diff --git a/CHANGES.txt b/CHANGES.txt
index f7b094ae6..8c82631bc 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -28,6 +28,8 @@ PIG-4333: Split BigData tests into multiple groups (rohini)
  
 BUG FIXES
 
+PIG-4345: e2e test "RubyUDFs_13" fails because of the different result of "group a all" in different engines like "spark", "mapreduce" (kellyzly via rohini)
+
 PIG-4332: Remove redundant jars packaged into pig-withouthadoop.jar for hadoop 2 (rohini)
 
 PIG-4331: update README, '-x' option in usage to include tez (thejas via daijy)
diff --git a/test/e2e/pig/tests/nightly.conf b/test/e2e/pig/tests/nightly.conf
index 29aaba9c7..d01b2bc56 100644
--- a/test/e2e/pig/tests/nightly.conf
+++ b/test/e2e/pig/tests/nightly.conf
@@ -3854,12 +3854,18 @@ store b into ':OUTPATH:';\,
                     'pig' => q\
 register ':SCRIPTHOMEPATH:/ruby/morerubyudfs.rb' using jruby as myfuncs;
 a = load ':INPATH:/singlefile/studenttab10k' using PigStorage() as (name, age:int, gpa:double);
-b = foreach (group a all) generate FLATTEN(myfuncs.AppendIndex(a));
+b = foreach (group a all){
+   a1= order a by name,age,gpa;
+   generate FLATTEN(myfuncs.AppendIndex(a1));
+}
 store b into ':OUTPATH:';\,
                     'verify_pig_script' => q\
 register :FUNCPATH:/testudf.jar;
 a = load ':INPATH:/singlefile/studenttab10k' using PigStorage() as (name, age:int, gpa:double);
-b = foreach (group a all) generate FLATTEN(org.apache.pig.test.udf.evalfunc.AppendIndex(a));
+b = foreach (group a all){
+    a1=order a by name,age,gpa;
+    generate FLATTEN(org.apache.pig.test.udf.evalfunc.AppendIndex(a1));
+}
 store b into ':OUTPATH:';\,
                     },
                 ]
