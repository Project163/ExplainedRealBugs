diff --git a/CHANGES.txt b/CHANGES.txt
index 363f54737..cd0f4ab5a 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -95,6 +95,8 @@ PIG-1309: Map-side Cogroup (ashutoshc)
 
 BUG FIXES
 
+PIG-1467: order by fail when set "fs.file.impl.disable.cache" to true (daijy)
+
 PIG-1463: Replace "bz" with ".bz" in setStoreLocation in PigStorage (zjffdu)
 
 PIG-1221: Filter equality does not work for tuples (zjffdu)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/SkewedPartitioner.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/SkewedPartitioner.java
index 89bcbe788..2a77589d3 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/SkewedPartitioner.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/SkewedPartitioner.java
@@ -35,6 +35,7 @@ import org.apache.pig.impl.io.NullablePartitionWritable;
 import org.apache.pig.impl.util.Pair;
 import org.apache.pig.data.DefaultTupleFactory;
 import org.apache.pig.data.DataType;
+import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapReduce;
 import org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil;
 
 
@@ -101,6 +102,7 @@ public class SkewedPartitioner extends Partitioner<PigNullableWritable, Writable
     @Override
     public void setConf(Configuration job) {
         conf = job;
+        PigMapReduce.sJobConf = conf;
         String keyDistFile = job.get("pig.keyDistFile", "");
         if (keyDistFile.length() == 0)
             throw new RuntimeException(this.getClass().getSimpleName() + " used but no key distribution found");
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/WeightedRangePartitioner.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/WeightedRangePartitioner.java
index 7d61cf75c..04f95d919 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/WeightedRangePartitioner.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/WeightedRangePartitioner.java
@@ -102,7 +102,11 @@ public class WeightedRangePartitioner extends Partitioner<PigNullableWritable, W
             
             
             // use local file system to get the quantilesFile
-            Configuration conf = new Configuration(false);            
+            Configuration conf = new Configuration(false);
+            if (configuration.get("fs.file.impl")!=null)
+                conf.set("fs.file.impl", configuration.get("fs.file.impl"));
+            if (configuration.get("fs.hdfs.impl")!=null)
+                conf.set("fs.hdfs.impl", configuration.get("fs.hdfs.impl"));
             conf.set(MapRedUtil.FILE_SYSTEM_NAME, "file:///");
             
             ReadToEndLoader loader = new ReadToEndLoader(new BinStorage(),
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/util/MapRedUtil.java b/src/org/apache/pig/backend/hadoop/executionengine/util/MapRedUtil.java
index 9702181b2..6bc868132 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/util/MapRedUtil.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/util/MapRedUtil.java
@@ -38,6 +38,7 @@ import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.plans.PhysicalPlan;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POStore;
+import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapReduce;
 import org.apache.pig.builtin.BinStorage;
 import org.apache.pig.data.DataBag;
 import org.apache.pig.data.DataType;
@@ -78,6 +79,11 @@ public class MapRedUtil {
 
         // use local file system to get the keyDistFile
         Configuration conf = new Configuration(false);            
+        
+        if (PigMapReduce.sJobConf.get("fs.file.impl")!=null)
+            conf.set("fs.file.impl", PigMapReduce.sJobConf.get("fs.file.impl"));
+        if (PigMapReduce.sJobConf.get("fs.hdfs.impl")!=null)
+            conf.set("fs.hdfs.impl", PigMapReduce.sJobConf.get("fs.hdfs.impl"));
         conf.set(MapRedUtil.FILE_SYSTEM_NAME, "file:///");
 
         ReadToEndLoader loader = new ReadToEndLoader(new BinStorage(), conf, 
