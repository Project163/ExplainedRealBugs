diff --git a/CHANGES.txt b/CHANGES.txt
index ae7afc337..892ff5c6c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -149,6 +149,8 @@ PIG-3013: BinInterSedes improve chararray sort performance (rohini)
 
 BUG FIXES
 
+PIG-3110: pig corrupts chararrays with trailing whitespace when converting them to long (prkommireddi via daijy)
+
 PIG-3253: Misleading comment w.r.t getSplitIndex() method in PigSplit.java (cheolsoo)
 
 PIG-3208: [zebra] TFile should not set io.compression.codec.lzo.buffersize (ekoontz via daijy)
diff --git a/src/org/apache/pig/builtin/Utf8StorageConverter.java b/src/org/apache/pig/builtin/Utf8StorageConverter.java
index b692ca6c2..36154c92b 100644
--- a/src/org/apache/pig/builtin/Utf8StorageConverter.java
+++ b/src/org/apache/pig/builtin/Utf8StorageConverter.java
@@ -24,15 +24,10 @@ import java.io.PushbackInputStream;
 import java.math.BigDecimal;
 import java.math.BigInteger;
 import java.util.Arrays;
-import java.util.EmptyStackException;
 import java.util.Deque;
 import java.util.HashMap;
 import java.util.LinkedList;
 import java.util.Map;
-import java.util.Stack;
-
-import org.joda.time.DateTime;
-import org.joda.time.DateTimeZone;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -47,6 +42,8 @@ import org.apache.pig.data.DefaultBagFactory;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.util.LogUtils;
+import org.joda.time.DateTime;
+import org.joda.time.DateTimeZone;
 
 /**
  * This abstract class provides standard conversions between utf8 encoded data
@@ -356,8 +353,10 @@ public class Utf8StorageConverter implements LoadStoreCaster {
 
     @Override
     public Double bytesToDouble(byte[] b) {
-        if(b == null)
+        if(b == null || b.length == 0) {
             return null;
+        }
+        
         try {
             return Double.valueOf(new String(b));
         } catch (NumberFormatException nfe) {
@@ -371,8 +370,10 @@ public class Utf8StorageConverter implements LoadStoreCaster {
 
     @Override
     public Float bytesToFloat(byte[] b) throws IOException {
-        if(b == null)
+        if(b == null || b.length == 0) {
             return null;
+        }
+        
         String s;
         if (b.length > 0 && (b[b.length - 1] == 'F' || b[b.length - 1] == 'f')) {
             s = new String(b, 0, b.length - 1);
@@ -426,9 +427,12 @@ public class Utf8StorageConverter implements LoadStoreCaster {
 
     @Override
     public Integer bytesToInteger(byte[] b) throws IOException {
-        if(b == null)
+        if(b == null || b.length == 0) {
             return null;
+        }
+        
         String s = new String(b);
+        s = s.trim();
         Integer ret = null;
 
         // See PIG-2835. Using exception handling to check if it's a double is very expensive.
@@ -467,13 +471,13 @@ public class Utf8StorageConverter implements LoadStoreCaster {
 
     @Override
     public Long bytesToLong(byte[] b) throws IOException {
-        if (b == null)
+        if (b == null || b.length == 0) {
             return null;
-        String s;
-        if (b.length > 0 && (b[b.length - 1] == 'L' || b[b.length - 1] == 'l')) {
-            s = new String(b, 0, b.length - 1);
-        } else {
-            s = new String(b);
+        }
+        
+        String s = new String(b).trim();
+        if(s.endsWith("l") || s.endsWith("L")) {
+            s = s.substring(0, s.length()-1);
         }
 
         // See PIG-2835. Using exception handling to check if it's a double is very expensive.
@@ -535,7 +539,6 @@ public class Utf8StorageConverter implements LoadStoreCaster {
     }
 
     @Override
-    @SuppressWarnings("unchecked")
     public Map<String, Object> bytesToMap(byte[] b, ResourceFieldSchema fieldSchema) throws IOException {
         if(b == null)
             return null;
@@ -584,7 +587,7 @@ public class Utf8StorageConverter implements LoadStoreCaster {
 
     @Override
     public BigInteger bytesToBigInteger(byte[] b) throws IOException {
-        if (b == null) {
+        if (b == null || b.length == 0) {
             return null;
         }
         return new BigInteger(new String(b));
@@ -592,7 +595,7 @@ public class Utf8StorageConverter implements LoadStoreCaster {
 
     @Override
     public BigDecimal bytesToBigDecimal(byte[] b) throws IOException {
-        if (b == null) {
+        if (b == null || b.length == 0) {
             return null;
         }
         return new BigDecimal(new String(b));
diff --git a/test/org/apache/pig/test/TestConversions.java b/test/org/apache/pig/test/TestConversions.java
index c0384d01b..1ddd0db93 100644
--- a/test/org/apache/pig/test/TestConversions.java
+++ b/test/org/apache/pig/test/TestConversions.java
@@ -87,8 +87,8 @@ public class TestConversions {
     public  void testBytesToInteger() throws IOException
     {
         // valid ints
-        String[] a = {"1", "-2345",  "1234567", "1.1", "-23.45", ""};
-        Integer[] ia = {1, -2345, 1234567, 1, -23};
+        String[] a = {"1234 ", " 4321", " 12345 ", "1", "-2345",  "1234567", "1.1", "-23.45", ""};
+        Integer[] ia = {1234, 4321, 12345, 1, -2345, 1234567, 1, -23};
 
         for (int i = 0; i < ia.length; i++) {
             byte[] b = a[i].getBytes();
@@ -96,7 +96,7 @@ public class TestConversions {
         }
 
         // invalid ints
-        a = new String[]{"1234567890123456", "This is an int", ""};
+        a = new String[]{"1234567890123456", "This is an int", "", "   "};
         for (String s : a) {
             byte[] b = s.getBytes();
             Integer i = ps.getLoadCaster().bytesToInteger(b);
@@ -120,7 +120,7 @@ public class TestConversions {
         }
 
         // invalid floats
-        a = new String[]{"1a.1", "23.1234567a890123456",  "This is a float", ""};
+        a = new String[]{"1a.1", "23.1234567a890123456",  "This is a float", "", "  "};
         for (String s : a) {
             byte[] b = s.getBytes();
             Float fl = ps.getLoadCaster().bytesToFloat(b);
@@ -141,7 +141,7 @@ public class TestConversions {
         }
 
         // invalid doubles
-        a = new String[]{"-0x1.1", "-23a.45",  "This is a double", ""};
+        a = new String[]{"-0x1.1", "-23a.45",  "This is a double", "", "   "};
         for (String s : a) {
             byte[] b = s.getBytes();
             Double dl = ps.getLoadCaster().bytesToDouble(b);
@@ -154,9 +154,9 @@ public class TestConversions {
     public  void testBytesToLong() throws IOException
     {
         // valid Longs
-        String[] a = {"1", "-2345",  "123456789012345678", "1.1", "-23.45",
+        String[] a = {"1703598819951657279 ", " 999888123L  ", " 1234 ", " 1234", "1234 ", "1", "-2345",  "123456789012345678", "1.1", "-23.45",
               "21345345", "3422342", ""};
-        Long[] la = {1L, -2345L, 123456789012345678L, 1L, -23L,
+        Long[] la = {1703598819951657279L, 999888123L, 1234L, 1234L, 1234L, 1L, -2345L, 123456789012345678L, 1L, -23L,
              21345345L, 3422342L};
 
         for (int i = 0; i < la.length; i++) {
@@ -165,7 +165,7 @@ public class TestConversions {
         }
 
         // invalid longs
-        a = new String[]{"This is a long", "1.0e1000", ""};
+        a = new String[]{"This is a long", "1.0e1000", "", "    "};
         for (String s : a) {
             byte[] b = s.getBytes();
             Long l = ps.getLoadCaster().bytesToLong(b);
