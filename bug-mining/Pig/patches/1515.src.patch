diff --git a/CHANGES.txt b/CHANGES.txt
index 0ce9c016b..f89893940 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -50,6 +50,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4053: TestMRCompiler succeeded with sun jdk 1.6 while failed with sun jdk 1.7 (daijy)
+
 PIG-3982: ant target test-tez should depend on jackson-pig-3039-test-download (daijy)
 
 PIG-4064: Fix tez auto parallelism test failures (daijy)
diff --git a/test/org/apache/pig/test/TestMRCompiler.java b/test/org/apache/pig/test/TestMRCompiler.java
index 4d2bbfe86..ea0b56b6b 100644
--- a/test/org/apache/pig/test/TestMRCompiler.java
+++ b/test/org/apache/pig/test/TestMRCompiler.java
@@ -24,6 +24,7 @@ import java.io.ByteArrayOutputStream;
 import java.io.FileInputStream;
 import java.io.FileOutputStream;
 import java.io.IOException;
+import java.lang.reflect.Field;
 import java.util.ArrayList;
 import java.util.LinkedList;
 import java.util.List;
@@ -31,7 +32,6 @@ import java.util.Properties;
 import java.util.Random;
 
 import org.apache.hadoop.conf.Configuration;
-import org.apache.hadoop.util.VersionInfo;
 import org.apache.pig.CollectableLoadFunc;
 import org.apache.pig.ComparisonFunc;
 import org.apache.pig.ExecType;
@@ -43,6 +43,7 @@ import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.LimitAdjuste
 import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MRCompiler;
 import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MRCompilerException;
 import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceOper;
+import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MergeJoinIndexer;
 import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.plans.MROperPlan;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POProject;
@@ -56,6 +57,7 @@ import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOpe
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POLimit;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POLoad;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POLocalRearrange;
+import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POMergeJoin;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POPackage;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POSort;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POSortedDistinct;
@@ -1004,14 +1006,51 @@ public class TestMRCompiler {
 
     @Test
     public void testMergeJoin() throws Exception {
-        org.junit.Assume.assumeFalse("Skip this test for hadoop 0.20.2. See PIG-3194", VersionInfo.getVersion().equals("0.20.2"));
         String query = "a = load '/tmp/input1';" +
         "b = load '/tmp/input2';" +
         "c = join a by $0, b by $0 using 'merge';" +
         "store c into '/tmp/output1';";
 
         PhysicalPlan pp = Util.buildPp(pigServer, query);
-        run(pp, "test/org/apache/pig/test/data/GoldenFiles/MRC18.gld");
+        MRCompiler comp = new MRCompiler(pp, pc);
+        comp.compile();
+        MROperPlan mrp = comp.getMRPlan();
+        assertTrue(mrp.size()==2);
+
+        MapReduceOper mrOp0 = mrp.getRoots().get(0);
+        assertTrue(mrOp0.mapPlan.size()==2);
+        PhysicalOperator load0 = mrOp0.mapPlan.getRoots().get(0);
+        MergeJoinIndexer func = (MergeJoinIndexer)PigContext.instantiateFuncFromSpec(((POLoad)load0).getLFile().getFuncSpec());
+        Field lrField = MergeJoinIndexer.class.getDeclaredField("lr");
+        lrField.setAccessible(true);
+        POLocalRearrange lr = (POLocalRearrange)lrField.get(func);
+        List<PhysicalPlan> innerPlans = lr.getPlans();
+        PhysicalOperator localrearrange0 = mrOp0.mapPlan.getSuccessors(load0).get(0);
+        assertTrue(localrearrange0 instanceof POLocalRearrange);
+        assertTrue(mrOp0.reducePlan.size()==3);
+        PhysicalOperator pack0 = mrOp0.reducePlan.getRoots().get(0);
+        assertTrue(pack0 instanceof POPackage);
+        PhysicalOperator foreach0 = mrOp0.reducePlan.getSuccessors(pack0).get(0);
+        assertTrue(foreach0 instanceof POForEach);
+        PhysicalOperator store0 = mrOp0.reducePlan.getSuccessors(foreach0).get(0);
+        assertTrue(store0 instanceof POStore);
+
+        assertTrue(innerPlans.size()==1);
+        PhysicalPlan innerPlan = innerPlans.get(0);
+        assertTrue(innerPlan.size()==1);
+        PhysicalOperator project = innerPlan.getRoots().get(0);
+        assertTrue(project instanceof POProject);
+        assertTrue(((POProject)project).getColumn()==0);
+
+        MapReduceOper mrOp1 = mrp.getSuccessors(mrOp0).get(0);
+        assertTrue(mrOp1.mapPlan.size()==3);
+        PhysicalOperator load1 = mrOp1.mapPlan.getRoots().get(0);
+        assertTrue(load1 instanceof POLoad);
+        PhysicalOperator mergejoin1 = mrOp1.mapPlan.getSuccessors(load1).get(0);
+        assertTrue(mergejoin1 instanceof POMergeJoin);
+        PhysicalOperator store1 = mrOp1.mapPlan.getSuccessors(mergejoin1).get(0);
+        assertTrue(store1 instanceof POStore);
+        assertTrue(mrOp1.reducePlan.isEmpty());
     }
 
     public static class WeirdComparator extends ComparisonFunc {
diff --git a/test/org/apache/pig/test/data/GoldenFiles/MRC18.gld b/test/org/apache/pig/test/data/GoldenFiles/MRC18.gld
deleted file mode 100644
index 8bffc3680..000000000
--- a/test/org/apache/pig/test/data/GoldenFiles/MRC18.gld
+++ /dev/null
@@ -1,21 +0,0 @@
-MapReduce(-1,PigStorage) - scope-109:
-Reduce Plan Empty
-|   c: Store(/tmp/output1:org.apache.pig.builtin.PigStorage) - scope-108
-|   |
-|   |---c: MergeJoin[tuple] - scope-105
-|       |
-|       |---a: Load(/tmp/input1:org.apache.pig.builtin.PigStorage) - scope-101
-|
-|---MapReduce(1,PigStorage) - scope-110:
-    |   Store(file:/tmp/temp-1456742965/tmp2077335416:org.apache.pig.impl.io.InterStorage) - scope-116
-    |   |
-    |   |---New For Each(true)[bag] - scope-115
-    |       |   |
-    |       |   Project[tuple][1] - scope-114
-    |       |
-    |       |---Package(Packager)[tuple]{tuple} - scope-113
-    |   Local Rearrange[tuple]{tuple}(false) - scope-112
-    |   |   |
-    |   |   Project[tuple][*] - scope-111
-    |   |
-    |   |---b: Load(/tmp/input2:org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MergeJoinIndexer('org.apache.pig.builtin.PigStorage','eNqtVT1vE0EQnThxYkzIF4QGpYj46u4kKqQUkEAiDEdsJWlwxeRuc76wd7vZ20vOFEhpoKCFggKJgjJ/AlFQQ0mF6KkpYXZtxxcHRGG2sLwzu+/NvJ2ZO/oB5VTB+V3cRyfTEXeWlcK2F6U6P/yy8OYTvh2FkRqMpdFTlksAGDkYM790aV2o0EGJfos5MgqdbfSfsCRwWhgIIR2WM58QRcKSMEroSKudRj5yD9tMOZJjkjqNrq1BO+iskRKUmnCOgOo7y5zXEplpD8pCxig1XPaI1O2QukTqRrHkrgncfZhxHT1EuZQruDoQmjllKZ26ZAq1UCcZKx5U4zUl4tUgZOkePINR4owfsHaqYdoz6nRJCN+DidhjuM/IN1PwGdHIORbXpYUoezAebwih7W7cg6l4U+zoQZpJa90SRVslLu5zSWov/ikl+2K9xLvplEowYqIgi43C3p7tP/A9TFvkK098/fDx4uPPo1BagyoXGKyhT8LU4IxuKZa2BA9yeeu2xZw8qNDvjPmb25iqpxymIq78U3ZStPDO96EUBSR06gvJNMx1xKTzobupVZSES3kvq5buHiOaR8MUHlUxZZeSuxcTlWG9ocQu83U/tvEmTEVp10yPkQRNqIp9poxSjDbzUgnfACXhCob1na1McpY24QKh04Nskp0zayR3DSqpRqXvCE7V4wuexQlVz3yheo77ztTv9v/OcPWUrZ8qEKE3DGGvi09DTzahjL6fxdTRkenkZa0NR1AzOu1l1EIsaKBCzhmP0ngFqh35ttqSUWEgj9DW2xRtLICGS4MjIECNrlWaum/cnup13DlO0WLIthT6TGm4PnhXsqTXvIWDhDMrVESpUorCR5N5D3JCZLrAUJWoWKLNONHQGITvyuh2ZHQHZHRPyOjakegWRyLFMarMmLk7FPCGldTU1eI/G7T/dnaIUL9quPbHoWuuuYW+pl41mkwD/KJ1Q9KyItllPxrVXJpZtDJMrXVyKcyQFZhUTGcq2dSos5QqoFNBJ8dJfdv0MYVY6g0UOA6u80WrHk9Jc8GpJZqFTM19f/f+5+GLmyXzESzvI88YyTjTP7eexdtMPT96vXD21beXppksQZ4Pwpvtpb8OT+u18uWnRLOGyl9uwpBukPlvzlh4bg==','','b_45-1','scope','true')) - scope-102
