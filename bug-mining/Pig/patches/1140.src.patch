diff --git a/CHANGES.txt b/CHANGES.txt
index a6a12ca4c..600053540 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -24,6 +24,8 @@ INCOMPATIBLE CHANGES
 
 IMPROVEMENTS
 
+PIG-3098: Add another test for the self join case (jcoveney)
+
 PIG-3129: Document syntax to refer to previous relation (rjurney via jcoveney)
 
 PIG-2553: Pig shouldn't allow attempts to write multiple relations into same directory (prkommireddi via cheolsoo)
diff --git a/test/org/apache/pig/test/TestJoin.java b/test/org/apache/pig/test/TestJoin.java
index e52f95050..b203a984b 100644
--- a/test/org/apache/pig/test/TestJoin.java
+++ b/test/org/apache/pig/test/TestJoin.java
@@ -76,7 +76,7 @@ public class TestJoin {
 
     @AfterClass
     public static void oneTimeTearDown() throws Exception {
-        cluster.shutDown();
+        if (cluster != null) cluster.shutDown();
     }
 
     private void setUp(ExecType execType) throws ExecException {
@@ -717,11 +717,34 @@ public class TestJoin {
         pigServer.registerQuery("E = foreach D generate field1, field2;");
         assertEquals(Utils.getSchemaFromString("B::field1:chararray, field2:chararray"), pigServer.dumpSchema("E"));
         pigServer.registerQuery("F = foreach E generate field2;");
-        Iterator<Tuple> it = pigServer.openIterator("F");
-        assertTrue(it.hasNext());
-        while (it.hasNext()) {
-            assertTrue(tuples.remove(it.next()));
+        pigServer.registerQuery("store F into 'foo_out' using mock.Storage();");
+        List<Tuple> out = data.get("foo_out");
+        assertEquals("Expected size was "+tuples.size()+" but was "+out.size(), tuples.size(), out.size());
+        for (Tuple t : out) {
+            assertTrue("Should have found tuple "+t+" in expected: "+tuples, tuples.remove(t));
         }
-        assertFalse(it.hasNext());
+        assertTrue("All expected tuples should have been found, remaining: "+tuples, tuples.isEmpty());
+    }
+
+    @Test
+    public void testIndirectSelfJoinData() throws Exception {
+        setUp(ExecType.LOCAL);
+        Data data = resetData(pigServer);
+
+        Set<Tuple> tuples = Sets.newHashSet(tuple("a", 1), tuple("b", 2), tuple("c", 3));
+        data.set("foo", Utils.getSchemaFromString("field1:chararray,field2:int"), tuples);
+        pigServer.registerQuery("A = load 'foo' using mock.Storage();");
+        pigServer.registerQuery("B = foreach A generate field1, field2*2 as field2;");
+        pigServer.registerQuery("C = join A by field1, B by field1;");
+        pigServer.registerQuery("D = foreach C generate A::field1 as field1_a, B::field1 as field1_b, A::field2 as field2_a, B::field2 as field2_b;");
+        pigServer.registerQuery("store D into 'foo_out' using mock.Storage();");
+
+        Set<Tuple> expected = Sets.newHashSet(tuple("a", "a", 1, 2), tuple("b", "b", 2, 4), tuple("c", "c", 3, 6));
+        List<Tuple> out = data.get("foo_out");
+        assertEquals("Expected size was "+expected.size()+" but was "+out.size(), expected.size(), out.size());
+        for (Tuple t : out) {
+            assertTrue("Should have found tuple "+t+" in expected: "+expected, expected.remove(t));
+        }
+        assertTrue("All expected tuples should have been found, remaining: "+expected, expected.isEmpty());
     }
 }
\ No newline at end of file
