<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:57:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-3318] AVRO: &apos;default value&apos; not honored when merging schemas on load with AvroStorage</title>
                <link>https://issues.apache.org/jira/browse/PIG-3318</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Piggybank - AvroStorage. When merging multiple schemas where default values have been specified in the avro schema; &lt;br/&gt;
The AvroStorage puts nulls in the merged data set. &lt;/p&gt;

&lt;p&gt;==&amp;gt; Employee3.avro &amp;lt;==&lt;br/&gt;
{&lt;br/&gt;
&quot;type&quot; : &quot;record&quot;,&lt;br/&gt;
&quot;name&quot; : &quot;employee&quot;,&lt;br/&gt;
&quot;fields&quot;:[&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;name&quot;, &quot;type&quot; : &quot;string&quot;, &quot;default&quot; : &quot;NU&quot;}
&lt;p&gt;,&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;age&quot;, &quot;type&quot; : &quot;int&quot;, &quot;default&quot; : 0 }
&lt;p&gt;,&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;dept&quot;, &quot;type&quot;: &quot;string&quot;, &quot;default&quot; : &quot;DU&quot;}
&lt;p&gt; ] }&lt;/p&gt;

&lt;p&gt;==&amp;gt; Employee4.avro &amp;lt;==&lt;br/&gt;
{&lt;br/&gt;
&quot;type&quot; : &quot;record&quot;,&lt;br/&gt;
&quot;name&quot; : &quot;employee&quot;,&lt;br/&gt;
&quot;fields&quot;:[&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;name&quot;, &quot;type&quot; : &quot;string&quot;, &quot;default&quot; : &quot;NU&quot;}
&lt;p&gt;,&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;age&quot;, &quot;type&quot; : &quot;int&quot;, &quot;default&quot; : 0}
&lt;p&gt;,&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;dept&quot;, &quot;type&quot;: &quot;string&quot;, &quot;default&quot; : &quot;DU&quot;}
&lt;p&gt;,&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;office&quot;, &quot;type&quot;: &quot;string&quot;, &quot;default&quot; : &quot;OU&quot;}
&lt;p&gt; ] }&lt;/p&gt;

&lt;p&gt;==&amp;gt; Employee6.avro &amp;lt;==&lt;br/&gt;
{&lt;br/&gt;
&quot;type&quot; : &quot;record&quot;,&lt;br/&gt;
&quot;name&quot; : &quot;employee&quot;,&lt;br/&gt;
&quot;fields&quot;:[&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;name&quot;, &quot;type&quot; : &quot;string&quot;, &quot;default&quot; : &quot;NU&quot;}
&lt;p&gt;,&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;lastname&quot;, &quot;type&quot;: &quot;string&quot;, &quot;default&quot; : &quot;LNU&quot;}
&lt;p&gt;,&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;age&quot;, &quot;type&quot; : &quot;int&quot;,&quot;default&quot; : 0}
&lt;p&gt;,&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;salary&quot;, &quot;type&quot;: &quot;int&quot;, &quot;default&quot; : 0}
&lt;p&gt;,&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;dept&quot;, &quot;type&quot;: &quot;string&quot;,&quot;default&quot; : &quot;DU&quot;}
&lt;p&gt;,&lt;br/&gt;
        &lt;/p&gt;
{&quot;name&quot; : &quot;office&quot;, &quot;type&quot;: &quot;string&quot;,&quot;default&quot; : &quot;OU&quot;}
&lt;p&gt; ] }&lt;/p&gt;

&lt;p&gt;The pig script:&lt;br/&gt;
employee = load &apos;employee&lt;/p&gt;
{3,4,6}
&lt;p&gt;.ser&apos; using org.apache.pig.piggybank.storage.avro.AvroStorage(&apos;multiple_schemas&apos;);&lt;br/&gt;
describe employee;&lt;br/&gt;
dump employee;&lt;/p&gt;

&lt;p&gt;Output Schema:&lt;br/&gt;
employee: &lt;/p&gt;
{name: chararray,age: int,dept: chararray,lastname: chararray,salary: int,office: chararray}

&lt;p&gt;(Milo,30,DH,,,)&lt;br/&gt;
(Asmya,34,PQ,,,)&lt;br/&gt;
(Baljit,23,RS,,,)&lt;br/&gt;
(Pune,60,Astrophysics,Warriors,5466,UTA)&lt;br/&gt;
(Rajsathan,20,Biochemistry,Royals,1378,Stanford)&lt;br/&gt;
(Chennai,50,Microbiology,Superkings,7338,Hopkins)&lt;br/&gt;
(Mumbai,20,Applied Math,Indians,4468,UAH)&lt;br/&gt;
(Praj,54,RMX,,,Champaign)&lt;br/&gt;
(Buba,767,HD,,,Sunnyvale)&lt;br/&gt;
(Manku,375,MS,,,New York)&lt;/p&gt;


&lt;p&gt;Regards&lt;br/&gt;
Viraj&lt;/p&gt;</description>
                <environment></environment>
        <key id="12646937">PIG-3318</key>
            <summary>AVRO: &apos;default value&apos; not honored when merging schemas on load with AvroStorage</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="viraj">Viraj Bhat</assignee>
                                    <reporter username="viraj">Viraj Bhat</reporter>
                        <labels>
                            <label>patch</label>
                    </labels>
                <created>Fri, 10 May 2013 01:41:31 +0000</created>
                <updated>Mon, 14 Oct 2013 16:45:51 +0000</updated>
                            <resolved>Fri, 14 Jun 2013 13:35:28 +0000</resolved>
                                    <version>0.11.2</version>
                                    <fixVersion>0.12.0</fixVersion>
                                    <component>piggybank</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13655428" author="viraj" created="Sun, 12 May 2013 02:36:33 +0000"  >&lt;p&gt;Submitting a patch in both Pig 0.11 and Pig 0.12/trunk, which will fix this issue with the relevant test cases and files.&lt;/p&gt;</comment>
                            <comment id="13655431" author="viraj" created="Sun, 12 May 2013 02:37:49 +0000"  >&lt;p&gt;Trunk patch which contains the fix&lt;/p&gt;</comment>
                            <comment id="13655432" author="viraj" created="Sun, 12 May 2013 02:38:22 +0000"  >&lt;p&gt;Patch for branch 0.11.2&lt;/p&gt;</comment>
                            <comment id="13655433" author="viraj" created="Sun, 12 May 2013 02:39:15 +0000"  >&lt;p&gt;Avro file&lt;/p&gt;</comment>
                            <comment id="13655434" author="viraj" created="Sun, 12 May 2013 02:39:35 +0000"  >&lt;p&gt;avro test file&lt;/p&gt;</comment>
                            <comment id="13655435" author="viraj" created="Sun, 12 May 2013 02:39:52 +0000"  >&lt;p&gt;Avro test file&lt;/p&gt;</comment>
                            <comment id="13655436" author="viraj" created="Sun, 12 May 2013 02:40:36 +0000"  >&lt;p&gt;Expected resulting avro file&lt;/p&gt;</comment>
                            <comment id="13655437" author="viraj" created="Sun, 12 May 2013 02:43:37 +0000"  >&lt;p&gt;Patch for adding default values for merged schemas.&lt;/p&gt;</comment>
                            <comment id="13657709" author="rohini" created="Tue, 14 May 2013 23:49:53 +0000"  >&lt;p&gt;Review board request from Virag for the patch - &lt;a href=&quot;https://reviews.apache.org/r/11135/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/11135/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13681267" author="rohini" created="Wed, 12 Jun 2013 14:24:18 +0000"  >&lt;p&gt;Ran TestAvroStorage before committing. Encountered&lt;/p&gt;


&lt;p&gt;Testcase: testMultipleSchemasWithDefaultValue took 3.543 sec&lt;br/&gt;
        Caused an ERROR&lt;br/&gt;
Not a data file.&lt;br/&gt;
java.io.IOException: Not a data file.&lt;br/&gt;
        at org.apache.avro.file.DataFileStream.initialize(DataFileStream.java:105)&lt;br/&gt;
        at org.apache.avro.file.DataFileStream.&amp;lt;init&amp;gt;(DataFileStream.java:84)&lt;br/&gt;
        at org.apache.pig.piggybank.test.storage.avro.TestAvroStorage.verifyResults(TestAvroStorage.java:1292)&lt;br/&gt;
        at org.apache.pig.piggybank.test.storage.avro.TestAvroStorage.verifyResults(TestAvroStorage.java:1262)&lt;br/&gt;
        at org.apache.pig.piggybank.test.storage.avro.TestAvroStorage.testMultipleSchemasWithDefaultValue(TestAvroStorage.java:704)&lt;/p&gt;

&lt;p&gt;The problem is that the testcase is storing output using PigStorage and so output is not a avro file. I tried changing it to AvroStorage but still failed as it did not match with the expected_testMultipleSchemasWithDefaultValue.avro. Can you fix the testcase? Also can you rename Employee*.ser to Employee*.avro to be consistent with naming. &lt;/p&gt;</comment>
                            <comment id="13681848" author="viraj" created="Thu, 13 Jun 2013 02:04:20 +0000"  >&lt;p&gt;Sorry for attaching the wrong patch, which makes the test case write to an Avro file. I have modified the test to use mock.Storage(), will reattach the correct patch.&lt;br/&gt;
Viraj&lt;/p&gt;</comment>
                            <comment id="13683342" author="rohini" created="Fri, 14 Jun 2013 13:35:28 +0000"  >&lt;p&gt;Committed to trunk(0.12). Thanks Viraj.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12587735" name="Employee3.avro" size="264" author="viraj" created="Fri, 14 Jun 2013 00:16:56 +0000"/>
                            <attachment id="12587736" name="Employee4.avro" size="343" author="viraj" created="Fri, 14 Jun 2013 00:17:09 +0000"/>
                            <attachment id="12587737" name="Employee6.avro" size="533" author="viraj" created="Fri, 14 Jun 2013 00:17:22 +0000"/>
                            <attachment id="12587738" name="PIG-3318_5.patch" size="19440" author="viraj" created="Fri, 14 Jun 2013 00:17:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>327294</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 23 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kgz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>327638</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>AvroStorage</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>