<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:00:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-4403] Combining -Dpig.additional.jars.uris with -useHCatalog breaks due to combination with colon instead of comma</title>
                <link>https://issues.apache.org/jira/browse/PIG-4403</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;When adding a JSON serde parser as additional jar on running pig with HCatalog:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;pig -useHCatalog -Dpig.additional.jars.uris=file:///usr/lib/hive/lib/json-serde-1.3.1-SNAPSHOT-jar-with-dependencies.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Pig crashes on &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR 2999: Unexpected internal error. java.net.URISyntaxException: Relative path in absolute URI: hive-hcatalog-pig-adapter-0.14.0.2.2.0.0-2041.jar:file:
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-01-30 18:21:23,848 [main] INFO  org.apache.pig.Main - Apache Pig version 0.14.0.2.2.0.0-2041 (rexported) compiled Nov 19 2014, 15:24:46
2015-01-30 18:21:23,848 [main] INFO  org.apache.pig.Main - Logging error messages to: /home/olivier/bsft_ds/data/pig.2015-01-30_18-21-22.log
2015-01-30 18:21:24,748 [main] INFO  org.apache.pig.impl.util.Utils - Default bootup file /home/olivier/.pigbootup not found
2015-01-30 18:21:24,967 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine - Connecting to hadoop file system at: hdfs://aws-usw2a-p-hw-master11.blueshift.vpc:8020
2015-01-30 18:21:26,214 [main] ERROR org.apache.pig.Main - ERROR 2999: Unexpected internal error. java.net.URISyntaxException: Relative path in absolute URI: hive-hcatalog-pig-adapter-0.14.0.2.2.0.0-2041.jar:file:
----------------------------
ERROR 2999: Unexpected internal error. java.net.URISyntaxException: Relative path in absolute URI: hive-hcatalog-pig-adapter-0.14.0.2.2.0.0-2041.jar:file:

java.lang.IllegalArgumentException: java.net.URISyntaxException: Relative path in absolute URI: hive-hcatalog-pig-adapter-0.14.0.2.2.0.0-2041.jar:file:
	at org.apache.hadoop.fs.Path.initialize(Path.java:206)
	at org.apache.hadoop.fs.Path.&amp;lt;init&amp;gt;(Path.java:172)
	at org.apache.hadoop.fs.Path.&amp;lt;init&amp;gt;(Path.java:94)
	at org.apache.hadoop.fs.Globber.glob(Globber.java:211)
	at org.apache.hadoop.fs.FileSystem.globStatus(FileSystem.java:1625)
	at org.apache.pig.impl.io.FileLocalizer.fetchFilesInternal(FileLocalizer.java:816)
	at org.apache.pig.impl.io.FileLocalizer.fetchFiles(FileLocalizer.java:767)
	at org.apache.pig.PigServer.registerJar(PigServer.java:558)
	at org.apache.pig.PigServer.addJarsFromProperties(PigServer.java:265)
	at org.apache.pig.PigServer.&amp;lt;init&amp;gt;(PigServer.java:231)
	at org.apache.pig.PigServer.&amp;lt;init&amp;gt;(PigServer.java:214)
	at org.apache.pig.tools.grunt.Grunt.&amp;lt;init&amp;gt;(Grunt.java:46)
	at org.apache.pig.Main.run(Main.java:487)
	at org.apache.pig.Main.main(Main.java:170)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:221)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:136)
Caused by: java.net.URISyntaxException: Relative path in absolute URI: hive-hcatalog-pig-adapter-0.14.0.2.2.0.0-2041.jar:file:
	at java.net.URI.checkPath(URI.java:1804)
	at java.net.URI.&amp;lt;init&amp;gt;(URI.java:752)
	at org.apache.hadoop.fs.Path.initialize(Path.java:203)
	... 19 more
================================================================================
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Checking with -printDebugCmd I can see that the command looks like:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;-Dpig.additional.jars.uris=file:///usr/hdp/2.2.0.0-2041/hive/lib/hive-metastore-0.14.0.2.2.0.0-2041.jar,file:///usr/hdp/2.2.0.0-2041/hive/lib/libthrift-0.9.0.jar,file:///usr/hdp/2.2.0.0-2041/hive/lib/hive-exec-0.14.0.2.2.0.0-2041.jar,file:///usr/hdp/2.2.0.0-2041/hive/lib/libfb303-0.9.0.jar,file:///usr/hdp/2.2.0.0-2041/hive/lib/jdo-api-3.0.1.jar,file://,file://,file:///usr/hdp/2.2.0.0-2041/hive/lib/hive-hbase-handler-0.14.0.2.2.0.0-2041.jar,file:///usr/hdp/2.2.0.0-2041/hive-hcatalog/share/hcatalog/hive-hcatalog-core-0.14.0.2.2.0.0-2041.jar,file://,file:///usr/hdp/2.2.0.0-2041/hive-hcatalog/share/hcatalog/hive-hcatalog-pig-adapter-0.14.0.2.2.0.0-2041.jar:file:/usr/lib/hive/lib/json-serde-1.3.1-SNAPSHOT-jar-with-dependencies.jar 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So it seems that 0.14 combines the -useHCatalog jars (comma separated), with -Dpig.additional.jars.uris (also comma separated) using a colon, and thus breaks the Jar classpath.&lt;/p&gt;

&lt;p&gt;Running with either only -useHCatalg or -Dpig.additional.jars.uris does not result in any issues.&lt;/p&gt;

&lt;p&gt;Could it be that 0.14 contains legacy code that combines these multiple flags with a symbol that breaks the path?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Apache Pig version 0.14.0.2.2.0.0-2041 (rexported) compiled Nov 19 2014, 15:24:46&lt;br/&gt;
Hortonworks HDP 2.2.0.0-2041&lt;/p&gt;</environment>
        <key id="12771405">PIG-4403</key>
            <summary>Combining -Dpig.additional.jars.uris with -useHCatalog breaks due to combination with colon instead of comma</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ovlaere">Olivier Van Laere</assignee>
                                    <reporter username="ovlaere">Olivier Van Laere</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Jan 2015 19:14:07 +0000</created>
                <updated>Sun, 7 Jun 2015 03:48:31 +0000</updated>
                            <resolved>Sat, 31 Jan 2015 04:57:07 +0000</resolved>
                                    <version>0.14.0</version>
                                    <fixVersion>0.15.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14299392" author="daijy" created="Fri, 30 Jan 2015 23:50:27 +0000"  >&lt;p&gt;Can you try setting environment variable PIG_OPTS?&lt;/p&gt;

&lt;p&gt;export PIG_OPTS=&quot;-Dpig.additional.jars.uris=&lt;a href=&quot;file:///usr/lib/hive/lib/json-serde-1.3.1-SNAPSHOT-jar-with-dependencies.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:///usr/lib/hive/lib/json-serde-1.3.1-SNAPSHOT-jar-with-dependencies.jar&lt;/a&gt;&quot;&lt;/p&gt;</comment>
                            <comment id="14299449" author="ovlaere" created="Sat, 31 Jan 2015 00:38:10 +0000"  >&lt;p&gt;Hi Daniel, i haven&apos;t tried that exact line, but similar things and it would break. I cloned the git repo of the pig source, and tried to figure out where the evil happens, and it&apos;s here: in line 191-193 of the bin/pig script, the following happens&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ADDITIONAL_CLASSPATHS=file://$hiveMetaStoreVersion,file://$thriftVersion,file://$hiveExecVersion,file://$fbJarVersion,file://$jdoECJarVersion,file://$slfJarVersion,file://$hbaseHiveVersion,file://$hcatJarPath,file://$hbaseHCatJarPath,file://$pigHCatJarPath
  if [ &quot;$additionalJars&quot; != &quot;&quot; ]; then
    ADDITIONAL_CLASSPATHS=$ADDITIONAL_CLASSPATHS:$additionalJars
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As you can see, the last line explicitly concats the defined HIVE/HCat jars with any additional jars using a colon, that will break the path, as ADDITIONAL_CLASSPATHS already contains colons.&lt;/p&gt;

&lt;p&gt;The same thing occurs at line 358.&lt;/p&gt;

&lt;p&gt;Replacing colon by comma in the script makes it work again.&lt;/p&gt;</comment>
                            <comment id="14299458" author="daijy" created="Sat, 31 Jan 2015 00:42:55 +0000"  >&lt;p&gt;Yes, we need to fix -D as well. Attach patch.&lt;/p&gt;</comment>
                            <comment id="14299473" author="ovlaere" created="Sat, 31 Jan 2015 00:49:16 +0000"  >&lt;p&gt;Replacing concatenation character from colon to comma in ADDITIONAL_CLASSPATHS, as colons can now occur in the URIs specific with -Dpig.additional.jars.uris and this avoids breaking the path.&lt;/p&gt;</comment>
                            <comment id="14299478" author="ovlaere" created="Sat, 31 Jan 2015 00:53:00 +0000"  >&lt;p&gt;Sorry Daniel, didn&apos;t see you already attached a patch, I read it as a request &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14299676" author="daijy" created="Sat, 31 Jan 2015 04:57:07 +0000"  >&lt;p&gt;Don&apos;t realize you want to submit the patch. The nice thing is the patches are the same &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; That&apos;s the perfect way for code review.&lt;/p&gt;

&lt;p&gt;Patch committed to trunk. Thanks Olivier!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12695683" name="PIG-4403-1.patch" size="1364" author="daijy" created="Sat, 31 Jan 2015 00:42:55 +0000"/>
                            <attachment id="12695686" name="PIG-4403-fix.patch" size="1400" author="ovlaere" created="Sat, 31 Jan 2015 00:49:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i250rb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>