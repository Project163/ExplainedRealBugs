<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:02:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-4965] Refactor test/perf/pigmix/bin/runpigmix.pl to delete the output of single test case if we enable cleanup_after_test</title>
                <link>https://issues.apache.org/jira/browse/PIG-4965</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;in  test/perf/pigmix/bin/runpigmix.pl#cleanup&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;sub cleanup {
    my $suffix = shift;
    my $cmd;
    $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf L&quot;&lt;/span&gt;.$suffix.&lt;span class=&quot;code-quote&quot;&gt;&quot;out&quot;&lt;/span&gt;;
    print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
    $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf highest_value_page_per_user&quot;&lt;/span&gt;;
    print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
    $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf total_timespent_per_term&quot;&lt;/span&gt;;
    print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
    $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf queries_per_action&quot;&lt;/span&gt;;
    print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
    $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf tmp&quot;&lt;/span&gt;;
    print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ($cleanup_after_test) {
        $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$hadoopbin fs -rmr $pigmixoutput&quot;&lt;/span&gt;;
        print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
    }   
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-200&quot; title=&quot;Pig Performance Benchmarks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-200&quot;&gt;&lt;del&gt;PIG-200&lt;/del&gt;&lt;/a&gt;, it deletes the output of the single script. But the output of a single script is not &lt;a href=&quot;https://github.com/apache/pig/blob/spark/test/perf/pigmix/bin/runpigmix.pl#L113&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;L.$suffix.out&lt;/a&gt; so the output is not deleted. The correct output of a single script is PIGMIX_OUTPUT/L.$suffix.out. In &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4753&quot; title=&quot;Pigmix should have option to delete outputs after completing the tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4753&quot;&gt;&lt;del&gt;PIG-4753&lt;/del&gt;&lt;/a&gt;(Pigmix should have option to delete outputs after completing the tests), we can delete the output if we enable cleanup_after_test.  So i think we can refactor the code as following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;sub cleanup {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ($cleanup_after_test) {
        my $suffix = shift;
        my $cmd;
        $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf $pigmixoutput/L&quot;&lt;/span&gt;.$suffix.&lt;span class=&quot;code-quote&quot;&gt;&quot;out&quot;&lt;/span&gt;;
        print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
        $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf $pigmixoutput/highest_value_page_per_user&quot;&lt;/span&gt;;
        print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
        $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf $pigmixoutput/total_timespent_per_term&quot;&lt;/span&gt;;
        print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
        $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf $pigmixoutput/queries_per_action&quot;&lt;/span&gt;;
        print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
        $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf tmp&quot;&lt;/span&gt;;
        print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12995097">PIG-4965</key>
            <summary>Refactor test/perf/pigmix/bin/runpigmix.pl to delete the output of single test case if we enable cleanup_after_test</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kellyzly">liyunzhang</assignee>
                                    <reporter username="kellyzly">liyunzhang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Aug 2016 04:52:18 +0000</created>
                <updated>Wed, 21 Jun 2017 09:15:33 +0000</updated>
                            <resolved>Mon, 8 Aug 2016 17:38:16 +0000</resolved>
                                                    <fixVersion>spark-branch</fixVersion>
                    <fixVersion>0.17.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15408890" author="kellyzly" created="Fri, 5 Aug 2016 05:16:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;daijy&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rohini&quot; class=&quot;user-hover&quot; rel=&quot;rohini&quot;&gt;rohini&lt;/a&gt;:  As you are familiar with pigmix benchmark, can you help review this?&lt;/p&gt;</comment>
                            <comment id="15410180" author="daijy" created="Fri, 5 Aug 2016 22:19:52 +0000"  >&lt;p&gt;Remove a file does not exist clearly a bug. I think you can just add $pigmixoutput prefix to each file intend to remove.&lt;/p&gt;</comment>
                            <comment id="15411279" author="kellyzly" created="Mon, 8 Aug 2016 04:51:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;daijy&lt;/a&gt;:  In &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-200&quot; title=&quot;Pig Performance Benchmarks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-200&quot;&gt;&lt;del&gt;PIG-200&lt;/del&gt;&lt;/a&gt;, we really want to delete output $pigmixoutput/L.$suffix.out?  If it is, i think we need not add cleanup_after_test option(&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4753&quot; title=&quot;Pigmix should have option to delete outputs after completing the tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4753&quot;&gt;&lt;del&gt;PIG-4753&lt;/del&gt;&lt;/a&gt;: Pigmix should have option to delete outputs after completing the tests). If we still want users to view the output, we need retain output($pigmixoutput/L.$suffix.out),  so i think we can delete the output $pigmixoutput/L.$suffix.out only when &quot;cleanup_after_test&quot; is enabled like following, if you think the following code is ok, i will upload the patch.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;sub cleanup {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ($cleanup_after_test) {
        my $suffix = shift;
        my $cmd;
        $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf $pigmixoutput/L&quot;&lt;/span&gt;.$suffix.&lt;span class=&quot;code-quote&quot;&gt;&quot;out&quot;&lt;/span&gt;;
        print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
        $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf $pigmixoutput/highest_value_page_per_user&quot;&lt;/span&gt;;
        print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
        $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf $pigmixoutput/total_timespent_per_term&quot;&lt;/span&gt;;
        print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
        $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf $pigmixoutput/queries_per_action&quot;&lt;/span&gt;;
        print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
        $cmd = &lt;span class=&quot;code-quote&quot;&gt;&quot;$pigbin -e rmf tmp&quot;&lt;/span&gt;;
        print STDERR `$cmd 2&amp;gt;&amp;amp;1`;
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15411389" author="daijy" created="Mon, 8 Aug 2016 06:31:08 +0000"  >&lt;p&gt;The suggested code makes sense to me. Remove a non-exist file is certainly a bug and this might be overlooked by &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4753&quot; title=&quot;Pigmix should have option to delete outputs after completing the tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4753&quot;&gt;&lt;del&gt;PIG-4753&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="15411435" author="kellyzly" created="Mon, 8 Aug 2016 07:39:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;daijy&lt;/a&gt;:  After investigating the code, i found that in pig mode, the output is $pigmixoutput/pig/L.$suffix.out while in mr mode the output is $pigmixoutput/mapreduce/L.$suffix.out.   Upload &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4965&quot; title=&quot;Refactor test/perf/pigmix/bin/runpigmix.pl to delete the output of single test case if we enable cleanup_after_test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4965&quot;&gt;&lt;del&gt;PIG-4965&lt;/del&gt;&lt;/a&gt;.patch, changes:&lt;br/&gt;
1. add $pigmixoutput prefix to each file intend to remove in runpigmix.pl#cleanup when enable &quot;cleanup_after_test&quot; option.&lt;/p&gt;</comment>
                            <comment id="15412139" author="daijy" created="Mon, 8 Aug 2016 17:38:17 +0000"  >&lt;p&gt;Patch committed to both trunk and spark-branch. Thanks Liyun!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12822523" name="PIG-4965.patch" size="1895" author="kellyzly" created="Mon, 8 Aug 2016 07:40:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 15 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31xy7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>