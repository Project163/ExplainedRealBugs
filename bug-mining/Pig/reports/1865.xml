<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:02:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-4953] Predicate push-down will not run filters for single unary expressions</title>
                <link>https://issues.apache.org/jira/browse/PIG-4953</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;While testing &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4940&quot; title=&quot;Predicate push-down filtering unary expressions can be pushed.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4940&quot;&gt;&lt;del&gt;PIG-4940&lt;/del&gt;&lt;/a&gt;, I noticed that a &quot;is not null&quot; predicate was not pushed down, but equality predicates were. The problem is that the &lt;tt&gt;FilterExtractor#visit&lt;/tt&gt; method ignores anything that isn&apos;t a &lt;tt&gt;BinaryExpression&lt;/tt&gt;. Pushing down &lt;tt&gt;UnaryExpression&lt;/tt&gt; filters works if the expression is linked in by a binary expression, like &quot;b is not null and c == &apos;val&apos;&quot;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12990814">PIG-4953</key>
            <summary>Predicate push-down will not run filters for single unary expressions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rdblue">Ryan Blue</assignee>
                                    <reporter username="rdblue">Ryan Blue</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Jul 2016 15:45:13 +0000</created>
                <updated>Wed, 21 Jun 2017 09:15:14 +0000</updated>
                            <resolved>Sat, 11 Feb 2017 06:14:35 +0000</resolved>
                                    <version>0.15.0</version>
                                    <fixVersion>0.17.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15384396" author="rdblue" created="Tue, 19 Jul 2016 15:49:29 +0000"  >&lt;p&gt;A comment in the code states, &quot;if the leaf is a unary operator it should be a FilterFunc in which case we don&apos;t try to extract partition filter conditions&quot;. This appears to be a stale comment because it refers to partition filter conditions (one of the subclasses), but this is being used for push-down filtering as well. Partition filtering will check &lt;tt&gt;isSupportedOpType&lt;/tt&gt; that returns false for all unary expressions, so it is perfectly safe to call &lt;tt&gt;checkPushDown&lt;/tt&gt; in the partition filtering case.&lt;/p&gt;</comment>
                            <comment id="15384606" author="rdblue" created="Tue, 19 Jul 2016 18:03:33 +0000"  >&lt;p&gt;Attaching a patch with the fix.&lt;/p&gt;</comment>
                            <comment id="15384612" author="rdblue" created="Tue, 19 Jul 2016 18:07:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;daijy&lt;/a&gt;, can you take a look at this patch?&lt;/p&gt;

&lt;p&gt;This fixes the visit method and adds tests for predicate push-down. I noticed that the tests added with &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4940&quot; title=&quot;Predicate push-down filtering unary expressions can be pushed.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4940&quot;&gt;&lt;del&gt;PIG-4940&lt;/del&gt;&lt;/a&gt; were for partition push-down, not predicate. I copied the test file and modified it to use &lt;tt&gt;PredicatePushDownFilterExtractor&lt;/tt&gt;. I also added a test for &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4940&quot; title=&quot;Predicate push-down filtering unary expressions can be pushed.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4940&quot;&gt;&lt;del&gt;PIG-4940&lt;/del&gt;&lt;/a&gt; and for this. The successful case caught an additional problem: the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4940&quot; title=&quot;Predicate push-down filtering unary expressions can be pushed.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4940&quot;&gt;&lt;del&gt;PIG-4940&lt;/del&gt;&lt;/a&gt; didn&apos;t remove the residual filters that accumulate on the filter plan when the entire unary expression is going to be added to the filter plan isntead. I fixed this case and the tests are passing. I&apos;d appreciate it if the reviewers could check that I got the logic right here. I&apos;m not very familiar with how residuals are handled and want to make sure this is correct. Thanks!&lt;/p&gt;</comment>
                            <comment id="15385296" author="daijy" created="Wed, 20 Jul 2016 04:21:41 +0000"  >&lt;p&gt;Seems you miss something in the test, I only see you change getTestExpression from private to public. Is that right?&lt;/p&gt;</comment>
                            <comment id="15385309" author="rdblue" created="Wed, 20 Jul 2016 04:40:01 +0000"  >&lt;p&gt;Forgot to add the new test file. I&apos;m attaching a new patch.&lt;/p&gt;</comment>
                            <comment id="15388924" author="daijy" created="Fri, 22 Jul 2016 05:14:57 +0000"  >&lt;p&gt;The import statement in TestNewPartitionFilterPushDown is unnecessary. Also added several more tests.&lt;/p&gt;

&lt;p&gt;Patch committed to trunk. Thanks Ryan!&lt;/p&gt;</comment>
                            <comment id="15389780" author="rdblue" created="Fri, 22 Jul 2016 16:30:05 +0000"  >&lt;p&gt;Thanks for reviewing so quickly!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12984474">PIG-4940</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12818874" name="PIG-4953.1.patch" size="3831" author="rdblue" created="Tue, 19 Jul 2016 18:03:33 +0000"/>
                            <attachment id="12819017" name="PIG-4953.2.patch" size="8938" author="rdblue" created="Wed, 20 Jul 2016 04:40:01 +0000"/>
                            <attachment id="12819557" name="PIG-4953.3.patch" size="9822" author="daijy" created="Fri, 22 Jul 2016 05:14:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 17 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i317iv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>