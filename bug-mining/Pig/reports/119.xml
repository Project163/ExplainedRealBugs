<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:49:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-468] Make BinStorage declare its schema</title>
                <link>https://issues.apache.org/jira/browse/PIG-468</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Currently, BinStorage breaks the rule that unless it tells Pig what types it is producing it should produce bytearrays. This causes runtime problems as the frontend assumes the data to be of one type while in fact it is of different type.&lt;/p&gt;

&lt;p&gt;Loader interface has a way to specify schema via determineSchema API. BinStorage need to implement this. Also, since this interface has not been used before, the pluming might also need to be adjusted.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12405501">PIG-468</key>
            <summary>Make BinStorage declare its schema</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pkamath">Pradeep Kamath</assignee>
                                    <reporter username="olgan">Olga Natkovich</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Sep 2008 23:19:07 +0000</created>
                <updated>Wed, 24 Mar 2010 22:04:11 +0000</updated>
                            <resolved>Tue, 14 Oct 2008 22:27:11 +0000</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12639593" author="pkamath" created="Tue, 14 Oct 2008 21:23:33 +0000"  >&lt;p&gt;Attached patch, some notes on the patch:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;determineSchema() was never being called from LOLoad  since the schemaFile was always passed as null from the parser. I have changed the signature of this method so that implementations of this method can open the input file if they need to, to determine the schema. Here is the new API:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;/**
     * Find the schema from the loader.  This function will be called at parse time
     * (not run time) to see &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the loader can provide a schema &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the data.  The
     * loader may be able to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the data is self describing (e.g. JSON).  If
     * the loader cannot determine the schema, it can &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; a &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;.
     * LoadFunc implementations which need to open the input &lt;span class=&quot;code-quote&quot;&gt;&quot;fileName&quot;&lt;/span&gt;, can use 
     * FileLocalizer.open(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fileName, ExecType execType, DataStorage storage) to get
     * an InputStream which they can use to initialize their loader implementation. They
     * can then use &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; to read the input data to discover the schema. Note: &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; will
     * work only when the fileName represents a file on Local File &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt; or Hadoop file 
     * system
     * @param fileName Name of the file to be read.(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; will be the same as the filename 
     * in the &quot;load statement of the script)
     * @param execType - execution mode of the pig script - one of ExecType.LOCAL or ExecType.MAPREDUCE
     * @param storage - the DataStorage object corresponding to the execType
     * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; a Schema describing the data &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; possible, or &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; otherwise.
     * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException.
     */
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Schema determineSchema(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fileName, ExecType execType, DataStorage storage) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;As noted in the comments above, I have also added a static helper method in FileLocalizer.  LoadFunc implementations which need to open the input &quot;fileName&quot;, can use  FileLocalizer.open(String fileName, ExecType execType, DataStorage storage) to get an InputStream which they can use to initialize their loader implementation. There are some related changes in TypeCastInserter and Schema to handle schema specification in the Load statement. (which would be providing an additional schema in addition to the one determined by determineSchema())&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Reviewers, please also look at  &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-492&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/PIG-492&lt;/a&gt; to make sure that, that are no blockers for that issue - it seems like for that issue we would need to serialize each of the loader&lt;br/&gt;
in the query and send it to the backend which may not be trivial&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12639627" author="olgan" created="Tue, 14 Oct 2008 22:27:11 +0000"  >&lt;p&gt;patch committed; thanks, pradeep&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12392133" name="PIG-468.patch" size="61138" author="pkamath" created="Tue, 14 Oct 2008 21:25:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164081</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 7 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gklr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94768</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>