<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:50:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-1048] inner join using &apos;skewed&apos; produces multiple rows for keys with single row in both input relations</title>
                <link>https://issues.apache.org/jira/browse/PIG-1048</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;${code}&lt;br/&gt;
grunt&amp;gt; cat students.txt                           &lt;br/&gt;
asdfxc  M       23      12.44&lt;br/&gt;
qwer    F       21      14.44&lt;br/&gt;
uhsdf   M       34      12.11&lt;br/&gt;
zxldf   M       21      12.56&lt;br/&gt;
qwer    F       23      145.5&lt;br/&gt;
oiue    M       54      23.33&lt;/p&gt;

&lt;p&gt; l1 = load &apos;students.txt&apos;;            &lt;br/&gt;
l2 = load &apos;students.txt&apos;;                  &lt;br/&gt;
j = join l1 by $0, l2 by $0 ; &lt;br/&gt;
store j into &apos;tmp.txt&apos;             &lt;/p&gt;

&lt;p&gt;grunt&amp;gt; cat tmp.txt&lt;br/&gt;
oiue    M       54      23.33   oiue    M       54      23.33&lt;br/&gt;
oiue    M       54      23.33   oiue    M       54      23.33&lt;br/&gt;
qwer    F       21      14.44   qwer    F       21      14.44&lt;br/&gt;
qwer    F       21      14.44   qwer    F       23      145.5&lt;br/&gt;
qwer    F       23      145.5   qwer    F       21      14.44&lt;br/&gt;
qwer    F       23      145.5   qwer    F       23      145.5&lt;br/&gt;
uhsdf   M       34      12.11   uhsdf   M       34      12.11&lt;br/&gt;
uhsdf   M       34      12.11   uhsdf   M       34      12.11&lt;br/&gt;
zxldf   M       21      12.56   zxldf   M       21      12.56&lt;br/&gt;
zxldf   M       21      12.56   zxldf   M       21      12.56&lt;br/&gt;
asdfxc  M       23      12.44   asdfxc  M       23      12.44&lt;br/&gt;
asdfxc  M       23      12.44   asdfxc  M       23      12.44$&lt;/p&gt;


&lt;p&gt;${code}&lt;/p&gt;</description>
                <environment></environment>
        <key id="12438875">PIG-1048</key>
            <summary>inner join using &apos;skewed&apos; produces multiple rows for keys with single row in both input relations</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sriranjan">Sriranjan Manjunath</assignee>
                                    <reporter username="thejas">Thejas Nair</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Oct 2009 01:12:40 +0000</created>
                <updated>Wed, 24 Mar 2010 22:15:58 +0000</updated>
                            <resolved>Fri, 30 Oct 2009 22:49:58 +0000</resolved>
                                                    <fixVersion>0.6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12770772" author="sriranjan" created="Wed, 28 Oct 2009 03:53:14 +0000"  >&lt;p&gt;The patch solves this issue.&lt;/p&gt;</comment>
                            <comment id="12771203" author="alangates" created="Wed, 28 Oct 2009 23:43:46 +0000"  >&lt;p&gt;Could you describe briefly the cause of the problem and how the one line change fixes it?&lt;/p&gt;</comment>
                            <comment id="12771249" author="hadoopqa" created="Thu, 29 Oct 2009 01:35:55 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12423389/pig_1048.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12423389/pig_1048.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 830757.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/124/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/124/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/124/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/124/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/124/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/124/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12771579" author="sriranjan" created="Thu, 29 Oct 2009 19:55:50 +0000"  >&lt;p&gt;The reason this issue was happening was because for a key with 1 value, we were allocating 2 reducers. The culprit being:&lt;/p&gt;

&lt;p&gt;                        // number of reducers&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Integer cnt = 0;&lt;/li&gt;
	&lt;li&gt;if (minIndex &amp;lt; maxIndex) 
{
-                               cnt = maxIndex - minIndex;
-                       }
&lt;p&gt; else &lt;/p&gt;
{
-                               cnt = totalReducers[0] + maxIndex - minIndex;
-                       }
&lt;p&gt;-&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If maxIndex = minIndex  = 0 and totalReducers was 1, cnt would get a value of 1 instead of 0!&lt;/p&gt;

&lt;p&gt;cnt was based on 0-index whereas, totalReducers was based on 1-index. This resulted in POParitionRearrange distributing the tuple to 1 more than the required amount of reducers.&lt;/p&gt;

&lt;p&gt;The fix is to always set the value of cnt to &quot;maxIndex - minIndex&quot;. The code guarantees that maxIndex is always greater than minIndex.&lt;/p&gt;</comment>
                            <comment id="12771693" author="sriranjan" created="Thu, 29 Oct 2009 23:31:27 +0000"  >&lt;p&gt;I have also modified a skewed join test case to check if atleast one key is present in more than 1 partition instead of checking for all the keys being present in multiple partitions. Since the dataset was too small sampler with the RLR change did not detect these small keys causing the unit test to fail.&lt;/p&gt;</comment>
                            <comment id="12771767" author="sriranjan" created="Fri, 30 Oct 2009 04:20:38 +0000"  >&lt;p&gt;Re-uploaded the same patch. Attaching a new one.&lt;/p&gt;</comment>
                            <comment id="12771807" author="hadoopqa" created="Fri, 30 Oct 2009 05:30:49 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12423641/pig_1048.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12423641/pig_1048.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 831169.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/34/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/34/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/34/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/34/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/34/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/34/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12771878" author="hadoopqa" created="Fri, 30 Oct 2009 08:42:44 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12423658/pig_1048.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12423658/pig_1048.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 831169.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/35/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/35/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/35/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/35/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/35/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/35/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12772148" author="alangates" created="Fri, 30 Oct 2009 22:49:58 +0000"  >&lt;p&gt;Patch checked in.  Thanks Sri for fixing this.&lt;/p&gt;</comment>
                            <comment id="12773333" author="alangates" created="Wed, 4 Nov 2009 01:36:29 +0000"  >&lt;p&gt;When attempting to apply this patch to the 0.5 branch, I got the following error:&lt;/p&gt;

&lt;p&gt;Testcase: testSkewedJoinOneValue took 145.739 sec&lt;br/&gt;
    Caused an ERROR&lt;br/&gt;
Unable to open iterator for alias E&lt;br/&gt;
org.apache.pig.impl.logicalLayer.FrontendException: ERROR 1066: Unable to open iterator for alias E&lt;br/&gt;
    at org.apache.pig.PigServer.openIterator(PigServer.java:475)&lt;br/&gt;
    at org.apache.pig.test.TestSkewedJoin.testSkewedJoinOneValue(TestSkewedJoin.java:340)&lt;br/&gt;
Caused by: org.apache.pig.backend.executionengine.ExecException: ERROR 2997: Unable to recreate exception from backed error: java.lang.RuntimeException: Error in configuring object&lt;br/&gt;
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.Launcher.getErrorMessages(Launcher.java:237)&lt;br/&gt;
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.Launcher.getStats(Launcher.java:181)&lt;br/&gt;
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher.launchPig(MapReduceLauncher.java:209)&lt;br/&gt;
    at org.apache.pig.backend.hadoop.executionengine.HExecutionEngine.execute(HExecutionEngine.java:265)&lt;br/&gt;
    at org.apache.pig.PigServer.executeCompiledLogicalPlan(PigServer.java:773)&lt;br/&gt;
    at org.apache.pig.PigServer.store(PigServer.java:522)&lt;br/&gt;
    at org.apache.pig.PigServer.openIterator(PigServer.java:458)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12423658" name="pig_1048.patch" size="23812" author="sriranjan" created="Fri, 30 Oct 2009 04:24:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164576</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0grcn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95861</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>