<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:52:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-313] Error handling aggregate of a computation</title>
                <link>https://issues.apache.org/jira/browse/PIG-313</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Query which fails:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;a = load &lt;span class=&quot;code-quote&quot;&gt;&apos;:INPATH:/singlefile/studenttab10k&apos;&lt;/span&gt; as (name:chararray, age:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, gpa:&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;);
b = group a by name;
c = foreach b generate group, SUM(a.age*a.gpa);                            
store c into &lt;span class=&quot;code-quote&quot;&gt;&apos;:OUTPATH:&apos;&lt;/span&gt;;\,
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Error output:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;2008-07-14 16:34:08,684 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine - Connecting to hadoop file system at: testhost.com:8020&lt;br/&gt;
2008-07-14 16:34:08,741 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; WARN  org.apache.hadoop.fs.FileSystem - &quot;testhost.com:8020&quot; is a deprecated filesystem name. Use &quot;hdfs://testhost:8020/&quot; instead.&lt;br/&gt;
2008-07-14 16:34:08,995 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine - Connecting to map-reduce job tracker at: testhost.com:50020&lt;br/&gt;
2008-07-14 16:34:09,251 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; WARN  org.apache.hadoop.fs.FileSystem - &quot;testhost.com:8020&quot; is a deprecated filesystem name. Use &quot;hdfs://testhost:8020/&quot; instead.&lt;br/&gt;
2008-07-14 16:34:09,559 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.PigServer - Cannot evaluate output type of Mul/Div Operator&lt;br/&gt;
2008-07-14 16:34:09,559 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.PigServer - Problem resolving LOForEach schema&lt;br/&gt;
2008-07-14 16:34:09,559 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.PigServer - Severe problem found during validation org.apache.pig.impl.plan.PlanValidationException: An unexpected exception caused the validation to stop &lt;br/&gt;
2008-07-14 16:34:09,560 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.Grunt - java.io.IOException: Unable to store for alias: c&lt;br/&gt;
2008-07-14 16:34:09,560 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.Main - java.io.IOException: Unable to store for alias: c&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="12400260">PIG-313</key>
            <summary>Error handling aggregate of a computation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gates">Alan Gates</assignee>
                                    <reporter username="pkamath">Pradeep Kamath</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Jul 2008 00:20:04 +0000</created>
                <updated>Thu, 4 Aug 2011 00:34:48 +0000</updated>
                            <resolved>Mon, 24 Jan 2011 18:45:32 +0000</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12613933" author="pi_song" created="Wed, 16 Jul 2008 12:25:36 +0000"  >&lt;p&gt;I think we have discussed about this before and the conclusion is we don&apos;t support this.&lt;/p&gt;

&lt;p&gt;Consider this query:-&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;b = cogroup a1 by name, a2 by name;
c = foreach b generate group, SUM(a1.age*a2.gpa);                            
store c into &apos;:OUTPATH:&apos;;\,
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will make it difficult for us because a1.age gives a bag and a2.gpa also gives a bag.&lt;br/&gt;
What is the definition of bag multiplied by bag?&lt;/p&gt;</comment>
                            <comment id="12614097" author="pkamath" created="Wed, 16 Jul 2008 20:58:40 +0000"  >&lt;p&gt;Per &lt;a href=&quot;http://wiki.apache.org/pig/PigTypesFunctionalSpec&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.apache.org/pig/PigTypesFunctionalSpec&lt;/a&gt; - in the last section: &quot;Argument Construction for Functions&quot; - it says that the computation will be done the fields per tuple in the group and the computed results will be stored into a bag and then supplied to SUM - Is this not going to be the case in this new Pig types release - if not the wiki should be updated.&lt;/p&gt;</comment>
                            <comment id="12615240" author="pi_song" created="Mon, 21 Jul 2008 13:13:08 +0000"  >&lt;p&gt;That sounds right. Then this is a problem in parser.&lt;/p&gt;</comment>
                            <comment id="12616197" author="pkamath" created="Wed, 23 Jul 2008 18:14:06 +0000"  >&lt;p&gt;Another case of this issue is the following:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;a = load &lt;span class=&quot;code-quote&quot;&gt;&apos;singlefile/studenttab10k&apos;&lt;/span&gt; as (name, age, gpa);
b = group a ALL;
c = foreach b generate SUM((&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)(a.age)), MIN((&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)(a.age)), MAX((&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)(a.age)), AVG((&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)(a.age)), MIN((chararray)(a.name)), MAX((chararray)(a.name)), SUM((&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)(a.gpa)), MIN((&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)(a.gpa)), MAX((&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)(a.gpa)), AVG((&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)(a.gpa));
store c into &lt;span class=&quot;code-quote&quot;&gt;&apos;outdir&apos;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In this case, the cast fails since it is trying to cast a bag of bytearray to int. However it should really cast each bytearray to int and then supply the bag of ints to SUM() etc.&lt;/p&gt;</comment>
                            <comment id="12628523" author="olgan" created="Thu, 4 Sep 2008 23:39:02 +0000"  >&lt;p&gt;Pi is correct - we do not support this right now. One idea we considered for future work is to define + operator on bags to match SQL semantics. Other approaches are also possible.&lt;/p&gt;</comment>
                            <comment id="12980917" author="daijy" created="Wed, 12 Jan 2011 20:50:54 +0000"  >&lt;p&gt;Run it on trunk, I get a meaningful error message in the front end:&lt;br/&gt;
ERROR 1039: In alias c, incompatible types in Multiplication Operator left hand side:bag right hand side:bag&lt;/p&gt;

&lt;p&gt;Attach a test case to make sure after new TypeChecker, this error message is still there.&lt;/p&gt;</comment>
                            <comment id="12981987" author="rding" created="Sat, 15 Jan 2011 00:25:41 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12985891" author="daijy" created="Mon, 24 Jan 2011 18:45:32 +0000"  >&lt;p&gt;Review notes:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/276/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/276/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Patch committed to trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12468163" name="PIG-313-1.patch" size="1059" author="daijy" created="Wed, 12 Jan 2011 20:50:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66260</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 44 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0giov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94458</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>