<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:02:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-4974] A simple map reference fail to cast</title>
                <link>https://issues.apache.org/jira/browse/PIG-4974</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;A = load &lt;span class=&quot;code-quote&quot;&gt;&apos;input.txt&apos;&lt;/span&gt; as (m:[bytearray]);
B = FOREACH A GENERATE m#&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt; as a, m#&lt;span class=&quot;code-quote&quot;&gt;&apos;e&apos;&lt;/span&gt; as e;
C = FILTER B by a != &lt;span class=&quot;code-quote&quot;&gt;&apos;abc&apos;&lt;/span&gt; and e != &lt;span class=&quot;code-quote&quot;&gt;&apos;abc&apos;&lt;/span&gt;;
store C into &lt;span class=&quot;code-quote&quot;&gt;&apos;output&apos;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This fails with &lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;Caused by: org.apache.pig.backend.executionengine.ExecException: ERROR 1075: Received a bytearray from the UDF or Union from two different Loaders. Cannot determine how to convert the bytearray to string&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13001832">PIG-4974</key>
            <summary>A simple map reference fail to cast</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knoguchi">Koji Noguchi</assignee>
                                    <reporter username="knoguchi">Koji Noguchi</reporter>
                        <labels>
                    </labels>
                <created>Wed, 31 Aug 2016 21:43:00 +0000</created>
                <updated>Thu, 8 Sep 2016 19:42:28 +0000</updated>
                            <resolved>Thu, 8 Sep 2016 19:42:28 +0000</resolved>
                                                    <fixVersion>0.16.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15453467" author="knoguchi" created="Wed, 31 Aug 2016 21:47:13 +0000"  >&lt;p&gt;Looking at the logicalplan &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    |---B: (Name: LOForEach Schema: a#2:bytearray,e#16:bytearray)
        |   |
        |   (Name: LOGenerate[&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;] Schema: a#2:bytearray,e#16:bytearray)ColumnPrune:OutputUids=[16, 2]ColumnPrune:InputUids=[1]
        |   |   |
        |   |   (Name: Map Type: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; Uid: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; Key: a)
        |   |   |
        |   |   |---m:(Name: Project Type: map Uid: 1 Input: 0 Column: (*))
        |   |   |
        |   |   (Name: UserFunc(org.apache.pig.impl.builtin.IdentityColumn) Type: bytearray Uid: 16)
        |   |   |
        |   |   |---(Name: Map Type: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; Uid: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; Key: e)
        |   |       |
        |   |       |---m:(Name: Project Type: map Uid: 1 Input: 1 Column: (*))
        |   |
        |   |---(Name: LOInnerLoad[0] Schema: m#1:map(#25:bytearray))
        |   |
        |   |---(Name: LOInnerLoad[0] Schema: m#1:map(#25:bytearray))
        |
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;this seems to be coming from the implicit &lt;tt&gt;org.apache.pig.impl.builtin.IdentityColumn&lt;/tt&gt; that is inserted for avoiding uid overlap.&lt;/p&gt;</comment>
                            <comment id="15453501" author="knoguchi" created="Wed, 31 Aug 2016 22:01:35 +0000"  >&lt;p&gt;From simple to complex, I can think of a couple of ways of fixing this.&lt;/p&gt;

&lt;p&gt;(1) Take IdentityColumn UDF as a special case and forward loadcaster  from the argument.   Attaching a patch for this (pig-4974-type1-v01.patch).&lt;/p&gt;

&lt;p&gt;(2) Extend (1)  and include any UDF that returns true for &lt;tt&gt;forwardLoadCaster&lt;/tt&gt; boolean method.  This may help for udf like MapToBag discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3938&quot; title=&quot;Add LoadCaster to EvalFunc(UDF) &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3938&quot;&gt;&lt;del&gt;PIG-3938&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;(3) Extend (2) to allow udf to specify its own loadcaster. &lt;/p&gt;

&lt;p&gt;I don&apos;t want to go to (3) for now.  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;daijy&lt;/a&gt;, let me know your thoughts on this.&lt;/p&gt;</comment>
                            <comment id="15454570" author="daijy" created="Thu, 1 Sep 2016 07:10:44 +0000"  >&lt;p&gt;+1 for (1) for this issue. We can do it later but we need (3) as long term solution.&lt;/p&gt;</comment>
                            <comment id="15474741" author="rohini" created="Thu, 8 Sep 2016 19:13:15 +0000"  >&lt;p&gt;+1.  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knoguchi&quot; class=&quot;user-hover&quot; rel=&quot;knoguchi&quot;&gt;knoguchi&lt;/a&gt; can we commit this? (3)  can be pursued later as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3938&quot; title=&quot;Add LoadCaster to EvalFunc(UDF) &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3938&quot;&gt;&lt;del&gt;PIG-3938&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15474772" author="knoguchi" created="Thu, 8 Sep 2016 19:25:51 +0000"  >&lt;p&gt;Sure.  I&apos;ll commit to 0.16 branch and trunk in a minute.&lt;/p&gt;</comment>
                            <comment id="15474808" author="knoguchi" created="Thu, 8 Sep 2016 19:42:28 +0000"  >&lt;p&gt;Committed to 0.16 branch and trunk.&lt;/p&gt;

&lt;p&gt;Thanks for the review Daniel, Rohini! &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12714457">PIG-3938</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12826504" name="pig-4974-type1-v01.patch" size="3984" author="knoguchi" created="Wed, 31 Aug 2016 22:01:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 10 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i333hj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>