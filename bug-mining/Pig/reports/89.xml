<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:48:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-442] Disambiguated alias after a foreach flatten is not accessible a couple of statements after the foreach</title>
                <link>https://issues.apache.org/jira/browse/PIG-442</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;In statements following a foreach which flattens its cogrouped inputs, unambiguous column names are not accessible via the :: specifier. A reproducible case is given below:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;grunt&amp;gt; a = load &lt;span class=&quot;code-quote&quot;&gt;&apos;one&apos;&lt;/span&gt; as (name, age, gpa);
grunt&amp;gt; b = load &lt;span class=&quot;code-quote&quot;&gt;&apos;two&apos;&lt;/span&gt; as (name, age, height);
grunt&amp;gt; c = cogroup a by name, b by name;
grunt&amp;gt; d = foreach c generate flatten(a), flatten(b);
grunt&amp;gt; e = group d by height;
grunt&amp;gt; f = foreach e generate group, COUNT(d.a::height);
114501 [main] ERROR org.apache.pig.tools.grunt.GruntParser  - java.io.IOException: Invalid alias: a::height in {a::name: bytearray,a::age: bytearray,gpa: bytearray,b::name: bytearray,b::age: bytearray,height: bytearray}
        at org.apache.pig.PigServer.parseQuery(PigServer.java:293)
        at org.apache.pig.PigServer.registerQuery(PigServer.java:258)
        at org.apache.pig.tools.grunt.GruntParser.processPig(GruntParser.java:432)
        at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:242)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12404801">PIG-442</key>
            <summary>Disambiguated alias after a foreach flatten is not accessible a couple of statements after the foreach</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="sms">Santhosh Muthur Srinivasan</assignee>
                                    <reporter username="sms">Santhosh Muthur Srinivasan</reporter>
                        <labels>
                    </labels>
                <created>Sat, 20 Sep 2008 18:42:06 +0000</created>
                <updated>Wed, 24 Mar 2010 22:04:10 +0000</updated>
                            <resolved>Mon, 22 Sep 2008 17:50:51 +0000</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12632999" author="sms" created="Sat, 20 Sep 2008 18:45:24 +0000"  >&lt;p&gt;Attached patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-442&quot; title=&quot;Disambiguated alias after a foreach flatten is not accessible a couple of statements after the foreach&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-442&quot;&gt;&lt;del&gt;PIG-442&lt;/del&gt;&lt;/a&gt;.patch) fixes the following issue:&lt;/p&gt;

&lt;p&gt;1. Use of unambiguous column names with the :: specifier is allowed in statements that follow the foreach flatten statements&lt;br/&gt;
2. It rolls back the fix in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-436&quot; title=&quot;When a single column is flattened, the alias is lost in subsequent statements that refer to the alias&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-436&quot;&gt;&lt;del&gt;PIG-436&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The following unit test case still fails:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Running org.apache.pig.test.TestEvalPipeline&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 11, Failures: 1, Errors: 0, Time elapsed: 218.337 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Test org.apache.pig.test.TestEvalPipeline FAILED&lt;/p&gt;</comment>
                            <comment id="12633026" author="olgan" created="Sun, 21 Sep 2008 00:27:19 +0000"  >&lt;p&gt;Santhosh, do we have unit tests for both 442 and 436?&lt;/p&gt;</comment>
                            <comment id="12633027" author="sms" created="Sun, 21 Sep 2008 00:32:40 +0000"  >&lt;p&gt;Yes, we do. Since &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-442&quot; title=&quot;Disambiguated alias after a foreach flatten is not accessible a couple of statements after the foreach&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-442&quot;&gt;&lt;del&gt;PIG-442&lt;/del&gt;&lt;/a&gt; is rolling back &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-436&quot; title=&quot;When a single column is flattened, the alias is lost in subsequent statements that refer to the alias&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-436&quot;&gt;&lt;del&gt;PIG-436&lt;/del&gt;&lt;/a&gt;, I had to change the unit test cases for &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-436&quot; title=&quot;When a single column is flattened, the alias is lost in subsequent statements that refer to the alias&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-436&quot;&gt;&lt;del&gt;PIG-436&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12633032" author="olgan" created="Sun, 21 Sep 2008 01:07:05 +0000"  >&lt;p&gt;I see one failure in TestLogicalPlanBuilder&lt;/p&gt;</comment>
                            <comment id="12633035" author="sms" created="Sun, 21 Sep 2008 01:24:25 +0000"  >&lt;p&gt;Which test case is it? I did a fresh checkout and applied the patch. All test cases for TestLogicalPlanBuilder pass&lt;/p&gt;</comment>
                            <comment id="12633036" author="olgan" created="Sun, 21 Sep 2008 01:27:13 +0000"  >&lt;p&gt;First one. I see the following error in the log:&lt;/p&gt;

&lt;p&gt;------------- Standard Error -----------------&lt;br/&gt;
Printing the logical plan&lt;br/&gt;
Store Test-Plan-Builder-95 Schema: null Type: Unknown&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;---Load Test-Plan-Builder-94 Schema: null Type: bag&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;



&lt;p&gt;08/09/21 00:46:55 ERROR test.TestLogicalPlanBuilder: org.apache.pig.impl.logicalLayer.parser.ParseException: Unrecognized alias A&lt;br/&gt;
08/09/21 00:46:55 ERROR test.TestLogicalPlanBuilder: org.apache.pig.impl.logicalLayer.parser.ParseException: Encountered &quot;group&quot; at line 1, column 9.&lt;br/&gt;
Was expecting one of:&lt;br/&gt;
    &amp;lt;IDENTIFIER&amp;gt; ...&lt;br/&gt;
    &quot;(&quot; ...&lt;/p&gt;

&lt;p&gt;08/09/21 00:46:55 ERROR test.TestLogicalPlanBuilder: org.apache.pig.impl.logicalLayer.parser.ParseException: Encountered &quot;generate&quot; at line 1, column 1.&lt;br/&gt;
Was expecting one of:&lt;br/&gt;
    &quot;define&quot; ...&lt;br/&gt;
    &quot;load&quot; ...&lt;br/&gt;
    &quot;filter&quot; ...&lt;br/&gt;
    &quot;foreach&quot; ...&lt;br/&gt;
    &quot;order&quot; ...&lt;br/&gt;
    &quot;distinct&quot; ...&lt;br/&gt;
    &quot;cogroup&quot; ...&lt;br/&gt;
    &quot;join&quot; ...&lt;br/&gt;
    &quot;cross&quot; ...&lt;br/&gt;
    &quot;union&quot; ...&lt;br/&gt;
    &quot;split&quot; ...&lt;br/&gt;
    &quot;group&quot; ...&lt;br/&gt;
    &quot;stream&quot; ...&lt;br/&gt;
    &quot;store&quot; ...&lt;br/&gt;
    &quot;limit&quot; ...&lt;br/&gt;
    &amp;lt;IDENTIFIER&amp;gt; ...&lt;br/&gt;
    &quot;(&quot; ...&lt;/p&gt;
</comment>
                            <comment id="12633039" author="sms" created="Sun, 21 Sep 2008 02:18:12 +0000"  >&lt;p&gt;Thats one of the negative test cases that checks if a Parser error is thrown. It appears in every run.&lt;/p&gt;</comment>
                            <comment id="12633076" author="olgan" created="Sun, 21 Sep 2008 16:27:56 +0000"  >&lt;p&gt;Sorry, must be this one then: Testcase: testQueryFail94 took 0.004 sec&lt;br/&gt;
    FAILED&lt;br/&gt;
null&lt;br/&gt;
junit.framework.AssertionFailedError: null&lt;br/&gt;
    at org.apache.pig.test.TestLogicalPlanBuilder.testQueryFail94(TestLogicalPlanBuilder.java:1349)&lt;/p&gt;</comment>
                            <comment id="12633372" author="sms" created="Mon, 22 Sep 2008 16:30:10 +0000"  >&lt;p&gt;New patch, &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-442&quot; title=&quot;Disambiguated alias after a foreach flatten is not accessible a couple of statements after the foreach&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-442&quot;&gt;&lt;del&gt;PIG-442&lt;/del&gt;&lt;/a&gt;_1.patch which fixes the failing test case. The keys of the map were not sorted when the error message is printed. The string comparison in the unit test case, had one order and the failing test case had a different order.&lt;/p&gt;</comment>
                            <comment id="12633396" author="olgan" created="Mon, 22 Sep 2008 17:50:51 +0000"  >&lt;p&gt;patch commited. thanks santhosh!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12390580" name="PIG-442.patch" size="7951" author="sms" created="Sat, 20 Sep 2008 18:45:24 +0000"/>
                            <attachment id="12390663" name="PIG-442_1.patch" size="7934" author="sms" created="Mon, 22 Sep 2008 16:30:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164057</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 10 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gka7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94716</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>