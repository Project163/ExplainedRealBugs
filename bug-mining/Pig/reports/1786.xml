<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:01:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-4774] Fix NPE in SUM,AVG,MIN,MAX UDFs for null bag input</title>
                <link>https://issues.apache.org/jira/browse/PIG-4774</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;For UDF backward compatibility issue after POStatus.STATUS_NULL refactory issue, &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4184&quot; title=&quot;UDF backward compatibility issue after POStatus.STATUS_NULL refactory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4184&quot;&gt;&lt;del&gt;PIG-4184&lt;/del&gt;&lt;/a&gt; fixed the udfs to handle null by adding input.get(0) == null check in all the UDFs. UDFs extending AlgebraicMathBase, AVG, MIN, MAX, etc was not fixed.&lt;/p&gt;

&lt;p&gt;Script to reproduce NPE. It is an odd usage doing aggregation after join instead of group by which one user was doing and rewrite moving aggregation after group by fixed the NPE. Might be rare, but there might be other cases where user call those functions with a bag directly without group by which might cause nulls to be passed to it.&lt;/p&gt;

&lt;p&gt;A = LOAD &apos;/tmp/data&apos; as (f1:int, f2:int, f3:int);&lt;br/&gt;
B = LOAD &apos;/tmp/data1&apos; as (f1:int, f2:int, f3:int);&lt;br/&gt;
A1 = GROUP A by f1;&lt;br/&gt;
A2 = FOREACH A1 GENERATE group as f1, $1;&lt;br/&gt;
C = JOIN B by f1 LEFT, A2 by f1;&lt;br/&gt;
D = FOREACH C GENERATE B::f1, (double)SUM(A2::A.f3)/SUM(A2::A.f2);&lt;br/&gt;
STORE D into &apos;/tmp/out&apos;;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12928930">PIG-4774</key>
            <summary>Fix NPE in SUM,AVG,MIN,MAX UDFs for null bag input</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rohini">Rohini Palaniswamy</assignee>
                                    <reporter username="rohini">Rohini Palaniswamy</reporter>
                        <labels>
                    </labels>
                <created>Sun, 10 Jan 2016 01:36:21 +0000</created>
                <updated>Wed, 8 Jun 2016 20:48:19 +0000</updated>
                            <resolved>Mon, 11 Jan 2016 00:19:32 +0000</resolved>
                                                    <fixVersion>0.16.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15090938" author="daijy" created="Sun, 10 Jan 2016 07:35:41 +0000"  >&lt;p&gt;Do you mind adding the script as test case?&lt;/p&gt;</comment>
                            <comment id="15091144" author="rohini" created="Sun, 10 Jan 2016 18:28:49 +0000"  >&lt;p&gt;  Added null check in TestBuiltin.java instead of a script as that covers all the different UDFs.&lt;/p&gt;</comment>
                            <comment id="15091276" author="daijy" created="Sun, 10 Jan 2016 22:30:45 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15091301" author="rohini" created="Mon, 11 Jan 2016 00:19:32 +0000"  >&lt;p&gt;Committed patch to trunk. Thanks for the review Daniel.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12742551">PIG-4184</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12781430" name="PIG-4774-1-withoutwhitespacechanges.patch" size="19314" author="rohini" created="Sun, 10 Jan 2016 01:54:19 +0000"/>
                            <attachment id="12781431" name="PIG-4774-1.patch" size="39760" author="rohini" created="Sun, 10 Jan 2016 01:54:19 +0000"/>
                            <attachment id="12781461" name="PIG-4774-2.patch" size="42361" author="rohini" created="Sun, 10 Jan 2016 18:41:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 45 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2r37r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>