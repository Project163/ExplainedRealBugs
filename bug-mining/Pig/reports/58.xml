<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:48:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-370] dump with split does not work</title>
                <link>https://issues.apache.org/jira/browse/PIG-370</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;The following script doesn&apos;t work:&lt;/p&gt;

&lt;p&gt;A = load &apos;file:/etc/passwd&apos; using PigStorage(&apos;:&apos;);&lt;br/&gt;
split A into A1 if $2&amp;lt;25, A2 if $2&amp;gt;25;&lt;br/&gt;
dump A1;&lt;/p&gt;

&lt;p&gt;The error dump is:&lt;br/&gt;
2008-08-08 17:03:06,888 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; WARN  org.apache.pig.PigServer - bytearray is implicitly casted to integer under LOGreaterThan Operator&lt;br/&gt;
2008-08-08 17:03:06,889 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; WARN  org.apache.pig.PigServer - bytearray is implicitly casted to integer under LOLesserThan Operator&lt;br/&gt;
2008-08-08 17:03:06,970 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.impl.plan.OperatorPlan - Attempt to give operator of type org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POStore multiple inputs.  This operator does not support multiple inputs.&lt;br/&gt;
2008-08-08 17:03:06,973 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.GruntParser - java.io.IOException: Unable to open iterator for alias: A1 &lt;span class=&quot;error&quot;&gt;&amp;#91;Attempt to give operator of type org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POStore multiple inputs.  This operator does not support multiple inputs.&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.pig.backend.local.executionengine.LocalExecutionEngine.execute(LocalExecutionEngine.java:158)&lt;br/&gt;
	at org.apache.pig.PigServer.execute(PigServer.java:519)&lt;br/&gt;
	at org.apache.pig.PigServer.openIterator(PigServer.java:307)&lt;br/&gt;
	at org.apache.pig.tools.grunt.GruntParser.processDump(GruntParser.java:258)&lt;br/&gt;
	at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:175)&lt;br/&gt;
	at org.apache.pig.tools.grunt.GruntParser.parseContOnError(GruntParser.java:92)&lt;br/&gt;
	at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:58)&lt;br/&gt;
	at org.apache.pig.Main.main(Main.java:278)&lt;br/&gt;
Caused by: org.apache.pig.backend.executionengine.ExecException: Attempt to give operator of type org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POStore multiple inputs.  This operator does not support multiple inputs.&lt;br/&gt;
	... 8 more&lt;br/&gt;
Caused by: org.apache.pig.impl.plan.PlanException: Attempt to give operator of type org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POStore multiple inputs.  This operator does not support multiple inputs.&lt;br/&gt;
	at org.apache.pig.impl.plan.OperatorPlan.connect(OperatorPlan.java:169)&lt;br/&gt;
	at org.apache.pig.backend.hadoop.executionengine.physicalLayer.plans.PhysicalPlan.connect(PhysicalPlan.java:81)&lt;br/&gt;
	at org.apache.pig.backend.hadoop.executionengine.physicalLayer.plans.PhysicalPlan.connect(PhysicalPlan.java:1)&lt;br/&gt;
	at org.apache.pig.impl.plan.OperatorPlan.addAsLeaf(OperatorPlan.java:395)&lt;br/&gt;
	at org.apache.pig.backend.local.executionengine.LocalExecutionEngine.execute(LocalExecutionEngine.java:142)&lt;br/&gt;
	... 7 more&lt;/p&gt;

&lt;p&gt;2008-08-08 17:03:06,973 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.GruntParser - Unable to open iterator for alias: A1 &lt;span class=&quot;error&quot;&gt;&amp;#91;Attempt to give operator of type org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POStore multiple inputs.  This operator does not support multiple inputs.&amp;#93;&lt;/span&gt;&lt;br/&gt;
2008-08-08 17:03:06,973 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.GruntParser - java.io.IOException: Unable to open iterator for alias: A1 &lt;span class=&quot;error&quot;&gt;&amp;#91;Attempt to give operator of type org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POStore multiple inputs.  This operator does not support multiple inputs.&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;The issue is that PigServer.OpenIterator doesn&apos;t send the logical plan corresponding to A1 but sends the plan with both splitOutputs. I have a fix for this and will attach it. We have two parallel branches which do nearly the same thing. OpenIterator &amp;amp; Store. However they have individual code paths and we see the same script with a store not raise a plan exception. For now I will just copy some code. But we need to fix this in a better way. Otherwise we will leave some bugs that we fix for store in dump.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12401984">PIG-370</key>
            <summary>dump with split does not work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shravanmn">Shravan Matthur Narayanamurthy</assignee>
                                    <reporter username="shravanmn">Shravan Matthur Narayanamurthy</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Aug 2008 12:05:30 +0000</created>
                <updated>Wed, 24 Mar 2010 22:04:06 +0000</updated>
                            <resolved>Tue, 26 Aug 2008 19:31:00 +0000</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.2.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12620933" author="shravanmn" created="Fri, 8 Aug 2008 13:48:34 +0000"  >&lt;p&gt;Please apply this patch after applying patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-343&quot; title=&quot;Simple script with SPLIT fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-343&quot;&gt;&lt;del&gt;PIG-343&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12624499" author="olgan" created="Thu, 21 Aug 2008 22:24:16 +0000"  >&lt;p&gt;I verified that with this patch the problem with dump goes away. However, if I try and store A2 into a file, I see the following exception:&lt;/p&gt;

&lt;p&gt;08/08/21 15:22:45 ERROR grunt.GruntParser: java.lang.NullPointerException&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.LOSplitOutput.getSchema(LOSplitOutput.java:74)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.LOStore.getSchema(LOStore.java:88)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.parser.QueryParser.Parse(QueryParser.java:418)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.LogicalPlanBuilder.parse(LogicalPlanBuilder.java:60)&lt;br/&gt;
        at org.apache.pig.PigServer.registerQuery(PigServer.java:252)&lt;br/&gt;
        at org.apache.pig.tools.grunt.GruntParser.processPig(GruntParser.java:422)&lt;br/&gt;
        at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:241)&lt;br/&gt;
        at org.apache.pig.tools.grunt.GruntParser.parseContOnError(GruntParser.java:92)&lt;br/&gt;
        at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:58)&lt;br/&gt;
        at org.apache.pig.Main.main(Main.java:278)&lt;/p&gt;

&lt;p&gt;08/08/21 15:22:45 ERROR grunt.GruntParser: &lt;br/&gt;
08/08/21 15:22:45 ERROR grunt.GruntParser: java.lang.NullPointerException&lt;/p&gt;</comment>
                            <comment id="12624817" author="shravanmn" created="Fri, 22 Aug 2008 13:24:33 +0000"  >&lt;p&gt;Fixed the issue of dump and store not working. Two parts:&lt;br/&gt;
1) Fixed the openIterator method to use the store() codepath instead of its own to execute.&lt;br/&gt;
2) Because of some debug calls using getSchema method in LOSplitoutput which used an object without checking for null, there was a NPE. Fixed it to return a null schema if there were no predecessors of LOSplitOutput.&lt;/p&gt;

&lt;p&gt;Also included is a test case to test the various split + dump + registerQuery(Store) + PigServer.store combinations &lt;/p&gt;</comment>
                            <comment id="12625214" author="olgan" created="Sun, 24 Aug 2008 19:09:08 +0000"  >&lt;p&gt;The end-to-end tests that I tried now passing put one of the unit tests started to fail:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 1, Failures: 1, Errors: 0, Time elapsed: 0.006 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Test org.apache.pig.test.TestSplitStore FAILED&lt;/p&gt;</comment>
                            <comment id="12625774" author="shravanmn" created="Tue, 26 Aug 2008 15:53:54 +0000"  >&lt;p&gt;Olga, even this one seems to be working for me. If it does not work for you could you please attach the log?&lt;/p&gt;</comment>
                            <comment id="12625833" author="olgan" created="Tue, 26 Aug 2008 19:31:00 +0000"  >&lt;p&gt;The problem was that the test file was built for new version of junit. Updated the test file and committed the patch.&lt;/p&gt;

&lt;p&gt;thanks shravan&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12388735" name="370-1.patch" size="9573" author="shravanmn" created="Fri, 22 Aug 2008 13:24:33 +0000"/>
                            <attachment id="12387816" name="370.patch" size="1339" author="shravanmn" created="Fri, 8 Aug 2008 13:48:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164004</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 14 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gjen:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94574</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>