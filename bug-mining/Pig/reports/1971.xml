<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:03:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-5310] MergeJoin throwing NullPointer Exception</title>
                <link>https://issues.apache.org/jira/browse/PIG-5310</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Merge join throws NullPointerException if left input&apos;s first key doesn&apos;t exist in right input and if it is smaller than first key of right input.&lt;br/&gt;
For ex&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;left&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;right&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Error we get - &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ERROR 2998: Unhandled internal error. Vertex failed, vertexName=scope-16, vertexId=vertex_1509400259446_0001_1_02, diagnostics=[Task failed, taskId=task_1509400259446_0001_1_02_000000, diagnostics=[TaskAttempt 0 failed, info=[Error: Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task ( failure ) : attempt_1509400259446_0001_1_02_000000_0:java.lang.NullPointerException
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.compareTo(&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.java:1216)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.compareTo(&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.java:52)
	at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POMergeJoin.getNextTuple(POMergeJoin.java:525)
	at org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator.processInput(PhysicalOperator.java:305)
	at org.apache.pig.backend.hadoop.executionengine.tez.plan.&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;.POStoreTez.getNextTuple(POStoreTez.java:123)
	at org.apache.pig.backend.hadoop.executionengine.tez.runtime.PigProcessor.runPipeline(PigProcessor.java:416)
	at org.apache.pig.backend.hadoop.executionengine.tez.runtime.PigProcessor.run(PigProcessor.java:281)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:370)
	at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:73)
	at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:61)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1945)
	at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:61)
	at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:37)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here, the key used in join is an integer. Integer.compareTo(other) method throws null pointer exception if comparison is made against null. &lt;/p&gt;</description>
                <environment></environment>
        <key id="13112144">PIG-5310</key>
            <summary>MergeJoin throwing NullPointer Exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="satishsaley">Satish Saley</assignee>
                                    <reporter username="satishsaley">Satish Saley</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Oct 2017 23:15:10 +0000</created>
                <updated>Mon, 15 Sep 2025 11:29:05 +0000</updated>
                            <resolved>Wed, 29 Nov 2017 19:39:48 +0000</resolved>
                                                    <fixVersion>0.18.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16224830" author="nkollar" created="Mon, 30 Oct 2017 12:37:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=satishsaley&quot; class=&quot;user-hover&quot; rel=&quot;satishsaley&quot;&gt;satishsaley&lt;/a&gt; could you please help me to reproduce this issue? The test case in your patch passes even when I &lt;b&gt;don&apos;t&lt;/b&gt; apply the changes you made on POMergeJoin.java (expecting a failing test case). I tried with &lt;tt&gt;-Dtest.exec.type=spark&lt;/tt&gt;, &lt;tt&gt;-Dtest.exec.type=tez&lt;/tt&gt;, and &lt;tt&gt;-Dtest.exec.type=mr&lt;/tt&gt;, each finished successfully.&lt;/p&gt;</comment>
                            <comment id="16267896" author="satishsaley" created="Tue, 28 Nov 2017 00:58:41 +0000"  >&lt;p&gt;Fixed the test case. &lt;br/&gt;
The test case earlier was not throwing exception without the fix because I was not loading key as integer. By default it was DataByteArray. &lt;/p&gt;</comment>
                            <comment id="16268457" author="nkollar" created="Tue, 28 Nov 2017 09:42:05 +0000"  >&lt;p&gt;Thanks, second patch looks good to me!&lt;/p&gt;</comment>
                            <comment id="16269355" author="rohini" created="Tue, 28 Nov 2017 19:51:18 +0000"  >&lt;p&gt;What happens if the left side had nulls and it is a Left outer join? Will those records be skipped? Can you add a test case for that case.&lt;/p&gt;</comment>
                            <comment id="16269890" author="satishsaley" created="Wed, 29 Nov 2017 01:31:58 +0000"  >&lt;p&gt;I checked the execution plans for Left/Right outer joins using merge, it takes different code path.&lt;/p&gt;</comment>
                            <comment id="16270572" author="szita" created="Wed, 29 Nov 2017 10:45:26 +0000"  >&lt;p&gt;+1 on &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12899518/12899518_PIG-5310-2.patch&quot; title=&quot;PIG-5310-2.patch attached to PIG-5310&quot;&gt;PIG-5310-2.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="16271423" author="rohini" created="Wed, 29 Nov 2017 19:39:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;it takes different code path&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;  Did not realize that outer join is through POMergeCogroup&lt;/p&gt;

&lt;p&gt;+1. Committed to trunk. Thanks for fixing this Satish. Thanks Nandor and Adam for the reviews.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12894424" name="PIG-5310-1.patch" size="3161" author="satishsaley" created="Fri, 27 Oct 2017 20:30:30 +0000"/>
                            <attachment id="12899518" name="PIG-5310-2.patch" size="3246" author="satishsaley" created="Tue, 28 Nov 2017 00:58:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 51 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3lpsn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>