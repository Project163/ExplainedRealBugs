<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:48:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-258] Pig should cleanup output directory of a failed query</title>
                <link>https://issues.apache.org/jira/browse/PIG-258</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Currently, after a failed store, the output directory is left behind and can&apos;t be re-used without manual cleanup&lt;/p&gt;</description>
                <environment></environment>
        <key id="12397705">PIG-258</key>
            <summary>Pig should cleanup output directory of a failed query</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daijy">Daniel Dai</assignee>
                                    <reporter username="olgan">Olga Natkovich</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Jun 2008 18:15:51 +0000</created>
                <updated>Thu, 1 Apr 2010 04:06:07 +0000</updated>
                            <resolved>Thu, 10 Jul 2008 00:08:17 +0000</resolved>
                                                    <fixVersion>0.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12608608" author="daijy" created="Thu, 26 Jun 2008 22:18:30 +0000"  >&lt;p&gt;Currently only one POStore in one physical plan, so if the execution of a physical plan fails, remove the associated output file.&lt;/p&gt;

&lt;p&gt;Here is the plan:&lt;br/&gt;
1. Create an entry deleteOnFail in FileLocalizer&lt;br/&gt;
2. Capture POStore in physical plan. We can put this code in MRCompiler.compile&lt;br/&gt;
3. Clear deteleOnFail before execution of any physical plan&lt;br/&gt;
4. After an unsuccessful execution of a physical plan, remove output file if it exists. Add this in PigServer.execute &lt;/p&gt;

&lt;p&gt;I will create a patch shortly if no problem&lt;/p&gt;</comment>
                            <comment id="12609646" author="daijy" created="Tue, 1 Jul 2008 17:38:34 +0000"  >&lt;p&gt;Attached patch target branches/types&lt;/p&gt;</comment>
                            <comment id="12609752" author="olgan" created="Wed, 2 Jul 2008 00:17:45 +0000"  >&lt;p&gt;Hi Daniel,&lt;/p&gt;

&lt;p&gt;Looks good. I have a couple of questions/comments:&lt;/p&gt;

&lt;p&gt;(1) I don&apos;t think we should through exception if we can&apos;t register the file to delete. We should just log a warning&lt;br/&gt;
(2) Also, if we can&apos;t delete, we should log a warning not an error&lt;br/&gt;
(3) I think you might be double deleting in case of dump. dump stores into temp file which would get cleaned up when we remove temp files. This might be ok if both check for file existance before trying to delete&lt;br/&gt;
(3) What kind of tests did you run?&lt;/p&gt;

&lt;p&gt;I think we need to test the following:&lt;/p&gt;

&lt;p&gt;(1) Pig script with a single successful store&lt;br/&gt;
(2) Pig script with multiple successful stores&lt;br/&gt;
(3) Pig script with one failed store &lt;br/&gt;
(4) Pig script with multiple failures &lt;br/&gt;
(5) Pig script with one successful and one failed store&lt;br/&gt;
(6) Pig script with a single successful dump&lt;br/&gt;
(7) Pig script with a single failed dump&lt;/p&gt;
</comment>
                            <comment id="12612312" author="daijy" created="Wed, 9 Jul 2008 22:47:53 +0000"  >&lt;p&gt;Some changes in the patch:&lt;br/&gt;
1. Use log.warn instead of throw exception/log.error&lt;br/&gt;
2. To prevent double deletion, check if output file is inside temp file list before putting into deleteOnFail&lt;br/&gt;
3. Add new testcase TestDeleteOnFail&lt;/p&gt;</comment>
                            <comment id="12612331" author="olgan" created="Thu, 10 Jul 2008 00:08:17 +0000"  >&lt;p&gt;changies committed into the types branch. Thanks, Daniel for contributing!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12460888">PIG-1347</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12385042" name="clearoutput.patch" size="2855" author="daijy" created="Tue, 1 Jul 2008 17:38:34 +0000"/>
                            <attachment id="12385683" name="clearoutput2.patch" size="12619" author="daijy" created="Wed, 9 Jul 2008 22:47:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>163903</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 20 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gi1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94352</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>