<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:49:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-538] bincond can&apos;t work with flatten bags</title>
                <link>https://issues.apache.org/jira/browse/PIG-538</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;The following script is user with trunk code to simulated outer join not directly supported by pig:&lt;/p&gt;

&lt;p&gt;A = load &apos;/studenttab10k&apos; as (name: chararray, age: int, gpa: float);&lt;br/&gt;
B = load &apos;votertab10k&apos; as (name: chararray, age: int, registration: chararray, donation: float);&lt;br/&gt;
C = cogroup A by name, B by name;&lt;br/&gt;
D = foreach C generate group, (IsEmpty(A) ? &apos;&apos; : flatten(A)), (IsEmpty(B) ? &apos;null&apos; : flatten(B));&lt;/p&gt;

&lt;p&gt;On types branch this gives syntax error and even beyond that not supported since bincond requires that both expressions be of the same type. Santhosh suggested to have  special NULL expression that matches any type. This seems to make sense.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12408787">PIG-538</key>
            <summary>bincond can&apos;t work with flatten bags</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pkamath">Pradeep Kamath</assignee>
                                    <reporter username="olgan">Olga Natkovich</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Nov 2008 00:09:36 +0000</created>
                <updated>Wed, 24 Mar 2010 22:04:13 +0000</updated>
                            <resolved>Wed, 3 Dec 2008 23:15:29 +0000</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12652935" author="pkamath" created="Wed, 3 Dec 2008 19:59:10 +0000"  >&lt;p&gt;The patch has the following changes:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;support a null constant through the &quot;null&quot; keyword&lt;/li&gt;
	&lt;li&gt;allow for picking right overloaded UDF function when input schema has bytearrays and there are many candidate UDFs to pick from&lt;/li&gt;
	&lt;li&gt;fix for a bug in the matching function for picking right overloaded function when the UDF supports input schema with complex types which have null inner schemas&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;1) Support for null constants - For this there are changes in QueryParser.jjt and DataType.java to represent null as a Constant of type bytearray. Besides that, there are changes in TypeCheckingVisitor to handle implicit casting of null constants (which are bytearrays) to the appropriate type in Binconds, AND, OR, ==, !=. Arithmetic operators already cast byearrays to doubles.&lt;/p&gt;

&lt;p&gt;2) The algorithm for picking the right overloaded UDF function is explained in a comment in TypeCheckingVisitor.java pasted here for reference. The changes follow the comment:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;       /**
         * Here is an explanation of the way the matching UDF funcspec will be chosen
         * based on actual types in the input schema.
         * First an &quot;exact&quot; match is tried for each of the fields in the input schema
         * with the corresponding fields in the candidate funcspecs&apos; schemas. 
         * 
         * If exact match fails, then first a check if made if the input schema has any
         * bytearrays in it. 
         * 
         * If there are NO bytearrays in the input schema, then a best fit match is attempted
         * for the different fields. Essential a permissible cast from one type to another
         * is given a &quot;score&quot; based on its position in the &quot;castLookup&quot; table. A final
         * score for a candidate funcspec is deduced as  
         *               SUM(score_of_particular_cast*noOfCastsSoFar). 
         * If no permissible casts are possible, the score for the candidate is -1. Among 
         * the non -1 score candidates, the candidate with the lowest score is chosen. 
         * 
         * If there are bytearrays in the input schema, a modified exact match is tried. In this
         * matching, bytearrays in the input schema are not considered. As a result of
         * ignoring the bytearrays, we could get multiple candidate funcspecs which match
         * &quot;exactly&quot; for the other columns - if this is the case, we notify the user of
         * the ambiguity and error out. Else if all other (non byte array) fields 
         * matched exactly, then we can cast bytearray(s) to the corresponding type(s)
         * in the matched udf schema. If this modified exact match fails, the above best fit 
         * algorithm is attempted by initially coming up with scores and candidate funcSpecs 
         * (with bytearray(s) being ignored in the scoring process). Then a check is 
         * made to ensure that the positions which have bytearrays in the input schema
         * have the same type (for a given position) in the corresponding positions in
         * all the candidate funcSpecs. If this is not the case, it indicates a conflict
         * and the user is notified of the error (because we have more than
         * one choice for the destination type of the cast for the bytearray). If this is the case,
         * the candidate with the lowest score is chosen. 
         */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;3) To allow the matching function to pick a UDF which supports a schema with a complex type which has null inner schema, the schema equality for matching purposes is relaxed for inner schemas of complex types.&lt;/p&gt;</comment>
                            <comment id="12653040" author="olgan" created="Wed, 3 Dec 2008 23:15:29 +0000"  >&lt;p&gt;patch tested and committed. thanks, pradeep&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12395206" name="PIG-538.patch" size="64804" author="pkamath" created="Wed, 3 Dec 2008 20:00:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164137</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 51 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0glfz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94904</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>