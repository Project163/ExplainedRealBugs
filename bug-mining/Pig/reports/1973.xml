<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:03:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-5201] Null handling on FLATTEN</title>
                <link>https://issues.apache.org/jira/browse/PIG-5201</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Sometimes, FLATTEN(null) or FLATTEN(bag-with-null) seem to produce incorrect results.&lt;/p&gt;

&lt;p&gt;Test code/script to follow.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13059808">PIG-5201</key>
            <summary>Null handling on FLATTEN</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knoguchi">Koji Noguchi</assignee>
                                    <reporter username="knoguchi">Koji Noguchi</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Mar 2017 18:12:42 +0000</created>
                <updated>Mon, 15 Sep 2025 11:29:02 +0000</updated>
                            <resolved>Sat, 9 Dec 2017 06:45:19 +0000</resolved>
                                                    <fixVersion>0.18.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15945728" author="knoguchi" created="Tue, 28 Mar 2017 18:56:24 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;test.pig&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;A = load &lt;span class=&quot;code-quote&quot;&gt;&apos;input.txt&apos;&lt;/span&gt; as (a1:bag {(a1_1:chararray, a1_2:chararray)}, a2:bag{(a2_1:chararray, a2_2:chararray)}, a3:chararray);
B = FOREACH A generate flatten(a1), flatten(a2), a3;
DUMP B;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Input&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;a1 &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; a2 &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; a3 &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; {(1,2)} &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 1 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; {(2,3),(3,4)} &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; {(a,b),(c,d)} &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 2 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 3 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; {(e,f)} &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 4 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; {,(7,8)} &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; {(g,h),(i,j)} &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 5 &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;Output&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;(1,2,,1)
(2,3,a,b,2)
(2,3,c,d,2)
(3,4,a,b,2)
(3,4,c,d,2)
(,,3)
(,e,f,4)
(7,8,g,h,5)
(7,8,i,j,5)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Formatting the output in a table&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;a2_1&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; a2_2 &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; a3_1 &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; a3_2 &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; a4 &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 1 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 2 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 1 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 2 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 3 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; a &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; b &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 2 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 2 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 3 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; c &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; d &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 2 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 3 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 4 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; a &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; b &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 2 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 3 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 4 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; c &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; d &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 2 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 3 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; e &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; f &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 4 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 7 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 8 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; g &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; h &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 5 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 7 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 8 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; i &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; j &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 5 &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Using different loader(&lt;tt&gt;mock.Storage&lt;/tt&gt;),  I can also see null and {(g,h),(i,j)} pair creating &lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;a2_1&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; a2_2 &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; a3_1 &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; a3_2 &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; a4 &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; g &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; h &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 5 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; i &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; j &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 5 &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;A couple of quetions.&lt;/p&gt;

&lt;p&gt;(1) What should be the behavior for FLATTEN(null)?   For FLATTEN(empty_bag), we drop them.  Shall we do the same?  (Offline, Rohini said no.)&lt;/p&gt;

&lt;p&gt;(2) What should be the behavior for null record within the bag in FLATTEN(bag-with-null) ?  &lt;/p&gt;

&lt;p&gt;and probably a separate jira, but &lt;br/&gt;
(3) Why is PigStorage not showing the empty item for {,(7,8)} ?&lt;/p&gt;</comment>
                            <comment id="15945770" author="knoguchi" created="Tue, 28 Mar 2017 19:22:38 +0000"  >&lt;p&gt;Attaching a unit test I&apos;m using for testing FLATTEN(null) and FLATTEN(bag-with-null). &lt;/p&gt;

&lt;p&gt;Please ignore the expected results part.  For that, I&apos;m waiting for feedback from others like &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rohini&quot; class=&quot;user-hover&quot; rel=&quot;rohini&quot;&gt;rohini&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;daijy&lt;/a&gt;, etc.&lt;/p&gt;</comment>
                            <comment id="15945813" author="rohini" created="Tue, 28 Mar 2017 19:53:27 +0000"  >&lt;p&gt;In my opinion, FLATTEN(null) or FLATTEN(bagwithnull) should produce nulls based on the number of elements in the schema of the field instead of a single null.&lt;/p&gt;

&lt;p&gt;For eg:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;FLATTEN(null) where the field is a tuple with 3 inner fields, it should produce three nulls&lt;/li&gt;
	&lt;li&gt;FLATTEN(bagwithnull) where the bag contains 3 inner fields, it should produce three nulls. Same as above.&lt;/li&gt;
	&lt;li&gt;FLATTEN(null) where the column is a map, it should produce two nulls (one each for key and value)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;It is tricky when the tuple or bag does not have schema. In that case we can probably retain the current behavior of producing single null and document it.&lt;/p&gt;</comment>
                            <comment id="15947543" author="knoguchi" created="Wed, 29 Mar 2017 17:16:22 +0000"  >&lt;p&gt;Reading my bible (==Programming Pig), &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The record with the empty bag would be swallowed by foreach. There are a couple of reasons for this behavior. One, since Pig may or may not have the schema of the data in the bag, it might have no idea how to fill in nulls for the missing fields. Two, from a mathematical perspective, this is what you would expect. Crossing a set S with the empty set results in the empty set.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;using the same reasonings, one option would be to drop for the cases discussed on this jira?  &lt;/p&gt;</comment>
                            <comment id="15949177" author="knoguchi" created="Thu, 30 Mar 2017 14:33:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;daijy&lt;/a&gt;, appreciate your feedback on this when you have time.&lt;/p&gt;</comment>
                            <comment id="15952064" author="daijy" created="Sat, 1 Apr 2017 06:15:10 +0000"  >&lt;p&gt;This is &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2537&quot; title=&quot;Output from flatten with a null tuple input generating data inconsistent with the schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2537&quot;&gt;&lt;del&gt;PIG-2537&lt;/del&gt;&lt;/a&gt;, this is a bug we shall fix.&lt;/p&gt;</comment>
                            <comment id="15952484" author="knoguchi" created="Sun, 2 Apr 2017 01:20:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;This is &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2537&quot; title=&quot;Output from flatten with a null tuple input generating data inconsistent with the schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2537&quot;&gt;&lt;del&gt;PIG-2537&lt;/del&gt;&lt;/a&gt;, this is a bug we shall fix.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;daijy&lt;/a&gt;.  Question.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2537&quot; title=&quot;Output from flatten with a null tuple input generating data inconsistent with the schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2537&quot;&gt;&lt;del&gt;PIG-2537&lt;/del&gt;&lt;/a&gt; is about null Tuple.  &lt;br/&gt;
I&apos;m not convinced that same should apply to null Bag.  (This is my question (1) above)  &lt;br/&gt;
(There is a separate question of whether runtime system can distinguish null bag to null tuple but let&apos;s put that aside.)&lt;/p&gt;

&lt;p&gt;To me, if Flatten(empty-bag) is defined to drop, FLATTEN(null-bag) should also do the same.&lt;/p&gt;

&lt;p&gt;As for my (2) FLATTEN(Bag-with-null), we probably want to follow whatever we&apos;re going to do in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2537&quot; title=&quot;Output from flatten with a null tuple input generating data inconsistent with the schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2537&quot;&gt;&lt;del&gt;PIG-2537&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15954167" author="daijy" created="Mon, 3 Apr 2017 21:09:51 +0000"  >&lt;p&gt;Thanks for pointing out, yes, &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2537&quot; title=&quot;Output from flatten with a null tuple input generating data inconsistent with the schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2537&quot;&gt;&lt;del&gt;PIG-2537&lt;/del&gt;&lt;/a&gt; is for tuple, for bag, I agree null bag should drop (same as empty bag), bag with null item should generating according to schema (same as &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2537&quot; title=&quot;Output from flatten with a null tuple input generating data inconsistent with the schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2537&quot;&gt;&lt;del&gt;PIG-2537&lt;/del&gt;&lt;/a&gt;), in case no schema, we can generate single null column.&lt;/p&gt;</comment>
                            <comment id="15961366" author="knoguchi" created="Fri, 7 Apr 2017 20:05:42 +0000"  >&lt;p&gt;I have little understanding on the back-end side so this may be off.&lt;br/&gt;
Tried grabbing the number of fields at compile time and using it at runtime when null is passed for flatten.&lt;/p&gt;</comment>
                            <comment id="15964600" author="knoguchi" created="Tue, 11 Apr 2017 16:26:13 +0000"  >&lt;p&gt;Adding one more testcase with column pruning.  I thought I would need to readjust the array but it seems to work as-is probably due to (re-)creating the numFields array in LOGenerate.getSchema call.&lt;/p&gt;</comment>
                            <comment id="15967023" author="rohini" created="Thu, 13 Apr 2017 02:34:57 +0000"  >&lt;blockquote&gt;&lt;p&gt;To me, if Flatten(empty-bag) is defined to drop, FLATTEN(null-bag) should also do the same.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;  I don&apos;t think we should do that as existing scripts will end up losing more records.&lt;/p&gt;</comment>
                            <comment id="15967607" author="knoguchi" created="Thu, 13 Apr 2017 13:52:43 +0000"  >&lt;blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;To me, if Flatten(empty-bag) is defined to drop, FLATTEN(null-bag) should also do the same.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I don&apos;t think we should do that as existing scripts will end up losing more records.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Dropping on FLATTEN(empty-bag) is a documented behavior.&lt;br/&gt;
I don&apos;t see any reasons FLATTEN(null-bag) to behave differently. &lt;/p&gt;

&lt;p&gt;Also, not sure how many users depend on the current &lt;tt&gt;FLATTEN(null) = null&lt;/tt&gt; given it corrupts the output in most cases.  (It incorrectly shifts the fields like described in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2537&quot; title=&quot;Output from flatten with a null tuple input generating data inconsistent with the schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2537&quot;&gt;&lt;del&gt;PIG-2537&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="15977151" author="rohini" created="Thu, 20 Apr 2017 17:58:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;I don&apos;t see any reasons FLATTEN(null-bag) to behave differently.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;   It is hard for me to see empty and null as same. This means dropping a whole record when one of the fields is null. I doubt users would want that. You might want to check with a couple of them to be sure. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Also, not sure how many users depend on the current FLATTEN(null) = null given it corrupts the output in most cases.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;  Most of the users have bags with just one element and this shifting issue is not a problem in those cases. Bag of strings is way more common than a bag of tuples and that is why we have not come across this for a long time.&lt;/p&gt;
</comment>
                            <comment id="15977166" author="knoguchi" created="Thu, 20 Apr 2017 18:07:14 +0000"  >&lt;blockquote&gt;&lt;p&gt;It is hard for me to see empty and null as same.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We defined FLATTEN(empty-bag) to drop since &quot;Crossing a set S with the empty set results in the empty set.&quot;. &lt;br/&gt;
To be consistent, FLATTEN(null-bag) should behave the same.&lt;/p&gt;

&lt;p&gt;Anyways, we can continue the discussion once you&apos;re back next month.  Let&apos;s keep the jira open till then.&lt;/p&gt;</comment>
                            <comment id="16024794" author="knoguchi" created="Thu, 25 May 2017 14:31:21 +0000"  >&lt;p&gt;It&apos;ll be nice if we can fix this for 0.17 since this leads to incorrect outputs (and confusions).&lt;/p&gt;</comment>
                            <comment id="16026559" author="rohini" created="Fri, 26 May 2017 17:42:31 +0000"  >&lt;p&gt;I guess it should be ok to push this to 0.18 as this has been there from the beginning. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;daijy&lt;/a&gt;, thoughts?&lt;/p&gt;</comment>
                            <comment id="16026631" author="daijy" created="Fri, 26 May 2017 18:22:20 +0000"  >&lt;p&gt;It is not a regression, so it is certainly fine to push out. Koji can still try but it should not be a release blocker.&lt;/p&gt;</comment>
                            <comment id="16026646" author="knoguchi" created="Fri, 26 May 2017 18:33:09 +0000"  >&lt;p&gt;I&apos;m ok to push it to 0.18.  But one correction.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Koji can still try but it should not be a release blocker.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Current issue here is more on &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;daijy&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rohini&quot; class=&quot;user-hover&quot; rel=&quot;rohini&quot;&gt;rohini&lt;/a&gt; to agree on what the behavior of flatten(null-bag) should be. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16026657" author="rohini" created="Fri, 26 May 2017 18:39:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;Current issue here is more on Daniel Dai and Rohini Palaniswamy to agree on what the behavior of flatten(null-bag) should be&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. Yes. The time is to sort that out. I am still not sure on this and worried that users might be losing records silently after this change. Have asked &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knoguchi&quot; class=&quot;user-hover&quot; rel=&quot;knoguchi&quot;&gt;knoguchi&lt;/a&gt; to check with couple of internal users who are both Pig and data pipeline experts and will be affected by this.&lt;/p&gt;</comment>
                            <comment id="16026660" author="knoguchi" created="Fri, 26 May 2017 18:42:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;and will be affected by this.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Who &lt;em&gt;may&lt;/em&gt; get affected by this.  &lt;/p&gt;</comment>
                            <comment id="16031913" author="knoguchi" created="Wed, 31 May 2017 20:37:12 +0000"  >&lt;p&gt;Noticed I forgot to take out some debug print/dump statements.  Taking them out and now calling &lt;tt&gt;Util.checkQueryOutputsAfterSort&lt;/tt&gt; for map output comparisons. &lt;/p&gt;</comment>
                            <comment id="16056468" author="knoguchi" created="Tue, 20 Jun 2017 21:10:22 +0000"  >&lt;blockquote&gt;&lt;p&gt;Have asked Koji Noguchi to check with couple of internal users who are both Pig and data pipeline experts and will be affected by this.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;From the users, learned that there&apos;s a common pattern users use which can easily break when FLATTEN(null-bag) start dropping records as I proposed... &lt;/p&gt;

&lt;p&gt;Basically their code looks like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
C = FOREACH B GENERATE record_type, FLATTEN(type_a_bag), FLATTEN(type_b_bag); 
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When record_type is &apos;a&apos;, type_b_bag is null, and vice-versa. &lt;br/&gt;
Instead of checking the record_type up-front, user simply flatten both and later examine the record_type.&lt;/p&gt;

&lt;p&gt;I hate inconsistency and I hate being wrong (and Rohini being right), but it looks like I would have to keep the current behavior of FLATTEN(null-bag) &lt;em&gt;not&lt;/em&gt; dropping.  &lt;/p&gt;</comment>
                            <comment id="16120468" author="knoguchi" created="Wed, 9 Aug 2017 18:58:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;daijy&lt;/a&gt;, as I wrote above, are you ok with FLATTEN(null-bag) not dropping ?  &lt;br/&gt;
(e.g. if this bag has schema, then FLATTEN(null) be expanded to multiple nulls to match the number of fields)&lt;/p&gt;</comment>
                            <comment id="16120551" author="daijy" created="Wed, 9 Aug 2017 19:51:49 +0000"  >&lt;p&gt;It is equivalent to flatten a scalar. That&apos;s sounds fine. How about columns? Shall we produce the same number of nulls columns according to schema? It might be the same as &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2537&quot; title=&quot;Output from flatten with a null tuple input generating data inconsistent with the schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2537&quot;&gt;&lt;del&gt;PIG-2537&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16120561" author="knoguchi" created="Wed, 9 Aug 2017 19:59:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;Shall we produce the same number of nulls columns according to schema?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, we should.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;It might be the same as &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2537&quot; title=&quot;Output from flatten with a null tuple input generating data inconsistent with the schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2537&quot;&gt;&lt;del&gt;PIG-2537&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Could be, but I don&apos;t think we can fix at Utf8StorageConverter loadcaster level.&lt;/p&gt;</comment>
                            <comment id="16121076" author="daijy" created="Thu, 10 Aug 2017 05:26:20 +0000"  >&lt;p&gt;What&apos;s your idea for the column padding?&lt;/p&gt;</comment>
                            <comment id="16122081" author="knoguchi" created="Thu, 10 Aug 2017 18:43:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;What&apos;s your idea for the column padding?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I don&apos;t remember much on what I tried on this jira but my patch seems like it&apos;s trying to pad null inside POForeach when flatten is called.  Utf8StorageConverter is just one type of loadcaster, so we cannot assume all the data use this loadcaster.  At least not for fixing a data correctness issue like this one.&lt;/p&gt;</comment>
                            <comment id="16173471" author="knoguchi" created="Wed, 20 Sep 2017 16:40:21 +0000"  >&lt;p&gt;Uploading a patch that now expands FLATTEN(null-bag) to null * num_fields and FLATTEN(null-map) to 2 fields.  &lt;/p&gt;

&lt;p&gt;I still need to look at &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2537&quot; title=&quot;Output from flatten with a null tuple input generating data inconsistent with the schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2537&quot;&gt;&lt;del&gt;PIG-2537&lt;/del&gt;&lt;/a&gt; and its patch to understand Daniel&apos;s approach.&lt;/p&gt;</comment>
                            <comment id="16220800" author="rohini" created="Thu, 26 Oct 2017 17:08:27 +0000"  >&lt;p&gt;Comments:&lt;br/&gt;
1) Can we rename flattenNumFieldsForNull to flattenNumFields? Naming it based on the purpose will make it odd when it is reused for something else.&lt;br/&gt;
2) POForeach clone should copy flattenNumFieldsForNull&lt;br/&gt;
3) isToBeFlattenedArray[ i ] is checked in 3 if statements. Can we create a outer block with that condition to simplify?&lt;br/&gt;
4) TestFlatten.java - license is modified. Unintended change?&lt;br/&gt;
6)  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;KOJIKOJI&quot;&lt;/span&gt;);
152	        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;( Tuple t : actualResults ) {
153	            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(t);
154	        }

        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;KOJIKOJI2&quot;&lt;/span&gt;);
167	        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;( Tuple t : expectedResults ) {
168	            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(t);
169	        }
170	
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;7) testFlattenOnNullBagWithColumnPrune is redundant. ColumPrune does not affect Flatten. Currently we don&#8217;t column prune nested data structures - tuple, bag (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1324&quot; title=&quot;Logical Optimizer: Nested column pruning&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1324&quot;&gt;PIG-1324&lt;/a&gt;). We can remove this test or merge it into one of the other tests considering our unit test run time is already too high. &lt;/p&gt;</comment>
                            <comment id="16223218" author="knoguchi" created="Sat, 28 Oct 2017 04:07:43 +0000"  >&lt;p&gt;Thanks for the review Rohini! &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;1) Can we rename flattenNumFieldsForNull to flattenNumFields? &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Done.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;2) POForeach clone should copy flattenNumFieldsForNull&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Completely missed that. Done.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;3) isToBeFlattenedArray[ i ] is checked in 3 if statements. Can we create a outer block with that condition to simplify?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Took a look but I&apos;m already afraid of introducing a regression with this current change.  Prefer not to touch other places if not necessary. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;4) TestFlatten.java - license is modified. Unintended change?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Ouch. Fixed.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;System.err.println(&quot;KOJIKOJI&quot;);&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Another ouch. Wiped. &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;7) testFlattenOnNullBagWithColumnPrune is redundant. ColumPrune does not affect Flatten. Currently we don&#8217;t column prune nested data structures - tuple, bag (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1324&quot; title=&quot;Logical Optimizer: Nested column pruning&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1324&quot;&gt;PIG-1324&lt;/a&gt;). &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Actually this was testing what would happen when a simple field is pruned. In the test with schema &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;(a0:int, bag1:bag {(a1_1:int, a1_2:chararray)}, bag2:bag{(a2_1:chararray, a2_2:chararray)})
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;this test is pruning a0:int and checking if &lt;tt&gt;flattenNumFields&lt;/tt&gt; needs to be shifted.&lt;/p&gt;

&lt;p&gt;Lastly, I added a document for this new behavior.&lt;/p&gt;</comment>
                            <comment id="16225411" author="rohini" created="Mon, 30 Oct 2017 17:48:00 +0000"  >&lt;p&gt;1) &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Took a look but I&apos;m already afraid of introducing a regression with this current change. Prefer not to touch other places if not necessary.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;  It should be a simple change. Don&apos;t see any cause for concern of regression. I am asking this because, currently isToBeFlattenedArray is being checked three times before going to the case of not FLATTEN while it should be done only once. This is very inefficient as the number of flatten compared to fields without flatten in a foreach statement is very less. Also there are many users with 100+ columns in a foreach statement and it will be bad for those cases.&lt;/p&gt;

&lt;p&gt;2) Doc minor issues&lt;br/&gt;
 some null Tuples -&amp;gt; some null tuples&lt;br/&gt;
Flatten operataor -&amp;gt; FLATTEN operator  (capitalize + typo in operator)&lt;/p&gt;

</comment>
                            <comment id="16234776" author="knoguchi" created="Wed, 1 Nov 2017 21:31:36 +0000"  >&lt;blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Took a look but I&apos;m already afraid of introducing a regression with this current change. Prefer not to touch other places if not necessary.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;It should be a simple change.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Ok,  Tried to add this change in POForEach.createTuple method.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;2) Doc minor issues&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Forgot to run a spell checker. Thanks.&lt;/p&gt;</comment>
                            <comment id="16234785" author="rohini" created="Wed, 1 Nov 2017 21:39:54 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="16239417" author="knoguchi" created="Sun, 5 Nov 2017 06:12:19 +0000"  >&lt;p&gt;With &lt;tt&gt;pig-5201-v06.patch&lt;/tt&gt;, saw a couple of unit test failures.&lt;br/&gt;
Turns out the change I made in test/Util.java was causing it.&lt;/p&gt;

&lt;p&gt;My change was meant to help show the exact output difference when comparisons fail, but &lt;tt&gt;checkQueryOutputs&lt;/tt&gt; was calling toString and was incorrectly failing when comparing two bags with different tuple orders.   (Bag is order-independent, so comparing two bags with different order should still match.)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git test/org/apache/pig/test/Util.java test/org/apache/pig/test/Util.java
index 8d4282dfb..f2cec4529 100644
--- test/org/apache/pig/test/Util.java
+++ test/org/apache/pig/test/Util.java
@@ -613,8 +613,7 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Util {
          Collections.sort(actualResList);
          Collections.sort(expectedResList);

-         Assert.assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;Comparing actual and expected results. &quot;&lt;/span&gt;,
-                 expectedResList, actualResList);
+         checkQueryOutputs(actualResList.iterator(), expectedResList);

     }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Attaching a new patch &lt;tt&gt;pig-5201-v07.patch&lt;/tt&gt; with change to &lt;tt&gt;test/Util.java&lt;/tt&gt; reverted. &lt;/p&gt;</comment>
                            <comment id="16240266" author="rohini" created="Mon, 6 Nov 2017 13:11:55 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="16263380" author="knoguchi" created="Wed, 22 Nov 2017 21:34:48 +0000"  >&lt;p&gt;Sorry for taking this long to commit.&lt;br/&gt;
Two more issues.&lt;/p&gt;

&lt;p&gt;(a) My last patch has one test failure from the test I added at &lt;br/&gt;
&lt;tt&gt;org.apache.pig.test.TestFlatten.testFlattenOnNullMap&lt;/tt&gt; &lt;/p&gt;

&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;Comparing actual and expected results.  &lt;br/&gt;
expected: java.util.ArrayList&amp;lt;[(,,11,12), (,,13,14), (a,b,1,2), (a,b,3,4), (c,d,1,2), (c,d,3,4), (k,l,,), (m,n,,)]&amp;gt; &lt;br/&gt;
but was: java.util.ArrayList&amp;lt;[(,,11,12), (,,13,14), (a,b,1,2), (a,b,3,4), (c,d,1,2), (c,d,3,4), (k,l,,), (m,n,,)]&amp;gt;&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Above error message is showing identical strings but it&apos;s actually failing since &lt;tt&gt;Util.checkQueryOutputs&lt;/tt&gt; only compares the string representation but &lt;tt&gt;Util.checkQueryOutputsAfterSort&lt;/tt&gt; actually compares Object to Object and is more strict.  Above test is failing since one has null and another has empty string.&lt;/p&gt;

&lt;p&gt;This patch fixed the test case so that it correctly passes &quot;null&quot; instead of empty &quot;&quot; as the expected outputs.&lt;/p&gt;

&lt;p&gt;We can go one step further and make checkQueryOutputs and checkQueryOutputsAfterSort consistent but this requires more changes elsewhere. &lt;/p&gt;

&lt;p&gt;(b) &lt;tt&gt;org.apache.pig.test.TestProjectRange.testRangeOrderByMixNOSchema&lt;/tt&gt; and  &lt;tt&gt;org.apache.pig.test.TestProjectRange.testRangeOrderByStartNOSchema&lt;/tt&gt; fails with my previous patch when comparing with the golden file.    Looking at them, it seems like golden files for these two tests include the serialized class as the output (and my patch did add extra field in POForEach.   For now, replaced the golden files but we may want to see if we can get rid of that serialized output line.&lt;/p&gt;
</comment>
                            <comment id="16263391" author="knoguchi" created="Wed, 22 Nov 2017 21:39:35 +0000"  >&lt;blockquote&gt;&lt;p&gt;We can go one step further and make checkQueryOutputs and checkQueryOutputsAfterSort consistent but this requires more changes elsewhere.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Attaching &lt;tt&gt;pig-5201-v09-with-testUtilchange.patch&lt;/tt&gt; which does this but not sure if this just makes the testing more confusing...&lt;br/&gt;
You would now need to consider &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;if number if integer, long or String,&lt;/li&gt;
	&lt;li&gt;if object is actually String or DataByteArray,&lt;/li&gt;
	&lt;li&gt;etc, etc&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16267093" author="rohini" created="Mon, 27 Nov 2017 17:25:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;We can go one step further and make checkQueryOutputs and checkQueryOutputsAfterSort &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This is absolutely better as there will be better data validation and type checking in tests.&lt;/p&gt;

&lt;p&gt;I just have one question. Why do you have to change checkQueryOutputsAfterSort to call checkQueryOutputs? Isn&apos;t that already doing object comparison?&lt;/p&gt;
</comment>
                            <comment id="16268004" author="knoguchi" created="Tue, 28 Nov 2017 02:52:50 +0000"  >&lt;blockquote&gt;&lt;p&gt;Why do you have to change checkQueryOutputsAfterSort to call checkQueryOutputs?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I just liked the way checkQueryOutputs showed only the different part of the outputs instead of showing the entire outputs.  I tried to keep this behavior by adding extra comparisons by toString() before making sure it fails with direct comparisons. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+              &lt;span class=&quot;code-comment&quot;&gt;// If &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; tuple contains any bags, bags will be sorted before comparisons
&lt;/span&gt;+              &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( !expected.equals(actual) ) {
+                  &lt;span class=&quot;code-comment&quot;&gt;// Using string comparisons since error message is more readable
&lt;/span&gt;+                  &lt;span class=&quot;code-comment&quot;&gt;// (only showing the part which differs)
&lt;/span&gt;+                  Assert.assertEquals(expected.toString(), actual.toString());
+                  &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; above goes through, simply failing with object comparisons
&lt;/span&gt;+                  Assert.assertEquals(expected, actual);
+              }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And I didn&apos;t want to write this code twice in both checkQueryOutputs and checkQueryOutputsAfterSort.&lt;/p&gt;</comment>
                            <comment id="16268947" author="rohini" created="Tue, 28 Nov 2017 15:49:55 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="16284635" author="knoguchi" created="Sat, 9 Dec 2017 06:45:19 +0000"  >&lt;p&gt;Thanks for the review Rohini! &lt;br/&gt;
Also, Daniel, thank you for all your feedback. &lt;/p&gt;

&lt;p&gt;Committed the patch to trunk (0.18).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12655204">PIG-3368</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12542920">PIG-2537</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12860913" name="pig-5201-v00-testonly.patch" size="4342" author="knoguchi" created="Tue, 28 Mar 2017 19:22:38 +0000"/>
                            <attachment id="12862524" name="pig-5201-v01.patch" size="19481" author="knoguchi" created="Fri, 7 Apr 2017 20:05:42 +0000"/>
                            <attachment id="12862889" name="pig-5201-v02.patch" size="22459" author="knoguchi" created="Tue, 11 Apr 2017 16:26:13 +0000"/>
                            <attachment id="12870642" name="pig-5201-v03.patch" size="21784" author="knoguchi" created="Wed, 31 May 2017 20:37:12 +0000"/>
                            <attachment id="12888084" name="pig-5201-v04.patch" size="23618" author="knoguchi" created="Wed, 20 Sep 2017 16:38:27 +0000"/>
                            <attachment id="12894514" name="pig-5201-v05.patch" size="25755" author="knoguchi" created="Sat, 28 Oct 2017 03:59:28 +0000"/>
                            <attachment id="12895284" name="pig-5201-v06.patch" size="26389" author="knoguchi" created="Wed, 1 Nov 2017 21:28:41 +0000"/>
                            <attachment id="12896114" name="pig-5201-v07.patch" size="25859" author="knoguchi" created="Sun, 5 Nov 2017 06:04:42 +0000"/>
                            <attachment id="12898943" name="pig-5201-v08.patch" size="66257" author="knoguchi" created="Wed, 22 Nov 2017 21:22:55 +0000"/>
                            <attachment id="12898944" name="pig-5201-v09-with-testUtilchange.patch" size="71784" author="knoguchi" created="Wed, 22 Nov 2017 21:36:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 49 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3cwnj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>