<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:48:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-288] Null pointer exception with load as schema - Optimizer</title>
                <link>https://issues.apache.org/jira/browse/PIG-288</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;A new test case (testNestedPlan) added to TestEvalPipeline has the following query:&lt;/p&gt;

&lt;p&gt;        pig.registerQuery(&quot;A = LOAD &apos;file:&quot; + tmpFile + &quot;&apos;as (a:int, b:int);&quot;);&lt;br/&gt;
        pig.registerQuery(&quot;B = group A by $0;&quot;);&lt;br/&gt;
        + &quot;C1 = filter A by $0 &amp;gt; -1;&quot;&lt;br/&gt;
        + &quot;C2 = distinct C1;&quot;&lt;br/&gt;
        + &quot;C3 = distinct A;&quot;&lt;br/&gt;
        + &quot;generate (int)group;&quot;&lt;br/&gt;
        + &quot;};&quot;;&lt;/p&gt;

&lt;p&gt;Testcase: testNestedPlan took 0.913 sec&lt;br/&gt;
    Caused an ERROR&lt;br/&gt;
Unable to open iterator for alias: C&lt;br/&gt;
java.io.IOException: Unable to open iterator for alias: C&lt;br/&gt;
    at org.apache.pig.impl.util.WrappedIOException.wrap(WrappedIOException.java:34)&lt;br/&gt;
    at org.apache.pig.PigServer.openIterator(PigServer.java:268)&lt;br/&gt;
    at org.apache.pig.test.TestEvalPipeline.testNestedPlan(TestEvalPipeline.java:376)&lt;br/&gt;
Caused by: org.apache.pig.impl.plan.optimizer.OptimizerException: Unable to insert type casts into plan&lt;br/&gt;
    at org.apache.pig.impl.logicalLayer.optimizer.TypeCastInserter.transform(TypeCastInserter.java:144)&lt;br/&gt;
    at org.apache.pig.impl.plan.optimizer.PlanOptimizer.optimize(PlanOptimizer.java:63)&lt;br/&gt;
    at org.apache.pig.PigServer.compileLp(PigServer.java:551)&lt;br/&gt;
    at org.apache.pig.PigServer.execute(PigServer.java:477)&lt;br/&gt;
    at org.apache.pig.PigServer.openIterator(PigServer.java:259)&lt;br/&gt;
    ... 16 more&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
    at org.apache.pig.impl.logicalLayer.LOVisitor.visit(LOVisitor.java:121)&lt;br/&gt;
    at org.apache.pig.impl.logicalLayer.optimizer.SchemaRemover.visit(SchemaRemover.java:65)&lt;br/&gt;
    at org.apache.pig.impl.logicalLayer.LOCogroup.visit(LOCogroup.java:273)&lt;br/&gt;
    at org.apache.pig.impl.logicalLayer.LOCogroup.visit(LOCogroup.java:37)&lt;br/&gt;
    at org.apache.pig.impl.plan.DependencyOrderWalker.walk(DependencyOrderWalker.java:68)&lt;br/&gt;
    at org.apache.pig.impl.plan.PlanVisitor.visit(PlanVisitor.java:51)&lt;br/&gt;
    at org.apache.pig.impl.logicalLayer.optimizer.LogicalTransformer.rebuildSchemas(LogicalTransformer.java:57)&lt;br/&gt;
    at org.apache.pig.impl.logicalLayer.optimizer.TypeCastInserter.transform(TypeCastInserter.java:141)&lt;br/&gt;
    ... 20 more&lt;/p&gt;</description>
                <environment></environment>
        <key id="12399482">PIG-288</key>
            <summary>Null pointer exception with load as schema - Optimizer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pi_song">Pi Song</assignee>
                                    <reporter username="sms">Santhosh Muthur Srinivasan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Jul 2008 21:19:21 +0000</created>
                <updated>Thu, 25 Mar 2010 00:12:40 +0000</updated>
                            <resolved>Tue, 8 Jul 2008 11:58:39 +0000</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.1.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12610231" author="pi_song" created="Thu, 3 Jul 2008 14:02:20 +0000"  >&lt;p&gt;The patch!&lt;/p&gt;

&lt;p&gt;This is due to the fact that LOCOGroup also maintains internal plan relations. The optimizer also has to fix up the downstream operator&apos;s internal.&lt;/p&gt;</comment>
                            <comment id="12610593" author="pi_song" created="Fri, 4 Jul 2008 14:15:57 +0000"  >&lt;p&gt;The similar issue can happen in type checker and plan optimizer (future) as well. In the meantime, this patch should work but we will have to come up with a guaranteed safe way to alter the plan.&lt;/p&gt;

&lt;p&gt;For example, we may have utility methods for removing/inserting nodes in linear subgraph to start with:-&lt;/p&gt;

&lt;p&gt;RemoveNode (a -&amp;gt; b -&amp;gt; c,  b)   --&amp;gt;  (a -&amp;gt; c) &lt;/p&gt;

&lt;p&gt;InsertNode(a -&amp;gt; c, b)   --&amp;gt;   a -&amp;gt; b -&amp;gt; c&lt;/p&gt;</comment>
                            <comment id="12610815" author="pi_song" created="Sun, 6 Jul 2008 13:39:13 +0000"  >&lt;p&gt;Just found out that the thing I mentioned already exists so moved the COGroup fixing logic to the appropriate place.&lt;br/&gt;
The test is still failing though due to problem in JarManager instead now.&lt;/p&gt;</comment>
                            <comment id="12611538" author="pi_song" created="Tue, 8 Jul 2008 11:58:36 +0000"  >&lt;p&gt;Patch checked in. Thanks to myself.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12385207" name="PIG_288_OptimizerNPE.patch" size="4001" author="pi_song" created="Thu, 3 Jul 2008 14:02:20 +0000"/>
                            <attachment id="12385348" name="PIG_288_OptimizerNPE_2.patch" size="3550" author="pi_song" created="Sun, 6 Jul 2008 13:39:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>163930</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 21 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gidz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94409</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>