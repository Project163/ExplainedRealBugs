<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:48:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-373] unconnected load causes exception</title>
                <link>https://issues.apache.org/jira/browse/PIG-373</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Load expects to be connected to another operator and when it is not,an exception is raised. Two scripts that cause this behavior&lt;/p&gt;

&lt;p&gt;grunt&amp;gt; B = load &apos;foo&apos; USING PigStorage() AS (s:chararray);&lt;br/&gt;
grunt&amp;gt; describe B;&lt;/p&gt;

&lt;p&gt;grunt&amp;gt; B = load &apos;foo&apos; USING PigStorage() AS (s:chararray);&lt;br/&gt;
grunt&amp;gt; dump B;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12402234">PIG-373</key>
            <summary>unconnected load causes exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shravanmn">Shravan Matthur Narayanamurthy</assignee>
                                    <reporter username="olgan">Olga Natkovich</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Aug 2008 18:28:58 +0000</created>
                <updated>Wed, 24 Mar 2010 22:04:06 +0000</updated>
                            <resolved>Tue, 26 Aug 2008 18:41:42 +0000</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12621919" author="olgan" created="Tue, 12 Aug 2008 18:32:50 +0000"  >&lt;p&gt;Stack:&lt;/p&gt;

&lt;p&gt;And the error is:&lt;br/&gt;
java.io.IOException: Unable to open iterator for alias: a &lt;span class=&quot;error&quot;&gt;&amp;#91;Unable to insert type casts into plan&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.optimizer.TypeCastInserter.transform(TypeCastInserter.java:144)&lt;br/&gt;
        at org.apache.pig.impl.plan.optimizer.PlanOptimizer.optimize(PlanOptimizer.java:65)&lt;br/&gt;
        at org.apache.pig.PigServer.compileLp(PigServer.java:583)&lt;br/&gt;
        at org.apache.pig.PigServer.execute(PigServer.java:514)&lt;br/&gt;
        at org.apache.pig.PigServer.openIterator(PigServer.java:307)&lt;br/&gt;
        at org.apache.pig.tools.grunt.GruntParser.processDump(GruntParser.java:258)&lt;br/&gt;
        at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:175)&lt;br/&gt;
        at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:82)&lt;br/&gt;
        at org.apache.pig.tools.grunt.Grunt.exec(Grunt.java:64)&lt;br/&gt;
        at org.apache.pig.Main.main(Main.java:302)&lt;br/&gt;
Caused by: org.apache.pig.impl.plan.optimizer.OptimizerException: Unable to insert type casts into plan&lt;br/&gt;
        ... 10 more&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.optimizer.LogicalTransformer.insertAfter(LogicalTransformer.java:203)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.optimizer.TypeCastInserter.transform(TypeCastInserter.java:139)&lt;br/&gt;
        ... 9 more&lt;/p&gt;
</comment>
                            <comment id="12621921" author="pkamath" created="Tue, 12 Aug 2008 18:38:23 +0000"  >&lt;p&gt;Another use case for the same issue:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;grunt&amp;gt; register my.jar                                                               
grunt&amp;gt; a = load &apos;testdata&apos; using MyLoader() as (s:map[], m, l);
grunt&amp;gt; b = foreach a generate s#&apos;name&apos;;
grunt&amp;gt; describe a;
2008-08-12 18:33:45,960 [main] ERROR org.apache.pig.tools.grunt.GruntParser - java.io.IOException: Unable to describe schema for alias a [Unable to insert type casts into plan]
        at org.apache.pig.impl.logicalLayer.optimizer.TypeCastInserter.transform(TypeCastInserter.java:144)
        at org.apache.pig.impl.plan.optimizer.PlanOptimizer.optimize(PlanOptimizer.java:65)
        at org.apache.pig.PigServer.compileLp(PigServer.java:583)
        at org.apache.pig.PigServer.dumpSchema(PigServer.java:281)
        at org.apache.pig.tools.grunt.GruntParser.processDescribe(GruntParser.java:149)
        at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:180)
        at org.apache.pig.tools.grunt.GruntParser.parseContOnError(GruntParser.java:92)
        at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:58)
        at org.apache.pig.Main.main(Main.java:278)
Caused by: org.apache.pig.impl.plan.optimizer.OptimizerException: Unable to insert type casts into plan
        ... 9 more
Caused by: java.lang.NullPointerException
        at org.apache.pig.impl.logicalLayer.optimizer.LogicalTransformer.insertAfter(LogicalTransformer.java:203)
        at org.apache.pig.impl.logicalLayer.optimizer.TypeCastInserter.transform(TypeCastInserter.java:139)
        ... 8 more

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12623063" author="olgan" created="Sat, 16 Aug 2008 00:11:31 +0000"  >&lt;p&gt;Alan suggested that we should not require that load requires that another operator follows it.&lt;/p&gt;</comment>
                            <comment id="12623967" author="shravanmn" created="Wed, 20 Aug 2008 11:54:48 +0000"  >&lt;p&gt;You are right olga. I have a fix for this in the LogicalTransformer. But svn is not working and hence could not submit patch. Will do it once svn is up.&lt;/p&gt;</comment>
                            <comment id="12624319" author="shravanmn" created="Thu, 21 Aug 2008 10:57:11 +0000"  >&lt;p&gt;373.patch attached&lt;/p&gt;</comment>
                            <comment id="12624463" author="olgan" created="Thu, 21 Aug 2008 19:58:10 +0000"  >&lt;p&gt;Shravan, with you patch, load followed by dump works. However, describe still dies with the following stack:&lt;/p&gt;

&lt;p&gt;08/08/21 12:57:58 ERROR grunt.GruntParser: java.io.IOException: Unable to describe schema for alias A &lt;span class=&quot;error&quot;&gt;&amp;#91;Unable to insert type casts into plan&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.optimizer.TypeCastInserter.transform(TypeCastInserter.java:144)&lt;br/&gt;
        at org.apache.pig.impl.plan.optimizer.PlanOptimizer.optimize(PlanOptimizer.java:65)&lt;br/&gt;
        at org.apache.pig.PigServer.compileLp(PigServer.java:587)&lt;br/&gt;
        at org.apache.pig.PigServer.dumpSchema(PigServer.java:284)&lt;br/&gt;
        at org.apache.pig.tools.grunt.GruntParser.processDescribe(GruntParser.java:149)&lt;br/&gt;
        at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:180)&lt;br/&gt;
        at org.apache.pig.tools.grunt.GruntParser.parseContOnError(GruntParser.java:92)&lt;br/&gt;
        at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:58)&lt;br/&gt;
        at org.apache.pig.Main.main(Main.java:278)&lt;br/&gt;
Caused by: org.apache.pig.impl.plan.optimizer.OptimizerException: Unable to insert type casts into plan&lt;br/&gt;
        ... 9 more&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.optimizer.LogicalTransformer.insertAfter(LogicalTransformer.java:212)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.optimizer.TypeCastInserter.transform(TypeCastInserter.java:139)&lt;br/&gt;
        ... 8 more&lt;/p&gt;</comment>
                            <comment id="12624841" author="shravanmn" created="Fri, 22 Aug 2008 14:22:38 +0000"  >&lt;p&gt;In the old patch I did the null check but forgot to break. Fixed that.&lt;/p&gt;</comment>
                            <comment id="12625209" author="olgan" created="Sun, 24 Aug 2008 18:38:41 +0000"  >&lt;p&gt;Shravan, now describe works but dump does not. Do you have a cluster on which you can test both?&lt;/p&gt;</comment>
                            <comment id="12625696" author="shravanmn" created="Tue, 26 Aug 2008 10:33:55 +0000"  >&lt;p&gt;Olga, I tried the patch on the trunk both locally and on a cluster. It seems to work for me. I can see that both describe and dump work just fine.&lt;/p&gt;</comment>
                            <comment id="12625771" author="olgan" created="Tue, 26 Aug 2008 15:32:37 +0000"  >&lt;p&gt;Shravan,&lt;/p&gt;

&lt;p&gt;I just tried again and here is my grunt session:&lt;/p&gt;

&lt;p&gt;grunt&amp;gt; B = load &apos;foo&apos; USING PigStorage() AS (s:chararray);&lt;br/&gt;
grunt&amp;gt; describe B;&lt;/p&gt;
{s: chararray}
&lt;p&gt;grunt&amp;gt; C = load &apos;foo&apos; USING PigStorage() AS (s:chararray);&lt;br/&gt;
grunt&amp;gt; dump C;&lt;br/&gt;
08/08/26 08:32:01 INFO mapReduceLayer.MapReduceLauncher: 0% complete&lt;br/&gt;
08/08/26 08:32:01 ERROR mapReduceLayer.MapReduceLauncher: Map reduce job failed&lt;br/&gt;
08/08/26 08:32:01 ERROR mapReduceLayer.MapReduceLauncher: java.io.IOException: foo does not exist&lt;br/&gt;
        at org.apache.pig.backend.executionengine.PigSlicer.validate(PigSlicer.java:105)&lt;br/&gt;
        at org.apache.pig.impl.io.ValidatingInputFileSpec.validate(ValidatingInputFileSpec.java:59)&lt;br/&gt;
        at org.apache.pig.impl.io.ValidatingInputFileSpec.&amp;lt;init&amp;gt;(ValidatingInputFileSpec.java:44)&lt;br/&gt;
        at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigInputFormat.getSplits(PigInputFormat.java:199)&lt;br/&gt;
        at org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:712)&lt;br/&gt;
        at org.apache.hadoop.mapred.jobcontrol.Job.submit(Job.java:347)&lt;br/&gt;
        at org.apache.hadoop.mapred.jobcontrol.JobControl.startReadyJobs(JobControl.java:247)&lt;br/&gt;
        at org.apache.hadoop.mapred.jobcontrol.JobControl.run(JobControl.java:279)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:595)&lt;/p&gt;

&lt;p&gt;08/08/26 08:32:01 ERROR grunt.GruntParser: java.io.IOException: Unable to open iterator for alias: C &lt;span class=&quot;error&quot;&gt;&amp;#91;Job terminated with anomalous status FAILED&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.pig.PigServer.openIterator(PigServer.java:315)&lt;br/&gt;
        at org.apache.pig.tools.grunt.GruntParser.processDump(GruntParser.java:258)&lt;br/&gt;
        at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:176)&lt;br/&gt;
        at org.apache.pig.tools.grunt.GruntParser.parseContOnError(GruntParser.java:92)&lt;br/&gt;
        at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:58)&lt;br/&gt;
        at org.apache.pig.Main.main(Main.java:278)&lt;br/&gt;
Caused by: java.io.IOException: Job terminated with anomalous status FAILED&lt;br/&gt;
        ... 6 more&lt;/p&gt;</comment>
                            <comment id="12625796" author="shravanmn" created="Tue, 26 Aug 2008 17:27:12 +0000"  >&lt;p&gt;Is the file foo available to your config because its saying that it can&apos;t find the file &apos;foo&apos;.&lt;/p&gt;

&lt;p&gt;Are you using Local mode with hadoop-site.xml?&lt;/p&gt;</comment>
                            <comment id="12625816" author="olgan" created="Tue, 26 Aug 2008 18:29:00 +0000"  >&lt;p&gt;Shravan, my bad . WIll be commiting the patch shortly&lt;/p&gt;</comment>
                            <comment id="12625822" author="olgan" created="Tue, 26 Aug 2008 18:41:42 +0000"  >&lt;p&gt;patch committed . thanks shravan&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12388742" name="373-1.patch" size="809" author="shravanmn" created="Fri, 22 Aug 2008 14:22:38 +0000"/>
                            <attachment id="12388662" name="373.patch" size="1120" author="shravanmn" created="Thu, 21 Aug 2008 10:57:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18572</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 14 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gjfr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94579</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>