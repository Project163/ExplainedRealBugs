<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:49:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-512] Expressions in foreach lead to errors</title>
                <link>https://issues.apache.org/jira/browse/PIG-512</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Use of expressions that use the same sub-expressions in foreach lead to translation errors. This issue is caused due to sharing operators across nested plans. To remedy this issue, logical operators should be cloned and not shared across plans.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;grunt&amp;gt; a = load &lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt; as (x, y, z);
grunt&amp;gt; b = foreach a {
&amp;gt;&amp;gt; exp1 = x + y;
&amp;gt;&amp;gt; exp2 = exp1 + x;
&amp;gt;&amp;gt; generate exp1, exp2;
&amp;gt;&amp;gt; }
grunt&amp;gt; explain b;
2008-10-30 15:38:40,257 [main] WARN  org.apache.pig.PigServer - bytearray is implicitly casted to &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; under LOAdd Operator
2008-10-30 15:38:40,258 [main] WARN  org.apache.pig.PigServer - bytearray is implicitly casted to &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; under LOAdd Operator
2008-10-30 15:38:40,258 [main] WARN  org.apache.pig.PigServer - bytearray is implicitly casted to &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; under LOAdd Operator
Logical Plan:
Store sms-Thu Oct 30 11:27:27 PDT 2008-2609 Schema: {&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;,&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;} Type: Unknown
|
|---ForEach sms-Thu Oct 30 11:27:27 PDT 2008-2605 Schema: {&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;,&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;} Type: bag
    |   |
    |   Add sms-Thu Oct 30 11:27:27 PDT 2008-2600 FieldSchema: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; Type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;
    |   |
    |   |---Cast sms-Thu Oct 30 11:27:27 PDT 2008-2606 FieldSchema: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; Type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;
    |   |   |
    |   |   |---Project sms-Thu Oct 30 11:27:27 PDT 2008-2598 Projections: [0] Overloaded: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; FieldSchema: x: bytearray Type: bytearray
    |   |       Input: Load sms-Thu Oct 30 11:27:27 PDT 2008-2597
    |   |
    |   |---Cast sms-Thu Oct 30 11:27:27 PDT 2008-2607 FieldSchema: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; Type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;
    |       |
    |       |---Project sms-Thu Oct 30 11:27:27 PDT 2008-2599 Projections: [1] Overloaded: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; FieldSchema: y: bytearray Type: bytearray
    |           Input: Load sms-Thu Oct 30 11:27:27 PDT 2008-2597
    |   |
    |   Add sms-Thu Oct 30 11:27:27 PDT 2008-2603 FieldSchema: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; Type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;
    |   |
    |   |---Project sms-Thu Oct 30 11:27:27 PDT 2008-2601 Projections:  [*]  Overloaded: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; FieldSchema: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; Type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;
    |   |   Input: Add sms-Thu Oct 30 11:27:27 PDT 2008-2600|
    |   |   |---Add sms-Thu Oct 30 11:27:27 PDT 2008-2600 FieldSchema: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; Type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;
    |   |       |
    |   |       |---Project sms-Thu Oct 30 11:27:27 PDT 2008-2598 Projections: [0] Overloaded: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; FieldSchema: x: bytearray Type: bytearray
    |   |       |   Input: Load sms-Thu Oct 30 11:27:27 PDT 2008-2597
    |   |       |
    |   |       |---Project sms-Thu Oct 30 11:27:27 PDT 2008-2599 Projections: [1] Overloaded: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; FieldSchema: y: bytearray Type: bytearray
    |   |           Input: Load sms-Thu Oct 30 11:27:27 PDT 2008-2597
    |   |
    |   |---Cast sms-Thu Oct 30 11:27:27 PDT 2008-2608 FieldSchema: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; Type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;
    |       |
    |       |---Project sms-Thu Oct 30 11:27:27 PDT 2008-2602 Projections: [0] Overloaded: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; FieldSchema: x: bytearray Type: bytearray
    |           Input: Load sms-Thu Oct 30 11:27:27 PDT 2008-2597
    |
    |---Load sms-Thu Oct 30 11:27:27 PDT 2008-2597 Schema: {x: bytearray,y: bytearray,z: bytearray} Type: bag

2008-10-30 15:38:40,272 [main] ERROR org.apache.pig.impl.plan.OperatorPlan - Attempt to give &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; of type org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POProject multiple outputs.  This &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; does not support multiple outputs.
2008-10-30 15:38:40,272 [main] ERROR org.apache.pig.backend.hadoop.executionengine.physicalLayer.LogToPhyTranslationVisitor - Invalid physical operators in the physical planAttempt to give &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; of type org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POProject multiple outputs.  This &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; does not support multiple outputs.
2008-10-30 15:38:40,273 [main] ERROR org.apache.pig.tools.grunt.GruntParser - java.io.IOException: Unable to explain alias b [org.apache.pig.impl.plan.VisitorException]
        at org.apache.pig.backend.hadoop.executionengine.HExecutionEngine.compile(HExecutionEngine.java:235)
        at org.apache.pig.PigServer.compilePp(PigServer.java:731)
        at org.apache.pig.PigServer.explain(PigServer.java:495)
        at org.apache.pig.tools.grunt.GruntParser.processExplain(GruntParser.java:155)
        at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:193)
        at org.apache.pig.tools.grunt.GruntParser.parseContOnError(GruntParser.java:94)
        at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:58)
        at org.apache.pig.Main.main(Main.java:282)
Caused by: org.apache.pig.backend.executionengine.ExecException: org.apache.pig.impl.plan.VisitorException
        ... 8 more
Caused by: org.apache.pig.impl.plan.VisitorException
        at org.apache.pig.backend.hadoop.executionengine.physicalLayer.LogToPhyTranslationVisitor.visit(LogToPhyTranslationVisitor.java:324)
        at org.apache.pig.impl.logicalLayer.LOAdd.visit(LOAdd.java:69)
        at org.apache.pig.impl.logicalLayer.LOAdd.visit(LOAdd.java:29)
        at org.apache.pig.impl.plan.DependencyOrderWalkerWOSeenChk.walk(DependencyOrderWalkerWOSeenChk.java:68)
        at org.apache.pig.backend.hadoop.executionengine.physicalLayer.LogToPhyTranslationVisitor.visit(LogToPhyTranslationVisitor.java:805)
        at org.apache.pig.impl.logicalLayer.LOForEach.visit(LOForEach.java:121)
        at org.apache.pig.impl.logicalLayer.LOForEach.visit(LOForEach.java:40)
        at org.apache.pig.impl.plan.DependencyOrderWalker.walk(DependencyOrderWalker.java:68)
        at org.apache.pig.impl.plan.PlanVisitor.visit(PlanVisitor.java:51)
        at org.apache.pig.backend.hadoop.executionengine.HExecutionEngine.compile(HExecutionEngine.java:232)
        ... 7 more
Caused by: org.apache.pig.impl.plan.PlanException: Attempt to give &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; of type org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POProject multiple outputs.  This &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; does not support multiple outputs.
        at org.apache.pig.impl.plan.OperatorPlan.connect(OperatorPlan.java:158)
        at org.apache.pig.backend.hadoop.executionengine.physicalLayer.plans.PhysicalPlan.connect(PhysicalPlan.java:89)
        at org.apache.pig.backend.hadoop.executionengine.physicalLayer.LogToPhyTranslationVisitor.visit(LogToPhyTranslationVisitor.java:320)
        ... 16 more

2008-10-30 15:38:40,274 [main] ERROR org.apache.pig.tools.grunt.GruntParser - Unable to explain alias b [org.apache.pig.impl.plan.VisitorException]
2008-10-30 15:38:40,274 [main] ERROR org.apache.pig.tools.grunt.GruntParser - java.io.IOException: Unable to explain alias b [org.apache.pig.impl.plan.VisitorException]

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12407559">PIG-512</key>
            <summary>Expressions in foreach lead to errors</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sms">Santhosh Muthur Srinivasan</assignee>
                                    <reporter username="sms">Santhosh Muthur Srinivasan</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Oct 2008 22:41:25 +0000</created>
                <updated>Wed, 24 Mar 2010 22:04:13 +0000</updated>
                            <resolved>Fri, 14 Nov 2008 22:56:54 +0000</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12647372" author="sms" created="Thu, 13 Nov 2008 19:45:50 +0000"  >&lt;p&gt;Atached patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-512&quot; title=&quot;Expressions in foreach lead to errors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-512&quot;&gt;&lt;del&gt;PIG-512&lt;/del&gt;&lt;/a&gt;.patch) includes the following:&lt;/p&gt;

&lt;p&gt;1. Logical Plan cloning which in turn includes logical operator cloning. Caveat: Only logical plan cloning is allowed and LogicalPlanCloner is the supported mechanism for cloning logical plans. The following operators do not support cloning:&lt;br/&gt;
   i. LOLoad&lt;br/&gt;
   ii. LOStore&lt;br/&gt;
   iii. LOStream&lt;/p&gt;

&lt;p&gt;2. A visitor to remove redundant project( * ) operators that occur between two relational operators or between two expression operators.&lt;/p&gt;

&lt;p&gt;3. Unit tests for 1 and 2&lt;/p&gt;

&lt;p&gt;All unit tests pass.&lt;/p&gt;</comment>
                            <comment id="12647421" author="sms" created="Thu, 13 Nov 2008 22:06:52 +0000"  >&lt;p&gt;Updated patch with SVN changes since last patch. All unit tests pass.&lt;/p&gt;</comment>
                            <comment id="12647427" author="olgan" created="Thu, 13 Nov 2008 22:12:11 +0000"  >&lt;p&gt;Alan, could you, please, review it.&lt;/p&gt;</comment>
                            <comment id="12647700" author="alangates" created="Fri, 14 Nov 2008 19:00:10 +0000"  >&lt;p&gt;In LogicalPlanCloneHelper, why do you need this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void visit(LOCross cs) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; VisitorException {
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.visit(cs);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Won&apos;t java do that for you?&lt;/p&gt;

&lt;p&gt;What is the significance of the changes in TypeCheckingVisitor?&lt;/p&gt;

&lt;p&gt;Neither of these issues are big enough to require a new patch.  The current one looks good (and big &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; ).&lt;/p&gt;</comment>
                            <comment id="12647728" author="sms" created="Fri, 14 Nov 2008 21:41:16 +0000"  >&lt;p&gt;Yes, the visit(LOCross cs)  can be removed from LogicalPlanCloneHelper.java. Its a placeholder if we change LOCross &lt;br/&gt;
to have additional member variables. For now, its redundant.&lt;/p&gt;

&lt;p&gt;The change in the type checker is not related to the cloning. Its a bug that I uncovered while I was testing unary expressions&lt;br/&gt;
as part of cloning. The insertCastForUniOp method in the typeChecker had a bug where the newly created cast operator was &lt;br/&gt;
not added  to the plan before inserting the cast between the unary expression and the unary expression&apos;s input. I fixed it by adding&lt;br/&gt;
the cast operator to the plan and patching the reference in the unary expression to point to the cast.&lt;/p&gt;

&lt;p&gt;I would like to thank Pradeep Kamath who had done the ground work in an earlier attempt at cloning logical plans.&lt;/p&gt;</comment>
                            <comment id="12647745" author="olgan" created="Fri, 14 Nov 2008 22:56:54 +0000"  >&lt;p&gt;patch committed; thanks, santhosh.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12393885" name="PIG-512.patch" size="95139" author="sms" created="Thu, 13 Nov 2008 19:45:50 +0000"/>
                            <attachment id="12393897" name="PIG-512_1.patch" size="95139" author="sms" created="Thu, 13 Nov 2008 22:06:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38063</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gl4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94852</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>