<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:01:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-4683] Nested order is broken after PIG-3591 in some cases</title>
                <link>https://issues.apache.org/jira/browse/PIG-4683</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;The following script fail after &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3591&quot; title=&quot;Refactor POPackage to separate MR specific code from packaging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3591&quot;&gt;&lt;del&gt;PIG-3591&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;a = load &lt;span class=&quot;code-quote&quot;&gt;&apos;1.txt&apos;&lt;/span&gt; using PigStorage(&lt;span class=&quot;code-quote&quot;&gt;&apos;,&apos;&lt;/span&gt;) as (a0:chararray, a1:chararray);
b = load &lt;span class=&quot;code-quote&quot;&gt;&apos;2.txt&apos;&lt;/span&gt; as (b0:chararray);
c = cogroup b by b0, a by a0;
d = foreach c {
    a_sorted = order a by a1 desc;
    generate group, a_sorted, b;
}
dump d;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;1.txt&lt;br/&gt;
a,0&lt;br/&gt;
a,2&lt;br/&gt;
a,1&lt;/p&gt;

&lt;p&gt;2.txt&lt;br/&gt;
a&lt;/p&gt;

&lt;p&gt;Expected:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;(a,{(a,1),(a,2),(a,0)},{(a)})
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Actual:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;(a,{(a,2),(a,1),(a,0),(a)},{})
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12895228">PIG-4683</key>
            <summary>Nested order is broken after PIG-3591 in some cases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daijy">Daniel Dai</assignee>
                                    <reporter username="daijy">Daniel Dai</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Sep 2015 19:13:50 +0000</created>
                <updated>Wed, 31 Aug 2016 22:47:52 +0000</updated>
                            <resolved>Thu, 24 Sep 2015 05:46:53 +0000</resolved>
                                                    <fixVersion>0.16.0</fixVersion>
                    <fixVersion>0.15.1</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14901228" author="daijy" created="Mon, 21 Sep 2015 19:19:29 +0000"  >&lt;p&gt;The reason is PigSecondaryKeyComparator doesn&apos;t sort on index, but POPackage assumes iterator is sorted by index after &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3591&quot; title=&quot;Refactor POPackage to separate MR specific code from packaging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3591&quot;&gt;&lt;del&gt;PIG-3591&lt;/del&gt;&lt;/a&gt;. Before that, if there are multiple inputs, POPackage will create multiple bag and accumulate individually. Now once POPackage sees an index of the last input, it stop accumulating and create a PeekedBag immediately. However, the iterator may have records of other inputs not processed.&lt;/p&gt;</comment>
                            <comment id="14901576" author="rohini" created="Mon, 21 Sep 2015 22:57:44 +0000"  >&lt;p&gt;Few questions:&lt;br/&gt;
  1) This is not an issue with Tez right?&lt;br/&gt;
  2)  If we are removing null checks in tuple, won&apos;t output be incorrect if cogroup is on multiple keys and they contain null? Most likely there are no test cases covering that scenario. I realized that with self joins for &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4627&quot; title=&quot;[Pig on Tez] Self join does not handle null values correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4627&quot;&gt;&lt;del&gt;PIG-4627&lt;/del&gt;&lt;/a&gt; and had to add/modify tests to use studentnulltab10k.&lt;/p&gt;</comment>
                            <comment id="14901641" author="daijy" created="Mon, 21 Sep 2015 23:50:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rohini&quot; class=&quot;user-hover&quot; rel=&quot;rohini&quot;&gt;rohini&lt;/a&gt;&lt;br/&gt;
1) No, because currently SecondaryKeyOptimizerTez does not optimize cogroup. But if we enable that in Tez, we will face the same issue.&lt;br/&gt;
2) PigSecondaryKeyComparator should only do sorting. Whether tuple containing null should collapse together is the responsibility of PigSecondaryKeyGroupComparator, which I didn&apos;t touch. Actually in the patch, I only changed the code path which key doesn&apos;t contain null.&lt;/p&gt;</comment>
                            <comment id="14903543" author="rohini" created="Tue, 22 Sep 2015 22:09:17 +0000"  >&lt;blockquote&gt;&lt;p&gt;No, because currently SecondaryKeyOptimizerTez does not optimize cogroup. But if we enable that in Tez, we will face the same issue.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;  We should have a jira to fix SecondaryKeyOptimizerTez to support it. Even if it was supported it should not be an issue as POShuffleTezLoad does not use PeekedBag like POPackage&lt;/p&gt;</comment>
                            <comment id="14905011" author="daijy" created="Wed, 23 Sep 2015 18:38:33 +0000"  >&lt;p&gt;New patch fixed unit test failures.&lt;/p&gt;</comment>
                            <comment id="14905111" author="rohini" created="Wed, 23 Sep 2015 19:41:06 +0000"  >&lt;p&gt;+1. This fix is better.&lt;/p&gt;</comment>
                            <comment id="14905853" author="daijy" created="Thu, 24 Sep 2015 05:46:53 +0000"  >&lt;p&gt;Patch committed to both trunk and 0.15 branch. Thanks Rohini for review!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12991088">PIG-4955</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12681618">PIG-3591</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12761484" name="PIG-4683-1.patch" size="3968" author="daijy" created="Mon, 21 Sep 2015 20:08:47 +0000"/>
                            <attachment id="12761950" name="PIG-4683-2.patch" size="4056" author="daijy" created="Wed, 23 Sep 2015 18:38:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 8 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ld3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>