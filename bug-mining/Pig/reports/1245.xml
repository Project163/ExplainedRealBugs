<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:57:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-2606] union/ join operations are not accepting same alias as multiple inputs</title>
                <link>https://issues.apache.org/jira/browse/PIG-2606</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;grunt&amp;gt; l = load &apos;x&apos;;   &lt;br/&gt;
grunt&amp;gt; u = union l, l; &lt;br/&gt;
2012-03-16 18:48:45,687 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.Grunt - ERROR 2998: Unhandled internal error. Union with Count(Operand) &amp;lt; 2&lt;/p&gt;

&lt;p&gt;grunt&amp;gt; a = load &apos;a0.txt&apos; as (a0, a1);&lt;br/&gt;
grunt&amp;gt; b = join a by a0, a by a1;    &lt;br/&gt;
2013-08-27 13:36:21,807 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.Grunt - ERROR 2225: Projection with nothing to reference!&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12546879">PIG-2606</key>
            <summary>union/ join operations are not accepting same alias as multiple inputs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hsubramaniyan">Hari Sankar Sivarama Subramaniyan</assignee>
                                    <reporter username="thejas">Thejas Nair</reporter>
                        <labels>
                    </labels>
                <created>Sat, 17 Mar 2012 01:49:00 +0000</created>
                <updated>Mon, 14 Oct 2013 16:46:48 +0000</updated>
                            <resolved>Thu, 29 Aug 2013 21:17:13 +0000</resolved>
                                    <version>0.9.2</version>
                    <version>0.10.0</version>
                                    <fixVersion>0.12.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13231797" author="thejas" created="Sat, 17 Mar 2012 01:50:05 +0000"  >&lt;p&gt;The plan is incorrect for the following union, when same input is used multiple times -&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;grunt&amp;gt; u = union l  , l2, l;
grunt&amp;gt; explain u;
#-----------------------------------------------
# New Logical Plan:
#-----------------------------------------------
u: (Name: LOStore Schema: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
|
|---u: (Name: LOUnion Schema: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
    |
    |---l: (Name: LOLoad Schema: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)RequiredFields:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
    |
    |---l2: (Name: LOLoad Schema: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)RequiredFields:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13751679" author="hsubramaniyan" created="Tue, 27 Aug 2013 20:27:23 +0000"  >&lt;p&gt;There are 2 possible fixes:&lt;br/&gt;
1. Improve the error message and say that Pig does not allow this for operations like UNION, JOIN.&lt;br/&gt;
2. Add a Split operator to split the alias and connect the Union node to Splitoutput. &lt;br/&gt;
I will add the patch which implements option 1. Option 2 might be added in future depending on whether users actually encounter this scenario.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Hari&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13751703" author="hsubramaniyan" created="Tue, 27 Aug 2013 20:49:36 +0000"  >&lt;p&gt;Improving the error message.&lt;/p&gt;</comment>
                            <comment id="13751707" author="hsubramaniyan" created="Tue, 27 Aug 2013 20:51:58 +0000"  >&lt;p&gt;Added patch to improve the error message.&lt;/p&gt;

&lt;p&gt;grunt&amp;gt; a = load &apos;a0.txt&apos; as (a0, a1);&lt;br/&gt;
grunt&amp;gt; b = union a, a;               &lt;br/&gt;
2013-08-27 13:51:01,679 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1200: Pig script failed to parse: &lt;br/&gt;
&amp;lt;line 2, column 4&amp;gt; pig script failed to validate: Pig does not accept same alias as input for UNION operation : a&lt;/p&gt;

&lt;p&gt;grunt&amp;gt; b = join a by a0, a by a0; &lt;br/&gt;
2013-08-27 13:51:32,838 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1200: Pig script failed to parse: &lt;br/&gt;
&amp;lt;line 2, column 4&amp;gt; pig script failed to validate: Pig does not accept same alias as input for JOIN operation : a&lt;/p&gt;
</comment>
                            <comment id="13751739" author="hsubramaniyan" created="Tue, 27 Aug 2013 21:15:57 +0000"  >&lt;p&gt;Improving the error message&lt;/p&gt;</comment>
                            <comment id="13751741" author="hsubramaniyan" created="Tue, 27 Aug 2013 21:17:32 +0000"  >&lt;p&gt;Adding the patch to improve the error message&lt;/p&gt;</comment>
                            <comment id="13752959" author="daijy" created="Wed, 28 Aug 2013 22:31:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hsubramaniyan&quot; class=&quot;user-hover&quot; rel=&quot;hsubramaniyan&quot;&gt;hsubramaniyan&lt;/a&gt;, can we add a test case?&lt;/p&gt;</comment>
                            <comment id="13753392" author="hsubramaniyan" created="Thu, 29 Aug 2013 07:06:28 +0000"  >&lt;p&gt;Adding unit tests.&lt;/p&gt;</comment>
                            <comment id="13754065" author="daijy" created="Thu, 29 Aug 2013 21:17:13 +0000"  >&lt;p&gt;Patch committed to trunk. Thanks Hari!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12600549" name="PIG-2606.2.patch.txt" size="3937" author="hsubramaniyan" created="Thu, 29 Aug 2013 07:06:28 +0000"/>
                            <attachment id="12600255" name="PIG-2606.patch.txt" size="2270" author="hsubramaniyan" created="Tue, 27 Aug 2013 21:15:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>232037</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 12 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h3if:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97831</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>