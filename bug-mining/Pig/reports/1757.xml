<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:01:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-4674] TOMAP should infer schema</title>
                <link>https://issues.apache.org/jira/browse/PIG-4674</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;TOMAP schema is map only without map value schema. This should be inferred if available.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12863300">PIG-4674</key>
            <summary>TOMAP should infer schema</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daijy">Daniel Dai</assignee>
                                    <reporter username="daijy">Daniel Dai</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Sep 2015 06:31:57 +0000</created>
                <updated>Wed, 8 Jun 2016 20:48:45 +0000</updated>
                            <resolved>Thu, 17 Sep 2015 02:41:21 +0000</resolved>
                                                    <fixVersion>0.16.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14744269" author="rohini" created="Mon, 14 Sep 2015 21:12:13 +0000"  >&lt;p&gt;TOMAP also accepts a bag with &apos;pair&apos; tuples (i.e. tuples with a &apos;key&apos; and a &apos;value&apos;). That is not handled. Can also simplify code to&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+        &lt;span class=&quot;code-object&quot;&gt;Byte&lt;/span&gt; valueType = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (input != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; input.getFields()!=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (input.size() == 1) {
                   &lt;span class=&quot;code-comment&quot;&gt;//Code &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; bag of tuple pairs &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;. Get valueType of the second field in tuple
&lt;/span&gt;            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                   valueType = input.getFields().get(1).type;
             }
+        }
+        Schema s = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema.FieldSchema(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, DataType.MAP));
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (valueType != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; valueType != DataType.BYTEARRAY) {
+            s.getFields().get(0).schema = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema.FieldSchema(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, valueType));
+            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; s;
+        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="14746377" author="daijy" created="Tue, 15 Sep 2015 22:18:33 +0000"  >&lt;p&gt;Yes, that is missing. Attach second patch.&lt;/p&gt;</comment>
                            <comment id="14791105" author="rohini" created="Wed, 16 Sep 2015 20:51:10 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+        &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; valueType = DataType.BYTEARRAY;
.....
+                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (valueType == DataType.BYTEARRAY || valueType == input.getFields().get(i).type) {
+                        valueType = input.getFields().get(i).type;
+                    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
+                        valueType = DataType.BYTEARRAY;
+                        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
+                    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;should be&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+        &lt;span class=&quot;code-object&quot;&gt;Byte&lt;/span&gt; valueType = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
+                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (valueType == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)) {
+                        valueType = input.getFields().get(i).type;
+                    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (valueType != input.getFields().get(i).type) {
+                        valueType = DataType.BYTEARRAY;
+                        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
+                    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Without that if we had a0,a1,a2,a3 with a1 as bytearray and a3 as int, it will become map&lt;span class=&quot;error&quot;&gt;&amp;#91;int&amp;#93;&lt;/span&gt; instead of map&lt;span class=&quot;error&quot;&gt;&amp;#91;bytearray&amp;#93;&lt;/span&gt;. &lt;/p&gt;</comment>
                            <comment id="14791166" author="daijy" created="Wed, 16 Sep 2015 21:35:58 +0000"  >&lt;p&gt;Yes, there is a hole. Apply suggested change.&lt;/p&gt;</comment>
                            <comment id="14791258" author="rohini" created="Wed, 16 Sep 2015 22:44:59 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14791488" author="daijy" created="Thu, 17 Sep 2015 02:41:21 +0000"  >&lt;p&gt;Patch committed to trunk. Thanks Rohini for review!&lt;/p&gt;</comment>
                            <comment id="14803341" author="daijy" created="Thu, 17 Sep 2015 18:18:52 +0000"  >&lt;p&gt;Commit &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4674&quot; title=&quot;TOMAP should infer schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4674&quot;&gt;&lt;del&gt;PIG-4674&lt;/del&gt;&lt;/a&gt;-fixtest.patch to fix unit test failure.&lt;/p&gt;</comment>
                            <comment id="14803365" author="rohini" created="Thu, 17 Sep 2015 18:26:45 +0000"  >&lt;p&gt;+1 for the &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12757130/PIG-4674-fixtest.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12757130/PIG-4674-fixtest.patch&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14903981" author="daijy" created="Wed, 23 Sep 2015 05:32:10 +0000"  >&lt;p&gt;Another unit test failure patch.&lt;/p&gt;</comment>
                            <comment id="14904030" author="prkommireddi" created="Wed, 23 Sep 2015 06:14:33 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12912950">PIG-4734</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12755338" name="PIG-4674-1.patch" size="2530" author="daijy" created="Fri, 11 Sep 2015 06:32:34 +0000"/>
                            <attachment id="12756106" name="PIG-4674-2.patch" size="4757" author="daijy" created="Tue, 15 Sep 2015 22:18:33 +0000"/>
                            <attachment id="12756355" name="PIG-4674-3.patch" size="4981" author="daijy" created="Wed, 16 Sep 2015 21:35:58 +0000"/>
                            <attachment id="12757130" name="PIG-4674-fixtest.patch" size="1106" author="daijy" created="Thu, 17 Sep 2015 18:18:52 +0000"/>
                            <attachment id="12761807" name="PIG-4674-fixtest2.patch" size="600" author="daijy" created="Wed, 23 Sep 2015 05:32:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2k1e7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>