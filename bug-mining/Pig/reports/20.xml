<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:48:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PIG-123] cannot escape single quotes in single quoted strings when using the eq or match operator</title>
                <link>https://issues.apache.org/jira/browse/PIG-123</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;a query like this :&lt;/p&gt;


&lt;p&gt;filter c by ( c.string eq &apos;hell\&apos;s angels&apos; OR c.string eq &apos;blue\&apos;s clues&apos;)  &lt;/p&gt;

&lt;p&gt;generates an error with the pig parser, because the parser does not allow single quotes (&apos;) within single quotes, even if they are escaped with a backslash. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12389557">PIG-123</key>
            <summary>cannot escape single quotes in single quoted strings when using the eq or match operator</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pi_song">Pi Song</assignee>
                                    <reporter username="andreib">andrei badulescu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Feb 2008 02:50:37 +0000</created>
                <updated>Wed, 24 Mar 2010 22:01:21 +0000</updated>
                            <resolved>Fri, 14 Mar 2008 22:46:22 +0000</resolved>
                                                    <fixVersion>0.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12572433" author="pi_song" created="Tue, 26 Feb 2008 11:29:54 +0000"  >&lt;p&gt;After having a look, currently there is no escape character implementation in our grammar.&lt;/p&gt;

&lt;p&gt;By changing the definition of quoted string in grammar file from&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TOKEN : { &amp;lt;QUOTEDSTRING : &quot;&apos;&quot; (~[&quot;&apos;&quot;])* &quot;&apos;&quot;&amp;gt; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TOKEN : { &amp;lt;QUOTEDSTRING : &quot;&apos;&quot; ( (~[&quot;&apos;&quot;,&quot;\\&quot;]) | (&quot;\\&quot; ([&quot;\\&quot;,&quot;&apos;&quot;] ) )* &quot;&apos;&quot;&amp;gt; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and changing the state manipulation in Grunt not to switch out of IN_STRING after  &lt;b&gt;&quot;\&apos;&quot;&lt;/b&gt; (backslash and a quote) is encountered, this should work.&lt;/p&gt;

&lt;p&gt;***&lt;b&gt;However&lt;/b&gt;*** the real problem of doing this is the semantic change. As we introduce an escape character, we no longer treat the character as itself. People using &quot;\&quot; in their code will get a weird error message.&lt;/p&gt;

&lt;p&gt;Here are what will be affected from the above grammar change (Similar to Java) :-&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&quot;\\&quot;  will be interpreted as &quot;\&quot;
&quot;\&apos;&quot;  will be interpreted as &quot;&apos;&quot;
&quot;\&quot;+(char) will no longer allowed. ***An error will be raised***.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;***&lt;b&gt;Another concern&lt;/b&gt;*** is I don&apos;t know how having a single quote in the expression evaluation engine (which sometimes uses encoded text notation internally) will be affected.&lt;/p&gt;

&lt;p&gt;Need to listen to others!!!&lt;/p&gt;</comment>
                            <comment id="12572616" author="olgan" created="Tue, 26 Feb 2008 19:07:25 +0000"  >&lt;p&gt;+1. Pi, your proposal makes sense to me.&lt;/p&gt;</comment>
                            <comment id="12572635" author="breed" created="Tue, 26 Feb 2008 20:03:09 +0000"  >&lt;p&gt;It would be nice to fix this properly and allow support for specifying unicode characters, \uXXXX , and supporting standard escapes, \r \n \t. As you mention,  we have to introduce a semantic change, so we should do it right.&lt;/p&gt;

&lt;p&gt;BTW, make sure to test for &apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&apos; and &apos;\\\&apos;&apos;.&lt;/p&gt;</comment>
                            <comment id="12572922" author="pi_song" created="Wed, 27 Feb 2008 14:52:30 +0000"  >&lt;p&gt;This patch adds escape character to pig script and grunt.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;-  &quot;\&apos;&quot;,&quot;\r&quot;,&quot;\f&quot;,&quot;\t&quot;,&quot;\n&quot;,&quot;\b&quot; are supported
- &quot;\\&quot; will be interpreted to \
- &quot;\uxxxx&quot; for unicode are supported
- &quot;\x&quot; where x doesn&apos;t match anything above will be interpreted to x (skipping &quot;\&quot; )
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This patch is only for review. Unit test is coming after I sort out the my miniMR problem.&lt;/p&gt;</comment>
                            <comment id="12573223" author="pi_song" created="Thu, 28 Feb 2008 10:55:57 +0000"  >&lt;p&gt;This patch includes implementation of the above spec.&lt;br/&gt;
A new test case also included (TestPigScriptParser) which tests 3 special cases&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;single quote escape&lt;/li&gt;
	&lt;li&gt;\n escape&lt;/li&gt;
	&lt;li&gt;\uxxxx unicode escape&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;All unit tests passed.&lt;/p&gt;

&lt;p&gt;Ready to be committed&lt;/p&gt;

&lt;p&gt;*&lt;b&gt;Please mark this as patch available&lt;/b&gt;*&lt;/p&gt;</comment>
                            <comment id="12573358" author="breed" created="Thu, 28 Feb 2008 17:12:09 +0000"  >&lt;p&gt;Excellent work! Have you done a microbenchmark to see the overhead?  I&apos;m wondering if it would be worth it to scan the string first to see if there are any slashes to avoid processing (in the common case?).&lt;/p&gt;</comment>
                            <comment id="12573572" author="pi_song" created="Fri, 29 Feb 2008 02:43:52 +0000"  >&lt;p&gt;Ben,&lt;/p&gt;

&lt;p&gt;Pig is a processing-oriented system. You spend milliseconds to compile the query but spend hours to do processing work. The real point to be optimized should be in the execution engine where the code gets called over and over millions of time. This change in frontend encoding should have extremely small impact on the whole execution.&lt;/p&gt;

&lt;p&gt;In terms of performance analysis, this is an O ( n ) operation on a short in-memory string (normally no longer than 1K) which gets called only once in an execution.&lt;/p&gt;

&lt;p&gt;PS. If you do string scan first, it&apos;s still O ( n ) operation&lt;/p&gt;</comment>
                            <comment id="12574791" author="breed" created="Mon, 3 Mar 2008 23:52:09 +0000"  >&lt;p&gt;You are correct. I was more worried about the strain on the memory manager, but as you point out this is done in the parser, not in the execution engine.&lt;/p&gt;</comment>
                            <comment id="12574792" author="breed" created="Mon, 3 Mar 2008 23:53:17 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12575158" author="olgan" created="Tue, 4 Mar 2008 21:48:48 +0000"  >&lt;p&gt;+1 on code changes.&lt;/p&gt;

&lt;p&gt;I think tests should be true unit tests not end-to-end runs of pig scripts. We really want to minimize the time it takes to run unit tests and not to go to full tests when possible.&lt;/p&gt;</comment>
                            <comment id="12575314" author="pi_song" created="Wed, 5 Mar 2008 11:46:02 +0000"  >&lt;p&gt;Here it is.&lt;/p&gt;

&lt;p&gt;The test is done at Parser level and subsequently Consts in LogicalOps are checked.&lt;br/&gt;
This test took 0.283 seconds on my machine.&lt;/p&gt;

&lt;p&gt;In fact, I see this patch as an improvement rather than a bug fix.&lt;/p&gt;

&lt;p&gt;Please mark as patch available.&lt;/p&gt;</comment>
                            <comment id="12575315" author="pi_song" created="Wed, 5 Mar 2008 11:54:33 +0000"  >&lt;p&gt;Surprisingly, there are so many of our tests that do end-to-end runs instead of a specific point test.&lt;/p&gt;

&lt;p&gt;In the long run, we will need to consolidate all these tests. I don&apos;t want to bloat this Jira. Let&apos;s discuss later.&lt;/p&gt;</comment>
                            <comment id="12575377" author="francisoud" created="Wed, 5 Mar 2008 15:06:18 +0000"  >&lt;p&gt;Setting &quot;Patch Available&quot; as request by &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-123?focusedCommentId=12575314#action_12575314&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Pi Song&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12577431" author="pi_song" created="Tue, 11 Mar 2008 12:58:59 +0000"  >&lt;p&gt;In sync with the latest trunk (11Mar2008)&lt;/p&gt;

&lt;p&gt;Unit tests passed&lt;/p&gt;

&lt;p&gt;This patch has been around for a while. Somebody please commit.&lt;/p&gt;</comment>
                            <comment id="12578394" author="breed" created="Thu, 13 Mar 2008 17:11:46 +0000"  >&lt;p&gt;I&apos;m checking this in now.&lt;/p&gt;</comment>
                            <comment id="12578949" author="breed" created="Fri, 14 Mar 2008 22:23:57 +0000"  >&lt;p&gt;Committed revision 637293.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12377610" name="Pig123_EscapeCharSupport_11Mar2008.patch" size="10187" author="pi_song" created="Tue, 11 Mar 2008 12:58:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>163782</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ggdz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94085</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>