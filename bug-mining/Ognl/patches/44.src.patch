diff --git a/src/main/java/org/apache/commons/ognl/ASTProperty.java b/src/main/java/org/apache/commons/ognl/ASTProperty.java
index 6d7b0d6..da8d0a2 100644
--- a/src/main/java/org/apache/commons/ognl/ASTProperty.java
+++ b/src/main/java/org/apache/commons/ognl/ASTProperty.java
@@ -254,32 +254,7 @@ public class ASTProperty
 
             String name = ( (ASTConst) _children[0] ).getValue().toString();
 
-            if ( !Iterator.class.isAssignableFrom( context.getCurrentObject().getClass() )
-                || ( Iterator.class.isAssignableFrom( context.getCurrentObject().getClass() ) 
-                     && name.indexOf( "next" ) < 0 ) )
-            {
-                Object currObj = target;
-
-                try
-                {
-                    target = getValue( context, context.getCurrentObject() );
-                }
-                catch ( NoSuchPropertyException e )
-                {
-                    try
-                    {
-                        target = getValue( context, context.getRoot() );
-                    }
-                    catch ( NoSuchPropertyException ex )
-                    {
-                        // ignore
-                    }
-                }
-                finally
-                {
-                    context.setCurrentObject( currObj );
-                }
-            }
+            target = getTarget( context, target, name );
 
             PropertyDescriptor pd = OgnlRuntime.getPropertyDescriptor( context.getCurrentObject().getClass(), name );
 
@@ -411,6 +386,39 @@ public class ASTProperty
         return result;
     }
 
+    Object getTarget( OgnlContext context, Object target, String name )
+        throws OgnlException
+    {
+        Class<? extends Object> clazz = context.getCurrentObject().getClass();
+        if ( !Iterator.class.isAssignableFrom(clazz)
+            || ( Iterator.class.isAssignableFrom(clazz)
+                 && name.indexOf( "next" ) < 0 ) )
+        {
+            Object currObj = target;
+
+            try
+            {
+                target = getValue( context, context.getCurrentObject() );
+            }
+            catch ( NoSuchPropertyException e )
+            {
+                try
+                {
+                    target = getValue( context, context.getRoot() );
+                }
+                catch ( NoSuchPropertyException ex )
+                {
+                    // ignore
+                }
+            }
+            finally
+            {
+                context.setCurrentObject( currObj );
+            }
+        }
+        return target;
+    }
+
     Method getIndexedWriteMethod( PropertyDescriptor pd )
     {
         if ( IndexedPropertyDescriptor.class.isInstance( pd ) )
@@ -565,36 +573,7 @@ public class ASTProperty
             // System.out.println(" astprop(setter) : trying to set " + name + " on object target " +
             // context.getCurrentObject().getClass().getName());
 
-            if ( !Iterator.class.isAssignableFrom( context.getCurrentObject().getClass() )
-                || ( Iterator.class.isAssignableFrom( context.getCurrentObject().getClass() ) 
-                     && name.indexOf( "next" ) < 0 ) )
-            {
-
-                Object currObj = target;
-
-                try
-                {
-                    target = getValue( context, context.getCurrentObject() );
-                }
-                catch ( NoSuchPropertyException e )
-                {
-                    try
-                    {
-
-                        target = getValue( context, context.getRoot() );
-
-                    }
-                    catch ( NoSuchPropertyException ex )
-                    {
-                        // TODO: how to handle this accordingly?
-                    }
-                }
-                finally
-                {
-
-                    context.setCurrentObject( currObj );
-                }
-            }
+            target = getTarget( context, target, name );
 
             PropertyDescriptor pd =
                 OgnlRuntime.getPropertyDescriptor( 
