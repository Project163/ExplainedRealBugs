<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:47:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OGNL-11] ClassCastException in ASTChain</title>
                <link>https://issues.apache.org/jira/browse/OGNL-11</link>
                <project id="12313525" key="OGNL">Commons OGNL (Dormant)</project>
                    <description>&lt;p&gt;The error expression was &quot;value.section&quot; on ImportPresentations page within the already compiled ASTChain expression....So this happend succesfully once but whatever class was being cast to didn&apos;t work for another value. (possible generics issue? ) &lt;/p&gt;</description>
                <environment>tapestry runtime</environment>
        <key id="12594758">OGNL-11</key>
            <summary>ClassCastException in ASTChain</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="jkuhnert">Jesse Kuhnert</assignee>
                                    <reporter username="jkuhnert">Jesse Kuhnert</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Mar 2007 14:29:20 +0000</created>
                <updated>Tue, 31 Dec 2013 13:34:17 +0000</updated>
                                            <version>2.7</version>
                                    <fixVersion>4.0.x</fixVersion>
                                    <component>ExpressionCompiler</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13395509" author="jkuhnert" created="Sun, 11 Mar 2007 16:52:02 +0000"  >&lt;p&gt;You provided insufficient data to re-produce. (shame on you)&lt;/p&gt;</comment>
                            <comment id="13395620" author="djuern" created="Tue, 10 Jul 2007 01:47:11 +0000"  >&lt;p&gt;I have just updated from Tapestry 4.0 to 4.1.2 with OGNL 2.7 and I am having this same class cast exception on an ASTChain generated class, stack trace is here:&lt;/p&gt;



&lt;p&gt;Caused by: java.lang.ClassCastException: com.jigsawpublications.common.tapestry.menu.ActionLinkNode&lt;/p&gt;

&lt;p&gt;        at $ASTChain_113aed5c33f.get($ASTChain_113aed5c33f.java)&lt;/p&gt;

&lt;p&gt;        at org.apache.tapestry.services.impl.ExpressionEvaluatorImpl.read(ExpressionEvaluatorImpl.java:142)&lt;/p&gt;



&lt;p&gt;What we have in the component template looks like this:&lt;/p&gt;



&lt;p&gt;&amp;lt;span jwcid=&quot;actionLink@Block&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;li&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;a jwcid=&quot;@DirectLink&quot; listener=&quot;listener:callParentAction&quot;&lt;/p&gt;

&lt;p&gt;			parameters=&quot;ognl:getNodeIter().getAction()&quot;&lt;/p&gt;

&lt;p&gt;			href=&quot;#&quot; title=&quot;ognl:nodeIter.title&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;			&amp;lt;span jwcid=&quot;@Insert&quot; value=&quot;ognl:nodeIter.title&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;/a&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;/li&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/span&amp;gt;&lt;/p&gt;



&lt;p&gt;The nodeIter property on the component class is declared as follows:&lt;/p&gt;



&lt;p&gt;public IMenuNode getNodeIter() &lt;/p&gt;
{ ....}



&lt;p&gt;So what we have here is a list of objects all implementing this interface IMenuNode, and getNodeIter() returns the current iteration as set by the tapestry @For component. The class cast exception was on an ActionLinkNode which implements that interface. Other classes are PageLinkNode, RootNode and MenuNode. The &lt;b&gt;only&lt;/b&gt; one that causes a problem seems to be the above @Block component, as another block:&lt;/p&gt;



&lt;p&gt;&amp;lt;span jwcid=&quot;pageLink@Block&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;li&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;a jwcid=&quot;@PageLink&quot; href=&quot;#&quot; title=&quot;ognl:nodeIter.title&quot;&lt;/p&gt;

&lt;p&gt;			page=&quot;ognl:nodeIter.page&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;			&amp;lt;span jwcid=&quot;@Insert&quot; value=&quot;ognl:nodeIter.title&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;/a&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;/li&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/span&amp;gt;&lt;/p&gt;



&lt;p&gt;renders fine without any issue (these other blocks occur earlier in the page than the ActionLinkBlock). If I change the actionLink block to be the following (i.e. change the offending ognl expressions):&lt;/p&gt;



&lt;p&gt;&amp;lt;span jwcid=&quot;actionLink@Block&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;li&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;a jwcid=&quot;@DirectLink&quot; listener=&quot;listener:callParentAction&quot;&lt;/p&gt;

&lt;p&gt;			parameters=&quot;ognl:&apos;action&apos;&quot;&lt;/p&gt;

&lt;p&gt;			href=&quot;#&quot; title=&quot;ognl:&apos;title&apos;&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;			&amp;lt;span jwcid=&quot;@Insert&quot; value=&quot;ognl:&apos;title&apos;&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;/a&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;/li&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/span&amp;gt;&lt;/p&gt;



&lt;p&gt;Then I do not get an exception during the page render. This worked fine with the previous version of ognl we were using (2.6.7).&lt;/p&gt;



&lt;p&gt;Please let me know if you require more information.&lt;/p&gt;


</comment>
                            <comment id="13395652" author="reggiep" created="Thu, 13 Sep 2007 14:40:26 +0000"  >&lt;p&gt;I&apos;m also experiencing the same ClassCastException but in a slightly different situation.&lt;/p&gt;



&lt;p&gt;We have two different components on a page that share a common bean.  This bean implements two different interfaces.  Here&apos;s a code snippet:&lt;/p&gt;



&lt;p&gt;	@Component(type=&quot;Intelliware:MessagingRecipients&quot;, bindings=&lt;/p&gt;
{&quot;value=ognl:emailMessage&quot;, &quot;displayName=message:to&quot;}
&lt;p&gt;)&lt;/p&gt;

&lt;p&gt;	public abstract MessagingRecipients getMessagingRecipients();&lt;/p&gt;



&lt;p&gt;	@Component(type=&quot;Intelliware:MessagingAttachments&quot;, bindings=&lt;/p&gt;
{&quot;value=ognl:emailMessage&quot;, &quot;displayName=message:attachments&quot;}
&lt;p&gt;)&lt;/p&gt;

&lt;p&gt;	public abstract MessagingAttachments getMessagingAttachments();&lt;/p&gt;

&lt;p&gt;...&lt;/p&gt;

&lt;p&gt;	@Persist()&lt;/p&gt;

&lt;p&gt;public abstract EmailMessage getEmailMessage();&lt;/p&gt;

&lt;p&gt;public abstract void setEmailMessage(EmailMessage emailMessage);&lt;/p&gt;





&lt;p&gt;The class EmailMessage implements IMessagingRecipients and IMessagingAttachments.  These two interfaces are mutually exclusive in the methods that they define.&lt;/p&gt;



&lt;p&gt;The ClassCastException occurs on the second component definition:&lt;/p&gt;



&lt;p&gt;Here&apos;s the stack trace:&lt;/p&gt;

&lt;p&gt;An exception has occurred.&lt;/p&gt;



&lt;p&gt;You may continue by restarting the session.&lt;/p&gt;

&lt;p&gt;[ +/- ] Exception: Unable to read OGNL expression &apos;&amp;lt;parsed OGNL expression&amp;gt;&apos; of $MessagingAttachments_93@b40e4541&lt;span class=&quot;error&quot;&gt;&amp;#91;secure/messaging/ComposeSecureMessage/messagingAttachments&amp;#93;&lt;/span&gt;: ca.intelliware.bean.EmailMessage&lt;/p&gt;

&lt;p&gt;org.apache.tapestry.BindingException&lt;/p&gt;

&lt;p&gt;Unable to read OGNL expression &apos;&amp;lt;parsed OGNL expression&amp;gt;&apos; of $MessagingAttachments_93@b40e4541&lt;span class=&quot;error&quot;&gt;&amp;#91;secure/messaging/ComposeSecureMessage/messagingAttachments&amp;#93;&lt;/span&gt;: ca.intelliware.bean.EmailMessage&lt;/p&gt;

&lt;p&gt;binding: 	ExpressionBinding&lt;span class=&quot;error&quot;&gt;&amp;#91;secure/messaging/ComposeSecureMessage/messagingAttachments attachmentsVO.existingAttachments&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;location: 	Annotation @org.apache.tapestry.annotations.Component(inheritInformalParameters=false, type=For, bindings=&lt;span class=&quot;error&quot;&gt;&amp;#91;source=attachmentsVO.existingAttachments, value=currentExistingAttachment, converter=blobConverter&amp;#93;&lt;/span&gt;, id=, copyOf=) of public abstract org.apache.tapestry.components.ForBean ca.intelliware.tapestry.component.messaging.MessagingAttachments.getExistingAttachmentFor()&lt;/p&gt;



&lt;p&gt;[ +/- ] Exception: Unable to read OGNL expression &apos;&amp;lt;parsed OGNL expression&amp;gt;&apos; of $MessagingAttachments_93@b40e4541&lt;span class=&quot;error&quot;&gt;&amp;#91;secure/messaging/ComposeSecureMessage/messagingAttachments&amp;#93;&lt;/span&gt;: ca.intelliware.bean.EmailMessage&lt;/p&gt;

&lt;p&gt;org.apache.hivemind.ApplicationRuntimeException&lt;/p&gt;

&lt;p&gt;Unable to read OGNL expression &apos;&amp;lt;parsed OGNL expression&amp;gt;&apos; of $MessagingAttachments_93@b40e4541&lt;span class=&quot;error&quot;&gt;&amp;#91;secure/messaging/ComposeSecureMessage/messagingAttachments&amp;#93;&lt;/span&gt;: ca.intelliware.bean.EmailMessage&lt;/p&gt;

&lt;p&gt;component: 	$MessagingAttachments_93@b40e4541&lt;span class=&quot;error&quot;&gt;&amp;#91;secure/messaging/ComposeSecureMessage/messagingAttachments&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;location: 	Annotation @org.apache.tapestry.annotations.Component(inheritInformalParameters=false, type=Intelliware:MessagingAttachments, bindings=&lt;span class=&quot;error&quot;&gt;&amp;#91;value=emailMessage, displayName=message:attachments&amp;#93;&lt;/span&gt;, id=, copyOf=) of public abstract ca.intelliware.tapestry.component.messaging.MessagingAttachments ca.intelliware.page.secure.messaging.ComposeSecureMessage.getMessagingAttachments()&lt;/p&gt;



&lt;p&gt;[ +/- ] Exception: ca.intelliware.bean.EmailMessage&lt;/p&gt;

&lt;p&gt;java.lang.ClassCastException&lt;/p&gt;

&lt;p&gt;ca.intelliware.bean.EmailMessage&lt;/p&gt;

&lt;p&gt;Stack Trace:&lt;/p&gt;



&lt;ul&gt;
	&lt;li&gt;$ASTChain_114feb2716f.get($ASTChain_114feb2716f.java)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.services.impl.ExpressionEvaluatorImpl.read(ExpressionEvaluatorImpl.java:142)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;$ExpressionEvaluator_114feb26df8.read($ExpressionEvaluator_114feb26df8.java)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.binding.ExpressionBinding.resolveExpression(ExpressionBinding.java:139)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.binding.ExpressionBinding.getObject(ExpressionBinding.java:125)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.components.ForBean.evaluateSourceIterator(ForBean.java:693)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.components.ForBean.storeSourceData(ForBean.java:409)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.components.ForBean.getData(ForBean.java:333)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.components.ForBean.renderComponent(ForBean.java:130)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.AbstractComponent.render(AbstractComponent.java:725)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.services.impl.DefaultResponseBuilder.render(DefaultResponseBuilder.java:180)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.BaseComponent.renderComponent(BaseComponent.java:107)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.AbstractComponent.render(AbstractComponent.java:725)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.services.impl.DefaultResponseBuilder.render(DefaultResponseBuilder.java:180)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.AbstractComponent.renderBody(AbstractComponent.java:539)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.form.FormSupportImpl.render(FormSupportImpl.java:502)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.form.Form.renderComponent(Form.java:217)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.AbstractComponent.render(AbstractComponent.java:725)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.services.impl.DefaultResponseBuilder.render(DefaultResponseBuilder.java:180)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.AbstractComponent.renderBody(AbstractComponent.java:539)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.components.Block.renderForComponent(Block.java:65)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.components.RenderBlock.renderComponent(RenderBlock.java:65)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.AbstractComponent.render(AbstractComponent.java:725)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.services.impl.DefaultResponseBuilder.render(DefaultResponseBuilder.java:180)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.BaseComponent.renderComponent(BaseComponent.java:107)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.AbstractComponent.render(AbstractComponent.java:725)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.services.impl.DefaultResponseBuilder.render(DefaultResponseBuilder.java:180)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.tapestry.AbstractComponent.renderBody(AbstractComponent.java:539)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;....&lt;/p&gt;



&lt;p&gt;This probably doesn&apos;t provide enough information but I considering the similar symptoms but different conditions I thought that it might be useful.&lt;/p&gt;
</comment>
                            <comment id="13395662" author="reggiep" created="Mon, 17 Sep 2007 11:13:04 +0000"  >&lt;p&gt;More on this...&lt;/p&gt;



&lt;p&gt;Turns out the problem wasn&apos;t related to two components sharing the same bean after all.&lt;/p&gt;

&lt;p&gt;The real problem was this:&lt;/p&gt;



&lt;p&gt;We had two separate Tapestry pages that used the same component: MessageAttachments.  This component uses a bean that implements a particular interface.  In this case the interface was something like this:&lt;/p&gt;

&lt;p&gt;public interface Foo &lt;/p&gt;
{

  public void setUploads(List&amp;lt;File&amp;gt; uploads);

  public List&amp;lt;File&amp;gt; getAttachments();

  public List&amp;lt;File&amp;gt; getExistingAttachments();

}



&lt;p&gt;We had two different beans that implemented this interface.  One used in one of the pages and one in the other.&lt;/p&gt;

&lt;p&gt;First of all the problem was difficult to find because it depended on which page was viewed first.  In one case it would cause a ClassCastException and in the other  it would work fine.  The problem was related to how the beans were defined.&lt;/p&gt;

&lt;p&gt;In one case, the bean that implemented the interface did so through inheritance rather than by directly implementing the required methods itself.  If the page that used this bean was loaded first then the other page was viewed, the latter page would blow up with the ClassCastException.   &lt;/p&gt;



&lt;p&gt;The fix was to remove the class inheritance in the bean and have it implement the interface explicitly.&lt;/p&gt;



&lt;p&gt;Hope this helps a bit.&lt;/p&gt;



&lt;p&gt;Pete.&lt;/p&gt;</comment>
                            <comment id="13395717" author="karol" created="Mon, 24 Nov 2008 05:50:07 +0000"  >&lt;p&gt;I&apos;m using tapestry 4.1.6 and ognl 2.7.3 and I had very similar problem. One component was used on several pages. this component used beans. Beans are  different in every page, but have some common interfaces. Both beans have the same method, but this method was not declared in any interfaces. &lt;/p&gt;



&lt;p&gt;When I opened one of pages, everything works well. when I opened second I had ClassCastException.&lt;/p&gt;



&lt;p&gt;I solve this problem when I make interface, declare there the common method, and implement this interface by both beans&apos; classes.&lt;/p&gt;

&lt;p&gt;But I have got a feeling that is should work in different, simpler way.&lt;/p&gt;






</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>307053</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1a48v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>267154</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>