<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:39:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CONFIGURATION-684] YAMLConfiguration keys with double dots</title>
                <link>https://issues.apache.org/jira/browse/CONFIGURATION-684</link>
                <project id="12310467" key="CONFIGURATION">Commons Configuration</project>
                    <description>&lt;h2&gt;&lt;a name=&quot;Issue&quot;&gt;&lt;/a&gt;Issue&lt;/h2&gt;

&lt;p&gt;Loading a YAML configuration with dotted keys causes dots to be duplicated in the keys of the YAMLConfiguration object.&lt;/p&gt;

&lt;h2&gt;&lt;a name=&quot;Repro&quot;&gt;&lt;/a&gt;Repro&lt;/h2&gt;
&lt;p&gt;100% repro:&lt;/p&gt;

&lt;p&gt;file.yml:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;some.key.with.dots: 123&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; foo;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.configuration2.YAMLConfiguration;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.configuration2.builder.FileBasedConfigurationBuilder;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.configuration2.builder.fluent.Parameters;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.configuration2.ex.ConfigurationException;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;App {

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; ConfigurationException {
        Parameters params = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Parameters();
        FileBasedConfigurationBuilder&amp;lt;YAMLConfiguration&amp;gt; builder1 =
                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileBasedConfigurationBuilder&amp;lt;&amp;gt;(YAMLConfiguration.class)
                        .configure(params.fileBased().setFileName(&lt;span class=&quot;code-quote&quot;&gt;&quot;file.yml&quot;&lt;/span&gt;));
        
        YAMLConfiguration conf = builder1.getConfiguration();
        conf.getKeys().forEachRemaining(&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out::println);

        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;---&quot;&lt;/span&gt;);
        YAMLConfiguration yaml = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; YAMLConfiguration();
        yaml.read(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InputStreamReader(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.getSystemResourceAsStream(&lt;span class=&quot;code-quote&quot;&gt;&quot;file.yml&quot;&lt;/span&gt;)));
        yaml.getKeys().forEachRemaining(&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out::println);
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;prints&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;some..key..with..dots
---
some..key..with..dots
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;That is a serious bug for a configuration system. The issue may easily go untested for some keys and only reveal itself on production.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13126710">CONFIGURATION-684</key>
            <summary>YAMLConfiguration keys with double dots</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fabienrenaud">Fabien Renaud</reporter>
                        <labels>
                            <label>discussion</label>
                            <label>help-wanted</label>
                    </labels>
                <created>Fri, 22 Dec 2017 02:11:17 +0000</created>
                <updated>Thu, 28 Dec 2017 20:09:32 +0000</updated>
                            <resolved>Thu, 28 Dec 2017 20:09:32 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16300957" author="garydgregory" created="Fri, 22 Dec 2017 04:45:05 +0000"  >&lt;p&gt;Hello Fabien,&lt;/p&gt;

&lt;p&gt;Which version are you using?&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;</comment>
                            <comment id="16301056" author="fabienrenaud" created="Fri, 22 Dec 2017 07:17:21 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;compile group: &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.commons&apos;&lt;/span&gt;, name: &lt;span class=&quot;code-quote&quot;&gt;&apos;commons-configuration2&apos;&lt;/span&gt;, version: &lt;span class=&quot;code-quote&quot;&gt;&apos;2.2&apos;&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;from maven central.&lt;br/&gt;
The latest &lt;em&gt;release&lt;/em&gt; version as far as I know.&lt;/p&gt;</comment>
                            <comment id="16301322" author="kinow" created="Fri, 22 Dec 2017 12:27:38 +0000"  >&lt;p&gt;Hi Fabien,&lt;/p&gt;

&lt;p&gt;I believe the YAML parsing is handled by SnakeYAML. I confirmed I can use your `file.yml` with SnakeYAML with no issues.&lt;/p&gt;

&lt;p&gt;Actually, debugging your example (thank you a lot for including code sample) it looks like the issue happens here &lt;a href=&quot;https://github.com/apache/commons-configuration/blob/a56ce4f20db01c3de9faabc5ee10db19113e83cd/src/main/java/org/apache/commons/configuration2/tree/DefaultConfigurationKey.java#L530&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-configuration/blob/a56ce4f20db01c3de9faabc5ee10db19113e83cd/src/main/java/org/apache/commons/configuration2/tree/DefaultConfigurationKey.java#L530&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;When we enter that method, the value of the `key` argument is still `some.key.with.dots`. But the default list of symbols to be escaped has a `.` (dot). So it gets escaped by a `..` (two dots).&lt;/p&gt;

&lt;p&gt;I could not find any note about it in the &lt;a href=&quot;http://commons.apache.org/proper/commons-configuration/userguide/howto_properties.html#Special_Characters_and_Escaping&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.x documentation&lt;/a&gt;, but the &lt;a href=&quot;https://commons.apache.org/proper/commons-configuration/userguide_v1.10/howto_xml.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;1.x documentation&lt;/a&gt; contains some useful information.&lt;/p&gt;

&lt;blockquote&gt;
&lt;ol&gt;
	&lt;li&gt;From the Escaping special characters section&lt;br/&gt;
Per default the dot character is used as delimiter by most configuration classes (we will learn how to change this for hierarchical configurations in a later section). In some configuration formats however, dots can be contained in the names of properties. For instance, in XML the dot is a legal character that can occur in any tag. The same is true for the names of properties in windows ini files&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;I think it is sensible to use this default behaviour for most configuration types, and it is good to have that documented. However, I think it is possible to have a configuration key for YAML, that allows keys to use dot without escaping it.&lt;/p&gt;

&lt;p&gt;So IMO we leave the ticket open until someone can work on a new configuration key. How does that sound Fabien?&lt;/p&gt;

&lt;p&gt;Cheers&lt;br/&gt;
Bruno&lt;/p&gt;</comment>
                            <comment id="16301604" author="fabienrenaud" created="Fri, 22 Dec 2017 16:10:29 +0000"  >&lt;p&gt;Sounds good. Should the 2.x doc be updated with what you found in 1.x?&lt;/p&gt;</comment>
                            <comment id="16301678" author="oliver.heger@t-online.de" created="Fri, 22 Dec 2017 17:15:56 +0000"  >&lt;p&gt;The documentation is still available for 2.x; it can be found here:&lt;br/&gt;
&lt;a href=&quot;http://commons.apache.org/proper/commons-configuration/userguide/howto_hierarchical.html#Escaping_special_characters&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://commons.apache.org/proper/commons-configuration/userguide/howto_hierarchical.html#Escaping_special_characters&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Maybe it is confusing and could be better documented, but the behavior is actually expected. As described in the referenced section of the documentation, you have to duplicate dots in order to escape them, so that properties with dots in their names can be accessed correctly.  The iterator returned by getKeys() takes this into account, i.e. it returns keys in an escaped form, so that they can be used directly to query properties. Otherwise, you would have very strange results: keys obtained from the configuration would be unresolvable.&lt;/p&gt;</comment>
                            <comment id="16302040" author="kinow" created="Fri, 22 Dec 2017 22:45:12 +0000"  >&lt;p&gt;Oliver is right. I didn&apos;t properly read the current documentation for 2.x.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=oliver.heger%40t-online.de&quot; class=&quot;user-hover&quot; rel=&quot;oliver.heger@t-online.de&quot;&gt;oliver.heger@t-online.de&lt;/a&gt; do you see any problem in having a different behaviour for YAML? i.e. allowing dots in YAML keys, and not escaping them?&lt;/p&gt;</comment>
                            <comment id="16302507" author="oliver.heger@t-online.de" created="Sat, 23 Dec 2017 17:00:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kinow&quot; class=&quot;user-hover&quot; rel=&quot;kinow&quot;&gt;kinow&lt;/a&gt;, maybe I have not fully understood this ticket. I think the report is only that the getKeys() method returns keys that are different from the original keys if the configuration contains keys with dots. But this is the normal behavior for all hierarchical configurations. Or do I miss something?&lt;/p&gt;

&lt;p&gt;So my proposed fix would be to add a note to the Javadocs of getKeys().&lt;/p&gt;</comment>
                            <comment id="16302517" author="fabienrenaud" created="Sat, 23 Dec 2017 17:30:47 +0000"  >&lt;p&gt;My original issues was with querying such dotted keys that did not appear to exist in the config tree. It&apos;s only when I printed all the keys I realized they were escape and wasn&apos;t sure whether this was desired behavior or not so I opened this ticket.&lt;/p&gt;

&lt;p&gt;Personally, I&apos;d rather disable escaping of dots completely (and explicitly) and trust whomever writes the config to not introduce dups.&lt;/p&gt;</comment>
                            <comment id="16302520" author="oliver.heger@t-online.de" created="Sat, 23 Dec 2017 17:54:14 +0000"  >&lt;p&gt;The problem is that the dot is the normal property delimiter character. If it appears in a property name, it must be escaped.&lt;/p&gt;</comment>
                            <comment id="16302606" author="kinow" created="Sat, 23 Dec 2017 22:38:51 +0000"  >&lt;p&gt;Hmm. Good point &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=oliver.heger%40t-online.de&quot; class=&quot;user-hover&quot; rel=&quot;oliver.heger@t-online.de&quot;&gt;oliver.heger@t-online.de&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fabienrenaud&quot; class=&quot;user-hover&quot; rel=&quot;fabienrenaud&quot;&gt;fabienrenaud&lt;/a&gt;, not too sure about disabling it completely, as it would impact other users that have built their software on top of the premise that dots were escaped.&lt;/p&gt;

&lt;p&gt;I don&apos;t have the need for this change right now, but perhaps users that have YAML configuration files from other frameworks/tools with dots in the keys could be affected by this issue.&lt;/p&gt;

&lt;p&gt;There are some tools (Ansible, Jenkins, Openshift, SpringBoot, etc) that support YAML and may use dots in the keys. I suspect users from these tools could report problems some day with this default behaviour.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/spring-projects/spring-boot/blob/8f793eaf33cc312935fc69b3591bf2aa55c63275/spring-boot-project/spring-boot/src/test/resources/activeprofilerepro.yml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/spring-projects/spring-boot/blob/8f793eaf33cc312935fc69b3591bf2aa55c63275/spring-boot-project/spring-boot/src/test/resources/activeprofilerepro.yml&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/khoubyari/spring-boot-rest-example/blob/c8c6a745ed7c2772d26cfb24a46f17c230eedcfe/src/main/resources/application.yml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/khoubyari/spring-boot-rest-example/blob/c8c6a745ed7c2772d26cfb24a46f17c230eedcfe/src/main/resources/application.yml&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/openshift/origin/blob/d017a2b159a44ae6860696caa3f9a88261e7b82a/examples/jenkins/pipeline/bluegreen-pipeline.yaml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/openshift/origin/blob/d017a2b159a44ae6860696caa3f9a88261e7b82a/examples/jenkins/pipeline/bluegreen-pipeline.yaml&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So I would be pending towards i) modifying the keys parsing just for YAML, allowing dots, and then ii) updating the documentation explaining that YAML supports dots in the keys, but not the other formats.&lt;/p&gt;

&lt;p&gt;One issue that we could have, however, is when mixing configurations from YAML/XML/ini/etc. Not sure if there could be a case where a key read from a YAML file is mixed with keys from other sources, and for some reason it results in an error...&lt;/p&gt;

&lt;p&gt;Not in a hurry to get it fixed, so happy to wait others to review this issue and vote on these solutions or others, or just comment their point of view.&lt;/p&gt;</comment>
                            <comment id="16302945" author="oliver.heger@t-online.de" created="Sun, 24 Dec 2017 20:42:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kinow&quot; class=&quot;user-hover&quot; rel=&quot;kinow&quot;&gt;kinow&lt;/a&gt;, there is nothing special in the handling of escapes for YAML configuration. The logic is implemented in the base classes for hierarchical configurations. If you modify the test program from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fabienrenaud&quot; class=&quot;user-hover&quot; rel=&quot;fabienrenaud&quot;&gt;fabienrenaud&lt;/a&gt; to use a different configuration type - say &lt;tt&gt;XMLConfiguration&lt;/tt&gt; -, it should produce similar results.&lt;/p&gt;

&lt;p&gt;It is possible to handle keys with dots in their names; they just have to be escaped properly as described in the user&apos;s guide.&lt;/p&gt;

&lt;p&gt;Also note that the dot is critical only for the default expression engine because here it is the default element delimiter character. You can configure a different character or switch to &lt;tt&gt;XPathExpressionEngine&lt;/tt&gt;; then you do not have to do the escaping any more.&lt;/p&gt;</comment>
                            <comment id="16305708" author="fabienrenaud" created="Thu, 28 Dec 2017 20:09:17 +0000"  >&lt;p&gt;I understand why the escaping is done. I wish the default engine wasn&apos;t doing such escaping as I find this unnecessarily confusing when starting to use the lib (and I don&apos;t want to write my own engine nor configure one). Logging a warning or throwing an exception would have been just as fine imo.&lt;br/&gt;
Closing this ticket.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 46 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3o7d3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>