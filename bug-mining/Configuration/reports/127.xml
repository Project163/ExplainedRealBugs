<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:38:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CONFIGURATION-444] SubsetConfiguration does not properly handle interpolation when used on a HierarchicalConfiguration</title>
                <link>https://issues.apache.org/jira/browse/CONFIGURATION-444</link>
                <project id="12310467" key="CONFIGURATION">Commons Configuration</project>
                    <description>&lt;p&gt;Imaging next text files:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;properties&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;var&amp;gt;&lt;/span&gt;a_value&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/var&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;prop2&amp;gt;&lt;/span&gt;
		&amp;lt;prop
			attr1=&lt;span class=&quot;code-quote&quot;&gt;&quot;${var}&quot;&lt;/span&gt;
			attr2=&lt;span class=&quot;code-quote&quot;&gt;&quot;attr2&quot;&lt;/span&gt;
		/&amp;gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/prop2&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/properties&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
  XMLConfiguration config2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XMLConfiguration(&lt;span class=&quot;code-quote&quot;&gt;&quot;test/test2.xml&quot;&lt;/span&gt;);
  Configuration subset2 = config2.subset(&lt;span class=&quot;code-quote&quot;&gt;&quot;prop2&quot;&lt;/span&gt;);
  Configuration subset3 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SubsetConfiguration(subset2,&lt;span class=&quot;code-quote&quot;&gt;&quot;prop&quot;&lt;/span&gt;);
  &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(subset3.getString(&lt;span class=&quot;code-quote&quot;&gt;&quot;[@attr1]&quot;&lt;/span&gt;))
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the result is wrong:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;${&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;it should be:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;a_value
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think the problem is related to the &lt;em&gt;interpolate()&lt;/em&gt; method in SubsetConfiguration(), which seems to involve some kind of recursive trick that seem overcomplicated (and inefficient, since it&apos;s creating unnecessary SubsetConfiguration)..&lt;br/&gt;
But maybe I&apos;m missing something.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; interpolate(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; base)
    {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (delimiter == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; &quot;&quot;.equals(prefix))
        {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.interpolate(base);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
        {
            SubsetConfiguration config = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SubsetConfiguration(parent, &quot;&quot;);
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; config.interpolate(base);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think the code below would be more appropriate:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; interpolate(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; base)
    {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(parent &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; AbstractConfiguration)
        {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; ((AbstractConfiguration)parent).interpolate(base);
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; base;
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There&apos;s no reason to try interpolation if the parent is not implementing interpolation. &lt;/p&gt;

&lt;p&gt;This brings other questions about the whole interpolation thing. I really wonder why the &lt;em&gt;Configuration&lt;/em&gt; interface does not define that method, leaving or the the option to implementation to actually implement it. But that is another debate.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;all&lt;/p&gt;</environment>
        <key id="12503048">CONFIGURATION-444</key>
            <summary>SubsetConfiguration does not properly handle interpolation when used on a HierarchicalConfiguration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fabien_nisol">Fabien Nisol</reporter>
                        <labels>
                    </labels>
                <created>Thu, 31 Mar 2011 17:41:25 +0000</created>
                <updated>Fri, 8 Apr 2011 16:58:58 +0000</updated>
                            <resolved>Fri, 8 Apr 2011 16:58:58 +0000</resolved>
                                    <version>1.6</version>
                                                    <component>Interpolation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13016490" author="oliver.heger@t-online.de" created="Wed, 6 Apr 2011 19:25:59 +0000"  >&lt;p&gt;You should not create the &lt;tt&gt;SubsetConfiguration&lt;/tt&gt; manually, but call the &lt;tt&gt;subset()&lt;/tt&gt; method instead. (Please also refer to my comment on &lt;a href=&quot;https://issues.apache.org/jira/browse/CONFIGURATION-442&quot; title=&quot;SubsetConfiguration does not properly list attributes when a delimiter is set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CONFIGURATION-442&quot;&gt;&lt;del&gt;CONFIGURATION-442&lt;/del&gt;&lt;/a&gt;.) I have added a test case for &lt;tt&gt;HierarchicalConfiguration&lt;/tt&gt; based on your description. The only difference is that the line&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Configuration subset3 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SubsetConfiguration(subset2,&lt;span class=&quot;code-quote&quot;&gt;&quot;prop&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;has been replaced by&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Configuration subset3 = subset2.subset(&lt;span class=&quot;code-quote&quot;&gt;&quot;prop&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then interpolation works as expected.&lt;/p&gt;

&lt;p&gt;Your remarks about the implementation of &lt;tt&gt;SubsetConfiguration.interpolate()&lt;/tt&gt; make sense. I don&apos;t know why it is implemented in this complicated way. In fact, the specialized configuration returned by the &lt;tt&gt;subset()&lt;/tt&gt; method of &lt;tt&gt;HierarchicalConfiguration&lt;/tt&gt; actually just delegates to its parent configuration for doing interpolation. When I find the time I will have a look if this implementation can be simplified.&lt;/p&gt;

&lt;p&gt;I am not sure how the interpolation method could be exposed through the &lt;tt&gt;Configuration&lt;/tt&gt; interface. It is not called directly by a client of a configuration object. Rather, the specific implementations of the various get methods are responsible for handling this feature.&lt;/p&gt;</comment>
                            <comment id="13017537" author="fabien_nisol" created="Fri, 8 Apr 2011 16:57:33 +0000"  >&lt;p&gt;You cannot always control what type of Configuration is instantiated. If your base configuration happens to be a CompositeConfiguration, calling &lt;em&gt;subset()&lt;/em&gt; on it will instantiate a SubsetConfiguration. &lt;/p&gt;

&lt;p&gt;See my comment on bug &lt;a href=&quot;https://issues.apache.org/jira/browse/CONFIGURATION-442&quot; title=&quot;SubsetConfiguration does not properly list attributes when a delimiter is set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CONFIGURATION-442&quot;&gt;&lt;del&gt;CONFIGURATION-442&lt;/del&gt;&lt;/a&gt; about this...&lt;/p&gt;

&lt;p&gt;Anyway, this seem to work if I use the subset() method here, you&apos;re absolutely right. In fact, the &lt;em&gt;getKeys()&lt;/em&gt; problem of &lt;a href=&quot;https://issues.apache.org/jira/browse/CONFIGURATION-442&quot; title=&quot;SubsetConfiguration does not properly list attributes when a delimiter is set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CONFIGURATION-442&quot;&gt;&lt;del&gt;CONFIGURATION-442&lt;/del&gt;&lt;/a&gt; was the source of our problem.&lt;/p&gt;

&lt;p&gt;I wonder if &lt;b&gt;SubsetConfiguration&lt;/b&gt; should be a &quot;package private&quot; class instead of a public one. It would then be obvious that this class is not intended to be used as part of the API.&lt;/p&gt;

&lt;p&gt;I tested some code that seem to work as expected:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
            ConfigurationFactory factory = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConfigurationFactory(&lt;span class=&quot;code-quote&quot;&gt;&quot;config2.xml&quot;&lt;/span&gt;);
            Configuration config = factory.getConfiguration();
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; prop = &lt;span class=&quot;code-quote&quot;&gt;&quot;[@attr1]&quot;&lt;/span&gt;;
            Configuration subset = config.subset(&lt;span class=&quot;code-quote&quot;&gt;&quot;prop2.prop&quot;&lt;/span&gt;);
            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.printf(&lt;span class=&quot;code-quote&quot;&gt;&quot;%s=%s%n&quot;&lt;/span&gt;,prop,subset.getString(prop));
            subset = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SubsetConfiguration(config.subset(&lt;span class=&quot;code-quote&quot;&gt;&quot;prop2&quot;&lt;/span&gt;),&lt;span class=&quot;code-quote&quot;&gt;&quot;prop&quot;&lt;/span&gt;);
            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.printf(&lt;span class=&quot;code-quote&quot;&gt;&quot;%s=%s%n&quot;&lt;/span&gt;,prop,subset.getString(prop));...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;config2.xml&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;configuration&amp;gt;
	&amp;lt;system/&amp;gt;
	&amp;lt;xml fileName=&lt;span class=&quot;code-quote&quot;&gt;&quot;test2.xml&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;/configuration&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;test2.xml&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;properties&amp;gt;
	&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;&amp;gt;a_value&amp;lt;/&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;&amp;gt;
	&amp;lt;prop2&amp;gt;
		&amp;lt;prop
			attr1=&lt;span class=&quot;code-quote&quot;&gt;&quot;${user.home}&quot;&lt;/span&gt;
			attr2=&lt;span class=&quot;code-quote&quot;&gt;&quot;attr2&quot;&lt;/span&gt;
		/&amp;gt;
	&amp;lt;/prop2&amp;gt;
&amp;lt;/properties&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;output&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[@attr1]=/home/users/vr3030
[@attr1]=${user.home}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</comment>
                            <comment id="13017539" author="fabien_nisol" created="Fri, 8 Apr 2011 16:58:58 +0000"  >&lt;p&gt;The SubsetConfiguration should not be directly used as stated in comments&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>110874</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 33 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0thr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>170185</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>