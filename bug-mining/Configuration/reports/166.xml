<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:38:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CONFIGURATION-524] AbstractConfiguration does not interpolate correctly after cloning</title>
                <link>https://issues.apache.org/jira/browse/CONFIGURATION-524</link>
                <project id="12310467" key="CONFIGURATION">Commons Configuration</project>
                    <description>&lt;p&gt;If you clone a Configuration, does not clone the StrSubstitutor when it has been instanced, so the cloned copy has the same StrSubstituor than the original composite. If you change a property in the original compoiste it is changed in the cloned copy.&lt;/p&gt;

&lt;p&gt;Way to reproduce it :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;SampleConfiguration {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; sentence = &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * FORM TABLE WHERE YEAR=${year} and QUARTER=${quarter}&quot;&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; CompositeConfiguration cp = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CompositeConfiguration();
        cp.addProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;year&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2000&quot;&lt;/span&gt;);
        cp.addProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;quarter&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;);

        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; AbstractConfiguration clonedConfig = (AbstractConfiguration) ConfigurationUtils.cloneConfiguration(cp);

        cp.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;year&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2001&quot;&lt;/span&gt;);
        clonedConfig.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;year&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2002&quot;&lt;/span&gt;);

        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Original sentence &quot;&lt;/span&gt; + PropertyConverter.interpolate(sentence, cp));
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Cloned sentence &quot;&lt;/span&gt; + PropertyConverter.interpolate(sentence, clonedConfig));

        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; AbstractConfiguration clonedConfig2 = (AbstractConfiguration) ConfigurationUtils.cloneConfiguration(cp);

        cp.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;year&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2003&quot;&lt;/span&gt;);
        clonedConfig2.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;year&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2004&quot;&lt;/span&gt;);

        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Original sentence &quot;&lt;/span&gt; + PropertyConverter.interpolate(sentence, cp));
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Cloned (after interpolate with same strSubstitutor )sentence &quot;&lt;/span&gt;
                + PropertyConverter.interpolate(sentence, clonedConfig2));
    }
}  
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The solution can be to make in the following ways:&lt;br/&gt;
Make the clone of the strSubstitutor in the AbstractConfigutration class.&lt;br/&gt;
Create a clone method inside the StrSubtitutor  and invoke it from the AbstractConfiguration class.&lt;br/&gt;
Set null the strSubstituror when the clone method is invoked in the Abstract Configuration class. The next invocation to interpolate methos instances the strSubstitutor.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12630369">CONFIGURATION-524</key>
            <summary>AbstractConfiguration does not interpolate correctly after cloning</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="oheger">Oliver Heger</assignee>
                                    <reporter username="diego7427">Juan Diego Gago Perez</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Feb 2013 13:00:21 +0000</created>
                <updated>Thu, 24 Mar 2016 20:20:51 +0000</updated>
                            <resolved>Fri, 12 Apr 2013 20:30:09 +0000</resolved>
                                                    <fixVersion>2.0</fixVersion>
                                    <component>Build</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>
                            <timeestimate seconds="86400">24h</timeestimate>
                                        <comments>
                            <comment id="13569612" author="oliver.heger@t-online.de" created="Sat, 2 Feb 2013 18:28:47 +0000"  >&lt;p&gt;Thank you for the report.&lt;/p&gt;

&lt;p&gt;There have been some changes recently in the current development version in the field of interpolation. However, I am pretty sure that the problem still exists.&lt;/p&gt;</comment>
                            <comment id="13630590" author="oliver.heger@t-online.de" created="Fri, 12 Apr 2013 20:30:09 +0000"  >&lt;p&gt;Fixed in subversion in revision 1467449.&lt;/p&gt;

&lt;p&gt;The &lt;tt&gt;ConfigurationInterpolator&lt;/tt&gt; is now cloned, too, by all implementations of the &lt;tt&gt;clone()&lt;/tt&gt; method. The following &lt;tt&gt;clone()&lt;/tt&gt; implementations had to be adapted:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;BaseConfiguration&lt;/li&gt;
	&lt;li&gt;BaseHierarchicalConfiguration&lt;/li&gt;
	&lt;li&gt;CompositeConfiguration&lt;/li&gt;
	&lt;li&gt;MapConfiguration&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I hope I did not forget one.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>310864</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 32 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1hncn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>311209</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>