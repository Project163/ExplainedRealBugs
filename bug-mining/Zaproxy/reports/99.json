{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/1874","repository_url":"https://api.github.com/repos/zaproxy/zaproxy","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/1874/labels{/name}","comments_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/1874/comments","events_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/1874/events","html_url":"https://github.com/zaproxy/zaproxy/issues/1874","id":105200468,"node_id":"MDU6SXNzdWUxMDUyMDA0Njg=","number":1874,"title":"Two Cookie line in the header when adding a cookie with an httpsender script and doing an active scan","user":{"login":"michaelcourcy","id":4678108,"node_id":"MDQ6VXNlcjQ2NzgxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/4678108?v=4","gravatar_id":"","url":"https://api.github.com/users/michaelcourcy","html_url":"https://github.com/michaelcourcy","followers_url":"https://api.github.com/users/michaelcourcy/followers","following_url":"https://api.github.com/users/michaelcourcy/following{/other_user}","gists_url":"https://api.github.com/users/michaelcourcy/gists{/gist_id}","starred_url":"https://api.github.com/users/michaelcourcy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/michaelcourcy/subscriptions","organizations_url":"https://api.github.com/users/michaelcourcy/orgs","repos_url":"https://api.github.com/users/michaelcourcy/repos","events_url":"https://api.github.com/users/michaelcourcy/events{/privacy}","received_events_url":"https://api.github.com/users/michaelcourcy/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":220063774,"node_id":"MDU6TGFiZWwyMjAwNjM3NzQ=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":382856034,"node_id":"MDU6TGFiZWwzODI4NTYwMzQ=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/historic","name":"historic","color":"c2e0c6","default":false,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/1","html_url":"https://github.com/zaproxy/zaproxy/milestone/1","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/1/labels","id":1487775,"node_id":"MDk6TWlsZXN0b25lMTQ4Nzc3NQ==","number":1,"title":"2.5.0","description":"Enhancements and bug fixes expected to be included in the next main release.","creator":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":152,"state":"closed","created_at":"2016-01-06T16:25:24Z","updated_at":"2016-10-04T09:53:40Z","due_on":null,"closed_at":"2016-06-04T18:07:32Z"},"comments":9,"created_at":"2015-09-07T11:40:59Z","updated_at":"2020-02-01T05:10:52Z","closed_at":"2016-04-18T09:29:19Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I use an httpsender script that add cookie to every request.\n\n```\nvar has_js_cookie = new org.parosproxy.paros.network.HtmlParameter(COOKIE_PARAM_TYPE, HAS_JS_NAME, \"1\");\ncookieParams.add(has_js_cookie);\nvar toolbar_cookie = new org.parosproxy.paros.network.HtmlParameter(COOKIE_PARAM_TYPE, TOOLBAR_NAME, \"0\");\ncookieParams.add(toolbar_cookie);\n```\n\n If I use it during an active scan with a context that create a session based on cookies, first zap add the cookie of the session in the header \n\n```\nCookie: SESS8bcff576a76286b5afa8392e2841f07f=9344OUeBNCCDF8YKkTni2SKSpFuzx5mNulec1n_sXnA\n```\n\nThen it adds the two other cookies in an other line \n\n```\nCookie: toolbar.collapsed=0; has_js=1 \n```\n\nInstead of adding them to the cookie line already created, this results in a header with two lines of cookies.\n\n```\nCookie: toolbar.collapsed=0; has_js=1\nConnection: keep-alive\nContent-Length: 0\nHost: 172.17.0.3\nCookie: SESS8bcff576a76286b5afa8392e2841f07f=9344OUeBNCCDF8YKkTni2SKSpFuzx5mNulec1n_sXnA\n```\n\nThe cookie line that's going to be taken in account by the server is unpredictable. \n\nI use ZAP 2.4.1\n","closed_by":{"login":"kingthorin","id":7570458,"node_id":"MDQ6VXNlcjc1NzA0NTg=","avatar_url":"https://avatars.githubusercontent.com/u/7570458?v=4","gravatar_id":"","url":"https://api.github.com/users/kingthorin","html_url":"https://github.com/kingthorin","followers_url":"https://api.github.com/users/kingthorin/followers","following_url":"https://api.github.com/users/kingthorin/following{/other_user}","gists_url":"https://api.github.com/users/kingthorin/gists{/gist_id}","starred_url":"https://api.github.com/users/kingthorin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingthorin/subscriptions","organizations_url":"https://api.github.com/users/kingthorin/orgs","repos_url":"https://api.github.com/users/kingthorin/repos","events_url":"https://api.github.com/users/kingthorin/events{/privacy}","received_events_url":"https://api.github.com/users/kingthorin/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/1874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/1874/timeline","performed_via_github_app":null,"state_reason":"completed"}