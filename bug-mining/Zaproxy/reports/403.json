{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/8904","repository_url":"https://api.github.com/repos/zaproxy/zaproxy","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/8904/labels{/name}","comments_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/8904/comments","events_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/8904/events","html_url":"https://github.com/zaproxy/zaproxy/issues/8904","id":2950213401,"node_id":"I_kwDOAjHKnc6v2K8Z","number":8904,"title":"JSON Input Vector doesn't handle top level primitive types","user":{"login":"kingthorin","id":7570458,"node_id":"MDQ6VXNlcjc1NzA0NTg=","avatar_url":"https://avatars.githubusercontent.com/u/7570458?v=4","gravatar_id":"","url":"https://api.github.com/users/kingthorin","html_url":"https://github.com/kingthorin","followers_url":"https://api.github.com/users/kingthorin/followers","following_url":"https://api.github.com/users/kingthorin/following{/other_user}","gists_url":"https://api.github.com/users/kingthorin/gists{/gist_id}","starred_url":"https://api.github.com/users/kingthorin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingthorin/subscriptions","organizations_url":"https://api.github.com/users/kingthorin/orgs","repos_url":"https://api.github.com/users/kingthorin/repos","events_url":"https://api.github.com/users/kingthorin/events{/privacy}","received_events_url":"https://api.github.com/users/kingthorin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":220063776,"node_id":"MDU6TGFiZWwyMjAwNjM3NzY=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/14","html_url":"https://github.com/zaproxy/zaproxy/milestone/14","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/14/labels","id":12197963,"node_id":"MI_kwDOAjHKnc4AuiBL","number":14,"title":"2.17.0","description":"","creator":{"login":"kingthorin","id":7570458,"node_id":"MDQ6VXNlcjc1NzA0NTg=","avatar_url":"https://avatars.githubusercontent.com/u/7570458?v=4","gravatar_id":"","url":"https://api.github.com/users/kingthorin","html_url":"https://github.com/kingthorin","followers_url":"https://api.github.com/users/kingthorin/followers","following_url":"https://api.github.com/users/kingthorin/following{/other_user}","gists_url":"https://api.github.com/users/kingthorin/gists{/gist_id}","starred_url":"https://api.github.com/users/kingthorin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingthorin/subscriptions","organizations_url":"https://api.github.com/users/kingthorin/orgs","repos_url":"https://api.github.com/users/kingthorin/repos","events_url":"https://api.github.com/users/kingthorin/events{/privacy}","received_events_url":"https://api.github.com/users/kingthorin/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":17,"closed_issues":33,"state":"open","created_at":"2025-01-21T15:18:19Z","updated_at":"2025-11-10T14:49:21Z","due_on":null,"closed_at":null},"comments":3,"created_at":"2025-03-26T16:37:08Z","updated_at":"2025-07-08T01:33:57Z","closed_at":"2025-04-08T15:19:45Z","author_association":"MEMBER","type":{"id":646230,"node_id":"IT_kwDOAGZ9xM4ACdxW","name":"Feature","description":"A request, idea, or new functionality","color":"blue","created_at":"2024-01-25T10:17:45Z","updated_at":"2024-10-08T08:52:07Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug:\n\nProcessing a HTTP request which has `content-type: application/json` and a body consisting of simple a quoted string, ex: `\"Jone Doe\"` results in an exception from VariantJSONQuery.\n\n### Steps to reproduce the behavior:\n\n1. Send the following request (or similar):\n```http\nPUT https://brokencrystals.com/api/file/raw?path=some/path/to/file.png HTTP/1.1\nhost: brokencrystals.com\nuser-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36\npragma: no-cache\ncache-control: no-cache\naccept: */*\ncontent-type: application/json\ncontent-length: 10\n\n\"John Doe\"\n```\n2. Attempt to launch an active scan with said message included.\n3. Note the resulting exception in the log.\n\n### Expected behavior:\n\nA simple quoted string should be handled by VariantJSONQuery.\n\n\n### Software versions:\n\nZAP\nVersion: Dev Build\n\nInstalled Add-ons: [[id=alertFilters, version=24.0.0],\n[id=ascanrules, version=71.0.0], [id=ascanrulesAlpha,\nversion=48.0.0], [id=ascanrulesBeta, version=58.0.0],\n[id=automation, version=0.49.0], [id=callhome,\nversion=0.14.0], [id=client, version=0.15.0], [id=commonlib,\nversion=1.31.0], [id=custompayloads, version=0.14.0],\n[id=database, version=0.8.0], [id=dev, version=0.9.0],\n[id=formhandler, version=6.7.0], [id=fuzz, version=13.15.0],\n[id=graaljs, version=0.9.0], [id=graphql, version=0.28.0],\n[id=grpc, version=0.2.0], [id=imagelocationscanner,\nversion=5.0.0], [id=llm, version=0.0.1], [id=neonmarker,\nversion=1.8.0], [id=network, version=0.21.0], [id=oast,\nversion=0.21.0], [id=openapi, version=45.0.0], [id=postman,\nversion=0.6.0], [id=pscan, version=0.2.1], [id=pscanrules,\nversion=64.0.0], [id=pscanrulesAlpha, version=44.0.0],\n[id=pscanrulesBeta, version=43.0.0], [id=quickstart,\nversion=51.0.0], [id=replacer, version=20.0.0], [id=reports,\nversion=0.38.0], [id=requester, version=7.8.0], [id=retire,\nversion=0.46.0], [id=scripts, version=45.9.0], [id=selenium,\nversion=15.36.0], [id=soap, version=24.0.0], [id=spider,\nversion=0.14.0], [id=wappalyzer, version=21.45.0],\n[id=webdriverwindows, version=131.0.0], [id=websocket,\nversion=32.0.0], [id=zest, version=48.5.0]]\n\nOperating System: Windows 11\nArchitecture: amd64\nCPU Cores: 8\nMax Memory: 7 GB\nJava Version: Eclipse Adoptium 17.0.11\nSystem's Locale: en_US\nDisplay Locale: en_GB\nFormat Locale: en_US\nDefault Charset: UTF-8\nZAP Home Directory: C:\\Users\\user\\ZAP_D\\\nZAP Installation Directory: C:\\Users\\user\\Desktop\\zap-ws\\zaproxy\\zap\\src\\main\\dist\\.\\\nLook and Feel: FlatLaf Dark (com.formdev.flatlaf.FlatDarkLaf)\n\n### Errors from the zap.log file:\n```\n245154 [ZAP-ActiveScanner-11] WARN  org.parosproxy.paros.core.scanner.VariantJSONQuery - Failed to parse the request body for url https://brokencrystals.com/api/file/raw?path=some/path/to/file.png : Input is invalid JSON; does not start with '{' or '[', c=34\njava.lang.IllegalArgumentException: Input is invalid JSON; does not start with '{' or '[', c=34\n\tat org.parosproxy.paros.core.scanner.VariantJSONQuery.parseObject(VariantJSONQuery.java:139) ~[main/:?]\n\tat org.parosproxy.paros.core.scanner.VariantJSONQuery.parseContent(VariantJSONQuery.java:89) ~[main/:?]\n\tat org.parosproxy.paros.core.scanner.VariantAbstractRPCQuery.setRequestContent(VariantAbstractRPCQuery.java:148) ~[main/:?]\n\tat org.parosproxy.paros.core.scanner.VariantAbstractRPCQuery.setMessage(VariantAbstractRPCQuery.java:60) [main/:?]\n\tat org.parosproxy.paros.core.scanner.AbstractAppParamPlugin.scan(AbstractAppParamPlugin.java:91) [main/:?]\n\tat org.parosproxy.paros.core.scanner.AbstractPlugin.run(AbstractPlugin.java:391) [main/:?]\n\tat java.base/java.lang.Thread.run(Thread.java:840) [?:?]\n```\n\n### Additional context:\n\nAccording to: https://jsonlint.com/ & https://jsonformatter.org/ a quoted string is valid JSON.\n\nFor reference: https://brokencrystals.com/swagger-json\n\n### Would you like to help fix this issue?\n\n- [ ] Yes","closed_by":{"login":"kingthorin","id":7570458,"node_id":"MDQ6VXNlcjc1NzA0NTg=","avatar_url":"https://avatars.githubusercontent.com/u/7570458?v=4","gravatar_id":"","url":"https://api.github.com/users/kingthorin","html_url":"https://github.com/kingthorin","followers_url":"https://api.github.com/users/kingthorin/followers","following_url":"https://api.github.com/users/kingthorin/following{/other_user}","gists_url":"https://api.github.com/users/kingthorin/gists{/gist_id}","starred_url":"https://api.github.com/users/kingthorin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingthorin/subscriptions","organizations_url":"https://api.github.com/users/kingthorin/orgs","repos_url":"https://api.github.com/users/kingthorin/repos","events_url":"https://api.github.com/users/kingthorin/events{/privacy}","received_events_url":"https://api.github.com/users/kingthorin/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/8904/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/8904/timeline","performed_via_github_app":null,"state_reason":"completed"}