{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/5581","repository_url":"https://api.github.com/repos/zaproxy/zaproxy","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/5581/labels{/name}","comments_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/5581/comments","events_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/5581/events","html_url":"https://github.com/zaproxy/zaproxy/issues/5581","id":494392937,"node_id":"MDU6SXNzdWU0OTQzOTI5Mzc=","number":5581,"title":"Error when using zap-api-scan.py in docker","user":{"login":"tpang-ameame","id":34192054,"node_id":"MDQ6VXNlcjM0MTkyMDU0","avatar_url":"https://avatars.githubusercontent.com/u/34192054?v=4","gravatar_id":"","url":"https://api.github.com/users/tpang-ameame","html_url":"https://github.com/tpang-ameame","followers_url":"https://api.github.com/users/tpang-ameame/followers","following_url":"https://api.github.com/users/tpang-ameame/following{/other_user}","gists_url":"https://api.github.com/users/tpang-ameame/gists{/gist_id}","starred_url":"https://api.github.com/users/tpang-ameame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tpang-ameame/subscriptions","organizations_url":"https://api.github.com/users/tpang-ameame/orgs","repos_url":"https://api.github.com/users/tpang-ameame/repos","events_url":"https://api.github.com/users/tpang-ameame/events{/privacy}","received_events_url":"https://api.github.com/users/tpang-ameame/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":220421415,"node_id":"MDU6TGFiZWwyMjA0MjE0MTU=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/Usability","name":"Usability","color":"ededed","default":false,"description":null},{"id":678291375,"node_id":"MDU6TGFiZWw2NzgyOTEzNzU=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/Docker","name":"Docker","color":"8B4513","default":false,"description":null}],"state":"closed","locked":true,"assignee":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":7,"created_at":"2019-09-17T04:23:33Z","updated_at":"2021-07-12T13:10:41Z","closed_at":"2020-04-06T15:55:56Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hi, \r\nWhen I use zap-api-scan.py in docker owasp/zap2docker-weekly to scan api with command: \r\n```\r\ndocker run -u root -v /tmp/zap:/zap/wrk:rw  -ti owasp/zap2docker-weekly zap-api-scan.py -t api\r\n_mini_1309.json -f openapi -r report.html -z \"-configfile /zap/wrk/options.prop\" -d\r\n```\r\n\r\nI met this error, and docker log shows:\r\n\r\n```\r\n\r\n2019-09-17 02:37:55,944 http://localhost:49579 \"GET http://zap/JSON/ascan/view/status/?scanId=Does+Not+Exist HTTP/1.1\" 400 52\r\nERROR <type 'exceptions.ValueError'>\r\n2019-09-17 02:37:55,945 Unexpected error: <type 'exceptions.ValueError'>\r\nTraceback (most recent call last):\r\n  File \"/zap/zap-api-scan.py\", line 425, in main\r\n    zap_active_scan(zap, target, scan_policy)\r\n  File \"/zap/zap_common.py\", line 84, in _wrap\r\n    return_data = func(*args_list, **kwargs)\r\n  File \"/zap/zap_common.py\", line 398, in zap_active_scan\r\n    while(int(zap.ascan.status(ascan_scan_id)) < 100):\r\nValueError: invalid literal for int() with base 10: 'Does Not Exist'\r\n\r\n```\r\nAnd url imported from swagger file is not null: ``` Number of Imported URLs: 14 ```\r\nI notice this: ``` http://localhost:49579 \"GET http://zap/JSON/ascan/view/status/?scanId=Does+Not+Exist HTTP/1.1\" 400 52 ```\r\nSeems that it passed wrong parameter to zap, please tell how to fix this?\r\n\r\n**Errors from the zap.log file**\r\n```\r\n13041 [ZAP-ProxyThread-8] WARN org.zaproxy.zap.extension.api.API  - Bad request to API endpoint [/JSON/ascan/action/scan/] from [127.0.0.1]:\r\nDoes Not Exist (does_not_exist) : scanPolicyName\r\n        at org.zaproxy.zap.extension.ascan.ActiveScanAPI.handleApiAction(ActiveScanAPI.java:357)\r\n        at org.zaproxy.zap.extension.api.API.handleApiRequest(API.java:508)\r\n        at org.parosproxy.paros.core.proxy.ProxyThread.processHttp(ProxyThread.java:499)\r\n        at org.parosproxy.paros.core.proxy.ProxyThread.run(ProxyThread.java:335)\r\n        at java.lang.Thread.run(Thread.java:748)\r\n18058 [ZAP-ProxyThread-9] WARN org.zaproxy.zap.extension.api.API  - Bad request to API endpoint [/JSON/ascan/view/status/] from [127.0.0.1]:\r\nDoes Not Exist (does_not_exist) : scanId\r\n        at org.zaproxy.zap.extension.ascan.ActiveScanAPI.getActiveScan(ActiveScanAPI.java:768)\r\n        at org.zaproxy.zap.extension.ascan.ActiveScanAPI.handleApiView(ActiveScanAPI.java:958)\r\n        at org.zaproxy.zap.extension.api.API.handleApiRequest(API.java:527)\r\n        at org.parosproxy.paros.core.proxy.ProxyThread.processHttp(ProxyThread.java:499)\r\n        at org.parosproxy.paros.core.proxy.ProxyThread.run(ProxyThread.java:335)\r\n        at java.lang.Thread.run(Thread.java:748)\r\n2019-09-17 02:37:55,952 Trigger hook: pre_exit, args: 3\r\n```\r\n","closed_by":{"login":"kingthorin","id":7570458,"node_id":"MDQ6VXNlcjc1NzA0NTg=","avatar_url":"https://avatars.githubusercontent.com/u/7570458?v=4","gravatar_id":"","url":"https://api.github.com/users/kingthorin","html_url":"https://github.com/kingthorin","followers_url":"https://api.github.com/users/kingthorin/followers","following_url":"https://api.github.com/users/kingthorin/following{/other_user}","gists_url":"https://api.github.com/users/kingthorin/gists{/gist_id}","starred_url":"https://api.github.com/users/kingthorin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingthorin/subscriptions","organizations_url":"https://api.github.com/users/kingthorin/orgs","repos_url":"https://api.github.com/users/kingthorin/repos","events_url":"https://api.github.com/users/kingthorin/events{/privacy}","received_events_url":"https://api.github.com/users/kingthorin/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/5581/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/5581/timeline","performed_via_github_app":null,"state_reason":"completed"}