{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/1950","repository_url":"https://api.github.com/repos/zaproxy/zaproxy","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/1950/labels{/name}","comments_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/1950/comments","events_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/1950/events","html_url":"https://github.com/zaproxy/zaproxy/issues/1950","id":109758467,"node_id":"MDU6SXNzdWUxMDk3NTg0Njc=","number":1950,"title":"Connection closed without response, with an Authentication script with errors","user":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":220063774,"node_id":"MDU6TGFiZWwyMjAwNjM3NzQ=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":382856034,"node_id":"MDU6TGFiZWwzODI4NTYwMzQ=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/historic","name":"historic","color":"c2e0c6","default":false,"description":null}],"state":"closed","locked":true,"assignee":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2015-10-05T09:19:20Z","updated_at":"2020-02-01T12:24:07Z","closed_at":"2015-10-21T10:46:56Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Steps to reproduce the issue:\n1. Run ZAP (version 2.4.2);\n2. Create an \"Authentication\" script with a call to an undefined function;\n3. Setup the authentication of a context to use the created authentication script and enable \"Forced User\";\n4. Proxy a request;\n5. Note that the user-agent doesn't get a response, but it should even if the authentication was not successful;\n6. Check the log file, there should be an exception:\nwith Nashorn (Java 8):\n\n```\n1138140 [ZAP-ProxyThread-10] ERROR org.zaproxy.zap.ZAP$UncaughtExceptionLogger  - Exception in thread \"ZAP-ProxyThread-10\"\n<eval>:18 ReferenceError: \"undefinedFunction\" is not defined\n    at jdk.nashorn.internal.runtime.ECMAErrors.error(ECMAErrors.java:57)\n    at jdk.nashorn.internal.runtime.ECMAErrors.referenceError(ECMAErrors.java:319)\n    at jdk.nashorn.internal.runtime.ECMAErrors.referenceError(ECMAErrors.java:291)\n    at jdk.nashorn.internal.objects.Global.__noSuchProperty__(Global.java:1432)\n    at jdk.nashorn.internal.scripts.Script$Recompilation$42$1253AAA$\\^eval\\_.authenticate(<eval>:18)\n    at org.zaproxy.zap.authentication.ScriptBasedAuthenticationMethodType$AuthenticationScript$$NashornJavaAdapter.authenticate(Unknown Source)\n    at org.zaproxy.zap.authentication.ScriptBasedAuthenticationMethodType$ScriptBasedAuthenticationMethod.authenticate(Unknown Source)\n    at org.zaproxy.zap.users.User.authenticate(Unknown Source)\n    at org.zaproxy.zap.users.User.processMessageToMatchUser(Unknown Source)\n    at org.parosproxy.paros.network.HttpSender.sendAuthenticated(Unknown Source)\n    at org.parosproxy.paros.network.HttpSender.sendAndReceive(Unknown Source)\n    at org.parosproxy.paros.network.HttpSender.sendAndReceive(Unknown Source)\n    at org.parosproxy.paros.core.proxy.ProxyThread.processHttp(Unknown Source)\n    at org.parosproxy.paros.core.proxy.ProxyThread.run(Unknown Source)\n    at java.lang.Thread.run(Thread.java:745)\n```\n\nor, with Rhino (Java 7):\n\n```\n697137 [ZAP-ProxyThread-15] ERROR org.zaproxy.zap.ZAP$UncaughtExceptionLogger  - Exception in thread \"ZAP-ProxyThread-15\"\njava.lang.reflect.UndeclaredThrowableException\n    at com.sun.proxy.$Proxy5.authenticate(Unknown Source)\n    at org.zaproxy.zap.authentication.ScriptBasedAuthenticationMethodType$ScriptBasedAuthenticationMethod.authenticate(Unknown Source)\n    at org.zaproxy.zap.users.User.authenticate(Unknown Source)\n    at org.zaproxy.zap.users.User.processMessageToMatchUser(Unknown Source)\n    at org.parosproxy.paros.network.HttpSender.sendAuthenticated(Unknown Source)\n    at org.parosproxy.paros.network.HttpSender.sendAndReceive(Unknown Source)\n    at org.parosproxy.paros.network.HttpSender.sendAndReceive(Unknown Source)\n    at org.parosproxy.paros.core.proxy.ProxyThread.processHttp(Unknown Source)\n    at org.parosproxy.paros.core.proxy.ProxyThread.run(Unknown Source)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: java.security.PrivilegedActionException: javax.script.ScriptException: sun.org.mozilla.javascript.internal.EcmaError: ReferenceError: \"undefinedFunction\" is not defined. (<Unknown source>#18) in <Unknown source> at line number 18\n    at java.security.AccessController.doPrivileged(Native Method)\n    at com.sun.script.util.InterfaceImplementor$InterfaceImplementorInvocationHandler.invoke(InterfaceImplementor.java:67)\n    ... 10 more\nCaused by: javax.script.ScriptException: sun.org.mozilla.javascript.internal.EcmaError: ReferenceError: \"undefinedFunction\" is not defined. (<Unknown source>#18) in <Unknown source> at line number 18\n    at com.sun.script.javascript.RhinoScriptEngine.invoke(RhinoScriptEngine.java:300)\n    at com.sun.script.javascript.RhinoScriptEngine.invokeFunction(RhinoScriptEngine.java:258)\n    at com.sun.script.util.InterfaceImplementor$InterfaceImplementorInvocationHandler$1.run(InterfaceImplementor.java:70)\n    ... 12 more\nCaused by: sun.org.mozilla.javascript.internal.EcmaError: ReferenceError: \"undefinedFunction\" is not defined. (<Unknown source>#18)\n    at sun.org.mozilla.javascript.internal.ScriptRuntime.constructError(ScriptRuntime.java:3770)\n    at sun.org.mozilla.javascript.internal.ScriptRuntime.constructError(ScriptRuntime.java:3748)\n    at sun.org.mozilla.javascript.internal.ScriptRuntime.notFoundError(ScriptRuntime.java:3833)\n    at sun.org.mozilla.javascript.internal.ScriptRuntime.getNameFunctionAndThis(ScriptRuntime.java:2218)\n    at sun.org.mozilla.javascript.internal.Interpreter.interpretLoop(Interpreter.java:1510)\n    at sun.org.mozilla.javascript.internal.Interpreter.interpret(Interpreter.java:849)\n    at sun.org.mozilla.javascript.internal.InterpretedFunction.call(InterpretedFunction.java:162)\n    at sun.org.mozilla.javascript.internal.ContextFactory.doTopCall(ContextFactory.java:430)\n    at com.sun.script.javascript.RhinoScriptEngine$1.superDoTopCall(RhinoScriptEngine.java:116)\n    at com.sun.script.javascript.RhinoScriptEngine$1.doTopCall(RhinoScriptEngine.java:109)\n    at sun.org.mozilla.javascript.internal.ScriptRuntime.doTopCall(ScriptRuntime.java:3160)\n    at sun.org.mozilla.javascript.internal.InterpretedFunction.call(InterpretedFunction.java:160)\n    at com.sun.script.javascript.RhinoScriptEngine.invoke(RhinoScriptEngine.java:294)\n    ... 14 more\n```\n\nZAP Version:\nVersions >= 2.3.0\n","closed_by":{"login":"psiinon","id":1081115,"node_id":"MDQ6VXNlcjEwODExMTU=","avatar_url":"https://avatars.githubusercontent.com/u/1081115?v=4","gravatar_id":"","url":"https://api.github.com/users/psiinon","html_url":"https://github.com/psiinon","followers_url":"https://api.github.com/users/psiinon/followers","following_url":"https://api.github.com/users/psiinon/following{/other_user}","gists_url":"https://api.github.com/users/psiinon/gists{/gist_id}","starred_url":"https://api.github.com/users/psiinon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psiinon/subscriptions","organizations_url":"https://api.github.com/users/psiinon/orgs","repos_url":"https://api.github.com/users/psiinon/repos","events_url":"https://api.github.com/users/psiinon/events{/privacy}","received_events_url":"https://api.github.com/users/psiinon/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/1950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/1950/timeline","performed_via_github_app":null,"state_reason":"completed"}