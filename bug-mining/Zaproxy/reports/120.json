{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/2546","repository_url":"https://api.github.com/repos/zaproxy/zaproxy","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/2546/labels{/name}","comments_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/2546/comments","events_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/2546/events","html_url":"https://github.com/zaproxy/zaproxy/issues/2546","id":158980798,"node_id":"MDU6SXNzdWUxNTg5ODA3OTg=","number":2546,"title":"ZAP access URLs which are out of scope","user":{"login":"g-sato","id":10803131,"node_id":"MDQ6VXNlcjEwODAzMTMx","avatar_url":"https://avatars.githubusercontent.com/u/10803131?v=4","gravatar_id":"","url":"https://api.github.com/users/g-sato","html_url":"https://github.com/g-sato","followers_url":"https://api.github.com/users/g-sato/followers","following_url":"https://api.github.com/users/g-sato/following{/other_user}","gists_url":"https://api.github.com/users/g-sato/gists{/gist_id}","starred_url":"https://api.github.com/users/g-sato/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-sato/subscriptions","organizations_url":"https://api.github.com/users/g-sato/orgs","repos_url":"https://api.github.com/users/g-sato/repos","events_url":"https://api.github.com/users/g-sato/events{/privacy}","received_events_url":"https://api.github.com/users/g-sato/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":220063774,"node_id":"MDU6TGFiZWwyMjAwNjM3NzQ=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":382856034,"node_id":"MDU6TGFiZWwzODI4NTYwMzQ=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/historic","name":"historic","color":"c2e0c6","default":false,"description":null}],"state":"closed","locked":true,"assignee":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/2","html_url":"https://github.com/zaproxy/zaproxy/milestone/2","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/2/labels","id":1808570,"node_id":"MDk6TWlsZXN0b25lMTgwODU3MA==","number":2,"title":"2.6.0","description":"Enhancements and bug fixes expected to be included in the next main release.","creator":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":230,"state":"closed","created_at":"2016-06-04T18:06:28Z","updated_at":"2017-11-27T11:18:43Z","due_on":null,"closed_at":"2017-03-30T12:42:51Z"},"comments":2,"created_at":"2016-06-07T17:33:55Z","updated_at":"2020-02-01T20:24:26Z","closed_at":"2016-06-14T06:23:20Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hello ZAP team,\n\nI've found a case that ZAP access URLs which are out of scope on 'protected mode'.\n\nSteps to reproduce:\n\n1) Run ZAP 2.5.0(or ZAP 2.4.3)\n\n2) Run Fiddler or Burp Suite\n\n3) Set up proxy network configration to:\nZAP - Fiddler or Burp Suite - Target Site\n(The reason of use Fiddler or Burp Suite is to logging ZAP raw access.)\n\n4) Make this php (or same logic other program), and put it on webserver.\n(In this example, this php is: http://localhost/zaptest/redirect.php)\n\n[redirect.php]\n\n```\n<?php\nheader('Location: https://www.*****.com/');\nexit;\n?>\n```\n\nIn this source, https://www.*****.com/ is example. Please change this URL to your own site that can attack by ZAP.\n- CASE-A  - ZAP does not access URL in out of scope (Normal Case)\n\n5-A) Access the URL below\n\n`http://localhost/zaptest/redirect.php`\n- CASE-B  - ZAP access the URL that out of scope (Probrem Case)\n\n5-B) Access the URL below (NOTICE: In this case, URL parameter (?a=b) is needed)\n\n`http://localhost/zaptest/redirect.php?a=b`\n\n6) Set ZAP mode to 'protected mode', and set 'http://localhost/' into default context.\n\n7) Right click the URL in history that \n\nCASE-A:\n`http://localhost/zaptest/redirect.php`\n\nCASE-B:\n`http://localhost/zaptest/redirect.php?a=b`\n\nAnd choice Active scan.Set 'Injectable Targets' to All,\nAnd set scan policy to all threshold off except 'Server Side Include'.\nSet threshold of 'Server Side Include' to default (execute this test only).\nThen Start active scan.\n\nThen, duaring activescan, check the log of Fiddler(or Burp Suite).\nIn CASE-A, ZAP does not access to 'https://www.*****.com/'.\nThere is no probrem.\n\nBut in CASE-B, ZAP access to 'https://www.*****.com/' like this log below.\n\n> GET http://localhost/zaptest/redirect.php?a=%22%3E%3C%21--%23EXEC+cmd%3D%22ls+%2F%22--%3E%3C\n> GET https://www.*****.com/   <<< access to out of scope url by redirect\n> GET http://localhost/zaptest/redirect.php?a=%22%3E%3C%21--%23EXEC+cmd%3D%22dir+%5C%22--%3E%3C\n> GET https://www.*****.com/\n>  .\n>  .\n> GET http://localhost/zaptest/redirect.php?a=b  (\\* User-Agent:<!--#EXEC cmd=\"ls /\"-->)\n> GET https://www.*****.com/  (\\* User-Agent: <!--#EXEC cmd=\"ls /\"-->)\n>  .\n>  .\n> GET http://localhost/zaptest/redirect.php?a=b   (\\* User-Agent:<!--#EXEC cmd=\"dir \\\"-->)\n> GET https://www.*****.com/  (\\* User-Agent: <!--#EXEC cmd=\"dir \\\"-->)\n>  .\n>  .\n\n(The ZAP active scan log doesn't show access to https://www.*****.com.\nFiddler or Burp log shows that ZAP access to https://www.*****.com. )\n\nSo in CASE-B, ZAP Attacks the URL that out of scope.\nIs this bug or by design? \n\nRegards.\n","closed_by":{"login":"psiinon","id":1081115,"node_id":"MDQ6VXNlcjEwODExMTU=","avatar_url":"https://avatars.githubusercontent.com/u/1081115?v=4","gravatar_id":"","url":"https://api.github.com/users/psiinon","html_url":"https://github.com/psiinon","followers_url":"https://api.github.com/users/psiinon/followers","following_url":"https://api.github.com/users/psiinon/following{/other_user}","gists_url":"https://api.github.com/users/psiinon/gists{/gist_id}","starred_url":"https://api.github.com/users/psiinon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psiinon/subscriptions","organizations_url":"https://api.github.com/users/psiinon/orgs","repos_url":"https://api.github.com/users/psiinon/repos","events_url":"https://api.github.com/users/psiinon/events{/privacy}","received_events_url":"https://api.github.com/users/psiinon/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/2546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/2546/timeline","performed_via_github_app":null,"state_reason":"completed"}