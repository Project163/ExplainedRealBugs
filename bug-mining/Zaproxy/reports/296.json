{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/2531","repository_url":"https://api.github.com/repos/zaproxy/zaproxy","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/2531/labels{/name}","comments_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/2531/comments","events_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/2531/events","html_url":"https://github.com/zaproxy/zaproxy/issues/2531","id":158332073,"node_id":"MDU6SXNzdWUxNTgzMzIwNzM=","number":2531,"title":"Cookie is not set during script authentication when following redirect","user":{"login":"aine-rb","id":17924188,"node_id":"MDQ6VXNlcjE3OTI0MTg4","avatar_url":"https://avatars.githubusercontent.com/u/17924188?v=4","gravatar_id":"","url":"https://api.github.com/users/aine-rb","html_url":"https://github.com/aine-rb","followers_url":"https://api.github.com/users/aine-rb/followers","following_url":"https://api.github.com/users/aine-rb/following{/other_user}","gists_url":"https://api.github.com/users/aine-rb/gists{/gist_id}","starred_url":"https://api.github.com/users/aine-rb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aine-rb/subscriptions","organizations_url":"https://api.github.com/users/aine-rb/orgs","repos_url":"https://api.github.com/users/aine-rb/repos","events_url":"https://api.github.com/users/aine-rb/events{/privacy}","received_events_url":"https://api.github.com/users/aine-rb/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":220063774,"node_id":"MDU6TGFiZWwyMjAwNjM3NzQ=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":382856034,"node_id":"MDU6TGFiZWwzODI4NTYwMzQ=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/historic","name":"historic","color":"c2e0c6","default":false,"description":null}],"state":"closed","locked":true,"assignee":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/4","html_url":"https://github.com/zaproxy/zaproxy/milestone/4","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/4/labels","id":2345949,"node_id":"MDk6TWlsZXN0b25lMjM0NTk0OQ==","number":4,"title":"2.8.0","description":"Enhancements and bug fixes expected to be included in a following main release.","creator":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":219,"state":"closed","created_at":"2017-02-24T14:48:00Z","updated_at":"2019-06-07T23:19:00Z","due_on":null,"closed_at":"2019-06-07T23:19:00Z"},"comments":8,"created_at":"2016-06-03T09:56:39Z","updated_at":"2020-02-01T21:31:42Z","closed_at":"2018-09-18T12:46:55Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"What steps will reproduce the problem?\n1. Choose a test site using redirects during authentication such as WebGoat\n2. Create a context with a Script-based Authentication method and a Cookie-based Session Management method\n3. In the script (for example, a Javascript one), use the function: \"helper.sendAndReceive(msg, true);\" (notice the second parameter is set to true) to send the authentication request and follow redirects\n4. Use a network analyzer to see the content of request/response packets (because ZAP doesn't display in his history the redirect requests/responses when authenticating, maybe I'll raise another issue)\n5. Use the User Forced Mode to test authentication and session management\n\nWhat is the expected output? What do you see instead?\nThe server sends a Set-Cookie header with a Location header. ZAP process the Location header in order to follow redirect but ignore the Set-Cookie header and doesn't set the cookie in the HTTP State. The session is not setup, the User Forced mode fail to authenticate.\n\nWhat version of the product are you using?\n2.4.3\n\nPlease provide any additional information below.\nAfter a quick research, the problem seams to come from the processRedirectResponse() method in org.apache.commons.httpclient.HttpMethodDirector class.\n\nI would like to work on this issue, if you agree.\n","closed_by":{"login":"psiinon","id":1081115,"node_id":"MDQ6VXNlcjEwODExMTU=","avatar_url":"https://avatars.githubusercontent.com/u/1081115?v=4","gravatar_id":"","url":"https://api.github.com/users/psiinon","html_url":"https://github.com/psiinon","followers_url":"https://api.github.com/users/psiinon/followers","following_url":"https://api.github.com/users/psiinon/following{/other_user}","gists_url":"https://api.github.com/users/psiinon/gists{/gist_id}","starred_url":"https://api.github.com/users/psiinon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psiinon/subscriptions","organizations_url":"https://api.github.com/users/psiinon/orgs","repos_url":"https://api.github.com/users/psiinon/repos","events_url":"https://api.github.com/users/psiinon/events{/privacy}","received_events_url":"https://api.github.com/users/psiinon/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/2531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/2531/timeline","performed_via_github_app":null,"state_reason":"completed"}