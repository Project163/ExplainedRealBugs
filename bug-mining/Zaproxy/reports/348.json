{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6102","repository_url":"https://api.github.com/repos/zaproxy/zaproxy","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6102/labels{/name}","comments_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6102/comments","events_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6102/events","html_url":"https://github.com/zaproxy/zaproxy/issues/6102","id":666524006,"node_id":"MDU6SXNzdWU2NjY1MjQwMDY=","number":6102,"title":"Error starting Active Scan in \"Everything in Scope\" mode.","user":{"login":"mauricew9","id":2752719,"node_id":"MDQ6VXNlcjI3NTI3MTk=","avatar_url":"https://avatars.githubusercontent.com/u/2752719?v=4","gravatar_id":"","url":"https://api.github.com/users/mauricew9","html_url":"https://github.com/mauricew9","followers_url":"https://api.github.com/users/mauricew9/followers","following_url":"https://api.github.com/users/mauricew9/following{/other_user}","gists_url":"https://api.github.com/users/mauricew9/gists{/gist_id}","starred_url":"https://api.github.com/users/mauricew9/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mauricew9/subscriptions","organizations_url":"https://api.github.com/users/mauricew9/orgs","repos_url":"https://api.github.com/users/mauricew9/repos","events_url":"https://api.github.com/users/mauricew9/events{/privacy}","received_events_url":"https://api.github.com/users/mauricew9/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":220063774,"node_id":"MDU6TGFiZWwyMjAwNjM3NzQ=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":220421415,"node_id":"MDU6TGFiZWwyMjA0MjE0MTU=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/Usability","name":"Usability","color":"ededed","default":false,"description":null}],"state":"closed","locked":true,"assignee":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/6","html_url":"https://github.com/zaproxy/zaproxy/milestone/6","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/6/labels","id":4805929,"node_id":"MDk6TWlsZXN0b25lNDgwNTkyOQ==","number":6,"title":"2.10.0","description":"","creator":{"login":"psiinon","id":1081115,"node_id":"MDQ6VXNlcjEwODExMTU=","avatar_url":"https://avatars.githubusercontent.com/u/1081115?v=4","gravatar_id":"","url":"https://api.github.com/users/psiinon","html_url":"https://github.com/psiinon","followers_url":"https://api.github.com/users/psiinon/followers","following_url":"https://api.github.com/users/psiinon/following{/other_user}","gists_url":"https://api.github.com/users/psiinon/gists{/gist_id}","starred_url":"https://api.github.com/users/psiinon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psiinon/subscriptions","organizations_url":"https://api.github.com/users/psiinon/orgs","repos_url":"https://api.github.com/users/psiinon/repos","events_url":"https://api.github.com/users/psiinon/events{/privacy}","received_events_url":"https://api.github.com/users/psiinon/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":62,"state":"closed","created_at":"2019-11-01T17:40:02Z","updated_at":"2020-12-18T14:30:28Z","due_on":null,"closed_at":"2020-12-18T14:30:28Z"},"comments":4,"created_at":"2020-07-27T19:16:09Z","updated_at":"2021-07-12T10:06:36Z","closed_at":"2020-10-15T10:33:18Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Describe the bug**\r\nWith 3 contexts in scope, starting Active Scan in \"Everything in Scope\" mode produces an error, and no scanning occurs. The following is written to the log:\r\n\r\n425550872 [AWT-EventQueue-0] INFO org.parosproxy.paros.core.scanner.Scanner  - scanner started\r\n425550873 [Thread-3781] ERROR org.parosproxy.paros.core.scanner.Scanner  - An error occurred while active scanning:\r\njava.lang.NullPointerException\r\n\tat org.zaproxy.zap.model.StructuralSiteNode.isRoot(StructuralSiteNode.java:77)\r\n\tat org.parosproxy.paros.core.scanner.Scanner.scan(Scanner.java:231)\r\n\tat org.parosproxy.paros.core.scanner.Scanner.run(Scanner.java:208)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Create 3 Contexts, configure each context to be in scope\r\n2. Open the Active Scan wizard\r\n3. For Staring Point field, click Select button and choose the \"Everything in Scope\" option\r\n4. Finish the wizard and click the button to start the scan.\r\n5. Error is written to log (see above) and no scanning takes place.\r\n\r\n**Expected behavior**\r\nExpect Active Scan to run, scanning all URLs currently in scope\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Software versions**\r\n - ZAP: 2.9.0\r\n - OS: Linux Mint 19.3\r\n - Java: openjdk version \"1.8.0_252\"\r\n - Browser: n/a\r\n\r\n**Errors from the zap.log file**\r\n\r\n425550872 [AWT-EventQueue-0] INFO org.parosproxy.paros.core.scanner.Scanner  - scanner started\r\n425550873 [Thread-3781] ERROR org.parosproxy.paros.core.scanner.Scanner  - An error occurred while active scanning:\r\njava.lang.NullPointerException\r\n\tat org.zaproxy.zap.model.StructuralSiteNode.isRoot(StructuralSiteNode.java:77)\r\n\tat org.parosproxy.paros.core.scanner.Scanner.scan(Scanner.java:231)\r\n\tat org.parosproxy.paros.core.scanner.Scanner.run(Scanner.java:208)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n\r\n**Additional context**\r\nn/a\r\n\r\n**Would you like to help fix this issue?**\r\nYes.","closed_by":{"login":"psiinon","id":1081115,"node_id":"MDQ6VXNlcjEwODExMTU=","avatar_url":"https://avatars.githubusercontent.com/u/1081115?v=4","gravatar_id":"","url":"https://api.github.com/users/psiinon","html_url":"https://github.com/psiinon","followers_url":"https://api.github.com/users/psiinon/followers","following_url":"https://api.github.com/users/psiinon/following{/other_user}","gists_url":"https://api.github.com/users/psiinon/gists{/gist_id}","starred_url":"https://api.github.com/users/psiinon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psiinon/subscriptions","organizations_url":"https://api.github.com/users/psiinon/orgs","repos_url":"https://api.github.com/users/psiinon/repos","events_url":"https://api.github.com/users/psiinon/events{/privacy}","received_events_url":"https://api.github.com/users/psiinon/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6102/timeline","performed_via_github_app":null,"state_reason":"completed"}