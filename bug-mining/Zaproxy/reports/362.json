{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6536","repository_url":"https://api.github.com/repos/zaproxy/zaproxy","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6536/labels{/name}","comments_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6536/comments","events_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6536/events","html_url":"https://github.com/zaproxy/zaproxy/issues/6536","id":856009751,"node_id":"MDU6SXNzdWU4NTYwMDk3NTE=","number":6536,"title":"Extensions not stopped nor destroyed when add-on is uninstalled","user":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":220063774,"node_id":"MDU6TGFiZWwyMjAwNjM3NzQ=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":true,"assignee":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/7","html_url":"https://github.com/zaproxy/zaproxy/milestone/7","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/7/labels","id":5632962,"node_id":"MDk6TWlsZXN0b25lNTYzMjk2Mg==","number":7,"title":"2.11.0","description":"","creator":{"login":"kingthorin","id":7570458,"node_id":"MDQ6VXNlcjc1NzA0NTg=","avatar_url":"https://avatars.githubusercontent.com/u/7570458?v=4","gravatar_id":"","url":"https://api.github.com/users/kingthorin","html_url":"https://github.com/kingthorin","followers_url":"https://api.github.com/users/kingthorin/followers","following_url":"https://api.github.com/users/kingthorin/following{/other_user}","gists_url":"https://api.github.com/users/kingthorin/gists{/gist_id}","starred_url":"https://api.github.com/users/kingthorin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingthorin/subscriptions","organizations_url":"https://api.github.com/users/kingthorin/orgs","repos_url":"https://api.github.com/users/kingthorin/repos","events_url":"https://api.github.com/users/kingthorin/events{/privacy}","received_events_url":"https://api.github.com/users/kingthorin/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":57,"state":"closed","created_at":"2020-07-08T14:55:01Z","updated_at":"2021-11-08T21:12:35Z","due_on":null,"closed_at":"2021-11-08T21:12:35Z"},"comments":1,"created_at":"2021-04-12T14:01:01Z","updated_at":"2021-07-13T01:26:00Z","closed_at":"2021-04-13T15:07:24Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Describe the bug**\r\nThe extensions are not stopped nor destroyed when the corresponding add-on is uninstalled, preventing the extensions from properly terminate or clean up their resources.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behaviour:\r\n1. Fuzz a message (e.g. send 10k empty payloads).\r\n2. While the fuzzer is running uninstall the Fuzz add-on;\r\n3. Note that in the log there are some errors (as the fuzzer extension was not destroyed).\r\n\r\n**Expected behaviour**\r\nThe extension should be stopped and destroyed when the corresponding add-on is uninstalled.\r\n\r\n**Software versions**\r\n - ZAP: 2.10.0\r\n\r\n**Errors from the zap.log file**\r\n```\r\n475223 [ZAP-FuzzerThreadPool-0-thread-3] ERROR org.zaproxy.zap.utils.I18N - Failed to load a message:\r\njava.util.MissingResourceException: Can't find resource for bundle java.util.PropertyResourceBundle, key fuzz.httpfuzzer.messagetype.result\r\n\tat java.util.ResourceBundle.getObject(ResourceBundle.java:564) ~[?:?]\r\n\tat java.util.ResourceBundle.getString(ResourceBundle.java:521) ~[?:?]\r\n\tat org.zaproxy.zap.utils.I18N.getStringImpl(I18N.java:185) [zap-2.10.0.jar:2.10.0]\r\n\tat org.zaproxy.zap.utils.I18N.getString(I18N.java:149) [zap-2.10.0.jar:2.10.0]\r\n\tat org.zaproxy.zap.extension.fuzz.httpfuzzer.HttpFuzzerTask.runImpl(HttpFuzzerTask.java:59) [fuzz-beta-13.1.0.zap:?]\r\n\tat org.zaproxy.zap.extension.fuzz.httpfuzzer.HttpFuzzerTask.runImpl(HttpFuzzerTask.java:30) [fuzz-beta-13.1.0.zap:?]\r\n\tat org.zaproxy.zap.extension.fuzz.AbstractFuzzerTask.run(AbstractFuzzerTask.java:56) [fuzz-beta-13.1.0.zap:?]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n\tat java.lang.Thread.run(Thread.java:834) [?:?]\r\n501048 [ZAP-FuzzerThreadPool-0-thread-5] ERROR org.zaproxy.zap.ZAP.UncaughtExceptionLogger - Exception in thread \"ZAP-FuzzerThreadPool-0-thread-5\"\r\njava.lang.NoClassDefFoundError: org/zaproxy/zap/extension/fuzz/AbstractFuzzer$ExecutorTerminatedListenerImpl$1\r\n\tat org.zaproxy.zap.extension.fuzz.AbstractFuzzer$ExecutorTerminatedListenerImpl.terminated(AbstractFuzzer.java:664) ~[?:?]\r\n\tat org.zaproxy.zap.utils.PausableThreadPoolExecutor.notifyListeners(PausableThreadPoolExecutor.java:276) ~[zap-2.10.0.jar:2.10.0]\r\n\tat org.zaproxy.zap.utils.PausableThreadPoolExecutor.terminated(PausableThreadPoolExecutor.java:266) ~[zap-2.10.0.jar:2.10.0]\r\n\tat java.util.concurrent.ThreadPoolExecutor.tryTerminate(ThreadPoolExecutor.java:718) ~[?:?]\r\n\tat java.util.concurrent.ThreadPoolExecutor.processWorkerExit(ThreadPoolExecutor.java:994) ~[?:?]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[?:?]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[?:?]\r\n\tat java.lang.Thread.run(Thread.java:834) [?:?]\r\nCaused by: java.lang.ClassNotFoundException\r\n\tat org.zaproxy.zap.control.AddOnClassLoader.findClass(AddOnClassLoader.java:330) ~[zap-2.10.0.jar:2.10.0]\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:589) ~[?:?]\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:522) ~[?:?]\r\n\t... 8 more\r\n```","closed_by":{"login":"kingthorin","id":7570458,"node_id":"MDQ6VXNlcjc1NzA0NTg=","avatar_url":"https://avatars.githubusercontent.com/u/7570458?v=4","gravatar_id":"","url":"https://api.github.com/users/kingthorin","html_url":"https://github.com/kingthorin","followers_url":"https://api.github.com/users/kingthorin/followers","following_url":"https://api.github.com/users/kingthorin/following{/other_user}","gists_url":"https://api.github.com/users/kingthorin/gists{/gist_id}","starred_url":"https://api.github.com/users/kingthorin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingthorin/subscriptions","organizations_url":"https://api.github.com/users/kingthorin/orgs","repos_url":"https://api.github.com/users/kingthorin/repos","events_url":"https://api.github.com/users/kingthorin/events{/privacy}","received_events_url":"https://api.github.com/users/kingthorin/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6536/timeline","performed_via_github_app":null,"state_reason":"completed"}