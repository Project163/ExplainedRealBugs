{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/5490","repository_url":"https://api.github.com/repos/zaproxy/zaproxy","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/5490/labels{/name}","comments_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/5490/comments","events_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/5490/events","html_url":"https://github.com/zaproxy/zaproxy/issues/5490","id":472199086,"node_id":"MDU6SXNzdWU0NzIxOTkwODY=","number":5490,"title":"Anti-CSRF tokens not encoded in authentication requests","user":{"login":"mrtc0","id":5842353,"node_id":"MDQ6VXNlcjU4NDIzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/5842353?v=4","gravatar_id":"","url":"https://api.github.com/users/mrtc0","html_url":"https://github.com/mrtc0","followers_url":"https://api.github.com/users/mrtc0/followers","following_url":"https://api.github.com/users/mrtc0/following{/other_user}","gists_url":"https://api.github.com/users/mrtc0/gists{/gist_id}","starred_url":"https://api.github.com/users/mrtc0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrtc0/subscriptions","organizations_url":"https://api.github.com/users/mrtc0/orgs","repos_url":"https://api.github.com/users/mrtc0/repos","events_url":"https://api.github.com/users/mrtc0/events{/privacy}","received_events_url":"https://api.github.com/users/mrtc0/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":220063774,"node_id":"MDU6TGFiZWwyMjAwNjM3NzQ=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":true,"assignee":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/5","html_url":"https://github.com/zaproxy/zaproxy/milestone/5","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/milestones/5/labels","id":2409992,"node_id":"MDk6TWlsZXN0b25lMjQwOTk5Mg==","number":5,"title":"2.9.0","description":"Enhancements and bug fixes expected to be included in a following main release.","creator":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":58,"state":"closed","created_at":"2017-03-24T19:44:20Z","updated_at":"2020-01-18T15:51:51Z","due_on":null,"closed_at":"2020-01-18T15:51:51Z"},"comments":5,"created_at":"2019-07-24T10:16:12Z","updated_at":"2019-10-31T14:09:20Z","closed_at":"2019-08-01T09:30:05Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Describe the bug**\r\n\r\n`+` is not escape to `%2b` in `authorized_token` .\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Run follow script\r\n\r\n```python\r\nfrom zapv2 import ZAPv2\r\n\r\ntarget = 'https://localhost/'\r\napikey = 'key'\r\ncontext = \"sample\"\r\n\r\nzap = ZAPv2(apikey=apikey)\r\n\r\nzap.urlopen(target)\r\n\r\nauthmethodname = 'formBasedAuthentication'\r\nauthmethodconfigparams = \"loginUrl=https://localhost/users/sign_in&loginRequestData=authenticity_token%3DBGF5HtOISJkEnm6pX27cZ8jO8oFkX091k8VOrDO79oSBNOWiPvypguaxSzwDdVma1EH1g7p1w3sLKf%252FTrFXOdA%253D%253D%26user%255Bemail%255D%3D%7B%25username%25%7D%26user%255Bpassword%255D%3D%7B%25password%25%7D%26signin_return_to%3D%26commit%3DLogin%26user%255Bremember_me%255D%3D0\"\r\n\r\nzap.core.new_session()\r\ncontextid = zap.context.new_context(context)\r\nprint(contextid)\r\nprint(zap.context.include_in_context(context, 'https://localhost.*'))\r\n\r\nprint(zap.context.context(context))\r\nprint(zap.authentication.set_authentication_method(contextid, authmethodname, authmethodconfigparams))\r\nprint(zap.authentication.set_logged_in_indicator(contextid, loggedinindicatorregex='\\QYou are being\\E'))\r\nuserid = zap.users.new_user(contextid, 'user1')\r\nprint(userid)\r\nprint(zap.users.set_authentication_credentials(contextid, userid, 'username=username&password=password'))\r\nprint(zap.users.set_user_enabled(contextid, userid, True))\r\n\r\nzap.spider.scan_as_user(contextid, userid, target)\r\n```\r\n\r\n2. See History\r\n\r\nif `+` not contains in `authorized_token`, loggin successful.\r\nbut if contains '+' in authorized_token, login failed ( `422 Unprocessable Entity` ). because, `+` is not escaped to `%2b` .\r\n\r\n**Expected behavior**\r\n\r\n`+` will encode to `%2b`, loggin success.\r\n\r\n**Screenshots**\r\n\r\n- `+` is not encoded when response code is 422\r\n\r\n![Screenshot from 2019-07-24 19-03-42](https://user-images.githubusercontent.com/5842353/61785448-aaeb4580-ae46-11e9-9acf-eab649be067b.png)\r\n\r\n- `+` is encode to `%2b` when response code is 302\r\n\r\n![Screenshot from 2019-07-24 19-03-52](https://user-images.githubusercontent.com/5842353/61785449-ab83dc00-ae46-11e9-8a58-cdb82d02bead.png)\r\n\r\n**Software versions**\r\n - ZAP: 2.8.0\r\n - OS: Arch Linux 5.2.0-arch2-1-ARCH\r\n - Java: 12.0.1\r\n\r\n**Additional context**\r\n\r\nPlease show me how to if any parameter can encode.","closed_by":{"login":"psiinon","id":1081115,"node_id":"MDQ6VXNlcjEwODExMTU=","avatar_url":"https://avatars.githubusercontent.com/u/1081115?v=4","gravatar_id":"","url":"https://api.github.com/users/psiinon","html_url":"https://github.com/psiinon","followers_url":"https://api.github.com/users/psiinon/followers","following_url":"https://api.github.com/users/psiinon/following{/other_user}","gists_url":"https://api.github.com/users/psiinon/gists{/gist_id}","starred_url":"https://api.github.com/users/psiinon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psiinon/subscriptions","organizations_url":"https://api.github.com/users/psiinon/orgs","repos_url":"https://api.github.com/users/psiinon/repos","events_url":"https://api.github.com/users/psiinon/events{/privacy}","received_events_url":"https://api.github.com/users/psiinon/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/5490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/5490/timeline","performed_via_github_app":null,"state_reason":"completed"}