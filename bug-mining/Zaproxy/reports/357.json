{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6443","repository_url":"https://api.github.com/repos/zaproxy/zaproxy","labels_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6443/labels{/name}","comments_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6443/comments","events_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6443/events","html_url":"https://github.com/zaproxy/zaproxy/issues/6443","id":802680909,"node_id":"MDU6SXNzdWU4MDI2ODA5MDk=","number":6443,"title":"mozilla.net appears in the report even though excluded with globalexcludeurl.url_list.url.regex","user":{"login":"kiwimato","id":56123381,"node_id":"MDQ6VXNlcjU2MTIzMzgx","avatar_url":"https://avatars.githubusercontent.com/u/56123381?v=4","gravatar_id":"","url":"https://api.github.com/users/kiwimato","html_url":"https://github.com/kiwimato","followers_url":"https://api.github.com/users/kiwimato/followers","following_url":"https://api.github.com/users/kiwimato/following{/other_user}","gists_url":"https://api.github.com/users/kiwimato/gists{/gist_id}","starred_url":"https://api.github.com/users/kiwimato/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kiwimato/subscriptions","organizations_url":"https://api.github.com/users/kiwimato/orgs","repos_url":"https://api.github.com/users/kiwimato/repos","events_url":"https://api.github.com/users/kiwimato/events{/privacy}","received_events_url":"https://api.github.com/users/kiwimato/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":220063774,"node_id":"MDU6TGFiZWwyMjAwNjM3NzQ=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":678291375,"node_id":"MDU6TGFiZWw2NzgyOTEzNzU=","url":"https://api.github.com/repos/zaproxy/zaproxy/labels/Docker","name":"Docker","color":"8B4513","default":false,"description":null}],"state":"closed","locked":true,"assignee":{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"thc202","id":4639210,"node_id":"MDQ6VXNlcjQ2MzkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4639210?v=4","gravatar_id":"","url":"https://api.github.com/users/thc202","html_url":"https://github.com/thc202","followers_url":"https://api.github.com/users/thc202/followers","following_url":"https://api.github.com/users/thc202/following{/other_user}","gists_url":"https://api.github.com/users/thc202/gists{/gist_id}","starred_url":"https://api.github.com/users/thc202/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thc202/subscriptions","organizations_url":"https://api.github.com/users/thc202/orgs","repos_url":"https://api.github.com/users/thc202/repos","events_url":"https://api.github.com/users/thc202/events{/privacy}","received_events_url":"https://api.github.com/users/thc202/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":6,"created_at":"2021-02-06T11:37:35Z","updated_at":"2021-07-12T08:01:42Z","closed_at":"2021-02-10T16:07:34Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Describe the bug**\r\nTrying to use API scan against and API I get mozilla.net urls in the report, even though it's excluded. Note: Even after running with `-d` I am not able to find anything that leads to mozilla.net, so what I don't understand is why it ends up in the XML report. I also tried a bunch of different regexes and all appear to be ignored.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Run the owasp/zap2docker-stable image with `-z \"-config globalexcludeurl.url_list.url.regex='https?:\\/\\/.*mozilla\\.net\\/.*'\"`\r\n2. Wait for it to complete\r\n3. Scroll down to logs and cat report file.\r\n4. See mozilla.net included in zap.log section below\r\n\r\n**Expected behavior**\r\nThe mozilla.net urls should not be included in the report at all.\r\n\r\n**Software versions**\r\n - ZAP: owasp/zap2docker-stable zap-api-scan.py\r\n - Add-on: Name and version [e.g. Passive Scan Rules Alpha v19. https://www.zaproxy.org/faq/how-do-i-see-what-version-of-an-add-on-extension-i-have-installed/]\r\n - OS: Linux/Docker\r\n - Java: [e.g. openjdk version \"1.8.0_171\"]\r\n - Browser: Firefox the Docker image uses\r\n\r\n**Errors from the zap.log file**\r\n```\r\n<Snip>\r\n2021-02-06T00:35:29.9852579Z 2021-02-06 00:35:29,981 Starting ZAP\r\n2021-02-06T00:35:29.9854483Z 2021-02-06 00:35:29,981 Params: ['zap-x.sh', '-daemon', '-port', '52443', '-host', '0.0.0.0', '-config', 'database.recoverylog=false', '-config', 'api.disablekey=true', '-config', 'api.addrs.addr.name=.*', '-config', 'api.addrs.addr.regex=true', '-addonupdate', '-addoninstall', 'pscanrulesBeta', '-config', 'rules.cookie.ignorelist=AWSALB,AWSALBCORS', '-config', 'globalexcludeurl.url_list.url.regex=https?:\\\\/\\\\/.*mozilla\\\\.net\\\\/.*']\r\n2021-02-06T00:35:29.9880505Z 2021-02-06 00:35:29,985 Starting new HTTP connection (1): localhost:52443\r\n2021-02-06T00:35:30.9900804Z 2021-02-06 00:35:30,989 Starting new HTTP connection (1): localhost:52443\r\n<snip>\r\n2021-02-06T00:40:06.8136579Z PASS: Loosely Scoped Cookie [90033]\r\n2021-02-06T00:40:06.8137267Z WARN-NEW: Unexpected Content-Type was returned [100001] x 1 \r\n2021-02-06T00:40:06.8137848Z \thttps://REDACTED.com/swagger/index.html (200 OK)\r\n2021-02-06T00:40:06.8138428Z WARN-NEW: Incomplete or No Cache-control and Pragma HTTP Header Set [10015] x 1 \r\n2021-02-06T00:40:06.8139054Z \thttps://REDACTED.com/swagger/v1/swagger.json (200 OK)\r\n2021-02-06T00:40:06.8139599Z WARN-NEW: X-Content-Type-Options Header Missing [10021] x 1 \r\n2021-02-06T00:40:06.8140170Z \thttps://REDACTED.com/swagger/v1/swagger.json (200 OK)\r\n2021-02-06T00:40:06.8140737Z WARN-NEW: Strict-Transport-Security Header Not Set [10035] x 7 \r\n2021-02-06T00:40:06.8141442Z \thttps://REDACTED.com/swagger/v1/swagger.json (200 OK)\r\n2021-02-06T00:40:06.8142226Z \thttps://REDACTED.com/accounts/id/quotes?api-version=api-version (401 Unauthorized)\r\n2021-02-06T00:40:06.8143192Z \thttps://REDACTED.com/accounts/id?api-version=api-version (401 Unauthorized)\r\n2021-02-06T00:40:06.8143920Z \thttps://REDACTED.com/accounts/id?api-version=api-version (401 Unauthorized)\r\n2021-02-06T00:40:06.8144786Z \thttps://REDACTED.com/accounts/id/rules?api-version=api-version (401 Unauthorized)\r\n2021-02-06T00:40:06.8145462Z FAIL-NEW: 0\tFAIL-INPROG: 0\tWARN-NEW: 4\tWARN-INPROG: 0\tINFO: 0\tIGNORE: 0\tPASS: 73\r\n2021-02-06T00:40:07.5139399Z <?xml version=\"1.0\"?><OWASPZAPReport version=\"2.10.0\" generated=\"Sat, 6 Feb 2021 00:40:06\">\r\n2021-02-06T00:40:07.5139934Z <site name=\"https://snippets.cdn.mozilla.net\" host=\"snippets.cdn.mozilla.net\" port=\"443\" ssl=\"true\"><alerts><alertitem>\r\n2021-02-06T00:40:07.5140305Z   <pluginid>100001</pluginid>\r\n2021-02-06T00:40:07.5140548Z   <alertRef>100001</alertRef>\r\n2021-02-06T00:40:07.5141326Z   <alert>Unexpected Content-Type was returned</alert>\r\n2021-02-06T00:40:07.5141768Z   <name>Unexpected Content-Type was returned</name>\r\n2021-02-06T00:40:07.5142038Z   <riskcode>1</riskcode>\r\n2021-02-06T00:40:07.5142443Z   <confidence>3</confidence>\r\n2021-02-06T00:40:07.5142882Z   <riskdesc>Low (High)</riskdesc>\r\n2021-02-06T00:40:07.5143749Z   <desc>&lt;p&gt;A Content-Type of text/html was returned by the server.&lt;/p&gt;&lt;p&gt;This is not one of the types expected to be returned by an API.&lt;/p&gt;&lt;p&gt;Raised by the &apos;Alert on Unexpected Content Types&apos; script&lt;/p&gt;</desc>\r\n2021-02-06T00:40:07.5144291Z   <instances>\r\n2021-02-06T00:40:07.5144481Z   <instance>\r\n2021-02-06T00:40:07.5145214Z   <uri>https://snippets.cdn.mozilla.net/6/Firefox/85.0/20210118153634/Linux_x86_64-gcc3/en-US/release-cck-ubuntu/Linux%205.4.0-1039-azure%20(GTK%203.24.20%2Clibpulse%20not-available)/canonical/1.0/</uri>\r\n2021-02-06T00:40:07.5145696Z   <method>GET</method>\r\n2021-02-06T00:40:07.5146114Z   <evidence>text/html</evidence>\r\n2021-02-06T00:40:07.5146333Z   </instance>\r\n2021-02-06T00:40:07.5146525Z   </instances>\r\n```\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n\r\n**Would you like to help fix this issue?**\r\nSure, I'd love to.","closed_by":{"login":"kingthorin","id":7570458,"node_id":"MDQ6VXNlcjc1NzA0NTg=","avatar_url":"https://avatars.githubusercontent.com/u/7570458?v=4","gravatar_id":"","url":"https://api.github.com/users/kingthorin","html_url":"https://github.com/kingthorin","followers_url":"https://api.github.com/users/kingthorin/followers","following_url":"https://api.github.com/users/kingthorin/following{/other_user}","gists_url":"https://api.github.com/users/kingthorin/gists{/gist_id}","starred_url":"https://api.github.com/users/kingthorin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingthorin/subscriptions","organizations_url":"https://api.github.com/users/kingthorin/orgs","repos_url":"https://api.github.com/users/kingthorin/repos","events_url":"https://api.github.com/users/kingthorin/events{/privacy}","received_events_url":"https://api.github.com/users/kingthorin/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/zaproxy/zaproxy/issues/6443/timeline","performed_via_github_app":null,"state_reason":"completed"}