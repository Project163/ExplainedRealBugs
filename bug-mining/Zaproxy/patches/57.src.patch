diff --git a/src/lang/Messages.properties b/src/lang/Messages.properties
index 53fa91be8..b081790ce 100644
--- a/src/lang/Messages.properties
+++ b/src/lang/Messages.properties
@@ -44,10 +44,12 @@ all.button.cancel = Cancel
 all.button.close  = Close
 all.button.ok     = OK
 all.button.pin    = Pin tab
+all.button.remove = Remove
 all.button.save   = Save
 all.button.select = Select...
 all.button.unpin  = Unpin tab
 
+all.prompt.dontshow = Do not show this message again
 
 anticsrf.desc = Handles anti cross site request forgery (CSRF) tokens
 anticsrf.genForm.popup      = Generate anti CSRF test FORM
@@ -732,6 +734,27 @@ context.allInScope				   = Everything in scope
 context.create.title			   = New Context
 context.create.warning.noname      = You must supply a context name
 context.general                    = Context
+context.ddn.dialog.add.title       = Add Data Driven Node
+context.ddn.dialog.modify.title    = Modify Data Driven Node
+context.ddn.dialog.remove.text     = Are you sure you want to remove the selected Structural Modifier?
+context.ddn.dialog.remove.title    = Remove Structural Modifier
+
+
+context.ddn.dialog.type            = Type:
+context.ddn.dialog.type.data       = Data Driven Node
+context.ddn.dialog.type.struct     = Structural Parameter
+context.ddn.dialog.regex           = Regex definition:
+context.ddn.dialog.name            = Name:
+context.ddn.dialog.error.name      = You must supply a name that contains only alpha numeric characters
+context.ddn.dialog.error.regex     = You must supply a valid regex pattern that includes 2 or 3 regex groups.\nSee the help for more information 
+
+context.ddn.table.header.type      = Type
+context.ddn.table.header.regex     = Regex
+context.ddn.table.header.name      = Name
+
+context.ddn.table.type.data        = Data
+context.ddn.table.type.struct      = Struct
+
 context.default.name			   = Default Context
 context.delete.popup			   = Delete
 context.delete.warning			   = Are you sure you want to remove this context?
@@ -739,6 +762,7 @@ context.exclude.popup              = Exclude from Context
 context.export.error			   = Failed to export Context:\n{0}
 context.export.tooltip			   = Select one Context in order to export it 
 context.flag.popup                 = Flag as Context 
+context.flag.popup.datadriven      = {0} : Data driven node
 context.include.popup              = Include in Context
 context.import.error			   = Failed to import Context:\n{0}
 context.import.error.exists		   = The file exists and 'overwrite' not selected
@@ -767,12 +791,11 @@ context.prefixName				   = Context: {0}
 context.outscope.popup			   = Remove from scope
 context.scope.exclude.title        = Exclude from context
 context.scope.include.title        = Include in context
-context.struct.label.post.kvpsep   = POST Key value pair separators
-context.struct.label.post.kvsep	   = POST Key value separators
-context.struct.label.struct		   = Structural Parameters
-context.struct.label.url.kvpsep	   = URL Key value pair separators
-context.struct.label.url.kvsep	   = URL Key value separators
-context.struct.table.header.param  = Parameter name
+context.struct.label.post.kvpsep   = POST Key value pair separators:
+context.struct.label.post.kvsep	   = POST Key value separators:
+context.struct.label.struct		   = Structural Modifiers:
+context.struct.label.url.kvpsep	   = URL Key value pair separators:
+context.struct.label.url.kvsep	   = URL Key value separators:
 context.struct.warning.stdparser.dup = The Key value pair separators and Key value separators must not contain the same characters
 context.struct.warning.stdparser.nokvpsep = You must supply at least one Key value pair separator
 context.struct.warning.stdparser.nokvsep = You must supply at least one Key value separator
diff --git a/src/org/parosproxy/paros/core/scanner/Scanner.java b/src/org/parosproxy/paros/core/scanner/Scanner.java
index e51dfea79..17c711c6d 100644
--- a/src/org/parosproxy/paros/core/scanner/Scanner.java
+++ b/src/org/parosproxy/paros/core/scanner/Scanner.java
@@ -36,6 +36,7 @@
 // ZAP: 2014/11/19 Issue 1412: Manage scan policies
 // ZAP: 2015/02/18 Issue 1062: Tidied up extension hooks
 // ZAP: 2015/04/02 Issue 1582: Low memory option
+// ZAP: 2015/10/21 Issue 1576: Removed SiteNode cast no longer needed
 
 package org.parosproxy.paros.core.scanner;
 
@@ -277,10 +278,10 @@ public class Scanner implements Runnable {
 	        result = "";
 	    } else {
 	        SiteNode curNode = node;
-	        parent = (SiteNode) node.getParent();
+	        parent = node.getParent();
 	        while (!parent.isRoot()) {
 	            curNode = parent;
-	            parent = (SiteNode) curNode.getParent();
+	            parent = curNode.getParent();
 	        }
 	        result = curNode.getNodeName();
 	    }
diff --git a/src/org/parosproxy/paros/db/RecordContext.java b/src/org/parosproxy/paros/db/RecordContext.java
index 843a02d2a..ce9fd52ae 100644
--- a/src/org/parosproxy/paros/db/RecordContext.java
+++ b/src/org/parosproxy/paros/db/RecordContext.java
@@ -66,6 +66,7 @@ public class RecordContext {
 	public static final int TYPE_URL_PARSER_CONFIG = 401;
 	public static final int TYPE_POST_PARSER_CLASSNAME = 402;
 	public static final int TYPE_POST_PARSER_CONFIG = 403;
+	public static final int TYPE_DATA_DRIVEN_NODES = 404;
 	
 	public static final int TYPE_ACCESS_CONTROL_RULE = 410;
 	
diff --git a/src/org/parosproxy/paros/model/Session.java b/src/org/parosproxy/paros/model/Session.java
index a6875722f..6b84c50b8 100644
--- a/src/org/parosproxy/paros/model/Session.java
+++ b/src/org/parosproxy/paros/model/Session.java
@@ -51,7 +51,8 @@
 // ZAP: 2015/02/09 Issue 1525: Introduce a database interface layer to allow for alternative implementations
 // ZAP: 2015/04/02 Issue 321: Support multiple databases and Issue 1582: Low memory option
 // ZAP: 2015/08/19 Change to use ZapXmlConfiguration instead of extending FileXML
-// ZAP: 2015/08/19 Issue 1789: Forced Browse/AJAX Spider messages not restored to Sites tab
+// ZAP: 2015/08/19 Issue 1789: Forced Browse/AJAX Spider messages not restored to Sites tab
+// ZAP: 2015/10/21 Issue 1576: Support data driven content
 
 package org.parosproxy.paros.model;
 
@@ -88,6 +89,7 @@ import org.zaproxy.zap.extension.spider.ExtensionSpider;
 import org.zaproxy.zap.model.Context;
 import org.zaproxy.zap.model.ParameterParser;
 import org.zaproxy.zap.model.StandardParameterParser;
+import org.zaproxy.zap.model.StructuralNodeModifier;
 import org.zaproxy.zap.model.Tech;
 import org.zaproxy.zap.model.TechSet;
 import org.zaproxy.zap.utils.ZapXmlConfiguration;
@@ -406,6 +408,7 @@ public class Session {
 				    	if (strs.size() == 1) {
 				    		parser.init(strs.get(0));
 				    	}
+				    	parser.setContext(ctx);
 				    	ctx.setUrlParamParser(parser);
 					}
 				}
@@ -425,12 +428,25 @@ public class Session {
 				    	if (strs.size() == 1) {
 				    		parser.init(strs.get(0));
 				    	}
+				    	parser.setContext(ctx);
 				    	ctx.setPostParamParser(parser);
 					}
 				}
 			} catch (Exception e) {
 				log.error("Failed to load POST parser for context " + ctx.getIndex(), e);
 			}
+	    	
+	    	try {
+	    		// Set up the Data Driven Nodes
+				List<String> strs = this.getContextDataStrings(ctx.getIndex(), RecordContext.TYPE_DATA_DRIVEN_NODES);
+				for (String str : strs) {
+					ctx.addDataDrivenNodes(new StructuralNodeModifier(str));
+				}
+			} catch (Exception e) {
+				log.error("Failed to load data driven nodes for context " + ctx.getIndex(), e);
+			}
+	    	
+	    	ctx.restructureSiteTree();
 		}
 		
 		if (View.isInitialised()) {
@@ -1078,6 +1094,14 @@ public class Session {
 		return strList;
 	}
 	
+	private List<String> snmListToStringList (List<StructuralNodeModifier> list) {
+		List<String> strList = new ArrayList<>();
+		for (StructuralNodeModifier snm : list) {
+			strList.add(snm.getConfig());
+		}
+		return strList;
+	}
+	
 	public void saveContext (Context c) {
 		try {
 			this.setContextData(c.getIndex(), RecordContext.TYPE_NAME, c.getName());
@@ -1093,6 +1117,9 @@ public class Session {
 			this.setContextData(c.getIndex(), RecordContext.TYPE_POST_PARSER_CLASSNAME, 
 					c.getPostParamParser().getClass().getCanonicalName());
 			this.setContextData(c.getIndex(), RecordContext.TYPE_POST_PARSER_CONFIG, c.getPostParamParser().getConfig());
+			this.setContextData(c.getIndex(), RecordContext.TYPE_DATA_DRIVEN_NODES, 
+					snmListToStringList(c.getDataDrivenNodes()));
+
 			model.saveContext(c);
 		} catch (DatabaseException e) {
             log.error(e.getMessage(), e);
@@ -1221,6 +1248,10 @@ public class Session {
 		config.setProperty(Context.CONTEXT_CONFIG_URLPARSER_CONFIG, c.getUrlParamParser().getConfig());
 		config.setProperty(Context.CONTEXT_CONFIG_POSTPARSER_CLASS, c.getPostParamParser().getClass().getCanonicalName());
 		config.setProperty(Context.CONTEXT_CONFIG_POSTPARSER_CONFIG, c.getPostParamParser().getConfig());
+		for (StructuralNodeModifier snm : c.getDataDrivenNodes()) {
+			config.setProperty(Context.CONTEXT_CONFIG_DATA_DRIVEN_NODES, snm.getConfig());
+		}
+		
 		model.exportContext(c, config);
 		config.save(file);
 	}
@@ -1272,6 +1303,7 @@ public class Session {
 		} else {
 			ParameterParser parser = (ParameterParser) cl.getConstructor().newInstance();
     		parser.init(config.getString(Context.CONTEXT_CONFIG_URLPARSER_CONFIG));
+    		parser.setContext(c);
 	    	c.setUrlParamParser(parser);
 		}
 
@@ -1288,9 +1320,17 @@ public class Session {
 		} else {
 			ParameterParser parser = (ParameterParser) cl.getConstructor().newInstance();
     		parser.init(postParserConfig);
+    		parser.setContext(c);
 	    	c.setPostParamParser(parser);
 		}
+		for (Object obj : config.getList(Context.CONTEXT_CONFIG_DATA_DRIVEN_NODES)) {
+			c.addDataDrivenNodes(new StructuralNodeModifier(obj.toString()));
+		}
+
 		model.importContext(c, config);
+		
+		c.restructureSiteTree();
+		
 		Model.getSingleton().getSession().saveContext(c);
 		return c;
 	}
diff --git a/src/org/parosproxy/paros/model/SiteMap.java b/src/org/parosproxy/paros/model/SiteMap.java
index 4d4eef378..2afd39b1b 100644
--- a/src/org/parosproxy/paros/model/SiteMap.java
+++ b/src/org/parosproxy/paros/model/SiteMap.java
@@ -44,6 +44,7 @@
 // ZAP: 2015/04/02 Issue 1582: Low memory option
 // ZAP: 2015/08/19 Change to cope with deprecation of HttpMessage.getParamNameSet(HtmlParameter.Type, String)
 // ZAP: 2015/08/19 Issue 1784: NullPointerException when active scanning through the API with a target without scheme
+// ZAP: 2015/10/21 Issue 1576: Support data driven content
 
 package org.parosproxy.paros.model;
 
@@ -594,10 +595,23 @@ public class SiteMap extends DefaultTreeModel {
         TreeNode[] path = node.getPath();
         StringBuilder sb = new StringBuilder();
         String nodeName;
+        String [] origPath = baseRef.getURI().getPath().split("/");
         for (int i=1; i<path.length; i++) {
         	// ZAP Cope with error counts in the node names
         	nodeName = ((SiteNode)path[i]).getNodeName();
-            sb.append(nodeName);
+        	if (((SiteNode)path[i]).isDataDriven()) {
+            	// Retrieve original name..
+            	if (origPath.length > i-1) {
+            		log.debug("Replace Data Driven element " + nodeName + " with " + origPath[i-1]);
+            		sb.append(origPath[i-1]);
+            	} else {
+            		log.error("Failed to determine original node name for element " + i +
+            				nodeName + " original request: " + baseRef.getURI().toString());
+                    sb.append(nodeName);
+            	}
+            } else {
+                sb.append(nodeName);
+            }
             if (i<path.length-1) {
                 sb.append('/');
             }
@@ -696,7 +710,7 @@ public class SiteMap extends DefaultTreeModel {
 	protected void applyFilter (SiteNode node) {
     	if (filter != null) {
     		boolean filtered = this.setFilter(filter, node);
-    		SiteNode parent = ((SiteNode)node.getParent());
+    		SiteNode parent = node.getParent();
     		if (parent != null && ! filtered && parent.isFiltered()) {
     			// This node is no longer filtered but its parent is, unfilter the parent so it becomes visible
     			this.clearParentFilter(parent);
@@ -713,7 +727,7 @@ public class SiteMap extends DefaultTreeModel {
 	private void clearParentFilter (SiteNode parent) {
 		if (parent != null) {
 			parent.setFiltered(false);
-			clearParentFilter((SiteNode)parent.getParent());
+			clearParentFilter(parent.getParent());
 		}
 	}
 
diff --git a/src/org/parosproxy/paros/model/SiteNode.java b/src/org/parosproxy/paros/model/SiteNode.java
index d9668a2ae..a50f06896 100644
--- a/src/org/parosproxy/paros/model/SiteNode.java
+++ b/src/org/parosproxy/paros/model/SiteNode.java
@@ -44,6 +44,7 @@
 // ZAP: 2014/11/19 Issue 1412: Prevent ConcurrentModificationException when icons updated frequently
 // ZAP: 2014/12/17 Issue 1174: Support a Site filter
 // ZAP: 2015/04/02 Issue 1582: Low memory option
+// ZAP: 2015/10/21 Issue 1576: Support data driven content
 
 package org.parosproxy.paros.model;
 
@@ -59,6 +60,7 @@ import org.apache.commons.lang.StringEscapeUtils;
 import org.apache.log4j.Logger;
 import org.parosproxy.paros.Constant;
 import org.parosproxy.paros.core.scanner.Alert;
+import org.zaproxy.zap.model.SessionStructure;
 
 public class SiteNode extends DefaultMutableTreeNode {
 
@@ -80,11 +82,15 @@ public class SiteNode extends DefaultMutableTreeNode {
     private boolean isIncludedInScope = false;
     private boolean isExcludedFromScope = false;
     private boolean filtered = false;
-	
+    private boolean dataDriven = false;
+
     public SiteNode(SiteMap siteMap, int type, String nodeName) {
         super();
         this.siteMap = siteMap;
 		this.nodeName = nodeName;
+		if (nodeName.startsWith(SessionStructure.DATA_DRIVEN_NODE_PREFIX)) {
+			this.dataDriven = true; 
+		}
 		this.icons = new ArrayList<>();
 		this.clearIfManual = new ArrayList<>();
 		if (type == HistoryReference.TYPE_SPIDER) {
@@ -171,37 +177,60 @@ public class SiteNode extends DefaultMutableTreeNode {
     public String getNodeName() {
     	return this.nodeName;
     }
-    
+
+    public String getCleanNodeName() {
+    	return getCleanNodeName(true);
+    }
+
+    public String getCleanNodeName(boolean specialNodesAsRegex) {
+    	String name = this.getNodeName();
+    	if (specialNodesAsRegex && this.isDataDriven()) {
+    		// Non-greedy regex pattern 
+			name = "(.+?)";
+
+    	} else if (this.isLeaf()) {
+    		int colonIndex = name.indexOf(":");
+    		if (colonIndex > 0) {
+    			// Strip the GET/POST etc off
+    			name = name.substring(colonIndex+1);
+    		}
+    		int bracketIndex = name.lastIndexOf("(");
+    		if (bracketIndex > 0) {
+    			// Strip the param summary off
+    			name = name.substring(0, bracketIndex);
+    		}
+    		int quesIndex = name.indexOf("?");
+    		if (quesIndex > 0) {
+    			// Strip the parameters off
+    			name = name.substring(0, quesIndex);
+    		}
+    	}
+    	return name;
+    }
+
     public String getHierarchicNodeName() {
-		if (hierarchicNodeName != null) {
+    	return getHierarchicNodeName(true);
+    }
+
+    public String getHierarchicNodeName(boolean specialNodesAsRegex) {
+		if (hierarchicNodeName != null && specialNodesAsRegex) {
+			// The regex version is used most frequently, so cache
 			return hierarchicNodeName;
 		}
 
     	if (this.isRoot()) {
     		hierarchicNodeName = "";
-    	} else if (((SiteNode)this.getParent()).isRoot()) {
+    	} else if (this.getParent().isRoot()) {
     		hierarchicNodeName = this.getNodeName();
     	} else {
-	    	String nodeName = this.getNodeName();
-	    	if (this.isLeaf()) {
-	    		// Need to clean up
-	    		int colonIndex = nodeName.indexOf(":");
-	    		if (colonIndex > 0) {
-	    			// Strip the GET/POST etc off
-	    			nodeName = nodeName.substring(colonIndex+1);
-	    		}
-	    		int bracketIndex = nodeName.indexOf("(");
-	    		if (bracketIndex > 0) {
-	    			// Strip the param summary off
-	    			nodeName = nodeName.substring(0, bracketIndex);
-	    		}
-	    		int quesIndex = nodeName.indexOf("?");
-	    		if (quesIndex > 0) {
-	    			// Strip the parameters off
-	    			nodeName = nodeName.substring(0, quesIndex);
-	    		}
-	    	}
-	    	hierarchicNodeName = ((SiteNode)this.getParent()).getHierarchicNodeName() + "/" + nodeName;
+    		String name = 
+        			this.getParent().getHierarchicNodeName(specialNodesAsRegex) + "/" + 
+        					this.getCleanNodeName(specialNodesAsRegex);
+    		if (!specialNodesAsRegex) {
+    			// Dont cache the non regex version
+    			return name;
+    		}
+    		hierarchicNodeName = name;
     	}
     	return hierarchicNodeName;
     }
@@ -302,8 +331,8 @@ public class SiteNode extends DefaultMutableTreeNode {
     		return;
     	}
     	this.alerts.add(alert);
-    	if (this.getParent() != null && this.getParent() instanceof SiteNode) {
- 			((SiteNode)this.getParent()).addAlert(alert);
+    	if (this.getParent() != null) {
+ 			this.getParent().addAlert(alert);
     	}
     	if (this.siteMap != null) {
     		// Adding alert might affect the nodes visibility in a filtered tree
@@ -324,8 +353,8 @@ public class SiteNode extends DefaultMutableTreeNode {
 		if (foundAlert != null) {
 			this.alerts.remove(foundAlert);
 			this.alerts.add(alert);
-		 	if (this.getParent() != null && this.getParent() instanceof SiteNode) {
-		 		((SiteNode)this.getParent()).updateAlert(alert);
+		 	if (this.getParent() != null) {
+		 		this.getParent().updateAlert(alert);
 		 	}
 	    	if (this.siteMap != null) {
 	    		// Updating an alert might affect the nodes visibility in a filtered tree
@@ -359,8 +388,8 @@ public class SiteNode extends DefaultMutableTreeNode {
 	    		c = (SiteNode) this.getChildAfter(c);
 	    	}
 		}
-	 	if (removed && this.getParent() != null && this.getParent() instanceof SiteNode) {
-	 		((SiteNode)this.getParent()).clearChildAlert(alert, this);
+	 	if (removed && this.getParent() != null) {
+	 		this.getParent().clearChildAlert(alert, this);
 	 	}
     }
 
@@ -368,8 +397,8 @@ public class SiteNode extends DefaultMutableTreeNode {
 		alerts.remove(alert);
 		
 		// Remove from parents, if not in siblings
-	 	if (this.getParent() != null && this.getParent() instanceof SiteNode) {
-	 		((SiteNode)this.getParent()).clearChildAlert(alert, this);
+	 	if (this.getParent() != null) {
+	 		this.getParent().clearChildAlert(alert, this);
 	 	}
     	if (this.siteMap != null) {
     		// Deleting alert might affect the nodes visibility in a filtered tree
@@ -382,8 +411,8 @@ public class SiteNode extends DefaultMutableTreeNode {
         List<Alert> alertsToRemove = new ArrayList<>(alerts);
         if (this.alerts.removeAll(alertsToRemove)) {
             // Remove from parents, if not in siblings
-            if (this.getParent() != null && this.getParent() instanceof SiteNode) {
-                ((SiteNode) this.getParent()).clearChildAlerts(alertsToRemove);
+            if (this.getParent() != null) {
+                this.getParent().clearChildAlerts(alertsToRemove);
             }
         	if (this.siteMap != null) {
         		// Deleting alerts might affect the nodes visibility in a filtered tree
@@ -422,8 +451,8 @@ public class SiteNode extends DefaultMutableTreeNode {
         }
         boolean changed = this.alerts.removeAll(alertsToRemove);
         if (changed) {
-            if (this.getParent() != null && this.getParent() instanceof SiteNode) {
-                ((SiteNode) this.getParent()).clearChildAlerts(alertsToRemove);
+            if (this.getParent() != null) {
+                this.getParent().clearChildAlerts(alertsToRemove);
             }
             nodeChangedEventHandler();
         }
@@ -512,6 +541,16 @@ public class SiteNode extends DefaultMutableTreeNode {
 		super.setParent(newParent);
 	}
 
+    /**
+     * Returns this node's parent or null if this node has no parent.
+     *
+     * @return  this node's parent SiteNode, or null if this node has no parent
+     */
+	@Override
+    public SiteNode getParent() {
+        return (SiteNode)super.getParent();
+    }
+
 	public boolean isFiltered() {
 		return filtered;
 	}
@@ -519,4 +558,8 @@ public class SiteNode extends DefaultMutableTreeNode {
 	protected void setFiltered(boolean filtered) {
 		this.filtered = filtered;
 	}
+
+	public boolean isDataDriven() {
+		return dataDriven;
+	}
 }
diff --git a/src/org/zaproxy/zap/extension/brk/impl/http/HttpBreakpointsUiManagerInterface.java b/src/org/zaproxy/zap/extension/brk/impl/http/HttpBreakpointsUiManagerInterface.java
index 6ef544c31..c364668e6 100644
--- a/src/org/zaproxy/zap/extension/brk/impl/http/HttpBreakpointsUiManagerInterface.java
+++ b/src/org/zaproxy/zap/extension/brk/impl/http/HttpBreakpointsUiManagerInterface.java
@@ -21,6 +21,7 @@ package org.zaproxy.zap.extension.brk.impl.http;
 
 import java.awt.Dimension;
 
+import org.parosproxy.paros.db.DatabaseException;
 import org.parosproxy.paros.extension.ExtensionHookMenu;
 import org.parosproxy.paros.network.HttpMessage;
 import org.parosproxy.paros.view.View;
@@ -28,6 +29,7 @@ import org.zaproxy.zap.extension.brk.BreakpointMessageInterface;
 import org.zaproxy.zap.extension.brk.BreakpointsUiManagerInterface;
 import org.zaproxy.zap.extension.brk.ExtensionBreak;
 import org.zaproxy.zap.extension.httppanel.Message;
+import org.zaproxy.zap.model.StructuralSiteNode;
 
 
 public class HttpBreakpointsUiManagerInterface implements BreakpointsUiManagerInterface {
@@ -98,18 +100,23 @@ public class HttpBreakpointsUiManagerInterface implements BreakpointsUiManagerIn
     private void populateAddDialogAndSetVisible(String url) {
     	breakDialog.init(
     			new HttpBreakpointMessage(url, HttpBreakpointMessage.Location.url, 
-    					HttpBreakpointMessage.Match.contains, false, true), 
+    					HttpBreakpointMessage.Match.regex, false, true), 
     			true);
     	breakDialog.setVisible(true);
     }
     
     private void showAddDialog(Message aMessage) {
     	HttpMessage msg = (HttpMessage) aMessage;
-    	if (msg.getRequestHeader().getURI() != null) {
-            this.showAddDialog(msg.getRequestHeader().getURI().toString());
-    	} else {
-            this.showAddDialog("");
+    	String regex = "";
+    	
+    	if (msg.getHistoryRef().getSiteNode() != null && msg.getHistoryRef().getSiteNode() != null) {
+        	try {
+				regex = new StructuralSiteNode(msg.getHistoryRef().getSiteNode()).getRegexPattern();
+			} catch (DatabaseException e) {
+				// Ignore
+			}
     	}
+        this.showAddDialog(regex);
     }
     
     private void showAddDialog(String url) {
@@ -154,5 +161,4 @@ public class HttpBreakpointsUiManagerInterface implements BreakpointsUiManagerIn
         }
         return popupMenuAddBreakHistory;
     }
-    
 }
diff --git a/src/org/zaproxy/zap/extension/brk/impl/http/PopupMenuAddBreakSites.java b/src/org/zaproxy/zap/extension/brk/impl/http/PopupMenuAddBreakSites.java
index 31c7f5990..16491c21d 100644
--- a/src/org/zaproxy/zap/extension/brk/impl/http/PopupMenuAddBreakSites.java
+++ b/src/org/zaproxy/zap/extension/brk/impl/http/PopupMenuAddBreakSites.java
@@ -20,8 +20,10 @@
 package org.zaproxy.zap.extension.brk.impl.http;
 
 import org.parosproxy.paros.Constant;
+import org.parosproxy.paros.db.DatabaseException;
 import org.parosproxy.paros.model.SiteNode;
 import org.zaproxy.zap.extension.brk.ExtensionBreak;
+import org.zaproxy.zap.model.StructuralSiteNode;
 import org.zaproxy.zap.view.messagecontainer.http.HttpMessageContainer;
 import org.zaproxy.zap.view.popup.PopupMenuItemSiteNodeContainer;
 
@@ -51,11 +53,11 @@ public class PopupMenuAddBreakSites extends PopupMenuItemSiteNodeContainer {
 
     @Override
     public void performAction(SiteNode sn) {
-        String url = sn.getHierarchicNodeName();
-        if (!sn.isLeaf()) {
-            url += "/*";
-        }
-        uiManager.handleAddBreakpoint(url);
+        try {
+			uiManager.handleAddBreakpoint(new StructuralSiteNode(sn).getRegexPattern());
+		} catch (DatabaseException e) {
+			// Ignore
+		}
     }
 
 }
diff --git a/src/org/zaproxy/zap/extension/stdmenus/ExtensionStdMenus.java b/src/org/zaproxy/zap/extension/stdmenus/ExtensionStdMenus.java
index 9c63c1579..c877428e9 100644
--- a/src/org/zaproxy/zap/extension/stdmenus/ExtensionStdMenus.java
+++ b/src/org/zaproxy/zap/extension/stdmenus/ExtensionStdMenus.java
@@ -42,6 +42,7 @@ import org.parosproxy.paros.view.View;
 import org.zaproxy.zap.extension.ascan.ExtensionActiveScan;
 import org.zaproxy.zap.extension.spider.ExtensionSpider;
 import org.zaproxy.zap.model.Context;
+import org.zaproxy.zap.view.popup.PopupMenuItemContextDataDriven;
 import org.zaproxy.zap.view.popup.PopupMenuItemContextExclude;
 import org.zaproxy.zap.view.popup.PopupMenuItemContextInclude;
 
@@ -62,6 +63,7 @@ public class ExtensionStdMenus extends ExtensionAdaptor implements ClipboardOwne
 	private PopupMenuOpenUrlInBrowser popupMenuOpenUrlInBrowser = null;
 	private PopupMenuItemContextInclude popupContextIncludeMenu = null;
 	private PopupMenuItemContextExclude popupContextExcludeMenu = null;
+	private PopupMenuItemContextDataDriven popupContextDataDrivenMenu = null;
 	private PopupMenuCopyUrls popupMenuCopyUrls = null;
 	private PopupContextTreeMenu popupContextTreeMenuInScope = null;
 	private PopupContextTreeMenu popupContextTreeMenuOutScope = null;
@@ -106,6 +108,7 @@ public class ExtensionStdMenus extends ExtensionAdaptor implements ClipboardOwne
 			}
 			extensionHook.getHookMenu().addPopupMenuItem(getPopupContextIncludeMenu(1));
 			extensionHook.getHookMenu().addPopupMenuItem(getPopupContextExcludeMenu(2));
+			extensionHook.getHookMenu().addPopupMenuItem(getPopupContextDataDrivenMenu(2));	// TODO ??
 
 			if (isExtensionActiveScanEnabled) {
 				extensionHook.getHookMenu().addPopupMenuItem(getPopupMenuActiveScanCustom(3));
@@ -369,6 +372,14 @@ public class ExtensionStdMenus extends ExtensionAdaptor implements ClipboardOwne
 		return popupContextExcludeMenu;
 	}
 
+	private PopupMenuItemContextDataDriven getPopupContextDataDrivenMenu(int menuIndex) {
+		if (popupContextDataDrivenMenu == null) {
+			popupContextDataDrivenMenu = new PopupMenuItemContextDataDriven();
+			popupContextDataDrivenMenu.setParentMenuIndex(menuIndex);
+		}
+		return popupContextDataDrivenMenu;
+	}
+
 	@Override
 	public String getAuthor() {
 		return Constant.ZAP_TEAM;
diff --git a/src/org/zaproxy/zap/extension/stdmenus/PopupExcludeFromProxyMenu.java b/src/org/zaproxy/zap/extension/stdmenus/PopupExcludeFromProxyMenu.java
index 90fff6e67..bdb168b91 100644
--- a/src/org/zaproxy/zap/extension/stdmenus/PopupExcludeFromProxyMenu.java
+++ b/src/org/zaproxy/zap/extension/stdmenus/PopupExcludeFromProxyMenu.java
@@ -20,12 +20,9 @@
 package org.zaproxy.zap.extension.stdmenus;
 
 import java.util.List;
-import java.util.regex.Pattern;
 
-import org.apache.commons.httpclient.URI;
-import org.apache.commons.httpclient.URIException;
-import org.apache.log4j.Logger;
 import org.parosproxy.paros.Constant;
+import org.parosproxy.paros.db.DatabaseException;
 import org.parosproxy.paros.model.HistoryReference;
 import org.parosproxy.paros.model.Model;
 import org.parosproxy.paros.model.Session;
@@ -33,6 +30,7 @@ import org.parosproxy.paros.model.SiteMap;
 import org.parosproxy.paros.model.SiteNode;
 import org.parosproxy.paros.view.View;
 import org.zaproxy.zap.extension.history.PopupMenuPurgeSites;
+import org.zaproxy.zap.model.StructuralSiteNode;
 import org.zaproxy.zap.view.SessionExcludeFromProxyPanel;
 import org.zaproxy.zap.view.popup.PopupMenuItemSiteNodeContainer;
 
@@ -40,8 +38,6 @@ public class PopupExcludeFromProxyMenu extends PopupMenuItemSiteNodeContainer {
 
 	private static final long serialVersionUID = 2282358266003940700L;
 
-	private static final Logger logger = Logger.getLogger(PopupExcludeFromProxyMenu.class);
-
 	/**
 	 * This method initializes 
 	 * 
@@ -67,23 +63,15 @@ public class PopupExcludeFromProxyMenu extends PopupMenuItemSiteNodeContainer {
    
 	@Override
 	public void performAction(SiteNode sn) {
-        Session session = Model.getSingleton().getSession();
-        String url;
         try {
-            url = new URI(sn.getHierarchicNodeName(), false).toString();
-        } catch (URIException e) {
-            logger.error("Failed to create the URI to exclude from proxy: " + e.getMessage(), e);
-            return;
-        }
-        if (sn.isLeaf()) {
-            url = Pattern.quote(url);
-        } else {
-        	url = Pattern.quote(url+"/") + ".*";
-        }
-        session.getExcludeFromProxyRegexs().add(url);
-        SiteMap map = (SiteMap) View.getSingleton().getSiteTreePanel().getTreeSite().getModel();
+			Session session = Model.getSingleton().getSession();
+			session.getExcludeFromProxyRegexs().add(new StructuralSiteNode(sn).getRegexPattern());
+			SiteMap map = (SiteMap) View.getSingleton().getSiteTreePanel().getTreeSite().getModel();
 
-        PopupMenuPurgeSites.purge(map, sn);
+			PopupMenuPurgeSites.purge(map, sn);
+		} catch (DatabaseException e) {
+			// Ignore
+		}
 	}
 
 	@Override
diff --git a/src/org/zaproxy/zap/extension/stdmenus/PopupExcludeFromScanMenu.java b/src/org/zaproxy/zap/extension/stdmenus/PopupExcludeFromScanMenu.java
index 6d39066d9..4de44034d 100644
--- a/src/org/zaproxy/zap/extension/stdmenus/PopupExcludeFromScanMenu.java
+++ b/src/org/zaproxy/zap/extension/stdmenus/PopupExcludeFromScanMenu.java
@@ -20,17 +20,15 @@
 package org.zaproxy.zap.extension.stdmenus;
 
 import java.util.List;
-import java.util.regex.Pattern;
 
-import org.apache.commons.httpclient.URI;
-import org.apache.commons.httpclient.URIException;
-import org.apache.log4j.Logger;
 import org.parosproxy.paros.Constant;
+import org.parosproxy.paros.db.DatabaseException;
 import org.parosproxy.paros.model.HistoryReference;
 import org.parosproxy.paros.model.Model;
 import org.parosproxy.paros.model.Session;
 import org.parosproxy.paros.model.SiteNode;
 import org.parosproxy.paros.view.View;
+import org.zaproxy.zap.model.StructuralSiteNode;
 import org.zaproxy.zap.view.SessionExcludeFromScanPanel;
 import org.zaproxy.zap.view.popup.PopupMenuItemSiteNodeContainer;
 
@@ -38,8 +36,6 @@ public class PopupExcludeFromScanMenu extends PopupMenuItemSiteNodeContainer {
 
 	private static final long serialVersionUID = 2282358266003940700L;
 
-    private static final Logger logger = Logger.getLogger(PopupExcludeFromScanMenu.class);
-
 	/**
 	 * This method initializes 
 	 * 
@@ -66,20 +62,12 @@ public class PopupExcludeFromScanMenu extends PopupMenuItemSiteNodeContainer {
    
 	@Override
 	public void performAction(SiteNode sn) {
-        Session session = Model.getSingleton().getSession();
-        String url;
         try {
-            url = new URI(sn.getHierarchicNodeName(), false).toString();
-        } catch (URIException e) {
-            logger.error("Failed to create the URI to exclude from scanner: " + e.getMessage(), e);
-            return;
-        }
-        if (sn.isLeaf()) {
-            url = Pattern.quote(url);
-        } else {
-        	url = Pattern.quote(url+"/") + ".*";
-        }
-        session.getExcludeFromScanRegexs().add(url);
+			Session session = Model.getSingleton().getSession();
+			session.getExcludeFromScanRegexs().add(new StructuralSiteNode(sn).getRegexPattern());
+		} catch (DatabaseException e) {
+			// Ignore
+		}
 	}
 
 	@Override
diff --git a/src/org/zaproxy/zap/extension/stdmenus/PopupExcludeFromSpiderMenu.java b/src/org/zaproxy/zap/extension/stdmenus/PopupExcludeFromSpiderMenu.java
index 86666066b..d82fd9a01 100644
--- a/src/org/zaproxy/zap/extension/stdmenus/PopupExcludeFromSpiderMenu.java
+++ b/src/org/zaproxy/zap/extension/stdmenus/PopupExcludeFromSpiderMenu.java
@@ -20,17 +20,15 @@
 package org.zaproxy.zap.extension.stdmenus;
 
 import java.util.List;
-import java.util.regex.Pattern;
 
-import org.apache.commons.httpclient.URI;
-import org.apache.commons.httpclient.URIException;
-import org.apache.log4j.Logger;
 import org.parosproxy.paros.Constant;
+import org.parosproxy.paros.db.DatabaseException;
 import org.parosproxy.paros.model.HistoryReference;
 import org.parosproxy.paros.model.Model;
 import org.parosproxy.paros.model.Session;
 import org.parosproxy.paros.model.SiteNode;
 import org.parosproxy.paros.view.View;
+import org.zaproxy.zap.model.StructuralSiteNode;
 import org.zaproxy.zap.view.SessionExcludeFromSpiderPanel;
 import org.zaproxy.zap.view.popup.PopupMenuItemSiteNodeContainer;
 
@@ -38,8 +36,6 @@ public class PopupExcludeFromSpiderMenu extends PopupMenuItemSiteNodeContainer {
 
 	private static final long serialVersionUID = 2282358266003940700L;
 
-    private static final Logger logger = Logger.getLogger(PopupExcludeFromSpiderMenu.class);
-
 	/**
 	 * This method initializes 
 	 * 
@@ -66,20 +62,12 @@ public class PopupExcludeFromSpiderMenu extends PopupMenuItemSiteNodeContainer {
    
 	@Override
 	public void performAction(SiteNode sn) {
-        Session session = Model.getSingleton().getSession();
-        String url;
         try {
-            url = new URI(sn.getHierarchicNodeName(), false).toString();
-        } catch (URIException e) {
-            logger.error("Failed to create the URI to exclude from spider: " + e.getMessage(), e);
-            return;
-        }
-        if (sn.isLeaf()) {
-            url = Pattern.quote(url);
-        } else {
-        	url = Pattern.quote(url+"/") + ".*";
-        }
-        session.getExcludeFromSpiderRegexs().add(url);
+			Session session = Model.getSingleton().getSession();
+			session.getExcludeFromSpiderRegexs().add(new StructuralSiteNode(sn).getRegexPattern());
+		} catch (DatabaseException e) {
+			// Ignore
+		}
 	}
 
 	@Override
diff --git a/src/org/zaproxy/zap/extension/stdmenus/PopupMenuActiveScanSite.java b/src/org/zaproxy/zap/extension/stdmenus/PopupMenuActiveScanSite.java
index 4887bb0d7..8f8f059bc 100644
--- a/src/org/zaproxy/zap/extension/stdmenus/PopupMenuActiveScanSite.java
+++ b/src/org/zaproxy/zap/extension/stdmenus/PopupMenuActiveScanSite.java
@@ -67,7 +67,7 @@ public class PopupMenuActiveScanSite extends PopupMenuItemSiteNodeContainer {
 	    if (node != null) {
 	    	// Loop up to get the top parent
 			while (node.getParent() != null && node.getParent().getParent() != null) {
-				node = (SiteNode) node.getParent();
+				node = node.getParent();
 			}
 	    	extension.startScan(node);
 	    }
diff --git a/src/org/zaproxy/zap/extension/stdmenus/PopupMenuSpiderSite.java b/src/org/zaproxy/zap/extension/stdmenus/PopupMenuSpiderSite.java
index acdf33285..ce5360927 100644
--- a/src/org/zaproxy/zap/extension/stdmenus/PopupMenuSpiderSite.java
+++ b/src/org/zaproxy/zap/extension/stdmenus/PopupMenuSpiderSite.java
@@ -67,7 +67,7 @@ public class PopupMenuSpiderSite extends PopupMenuItemSiteNodeContainer {
 	    if (node != null) {
 	    	// Loop up to get the top parent
 			while (node.getParent() != null && node.getParent().getParent() != null) {
-				node = (SiteNode) node.getParent();
+				node = node.getParent();
 			}
 	    	getExtensionSpider().startScan(node);
 	    }
diff --git a/src/org/zaproxy/zap/model/Context.java b/src/org/zaproxy/zap/model/Context.java
index cb3288c93..97f5f745f 100644
--- a/src/org/zaproxy/zap/model/Context.java
+++ b/src/org/zaproxy/zap/model/Context.java
@@ -26,13 +26,13 @@ import java.util.LinkedList;
 import java.util.List;
 import java.util.regex.Pattern;
 
-import org.apache.commons.httpclient.URI;
 import org.apache.log4j.Logger;
 import org.parosproxy.paros.core.scanner.Alert;
 import org.parosproxy.paros.model.HistoryReference;
 import org.parosproxy.paros.model.Session;
+import org.parosproxy.paros.model.SiteMap;
 import org.parosproxy.paros.model.SiteNode;
-import org.parosproxy.paros.network.HttpMessage;
+import org.parosproxy.paros.network.HttpRequestHeader;
 import org.zaproxy.zap.authentication.AuthenticationMethod;
 import org.zaproxy.zap.authentication.ManualAuthenticationMethodType.ManualAuthenticationMethod;
 import org.zaproxy.zap.extension.authorization.AuthorizationDetectionMethod;
@@ -58,6 +58,7 @@ public class Context {
 	public static final String CONTEXT_CONFIG_POSTPARSER = CONTEXT_CONFIG + ".postparser";
 	public static final String CONTEXT_CONFIG_POSTPARSER_CLASS = CONTEXT_CONFIG_POSTPARSER + ".class";
 	public static final String CONTEXT_CONFIG_POSTPARSER_CONFIG = CONTEXT_CONFIG_POSTPARSER + ".config";
+	public static final String CONTEXT_CONFIG_DATA_DRIVEN_NODES = CONTEXT_CONFIG + ".ddns";
 
 	private static Logger log = Logger.getLogger(Context.class);
 
@@ -70,6 +71,7 @@ public class Context {
 	private List<String> excludeFromRegexs = new ArrayList<>();
 	private List<Pattern> includeInPatterns = new ArrayList<>();
 	private List<Pattern> excludeFromPatterns = new ArrayList<>();
+	private List<StructuralNodeModifier> dataDrivenNodes = new ArrayList<>();
 
 	/** The authentication method. */
 	private AuthenticationMethod authenticationMethod = null;
@@ -93,6 +95,8 @@ public class Context {
 		this.authenticationMethod = new ManualAuthenticationMethod(index);
 		this.authorizationDetectionMethod = new BasicAuthorizationDetectionMethod(null, null, null,
 				LogicalOperator.AND);
+		this.urlParamParser.setContext(this);
+		this.postParamParser.setContext(this);
 	}
 
 	public boolean isIncludedInScope(SiteNode sn) {
@@ -316,27 +320,13 @@ public class Context {
 			}
 		}
 	}
-
-	private String getPatternFromNode(SiteNode sn, boolean recurse) throws Exception {
-		return this.getPatternUrl(new URI(sn.getHierarchicNodeName(), false).toString(), recurse);
-	}
-
-	private String getPatternUrl(String url, boolean recurse) throws Exception {
-		if (url.indexOf("?") > 0) {
-			// Strip off any parameters
-			url = url.substring(0, url.indexOf("?"));
-		}
-
-		if (recurse) {
-			url = Pattern.quote(url) + ".*";
-		} else {
-			url = Pattern.quote(url);
-		}
-		return url;
+	
+	public void excludeFromContext(SiteNode sn, boolean recurse) throws Exception {
+		excludeFromContext(new StructuralSiteNode(sn), recurse);
 	}
 
-	public void excludeFromContext(SiteNode sn, boolean recurse) throws Exception {
-		addExcludeFromContextRegex(this.getPatternFromNode(sn, recurse));
+	public void excludeFromContext(StructuralNode sn, boolean recurse) throws Exception {
+		addExcludeFromContextRegex(sn.getRegexPattern(recurse));
 	}
 
 	public void addIncludeInContextRegex(String includeRegex) {
@@ -485,7 +475,6 @@ public class Context {
 
 	public void setUrlParamParser(ParameterParser paramParser) {
 		this.urlParamParser = paramParser;
-		restructureSiteTree();
 	}
 
 	public ParameterParser getPostParamParser() {
@@ -515,35 +504,123 @@ public class Context {
 	
 	private void restructureSiteTreeEventHandler() {
 		log.debug("Restructure site tree for context: " + this.getName());
-		
-		HttpMessage msg;
-		SiteNode sn2;
+		List<SiteNode> nodes = this.getTopNodesInContextFromSiteTree();
+		for (SiteNode sn : nodes) {
+			checkNode(sn);
+		}
+	}
+	
+	private boolean checkNode(SiteNode sn) {
+		// Loop backwards through the children TODO change for lowmem!
+		// log.debug("checkNode " + sn.getHierarchicNodeName());		// Useful for debugging
+		int origChildren = sn.getChildCount();
+		int movedChildren = 0;
+		for (int i=origChildren; i > 0; i--) {
+			if (checkNode((SiteNode)sn.getChildAt(i-1))) {
+				movedChildren++;
+			}
+		}
 
-		for (SiteNode sn: this.getNodesInContextFromSiteTree()) {
-			log.debug("Restructure site tree, node: " + sn.getNodeName());
+		if (this.isInContext(sn)) {
+			SiteMap sitesTree = this.session.getSiteTree();
+			HistoryReference href = sn.getHistoryReference();
+			
 			try {
-				msg = sn.getHistoryReference().getHttpMessage();
-				if (msg != null) {
-					sn2 = session.getSiteTree().findNode(msg, sn.getChildCount() > 0);
-					if (sn2 == null) {
-						sn2 = session.getSiteTree().addPath(sn.getHistoryReference(), msg);
+				SiteNode sn2;
+				if (HttpRequestHeader.POST.equals(href.getMethod())) {
+					// Have to go to the db as POST data can be used in the name
+					sn2 = sitesTree.findNode(href.getHttpMessage());
+				} else {
+					// This is better as it doesnt require a db read
+					sn2 = sitesTree.findNode(href.getURI());
+				}
+				
+				if (sn2 == null || ! sn.getHierarchicNodeName().equals(sn2.getHierarchicNodeName())) {
+					if (! sn.isDataDriven()) {
+						moveNode(sitesTree, sn);
+						return true;
 					}
-						
-					if (! sn2.equals(sn)) {
-						// TODO: Might be better in a 'merge'? Do we need to copy other things, list custom icons? 
-						for (Alert alert : sn.getAlerts()) {
-							sn2.addAlert(alert);
-						}
-						for (Alert alert : sn.getAlerts()) {
-							sn.deleteAlert(alert);
-						}
-						session.getSiteTree().removeNodeFromParent(sn);
+				}
+				if (movedChildren > 0 && movedChildren == origChildren && sn.getChildCount() == 0) {
+					if (href.getHistoryType() == HistoryReference.TYPE_TEMPORARY) {
+						// Remove temp old node, no need to add new one in - 
+						// that will happen when moving child nodes (if required)
+						deleteNode(sitesTree, sn);
+						return true;
 					}
 				}
+				// log.debug("Didnt need to move " + sn.getHierarchicNodeName());	// Useful for debugging
 			} catch (Exception e) {
 				log.error(e.getMessage(), e);
 			}
 		}
+		return false;
+		
+	}
+
+	private void moveNode (SiteMap sitesTree, SiteNode sn) {
+		List<Alert> alerts = sn.getAlerts();
+		
+		// And delete the old one
+		deleteNode(sitesTree, sn);
+		
+		// Add into the right place
+		SiteNode sn2 = sitesTree.addPath(sn.getHistoryReference());
+		log.debug("Moved node " + sn.getHierarchicNodeName() + " to " + sn2.getHierarchicNodeName());
+
+		// And sort out the alerts
+		for (Alert alert : alerts) {
+			sn2.addAlert(alert);
+		}
+	}
+	
+	private void deleteNode (SiteMap sitesTree, SiteNode sn) {
+		log.debug("Deleting node " + sn.getHierarchicNodeName());
+		List<Alert> alerts = sn.getAlerts();
+		HistoryReference href = sn.getHistoryReference();
+		
+		// Remove old one
+		for (Alert alert : alerts) {
+			sn.deleteAlert(alert);
+		}
+		sitesTree.removeNodeFromParent(sn);
+		sitesTree.removeHistoryReference(href.getHistoryId());
+	}
+	
+	
+	public List<StructuralNodeModifier> getDataDrivenNodes() {
+		List<StructuralNodeModifier> ddns = new ArrayList<>(this.dataDrivenNodes.size());
+		for (StructuralNodeModifier ddn : this.dataDrivenNodes) {
+			ddns.add(ddn.clone());
+		}
+		return ddns;
+	}
+
+	public void setDataDrivenNodes(List<StructuralNodeModifier> dataDrivenNodes) {
+		this.dataDrivenNodes = dataDrivenNodes;
+	}
+
+	public void addDataDrivenNodes(StructuralNodeModifier ddn) {
+		this.dataDrivenNodes.add(ddn.clone());
+	}
+	
+	public String getDefaultDDNName() {
+		int i=1;
+		while (true) {
+			boolean found = false;
+			String name = "DDN" + i;
+			for (StructuralNodeModifier ddn : this.dataDrivenNodes) {
+				if (ddn.getName().equals(name)) {
+					found = true;
+					break;
+				}
+			}
+			if (!found) {
+				return name;
+			}
+			
+			i++;
+		}
 	}
 
 	/**
@@ -566,6 +643,7 @@ public class Context {
 		newContext.urlParamParser = this.urlParamParser.clone();
 		newContext.postParamParser = this.postParamParser.clone();
 		newContext.authorizationDetectionMethod = this.authorizationDetectionMethod.clone();
+		newContext.dataDrivenNodes = this.getDataDrivenNodes();
 		return newContext;
 	}
 
diff --git a/src/org/zaproxy/zap/model/ParameterParser.java b/src/org/zaproxy/zap/model/ParameterParser.java
index c6d796eb9..f77623e53 100644
--- a/src/org/zaproxy/zap/model/ParameterParser.java
+++ b/src/org/zaproxy/zap/model/ParameterParser.java
@@ -65,4 +65,8 @@ public interface ParameterParser {
 	String getConfig();
 
 	ParameterParser clone();
+	
+	void setContext(Context context);
+	
+	Context getContext();
 }
diff --git a/src/org/zaproxy/zap/model/SessionStructure.java b/src/org/zaproxy/zap/model/SessionStructure.java
index 259ac8bd4..12b7563cd 100644
--- a/src/org/zaproxy/zap/model/SessionStructure.java
+++ b/src/org/zaproxy/zap/model/SessionStructure.java
@@ -43,6 +43,10 @@ import org.parosproxy.paros.network.HttpRequestHeader;
 public class SessionStructure {
 
 	public static final String ROOT = "Root";
+	
+	public static final String DATA_DRIVEN_NODE_PREFIX = "\u00AB";
+	public static final String DATA_DRIVEN_NODE_POSTFIX = "\u00BB";
+	public static final String DATA_DRIVEN_NODE_REGEX = "(.+?)";
 
     private static final Logger log = Logger.getLogger(SessionStructure.class);
 
@@ -112,6 +116,110 @@ public class SessionStructure {
 		return nodeUrl;
 	}
 
+    public static String regexEscape (String str) {
+    	String chrsToEscape = ".*+?^=!${}()|[]\\";
+		StringBuilder sb = new StringBuilder();
+		char c;
+		for (int i=0; i < str.length(); i++) {
+			c = str.charAt(i);
+			if (chrsToEscape.indexOf(c) >= 0) {
+				sb.append('\\');
+			}
+			sb.append(c);
+		}
+		return sb.toString();
+    }
+
+	/**
+	 * Returns a regex pattern that will match the specified StructuralNode, ignoring the parent and children.
+	 * For most nodes this will just be the last element in the path, eg
+	 * URL								regex name
+	 * https://www.example.com/aaa/bbb 	bbb
+	 * https://www.example.com/aaa		aaa
+	 * https://www.example.com/			https://www.example.com
+	 * Datadriven nodes are different, they will always return (.+?) to match anything.
+	 * @param sn a StructuralNode
+	 * @param incParams if true then include URL params in the regex, otherwise exclude them 
+	 * @return a regex pattern that will match the specified StructuralNode, ignoring the parent and children.
+	 */
+	private static String getRegexName(StructuralNode sn, boolean incParams) {
+    	String name = sn.getName();
+    	if (sn.isDataDriven()) {
+    		// Non-greedy regex pattern 
+			return DATA_DRIVEN_NODE_REGEX;
+    	} 
+		int bracketIndex = name.lastIndexOf("(");
+		if (bracketIndex >= 0) {
+			// Strip the param summary off
+			name = name.substring(0, bracketIndex);
+		}
+		int quesIndex = name.indexOf("?");
+		if (quesIndex >= 0) {
+			if (incParams) {
+				// Escape the params
+				String params = name.substring(quesIndex);
+				name = name.substring(0, quesIndex) + regexEscape(params);
+			} else {
+				// Strip the parameters off
+				name = name.substring(0, quesIndex);
+			}
+		}
+
+    	try {
+			String host = getHostName(sn.getURI());
+			if (name.equals(host) || name.equals(host + "/")) {
+				// This is a top level node (under the root)
+				return host;
+			}
+		} catch (URIException e) {
+			// Ignore
+		}
+    	
+    	int slashIndex = name.lastIndexOf('/');
+    	if (slashIndex >= 0) {
+    		name = name.substring(slashIndex+1);
+    	}
+    	if (sn.isLeaf()) {
+    		int colonIndex = name.indexOf(":");
+    		if (colonIndex > 0) {
+    			// Strip the GET/POST etc off
+    			name = name.substring(colonIndex+1);
+    		}
+    	}
+    	return name;
+	}
+
+	public static String getRegexPattern(StructuralNode sn) throws DatabaseException {
+		return getRegexPattern(sn, true);
+	}
+
+	public static String getRegexPattern(StructuralNode sn, boolean incChildren) throws DatabaseException {
+    	/*
+    	 * The logic...
+    	 * 	Loop up to parent / recurse up
+    	 * 	for std nodes escape special cases
+    	 * 	inc \/ between nodes
+    	 * 	for NSPs use (.+?) ?
+    	 */
+    	
+		StringBuilder sb = new StringBuilder();
+		boolean incParams = sn.isLeaf() || ! incChildren;
+		
+		// Work back up the tree..
+		while (!sn.isRoot()) {
+			if (sb.length() > 0) {
+				sb.insert(0, "/");
+			}
+			sb.insert(0, getRegexName(sn, incParams));
+			sn = sn.getParent();
+			incParams = false;	// Only do this for the top node
+		}
+		if (incChildren) {
+			sb.append(".*");
+		}
+		return sb.toString();
+	}
+
     private static RecordStructure addStructure (Session session, String host, HttpMessage msg, 
     		List<String> paths, int size, int historyId) throws DatabaseException, URIException {
 		//String nodeUrl = pathsToUrl(host, paths, size);
diff --git a/src/org/zaproxy/zap/model/StandardParameterParser.java b/src/org/zaproxy/zap/model/StandardParameterParser.java
index bda076850..4e3e05b89 100644
--- a/src/org/zaproxy/zap/model/StandardParameterParser.java
+++ b/src/org/zaproxy/zap/model/StandardParameterParser.java
@@ -24,6 +24,7 @@ import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
 import java.util.Map.Entry;
+import java.util.regex.Matcher;
 import java.util.regex.Pattern;
 import java.util.regex.PatternSyntaxException;
 
@@ -42,6 +43,7 @@ public class StandardParameterParser implements ParameterParser {
 	private static final String CONFIG_KV_SEPARATORS = "kvs";
 	private static final String CONFIG_STRUCTURAL_PARAMS = "struct";
 
+	private Context context;
 	private Pattern keyValuePairSeparatorPattern;
 	private Pattern keyValueSeparatorPattern;
 	private String keyValuePairSeparators;
@@ -200,9 +202,45 @@ public class StandardParameterParser implements ParameterParser {
 
 	@Override
 	public List<String> getTreePath(URI uri) throws URIException {
+		return this.getTreePath(uri, true);
+	}
+
+	private List<String> getTreePath(URI uri, boolean incStructParams) throws URIException {
 		String path = uri.getPath();
 		List<String> list = new ArrayList<String>();
 		if (path != null) {
+			Context context = this.getContext();
+			if (context != null) {
+				String uriStr = uri.toString();
+				boolean changed = false;
+				for (StructuralNodeModifier ddn : context.getDataDrivenNodes()) {
+					Matcher m = ddn.getPattern().matcher(uriStr);
+					if (m.find()){ 
+						if (m.groupCount() == 3) {
+							path = m.group(1) + SessionStructure.DATA_DRIVEN_NODE_PREFIX + 
+									ddn.getName() + SessionStructure.DATA_DRIVEN_NODE_POSTFIX + 
+									m.group(3);
+							if (!path.startsWith("/")) {
+								// Should always start with a slash;)
+								path = "/" + path;
+							}
+							changed = true;
+						} else if (m.groupCount() == 2) {
+							path = m.group(1) + SessionStructure.DATA_DRIVEN_NODE_PREFIX + 
+									ddn.getName() + SessionStructure.DATA_DRIVEN_NODE_POSTFIX;
+							if (!path.startsWith("/")) {
+								// Should always start with a slash;)
+								path = "/" + path;
+							}
+							changed = true;
+						}
+					}
+				}
+				if (changed) {
+					log.debug("Changed path from " + uri.getPath() + " to " + path);
+				}
+			}
+			
 			// Note: Start from the 2nd path element as the first on is always the empty string due
 			// to the split
 			String[] pathList = path.split("/");
@@ -210,20 +248,21 @@ public class StandardParameterParser implements ParameterParser {
 				list.add(pathList[i]);
 			}
 		}
-		// Add any structural params (url param) in key order
-		Map<String, String> urlParams = this.parse(uri.getQuery());
-		List<String> keys = new ArrayList<String>(urlParams.keySet());
-		Collections.sort(keys);
-		for (String key: keys) {
-			if (this.structuralParameters.contains(key)) {
-				list.add(urlParams.get(key));
+		if (incStructParams) {
+			// Add any structural params (url param) in key order
+			Map<String, String> urlParams = this.parse(uri.getQuery());
+			List<String> keys = new ArrayList<String>(urlParams.keySet());
+			Collections.sort(keys);
+			for (String key: keys) {
+				if (this.structuralParameters.contains(key)) {
+					list.add(urlParams.get(key));
+				}
 			}
 		}
 
 		return list;
 	}
 	
-	
 	@Override
 	public List<String> getTreePath(HttpMessage msg) throws URIException {
 		URI uri = msg.getRequestHeader().getURI();
@@ -242,8 +281,6 @@ public class StandardParameterParser implements ParameterParser {
 
 		return list;
 	}
-	
-	
 
 	@Override
 	public String getAncestorPath(URI uri, int depth) throws URIException {
@@ -252,18 +289,25 @@ public class StandardParameterParser implements ParameterParser {
 		if (depth == 0 || path == null) {
 			return "";
 		}
+		List<String> pathList = getTreePath(uri, false);
 
-		// Add the 'normal' path elements until we finish them or we reach the desired depth
-		String[] pathList = path.split("/");
+		// Add the 'normal' (plus data driven) path elements 
+		// until we finish them or we reach the desired depth
 		StringBuilder parentPath = new StringBuilder(path.length());
-		// Note: Start from the 2nd path element as the first on is always the empty string due to
-		// the split
-		for (int i = 1; i < pathList.length && depth > 0; i++, depth--) {
-			parentPath.append('/').append(pathList[i]);
+		for (int i = 0; i < pathList.size() && depth > 0; i++, depth--) {
+			String element = pathList.get(i);
+			parentPath.append('/');
+			if (element.startsWith(SessionStructure.DATA_DRIVEN_NODE_PREFIX)) {
+				// Its a data driven node - use the regex pattern instead
+				parentPath.append(SessionStructure.DATA_DRIVEN_NODE_REGEX);
+			} else {
+				parentPath.append(element);
+			}
 		}
 		// If we're done or we have no structural parameters, just return
-		if (depth == 0 || structuralParameters.isEmpty())
+		if (depth == 0 || structuralParameters.isEmpty()) {
 			return parentPath.toString();
+		}
 
 		// Add the 'structural params' path elements
 		boolean firstElement = true;
@@ -285,4 +329,14 @@ public class StandardParameterParser implements ParameterParser {
 		return parentPath.toString();
 	}
 
+	@Override
+	public void setContext(Context context) {
+		this.context = context;
+	}
+
+	@Override
+	public Context getContext() {
+		return context;
+	}
+
 }
diff --git a/src/org/zaproxy/zap/model/StructuralNode.java b/src/org/zaproxy/zap/model/StructuralNode.java
index 74660037d..a92e1229a 100644
--- a/src/org/zaproxy/zap/model/StructuralNode.java
+++ b/src/org/zaproxy/zap/model/StructuralNode.java
@@ -37,11 +37,17 @@ public interface StructuralNode {
 	
 	String getName();
 	
+	String getRegexPattern() throws DatabaseException;
+
+	String getRegexPattern(boolean incChildren) throws DatabaseException;
+
 	URI getURI();
 	
 	boolean isRoot();
 	
 	boolean isLeaf();
 	
+	boolean isDataDriven();
+	
 	boolean isSameAs (StructuralNode node);
 }
diff --git a/src/org/zaproxy/zap/model/StructuralNodeModifier.java b/src/org/zaproxy/zap/model/StructuralNodeModifier.java
new file mode 100644
index 000000000..b557cd7e0
--- /dev/null
+++ b/src/org/zaproxy/zap/model/StructuralNodeModifier.java
@@ -0,0 +1,110 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License"); 
+ * you may not use this file except in compliance with the License. 
+ * You may obtain a copy of the License at 
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0 
+ *   
+ * Unless required by applicable law or agreed to in writing, software 
+ * distributed under the License is distributed on an "AS IS" BASIS, 
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
+ * See the License for the specific language governing permissions and 
+ * limitations under the License. 
+ */
+package org.zaproxy.zap.model;
+
+import java.util.regex.Pattern;
+
+import net.sf.json.JSONObject;
+
+import org.zaproxy.zap.utils.Enableable;
+/**
+ * Represents a rule for modifying the structure of an app as it is represented in the Sites tree
+ * 
+ * Data driven nodes are nodes that represent URL path elements that come from a database
+ * For example with http://www.example.com/a/b/c we normally assume that 'a', 'b' and 'c' are part of the 
+ * structure of the application. However if 'b' is actually a value retrieved from a db then we should treat 
+ * all such nodes as the same, so:
+ * 	http://www.example.com/a/b/c
+ * 	http://www.example.com/a/ddd/c
+ * 	http://www.example.com/a/eee/c
+ * are the same as far as the application structure is concerned - theres no point attacking all 3 as the same code
+ * will be behind them.
+ * 
+ * Structural parameters are parameters (as opposed to URL path elements) that actually define part of the
+ * structure of an app. These are most commonly found in 'single page apps' where:
+ * 	http://www.example.com/a/b?page=c
+ * 	http://www.example.com/a/b?page=d
+ * 	http://www.example.com/a/b?page=e
+ * all represent different pages with different functionality.
+ * In this case the 'page' parameter should be treated as being 'structural' rather than data
+ * 
+ * @author simon
+ * @since TODO add version
+ */
+public class StructuralNodeModifier extends Enableable implements Cloneable {
+	public enum Type {DataDrivenNode, StructuralParameter}
+	
+	private static final String CONFIG_NAME = "name";
+	private static final String CONFIG_TYPE = "type";
+	private static final String CONFIG_PATTERN = "pattern";
+
+	private Type type;
+	private Pattern pattern;
+	private String name;
+	
+	public StructuralNodeModifier(Type type, Pattern pattern, String name) {
+		super();
+		this.type = type;
+		this.pattern = pattern;
+		this.name = name;
+	}
+
+	public StructuralNodeModifier(String config) {
+		super();
+		JSONObject json = JSONObject.fromObject(config);
+		this.name = json.getString(CONFIG_NAME);
+		this.type = Type.valueOf(json.getString(CONFIG_TYPE));
+		if (json.containsKey(CONFIG_TYPE)) {
+			pattern = Pattern.compile(json.getString(CONFIG_PATTERN));
+		}
+	}
+
+	public Type getType() {
+		return type;
+	}
+
+	public Pattern getPattern() {
+		return pattern;
+	}
+	public void setPattern(Pattern pattern) {
+		this.pattern = pattern;
+	}
+	public String getName() {
+		return name;
+	}
+	public void setName(String name) {
+		this.name = name;
+	}
+	@Override
+	public StructuralNodeModifier clone() {
+		return new StructuralNodeModifier(type, Pattern.compile(pattern.toString()), name);
+	}
+
+	public String getConfig() {
+		JSONObject json = new JSONObject();
+		json.put(CONFIG_TYPE, this.getType().name());
+		json.put(CONFIG_NAME, this.getName());
+		if (getPattern() != null) {
+			json.put(CONFIG_PATTERN, this.getPattern().pattern());
+		}
+		return json.toString();
+	}
+	
+}
diff --git a/src/org/zaproxy/zap/model/StructuralSiteNode.java b/src/org/zaproxy/zap/model/StructuralSiteNode.java
index 442734ba1..1d169573b 100644
--- a/src/org/zaproxy/zap/model/StructuralSiteNode.java
+++ b/src/org/zaproxy/zap/model/StructuralSiteNode.java
@@ -38,7 +38,7 @@ public class StructuralSiteNode implements StructuralNode {
 	@Override
 	public StructuralNode getParent() throws DatabaseException {
 		if (parent == null && ! this.isRoot()) {
-			parent = new StructuralSiteNode((SiteNode) node.getParent());
+			parent = new StructuralSiteNode(node.getParent());
 		}
 		return parent;
 	}
@@ -90,4 +90,19 @@ public class StructuralSiteNode implements StructuralNode {
 		return false;
 	}
 
+	@Override
+	public String getRegexPattern() throws DatabaseException {
+		return this.getRegexPattern(true);
+	}
+
+	@Override
+	public String getRegexPattern(boolean incChildren) throws DatabaseException {
+		return SessionStructure.getRegexPattern(this, incChildren);
+	}
+
+	@Override
+	public boolean isDataDriven() {
+		return this.node.isDataDriven();
+	}
+
 }
diff --git a/src/org/zaproxy/zap/model/StructuralSiteNodeIterator.java b/src/org/zaproxy/zap/model/StructuralSiteNodeIterator.java
index f1be17fc0..2c0c36dc1 100644
--- a/src/org/zaproxy/zap/model/StructuralSiteNodeIterator.java
+++ b/src/org/zaproxy/zap/model/StructuralSiteNodeIterator.java
@@ -44,7 +44,7 @@ public class StructuralSiteNodeIterator implements Iterator<StructuralNode> {
 		if (! hasNext()) {
 			throw new NoSuchElementException();
 		}
-		return new StructuralSiteNode((SiteNode)children.nextElement());
+		return new StructuralSiteNode(children.nextElement());
 	}
 
 	@Override
diff --git a/src/org/zaproxy/zap/model/StructuralTableNode.java b/src/org/zaproxy/zap/model/StructuralTableNode.java
index b932b91b9..dfe6671aa 100644
--- a/src/org/zaproxy/zap/model/StructuralTableNode.java
+++ b/src/org/zaproxy/zap/model/StructuralTableNode.java
@@ -92,8 +92,11 @@ public class StructuralTableNode implements StructuralNode {
 
 	@Override
 	public boolean isLeaf() {
-		// TODO implement in more efficient way ;)
-		return ! this.getChildIterator().hasNext();
+		try {
+			return this.getChildNodeCount() == 0;
+		} catch (DatabaseException e) {
+			return false;
+		}
 	}
 	
 	protected RecordStructure getRecordStructure() {
@@ -115,5 +118,25 @@ public class StructuralTableNode implements StructuralNode {
 		return extHistory;
 	}
 
+	@Override
+	public String getRegexPattern() throws DatabaseException {
+		return this.getRegexPattern(true);
+	}
+
+	@Override
+	public String getRegexPattern(boolean incChildren) throws DatabaseException {
+		return SessionStructure.getRegexPattern(this, incChildren);
+	}
+
+	@Override
+	public boolean isDataDriven() {
+		String name = this.getName();
+		int slashIndex = name.lastIndexOf('/');
+		if (slashIndex >= 0) {
+			name = name.substring(slashIndex+1);
+		}
+		return name.startsWith(SessionStructure.DATA_DRIVEN_NODE_PREFIX);
+	}
+
 
 }
diff --git a/src/org/zaproxy/zap/model/Target.java b/src/org/zaproxy/zap/model/Target.java
index 14ed11c98..00f105219 100644
--- a/src/org/zaproxy/zap/model/Target.java
+++ b/src/org/zaproxy/zap/model/Target.java
@@ -159,7 +159,7 @@ public class Target {
     			return Constant.messages.getString("target.empty");
     		}
     	} else {
-    		String name = this.getStartNode().getHierarchicNodeName(); 
+    		String name = this.getStartNode().getHierarchicNodeName(false); 
     		if (name.length() < 30) {
     			return name;
     		}
diff --git a/src/org/zaproxy/zap/view/ContextCreateDialog.java b/src/org/zaproxy/zap/view/ContextCreateDialog.java
index f8c6070eb..f2c377a82 100644
--- a/src/org/zaproxy/zap/view/ContextCreateDialog.java
+++ b/src/org/zaproxy/zap/view/ContextCreateDialog.java
@@ -20,15 +20,13 @@
 package org.zaproxy.zap.view;
 
 import java.awt.Frame;
-import java.util.regex.Pattern;
 
-import org.apache.commons.httpclient.URI;
-import org.apache.commons.httpclient.URIException;
-import org.apache.log4j.Logger;
 import org.parosproxy.paros.Constant;
+import org.parosproxy.paros.db.DatabaseException;
 import org.parosproxy.paros.model.Model;
 import org.parosproxy.paros.model.SiteNode;
 import org.zaproxy.zap.model.Context;
+import org.zaproxy.zap.model.StructuralSiteNode;
 import org.zaproxy.zap.utils.DisplayUtils;
 
 public class ContextCreateDialog extends StandardFieldsDialog {
@@ -41,7 +39,6 @@ public class ContextCreateDialog extends StandardFieldsDialog {
 	private static final String IN_SCOPE_FIELD = "context.inscope.label"; 
 	
 	private SiteNode topNode = null;
-    private Logger logger = Logger.getLogger(ContextCreateDialog.class);
 
 	public ContextCreateDialog(Frame owner) {
 		super(owner, "context.create.title", DisplayUtils.getScaledDimension(400,300));
@@ -66,18 +63,11 @@ public class ContextCreateDialog extends StandardFieldsDialog {
 		ctx.setDescription(this.getStringValue(DESC_FIELD));
 		ctx.setInScope(this.getBoolValue(IN_SCOPE_FIELD));
 		if (topNode != null) {
-			String url;
 	        try {
-	            url = new URI(topNode.getHierarchicNodeName(), false).toString();
-		        if (topNode.isLeaf()) {
-		            url = Pattern.quote(url);
-		        } else {
-		            url = Pattern.quote(url) + ".*";
-		        }
-		        ctx.addIncludeInContextRegex(url);
-	        } catch (URIException e) {
-	        	logger.error("Bad context start url " + this.getStringValue(TOP_NODE), e);
-	        }
+				ctx.addIncludeInContextRegex(new StructuralSiteNode(topNode).getRegexPattern());
+			} catch (DatabaseException e) {
+				// Ignore
+			}
 		}
 		
 		Model.getSingleton().getSession().saveContext(ctx);
diff --git a/src/org/zaproxy/zap/view/ContextStructurePanel.java b/src/org/zaproxy/zap/view/ContextStructurePanel.java
index 479101e41..6c8fffdc2 100644
--- a/src/org/zaproxy/zap/view/ContextStructurePanel.java
+++ b/src/org/zaproxy/zap/view/ContextStructurePanel.java
@@ -21,21 +21,29 @@
 package org.zaproxy.zap.view;
 
 import java.awt.CardLayout;
-import java.awt.GridBagConstraints;
+import java.awt.Dimension;
 import java.awt.GridBagLayout;
 import java.awt.Insets;
-
+import java.awt.event.ActionEvent;
+import java.awt.event.ActionListener;
+import java.util.ArrayList;
+import java.util.List;
+import java.util.regex.Pattern;
+
+import javax.swing.JCheckBox;
+import javax.swing.JDialog;
 import javax.swing.JLabel;
+import javax.swing.JOptionPane;
 import javax.swing.JPanel;
-import javax.swing.JScrollPane;
-import javax.swing.JTable;
+import javax.swing.SortOrder;
 
 import org.parosproxy.paros.Constant;
 import org.parosproxy.paros.model.Session;
+import org.parosproxy.paros.view.View;
 import org.zaproxy.zap.model.Context;
 import org.zaproxy.zap.model.ParameterParser;
 import org.zaproxy.zap.model.StandardParameterParser;
-import org.zaproxy.zap.utils.DisplayUtils;
+import org.zaproxy.zap.model.StructuralNodeModifier;
 import org.zaproxy.zap.utils.ZapTextField;
 
 public class ContextStructurePanel extends AbstractContextPropertiesPanel {
@@ -43,16 +51,14 @@ public class ContextStructurePanel extends AbstractContextPropertiesPanel {
 	private static final String PANEL_NAME = Constant.messages.getString("context.struct.title");
 	private static final long serialVersionUID = -1;
 
+	private StructuralNodeModifiersTableModel ddnTableModel;
+	
 	private JPanel panelSession = null;
 	private ZapTextField urlKvPairSeparators = null;
 	private ZapTextField urlKeyValueSeparators = null;
 	private ZapTextField postKeyValueSeparators = null;
 	private ZapTextField postKvPairSeparators = null;
 
-	private JTable tableStructuralParams = null;
-	private JScrollPane jScrollPane = null;
-	private SingleColumnTableModel model = null;
-
 	/**
 	 * Returns the name of the panel "Structure" for the given {@code contextIndex}.
 	 * 
@@ -74,6 +80,7 @@ public class ContextStructurePanel extends AbstractContextPropertiesPanel {
 	private void initialize() {
 		this.setLayout(new CardLayout());
 		this.setName(getPanelName(this.getContextIndex()));
+		//this.add(new JScrollPane(getPanel()), getPanel().getName());
 		this.add(getPanel(), getPanel().getName());
 	}
 
@@ -87,12 +94,14 @@ public class ContextStructurePanel extends AbstractContextPropertiesPanel {
 			| |  + Structure | URL Key value delimiters       [ =    ] |
 			| |              | POST Key value pair delimiters [ &    ] |
 			| |              | POST Key value delimiters      [ =    ] |
-			| |              | Structural Parameters:  +-------------+ |
-			| |              |                         |             | |
-			| |              |                         |             | |
-			| |              |                         |             | |
-			| |              |                         |             | |
-			| |              |                         +-------------+ |
+			| |              | Structural Modifiers:                   |
+			| |              | +-----------------------------+         |
+			| |              | |                             | [ Add ] |
+			| |              | |                             | [ Mod ] |
+			| |              | |                             | [ Rem ] |
+			| |              | |                             |         |
+			| |              | |                             |         |
+			| |              | +-----------------------------+         |
 			 */
 			panelSession = new JPanel();
 			panelSession.setLayout(new GridBagLayout());
@@ -114,11 +123,11 @@ public class ContextStructurePanel extends AbstractContextPropertiesPanel {
 
 			panelSession.add(new JLabel(Constant.messages.getString("context.struct.label.struct")),
 					LayoutHelper.getGBC(0, 4, 1, 1.0D));
-			panelSession.add(getJScrollPane(),
-					LayoutHelper.getGBC(1, 4, 1, 1.0D, 1.0D, GridBagConstraints.BOTH, new Insets(2, 0, 2, 0)));
-
-			panelSession.add(new JLabel(), LayoutHelper.getGBC(0, 20, 1, 1.0D, 1.0D)); // Padding
-
+			
+			ddnTableModel = new StructuralNodeModifiersTableModel();
+			DataDrivenNodesMultipleOptionsPanel ddnOptionsPanel = 
+					new DataDrivenNodesMultipleOptionsPanel(ddnTableModel);
+			panelSession.add(ddnOptionsPanel, LayoutHelper.getGBC(0, 5, 2, 1.0d, 1.0d));
 		}
 		return panelSession;
 	}
@@ -151,44 +160,24 @@ public class ContextStructurePanel extends AbstractContextPropertiesPanel {
 		return postKvPairSeparators;
 	}
 
-	private JTable getTableStructualParams() {
-		if (tableStructuralParams == null) {
-			tableStructuralParams = new JTable();
-			tableStructuralParams.setModel(getStructuralParamsModel());
-			tableStructuralParams.setRowHeight(DisplayUtils.getScaledSize(18));
-			// Issue 954: Force the JTable cell to auto-save when the focus changes.
-			// Example, edit cell, click OK for a panel dialog box, the data will get saved.
-			tableStructuralParams.putClientProperty("terminateEditOnFocusLost", Boolean.TRUE);
-		}
-		return tableStructuralParams;
-	}
-
-	private JScrollPane getJScrollPane() {
-		if (jScrollPane == null) {
-			jScrollPane = new JScrollPane();
-			jScrollPane.setViewportView(getTableStructualParams());
-			jScrollPane.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));
-		}
-		return jScrollPane;
-	}
-
-	private SingleColumnTableModel getStructuralParamsModel() {
-		if (model == null) {
-			model = new SingleColumnTableModel(Constant.messages.getString("context.struct.table.header.param"));
-		}
-		return model;
-	}
-
 	@Override
 	public void initContextData(Session session, Context context) {
 		ParameterParser urlParamParser = context.getUrlParamParser();
 		ParameterParser formParamParser = context.getPostParamParser();
+
+		this.ddnTableModel.setStructuralNodeModifiers(context.getDataDrivenNodes());
+
 		if (urlParamParser instanceof StandardParameterParser) {
 			StandardParameterParser urlStdParamParser = (StandardParameterParser) urlParamParser;
 			this.getUrlKvPairSeparators().setText(urlStdParamParser.getKeyValuePairSeparators());
 			this.getUrlKeyValueSeparators().setText(urlStdParamParser.getKeyValueSeparators());
 
-			this.getStructuralParamsModel().setLines(urlStdParamParser.getStructuralParameters());
+			for (String structParam : urlStdParamParser.getStructuralParameters()) {
+				this.ddnTableModel.addStructuralNodeModifier(
+						new StructuralNodeModifier(
+								StructuralNodeModifier.Type.StructuralParameter, 
+								null, structParam));
+			}
 		}
 		if (formParamParser instanceof StandardParameterParser) {
 			StandardParameterParser formStdParamParser = (StandardParameterParser) formParamParser;
@@ -231,40 +220,231 @@ public class ContextStructurePanel extends AbstractContextPropertiesPanel {
 	 *
 	 * @param context the context
 	 */
-	private void saveToContext(Context context) {
+	private void saveToContext(Context context, boolean updateSiteStructure) {
 		ParameterParser urlParamParser = context.getUrlParamParser();
 		ParameterParser formParamParser = context.getPostParamParser();
+		List<String> structParams = new ArrayList<String>();
+		List<StructuralNodeModifier> ddns = new ArrayList<StructuralNodeModifier>();
+		
+		for (StructuralNodeModifier snm : this.ddnTableModel.getElements()) {
+			if (snm.getType().equals(StructuralNodeModifier.Type.StructuralParameter)) {
+				structParams.add(snm.getName());
+			} else {
+				ddns.add(snm);
+			}
+		}
 
 		if (urlParamParser instanceof StandardParameterParser) {
 			StandardParameterParser urlStdParamParser = (StandardParameterParser) urlParamParser;
 			urlStdParamParser.setKeyValuePairSeparators(this.getUrlKvPairSeparators().getText());
 			urlStdParamParser.setKeyValueSeparators(this.getUrlKeyValueSeparators().getText());
 
-			urlStdParamParser.setStructuralParameters(this.getStructuralParamsModel().getLines());
+			urlStdParamParser.setStructuralParameters(structParams);
 
 			context.setUrlParamParser(urlStdParamParser);
+			urlStdParamParser.setContext(context);
 		}
 		if (formParamParser instanceof StandardParameterParser) {
 			StandardParameterParser formStdParamParser = (StandardParameterParser) formParamParser;
 			formStdParamParser.setKeyValuePairSeparators(this.getPostKvPairSeparators().getText());
 			formStdParamParser.setKeyValueSeparators(this.getPostKeyValueSeparators().getText());
 			context.setPostParamParser(formStdParamParser);
+			formStdParamParser.setContext(context);
+		}
+		
+		context.setDataDrivenNodes(ddns);
+		
+		if (updateSiteStructure) {
+			context.restructureSiteTree();
 		}
 	}
 
 	@Override
 	public void saveContextData(Session session) throws Exception {
 		Context context = session.getContext(getContextIndex());
-		saveToContext(context);
+		saveToContext(context, true);
 	}
 
 	@Override
 	public void saveTemporaryContextData(Context uiSharedContext) {
-		saveToContext(uiSharedContext);
+		saveToContext(uiSharedContext, false);
 	}
 
 	@Override
 	public String getHelpIndex() {
 		return "ui.dialogs.contexts";
 	}
+
+	public static class DataDrivenNodesMultipleOptionsPanel extends AbstractMultipleOptionsBaseTablePanel<StructuralNodeModifier> {
+		private static final long serialVersionUID = -7216673905642941770L;
+		private static final String REMOVE_DIALOG_TITLE = Constant.messages.getString("context.ddn.dialog.remove.title");
+		private static final String REMOVE_DIALOG_TEXT = Constant.messages.getString("context.ddn.dialog.remove.text");
+
+		private static final String REMOVE_DIALOG_CONFIRM_BUTTON_LABEL = 
+				Constant.messages.getString("all.button.remove");
+		private static final String REMOVE_DIALOG_CANCEL_BUTTON_LABEL = 
+				Constant.messages.getString("all.button.cancel");
+
+		private static final String REMOVE_DIALOG_CHECKBOX_LABEL = 
+				Constant.messages.getString("all.prompt.dontshow");
+
+		public DataDrivenNodesMultipleOptionsPanel(StructuralNodeModifiersTableModel model) {
+			super(model);
+
+			getTable().getColumnExt(0).setPreferredWidth(50);
+			getTable().getColumnExt(1).setPreferredWidth(50);
+			getTable().getColumnExt(2).setPreferredWidth(200);
+			getTable().setSortOrder(1, SortOrder.ASCENDING);
+		}
+
+		@Override
+		public StructuralNodeModifier showAddDialogue() {
+			StructuralModifierDialog ddnDialog = 
+					new StructuralModifierDialog(
+							View.getSingleton().getSessionDialog(), 
+							"context.ddn.dialog.add.title", 
+							new Dimension(500, 200));
+			
+			return ddnDialog.showDialog(null);
+		}
+
+		@Override
+		public StructuralNodeModifier showModifyDialogue(StructuralNodeModifier ddn) {
+			StructuralModifierDialog ddnDialog = 
+					new StructuralModifierDialog(
+							View.getSingleton().getSessionDialog(), 
+							"context.ddn.dialog.modify.title", 
+							new Dimension(500, 200));
+			
+			return ddnDialog.showDialog(ddn);
+		}
+
+		@Override
+		public boolean showRemoveDialogue(StructuralNodeModifier e) {
+			JCheckBox removeWithoutConfirmationCheckBox = new JCheckBox(REMOVE_DIALOG_CHECKBOX_LABEL);
+			Object[] messages = { REMOVE_DIALOG_TEXT, " ", removeWithoutConfirmationCheckBox };
+			int option = JOptionPane.showOptionDialog(View.getSingleton().getMainFrame(), messages,
+					REMOVE_DIALOG_TITLE, JOptionPane.OK_CANCEL_OPTION, JOptionPane.QUESTION_MESSAGE, null,
+					new String[] { REMOVE_DIALOG_CONFIRM_BUTTON_LABEL, REMOVE_DIALOG_CANCEL_BUTTON_LABEL },
+					null);
+
+			if (option == JOptionPane.OK_OPTION) {
+				setRemoveWithoutConfirmation(removeWithoutConfirmationCheckBox.isSelected());
+				return true;
+			}
+
+			return false;
+		}
+	}
+	
+	public static class StructuralModifierDialog extends StandardFieldsDialog {
+		private static final long serialVersionUID = 1L;
+		
+		private static final String FIELD_TYPE = "context.ddn.dialog.type";
+		private static final String FIELD_NAME = "context.ddn.dialog.name";
+		private static final String FIELD_REGEX = "context.ddn.dialog.regex";
+		
+		private static final String VALUE_TYPE_DATA = "context.ddn.dialog.type.data";
+		private static final String VALUE_TYPE_STRUCT = "context.ddn.dialog.type.struct";
+		
+		private StructuralNodeModifier.Type type = StructuralNodeModifier.Type.StructuralParameter;
+		private StructuralNodeModifier ddn = null;
+		private boolean ro = false;
+
+		public StructuralModifierDialog(JDialog owner, String titleLabel,
+				Dimension dim) {
+			super(owner, titleLabel, dim, true);
+		}
+		
+		public StructuralNodeModifier showDialog(StructuralNodeModifier ddn) {
+			String regex = "";
+			String name = "";
+			
+			this.ddn = ddn;
+			if (ddn != null) {
+				type = ddn.getType();
+				if (ddn.getPattern() != null) {
+					regex = ddn.getPattern().pattern();
+				}
+				name = ddn.getName();
+				ro = true;
+				this.addReadOnlyField(FIELD_NAME, getModVal(type), false);
+			} else {
+				this.addComboField(FIELD_TYPE, 
+						new String [] {
+							Constant.messages.getString(VALUE_TYPE_STRUCT), 
+							Constant.messages.getString(VALUE_TYPE_DATA)}, 
+							getModVal(type)); 
+				this.addFieldListener(FIELD_TYPE, new ActionListener() {
+					@Override
+					public void actionPerformed(ActionEvent e) {
+						setFieldStates();						
+					}});
+			}
+			
+			this.addTextField(FIELD_NAME, name);
+			this.addTextField(FIELD_REGEX, regex);
+
+			setFieldStates();
+
+			this.setVisible(true);
+			
+			return this.ddn;
+		}
+		
+		private void setFieldStates() {
+			if (! ro) {
+				if (Constant.messages.getString(VALUE_TYPE_STRUCT).equals(
+						this.getStringValue(FIELD_TYPE))) {
+					type = StructuralNodeModifier.Type.StructuralParameter;
+				} else {
+					type = StructuralNodeModifier.Type.DataDrivenNode;
+				}
+			}
+			this.getField(FIELD_REGEX).setEnabled(
+					StructuralNodeModifier.Type.DataDrivenNode.equals(type));
+		}
+
+		private String getModVal(StructuralNodeModifier.Type type) {
+			switch (type) {
+			case StructuralParameter: 	return Constant.messages.getString(VALUE_TYPE_STRUCT);
+			case DataDrivenNode:		return Constant.messages.getString(VALUE_TYPE_DATA);
+			}
+			return "";
+		}
+
+		@Override
+		public void save() {
+			ddn = new StructuralNodeModifier(
+					type,
+					Pattern.compile(this.getStringValue(FIELD_REGEX)), 
+					this.getStringValue(FIELD_NAME));
+		}
+
+		@Override
+		public String validateFields() {
+			if (! this.getStringValue(FIELD_NAME).matches("[A-Za-z0-9]+")) {
+				// Must supply a name just made up of alphanumeric characters
+				return Constant.messages.getString("context.ddn.dialog.error.name");
+			}
+			
+			if (StructuralNodeModifier.Type.DataDrivenNode.equals(type)) {
+				if (this.isEmptyField(FIELD_REGEX)) {
+					return Constant.messages.getString("context.ddn.dialog.error.regex");
+				}
+				if (! this.getStringValue(FIELD_REGEX).matches(".*\\(.*\\).*\\(.*\\).*")) {
+					// We need at least 2 groups
+					return Constant.messages.getString("context.ddn.dialog.error.regex");
+				}
+				try {
+					Pattern.compile(this.getStringValue(FIELD_REGEX));
+				} catch (Exception e) {
+					// Not a valid regex expression
+					return Constant.messages.getString("context.ddn.dialog.error.regex");
+				}
+			}
+			
+			return null;
+		}
+	}
 }
diff --git a/src/org/zaproxy/zap/view/ScanPanel.java b/src/org/zaproxy/zap/view/ScanPanel.java
index 69e8a8c50..53bac4dfe 100644
--- a/src/org/zaproxy/zap/view/ScanPanel.java
+++ b/src/org/zaproxy/zap/view/ScanPanel.java
@@ -611,7 +611,7 @@ public abstract class ScanPanel extends AbstractPanel {
 	public static String cleanSiteName(SiteNode node, boolean incPort) {
 		if (node != null) {
 			while (node.getParent() != null && node.getParent().getParent() != null) {
-				node = (SiteNode) node.getParent();
+				node = node.getParent();
 			}
 			return cleanSiteName(node.getNodeName(), incPort);
 		}
diff --git a/src/org/zaproxy/zap/view/SiteMapTreeCellRenderer.java b/src/org/zaproxy/zap/view/SiteMapTreeCellRenderer.java
index 90141581c..cd06dd2b3 100644
--- a/src/org/zaproxy/zap/view/SiteMapTreeCellRenderer.java
+++ b/src/org/zaproxy/zap/view/SiteMapTreeCellRenderer.java
@@ -48,6 +48,8 @@ public class SiteMapTreeCellRenderer extends DefaultTreeCellRenderer {
 	private static final ImageIcon FOLDER_OPEN_ICON = new ImageIcon(DefaultTreeCellRenderer.class.getResource("/resource/icon/fugue/folder-horizontal-open.png"));
 	private static final ImageIcon FOLDER_CLOSED_IN_SCOPE_ICON = new ImageIcon(DefaultTreeCellRenderer.class.getResource("/resource/icon/fugue/folder-horizontal-target.png"));
 	private static final ImageIcon FOLDER_CLOSED_ICON = new ImageIcon(DefaultTreeCellRenderer.class.getResource("/resource/icon/fugue/folder-horizontal.png"));
+	private static final ImageIcon DATA_DRIVEN_ICON = new ImageIcon(DefaultTreeCellRenderer.class.getResource("/resource/icon/fugue/database.png"));
+	private static final ImageIcon DATA_DRIVEN_IN_SCOPE_ICON = new ImageIcon(DefaultTreeCellRenderer.class.getResource("/resource/icon/fugue/database-target.png"));
 
 	private static final ImageIcon LOCK_OVERLAY_ICON = new ImageIcon(DefaultTreeCellRenderer.class.getResource("/resource/icon/fugue/lock-overlay.png"));
 
@@ -87,36 +89,39 @@ public class SiteMapTreeCellRenderer extends DefaultTreeCellRenderer {
 			if (node.isRoot()) {
 				setIcon(DisplayUtils.getScaledIcon(ROOT_ICON));	// 'World' icon
 			} else {
-		        ImageIcon icon;
-				if (leaf) {
+				OverlayIcon icon;
+		        if (node.isDataDriven()) {
 					if (node.isIncludedInScope() && ! node.isExcludedFromScope()) {
-						icon = LEAF_IN_SCOPE_ICON;
+						icon = new OverlayIcon(DATA_DRIVEN_IN_SCOPE_ICON);
 					} else {
-						icon = LEAF_ICON;
+						icon = new OverlayIcon(DATA_DRIVEN_ICON);
+					}
+		        } else if (leaf) {
+					if (node.isIncludedInScope() && ! node.isExcludedFromScope()) {
+						icon = new OverlayIcon(LEAF_IN_SCOPE_ICON);
+					} else {
+						icon = new OverlayIcon(LEAF_ICON);
 					}
 				} else {
 					if  (expanded) {
 						if (node.isIncludedInScope() && ! node.isExcludedFromScope()) {
-							icon = FOLDER_OPEN_IN_SCOPE_ICON;
+							icon = new OverlayIcon(FOLDER_OPEN_IN_SCOPE_ICON);
 						} else {
-							icon = FOLDER_OPEN_ICON;
+							icon = new OverlayIcon(FOLDER_OPEN_ICON);
 						}
 					} else {
 						if (node.isIncludedInScope() && ! node.isExcludedFromScope()) {
-							icon = FOLDER_CLOSED_IN_SCOPE_ICON;
+							icon = new OverlayIcon(FOLDER_CLOSED_IN_SCOPE_ICON);
 						} else {
-							icon = FOLDER_CLOSED_ICON;
+							icon = new OverlayIcon(FOLDER_CLOSED_ICON);
 						}
 					}
 				}
-				if (((SiteNode)node.getParent()).isRoot() && node.getNodeName().startsWith("https://")) {
+				if (node.getParent().isRoot() && node.getNodeName().startsWith("https://")) {
 					// Add lock icon to site nodes with https
-					OverlayIcon oi = new OverlayIcon(icon);
-					oi.add(LOCK_OVERLAY_ICON);
-					setIcon(DisplayUtils.getScaledIcon(oi));
-				} else {
-					setIcon(DisplayUtils.getScaledIcon(icon));
+					icon.add(LOCK_OVERLAY_ICON);
 				}
+				setIcon(DisplayUtils.getScaledIcon(icon));
 			}
 
 	        for (SiteMapListener listener : listeners) {
diff --git a/src/org/zaproxy/zap/view/StandardFieldsDialog.java b/src/org/zaproxy/zap/view/StandardFieldsDialog.java
index 91ccdefcb..79b373c3d 100644
--- a/src/org/zaproxy/zap/view/StandardFieldsDialog.java
+++ b/src/org/zaproxy/zap/view/StandardFieldsDialog.java
@@ -105,6 +105,10 @@ public abstract class StandardFieldsDialog extends AbstractDialog {
 		this((Window)owner, titleLabel, dim);
 	}
 
+	public StandardFieldsDialog(Window owner, String titleLabel, Dimension dim, boolean modal) {
+		this(owner, titleLabel, dim, null, modal);
+	}
+
 	public StandardFieldsDialog(Window owner, String titleLabel, Dimension dim) {
 		this(owner, titleLabel, dim, null);
 	}
@@ -119,9 +123,13 @@ public abstract class StandardFieldsDialog extends AbstractDialog {
 	public StandardFieldsDialog(Frame owner, String titleLabel, Dimension dim, String[] tabLabels) {
 		this((Window)owner, titleLabel, dim, tabLabels);
 	}
-
+	
 	public StandardFieldsDialog(Window owner, String titleLabel, Dimension dim, String[] tabLabels) {
-		super(owner, false);
+		this((Window)owner, titleLabel, dim, tabLabels, false);
+	}
+
+	public StandardFieldsDialog(Window owner, String titleLabel, Dimension dim, String[] tabLabels, boolean modal) {
+		super(owner, modal);
 		this.setTitle(Constant.messages.getString(titleLabel));
 		this.setXWeights(0.4D, 0.6D);	// Looks a bit better..
 		this.initialize(dim, tabLabels);
diff --git a/src/org/zaproxy/zap/view/StructuralNodeModifiersTableModel.java b/src/org/zaproxy/zap/view/StructuralNodeModifiersTableModel.java
new file mode 100644
index 000000000..4e9929d31
--- /dev/null
+++ b/src/org/zaproxy/zap/view/StructuralNodeModifiersTableModel.java
@@ -0,0 +1,159 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2015 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License"); 
+ * you may not use this file except in compliance with the License. 
+ * You may obtain a copy of the License at 
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0 
+ *   
+ * Unless required by applicable law or agreed to in writing, software 
+ * distributed under the License is distributed on an "AS IS" BASIS, 
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
+ * See the License for the specific language governing permissions and 
+ * limitations under the License. 
+ */
+package org.zaproxy.zap.view;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import org.parosproxy.paros.Constant;
+import org.zaproxy.zap.model.Context;
+import org.zaproxy.zap.model.StructuralNodeModifier;
+
+/**
+ * A table model for holding a set of structural node modifiers, for a {@link Context}.
+ * @since TODO add version
+ */
+public class StructuralNodeModifiersTableModel extends AbstractMultipleOptionsTableModel<StructuralNodeModifier> {
+
+	/** The Constant defining the table column names. */
+	private static final String[] COLUMN_NAMES = {
+			Constant.messages.getString("context.ddn.table.header.type"),
+			Constant.messages.getString("context.ddn.table.header.name"),
+			Constant.messages.getString("context.ddn.table.header.regex") };
+
+	/** The Constant serialVersionUID. */
+	private static final long serialVersionUID = 4463944219657112162L;
+
+	/** The users. */
+	private List<StructuralNodeModifier> snms = new ArrayList<StructuralNodeModifier>();
+
+	/**
+	 * Instantiates a new structural node modifiers table model. An internal copy of the provided list is stored.
+	 * 
+	 * @param snms the structural node modifiers
+	 */
+	public StructuralNodeModifiersTableModel(List<StructuralNodeModifier> snms) {
+		this.snms = new ArrayList<>(snms);
+	}
+
+	/**
+	 * Instantiates a new user table model.
+	 */
+	public StructuralNodeModifiersTableModel() {
+		this.snms = new ArrayList<>();
+	}
+
+	@Override
+	public int getColumnCount() {
+		return COLUMN_NAMES.length;
+	}
+
+	@Override
+	public int getRowCount() {
+		return snms.size();
+	}
+
+	@Override
+	public Object getValueAt(int rowIndex, int columnIndex) {
+		switch (columnIndex) {
+		case 0:
+			switch (snms.get(rowIndex).getType()) {
+			case StructuralParameter:	return Constant.messages.getString("context.ddn.table.type.struct");
+			case DataDrivenNode:		return Constant.messages.getString("context.ddn.table.type.data");
+			}
+		case 1:
+			return snms.get(rowIndex).getName();
+		case 2:
+			if (snms.get(rowIndex).getPattern() != null) {
+				return snms.get(rowIndex).getPattern().pattern();
+			}
+			return null;
+		default:
+			return null;
+		}
+	}
+
+	@Override
+	public List<StructuralNodeModifier> getElements() {
+		return snms;
+	}
+
+	/**
+	 * Gets the internal list of users managed by this model. 
+	 * 
+	 * @return the users
+	 */
+	public List<StructuralNodeModifier> getStructuralNodeModifiers() {
+		return snms;
+	}
+
+	@Override
+	public boolean isCellEditable(int rowIndex, int columnIndex) {
+		return false;
+	}
+
+	/**
+	 * Sets a new list of structural node modifiers for this model. An internal copy of the provided list is stored.
+	 * 
+	 * @param snms the new structural node modifiers
+	 */
+	public void setStructuralNodeModifiers(List<StructuralNodeModifier> snms) {
+		this.snms = new ArrayList<>(snms);
+		this.fireTableDataChanged();
+	}
+	
+	public void addStructuralNodeModifiers(List<StructuralNodeModifier> snms) {
+		this.snms.addAll(snms);
+		this.fireTableDataChanged();
+	}
+	
+	/**
+	 * Removes all the structural node modifiers for this model.
+	 */
+	public void removeAllStructuralNodeModifiers(){
+		this.snms=new ArrayList<>();
+		this.fireTableDataChanged();
+	}
+	
+	/**
+	 * Adds a new structural node modifiers to this model
+	 *
+	 * @param snm the structural node modifier
+	 */
+	public void addStructuralNodeModifier(StructuralNodeModifier snm){
+		this.snms.add(snm);
+		this.fireTableRowsInserted(this.snms.size()-1, this.snms.size()-1);
+	}
+
+	@Override
+	public Class<?> getColumnClass(int columnIndex) {
+		return String.class;
+	}
+
+	@Override
+	public String getColumnName(int column) {
+		return COLUMN_NAMES[column];
+	}
+
+	@Override
+	public void setValueAt(Object aValue, int rowIndex, int columnIndex) {
+	}
+
+}
diff --git a/src/org/zaproxy/zap/view/popup/PopupMenuItemContextDataDriven.java b/src/org/zaproxy/zap/view/popup/PopupMenuItemContextDataDriven.java
new file mode 100644
index 000000000..8af70a625
--- /dev/null
+++ b/src/org/zaproxy/zap/view/popup/PopupMenuItemContextDataDriven.java
@@ -0,0 +1,112 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2015 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.zaproxy.zap.view.popup;
+
+import java.text.MessageFormat;
+import java.util.ArrayList;
+import java.util.List;
+
+import javax.swing.JMenuItem;
+
+import org.parosproxy.paros.Constant;
+import org.parosproxy.paros.extension.ExtensionPopupMenuItem;
+import org.parosproxy.paros.model.Model;
+import org.parosproxy.paros.model.Session;
+import org.parosproxy.paros.model.SiteNode;
+import org.parosproxy.paros.view.View;
+import org.zaproxy.zap.model.Context;
+
+/**
+ * @since TODO add version
+ */
+public class PopupMenuItemContextDataDriven extends PopupMenuItemSiteNodeContainer {
+
+    private static final long serialVersionUID = 3790264690466717219L;
+
+    private List<ExtensionPopupMenuItem> subMenus = new ArrayList<>();
+
+    /**
+     * This method initializes
+     * 
+     */
+    public PopupMenuItemContextDataDriven() {
+        super("DataDrivenNodeX", true);
+    }
+
+    /**/
+    @Override
+    public String getParentMenuName() {
+        return Constant.messages.getString("context.flag.popup");
+    }
+
+    @Override
+    public boolean isSubMenu() {
+        return true;
+    }
+
+    @Override
+    public boolean isDummyItem() {
+        return true;
+    }
+
+    @Override
+    public void performAction(SiteNode sn) {
+        // Do nothing
+    }
+
+    @Override
+    public boolean isButtonEnabledForSiteNode(SiteNode sn) {
+        reCreateSubMenu(sn);
+
+        return false;
+    }
+
+    protected void reCreateSubMenu(SiteNode sn) {
+        final List<JMenuItem> mainPopupMenuItems = View.getSingleton().getPopupList();
+        for (ExtensionPopupMenuItem menu : subMenus) {
+            mainPopupMenuItems.remove(menu);
+
+        }
+        subMenus.clear();
+
+        Session session = Model.getSingleton().getSession();
+        List<Context> contexts = session.getContexts();
+        for (Context context : contexts) {
+        	if (context.isIncluded(sn)) {
+	            ExtensionPopupMenuItem piicm = createPopupDataDrivenNodeMenu(context);
+	            piicm.setMenuIndex(this.getMenuIndex());
+	            mainPopupMenuItems.add(piicm);
+	            this.subMenus.add(piicm);
+        	}
+        }
+    }
+
+    protected ExtensionPopupMenuItem createPopupDataDrivenNodeMenu(Context context) {
+        return new PopupMenuItemContextDataDrivenNode(context,
+        		MessageFormat.format(
+        				Constant.messages.getString("context.flag.popup.datadriven"), context.getName()));
+    }
+
+    @Override
+    public boolean isSafe() {
+        return true;
+    }
+
+}
diff --git a/src/org/zaproxy/zap/view/popup/PopupMenuItemContextDataDrivenNode.java b/src/org/zaproxy/zap/view/popup/PopupMenuItemContextDataDrivenNode.java
new file mode 100644
index 000000000..d018fdad9
--- /dev/null
+++ b/src/org/zaproxy/zap/view/popup/PopupMenuItemContextDataDrivenNode.java
@@ -0,0 +1,107 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2015 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.zaproxy.zap.view.popup;
+
+import java.util.regex.Pattern;
+
+import org.parosproxy.paros.Constant;
+import org.parosproxy.paros.model.Model;
+import org.parosproxy.paros.model.Session;
+import org.parosproxy.paros.model.SiteNode;
+import org.parosproxy.paros.view.SessionDialog;
+import org.parosproxy.paros.view.View;
+import org.zaproxy.zap.model.Context;
+import org.zaproxy.zap.model.StructuralNodeModifier;
+import org.zaproxy.zap.view.ContextStructurePanel;
+
+
+/**
+ * @since TODO add version
+ */
+public class PopupMenuItemContextDataDrivenNode extends PopupMenuItemSiteNodeContainer {
+
+    private static final long serialVersionUID = 990419495607725846L;
+
+    protected Context context;
+
+    public PopupMenuItemContextDataDrivenNode(Context context, String name) {
+        super(name, true);
+        this.context = context;
+    }
+
+    @Override
+    public String getParentMenuName() {
+        return Constant.messages.getString("context.flag.popup");
+    }
+
+    @Override
+    public boolean isSubMenu() {
+        return true;
+    }
+
+    @Override
+    public void performAction(SiteNode sn) {
+        Session session = Model.getSingleton().getSession();
+
+        SessionDialog sessionDialog = View.getSingleton().getSessionDialog();
+        sessionDialog.recreateUISharedContexts(session);
+        Context uiSharedContext = sessionDialog.getUISharedContext(context.getIndex());
+
+        // We want to form a regex expression like:
+        // https://www.example.com/(aa/bb/cc/)(.+?)(/.*)
+        
+        StringBuilder sb = new StringBuilder();
+        
+        SiteNode parent = sn.getParent();
+        
+        while (!parent.getParent().isRoot()) {
+        	sb.insert(0, "/");
+        	if (parent.isDataDriven()) {
+        		// Dont want these in their own regex group
+        		sb.insert(0, ".+?");
+        	} else {
+        		sb.insert(0, parent.getCleanNodeName());
+        	}
+            parent = parent.getParent();
+        }
+    	sb.insert(0, "/(");
+    	sb.insert(0, parent.getCleanNodeName());
+        sb.append(")(.+?)(/.*)");
+        Pattern p = Pattern.compile(sb.toString());
+        
+        uiSharedContext.addDataDrivenNodes(
+        		new StructuralNodeModifier(StructuralNodeModifier.Type.DataDrivenNode, 
+        				p, uiSharedContext.getDefaultDDNName()));
+
+        // Show the session dialog without recreating UI Shared contexts
+        View.getSingleton().showSessionDialog(session, ContextStructurePanel.getPanelName(context.getIndex()),
+                false);
+    }
+
+    @Override
+    public boolean isButtonEnabledForSiteNode(SiteNode sn) {
+    	return sn.getLevel() > 2;
+    }
+
+    @Override
+    public boolean isSafe() {
+        return true;
+    }
+}
diff --git a/src/org/zaproxy/zap/view/popup/PopupMenuItemIncludeInContext.java b/src/org/zaproxy/zap/view/popup/PopupMenuItemIncludeInContext.java
index 693831230..fdecaf837 100644
--- a/src/org/zaproxy/zap/view/popup/PopupMenuItemIncludeInContext.java
+++ b/src/org/zaproxy/zap/view/popup/PopupMenuItemIncludeInContext.java
@@ -19,18 +19,15 @@
  */
 package org.zaproxy.zap.view.popup;
 
-import java.util.regex.Pattern;
-
-import org.apache.commons.httpclient.URI;
-import org.apache.commons.httpclient.URIException;
-import org.apache.log4j.Logger;
 import org.parosproxy.paros.Constant;
+import org.parosproxy.paros.db.DatabaseException;
 import org.parosproxy.paros.model.Model;
 import org.parosproxy.paros.model.Session;
 import org.parosproxy.paros.model.SiteNode;
 import org.parosproxy.paros.view.SessionDialog;
 import org.parosproxy.paros.view.View;
 import org.zaproxy.zap.model.Context;
+import org.zaproxy.zap.model.StructuralSiteNode;
 import org.zaproxy.zap.view.ContextIncludePanel;
 
 
@@ -41,8 +38,6 @@ public class PopupMenuItemIncludeInContext extends PopupMenuItemSiteNodeContaine
 
     private static final long serialVersionUID = 990419495607725846L;
 
-    private static final Logger LOGGER = Logger.getLogger(PopupMenuItemIncludeInContext.class);
-
     protected Context context;
 
     /**
@@ -72,22 +67,11 @@ public class PopupMenuItemIncludeInContext extends PopupMenuItemSiteNodeContaine
 
     @Override
     public void performAction(SiteNode sn) {
-        String url;
         try {
-            url = new URI(sn.getHierarchicNodeName(), false).toString();
-        } catch (URIException e) {
-            LOGGER.error("Failed to execute action include in context: " + e.getMessage(), e);
-            return;
-        }
-
-        if (sn.isLeaf() && ! (sn.getParent().getParent() == null)) {
-        	// Its a leaf and not a site
-            url = Pattern.quote(url);
-        } else {
-            url = Pattern.quote(url) + ".*";
-        }
-
-        performAction(sn.getNodeName(), url);
+			performAction(sn.getNodeName(), new StructuralSiteNode(sn).getRegexPattern());
+		} catch (DatabaseException e) {
+			// Ignore
+		}
     }
 
     protected void performAction(String name, String url) {
diff --git a/src/resource/icon/fugue/cards-stack.png b/src/resource/icon/fugue/cards-stack.png
new file mode 100644
index 000000000..fd024210e
Binary files /dev/null and b/src/resource/icon/fugue/cards-stack.png differ
diff --git a/src/resource/icon/fugue/database-target.png b/src/resource/icon/fugue/database-target.png
new file mode 100644
index 000000000..1ba709061
Binary files /dev/null and b/src/resource/icon/fugue/database-target.png differ
diff --git a/src/resource/icon/fugue/database.png b/src/resource/icon/fugue/database.png
new file mode 100644
index 000000000..d588f422f
Binary files /dev/null and b/src/resource/icon/fugue/database.png differ
diff --git a/src/resource/icon/fugue/target-overlay.png b/src/resource/icon/fugue/target-overlay.png
new file mode 100644
index 000000000..56531b62e
Binary files /dev/null and b/src/resource/icon/fugue/target-overlay.png differ
diff --git a/test/org/zaproxy/zap/model/StandardParameterParserUnitTest.java b/test/org/zaproxy/zap/model/StandardParameterParserUnitTest.java
index f003ac221..8f9598e48 100644
--- a/test/org/zaproxy/zap/model/StandardParameterParserUnitTest.java
+++ b/test/org/zaproxy/zap/model/StandardParameterParserUnitTest.java
@@ -17,17 +17,20 @@
  */
 package org.zaproxy.zap.model;
 
-import org.junit.Before;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mockito.runners.MockitoJUnitRunner;
-import org.parosproxy.paros.model.Session;
+import static org.junit.Assert.assertEquals;
 
 import java.util.ArrayList;
 import java.util.List;
 import java.util.Map;
+import java.util.regex.Pattern;
 
-import static org.junit.Assert.assertEquals;
+import org.apache.commons.httpclient.URI;
+import org.apache.commons.httpclient.URIException;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.runners.MockitoJUnitRunner;
+import org.parosproxy.paros.model.Session;
 
 @RunWith(MockitoJUnitRunner.class)
 public class StandardParameterParserUnitTest {
@@ -102,4 +105,73 @@ public class StandardParameterParserUnitTest {
 		assertEquals(res.get("b"), "c");
 	}
 
+	/**
+	 * Gets the path of the URI's ancestor found at the given depth, taking into account any context
+	 * specific configuration (e.g. structural parameters). The depth could also be seen as the
+	 * number of path elements returned.
+	 * <p/>
+	 * A few examples (uri, depth):
+	 * <ul>
+	 * <li>(<i>http://example.org/path/to/element</i>, 0) -> ""</li>
+	 * <li>(<i>http://example.org/path/to/element</i>, 1) -> "/path"</li>
+	 * <li>(<i>http://example.org/path/to/element</i>, 3) -> "/path/to/element"</li>
+	 * <li>(<i>http://example.org/path?page=12&data=123</i>, 2) -> "/path?page=12", if {@code page}
+	 * is a structural parameter</li>
+	 * <li>(<i>http://example.org/path?page=12&data=123&type=1</i>, 3) -> "/path?page=12&type=1", if
+	 * {@code page} and {@code type} are both structural parameter</li>
+	 * </ul>
+	 * @throws NullPointerException 
+	 * 
+	 * @throws URIException if an error occurred while accessing the provided uri
+	 */
+	@Test
+	public void ansestorPath() throws Exception {
+		// standard urls
+		assertEquals("",
+				spp.getAncestorPath(
+						new URI("http://example.org/path/to/element", true), 0));
+		assertEquals("/path",
+				spp.getAncestorPath(
+						new URI("http://example.org/path/to/element", true), 1));
+		assertEquals("/path/to",
+				spp.getAncestorPath(
+						new URI("http://example.org/path/to/element", true), 2));
+		assertEquals("/path/to/element",
+				spp.getAncestorPath(
+						new URI("http://example.org/path/to/element", true), 3));
+		assertEquals("/path",
+				spp.getAncestorPath(
+						new URI("http://example.org/path?page=12&data=123", true), 3));
+		assertEquals("/path",
+				spp.getAncestorPath(
+						new URI("http://example.org/path?page=12&data=123&type=1", true), 3));
+
+		// With structural params
+		List<String> structuralParameters = new ArrayList<String>();
+		structuralParameters.add("page");
+		structuralParameters.add("type");
+		spp.setStructuralParameters(structuralParameters );
+		assertEquals("/path?page=12",
+				spp.getAncestorPath(
+						new URI("http://example.org/path?page=12&data=123", true), 3));
+		assertEquals("/path?page=12&type=1",
+				spp.getAncestorPath(
+						new URI("http://example.org/path?page=12&data=123&type=1", true), 3));
+		
+		// with data driven nodes
+		Context context = new Context(session, 0);
+		Pattern p = Pattern.compile("http://example.org/(path/to/)(.+?)(/.*)");
+		StructuralNodeModifier ddn = 
+				new StructuralNodeModifier(
+						StructuralNodeModifier.Type.DataDrivenNode, 
+						p, "DDN");
+		context.addDataDrivenNodes(ddn );
+		spp.setContext(context);
+		assertEquals("/path/to/(.+?)",
+				spp.getAncestorPath(
+						new URI("http://example.org/path/to/ddn/aa", true), 3));
+		assertEquals("/path/to/(.+?)/aa",
+				spp.getAncestorPath(
+						new URI("http://example.org/path/to/ddn/aa", true), 4));
+	}
 }
