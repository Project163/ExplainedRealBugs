diff --git a/src/org/zaproxy/zap/control/AddOnClassLoader.java b/src/org/zaproxy/zap/control/AddOnClassLoader.java
index a5e41ced8..e2e268dd7 100644
--- a/src/org/zaproxy/zap/control/AddOnClassLoader.java
+++ b/src/org/zaproxy/zap/control/AddOnClassLoader.java
@@ -326,7 +326,7 @@ public class AddOnClassLoader extends URLClassLoader {
      * @see AddOnClassLoader#findClass(String)
      * @see ClassLoader#loadClass(String, boolean)
      */
-    private static class ParentClassLoader extends ClassLoader {
+    private class ParentClassLoader extends ClassLoader {
 
         public ParentClassLoader(ClassLoader classLoader) {
             super(classLoader);
@@ -336,6 +336,14 @@ public class AddOnClassLoader extends URLClassLoader {
         protected Class<?> loadClass(String name, boolean resolve) throws ClassNotFoundException {
             return super.loadClass(name, resolve);
         }
+
+        @Override
+        protected Object getClassLoadingLock(String className) {
+            if (classLoadingLockProvider != null) {
+                return classLoadingLockProvider.getLock(className);
+            }
+            return super.getClassLoadingLock(className);
+        }
     }
 
     @FunctionalInterface
