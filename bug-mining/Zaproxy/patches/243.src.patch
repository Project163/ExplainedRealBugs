diff --git a/src/lang/Messages.properties b/src/lang/Messages.properties
index c93c31728..0168a29f5 100644
--- a/src/lang/Messages.properties
+++ b/src/lang/Messages.properties
@@ -85,6 +85,7 @@ api.error.bad_type          = Bad Type
 api.error.bad_view          = Bad View
 api.error.bad_other         = Bad Other
 api.error.bad_pconn         = Bad Persistent Connection
+api.error.bad_state = Bad State
 api.error.disabled          = Disabled
 api.error.does_not_exist    = Does Not Exist
 api.error.href_not_found    = Message Not Found
@@ -1513,6 +1514,7 @@ menu.file.session.activeactions = <html>The following actions are still active:<
 menu.file.sessionExists.error = Session already being persisted to disk.\n You do not need to save it again.
 menu.file.sessionNotExist.error = You can only snapshot a session when it is being persisted to disk.
 menu.file.sessionProperties   = Session Properties...
+menu.file.snapshot.activeactions = <html>No actions can be active to snapshot the session:<ul>{0}</ul></html>
 menu.file.shuttingDown        = Shutting down server and database...
 menu.file.snapshotSession     = Snapshot Session As...
 menu.file.snapshotSession.error = Error saving session snapshot
diff --git a/src/org/parosproxy/paros/control/MenuFileControl.java b/src/org/parosproxy/paros/control/MenuFileControl.java
index a0e8ede65..8be82d8cc 100644
--- a/src/org/parosproxy/paros/control/MenuFileControl.java
+++ b/src/org/parosproxy/paros/control/MenuFileControl.java
@@ -47,6 +47,7 @@
 // ZAP: 2017/06/01 Issue 3555: setTitle() functionality moved in order to ensure consistent application
 // ZAP: 2017/06/20 Inform of active actions before changing the session.
 // ZAP: 2017/08/31 Use helper method I18N.getString(String, Object...).
+// ZAP: 2017/11/22 Do not allow to snapshot the session with active actions (Issue 3711).
 
 package org.parosproxy.paros.control;
  
@@ -449,6 +450,12 @@ public class MenuFileControl implements SessionListener {
 	}
 	
 	public void saveSnapshot() {
+		String activeActions = wrapEntriesInLiTags(control.getExtensionLoader().getActiveActions());
+		if (!activeActions.isEmpty()) {
+			view.showMessageDialog(Constant.messages.getString("menu.file.snapshot.activeactions", activeActions));
+			return;
+		}
+
 	    Session session = model.getSession();
 
 	    JFileChooser chooser = new JFileChooser(model.getOptionsParam().getUserDirectory());
diff --git a/src/org/zaproxy/zap/extension/api/ApiException.java b/src/org/zaproxy/zap/extension/api/ApiException.java
index bb5580275..dfbabdf44 100644
--- a/src/org/zaproxy/zap/extension/api/ApiException.java
+++ b/src/org/zaproxy/zap/extension/api/ApiException.java
@@ -76,7 +76,15 @@ public class ApiException extends Exception {
 		 * 
 		 * @since 2.6.0
 		 */
-		BAD_EXTERNAL_DATA
+		BAD_EXTERNAL_DATA,
+		/**
+		 * Indicates that the request could not fulfilled with the current API state.
+		 * <p>
+		 * The actual reason should be provided in {@code detail} of the exception.
+		 * 
+		 * @since TODO add version
+		 */
+		BAD_STATE,
 	}
 	
 	private final Type type;
diff --git a/src/org/zaproxy/zap/extension/api/CoreAPI.java b/src/org/zaproxy/zap/extension/api/CoreAPI.java
index 07d1de847..638f6051b 100644
--- a/src/org/zaproxy/zap/extension/api/CoreAPI.java
+++ b/src/org/zaproxy/zap/extension/api/CoreAPI.java
@@ -418,6 +418,12 @@ public class CoreAPI extends ApiImplementor implements SessionListener {
 			if (session.isNewState()) {
 				throw new ApiException(ApiException.Type.DOES_NOT_EXIST);
 			}
+
+			List<String> actions = Control.getSingleton().getExtensionLoader().getActiveActions();
+			if (!actions.isEmpty()) {
+				throw new ApiException(ApiException.Type.BAD_STATE, "Active actions prevent the session snapshot: " + actions);
+			}
+
 			String fileName = session.getFileName();
 			
 			if (fileName.endsWith(".session")) {
