diff --git a/src/lang/Messages.properties b/src/lang/Messages.properties
index ed3be62df..4e369548c 100644
--- a/src/lang/Messages.properties
+++ b/src/lang/Messages.properties
@@ -1420,6 +1420,10 @@ keyboard.options.table.header.key	= Key
 keyboard.options.table.header.mods	= Modifiers
 keyboard.options.title			= Keyboard
 
+localProxies.api.action.addAdditionalProxy = Adds an new proxy using the details supplied.
+localProxies.api.action.removeAdditionalProxy = Removes the additional proxy with the specified address and port.
+localProxies.api.view.additionalProxies = Gets all of the additional proxies that have been configured.
+
 locale.options.label.change   = <html><body><p>You can change your language by selecting the <br> &nbsp; &nbsp; &nbsp;&nbsp; Tools / Options... / Language screen</body></html>
 locale.options.label.language = Please select your language:
 
@@ -1713,19 +1717,15 @@ options.lang.selector.label                       = Language:
 options.lang.title                                = Language
 options.lang.usesystemslocaleformat.label = Use system''s locale ({0}) for formatting.
 options.lang.usesystemslocaleformat.tooltip = Sets whether or not the system's locale should be used for formatting dates, numbers, and/or currencies.
+options.proxy.additional.title = Additional Proxies
 options.proxy.local.label.alwaysDecodeGzip = Always unzip gzipped content
 options.proxy.local.label.behindnat = Behind NAT
 options.proxy.local.label.browser     = <html><body><br><p>Set your browser proxy setting using the above.  The HTTP port and HTTPS port must be the same port as above.</p></body></html>
 options.proxy.local.label.local       = Local Proxy
 options.proxy.local.label.misc        = Miscellaneous
 options.proxy.local.label.removeUnsupportedEncodings = Remove Unsupported Encodings
-options.proxy.local.label.address = Address (eg localhost, 127.0.0.1)
-options.proxy.local.label.port        = Port (eg 8080)
-options.proxy.local.label.rev.address = Address (eg 192.168.0.1)
-options.proxy.local.label.rev.local   = <html><body><p>The address should not be "localhost" because a reverse proxy should be accessed by browser from another computer.</p></body></html>
-options.proxy.local.label.rev.port    = HTTP Port (eg 80)
-options.proxy.local.label.reverse     = Reverse proxy
-options.proxy.local.label.userev      = Use reverse proxy
+options.proxy.local.label.address = Address:
+options.proxy.local.label.port        = Port (eg 8080):
 options.proxy.local.title             = Local Proxy
 options.proxy.local.tooltip.alwaysDecodeGzip = <html>Always automatically unzip gzipped content. This option is needed for applications that ignore the modified \"Accept-Encoding\" header<br>\
 This option should be always enabled unless the decoding breaks the application being tested.<br>\
@@ -1736,6 +1736,20 @@ so no (unsupported) encoding transformations are done to the response.<br>\
 This option should be always enabled unless when testing the encoding transformations.<br>\
 The HTTP responses encoded with unsupported encodings will not be correctly scanned (either by passive and active scanners).</html>
 
+options.proxy.dialog.proxy.warning.dup.title = Duplicated Proxy
+options.proxy.dialog.proxy.warning.dup.message = A proxy with this address and port is already defined
+options.proxy.dialog.proxy.warning.fail.title = Invalid Proxy 
+options.proxy.dialog.proxy.warning.fail.message = Unable to listen on this address and port: {0}:{1}
+options.proxy.dialog.proxy.add.title			= Add Local Proxy
+options.proxy.dialog.proxy.add.button.confirm	= Add
+options.proxy.dialog.proxy.modify.button.confirm = Modify
+options.proxy.dialog.proxy.modify.title			= Modify Local Proxy
+options.proxy.dialog.proxy.remove.button.cancel        = Cancel
+options.proxy.dialog.proxy.remove.button.confirm       = Remove
+options.proxy.dialog.proxy.remove.checkbox.label       = Do not show this message again
+options.proxy.dialog.proxy.remove.text                 = Are you sure you want to remove the selected proxy?
+options.proxy.dialog.proxy.remove.title                = Remove Local Proxy
+
 options.script.table.header.dir       = Directory
 options.script.label.dirs             = <html><body><p>Scripts will be loaded from these directories.</p>\
 <p>The scripts must be in subdirectories named after the relevant script type (such as 'active', 'passive', 'proxy' etc) and must have an appropriate extension for the script language used.</p>\
@@ -1787,6 +1801,14 @@ proxy.error.address = Cannot listen on address
 proxy.error.generic = An error occurred while starting the proxy:\n
 proxy.error.readtimeout = Failed to read {0} within {1} seconds, check to see if the site is available and if so consider adjusting ZAP''s read time out in the Connection options panel.
 
+
+proxies.name							= Local Proxies
+proxies.desc							= Manages the local proxy configurations
+proxies.options.table.header.enabled	= Enabled
+proxies.options.table.header.address	= Address
+proxies.options.table.header.port		= Port
+proxies.options.title					= Local Proxies
+
 pscan.api.action.setEnabled = Sets whether or not the passive scanning is enabled (Note: the enabled state is not persisted).
 pscan.api.action.setScanOnlyInScope = Sets whether or not the passive scan should be performed only on messages that are in scope.
 pscan.api.action.enableAllScanners = Enables all passive scanners
diff --git a/src/org/parosproxy/paros/control/Proxy.java b/src/org/parosproxy/paros/control/Proxy.java
index 1f4e468de..4a3d8190d 100644
--- a/src/org/parosproxy/paros/control/Proxy.java
+++ b/src/org/parosproxy/paros/control/Proxy.java
@@ -29,6 +29,7 @@
 // ZAP: 2015/11/04 Issue 1920: Report the host:port ZAP is listening on in daemon mode, or exit if it cant
 // ZAP: 2016/05/30 Issue 2494: ZAP Proxy is not showing the HTTP CONNECT Request in history tab
 // ZAP: 2017/03/15 Enable API
+// ZAP: 2017/11/06 Removed ProxyServerSSL (Issue 3983)
 
 package org.parosproxy.paros.control;
  
@@ -39,7 +40,6 @@ import org.parosproxy.paros.core.proxy.ConnectRequestProxyListener;
 import org.parosproxy.paros.core.proxy.OverrideMessageProxyListener;
 import org.parosproxy.paros.core.proxy.ProxyListener;
 import org.parosproxy.paros.core.proxy.ProxyServer;
-import org.parosproxy.paros.core.proxy.ProxyServerSSL;
 import org.parosproxy.paros.model.Model;
 import org.zaproxy.zap.PersistentConnectionListener;
 import org.zaproxy.zap.control.ControlOverrides;
@@ -48,7 +48,6 @@ public class Proxy {
     
 	private Model model = null;
 	private ProxyServer proxyServer = null;
-	private ProxyServerSSL proxyServerSSL = null;
 	private boolean reverseProxy = false;
 	private String reverseProxyHost = "";
 	private ControlOverrides overrides = null;
@@ -60,8 +59,6 @@ public class Proxy {
 	    
 		proxyServer = new ProxyServer();
 		proxyServer.setEnableApi(true);
-		proxyServerSSL = new ProxyServerSSL();
-		proxyServerSSL.setEnableApi(true);
 	}
 	
 	public boolean startServer() {
@@ -70,14 +67,8 @@ public class Proxy {
 		proxyServer.setProxyParam(model.getOptionsParam().getProxyParam());
 		proxyServer.setConnectionParam(model.getOptionsParam().getConnectionParam());
 
-		proxyServerSSL.setProxyParam(model.getOptionsParam().getProxyParam());
-		proxyServerSSL.setConnectionParam(model.getOptionsParam().getConnectionParam());
-
 		if (model.getOptionsParam().getProxyParam().isUseReverseProxy()) {
 
-//		    int sslPort = proxyServerSSL.startServer(model.getOptionsParam().getProxyParam().getReverseProxyIp(), model.getOptionsParam().getProxyParam().getReverseProxyHttpsPort(), false);
-		    proxyServerSSL.startServer(model.getOptionsParam().getProxyParam().getReverseProxyIp(), model.getOptionsParam().getProxyParam().getReverseProxyHttpsPort(), false);
-
 //			proxyServer.setForwardPort(sslPort);
 		    
 			proxyServer.startServer(model.getOptionsParam().getProxyParam().getReverseProxyIp(), model.getOptionsParam().getProxyParam().getReverseProxyHttpPort(), false);
@@ -119,7 +110,6 @@ public class Proxy {
 
 	public void stopServer() {
         if (model.getOptionsParam().getProxyParam().isUseReverseProxy()) {
-            proxyServerSSL.stopServer();
             proxyServer.stopServer();
 
         } else {
@@ -129,37 +119,30 @@ public class Proxy {
 	
 	public void setSerialize(boolean serialize) {
 	    proxyServer.setSerialize(serialize);
-	    proxyServerSSL.setSerialize(serialize);
 	}
 	
 	public void addProxyListener(ProxyListener listener) {
 	    proxyServer.addProxyListener(listener);
-	    proxyServerSSL.addProxyListener(listener);
 	}
 	
 	public void removeProxyListener(ProxyListener listener) {
 	    proxyServer.removeProxyListener(listener);
-	    proxyServerSSL.removeProxyListener(listener);
 	}
 
     public void addOverrideMessageProxyListener(OverrideMessageProxyListener listener) {
         proxyServer.addOverrideMessageProxyListener(listener);
-        proxyServerSSL.addOverrideMessageProxyListener(listener);
     }
 
     public void removeOverrideMessageProxyListener(OverrideMessageProxyListener listener) {
         proxyServer.removeOverrideMessageProxyListener(listener);
-        proxyServerSSL.removeOverrideMessageProxyListener(listener);
     }
 	
 	public void addPersistentConnectionListener(PersistentConnectionListener listener) {
 	    proxyServer.addPersistentConnectionListener(listener);
-	    proxyServerSSL.addPersistentConnectionListener(listener);
 	}
 
 	public void removePersistentConnectionListener(PersistentConnectionListener listener) {
 	    proxyServer.removePersistentConnectionListener(listener);
-	    proxyServerSSL.removePersistentConnectionListener(listener);
 	}
 
     /**
@@ -172,7 +155,6 @@ public class Proxy {
     public void addConnectRequestProxyListener(ConnectRequestProxyListener listener) {
         validateListenerNotNull(listener);
         proxyServer.addConnectRequestProxyListener(listener);
-        proxyServerSSL.addConnectRequestProxyListener(listener);
     }
 
     /**
@@ -197,7 +179,6 @@ public class Proxy {
     public void removeConnectRequestProxyListener(ConnectRequestProxyListener listener) {
         validateListenerNotNull(listener);
         proxyServer.removeConnectRequestProxyListener(listener);
-        proxyServerSSL.removeConnectRequestProxyListener(listener);
     }
 
     /**
@@ -232,33 +213,17 @@ public class Proxy {
         if (proxyServer != null) {
             proxyServer.setEnableCacheProcessing(enableCacheProcessing);
         }
-        
-        if (proxyServerSSL != null) {
-            proxyServerSSL.setEnableCacheProcessing(enableCacheProcessing);
-        }
-
     }
     
     public void addCacheProcessingList(CacheProcessingItem item) {
         if (proxyServer != null) {
             proxyServer.addCacheProcessingList(item);
         }
-
-        if (proxyServerSSL != null) {
-            proxyServerSSL.addCacheProcessingList(item);
-        }
-
-        
     }
 
 	public void setIgnoreList(List<String> urls) {
         if (proxyServer != null) {
             proxyServer.setExcludeList(urls);
         }
-
-        if (proxyServerSSL != null) {
-            proxyServerSSL.setExcludeList(urls);
-        }
-		
 	}
 }
diff --git a/src/org/parosproxy/paros/core/proxy/ProxyServerSSL.java b/src/org/parosproxy/paros/core/proxy/ProxyServerSSL.java
index 90de9f93c..1783123f4 100644
--- a/src/org/parosproxy/paros/core/proxy/ProxyServerSSL.java
+++ b/src/org/parosproxy/paros/core/proxy/ProxyServerSSL.java
@@ -22,6 +22,7 @@
 // ZAP: 2012/04/25 Added @Override annotation to all appropriate methods.
 // ZAP: 2013/03/03 Issue 546: Remove all template Javadoc comments
 // ZAP: 2014/01/22 Add the possibility to bound the proxy to all interfaces if null IP address has been set
+// ZAP: 2017/11/06 Marked as Deprecated
 //
 package org.parosproxy.paros.core.proxy;
 
@@ -34,6 +35,7 @@ import java.net.UnknownHostException;
 import org.parosproxy.paros.network.HttpSender;
 import org.parosproxy.paros.network.SSLConnector;
 
+@Deprecated
 public class ProxyServerSSL extends ProxyServer {
 
     private static SSLConnector ssl = HttpSender.getSSLConnector();
diff --git a/src/org/parosproxy/paros/core/proxy/ProxyThreadSSL.java b/src/org/parosproxy/paros/core/proxy/ProxyThreadSSL.java
index 9e3f656fe..d89a9ef7d 100644
--- a/src/org/parosproxy/paros/core/proxy/ProxyThreadSSL.java
+++ b/src/org/parosproxy/paros/core/proxy/ProxyThreadSSL.java
@@ -21,13 +21,15 @@
  */
 // ZAP: 2012/04/25 Added @Override annotation to the appropriate method.
 // ZAP: 2013/03/03 Issue 546: Remove all template Javadoc comments
+// ZAP: 2017/11/06 Marked as Deprecated
+
 package org.parosproxy.paros.core.proxy;
 
 import java.net.Socket;
 
 //import org.parosproxy.paros.network.HttpUtil;
 
-
+@Deprecated
 public class ProxyThreadSSL extends ProxyThread {
 	ProxyThreadSSL(ProxyServerSSL server, Socket socket) {
 		super(server, socket);
diff --git a/src/org/parosproxy/paros/extension/history/ExtensionHistory.java b/src/org/parosproxy/paros/extension/history/ExtensionHistory.java
index f1aca74be..febb8a040 100644
--- a/src/org/parosproxy/paros/extension/history/ExtensionHistory.java
+++ b/src/org/parosproxy/paros/extension/history/ExtensionHistory.java
@@ -79,6 +79,7 @@
 // ZPA: 2017/06/05 Sync HistoryReference cache.
 // ZAP: 2017/06/13 Handle notification of notes set and deprecate/remove code no longer needed.
 // ZAP: 2017/10/20 Move methods to delete history entries (Issue 3626).
+// ZAP: 2017/11/06 Added (un)registerProxy (Issue 3983)
 
 package org.parosproxy.paros.extension.history;
 
@@ -95,6 +96,7 @@ import org.apache.log4j.Logger;
 import org.parosproxy.paros.Constant;
 import org.parosproxy.paros.control.Control;
 import org.parosproxy.paros.control.Control.Mode;
+import org.parosproxy.paros.core.proxy.ProxyServer;
 import org.parosproxy.paros.core.scanner.Alert;
 import org.parosproxy.paros.db.DatabaseException;
 import org.parosproxy.paros.extension.ExtensionAdaptor;
@@ -274,6 +276,14 @@ public class ExtensionHistory extends ExtensionAdaptor implements SessionChanged
         return proxyListener;
 	}
 	
+	public void registerProxy(ProxyServer ps) {
+	    ps.addProxyListener(this.getProxyListenerLog());
+	}
+	
+    public void unregisterProxy(ProxyServer ps) {
+        ps.removeProxyListener(this.getProxyListenerLog());
+    }
+    
 	public void removeFromHistoryList(final HistoryReference href) {
         if (!View.isInitialised() || EventQueue.isDispatchThread()) {
             this.historyTableModel.removeEntry(href.getHistoryId());
diff --git a/src/org/parosproxy/paros/extension/option/ExtensionOption.java b/src/org/parosproxy/paros/extension/option/ExtensionOption.java
index ccea3b194..392849616 100644
--- a/src/org/parosproxy/paros/extension/option/ExtensionOption.java
+++ b/src/org/parosproxy/paros/extension/option/ExtensionOption.java
@@ -30,6 +30,7 @@
 // ZAP: 2016/04/05 Issue 2458: Fix xlint warning messages 
 // ZAP: 2016/06/20 Removed unnecessary/unused constructor
 // ZAP: 2017/04/07 Added getUIName()
+// ZAP: 2017/11/06 Moved options panel to new proxies extension (Issue 3983)
 
 package org.parosproxy.paros.extension.option;
 
@@ -49,7 +50,6 @@ public class ExtensionOption extends ExtensionAdaptor {
 	private JCheckBoxMenuItem menuViewImage = null;
 	private OptionsConnectionPanel optionsConnectionPanel = null;
 	private OptionsCertificatePanel optionsCertificatePanel = null;
-	private OptionsLocalProxyPanel optionsLocalProxyPanel = null;
 	private OptionsViewPanel optionsViewPanel = null;
 	private OptionsCheckForUpdatesPanel optionsCheckForUpdatesPanel = null;
 	private OptionsLangPanel optionsLangPanel = null;
@@ -80,7 +80,6 @@ public class ExtensionOption extends ExtensionAdaptor {
 	        extensionHook.getHookMenu().addViewMenuItem(getMenuViewImage());
 	        
 	        extensionHook.getHookView().addOptionPanel(getOptionsConnectionPanel());
-	        extensionHook.getHookView().addOptionPanel(getOptionsLocalProxyPanel());
 	        extensionHook.getHookView().addOptionPanel(getOptionsCertificatePanel());
 	        extensionHook.getHookView().addOptionPanel(getOptionsViewPanel());
 	        extensionHook.getHookView().addOptionPanel(getOptionsCheckForUpdatesPanel());
@@ -120,13 +119,6 @@ public class ExtensionOption extends ExtensionAdaptor {
 		return optionsCertificatePanel;
 	}
    
-	private OptionsLocalProxyPanel getOptionsLocalProxyPanel() {
-		if (optionsLocalProxyPanel == null) {
-			optionsLocalProxyPanel = new OptionsLocalProxyPanel();
-		}
-		return optionsLocalProxyPanel;
-	}
-  
 	private OptionsViewPanel getOptionsViewPanel() {
 		if (optionsViewPanel == null) {
 			optionsViewPanel = new OptionsViewPanel();
diff --git a/src/org/parosproxy/paros/extension/option/OptionsLocalProxyPanel.java b/src/org/parosproxy/paros/extension/option/OptionsLocalProxyPanel.java
deleted file mode 100644
index 5eabacfce..000000000
--- a/src/org/parosproxy/paros/extension/option/OptionsLocalProxyPanel.java
+++ /dev/null
@@ -1,606 +0,0 @@
-/*
- *
- * Paros and its related class files.
- * 
- * Paros is an HTTP/HTTPS proxy for assessing web application security.
- * Copyright (C) 2003-2004 Chinotec Technologies Company
- *
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the Clarified Artistic License
- * as published by the Free Software Foundation.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * Clarified Artistic License for more details.
- * 
- * You should have received a copy of the Clarified Artistic License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- */
-// ZAP: 2011/04/16 i18n
-// ZAP: 2012/04/14 Changed the method initParam to discard all edits.
-// ZAP: 2012/04/25 Added @Override annotation to all appropriate methods.
-// ZAP: 2012/11/04 Issue 408: Add support to encoding transformations, added an
-// option to control whether the "Accept-Encoding" request-header field is 
-// modified/removed or not.
-// ZAP: 2014/03/06 Issue 1063: Add option to decode all gzipped content
-// ZAP: 2014/03/23 Issue 968: Allow to choose the enabled SSL/TLS protocols
-// ZAP: 2015/02/10 Issue 1528: Support user defined font size
-// ZAP: 2016/06/13 Change option "Modify/Remove Accept-Encoding" to "Remove Unsupported Encodings"
-// ZAP: 2016/06/13 Internationalise string and remove unused instance variable
-// ZAP: 2017/03/26 Allow to set the Local Proxy behind NAT.
-
-package org.parosproxy.paros.extension.option;
-
-import java.awt.CardLayout;
-import java.awt.Color;
-import java.awt.GridBagConstraints;
-import java.awt.GridBagLayout;
-
-import javax.swing.JCheckBox;
-import javax.swing.JLabel;
-import javax.swing.JPanel;
-
-import org.parosproxy.paros.Constant;
-import org.parosproxy.paros.core.proxy.ProxyParam;
-import org.parosproxy.paros.model.Model;
-import org.parosproxy.paros.model.OptionsParam;
-import org.parosproxy.paros.view.AbstractParamPanel;
-import org.zaproxy.zap.utils.FontUtils;
-import org.zaproxy.zap.utils.ZapPortNumberSpinner;
-import org.zaproxy.zap.utils.ZapTextField;
-
-public class OptionsLocalProxyPanel extends AbstractParamPanel {
-
-    private static final long serialVersionUID = -1350537974139536669L;
-
-    private JPanel panelLocalProxy = null;
-    private JPanel panelReverseProxy = null;  //  @jve:decl-index=0:visual-constraint="520,10"
-
-    private JPanel panelProxy = null;  //  @jve:decl-index=0:visual-constraint="10,283"
-    private ZapTextField txtProxyIp = null;
-    private ZapTextField txtReverseProxyIp = null;
-
-    private JCheckBox chkBehindNat;
-    private JCheckBox chkRemoveUnsupportedEncodings = null;
-    private JCheckBox chkAlwaysDecodeGzip = null;
-
-    private SecurityProtocolsPanel securityProtocolsPanel;
-
-    // ZAP: Do not allow invalid port numbers
-    private ZapPortNumberSpinner spinnerProxyPort = null;
-    private ZapPortNumberSpinner spinnerReverseProxyHttpPort = null;
-    private ZapPortNumberSpinner spinnerReverseProxyHttpsPort = null;
-
-    private JLabel jLabel6 = null;
-    private JCheckBox chkReverseProxy = null;
-    private JLabel jLabel5 = null;
-    private JLabel jLabel7 = null;
-
-    public OptionsLocalProxyPanel() {
-        super();
-        initialize();
-    }
-
-    /**
-     * This method initializes panelLocalProxy
-     *
-     * @return javax.swing.JPanel
-     */
-    private JPanel getPanelLocalProxy() {
-        if (panelLocalProxy == null) {
-            jLabel6 = new JLabel();
-            GridBagConstraints gridBagConstraints15 = new GridBagConstraints();
-            java.awt.GridBagConstraints gridBagConstraints7 = new GridBagConstraints();
-            java.awt.GridBagConstraints gridBagConstraints6 = new GridBagConstraints();
-            java.awt.GridBagConstraints gridBagConstraints5 = new GridBagConstraints();
-            java.awt.GridBagConstraints gridBagConstraints4 = new GridBagConstraints();
-            javax.swing.JLabel jLabel = new JLabel();
-            javax.swing.JLabel jLabel1 = new JLabel();
-
-            panelLocalProxy = new JPanel();
-            panelLocalProxy.setLayout(new GridBagLayout());
-            panelLocalProxy.setBorder(javax.swing.BorderFactory.createTitledBorder(
-                    null, Constant.messages.getString("options.proxy.local.title"), javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION,
-                    javax.swing.border.TitledBorder.DEFAULT_POSITION, FontUtils.getFont(FontUtils.Size.standard), java.awt.Color.black));	// ZAP: i18n
-
-            jLabel.setText(Constant.messages.getString("options.proxy.local.label.address"));
-            
-            gridBagConstraints4.gridx = 0;
-            gridBagConstraints4.gridy = 0;
-            gridBagConstraints4.ipadx = 0;
-            gridBagConstraints4.ipady = 0;
-            gridBagConstraints4.anchor = java.awt.GridBagConstraints.WEST;
-            gridBagConstraints4.insets = new java.awt.Insets(2, 2, 2, 2);
-            gridBagConstraints4.weightx = 0.5D;
-            gridBagConstraints4.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            
-            gridBagConstraints5.gridx = 1;
-            gridBagConstraints5.gridy = 0;
-            gridBagConstraints5.weightx = 0.5D;
-            gridBagConstraints5.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints5.ipadx = 50;
-            gridBagConstraints5.ipady = 0;
-            gridBagConstraints5.anchor = java.awt.GridBagConstraints.EAST;
-            gridBagConstraints5.insets = new java.awt.Insets(2, 2, 2, 2);
-            
-            gridBagConstraints6.gridx = 0;
-            gridBagConstraints6.gridy = 1;
-            gridBagConstraints6.ipadx = 0;
-            gridBagConstraints6.ipady = 0;
-            gridBagConstraints6.anchor = java.awt.GridBagConstraints.WEST;
-            gridBagConstraints6.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints6.insets = new java.awt.Insets(2, 2, 2, 2);
-            gridBagConstraints6.weightx = 0.5D;
-            
-            gridBagConstraints7.gridx = 1;
-            gridBagConstraints7.gridy = 1;
-            gridBagConstraints7.weightx = 0.5D;
-            gridBagConstraints7.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints7.ipadx = 50;
-            gridBagConstraints7.ipady = 0;
-            gridBagConstraints7.anchor = java.awt.GridBagConstraints.EAST;
-            gridBagConstraints7.insets = new java.awt.Insets(2, 2, 2, 2);
-            
-            jLabel1.setText(Constant.messages.getString("options.proxy.local.label.port"));
-            jLabel6.setText(Constant.messages.getString("options.proxy.local.label.browser"));
-            
-            gridBagConstraints15.anchor = java.awt.GridBagConstraints.NORTHWEST;
-            gridBagConstraints15.gridx = 0;
-            gridBagConstraints15.gridy = 4;
-            gridBagConstraints15.insets = new java.awt.Insets(2, 2, 2, 2);
-            gridBagConstraints15.weightx = 1.0D;
-            gridBagConstraints15.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints15.gridwidth = 2;
-            
-            panelLocalProxy.add(jLabel, gridBagConstraints4);
-            panelLocalProxy.add(getTxtProxyIp(), gridBagConstraints5);
-            panelLocalProxy.add(jLabel1, gridBagConstraints6);
-            panelLocalProxy.add(getSpinnerProxyPort(), gridBagConstraints7);
-            panelLocalProxy.add(jLabel6, gridBagConstraints15);
-            
-            java.awt.GridBagConstraints gbc = new GridBagConstraints();
-            gbc.gridx = 0;
-            gbc.insets = new java.awt.Insets(2, 2, 2, 2);
-            gbc.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gbc.weightx = 1.0D;
-            gbc.gridwidth = java.awt.GridBagConstraints.REMAINDER;
-            gbc.anchor = java.awt.GridBagConstraints.PAGE_START;
-            panelLocalProxy.add(getChkBehindNat(), gbc);
-            panelLocalProxy.add(getChkRemoveUnsupportedEncodings(), gbc);
-
-            // TODO hacking
-            panelLocalProxy.add(this.getChkAlwaysDecodeGzip(), gbc);
-
-        }
-        
-        return panelLocalProxy;
-    }
-
-    /**
-     * This method initializes panelLocalProxySSL
-     *
-     * @return javax.swing.JPanel
-     */
-    private JPanel getPanelReverseProxy() {
-        if (panelReverseProxy == null) {
-            jLabel7 = new JLabel();
-            jLabel5 = new JLabel();
-            GridBagConstraints gridBagConstraints3 = new GridBagConstraints();
-            GridBagConstraints gridBagConstraints41 = new GridBagConstraints();
-            GridBagConstraints gridBagConstraints51 = new GridBagConstraints();
-            javax.swing.JLabel jLabel3 = new JLabel();
-            javax.swing.JLabel jLabel2 = new JLabel();
-
-            panelReverseProxy = new JPanel();
-            java.awt.GridBagConstraints gridBagConstraints13 = new GridBagConstraints();
-            java.awt.GridBagConstraints gridBagConstraints12 = new GridBagConstraints();
-            java.awt.GridBagConstraints gridBagConstraints11 = new GridBagConstraints();
-            java.awt.GridBagConstraints gridBagConstraints101 = new GridBagConstraints();
-
-            panelReverseProxy.setLayout(new GridBagLayout());
-            if (Model.getSingleton().getOptionsParam().getViewParam().getWmUiHandlingOption() == 0) {
-                panelReverseProxy.setSize(114, 132);
-            }
-            
-            panelReverseProxy.setName(Constant.messages.getString("options.proxy.local.label.misc"));
-            panelReverseProxy.setBorder(javax.swing.BorderFactory.createTitledBorder(null,
-                    Constant.messages.getString("options.proxy.local.label.reverse"),
-                    javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION,
-                    javax.swing.border.TitledBorder.DEFAULT_POSITION, FontUtils.getFont(FontUtils.Size.standard), java.awt.Color.black));
-            
-            gridBagConstraints101.gridx = 0;
-            gridBagConstraints101.gridy = 0;
-            gridBagConstraints101.ipadx = 0;
-            gridBagConstraints101.ipady = 0;
-            gridBagConstraints101.insets = new java.awt.Insets(2, 2, 2, 2);
-            gridBagConstraints101.weightx = 0.5D;
-            gridBagConstraints101.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints101.anchor = java.awt.GridBagConstraints.WEST;
-            
-            gridBagConstraints11.gridx = 1;
-            gridBagConstraints11.gridy = 0;
-            gridBagConstraints11.weightx = 0.5D;
-            gridBagConstraints11.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints11.ipadx = 50;
-            gridBagConstraints11.anchor = java.awt.GridBagConstraints.WEST;
-            gridBagConstraints11.insets = new java.awt.Insets(2, 2, 2, 2);
-            
-            gridBagConstraints12.gridx = 0;
-            gridBagConstraints12.gridy = 1;
-            gridBagConstraints12.ipadx = 0;
-            gridBagConstraints12.ipady = 0;
-            gridBagConstraints12.anchor = java.awt.GridBagConstraints.WEST;
-            gridBagConstraints12.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints12.insets = new java.awt.Insets(2, 2, 2, 2);
-            gridBagConstraints12.weightx = 0.5D;
-            
-            gridBagConstraints13.gridx = 1;
-            gridBagConstraints13.gridy = 1;
-            gridBagConstraints13.weightx = 0.5D;
-            gridBagConstraints13.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints13.ipadx = 50;
-            gridBagConstraints13.insets = new java.awt.Insets(2, 2, 2, 2);
-            gridBagConstraints13.anchor = java.awt.GridBagConstraints.WEST;
-            
-            jLabel2.setText(Constant.messages.getString("options.proxy.local.label.rev.address"));
-            jLabel3.setText(Constant.messages.getString("options.proxy.local.label.rev.port"));
-            
-            panelReverseProxy.add(jLabel2, gridBagConstraints101);
-            panelReverseProxy.add(getTxtReverseProxyIp(), gridBagConstraints11);
-            panelReverseProxy.add(getSpinnerReverseProxyHttpPort(), gridBagConstraints13);
-            panelReverseProxy.setVisible(true);
-            
-            jLabel5.setText("HTTPS port (eg 443)");
-            
-            gridBagConstraints3.weightx = 0.5D;
-            gridBagConstraints3.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints3.anchor = java.awt.GridBagConstraints.EAST;
-            gridBagConstraints3.gridx = 1;
-            gridBagConstraints3.gridy = 2;
-            gridBagConstraints3.insets = new java.awt.Insets(2, 2, 2, 2);
-            gridBagConstraints3.ipadx = 50;
-            
-            gridBagConstraints41.anchor = java.awt.GridBagConstraints.WEST;
-            gridBagConstraints41.gridx = 0;
-            gridBagConstraints41.gridy = 2;
-            gridBagConstraints41.insets = new java.awt.Insets(2, 2, 2, 2);
-            gridBagConstraints41.weightx = 0.5D;
-            gridBagConstraints41.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            
-            jLabel7.setText(Constant.messages.getString("options.proxy.local.label.rev.local"));
-            
-            gridBagConstraints51.gridx = 0;
-            gridBagConstraints51.gridy = 3;
-            gridBagConstraints51.insets = new java.awt.Insets(2, 2, 2, 2);
-            gridBagConstraints51.gridwidth = 2;
-            gridBagConstraints51.weightx = 1.0D;
-            gridBagConstraints51.anchor = java.awt.GridBagConstraints.WEST;
-            gridBagConstraints51.fill = java.awt.GridBagConstraints.BOTH;
-            panelReverseProxy.add(jLabel3, gridBagConstraints12);
-            panelReverseProxy.add(jLabel7, gridBagConstraints51);
-            panelReverseProxy.add(jLabel5, gridBagConstraints41);
-            panelReverseProxy.add(getSpinnerReverseProxyHttpsPort(), gridBagConstraints3);
-        }
-        return panelReverseProxy;
-    }
-
-    /**
-     * This method initializes panelProxy
-     *
-     * @return javax.swing.JPanel
-     */
-    private JPanel getPanelProxy() {
-        if (panelProxy == null) {
-            GridBagConstraints gridBagConstraints2 = new GridBagConstraints();
-            panelProxy = new JPanel();
-            java.awt.GridBagConstraints gridBagConstraints1 = new GridBagConstraints();
-            java.awt.GridBagConstraints gridBagConstraints8 = new GridBagConstraints();
-            java.awt.GridBagConstraints gridBagConstraints9 = new GridBagConstraints();
-            java.awt.GridBagConstraints gridBagConstraints10 = new GridBagConstraints();
-            javax.swing.JLabel jLabel4 = new JLabel();
-            java.awt.GridBagConstraints gridBagConstraints14 = new GridBagConstraints();
-
-            GridBagConstraints gridBagConstraints91 = new GridBagConstraints();
-            java.awt.GridBagConstraints gridBagConstraints81 = new GridBagConstraints();
-
-            panelProxy.setLayout(new GridBagLayout());
-
-            gridBagConstraints8.gridx = 0;
-            gridBagConstraints8.gridy = 0;
-            gridBagConstraints8.insets = new java.awt.Insets(2, 0, 2, 0);
-            gridBagConstraints8.anchor = java.awt.GridBagConstraints.NORTHWEST;
-            gridBagConstraints8.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints8.weightx = 1.0D;
-            
-            gridBagConstraints9.gridx = 0;
-            gridBagConstraints9.gridy = 1;
-            gridBagConstraints9.weightx = 1.0;
-            gridBagConstraints9.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints9.insets = new java.awt.Insets(2, 0, 2, 0);
-            gridBagConstraints9.anchor = java.awt.GridBagConstraints.NORTHWEST;
-            
-            gridBagConstraints10.gridx = 0;
-            gridBagConstraints10.gridy = 2;
-            gridBagConstraints10.insets = new java.awt.Insets(2, 0, 2, 0);
-            gridBagConstraints10.anchor = java.awt.GridBagConstraints.NORTHWEST;
-            gridBagConstraints10.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            
-            gridBagConstraints1.weightx = 1.0;
-            gridBagConstraints1.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            
-            panelProxy.setName(Constant.messages.getString("options.proxy.local.label.local"));
-            if (Model.getSingleton().getOptionsParam().getViewParam().getWmUiHandlingOption() == 0) {
-                panelProxy.setSize(303, 177);
-            }
-            
-            panelProxy.setFont(FontUtils.getFont(FontUtils.Size.standard));
-            
-            gridBagConstraints81.gridx = 0;
-            gridBagConstraints81.gridy = 0;
-            gridBagConstraints81.ipadx = 2;
-            gridBagConstraints81.ipady = 4;
-            gridBagConstraints81.insets = new java.awt.Insets(2, 2, 2, 2);
-            gridBagConstraints81.anchor = java.awt.GridBagConstraints.NORTHWEST;
-            gridBagConstraints81.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints81.weightx = 1.0D;
-            gridBagConstraints81.weighty = 0.0D;
-            
-            gridBagConstraints91.gridx = 0;
-            gridBagConstraints91.gridy = 3;
-            gridBagConstraints91.anchor = java.awt.GridBagConstraints.NORTHWEST;
-            gridBagConstraints91.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints91.weightx = 1.0D;
-            gridBagConstraints91.weighty = 0.0D;
-            gridBagConstraints91.ipady = 4;
-            gridBagConstraints91.ipadx = 2;
-            
-            jLabel4.setText("");
-            
-            gridBagConstraints14.fill = java.awt.GridBagConstraints.BOTH;
-            gridBagConstraints14.gridx = 0;
-            gridBagConstraints14.gridy = 3;
-            gridBagConstraints14.weightx = 1.0D;
-            gridBagConstraints14.weighty = 1.0D;
-            
-            gridBagConstraints2.gridx = 0;
-            gridBagConstraints2.gridy = 2;
-            gridBagConstraints2.anchor = java.awt.GridBagConstraints.NORTHWEST;
-            gridBagConstraints2.fill = java.awt.GridBagConstraints.HORIZONTAL;
-            gridBagConstraints2.insets = new java.awt.Insets(2, 2, 2, 2);
-            gridBagConstraints2.weightx = 1.0D;
-            
-            panelProxy.add(getPanelLocalProxy(), gridBagConstraints81);
-            gridBagConstraints81.gridy = 1;
-            panelProxy.add(securityProtocolsPanel, gridBagConstraints81);
-            panelProxy.add(getChkReverseProxy(), gridBagConstraints2);
-            panelProxy.add(getPanelReverseProxy(), gridBagConstraints91);
-            panelProxy.add(jLabel4, gridBagConstraints14);
-        }
-        return panelProxy;
-    }
-
-    /**
-     * This method initializes txtProxyIp
-     *
-     * @return org.zaproxy.zap.utils.ZapTextField
-     */
-    private ZapTextField getTxtProxyIp() {
-        if (txtProxyIp == null) {
-            txtProxyIp = new ZapTextField("");
-        }
-        return txtProxyIp;
-    }
-
-    /**
-     * This method initializes txtProxyIpSSL
-     *
-     * @return org.zaproxy.zap.utils.ZapTextField
-     */
-    private ZapTextField getTxtReverseProxyIp() {
-        if (txtReverseProxyIp == null) {
-            txtReverseProxyIp = new ZapTextField();
-        }
-        return txtReverseProxyIp;
-    }
-
-    private JCheckBox getChkBehindNat() {
-        if (chkBehindNat == null) {
-            chkBehindNat = new JCheckBox(Constant.messages.getString("options.proxy.local.label.behindnat"));
-            chkBehindNat.setToolTipText(Constant.messages.getString("options.proxy.local.tooltip.behindnat"));
-        }
-        return chkBehindNat;
-    }
-
-    public JCheckBox getChkRemoveUnsupportedEncodings() {
-        if (chkRemoveUnsupportedEncodings == null) {
-            chkRemoveUnsupportedEncodings = new JCheckBox(Constant.messages.getString("options.proxy.local.label.removeUnsupportedEncodings"));
-            chkRemoveUnsupportedEncodings.setToolTipText(Constant.messages.getString("options.proxy.local.tooltip.removeUnsupportedEncodings"));
-        }
-        return chkRemoveUnsupportedEncodings;
-    }
-    
-    private JCheckBox getChkAlwaysDecodeGzip() {
-        if (chkAlwaysDecodeGzip == null) {
-        	chkAlwaysDecodeGzip = new JCheckBox(Constant.messages.getString("options.proxy.local.label.alwaysDecodeGzip"));
-        	chkAlwaysDecodeGzip.setToolTipText(Constant.messages.getString("options.proxy.local.tooltip.alwaysDecodeGzip"));
-        }
-    	return chkAlwaysDecodeGzip;
-    }
-
-
-    /**
-     * This method initializes spinnerProxyPort
-     *
-     * @return ZapPortNumberSpinner
-     */
-    private ZapPortNumberSpinner getSpinnerProxyPort() {
-        if (spinnerProxyPort == null) {
-            // ZAP: Do not allow invalid port numbers
-            spinnerProxyPort = new ZapPortNumberSpinner(8080);
-        }
-        return spinnerProxyPort;
-    }
-
-    /**
-     * This method initializes spinnerReverseProxyHttpPort
-     *
-     * @return ZapPortNumberSpinner
-     */
-    private ZapPortNumberSpinner getSpinnerReverseProxyHttpPort() {
-        if (spinnerReverseProxyHttpPort == null) {
-            // ZAP: Do not allow invalid port numbers
-            spinnerReverseProxyHttpPort = new ZapPortNumberSpinner(80);
-        }
-        return spinnerReverseProxyHttpPort;
-    }
-
-    /**
-     * This method initializes this
-     */
-    private void initialize() {
-        this.setLayout(new CardLayout());
-        this.setName(Constant.messages.getString("options.proxy.local.title"));
-        if (Model.getSingleton().getOptionsParam().getViewParam().getWmUiHandlingOption() == 0) {
-            this.setSize(391, 320);
-        }
-        
-        securityProtocolsPanel = new SecurityProtocolsPanel();
-        this.add(getPanelProxy(), getPanelProxy().getName());
-
-        getChkReverseProxy().setVisible(Constant.isSP());
-        getPanelReverseProxy().setVisible(Constant.isSP());
-
-    }
-
-    @Override
-    public void initParam(Object obj) {
-        OptionsParam optionsParam = (OptionsParam) obj;
-        ProxyParam proxyParam = optionsParam.getProxyParam();
-
-        // set Local Proxy parameters
-        // ZAP: in the Options dialog we can show the real value of the field
-        // and null means that the listener should be bound to all interfaces
-        txtProxyIp.setText(proxyParam.getRawProxyIP());
-        txtProxyIp.discardAllEdits();
-        
-        // ZAP: Do not allow invalid port numbers
-        spinnerProxyPort.setValue(proxyParam.getProxyPort());
-
-        chkBehindNat.setSelected(proxyParam.isBehindNat());
-        chkRemoveUnsupportedEncodings.setSelected(proxyParam.isRemoveUnsupportedEncodings());
-        chkAlwaysDecodeGzip.setSelected(proxyParam.isAlwaysDecodeGzip());
-
-        // set reverse proxy param
-        txtReverseProxyIp.setText(proxyParam.getReverseProxyIp());
-        txtReverseProxyIp.discardAllEdits();
-        
-        // ZAP: Do not allow invalid port numbers
-        spinnerReverseProxyHttpPort.setValue(proxyParam.getReverseProxyHttpPort());
-        spinnerReverseProxyHttpsPort.setValue(proxyParam.getReverseProxyHttpsPort());
-
-        chkReverseProxy.setSelected(proxyParam.isUseReverseProxy());
-        setReverseProxyEnabled(proxyParam.isUseReverseProxy());
-
-        securityProtocolsPanel.setSecurityProtocolsEnabled(proxyParam.getSecurityProtocolsEnabled());
-    }
-
-    @Override
-    public void validateParam(Object obj) throws Exception {
-        securityProtocolsPanel.validateSecurityProtocols();
-    }
-
-    @Override
-    public void saveParam(Object obj) throws Exception {
-        OptionsParam optionsParam = (OptionsParam) obj;
-        ProxyParam proxyParam = optionsParam.getProxyParam();
-
-        proxyParam.setProxyIp(txtProxyIp.getText());
-        // ZAP: Do not allow invalid port numbers
-        proxyParam.setProxyPort(spinnerProxyPort.getValue());
-
-        proxyParam.setBehindNat(getChkBehindNat().isSelected());
-        proxyParam.setRemoveUnsupportedEncodings(getChkRemoveUnsupportedEncodings().isSelected());
-        // TODO hacking
-        proxyParam.setAlwaysDecodeGzip(getChkAlwaysDecodeGzip().isSelected());
-
-        proxyParam.setReverseProxyIp(txtReverseProxyIp.getText());
-        // ZAP: Do not allow invalid port numbers
-        proxyParam.setReverseProxyHttpPort(spinnerReverseProxyHttpPort.getValue());
-        proxyParam.setReverseProxyHttpsPort(spinnerReverseProxyHttpsPort.getValue());
-        proxyParam.setUseReverseProxy(getChkReverseProxy().isSelected());
-
-        proxyParam.setSecurityProtocolsEnabled(securityProtocolsPanel.getSelectedProtocols());
-    }
-
-    /**
-     * This method initializes jCheckBox
-     *
-     * @return javax.swing.JCheckBox
-     */
-    private JCheckBox getChkReverseProxy() {
-        if (chkReverseProxy == null) {
-            chkReverseProxy = new JCheckBox();
-            chkReverseProxy.setText(Constant.messages.getString("options.proxy.local.label.userev"));
-            chkReverseProxy.addActionListener(new java.awt.event.ActionListener() {
-                @Override
-                public void actionPerformed(java.awt.event.ActionEvent e) {
-                    setReverseProxyEnabled(getChkReverseProxy().isSelected());
-                }
-            });
-        }
-        return chkReverseProxy;
-    }
-
-    /**
-     * This method initializes spinnerReverseProxyHttpsPort
-     *
-     * @return ZapPortNumberSpinner
-     */
-    private ZapPortNumberSpinner getSpinnerReverseProxyHttpsPort() {
-        if (spinnerReverseProxyHttpsPort == null) {
-            // ZAP: Do not allow invalid port numbers
-            spinnerReverseProxyHttpsPort = new ZapPortNumberSpinner(443);
-        }
-        return spinnerReverseProxyHttpsPort;
-    }
-
-    private void setReverseProxyEnabled(boolean isEnabled) {
-
-        txtProxyIp.setEditable(!isEnabled);
-        spinnerProxyPort.setEditable(!isEnabled);
-
-        txtReverseProxyIp.setEditable(isEnabled);
-        spinnerReverseProxyHttpPort.setEditable(isEnabled);
-        spinnerReverseProxyHttpsPort.setEditable(isEnabled);
-
-        Color color = Color.WHITE;
-
-        if (isEnabled) {
-            txtProxyIp.setBackground(panelProxy.getBackground());
-            spinnerProxyPort.setBackground(panelProxy.getBackground());
-
-            txtReverseProxyIp.setBackground(Color.WHITE);
-            spinnerReverseProxyHttpPort.setBackground(Color.WHITE);
-            spinnerReverseProxyHttpsPort.setBackground(Color.WHITE);
-
-        } else {
-
-            txtProxyIp.setBackground(Color.WHITE);
-            spinnerProxyPort.setBackground(Color.WHITE);
-
-            txtReverseProxyIp.setBackground(panelProxy.getBackground());
-            spinnerReverseProxyHttpPort.setBackground(panelProxy.getBackground());
-            spinnerReverseProxyHttpsPort.setBackground(panelProxy.getBackground());
-
-        }
-    }
-
-    @Override
-    public String getHelpIndex() {
-        // ZAP: added help index
-        return "ui.dialogs.options.localproxy";
-    }
-
-}  //  @jve:decl-index=0:visual-constraint="10,10"
diff --git a/src/org/parosproxy/paros/extension/option/SecurityProtocolsPanel.java b/src/org/parosproxy/paros/extension/option/SecurityProtocolsPanel.java
index 96ec52a4c..af3a8b737 100644
--- a/src/org/parosproxy/paros/extension/option/SecurityProtocolsPanel.java
+++ b/src/org/parosproxy/paros/extension/option/SecurityProtocolsPanel.java
@@ -114,10 +114,12 @@ public class SecurityProtocolsPanel extends JPanel {
             checkBox.setSelected(false);
         }
 
-        for (String protocol : selectedProtocols) {
-            JCheckBox checkBox = checkBoxesSslTlsProtocols.get(protocol);
-            if (checkBox != null && checkBox.isEnabled()) {
-                checkBox.setSelected(true);
+        if (selectedProtocols != null) {
+            for (String protocol : selectedProtocols) {
+                JCheckBox checkBox = checkBoxesSslTlsProtocols.get(protocol);
+                if (checkBox != null && checkBox.isEnabled()) {
+                    checkBox.setSelected(true);
+                }
             }
         }
     }
diff --git a/src/org/zaproxy/zap/control/CoreFunctionality.java b/src/org/zaproxy/zap/control/CoreFunctionality.java
index 01349137d..0f4ce4a5a 100644
--- a/src/org/zaproxy/zap/control/CoreFunctionality.java
+++ b/src/org/zaproxy/zap/control/CoreFunctionality.java
@@ -101,6 +101,7 @@ public final class CoreFunctionality {
 			extensions.add(new org.zaproxy.zap.extension.keyboard.ExtensionKeyboard());
 			extensions.add(new org.zaproxy.zap.extension.log4j.ExtensionLog4j());
 			extensions.add(new org.zaproxy.zap.extension.params.ExtensionParams());
+			extensions.add(new org.zaproxy.zap.extension.proxies.ExtensionProxies());
 			extensions.add(new org.zaproxy.zap.extension.pscan.ExtensionPassiveScan());
 			extensions.add(new org.zaproxy.zap.extension.ruleconfig.ExtensionRuleConfig());
 			extensions.add(new org.zaproxy.zap.extension.script.ExtensionScript());
diff --git a/src/org/zaproxy/zap/extension/callback/CallbackParam.java b/src/org/zaproxy/zap/extension/callback/CallbackParam.java
index 1b6e82a64..1fb083760 100644
--- a/src/org/zaproxy/zap/extension/callback/CallbackParam.java
+++ b/src/org/zaproxy/zap/extension/callback/CallbackParam.java
@@ -19,15 +19,10 @@
  */
 package org.zaproxy.zap.extension.callback;
 
-import java.net.InetAddress;
-import java.net.NetworkInterface;
-import java.net.SocketException;
-import java.util.ArrayList;
-import java.util.Enumeration;
 import java.util.List;
 
-import org.apache.log4j.Logger;
 import org.parosproxy.paros.common.AbstractParam;
+import org.zaproxy.zap.utils.NetworkUtils;
 
 /**
  * @author psiinon
@@ -35,8 +30,6 @@ import org.parosproxy.paros.common.AbstractParam;
  */
 public class CallbackParam extends AbstractParam {
 
-    private static final Logger logger = Logger.getLogger(CallbackParam.class);
-
     private static final String PROXY_BASE_KEY = "callback";
 
     private static final String LOCAL_ADDRESS_KEY = PROXY_BASE_KEY
@@ -60,7 +53,7 @@ public class CallbackParam extends AbstractParam {
     }
 
     private String getDefaultAddress() {
-        List<String> addrs = getAvailableAddresses(false);
+        List<String> addrs = NetworkUtils.getAvailableAddresses(false);
         for (String addr : addrs) {
             if (!addr.contains(":") && !addr.equals("localhost")
                     && !addr.equals("127.0.0.1")) {
@@ -75,35 +68,6 @@ public class CallbackParam extends AbstractParam {
         return "localhost";
     }
 
-    public List<String> getAvailableAddresses(boolean remoteOnly) {
-        List<String> list = new ArrayList<String>();
-        Enumeration<NetworkInterface> e;
-        try {
-            e = NetworkInterface.getNetworkInterfaces();
-            while (e.hasMoreElements()) {
-                NetworkInterface n = e.nextElement();
-                if (n.isLoopback() || !n.isUp()) {
-                    continue;
-                }
-                Enumeration<InetAddress> ee = n.getInetAddresses();
-                while (ee.hasMoreElements()) {
-                    InetAddress i = ee.nextElement();
-                    if (remoteOnly && i.isSiteLocalAddress()) {
-                        continue;
-                    }
-                    String addr = i.getHostAddress();
-                    if (addr.indexOf('%') > 0) {
-                        addr = addr.substring(0, addr.indexOf('%'));
-                    }
-                    list.add(addr);
-                }
-            }
-        } catch (SocketException e1) {
-            logger.error(e1.getMessage(), e1);
-        }
-        return list;
-    }
-
     public String getLocalAddress() {
         return localAddress;
     }
diff --git a/src/org/zaproxy/zap/extension/callback/OptionsCallbackPanel.java b/src/org/zaproxy/zap/extension/callback/OptionsCallbackPanel.java
index 63fe9a025..74cd77d7e 100644
--- a/src/org/zaproxy/zap/extension/callback/OptionsCallbackPanel.java
+++ b/src/org/zaproxy/zap/extension/callback/OptionsCallbackPanel.java
@@ -36,6 +36,7 @@ import javax.swing.JPanel;
 import org.parosproxy.paros.Constant;
 import org.parosproxy.paros.model.OptionsParam;
 import org.parosproxy.paros.view.AbstractParamPanel;
+import org.zaproxy.zap.utils.NetworkUtils;
 import org.zaproxy.zap.utils.ZapPortNumberSpinner;
 import org.zaproxy.zap.utils.ZapTextField;
 import org.zaproxy.zap.view.LayoutHelper;
@@ -211,7 +212,7 @@ public class OptionsCallbackPanel extends AbstractParamPanel {
         CallbackParam proxyParam = optionsParam
                 .getParamSet(CallbackParam.class);
 
-        List<String> allAddrs = proxyParam.getAvailableAddresses(false);
+        List<String> allAddrs = NetworkUtils.getAvailableAddresses(false);
         localAddress.removeAllItems();
         localAddress.addItem("0.0.0.0");
         for (String addr : allAddrs) {
diff --git a/src/org/zaproxy/zap/extension/proxies/DialogAddProxy.java b/src/org/zaproxy/zap/extension/proxies/DialogAddProxy.java
new file mode 100644
index 000000000..98dff4e7f
--- /dev/null
+++ b/src/org/zaproxy/zap/extension/proxies/DialogAddProxy.java
@@ -0,0 +1,123 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2017 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License"); 
+ * you may not use this file except in compliance with the License. 
+ * You may obtain a copy of the License at 
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0 
+ *   
+ * Unless required by applicable law or agreed to in writing, software 
+ * distributed under the License is distributed on an "AS IS" BASIS, 
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
+ * See the License for the specific language governing permissions and 
+ * limitations under the License. 
+ */
+package org.zaproxy.zap.extension.proxies;
+
+import java.awt.Dialog;
+
+import javax.swing.JOptionPane;
+import javax.swing.JPanel;
+
+import org.parosproxy.paros.Constant;
+import org.zaproxy.zap.view.AbstractFormDialog;
+
+class DialogAddProxy extends AbstractFormDialog {
+
+    private static final long serialVersionUID = 4460797449668634319L;
+
+    private static final String DIALOG_TITLE = Constant.messages.getString("options.proxy.dialog.proxy.add.title");
+
+    private static final String CONFIRM_BUTTON_LABEL = Constant.messages
+            .getString("options.proxy.dialog.proxy.add.button.confirm");
+
+    protected OptionsLocalProxyPanel proxyPanel;
+
+    protected ProxiesParamProxy proxy;
+
+    private ExtensionProxies extension;
+
+    public DialogAddProxy(Dialog owner, ExtensionProxies extension) {
+        super(owner, DIALOG_TITLE);
+        this.extension = extension;
+        setConfirmButtonEnabled(true);
+    }
+
+    protected DialogAddProxy(Dialog owner, String title, ExtensionProxies extension) {
+        super(owner, title);
+        this.extension = extension;
+    }
+
+    @Override
+    protected JPanel getFieldsPanel() {
+        if (proxyPanel == null) {
+            proxyPanel = new OptionsLocalProxyPanel();
+        }
+        return proxyPanel;
+    }
+
+    @Override
+    protected String getConfirmButtonLabel() {
+        return CONFIRM_BUTTON_LABEL;
+    }
+
+    @Override
+    protected void init() {
+        proxy = null;
+        this.getFieldsPanel();  // to initialise proxyPanel
+        ProxiesParamProxy paramProxy = new ProxiesParamProxy(true);
+        proxyPanel.setProxy(paramProxy);
+    }
+
+    @Override
+    protected boolean validateFields() {
+        ProxiesParamProxy testProxy = proxyPanel.getProxy();
+
+        if (extension.getAdditionalProxy(testProxy.getAddress(), testProxy.getPort()) != null) {
+            JOptionPane.showMessageDialog(
+                    this,
+                    Constant.messages.getString("options.proxy.dialog.proxy.warning.dup.message"),
+                    Constant.messages.getString("options.proxy.dialog.proxy.warning.dup.title"),
+                    JOptionPane.ERROR_MESSAGE);
+            return false;
+        }
+
+        if (this.proxy == null
+                || !(this.proxy.getAddress().equals(testProxy.getAddress()) && this.proxy.getPort() == testProxy.getPort())) {
+            // We're adding a proxy or changing the addr:port, so check that we can listen on this combination
+            if (!extension.canListenOn(testProxy.getAddress(), testProxy.getPort())) {
+                JOptionPane.showMessageDialog(
+                        this,
+                        Constant.messages.getString("options.proxy.dialog.proxy.warning.fail.message", testProxy.getAddress(), testProxy.getPort()),
+                        Constant.messages.getString("options.proxy.dialog.proxy.warning.fail.title"),
+                        JOptionPane.ERROR_MESSAGE);
+                return false;
+            }
+        }
+
+        return true;
+    }
+
+    @Override
+    protected void performAction() {
+        proxy = proxyPanel.getProxy();
+    }
+
+    @Override
+    protected void clearFields() {
+    }
+
+    public ProxiesParamProxy getProxy() {
+        return proxy;
+    }
+
+    public void clear() {
+        this.proxy = null;
+    }
+
+}
diff --git a/src/org/zaproxy/zap/extension/proxies/DialogModifyProxy.java b/src/org/zaproxy/zap/extension/proxies/DialogModifyProxy.java
new file mode 100644
index 000000000..6a295c1ce
--- /dev/null
+++ b/src/org/zaproxy/zap/extension/proxies/DialogModifyProxy.java
@@ -0,0 +1,65 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2017 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License"); 
+ * you may not use this file except in compliance with the License. 
+ * You may obtain a copy of the License at 
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0 
+ *   
+ * Unless required by applicable law or agreed to in writing, software 
+ * distributed under the License is distributed on an "AS IS" BASIS, 
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
+ * See the License for the specific language governing permissions and 
+ * limitations under the License. 
+ */
+package org.zaproxy.zap.extension.proxies;
+
+import java.awt.Dialog;
+
+import org.parosproxy.paros.Constant;
+
+class DialogModifyProxy extends DialogAddProxy {
+
+    private static final long serialVersionUID = 6675509994290748494L;
+
+    private static final String DIALOG_TITLE = Constant.messages.getString("options.proxy.dialog.proxy.modify.title");
+
+    private static final String CONFIRM_BUTTON_LABEL = Constant.messages
+            .getString("options.proxy.dialog.proxy.modify.button.confirm");
+
+    protected DialogModifyProxy(Dialog owner, ExtensionProxies extension) {
+        super(owner, DIALOG_TITLE, extension);
+        setConfirmButtonEnabled(true);
+    }
+
+    @Override
+    protected String getConfirmButtonLabel() {
+        return CONFIRM_BUTTON_LABEL;
+    }
+
+    public void setProxy(ProxiesParamProxy paramProxy) {
+        this.proxy = paramProxy;
+        this.proxyPanel.setProxy(proxy);
+    }
+
+    @Override
+    protected boolean validateFields() {
+        ProxiesParamProxy testProxy = proxyPanel.getProxy();
+        if (testProxy.getAddress().equals(proxy.getAddress()) && testProxy.getPort() == proxy.getPort()) {
+            // No change, assume its ok
+            return true;
+        }
+        return super.validateFields();
+    }
+
+    @Override
+    protected void init() {
+        this.setProxy(proxy);
+    }
+
+}
diff --git a/src/org/zaproxy/zap/extension/proxies/ExtensionProxies.java b/src/org/zaproxy/zap/extension/proxies/ExtensionProxies.java
new file mode 100644
index 000000000..82fca80e0
--- /dev/null
+++ b/src/org/zaproxy/zap/extension/proxies/ExtensionProxies.java
@@ -0,0 +1,233 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2017 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License"); 
+ * you may not use this file except in compliance with the License. 
+ * You may obtain a copy of the License at 
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0 
+ *   
+ * Unless required by applicable law or agreed to in writing, software 
+ * distributed under the License is distributed on an "AS IS" BASIS, 
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
+ * See the License for the specific language governing permissions and 
+ * limitations under the License. 
+ */
+package org.zaproxy.zap.extension.proxies;
+
+import java.io.IOException;
+import java.net.InetAddress;
+import java.net.MalformedURLException;
+import java.net.ServerSocket;
+import java.net.URL;
+import java.util.HashMap;
+import java.util.List;
+import java.util.Map;
+import java.util.Map.Entry;
+
+import org.apache.log4j.Logger;
+import org.parosproxy.paros.Constant;
+import org.parosproxy.paros.control.Control;
+import org.parosproxy.paros.core.proxy.ProxyServer;
+import org.parosproxy.paros.extension.ExtensionAdaptor;
+import org.parosproxy.paros.extension.ExtensionHook;
+import org.parosproxy.paros.extension.OptionsChangedListener;
+import org.parosproxy.paros.extension.history.ExtensionHistory;
+import org.parosproxy.paros.model.OptionsParam;
+
+public class ExtensionProxies extends ExtensionAdaptor implements OptionsChangedListener {
+
+    public static final String NAME = "ExtensionProxies";
+    public static final String ZAP_PROXY_THREAD_PREFIX = "ZAP-";
+
+    private ProxiesParam proxiesParam = null;
+    private OptionsProxiesPanel optionsProxiesPanel = null;
+    private Map<String, ProxyServer> proxyServers = new HashMap<String, ProxyServer>();
+
+    private static Logger log = Logger.getLogger(ExtensionProxies.class);
+
+    public ExtensionProxies() {
+        super();
+        initialize();
+    }
+
+    private void initialize() {
+        this.setName(NAME);
+        this.setOrder(310);
+    }
+
+    @Override
+    public void init() {
+    }
+
+    @Override
+    public String getUIName() {
+        return Constant.messages.getString("proxies.name");
+    }
+
+    @Override
+    public void hook(ExtensionHook extensionHook) {
+        super.hook(extensionHook);
+
+        extensionHook.addOptionsParamSet(this.getParam());
+        extensionHook.addOptionsChangedListener(this);
+
+        if (getView() != null) {
+            extensionHook.getHookView().addOptionPanel(getOptionsProxiesPanel());
+        }
+
+        extensionHook.addApiImplementor(new ProxiesAPI(this));
+    }
+
+    @Override
+    public void stop() {
+        super.stop();
+        // Stop all of the running servers
+        for (Entry<String, ProxyServer> entry : proxyServers.entrySet()) {
+            stopProxyServer(entry.getValue());
+        }
+        proxyServers.clear();
+    }
+
+    @Override
+    public void start() {
+        restartProxies();
+    }
+
+    @Override
+    public void optionsChanged(OptionsParam optionsParam) {
+        restartProxies();
+    }
+
+    private void restartProxies() {
+        List<ProxiesParamProxy> proxyParams = this.getParam().getProxies();
+        Map<String, ProxyServer> currentProxies = proxyServers;
+        proxyServers = new HashMap<String, ProxyServer>();
+        for (ProxiesParamProxy proxyParam : proxyParams) {
+            if (proxyParam.isEnabled()) {
+                // Treat disabled proxies as if they dont really exist
+                String key = proxyParam.getAddress() + ":" + proxyParam.getPort();
+                ProxyServer proxy = currentProxies.remove(key);
+                if (proxy == null) {
+                    // Its a new one
+                    proxy = startProxyServer(proxyParam.getAddress(), proxyParam.getPort());
+                }
+                proxyServers.put(key, proxy);
+            }
+        }
+        // Any proxies left have been removed
+        for (Entry<String, ProxyServer> entry : currentProxies.entrySet()) {
+            stopProxyServer(entry.getValue());
+        }
+    }
+
+    private ProxyServer startProxyServer(String address, int port) {
+        // Note that if this is _not_ set then the proxy will go into a nasty loop if you point a browser at it
+        String key = address + ":" + port;
+        log.info("Starting alt proxy server: " + key);
+        ProxyServer proxyServer = new ProxyServer(ZAP_PROXY_THREAD_PREFIX + key);
+        proxyServer.setEnableApi(true);
+        if (proxyServer.startServer(address, port, false) > 0) {
+            Control.getSingleton().getExtensionLoader().getExtension(ExtensionHistory.class).registerProxy(proxyServer);
+        }
+        return proxyServer;
+    }
+
+    private void stopProxyServer(ProxyServer proxyServer) {
+        log.info(
+                "Stopping alt proxy server: " + proxyServer.getProxyParam().getProxyIp() + ":"
+                        + proxyServer.getProxyParam().getProxyPort());
+        Control.getSingleton().getExtensionLoader().getExtension(ExtensionHistory.class).unregisterProxy(proxyServer);
+        proxyServer.stopServer();
+    }
+
+    public List<ProxiesParamProxy> getAdditionalProxies() {
+        return this.getParam().getProxies();
+    }
+
+    public ProxiesParamProxy getAdditionalProxy(String address, int port) {
+        for (ProxiesParamProxy p : this.getParam().getProxies()) {
+            if (p.getAddress().equals(address) && p.getPort() == port) {
+                return new ProxiesParamProxy(p);
+            }
+        }
+        return null;
+    }
+
+    public void addProxy(ProxiesParamProxy proxy) {
+        if (this.getAdditionalProxy(proxy.getAddress(), proxy.getPort()) != null) {
+            throw new IllegalArgumentException("Proxy already exists " + proxy.getAddress() + ":" + proxy.getPort());
+        }
+        if (!this.canListenOn(proxy.getAddress(), proxy.getPort())) {
+            throw new IllegalArgumentException("Cannot listen on " + proxy.getAddress() + ":" + proxy.getPort());
+        }
+
+        ProxyServer proxyServer = startProxyServer(proxy.getAddress(), proxy.getPort());
+        proxyServers.put(proxy.getAddress() + proxy.getPort(), proxyServer);
+        this.getParam().addProxy(proxy);
+    }
+
+    public void removeProxy(String address, int port) {
+        String key = address + ":" + port;
+        ProxyServer proxyServer = proxyServers.remove(key);
+        if (proxyServer == null) {
+            throw new IllegalArgumentException("Proxy not found");
+        }
+        this.stopProxyServer(proxyServer);
+        this.getParam().removeProxy(address, port);
+    }
+
+    protected boolean canListenOn(String address, int port) {
+        ServerSocket socket = null;
+        try {
+            socket = new ServerSocket(port, 5, InetAddress.getByName(address));
+            return true;
+        } catch (IOException e) {
+            return false;
+        } finally {
+            if (socket != null) try {
+                socket.close();
+            } catch (IOException e) {
+                // Ignore
+            }
+        }
+    }
+
+    private OptionsProxiesPanel getOptionsProxiesPanel() {
+        if (optionsProxiesPanel == null) {
+            optionsProxiesPanel = new OptionsProxiesPanel(this);
+        }
+        return optionsProxiesPanel;
+    }
+
+    private ProxiesParam getParam() {
+        if (this.proxiesParam == null) {
+            this.proxiesParam = new ProxiesParam();
+        }
+        return this.proxiesParam;
+    }
+
+    @Override
+    public String getAuthor() {
+        return Constant.ZAP_TEAM;
+    }
+
+    @Override
+    public String getDescription() {
+        return Constant.messages.getString("proxies.desc");
+    }
+
+    @Override
+    public URL getURL() {
+        try {
+            return new URL(Constant.ZAP_HOMEPAGE);
+        } catch (MalformedURLException e) {
+            return null;
+        }
+    }
+
+}
diff --git a/src/org/zaproxy/zap/extension/proxies/OptionsLocalProxyPanel.java b/src/org/zaproxy/zap/extension/proxies/OptionsLocalProxyPanel.java
new file mode 100644
index 000000000..407a844f1
--- /dev/null
+++ b/src/org/zaproxy/zap/extension/proxies/OptionsLocalProxyPanel.java
@@ -0,0 +1,245 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2017 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License"); 
+ * you may not use this file except in compliance with the License. 
+ * You may obtain a copy of the License at 
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0 
+ *   
+ * Unless required by applicable law or agreed to in writing, software 
+ * distributed under the License is distributed on an "AS IS" BASIS, 
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
+ * See the License for the specific language governing permissions and 
+ * limitations under the License. 
+ */
+
+package org.zaproxy.zap.extension.proxies;
+
+import java.awt.CardLayout;
+import java.awt.GridBagConstraints;
+import java.awt.GridBagLayout;
+import java.util.List;
+
+import javax.swing.JCheckBox;
+import javax.swing.JComboBox;
+import javax.swing.JLabel;
+import javax.swing.JPanel;
+
+import org.parosproxy.paros.Constant;
+import org.parosproxy.paros.model.Model;
+import org.zaproxy.zap.utils.FontUtils;
+import org.zaproxy.zap.utils.NetworkUtils;
+import org.zaproxy.zap.utils.ZapPortNumberSpinner;
+
+public class OptionsLocalProxyPanel extends JPanel {
+
+    private static final long serialVersionUID = -1350537974139536669L;
+
+    private JComboBox<String> localAddress = null;
+    private JCheckBox chkBehindNat;
+    private JCheckBox chkRemoveUnsupportedEncodings = null;
+    private JCheckBox chkAlwaysDecodeGzip = null;
+
+    private ZapPortNumberSpinner spinnerProxyPort = null;
+
+    public OptionsLocalProxyPanel() {
+        super();
+        initialize();
+    }
+
+    private JComboBox<String> getLocalAddress() {
+        if (localAddress == null) {
+            localAddress = new JComboBox<String>();
+            localAddress.setEditable(true);
+            List<String> allAddrs = NetworkUtils.getAvailableAddresses(false);
+            localAddress.addItem("localhost");
+            localAddress.addItem("127.0.0.1");
+            localAddress.addItem("::1");
+            localAddress.addItem("0.0.0.0");
+            for (String addr : allAddrs) {
+                localAddress.addItem(addr);
+            }
+        }
+        return localAddress;
+    }
+
+    private JCheckBox getChkBehindNat() {
+        if (chkBehindNat == null) {
+            chkBehindNat = new JCheckBox(Constant.messages.getString("options.proxy.local.label.behindnat"));
+            chkBehindNat.setToolTipText(Constant.messages.getString("options.proxy.local.tooltip.behindnat"));
+        }
+        return chkBehindNat;
+    }
+
+    public JCheckBox getChkRemoveUnsupportedEncodings() {
+        if (chkRemoveUnsupportedEncodings == null) {
+            chkRemoveUnsupportedEncodings = new JCheckBox(
+                    Constant.messages.getString("options.proxy.local.label.removeUnsupportedEncodings"));
+            chkRemoveUnsupportedEncodings
+                    .setToolTipText(Constant.messages.getString("options.proxy.local.tooltip.removeUnsupportedEncodings"));
+        }
+        return chkRemoveUnsupportedEncodings;
+    }
+
+    private JCheckBox getChkAlwaysDecodeGzip() {
+        if (chkAlwaysDecodeGzip == null) {
+            chkAlwaysDecodeGzip = new JCheckBox(Constant.messages.getString("options.proxy.local.label.alwaysDecodeGzip"));
+            chkAlwaysDecodeGzip.setToolTipText(Constant.messages.getString("options.proxy.local.tooltip.alwaysDecodeGzip"));
+        }
+        return chkAlwaysDecodeGzip;
+    }
+
+    /**
+     * This method initializes spinnerProxyPort
+     *
+     * @return ZapPortNumberSpinner
+     */
+    private ZapPortNumberSpinner getSpinnerProxyPort() {
+        if (spinnerProxyPort == null) {
+            // Do not allow invalid port numbers
+            spinnerProxyPort = new ZapPortNumberSpinner(8080);
+        }
+        return spinnerProxyPort;
+    }
+
+    private void initialize() {
+        this.setLayout(new CardLayout());
+        this.setName(Constant.messages.getString("options.proxy.local.title"));
+        JPanel panelProxy =  new JPanel();
+
+        panelProxy.setLayout(new GridBagLayout());
+
+        panelProxy.setName(Constant.messages.getString("options.proxy.local.label.local"));
+        if (Model.getSingleton().getOptionsParam().getViewParam().getWmUiHandlingOption() == 0) {
+            panelProxy.setSize(303, 177);
+        }
+
+        panelProxy.setFont(FontUtils.getFont(FontUtils.Size.standard));
+
+        JPanel panelLocalProxy = null;
+
+        JLabel jLabel6 = new JLabel();
+        GridBagConstraints gridBagConstraints15 = new GridBagConstraints();
+        GridBagConstraints gridBagConstraints7 = new GridBagConstraints();
+        GridBagConstraints gridBagConstraints6 = new GridBagConstraints();
+        GridBagConstraints gridBagConstraints5 = new GridBagConstraints();
+        GridBagConstraints gridBagConstraints4 = new GridBagConstraints();
+        JLabel jLabel = new JLabel();
+        JLabel jLabel1 = new JLabel();
+
+        panelLocalProxy = new JPanel();
+        panelLocalProxy.setLayout(new GridBagLayout());
+        panelLocalProxy.setBorder(javax.swing.BorderFactory.createTitledBorder(
+                null,
+                Constant.messages.getString("options.proxy.local.title"),
+                javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION,
+                javax.swing.border.TitledBorder.DEFAULT_POSITION,
+                FontUtils.getFont(FontUtils.Size.standard),
+                java.awt.Color.black));
+
+        jLabel.setText(Constant.messages.getString("options.proxy.local.label.address"));
+
+        gridBagConstraints4.gridx = 0;
+        gridBagConstraints4.gridy = 0;
+        gridBagConstraints4.ipadx = 0;
+        gridBagConstraints4.ipady = 0;
+        gridBagConstraints4.anchor = java.awt.GridBagConstraints.WEST;
+        gridBagConstraints4.insets = new java.awt.Insets(2, 2, 2, 2);
+        gridBagConstraints4.weightx = 0.5D;
+        gridBagConstraints4.fill = java.awt.GridBagConstraints.HORIZONTAL;
+
+        gridBagConstraints5.gridx = 1;
+        gridBagConstraints5.gridy = 0;
+        gridBagConstraints5.weightx = 0.5D;
+        gridBagConstraints5.fill = java.awt.GridBagConstraints.HORIZONTAL;
+        gridBagConstraints5.ipadx = 50;
+        gridBagConstraints5.ipady = 0;
+        gridBagConstraints5.anchor = java.awt.GridBagConstraints.EAST;
+        gridBagConstraints5.insets = new java.awt.Insets(2, 2, 2, 2);
+
+        gridBagConstraints6.gridx = 0;
+        gridBagConstraints6.gridy = 1;
+        gridBagConstraints6.ipadx = 0;
+        gridBagConstraints6.ipady = 0;
+        gridBagConstraints6.anchor = java.awt.GridBagConstraints.WEST;
+        gridBagConstraints6.fill = java.awt.GridBagConstraints.HORIZONTAL;
+        gridBagConstraints6.insets = new java.awt.Insets(2, 2, 2, 2);
+        gridBagConstraints6.weightx = 0.5D;
+
+        gridBagConstraints7.gridx = 1;
+        gridBagConstraints7.gridy = 1;
+        gridBagConstraints7.weightx = 0.5D;
+        gridBagConstraints7.fill = java.awt.GridBagConstraints.HORIZONTAL;
+        gridBagConstraints7.ipadx = 50;
+        gridBagConstraints7.ipady = 0;
+        gridBagConstraints7.anchor = java.awt.GridBagConstraints.EAST;
+        gridBagConstraints7.insets = new java.awt.Insets(2, 2, 2, 2);
+
+        jLabel1.setText(Constant.messages.getString("options.proxy.local.label.port"));
+        jLabel6.setText(Constant.messages.getString("options.proxy.local.label.browser"));
+
+        gridBagConstraints15.anchor = java.awt.GridBagConstraints.NORTHWEST;
+        gridBagConstraints15.gridx = 0;
+        gridBagConstraints15.gridy = 4;
+        gridBagConstraints15.insets = new java.awt.Insets(2, 2, 2, 2);
+        gridBagConstraints15.weightx = 1.0D;
+        gridBagConstraints15.fill = java.awt.GridBagConstraints.HORIZONTAL;
+        gridBagConstraints15.gridwidth = 2;
+
+        panelLocalProxy.add(jLabel, gridBagConstraints4);
+        panelLocalProxy.add(getLocalAddress(), gridBagConstraints5);
+        panelLocalProxy.add(jLabel1, gridBagConstraints6);
+        panelLocalProxy.add(getSpinnerProxyPort(), gridBagConstraints7);
+        panelLocalProxy.add(jLabel6, gridBagConstraints15);
+
+        java.awt.GridBagConstraints gbc = new GridBagConstraints();
+        gbc.gridx = 0;
+        gbc.insets = new java.awt.Insets(2, 2, 2, 2);
+        gbc.fill = java.awt.GridBagConstraints.HORIZONTAL;
+        gbc.weightx = 1.0D;
+        gbc.gridwidth = java.awt.GridBagConstraints.REMAINDER;
+        gbc.anchor = java.awt.GridBagConstraints.PAGE_START;
+        panelLocalProxy.add(getChkBehindNat(), gbc);
+        panelLocalProxy.add(getChkRemoveUnsupportedEncodings(), gbc);
+        panelLocalProxy.add(this.getChkAlwaysDecodeGzip(), gbc);
+
+        GridBagConstraints gridBagConstraints81 = new GridBagConstraints();
+        gridBagConstraints81.gridx = 0;
+        gridBagConstraints81.gridy = 0;
+        gridBagConstraints81.ipadx = 2;
+        gridBagConstraints81.ipady = 4;
+        gridBagConstraints81.insets = new java.awt.Insets(2, 2, 2, 2);
+        gridBagConstraints81.anchor = java.awt.GridBagConstraints.NORTHWEST;
+        gridBagConstraints81.fill = java.awt.GridBagConstraints.HORIZONTAL;
+        gridBagConstraints81.weightx = 1.0D;
+        gridBagConstraints81.weighty = 0.0D;
+
+        panelProxy.add(panelLocalProxy, gridBagConstraints81);
+
+        this.add(panelProxy, panelProxy.getName());
+    }
+
+    public void setProxy(ProxiesParamProxy proxy) {
+        getLocalAddress().setSelectedItem(proxy.getAddress());
+        this.getSpinnerProxyPort().setValue(proxy.getPort());
+        this.getChkBehindNat().setSelected(proxy.isBehindNat());
+        this.getChkAlwaysDecodeGzip().setSelected(proxy.isAlwaysDecodeGzip());
+        this.getChkRemoveUnsupportedEncodings().setSelected(proxy.isRemoveUnsupportedEncodings());
+    }
+
+    public ProxiesParamProxy getProxy() {
+        ProxiesParamProxy proxy = new ProxiesParamProxy(
+                (String) getLocalAddress().getSelectedItem(),
+                getSpinnerProxyPort().getValue(),
+                true);
+        proxy.setBehindNat(getChkBehindNat().isSelected());
+        proxy.setAlwaysDecodeGzip(getChkAlwaysDecodeGzip().isSelected());
+        proxy.setRemoveUnsupportedEncodings(getChkRemoveUnsupportedEncodings().isSelected());
+        return proxy;
+    }
+}
diff --git a/src/org/zaproxy/zap/extension/proxies/OptionsProxiesPanel.java b/src/org/zaproxy/zap/extension/proxies/OptionsProxiesPanel.java
new file mode 100644
index 000000000..4a6442f00
--- /dev/null
+++ b/src/org/zaproxy/zap/extension/proxies/OptionsProxiesPanel.java
@@ -0,0 +1,227 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2017 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License"); 
+ * you may not use this file except in compliance with the License. 
+ * You may obtain a copy of the License at 
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0 
+ *   
+ * Unless required by applicable law or agreed to in writing, software 
+ * distributed under the License is distributed on an "AS IS" BASIS, 
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
+ * See the License for the specific language governing permissions and 
+ * limitations under the License. 
+ */
+package org.zaproxy.zap.extension.proxies;
+
+import java.awt.GridBagLayout;
+import java.util.List;
+
+import javax.swing.JCheckBox;
+import javax.swing.JOptionPane;
+import javax.swing.SortOrder;
+
+import org.parosproxy.paros.Constant;
+import org.parosproxy.paros.extension.option.SecurityProtocolsPanel;
+import org.parosproxy.paros.model.OptionsParam;
+import org.parosproxy.paros.view.AbstractParamPanel;
+import org.parosproxy.paros.view.View;
+import org.zaproxy.zap.utils.FontUtils;
+import org.zaproxy.zap.view.AbstractMultipleOptionsTablePanel;
+import org.zaproxy.zap.view.LayoutHelper;
+
+public class OptionsProxiesPanel extends AbstractParamPanel {
+
+    private static final long serialVersionUID = 1L;
+
+    private ProxiesMultipleOptionsPanel proxiesOptionsPanel;
+
+    private OptionsLocalProxyPanel mainProxyPanel;
+    private SecurityProtocolsPanel securityProtocolsPanel;
+    private OptionsProxiesTableModel proxiesModel;
+    private String currentAddress;
+    private int currentPort;
+
+    private ExtensionProxies extension;
+
+    public OptionsProxiesPanel(ExtensionProxies extension) {
+        super();
+        this.extension = extension;
+        initialize();
+    }
+
+    private void initialize() {
+        this.setName(Constant.messages.getString("proxies.options.title"));
+        this.setLayout(new GridBagLayout());
+        this.add(getMainProxyPanel(), LayoutHelper.getGBC(0, 0, 1, 0.0));
+        this.add(getSecurityProtocolsPanel(), LayoutHelper.getGBC(0, 1, 1, 0.0));
+        this.add(getProxiesOptionsPanel(), LayoutHelper.getGBC(0, 2, 1, 1.0, 1.0));
+    }
+
+    @Override
+    public void initParam(Object obj) {
+        OptionsParam optionsParam = (OptionsParam) obj;
+        ProxiesParam param = optionsParam.getParamSet(ProxiesParam.class);
+        getMainProxyPanel().setProxy(param.getMainProxy());
+        getSecurityProtocolsPanel().setSecurityProtocolsEnabled(param.getSecurityProtocolsEnabled());
+        getProxiesModel().setProxies(param.getProxies());
+        getProxiesOptionsPanel().setRemoveWithoutConfirmation(!param.isConfirmRemoveProxy());
+        this.currentAddress = param.getMainProxy().getAddress();
+        this.currentPort = param.getMainProxy().getPort();
+    }
+
+    @Override
+    public void validateParam(Object obj) throws Exception {
+        getSecurityProtocolsPanel().validateSecurityProtocols();
+        ProxiesParamProxy mainProxy = getMainProxyPanel().getProxy();
+        String newAddress = mainProxy.getAddress();
+        int newPort = mainProxy.getPort();
+
+        if (!this.currentAddress.equals(newAddress) || this.currentPort != newPort) {
+            // Only check if they've changed, otherwise we'll still be listening on them
+            if (!extension.canListenOn(newAddress, newPort) || extension.getAdditionalProxy(newAddress, newPort) != null) {
+                throw new Exception(
+                        Constant.messages.getString("options.proxy.dialog.proxy.warning.fail.message", newAddress, newPort));
+            }
+        }
+    }
+
+    @Override
+    public void saveParam(Object obj) throws Exception {
+        OptionsParam optionsParam = (OptionsParam) obj;
+        ProxiesParam param = optionsParam.getParamSet(ProxiesParam.class);
+
+        List<ProxiesParamProxy> proxies = getProxiesModel().getElements();
+        param.setMainProxy(getMainProxyPanel().getProxy());
+        param.setSecurityProtocolsEnabled(getSecurityProtocolsPanel().getSelectedProtocols());
+        param.setProxies(proxies);
+        param.setConfirmRemoveProxy(!getProxiesOptionsPanel().isRemoveWithoutConfirmation());
+    }
+
+    private ProxiesMultipleOptionsPanel getProxiesOptionsPanel() {
+        if (proxiesOptionsPanel == null) {
+            proxiesOptionsPanel = new ProxiesMultipleOptionsPanel(getProxiesModel(), extension);
+            proxiesOptionsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(
+                    null,
+                    Constant.messages.getString("options.proxy.additional.title"),
+                    javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION,
+                    javax.swing.border.TitledBorder.DEFAULT_POSITION,
+                    FontUtils.getFont(FontUtils.Size.standard),
+                    java.awt.Color.black));
+
+        }
+        return proxiesOptionsPanel;
+    }
+
+    private OptionsLocalProxyPanel getMainProxyPanel() {
+        if (mainProxyPanel == null) {
+            mainProxyPanel = new OptionsLocalProxyPanel();
+        }
+        return mainProxyPanel;
+    }
+
+    private SecurityProtocolsPanel getSecurityProtocolsPanel() {
+        if (securityProtocolsPanel == null) {
+            securityProtocolsPanel = new SecurityProtocolsPanel();
+        }
+        return securityProtocolsPanel;
+    }
+
+    private OptionsProxiesTableModel getProxiesModel() {
+        if (proxiesModel == null) {
+            proxiesModel = new OptionsProxiesTableModel();
+        }
+        return proxiesModel;
+    }
+
+    @Override
+    public String getHelpIndex() {
+        return "ui.dialogs.options.localproxy";
+    }
+
+    private static class ProxiesMultipleOptionsPanel extends AbstractMultipleOptionsTablePanel<ProxiesParamProxy> {
+
+        private static final long serialVersionUID = -115340627058929308L;
+
+        private static final String REMOVE_DIALOG_TITLE = Constant.messages
+                .getString("options.proxy.dialog.proxy.remove.title");
+        private static final String REMOVE_DIALOG_TEXT = Constant.messages.getString("options.proxy.dialog.proxy.remove.text");
+
+        private static final String REMOVE_DIALOG_CONFIRM_BUTTON_LABEL = Constant.messages
+                .getString("options.proxy.dialog.proxy.remove.button.confirm");
+        private static final String REMOVE_DIALOG_CANCEL_BUTTON_LABEL = Constant.messages
+                .getString("options.proxy.dialog.proxy.remove.button.cancel");
+
+        private static final String REMOVE_DIALOG_CHECKBOX_LABEL = Constant.messages
+                .getString("options.proxy.dialog.proxy.remove.checkbox.label");
+
+        private DialogAddProxy addDialog = null;
+        private DialogModifyProxy modifyDialog = null;
+
+        private ExtensionProxies extension;
+
+        public ProxiesMultipleOptionsPanel(OptionsProxiesTableModel model, ExtensionProxies extension) {
+            super(model);
+
+            this.extension = extension;
+
+            getTable().getColumnExt(0).setPreferredWidth(20);
+            getTable().setSortOrder(1, SortOrder.ASCENDING);
+        }
+
+        @Override
+        public ProxiesParamProxy showAddDialogue() {
+            if (addDialog == null) {
+                addDialog = new DialogAddProxy(View.getSingleton().getOptionsDialog(null), extension);
+                addDialog.pack();
+            }
+            addDialog.setVisible(true);
+            ProxiesParamProxy proxy = addDialog.getProxy();
+            addDialog.clear();
+
+            return proxy;
+        }
+
+        @Override
+        public ProxiesParamProxy showModifyDialogue(ProxiesParamProxy e) {
+            if (modifyDialog == null) {
+                modifyDialog = new DialogModifyProxy(View.getSingleton().getOptionsDialog(null), extension);
+                modifyDialog.pack();
+            }
+            modifyDialog.setProxy(e);
+            modifyDialog.setVisible(true);
+
+            ProxiesParamProxy proxy = modifyDialog.getProxy();
+            modifyDialog.clear();
+            return proxy;
+        }
+
+        @Override
+        public boolean showRemoveDialogue(ProxiesParamProxy e) {
+            JCheckBox removeWithoutConfirmationCheckBox = new JCheckBox(REMOVE_DIALOG_CHECKBOX_LABEL);
+            Object[] messages = { REMOVE_DIALOG_TEXT, " ", removeWithoutConfirmationCheckBox };
+            int option = JOptionPane.showOptionDialog(
+                    View.getSingleton().getMainFrame(),
+                    messages,
+                    REMOVE_DIALOG_TITLE,
+                    JOptionPane.OK_CANCEL_OPTION,
+                    JOptionPane.QUESTION_MESSAGE,
+                    null,
+                    new String[] { REMOVE_DIALOG_CONFIRM_BUTTON_LABEL, REMOVE_DIALOG_CANCEL_BUTTON_LABEL },
+                    null);
+
+            if (option == JOptionPane.OK_OPTION) {
+                setRemoveWithoutConfirmation(removeWithoutConfirmationCheckBox.isSelected());
+
+                return true;
+            }
+
+            return false;
+        }
+    }
+}
diff --git a/src/org/zaproxy/zap/extension/proxies/OptionsProxiesTableModel.java b/src/org/zaproxy/zap/extension/proxies/OptionsProxiesTableModel.java
new file mode 100644
index 000000000..74bdccbbe
--- /dev/null
+++ b/src/org/zaproxy/zap/extension/proxies/OptionsProxiesTableModel.java
@@ -0,0 +1,113 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2017 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License"); 
+ * you may not use this file except in compliance with the License. 
+ * You may obtain a copy of the License at 
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0 
+ *   
+ * Unless required by applicable law or agreed to in writing, software 
+ * distributed under the License is distributed on an "AS IS" BASIS, 
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
+ * See the License for the specific language governing permissions and 
+ * limitations under the License. 
+ */
+
+package org.zaproxy.zap.extension.proxies;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import org.parosproxy.paros.Constant;
+import org.zaproxy.zap.view.AbstractMultipleOptionsTableModel;
+
+public class OptionsProxiesTableModel extends AbstractMultipleOptionsTableModel<ProxiesParamProxy> {
+
+	private static final long serialVersionUID = 1L;
+
+    private static final String[] COLUMN_NAMES = {
+            Constant.messages.getString("proxies.options.table.header.enabled"),
+            Constant.messages.getString("proxies.options.table.header.address"),
+            Constant.messages.getString("proxies.options.table.header.port")};
+    
+	private static final int COLUMN_COUNT = COLUMN_NAMES.length;
+	
+    private List<ProxiesParamProxy> proxies = new ArrayList<>(0);
+    
+    public OptionsProxiesTableModel() {
+        super();
+    }
+    
+    @Override
+    public List<ProxiesParamProxy> getElements() {
+        return proxies;
+    }
+
+    public void setProxies(List<ProxiesParamProxy> proxies) {
+		this.proxies = new ArrayList<>(proxies.size());
+		
+		for (ProxiesParamProxy proxy : proxies) {
+			this.proxies.add(new ProxiesParamProxy(proxy));
+		}
+    	
+  	  	fireTableDataChanged();
+    }
+    
+    @Override
+    public String getColumnName(int col) {
+        return COLUMN_NAMES[col];
+    }
+
+    @Override
+    public int getColumnCount() {
+        return COLUMN_COUNT;
+    }
+    
+    @Override
+	public Class<?> getColumnClass(int c) {
+        if (c == 0) {
+            return Boolean.class;
+        }
+        return String.class;
+    }
+
+    @Override
+    public int getRowCount() {
+        return proxies.size();
+    }
+
+    @Override
+    public boolean isCellEditable(int rowIndex, int columnIndex) {
+        return (columnIndex == 0);
+    }
+    
+    @Override
+    public Object getValueAt(int rowIndex, int columnIndex) {
+        switch(columnIndex) {
+        case 0:
+            return Boolean.valueOf(getElement(rowIndex).isEnabled());
+        case 1:
+            return getElement(rowIndex).getAddress();
+        case 2:
+            // Return a String as the commas used for integers dont look right in the table
+            return Integer.toString(getElement(rowIndex).getPort());
+        }
+        return null;
+    }
+
+    @Override
+    public void setValueAt(Object aValue, int rowIndex, int columnIndex) {
+        if (columnIndex == 0) {
+            if (aValue instanceof Boolean) {
+                proxies.get(rowIndex).setEnabled(((Boolean) aValue).booleanValue());
+                fireTableCellUpdated(rowIndex, columnIndex);
+            }
+        }
+    }
+    
+}
diff --git a/src/org/zaproxy/zap/extension/proxies/ProxiesAPI.java b/src/org/zaproxy/zap/extension/proxies/ProxiesAPI.java
new file mode 100644
index 000000000..054d274f6
--- /dev/null
+++ b/src/org/zaproxy/zap/extension/proxies/ProxiesAPI.java
@@ -0,0 +1,117 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2017 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License"); 
+ * you may not use this file except in compliance with the License. 
+ * You may obtain a copy of the License at 
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0 
+ *   
+ * Unless required by applicable law or agreed to in writing, software 
+ * distributed under the License is distributed on an "AS IS" BASIS, 
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
+ * See the License for the specific language governing permissions and 
+ * limitations under the License. 
+ */
+package org.zaproxy.zap.extension.proxies;
+
+import java.util.HashMap;
+import java.util.Map;
+
+import org.zaproxy.zap.extension.api.ApiAction;
+import org.zaproxy.zap.extension.api.ApiException;
+import org.zaproxy.zap.extension.api.ApiImplementor;
+import org.zaproxy.zap.extension.api.ApiResponse;
+import org.zaproxy.zap.extension.api.ApiResponseElement;
+import org.zaproxy.zap.extension.api.ApiResponseList;
+import org.zaproxy.zap.extension.api.ApiResponseSet;
+import org.zaproxy.zap.extension.api.ApiView;
+
+import net.sf.json.JSONObject;
+
+public class ProxiesAPI extends ApiImplementor {
+
+    private static final String PREFIX = "localProxies";
+
+    private static final String VIEW_ADDITIONAL_PROXIES = "additionalProxies";
+    private static final String ACTION_ADD_PROXY = "addAdditionalProxy";
+    private static final String ACTION_REMOVE_PROXY = "removeAdditionalProxy";
+    private static final String PARAM_ADDRESS = "address";
+    private static final String PARAM_PORT = "port";
+    private static final String PARAM_BEHIND_NAT = "behindNat";
+    private static final String PARAM_DECODE_ZIP = "alwaysDecodeZip";
+    private static final String PARAM_REM_UNSUPPORTED_ENC = "removeUnsupportedEncodings";
+
+    private ExtensionProxies extension = null;
+
+    public ProxiesAPI(ExtensionProxies ext) {
+        this.extension = ext;
+        this.addApiView(new ApiView(VIEW_ADDITIONAL_PROXIES));
+        this.addApiAction(
+                new ApiAction(
+                        ACTION_ADD_PROXY,
+                        new String[] { PARAM_ADDRESS, PARAM_PORT },
+                        new String[] { PARAM_BEHIND_NAT, PARAM_DECODE_ZIP, PARAM_REM_UNSUPPORTED_ENC }));
+        this.addApiAction(new ApiAction(ACTION_REMOVE_PROXY, new String[] { PARAM_ADDRESS, PARAM_PORT }));
+    }
+
+    @Override
+    public String getPrefix() {
+        return PREFIX;
+    }
+
+    @Override
+    public ApiResponse handleApiView(String name, JSONObject params) throws ApiException {
+        if (VIEW_ADDITIONAL_PROXIES.equals(name)) {
+            ApiResponseList response = new ApiResponseList(name);
+
+            for (ProxiesParamProxy p : (this.extension.getAdditionalProxies())) {
+                Map<String, String> map = new HashMap<String, String>();
+                map.put("address", p.getAddress());
+                map.put("port", Integer.toString(p.getPort()));
+                map.put("enabled", Boolean.toString(p.isEnabled()));
+                map.put("behindNat", Boolean.toString(p.isBehindNat()));
+                map.put("alwaysDecodeZip", Boolean.toString(p.isAlwaysDecodeGzip()));
+                map.put("removeUnsupportedEncodings", Boolean.toString(p.isRemoveUnsupportedEncodings()));
+                response.addItem(new ApiResponseSet<String>("proxy", map));
+            }
+
+            return response;
+        } else {
+            throw new ApiException(ApiException.Type.BAD_VIEW, name);
+        }
+    }
+
+    @Override
+    public ApiResponse handleApiAction(String name, JSONObject params) throws ApiException {
+        if (ACTION_ADD_PROXY.equals(name)) {
+            try {
+                extension.addProxy(
+                        new ProxiesParamProxy(
+                                params.getString(PARAM_ADDRESS),
+                                params.getInt(PARAM_PORT),
+                                true,
+                                false,
+                                this.getParam(params, PARAM_REM_UNSUPPORTED_ENC, false),
+                                this.getParam(params, PARAM_DECODE_ZIP, false),
+                                this.getParam(params, PARAM_BEHIND_NAT, false)));
+                return ApiResponseElement.OK;
+            } catch (Exception e) {
+                throw new ApiException(ApiException.Type.ILLEGAL_PARAMETER, e.getMessage());
+            }
+        } else if (ACTION_REMOVE_PROXY.equals(name)) {
+            try {
+                extension.removeProxy(params.getString(PARAM_ADDRESS), params.getInt(PARAM_PORT));
+                return ApiResponseElement.OK;
+            } catch (Exception e) {
+                throw new ApiException(ApiException.Type.ILLEGAL_PARAMETER, e.getMessage());
+            }
+        } else {
+            throw new ApiException(ApiException.Type.BAD_VIEW, name);
+        }
+    }
+}
diff --git a/src/org/zaproxy/zap/extension/proxies/ProxiesParam.java b/src/org/zaproxy/zap/extension/proxies/ProxiesParam.java
new file mode 100644
index 000000000..a39a8c5c6
--- /dev/null
+++ b/src/org/zaproxy/zap/extension/proxies/ProxiesParam.java
@@ -0,0 +1,168 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2017 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License"); 
+ * you may not use this file except in compliance with the License. 
+ * You may obtain a copy of the License at 
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0 
+ *   
+ * Unless required by applicable law or agreed to in writing, software 
+ * distributed under the License is distributed on an "AS IS" BASIS, 
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
+ * See the License for the specific language governing permissions and 
+ * limitations under the License. 
+ */
+package org.zaproxy.zap.extension.proxies;
+
+import java.util.ArrayList;
+import java.util.Iterator;
+import java.util.List;
+
+import org.apache.commons.configuration.ConversionException;
+import org.apache.commons.configuration.HierarchicalConfiguration;
+import org.apache.log4j.Logger;
+import org.parosproxy.paros.common.AbstractParam;
+import org.parosproxy.paros.core.proxy.ProxyParam;
+import org.parosproxy.paros.model.Model;
+
+public class ProxiesParam extends AbstractParam {
+
+    private static final Logger logger = Logger.getLogger(ProxiesParam.class);
+
+    private static final String PROXIES_BASE_KEY = "proxies";
+
+    private static final String ALL_PROXIES_KEY = PROXIES_BASE_KEY + ".all";
+
+    private static final String PROXY_ADDRESS_KEY = "address";
+    private static final String PROXY_ENABLED_KEY = "enabled";
+    private static final String PROXY_PORT_KEY = "port";
+    private static final String PROXY_ANY_LOCAL_KEY = "anylocal";
+    private static final String PROXY_REM_UNSUPPORTED = "remunsupported";
+    private static final String PROXY_DECODE_KEY = "decode";
+    private static final String PROXY_BEHIND_NAT_KEY = "behindnat";
+
+    private static final String CONFIRM_REMOVE_PROXY_KEY = PROXIES_BASE_KEY + ".confirmRemoveProxy";
+
+    private List<ProxiesParamProxy> proxies = null;
+    private boolean confirmRemoveProxy = true;
+
+    public ProxiesParam() {
+    }
+
+    @Override
+    protected void parse() {
+        try {
+            List<HierarchicalConfiguration> fields = ((HierarchicalConfiguration) getConfig())
+                    .configurationsAt(ALL_PROXIES_KEY);
+            this.proxies = new ArrayList<>(fields.size() + 1);
+
+            for (HierarchicalConfiguration sub : fields) {
+                this.proxies.add(
+                        new ProxiesParamProxy(
+                                sub.getString(PROXY_ADDRESS_KEY),
+                                sub.getInt(PROXY_PORT_KEY),
+                                sub.getBoolean(PROXY_ENABLED_KEY, true),
+                                sub.getBoolean(PROXY_ANY_LOCAL_KEY),
+                                sub.getBoolean(PROXY_REM_UNSUPPORTED),
+                                sub.getBoolean(PROXY_DECODE_KEY),
+                                sub.getBoolean(PROXY_BEHIND_NAT_KEY)));
+            }
+        } catch (ConversionException e) {
+            logger.error("Error while loading proxies: " + e.getMessage(), e);
+        }
+
+        this.confirmRemoveProxy = getBoolean(CONFIRM_REMOVE_PROXY_KEY, true);
+    }
+
+    public ProxiesParamProxy getMainProxy() {
+        ProxyParam mainProxyParam = Model.getSingleton().getOptionsParam().getProxyParam();
+        ProxiesParamProxy mainProxy = new ProxiesParamProxy(mainProxyParam.getProxyIp(), mainProxyParam.getProxyPort(), true);
+        mainProxy.setAlwaysDecodeGzip(mainProxyParam.isAlwaysDecodeGzip());
+        mainProxy.setBehindNat(mainProxyParam.isBehindNat());
+        mainProxy.setProxyIpAnyLocalAddress(mainProxyParam.isProxyIpAnyLocalAddress());
+        mainProxy.setRemoveUnsupportedEncodings(mainProxyParam.isRemoveUnsupportedEncodings());
+        return mainProxy;
+    }
+
+    public String[] getSecurityProtocolsEnabled() {
+        return Model.getSingleton().getOptionsParam().getProxyParam().getSecurityProtocolsEnabled();
+    }
+
+    public void setSecurityProtocolsEnabled(String[] protocols) {
+        Model.getSingleton().getOptionsParam().getProxyParam().setSecurityProtocolsEnabled(protocols);
+    }
+
+    public List<ProxiesParamProxy> getProxies() {
+        List<ProxiesParamProxy> list = new ArrayList<ProxiesParamProxy>(proxies.size() + 1);
+        for (ProxiesParamProxy proxy : this.proxies) {
+            list.add(new ProxiesParamProxy(proxy));
+        }
+        return list;
+    }
+
+    public void setMainProxy(ProxiesParamProxy proxy) {
+        ProxyParam proxyParam = Model.getSingleton().getOptionsParam().getProxyParam();
+        proxyParam.setProxyIp(proxy.getAddress());
+        proxyParam.setProxyPort(proxy.getPort());
+        proxyParam.setAlwaysDecodeGzip(proxy.isAlwaysDecodeGzip());
+        proxyParam.setBehindNat(proxy.isBehindNat());
+        proxyParam.setRemoveUnsupportedEncodings(proxy.isRemoveUnsupportedEncodings());
+    }
+
+    public void setProxies(List<ProxiesParamProxy> proxies) {
+        this.proxies = new ArrayList<>(proxies);
+
+        ((HierarchicalConfiguration) getConfig()).clearTree(ALL_PROXIES_KEY);
+
+        for (int i = 0, size = proxies.size(); i < size; ++i) {
+            String elementBaseKey = ALL_PROXIES_KEY + "(" + i + ").";
+            ProxiesParamProxy proxy = proxies.get(i);
+
+            getConfig().setProperty(elementBaseKey + PROXY_ADDRESS_KEY, proxy.getAddress());
+            getConfig().setProperty(elementBaseKey + PROXY_PORT_KEY, proxy.getPort());
+            getConfig().setProperty(elementBaseKey + PROXY_ENABLED_KEY, Boolean.valueOf(proxy.isEnabled()));
+            getConfig().setProperty(elementBaseKey + PROXY_ANY_LOCAL_KEY, Boolean.valueOf(proxy.isProxyIpAnyLocalAddress()));
+            getConfig()
+                    .setProperty(elementBaseKey + PROXY_REM_UNSUPPORTED, Boolean.valueOf(proxy.isRemoveUnsupportedEncodings()));
+            getConfig().setProperty(elementBaseKey + PROXY_DECODE_KEY, Boolean.valueOf(proxy.isAlwaysDecodeGzip()));
+            getConfig().setProperty(elementBaseKey + PROXY_BEHIND_NAT_KEY, Boolean.valueOf(proxy.isBehindNat()));
+        }
+    }
+
+    public void addProxy(ProxiesParamProxy proxy) {
+        this.proxies.add(proxy);
+        // Save the configs
+        setProxies(this.proxies);
+    }
+
+    public void removeProxy(String address, int port) {
+        if (address == null || address.isEmpty()) {
+            return;
+        }
+
+        for (Iterator<ProxiesParamProxy> it = proxies.iterator(); it.hasNext();) {
+            ProxiesParamProxy proxy = it.next();
+            if (address.equals(proxy.getAddress()) && proxy.getPort() == port) {
+                it.remove();
+                break;
+            }
+        }
+        // Save the configs
+        setProxies(this.proxies);
+    }
+
+    public boolean isConfirmRemoveProxy() {
+        return this.confirmRemoveProxy;
+    }
+
+    public void setConfirmRemoveProxy(boolean confirmRemove) {
+        this.confirmRemoveProxy = confirmRemove;
+        getConfig().setProperty(CONFIRM_REMOVE_PROXY_KEY, Boolean.valueOf(confirmRemoveProxy));
+    }
+
+}
diff --git a/src/org/zaproxy/zap/extension/proxies/ProxiesParamProxy.java b/src/org/zaproxy/zap/extension/proxies/ProxiesParamProxy.java
new file mode 100644
index 000000000..6610b25a0
--- /dev/null
+++ b/src/org/zaproxy/zap/extension/proxies/ProxiesParamProxy.java
@@ -0,0 +1,139 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2017 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License"); 
+ * you may not use this file except in compliance with the License. 
+ * You may obtain a copy of the License at 
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0 
+ *   
+ * Unless required by applicable law or agreed to in writing, software 
+ * distributed under the License is distributed on an "AS IS" BASIS, 
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
+ * See the License for the specific language governing permissions and 
+ * limitations under the License. 
+ */
+package org.zaproxy.zap.extension.proxies;
+
+import org.zaproxy.zap.utils.Enableable;
+
+class ProxiesParamProxy extends Enableable {
+
+    private String address = "localhost";
+    private int port = 8080;
+
+    /**
+     * Flag that indicates if the proxy ip is any local address.
+     */
+    private boolean proxyIpAnyLocalAddress;
+
+    /**
+     * Flag that controls whether or not the local proxy should remove unsupported encodings from the "Accept-Encoding"
+     * request-header field.
+     * <p>
+     * Default is {@code true}.
+     * @see #setRemoveUnsupportedEncodings(boolean)
+     */
+    private boolean removeUnsupportedEncodings = true;
+    /**
+     * The option that controls whether the proxy should always decode gzipped content or not.
+     */
+    private boolean alwaysDecodeGzip = true;
+
+    /**
+     * Flag that controls whether or not the local proxy is behind NAT.
+     * <p>
+     * Default is {@code false}.
+     */
+    private boolean behindNat;
+
+    public ProxiesParamProxy(boolean enabled) {
+        super(enabled);
+    }
+
+    public ProxiesParamProxy(String address, int port, boolean enabled) {
+        this(enabled);
+
+        this.address = address;
+        this.port = port;
+    }
+
+    public ProxiesParamProxy(
+            String address,
+            int port,
+            boolean enabled,
+            boolean proxyIpAnyLocalAddress,
+            boolean removeUnsupportedEncodings,
+            boolean alwaysDecodeGzip,
+            boolean behindNat) {
+        super(enabled);
+        this.address = address;
+        this.port = port;
+        this.proxyIpAnyLocalAddress = proxyIpAnyLocalAddress;
+        this.removeUnsupportedEncodings = removeUnsupportedEncodings;
+        this.alwaysDecodeGzip = alwaysDecodeGzip;
+        this.behindNat = behindNat;
+    }
+
+    public ProxiesParamProxy(ProxiesParamProxy proxy) {
+        this(proxy.address,
+             proxy.port,
+             proxy.isEnabled(),
+             proxy.proxyIpAnyLocalAddress,
+             proxy.removeUnsupportedEncodings,
+             proxy.alwaysDecodeGzip,
+             proxy.behindNat);
+    }
+
+    public String getAddress() {
+        return address;
+    }
+
+    public void setAddress(String address) {
+        this.address = address;
+    }
+
+    public int getPort() {
+        return port;
+    }
+
+    public void setPort(int port) {
+        this.port = port;
+    }
+
+    public boolean isProxyIpAnyLocalAddress() {
+        return proxyIpAnyLocalAddress;
+    }
+
+    public void setProxyIpAnyLocalAddress(boolean proxyIpAnyLocalAddress) {
+        this.proxyIpAnyLocalAddress = proxyIpAnyLocalAddress;
+    }
+
+    public boolean isRemoveUnsupportedEncodings() {
+        return removeUnsupportedEncodings;
+    }
+
+    public void setRemoveUnsupportedEncodings(boolean removeUnsupportedEncodings) {
+        this.removeUnsupportedEncodings = removeUnsupportedEncodings;
+    }
+
+    public boolean isAlwaysDecodeGzip() {
+        return alwaysDecodeGzip;
+    }
+
+    public void setAlwaysDecodeGzip(boolean alwaysDecodeGzip) {
+        this.alwaysDecodeGzip = alwaysDecodeGzip;
+    }
+
+    public boolean isBehindNat() {
+        return behindNat;
+    }
+
+    public void setBehindNat(boolean behindNat) {
+        this.behindNat = behindNat;
+    }
+}
diff --git a/src/org/zaproxy/zap/utils/NetworkUtils.java b/src/org/zaproxy/zap/utils/NetworkUtils.java
new file mode 100644
index 000000000..737156dfe
--- /dev/null
+++ b/src/org/zaproxy/zap/utils/NetworkUtils.java
@@ -0,0 +1,69 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2017 The ZAP Development Team
+ *  
+ * Licensed under the Apache License, Version 2.0 (the "License"); 
+ * you may not use this file except in compliance with the License. 
+ * You may obtain a copy of the License at 
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0 
+ *   
+ * Unless required by applicable law or agreed to in writing, software 
+ * distributed under the License is distributed on an "AS IS" BASIS, 
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
+ * See the License for the specific language governing permissions and 
+ * limitations under the License. 
+ */
+package org.zaproxy.zap.utils;
+
+import java.net.InetAddress;
+import java.net.NetworkInterface;
+import java.net.SocketException;
+import java.util.ArrayList;
+import java.util.Enumeration;
+import java.util.List;
+
+import org.apache.log4j.Logger;
+
+/**
+ * @since TODO add version
+ */
+public final class NetworkUtils {
+    
+    private NetworkUtils() {
+    }
+
+    private static final Logger LOG = Logger.getLogger(NetworkUtils.class);
+
+    public static List<String> getAvailableAddresses(boolean remoteOnly) {
+        List<String> list = new ArrayList<String>();
+        Enumeration<NetworkInterface> e;
+        try {
+            e = NetworkInterface.getNetworkInterfaces();
+            while (e.hasMoreElements()) {
+                NetworkInterface n = e.nextElement();
+                if (n.isLoopback() || !n.isUp()) {
+                    continue;
+                }
+                Enumeration<InetAddress> ee = n.getInetAddresses();
+                while (ee.hasMoreElements()) {
+                    InetAddress i = ee.nextElement();
+                    if (remoteOnly && i.isSiteLocalAddress()) {
+                        continue;
+                    }
+                    String addr = i.getHostAddress();
+                    if (addr.indexOf('%') > 0) {
+                        addr = addr.substring(0, addr.indexOf('%'));
+                    }
+                    list.add(addr);
+                }
+            }
+        } catch (SocketException e1) {
+            LOG.error(e1.getMessage(), e1);
+        }
+        return list;
+    }
+}
