diff --git a/src/org/parosproxy/paros/model/SiteMap.java b/src/org/parosproxy/paros/model/SiteMap.java
index 8585978c9..4d4eef378 100644
--- a/src/org/parosproxy/paros/model/SiteMap.java
+++ b/src/org/parosproxy/paros/model/SiteMap.java
@@ -43,6 +43,7 @@
 // ZAP: 2015/02/09 Issue 1525: Introduce a database interface layer to allow for alternative implementations
 // ZAP: 2015/04/02 Issue 1582: Low memory option
 // ZAP: 2015/08/19 Change to cope with deprecation of HttpMessage.getParamNameSet(HtmlParameter.Type, String)
+// ZAP: 2015/08/19 Issue 1784: NullPointerException when active scanning through the API with a target without scheme
 
 package org.parosproxy.paros.model;
 
@@ -629,7 +630,12 @@ public class SiteMap extends DefaultTreeModel {
 	private String getHostName(URI uri) throws URIException {
 		StringBuilder host = new StringBuilder(); 				
 		
-		String scheme = uri.getScheme().toLowerCase();
+		String scheme = uri.getScheme();
+		if (scheme == null) {
+			scheme = "http";
+		} else {
+			scheme = scheme.toLowerCase();
+		}
 		host.append(scheme).append("://").append(uri.getHost());
 		
 		int port = uri.getPort();		
diff --git a/src/org/zaproxy/zap/extension/ascan/ActiveScanAPI.java b/src/org/zaproxy/zap/extension/ascan/ActiveScanAPI.java
index ff89cab90..37dd07c10 100644
--- a/src/org/zaproxy/zap/extension/ascan/ActiveScanAPI.java
+++ b/src/org/zaproxy/zap/extension/ascan/ActiveScanAPI.java
@@ -31,6 +31,7 @@ import net.sf.json.JSONObject;
 
 import org.apache.commons.configuration.ConfigurationException;
 import org.apache.commons.httpclient.URI;
+import org.apache.commons.httpclient.URIException;
 import org.apache.commons.lang.StringEscapeUtils;
 import org.apache.log4j.Logger;
 import org.parosproxy.paros.control.Control;
@@ -187,7 +188,6 @@ public class ActiveScanAPI extends ApiImplementor {
 		try {
 			switch(name) {
 			case ACTION_SCAN_AS_USER:
-				String urlUserScan = ApiUtils.getNonEmptyStringParam(params, PARAM_URL);
 				int userID = ApiUtils.getIntParam(params, PARAM_USER_ID);
 				ExtensionUserManagement usersExtension = Control.getSingleton()
 						.getExtensionLoader()
@@ -196,7 +196,7 @@ public class ActiveScanAPI extends ApiImplementor {
 					throw new ApiException(Type.NO_IMPLEMENTOR, ExtensionUserManagement.NAME);
 				}
 				Context context = ApiUtils.getContextByParamId(params, PARAM_CONTEXT_ID);
-				if (!context.isIncluded(urlUserScan)) {
+				if (!context.isIncluded(params.getString(PARAM_URL))) {
 					throw new ApiException(Type.URL_NOT_IN_CONTEXT, PARAM_CONTEXT_ID);
 				}
 				user = usersExtension.getContextUserAuthManager(context.getIndex()).getUserById(userID);
@@ -207,10 +207,7 @@ public class ActiveScanAPI extends ApiImplementor {
 				// Same behaviour but with addition of the user to scan
 				// $FALL-THROUGH$
 			case ACTION_SCAN:
-				String url = params.getString(PARAM_URL);
-				if (url == null || url.length() == 0) {
-					throw new ApiException(ApiException.Type.MISSING_PARAMETER, PARAM_URL);
-				}
+				URI url = getTargetUrl(params.getString(PARAM_URL));
 
 				boolean scanJustInScope = user == null ? this.getParam(params, PARAM_JUST_IN_SCOPE, false) : false;
 
@@ -240,7 +237,7 @@ public class ActiveScanAPI extends ApiImplementor {
 				}
 
 				int scanId = scanURL(
-						params.getString(PARAM_URL),
+						url,
 						user,
 						this.getParam(params, PARAM_RECURSE, true),
 						scanJustInScope,
@@ -389,6 +386,19 @@ public class ActiveScanAPI extends ApiImplementor {
 		return ApiResponseElement.OK;
 	}
 
+	private static URI getTargetUrl(String url) throws ApiException {
+		try {
+			URI targetUrl = new URI(url, false);
+			String scheme = targetUrl.getScheme();
+			if (scheme == null || (!scheme.equalsIgnoreCase("http") && !scheme.equalsIgnoreCase("https"))) {
+				throw new ApiException(ApiException.Type.ILLEGAL_PARAMETER, PARAM_URL);
+			}
+			return targetUrl;
+		} catch (URIException e) {
+			throw new ApiException(ApiException.Type.ILLEGAL_PARAMETER, PARAM_URL);
+		}
+	}
+
 	private ScanPolicy getScanPolicyFromParams(JSONObject params) throws ApiException {
 		String policyName = null;
 		try {
@@ -529,12 +539,12 @@ public class ActiveScanAPI extends ApiImplementor {
 		return scanner;
 	}
 
-	private int scanURL(String url, User user, boolean scanChildren, boolean scanJustInScope, String method, String postData, ScanPolicy policy) throws ApiException {
+	private int scanURL(URI url, User user, boolean scanChildren, boolean scanJustInScope, String method, String postData, ScanPolicy policy) throws ApiException {
 		// Try to find node
 		StructuralNode node;
 		
 		try {
-			node = SessionStructure.find(Model.getSingleton().getSession().getSessionId(), new URI(url, false), method, postData);
+			node = SessionStructure.find(Model.getSingleton().getSession().getSessionId(), url, method, postData);
 			if (node == null) {
 				throw new ApiException(ApiException.Type.URL_NOT_FOUND);
 			}
