diff --git a/src/org/parosproxy/paros/core/scanner/HostProcess.java b/src/org/parosproxy/paros/core/scanner/HostProcess.java
index 7d105e4f8..f1c802704 100644
--- a/src/org/parosproxy/paros/core/scanner/HostProcess.java
+++ b/src/org/parosproxy/paros/core/scanner/HostProcess.java
@@ -51,6 +51,7 @@
 // ZAP: 2015/04/17 A problem occur when a single node should be scanned because count start from -1
 // ZAP: 2015/05/04 Issue 1566: Improve active scan's reported progress
 // ZAP: 2015/07/26 Issue 1618: Target Technology Not Honored
+// ZAP: 2015/10/29 Issue 2005: Active scanning incorrectly performed on sibling nodes 
 
 package org.parosproxy.paros.core.scanner;
 
@@ -71,6 +72,7 @@ import org.parosproxy.paros.network.ConnectionParam;
 import org.parosproxy.paros.network.HttpMessage;
 import org.parosproxy.paros.network.HttpSender;
 import org.zaproxy.zap.extension.ascan.ScanPolicy;
+import org.zaproxy.zap.model.SessionStructure;
 import org.zaproxy.zap.model.StructuralNode;
 import org.zaproxy.zap.model.TechSet;
 import org.zaproxy.zap.users.User;
@@ -245,24 +247,29 @@ public class HostProcess implements Runnable {
 
         scanSingleNode(plugin, node);
 
-        if (incRelatedSiblings) {
-            // Also match siblings with the same hierarchic name
-            // If we dont do this http://localhost/start might match the GET variant in the Sites tree and miss the hierarchic node
-            // note that this is only done for the top level.
-            try {
-				Iterator<StructuralNode> iter = node.getParent().getChildIterator();
-				while (iter.hasNext()) {
-				    StructuralNode sibling = iter.next();
-					if (! node.isSameAs(sibling) && ! node.getName().equals(sibling.getName())) {
-				        parentNodes.add(sibling);
-					}
-				}
-			} catch (DatabaseException e) {
-				// Ignore - if we cant connect to the db there will be plenty of other errors logged ;)
-			}
-        }
-
         if (parentScanner.scanChildren()) {
+            if (incRelatedSiblings) {
+                // Also match siblings with the same hierarchic name
+                // If we dont do this http://localhost/start might match the GET variant 
+            	// in the Sites tree and miss the hierarchic node.
+                // Note that this is only done for the top level
+                try {
+    				Iterator<StructuralNode> iter = node.getParent().getChildIterator();
+    				String nodeName = SessionStructure.getCleanRelativeName(node, false);
+    				while (iter.hasNext()) {
+    				    StructuralNode sibling = iter.next();
+    					if (! node.isSameAs(sibling) && 
+    							nodeName.equals(
+    									SessionStructure.getCleanRelativeName(sibling, false))) {
+    				        log.debug("traverse: including related sibling " + sibling.getName());
+    				        parentNodes.add(sibling);
+    					}
+    				}
+    			} catch (DatabaseException e) {
+    				// Ignore - if we cant connect to the db there will be plenty of other errors logged ;)
+    			}
+            }
+        	
         	for (StructuralNode pNode : parentNodes) {
 	        	Iterator<StructuralNode> iter = pNode.getChildIterator();
 	        	while (iter.hasNext() && !isStop() && !isSkipped(plugin)) {
diff --git a/src/org/zaproxy/zap/model/SessionStructure.java b/src/org/zaproxy/zap/model/SessionStructure.java
index c6ed54b24..8c687ffd8 100644
--- a/src/org/zaproxy/zap/model/SessionStructure.java
+++ b/src/org/zaproxy/zap/model/SessionStructure.java
@@ -142,9 +142,27 @@ public class SessionStructure {
 	 * @param incParams if true then include URL params in the regex, otherwise exclude them 
 	 * @return a regex pattern that will match the specified StructuralNode, ignoring the parent and children.
 	 */
-	private static String getRegexName(StructuralNode sn, boolean incParams) {
+	public static String getRegexName(StructuralNode sn, boolean incParams) {
+		return getSpecifiedName(sn, incParams, true);
+	}
+	
+	/**
+	 * Returns the name of the node ignoring the parent and children,
+	 * ie the last element in the path.
+	 * Data driven nodes will return the user specified name surrounded by the 
+	 * double angled brackets. 
+	 * @param sn a StructuralNode
+	 * @param incParams if true then include URL params in the regex, otherwise exclude them 
+	 * @return the name of the node ignoring the parent and children
+	 */
+	public static String getCleanRelativeName(StructuralNode sn, boolean incParams) {
+		return getSpecifiedName(sn, incParams, false);
+	}
+
+	private static String getSpecifiedName(StructuralNode sn, 
+			boolean incParams, boolean dataDrivenNodesAsRegex) {
     	String name = sn.getName();
-    	if (sn.isDataDriven()) {
+    	if (sn.isDataDriven() && dataDrivenNodesAsRegex) {
     		// Non-greedy regex pattern 
 			return DATA_DRIVEN_NODE_REGEX;
     	} 
@@ -164,18 +182,18 @@ public class SessionStructure {
 				name = name.substring(0, quesIndex);
 			}
 		}
+		if (name.endsWith("/")) {
+    		name = name.substring(0, name.length()-1);
+		}
     	try {
 			if (sn.getURI().getPath() == null || sn.getURI().getPath().length() == 1) {
-				// Its a top level node, return as is (minus any trailing slash
-				if (name.charAt(name.length()-1) == '/') {
-					return name.substring(0, name.length()-1);
-				}
+				// Its a top level node, return as is
 				return name;
 			}
 		} catch (URIException e) {
 			// Ignore
 		}
-    	
+
     	int slashIndex = name.lastIndexOf('/');
     	if (slashIndex >= 0) {
     		name = name.substring(slashIndex+1);
diff --git a/src/org/zaproxy/zap/view/StandardFieldsDialog.java b/src/org/zaproxy/zap/view/StandardFieldsDialog.java
index 79b373c3d..6d6fe3ace 100644
--- a/src/org/zaproxy/zap/view/StandardFieldsDialog.java
+++ b/src/org/zaproxy/zap/view/StandardFieldsDialog.java
@@ -816,12 +816,8 @@ public abstract class StandardFieldsDialog extends AbstractDialog {
 		}
 		final ZapTextField text = new ZapTextField();
 		text.setEditable(editable);
-		if (value != null && value.getHistoryReference() != null) {
-			try {
-				text.setText(value.getHistoryReference().getURI().toString());
-			} catch (Exception e1) {
-				// Ignore
-			}
+		if (value != null) {
+			text.setText(getNodeText(value));
 		}
 		JButton selectButton = new JButton(Constant.messages.getString("all.button.select"));
 		selectButton.setIcon(new ImageIcon(View.class.getResource("/resource/icon/16/094.png"))); // Globe icon
@@ -833,12 +829,8 @@ public abstract class StandardFieldsDialog extends AbstractDialog {
 				NodeSelectDialog nsd = new NodeSelectDialog(StandardFieldsDialog.this);
 				nsd.setAllowRoot(allowRoot);
 				SiteNode node = nsd.showDialog(this.node);
-				if (node != null && node.getHistoryReference() != null) {
-					try {
-						text.setText(node.getHistoryReference().getURI().toString());
-					} catch (Exception e1) {
-						// Ignore
-					}
+				if (node != null) {
+					text.setText(getNodeText(node));
 					this.node = node;
 					siteNodeSelected(fieldLabel, node);
 				}
@@ -867,12 +859,8 @@ public abstract class StandardFieldsDialog extends AbstractDialog {
 		}
 		final ZapTextField text = new ZapTextField();
 		text.setEditable(editable);
-		if (value != null && value.getHistoryReference() != null) {
-			try {
-				text.setText(value.getHistoryReference().getURI().toString());
-			} catch (Exception e1) {
-				// Ignore
-			}
+		if (value != null) {
+			text.setText(getNodeText(value));
 		}
 		JButton selectButton = new JButton(Constant.messages.getString("all.button.select"));
 		selectButton.setIcon(new ImageIcon(View.class.getResource("/resource/icon/16/094.png"))); // Globe icon
@@ -884,12 +872,8 @@ public abstract class StandardFieldsDialog extends AbstractDialog {
 				NodeSelectDialog nsd = new NodeSelectDialog(StandardFieldsDialog.this);
 				nsd.setAllowRoot(allowRoot);
 				SiteNode node = nsd.showDialog(this.node);
-				if (node != null && node.getHistoryReference() != null) {
-					try {
-						text.setText(node.getHistoryReference().getURI().toString());
-					} catch (Exception e1) {
-						// Ignore
-					}
+				if (node != null) {
+					text.setText(getNodeText(node));
 					this.node = node;
 					siteNodeSelected(fieldLabel, node);
 				}
@@ -970,8 +954,8 @@ public abstract class StandardFieldsDialog extends AbstractDialog {
 	 */
 	protected static String getTargetText(Target target) {
 		if (target != null) {
-			if (target.getStartNode() != null && target.getStartNode().getHistoryReference() != null) {
-				return target.getStartNode().getHistoryReference().getURI().toString();
+			if (target.getStartNode() != null) {
+				return getNodeText(target.getStartNode());
 			} else if (target.getContext() != null) {
 				return Constant.messages.getString("context.prefixName", target.getContext().getName());
 			} else if (target.isInScopeOnly()) {
@@ -980,7 +964,23 @@ public abstract class StandardFieldsDialog extends AbstractDialog {
 		}
 		return null;
 	}
-	
+
+	private static String getNodeText(SiteNode node) {
+		if (node != null && node.getHistoryReference() != null) {
+			String url = node.getHistoryReference().getURI().toString();
+			if (node.isLeaf() && url.endsWith("/")) {
+				// String off the slash so we dont match a non leaf
+				// node with the same name
+				url = url.substring(0, url.length()-1);
+			} else if (! node.isLeaf() && ! url.endsWith("/")) {
+				// Add the slash to show its a non leaf node
+				url = url + "/";
+			}
+			return url;
+		}
+		return "";
+	}
+
 	public void addContextSelectField(String fieldLabel, Context selectedContext){
 		if (isTabbed()) {
 			throw new IllegalArgumentException("Initialised as a tabbed dialog - must use method with tab parameters");
