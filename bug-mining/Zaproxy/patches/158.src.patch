diff --git a/src/org/zaproxy/zap/control/AddOn.java b/src/org/zaproxy/zap/control/AddOn.java
index fa45abfcd..21ceae999 100644
--- a/src/org/zaproxy/zap/control/AddOn.java
+++ b/src/org/zaproxy/zap/control/AddOn.java
@@ -24,12 +24,15 @@ import java.io.IOException;
 import java.io.InputStream;
 import java.net.MalformedURLException;
 import java.net.URL;
+import java.nio.file.Files;
+import java.nio.file.Path;
 import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.Collection;
 import java.util.Collections;
 import java.util.HashSet;
 import java.util.List;
+import java.util.Locale;
 import java.util.Set;
 import java.util.zip.ZipEntry;
 import java.util.zip.ZipFile;
@@ -54,6 +57,14 @@ import org.zaproxy.zap.control.BaseZapAddOnXmlData.ExtensionWithDeps;
 import org.zaproxy.zap.extension.pscan.PluginPassiveScanner;
 
 public class AddOn  {
+
+	/**
+	 * The name of the manifest file, contained in the add-ons.
+	 * 
+	 * @since TODO add version
+	 */
+	public static final String MANIFEST_FILE_NAME = "ZapAddOn.xml";
+
 	public enum Status {unknown, example, alpha, beta, weekly, release}
 	
 	private static ZapRelease v2_4 = new ZapRelease("2.4.0");
@@ -167,8 +178,21 @@ public class AddOn  {
 
 	private static final Logger logger = Logger.getLogger(AddOn.class);
 	
+	/**
+	 * Tells whether or not the given file name matches the name of a ZAP add-on.
+	 * <p>
+	 * The file name must have the format "{@code <id>-<status>-<version>.zap}". The {@code id} is a string, the {@code status}
+	 * must be a value from {@link Status} and the {@code version} must be an integer.
+	 *
+	 * @param fileName the name of the file to check
+	 * @return {@code true} if the given file name is the name of an add-on, {@code false} otherwise.
+	 * @deprecated (TODO add version) Use {@link #isAddOnFileName(String)} instead, the checks done in this method are more
+	 *             strict than it needs to.
+	 * @see #isAddOnFileName(String)
+	 */
+	@Deprecated
 	public static boolean isAddOn(String fileName) {
-		if (! fileName.toLowerCase().endsWith(FILE_EXTENSION)) {
+		if (! isAddOnFileName(fileName)) {
 			return false;
 		}
 		if (fileName.substring(0, fileName.indexOf(".")).split("-").length < 3) {
@@ -185,13 +209,76 @@ public class AddOn  {
 		return true;
 		
 	}
+
+	/**
+	 * Tells whether or not the given file name matches the name of a ZAP add-on.
+	 * <p>
+	 * The file name must have as file extension {@link #FILE_EXTENSION}.
+	 *
+	 * @param fileName the name of the file to check
+	 * @return {@code true} if the given file name is the name of an add-on, {@code false} otherwise.
+	 * @since TODO add version
+	 */
+	public static boolean isAddOnFileName(String fileName) {
+		if (fileName == null) {
+			return false;
+		}
+		return fileName.toLowerCase(Locale.ROOT).endsWith(FILE_EXTENSION);
+	}
+
+	/**
+	 * Tells whether or not the given file is an add-on.
+	 *
+	 * @param f the file to be checked
+	 * @return {@code true} if the given file is an add-on, {@code false} otherwise.
+	 * @deprecated (TODO add version) Use {@link #isAddOn(Path)} instead.
+	 */
+	@Deprecated
 	public static boolean isAddOn(File f) {
-		if (! f.exists()) {
+		return isAddOn(f.toPath());
+	}
+
+	/**
+	 * Tells whether or not the given file is a ZAP add-on.
+	 * <p>
+	 * An add-on is a ZIP file that contains, at least, a {@value #MANIFEST_FILE_NAME} file.
+	 * 
+	 * @param file the file to be checked
+	 * @return {@code true} if the given file is an add-on, {@code false} otherwise.
+	 * @since TODO add version
+	 * @see #isAddOnFileName(String)
+	 */
+	public static boolean isAddOn(Path file) {
+		if (file == null || file.getNameCount() == 0) {
+			return false;
+		}
+
+		if (!isAddOnFileName(file.getFileName().toString())) {
+			return false;
+		}
+
+		if (!Files.isRegularFile(file) || !Files.isReadable(file)) {
+			return false;
+		}
+
+		try (ZipFile zip = new ZipFile(file.toFile())) {
+			return zip.getEntry(MANIFEST_FILE_NAME) != null;
+		} catch (Exception e) {
+			if (logger.isDebugEnabled()) {
+				logger.debug("Failed to obtain " + MANIFEST_FILE_NAME + " entry:", e);
+			}
 			return false;
 		}
-		return isAddOn(f.getName());
 	}
 
+	/**
+	 * Constructs an {@code AddOn} with the given file name.
+	 *
+	 * @param fileName the file name of the add-on
+	 * @throws Exception if the file name is not valid.
+	 * @deprecated (TODO add version) Use {@link #AddOn(Path)} instead.
+	 */
+	@Deprecated
 	public AddOn(String fileName) throws Exception {
 		// Format is <name>-<status>-<version>.zap
 		if (! isAddOn(fileName)) {
@@ -207,53 +294,78 @@ public class AddOn  {
 	/**
 	 * Constructs an {@code AddOn} from the given {@code file}.
 	 * <p>
-	 * The {@code ZapAddOn.xml} ZIP file entry is read after validating that the add-on has a valid add-on file name.
+	 * The {@value #MANIFEST_FILE_NAME} ZIP file entry is read after validating that the add-on has a valid add-on file name.
 	 * <p>
 	 * The installation status of the add-on is 'not installed'.
 	 * 
 	 * @param file the file of the add-on
 	 * @throws Exception if the given {@code file} does not exist, does not have a valid add-on file name or an error occurred
-	 *			 while reading the {@code ZapAddOn.xml} ZIP file entry
+	 *             while reading the {@code value #ZAP_ADD_ON_XML} ZIP file entry
+	 * @deprecated (TODO add version) Use {@link #AddOn(Path)} instead.
 	 */
+	@Deprecated
 	public AddOn(File file) throws Exception {
-		this(file.getName());
+		this(file.toPath());
+	}
+
+	/**
+	 * Constructs an {@code AddOn} from the given {@code file}.
+	 * <p>
+	 * The {@value #MANIFEST_FILE_NAME} ZIP file entry is read after validating that the add-on is a valid add-on.
+	 * <p>
+	 * The installation status of the add-on is 'not installed'.
+	 * 
+	 * @param file the file of the add-on
+	 * @throws IOException if the given {@code file} does not exist, does not have a valid add-on file name or an error occurred
+	 *             while reading the {@value #MANIFEST_FILE_NAME} ZIP file entry
+	 * @see #isAddOn(Path)
+	 */
+	public AddOn(Path file) throws IOException {
 		if (! isAddOn(file)) {
-			throw new Exception("Invalid ZAP add-on file " + file.getAbsolutePath());
+			throw new IOException("Invalid ZAP add-on file " + (file != null ? file.toAbsolutePath() : "[null]"));
 		}
-		this.file = file;
+		this.id = extractAddOnId(file.getFileName().toString());
+		this.file = file.toFile();
 		loadManifestFile();
 	}
+
+	private static String extractAddOnId(String fileName) {
+		return fileName.substring(0, fileName.indexOf('.')).split("-")[0];
+	}
 	
 	private void loadManifestFile() throws IOException {
 		manifestRead = true;
 		if (file.exists()) {
 			// Might not exist in the tests
 			try (ZipFile zip = new ZipFile(file)) {
-				ZipEntry zapAddOnEntry = zip.getEntry("ZapAddOn.xml");
-				if (zapAddOnEntry != null) {
-					try (InputStream zis = zip.getInputStream(zapAddOnEntry)) {
-						ZapAddOnXmlFile zapAddOnXml = new ZapAddOnXmlFile(zis);
-
-						this.name = zapAddOnXml.getName();
-						this.version = zapAddOnXml.getVersion();
-						this.description = zapAddOnXml.getDescription();
-						this.changes = zapAddOnXml.getChanges();
-						this.author = zapAddOnXml.getAuthor();
-						this.notBeforeVersion = zapAddOnXml.getNotBeforeVersion();
-						this.notFromVersion = zapAddOnXml.getNotFromVersion();
-						this.dependencies = zapAddOnXml.getDependencies();
-
-						this.ascanrules = zapAddOnXml.getAscanrules();
-						this.extensions = zapAddOnXml.getExtensions();
-						this.extensionsWithDeps = zapAddOnXml.getExtensionsWithDeps();
-						this.files = zapAddOnXml.getFiles();
-						this.pscanrules = zapAddOnXml.getPscanrules();
-
-						this.addOnClassnames = zapAddOnXml.getAddOnClassnames();
-
-						hasZapAddOnEntry = true;
-					}
+				ZipEntry zapAddOnEntry = zip.getEntry(MANIFEST_FILE_NAME);
+				if (zapAddOnEntry == null) {
+					throw new IOException("Add-on does not have the " + MANIFEST_FILE_NAME + " file.");
+				}
 
+				try (InputStream zis = zip.getInputStream(zapAddOnEntry)) {
+					ZapAddOnXmlFile zapAddOnXml = new ZapAddOnXmlFile(zis);
+
+					this.name = zapAddOnXml.getName();
+					this.fileVersion = zapAddOnXml.getPackageVersion();
+					this.version = zapAddOnXml.getVersion();
+					this.status = AddOn.Status.valueOf(zapAddOnXml.getStatus());
+					this.description = zapAddOnXml.getDescription();
+					this.changes = zapAddOnXml.getChanges();
+					this.author = zapAddOnXml.getAuthor();
+					this.notBeforeVersion = zapAddOnXml.getNotBeforeVersion();
+					this.notFromVersion = zapAddOnXml.getNotFromVersion();
+					this.dependencies = zapAddOnXml.getDependencies();
+
+					this.ascanrules = zapAddOnXml.getAscanrules();
+					this.extensions = zapAddOnXml.getExtensions();
+					this.extensionsWithDeps = zapAddOnXml.getExtensionsWithDeps();
+					this.files = zapAddOnXml.getFiles();
+					this.pscanrules = zapAddOnXml.getPscanrules();
+
+					this.addOnClassnames = zapAddOnXml.getAddOnClassnames();
+
+					hasZapAddOnEntry = true;
 				}
 			}
 		}
@@ -266,7 +378,7 @@ public class AddOn  {
 	 * <p>
 	 * The given {@code SubnodeConfiguration} must have a {@code XPathExpressionEngine} installed.
 	 * <p>
-	 * The {@code ZapAddOn.xml} ZIP file entry is read, if the add-on file exists locally.
+	 * The {@value #MANIFEST_FILE_NAME} ZIP file entry is read, if the add-on file exists locally.
 	 * 
 	 * @param id the id of the add-on
 	 * @param baseDir the base directory where the add-on is located
@@ -360,6 +472,25 @@ public class AddOn  {
 		this.changes = changes;
 	}
 
+	/**
+	 * Gets the normalised file name of the add-on.
+	 * <p>
+	 * Should be used when copying the file from an "unknown" source (e.g. manually installed).
+	 *
+	 * @return the normalised file name.
+	 * @since TODO add version
+	 * @see #getFile()
+	 */
+	public String getNormalisedFileName() {
+		return getId() + "-" + getFileVersion() + FILE_EXTENSION;
+	}
+
+	/**
+	 * Gets the file of the add-on.
+	 *
+	 * @return the file of the add-on.
+	 * @see #getNormalisedFileName()
+	 */
 	public File getFile() {
 		return file;
 	}
@@ -425,7 +556,7 @@ public class AddOn  {
 					this.loadManifestFile();
 				} catch (IOException e) {
 					if (logger.isDebugEnabled()) {
-						logger.debug("Failed to read the ZapAddOn.xml file of " + id + ":", e);
+						logger.debug("Failed to read the " + AddOn.MANIFEST_FILE_NAME + " file of " + id + ":", e);
 					}
 				}
 			}
diff --git a/src/org/zaproxy/zap/control/AddOnCollection.java b/src/org/zaproxy/zap/control/AddOnCollection.java
index cd268f9f8..dec5d0dbb 100644
--- a/src/org/zaproxy/zap/control/AddOnCollection.java
+++ b/src/org/zaproxy/zap/control/AddOnCollection.java
@@ -22,6 +22,9 @@ package org.zaproxy.zap.control;
 
 import java.io.File;
 import java.net.URL;
+import java.nio.file.DirectoryStream;
+import java.nio.file.Files;
+import java.nio.file.Path;
 import java.util.ArrayList;
 import java.util.List;
 import java.util.Set;
@@ -163,11 +166,10 @@ public class AddOnCollection {
     	if (! dir.isDirectory()) {
     		logger.error("Not a directory: " + dir.getAbsolutePath());
     	}
-    	// Load the addons
-        File[] listFile = dir.listFiles();
 
-        if (listFile != null) {
-        	for (File addOnFile : listFile) {
+    	// Load the addons
+    	try (DirectoryStream<Path> addOnFiles = Files.newDirectoryStream(dir.toPath(), "*" + AddOn.FILE_EXTENSION)) {
+        	for (Path addOnFile : addOnFiles) {
         		if (AddOn.isAddOn(addOnFile)) {
 	            	AddOn ao = createAddOn(addOnFile);
                     if (ao == null) {
@@ -210,7 +212,7 @@ public class AddOnCollection {
         }
     }
 
-    private static AddOn createAddOn(File addOnFile) {
+    private static AddOn createAddOn(Path addOnFile) {
         try {
             return new AddOn(addOnFile);
         } catch (Exception e) {
diff --git a/src/org/zaproxy/zap/control/AddOnLoader.java b/src/org/zaproxy/zap/control/AddOnLoader.java
index 739f1b693..8f6d3ec72 100644
--- a/src/org/zaproxy/zap/control/AddOnLoader.java
+++ b/src/org/zaproxy/zap/control/AddOnLoader.java
@@ -643,7 +643,8 @@ public class AddOnLoader extends URLClassLoader {
 	/**
 	 * Returns all the {@code Extension}s of all the installed add-ons.
 	 * <p>
-	 * The discovery of {@code Extension}s is done by resorting to the {@code ZapAddOn.xml} file bundled in the add-ons.
+	 * The discovery of {@code Extension}s is done by resorting to the {@link AddOn#MANIFEST_FILE_NAME manifest file} bundled in
+	 * the add-ons.
 	 * <p>
 	 * Extensions with unfulfilled dependencies are not be returned.
 	 *
@@ -664,7 +665,8 @@ public class AddOnLoader extends URLClassLoader {
     /**
      * Returns all {@code Extension}s of the given {@code addOn}.
      * <p>
-     * The discovery of {@code Extension}s is done by resorting to {@code ZapAddOn.xml} file bundled in the add-on.
+     * The discovery of {@code Extension}s is done by resorting to {@link AddOn#MANIFEST_FILE_NAME manifest file} bundled in the
+     * add-on.
      * <p>
      * Extensions with unfulfilled dependencies are not be returned.
      * <p>
@@ -737,7 +739,8 @@ public class AddOnLoader extends URLClassLoader {
 	/**
 	 * Gets the active scan rules of all the loaded add-ons.
 	 * <p>
-	 * The discovery of active scan rules is done by resorting to {@code ZapAddOn.xml} file bundled in the add-ons.
+	 * The discovery of active scan rules is done by resorting to  {@link AddOn#MANIFEST_FILE_NAME manifest file} bundled in the
+	 * add-ons.
 	 *
 	 * @return an unmodifiable {@code List} with all the active scan rules, never {@code null}
 	 * @since 2.4.0
@@ -758,7 +761,8 @@ public class AddOnLoader extends URLClassLoader {
 	/**
 	 * Gets the passive scan rules of all the loaded add-ons.
 	 * <p>
-	 * The discovery of passive scan rules is done by resorting to {@code ZapAddOn.xml} file bundled in the add-ons.
+	 * The discovery of passive scan rules is done by resorting to {@link AddOn#MANIFEST_FILE_NAME manifest file} bundled in the
+	 * add-ons.
 	 *
 	 * @return an unmodifiable {@code List} with all the passive scan rules, never {@code null}
 	 * @since 2.4.0
diff --git a/src/org/zaproxy/zap/control/BaseZapAddOnXmlData.java b/src/org/zaproxy/zap/control/BaseZapAddOnXmlData.java
index 33c623a7e..8dc8699c5 100644
--- a/src/org/zaproxy/zap/control/BaseZapAddOnXmlData.java
+++ b/src/org/zaproxy/zap/control/BaseZapAddOnXmlData.java
@@ -38,6 +38,7 @@ import org.zaproxy.zap.utils.ZapXmlConfiguration;
  * Reads:
  * <ul>
  * <li>name;</li>
+ * <li>status (since TODO add version);</li>
  * <li>version;</li>
  * <li>semver;</li>
  * <li>description;</li>
@@ -91,6 +92,7 @@ public abstract class BaseZapAddOnXmlData {
     private static final Logger LOGGER = Logger.getLogger(BaseZapAddOnXmlData.class);
 
     private static final String NAME_ELEMENT = "name";
+    private static final String STATUS = "status";
     private static final String VERSION_ELEMENT = "version";
     private static final String SEM_VER_ELEMENT = "semver";
     private static final String DESCRIPTION_ELEMENT = "description";
@@ -119,6 +121,7 @@ public abstract class BaseZapAddOnXmlData {
     private static final String CLASSNAMES_RESTRICTED_ALL_ELEMENTS = "classnames/" + CLASSNAMES_RESTRICTED_ELEMENT;
 
     private String name;
+    private String status;
     private int packageVersion;
     private Version version;
     private String description;
@@ -171,6 +174,7 @@ public abstract class BaseZapAddOnXmlData {
     private void readDataImpl(HierarchicalConfiguration zapAddOnXml) {
         name = zapAddOnXml.getString(NAME_ELEMENT, "");
         packageVersion = zapAddOnXml.getInt(VERSION_ELEMENT, 0);
+        status = zapAddOnXml.getString(STATUS, "alpha");
         version = createVersion(zapAddOnXml.getString(SEM_VER_ELEMENT, ""));
         description = zapAddOnXml.getString(DESCRIPTION_ELEMENT, "");
         author = zapAddOnXml.getString(AUTHOR_ELEMENT, "");
@@ -211,6 +215,16 @@ public abstract class BaseZapAddOnXmlData {
         return name;
     }
 
+    /**
+     * Returns the status of the add-on, "alpha", "beta" or "release".
+     *
+     * @return the status of the add-on
+     * @since TODO add version
+     */
+    public String getStatus() {
+        return status;
+    }
+
     public String getDescription() {
         return description;
     }
@@ -364,7 +378,8 @@ public abstract class BaseZapAddOnXmlData {
     }
 
     private void malformedFile(String reason) {
-        throw new IllegalArgumentException("Add-on \"" + name + "\" contains malformed ZapAddOn.xml file, " + reason);
+        throw new IllegalArgumentException(
+                "Add-on \"" + name + "\" contains malformed " + AddOn.MANIFEST_FILE_NAME + " file, " + reason);
     }
 
     public static class Dependencies {
diff --git a/src/org/zaproxy/zap/control/ZapAddOnXmlFile.java b/src/org/zaproxy/zap/control/ZapAddOnXmlFile.java
index 0d41b7efe..144703cef 100644
--- a/src/org/zaproxy/zap/control/ZapAddOnXmlFile.java
+++ b/src/org/zaproxy/zap/control/ZapAddOnXmlFile.java
@@ -26,7 +26,7 @@ import java.util.List;
 import org.apache.commons.configuration.HierarchicalConfiguration;
 
 /**
- * Helper class that reads a {@code ZapAddOn.xml} file.
+ * Helper class that reads a {@link AddOn#MANIFEST_FILE_NAME manifest file}.
  * 
  * @since 2.4.0
  */
diff --git a/src/org/zaproxy/zap/control/ZapVersionsAddOnEntry.java b/src/org/zaproxy/zap/control/ZapVersionsAddOnEntry.java
index 0a8a43a29..6188b8c1a 100644
--- a/src/org/zaproxy/zap/control/ZapVersionsAddOnEntry.java
+++ b/src/org/zaproxy/zap/control/ZapVersionsAddOnEntry.java
@@ -26,7 +26,6 @@ import org.apache.commons.configuration.HierarchicalConfiguration;
  * <p>
  * It also reads:
  * <ul>
- * <li>status;</li>
  * <li>file;</li>
  * <li>size;</li>
  * <li>info;</li>
@@ -37,13 +36,11 @@ import org.apache.commons.configuration.HierarchicalConfiguration;
  */
 public class ZapVersionsAddOnEntry extends BaseZapAddOnXmlData {
 
-    private static final String STATUS = "status";
     private static final String FILE = "file";
     private static final String SIZE = "size";
     private static final String INFO = "info";
     private static final String HASH = "hash";
 
-    private String status;
     private String file;
     private long size;
     private String info;
@@ -55,22 +52,12 @@ public class ZapVersionsAddOnEntry extends BaseZapAddOnXmlData {
 
     @Override
     protected void readAdditionalData(HierarchicalConfiguration zapAddOnData) {
-        status = zapAddOnData.getString(STATUS);
         file = zapAddOnData.getString(FILE);
         size = zapAddOnData.getLong(SIZE);
         info = zapAddOnData.getString(INFO);
         hash = zapAddOnData.getString(HASH, null);
     }
 
-    /**
-     * Returns the status of the add-on, ("alpha", "beta" or "release").
-     *
-     * @return the status of the add-on
-     */
-    public String getStatus() {
-        return status;
-    }
-
     /**
      * Returns the name of the file of the add-on.
      *
diff --git a/src/org/zaproxy/zap/extension/autoupdate/ExtensionAutoUpdate.java b/src/org/zaproxy/zap/extension/autoupdate/ExtensionAutoUpdate.java
index 3ed5cca1d..2abee9908 100644
--- a/src/org/zaproxy/zap/extension/autoupdate/ExtensionAutoUpdate.java
+++ b/src/org/zaproxy/zap/extension/autoupdate/ExtensionAutoUpdate.java
@@ -32,6 +32,7 @@ import java.lang.reflect.InvocationTargetException;
 import java.net.MalformedURLException;
 import java.net.URL;
 import java.nio.file.FileAlreadyExistsException;
+import java.nio.file.Path;
 import java.text.MessageFormat;
 import java.util.ArrayList;
 import java.util.Collection;
@@ -219,7 +220,7 @@ public class ExtensionAutoUpdate extends ExtensionAdaptor implements CheckForUpd
 						       public boolean accept(File file) {
 						            if (file.isDirectory()) {
 						                return true;
-						            } else if (file.isFile() && file.getName().endsWith(AddOn.FILE_EXTENSION)) {
+						            } else if (file.isFile() && AddOn.isAddOnFileName(file.getName())) {
 						                return true;
 						            }
 						            return false;
@@ -235,7 +236,7 @@ public class ExtensionAutoUpdate extends ExtensionAdaptor implements CheckForUpd
 							if (file == null) {
 								return;
 							}
-							installLocalAddOn(file);
+							installLocalAddOn(file.toPath());
 						}
 					} catch (Exception e1) {
 						logger.error(e1.getMessage(), e1);
@@ -246,7 +247,7 @@ public class ExtensionAutoUpdate extends ExtensionAdaptor implements CheckForUpd
 		return menuItemLoadAddOn;
 	}
 	
-	private void installLocalAddOn(File file) throws Exception {
+	private void installLocalAddOn(Path file) throws Exception {
 		if (!AddOn.isAddOn(file)) {
 			showWarningMessageInvalidAddOnFile();
 			return;
@@ -327,7 +328,7 @@ public class ExtensionAutoUpdate extends ExtensionAdaptor implements CheckForUpd
 	private void installLocalAddOn(AddOn ao) {
 		File addOnFile;
 		try {
-			addOnFile = copyAddOnFileToLocalPluginFolder(ao.getFile());
+			addOnFile = copyAddOnFileToLocalPluginFolder(ao);
 		} catch (FileAlreadyExistsException e) {
 			showWarningMessageAddOnFileAlreadyExists(e.getFile(), e.getOtherFile());
 			logger.warn("Unable to copy add-on, a file with the same name already exists.", e);
@@ -355,18 +356,18 @@ public class ExtensionAutoUpdate extends ExtensionAdaptor implements CheckForUpd
 		View.getSingleton().showWarningDialog(message);
 	}
 
-	private static File copyAddOnFileToLocalPluginFolder(File file) throws IOException {
-		if (isFileInLocalPluginFolder(file)) {
-			return file;
+	private static File copyAddOnFileToLocalPluginFolder(AddOn addOn) throws IOException {
+		if (isFileInLocalPluginFolder(addOn.getFile())) {
+			return addOn.getFile();
 		}
 
-		File targetFile = new File(Constant.FOLDER_LOCAL_PLUGIN, file.getName());
+		File targetFile = new File(Constant.FOLDER_LOCAL_PLUGIN, addOn.getNormalisedFileName());
 		if (targetFile.exists()) {
-			throw new FileAlreadyExistsException(file.getAbsolutePath(), targetFile.getAbsolutePath(), "");
+			throw new FileAlreadyExistsException(addOn.getFile().getAbsolutePath(), targetFile.getAbsolutePath(), "");
 		}
 
 		FileCopier fileCopier = new FileCopier();
-		fileCopier.copy(file, targetFile);
+		fileCopier.copy(addOn.getFile(), targetFile);
 
 		return targetFile;
 	}
@@ -470,7 +471,7 @@ public class ExtensionAutoUpdate extends ExtensionAdaptor implements CheckForUpd
 							}
 						}
 					}
-				} else if (AddOn.isAddOn(dl.getTargetFile())) {
+				} else if (AddOn.isAddOn(dl.getTargetFile().toPath())) {
 					File f = dl.getTargetFile();
 					if (! options.getDownloadDirectory().equals(dl.getTargetFile().getParentFile())) {
 						// Move the file to the specified directory - we do this after its been downloaded
@@ -494,7 +495,7 @@ public class ExtensionAutoUpdate extends ExtensionAdaptor implements CheckForUpd
 						}
 					}
 					
-					AddOn ao = new AddOn(f);
+					AddOn ao = new AddOn(f.toPath());
 					if (ao.canLoadInCurrentVersion()) {
 						install(ao);
 					} else {
diff --git a/test/org/zaproxy/zap/control/AddOnUnitTest.java b/test/org/zaproxy/zap/control/AddOnUnitTest.java
index 4185f8c06..1e127b94d 100644
--- a/test/org/zaproxy/zap/control/AddOnUnitTest.java
+++ b/test/org/zaproxy/zap/control/AddOnUnitTest.java
@@ -20,16 +20,24 @@
 
 package org.zaproxy.zap.control;
 
+import org.junit.Rule;
 import org.junit.Test;
+import org.junit.rules.TemporaryFolder;
 
 import static org.hamcrest.Matchers.equalTo;
 import static org.hamcrest.Matchers.is;
 import static org.junit.Assert.*;
 
 import java.io.File;
+import java.io.FileOutputStream;
+import java.io.IOException;
+import java.nio.charset.StandardCharsets;
+import java.nio.file.Path;
 import java.nio.file.Paths;
 import java.util.Arrays;
 import java.util.Collection;
+import java.util.zip.ZipEntry;
+import java.util.zip.ZipOutputStream;
 
 import org.apache.commons.configuration.tree.xpath.XPathExpressionEngine;
 import org.zaproxy.zap.utils.ZapXmlConfiguration;
@@ -40,53 +48,65 @@ import org.zaproxy.zap.utils.ZapXmlConfiguration;
  */
 public class AddOnUnitTest {
 
+	@Rule
+	public TemporaryFolder tempDir = new TemporaryFolder();
+
 	private static final File ZAP_VERSIONS_XML = 
 			Paths.get("test/resources/org/zaproxy/zap/control", "ZapVersions-deps.xml").toFile();
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testIsAddon() throws Exception {
 		assertTrue(AddOn.isAddOn("test-alpha-1.zap"));
 	}
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testNotAddonNoState() throws Exception {
 		assertFalse(AddOn.isAddOn("test-1.zap"));
 	}
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testNotAddonBadExt() throws Exception {
 		assertFalse(AddOn.isAddOn("test-beta-1.zip"));
 	}
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testNotAddonBadStatus() throws Exception {
 		assertFalse(AddOn.isAddOn("test-xxx-1.zap"));
 	}
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testNotAddonBadVersion() throws Exception {
 		assertFalse(AddOn.isAddOn("test-beta-A.zap"));
 	}
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testId() throws Exception {
 		AddOn addOn = new AddOn("test-alpha-1.zap");
 		assertThat(addOn.getId(), is("test"));
 	}
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testStatus() throws Exception {
 		AddOn addOn = new AddOn("test-alpha-1.zap");
 		assertThat(addOn.getStatus().name(), is("alpha"));
 	}
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testVersion() throws Exception {
 		AddOn addOn = new AddOn("test-alpha-1.zap");
 		assertThat(addOn.getFileVersion(), is(1));
 	}
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testAlpha2UpdatesAlpha1() throws Exception {
 		AddOn addOnA1 = new AddOn("test-alpha-1.zap");
 		AddOn addOnA2 = new AddOn("test-alpha-2.zap");
@@ -94,6 +114,7 @@ public class AddOnUnitTest {
 	}
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testAlpha1DoesNotUpdateAlpha2() throws Exception {
 		AddOn addOnA1 = new AddOn("test-alpha-1.zap");
 		AddOn addOnA2 = new AddOn("test-alpha-2.zap");
@@ -101,6 +122,7 @@ public class AddOnUnitTest {
 	}
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testAlpha2UpdatesBeta1() throws Exception {
 		AddOn addOnB1 = new AddOn("test-beta-1.zap");
 		AddOn addOnA2 = new AddOn("test-alpha-2.zap");
@@ -108,6 +130,7 @@ public class AddOnUnitTest {
 	}
 
 	@Test(expected = IllegalArgumentException.class)
+	@SuppressWarnings("deprecation")
 	public void testAlpha2DoesNotUpdateTestyAlpha1() throws Exception {
 		// Given 
 		AddOn addOnA1 = new AddOn("test-alpha-1.zap");
@@ -118,6 +141,7 @@ public class AddOnUnitTest {
 	}
 	
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testCanLoadAddOnNotBefore() throws Exception {
 		AddOn ao = new AddOn("test-alpha-1.zap");
 		ao.setNotBeforeVersion("2.4.0");
@@ -131,6 +155,7 @@ public class AddOnUnitTest {
 	}
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testCanLoadAddOnNotFrom() throws Exception {
 		AddOn ao = new AddOn("test-alpha-1.zap");
 		ao.setNotBeforeVersion("2.4.0");
@@ -144,6 +169,7 @@ public class AddOnUnitTest {
 	}
 
 	@Test
+	@SuppressWarnings("deprecation")
 	public void testCanLoadAddOnNotBeforeNotFrom() throws Exception {
 		AddOn ao = new AddOn("test-alpha-1.zap");
 		ao.setNotBeforeVersion("2.4.0");
@@ -157,7 +183,169 @@ public class AddOnUnitTest {
 		assertFalse(ao.canLoadInVersion("2.8.0"));
 		
 	}
+	
+	@Test
+	public void shouldNotBeAddOnFileNameIfNull() throws Exception {
+		// Given
+		String fileName = null;
+		// When
+		boolean addOnFileName = AddOn.isAddOnFileName(fileName);
+		// Then
+		assertThat(addOnFileName, is(equalTo(false)));
+	}
+
+	@Test
+	public void shouldNotBeAddOnFileNameIfNotEndsWithZapExtension() throws Exception {
+		// Given
+		String fileName = "addon.txt";
+		// When
+		boolean addOnFileName = AddOn.isAddOnFileName(fileName);
+		// Then
+		assertThat(addOnFileName, is(equalTo(false)));
+	}
+
+	@Test
+	public void shouldBeAddOnFileNameIfEndsWithZapExtension() throws Exception {
+		// Given
+		String fileName = "addon.zap";
+		// When
+		boolean addOnFileName = AddOn.isAddOnFileName(fileName);
+		// Then
+		assertThat(addOnFileName, is(equalTo(true)));
+	}
+
+	@Test
+	public void shouldBeAddOnFileNameEvenIfZapExtensionIsUpperCase() throws Exception {
+		// Given
+		String fileName = "addon.ZAP";
+		// When
+		boolean addOnFileName = AddOn.isAddOnFileName(fileName);
+		// Then
+		assertThat(addOnFileName, is(equalTo(true)));
+	}
+
+	@Test
+	public void shouldNotBeAddOnIfPathIsNull() throws Exception {
+		// Given
+		Path file = null;
+		// When
+		boolean addOnFile = AddOn.isAddOn(file);
+		// Then
+		assertThat(addOnFile, is(equalTo(false)));
+	}
+
+	@Test
+	public void shouldNotBeAddOnIfPathIsDirectory() throws Exception {
+		// Given
+		Path file = tempDir.newFolder("addon.zap").toPath();
+		// When
+		boolean addOnFile = AddOn.isAddOn(file);
+		// Then
+		assertThat(addOnFile, is(equalTo(false)));
+	}
+
+	@Test
+	public void shouldNotBeAddOnIfFileNameNotEndsWithZapExtension() throws Exception {
+		// Given
+		Path file = createAddOnFile("addon.txt", "alpha", "1");
+		// When
+		boolean addOnFile = AddOn.isAddOn(file);
+		// Then
+		assertThat(addOnFile, is(equalTo(false)));
+	}
+
+	@Test
+	public void shouldNotBeAddOnIfAddOnDoesNotHaveManifestFile() throws Exception {
+		// Given
+		Path file = createEmptyAddOnFile("addon.zap");
+		// When
+		boolean addOnFile = AddOn.isAddOn(file);
+		// Then
+		assertThat(addOnFile, is(equalTo(false)));
+	}
 
+	@Test
+	public void shouldBeAddOnIfPathEndsWithZapExtension() throws Exception {
+		// Given
+		Path file = createAddOnFile("addon.zap", "alpha", "1");
+		// When
+		boolean addOnFile = AddOn.isAddOn(file);
+		// Then
+		assertThat(addOnFile, is(equalTo(true)));
+	}
+
+	@Test
+	public void shouldBeAddOnEvenIfZapExtensionIsUpperCase() throws Exception {
+		// Given
+		Path file = createAddOnFile("addon.ZAP", "alpha", "1");
+		// When
+		boolean addOnFile = AddOn.isAddOn(file);
+		// Then
+		assertThat(addOnFile, is(equalTo(true)));
+	}
+
+	@Test(expected = IOException.class)
+	public void shouldFailToCreateAddOnFromNullFile() throws Exception {
+		// Given
+		Path file = null;
+		// When
+		new AddOn(file);
+		// Then = IOException
+	}
+
+	@Test(expected = IOException.class)
+	public void shouldFailToCreateAddOnFromFileWithInvalidFileName() throws Exception {
+		// Given
+		String invalidFileName = "addon.txt";
+		Path file = createAddOnFile(invalidFileName, "alpha", "1");
+		// When
+		new AddOn(file);
+		// Then = IOException
+	}
+
+	@Test
+	public void shouldCreateAddOnFromFileAndUseManifestData() throws Exception {
+		// Given
+		Path file = createAddOnFile("addon.zap", "beta", "1");
+		// When
+		AddOn addOn = new AddOn(file);
+		// Then
+		assertThat(addOn.getId(), is(equalTo("addon")));
+		assertThat(addOn.getStatus(), is(equalTo(AddOn.Status.beta)));
+		assertThat(addOn.getFileVersion(), is(equalTo(1)));
+	}
+
+	@Test
+	public void shouldIgnoreStatusInFileNameWhenCreatingAddOnFromFile() throws Exception {
+		// Given
+		Path file = createAddOnFile("addon-alpha.zap", "release", "1");
+		// When
+		AddOn addOn = new AddOn(file);
+		// Then
+		assertThat(addOn.getStatus(), is(equalTo(AddOn.Status.release)));
+	}
+
+	@Test
+	public void shouldIgnoreVersionInFileNameWhenCreatingAddOnFromFile() throws Exception {
+		// Given
+		Path file = createAddOnFile("addon-alpha-2.zap", "alpha", "3");
+		// When
+		AddOn addOn = new AddOn(file);
+		// Then
+		assertThat(addOn.getFileVersion(), is(equalTo(3)));
+	}
+
+	@Test
+	public void shouldReturnNormalisedFileName() throws Exception {
+		// Given
+		Path file = createAddOnFile("addon.zap", "alpha", "2");
+		AddOn addOn = new AddOn(file);
+		// When
+		String normalisedFileName = addOn.getNormalisedFileName();
+		// Then
+		assertThat(normalisedFileName, is(equalTo("addon-2.zap")));
+	}
+	
 	@Test
 	public void shouldDependOnDependency() throws Exception {
 		// Given
@@ -173,7 +361,7 @@ public class AddOnUnitTest {
 	@Test
 	public void shouldNotDependIfNoDependencies() throws Exception {
 		// Given
-		AddOn addOn = new AddOn("AddOn-release-1.zap");
+		AddOn addOn = new AddOn(createAddOnFile("AddOn-release-1.zap", "release", "1"));
 		AddOn nonDependency = createAddOn("AddOn3", createZapVersionsXml());
 		// When
 		boolean depends = addOn.dependsOn(nonDependency);
@@ -265,6 +453,37 @@ public class AddOnUnitTest {
 		return zapVersionsXml;
 	}
 
+	private Path createEmptyAddOnFile(String fileName) {
+		try {
+			File file = tempDir.newFile(fileName);
+			new ZipOutputStream(new FileOutputStream(file)).close();
+			return file.toPath();
+		} catch (IOException e) {
+			throw new RuntimeException(e);
+		}
+	}
+
+	private Path createAddOnFile(String fileName, String status, String version) {
+		try {
+			File file = tempDir.newFile(fileName);
+			try (ZipOutputStream zos = new ZipOutputStream(new FileOutputStream(file))) {
+				ZipEntry manifest = new ZipEntry(AddOn.MANIFEST_FILE_NAME);
+				zos.putNextEntry(manifest);
+				StringBuilder strBuilder = new StringBuilder(150);
+				strBuilder.append("<zapaddon>");
+				strBuilder.append("<version>").append(version).append("</version>");
+				strBuilder.append("<status>").append(status).append("</status>");
+				strBuilder.append("</zapaddon>");
+				byte[] bytes = strBuilder.toString().getBytes(StandardCharsets.UTF_8);
+				zos.write(bytes, 0, bytes.length);
+				zos.closeEntry();
+			}
+			return file.toPath();
+		} catch (IOException e) {
+			throw new RuntimeException(e);
+		}
+	}
+	
 	protected static AddOn createAddOn(String addOnId, ZapXmlConfiguration zapVersions) throws Exception {
 		return new AddOn(addOnId, Paths.get("").toFile(), zapVersions.configurationAt("addon_" + addOnId));
 	}
