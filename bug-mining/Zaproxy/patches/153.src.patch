diff --git a/src/lang/Messages.properties b/src/lang/Messages.properties
index 08ec0d2c5..4677adbf9 100644
--- a/src/lang/Messages.properties
+++ b/src/lang/Messages.properties
@@ -194,7 +194,9 @@ ascan.options.level.high.label = (Fewer potential issues flagged)
 ascan.options.maxChart.label	= Max progress chart in mins:
 ascan.options.maxChart.tooltip  = Displaying very large charts may cause memory problems. Set to zero to disable the charting 
 ascan.options.maxRes.label	   = Max results to list:
-ascan.options.maxRes.tooltip   = Displaying a large number of results can significantly increase the time a scan takes 
+ascan.options.maxRes.tooltip   = Displaying a large number of results can significantly increase the time a scan takes
+ascan.options.maxRule.label		= Maximum rule duration (min, 0 is unlimited): 
+ascan.options.maxScan.label		= Maximum scan duration (min, 0 is unlimited): 
 ascan.options.numHosts.label   = Number of hosts scanned concurrently:
 ascan.options.numThreads.label = Concurrent scanning threads per host:
 ascan.options.rules.label		= Rules
@@ -296,6 +298,8 @@ ascan.progress.label.skipped    = Skipped
 ascan.progress.label.skippedWithReason = Skipped, {0}.
 ascan.progress.label.skipped.reason.user = by user action
 ascan.progress.label.skipped.reason.techs = scanner does not target selected technologies
+ascan.progress.label.skipped.reason.maxRule = exceeded max rule time
+ascan.progress.label.skipped.reason.maxScan = exceeded max scan time
 ascan.progress.label.totals		= Totals
 ascan.progress.label.skipaction	= Skip current running active script
 ascan.progress.tab.chart		= Response Chart
diff --git a/src/org/parosproxy/paros/core/scanner/HostProcess.java b/src/org/parosproxy/paros/core/scanner/HostProcess.java
index 2a7a9ba43..1a3dab9fa 100644
--- a/src/org/parosproxy/paros/core/scanner/HostProcess.java
+++ b/src/org/parosproxy/paros/core/scanner/HostProcess.java
@@ -62,6 +62,7 @@
 // ZAP: 2016/09/20 - Reorder statements to prevent (potential) NullPointerException in scanSingleNode
 //                 - JavaDoc tweaks
 // ZAP: 2016/11/14 Restore and deprecate old constructor, to keep binary compatibility
+// ZAP: 2016/12/13 Issue 2951:  Support active scan rule and scan max duration
 
 package org.parosproxy.paros.core.scanner;
 
@@ -73,6 +74,7 @@ import java.util.Iterator;
 import java.util.List;
 import java.util.Map;
 import java.util.Set;
+import java.util.concurrent.TimeUnit;
 
 import org.apache.log4j.Logger;
 import org.parosproxy.paros.Constant;
@@ -108,6 +110,7 @@ public class HostProcess implements Runnable {
     private User user = null;
     private TechSet techSet;
     private RuleConfigParam ruleConfigParam;
+    private String stopReason = null;
 
     /**
      * A {@code Map} from plugin IDs to corresponding {@link PluginStats}.
@@ -475,6 +478,13 @@ public class HostProcess implements Runnable {
      * @return true if the process has been stopped
      */
     public boolean isStop() {
+        if (this.scannerParam.getMaxScanDurationInMins() > 0) {
+        	if (System.currentTimeMillis() - this.hostProcessStartTime > 
+        			TimeUnit.MINUTES.toMillis(this.scannerParam.getMaxScanDurationInMins())) {
+        	    this.stopReason = Constant.messages.getString("ascan.progress.label.skipped.reason.maxScan");
+        	    this.stop();
+            }
+        }
         return (isStop || parentScanner.isStop());
     }
     
@@ -633,10 +643,28 @@ public class HostProcess implements Runnable {
      */
     public boolean isSkipped(Plugin plugin) {
         PluginStats pluginStats = mapPluginStats.get(plugin.getId());
-        if (pluginStats == null) {
-            return false;
+
+        if (pluginStats != null && pluginStats.isSkipped()) {
+            return true;
+        }
+
+        if (plugin.getTimeFinished() == null && stopReason != null) {
+            this.pluginSkipped(plugin, stopReason);
+            return true;
+        
+        } else if (this.scannerParam.getMaxRuleDurationInMins() > 0 && plugin.getTimeStarted() != null) {
+        	long endtime = System.currentTimeMillis();
+        	if (plugin.getTimeFinished() != null) {
+        		endtime = plugin.getTimeFinished().getTime();
+        	}
+        	if (endtime - plugin.getTimeStarted().getTime() > 
+        			TimeUnit.MINUTES.toMillis(this.scannerParam.getMaxRuleDurationInMins())) {
+        	    this.pluginSkipped(plugin,
+        	            Constant.messages.getString("ascan.progress.label.skipped.reason.maxRule"));
+            	return true;
+            }
         }
-        return pluginStats.isSkipped();
+        return false;
     }
 
     /**
@@ -650,7 +678,7 @@ public class HostProcess implements Runnable {
     public String getSkippedReason(Plugin plugin) {
         PluginStats pluginStats = mapPluginStats.get(plugin.getId());
         if (pluginStats == null) {
-            return null;
+            return stopReason;
         }
         return pluginStats.getSkippedReason();
     }
diff --git a/src/org/parosproxy/paros/core/scanner/ScannerParam.java b/src/org/parosproxy/paros/core/scanner/ScannerParam.java
index 8e713809c..8df84ee75 100644
--- a/src/org/parosproxy/paros/core/scanner/ScannerParam.java
+++ b/src/org/parosproxy/paros/core/scanner/ScannerParam.java
@@ -41,6 +41,7 @@
 // ZAP: 2015/03/25 Issue 1573: Add option to inject plugin ID in header for all ascan requests
 // ZAP: 2015/10/01 Issue 1944:  Chart responses per second in ascan progress
 // ZAP: 2016/01/20 Issue 1959: Allow to active scan headers of all requests
+// ZAP: 2016/10/24 Issue 2951:  Support active scan rule and scan max duration
 
 package org.parosproxy.paros.core.scanner;
 
@@ -76,6 +77,9 @@ public class ScannerParam extends AbstractParam {
     private static final String ALLOW_ATTACK_ON_START = ACTIVE_SCAN_BASE_KEY + ".attackOnStart";
     private static final String MAX_CHART_TIME_IN_MINS = ACTIVE_SCAN_BASE_KEY + ".chartTimeInMins";
 
+    private static final String MAX_RULE_DURATION_IN_MINS = ACTIVE_SCAN_BASE_KEY + ".maxRuleDurationInMins";
+    private static final String MAX_SCAN_DURATION_IN_MINS = ACTIVE_SCAN_BASE_KEY + ".maxScanDurationInMins";
+
     // ZAP: Excluded Parameters
     private static final String EXCLUDED_PARAMS_KEY = ACTIVE_SCAN_BASE_KEY + ".excludedParameters";
     private static final String EXCLUDED_PARAM_NAME = "name";
@@ -131,6 +135,8 @@ public class ScannerParam extends AbstractParam {
     private String defaultPolicy;
     private String attackPolicy;
     private int maxChartTimeInMins = DEFAULT_MAX_CHART_TIME_IN_MINS;
+    private int maxRuleDurationInMins = 0;
+    private int maxScanDurationInMins = 0;
 
     // ZAP: Variants Configuration
     private int targetParamsInjectable = TARGET_INJECTABLE_DEFAULT;
@@ -183,6 +189,16 @@ public class ScannerParam extends AbstractParam {
         } catch (Exception e) {
         }
 
+        try {
+            this.maxRuleDurationInMins = getConfig().getInt(MAX_RULE_DURATION_IN_MINS, 0);
+        } catch (Exception e) {
+        }
+
+        try {
+            this.maxScanDurationInMins = getConfig().getInt(MAX_SCAN_DURATION_IN_MINS, 0);
+        } catch (Exception e) {
+        }
+
         try {
             this.maxScansInUI = getConfig().getInt(MAX_SCANS_IN_UI, 5);
         } catch (Exception e) {
@@ -407,7 +423,25 @@ public class ScannerParam extends AbstractParam {
         getConfig().setProperty(MAX_RESULTS_LIST, Integer.toString(this.maxResultsToList));
     }
 
-    /**
+    public int getMaxRuleDurationInMins() {
+		return maxRuleDurationInMins;
+	}
+
+	public void setMaxRuleDurationInMins(int maxRuleDurationInMins) {
+		this.maxRuleDurationInMins = maxRuleDurationInMins;
+        getConfig().setProperty(MAX_RULE_DURATION_IN_MINS, Integer.toString(this.maxRuleDurationInMins));
+	}
+
+	public int getMaxScanDurationInMins() {
+		return maxScanDurationInMins;
+	}
+
+	public void setMaxScanDurationInMins(int maxScanDurationInMins) {
+		this.maxScanDurationInMins = maxScanDurationInMins;
+        getConfig().setProperty(MAX_SCAN_DURATION_IN_MINS, Integer.toString(this.maxScanDurationInMins));
+	}
+
+	/**
      *
      * @param delayInMs
      */
diff --git a/src/org/zaproxy/zap/extension/ascan/ActiveScanAPI.java b/src/org/zaproxy/zap/extension/ascan/ActiveScanAPI.java
index b1543401d..077957ed4 100644
--- a/src/org/zaproxy/zap/extension/ascan/ActiveScanAPI.java
+++ b/src/org/zaproxy/zap/extension/ascan/ActiveScanAPI.java
@@ -34,6 +34,7 @@ import org.apache.commons.httpclient.URI;
 import org.apache.commons.httpclient.URIException;
 import org.apache.commons.lang.StringEscapeUtils;
 import org.apache.log4j.Logger;
+import org.parosproxy.paros.Constant;
 import org.parosproxy.paros.control.Control;
 import org.parosproxy.paros.core.scanner.Category;
 import org.parosproxy.paros.core.scanner.HostProcess;
@@ -634,7 +635,17 @@ public class ActiveScanAPI extends ApiImplementor {
 					for (Plugin plugin : hp.getCompleted()) {
 						long timeTaken = plugin.getTimeFinished().getTime() - plugin.getTimeStarted().getTime();
 						int reqs = hp.getPluginRequestCount(plugin.getId());
-						hpList.addItem(createPluginProgressEntry(plugin, "Complete", timeTaken, reqs));
+						if (hp.isSkipped(plugin)) {
+						    String skippedReason = hp.getSkippedReason(plugin);
+						    if (skippedReason == null) {
+						        skippedReason = Constant.messages.getString("ascan.progress.label.skipped");
+						    } else {
+						        skippedReason = Constant.messages.getString("ascan.progress.label.skippedWithReason", skippedReason);
+						    }
+							hpList.addItem(createPluginProgressEntry(plugin, skippedReason, timeTaken, reqs));
+						} else {
+							hpList.addItem(createPluginProgressEntry(plugin, "Complete", timeTaken, reqs));
+						}
 			        }
 
 			        for (Plugin plugin : hp.getRunning()) {
@@ -650,7 +661,17 @@ public class ActiveScanAPI extends ApiImplementor {
 			        }
 
 			        for (Plugin plugin : hp.getPending()) {
-						hpList.addItem(createPluginProgressEntry(plugin, "Pending", 0, 0));
+						if (hp.isSkipped(plugin)) {
+                            String skippedReason = hp.getSkippedReason(plugin);
+                            if (skippedReason == null) {
+                                skippedReason = Constant.messages.getString("ascan.progress.label.skipped");
+                            } else {
+                                skippedReason = Constant.messages.getString("ascan.progress.label.skippedWithReason", skippedReason);
+                            }
+                            hpList.addItem(createPluginProgressEntry(plugin, skippedReason, 0, 0));
+						} else {
+							hpList.addItem(createPluginProgressEntry(plugin, "Pending", 0, 0));
+						}
 			        }
 					resultList.addItem(hpList);
 
diff --git a/src/org/zaproxy/zap/extension/ascan/OptionsScannerPanel.java b/src/org/zaproxy/zap/extension/ascan/OptionsScannerPanel.java
index 3be44bf3c..e44001a84 100644
--- a/src/org/zaproxy/zap/extension/ascan/OptionsScannerPanel.java
+++ b/src/org/zaproxy/zap/extension/ascan/OptionsScannerPanel.java
@@ -52,6 +52,8 @@ public class OptionsScannerPanel extends AbstractParamPanel {
     private JSlider sliderDelayInMs = null;
     private JLabel labelThreadsPerHostValue = null;
     private JLabel labelDelayInMsValue = null;
+    private ZapNumberSpinner spinnerMaxRuleDuration = null;
+    private ZapNumberSpinner spinnerMaxScanDuration = null;
     private ZapNumberSpinner spinnerMaxResultsList = null;
     private JCheckBox chkInjectPluginIdInHeader = null;
     private JCheckBox chkHandleAntiCrsfTokens = null;
@@ -90,67 +92,79 @@ public class OptionsScannerPanel extends AbstractParamPanel {
             panelScanner.setLayout(new GridBagLayout());
             panelScanner.setName("");
 
+            int row = 0;
             panelScanner.add(new JLabel(Constant.messages.getString("ascan.options.numHosts.label")),
-                    LayoutHelper.getGBC(0, 0, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL));
+                    LayoutHelper.getGBC(0, row++, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL));
             panelScanner.add(getSliderHostPerScan(),
-                    LayoutHelper.getGBC(0, 1, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+                    LayoutHelper.getGBC(0, row++, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
             
             panelScanner.add(new JLabel(Constant.messages.getString("ascan.options.numThreads.label")),
-                    LayoutHelper.getGBC(0, 2, 2, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+                    LayoutHelper.getGBC(0, row, 2, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
             panelScanner.add(getLabelThreadsPerHostValue(),
-                    LayoutHelper.getGBC(2, 2, 1, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+                    LayoutHelper.getGBC(2, row++, 1, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
             panelScanner.add(getSliderThreadsPerHost(),
-                    LayoutHelper.getGBC(0, 3, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
-            
+                    LayoutHelper.getGBC(0, row++, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+
             panelScanner.add(new JLabel(Constant.messages.getString("ascan.options.maxRes.label")),
-                    LayoutHelper.getGBC(0, 4, 1, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+                    LayoutHelper.getGBC(0, row, 1, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
             panelScanner.add(this.getSpinnerMaxResultsList(),
-                    LayoutHelper.getGBC(1, 4, 2, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+                    LayoutHelper.getGBC(1, row++, 2, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+
+            panelScanner.add(new JLabel(Constant.messages.getString("ascan.options.maxRule.label")),
+                    LayoutHelper.getGBC(0, row, 1, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+            panelScanner.add(this.getSpinnerMaxRuleDuration(),
+                    LayoutHelper.getGBC(1, row++, 2, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+
+            panelScanner.add(new JLabel(Constant.messages.getString("ascan.options.maxScan.label")),
+                    LayoutHelper.getGBC(0, row, 1, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+            panelScanner.add(this.getSpinnerMaxScanDuration(),
+                    LayoutHelper.getGBC(1, row++, 2, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+
 
             panelScanner.add(new JLabel(Constant.messages.getString("ascan.options.delayInMs.label")),
-                    LayoutHelper.getGBC(0, 5, 2, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+                    LayoutHelper.getGBC(0, row, 2, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
             panelScanner.add(getLabelDelayInMsValue(),
-                    LayoutHelper.getGBC(2, 5, 1, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+                    LayoutHelper.getGBC(2, row++, 1, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
             panelScanner.add(getSliderDelayInMs(),
-                    LayoutHelper.getGBC(0, 6, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+                    LayoutHelper.getGBC(0, row++, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
             
             // Add checkboxes for Active scan configuration
             // ---------------------------------------------            
             panelScanner.add(getChkInjectPluginIdInHeader(),
-            		LayoutHelper.getGBC(0, 7, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2))); 
+            		LayoutHelper.getGBC(0, row++, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2))); 
             panelScanner.add(getChkHandleAntiCSRFTokens(),
-                    LayoutHelper.getGBC(0, 8, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2)));
+                    LayoutHelper.getGBC(0, row++, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2)));
 
             panelScanner.add(this.getChkPromptInAttackMode(),
-                    LayoutHelper.getGBC(0, 9, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2)));
+                    LayoutHelper.getGBC(0, row++, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2)));
             panelScanner.add(this.getChkRescanInAttackMode(),
-                    LayoutHelper.getGBC(0, 10, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2)));
+                    LayoutHelper.getGBC(0, row++, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2)));
 
 
             // Add Attack settings section
             // ---------------------------------------------
             panelScanner.add(new JLabel(Constant.messages.getString("ascan.options.policy.ascan.label")),
-                    LayoutHelper.getGBC(0, 11, 1, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2)));
+                    LayoutHelper.getGBC(0, row, 1, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2)));
             panelScanner.add(getDefaultAscanPolicyPulldown(),
-                    LayoutHelper.getGBC(1, 11, 2, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2)));
+                    LayoutHelper.getGBC(1, row++, 2, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2)));
 
             panelScanner.add(new JLabel(Constant.messages.getString("ascan.options.policy.attack.label")),
-                    LayoutHelper.getGBC(0, 12, 1, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+                    LayoutHelper.getGBC(0, row, 1, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
             panelScanner.add(getDefaultAttackPolicyPulldown(),
-                    LayoutHelper.getGBC(1, 12, 2, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+                    LayoutHelper.getGBC(1, row++, 2, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
             panelScanner.add(this.getAllowAttackModeOnStart(),
-                    LayoutHelper.getGBC(0, 13, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2)));
+                    LayoutHelper.getGBC(0, row++, 3, 1.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(16, 2, 2, 2)));
 
             // Chart
             panelScanner.add(new JLabel(Constant.messages.getString("ascan.options.maxChart.label")),
-                    LayoutHelper.getGBC(0, 14, 1, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+                    LayoutHelper.getGBC(0, row, 1, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
             panelScanner.add(this.getSpinnerMaxChartTime(),
-                    LayoutHelper.getGBC(1, 14, 2, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
+                    LayoutHelper.getGBC(1, row++, 2, 0.0D, 0, GridBagConstraints.HORIZONTAL, new Insets(2, 2, 2, 2)));
 
             // Close Panel
             panelScanner.add(
                     new JLabel(), 
-                    LayoutHelper.getGBC(0, 30, 3, 1.0D, 1.0D, GridBagConstraints.BOTH));
+                    LayoutHelper.getGBC(0, row, 3, 1.0D, 1.0D, GridBagConstraints.BOTH));
         }
         
         return panelScanner;
@@ -191,6 +205,8 @@ public class OptionsScannerPanel extends AbstractParamPanel {
         getSliderDelayInMs().setValue(param.getDelayInMs());
         setLabelDelayInMsValue(param.getDelayInMs());
         getSpinnerMaxResultsList().setValue(param.getMaxResultsToList());
+        getSpinnerMaxRuleDuration().setValue(param.getMaxRuleDurationInMins());
+        getSpinnerMaxScanDuration().setValue(param.getMaxScanDurationInMins());
         getChkInjectPluginIdInHeader().setSelected(param.isInjectPluginIdInHeader());
         getChkHandleAntiCSRFTokens().setSelected(param.getHandleAntiCSRFTokens());
         getChkPromptInAttackMode().setSelected(param.isPromptInAttackMode());
@@ -218,6 +234,8 @@ public class OptionsScannerPanel extends AbstractParamPanel {
         param.setThreadPerHost(getSliderThreadsPerHost().getValue());
         param.setDelayInMs(getDelayInMs());
         param.setMaxResultsToList(this.getSpinnerMaxResultsList().getValue());
+        param.setMaxRuleDurationInMins(this.getSpinnerMaxRuleDuration().getValue());
+        param.setMaxScanDurationInMins(this.getSpinnerMaxScanDuration().getValue());
         param.setInjectPluginIdInHeader(getChkInjectPluginIdInHeader().isSelected());
         param.setHandleAntiCSRFTokens(getChkHandleAntiCSRFTokens().isSelected());
         param.setPromptInAttackMode(getChkPromptInAttackMode().isSelected());
@@ -350,6 +368,20 @@ public class OptionsScannerPanel extends AbstractParamPanel {
         return spinnerMaxResultsList;
     }
 
+    private ZapNumberSpinner getSpinnerMaxRuleDuration() {
+        if (spinnerMaxRuleDuration == null) {
+            spinnerMaxRuleDuration = new ZapNumberSpinner();
+        }
+        return spinnerMaxRuleDuration;
+    }
+
+    private ZapNumberSpinner getSpinnerMaxScanDuration() {
+        if (spinnerMaxScanDuration == null) {
+            spinnerMaxScanDuration = new ZapNumberSpinner();
+        }
+        return spinnerMaxScanDuration;
+    }
+
     private ZapNumberSpinner getSpinnerMaxChartTime() {
         if (spinnerMaxChartTime == null) {
             spinnerMaxChartTime = new ZapNumberSpinner();
