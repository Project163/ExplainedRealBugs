diff --git a/src/lang/Messages.properties b/src/lang/Messages.properties
index c586154c8..9bc126218 100644
--- a/src/lang/Messages.properties
+++ b/src/lang/Messages.properties
@@ -73,6 +73,7 @@ api.error.does_not_exist    = Does Not Exist
 api.error.href_not_found    = Message Not Found
 api.error.internal_error    = Internal Error
 api.error.missing_parameter = Missing Parameter
+api.error.mode_violation	= Operation not allowed for current mode
 api.error.no_implementor    = No Implementor
 api.error.no_access		    = No Access
 api.error.scan_in_progress  = Scan In Progress
@@ -843,6 +844,7 @@ core.api.action.loadSession = Loads the session with the given name. If a relati
 core.api.action.newSession = Creates a new session, optionally overwriting existing files. If a relative path is specified it will be resolved against the "session" directory in ZAP "home" dir.
 core.api.action.saveSession = Saves the session with the name supplied, optionally overwriting existing files. If a relative path is specified it will be resolved against the "session" directory in ZAP "home" dir.
 core.api.action.sendRequest = Sends the HTTP request, optionally following redirections. Returns the request sent and response received and followed redirections, if any.
+core.api.action.setMode = Sets the mode, which may be one of [safe, protect, standard, attack]
 core.api.action.shutdown = Shuts down ZAP
 core.api.other.messagesHar = Gets the HTTP messages sent through/by ZAP, in HAR format, optionally filtered by URL and paginated with 'start' position and 'count' of messages
 core.api.other.sendHarRequest = Sends the first HAR request entry, optionally following redirections. Returns, in HAR format, the request sent and response received and followed redirections, if any.
@@ -857,6 +859,7 @@ core.api.view.sites = Gets the sites accessed through/by ZAP (scheme and domain)
 core.api.view.urls = Gets the URLs accessed through/by ZAP
 core.api.view.message = Gets the HTTP message with the given ID. Returns the ID, request/response headers and bodies, cookies and note.
 core.api.view.messages = Gets the HTTP messages sent by ZAP, request and response, optionally filtered by URL and paginated with 'start' position and 'count' of messages
+core.api.view.mode = Gets the mode
 core.api.view.numberOfMessages = Gets the number of messages, optionally filtering by URL
 core.api.view.version = Gets ZAP version
 core.api.view.excludedFromProxy = Gets the regular expressions, applied to URLs, to exclude from the Proxy
diff --git a/src/org/zaproxy/zap/extension/api/ApiException.java b/src/org/zaproxy/zap/extension/api/ApiException.java
index 423a0ba57..a9924ee33 100644
--- a/src/org/zaproxy/zap/extension/api/ApiException.java
+++ b/src/org/zaproxy/zap/extension/api/ApiException.java
@@ -59,7 +59,11 @@ public class ApiException extends Exception {
 		 */
 		ILLEGAL_PARAMETER,
 		CONTEXT_NOT_FOUND,
-		USER_NOT_FOUND, URL_NOT_IN_CONTEXT, BAD_API_KEY, SCRIPT_NOT_FOUND, BAD_SCRIPT_FORMAT, NO_ACCESS};
+		USER_NOT_FOUND, URL_NOT_IN_CONTEXT, BAD_API_KEY, SCRIPT_NOT_FOUND, BAD_SCRIPT_FORMAT, NO_ACCESS,
+		/*
+		 * Indicates that the requested operation is not allowed in the current mode
+		 */
+		MODE_VIOLATION};
 	
 	private final Type type;
 	private final String detail;
diff --git a/src/org/zaproxy/zap/extension/api/ContextAPI.java b/src/org/zaproxy/zap/extension/api/ContextAPI.java
index cc3705bbc..0d44e11ad 100644
--- a/src/org/zaproxy/zap/extension/api/ContextAPI.java
+++ b/src/org/zaproxy/zap/extension/api/ContextAPI.java
@@ -112,7 +112,6 @@ public class ContextAPI extends ApiImplementor {
     public ApiResponse handleApiAction(String name, JSONObject params) throws ApiException {
         log.debug("handleApiAction " + name + " " + params.toString());
         
-        String contextName;
         Context context;
         TechSet techSet;
         String[] techNames;
@@ -121,7 +120,11 @@ public class ContextAPI extends ApiImplementor {
         
         switch(name) {
         case EXCLUDE_FROM_CONTEXT_REGEX:
-        	addExcludeToContext(getContext(params), params.getString(REGEX_PARAM));
+        	try {
+				addExcludeToContext(getContext(params), params.getString(REGEX_PARAM));
+			} catch (Exception e) {
+	            throw new ApiException(ApiException.Type.INTERNAL_ERROR, e.getMessage());
+			}
         	break;
         case INCLUDE_IN_CONTEXT_REGEX:
         	addIncludeToContext(getContext(params), params.getString(REGEX_PARAM));
@@ -216,8 +219,14 @@ public class ContextAPI extends ApiImplementor {
         return ApiResponseElement.OK;
     }
 
-    private void addExcludeToContext(Context context, String regex) {
-        context.addExcludeFromContextRegex(regex);
+    private void addExcludeToContext(Context context, String regex) throws Exception {
+    	List<String> incRegexes = new ArrayList<String>(context.getIncludeInContextRegexs());
+    	if (incRegexes.remove(regex)) {
+    		// Its already explicitly included, removing it from the include list is safer and more useful
+    		context.setIncludeInContextRegexs(incRegexes);
+    	} else {
+            context.addExcludeFromContextRegex(regex);
+    	}
         Model.getSingleton().getSession().saveContext(context);
     }
 
diff --git a/src/org/zaproxy/zap/extension/api/CoreAPI.java b/src/org/zaproxy/zap/extension/api/CoreAPI.java
index 10095c399..24d7f89ba 100644
--- a/src/org/zaproxy/zap/extension/api/CoreAPI.java
+++ b/src/org/zaproxy/zap/extension/api/CoreAPI.java
@@ -49,6 +49,7 @@ import org.bouncycastle.openssl.jcajce.JcaMiscPEMGenerator;
 import org.bouncycastle.util.io.pem.PemWriter;
 import org.parosproxy.paros.Constant;
 import org.parosproxy.paros.control.Control;
+import org.parosproxy.paros.control.Control.Mode;
 import org.parosproxy.paros.core.proxy.ProxyParam;
 import org.parosproxy.paros.core.scanner.Alert;
 import org.parosproxy.paros.db.DatabaseException;
@@ -70,6 +71,7 @@ import org.parosproxy.paros.network.HttpMessage;
 import org.parosproxy.paros.network.HttpRequestHeader;
 import org.parosproxy.paros.network.HttpSender;
 import org.parosproxy.paros.network.HttpStatusCode;
+import org.parosproxy.paros.view.View;
 import org.zaproxy.zap.extension.alert.ExtensionAlert;
 import org.zaproxy.zap.extension.dynssl.ExtensionDynSSL;
 import org.zaproxy.zap.model.SessionUtils;
@@ -103,6 +105,7 @@ public class CoreAPI extends ApiImplementor implements SessionListener {
 	private static final String ACTION_DELETE_ALL_ALERTS = "deleteAllAlerts";
 	private static final String ACTION_COLLECT_GARBAGE = "runGarbageCollection";
 	private static final String ACTION_CLEAR_STATS = "clearStats";
+	private static final String ACTION_SET_MODE = "setMode";
 	
 	private static final String VIEW_ALERT = "alert";
 	private static final String VIEW_ALERTS = "alerts";
@@ -112,6 +115,7 @@ public class CoreAPI extends ApiImplementor implements SessionListener {
 	private static final String VIEW_URLS = "urls";
 	private static final String VIEW_MESSAGE = "message";
 	private static final String VIEW_MESSAGES = "messages";
+	private static final String VIEW_MODE = "mode";
 	private static final String VIEW_NUMBER_OF_MESSAGES = "numberOfMessages";
 	private static final String VIEW_VERSION = "version";
 	private static final String VIEW_EXCLUDED_FROM_PROXY = "excludedFromProxy";
@@ -139,6 +143,7 @@ public class CoreAPI extends ApiImplementor implements SessionListener {
 	private static final String PARAM_REQUEST = "request";
 	private static final String PARAM_FOLLOW_REDIRECTS = "followRedirects";
 	private static final String PARAM_KEY_PREFIX = "keyPrefix";
+	private static final String PARAM_MODE = "mode";
 
     private SimpleDateFormat dateFormat = new SimpleDateFormat("yyyyMMdd-HHmmss");
 	private boolean savingSession = false;
@@ -152,6 +157,7 @@ public class CoreAPI extends ApiImplementor implements SessionListener {
 		this.addApiAction(new ApiAction(ACTION_CLEAR_EXCLUDED_FROM_PROXY));
 		this.addApiAction(new ApiAction(ACTION_EXCLUDE_FROM_PROXY, new String[] {PARAM_REGEX}));
 		this.addApiAction(new ApiAction(ACTION_SET_HOME_DIRECTORY, new String[] {PARAM_DIR}));
+		this.addApiAction(new ApiAction(ACTION_SET_MODE, new String[] {PARAM_MODE}));
 		this.addApiAction(new ApiAction(ACTION_GENERATE_ROOT_CA));
 		this.addApiAction(new ApiAction(
 				ACTION_SEND_REQUEST,
@@ -172,6 +178,7 @@ public class CoreAPI extends ApiImplementor implements SessionListener {
 		this.addApiView(new ApiView(VIEW_MESSAGES, null, 
 				new String[] {PARAM_BASE_URL, PARAM_START, PARAM_COUNT}));
 		this.addApiView(new ApiView(VIEW_NUMBER_OF_MESSAGES, null, new String[] { PARAM_BASE_URL }));
+		this.addApiView(new ApiView(VIEW_MODE));
 		this.addApiView(new ApiView(VIEW_VERSION));
 		this.addApiView(new ApiView(VIEW_EXCLUDED_FROM_PROXY));
 		this.addApiView(new ApiView(VIEW_HOME_DIRECTORY));
@@ -364,6 +371,17 @@ public class CoreAPI extends ApiImplementor implements SessionListener {
 			} else {
 				throw new ApiException(ApiException.Type.ILLEGAL_PARAMETER, PARAM_DIR);
 			}
+		} else if (ACTION_SET_MODE.equals(name)) {
+			try {
+				Mode mode = Mode.valueOf(params.getString(PARAM_MODE).toLowerCase());
+		    	if (View.isInitialised()) {
+	    			View.getSingleton().getMainFrame().getMainToolbarPanel().setMode(mode);
+		    	} else {
+	    			Control.getSingleton().setMode(mode);
+		    	}
+			} catch (Exception e) {
+				throw new ApiException(ApiException.Type.ILLEGAL_PARAMETER, PARAM_MODE);
+			}
 		} else if (ACTION_GENERATE_ROOT_CA.equals(name)) {
 			ExtensionDynSSL extDyn = (ExtensionDynSSL) 
 					Control.getSingleton().getExtensionLoader().getExtension(ExtensionDynSSL.EXTENSION_ID);
@@ -624,6 +642,8 @@ public class CoreAPI extends ApiImplementor implements SessionListener {
 					counter);
 
 			result = new ApiResponseElement(name, Integer.toString(counter.getCount()));
+		} else if (VIEW_MODE.equals(name)) {
+			result = new ApiResponseElement(name, Control.getSingleton().getMode().name());
 		} else if (VIEW_VERSION.equals(name)) {
 			result = new ApiResponseElement(name, Constant.PROGRAM_VERSION);
 		} else if (VIEW_EXCLUDED_FROM_PROXY.equals(name)) {
diff --git a/src/org/zaproxy/zap/extension/ascan/ActiveScanAPI.java b/src/org/zaproxy/zap/extension/ascan/ActiveScanAPI.java
index 901581b10..3d307939c 100644
--- a/src/org/zaproxy/zap/extension/ascan/ActiveScanAPI.java
+++ b/src/org/zaproxy/zap/extension/ascan/ActiveScanAPI.java
@@ -536,6 +536,24 @@ public class ActiveScanAPI extends ApiImplementor {
 			if (node == null) {
 				throw new ApiException(ApiException.Type.URL_NOT_FOUND);
 			}
+			
+			switch (Control.getSingleton().getMode()) {
+			case safe:
+				throw new ApiException(ApiException.Type.MODE_VIOLATION);
+			case protect:
+				if (!Model.getSingleton().getSession().isInScope(url.toString())) {
+					throw new ApiException(ApiException.Type.MODE_VIOLATION);
+				}
+				// No problem
+				break;
+			case standard:
+				// No problem
+				break;
+			case attack:
+				// No problem
+				break;
+			}
+			
 			Target target = new Target(node);
 			target.setRecurse(scanChildren);
 			target.setInScopeOnly(scanJustInScope);
diff --git a/src/org/zaproxy/zap/extension/ascan/ExtensionActiveScan.java b/src/org/zaproxy/zap/extension/ascan/ExtensionActiveScan.java
index b837be8ff..a6769e09c 100644
--- a/src/org/zaproxy/zap/extension/ascan/ExtensionActiveScan.java
+++ b/src/org/zaproxy/zap/extension/ascan/ExtensionActiveScan.java
@@ -146,22 +146,16 @@ public class ExtensionActiveScan extends ExtensionAdaptor implements
     }
     
     @Override
-    public void optionsLoaded() {
+    public void postInit() {
     	policyManager.init();
 
 		if (Control.getSingleton().getMode().equals(Mode.attack)) {
-			if (this.getScannerParam().isAllowAttackOnStart()) {
-		    	if ( ! View.isInitialised()) {
-		    		// Need to do this in daemon mode or the active scanner wont start
-		    		Control.getSingleton().setMode(Control.Mode.attack);
-		    	}
+			if (View.isInitialised() && ! this.getScannerParam().isAllowAttackOnStart()) {
+				// Disable attack mode for safeties sake (when running with the UI)
+	   			View.getSingleton().getMainFrame().getMainToolbarPanel().setMode(Mode.standard);
 			} else {
-				// Disable attack mode for safeties sake
-		    	if (View.isInitialised()) {
-	    			View.getSingleton().getMainFrame().getMainToolbarPanel().setMode(Mode.standard);
-		    	} else {
-	    			Control.getSingleton().setMode(Control.Mode.standard);
-		    	}
+				// Needed to make sure the attackModeScanner starts up
+				this.attackModeScanner.sessionModeChanged(Control.getSingleton().getMode());
 			}
 		}
     }
diff --git a/src/org/zaproxy/zap/extension/spider/SpiderAPI.java b/src/org/zaproxy/zap/extension/spider/SpiderAPI.java
index f8bc58ff9..6ff37e88e 100644
--- a/src/org/zaproxy/zap/extension/spider/SpiderAPI.java
+++ b/src/org/zaproxy/zap/extension/spider/SpiderAPI.java
@@ -340,6 +340,23 @@ public class SpiderAPI extends ApiImplementor {
 			target.setContext(context);
 		}
 		
+		switch (Control.getSingleton().getMode()) {
+		case safe:
+			throw new ApiException(ApiException.Type.MODE_VIOLATION);
+		case protect:
+			if (!Model.getSingleton().getSession().isInScope(url)) {
+				throw new ApiException(ApiException.Type.MODE_VIOLATION);
+			}
+			// No problem
+			break;
+		case standard:
+			// No problem
+			break;
+		case attack:
+			// No problem
+			break;
+		}
+		
 		List<Object> objs = new ArrayList<>(maxChildren > 0 ? 3 : 1);
 		objs.add(startURI);
 		if (maxChildren > 0) {
diff --git a/src/org/zaproxy/zap/model/Context.java b/src/org/zaproxy/zap/model/Context.java
index 97f5f745f..d54d10b09 100644
--- a/src/org/zaproxy/zap/model/Context.java
+++ b/src/org/zaproxy/zap/model/Context.java
@@ -21,6 +21,7 @@ package org.zaproxy.zap.model;
 
 import java.awt.EventQueue;
 import java.util.ArrayList;
+import java.util.Collections;
 import java.util.Enumeration;
 import java.util.LinkedList;
 import java.util.List;
@@ -280,7 +281,7 @@ public class Context {
 	}
 
 	public List<String> getIncludeInContextRegexs() {
-		return includeInRegexs;
+		return Collections.unmodifiableList(includeInRegexs);
 	}
 
 	private void checkRegexs(List<String> regexs) throws Exception {
@@ -336,7 +337,7 @@ public class Context {
 	}
 
 	public List<String> getExcludeFromContextRegexs() {
-		return excludeFromRegexs;
+		return Collections.unmodifiableList(excludeFromRegexs);
 	}
 
 	public void setExcludeFromContextRegexs(List<String> excludeRegexs) throws Exception {
diff --git a/src/org/zaproxy/zap/view/MainToolbarPanel.java b/src/org/zaproxy/zap/view/MainToolbarPanel.java
index e22f8a771..fd6a31bdb 100644
--- a/src/org/zaproxy/zap/view/MainToolbarPanel.java
+++ b/src/org/zaproxy/zap/view/MainToolbarPanel.java
@@ -34,6 +34,7 @@ import javax.swing.JComboBox;
 import javax.swing.JPanel;
 import javax.swing.JToggleButton;
 import javax.swing.JToolBar;
+import javax.swing.SwingUtilities;
 import javax.swing.ToolTipManager;
 
 import org.apache.commons.configuration.ConfigurationException;
@@ -209,8 +210,13 @@ public class MainToolbarPanel extends JPanel {
 		return modeSelect;
 	}
 	
-	public void setMode (Mode mode) {
-		this.getModeSelect().setSelectedItem(Constant.messages.getString("view.toolbar.mode." + mode.name() + ".select"));
+	public void setMode (final Mode mode) {
+		SwingUtilities.invokeLater(new Runnable() {
+			@Override
+			public void run() {
+				getModeSelect().setSelectedItem(
+						Constant.messages.getString("view.toolbar.mode." + mode.name() + ".select"));
+			}});
 	}
 
 	private JButton getBtnNew() {
