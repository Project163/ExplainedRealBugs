diff --git a/src/org/zaproxy/zap/model/Context.java b/src/org/zaproxy/zap/model/Context.java
index c7b1a0eca..1d5765d57 100644
--- a/src/org/zaproxy/zap/model/Context.java
+++ b/src/org/zaproxy/zap/model/Context.java
@@ -551,8 +551,8 @@ public class Context {
 		// log.debug("checkNode " + sn.getHierarchicNodeName());		// Useful for debugging
 		int origChildren = sn.getChildCount();
 		int movedChildren = 0;
-		for (int i=origChildren; i > 0; i--) {
-			if (checkNode((SiteNode)sn.getChildAt(i-1))) {
+		for (SiteNode childNode : getChildren(sn)) {
+			if (checkNode(childNode)) {
 				movedChildren++;
 			}
 		}
@@ -594,6 +594,25 @@ public class Context {
 		
 	}
 
+	/**
+	 * Gets the child nodes of the given site node.
+	 *
+	 * @param siteNode the site node that will be used, must not be {@code null}
+	 * @return a {@code List} with the child nodes, never {@code null}
+	 */
+	private List<SiteNode> getChildren(SiteNode siteNode) {
+		int childCount = siteNode.getChildCount();
+		if (childCount == 0) {
+			return Collections.emptyList();
+		}
+
+		List<SiteNode> children = new ArrayList<>(childCount);
+		for (int i = 0; i < childCount; i++) {
+			children.add((SiteNode) siteNode.getChildAt(i));
+		}
+		return children;
+	}
+
 	private void moveNode (SiteMap sitesTree, SiteNode sn) {
 		List<Alert> alerts = sn.getAlerts();
 		
