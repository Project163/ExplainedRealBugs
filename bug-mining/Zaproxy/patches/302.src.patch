diff --git a/src/lang/Messages.properties b/src/lang/Messages.properties
index 2d8eeb59d..0aed0f173 100644
--- a/src/lang/Messages.properties
+++ b/src/lang/Messages.properties
@@ -470,7 +470,7 @@ authentication.panel.error.illegalPattern	= One of the patterns you have defined
 authentication.popup.indicator.loggedIn 	= {0} : Authentication Logged-in indicator
 authentication.popup.indicator.loggedOut 	= {0} : Authentication Logged-out indicator
 authentication.panel.label.configTitle		= Configure Authentication Method
-authentication.dialog.confirmChange.label	= Changing the Authentication Method will remove any Users defined for this Context. Are you sure?
+authentication.dialog.confirmChange.label	= Changing the Authentication Method will reset the Users' credentials defined for this Context. Are you sure?
 authentication.dialog.confirmChange.title	= Change Authentication Method
 authentication.output.indicatorsNotSet		= No indicators have been set for identifying authentication. Assuming response is authenticated for {0}.
 authentication.output.failure				= Authentication failure: {0}
diff --git a/src/org/zaproxy/zap/authentication/AuthenticationMethodType.java b/src/org/zaproxy/zap/authentication/AuthenticationMethodType.java
index eda60cb6b..9a9ef1029 100644
--- a/src/org/zaproxy/zap/authentication/AuthenticationMethodType.java
+++ b/src/org/zaproxy/zap/authentication/AuthenticationMethodType.java
@@ -23,13 +23,11 @@ import net.sf.json.JSONObject;
 
 import org.apache.commons.configuration.Configuration;
 import org.apache.commons.configuration.ConfigurationException;
-import org.parosproxy.paros.control.Control;
 import org.parosproxy.paros.db.DatabaseException;
 import org.parosproxy.paros.extension.ExtensionHook;
 import org.parosproxy.paros.model.Session;
 import org.zaproxy.zap.extension.api.ApiAction;
 import org.zaproxy.zap.extension.api.ApiDynamicActionImplementor;
-import org.zaproxy.zap.extension.users.ExtensionUserManagement;
 import org.zaproxy.zap.model.Context;
 import org.zaproxy.zap.users.User;
 
@@ -184,6 +182,14 @@ public abstract class AuthenticationMethodType {
 	 */
 	public abstract AuthenticationCredentials createAuthenticationCredentials();
 
+	/**
+	 * Gets the type of the authentication credentials that this authentication method creates.
+	 *
+	 * @return the type of the authentication credentials, should not be {@code null}.
+	 * @since TODO version
+	 */
+	public abstract Class<? extends AuthenticationCredentials> getAuthenticationCredentialsType();
+
 	/**
 	 * Gets the {@link ApiAction} that can be used to set an authentication method of this type for
 	 * a context.
@@ -191,11 +197,6 @@ public abstract class AuthenticationMethodType {
 	 * This api action will be handled by executing the
 	 * {@link ApiDynamicActionImplementor#handleAction(JSONObject)} method.
 	 * </p>
-	 * <p>
-	 * In the {@link ApiDynamicActionImplementor#handleAction(JSONObject)} method, if the new type
-	 * of method differs from the current type of method, a call should be made to
-	 * {@link #apiChangedAuthenticationMethodForContext(int)} to make sure changes are propagated.
-	 * </p>
 	 * 
 	 * @return the api action, or null if there is no way to set this method type through the API
 	 */
@@ -213,25 +214,6 @@ public abstract class AuthenticationMethodType {
 	 */
 	public abstract ApiDynamicActionImplementor getSetCredentialsForUserApiAction();
 
-	/**
-	 * Called when the authentication method for a context is changed through an API call.
-	 * <p>
-	 * Makes sure the Users are wiped so the authentication credentials for them match the Method.
-	 * </p>
-	 * 
-	 * @param contextId the context id
-	 */
-	protected static void apiChangedAuthenticationMethodForContext(int contextId) {
-		// Make sure the Users are wiped so the authentication credentials for them match the
-		// Method.
-		ExtensionUserManagement usersExtension = Control.getSingleton().getExtensionLoader().getExtension(ExtensionUserManagement.class);
-		if (usersExtension != null) {
-			if (usersExtension.getContextUserAuthManager(contextId).getUsers().size() > 0) {
-				usersExtension.removeContextUsers(contextId);
-			}
-		}
-	}
-
 	@Override
 	public int hashCode() {
 		return getUniqueIdentifier();
diff --git a/src/org/zaproxy/zap/authentication/HttpAuthenticationMethodType.java b/src/org/zaproxy/zap/authentication/HttpAuthenticationMethodType.java
index 996620edc..8972e6005 100644
--- a/src/org/zaproxy/zap/authentication/HttpAuthenticationMethodType.java
+++ b/src/org/zaproxy/zap/authentication/HttpAuthenticationMethodType.java
@@ -327,6 +327,11 @@ public class HttpAuthenticationMethodType extends AuthenticationMethodType {
 		return new UsernamePasswordAuthenticationCredentials();
 	}
 
+	@Override
+	public Class<UsernamePasswordAuthenticationCredentials> getAuthenticationCredentialsType() {
+		return UsernamePasswordAuthenticationCredentials.class;
+	}
+
 	@Override
 	public ApiDynamicActionImplementor getSetMethodForContextApiAction() {
 		return new ApiDynamicActionImplementor(API_METHOD_NAME, new String[] { PARAM_HOSTNAME, PARAM_REALM },
@@ -355,8 +360,6 @@ public class HttpAuthenticationMethodType extends AuthenticationMethodType {
 						throw new ApiException(ApiException.Type.ILLEGAL_PARAMETER, PARAM_PORT);
 					}
 
-				if (!context.getAuthenticationMethod().isSameType(method))
-					apiChangedAuthenticationMethodForContext(context.getIndex());
 				context.setAuthenticationMethod(method);
 
 			}
diff --git a/src/org/zaproxy/zap/authentication/ManualAuthenticationMethodType.java b/src/org/zaproxy/zap/authentication/ManualAuthenticationMethodType.java
index 5b4c09c20..62a2f7f97 100644
--- a/src/org/zaproxy/zap/authentication/ManualAuthenticationMethodType.java
+++ b/src/org/zaproxy/zap/authentication/ManualAuthenticationMethodType.java
@@ -379,6 +379,11 @@ public class ManualAuthenticationMethodType extends AuthenticationMethodType {
 		return new ManualAuthenticationCredentials();
 	}
 
+	@Override
+	public Class<ManualAuthenticationCredentials> getAuthenticationCredentialsType() {
+		return ManualAuthenticationCredentials.class;
+	}
+
 	public static ManualAuthenticationCredentials createAuthenticationCredentials(HttpSession session) {
 		ManualAuthenticationCredentials c = new ManualAuthenticationCredentials();
 		c.setSelectedSession(session);
@@ -397,9 +402,6 @@ public class ManualAuthenticationMethodType extends AuthenticationMethodType {
 			public void handleAction(JSONObject params) throws ApiException {
 				Context context = ApiUtils.getContextByParamId(params, AuthenticationAPI.PARAM_CONTEXT_ID);
 				ManualAuthenticationMethod method = createAuthenticationMethod(context.getIndex());
-				if (!context.getAuthenticationMethod().isSameType(method)) {
-					apiChangedAuthenticationMethodForContext(context.getIndex());
-				}
 				context.setAuthenticationMethod(method);
 			}
 		};
diff --git a/src/org/zaproxy/zap/authentication/PostBasedAuthenticationMethodType.java b/src/org/zaproxy/zap/authentication/PostBasedAuthenticationMethodType.java
index 768a0e590..01e33e3f1 100644
--- a/src/org/zaproxy/zap/authentication/PostBasedAuthenticationMethodType.java
+++ b/src/org/zaproxy/zap/authentication/PostBasedAuthenticationMethodType.java
@@ -1031,6 +1031,11 @@ public abstract class PostBasedAuthenticationMethodType extends AuthenticationMe
 		return new UsernamePasswordAuthenticationCredentials();
 	}
 
+	@Override
+	public Class<UsernamePasswordAuthenticationCredentials> getAuthenticationCredentialsType() {
+		return UsernamePasswordAuthenticationCredentials.class;
+	}
+
 	/* API related constants and methods. */
 	private static final String PARAM_LOGIN_URL = "loginUrl";
 	private static final String PARAM_LOGIN_REQUEST_DATA = "loginRequestData";
@@ -1070,8 +1075,6 @@ public abstract class PostBasedAuthenticationMethodType extends AuthenticationMe
 					throw new ApiException(ApiException.Type.INTERNAL_ERROR, e.getMessage());
 				}
 
-				if (!context.getAuthenticationMethod().isSameType(method))
-					apiChangedAuthenticationMethodForContext(context.getIndex());
 				context.setAuthenticationMethod(method);
 			}
 		};
diff --git a/src/org/zaproxy/zap/authentication/ScriptBasedAuthenticationMethodType.java b/src/org/zaproxy/zap/authentication/ScriptBasedAuthenticationMethodType.java
index 7b799b3f5..5eb92b952 100644
--- a/src/org/zaproxy/zap/authentication/ScriptBasedAuthenticationMethodType.java
+++ b/src/org/zaproxy/zap/authentication/ScriptBasedAuthenticationMethodType.java
@@ -647,6 +647,11 @@ public class ScriptBasedAuthenticationMethodType extends AuthenticationMethodTyp
 		return new GenericAuthenticationCredentials(new String[0]);
 	}
 
+	@Override
+	public Class<GenericAuthenticationCredentials> getAuthenticationCredentialsType() {
+		return GenericAuthenticationCredentials.class;
+	}
+
 	private ExtensionScript getScriptsExtension() {
 		if (extensionScript == null)
 			extensionScript = Control.getSingleton().getExtensionLoader().getExtension(ExtensionScript.class);
@@ -801,10 +806,6 @@ public class ScriptBasedAuthenticationMethodType extends AuthenticationMethodTyp
 					throw new ApiException(ApiException.Type.BAD_SCRIPT_FORMAT, e.getMessage());
 				}
 
-				// Set the method, making sure that, if the type is different, things are changed
-				// accordingly
-				if (!context.getAuthenticationMethod().isSameType(method))
-					apiChangedAuthenticationMethodForContext(context.getIndex());
 				context.setAuthenticationMethod(method);
 			}
 		};
diff --git a/src/org/zaproxy/zap/extension/authentication/AuthenticationAPI.java b/src/org/zaproxy/zap/extension/authentication/AuthenticationAPI.java
index 6fcc72814..d02d799d3 100644
--- a/src/org/zaproxy/zap/extension/authentication/AuthenticationAPI.java
+++ b/src/org/zaproxy/zap/extension/authentication/AuthenticationAPI.java
@@ -20,24 +20,28 @@
 package org.zaproxy.zap.extension.authentication;
 
 import java.util.HashMap;
+import java.util.List;
 import java.util.Map;
 import java.util.regex.Pattern;
 
 import net.sf.json.JSONObject;
 
 import org.apache.log4j.Logger;
+import org.parosproxy.paros.control.Control;
 import org.zaproxy.zap.authentication.AuthenticationMethodType;
 import org.zaproxy.zap.extension.api.API;
 import org.zaproxy.zap.extension.api.ApiAction;
 import org.zaproxy.zap.extension.api.ApiDynamicActionImplementor;
 import org.zaproxy.zap.extension.api.ApiException;
 import org.zaproxy.zap.extension.api.ApiException.Type;
+import org.zaproxy.zap.extension.users.ExtensionUserManagement;
 import org.zaproxy.zap.extension.api.ApiImplementor;
 import org.zaproxy.zap.extension.api.ApiResponse;
 import org.zaproxy.zap.extension.api.ApiResponseElement;
 import org.zaproxy.zap.extension.api.ApiResponseList;
 import org.zaproxy.zap.extension.api.ApiView;
 import org.zaproxy.zap.model.Context;
+import org.zaproxy.zap.users.User;
 import org.zaproxy.zap.utils.ApiUtils;
 
 /**
@@ -66,7 +70,7 @@ public class AuthenticationAPI extends ApiImplementor {
 	private static final String PARAM_METHOD_NAME = "authMethodName";
 	private static final String PARAM_METHOD_CONFIG_PARAMS = "authMethodConfigParams";
 
-	private Map<String, ApiDynamicActionImplementor> loadedAuthenticationMethodActions;
+	private Map<String, AuthMethodEntry> loadedAuthenticationMethodActions;
 
 	public AuthenticationAPI(ExtensionAuthentication extension) {
 		super();
@@ -83,7 +87,7 @@ public class AuthenticationAPI extends ApiImplementor {
 			for (AuthenticationMethodType t : extension.getAuthenticationMethodTypes()) {
 				ApiDynamicActionImplementor i = t.getSetMethodForContextApiAction();
 				if (i != null) {
-					loadedAuthenticationMethodActions.put(i.getName(), i);
+					loadedAuthenticationMethodActions.put(i.getName(), new AuthMethodEntry(t, i));
 				}
 			}
 		}
@@ -125,11 +129,11 @@ public class AuthenticationAPI extends ApiImplementor {
 				return new ApiResponseElement("logged_out_regex", "");
 		case VIEW_GET_SUPPORTED_METHODS:
 			ApiResponseList supportedMethods = new ApiResponseList("supportedMethods");
-			for (ApiDynamicActionImplementor a : loadedAuthenticationMethodActions.values())
-				supportedMethods.addItem(new ApiResponseElement("methodName", a.getName()));
+			for (AuthMethodEntry entry : loadedAuthenticationMethodActions.values())
+				supportedMethods.addItem(new ApiResponseElement("methodName", entry.getApi().getName()));
 			return supportedMethods;
 		case VIEW_GET_METHOD_CONFIG_PARAMETERS:
-			ApiDynamicActionImplementor a = getSetMethodActionImplementor(params);
+			ApiDynamicActionImplementor a = getSetMethodActionImplementor(params).getApi();
 			return a.buildParamsDescription();
 		default:
 			throw new ApiException(ApiException.Type.BAD_VIEW);
@@ -169,8 +173,11 @@ public class AuthenticationAPI extends ApiImplementor {
 				actionParams = new JSONObject();
 			context = getContext(params);
 			actionParams.put(PARAM_CONTEXT_ID, context.getIndex());
-			// Run the method
-			getSetMethodActionImplementor(params).handleAction(actionParams);
+
+			AuthenticationMethodType oldMethodType = context.getAuthenticationMethod().getType();
+			AuthMethodEntry authEntry = getSetMethodActionImplementor(params);
+			authEntry.getApi().handleAction(actionParams);
+			resetUsersCredentials(context.getIndex(), oldMethodType, authEntry.getMethodType());
 			context.save();
 			return ApiResponseElement.OK;
 		default:
@@ -179,6 +186,23 @@ public class AuthenticationAPI extends ApiImplementor {
 
 	}
 
+	private static void resetUsersCredentials(
+			int contextId,
+			AuthenticationMethodType oldMethod,
+			AuthenticationMethodType newMethod) {
+		ExtensionUserManagement usersExtension = Control.getSingleton().getExtensionLoader().getExtension(
+				ExtensionUserManagement.class);
+		if (usersExtension == null
+				|| oldMethod.getAuthenticationCredentialsType() == newMethod.getAuthenticationCredentialsType()) {
+			return;
+		}
+		List<User> users = usersExtension.getContextUserAuthManager(contextId).getUsers();
+		users.forEach(user -> {
+			user.setEnabled(false);
+			user.setAuthenticationCredentials(newMethod.createAuthenticationCredentials());
+		});
+	}
+
 	/**
 	 * Gets the sets the method action implementor or throws a Missing Parameter exception, if any
 	 * problems occurred.
@@ -187,8 +211,8 @@ public class AuthenticationAPI extends ApiImplementor {
 	 * @return the sets the method action implementor
 	 * @throws ApiException the api exception
 	 */
-	private ApiDynamicActionImplementor getSetMethodActionImplementor(JSONObject params) throws ApiException {
-		ApiDynamicActionImplementor a = loadedAuthenticationMethodActions.get(ApiUtils
+	private AuthMethodEntry getSetMethodActionImplementor(JSONObject params) throws ApiException {
+		AuthMethodEntry a = loadedAuthenticationMethodActions.get(ApiUtils
 				.getNonEmptyStringParam(params, PARAM_METHOD_NAME));
 		if (a == null)
 			throw new ApiException(Type.DOES_NOT_EXIST,
@@ -207,4 +231,26 @@ public class AuthenticationAPI extends ApiImplementor {
 		return ApiUtils.getContextByParamId(params, PARAM_CONTEXT_ID);
 	}
 
+	/**
+	 * An {@link AuthenticationMethodType} and its {@link ApiDynamicActionImplementor API}.
+	 */
+	private static class AuthMethodEntry {
+
+		private final AuthenticationMethodType methodType;
+		private final ApiDynamicActionImplementor api;
+
+		public AuthMethodEntry(AuthenticationMethodType methodType, ApiDynamicActionImplementor api) {
+			this.methodType = methodType;
+			this.api = api;
+		}
+
+		public AuthenticationMethodType getMethodType() {
+			return methodType;
+		}
+
+		public ApiDynamicActionImplementor getApi() {
+			return api;
+		}
+
+	}
 }
diff --git a/src/org/zaproxy/zap/extension/authentication/ContextAuthenticationPanel.java b/src/org/zaproxy/zap/extension/authentication/ContextAuthenticationPanel.java
index 382c5de16..073918158 100644
--- a/src/org/zaproxy/zap/extension/authentication/ContextAuthenticationPanel.java
+++ b/src/org/zaproxy/zap/extension/authentication/ContextAuthenticationPanel.java
@@ -25,6 +25,7 @@ import java.awt.GridBagLayout;
 import java.awt.Insets;
 import java.awt.event.ItemEvent;
 import java.awt.event.ItemListener;
+import java.util.List;
 import java.util.Vector;
 import java.util.regex.Pattern;
 import java.util.regex.PatternSyntaxException;
@@ -45,6 +46,7 @@ import org.zaproxy.zap.authentication.AuthenticationMethod;
 import org.zaproxy.zap.authentication.AuthenticationMethodType;
 import org.zaproxy.zap.extension.users.ExtensionUserManagement;
 import org.zaproxy.zap.model.Context;
+import org.zaproxy.zap.users.User;
 import org.zaproxy.zap.utils.FontUtils;
 import org.zaproxy.zap.utils.ZapTextField;
 import org.zaproxy.zap.view.AbstractContextPropertiesPanel;
@@ -205,17 +207,19 @@ public class ContextAuthenticationPanel extends AbstractContextPropertiesPanel {
 					if (e.getStateChange() == ItemEvent.SELECTED && !e.getItem().equals(shownMethodType)) {
 						log.debug("Selected new Authentication type: " + e.getItem());
 
-						if (needsConfirm && !confirmAndExecuteUsersDeletion()) {
-							log.debug("Cancelled change of authentication type.");
+						AuthenticationMethodType type = ((AuthenticationMethodType) e.getItem());
+						if (shownMethodType == null || type.getAuthenticationCredentialsType() != shownMethodType
+								.getAuthenticationCredentialsType()) {
+
+							if (needsConfirm && !confirmAndResetUsersCredentials(type)) {
+								log.debug("Cancelled change of authentication type.");
 
-							authenticationMethodsComboBox.setSelectedItem(shownMethodType);
-							return;
+								authenticationMethodsComboBox.setSelectedItem(shownMethodType);
+								return;
+							}
 						}
 						resetLoggedInOutIndicators();
 
-						// Prepare the new authentication method
-						AuthenticationMethodType type = ((AuthenticationMethodType) e.getItem());
-
 						// If no authentication method was previously selected or it's a different
 						// class, create a new authentication method object
 						if (selectedAuthenticationMethod == null
@@ -243,27 +247,37 @@ public class ContextAuthenticationPanel extends AbstractContextPropertiesPanel {
 	}
 
 	/**
-	 * Make sure the user acknowledges the Users corresponding to this context will be deleted.
+	 * Make sure the user acknowledges the Users corresponding to this context will have the credentials changed with the new
+	 * type of authentication method.
 	 * 
+	 * @param type the type of authentication method being set.
 	 * @return true, if successful
 	 */
-	private boolean confirmAndExecuteUsersDeletion() {
+	private boolean confirmAndResetUsersCredentials(AuthenticationMethodType type) {
 		ExtensionUserManagement usersExtension = Control.getSingleton().getExtensionLoader().getExtension(ExtensionUserManagement.class);
-		if (usersExtension != null) {
-			if (usersExtension.getSharedContextUsers(getUISharedContext()).size() > 0) {
-				authenticationMethodsComboBox.transferFocus();
-				int choice = JOptionPane.showConfirmDialog(this,
-						Constant.messages.getString("authentication.dialog.confirmChange.label"),
-						Constant.messages.getString("authentication.dialog.confirmChange.title"),
-						JOptionPane.OK_CANCEL_OPTION);
-				if (choice == JOptionPane.CANCEL_OPTION) {
-					return false;
-				}
-				// Removing the users from the 'shared context' (the UI) will cause their removal at
-				// save as well
-				usersExtension.removeSharedContextUsers(getUISharedContext());
+		if (usersExtension == null) {
+			return true;
+		}
+		List<User> users = usersExtension.getSharedContextUsers(getUISharedContext());
+		if (users.isEmpty()) {
+			return true;
+		}
+		if (users.stream().anyMatch(user -> user.getAuthenticationCredentials().isConfigured())) {
+			authenticationMethodsComboBox.transferFocus();
+			int choice = JOptionPane.showConfirmDialog(this,
+					Constant.messages.getString("authentication.dialog.confirmChange.label"),
+					Constant.messages.getString("authentication.dialog.confirmChange.title"),
+					JOptionPane.OK_CANCEL_OPTION);
+			if (choice == JOptionPane.CANCEL_OPTION) {
+				return false;
 			}
 		}
+		users.replaceAll(user -> {
+			User modifiedUser = new User(user.getContextId(), user.getName(), user.getId());
+			modifiedUser.setEnabled(false);
+			modifiedUser.setAuthenticationCredentials(type.createAuthenticationCredentials());
+			return modifiedUser;
+		});
 		return true;
 	}
 
