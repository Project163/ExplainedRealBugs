diff --git a/src/org/parosproxy/paros/common/FileXML.java b/src/org/parosproxy/paros/common/FileXML.java
index a96694d12..5e6e8808d 100644
--- a/src/org/parosproxy/paros/common/FileXML.java
+++ b/src/org/parosproxy/paros/common/FileXML.java
@@ -23,7 +23,7 @@
 // ZAP: 2013/01/23 Clean up of exception handling/logging.
 // ZAP: 2013/03/03 Issue 546: Remove all template Javadoc comments
 // ZAP: 2013/05/02 Re-arranged all modifiers into Java coding standard order
-// ZAP: 2015/08/19 Deprecated
+// ZAP: 2015/08/19 Deprecated; Issue 1804: Disable processing of XML external entities by default
 package org.parosproxy.paros.common;
 
 import java.io.File;
@@ -49,6 +49,7 @@ import org.w3c.dom.Node;
 import org.w3c.dom.NodeList;
 import org.xml.sax.InputSource;
 import org.xml.sax.SAXException;
+import org.zaproxy.zap.utils.XmlUtils;
 
 /**
  * @deprecated (TODO version) Use {@link org.zaproxy.zap.utils.ZapXmlConfiguration} instead.
@@ -64,9 +65,9 @@ public abstract class FileXML {
 	
 	public FileXML(String rootElementName) {
 
-		docBuilderFactory = DocumentBuilderFactory.newInstance();
 		String rootString = "<" + rootElementName + "></" + rootElementName + ">";
 		try {
+			docBuilderFactory = XmlUtils.newXxeDisabledDocumentBuilderFactory();
 			docBuilder = docBuilderFactory.newDocumentBuilder();
 			
 			doc = docBuilder.parse(new InputSource(new StringReader(rootString)));
@@ -229,7 +230,7 @@ public abstract class FileXML {
 		DocumentBuilder 		builder	= null;
 		
 		try {
-			factory = DocumentBuilderFactory.newInstance();
+			factory = XmlUtils.newXxeDisabledDocumentBuilderFactory();
 			factory.setValidating(false);
 			builder	= factory.newDocumentBuilder();
 			//builder.setErrorHandler(new ErrorHandler() {
diff --git a/src/org/parosproxy/paros/extension/report/ReportGenerator.java b/src/org/parosproxy/paros/extension/report/ReportGenerator.java
index bc40c2df3..db6f75083 100644
--- a/src/org/parosproxy/paros/extension/report/ReportGenerator.java
+++ b/src/org/parosproxy/paros/extension/report/ReportGenerator.java
@@ -21,6 +21,7 @@ Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
 // ZAP: 2012/08/07 synchronize calls on staticDateFormat
 // ZAP: 2013/01/23 Clean up of exception handling/logging.
 // ZAP: 2013/09/26 Issue 802: XML report generated by API differs from GUI report
+// ZAP: 2015/08/19 Issue 1804: Disable processing of XML external entities by default
 
 package org.parosproxy.paros.extension.report;
 
@@ -32,7 +33,6 @@ import java.text.SimpleDateFormat;
 import java.util.Date;
 
 import javax.xml.parsers.DocumentBuilder;
-import javax.xml.parsers.DocumentBuilderFactory;
 import javax.xml.parsers.ParserConfigurationException;
 import javax.xml.transform.OutputKeys;
 import javax.xml.transform.Transformer;
@@ -49,6 +49,7 @@ import org.w3c.dom.Element;
 import org.xml.sax.InputSource;
 import org.xml.sax.SAXException;
 import org.zaproxy.zap.utils.XMLStringUtil;
+import org.zaproxy.zap.utils.XmlUtils;
 
 public class ReportGenerator {
 
@@ -85,7 +86,6 @@ public class ReportGenerator {
 	}
 
 	public static File stringToHtml(String inxml, String infilexsl, String outfilename) {
-		DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
 		Document doc = null;
 
 		// factory.setNamespaceAware(true);
@@ -98,7 +98,7 @@ public class ReportGenerator {
 			stylesheet = new File(infilexsl);
 			outfile = new File(outfilename);
 
-			DocumentBuilder builder = factory.newDocumentBuilder();
+			DocumentBuilder builder = XmlUtils.newXxeDisabledDocumentBuilderFactory().newDocumentBuilder();
 			doc = builder.parse(new InputSource(inReader));
 
 			// Use a Transformer for output
@@ -120,7 +120,6 @@ public class ReportGenerator {
 	}
 
 	public static String stringToHtml(String inxml, String infilexsl) {
-		DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
 		Document doc = null;
 
 		// factory.setNamespaceAware(true);
@@ -132,7 +131,7 @@ public class ReportGenerator {
 		try {
 			stylesheet = new File(infilexsl);
 
-			DocumentBuilder builder = factory.newDocumentBuilder();
+			DocumentBuilder builder = XmlUtils.newXxeDisabledDocumentBuilderFactory().newDocumentBuilder();
 			doc = builder.parse(new InputSource(inReader));
 
 			// Use a Transformer for output
@@ -155,7 +154,6 @@ public class ReportGenerator {
 	}
 
 	public static File fileToHtml(String infilexml, String infilexsl, String outfilename) {
-		DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
 		Document doc = null;
 
 		// factory.setNamespaceAware(true);
@@ -169,7 +167,7 @@ public class ReportGenerator {
 			datafile = new File(infilexml);
 			outfile = new File(outfilename);
 
-			DocumentBuilder builder = factory.newDocumentBuilder();
+			DocumentBuilder builder = XmlUtils.newXxeDisabledDocumentBuilderFactory().newDocumentBuilder();
 			doc = builder.parse(datafile);
 
 			// Use a Transformer for output
diff --git a/src/org/zaproxy/zap/spider/parser/SpiderSVNEntriesParser.java b/src/org/zaproxy/zap/spider/parser/SpiderSVNEntriesParser.java
index b6b65124d..62c066b1a 100644
--- a/src/org/zaproxy/zap/spider/parser/SpiderSVNEntriesParser.java
+++ b/src/org/zaproxy/zap/spider/parser/SpiderSVNEntriesParser.java
@@ -32,7 +32,6 @@ import java.util.regex.Matcher;
 import java.util.regex.Pattern;
 
 import javax.xml.parsers.DocumentBuilder;
-import javax.xml.parsers.DocumentBuilderFactory;
 import javax.xml.parsers.ParserConfigurationException;
 
 import net.htmlparser.jericho.Source;
@@ -45,6 +44,7 @@ import org.w3c.dom.NodeList;
 import org.xml.sax.InputSource;
 import org.xml.sax.SAXException;
 import org.zaproxy.zap.spider.SpiderParam;
+import org.zaproxy.zap.utils.XmlUtils;
 
 /**
  * The Class SpiderSVNEntriesParser is used for parsing SVN metadata, inclusing SVN "entries" and "wc.db" files.
@@ -70,19 +70,15 @@ public class SpiderSVNEntriesParser extends SpiderParser {
 	/** The Spider parameters. */
 	private SpiderParam params;
 	
-	/** used to parse the XML based .svn/entries file format */ 
-	private static DocumentBuilderFactory dbFactory;
-	
 	/** used to parse the XML based .svn/entries file format */ 
 	private static DocumentBuilder dBuilder;
 
 	private Pattern SVN_ENTRIES_FILE_PATTERN = Pattern.compile("/\\.svn/entries$|/\\.svn/wc.db$");
 	
-	/** statically initialise the XML DocumentBuilderFactory and DocumentBuilder */
+	/** statically initialise the XML DocumentBuilder */
 	static {
-		dbFactory = DocumentBuilderFactory.newInstance();
 		try {
-			dBuilder = dbFactory.newDocumentBuilder();
+			dBuilder = XmlUtils.newXxeDisabledDocumentBuilderFactory().newDocumentBuilder();
 		} catch (ParserConfigurationException e) {
 			log.error(e);
 		}
diff --git a/src/org/zaproxy/zap/spider/parser/SpiderSitemapXMLParser.java b/src/org/zaproxy/zap/spider/parser/SpiderSitemapXMLParser.java
index 851efa0b1..549372892 100644
--- a/src/org/zaproxy/zap/spider/parser/SpiderSitemapXMLParser.java
+++ b/src/org/zaproxy/zap/spider/parser/SpiderSitemapXMLParser.java
@@ -23,7 +23,6 @@ import java.util.regex.Matcher;
 import java.util.regex.Pattern;
 
 import javax.xml.parsers.DocumentBuilder;
-import javax.xml.parsers.DocumentBuilderFactory;
 import javax.xml.parsers.ParserConfigurationException;
 import javax.xml.xpath.XPath;
 import javax.xml.xpath.XPathConstants;
@@ -38,6 +37,7 @@ import org.w3c.dom.Document;
 import org.w3c.dom.NodeList;
 import org.xml.sax.InputSource;
 import org.zaproxy.zap.spider.SpiderParam;
+import org.zaproxy.zap.utils.XmlUtils;
 
 /**
  * SitemapXMLParser is used for parsing URLs from a sitemap.xml file, which sometimes (very helpfully) resides in the web root.
@@ -55,9 +55,6 @@ public class SpiderSitemapXMLParser extends SpiderParser {
 	/** The Spider parameters. */
 	private SpiderParam params;
 	
-	/** used to parse the XML based file format */ 
-	private static DocumentBuilderFactory dbFactory;
-	
 	/** used to parse the XML based file format */ 
 	private static DocumentBuilder dBuilder;
 	
@@ -68,9 +65,8 @@ public class SpiderSitemapXMLParser extends SpiderParser {
 
 	/** statically initialise the XML DocumentBuilderFactory and DocumentBuilder */
 	static {		
-		dbFactory = DocumentBuilderFactory.newInstance();
 		try {
-			dBuilder = dbFactory.newDocumentBuilder();
+			dBuilder = XmlUtils.newXxeDisabledDocumentBuilderFactory().newDocumentBuilder();
 			XPath  xpath = (XPath) XPathFactory.newInstance().newXPath();
 			xpathLocationExpression = xpath.compile("/urlset/url/loc/text()");
 		} catch (ParserConfigurationException | XPathExpressionException e) {
diff --git a/src/org/zaproxy/zap/utils/XmlUtils.java b/src/org/zaproxy/zap/utils/XmlUtils.java
new file mode 100644
index 000000000..dff38a0e9
--- /dev/null
+++ b/src/org/zaproxy/zap/utils/XmlUtils.java
@@ -0,0 +1,50 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright 2015 The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.zaproxy.zap.utils;
+
+import javax.xml.parsers.DocumentBuilderFactory;
+import javax.xml.parsers.ParserConfigurationException;
+
+/**
+ * A class with utility methods related to XML parsing.
+ */
+public final class XmlUtils {
+
+    private XmlUtils() {
+    }
+
+    /**
+     * Returns a new {@code DocumentBuilderFactory} instance with XML External Entity (XXE) processing disabled.
+     *
+     * @return the new {@code DocumentBuilderFactory} instance with XXE processing disabled
+     * @throws ParserConfigurationException if an error occurred while disabling XXE processing
+     * @see DocumentBuilderFactory
+     */
+    public static DocumentBuilderFactory newXxeDisabledDocumentBuilderFactory() throws ParserConfigurationException {
+        // Disable XXE processing, not required by default.
+        // https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Processing
+        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
+        factory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
+        factory.setFeature("http://xml.org/sax/features/external-general-entities", false);
+        factory.setFeature("http://xml.org/sax/features/external-parameter-entities", false);
+        factory.setExpandEntityReferences(false);
+        return factory;
+    }
+}
diff --git a/src/org/zaproxy/zap/utils/ZapXmlConfiguration.java b/src/org/zaproxy/zap/utils/ZapXmlConfiguration.java
index 9f510cef5..a1b196dd8 100644
--- a/src/org/zaproxy/zap/utils/ZapXmlConfiguration.java
+++ b/src/org/zaproxy/zap/utils/ZapXmlConfiguration.java
@@ -22,8 +22,15 @@ package org.zaproxy.zap.utils;
 import java.io.File;
 import java.net.URL;
 
+import javax.xml.parsers.DocumentBuilder;
+import javax.xml.parsers.DocumentBuilderFactory;
+import javax.xml.parsers.ParserConfigurationException;
+
 import org.apache.commons.configuration.ConfigurationException;
 import org.apache.commons.configuration.XMLConfiguration;
+import org.xml.sax.SAXException;
+import org.xml.sax.SAXParseException;
+import org.xml.sax.helpers.DefaultHandler;
 
 /**
  * A {@code XMLConfiguration} with character encoding always set to UTF-8 and
@@ -81,6 +88,36 @@ public class ZapXmlConfiguration extends XMLConfiguration {
 		load();
 	}
 
+	@Override
+	protected DocumentBuilder createDocumentBuilder() throws ParserConfigurationException {
+		DocumentBuilderFactory factory = XmlUtils.newXxeDisabledDocumentBuilderFactory();
+
+		// Same behaviour as base method:
+		if (isValidating()) {
+			factory.setValidating(true);
+			if (isSchemaValidation()) {
+				factory.setNamespaceAware(true);
+				factory.setAttribute(
+						"http://java.sun.com/xml/jaxp/properties/schemaLanguage",
+						"http://www.w3.org/2001/XMLSchema");
+			}
+		}
+
+		DocumentBuilder result = factory.newDocumentBuilder();
+		result.setEntityResolver(getEntityResolver());
+
+		if (isValidating()) {
+			result.setErrorHandler(new DefaultHandler() {
+
+				@Override
+				public void error(SAXParseException ex) throws SAXException {
+					throw ex;
+				}
+			});
+		}
+		return result;
+	}
+
 	/**
 	 * Creates a new instance of {@code ZapXmlConfiguration}. The configuration
 	 * is loaded from the specified {@code url}.
