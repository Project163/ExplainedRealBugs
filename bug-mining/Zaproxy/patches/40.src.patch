diff --git a/src/org/parosproxy/paros/extension/history/ProxyListenerLog.java b/src/org/parosproxy/paros/extension/history/ProxyListenerLog.java
index c216ab5cb..c0697a32c 100644
--- a/src/org/parosproxy/paros/extension/history/ProxyListenerLog.java
+++ b/src/org/parosproxy/paros/extension/history/ProxyListenerLog.java
@@ -27,6 +27,7 @@
 // ZAP: 2013/03/03 Issue 546: Remove all template Javadoc comments
 // ZAP: 2013/11/16 Issue 869: Differentiate proxied requests from (ZAP) user requests
 // ZAP: 2015/04/02 Issue 1582: Low memory option
+// ZAP: 2015/09/07 Issue 1872: EDT accessed in daemon mode
 
 package org.parosproxy.paros.extension.history;
  
@@ -150,36 +151,31 @@ public class ProxyListenerLog implements ProxyListener {
         
         extension.addHistory(historyRef);
 
-        // add history to site panel.  Must use event queue because this proxylistener may not be run from event queue.
-        final HistoryReference ref = historyRef;
-        final HttpMessage finalMsg = msg;
-        if (EventQueue.isDispatchThread()) {
-            SessionStructure.addPath(model.getSession(), ref, msg);
-            if (isFirstAccess) {
-                isFirstAccess = false;
-                if (View.isInitialised()) {
-                	view.getSiteTreePanel().expandRoot();
-                }
-            }
-            
-        } else {
+        addToSiteMap(historyRef, msg);
+    }
+
+    private void addToSiteMap(final HistoryReference ref, final HttpMessage msg) {
+        if (View.isInitialised() && !EventQueue.isDispatchThread()) {
             try {
                 EventQueue.invokeAndWait(new Runnable() {
                     @Override
                     public void run() {
-                        SessionStructure.addPath(model.getSession(), ref, finalMsg);
-                        if (isFirstAccess && ! Constant.isLowMemoryOptionSet()) {
-                            isFirstAccess = false;
-                            if (View.isInitialised()) {
-                            	view.getSiteTreePanel().expandRoot();
-                            }
-                        }
+                        addToSiteMap(ref, msg);
                     }
                 });
             } catch (Exception e) {
             	// ZAP: Log exceptions
             	log.warn(e.getMessage(), e);
             }
+            return;
+        }
+
+        SessionStructure.addPath(model.getSession(), ref, msg);
+        if (isFirstAccess && !Constant.isLowMemoryOptionSet()) {
+            isFirstAccess = false;
+            if (View.isInitialised()) {
+                view.getSiteTreePanel().expandRoot();
+            }
         }
     }
 }
diff --git a/src/org/zaproxy/zap/extension/alert/AlertTreeModel.java b/src/org/zaproxy/zap/extension/alert/AlertTreeModel.java
index fc31c93c2..8c6fbed96 100644
--- a/src/org/zaproxy/zap/extension/alert/AlertTreeModel.java
+++ b/src/org/zaproxy/zap/extension/alert/AlertTreeModel.java
@@ -27,6 +27,7 @@ import javax.swing.tree.DefaultTreeModel;
 import org.apache.log4j.Logger;
 import org.parosproxy.paros.Constant;
 import org.parosproxy.paros.core.scanner.Alert;
+import org.parosproxy.paros.view.View;
 
 
 class AlertTreeModel extends DefaultTreeModel {
@@ -47,7 +48,7 @@ class AlertTreeModel extends DefaultTreeModel {
     }
     
     void addPath(final Alert alert) {
-        if (EventQueue.isDispatchThread()) {
+        if (!View.isInitialised() || EventQueue.isDispatchThread()) {
         	addPathEventHandler(alert);
         } else {
             try {
