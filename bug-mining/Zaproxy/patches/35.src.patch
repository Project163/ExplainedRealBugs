diff --git a/src/lang/Messages.properties b/src/lang/Messages.properties
index afb7d0587..24846d64d 100644
--- a/src/lang/Messages.properties
+++ b/src/lang/Messages.properties
@@ -28,6 +28,9 @@ alert.label.wascid			= WASC Id:
 
 alerts.desc                 = Allows you to view and manage alerts
 alerts.label.defaultMessage = Full details of any selected alert will be displayed here.\n\nYou can manually add alerts by right clicking on the relevant line in the history and selecting 'Add alert'.\n\nYou can also edit existing alerts by double clicking on them.
+alert.optionspanel.name		= Alerts
+alert.optionspanel.label.maxinstances = Max alert instances in report:
+alert.optionspanel.label.mergerelated = Merge related alerts in report
 alerts.panel.mnemonic 		= a
 alerts.panel.title          = Alerts
 alerts.panel.linkWithSitesSelection.unselected.button.tooltip = Link with Sites selection
diff --git a/src/org/parosproxy/paros/core/scanner/Alert.java b/src/org/parosproxy/paros/core/scanner/Alert.java
index b6994230f..49f44b00e 100644
--- a/src/org/parosproxy/paros/core/scanner/Alert.java
+++ b/src/org/parosproxy/paros/core/scanner/Alert.java
@@ -38,6 +38,7 @@
 // ZAP: 2015/01/04 Issue 1419: Include alert's evidence in HTML report
 // ZAP: 2014/01/04 Issue 1475: Alerts with different name from same scanner might not be shown in report
 // ZAP: 2015/02/09 Issue 1525: Introduce a database interface layer to allow for alternative implementations
+// ZAP: 2015/08/24 Issue 1849: Option to merge related issues in reports
 
 package org.parosproxy.paros.core.scanner;
 
@@ -527,12 +528,15 @@ public class Alert implements Comparable<Object>  {
     public String getUrlParamXML() {
     	StringBuilder sb = new StringBuilder(200); // ZAP: Changed the type to StringBuilder.
         sb.append("  <uri>").append(breakNoSpaceString(replaceEntity(uri))).append("</uri>\r\n");
-        sb.append("  <param>").append(breakNoSpaceString(replaceEntity(param))).append("</param>\r\n");
-        sb.append("  <attack>").append(breakNoSpaceString(replaceEntity(attack))).append("</attack>\r\n");
+        if (param != null && param.length() > 0) {
+        	sb.append("  <param>").append(breakNoSpaceString(replaceEntity(param))).append("</param>\r\n");
+        }
+        if (attack != null && attack.length() > 0) {
+        	sb.append("  <attack>").append(breakNoSpaceString(replaceEntity(attack))).append("</attack>\r\n");
+        }
         if (evidence != null && evidence.length() > 0) {
             sb.append("  <evidence>").append(breakNoSpaceString(replaceEntity(evidence))).append("</evidence>\r\n");
         }
-        sb.append("  <otherinfo>").append(breakNoSpaceString(replaceEntity(otherInfo))).append("</otherinfo>\r\n");
         return sb.toString();
     }
 
diff --git a/src/org/zaproxy/zap/extension/alert/AlertParam.java b/src/org/zaproxy/zap/extension/alert/AlertParam.java
new file mode 100644
index 000000000..74901382d
--- /dev/null
+++ b/src/org/zaproxy/zap/extension/alert/AlertParam.java
@@ -0,0 +1,104 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.zaproxy.zap.extension.alert;
+
+import org.apache.commons.configuration.ConversionException;
+import org.apache.log4j.Logger;
+import org.parosproxy.paros.common.AbstractParam;
+
+public class AlertParam extends AbstractParam {
+
+    private static final Logger LOGGER = Logger.getLogger(AlertParam.class);
+
+    /**
+     * The base configuration key for all alert configurations.
+     */
+    private static final String PARAM_BASE_KEY = "alert";
+
+    private static final String PARAM_MERGE_RELATED_ISSUES = PARAM_BASE_KEY + ".mergeissues";
+
+    /**
+     * The configuration key for the maximum number of instances to include in a report.
+     * 
+     * @see #maximumInstances
+     */
+    private static final String PARAM_MAXIMUM_INSTANCES = PARAM_BASE_KEY + ".maxInstances";
+
+    private static final int DEFAULT_MAXIMUM_INSTANCES = 20;
+
+    /**
+     * The number of maximum instances of each vulnerability included in a report.
+     * <p>
+     * Default is {@value #DEFAULT_MAXIMUM_INSTANCES}.
+     * </p>
+     */
+    private int maximumInstances = DEFAULT_MAXIMUM_INSTANCES;
+    
+    private boolean mergeRelatedIssues = true;
+
+    /**
+     * Parses the alert options.
+     * 
+     * @see #getMaximumInstances()
+     */
+    @Override
+    protected void parse() {
+        try {
+            maximumInstances = getConfig().getInt(PARAM_MAXIMUM_INSTANCES, DEFAULT_MAXIMUM_INSTANCES);
+        } catch (ConversionException e) {
+            LOGGER.error("Failed to load the \"Maximum instances\" configuration: " + e.getMessage(), e);
+        }
+        try {
+        	mergeRelatedIssues = getConfig().getBoolean(PARAM_MERGE_RELATED_ISSUES, true);
+        } catch (ConversionException e) {
+            LOGGER.error("Failed to load the \"old format\" configuration: " + e.getMessage(), e);
+        }
+    }
+
+    /**
+     * Sets the maximum instances of an alert to include in a report.
+     */
+    public void setMaximumInstances(int maximumInstances) {
+        if (this.maximumInstances != maximumInstances) {
+            this.maximumInstances = maximumInstances;
+
+            getConfig().setProperty(PARAM_MAXIMUM_INSTANCES, Integer.valueOf(maximumInstances));
+        }
+    }
+
+    /**
+     * Returns the maximum instances of an alert to include in a report.
+     */
+    public int getMaximumInstances() {
+        return maximumInstances;
+    }
+
+	public boolean isMergeRelatedIssues() {
+		return mergeRelatedIssues;
+	}
+
+	public void setMergeRelatedIssues(boolean mergeRelatedIssues) {
+		if (this.mergeRelatedIssues != mergeRelatedIssues) {
+			this.mergeRelatedIssues = mergeRelatedIssues;
+            getConfig().setProperty(PARAM_MERGE_RELATED_ISSUES, Boolean.valueOf(mergeRelatedIssues));
+		}
+	}
+
+}
diff --git a/src/org/zaproxy/zap/extension/alert/ExtensionAlert.java b/src/org/zaproxy/zap/extension/alert/ExtensionAlert.java
index 1f0d912c7..ad1adce53 100644
--- a/src/org/zaproxy/zap/extension/alert/ExtensionAlert.java
+++ b/src/org/zaproxy/zap/extension/alert/ExtensionAlert.java
@@ -71,6 +71,8 @@ public class ExtensionAlert extends ExtensionAdaptor implements SessionChangedLi
     private PopupMenuAlertsRefresh popupMenuAlertsRefresh = null;
     private PopupMenuShowAlerts popupMenuShowAlerts = null;
     private Logger logger = Logger.getLogger(ExtensionAlert.class);
+	private AlertParam alertParam = null;
+	private OptionsAlertPanel optionsPanel = null;
 
     /**
      *
@@ -98,7 +100,9 @@ public class ExtensionAlert extends ExtensionAdaptor implements SessionChangedLi
     @Override
     public void hook(ExtensionHook extensionHook) {
         super.hook(extensionHook);
+	    extensionHook.addOptionsParamSet(getAlertParam());
         if (getView() != null) {
+	        extensionHook.getHookView().addOptionPanel(getOptionsPanel());
             extensionHook.getHookMenu().addPopupMenuItem(getPopupMenuAlertEdit());
             extensionHook.getHookMenu().addPopupMenuItem(getPopupMenuAlertDelete());
             extensionHook.getHookMenu().addPopupMenuItem(getPopupMenuAlertsRefresh());
@@ -112,6 +116,20 @@ public class ExtensionAlert extends ExtensionAdaptor implements SessionChangedLi
 
     }
 
+	private OptionsAlertPanel getOptionsPanel() {
+		if (optionsPanel == null) {
+			optionsPanel = new OptionsAlertPanel();
+		}
+		return optionsPanel;
+	}
+
+	private AlertParam getAlertParam() {
+		if (alertParam == null) {
+			alertParam = new AlertParam();
+		}
+		return alertParam;
+	}
+
     public void alertFound(Alert alert, HistoryReference ref) {
         try {
             logger.debug("alertFound " + alert.getAlert() + " " + alert.getUri());
@@ -636,10 +654,41 @@ public class ExtensionAlert extends ExtensionAdaptor implements SessionChangedLi
         StringBuilder xml = new StringBuilder();
         xml.append("<alerts>");
         List<Alert> alerts = site.getAlerts();
-        for (Alert alert : alerts) {
+        List<Integer> handledAlerts = new ArrayList<Integer>(); 
+        
+        for (int i=0; i < alerts.size(); i++) {
+        	Alert alert = alerts.get(i);
             if (alert.getConfidence() != Alert.CONFIDENCE_FALSE_POSITIVE) {
-                String urlParamXML = alert.getUrlParamXML();
-                xml.append(alert.toPluginXML(urlParamXML));
+            	if (this.getAlertParam().isMergeRelatedIssues()) {
+	            	if (!handledAlerts.contains(alert.getPluginId())) {
+	            		// Its a new one
+	            		handledAlerts.add(alert.getPluginId());
+	            		// Build up the full set of details
+	            		StringBuilder sb = new StringBuilder();
+	            		sb.append("  <instances>\n");
+	            		int count = 0;
+	            		for (int j=i; j < alerts.size(); j++) {
+	            			// Deliberately include i!
+	            			Alert alert2 = alerts.get(j);
+	            			if (alert.getPluginId() == alert2.getPluginId()) {
+	            				if (count < this.getAlertParam().getMaximumInstances()) {
+		            				sb.append("  <instance>\n");
+		            				sb.append(alert2.getUrlParamXML());
+		            				sb.append("  </instance>\n");
+	            				}
+	            				count ++;
+	            			}
+	            		}
+	            		sb.append("  </instances>\n");
+	            		sb.append("  <count>");
+	            		sb.append(count);
+	            		sb.append("</count>\n");
+	            		xml.append(alert.toPluginXML(sb.toString()));
+	            	}
+            	} else {
+                    String urlParamXML = alert.getUrlParamXML();
+                    xml.append(alert.toPluginXML(urlParamXML));
+            	}
             }
         }
         xml.append("</alerts>");
diff --git a/src/org/zaproxy/zap/extension/alert/OptionsAlertPanel.java b/src/org/zaproxy/zap/extension/alert/OptionsAlertPanel.java
new file mode 100644
index 000000000..af26d4826
--- /dev/null
+++ b/src/org/zaproxy/zap/extension/alert/OptionsAlertPanel.java
@@ -0,0 +1,133 @@
+/*
+ * Zed Attack Proxy (ZAP) and its related class files.
+ * 
+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.
+ * 
+ * Copyright The ZAP Development Team
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.zaproxy.zap.extension.alert;
+
+import java.awt.FlowLayout;
+import java.awt.GridBagLayout;
+import java.awt.Insets;
+import java.awt.event.ItemEvent;
+import java.awt.event.ItemListener;
+
+import javax.swing.JCheckBox;
+import javax.swing.JLabel;
+import javax.swing.JPanel;
+import javax.swing.border.EmptyBorder;
+
+import org.parosproxy.paros.Constant;
+import org.parosproxy.paros.model.OptionsParam;
+import org.parosproxy.paros.view.AbstractParamPanel;
+import org.zaproxy.zap.utils.ZapNumberSpinner;
+import org.zaproxy.zap.view.LayoutHelper;
+
+/**
+ * The GUI report options panel.
+ * <p>
+ * It allows to change the following report options:
+ * <ul>
+ * <li>The number of maximum instances of each vulnerability included in a report.</li>
+ * </ul>
+ * </p>
+ */
+public class OptionsAlertPanel extends AbstractParamPanel {
+
+    private static final long serialVersionUID = -7541236934312940852L;
+
+    /**
+     * The name of the options panel.
+     */
+    private static final String NAME = Constant.messages.getString("alert.optionspanel.name");
+
+    /**
+     * The number spinner that will contain the maximum number of instances to include in a report.
+     */
+    private ZapNumberSpinner maxInstances = null;
+    private JCheckBox mergeRelatedIssues = null;
+
+    public OptionsAlertPanel() {
+        super();
+        setName(NAME);
+
+        setLayout(new FlowLayout(FlowLayout.LEADING, 0, 0));
+
+        JPanel panel = new JPanel(new GridBagLayout());
+        panel.setBorder(new EmptyBorder(2, 2, 2, 2));
+
+        panel.add(getMergeRelatedIssues(), 
+        		LayoutHelper.getGBC(0, 0, 1, 1.0, new Insets(2,2,2,2)));
+
+        JLabel maxInstancesLabel = new JLabel(
+        		Constant.messages.getString("alert.optionspanel.label.maxinstances"));
+        maxInstancesLabel.setLabelFor(getMaxInstances());
+        panel.add(maxInstancesLabel, 
+        		LayoutHelper.getGBC(0, 1, 1, 1.0, new Insets(2,2,2,2)));
+        panel.add(getMaxInstances(), 
+        		LayoutHelper.getGBC(1, 1, 1, 1.0, new Insets(2,2,2,2)));
+
+        add(panel);
+    }
+
+    private JCheckBox getMergeRelatedIssues() {
+    	if (mergeRelatedIssues == null) {
+    		mergeRelatedIssues = new JCheckBox();
+    		mergeRelatedIssues.setText(
+    				Constant.messages.getString("alert.optionspanel.label.mergerelated"));
+    		mergeRelatedIssues.addItemListener(new ItemListener(){
+				@Override
+				public void itemStateChanged(ItemEvent arg0) {
+			       	getMaxInstances().setEditable(mergeRelatedIssues.isSelected());
+				}});
+    	}
+    	return mergeRelatedIssues;
+    }
+    private ZapNumberSpinner getMaxInstances() {
+        if (maxInstances == null) {
+            maxInstances = new ZapNumberSpinner();
+        }
+        return maxInstances;
+    }
+
+    @Override
+    public void initParam(Object obj) {
+        final OptionsParam options = (OptionsParam) obj;
+        final AlertParam param = options.getParamSet(AlertParam.class);
+
+        getMaxInstances().setValue(Integer.valueOf(param.getMaximumInstances()));
+        getMergeRelatedIssues().setSelected(param.isMergeRelatedIssues());
+       	getMaxInstances().setEditable(param.isMergeRelatedIssues());
+    }
+
+    @Override
+    public void validateParam(Object obj) throws Exception {
+    }
+
+    @Override
+    public void saveParam(Object obj) throws Exception {
+        final OptionsParam options = (OptionsParam) obj;
+        final AlertParam param = options.getParamSet(AlertParam.class);
+
+        param.setMaximumInstances(getMaxInstances().getValue().intValue());
+        param.setMergeRelatedIssues(getMergeRelatedIssues().isSelected());
+    }
+
+    @Override
+    public String getHelpIndex() {
+        return "ui.dialogs.options.report";
+    }
+}
\ No newline at end of file
diff --git a/src/xml/report.html.xsl b/src/xml/report.html.xsl
index c05341037..31767d685 100644
--- a/src/xml/report.html.xsl
+++ b/src/xml/report.html.xsl
@@ -70,7 +70,7 @@
   <xsl:template match="alertitem">
 <p></p>
 <table width="100%" border="0">
-<xsl:apply-templates select="text()|alert|desc|uri|param|attack|evidence|otherinfo|solution|reference|cweid|wascid|p|br|wbr|ul|li"/>
+<xsl:apply-templates select="text()|alert|desc|uri|param|attack|evidence|instances|count|otherinfo|solution|reference|cweid|wascid|p|br|wbr|ul|li"/>
 </table>
   </xsl:template>
 
@@ -154,10 +154,10 @@
 
   <xsl:template match="uri">
   <tr bgcolor="#e8e8e8" valign="top"> 
-    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif">URL</font></blockquote></td>
+    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif"><p>URL</p></font></blockquote></td>
     <td width="80%">
     <font size="2" face="Arial, Helvetica, sans-serif">
-    <xsl:apply-templates select="text()|*"/>
+    <p><xsl:apply-templates select="text()|*"/></p>
     </font></td>
   </tr>
   </xsl:template>
@@ -165,10 +165,10 @@
   <xsl:template match="param">
   <xsl:if test="text() !=''">
   <tr bgcolor="#e8e8e8" valign="top"> 
-    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif">Parameter</font></blockquote></td>
+    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif"><p>Parameter</p></font></blockquote></td>
     <td width="80%">
     <font size="2" face="Arial, Helvetica, sans-serif">
-	<xsl:apply-templates select="text()|*"/>
+    <p><xsl:apply-templates select="text()|*"/></p>
     </font></td>
   </tr>
   </xsl:if>
@@ -177,10 +177,10 @@
 <xsl:template match="attack">
   <xsl:if test="text() !=''">
   <tr bgcolor="#e8e8e8" valign="top"> 
-    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif">Attack</font></blockquote></td>
+    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif"><p>Attack</p></font></blockquote></td>
     <td width="80%">
     <font size="2" face="Arial, Helvetica, sans-serif">
-	<xsl:apply-templates select="text()|*"/>
+    <p><xsl:apply-templates select="text()|*"/></p>
     </font></td>
   </tr>
   </xsl:if>
@@ -189,25 +189,81 @@
   <xsl:template match="evidence">
   <xsl:if test="text() !=''">
   <tr bgcolor="#e8e8e8" valign="top"> 
-    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif">Evidence</font></blockquote></td>
+    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif"><p>Evidence</p></font></blockquote></td>
     <td width="80%">
     <font size="2" face="Arial, Helvetica, sans-serif">
-    <xsl:apply-templates select="text()|*"/>
+    <p><xsl:apply-templates select="text()|*"/></p>
     </font></td>
   </tr>
   </xsl:if>
   </xsl:template>
 
-  <xsl:template match="otherinfo">
+  <xsl:template match="instances/instance/uri">
+  <tr bgcolor="#e8e8e8" valign="top"> 
+    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif"><p>URL</p></font></blockquote></td>
+    <td width="80%">
+    <font size="2" face="Arial, Helvetica, sans-serif">
+    <p><xsl:apply-templates select="text()|*"/></p>
+    </font></td>
+  </tr>
+  </xsl:template>
+ 
+  <xsl:template match="instances/instance/param">
   <xsl:if test="text() !=''">
   <tr bgcolor="#e8e8e8" valign="top"> 
-    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif">Other information</font></blockquote></td>
+    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif"><p>&#160;&#160;&#160;&#160;Parameter</p></font></blockquote></td>
     <td width="80%">
     <font size="2" face="Arial, Helvetica, sans-serif">
-	<xsl:apply-templates select="text()|*"/>
+	<p><xsl:apply-templates select="text()|*"/></p>
+    </font></td>
+  </tr>
+  </xsl:if>
+  </xsl:template>
+
+  <xsl:template match="instances/instance/attack">
+  <xsl:if test="text() !=''">
+  <tr bgcolor="#e8e8e8" valign="top"> 
+    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif"><p>&#160;&#160;&#160;&#160;Attack</p></font></blockquote></td>
+    <td width="80%">
+    <font size="2" face="Arial, Helvetica, sans-serif">
+	<p><xsl:apply-templates select="text()|*"/></p>
+    </font></td>
+  </tr>
+  </xsl:if>
+  </xsl:template>
+
+  <xsl:template match="instances/instance/evidence">
+  <xsl:if test="text() !=''">
+  <tr bgcolor="#e8e8e8" valign="top"> 
+    <td width="20%"><blockquote><font size="2" face="Arial, Helvetica, sans-serif"><p>&#160;&#160;&#160;&#160;Evidence</p></font></blockquote></td>
+    <td width="80%">
+    <font size="2" face="Arial, Helvetica, sans-serif">
+    <p><xsl:apply-templates select="text()|*"/></p>
     </font></td>
   </tr>
   </xsl:if>
+  </xsl:template>
+
+  <xsl:template match="count">
+  <xsl:if test="text() !=''">
+  <tr bgcolor="#e8e8e8" valign="top"> 
+    <td width="20%"><font size="2" face="Arial, Helvetica, sans-serif"><p>Instances</p></font></td>
+    <td width="80%">
+    <font size="2" face="Arial, Helvetica, sans-serif">
+    <p><xsl:apply-templates select="text()|*"/></p>
+    </font></td>
+  </tr>
+  </xsl:if>
+  </xsl:template>
+
+  <xsl:template match="otherinfo">
+  <tr bgcolor="#e8e8e8" valign="top"> 
+    <td width="20%"><font size="2" face="Arial, Helvetica, sans-serif"><p>Other information</p></font></td>
+    <td width="80%">
+    <font size="2" face="Arial, Helvetica, sans-serif">
+    <p><xsl:apply-templates select="text()|*"/></p>
+    </font></td>
+  </tr>
 
   <TR vAlign="top"> 
     <TD colspan="2"> </TD>
@@ -239,7 +295,7 @@
     <td width="20%"><font size="2" face="Arial, Helvetica, sans-serif"><p>CWE Id</p></font></td>
     <td width="80%">
     <font size="2" face="Arial, Helvetica, sans-serif">
-	<xsl:apply-templates select="text()|*"/>
+	<p><xsl:apply-templates select="text()|*"/></p>
     </font></td>
   </tr>
   </xsl:template>
@@ -249,7 +305,7 @@
     <td width="20%"><font size="2" face="Arial, Helvetica, sans-serif"><p>WASC Id</p></font></td>
     <td width="80%">
     <font size="2" face="Arial, Helvetica, sans-serif">
-	<xsl:apply-templates select="text()|*"/>
+	<p><xsl:apply-templates select="text()|*"/></p>
     </font></td>
   </tr>
   </xsl:template>
