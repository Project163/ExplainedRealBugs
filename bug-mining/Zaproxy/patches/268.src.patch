diff --git a/src/lang/Messages.properties b/src/lang/Messages.properties
index 356b27720..80857f313 100644
--- a/src/lang/Messages.properties
+++ b/src/lang/Messages.properties
@@ -974,6 +974,7 @@ core.api.action.saveSession = Saves the session with the name supplied, optional
 core.api.action.sendRequest = Sends the HTTP request, optionally following redirections. Returns the request sent and response received and followed redirections, if any. The Mode is enforced when sending the request (and following redirections), custom manual requests are not allowed in 'Safe' mode nor in 'Protected' mode if out of scope.
 core.api.action.setMode = Sets the mode, which may be one of [safe, protect, standard, attack]
 core.api.action.setOptionDnsTtlSuccessfulQueries = Sets the TTL (in seconds) of successful DNS queries (applies after ZAP restart).
+core.api.action.snapshotSession = Snapshots the session, optionally with the given name, and overwriting existing files. If no name is specified the name of the current session with a timestamp appended is used. If a relative path is specified it will be resolved against the "session" directory in ZAP "home" dir.
 core.api.action.shutdown = Shuts down ZAP
 core.api.action.addProxyChainExcludedDomain = Adds a domain to be excluded from the outgoing proxy, using the specified value. Optionally sets if the new entry is enabled (default, true) and whether or not the new value is specified as a regex (default, false).
 core.api.action.modifyProxyChainExcludedDomain = Modifies a domain excluded from the outgoing proxy. Allows to modify the value, if enabled or if a regex. The domain is selected with its index, which can be obtained with the view proxyChainExcludedDomains.
diff --git a/src/org/zaproxy/zap/extension/api/CoreAPI.java b/src/org/zaproxy/zap/extension/api/CoreAPI.java
index 9b0d73993..76bfed8a6 100644
--- a/src/org/zaproxy/zap/extension/api/CoreAPI.java
+++ b/src/org/zaproxy/zap/extension/api/CoreAPI.java
@@ -248,7 +248,7 @@ public class CoreAPI extends ApiImplementor implements SessionListener {
 		this.addApiAction(new ApiAction(ACTION_NEW_SESSION, null, new String[] {PARAM_SESSION, PARAM_OVERWRITE_SESSION}));
 		this.addApiAction(new ApiAction(ACTION_LOAD_SESSION, new String[] {PARAM_SESSION}));
 		this.addApiAction(new ApiAction(ACTION_SAVE_SESSION, new String[] {PARAM_SESSION}, new String[] {PARAM_OVERWRITE_SESSION}));
-		this.addApiAction(new ApiAction(ACTION_SNAPSHOT_SESSION));
+		this.addApiAction(new ApiAction(ACTION_SNAPSHOT_SESSION, null, new String[] { PARAM_SESSION, PARAM_OVERWRITE_SESSION }));
 		this.addApiAction(new ApiAction(ACTION_CLEAR_EXCLUDED_FROM_PROXY));
 		this.addApiAction(new ApiAction(ACTION_EXCLUDE_FROM_PROXY, new String[] {PARAM_REGEX}));
 		this.addApiAction(new ApiAction(ACTION_SET_HOME_DIRECTORY, new String[] {PARAM_DIR}));
@@ -435,13 +435,34 @@ public class CoreAPI extends ApiImplementor implements SessionListener {
 				throw new ApiException(ApiException.Type.BAD_STATE, "Active actions prevent the session snapshot: " + actions);
 			}
 
-			String fileName = session.getFileName();
+			String fileName = ApiUtils.getOptionalStringParam(params, PARAM_SESSION);
 			
-			if (fileName.endsWith(".session")) {
-			    fileName = fileName.substring(0, fileName.length() - 8);
-			}
-			fileName += "-" + dateFormat.format(new Date()) + ".session";
+			if (fileName == null || fileName.isEmpty()) {
+				fileName = session.getFileName();
+
+				if (fileName.endsWith(".session")) {
+					fileName = fileName.substring(0, fileName.length() - 8);
+				}
+				fileName += "-" + dateFormat.format(new Date()) + ".session";
+			} else {
+				Path sessionPath = SessionUtils.getSessionPath(fileName);
+				fileName = sessionPath.toAbsolutePath().toString();
+
+				if (Files.exists(sessionPath)) {
+					final boolean overwrite = getParam(params, PARAM_OVERWRITE_SESSION, false);
+					boolean sameSession = false;
+					try {
+						sameSession = Files.isSameFile(Paths.get(session.getFileName()), sessionPath);
+					} catch (IOException e) {
+						logger.error("Failed to check if same session path:", e);
+						throw new ApiException(ApiException.Type.INTERNAL_ERROR, e.getMessage());
+					}
 
+					if (!overwrite || sameSession) {
+						throw new ApiException(ApiException.Type.ALREADY_EXISTS, fileName);
+					}
+				}
+			}
 			
 			this.savingSession = true;
 			try {
