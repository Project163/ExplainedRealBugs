diff --git a/zap/src/main/java/org/zaproxy/zap/extension/script/ProxyListenerScript.java b/zap/src/main/java/org/zaproxy/zap/extension/script/ProxyListenerScript.java
index 1a66066ed..04c482227 100644
--- a/zap/src/main/java/org/zaproxy/zap/extension/script/ProxyListenerScript.java
+++ b/zap/src/main/java/org/zaproxy/zap/extension/script/ProxyListenerScript.java
@@ -66,7 +66,11 @@ public class ProxyListenerScript implements ProxyListener {
             ProxyScript script = cachedScript.getScript();
             try {
                 boolean forwardMessage =
-                        request ? script.proxyRequest(msg) : script.proxyResponse(msg);
+                        cachedScript.execute(
+                                () ->
+                                        request
+                                                ? script.proxyRequest(msg)
+                                                : script.proxyResponse(msg));
                 if (!forwardMessage) {
                     return false;
                 }
diff --git a/zap/src/main/java/org/zaproxy/zap/extension/script/ScriptsCache.java b/zap/src/main/java/org/zaproxy/zap/extension/script/ScriptsCache.java
index ed7b0701a..11c2891bf 100644
--- a/zap/src/main/java/org/zaproxy/zap/extension/script/ScriptsCache.java
+++ b/zap/src/main/java/org/zaproxy/zap/extension/script/ScriptsCache.java
@@ -232,14 +232,13 @@ public class ScriptsCache<T> {
             this.script = script;
         }
 
-        void execute(Callable<T> action) throws Exception {
+        <R> R execute(Callable<R> action) throws Exception {
             if (isSyncAccess()) {
                 synchronized (this) {
-                    action.call();
+                    return action.call();
                 }
-            } else {
-                action.call();
             }
+            return action.call();
         }
 
         private boolean isSyncAccess() {
diff --git a/zap/src/test/java/org/zaproxy/zap/extension/script/ProxyListenerScriptUnitTest.java b/zap/src/test/java/org/zaproxy/zap/extension/script/ProxyListenerScriptUnitTest.java
index adfb7e32d..e9963b8ce 100644
--- a/zap/src/test/java/org/zaproxy/zap/extension/script/ProxyListenerScriptUnitTest.java
+++ b/zap/src/test/java/org/zaproxy/zap/extension/script/ProxyListenerScriptUnitTest.java
@@ -34,6 +34,7 @@ import static org.mockito.Mockito.times;
 import static org.mockito.Mockito.verify;
 import static org.mockito.Mockito.withSettings;
 
+import java.util.concurrent.Callable;
 import javax.script.ScriptException;
 import org.junit.jupiter.api.BeforeEach;
 import org.junit.jupiter.api.Test;
@@ -226,6 +227,12 @@ class ProxyListenerScriptUnitTest extends WithConfigsTest {
         CachedScript<T> cachedScript =
                 mock(CachedScript.class, withSettings().strictness(Strictness.LENIENT));
         given(cachedScript.getScript()).willReturn(script);
+        try {
+            given(cachedScript.execute(any()))
+                    .willAnswer(a -> ((Callable<?>) a.getArgument(0)).call());
+        } catch (Exception e) {
+            throw new RuntimeException(e);
+        }
         if (scriptWrapper != null) {
             given(cachedScript.getScriptWrapper()).willReturn(scriptWrapper);
         }
