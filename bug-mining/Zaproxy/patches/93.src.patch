diff --git a/src/org/zaproxy/zap/extension/httppanel/view/syntaxhighlight/components/split/request/HttpRequestHeaderPanelSyntaxHighlightTextView.java b/src/org/zaproxy/zap/extension/httppanel/view/syntaxhighlight/components/split/request/HttpRequestHeaderPanelSyntaxHighlightTextView.java
index 7132bd33f..50a709e7a 100644
--- a/src/org/zaproxy/zap/extension/httppanel/view/syntaxhighlight/components/split/request/HttpRequestHeaderPanelSyntaxHighlightTextView.java
+++ b/src/org/zaproxy/zap/extension/httppanel/view/syntaxhighlight/components/split/request/HttpRequestHeaderPanelSyntaxHighlightTextView.java
@@ -177,9 +177,11 @@ public class HttpRequestHeaderPanelSyntaxHighlightTextView extends HttpPanelSynt
                 return null;
             }
 
-            while ((pos = header.indexOf("\r\n", pos)) != -1 && pos < textLocation.getEnd()) {
-                pos += 2;
-                ++excessChars;
+            if (pos != -1) {
+                while ((pos = header.indexOf("\r\n", pos)) != -1 && pos < textLocation.getEnd()) {
+                    pos += 2;
+                    ++excessChars;
+                }
             }
 
             int finalEndPos = textLocation.getEnd() - excessChars;
