diff --git a/src/org/parosproxy/paros/core/scanner/PluginFactory.java b/src/org/parosproxy/paros/core/scanner/PluginFactory.java
index 8cdd16695..4627313ff 100644
--- a/src/org/parosproxy/paros/core/scanner/PluginFactory.java
+++ b/src/org/parosproxy/paros/core/scanner/PluginFactory.java
@@ -48,6 +48,7 @@
 // ZAP: 2016/07/25 Fix to correct handling of lists in plugins
 // ZAP: 2017/06/20 Allow to obtain a Plugin by ID.
 // ZAP: 2017/07/05 Log an error if the Plugin does not have a defined ID.
+// ZAP: 2017/07/12 Order dependencies before dependent plugins (Issue 3154) and tweak status comparison.
 
 package org.parosproxy.paros.core.scanner;
 
@@ -230,16 +231,12 @@ public class PluginFactory {
     private static final Comparator<AbstractPlugin> riskComparator = new Comparator<AbstractPlugin>() {
         @Override
         public int compare(AbstractPlugin e1, AbstractPlugin e2) {
-        	if (e1.getStatus().ordinal() > e2.getStatus().ordinal()) {
-            	//High Risk alerts are checked before low risk alerts
-                return -1;
-        		
-        	}
-        	if (e1.getStatus().ordinal() < e2.getStatus().ordinal()) {
-            	//High Risk alerts are checked before low risk alerts
-                return 1;
-        		
-        	}
+            // Run stable plugins first
+            int res = e1.getStatus().compareTo(e2.getStatus());
+            if (res != 0) {
+                return -res;
+            }
+
             if (e1.getRisk() > e2.getRisk()) {
             	//High Risk alerts are checked before low risk alerts
                 return -1;
@@ -287,7 +284,10 @@ public class PluginFactory {
                 // ZAP: Removed unnecessary cast.
                 plugin = iterator.next();
                 if (plugin.isEnabled()) {
-                    listPending.add(plugin);
+                    addAllDependencies(plugin, listPending);
+                    if (!listPending.contains(plugin)) {
+                        listPending.add(plugin);
+                    }
                 }
             }
             
@@ -336,8 +336,8 @@ public class PluginFactory {
             if (pluginDep == null) {
                 allDepsAvailable = false;
             } else if (!to.contains(pluginDep)) {
-                to.add(pluginDep);
                 allDepsAvailable &= addAllDependencies(pluginDep, to);
+                to.add(pluginDep);
             }
         }
         return allDepsAvailable;
diff --git a/test/org/parosproxy/paros/core/scanner/PluginFactoryUnitTest.java b/test/org/parosproxy/paros/core/scanner/PluginFactoryUnitTest.java
index fb11f878e..5f51e53f2 100644
--- a/test/org/parosproxy/paros/core/scanner/PluginFactoryUnitTest.java
+++ b/test/org/parosproxy/paros/core/scanner/PluginFactoryUnitTest.java
@@ -22,6 +22,7 @@ package org.parosproxy.paros.core.scanner;
 import static org.hamcrest.Matchers.equalTo;
 import static org.hamcrest.Matchers.hasSize;
 import static org.hamcrest.Matchers.is;
+import static org.hamcrest.Matchers.lessThan;
 import static org.hamcrest.Matchers.not;
 import static org.hamcrest.Matchers.sameInstance;
 import static org.junit.Assert.assertThat;
@@ -29,6 +30,8 @@ import static org.mockito.BDDMockito.given;
 import static org.mockito.Matchers.anyObject;
 import static org.mockito.Matchers.anyString;
 
+import java.util.List;
+
 import org.junit.Before;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -39,6 +42,7 @@ import org.parosproxy.paros.model.Model;
 import org.powermock.api.mockito.PowerMockito;
 import org.powermock.core.classloader.annotations.PrepareForTest;
 import org.powermock.modules.junit4.PowerMockRunner;
+import org.zaproxy.zap.control.AddOn;
 import org.zaproxy.zap.utils.I18N;
 import org.zaproxy.zap.utils.ZapXmlConfiguration;
 
@@ -201,4 +205,138 @@ public class PluginFactoryUnitTest extends PluginTestUtils {
         assertThat(otherPluginFactory.getAllPlugin().get(1), is(equalTo((Plugin) plugin)));
         assertThat(pluginFactory.getAllPlugin().get(1), is(not(sameInstance(otherPluginFactory.getAllPlugin().get(1)))));
     }
+
+    @Test
+    public void shouldOrderHighRiskAlertPluginsBeforeMedium() {
+        // Given
+        AbstractPlugin pluginHighAlert = createAbstractPlugin(1, Alert.RISK_HIGH);
+        AbstractPlugin pluginMediumAlert = createAbstractPlugin(2, Alert.RISK_MEDIUM);
+        PluginFactory.loadedPlugin(pluginHighAlert);
+        PluginFactory.loadedPlugin(pluginMediumAlert);
+        PluginFactory pluginFactory = new PluginFactory();
+        pluginFactory.loadAllPlugin(emptyConfig());
+        // When
+        pluginFactory.reset();
+        // Then
+        assertThat(indexOf(pluginHighAlert, pluginFactory), is(lessThan(indexOf(pluginMediumAlert, pluginFactory))));
+    }
+
+    @Test
+    public void shouldOrderMediumRiskAlertPluginsBeforeLow() {
+        // Given
+        AbstractPlugin pluginMediumAlert = createAbstractPlugin(1, Alert.RISK_MEDIUM);
+        AbstractPlugin pluginLowAlert = createAbstractPlugin(2, Alert.RISK_LOW);
+        PluginFactory.loadedPlugin(pluginMediumAlert);
+        PluginFactory.loadedPlugin(pluginLowAlert);
+        PluginFactory pluginFactory = new PluginFactory();
+        pluginFactory.loadAllPlugin(emptyConfig());
+        // When
+        pluginFactory.reset();
+        // Then
+        assertThat(indexOf(pluginMediumAlert, pluginFactory), is(lessThan(indexOf(pluginLowAlert, pluginFactory))));
+    }
+
+    @Test
+    public void shouldOrderLowRiskAlertPluginsBeforeInfo() {
+        // Given
+        AbstractPlugin pluginLowAlert = createAbstractPlugin(1, Alert.RISK_LOW);
+        AbstractPlugin pluginInfoAlert = createAbstractPlugin(2, Alert.RISK_INFO);
+        PluginFactory.loadedPlugin(pluginLowAlert);
+        PluginFactory.loadedPlugin(pluginInfoAlert);
+        PluginFactory pluginFactory = new PluginFactory();
+        pluginFactory.loadAllPlugin(emptyConfig());
+        // When
+        pluginFactory.reset();
+        // Then
+        assertThat(indexOf(pluginLowAlert, pluginFactory), is(lessThan(indexOf(pluginInfoAlert, pluginFactory))));
+    }
+
+    @Test
+    public void shouldOrderReleaseStatusPluginsBeforeBeta() {
+        // Given
+        AbstractPlugin pluginReleaseStatus = createAbstractPlugin(1, Alert.RISK_LOW, AddOn.Status.release);
+        AbstractPlugin pluginBetaStatus = createAbstractPlugin(2, Alert.RISK_HIGH, AddOn.Status.beta);
+        PluginFactory.loadedPlugin(pluginReleaseStatus);
+        PluginFactory.loadedPlugin(pluginBetaStatus);
+        PluginFactory pluginFactory = new PluginFactory();
+        pluginFactory.loadAllPlugin(emptyConfig());
+        // When
+        pluginFactory.reset();
+        // Then
+        assertThat(indexOf(pluginReleaseStatus, pluginFactory), is(lessThan(indexOf(pluginBetaStatus, pluginFactory))));
+    }
+
+    @Test
+    public void shouldOrderBetaStatusPluginBeforeAlpha() {
+        // Given
+        AbstractPlugin pluginBetaStatus = createAbstractPlugin(1, Alert.RISK_LOW, AddOn.Status.beta);
+        AbstractPlugin pluginAlphaStatus = createAbstractPlugin(2, Alert.RISK_HIGH, AddOn.Status.alpha);
+        PluginFactory.loadedPlugin(pluginBetaStatus);
+        PluginFactory.loadedPlugin(pluginAlphaStatus);
+        PluginFactory pluginFactory = new PluginFactory();
+        pluginFactory.loadAllPlugin(emptyConfig());
+        // When
+        pluginFactory.reset();
+        // Then
+        assertThat(indexOf(pluginBetaStatus, pluginFactory), is(lessThan(indexOf(pluginAlphaStatus, pluginFactory))));
+    }
+
+    @Test
+    public void shouldOrderAlphaStatusPluginBeforeUnknown() {
+        // Given
+        AbstractPlugin pluginAlphaStatus = createAbstractPlugin(1, Alert.RISK_LOW, AddOn.Status.alpha);
+        AbstractPlugin pluginUnknownStatus = createAbstractPlugin(2, Alert.RISK_HIGH, AddOn.Status.unknown);
+        PluginFactory.loadedPlugin(pluginAlphaStatus);
+        PluginFactory.loadedPlugin(pluginUnknownStatus);
+        PluginFactory pluginFactory = new PluginFactory();
+        pluginFactory.loadAllPlugin(emptyConfig());
+        // When
+        pluginFactory.reset();
+        // Then
+        assertThat(indexOf(pluginAlphaStatus, pluginFactory), is(lessThan(indexOf(pluginUnknownStatus, pluginFactory))));
+    }
+
+    @Test
+    public void shouldOrderByLowerPluginIdIfSameAlertRiskAndStatus() {
+        // Given
+        AbstractPlugin pluginLowerId = createAbstractPlugin(52, Alert.RISK_LOW, AddOn.Status.beta);
+        AbstractPlugin pluginHigherId = createAbstractPlugin(150, Alert.RISK_LOW, AddOn.Status.beta);
+        PluginFactory.loadedPlugin(pluginLowerId);
+        PluginFactory.loadedPlugin(pluginHigherId);
+        PluginFactory pluginFactory = new PluginFactory();
+        pluginFactory.loadAllPlugin(emptyConfig());
+        // When
+        pluginFactory.reset();
+        // Then
+        assertThat(indexOf(pluginLowerId, pluginFactory), is(lessThan(indexOf(pluginHigherId, pluginFactory))));
+    }
+
+    @Test
+    public void shouldOrderDependenciesBeforeDependentPlugins() {
+        // Given
+        AbstractPlugin dependentPlugin = createAbstractPlugin(1, "DependentPlugin", "DependencyPlugin1", "DependencyPlugin2");
+        AbstractPlugin dependencyPlugin1 = createAbstractPlugin(2, "DependencyPlugin1", "DependencyPlugin2");
+        AbstractPlugin dependencyPlugin2 = createAbstractPlugin(3, "DependencyPlugin2");
+        PluginFactory.loadedPlugin(dependentPlugin);
+        PluginFactory.loadedPlugin(dependencyPlugin1);
+        PluginFactory.loadedPlugin(dependencyPlugin2);
+        PluginFactory pluginFactory = new PluginFactory();
+        pluginFactory.loadAllPlugin(emptyConfig());
+        // When
+        pluginFactory.reset();
+        // Then
+        assertThat(indexOf(dependencyPlugin1, pluginFactory), is(lessThan(indexOf(dependentPlugin, pluginFactory))));
+        assertThat(indexOf(dependencyPlugin2, pluginFactory), is(lessThan(indexOf(dependentPlugin, pluginFactory))));
+        assertThat(indexOf(dependencyPlugin2, pluginFactory), is(lessThan(indexOf(dependencyPlugin1, pluginFactory))));
+    }
+
+    private static int indexOf(AbstractPlugin plugin, PluginFactory pluginFactory) {
+        List<Plugin> pending = pluginFactory.getPending();
+        for (int i = 0; i < pending.size(); i++) {
+            if (plugin.getId() == pending.get(i).getId()) {
+                return i;
+            }
+        }
+        return -1;
+    }
 }
diff --git a/test/org/parosproxy/paros/core/scanner/PluginTestUtils.java b/test/org/parosproxy/paros/core/scanner/PluginTestUtils.java
index e0723ef17..cdbf7077d 100644
--- a/test/org/parosproxy/paros/core/scanner/PluginTestUtils.java
+++ b/test/org/parosproxy/paros/core/scanner/PluginTestUtils.java
@@ -26,6 +26,7 @@ import org.apache.log4j.Logger;
 import org.apache.log4j.varia.NullAppender;
 import org.junit.BeforeClass;
 import org.parosproxy.paros.network.HttpMessage;
+import org.zaproxy.zap.control.AddOn;
 import org.zaproxy.zap.control.AddOn.Status;
 import org.zaproxy.zap.model.Tech;
 import org.zaproxy.zap.model.TechSet;
@@ -61,6 +62,24 @@ public class PluginTestUtils {
         return new TestPlugin(id);
     }
 
+    protected static AbstractPlugin createAbstractPlugin(int id, int risk) {
+        return new TestPlugin(id, risk);
+    }
+
+    protected static AbstractPlugin createAbstractPlugin(int id, int risk, AddOn.Status status) {
+        AbstractPlugin plugin = createAbstractPlugin(id, risk);
+        plugin.setStatus(status);
+        return plugin;
+    }
+
+    protected static AbstractPlugin createAbstractPlugin(int id, String codeName) {
+        return new TestPlugin(id, codeName);
+    }
+
+    protected static AbstractPlugin createAbstractPlugin(int id, String codeName, String... dependencies) {
+        return new TestPlugin(id, codeName, dependencies);
+    }
+
     protected static AbstractPlugin createNonVisibleAbstractPlugin() {
         return new NonVisibleTestPlugin();
     }
@@ -79,14 +98,34 @@ public class PluginTestUtils {
 
     private static class TestPlugin extends AbstractPlugin {
 
-        private final int id;
+        private static final int NOT_DEFINED = -1;
+
+        private int id;
+        private int risk;
+        private String codeName;
+        private String[] dependencies;
 
         public TestPlugin() {
-            this.id = 0;
+            this(0);
         }
 
         public TestPlugin(int id) {
+            this(id, NOT_DEFINED);
+        }
+
+        public TestPlugin(int id, int risk) {
             this.id = id;
+            this.risk = risk;
+        }
+
+        public TestPlugin(int id, String codeName) {
+            this(id, codeName, (String[]) null);
+        }
+
+        public TestPlugin(int id, String codeName, String... dependencies) {
+            this(id);
+            this.codeName = codeName;
+            this.dependencies = dependencies;
         }
 
         @Override
@@ -99,6 +138,22 @@ public class PluginTestUtils {
             return null;
         }
 
+        @Override
+        public String getCodeName() {
+            if (codeName != null) {
+                return codeName;
+            }
+            return super.getCodeName();
+        }
+
+        @Override
+        public String[] getDependency() {
+            if (dependencies != null) {
+                return dependencies;
+            }
+            return super.getDependency();
+        }
+
         @Override
         public String getDescription() {
             return null;
@@ -126,6 +181,30 @@ public class PluginTestUtils {
         @Override
         public void notifyPluginCompleted(HostProcess parent) {
         }
+
+        @Override
+        public int getRisk() {
+            if (risk == NOT_DEFINED) {
+                return super.getRisk();
+            }
+            return risk;
+        }
+
+        @Override
+        public void cloneInto(Plugin plugin) {
+            super.cloneInto(plugin);
+            if (plugin instanceof TestPlugin) {
+                ((TestPlugin) plugin).id = id;
+                ((TestPlugin) plugin).risk = risk;
+                ((TestPlugin) plugin).codeName = codeName;
+                ((TestPlugin) plugin).dependencies = dependencies;
+            }
+        }
+
+        @Override
+        public String toString() {
+            return getCodeName();
+        }
     }
 
     private static class NonVisibleTestPlugin extends TestPlugin {
