<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:44:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DAEMON-87] procrun as tomcat5.exe from Tomcat 5.5.17 does not start, when installed into the file path containing non-ascii character</title>
                <link>https://issues.apache.org/jira/browse/DAEMON-87</link>
                <project id="12310468" key="DAEMON">Commons Daemon</project>
                    <description>&lt;p&gt;Tomcat Service can not be started if Tomcat was installed into the path, &lt;br/&gt;
containing non-ASCII (e.g. Japanese or Chinese) symbols.&lt;/p&gt;

&lt;p&gt;The problem is apparently due to the improper treatment of non-ascii &lt;br/&gt;
characters in the &quot;Java classpath&quot; section of the Service settings.&lt;/p&gt;

&lt;p&gt;In tomcat5w.exe GUI or windows registry I could see proper PATH, namely&lt;br/&gt;
C:[ONE CHINESE HIEROGLIPH]\Tomcat 5.5\bin\bootstrap.jar&lt;/p&gt;

&lt;p&gt;Unfortunately, service doesn&apos;t get started with the following log:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2006-09-15 18:29:17&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;457  javajni.c&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;error&amp;#93;&lt;/span&gt; FindClass &lt;br/&gt;
org/apache/catalina/startup/Bootstrap failed&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2006-09-15 18:29:17&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;935  prunsrv.c&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;error&amp;#93;&lt;/span&gt; Failed loading main &lt;br/&gt;
org/apache/catalina/startup/Bootstrap class C:\ss\Tomcat 5.5\bin\bootstrap.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2006-09-15 18:29:17&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;1179 prunsrv.c&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;error&amp;#93;&lt;/span&gt; ServiceStart returned 3&lt;/p&gt;

&lt;p&gt;where the non-ascii symbol gets replaced with improper ascii &apos;ss&apos; sequence.&lt;/p&gt;


&lt;p&gt;Moreover, I tried to define environmental variables PR_CLASSPATH and &lt;br/&gt;
PR_STARTPATH instead of using corresponding service params. The result is &lt;br/&gt;
exactly the same.&lt;/p&gt;

&lt;p&gt;Please, suggest me the workaround to make Tomcat service run.&lt;/p&gt;

&lt;p&gt;P.S. The problem is stable either under JRE 1.5.0_02 or 1.4.2_10 (within &lt;br/&gt;
tomcat compatibility package). The problem exist apparently under all OS (in &lt;br/&gt;
particular, it was detected on Windows 2000 and Windows XP Pro 2002 SP2 either &lt;br/&gt;
Chinese version or standard English with Chinese System locale installed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12350222">DAEMON-87</key>
            <summary>procrun as tomcat5.exe from Tomcat 5.5.17 does not start, when installed into the file path containing non-ascii character</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="yurlit">Yury Litvinov</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Sep 2006 04:40:04 +0000</created>
                <updated>Tue, 14 Nov 2017 14:41:40 +0000</updated>
                            <resolved>Tue, 14 Nov 2017 14:41:40 +0000</resolved>
                                                    <fixVersion>1.0.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12438588" author="yurlit" created="Thu, 28 Sep 2006 23:40:30 +0000"  >&lt;p&gt;The problem was apparently that some wide-character registry settings (namely, Classpath and Options) are not properly converted, using LPSTR WideToAscii(LPCWSTR ws, LPSTR s) and LPSTR MzWideToAscii(LPCWSTR ws, LPSTR s) (that basically ignores the higher byte), while passing values into Java Invocation API.&lt;/p&gt;

&lt;p&gt;The solution is to convert these wide-char values properly to multibyte.&lt;br/&gt;
I attach the updated utils.c that contains two implemented functions &lt;br/&gt;
LPSTR WideToMbyte(LPCWSTR ws), LPSTR MzWideToMbyte(LPCWSTR ws).&lt;br/&gt;
and prunsrv.c that basically uses these functions for proper converting.&lt;/p&gt;

&lt;p&gt;Please, grep for &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/DAEMON-87&quot; title=&quot;procrun as tomcat5.exe from Tomcat 5.5.17 does not start, when installed into the file path containing non-ascii character&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DAEMON-87&quot;&gt;&lt;del&gt;DAEMON-87&lt;/del&gt;&lt;/a&gt;&quot; into attached files to locale all changes concerning fixing this bug on our site.&lt;/p&gt;

&lt;p&gt;I would be grateful if you could propogate these changes to your coming release sooner.&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="12438589" author="yurlit" created="Thu, 28 Sep 2006 23:47:07 +0000"  >&lt;p&gt;It is modified  \procrun\srs\utils.c. Please use &apos;&lt;a href=&quot;https://issues.apache.org/jira/browse/DAEMON-87&quot; title=&quot;procrun as tomcat5.exe from Tomcat 5.5.17 does not start, when installed into the file path containing non-ascii character&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DAEMON-87&quot;&gt;&lt;del&gt;DAEMON-87&lt;/del&gt;&lt;/a&gt;&apos; for quick search of all places.&lt;/p&gt;</comment>
                            <comment id="12438590" author="yurlit" created="Thu, 28 Sep 2006 23:48:21 +0000"  >&lt;p&gt;It is modified  \procrun\apps\prunsrv\prunsrv.c. Please use &apos;&lt;a href=&quot;https://issues.apache.org/jira/browse/DAEMON-87&quot; title=&quot;procrun as tomcat5.exe from Tomcat 5.5.17 does not start, when installed into the file path containing non-ascii character&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DAEMON-87&quot;&gt;&lt;del&gt;DAEMON-87&lt;/del&gt;&lt;/a&gt;&apos; for quick search of all places.&lt;/p&gt;</comment>
                            <comment id="12438593" author="yurlit" created="Thu, 28 Sep 2006 23:52:14 +0000"  >&lt;p&gt;Modifed original file  prunsrv\include\apxwin.h. Contains function declarations implemented into utils.h. Please use &apos;&lt;a href=&quot;https://issues.apache.org/jira/browse/DAEMON-87&quot; title=&quot;procrun as tomcat5.exe from Tomcat 5.5.17 does not start, when installed into the file path containing non-ascii character&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DAEMON-87&quot;&gt;&lt;del&gt;DAEMON-87&lt;/del&gt;&lt;/a&gt;&apos; to grep changes quickly.&lt;/p&gt;</comment>
                            <comment id="12481943" author="mturk@apache.org" created="Sun, 18 Mar 2007 14:32:07 +0000"  >&lt;p&gt;Fixed in the SVN.&lt;br/&gt;
See:&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;rev=519615&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;rev=519615&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12525032">DAEMON-218</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12341940" name="apxwin.h" size="7123" author="yurlit" created="Thu, 28 Sep 2006 23:52:14 +0000"/>
                            <attachment id="12341939" name="prunsrv.c" size="50420" author="yurlit" created="Thu, 28 Sep 2006 23:48:21 +0000"/>
                            <attachment id="12341938" name="utils.c" size="25641" author="yurlit" created="Thu, 28 Sep 2006 23:47:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34422</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uyg7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178722</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>