<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:46:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DAEMON-458] The changes in DAEMON-446 cause existing DependsOn values to be removed</title>
                <link>https://issues.apache.org/jira/browse/DAEMON-458</link>
                <project id="12310468" key="DAEMON">Commons Daemon</project>
                    <description>&lt;p&gt;As part of &lt;a href=&quot;https://issues.apache.org/jira/browse/DAEMON-446&quot; title=&quot;Update service (//US) does not change DependsOn&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DAEMON-446&quot;&gt;&lt;del&gt;DAEMON-446&lt;/del&gt;&lt;/a&gt; a regression was introduced that causes existing service DependsOn services to be removed when working with the //US option.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Replication:&lt;/p&gt;

&lt;p&gt;Run:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
prunsrv.exe &lt;span class=&quot;code-comment&quot;&gt;//IS/MyService --Startup=auto --Description=MyService --DisplayName=MyService
&lt;/span&gt;sc config MyService depend=Tcpip/Afd/Dhcp &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;View the services and note that &lt;b&gt;MyService&lt;/b&gt; depends on Dhcp (the sc config command is being used to represent a separate script call)&lt;/p&gt;

&lt;p&gt;Now run:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
prunsrv.exe &lt;span class=&quot;code-comment&quot;&gt;//US/MyService --Startup=manual &lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;View the services and note that MyService no longer depends on Dhcp&lt;/p&gt;

&lt;p&gt;The offending code appears to be the following in service.c:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;/* Add the mandatory dependencies */&lt;/span&gt;
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (lpDependencies) {
&#160; &#160; &#160; &#160; lpDependencies = apxMultiSzCombine(NULL, lpDependencies,
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;L&lt;span class=&quot;code-quote&quot;&gt;&quot;Tcpip\0Afd\0&quot;&lt;/span&gt;, NULL);
&#160; &#160; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&#160; &#160; &#160; &#160; lpDependencies = L&lt;span class=&quot;code-quote&quot;&gt;&quot;Tcpip\0Afd\0&quot;&lt;/span&gt;;
&#160; &#160; }&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Which means if DependsOn isn&apos;t defined we&apos;ll always pass down Tcpip and Afd, vs the NULL that happened before. Wiping existing custom dependancies out.&lt;/p&gt;

&lt;p&gt;I didn&apos;t test it but this code may not work properly with the &#8211; vs ++ logic defined under &lt;a href=&quot;https://commons.apache.org/proper/commons-daemon/procrun.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://commons.apache.org/proper/commons-daemon/procrun.html&lt;/a&gt; The &lt;a href=&quot;https://issues.apache.org/jira/browse/DAEMON-446&quot; title=&quot;Update service (//US) does not change DependsOn&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DAEMON-446&quot;&gt;&lt;del&gt;DAEMON-446&lt;/del&gt;&lt;/a&gt; ticket talks about --DependsOn (full replace) although I only see ++Depends on documented, so maybe &lt;a href=&quot;https://issues.apache.org/jira/browse/DAEMON-446&quot; title=&quot;Update service (//US) does not change DependsOn&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DAEMON-446&quot;&gt;&lt;del&gt;DAEMON-446&lt;/del&gt;&lt;/a&gt; was actually invalid to begin with?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13532386">DAEMON-458</key>
            <summary>The changes in DAEMON-446 cause existing DependsOn values to be removed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="brianandle">Brian Andle</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Apr 2023 17:39:05 +0000</created>
                <updated>Fri, 12 May 2023 13:37:32 +0000</updated>
                            <resolved>Thu, 20 Apr 2023 18:32:02 +0000</resolved>
                                    <version>1.3.2</version>
                    <version>1.3.3</version>
                                    <fixVersion>1.3.4</fixVersion>
                                    <component>Procrun</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17714527" author="markt" created="Thu, 20 Apr 2023 10:43:07 +0000"  >&lt;p&gt;Thanks for the report. I can repeat this issue. Procrun isn&apos;t taking into account any changes that may have been made to the service configuration outside of Procrun. I&apos;ll see if it is possible to do anything about that although part of me is thinking that the service should either be managed using procrun or externally to procrun and that a mix of both approaches is asking for trouble to some extent.&lt;br/&gt;
Note that the &apos;++&apos; and &apos;--&apos; variations of &apos;DependsOn&apos; both work as expected.&lt;/p&gt;</comment>
                            <comment id="17714583" author="markt" created="Thu, 20 Apr 2023 12:50:43 +0000"  >&lt;p&gt;It is fairly simple to fix things so dependencies can be managed either via &apos;sc config ...&apos; or via &apos;DependsOn&apos;. I&apos;l commit a fix shortly that does that. Note that once &apos;DependsOn&apos; has been used with a service, any value set will override anything set via `sc config` the next time &apos;//US&apos; is used.&lt;/p&gt;

&lt;p&gt;Being able to &apos;sc config ...&apos; and &apos;DependsOn&apos; interchangeably looks to be a lot trickier. I&apos;m not at the point yet where I think the solution is documenting that this isn&apos;t supported but it is certainly a possibility.&lt;/p&gt;</comment>
                            <comment id="17714590" author="JIRAUSER287474" created="Thu, 20 Apr 2023 13:09:39 +0000"  >&lt;p&gt;Can we tell if DependsOn has been passed in on the command line? I.e. pass NULL to the existing method if the the DependsOn isn&apos;t explicitly passed in when //US is used? Since //US didn&apos;t used to impact values that weren&apos;t explicitly passed.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Not supporting the ++DependsOn and sc makes complete sense to me, should be documented, but modifying attributes not passed in the command doesn&apos;t make sense to me.&lt;/p&gt;</comment>
                            <comment id="17714708" author="markt" created="Thu, 20 Apr 2023 18:32:02 +0000"  >&lt;p&gt;It turns out pretty much all of the plumbing to get this working was in place, I just had to switch the code to use the existing service dependencies in the registry rather than maintaining its own, separate registry entry.&lt;/p&gt;</comment>
                            <comment id="17714718" author="JIRAUSER287474" created="Thu, 20 Apr 2023 19:03:08 +0000"  >&lt;p&gt;Cool. Thanks for digging into, and fixing, this Mark.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 29 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1h8vc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>