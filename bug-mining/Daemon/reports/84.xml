<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:45:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DAEMON-302] Service recovery options do not work when a JNI crash brings down the JVM</title>
                <link>https://issues.apache.org/jira/browse/DAEMON-302</link>
                <project id="12310468" key="DAEMON">Commons Daemon</project>
                    <description>&lt;p&gt;We have a java application that we run as a service which has a C component setup, and communicated to across the Java Native Interface. &lt;/p&gt;

&lt;p&gt;If a crash occurs in the C component the whole JVM is brought down. However this does not trigger the service recovery options to kick in.&lt;/p&gt;

&lt;p&gt;I believe this is due to a VM exit code of 0 (see bellow).&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2013-06-27 11:55:47&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;debug&amp;#93;&lt;/span&gt; ( prunsrv.c:1528) [ 8488] Waiting for worker to finish...&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2013-06-27 11:55:55&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;debug&amp;#93;&lt;/span&gt; ( javajni.c:964 ) [ 5716] Java Worker thread finished applicationName/core/applicationNameCore:main with status=0&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2013-06-27 11:55:55&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;debug&amp;#93;&lt;/span&gt; ( prunsrv.c:1533) [ 8488] Worker finished.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2013-06-27 11:55:55&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;debug&amp;#93;&lt;/span&gt; ( prunsrv.c:1559) [ 8488] Waiting for all threads to exit&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2013-06-27 11:56:46&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;debug&amp;#93;&lt;/span&gt; ( prunsrv.c:919 ) &lt;span class=&quot;error&quot;&gt;&amp;#91;10160&amp;#93;&lt;/span&gt; Start exit hook called ...&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2013-06-27 11:56:46&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;debug&amp;#93;&lt;/span&gt; ( prunsrv.c:920 ) &lt;span class=&quot;error&quot;&gt;&amp;#91;10160&amp;#93;&lt;/span&gt; VM exit code: 0&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2013-06-27 11:56:46&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;debug&amp;#93;&lt;/span&gt; ( prunsrv.c:844 ) &lt;span class=&quot;error&quot;&gt;&amp;#91;10160&amp;#93;&lt;/span&gt; reportServiceStatusE: 1, 0, 0, 0&lt;/p&gt;

&lt;p&gt;With a return code of 0, the SCM would think the service stopped safely, without error, which is not the case here since the JNI has crashed.&lt;/p&gt;

&lt;p&gt;Is there anything that can be done about this?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7 64bit&lt;br/&gt;
JRE 1.7.0_25-b17 (64bit)&lt;/p&gt;</environment>
        <key id="12655295">DAEMON-302</key>
            <summary>Service recovery options do not work when a JNI crash brings down the JVM</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="empirechaotix">Iain Williams</reporter>
                        <labels>
                            <label>jni</label>
                            <label>jvm</label>
                            <label>procrun</label>
                            <label>service</label>
                    </labels>
                <created>Fri, 28 Jun 2013 09:39:19 +0000</created>
                <updated>Wed, 12 Jun 2019 17:55:43 +0000</updated>
                            <resolved>Thu, 26 Oct 2017 19:46:08 +0000</resolved>
                                    <version>1.0.15</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>Procrun</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13702038" author="mturk@apache.org" created="Mon, 8 Jul 2013 14:48:07 +0000"  >&lt;p&gt;Since &apos;normal&apos; jvm operation can return non zero exit codes (depending on the application itself)&lt;br/&gt;
we cannot use that. Our &apos;VM exit code&apos; only reflects the errors in starting VM.&lt;br/&gt;
From Commons Daemon perspective the VM exited cleanly since main() terminated.&lt;/p&gt;

&lt;p&gt;Anyhow, I think no one should ever try to auto restart crashed VM.&lt;br/&gt;
Not sure if JNI core produces special VM exit code. If it does we could use that as config param filter value for reportServiceStatus&lt;/p&gt;</comment>
                            <comment id="16221103" author="markt" created="Thu, 26 Oct 2017 19:46:08 +0000"  >&lt;p&gt;There are multiple parts to this.&lt;/p&gt;

&lt;p&gt;For jni mode, an &apos;abort&apos; hook has been added that sets a non-zero exit code when the JVM crashes. This is sufficient to trigger recovery for jni mode.&lt;/p&gt;

&lt;p&gt;For Java and exe modes, a crash will trigger a non-zero exit code. It is therefore necessary for additional configuration to be made in the recovery tab. If the &quot;Enable actions for stops with errors.&quot; checkbox is enabled, then a crash will trigger recovery in java and exe modes&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12544803">DAEMON-243</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>335572</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 3 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1lvuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>335896</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>