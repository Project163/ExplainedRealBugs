<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:45:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DAEMON-358] PPC64: jsvc fails to find JVM jvm.cfg file and shared objects due to wrong path</title>
                <link>https://issues.apache.org/jira/browse/DAEMON-358</link>
                <project id="12310468" key="DAEMON">Commons Daemon</project>
                    <description>&lt;p&gt;On ppc64 and ppc64le archs jsvc looks for jvm.cfg and JVM shared objects in the wrong path. Be it used with IBM Java or OpenJDK (where the problem was first encountered), there is no dir called power64 or power64le. Instead ppc64 and ppc64le are used. In doing so, it fails with &quot;Cannot find any VM in Java Home&quot;&lt;/p&gt;

&lt;p&gt;Contact Information = gromero@br.ibm.com &lt;/p&gt;

&lt;p&gt;uname output:&lt;br/&gt;
Linux gromero18 3.10.0-505.el7.ppc64le #1 SMP Tue Sep 6 11:09:32 EDT 2016 ppc64le ppc64le ppc64le GNU/Linux&lt;/p&gt;

&lt;p&gt;Machine Type = pKVM &lt;/p&gt;

&lt;p&gt;Debugger:&lt;br/&gt;
A debugger is not configured&lt;/p&gt;

&lt;p&gt;Steps to Reproduce:&lt;br/&gt;
 yum install apache-commons-daemon-jsvc&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;cat MyClass.java&lt;br/&gt;
public class MyClass {&lt;br/&gt;
  public void init(String[] args) 
{
    System.out.println(&quot;Init...&quot;);
  }&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;  public void start() &lt;/p&gt;
{
    System.out.println(&quot;Start...&quot;);
  }

&lt;p&gt;  public void stop() &lt;/p&gt;
{
    System.out.println(&quot;Stop...&quot;);
  }

&lt;p&gt;  public void destroy() &lt;/p&gt;
{
    System.out.println(&quot;Destroy...&quot;);
  }
&lt;p&gt;}&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;javac MyClass.java&lt;/li&gt;
	&lt;li&gt;jar cvf my.jar MyClass.class&lt;/li&gt;
	&lt;li&gt;/bin/jsvc -debug -user root -java-home /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.111-2.b15.el7_3.ppc64le -cp /usr/share/java/apache-commons-daemon.jar:/root/my.jar MyClass -start&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Then:&lt;br/&gt;
Attempting to locate Java Home in /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.111-2.b15.el7_3.ppc64le&lt;br/&gt;
Attempting to locate VM configuration file /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.111-2.b15.el7_3.ppc64le/jre/lib/jvm.cfg&lt;br/&gt;
Attempting to locate VM configuration file /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.111-2.b15.el7_3.ppc64le/lib/jvm.cfg&lt;br/&gt;
Attempting to locate VM configuration file /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.111-2.b15.el7_3.ppc64le/jre/lib/powerpc64le/jvm.cfg&lt;br/&gt;
Attempting to locate VM configuration file /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.111-2.b15.el7_3.ppc64le/lib/powerpc64le/jvm.cfg&lt;br/&gt;
VM configuration file not found&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;Java Version: openjdk version &quot;1.8.0_111&quot; OpenJDK Runtime Environment (build 1.8.0_111-b15) OpenJDK 64-Bit Server VM (build 25.111-b15, mixed mode)&lt;/p&gt;

&lt;p&gt;Userspace rpm:&lt;br/&gt;
apache-commons-daemon-jsvc-1.0.13-6.el7.ppc64le.rpm&lt;/p&gt;

&lt;p&gt;The userspace tool has the following bit modes: 64-bit&lt;/p&gt;</description>
                <environment></environment>
        <key id="13022926">DAEMON-358</key>
            <summary>PPC64: jsvc fails to find JVM jvm.cfg file and shared objects due to wrong path</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="gromero">Gustavo Romero</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Nov 2016 16:57:34 +0000</created>
                <updated>Thu, 23 Nov 2017 09:48:26 +0000</updated>
                            <resolved>Mon, 28 Nov 2016 15:03:12 +0000</resolved>
                                    <version>1.0.13</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>Jsvc</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="2700">0.75h</timeoriginalestimate>
                            <timeestimate seconds="2700">0.75h</timeestimate>
                                        <comments>
                            <comment id="15690744" author="gromero" created="Wed, 23 Nov 2016 17:08:54 +0000"  >&lt;p&gt;Set correct path names for PPC64 BE and LE archs&lt;/p&gt;</comment>
                            <comment id="15690748" author="gromero" created="Wed, 23 Nov 2016 17:09:58 +0000"  >&lt;p&gt;Dear developer, please consider applying the patch provided above to fix the issue here described. Thank you.&lt;/p&gt;</comment>
                            <comment id="15691149" author="markt" created="Wed, 23 Nov 2016 19:32:52 +0000"  >&lt;p&gt;As well as being a duplicate, the proposed patch is wrong since it attempts to patch a generated file.&lt;/p&gt;</comment>
                            <comment id="15694167" author="gromero" created="Thu, 24 Nov 2016 20:35:53 +0000"  >&lt;p&gt;Indicated fix already mergerd in trunk does not resolve the issue&lt;/p&gt;</comment>
                            <comment id="15694172" author="gromero" created="Thu, 24 Nov 2016 20:39:39 +0000"  >&lt;p&gt;Hi Mark,&lt;/p&gt;

&lt;p&gt;I just compiled the trunk HEAD (which contains the fix you pointed out):&lt;/p&gt;

&lt;p&gt;Path: unix&lt;br/&gt;
URL: &lt;a href=&quot;http://svn.apache.org/repos/asf/commons/proper/daemon/trunk/src/native/unix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/repos/asf/commons/proper/daemon/trunk/src/native/unix&lt;/a&gt;&lt;br/&gt;
Relative URL: ^/commons/proper/daemon/trunk/src/native/unix&lt;br/&gt;
Repository Root: &lt;a href=&quot;http://svn.apache.org/repos/asf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/repos/asf&lt;/a&gt;&lt;br/&gt;
Repository UUID: 13f79535-47bb-0310-9956-ffa450edef68&lt;br/&gt;
Revision: 1771220&lt;br/&gt;
Node Kind: directory&lt;br/&gt;
Last Changed Author: markt&lt;br/&gt;
Last Changed Rev: 1768609&lt;br/&gt;
Last Changed Date: 2016-11-07 18:23:18 -0500 (Mon, 07 Nov 2016)&lt;/p&gt;

&lt;p&gt;but the path is not correct also there:&lt;/p&gt;

&lt;p&gt;$ ./jsvc -debug -user gromero -java-home /usr/lib/jvm/java-1.8.0-openjdk-ppc64el -cp /usr/share/java/apache-commons-daemon.jar:/root/my.jar MyClass -start&lt;br/&gt;
+-- DUMPING PARSED COMMAND LINE ARGUMENTS --------------&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Detach:          True&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Show Version:    No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Show Help:       No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Check Only:      Disabled&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Stop:            False&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Wait:            0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Run as service:  No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Install service: No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Remove service:  No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; JVM Name:        &quot;null&quot;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Java Home:       &quot;/usr/lib/jvm/java-1.8.0-openjdk-ppc64el&quot;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; PID File:        &quot;/var/run/jsvc.pid&quot;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; User Name:       &quot;gromero&quot;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Extra Options:   1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   &quot;-Djava.class.path=/usr/share/java/apache-commons-daemon.jar:/root/my.jar&quot;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Class Invoked:   &quot;MyClass&quot;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Class Arguments: 1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   &quot;-start&quot;&lt;br/&gt;
+-------------------------------------------------------&lt;br/&gt;
Cannot set supplement group list for user &apos;gromero&apos;&lt;br/&gt;
No need to change user to &apos;gromero&apos;!&lt;br/&gt;
User &apos;gromero&apos; validated&lt;br/&gt;
Attempting to locate Java Home in /usr/lib/jvm/java-1.8.0-openjdk-ppc64el&lt;br/&gt;
Attempting to locate VM configuration file /usr/lib/jvm/java-1.8.0-openjdk-ppc64el/jre/lib/jvm.cfg&lt;br/&gt;
Attempting to locate VM configuration file /usr/lib/jvm/java-1.8.0-openjdk-ppc64el/lib/jvm.cfg&lt;br/&gt;
Attempting to locate VM configuration file /usr/lib/jvm/java-1.8.0-openjdk-ppc64el/jre/lib/powerpc64le/jvm.cfg&lt;br/&gt;
Attempting to locate VM configuration file /usr/lib/jvm/java-1.8.0-openjdk-ppc64el/lib/powerpc64le/jvm.cfg&lt;br/&gt;
VM configuration file not found&lt;br/&gt;
Attempting to locate VM library /usr/lib/jvm/java-1.8.0-openjdk-ppc64el/jre/lib/powerpc64le/classic/libjvm.so&lt;br/&gt;
Attempting to locate VM library /usr/lib/jvm/java-1.8.0-openjdk-ppc64el/jre/lib/powerpc64le/server/libjvm.so&lt;br/&gt;
Attempting to locate VM library /usr/lib/jvm/java-1.8.0-openjdk-ppc64el/jre/lib/powerpc64le/client/libjvm.so&lt;br/&gt;
Attempting to locate VM library /usr/lib/jvm/java-1.8.0-openjdk-ppc64el/jre/lib/powerpc64le/libjvm.so&lt;br/&gt;
...&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;So it&apos;s still looking for $JAVA_HOME/*/powerpc64le which is wrong.&lt;/p&gt;

&lt;p&gt;Could you please verify that again?&lt;/p&gt;

&lt;p&gt;I can test it on a Power machine if it makes sense for you.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="15702166" author="markt" created="Mon, 28 Nov 2016 15:03:13 +0000"  >&lt;p&gt;Should be fixed now. I don;t have access to that architecture for testing so if you can confirm the fix, that would be helpful.&lt;/p&gt;</comment>
                            <comment id="15702725" author="gromero" created="Mon, 28 Nov 2016 18:28:51 +0000"  >&lt;p&gt;Thank you very much for fixing that.&lt;/p&gt;

&lt;p&gt;It works now.&lt;/p&gt;

&lt;p&gt;I&apos;ve tested on:&lt;/p&gt;

&lt;p&gt;Ubuntu 16.04 + OpenJDK 8 (which supports only PPC64 LE):&lt;br/&gt;
$ java -version&lt;br/&gt;
openjdk version &quot;1.8.0_111&quot;&lt;br/&gt;
OpenJDK Runtime Environment (build 1.8.0_111-8u111-b14-2ubuntu0.16.04.2-b14)&lt;br/&gt;
OpenJDK 64-Bit Server VM (build 25.111-b14, mixed mode)&lt;/p&gt;

&lt;p&gt;RHEL 7.3 + IBM Java 8 (PPC64 LE):&lt;br/&gt;
$ java -version&lt;br/&gt;
java version &quot;1.8.0&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build pxl6480sr3fp20-20161019_02(SR3 FP20))&lt;br/&gt;
IBM J9 VM (build 2.8, JRE 1.8.0 Linux ppc64le-64 Compressed References 20161013_322271 (JIT enabled, AOT enabled)&lt;br/&gt;
J9VM - R28_Java8_SR3_20161013_1635_B322271&lt;br/&gt;
JIT  - tr.r14.java.green_20161011_125790&lt;br/&gt;
GC   - R28_Java8_SR3_20161013_1635_B322271_CMPRSS&lt;br/&gt;
J9CL - 20161013_322271)&lt;br/&gt;
JCL - 20161018_01 based on Oracle jdk8u111-b14&lt;/p&gt;

&lt;p&gt;RHEL 7.3 + OpenJDK 8 (PPC64 LE):&lt;br/&gt;
$ java -version&lt;br/&gt;
openjdk version &quot;1.8.0_111&quot;&lt;br/&gt;
OpenJDK Runtime Environment (build 1.8.0_111-b15)&lt;br/&gt;
OpenJDK 64-Bit Server VM (build 25.111-b15, mixed mode)&lt;/p&gt;

&lt;p&gt;RHEL 7.3 + IBM Java 8 (PPC64 BE):&lt;br/&gt;
$ java -version&lt;br/&gt;
java version &quot;1.8.0&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build pxp6480sr3fp20-20161019_02(SR3 FP20))&lt;br/&gt;
IBM J9 VM (build 2.8, JRE 1.8.0 Linux ppc64-64 Compressed References 20161013_322271 (JIT enabled, AOT enabled)&lt;br/&gt;
J9VM - R28_Java8_SR3_20161013_1635_B322271&lt;br/&gt;
JIT  - tr.r14.java.green_20161011_125790&lt;br/&gt;
GC   - R28_Java8_SR3_20161013_1635_B322271_CMPRSS&lt;br/&gt;
J9CL - 20161013_322271)&lt;br/&gt;
JCL - 20161018_01 based on Oracle jdk8u111-b14&lt;/p&gt;

&lt;p&gt;RHEL 7.3 + OpenJDK 8 (PPC64 BE):&lt;br/&gt;
$ java -version&lt;br/&gt;
openjdk version &quot;1.8.0_111&quot;&lt;br/&gt;
OpenJDK Runtime Environment (build 1.8.0_111-b15)&lt;br/&gt;
OpenJDK 64-Bit Server VM (build 25.111-b15, mixed mode)&lt;/p&gt;

&lt;p&gt;AFAICS Java level 7 and future 9 will work as well.&lt;/p&gt;</comment>
                            <comment id="15702729" author="gromero" created="Mon, 28 Nov 2016 18:29:52 +0000"  >&lt;p&gt;Fixed&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12933351">DAEMON-343</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12840281" name="jvsc-ppc64.patch" size="1244" author="gromero" created="Wed, 23 Nov 2016 17:08:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 50 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36pf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>