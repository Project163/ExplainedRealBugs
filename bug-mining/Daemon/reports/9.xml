<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:44:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DAEMON-129] jsvc unable to start in OS X Snow Leopard (10.6)</title>
                <link>https://issues.apache.org/jira/browse/DAEMON-129</link>
                <project id="12310468" key="DAEMON">Commons Daemon</project>
                    <description>&lt;p&gt;After following the directions posted here (&lt;a href=&quot;http://www.malisphoto.com/tips/tomcatonosx.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.malisphoto.com/tips/tomcatonosx.html&lt;/a&gt;) I am unable to start up jsvc. Starting Tomcat 6 works just fine.&lt;/p&gt;

&lt;p&gt;When I attempt to start jsvc, it immediately exits with the following error:&lt;/p&gt;

&lt;p&gt;02/09/2009 16:46:42 30987 jsvc error: Cannot load required shell library /Library/Java/Home/../Libraries/libjvm_compat.dylib &lt;br/&gt;
02/09/2009 16:46:42 30986 jsvc error: Service exit with a return value of 1 &lt;/p&gt;

&lt;p&gt;Looking in my frameworks, it looks like &quot;libjvm_compat.dylib&quot; doesn&apos;t exist in Snow Leopard&apos;s installations of JDK 1.5 and 1.6. It looks like the reference to this file is made in java.c, but I&apos;m not sure what to change this to. When changing it to simply &quot;libjvm.dylib&quot;, I get this error:&lt;/p&gt;

&lt;p&gt;03/09/2009 16:20:45 594 jsvc error: Cannot find JVM library entry point&lt;br/&gt;
03/09/2009 16:20:45 593 jsvc error: Service exit with a return value of 1&lt;/p&gt;

&lt;p&gt;Any thoughts would be much appreciated!&lt;/p&gt;</description>
                <environment>&lt;p&gt;Mac OS X 10.6, Tomcat 6, JDK 1.6&lt;/p&gt;</environment>
        <key id="12434901">DAEMON-129</key>
            <summary>jsvc unable to start in OS X Snow Leopard (10.6)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bemaniac">Adam Singer</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Sep 2009 23:56:10 +0000</created>
                <updated>Fri, 26 Feb 2010 16:49:09 +0000</updated>
                            <resolved>Sat, 6 Feb 2010 12:25:43 +0000</resolved>
                                    <version>1.0.1</version>
                                    <fixVersion>1.0.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12759199" author="dougkiley" created="Thu, 24 Sep 2009 18:15:46 +0000"  >&lt;p&gt;Adam,&lt;/p&gt;

&lt;p&gt;I don&apos;t have any particular knowledge of the jsvc code, but I have been poking around for the last day. I could be way off base with what I&apos;ve done so far, but judging from the amount of people around the web asking for a fix and the lack of a solution I bet the problem isn&apos;t a simple one.&lt;/p&gt;

&lt;p&gt;Here&apos;s what I have found:&lt;br/&gt;
I got the same initial error message that you got. This led me to look for info on what replaces libjvm_compat.dylib. Couldn&apos;t find anything on that.&lt;/p&gt;

&lt;p&gt;Next I found myself in java.c. It looks like what eventually fails is a call to JNI_CreateJavaVM which used to be in libjvm_compat.dylib. So now we need to find a new place to load this from.&lt;/p&gt;

&lt;p&gt;I wrote the following C program to run through the 6 choices of dylibs that were in Libraries.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;dlfcn.h&amp;gt;

int main (int argc, const char * argv[]) {
	
	/*
	 /System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Libraries/libclient.dylib
	 /System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Libraries/libhotspot.dylib
	 /System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Libraries/libjawt.dylib  ** works
	 /System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Libraries/libjvm.dylib
	 /System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Libraries/libserver.dylib
	 /System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Libraries/libverify.dylib ** works
	 
	 */
	
	void* hndl = dlopen(&quot;/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Libraries/libjawt.dylib&quot;,RTLD_GLOBAL|RTLD_NOW);
	void* success = dlsym(hndl,&quot;JNI_CreateJavaVM&quot;);
	if (success != NULL)
	{
		printf(&quot;Found JNI_CreateJavaVM&quot;);
	}
	else
	{
		printf(&quot;NOT FOUND&quot;);
	}
	
    return 0;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As you can see I found two that worked. I couldn&apos;t find any info on the web about the differences between libjawt and libverify.&lt;/p&gt;

&lt;p&gt;I changed my java.c to load from libverify.dylib instead of libjvm_compat.dylib. The only reason I picked liberify is because I found some Linux forums that were using libverify.so &amp;#8211; this wasn&apos;t for jsvc, but some other project.&lt;/p&gt;

&lt;p&gt;My current state is that jsvc will build and it does execute, but it won&apos;t grab any ports. I get 2 processes called jsvc, but they are both owned by root. It should be that one is owned by root and the other by my Tomcat user.&lt;/p&gt;

&lt;p&gt;I am working on getting the project into Xcode so that I can step through it and see what&apos;s going on.&lt;/p&gt;

&lt;p&gt;In debug.c I set log_debug_flag to true.&lt;br/&gt;
In tomcatctl I set JSVC_DEBUG=&quot;-debug -verbose&quot;.&lt;/p&gt;

&lt;p&gt;I am not getting any error messages to the console or catalina.out/err.&lt;/p&gt;

&lt;p&gt;I&apos;ve tried my Utilities/Java Preferences in both 32 bit and 64 bit mode. No difference either way.&lt;/p&gt;

&lt;p&gt;I&apos;m running Tomcat 5. Maybe I&apos;ll try 6 next.&lt;/p&gt;

&lt;p&gt;I hope this has given someone else an idea on what to try next.&lt;/p&gt;

&lt;p&gt;-Doug&lt;/p&gt;</comment>
                            <comment id="12761664" author="dougkiley" created="Fri, 2 Oct 2009 18:40:38 +0000"  >&lt;p&gt;I got mine working! ! ! &lt;/p&gt;

&lt;p&gt;Here&apos;s my patch file.&lt;/p&gt;

&lt;p&gt;I patched against the 1.0.1 source. Some of the changes came from other people&apos;s patch files. The important stuff for this issue is in java.c&lt;/p&gt;

&lt;p&gt;-Doug&lt;/p&gt;</comment>
                            <comment id="12830512" author="mturk@apache.org" created="Sat, 6 Feb 2010 12:25:43 +0000"  >&lt;p&gt;Committed as r907206. Thanks&lt;/p&gt;</comment>
                            <comment id="12832446" author="srijithunni" created="Thu, 11 Feb 2010 11:22:15 +0000"  >&lt;p&gt;Hi Mladen and Doug,&lt;/p&gt;

&lt;p&gt;      I applied the same patch on my box and tried to start the daemon, but what i notice is that it loads libverify.dylib correctly, but then it just crashes I see this message &quot;dyld: dyld std::terminate()&quot;. looks like some uncaught exception was thrown and it says service did not exit cleanly. I&apos;m not sure it the patch is working. Is it a requirement that jsvc must also be built on 10.6 for it to run on 10.6?&lt;/p&gt;

&lt;p&gt;    It would be really helpful if I could get this working.?&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Srijith.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12421136" name="jsvc_patch_snowleopard.patch" size="2840" author="dougkiley" created="Fri, 2 Oct 2009 18:40:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37676</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 41 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0tjxz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>170540</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>