diff --git a/oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/sort/StringSort.java b/oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/sort/StringSort.java
index c8f60bdedc..6ccbfa6403 100644
--- a/oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/sort/StringSort.java
+++ b/oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/sort/StringSort.java
@@ -208,16 +208,17 @@ public class StringSort implements Closeable {
         public void close() throws IOException {
             Closer closer = Closer.create();
             try {
-                closer.register(writer);
-                for (CloseableIterator citr : openedIterators) {
-                    closer.register(citr);
-                }
+                //Closing is done in LIFO manner!
                 closer.register(new Closeable() {
                     @Override
                     public void close() throws IOException {
                         FileUtils.deleteDirectory(workDir);
                     }
                 });
+                closer.register(writer);
+                for (CloseableIterator citr : openedIterators) {
+                    closer.register(citr);
+                }
             } finally {
                 closer.close();
             }
