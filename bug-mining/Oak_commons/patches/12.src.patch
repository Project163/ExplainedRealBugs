diff --git a/oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/json/JsopBuilder.java b/oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/json/JsopBuilder.java
index a9a8b9a777..8489197562 100644
--- a/oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/json/JsopBuilder.java
+++ b/oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/json/JsopBuilder.java
@@ -285,6 +285,7 @@ public class JsopBuilder implements JsopWriter {
     private static void escape(String s, int length, StringBuilder buff) {
         for (int i = 0; i < length; i++) {
             char c = s.charAt(i);
+            int ic = (int)c;
             switch (c) {
             case '"':
                 // quotation mark
@@ -316,10 +317,18 @@ public class JsopBuilder implements JsopWriter {
                 break;
             default:
                 if (c < ' ') {
-                    buff.append("\\u00");
-                    // guaranteed to be 1 or 2 hex digits only
-                    buff.append(Character.forDigit(c >>> 4, 16));
-                    buff.append(Character.forDigit(c & 15, 16));
+                    buff.append(String.format("\\u%04x", ic));
+                } else if (ic >= 0xD800 && ic <= 0xDBFF) {
+                    // isSurrogate(), only available in Java 7
+                    if (i < length - 1 && Character.isSurrogatePair(c, s.charAt(i + 1))) {
+                        // ok surrogate
+                        buff.append(c);
+                        buff.append(s.charAt(i + 1));
+                        i += 1;
+                    } else {
+                        // broken surrogate -> escape
+                        buff.append(String.format("\\u%04x", ic));
+                    }
                 } else {
                     buff.append(c);
                 }
diff --git a/oak-commons/src/test/java/org/apache/jackrabbit/oak/commons/json/JsopTest.java b/oak-commons/src/test/java/org/apache/jackrabbit/oak/commons/json/JsopTest.java
index 0d0cf28278..0479b0f686 100644
--- a/oak-commons/src/test/java/org/apache/jackrabbit/oak/commons/json/JsopTest.java
+++ b/oak-commons/src/test/java/org/apache/jackrabbit/oak/commons/json/JsopTest.java
@@ -259,6 +259,18 @@ public class JsopTest extends TestCase {
 
     }
 
+    public void testSurrogates() {
+        String[][] tests = { { "surrogate-ok: \uD834\uDD1E", "surrogate-ok: \uD834\uDD1E" },
+                { "surrogate-broken: \ud800 ", "surrogate-broken: \\ud800 " },
+                { "surrogate-truncated: \ud800", "surrogate-truncated: \\ud800" } };
+
+        for (String[] test : tests) {
+            StringBuilder buff = new StringBuilder();
+            JsopBuilder.escape(test[0], buff);
+            assertEquals(test[1], buff.toString());
+        }
+    }
+
     static void test(String expected, String json) {
         String j2 = prettyPrintWithErrors(json);
         assertEquals(expected, j2);
