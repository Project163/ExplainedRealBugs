<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:46:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[NIFI-9391] MergeRecord does not work in stateless flows</title>
                <link>https://issues.apache.org/jira/browse/NIFI-9391</link>
                <project id="12316020" key="NIFI">Apache NiFi</project>
                    <description>&lt;p&gt;The stateless runtime triggers a processor up until FFs are available in the upstream queue.&lt;/p&gt;

&lt;p&gt;MergeRecord needs an extra onTrigger() call where session.get() yields no result in order to get notified that no more FFs are available and it is time to send the merged FF downstream. This extra call will never happen in stateless environment and MergeRecord cannot send out FF in this way.&lt;/p&gt;

&lt;p&gt;Modify MergeRecord to run session.get() in a loop within a single onTrigger() call like MergeContent does:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (binManager.getBinCount() &amp;lt;= context.getProperty(MAX_BIN_COUNT).asInteger()) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isScheduled()) {
        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
    }

    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ProcessSession session = sessionFactory.createSession();
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; List&amp;lt;FlowFile&amp;gt; flowFiles = session.get(1000);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (flowFiles.isEmpty()) {
        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
    }
    ... 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/NIFI-9390&quot; title=&quot;MergeContent does not work properly in Kafka Connect Stateless flows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NIFI-9390&quot;&gt;&lt;del&gt;NIFI-9390&lt;/del&gt;&lt;/a&gt; also affects MergeContent when it is not in the starting position in the flow but this jira needs to be fixed first (otherwise the other cannot pop up).&lt;/p&gt;</description>
                <environment></environment>
        <key id="13412573">NIFI-9391</key>
            <summary>MergeRecord does not work in stateless flows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="turcsanyip">Peter Turcsanyi</assignee>
                                    <reporter username="turcsanyip">Peter Turcsanyi</reporter>
                        <labels>
                            <label>stateless</label>
                    </labels>
                <created>Thu, 18 Nov 2021 15:45:40 +0000</created>
                <updated>Mon, 21 Mar 2022 20:38:36 +0000</updated>
                            <resolved>Tue, 4 Jan 2022 16:37:17 +0000</resolved>
                                                    <fixVersion>1.16.0</fixVersion>
                                    <component>Extensions</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4800">1h 20m</timespent>
                                <comments>
                            <comment id="17468721" author="jira-bot" created="Tue, 4 Jan 2022 16:37:10 +0000"  >&lt;p&gt;Commit 4346dd8faf692968716669117e799afadc60150c in nifi&apos;s branch refs/heads/main from Peter Turcsanyi&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=nifi.git;h=4346dd8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=nifi.git;h=4346dd8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/NIFI-9391&quot; title=&quot;MergeRecord does not work in stateless flows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NIFI-9391&quot;&gt;&lt;del&gt;NIFI-9391&lt;/del&gt;&lt;/a&gt;: Modified MergeRecord to process FlowFiles within a loop in&#8230; (#5550)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/NIFI-9391&quot; title=&quot;MergeRecord does not work in stateless flows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NIFI-9391&quot;&gt;&lt;del&gt;NIFI-9391&lt;/del&gt;&lt;/a&gt;: Modified MergeRecord to process FlowFiles within a loop in a single onTrigger&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;MergeRecord processed the FlowFiles in multiple onTrigger-s and it needed an extra onTrigger call&lt;br/&gt;
(with no incoming FFs) to realize that no more FFs are available and it is time to send the merged FF downstream.&lt;br/&gt;
It was not compatible with Stateless Runtime which does not trigger the flow any more if no FFs available.&lt;/p&gt;

&lt;p&gt;Also changed &quot;unschedule&quot; logic in StandardProcessorTestRunner: @OnUnscheduled methods were called immediately after&lt;br/&gt;
the 1st FlowFile was processed. Unschedule the processor only at the end of the execution (onTrigger finished)&lt;br/&gt;
and only if stopOnFinish has been requested by the test case.&lt;/p&gt;</comment>
                            <comment id="17468733" author="jira-bot" created="Tue, 4 Jan 2022 16:40:48 +0000"  >&lt;p&gt;Commit 4346dd8faf692968716669117e799afadc60150c in nifi&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/NIFI-9428&quot; title=&quot;Implement C2 Protocol, Client, and Server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NIFI-9428&quot;&gt;NIFI-9428&lt;/a&gt; from Peter Turcsanyi&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=nifi.git;h=4346dd8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=nifi.git;h=4346dd8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/NIFI-9391&quot; title=&quot;MergeRecord does not work in stateless flows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NIFI-9391&quot;&gt;&lt;del&gt;NIFI-9391&lt;/del&gt;&lt;/a&gt;: Modified MergeRecord to process FlowFiles within a loop in&#8230; (#5550)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/NIFI-9391&quot; title=&quot;MergeRecord does not work in stateless flows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NIFI-9391&quot;&gt;&lt;del&gt;NIFI-9391&lt;/del&gt;&lt;/a&gt;: Modified MergeRecord to process FlowFiles within a loop in a single onTrigger&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;MergeRecord processed the FlowFiles in multiple onTrigger-s and it needed an extra onTrigger call&lt;br/&gt;
(with no incoming FFs) to realize that no more FFs are available and it is time to send the merged FF downstream.&lt;br/&gt;
It was not compatible with Stateless Runtime which does not trigger the flow any more if no FFs available.&lt;/p&gt;

&lt;p&gt;Also changed &quot;unschedule&quot; logic in StandardProcessorTestRunner: @OnUnscheduled methods were called immediately after&lt;br/&gt;
the 1st FlowFile was processed. Unschedule the processor only at the end of the execution (onTrigger finished)&lt;br/&gt;
and only if stopOnFinish has been requested by the test case.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 44 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0wvds:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>