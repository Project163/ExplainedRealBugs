diff --git a/src/main/java/org/semux/consensus/SemuxBFT.java b/src/main/java/org/semux/consensus/SemuxBFT.java
index ef9ac572..f9bb3fa1 100644
--- a/src/main/java/org/semux/consensus/SemuxBFT.java
+++ b/src/main/java/org/semux/consensus/SemuxBFT.java
@@ -833,11 +833,10 @@ public class SemuxBFT implements Consensus {
                             // thread-safe via volatile
                             List<Channel> channels = activeValidators;
                             if (channels != null) {
-                                int[] indexes = ArrayUtil
-                                        .permutation(Math.min(Config.NET_RELAY_REDUNDANCY, channels.size()));
-                                for (int idx : indexes) {
-                                    if (channels.get(idx).isActive()) {
-                                        channels.get(idx).getMessageQueue().sendMessage(msg);
+                                int[] indexes = ArrayUtil.permutation(channels.size());
+                                for (int i = 0; i < indexes.length && i < Config.NET_RELAY_REDUNDANCY; i++) {
+                                    if (channels.get(indexes[i]).isActive()) {
+                                        channels.get(indexes[i]).getMessageQueue().sendMessage(msg);
                                     }
                                 }
                             }
diff --git a/src/main/java/org/semux/core/PendingManager.java b/src/main/java/org/semux/core/PendingManager.java
index aaae6202..748135f6 100644
--- a/src/main/java/org/semux/core/PendingManager.java
+++ b/src/main/java/org/semux/core/PendingManager.java
@@ -299,11 +299,11 @@ public class PendingManager implements Runnable, BlockchainListener, Comparator<
             // [5] relay transaction
             if (relay) {
                 List<Channel> channels = channelMgr.getActiveChannels();
-                int[] indexes = ArrayUtil.permutation(Math.min(Config.NET_RELAY_REDUNDANCY, channels.size()));
-                for (int idx : indexes) {
-                    if (channels.get(idx).isActive()) {
+                int[] indexes = ArrayUtil.permutation(channels.size());
+                for (int i = 0; i < indexes.length && i < Config.NET_RELAY_REDUNDANCY; i++) {
+                    if (channels.get(indexes[i]).isActive()) {
                         TransactionMessage msg = new TransactionMessage(tx);
-                        channels.get(idx).getMessageQueue().sendMessage(msg);
+                        channels.get(indexes[i]).getMessageQueue().sendMessage(msg);
                     }
                 }
             }
