<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:37:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SLING-2990] race condition in scheduler could cause tasks to be lost</title>
                <link>https://issues.apache.org/jira/browse/SLING-2990</link>
                <project id="12310710" key="SLING">Sling</project>
                    <description>&lt;p&gt;In QuartzScheduler.java, binding a task/job checks if the scheduler is null and then either registers the service reference or adds it to a list for later registration. When the scheduler is activated all items on the list are registered and the list is cleared.&lt;/p&gt;

&lt;p&gt;All accesses to the list are properly synchronized, but the scheduler null check is not, so they are not done atomically together - there may be a race condition here that can cause a task to be lost: if the scheduler is checked and found to be null, then a context switch occurs and the scheduler is activated and processes the list, and then the original thread resumes and adds the task to the list, then the task will remain unprocessed in the list and never be registered.&lt;/p&gt;

&lt;p&gt;The same thing might happen inversed with unbinding tasks/jobs.&lt;/p&gt;

&lt;p&gt;btw the bind/unbind methods are duplicated for jobs and tasks, so it might be nicer to extract the common implementation and delegate to it with a job/task parameter. Then there will be less places to apply the fix in &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12661136">SLING-2990</key>
            <summary>race condition in scheduler could cause tasks to be lost</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cziegeler">Carsten Ziegeler</assignee>
                                    <reporter username="amichai">Amichai Rothman</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Aug 2013 14:42:38 +0000</created>
                <updated>Mon, 7 Oct 2013 14:55:59 +0000</updated>
                            <resolved>Fri, 2 Aug 2013 06:43:34 +0000</resolved>
                                    <version>Commons Scheduler 2.3.4</version>
                                    <fixVersion>Commons Scheduler 2.4.0</fixVersion>
                                    <component>Commons</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13726613" author="cziegeler" created="Thu, 1 Aug 2013 17:01:39 +0000"  >&lt;p&gt;Thanks for spotting this - in rev 1509329 i&apos;ve changed the implementation and moved all whiteboard stuff into a separate class which now uses a service tracker which runs after the component is activated. This ensures that all jobs are bound after the scheduler is initialized and we don&apos;t need to handle bound jobs before the scheduler is ready&lt;/p&gt;</comment>
                            <comment id="13726674" author="amichai" created="Thu, 1 Aug 2013 18:01:51 +0000"  >&lt;p&gt;Wow, that was quick &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;btw, Karaf is considering adding a scheduling service based on the Sling scheduler but ported to blueprint (&lt;a href=&quot;https://issues.apache.org/jira/browse/KARAF-751&quot; title=&quot;Provide a Timer Service in Karaf&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KARAF-751&quot;&gt;&lt;del&gt;KARAF-751&lt;/del&gt;&lt;/a&gt;)... so if you ever have a choice in design/implementation to make things more decoupled from DS/SCR and/or other slingy dependencies, and it&apos;s all the same to you, going for the decoupled approach would be helpful &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thanks for the fix!&lt;/p&gt;</comment>
                            <comment id="13727413" author="cziegeler" created="Fri, 2 Aug 2013 06:43:34 +0000"  >&lt;p&gt;Thanks for the info - the idea is that all Sling common modules can be run without some of the core Sling modules. The scheduler is just depending on the commons thread pool. The other dependency to the discovery service is optional&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>341325</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 16 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1mv9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>341643</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>