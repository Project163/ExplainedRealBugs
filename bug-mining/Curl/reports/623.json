{"url":"https://api.github.com/repos/curl/curl/issues/15941","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/15941/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/15941/comments","events_url":"https://api.github.com/repos/curl/curl/issues/15941/events","html_url":"https://github.com/curl/curl/issues/15941","id":2775362595,"node_id":"I_kwDOAAiu0c6lbKwj","number":15941,"title":"HTTP2 frame issue with libcurl and openscap","user":{"login":"Jiri-Stary","id":72435227,"node_id":"MDQ6VXNlcjcyNDM1MjI3","avatar_url":"https://avatars.githubusercontent.com/u/72435227?v=4","gravatar_id":"","url":"https://api.github.com/users/Jiri-Stary","html_url":"https://github.com/Jiri-Stary","followers_url":"https://api.github.com/users/Jiri-Stary/followers","following_url":"https://api.github.com/users/Jiri-Stary/following{/other_user}","gists_url":"https://api.github.com/users/Jiri-Stary/gists{/gist_id}","starred_url":"https://api.github.com/users/Jiri-Stary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jiri-Stary/subscriptions","organizations_url":"https://api.github.com/users/Jiri-Stary/orgs","repos_url":"https://api.github.com/users/Jiri-Stary/repos","events_url":"https://api.github.com/users/Jiri-Stary/events{/privacy}","received_events_url":"https://api.github.com/users/Jiri-Stary/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":194601710,"node_id":"MDU6TGFiZWwxOTQ2MDE3MTA=","url":"https://api.github.com/repos/curl/curl/labels/HTTP/2","name":"HTTP/2","color":"009800","default":false,"description":null},{"id":698723912,"node_id":"MDU6TGFiZWw2OTg3MjM5MTI=","url":"https://api.github.com/repos/curl/curl/labels/not-a-curl-bug","name":"not-a-curl-bug","color":"d4c5f9","default":false,"description":"This is not a bug in curl"}],"state":"closed","locked":false,"assignee":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":12,"created_at":"2025-01-08T13:11:06Z","updated_at":"2025-01-08T22:45:13Z","closed_at":"2025-01-08T22:45:13Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\n/usr/bin/oscap info --verbose DEVEL --fetch-remote-resources --profiles /ssg/scap-security-guide-0.1.75/ssg-debian12-ds.xml;\r\n\r\nIt uses libcurl to fetch the data and it fails on frame issue:\r\n\r\nI: oscap: Using environment variables: [oscap(17):oscap(7fd8c7d58390):debug.c:316:oscap_print_env_vars]\r\nI: oscap: OSCAP_CHECK_ENGINE_PLUGIN_DIR='' [oscap(17):oscap(7fd8c7d58390):debug.c:319:oscap_print_env_vars]\r\nI: oscap: OSCAP_CONTAINER_VARS='' [oscap(17):oscap(7fd8c7d58390):debug.c:319:oscap_print_env_vars]\r\nI: oscap: OSCAP_EVALUATION_TARGET='' [oscap(17):oscap(7fd8c7d58390):debug.c:319:oscap_print_env_vars]\r\nI: oscap: OSCAP_FULL_VALIDATION='' [oscap(17):oscap(7fd8c7d58390):debug.c:319:oscap_print_env_vars]\r\nI: oscap: OSCAP_OVAL_COMMAND_OPTIONS='' [oscap(17):oscap(7fd8c7d58390):debug.c:319:oscap_print_env_vars]\r\nI: oscap: OSCAP_PCRE_EXEC_RECURSION_LIMIT='' [oscap(17):oscap(7fd8c7d58390):debug.c:319:oscap_print_env_vars]\r\nI: oscap: OSCAP_PROBE_ROOT='' [oscap(17):oscap(7fd8c7d58390):debug.c:319:oscap_print_env_vars]\r\nI: oscap: SEXP_VALIDATE_DISABLE='' [oscap(17):oscap(7fd8c7d58390):debug.c:319:oscap_print_env_vars]\r\nI: oscap: SOURCE_DATE_EPOCH='' [oscap(17):oscap(7fd8c7d58390):debug.c:319:oscap_print_env_vars]\r\nI: oscap: OSCAP_PROBE_MEMORY_USAGE_RATIO='' [oscap(17):oscap(7fd8c7d58390):debug.c:319:oscap_print_env_vars]\r\nI: oscap: OSCAP_PROBE_MAX_COLLECTED_ITEMS='' [oscap(17):oscap(7fd8c7d58390):debug.c:319:oscap_print_env_vars]\r\nI: oscap: OSCAP_PROBE_IGNORE_PATHS='' [oscap(17):oscap(7fd8c7d58390):debug.c:319:oscap_print_env_vars]\r\nI: oscap: Identified document type: data-stream-collection [oscap(17):oscap(7fd8c7d58390):doc_type.c:96:oscap_determine_document_type_reader]\r\nDownloading: https://www.debian.org/security/oval/oval-definitions-bookworm.xml.bz2 ... D: oscap: == cURL info: Host www.debian.org:443 was resolved.\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: IPv6: 2603:400a:ffff:bb8::801f:3e\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: IPv4: 128.31.0.62\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:   Trying [2603:400a:ffff:bb8::801f:3e]:443...\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: Immediate connect fail for 2603:400a:ffff:bb8::801f:3e: Network unreachable\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:   Trying 128.31.0.62:443...\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: ALPN: curl offers h2,http/1.1\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: TLSv1.3 (OUT), TLS handshake, Client hello (1):\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:  CAfile: /etc/ssl/certs/ca-certificates.crt\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:  CApath: /etc/ssl/certs\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: TLSv1.3 (IN), TLS handshake, Server hello (2):\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: TLSv1.3 (IN), TLS handshake, Certificate (11):\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: TLSv1.3 (IN), TLS handshake, CERT verify (15):\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: TLSv1.3 (IN), TLS handshake, Finished (20):\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: TLSv1.3 (OUT), TLS handshake, Finished (20):\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA[38](https://github.com/McK-Internal/SF-SE-openscap-docker-image/actions/runs/12668762603/job/35304841578#step:6:40)4 / x25519 / RSASSA-PSS\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: ALPN: server accepted h2\r\n [oscap(17):oscap(7fd8c7d58[39](https://github.com/McK-Internal/SF-SE-openscap-docker-image/actions/runs/12668762603/job/35304841578#step:6:41)0):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: Server certificate:\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:  subject: CN=www.debian.org\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:  start date: Dec 10 00:38:49 2024 GMT\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:  expire date: Mar 10 00:38:48 2025 GMT\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:  subjectAltName: host \"www.debian.org\" matched cert's \"www.debian.org\"\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:  issuer: C=US; O=Let's Encrypt; CN=R11\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:  SSL certificate verify ok.\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:   Certificate level 0: Public key type RSA ([40](https://github.com/McK-Internal/SF-SE-openscap-docker-image/actions/runs/12668762603/job/35304841578#step:6:42)96/152 Bits/secBits), signed using sha256WithRSAEncryption\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:   Certificate level 1: Public key type RSA (2048/112 Bits/secBits), signed using sha256WithRSAEncryption\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info:   Certificate level 2: Public key type RSA (4096/152 Bits/secBits), signed using sha256WithRSAEncryption\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: Connected to www.debian.org (128.31.0.62) port 4[43](https://github.com/McK-Internal/SF-SE-openscap-docker-image/actions/runs/12668762603/job/35304841578#step:6:45)\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: using HTTP/2\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: [HTTP/2] [1] OPENED stream for https://www.debian.org/security/oval/oval-definitions-bookworm.xml.bz2\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: [HTTP/2] [1] [:method: GET]\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: [HTTP/2] [1] [:scheme: https]\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: [HTTP/2] [1] [:authority: www.debian.org]\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: [HTTP/2] [1] [:path: /security/oval/oval-definitions-bookworm.xml.bz2]\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: [HTTP/2] [1] [accept: */*]\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: [HTTP/2] [1] [te: gzip]\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: [HTTP/2] [1] [accept-encoding: deflate, gzip, br, zstd]\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: => cURL header (out): GET /security/oval/oval-definitions-bookworm.xml.bz2 HTTP/2\r\nHost: www.debian.org\r\nAccept: */*\r\nConnection: TE\r\nTE: gzip\r\nAccept-Encoding: deflate, gzip, br, zstd\r\n [oscap(17):oscap(7fd8c7d[58](https://github.com/McK-Internal/SF-SE-openscap-docker-image/actions/runs/12668762603/job/35304841578#step:6:60)390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: Request completely sent off\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: HTTP/2 stream 1 was not closed cleanly: PROTOCOL_ERROR (err 1)\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nD: oscap: == cURL info: Connection #0 to host www.debian.org left intact\r\n [oscap(17):oscap(7fd8c7d58390):oscap_acquire.c:315:_curl_trace]\r\nerror\r\nOpenSCAP Error: Download failed: Stream error in the HTTP/2 framing layer [/home/buildozer/aports/community/openscap/src/openscap-1.3.10/src/common/oscap_acquire.c:405]\r\nCould not extract scap_org.open-scap_cref_ssg-debian12-xccdf.xml with all dependencies from datastream. [/home/buildozer/aports/community/openscap/src/openscap-1.3.10/src/DS/ds_sds_session.c:228]\r\nAn error occurred during evaluation\n\n### I expected the following\n\nnot to have the the frame error on the file \r\n\r\nhttps://www.debian.org/security/oval/oval-definitions-bookworm.xml.bz2 \r\n\r\n Download failed: Stream error in the HTTP/2 framing layer \n\n### curl/libcurl version\n\n#10 [5/8] RUN curl --version\r\n#10 0.157 curl 8.11.1 (x86_64-alpine-linux-musl) libcurl/8.11.1 OpenSSL/3.3.2 zlib/1.3.1 brotli/1.1.0 zstd/1.5.6 c-ares/1.33.1 libidn2/2.3.7 libpsl/0.21.5 nghttp2/1.62.1\r\n#10 0.157 Release-Date: 2024-12-11\r\n#10 0.157 Protocols: dict file ftp ftps gopher gophers http https imap imaps ipfs ipns mqtt pop3 pop3s rtsp smb smbs smtp smtps telnet tftp ws wss\r\n#10 0.157 Features: alt-svc AsynchDNS brotli HSTS HTTP2 HTTPS-proxy IDN IPv6 Largefile libz NTLM PSL SSL threadsafe TLS-SRP UnixSockets zstd\r\n#10 DONE 0.2s\n\n### operating system\n\nalpine linux 3.20","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/15941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/15941/timeline","performed_via_github_app":null,"state_reason":"completed"}