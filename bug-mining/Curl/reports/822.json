{"url":"https://api.github.com/repos/curl/curl/issues/18991","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/18991/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/18991/comments","events_url":"https://api.github.com/repos/curl/curl/issues/18991/events","html_url":"https://github.com/curl/curl/issues/18991","id":3501103348,"node_id":"I_kwDOAAiu0c7Qrpj0","number":18991,"title":"Curious bug with wss when using schannel on windows","user":{"login":"pps83","id":1614246,"node_id":"MDQ6VXNlcjE2MTQyNDY=","avatar_url":"https://avatars.githubusercontent.com/u/1614246?v=4","gravatar_id":"","url":"https://api.github.com/users/pps83","html_url":"https://github.com/pps83","followers_url":"https://api.github.com/users/pps83/followers","following_url":"https://api.github.com/users/pps83/following{/other_user}","gists_url":"https://api.github.com/users/pps83/gists{/gist_id}","starred_url":"https://api.github.com/users/pps83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pps83/subscriptions","organizations_url":"https://api.github.com/users/pps83/orgs","repos_url":"https://api.github.com/users/pps83/repos","events_url":"https://api.github.com/users/pps83/events{/privacy}","received_events_url":"https://api.github.com/users/pps83/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118221,"node_id":"MDU6TGFiZWwxODQxMTgyMjE=","url":"https://api.github.com/repos/curl/curl/labels/TLS","name":"TLS","color":"bfdadc","default":false,"description":""},{"id":1117926199,"node_id":"MDU6TGFiZWwxMTE3OTI2MTk5","url":"https://api.github.com/repos/curl/curl/labels/libcurl%20API","name":"libcurl API","color":"fef2c0","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":20,"created_at":"2025-10-10T01:55:12Z","updated_at":"2025-10-23T20:53:39Z","closed_at":"2025-10-23T20:53:39Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\nI use libcurl for CONNECT_ONLY mode to do websocks (using wslay library). The code works well, has lots of unit tests, went through stress testing as well and overall worked quite ok (without using ssl). Today I tried to use this websock impl with a commercial service and I started seeing weird bugs. In short, it looked like the remote server would stop responding to my WS ping frames after replying to me 5 times. When I tried to debug more, it appeared that after around 60 seconds all `curl_easy_send` calls would fail with 55 (`CURLE_SEND_ERROR`) while `WSAGetLastError()` would return `WSAEWOULDBLOCK`. I tried to handle the case as `WSAEWOULDBLOCK` but it didn't work.\nThere was not heavy sending to cause `WSAEWOULDBLOCK`, it was a 10-byte msg each 10 seconds.\n\nIt all looked suspicious, as the error was happening precisely around 60 second mark after making a connection.\n\nI wanted to capture it all with wireshark to see what's on the wire, but schannel has no options to decrypt connection. So, I built it with openssl instead and ... this fixed the issue. Suddenly, the problem was gone, while with schannel it was 100% happening precisely at 60 second mark of the connection.\n\nIs it something that was already observed/known issue with tls+schannel with curl?\n\nI use libcurl `8.12.1`\n\n### I expected the following\n\n_No response_\n\n### curl/libcurl version\n\n8.12.1\n\n### operating system\n\nWindows 11","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/18991/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/18991/timeline","performed_via_github_app":null,"state_reason":"completed"}