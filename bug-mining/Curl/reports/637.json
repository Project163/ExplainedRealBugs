{"url":"https://api.github.com/repos/curl/curl/issues/16201","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/16201/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/16201/comments","events_url":"https://api.github.com/repos/curl/curl/issues/16201/events","html_url":"https://github.com/curl/curl/issues/16201","id":2834872719,"node_id":"I_kwDOAAiu0c6o-LmP","number":16201,"title":"Building 8.12.0 from source failes","user":{"login":"mschroeder-fzj","id":176493159,"node_id":"U_kgDOCoUSZw","avatar_url":"https://avatars.githubusercontent.com/u/176493159?v=4","gravatar_id":"","url":"https://api.github.com/users/mschroeder-fzj","html_url":"https://github.com/mschroeder-fzj","followers_url":"https://api.github.com/users/mschroeder-fzj/followers","following_url":"https://api.github.com/users/mschroeder-fzj/following{/other_user}","gists_url":"https://api.github.com/users/mschroeder-fzj/gists{/gist_id}","starred_url":"https://api.github.com/users/mschroeder-fzj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mschroeder-fzj/subscriptions","organizations_url":"https://api.github.com/users/mschroeder-fzj/orgs","repos_url":"https://api.github.com/users/mschroeder-fzj/repos","events_url":"https://api.github.com/users/mschroeder-fzj/events{/privacy}","received_events_url":"https://api.github.com/users/mschroeder-fzj/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":0,"created_at":"2025-02-06T08:29:53Z","updated_at":"2025-02-06T21:25:44Z","closed_at":"2025-02-06T21:25:44Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\nI am building a static binary version of curl that tries to be as small as possible with only http required.\nFor that I am using `debian:stable-slim` as Contianer image with these packages installed:\nbuild-essential clang perl gcc musl-dev libwolfssl-dev cmake autoconf automake libtool curl tar\n\nBuild command:\n```\nexport CC=clang\nautoreconf -fi\nCPPFLAGS=\"-DHAVE_CURL\" LDFLAGS=\"-static\" PKG_CONFIG=\"pkg-config --static\" ./configure \\\n        --disable-shared \\\n        --disable-libcurl-option \\\n        --disable-threaded-resolver \\\n        --disable-cookies \\\n        --disable-crypto-auth \\\n        --disable-dict \\\n        --disable-file \\\n        --disable-ftp \\\n        --disable-gopher \\\n        --disable-imap \\\n        --disable-ldap \\\n        --disable-ldaps \\\n        --without-ldap-lib \\\n        --without-lber-lib \\\n        --disable-mqtt \\\n        --disable-pop3 \\\n        --disable-proxy \\\n        --disable-rtmp \\\n        --disable-rtsp \\\n        --disable-scp \\\n        --disable-sftp \\\n        --disable-smtp \\\n        --disable-smb \\\n        --without-ngtcp2 \\\n        --disable-ntlm-wb \\\n        --disable-telnet \\\n        --disable-tftp \\\n        --disable-alt-svc \\\n        --disable-unix-sockets \\\n        --disable-verbose \\\n        --disable-versioned-symbols \\\n        --disable-http-auth \\\n        --disable-doh \\\n        --disable-mime \\\n        --disable-dateparse \\\n        --disable-netrc \\\n        --disable-dnsshuffle \\\n        --disable-ares \\\n        --disable-progress-meter \\\n        --disable-headers-api \\\n        --disable-hsts \\\n        --enable-maintainer-mode \\\n        --enable-werror \\\n        --without-brotli \\\n        --without-gssapi \\\n        --without-gsasl \\\n        --without-libidn2 \\\n        --without-libpsl \\\n        --without-librtmp \\\n        --without-libssh \\\n        --without-libssh2 \\\n        --without-nghttp2 \\\n        --without-nghttp3 \\\n        --without-quiche \\\n        --without-ntlm-auth \\\n        --without-zlib \\\n        --without-zstd \\\n        --without-ssl \\\n        --without-openssl-quic \\\n        --without-msh3 \\\n        --disable-tls-srp \\\n        --disable-ipv6 \\\n        --enable-static \\\n        --disable-docs \\\n        --disable-manual\n\nmake -j4 V=1 LDFLAGS=\"-static -all-static\" CFLAGS=\"-Os\"\n```\n\n### I expected the following\n\nA static binary should be build.\n\nInstead it failes with:\n```\n+ make -j4 V=1 LDFLAGS=-static -all-static CFLAGS=-Os\nMaking all in lib\nmake[1]: Entering directory '/build/curl_without_ssl/curl-8.12.0/lib'\nmake  all-am\nmake[2]: Entering directory '/build/curl_without_ssl/curl-8.12.0/lib'\nmake[2]: Leaving directory '/build/curl_without_ssl/curl-8.12.0/lib'\nmake[1]: Leaving directory '/build/curl_without_ssl/curl-8.12.0/lib'\nMaking all in docs\nmake[1]: Entering directory '/build/curl_without_ssl/curl-8.12.0/docs'\nMaking all in .\nmake[2]: Entering directory '/build/curl_without_ssl/curl-8.12.0/docs'\nmake[2]: Nothing to be done for 'all-am'.\nmake[2]: Leaving directory '/build/curl_without_ssl/curl-8.12.0/docs'\nMaking all in cmdline-opts\nmake[2]: Entering directory '/build/curl_without_ssl/curl-8.12.0/docs/cmdline-opts'\nmake[2]: Nothing to be done for 'all'.\nmake[2]: Leaving directory '/build/curl_without_ssl/curl-8.12.0/docs/cmdline-opts'\nMaking all in libcurl\nmake[2]: Entering directory '/build/curl_without_ssl/curl-8.12.0/docs/libcurl'\nMaking all in opts\nmake[3]: Entering directory '/build/curl_without_ssl/curl-8.12.0/docs/libcurl/opts'\nmake[3]: Nothing to be done for 'all'.\nmake[3]: Leaving directory '/build/curl_without_ssl/curl-8.12.0/docs/libcurl/opts'\nmake[3]: Entering directory '/build/curl_without_ssl/curl-8.12.0/docs/libcurl'\nmake[3]: Nothing to be done for 'all-am'.\nmake[3]: Leaving directory '/build/curl_without_ssl/curl-8.12.0/docs/libcurl'\nmake[2]: Leaving directory '/build/curl_without_ssl/curl-8.12.0/docs/libcurl'\nmake[1]: Leaving directory '/build/curl_without_ssl/curl-8.12.0/docs'\nMaking all in src\nmake[1]: Entering directory '/build/curl_without_ssl/curl-8.12.0/src'\n/bin/bash ../libtool  --tag=CC   --mode=link clang  -Os   -static -all-static -o curl curl-slist_wc.o curl-terminal.o curl-tool_bname.o curl-tool_cb_dbg.o curl-tool_cb_hdr.o curl-tool_cb_prg.o curl-tool_cb_rea.o curl-tool_cb_see.o curl-tool_cb_soc.o curl-tool_cb_wrt.o curl-tool_cfgable.o curl-tool_dirhie.o curl-tool_doswin.o curl-tool_easysrc.o curl-tool_filetime.o curl-tool_findfile.o curl-tool_formparse.o curl-tool_getparam.o curl-tool_getpass.o curl-tool_help.o curl-tool_helpers.o curl-tool_ipfs.o curl-tool_libinfo.o curl-tool_listhelp.o curl-tool_main.o curl-tool_msgs.o curl-tool_operate.o curl-tool_operhlp.o curl-tool_paramhlp.o curl-tool_parsecfg.o curl-tool_progress.o curl-tool_setopt.o curl-tool_sleep.o curl-tool_ssls.o curl-tool_stderr.o curl-tool_strdup.o curl-tool_urlglob.o curl-tool_util.o curl-tool_vms.o curl-tool_writeout.o curl-tool_writeout_json.o curl-tool_xattr.o curl-var.o ../lib/curl-base64.o ../lib/curl-curl_get_line.o ../lib/curl-curl_multibyte.o ../lib/curl-dynbuf.o ../lib/curl-nonblock.o ../lib/curl-strtoofft.o ../lib/curl-timediff.o ../lib/curl-version_win32.o ../lib/curl-warnless.o  curl-tool_hugehelp.o curl-tool_ca_embed.o    ../lib/libcurl.la\nlibtool: link: clang -Os -static -o curl curl-slist_wc.o curl-terminal.o curl-tool_bname.o curl-tool_cb_dbg.o curl-tool_cb_hdr.o curl-tool_cb_prg.o curl-tool_cb_rea.o curl-tool_cb_see.o curl-tool_cb_soc.o curl-tool_cb_wrt.o curl-tool_cfgable.o curl-tool_dirhie.o curl-tool_doswin.o curl-tool_easysrc.o curl-tool_filetime.o curl-tool_findfile.o curl-tool_formparse.o curl-tool_getparam.o curl-tool_getpass.o curl-tool_help.o curl-tool_helpers.o curl-tool_ipfs.o curl-tool_libinfo.o curl-tool_listhelp.o curl-tool_main.o curl-tool_msgs.o curl-tool_operate.o curl-tool_operhlp.o curl-tool_paramhlp.o curl-tool_parsecfg.o curl-tool_progress.o curl-tool_setopt.o curl-tool_sleep.o curl-tool_ssls.o curl-tool_stderr.o curl-tool_strdup.o curl-tool_urlglob.o curl-tool_util.o curl-tool_vms.o curl-tool_writeout.o curl-tool_writeout_json.o curl-tool_xattr.o curl-var.o ../lib/curl-base64.o ../lib/curl-curl_get_line.o ../lib/curl-curl_multibyte.o ../lib/curl-dynbuf.o ../lib/curl-nonblock.o ../lib/curl-strtoofft.o ../lib/curl-timediff.o ../lib/curl-version_win32.o ../lib/curl-warnless.o curl-tool_hugehelp.o curl-tool_ca_embed.o  ../lib/.libs/libcurl.a\n/usr/bin/ld: curl-tool_findfile.o: in function `findfile':\ntool_findfile.c:(.text+0xe7): warning: Using 'getpwuid' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/bin/ld: ../lib/.libs/libcurl.a(libcurl_la-curl_addrinfo.o): in function `Curl_getaddrinfo_ex':\ncurl_addrinfo.c:(.text+0x40): warning: Using 'getaddrinfo' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/bin/ld: curl-tool_ssls.o: in function `tool_ssls_load':\ntool_ssls.c:(.text+0x80): undefined reference to `curlx_get_line'\n/usr/bin/ld: tool_ssls.c:(.text+0x1c0): undefined reference to `curlx_get_line'\n/usr/bin/ld: tool_ssls.c:(.text+0x216): undefined reference to `curlx_get_line'\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake[1]: Leaving directory '/build/curl_without_ssl/curl-8.12.0/src'\nmake[1]: *** [Makefile:1016: curl] Error 1\nmake: *** [Makefile:624: all-recursive] Error 1\n```\n\nFor curl Versions 8.8.0 until 8.11.1 it worked just fine.\n\n### curl/libcurl version\n\ncurl 8.12.0\n\n### operating system\n\ndebian:stable-slim","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/16201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/16201/timeline","performed_via_github_app":null,"state_reason":"completed"}