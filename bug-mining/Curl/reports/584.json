{"url":"https://api.github.com/repos/curl/curl/issues/15483","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/15483/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/15483/comments","events_url":"https://api.github.com/repos/curl/curl/issues/15483/events","html_url":"https://github.com/curl/curl/issues/15483","id":2633235851,"node_id":"I_kwDOAAiu0c6c8_2L","number":15483,"title":"Stapled OCSP responses are ignored by default","user":{"login":"CounterPillow","id":308818,"node_id":"MDQ6VXNlcjMwODgxOA==","avatar_url":"https://avatars.githubusercontent.com/u/308818?v=4","gravatar_id":"","url":"https://api.github.com/users/CounterPillow","html_url":"https://github.com/CounterPillow","followers_url":"https://api.github.com/users/CounterPillow/followers","following_url":"https://api.github.com/users/CounterPillow/following{/other_user}","gists_url":"https://api.github.com/users/CounterPillow/gists{/gist_id}","starred_url":"https://api.github.com/users/CounterPillow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CounterPillow/subscriptions","organizations_url":"https://api.github.com/users/CounterPillow/orgs","repos_url":"https://api.github.com/users/CounterPillow/repos","events_url":"https://api.github.com/users/CounterPillow/events{/privacy}","received_events_url":"https://api.github.com/users/CounterPillow/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118221,"node_id":"MDU6TGFiZWwxODQxMTgyMjE=","url":"https://api.github.com/repos/curl/curl/labels/TLS","name":"TLS","color":"bfdadc","default":false,"description":""},{"id":228248612,"node_id":"MDU6TGFiZWwyMjgyNDg2MTI=","url":"https://api.github.com/repos/curl/curl/labels/enhancement","name":"enhancement","color":"FCFD96","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2024-11-04T16:12:10Z","updated_at":"2024-11-08T07:58:14Z","closed_at":"2024-11-08T07:58:13Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\r\n\r\n```\r\ncurl -v https://3dsec.postfinance.ch/challengeRequestBrowser\r\n```\r\n\r\nThis sends an OCSP stapled revocation as of right now because my bank is a clown show and doesn't know how to run a business. Firefox doesn't accept it because the cert is revoked, but curl did.\r\n\r\nNote: postfinance might fix their oopsie by the time you read this, but I doubt it, since it's been 24+ hours and they seemingly have no monitoring.\r\n\r\n### I expected the following\r\n\r\nRevocation error, as with `curl -v --cert-status https://3dsec.postfinance.ch/challengeRequestBrowser`. It's fine (and probably preferable) to not query the CA for OCSP, thereby leaking information to it, but if OCSP revocation is part of the response it should probably respect it by default like Firefox does.\r\n\r\nstracing the curl process shows that the OCSP information isn't coming from the CA but seemingly the stapled response.\r\n\r\nAs an aside note, if anyone has any test domains that sends an OCSP-stapled revocation, that'd be nice, so that this bug report doesn't have to count on the incompetence of a large banking entity.\r\n\r\n### curl/libcurl version\r\n\r\ncurl 8.10.1 (x86_64-pc-linux-gnu) libcurl/8.10.1 OpenSSL/3.4.0 zlib/1.3.1 brotli/1.1.0 zstd/1.5.6 libidn2/2.3.7 libpsl/0.21.5 libssh2/1.11.0 nghttp2/1.64.0 nghttp3/1.6.0\r\nRelease-Date: 2024-09-18\r\nProtocols: dict file ftp ftps gopher gophers http https imap imaps ipfs ipns mqtt pop3 pop3s rtsp scp sftp smb smbs smtp smtps telnet tftp ws wss\r\nFeatures: alt-svc AsynchDNS brotli GSS-API HSTS HTTP2 HTTP3 HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTLM PSL SPNEGO SSL threadsafe TLS-SRP UnixSockets zstd\r\n\r\n### operating system\r\n\r\n`Linux archbox 6.11.6-arch1-1 #1 SMP PREEMPT_DYNAMIC Fri, 01 Nov 2024 03:30:41 +0000 x86_64 GNU/Linux`","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/15483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/15483/timeline","performed_via_github_app":null,"state_reason":"completed"}