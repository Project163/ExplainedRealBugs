{"url":"https://api.github.com/repos/curl/curl/issues/19130","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/19130/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/19130/comments","events_url":"https://api.github.com/repos/curl/curl/issues/19130/events","html_url":"https://github.com/curl/curl/issues/19130","id":3529364919,"node_id":"I_kwDOAAiu0c7SXdW3","number":19130,"title":"Multiple location headers allowed","user":{"login":"jstasiak","id":36209,"node_id":"MDQ6VXNlcjM2MjA5","avatar_url":"https://avatars.githubusercontent.com/u/36209?v=4","gravatar_id":"","url":"https://api.github.com/users/jstasiak","html_url":"https://github.com/jstasiak","followers_url":"https://api.github.com/users/jstasiak/followers","following_url":"https://api.github.com/users/jstasiak/following{/other_user}","gists_url":"https://api.github.com/users/jstasiak/gists{/gist_id}","starred_url":"https://api.github.com/users/jstasiak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jstasiak/subscriptions","organizations_url":"https://api.github.com/users/jstasiak/orgs","repos_url":"https://api.github.com/users/jstasiak/repos","events_url":"https://api.github.com/users/jstasiak/events{/privacy}","received_events_url":"https://api.github.com/users/jstasiak/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118243,"node_id":"MDU6TGFiZWwxODQxMTgyNDM=","url":"https://api.github.com/repos/curl/curl/labels/HTTP","name":"HTTP","color":"207de5","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":6,"created_at":"2025-10-19T00:18:39Z","updated_at":"2025-10-21T19:21:42Z","closed_at":"2025-10-20T07:35:44Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\nI fetched a URL where the server responded with multiple location headers.\n\n### I expected the following\n\nI expected curl to reject a response with multiple location headers and (when used with `-L`) not to follow any redirects.\n\nThis is a *soft* bug report (I'm leaning towards considering it a bug but it's not exactly obvious and reasonable people may disagree).\n\n13 years ago a patch was added to ignore location headers other than the first one[1].\n\nI just bumped into this subject a few days ago and did some digging, the browsers I tried so far (Firefox, Safari, Brave) reject HTTP responses with multiple location headers.\n\nIt feels to me this unnecessarily creates an opportunity for mistakes to happen (one piece of software picks one location header, another picks a different one, there can even be some security consequences associated with that) so I thought I'd raise this topic.\n\n[1] dbcaa0065719 (\"HTTP: memory leak on multiple Location:\")\n\n### curl/libcurl version\n\ncurl 8.16.0\nalso the current master branch\n\n### operating system\n\nN/A","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/19130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/19130/timeline","performed_via_github_app":null,"state_reason":"completed"}