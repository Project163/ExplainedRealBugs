{"url":"https://api.github.com/repos/curl/curl/issues/14641","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/14641/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/14641/comments","events_url":"https://api.github.com/repos/curl/curl/issues/14641/events","html_url":"https://github.com/curl/curl/issues/14641","id":2479896728,"node_id":"I_kwDOAAiu0c6T0DiY","number":14641,"title":"cmake ignores Cflags.private","user":{"login":"Andarwinux","id":144242044,"node_id":"U_kgDOCJj1fA","avatar_url":"https://avatars.githubusercontent.com/u/144242044?v=4","gravatar_id":"","url":"https://api.github.com/users/Andarwinux","html_url":"https://github.com/Andarwinux","followers_url":"https://api.github.com/users/Andarwinux/followers","following_url":"https://api.github.com/users/Andarwinux/following{/other_user}","gists_url":"https://api.github.com/users/Andarwinux/gists{/gist_id}","starred_url":"https://api.github.com/users/Andarwinux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Andarwinux/subscriptions","organizations_url":"https://api.github.com/users/Andarwinux/orgs","repos_url":"https://api.github.com/users/Andarwinux/repos","events_url":"https://api.github.com/users/Andarwinux/events{/privacy}","received_events_url":"https://api.github.com/users/Andarwinux/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184123162,"node_id":"MDU6TGFiZWwxODQxMjMxNjI=","url":"https://api.github.com/repos/curl/curl/labels/cmake","name":"cmake","color":"d4c5f9","default":false,"description":null},{"id":228248612,"node_id":"MDU6TGFiZWwyMjgyNDg2MTI=","url":"https://api.github.com/repos/curl/curl/labels/enhancement","name":"enhancement","color":"FCFD96","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-08-22T05:50:19Z","updated_at":"2024-08-23T08:43:57Z","closed_at":"2024-08-23T08:43:56Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\nbuild curl with cmake -DCURL_USE_PKGCONFIG=ON\n\n### I expected the following\n\ncurl cmake should apply `Cflags.private: -DLIBSSH_STATIC` from dependency pkgconfig (libssh.pc), but it doesn't, causing the build to fail.\r\n\r\n```\r\nFAILED: src/curl.exe\r\n: && /build/install/bin/x86_64-w64-mingw32-clang -DNGHTTP3_STATICLIB -DNGHTTP2_STATICLIB  -Werror-implicit-function-declaration -Wextra -Wall -pedantic -Wbad-function-cast -Wconversion -Winline -Wmissing-declarations -Wmissing-prototypes -Wnested-externs -Wno-long-long -Wno-multichar -Wpointer-arith -Wshadow -Wsign-compare -Wundef -Wunused -Wwrite-strings -Waddress -Wattributes -Wcast-align -Wdeclaration-after-statement -Wdiv-by-zero -Wempty-body -Wendif-labels -Wfloat-equal -Wformat-security -Wignored-qualifiers -Wmissing-field-initializers -Wmissing-noreturn -Wno-format-nonliteral -Wno-system-headers -Wold-style-definition -Wredundant-decls -Wsign-conversion -Wno-error=sign-conversion -Wstrict-prototypes -Wtype-limits -Wunreachable-code -Wunused-parameter -Wvla -Wshift-sign-overflow -Wshorten-64-to-32 -Wlanguage-extension-token -Wformat=2 -Wdouble-promotion -Wenum-conversion -Wpragmas -Wunused-const-variable -Wunreachable-code-break -Wheader-guard -Wsometimes-uninitialized -Wcomma -Wmissing-variable-declarations -Wassign-enum -Wextra-semi-stmt -Wimplicit-fallthrough -O3 -DNDEBUG  src/CMakeFiles/curl.dir/Unity/unity_0_c.c.obj src/CMakeFiles/curl.dir/curl.rc.res -o src/curl.exe -Wl,--out-implib,src/libcurl.dll.a -Wl,--major-image-version,0,--minor-image-version,0  -municode  lib/libcurl.a  /build/install/x86_64-w64-mingw32/lib/libcares.a  -lws2_32  -lbcrypt  /build/install/x86_64-w64-mingw32/lib/libssl.a  /build/install/x86_64-w64-mingw32/lib/libcrypto.a  /build/install/x86_64-w64-mingw32/lib/libz.a  /build/install/x86_64-w64-mingw32/lib/libbrotlidec.a  /build/install/x86_64-w64-mingw32/lib/libbrotlicommon.a  /build/install/x86_64-w64-mingw32/lib/libzstd.a  /build/install/x86_64-w64-mingw32/lib/libnghttp2.a  /build/install/x86_64-w64-mingw32/lib/libnghttp3.a  -lwldap32  -lnormaliz  /build/install/x86_64-w64-mingw32/lib/libpsl.a  /build/install/x86_64-w64-mingw32/lib/libssh.a  /build/install/x86_64-w64-mingw32/lib/libwsock32.a  /build/install/x86_64-w64-mingw32/lib/libiphlpapi.a  /build/install/x86_64-w64-mingw32/lib/libpthread.a  /build/install/x86_64-w64-mingw32/lib/libssl.a  /build/install/x86_64-w64-mingw32/lib/libcrypto.a  /build/install/x86_64-w64-mingw32/lib/libz.a  /build/install/x86_64-w64-mingw32/lib/libbrotlienc.a  /build/install/x86_64-w64-mingw32/lib/libbrotlidec.a  /build/install/x86_64-w64-mingw32/lib/libbrotlicommon.a  /build/install/x86_64-w64-mingw32/lib/libm.a  /build/install/x86_64-w64-mingw32/lib/libzstd.a  /build/install/x86_64-w64-mingw32/lib/libws2_32.a  /build/install/x86_64-w64-mingw32/lib/libgdi32.a  /build/install/x86_64-w64-mingw32/lib/libcrypt32.a  -liphlpapi  -ladvapi32  -lcrypt32  /build/install/x86_64-w64-mingw32/lib/libbrotlidec.a  /build/install/x86_64-w64-mingw32/lib/libbrotlicommon.a  /build/install/x86_64-w64-mingw32/lib/libnghttp2.a  /build/install/x86_64-w64-mingw32/lib/libnghttp3.a  -lwldap32  -lnormaliz  /build/install/x86_64-w64-mingw32/lib/libpsl.a  /build/install/x86_64-w64-mingw32/lib/libssh.a  /build/install/x86_64-w64-mingw32/lib/libwsock32.a  /build/install/x86_64-w64-mingw32/lib/libiphlpapi.a  /build/install/x86_64-w64-mingw32/lib/libpthread.a  /build/install/x86_64-w64-mingw32/lib/libssl.a  /build/install/x86_64-w64-mingw32/lib/libcrypto.a  /build/install/x86_64-w64-mingw32/lib/libz.a  /build/install/x86_64-w64-mingw32/lib/libbrotlienc.a  /build/install/x86_64-w64-mingw32/lib/libm.a  /build/install/x86_64-w64-mingw32/lib/libws2_32.a  /build/install/x86_64-w64-mingw32/lib/libgdi32.a  /build/install/x86_64-w64-mingw32/lib/libcrypt32.a  -liphlpapi  -ladvapi32  -lcrypt32  -lkernel32 -luser32 -lgdi32 -lwinspool -lshell32 -lole32 -loleaut32 -luuid -lcomdlg32 -ladvapi32 && :\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_init\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_finalize\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_version\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_set_blocking\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_connect\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_userauth_none\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_userauth_list\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_userauth_try_publickey\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_pki_import_privkey_file\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_userauth_publickey_auto\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_userauth_publickey\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_userauth_gssapi\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_userauth_password\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) sftp_new\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) ssh_get_error\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) sftp_init\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) sftp_canonicalize_path\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) sftp_setstat\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) sftp_symlink\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n\r\nld.lld: error: undefined symbol: __declspec(dllimport) sftp_mkdir\r\n>>> referenced by /build/packages/curl-prefix/src/curl-build/lib/CMakeFiles/libcurl_object.dir/Unity/unity_0_c.c\r\n>>>               libcurl.a(unity_0_c.c.obj)\r\n```\n\n### curl/libcurl version\n\nmaster\n\n### operating system\n\nlinux","closed_by":{"login":"vszakats","id":1446897,"node_id":"MDQ6VXNlcjE0NDY4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1446897?v=4","gravatar_id":"","url":"https://api.github.com/users/vszakats","html_url":"https://github.com/vszakats","followers_url":"https://api.github.com/users/vszakats/followers","following_url":"https://api.github.com/users/vszakats/following{/other_user}","gists_url":"https://api.github.com/users/vszakats/gists{/gist_id}","starred_url":"https://api.github.com/users/vszakats/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vszakats/subscriptions","organizations_url":"https://api.github.com/users/vszakats/orgs","repos_url":"https://api.github.com/users/vszakats/repos","events_url":"https://api.github.com/users/vszakats/events{/privacy}","received_events_url":"https://api.github.com/users/vszakats/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/14641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/14641/timeline","performed_via_github_app":null,"state_reason":"completed"}