[{"url":"https://api.github.com/repos/curl/curl/issues/comments/1802047461","html_url":"https://github.com/curl/curl/issues/12299#issuecomment-1802047461","issue_url":"https://api.github.com/repos/curl/curl/issues/12299","id":1802047461,"node_id":"IC_kwDOAAiu0c5raQ_l","user":{"login":"hwti","id":827856,"node_id":"MDQ6VXNlcjgyNzg1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/827856?v=4","gravatar_id":"","url":"https://api.github.com/users/hwti","html_url":"https://github.com/hwti","followers_url":"https://api.github.com/users/hwti/followers","following_url":"https://api.github.com/users/hwti/following{/other_user}","gists_url":"https://api.github.com/users/hwti/gists{/gist_id}","starred_url":"https://api.github.com/users/hwti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hwti/subscriptions","organizations_url":"https://api.github.com/users/hwti/orgs","repos_url":"https://api.github.com/users/hwti/repos","events_url":"https://api.github.com/users/hwti/events{/privacy}","received_events_url":"https://api.github.com/users/hwti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-08T14:53:21Z","updated_at":"2023-11-08T18:47:50Z","body":"20f9dd6bae50b or the CVE do not explain why :\r\n - the temporary file is created with `0600`\r\n - the `fchmod` is only done when the uid and gid are the same\r\n\r\nMaybe the temporary file could be created with `0600 | sb.st_mode`.\r\nThen the `fchmod` would restore the full mode if the umask prevented it (`nsb.st_mode != (0600 | sb.st_mode)` could be checked).\r\nEven if the uid or gid are different, I think we could still do the `fchmod`.\r\nThen a `fchown` could try restoring the uid / gid, but without `CAP_CHOWN` only the gid could be restored (if the current user is a member of this group) but this would cover cases where the file is shared with a group.\r\n\r\nIn `0600 | sb.st_mode`, the `0600` would prevent creating a file we can't access, if the original rights lack permissions for the user (which would be strange, but it's possible).\r\nFor example if the original file is `0066` and belongs to `user2`, `user1` can open it.\r\nBut the temporary file would belong to `user2`, so it would need to be `0666`, else `user2` wouldn't be able to access it later.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1802047461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hwti","id":827856,"node_id":"MDQ6VXNlcjgyNzg1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/827856?v=4","gravatar_id":"","url":"https://api.github.com/users/hwti","html_url":"https://github.com/hwti","followers_url":"https://api.github.com/users/hwti/followers","following_url":"https://api.github.com/users/hwti/following{/other_user}","gists_url":"https://api.github.com/users/hwti/gists{/gist_id}","starred_url":"https://api.github.com/users/hwti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hwti/subscriptions","organizations_url":"https://api.github.com/users/hwti/orgs","repos_url":"https://api.github.com/users/hwti/repos","events_url":"https://api.github.com/users/hwti/events{/privacy}","received_events_url":"https://api.github.com/users/hwti/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":10915052188,"node_id":"LE_lADOAAiu0c52PjSAzwAAAAKKlnqc","url":"https://api.github.com/repos/curl/curl/issues/events/10915052188","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-11-09T15:54:59Z","label":{"name":"cookies","color":"bfdadc"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1804224017","html_url":"https://github.com/curl/curl/issues/12299#issuecomment-1804224017","issue_url":"https://api.github.com/repos/curl/curl/issues/12299","id":1804224017,"node_id":"IC_kwDOAAiu0c5rikYR","user":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-09T17:08:41Z","updated_at":"2023-11-09T17:08:41Z","body":"I've pondered a bit back and forth on this and yes, I think `0600 | sb.st_mode` is what we want. You up for writing a PR for this @hwti ?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1804224017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":10915884410,"node_id":"MEE_lADOAAiu0c52PjSAzwAAAAKKoy16","url":"https://api.github.com/repos/curl/curl/issues/events/10915884410","actor":{"login":"hwti","id":827856,"node_id":"MDQ6VXNlcjgyNzg1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/827856?v=4","gravatar_id":"","url":"https://api.github.com/users/hwti","html_url":"https://github.com/hwti","followers_url":"https://api.github.com/users/hwti/followers","following_url":"https://api.github.com/users/hwti/following{/other_user}","gists_url":"https://api.github.com/users/hwti/gists{/gist_id}","starred_url":"https://api.github.com/users/hwti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hwti/subscriptions","organizations_url":"https://api.github.com/users/hwti/orgs","repos_url":"https://api.github.com/users/hwti/repos","events_url":"https://api.github.com/users/hwti/events{/privacy}","received_events_url":"https://api.github.com/users/hwti/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-11-09T17:08:42Z","performed_via_github_app":null},{"id":10915884427,"node_id":"SE_lADOAAiu0c52PjSAzwAAAAKKoy2L","url":"https://api.github.com/repos/curl/curl/issues/events/10915884427","actor":{"login":"hwti","id":827856,"node_id":"MDQ6VXNlcjgyNzg1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/827856?v=4","gravatar_id":"","url":"https://api.github.com/users/hwti","html_url":"https://github.com/hwti","followers_url":"https://api.github.com/users/hwti/followers","following_url":"https://api.github.com/users/hwti/following{/other_user}","gists_url":"https://api.github.com/users/hwti/gists{/gist_id}","starred_url":"https://api.github.com/users/hwti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hwti/subscriptions","organizations_url":"https://api.github.com/users/hwti/orgs","repos_url":"https://api.github.com/users/hwti/repos","events_url":"https://api.github.com/users/hwti/events{/privacy}","received_events_url":"https://api.github.com/users/hwti/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-11-09T17:08:42Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1808382671","html_url":"https://github.com/curl/curl/issues/12299#issuecomment-1808382671","issue_url":"https://api.github.com/repos/curl/curl/issues/12299","id":1808382671,"node_id":"IC_kwDOAAiu0c5rybrP","user":{"login":"hwti","id":827856,"node_id":"MDQ6VXNlcjgyNzg1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/827856?v=4","gravatar_id":"","url":"https://api.github.com/users/hwti","html_url":"https://github.com/hwti","followers_url":"https://api.github.com/users/hwti/followers","following_url":"https://api.github.com/users/hwti/following{/other_user}","gists_url":"https://api.github.com/users/hwti/gists{/gist_id}","starred_url":"https://api.github.com/users/hwti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hwti/subscriptions","organizations_url":"https://api.github.com/users/hwti/orgs","repos_url":"https://api.github.com/users/hwti/repos","events_url":"https://api.github.com/users/hwti/events{/privacy}","received_events_url":"https://api.github.com/users/hwti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-13T15:29:11Z","updated_at":"2023-11-13T15:29:11Z","body":"What about the `fchmod`, should we do it without the uid/gid condition ?\r\nIf yes, then the `fstat` would actually be useless (no point to do a stat to avoid a chmod).","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1808382671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hwti","id":827856,"node_id":"MDQ6VXNlcjgyNzg1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/827856?v=4","gravatar_id":"","url":"https://api.github.com/users/hwti","html_url":"https://github.com/hwti","followers_url":"https://api.github.com/users/hwti/followers","following_url":"https://api.github.com/users/hwti/following{/other_user}","gists_url":"https://api.github.com/users/hwti/gists{/gist_id}","starred_url":"https://api.github.com/users/hwti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hwti/subscriptions","organizations_url":"https://api.github.com/users/hwti/orgs","repos_url":"https://api.github.com/users/hwti/repos","events_url":"https://api.github.com/users/hwti/events{/privacy}","received_events_url":"https://api.github.com/users/hwti/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1809801290","html_url":"https://github.com/curl/curl/issues/12299#issuecomment-1809801290","issue_url":"https://api.github.com/repos/curl/curl/issues/12299","id":1809801290,"node_id":"IC_kwDOAAiu0c5r32BK","user":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-14T09:05:13Z","updated_at":"2023-11-14T09:05:13Z","body":"... but if we consider skipping `fstat()` to do `chmod` unconditionally, can't we then instead change the `open()` call to the version below, and cut out the entire `#ifdef` block?\r\n\r\n~~~c\r\n  fd = open(tempstore, O_WRONLY | O_CREAT | O_EXCL, (mode_t)sb.st_mode);\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1809801290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11048658672,"node_id":"REFE_lADOAAiu0c52PjSAzwAAAAKSjSbw","url":"https://api.github.com/repos/curl/curl/issues/events/11048658672","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"efa8d1d5b08c1b3f97e5622f5d3afe6453177d89","commit_url":"https://api.github.com/repos/curl/curl/commits/efa8d1d5b08c1b3f97e5622f5d3afe6453177d89","created_at":"2023-11-23T14:56:26Z","performed_via_github_app":null},{"actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-23T14:56:32Z","updated_at":"2023-11-23T14:56:32Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/curl/curl/issues/12395","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/12395/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/12395/comments","events_url":"https://api.github.com/repos/curl/curl/issues/12395/events","html_url":"https://github.com/curl/curl/pull/12395","id":2008387846,"node_id":"PR_kwDOAAiu0c5gPPuZ","number":12395,"title":"fopen: create new file using old file's mode","user":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-11-23T14:56:31Z","updated_at":"2023-11-23T21:56:10Z","closed_at":"2023-11-23T21:56:06Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":569041,"node_id":"MDEwOlJlcG9zaXRvcnk1NjkwNDE=","name":"curl","full_name":"curl/curl","private":false,"owner":{"login":"curl","id":16928085,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE2OTI4MDg1","avatar_url":"https://avatars.githubusercontent.com/u/16928085?v=4","gravatar_id":"","url":"https://api.github.com/users/curl","html_url":"https://github.com/curl","followers_url":"https://api.github.com/users/curl/followers","following_url":"https://api.github.com/users/curl/following{/other_user}","gists_url":"https://api.github.com/users/curl/gists{/gist_id}","starred_url":"https://api.github.com/users/curl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/curl/subscriptions","organizations_url":"https://api.github.com/users/curl/orgs","repos_url":"https://api.github.com/users/curl/repos","events_url":"https://api.github.com/users/curl/events{/privacy}","received_events_url":"https://api.github.com/users/curl/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/curl/curl","description":"A command line tool and library for transferring data with URL syntax, supporting DICT, FILE, FTP, FTPS, GOPHER, GOPHERS, HTTP, HTTPS, IMAP, IMAPS, LDAP, LDAPS, MQTT, POP3, POP3S, RTMP, RTMPS, RTSP, SCP, SFTP, SMB, SMBS, SMTP, SMTPS, TELNET, TFTP, WS and WSS. libcurl offers a myriad of powerful features","fork":false,"url":"https://api.github.com/repos/curl/curl","forks_url":"https://api.github.com/repos/curl/curl/forks","keys_url":"https://api.github.com/repos/curl/curl/keys{/key_id}","collaborators_url":"https://api.github.com/repos/curl/curl/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/curl/curl/teams","hooks_url":"https://api.github.com/repos/curl/curl/hooks","issue_events_url":"https://api.github.com/repos/curl/curl/issues/events{/number}","events_url":"https://api.github.com/repos/curl/curl/events","assignees_url":"https://api.github.com/repos/curl/curl/assignees{/user}","branches_url":"https://api.github.com/repos/curl/curl/branches{/branch}","tags_url":"https://api.github.com/repos/curl/curl/tags","blobs_url":"https://api.github.com/repos/curl/curl/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/curl/curl/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/curl/curl/git/refs{/sha}","trees_url":"https://api.github.com/repos/curl/curl/git/trees{/sha}","statuses_url":"https://api.github.com/repos/curl/curl/statuses/{sha}","languages_url":"https://api.github.com/repos/curl/curl/languages","stargazers_url":"https://api.github.com/repos/curl/curl/stargazers","contributors_url":"https://api.github.com/repos/curl/curl/contributors","subscribers_url":"https://api.github.com/repos/curl/curl/subscribers","subscription_url":"https://api.github.com/repos/curl/curl/subscription","commits_url":"https://api.github.com/repos/curl/curl/commits{/sha}","git_commits_url":"https://api.github.com/repos/curl/curl/git/commits{/sha}","comments_url":"https://api.github.com/repos/curl/curl/comments{/number}","issue_comment_url":"https://api.github.com/repos/curl/curl/issues/comments{/number}","contents_url":"https://api.github.com/repos/curl/curl/contents/{+path}","compare_url":"https://api.github.com/repos/curl/curl/compare/{base}...{head}","merges_url":"https://api.github.com/repos/curl/curl/merges","archive_url":"https://api.github.com/repos/curl/curl/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/curl/curl/downloads","issues_url":"https://api.github.com/repos/curl/curl/issues{/number}","pulls_url":"https://api.github.com/repos/curl/curl/pulls{/number}","milestones_url":"https://api.github.com/repos/curl/curl/milestones{/number}","notifications_url":"https://api.github.com/repos/curl/curl/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/curl/curl/labels{/name}","releases_url":"https://api.github.com/repos/curl/curl/releases{/id}","deployments_url":"https://api.github.com/repos/curl/curl/deployments","created_at":"2010-03-18T22:32:22Z","updated_at":"2025-11-10T09:41:55Z","pushed_at":"2025-11-10T12:18:24Z","git_url":"git://github.com/curl/curl.git","ssh_url":"git@github.com:curl/curl.git","clone_url":"https://github.com/curl/curl.git","svn_url":"https://github.com/curl/curl","homepage":"https://curl.se/","size":118458,"stargazers_count":39830,"watchers_count":39830,"language":"C","has_issues":true,"has_projects":false,"has_downloads":false,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6941,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":43,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["c","client","curl","ftp","gopher","hacktoberfest","http","https","imaps","ldap","libcurl","library","mqtt","pop3","scp","sftp","transfer-data","transferring-data","user-agent","websocket"],"visibility":"public","forks":6941,"open_issues":43,"watchers":39830,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/curl/curl/pulls/12395","html_url":"https://github.com/curl/curl/pull/12395","diff_url":"https://github.com/curl/curl/pull/12395.diff","patch_url":"https://github.com/curl/curl/pull/12395.patch","merged_at":null},"body":"Because the function renames the temp file to the target name as a last step, if the file was previously owned by a different user, not ORing the old mode could otherwise end up creating a file that was no longer readable by the original owner after save.\r\n\r\nReported-by: LoÃ¯c Yhuel\r\nFixes #12299","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/12395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/12395/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1824570898","html_url":"https://github.com/curl/curl/issues/12299#issuecomment-1824570898","issue_url":"https://api.github.com/repos/curl/curl/issues/12299","id":1824570898,"node_id":"IC_kwDOAAiu0c5swL4S","user":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-23T14:56:44Z","updated_at":"2023-11-23T14:56:44Z","body":"See  #12395 for my take on a fix.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1824570898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11049736265,"node_id":"REFE_lADOAAiu0c52PjSAzwAAAAKSnZhJ","url":"https://api.github.com/repos/curl/curl/issues/events/11049736265","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"0f6f04375359ccbdae05f2293b6cc240da60b885","commit_url":"https://api.github.com/repos/curl/curl/commits/0f6f04375359ccbdae05f2293b6cc240da60b885","created_at":"2023-11-23T16:57:10Z","performed_via_github_app":null},{"id":11050511660,"node_id":"REFE_lADOAAiu0c52PjSAzwAAAAKSqW0s","url":"https://api.github.com/repos/curl/curl/issues/events/11050511660","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"dda60b3f88dab50871ea4e87c8188e63dd868648","commit_url":"https://api.github.com/repos/curl/curl/commits/dda60b3f88dab50871ea4e87c8188e63dd868648","created_at":"2023-11-23T19:24:19Z","performed_via_github_app":null},{"id":11051192956,"node_id":"CE_lADOAAiu0c52PjSAzwAAAAKSs9J8","url":"https://api.github.com/repos/curl/curl/issues/events/11051192956","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"03cb1ff4d629d6110dab787c75c187626d58323d","commit_url":"https://api.github.com/repos/curl/curl/commits/03cb1ff4d629d6110dab787c75c187626d58323d","created_at":"2023-11-23T21:56:06Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1825950719","html_url":"https://github.com/curl/curl/issues/12299#issuecomment-1825950719","issue_url":"https://api.github.com/repos/curl/curl/issues/12299","id":1825950719,"node_id":"IC_kwDOAAiu0c5s1cv_","user":{"login":"hwti","id":827856,"node_id":"MDQ6VXNlcjgyNzg1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/827856?v=4","gravatar_id":"","url":"https://api.github.com/users/hwti","html_url":"https://github.com/hwti","followers_url":"https://api.github.com/users/hwti/followers","following_url":"https://api.github.com/users/hwti/following{/other_user}","gists_url":"https://api.github.com/users/hwti/gists{/gist_id}","starred_url":"https://api.github.com/users/hwti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hwti/subscriptions","organizations_url":"https://api.github.com/users/hwti/orgs","repos_url":"https://api.github.com/users/hwti/repos","events_url":"https://api.github.com/users/hwti/events{/privacy}","received_events_url":"https://api.github.com/users/hwti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-24T17:37:49Z","updated_at":"2023-11-24T17:39:24Z","body":"Sorry for not responding earlier, I was quite busy with other work.\r\n\r\n> ... but if we consider skipping `fstat()` to do `chmod` unconditionally, can't we then instead change the `open()` call to the version below, and cut out the entire `#ifdef` block?\r\n> \r\n> ```c\r\n>   fd = open(tempstore, O_WRONLY | O_CREAT | O_EXCL, (mode_t)sb.st_mode);\r\n> ```\r\n\r\nUnlike `fchmod`, `open` is affected by the umask (typically `022`, so removing group / other write).\r\nSo if the permissions were modified outside of curl (or by calling curl with a modified umask, which is less likely), these additional modifications would be lost.\r\n\r\nSo to share a cookie file between users, there are several options :\r\n - run the program with a large umask (not great)\r\n - a manual `chmod 0660` (or `0666`), for example when pre-creating the file : it worked before 20f9dd6bae50b7223171b17ba7798946e74f877f, but now it would require a `fchmod` to set the full `0600 | sb.st_mode`\r\n - reverting 0c667188e0c6cda615a036b8a2b4125f2c404dde : `fopen(filename, FOPEN_WRITETEXT)` needs write permission on the file, but `rename()` doesn't (so it could work with `0644` files, nothing special would be needed)\r\n\r\nIn fact, 0c667188e0c6cda615a036b8a2b4125f2c404dde made the non-regular file check atomic, but at the same time truncated the file with `FOPEN_WRITETEXT`, which is not atomic.\r\nI don't see an easy way to make both operations atomic, so we probably have to choose (unless maybe reopening `/proc/self/fd/%d`, but this would be Linux-specific, and I don't know if it would really work).","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1825950719/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hwti","id":827856,"node_id":"MDQ6VXNlcjgyNzg1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/827856?v=4","gravatar_id":"","url":"https://api.github.com/users/hwti","html_url":"https://github.com/hwti","followers_url":"https://api.github.com/users/hwti/followers","following_url":"https://api.github.com/users/hwti/following{/other_user}","gists_url":"https://api.github.com/users/hwti/gists{/gist_id}","starred_url":"https://api.github.com/users/hwti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hwti/subscriptions","organizations_url":"https://api.github.com/users/hwti/orgs","repos_url":"https://api.github.com/users/hwti/repos","events_url":"https://api.github.com/users/hwti/events{/privacy}","received_events_url":"https://api.github.com/users/hwti/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11620951236,"node_id":"REFE_lADOAAiu0c52PjSAzwAAAAK0qaTE","url":"https://api.github.com/repos/curl/curl/issues/events/11620951236","actor":{"login":"sftcd","id":5494807,"node_id":"MDQ6VXNlcjU0OTQ4MDc=","avatar_url":"https://avatars.githubusercontent.com/u/5494807?v=4","gravatar_id":"","url":"https://api.github.com/users/sftcd","html_url":"https://github.com/sftcd","followers_url":"https://api.github.com/users/sftcd/followers","following_url":"https://api.github.com/users/sftcd/following{/other_user}","gists_url":"https://api.github.com/users/sftcd/gists{/gist_id}","starred_url":"https://api.github.com/users/sftcd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sftcd/subscriptions","organizations_url":"https://api.github.com/users/sftcd/orgs","repos_url":"https://api.github.com/users/sftcd/repos","events_url":"https://api.github.com/users/sftcd/events{/privacy}","received_events_url":"https://api.github.com/users/sftcd/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"03cb1ff4d629d6110dab787c75c187626d58323d","commit_url":"https://api.github.com/repos/defo-project/curl/commits/03cb1ff4d629d6110dab787c75c187626d58323d","created_at":"2024-01-28T21:31:49Z","performed_via_github_app":null}]