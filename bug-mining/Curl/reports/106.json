{"url":"https://api.github.com/repos/curl/curl/issues/9921","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/9921/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/9921/comments","events_url":"https://api.github.com/repos/curl/curl/issues/9921/events","html_url":"https://github.com/curl/curl/issues/9921","id":1450640673,"node_id":"I_kwDOAAiu0c5WdwUh","number":9921,"title":"vcpkg install on linux skip detect poll API","user":{"login":"comphilip","id":13473736,"node_id":"MDQ6VXNlcjEzNDczNzM2","avatar_url":"https://avatars.githubusercontent.com/u/13473736?v=4","gravatar_id":"","url":"https://api.github.com/users/comphilip","html_url":"https://github.com/comphilip","followers_url":"https://api.github.com/users/comphilip/followers","following_url":"https://api.github.com/users/comphilip/following{/other_user}","gists_url":"https://api.github.com/users/comphilip/gists{/gist_id}","starred_url":"https://api.github.com/users/comphilip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/comphilip/subscriptions","organizations_url":"https://api.github.com/users/comphilip/orgs","repos_url":"https://api.github.com/users/comphilip/repos","events_url":"https://api.github.com/users/comphilip/events{/privacy}","received_events_url":"https://api.github.com/users/comphilip/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184123162,"node_id":"MDU6TGFiZWwxODQxMjMxNjI=","url":"https://api.github.com/repos/curl/curl/labels/cmake","name":"cmake","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-11-16T01:13:12Z","updated_at":"2022-11-16T15:06:12Z","closed_at":"2022-11-16T15:06:12Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!-- Only file bugs here! Ask questions on the mailing lists https://curl.se/mail/\r\n\r\n     SECURITY RELATED? Post it here: https://hackerone.com/curl\r\n\r\n     There are collections of known issues to be aware of:\r\n     https://curl.se/docs/knownbugs.html\r\n     https://curl.se/docs/todo.html       -->\r\n\r\n### I did this\r\nAfter running `vcpkg install curl` ,  running `grep HAVE_POLL_FINE <VCPKG_DIR>/buildtrees/curl/x64-linux-rel/lib/curl_config.h`, it shows \r\n```c++\r\n/* #undef HAVE_POLL_FINE */\r\n```\r\n\r\nWithout poll API, curl multi-api cannot handle more than 1024 concurrent connections with `select` API.\r\n\r\n### I expected the following\r\ncurl build with poll api supported: `HAVE_POLL_FINE` should be defined in `curl_config.h`\r\n### curl/libcurl version\r\n7.84.0\r\n\r\n### operating system\r\nLinux phillip-dev 5.15.0-52-generic #58-Ubuntu SMP Thu Oct 13 08:03:55 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n### Root Cause\r\nCMake script skip detecting poll API if `CMAKE_TOOLCHAIN_FILE` defined(My guess: skip detecting POLL API if cross-compile). `CMAKE_TOOLCHAIN_FILE` is always defined in vcpkg:https://vcpkg.io/en/docs/maintainers/vcpkg_cmake_configure.html#implicit-options\r\nhttps://github.com/curl/curl/blob/bbb36409de55fcf8e0110951c26896f59ba8aa5f/CMake/OtherTests.cmake#L88\r\n\r\n","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/9921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/9921/timeline","performed_via_github_app":null,"state_reason":"completed"}