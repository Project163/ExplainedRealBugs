[{"id":18999380344,"node_id":"RTE_lADOAAiu0c7EW-VQzwAAAARsc4l4","url":"https://api.github.com/repos/curl/curl/issues/events/18999380344","actor":{"login":"MichalPetryka","id":35800402,"node_id":"MDQ6VXNlcjM1ODAwNDAy","avatar_url":"https://avatars.githubusercontent.com/u/35800402?v=4","gravatar_id":"","url":"https://api.github.com/users/MichalPetryka","html_url":"https://github.com/MichalPetryka","followers_url":"https://api.github.com/users/MichalPetryka/followers","following_url":"https://api.github.com/users/MichalPetryka/following{/other_user}","gists_url":"https://api.github.com/users/MichalPetryka/gists{/gist_id}","starred_url":"https://api.github.com/users/MichalPetryka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichalPetryka/subscriptions","organizations_url":"https://api.github.com/users/MichalPetryka/orgs","repos_url":"https://api.github.com/users/MichalPetryka/repos","events_url":"https://api.github.com/users/MichalPetryka/events{/privacy}","received_events_url":"https://api.github.com/users/MichalPetryka/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2025-08-05T20:32:46Z","rename":{"from":"`--ca-native`/CURLSSLOPT_NATIVE_CA` break when cert store contains invalid certs","to":"`--ca-native`/`CURLSSLOPT_NATIVE_CA` break when cert store contains invalid certs"},"performed_via_github_app":null},{"id":19001154239,"node_id":"LE_lADOAAiu0c7EW-VQzwAAAARsjpq_","url":"https://api.github.com/repos/curl/curl/issues/events/19001154239","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2025-08-05T22:55:17Z","label":{"name":"TLS","color":"bfdadc"},"performed_via_github_app":null},{"id":19001154244,"node_id":"LE_lADOAAiu0c7EW-VQzwAAAARsjprE","url":"https://api.github.com/repos/curl/curl/issues/events/19001154244","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2025-08-05T22:55:17Z","label":{"name":"Windows","color":"0e8a16"},"performed_via_github_app":null},{"id":19004965691,"node_id":"LE_lADOAAiu0c7EW-VQzwAAAARsyMM7","url":"https://api.github.com/repos/curl/curl/issues/events/19004965691","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2025-08-06T06:07:28Z","label":{"name":"help wanted","color":"fbca04"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3158025796","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3158025796","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3158025796,"node_id":"IC_kwDOAAiu0c68O6ZE","user":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-06T08:06:55Z","updated_at":"2025-08-06T08:06:55Z","body":"It would be useful to get a trace where the mentioned error really occurs. On first inspection, it seems that `import_windows_cert_store()` *does ignore* certificates with errors already. So, if you could run a command on your system like:\n\n```\n> curl -vvvv -ca-native url\n```\n\nit could help us understand what is going on. Thanks.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3158025796/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3160696362","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3160696362","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3160696362,"node_id":"IC_kwDOAAiu0c68ZGYq","user":{"login":"ced777ric","id":44529860,"node_id":"MDQ6VXNlcjQ0NTI5ODYw","avatar_url":"https://avatars.githubusercontent.com/u/44529860?v=4","gravatar_id":"","url":"https://api.github.com/users/ced777ric","html_url":"https://github.com/ced777ric","followers_url":"https://api.github.com/users/ced777ric/followers","following_url":"https://api.github.com/users/ced777ric/following{/other_user}","gists_url":"https://api.github.com/users/ced777ric/gists{/gist_id}","starred_url":"https://api.github.com/users/ced777ric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ced777ric/subscriptions","organizations_url":"https://api.github.com/users/ced777ric/orgs","repos_url":"https://api.github.com/users/ced777ric/repos","events_url":"https://api.github.com/users/ced777ric/events{/privacy}","received_events_url":"https://api.github.com/users/ced777ric/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-06T15:47:39Z","updated_at":"2025-08-06T15:47:39Z","body":"It seems that the issue does not occur when using verbose logging, only without logging\n\n[log.txt](https://github.com/user-attachments/files/21622198/log.txt)","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3160696362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ced777ric","id":44529860,"node_id":"MDQ6VXNlcjQ0NTI5ODYw","avatar_url":"https://avatars.githubusercontent.com/u/44529860?v=4","gravatar_id":"","url":"https://api.github.com/users/ced777ric","html_url":"https://github.com/ced777ric","followers_url":"https://api.github.com/users/ced777ric/followers","following_url":"https://api.github.com/users/ced777ric/following{/other_user}","gists_url":"https://api.github.com/users/ced777ric/gists{/gist_id}","starred_url":"https://api.github.com/users/ced777ric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ced777ric/subscriptions","organizations_url":"https://api.github.com/users/ced777ric/orgs","repos_url":"https://api.github.com/users/ced777ric/repos","events_url":"https://api.github.com/users/ced777ric/events{/privacy}","received_events_url":"https://api.github.com/users/ced777ric/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3163475707","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3163475707","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3163475707,"node_id":"IC_kwDOAAiu0c68js77","user":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T10:21:37Z","updated_at":"2025-08-07T10:21:37Z","body":"Which points to something very weird going on in your system. If there is some timing effect, you can try to reduce the tracing. For example trace only the SSL related things via:\n\n```sh\n> curl -v --trace-config ssl --ca-native https://api.ipify.org\n```\n\nand see if that makes a difference.  Another thing I see in your log is that your connect times seem very long:\n\n```\n08:37:07.619000 [0-0] == Info: [DNS] resolve thread started for of api.ipify.org:443\n...\n08:37:07.744000 [0-0] == Info:   Trying 172.67.74.152:443...\n...\n08:37:07.869000 [0-0] == Info: [TCP] connected\n...\n08:37:08.290000 [0-0] == Info: [TCP] send(len=1564) -> 0, 1564\n...\n08:37:08.337000 [0-0] == Info: [SSL] ossl_populate_x509_store, path=none, blob=0\n...\n08:37:08.353000 [0-0] == Info: successfully imported Windows CA store\n...\n08:37:08.400000 [0-0] <= Recv SSL data, 1210 bytes (0x4ba)\n...\n08:37:08.759000 [0-0] <= Recv SSL data, 2524 bytes (0x9dc)\n...\n08:37:09.322000 [0-0] == Info: [TCP] send(len=80) -> 0, 80\n08:37:09.338000 [0-0] == Info: SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384 / X25519MLKEM768 / id-ecPublicKey\n```\n\nYour curl takes ~120ms to resolve the hostname, ~120ms to connect the TCP socket, ~400ms(!) to send the TLS client hello, 110ms to get the first TLS server reply, 350ms to get the final TLS server reply and 560ms to send the TLS client answer. Either your client is very slow, or something is installed in your Windows machine/network that interferes here a lot. \n\nTo compare, on my macOS machine curl takes **30ms in total** to establish the SSL connection to `api.ipify.org`, compared to the **~1600ms** on your machine.\n\nI suspect someone is messing with you, be it a local AntiVir/Security or middle boxes on your network path.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3163475707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3163926788","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3163926788","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3163926788,"node_id":"IC_kwDOAAiu0c68lbEE","user":{"login":"MichalPetryka","id":35800402,"node_id":"MDQ6VXNlcjM1ODAwNDAy","avatar_url":"https://avatars.githubusercontent.com/u/35800402?v=4","gravatar_id":"","url":"https://api.github.com/users/MichalPetryka","html_url":"https://github.com/MichalPetryka","followers_url":"https://api.github.com/users/MichalPetryka/followers","following_url":"https://api.github.com/users/MichalPetryka/following{/other_user}","gists_url":"https://api.github.com/users/MichalPetryka/gists{/gist_id}","starred_url":"https://api.github.com/users/MichalPetryka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichalPetryka/subscriptions","organizations_url":"https://api.github.com/users/MichalPetryka/orgs","repos_url":"https://api.github.com/users/MichalPetryka/repos","events_url":"https://api.github.com/users/MichalPetryka/events{/privacy}","received_events_url":"https://api.github.com/users/MichalPetryka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T12:10:36Z","updated_at":"2025-08-07T12:14:54Z","body":"> Which points to something very weird going on in your system. If there is some timing effect, you can try to reduce the tracing. For example trace only the SSL related things via:\n> \n> > curl -v --trace-config ssl --ca-native https://api.ipify.org\n> and see if that makes a difference. Another thing I see in your log is that your connect times seem very long:\n> \n> ```\n> 08:37:07.619000 [0-0] == Info: [DNS] resolve thread started for of api.ipify.org:443\n> ...\n> 08:37:07.744000 [0-0] == Info:   Trying 172.67.74.152:443...\n> ...\n> 08:37:07.869000 [0-0] == Info: [TCP] connected\n> ...\n> 08:37:08.290000 [0-0] == Info: [TCP] send(len=1564) -> 0, 1564\n> ...\n> 08:37:08.337000 [0-0] == Info: [SSL] ossl_populate_x509_store, path=none, blob=0\n> ...\n> 08:37:08.353000 [0-0] == Info: successfully imported Windows CA store\n> ...\n> 08:37:08.400000 [0-0] <= Recv SSL data, 1210 bytes (0x4ba)\n> ...\n> 08:37:08.759000 [0-0] <= Recv SSL data, 2524 bytes (0x9dc)\n> ...\n> 08:37:09.322000 [0-0] == Info: [TCP] send(len=80) -> 0, 80\n> 08:37:09.338000 [0-0] == Info: SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384 / X25519MLKEM768 / id-ecPublicKey\n> ```\n> \n> Your curl takes ~120ms to resolve the hostname, ~120ms to connect the TCP socket, ~400ms(!) to send the TLS client hello, 110ms to get the first TLS server reply, 350ms to get the final TLS server reply and 560ms to send the TLS client answer. Either your client is very slow, or something is installed in your Windows machine/network that interferes here a lot.\n> \n> To compare, on my macOS machine curl takes **30ms in total** to establish the SSL connection to `api.ipify.org`, compared to the **~1600ms** on your machine.\n> \n> I suspect someone is messing with you, be it a local AntiVir/Security or middle boxes on your network path.\n\n1. This is a log from a reproduction test on a clean Windows 10 VM (with only the cert added), there's nothing that could be messing with it.\n2. Only Serbian users report this and confirm the issue is gone when they remove the certs.\n3. You have the linked OpenSSL issues that confirm it does reject those certs.\n4. You have full repro steps provided in the issue which you could use to verify that the issue is not machine dependent.\n\nIn other words, the issue is verifiably and fully reproducibly proven to be caused by those certs, so I'd really prefer to avoid blaming other unrelated factors.\nEven if it is a timing issue - which seems unlikely with it reproducing the same on every try on multiple machines - that'd still be a bug in the Curl code that needs to be fixed.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3163926788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MichalPetryka","id":35800402,"node_id":"MDQ6VXNlcjM1ODAwNDAy","avatar_url":"https://avatars.githubusercontent.com/u/35800402?v=4","gravatar_id":"","url":"https://api.github.com/users/MichalPetryka","html_url":"https://github.com/MichalPetryka","followers_url":"https://api.github.com/users/MichalPetryka/followers","following_url":"https://api.github.com/users/MichalPetryka/following{/other_user}","gists_url":"https://api.github.com/users/MichalPetryka/gists{/gist_id}","starred_url":"https://api.github.com/users/MichalPetryka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichalPetryka/subscriptions","organizations_url":"https://api.github.com/users/MichalPetryka/orgs","repos_url":"https://api.github.com/users/MichalPetryka/repos","events_url":"https://api.github.com/users/MichalPetryka/events{/privacy}","received_events_url":"https://api.github.com/users/MichalPetryka/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3163944428","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3163944428","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3163944428,"node_id":"IC_kwDOAAiu0c68lfXs","user":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T12:16:28Z","updated_at":"2025-08-07T12:16:28Z","body":"> avoid blaming other unrelated factors.\n\nHey, no one is *blaming* anything or anyone. You come to us with a problem *you* have. It is perfectly legitimate for us to ask questions about what you see and report.\n\nDo not assume that everyone can and is even willing to reproduce those problems (for example because it requires running and debugging on Windows) and you should probably instead be glad that some of us are still interested to help even if we can't - but that may mean that we ask more questions.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3163944428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3163966978","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3163966978","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3163966978,"node_id":"IC_kwDOAAiu0c68lk4C","user":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T12:24:16Z","updated_at":"2025-08-07T12:24:16Z","body":"@MichalPetryka I am not here to prove you wrong. I am saying that I cannot reproduce your problem and give hints where I see strange behaviour that I would use in my investigation of the root cause. In order to help you, as I cannot reproduce.\n\nDo with that what you want. I do not see a bug in curl from this.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3163966978/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":19034390957,"node_id":"MEE_lADOAAiu0c7EW-VQzwAAAARuicGt","url":"https://api.github.com/repos/curl/curl/issues/events/19034390957","actor":{"login":"MichalPetryka","id":35800402,"node_id":"MDQ6VXNlcjM1ODAwNDAy","avatar_url":"https://avatars.githubusercontent.com/u/35800402?v=4","gravatar_id":"","url":"https://api.github.com/users/MichalPetryka","html_url":"https://github.com/MichalPetryka","followers_url":"https://api.github.com/users/MichalPetryka/followers","following_url":"https://api.github.com/users/MichalPetryka/following{/other_user}","gists_url":"https://api.github.com/users/MichalPetryka/gists{/gist_id}","starred_url":"https://api.github.com/users/MichalPetryka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichalPetryka/subscriptions","organizations_url":"https://api.github.com/users/MichalPetryka/orgs","repos_url":"https://api.github.com/users/MichalPetryka/repos","events_url":"https://api.github.com/users/MichalPetryka/events{/privacy}","received_events_url":"https://api.github.com/users/MichalPetryka/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2025-08-07T12:24:17Z","performed_via_github_app":null},{"id":19034390988,"node_id":"SE_lADOAAiu0c7EW-VQzwAAAARuicHM","url":"https://api.github.com/repos/curl/curl/issues/events/19034390988","actor":{"login":"MichalPetryka","id":35800402,"node_id":"MDQ6VXNlcjM1ODAwNDAy","avatar_url":"https://avatars.githubusercontent.com/u/35800402?v=4","gravatar_id":"","url":"https://api.github.com/users/MichalPetryka","html_url":"https://github.com/MichalPetryka","followers_url":"https://api.github.com/users/MichalPetryka/followers","following_url":"https://api.github.com/users/MichalPetryka/following{/other_user}","gists_url":"https://api.github.com/users/MichalPetryka/gists{/gist_id}","starred_url":"https://api.github.com/users/MichalPetryka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichalPetryka/subscriptions","organizations_url":"https://api.github.com/users/MichalPetryka/orgs","repos_url":"https://api.github.com/users/MichalPetryka/repos","events_url":"https://api.github.com/users/MichalPetryka/events{/privacy}","received_events_url":"https://api.github.com/users/MichalPetryka/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2025-08-07T12:24:17Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164008650","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3164008650","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3164008650,"node_id":"IC_kwDOAAiu0c68lvDK","user":{"login":"MichalPetryka","id":35800402,"node_id":"MDQ6VXNlcjM1ODAwNDAy","avatar_url":"https://avatars.githubusercontent.com/u/35800402?v=4","gravatar_id":"","url":"https://api.github.com/users/MichalPetryka","html_url":"https://github.com/MichalPetryka","followers_url":"https://api.github.com/users/MichalPetryka/followers","following_url":"https://api.github.com/users/MichalPetryka/following{/other_user}","gists_url":"https://api.github.com/users/MichalPetryka/gists{/gist_id}","starred_url":"https://api.github.com/users/MichalPetryka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichalPetryka/subscriptions","organizations_url":"https://api.github.com/users/MichalPetryka/orgs","repos_url":"https://api.github.com/users/MichalPetryka/repos","events_url":"https://api.github.com/users/MichalPetryka/events{/privacy}","received_events_url":"https://api.github.com/users/MichalPetryka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T12:37:43Z","updated_at":"2025-08-07T12:37:43Z","body":"> > avoid blaming other unrelated factors.\n> \n> Hey, no one is _blaming_ anything or anyone. You come to us with a problem _you_ have. It is perfectly legitimate for us to ask questions about what you see and report.\n> \n> Do not assume that everyone can and is even willing to reproduce those problems (for example because it requires running and debugging on Windows) and you should probably instead be glad that some of us are still interested to help even if we can't - but that may mean that we ask more questions.\n\nSorry but it's a bit frustrating to receive a response that presumes the issue is caused by machine related factors after the issue is reported to be reproductible on any Windows machine with the provided steps. We are happy to assist with testing the issue but for that to be meaningful, I wanted to reiterate that the issue does not appear environment specific.\n\n> I am saying that I cannot reproduce your problem\n\nI might be missing something but I did not see a mention of that in your original reply.\nAre you sure you meet all of the required conditions:\n1. A Windows Machine\n2. A curl build using the OpenSSL API\n3. Having the provided certificate added to an active Windows Certificate Store\n4. Using `--ca-native` for the request\n\nIf yes then that'd be very surprising since the issue reproduces for multiple Serbian users and our VM reliably with just those conditions.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164008650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MichalPetryka","id":35800402,"node_id":"MDQ6VXNlcjM1ODAwNDAy","avatar_url":"https://avatars.githubusercontent.com/u/35800402?v=4","gravatar_id":"","url":"https://api.github.com/users/MichalPetryka","html_url":"https://github.com/MichalPetryka","followers_url":"https://api.github.com/users/MichalPetryka/followers","following_url":"https://api.github.com/users/MichalPetryka/following{/other_user}","gists_url":"https://api.github.com/users/MichalPetryka/gists{/gist_id}","starred_url":"https://api.github.com/users/MichalPetryka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichalPetryka/subscriptions","organizations_url":"https://api.github.com/users/MichalPetryka/orgs","repos_url":"https://api.github.com/users/MichalPetryka/repos","events_url":"https://api.github.com/users/MichalPetryka/events{/privacy}","received_events_url":"https://api.github.com/users/MichalPetryka/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164105396","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3164105396","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3164105396,"node_id":"IC_kwDOAAiu0c68mGq0","user":{"login":"vszakats","id":1446897,"node_id":"MDQ6VXNlcjE0NDY4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1446897?v=4","gravatar_id":"","url":"https://api.github.com/users/vszakats","html_url":"https://github.com/vszakats","followers_url":"https://api.github.com/users/vszakats/followers","following_url":"https://api.github.com/users/vszakats/following{/other_user}","gists_url":"https://api.github.com/users/vszakats/gists{/gist_id}","starred_url":"https://api.github.com/users/vszakats/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vszakats/subscriptions","organizations_url":"https://api.github.com/users/vszakats/orgs","repos_url":"https://api.github.com/users/vszakats/repos","events_url":"https://api.github.com/users/vszakats/events{/privacy}","received_events_url":"https://api.github.com/users/vszakats/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T13:04:22Z","updated_at":"2025-08-07T13:24:04Z","body":"I could reproduce it with the MSYS2 mingw-w64 build of curl (as one built with OpenSSL) on Windows 11 (VM):\n\n```\n> curl.exe -vvvv --ca-native https://curl.se/\n[...]\n14:57:01.691000 [0-0] == Info: [SSL] ossl_bio_cf_in_read(len=5) -> -1, err=81\n14:57:01.691000 [0-0] == Info: [SSL] ossl_populate_x509_store, path=C:/msys64/clangarm64/etc/ssl/certs/ca-bundle.crt, blob=0\n14:57:01.691000 [0-0] == Info: successfully imported Windows ROOT store\n14:57:01.707000 [0-0] == Info: successfully imported Windows CA store\n14:57:01.709000 [0-0] == Info:  CAfile: C:/msys64/clangarm64/etc/ssl/certs/ca-bundle.crt\n14:57:01.709000 [0-0] == Info:  CApath: none\n14:57:01.709000 [0-0] == Info: [SSL] SSL_connect() -> err=-1, detail=1\n14:57:01.709000 [0-0] == Info: TLS connect error: error:068000DD:asn1 encoding routines::illegal padding\n14:57:01.709000 [0-0] == Info: [SSL] cf_connect() -> 35, done=0\n14:57:01.709000 [0-0] == Info: [HTTPS-CONNECT] connect, all attempts failed\n14:57:01.709000 [0-0] == Info: [HTTPS-CONNECT] connect -> 35, done=0\n[...]\n\n> curl.exe -V\ncurl 8.13.0 (Windows) libcurl/8.13.0 OpenSSL/3.5.0 zlib/1.3.1 brotli/1.1.0 zstd/1.5.7 libidn2/2.3.8 libpsl/0.21.5 libssh2/1.11.1 nghttp2/1.65.0 nghttp3/1.9.0\nRelease-Date: 2025-04-02\nProtocols: dict file ftp ftps gopher gophers http https imap imaps ipfs ipns ldap ldaps mqtt pop3 pop3s rtsp scp sftp smb smbs smtp smtps telnet tftp ws wss\nFeatures: alt-svc AsynchDNS brotli HSTS HTTP2 HTTP3 HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTLM PSL SPNEGO SSL SSPI threadsafe TLS-SRP UnixSockets zstd\n```\n\nOfficial Windows binaries (LibreSSL) and curl bundled with Windows 11 (Schannel) did not reproduce it.\n\nWith the latest packages:\n```\n> curl.exe -vvvv --ca-native https://curl.se/\n[...]\n15:17:37.436000 [0-0] == Info: [SSL] ossl_bio_cf_in_read(len=5) -> 81, 0\n15:17:37.436000 [0-0] == Info: [SSL] ossl_populate_x509_store, path=C:/msys64/clangarm64/etc/ssl/certs/ca-bundle.crt, blob=0\n15:17:37.440000 [0-0] == Info: successfully imported Windows ROOT store\n15:17:37.441000 [0-0] == Info: successfully imported Windows CA store\n15:17:37.446000 [0-0] == Info:  CAfile: C:/msys64/clangarm64/etc/ssl/certs/ca-bundle.crt\n15:17:37.446000 [0-0] == Info:  CApath: none\n15:17:37.448000 [0-0] == Info: [SSL] SSL_connect() -> err=-1, detail=1\n15:17:37.448000 [0-0] == Info: TLS connect error: error:068000DD:asn1 encoding routines::illegal padding\n15:17:37.448000 [0-0] == Info: [SSL] cf_connect() -> 35, done=0\n15:17:37.448000 [0-0] == Info: [HTTPS-CONNECT] connect, all attempts failed\n15:17:37.448000 [0-0] == Info: [HTTPS-CONNECT] connect -> 35, done=0\n[...]\n\n> curl.exe -V\ncurl 8.15.0 (Windows) libcurl/8.15.0 OpenSSL/3.5.2 zlib/1.3.1 brotli/1.1.0 zstd/1.5.7 libidn2/2.3.8 libpsl/0.21.5 libssh2/1.11.1 nghttp2/1.66.0 ngtcp2/1.14.0 nghttp3/1.11.0\nRelease-Date: 2025-07-16\nProtocols: dict file ftp ftps gopher gophers http https imap imaps ipfs ipns ldap ldaps mqtt pop3 pop3s rtsp scp sftp smb smbs smtp smtps telnet tftp ws wss\nFeatures: alt-svc AsynchDNS brotli HSTS HTTP2 HTTP3 HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTLM PSL SPNEGO SSL SSPI threadsafe TLS-SRP UnixSockets zstd\n```\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164105396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vszakats","id":1446897,"node_id":"MDQ6VXNlcjE0NDY4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1446897?v=4","gravatar_id":"","url":"https://api.github.com/users/vszakats","html_url":"https://github.com/vszakats","followers_url":"https://api.github.com/users/vszakats/followers","following_url":"https://api.github.com/users/vszakats/following{/other_user}","gists_url":"https://api.github.com/users/vszakats/gists{/gist_id}","starred_url":"https://api.github.com/users/vszakats/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vszakats/subscriptions","organizations_url":"https://api.github.com/users/vszakats/orgs","repos_url":"https://api.github.com/users/vszakats/repos","events_url":"https://api.github.com/users/vszakats/events{/privacy}","received_events_url":"https://api.github.com/users/vszakats/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164202234","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3164202234","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3164202234,"node_id":"IC_kwDOAAiu0c68meT6","user":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T13:25:26Z","updated_at":"2025-08-07T13:25:26Z","body":"It seems like OpenSSL does not deeply inspect the certificate on loading, but will on use and then fail. This means we cannot in curl detect the offending certificate, I guess?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164202234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164326850","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3164326850","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3164326850,"node_id":"IC_kwDOAAiu0c68m8vC","user":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T13:59:12Z","updated_at":"2025-08-07T13:59:12Z","body":"Reading the [openssl issue 25023](https://github.com/openssl/openssl/issues/25023), the trouble with http://crl.mup.gov.rs/MUPCARoot.crt is that it is indeed a broken certificate, OpenSSL freaks out on parsing it and there is no option in OpenSSL to change that behaviour, e.g. make it ignore such a cert in the root store.\n\nIf that all is correct, I do not see what we could do in curl to make this work. There is nothing wrong in curl how it loads these certificates or uses OpenSSL.\n\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164326850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":19036363230,"node_id":"LE_lADOAAiu0c7EW-VQzwAAAARup9ne","url":"https://api.github.com/repos/curl/curl/issues/events/19036363230","actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2025-08-07T13:59:21Z","label":{"name":"not-a-curl-bug","color":"d4c5f9"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164370560","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3164370560","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3164370560,"node_id":"IC_kwDOAAiu0c68nHaA","user":{"login":"MichalPetryka","id":35800402,"node_id":"MDQ6VXNlcjM1ODAwNDAy","avatar_url":"https://avatars.githubusercontent.com/u/35800402?v=4","gravatar_id":"","url":"https://api.github.com/users/MichalPetryka","html_url":"https://github.com/MichalPetryka","followers_url":"https://api.github.com/users/MichalPetryka/followers","following_url":"https://api.github.com/users/MichalPetryka/following{/other_user}","gists_url":"https://api.github.com/users/MichalPetryka/gists{/gist_id}","starred_url":"https://api.github.com/users/MichalPetryka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichalPetryka/subscriptions","organizations_url":"https://api.github.com/users/MichalPetryka/orgs","repos_url":"https://api.github.com/users/MichalPetryka/repos","events_url":"https://api.github.com/users/MichalPetryka/events{/privacy}","received_events_url":"https://api.github.com/users/MichalPetryka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T14:11:00Z","updated_at":"2025-08-07T14:11:00Z","body":"> This means we cannot in curl detect the offending certificate\n\nCould doing something like\n```cpp\nif (X509_check_purpose(x509, X509_PURPOSE_SSL_CLIENT, 0) < 1)\n    continue;\n```\nmaybe work for detecting invalid ones eagerly?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164370560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MichalPetryka","id":35800402,"node_id":"MDQ6VXNlcjM1ODAwNDAy","avatar_url":"https://avatars.githubusercontent.com/u/35800402?v=4","gravatar_id":"","url":"https://api.github.com/users/MichalPetryka","html_url":"https://github.com/MichalPetryka","followers_url":"https://api.github.com/users/MichalPetryka/followers","following_url":"https://api.github.com/users/MichalPetryka/following{/other_user}","gists_url":"https://api.github.com/users/MichalPetryka/gists{/gist_id}","starred_url":"https://api.github.com/users/MichalPetryka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichalPetryka/subscriptions","organizations_url":"https://api.github.com/users/MichalPetryka/orgs","repos_url":"https://api.github.com/users/MichalPetryka/repos","events_url":"https://api.github.com/users/MichalPetryka/events{/privacy}","received_events_url":"https://api.github.com/users/MichalPetryka/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164464700","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3164464700","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3164464700,"node_id":"IC_kwDOAAiu0c68neY8","user":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T14:36:35Z","updated_at":"2025-08-07T14:37:01Z","body":"@vszakats, care to test how an curl+openssl behaves with the following applied?\n\n```diff\ndiff --git a/lib/vtls/openssl.c b/lib/vtls/openssl.c\nindex a2ab831f20..a01712962d 100644\n--- a/lib/vtls/openssl.c\n+++ b/lib/vtls/openssl.c\n@@ -3330,6 +3330,11 @@ static CURLcode import_windows_cert_store(struct Curl_easy *data,\n       if(!x509)\n         continue;\n\n+      /* Windows may contain some broken certs, in some countries\n+       * by law. See #18190. Trigger the parsing of all x509 extensions. */\n+      if(X509_check_purpose(x509, -1, 0) != 1)\n+        continue;\n+\n       /* Try to import the certificate. This may fail for legitimate\n          reasons such as duplicate certificate, which is allowed by MS but\n          not OpenSSL. */\n```","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164464700/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":19037163130,"node_id":"MEE_lADOAAiu0c7EW-VQzwAAAARutA56","url":"https://api.github.com/repos/curl/curl/issues/events/19037163130","actor":{"login":"vszakats","id":1446897,"node_id":"MDQ6VXNlcjE0NDY4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1446897?v=4","gravatar_id":"","url":"https://api.github.com/users/vszakats","html_url":"https://github.com/vszakats","followers_url":"https://api.github.com/users/vszakats/followers","following_url":"https://api.github.com/users/vszakats/following{/other_user}","gists_url":"https://api.github.com/users/vszakats/gists{/gist_id}","starred_url":"https://api.github.com/users/vszakats/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vszakats/subscriptions","organizations_url":"https://api.github.com/users/vszakats/orgs","repos_url":"https://api.github.com/users/vszakats/repos","events_url":"https://api.github.com/users/vszakats/events{/privacy}","received_events_url":"https://api.github.com/users/vszakats/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2025-08-07T14:36:36Z","performed_via_github_app":null},{"id":19037163195,"node_id":"SE_lADOAAiu0c7EW-VQzwAAAARutA67","url":"https://api.github.com/repos/curl/curl/issues/events/19037163195","actor":{"login":"vszakats","id":1446897,"node_id":"MDQ6VXNlcjE0NDY4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1446897?v=4","gravatar_id":"","url":"https://api.github.com/users/vszakats","html_url":"https://github.com/vszakats","followers_url":"https://api.github.com/users/vszakats/followers","following_url":"https://api.github.com/users/vszakats/following{/other_user}","gists_url":"https://api.github.com/users/vszakats/gists{/gist_id}","starred_url":"https://api.github.com/users/vszakats/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vszakats/subscriptions","organizations_url":"https://api.github.com/users/vszakats/orgs","repos_url":"https://api.github.com/users/vszakats/repos","events_url":"https://api.github.com/users/vszakats/events{/privacy}","received_events_url":"https://api.github.com/users/vszakats/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2025-08-07T14:36:36Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164821216","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3164821216","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3164821216,"node_id":"IC_kwDOAAiu0c68o1bg","user":{"login":"vszakats","id":1446897,"node_id":"MDQ6VXNlcjE0NDY4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1446897?v=4","gravatar_id":"","url":"https://api.github.com/users/vszakats","html_url":"https://github.com/vszakats","followers_url":"https://api.github.com/users/vszakats/followers","following_url":"https://api.github.com/users/vszakats/following{/other_user}","gists_url":"https://api.github.com/users/vszakats/gists{/gist_id}","starred_url":"https://api.github.com/users/vszakats/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vszakats/subscriptions","organizations_url":"https://api.github.com/users/vszakats/orgs","repos_url":"https://api.github.com/users/vszakats/repos","events_url":"https://api.github.com/users/vszakats/events{/privacy}","received_events_url":"https://api.github.com/users/vszakats/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T15:57:24Z","updated_at":"2025-08-07T15:57:24Z","body":"I'll give it go, but can only do it tomorrow.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164821216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vszakats","id":1446897,"node_id":"MDQ6VXNlcjE0NDY4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1446897?v=4","gravatar_id":"","url":"https://api.github.com/users/vszakats","html_url":"https://github.com/vszakats","followers_url":"https://api.github.com/users/vszakats/followers","following_url":"https://api.github.com/users/vszakats/following{/other_user}","gists_url":"https://api.github.com/users/vszakats/gists{/gist_id}","starred_url":"https://api.github.com/users/vszakats/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vszakats/subscriptions","organizations_url":"https://api.github.com/users/vszakats/orgs","repos_url":"https://api.github.com/users/vszakats/repos","events_url":"https://api.github.com/users/vszakats/events{/privacy}","received_events_url":"https://api.github.com/users/vszakats/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164905990","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3164905990","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3164905990,"node_id":"IC_kwDOAAiu0c68pKIG","user":{"login":"vszakats","id":1446897,"node_id":"MDQ6VXNlcjE0NDY4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1446897?v=4","gravatar_id":"","url":"https://api.github.com/users/vszakats","html_url":"https://github.com/vszakats","followers_url":"https://api.github.com/users/vszakats/followers","following_url":"https://api.github.com/users/vszakats/following{/other_user}","gists_url":"https://api.github.com/users/vszakats/gists{/gist_id}","starred_url":"https://api.github.com/users/vszakats/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vszakats/subscriptions","organizations_url":"https://api.github.com/users/vszakats/orgs","repos_url":"https://api.github.com/users/vszakats/repos","events_url":"https://api.github.com/users/vszakats/events{/privacy}","received_events_url":"https://api.github.com/users/vszakats/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T16:20:43Z","updated_at":"2025-08-07T16:20:43Z","body":"Build/VM went smoother than expected, so with the patch applied, the result is unchanged.\nThe `continue;` branch is not taken.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3164905990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vszakats","id":1446897,"node_id":"MDQ6VXNlcjE0NDY4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1446897?v=4","gravatar_id":"","url":"https://api.github.com/users/vszakats","html_url":"https://github.com/vszakats","followers_url":"https://api.github.com/users/vszakats/followers","following_url":"https://api.github.com/users/vszakats/following{/other_user}","gists_url":"https://api.github.com/users/vszakats/gists{/gist_id}","starred_url":"https://api.github.com/users/vszakats/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vszakats/subscriptions","organizations_url":"https://api.github.com/users/vszakats/orgs","repos_url":"https://api.github.com/users/vszakats/repos","events_url":"https://api.github.com/users/vszakats/events{/privacy}","received_events_url":"https://api.github.com/users/vszakats/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3165131271","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3165131271","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3165131271,"node_id":"IC_kwDOAAiu0c68qBIH","user":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T17:30:59Z","updated_at":"2025-08-07T17:30:59Z","body":"Thanks for testing.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3165131271/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"MichalPetryka","id":35800402,"node_id":"MDQ6VXNlcjM1ODAwNDAy","avatar_url":"https://avatars.githubusercontent.com/u/35800402?v=4","gravatar_id":"","url":"https://api.github.com/users/MichalPetryka","html_url":"https://github.com/MichalPetryka","followers_url":"https://api.github.com/users/MichalPetryka/followers","following_url":"https://api.github.com/users/MichalPetryka/following{/other_user}","gists_url":"https://api.github.com/users/MichalPetryka/gists{/gist_id}","starred_url":"https://api.github.com/users/MichalPetryka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichalPetryka/subscriptions","organizations_url":"https://api.github.com/users/MichalPetryka/orgs","repos_url":"https://api.github.com/users/MichalPetryka/repos","events_url":"https://api.github.com/users/MichalPetryka/events{/privacy}","received_events_url":"https://api.github.com/users/MichalPetryka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T19:27:31Z","updated_at":"2025-08-07T19:27:31Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/openssl/openssl/issues/25023","repository_url":"https://api.github.com/repos/openssl/openssl","labels_url":"https://api.github.com/repos/openssl/openssl/issues/25023/labels{/name}","comments_url":"https://api.github.com/repos/openssl/openssl/issues/25023/comments","events_url":"https://api.github.com/repos/openssl/openssl/issues/25023/events","html_url":"https://github.com/openssl/openssl/issues/25023","id":2435228064,"node_id":"I_kwDOAHR-9c6RJqGg","number":25023,"title":"SSLError(58, '[ASN1] nested asn1 error (_ssl.c:4174)') and SSLError(0, 'not enough data: cadata does not contain a certificate (_ssl.c:4159)')","user":{"login":"levicki","id":16415478,"node_id":"MDQ6VXNlcjE2NDE1NDc4","avatar_url":"https://avatars.githubusercontent.com/u/16415478?v=4","gravatar_id":"","url":"https://api.github.com/users/levicki","html_url":"https://github.com/levicki","followers_url":"https://api.github.com/users/levicki/followers","following_url":"https://api.github.com/users/levicki/following{/other_user}","gists_url":"https://api.github.com/users/levicki/gists{/gist_id}","starred_url":"https://api.github.com/users/levicki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/levicki/subscriptions","organizations_url":"https://api.github.com/users/levicki/orgs","repos_url":"https://api.github.com/users/levicki/repos","events_url":"https://api.github.com/users/levicki/events{/privacy}","received_events_url":"https://api.github.com/users/levicki/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":441165144,"node_id":"MDU6TGFiZWw0NDExNjUxNDQ=","url":"https://api.github.com/repos/openssl/openssl/labels/branch:%20master","name":"branch: master","color":"bfdadc","default":false,"description":"Merge to master branch"},{"id":1158071402,"node_id":"MDU6TGFiZWwxMTU4MDcxNDAy","url":"https://api.github.com/repos/openssl/openssl/labels/help%20wanted","name":"help wanted","color":"008672","default":true,"description":""},{"id":1645020505,"node_id":"MDU6TGFiZWwxNjQ1MDIwNTA1","url":"https://api.github.com/repos/openssl/openssl/labels/triaged:%20feature","name":"triaged: feature","color":"84b6eb","default":false,"description":"The issue/pr requests/adds a feature"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":24,"created_at":"2024-07-29T12:00:54Z","updated_at":"2025-08-07T22:19:07Z","closed_at":null,"author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":7634677,"node_id":"MDEwOlJlcG9zaXRvcnk3NjM0Njc3","name":"openssl","full_name":"openssl/openssl","private":false,"owner":{"login":"openssl","id":3279138,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMyNzkxMzg=","avatar_url":"https://avatars.githubusercontent.com/u/3279138?v=4","gravatar_id":"","url":"https://api.github.com/users/openssl","html_url":"https://github.com/openssl","followers_url":"https://api.github.com/users/openssl/followers","following_url":"https://api.github.com/users/openssl/following{/other_user}","gists_url":"https://api.github.com/users/openssl/gists{/gist_id}","starred_url":"https://api.github.com/users/openssl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openssl/subscriptions","organizations_url":"https://api.github.com/users/openssl/orgs","repos_url":"https://api.github.com/users/openssl/repos","events_url":"https://api.github.com/users/openssl/events{/privacy}","received_events_url":"https://api.github.com/users/openssl/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/openssl/openssl","description":"TLS/SSL and crypto library","fork":false,"url":"https://api.github.com/repos/openssl/openssl","forks_url":"https://api.github.com/repos/openssl/openssl/forks","keys_url":"https://api.github.com/repos/openssl/openssl/keys{/key_id}","collaborators_url":"https://api.github.com/repos/openssl/openssl/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/openssl/openssl/teams","hooks_url":"https://api.github.com/repos/openssl/openssl/hooks","issue_events_url":"https://api.github.com/repos/openssl/openssl/issues/events{/number}","events_url":"https://api.github.com/repos/openssl/openssl/events","assignees_url":"https://api.github.com/repos/openssl/openssl/assignees{/user}","branches_url":"https://api.github.com/repos/openssl/openssl/branches{/branch}","tags_url":"https://api.github.com/repos/openssl/openssl/tags","blobs_url":"https://api.github.com/repos/openssl/openssl/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/openssl/openssl/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/openssl/openssl/git/refs{/sha}","trees_url":"https://api.github.com/repos/openssl/openssl/git/trees{/sha}","statuses_url":"https://api.github.com/repos/openssl/openssl/statuses/{sha}","languages_url":"https://api.github.com/repos/openssl/openssl/languages","stargazers_url":"https://api.github.com/repos/openssl/openssl/stargazers","contributors_url":"https://api.github.com/repos/openssl/openssl/contributors","subscribers_url":"https://api.github.com/repos/openssl/openssl/subscribers","subscription_url":"https://api.github.com/repos/openssl/openssl/subscription","commits_url":"https://api.github.com/repos/openssl/openssl/commits{/sha}","git_commits_url":"https://api.github.com/repos/openssl/openssl/git/commits{/sha}","comments_url":"https://api.github.com/repos/openssl/openssl/comments{/number}","issue_comment_url":"https://api.github.com/repos/openssl/openssl/issues/comments{/number}","contents_url":"https://api.github.com/repos/openssl/openssl/contents/{+path}","compare_url":"https://api.github.com/repos/openssl/openssl/compare/{base}...{head}","merges_url":"https://api.github.com/repos/openssl/openssl/merges","archive_url":"https://api.github.com/repos/openssl/openssl/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/openssl/openssl/downloads","issues_url":"https://api.github.com/repos/openssl/openssl/issues{/number}","pulls_url":"https://api.github.com/repos/openssl/openssl/pulls{/number}","milestones_url":"https://api.github.com/repos/openssl/openssl/milestones{/number}","notifications_url":"https://api.github.com/repos/openssl/openssl/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/openssl/openssl/labels{/name}","releases_url":"https://api.github.com/repos/openssl/openssl/releases{/id}","deployments_url":"https://api.github.com/repos/openssl/openssl/deployments","created_at":"2013-01-15T22:34:48Z","updated_at":"2025-11-10T11:08:57Z","pushed_at":"2025-11-10T10:02:16Z","git_url":"git://github.com/openssl/openssl.git","ssh_url":"git@github.com:openssl/openssl.git","clone_url":"https://github.com/openssl/openssl.git","svn_url":"https://github.com/openssl/openssl","homepage":"https://www.openssl.org","size":306812,"stargazers_count":28979,"watchers_count":28979,"language":"C","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":10911,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1742,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["cryptography","decryption","encryption","openssl","ssl","tls"],"visibility":"public","forks":10911,"open_issues":1742,"watchers":28979,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"If a CA encodes certificate serial number integer value `102` (`0x66`) as `02 04 00 00 00 66` instead of `02 01 66`, which violates the DER standard the following error shows up when trying to load such a certificate:\r\n\r\nSSLError(58, '[ASN1] nested asn1 error (_ssl.c:4174)') and SSLError(0, 'not enough data: cadata does not contain a certificate (_ssl.c:4159)')\r\n\r\nThere are some root certificates in circulation with such non-compliant DER encoding which apparently can't be replaced, and they are causing a host of issues in various Python based applications since Python uses OpenSSL.\r\n\r\nI am reporting this as a bug even though I don't consider strict adherence to DER standard to be a bug, but something should be done to allow use of such certificates or there should be an option to relax validation so that this results in a warning instead of error.\r\n\r\nOther implementations (Firefox, Chromium) accept those certificates.\r\n\r\nRelevant Python issue can be found [here](https://github.com/python/cpython/issues/79846).\r\n\r\nCurrent workaround is to:\r\n\r\n - Process certificates from Windows certificate store one by one and\r\n - Skip certificates which raise an exception related to this error\r\n\r\n@mattcaswell @t8m Please advise.","reactions":{"url":"https://api.github.com/repos/openssl/openssl/issues/25023/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/openssl/openssl/issues/25023/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3166006244","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3166006244","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3166006244,"node_id":"IC_kwDOAAiu0c68tWvk","user":{"login":"levicki","id":16415478,"node_id":"MDQ6VXNlcjE2NDE1NDc4","avatar_url":"https://avatars.githubusercontent.com/u/16415478?v=4","gravatar_id":"","url":"https://api.github.com/users/levicki","html_url":"https://github.com/levicki","followers_url":"https://api.github.com/users/levicki/followers","following_url":"https://api.github.com/users/levicki/following{/other_user}","gists_url":"https://api.github.com/users/levicki/gists{/gist_id}","starred_url":"https://api.github.com/users/levicki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/levicki/subscriptions","organizations_url":"https://api.github.com/users/levicki/orgs","repos_url":"https://api.github.com/users/levicki/repos","events_url":"https://api.github.com/users/levicki/events{/privacy}","received_events_url":"https://api.github.com/users/levicki/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-07T22:15:56Z","updated_at":"2025-08-07T22:15:56Z","body":"@MichalPetryka I am not the person you asked in OpenSSL issue which I created, but maybe you guys could try something like this:\n```\n// for each cert in the store during import:\n\nASN1_INTEGER *sn = X509_get_serialNumber(x509);\n\nif (sn != nullptr) {\n\tBIGNUM *bn = ASN1_INTEGER_to_BN(sn, nullptr);\n\tif (bn != nullptr) {\n\t\tBN_free(bn);\n\t\t// import this certificate\n\t} else {\n\t\t// number encoding bad, out of memory\n\t\t// skip this certificate\n\t}\n}\n```\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3166006244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"levicki","id":16415478,"node_id":"MDQ6VXNlcjE2NDE1NDc4","avatar_url":"https://avatars.githubusercontent.com/u/16415478?v=4","gravatar_id":"","url":"https://api.github.com/users/levicki","html_url":"https://github.com/levicki","followers_url":"https://api.github.com/users/levicki/followers","following_url":"https://api.github.com/users/levicki/following{/other_user}","gists_url":"https://api.github.com/users/levicki/gists{/gist_id}","starred_url":"https://api.github.com/users/levicki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/levicki/subscriptions","organizations_url":"https://api.github.com/users/levicki/orgs","repos_url":"https://api.github.com/users/levicki/repos","events_url":"https://api.github.com/users/levicki/events{/privacy}","received_events_url":"https://api.github.com/users/levicki/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":19044442177,"node_id":"MEE_lADOAAiu0c7EW-VQzwAAAARvIyBB","url":"https://api.github.com/repos/curl/curl/issues/events/19044442177","actor":{"login":"MichalPetryka","id":35800402,"node_id":"MDQ6VXNlcjM1ODAwNDAy","avatar_url":"https://avatars.githubusercontent.com/u/35800402?v=4","gravatar_id":"","url":"https://api.github.com/users/MichalPetryka","html_url":"https://github.com/MichalPetryka","followers_url":"https://api.github.com/users/MichalPetryka/followers","following_url":"https://api.github.com/users/MichalPetryka/following{/other_user}","gists_url":"https://api.github.com/users/MichalPetryka/gists{/gist_id}","starred_url":"https://api.github.com/users/MichalPetryka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichalPetryka/subscriptions","organizations_url":"https://api.github.com/users/MichalPetryka/orgs","repos_url":"https://api.github.com/users/MichalPetryka/repos","events_url":"https://api.github.com/users/MichalPetryka/events{/privacy}","received_events_url":"https://api.github.com/users/MichalPetryka/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2025-08-07T22:15:58Z","performed_via_github_app":null},{"id":19044442198,"node_id":"SE_lADOAAiu0c7EW-VQzwAAAARvIyBW","url":"https://api.github.com/repos/curl/curl/issues/events/19044442198","actor":{"login":"MichalPetryka","id":35800402,"node_id":"MDQ6VXNlcjM1ODAwNDAy","avatar_url":"https://avatars.githubusercontent.com/u/35800402?v=4","gravatar_id":"","url":"https://api.github.com/users/MichalPetryka","html_url":"https://github.com/MichalPetryka","followers_url":"https://api.github.com/users/MichalPetryka/followers","following_url":"https://api.github.com/users/MichalPetryka/following{/other_user}","gists_url":"https://api.github.com/users/MichalPetryka/gists{/gist_id}","starred_url":"https://api.github.com/users/MichalPetryka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichalPetryka/subscriptions","organizations_url":"https://api.github.com/users/MichalPetryka/orgs","repos_url":"https://api.github.com/users/MichalPetryka/repos","events_url":"https://api.github.com/users/MichalPetryka/events{/privacy}","received_events_url":"https://api.github.com/users/MichalPetryka/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2025-08-07T22:15:58Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3166817457","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3166817457","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3166817457,"node_id":"IC_kwDOAAiu0c68wcyx","user":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-08T07:14:15Z","updated_at":"2025-08-08T07:14:15Z","body":"That would special code to find this particular certificate, right? Not fond of having such code in libcurl.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3166817457/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/3166852366","html_url":"https://github.com/curl/curl/issues/18190#issuecomment-3166852366","issue_url":"https://api.github.com/repos/curl/curl/issues/18190","id":3166852366,"node_id":"IC_kwDOAAiu0c68wlUO","user":{"login":"vdukhovni","id":1107986,"node_id":"MDQ6VXNlcjExMDc5ODY=","avatar_url":"https://avatars.githubusercontent.com/u/1107986?v=4","gravatar_id":"","url":"https://api.github.com/users/vdukhovni","html_url":"https://github.com/vdukhovni","followers_url":"https://api.github.com/users/vdukhovni/followers","following_url":"https://api.github.com/users/vdukhovni/following{/other_user}","gists_url":"https://api.github.com/users/vdukhovni/gists{/gist_id}","starred_url":"https://api.github.com/users/vdukhovni/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vdukhovni/subscriptions","organizations_url":"https://api.github.com/users/vdukhovni/orgs","repos_url":"https://api.github.com/users/vdukhovni/repos","events_url":"https://api.github.com/users/vdukhovni/events{/privacy}","received_events_url":"https://api.github.com/users/vdukhovni/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-08T07:29:29Z","updated_at":"2025-08-08T07:29:29Z","body":"> care to test how an curl+openssl behaves with the following applied?\n> --- a/lib/vtls/openssl.c\n> +++ b/lib/vtls/openssl.c\n> @@ -3330,6 +3330,11 @@ static CURLcode import_windows_cert_store(struct Curl_easy *data,\n>        if(!x509)\n>          continue;\n> \n> ... Workaround elided ...\n\nWhy is any of that necessary, the DER encoding in question should have returned NULL from `d2i_X509()` and the import loop should have continued to the next CA cert...\n\nhttps://github.com/curl/curl/blob/fd219aa44d55a8ceec1b9357ac0a93028852e710/lib/vtls/openssl.c#L3329-L3331\n\nI converted the [original DER encoding](http://crl.mup.gov.rs/MUPCARoot.crt) to a C array with `xxd -i > mup.h` and compiled the below:\n```c\n#include <stdio.h>\n#include <stdlib.h>\n#include <openssl/x509.h>\n#include <openssl/err.h>\n\nstatic const unsigned char cert[] = {\n#include \"mup.h\"\n}\n\nint main(int argc, char *argv[])\n{\n    X509 *x = NULL;\n    unsigned const char *der = cert;\n    \n    if (d2i_X509(&x, &der, sizeof(cert)) == NULL) {\n        ERR_print_errors_fp(stderr);\n        return 1;\n    }\n    printf(\"Parsed %zd bytes\\n\", (ssize_t)(der - cert));\n    X509_free(x);\n    return 0;\n}\n```\nWhen compiled and run, this outputs:\n```\n$ curl -sLo - 'http://crl.mup.gov.rs/MUPCARoot.crt' | xxd -i > mup.h\n$ cc -g -ggdb3 -O0 mup.c -o mup -lcrypto\n$ ./mup \n4067D901807F0000:error:068000DD:asn1 encoding routines:c2i_ibuf:illegal padding:crypto/asn1/a_int.c:193:\n4067D901807F0000:error:0688010A:asn1 encoding routines:asn1_template_noexp_d2i:nested asn1 error:crypto/asn1/tasn_dec.c:685:Field=serialNumber, Type=X509_CINF\n4067D901807F0000:error:0688010A:asn1 encoding routines:asn1_template_noexp_d2i:nested asn1 error:crypto/asn1/tasn_dec.c:685:Field=cert_info, Type=X509\n\n```\nBy way of contrast the DER form of the first certificate in my Fedora system's root CA bundle is parsed as expected:\n```\n$ openssl x509 -in /etc/pki/tls/cert.pem -outform DER | xxd -i > mup.h\n$ cc -g -ggdb3 -O0 mup.c -o mup -lcrypto\n$ ./mup \nParsed 2007 bytes\n```\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/3166852366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vdukhovni","id":1107986,"node_id":"MDQ6VXNlcjExMDc5ODY=","avatar_url":"https://avatars.githubusercontent.com/u/1107986?v=4","gravatar_id":"","url":"https://api.github.com/users/vdukhovni","html_url":"https://github.com/vdukhovni","followers_url":"https://api.github.com/users/vdukhovni/followers","following_url":"https://api.github.com/users/vdukhovni/following{/other_user}","gists_url":"https://api.github.com/users/vdukhovni/gists{/gist_id}","starred_url":"https://api.github.com/users/vdukhovni/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vdukhovni/subscriptions","organizations_url":"https://api.github.com/users/vdukhovni/orgs","repos_url":"https://api.github.com/users/vdukhovni/repos","events_url":"https://api.github.com/users/vdukhovni/events{/privacy}","received_events_url":"https://api.github.com/users/vdukhovni/received_events","type":"User","user_view_type":"public","site_admin":false}}]