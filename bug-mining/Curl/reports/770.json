{"url":"https://api.github.com/repos/curl/curl/issues/17977","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/17977/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/17977/comments","events_url":"https://api.github.com/repos/curl/curl/issues/17977/events","html_url":"https://github.com/curl/curl/issues/17977","id":3246194816,"node_id":"I_kwDOAAiu0c7BfQCA","number":17977,"title":"Should colons in paths skip url-encoding?","user":{"login":"jeroen","id":216319,"node_id":"MDQ6VXNlcjIxNjMxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/216319?v=4","gravatar_id":"","url":"https://api.github.com/users/jeroen","html_url":"https://github.com/jeroen","followers_url":"https://api.github.com/users/jeroen/followers","following_url":"https://api.github.com/users/jeroen/following{/other_user}","gists_url":"https://api.github.com/users/jeroen/gists{/gist_id}","starred_url":"https://api.github.com/users/jeroen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeroen/subscriptions","organizations_url":"https://api.github.com/users/jeroen/orgs","repos_url":"https://api.github.com/users/jeroen/repos","events_url":"https://api.github.com/users/jeroen/events{/privacy}","received_events_url":"https://api.github.com/users/jeroen/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":228248612,"node_id":"MDU6TGFiZWwyMjgyNDg2MTI=","url":"https://api.github.com/repos/curl/curl/labels/enhancement","name":"enhancement","color":"FCFD96","default":true,"description":null},{"id":534486041,"node_id":"MDU6TGFiZWw1MzQ0ODYwNDE=","url":"https://api.github.com/repos/curl/curl/labels/URL","name":"URL","color":"bfd4f2","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2025-07-20T09:30:47Z","updated_at":"2025-08-04T16:32:51Z","closed_at":"2025-08-01T21:23:09Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"After we switched the R bindings to libcurl's `curl_url_set()` for building URLs, a lot of users reported the same problem: many public http servers expect colons `:` in the __path__ to NOT be url-encoded. This affects almost all of these AI chat APIs, which use URI schemes with colons.\n\nThe core issue is similar to the `curl_url_set()` treatment of slashes:\n\nhttps://github.com/curl/curl/blob/7c23e88d17e0939b4e01c8d05f430e167e148f4b/docs/libcurl/curl_url_set.md?plain=1#L187-L188\n\nPerhaps colons deserve similar treatment, because they are commonly used as URI resource separators. For example:\n\n```\nhttps://firestore.googleapis.com/v1beta1/projects/{myprojectid}/databases/(default)/documents/Users:runQuery\n```\n\nHere we want `{myprojectid}` and `(default)` get URL encoded, but `Users:runQuery` should not. Right now there is no good way to do this, because if I call `curl_url_set()` with `CURLU_URLENCODE` then the colon gets encoded and the server does not understand the request. \n\nHowever there is also no workaround: if we do not `CURLU_URLENCODE` we need to escape the input ourselves beforehand, but we run into this documented problem that also the slashes get escaped:\n\nhttps://github.com/curl/curl/blob/7c23e88d17e0939b4e01c8d05f430e167e148f4b/docs/libcurl/curl_easy_escape.md?plain=1#L54-L57\n\nInterestingly, the above already mentions colons as a special case, but perhaps this is about the colon in the scheme prefix, not the path? \n\nUpon further search there are quite some services that use colons in the URL scheme, for example wikipedia, however in this case the server is smart enough to understand the url-encoded variant as well, and add redirect:\n\n```\nhttps://en.wikipedia.org/wiki/Wikipedia:Contents/Human_activities\n```\n\nI am not convinced there is any practical need for url-encoding the `:` in paths. What purpose does it serve? All servers I found seem to accept or even require an unencoded `:` in the path. Is it just to distinguish from the colon in the scheme prefix of the url? I doubt any server will mistake the entire part of the URL up till the latest `:` as the scheme?","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/17977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/17977/timeline","performed_via_github_app":null,"state_reason":"completed"}