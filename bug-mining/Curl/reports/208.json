{"url":"https://api.github.com/repos/curl/curl/issues/10793","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/10793/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/10793/comments","events_url":"https://api.github.com/repos/curl/curl/issues/10793/events","html_url":"https://github.com/curl/curl/issues/10793","id":1630770254,"node_id":"I_kwDOAAiu0c5hM5RO","number":10793,"title":"curl build error when ngtcp2 is installed but nghttp3 is not","user":{"login":"chiouss","id":64595809,"node_id":"MDQ6VXNlcjY0NTk1ODA5","avatar_url":"https://avatars.githubusercontent.com/u/64595809?v=4","gravatar_id":"","url":"https://api.github.com/users/chiouss","html_url":"https://github.com/chiouss","followers_url":"https://api.github.com/users/chiouss/followers","following_url":"https://api.github.com/users/chiouss/following{/other_user}","gists_url":"https://api.github.com/users/chiouss/gists{/gist_id}","starred_url":"https://api.github.com/users/chiouss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chiouss/subscriptions","organizations_url":"https://api.github.com/users/chiouss/orgs","repos_url":"https://api.github.com/users/chiouss/repos","events_url":"https://api.github.com/users/chiouss/events{/privacy}","received_events_url":"https://api.github.com/users/chiouss/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118182,"node_id":"MDU6TGFiZWwxODQxMTgxODI=","url":"https://api.github.com/repos/curl/curl/labels/build","name":"build","color":"bfdadc","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":3,"created_at":"2023-03-19T03:55:40Z","updated_at":"2023-12-05T21:07:31Z","closed_at":"2023-03-23T14:40:21Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hi,\r\n\r\nI installed ngtcp2 on Openwrt in order to build some small program with QUIC I wrote. But then I found curl will build failed after it finds ngtcp2 in system is usable but doesn't notice there's no nghttp3 in system.\r\n\r\nI know I can add `--without-ngtcp2` in configure, but I add `--without-nghttp3` at the first time and found nothing changed. Then I realized that there's no checking of `USE_NGHTTP3` in code.\r\n\r\nI think in configure.ac we need to check nghttp3 first then check ngtcp2 maybe?\r\n\r\n```\r\nIn file included from quic.h:29,\r\n                 from urldata.h:142,\r\n                 from altsvc.c:30:\r\nvquic/ngtcp2.h:30:10: fatal error: nghttp3/nghttp3.h: No such file or directory\r\n #include <nghttp3/nghttp3.h>\r\n          ^~~~~~~~~~~~~~~~~~~\r\ncompilation terminated.\r\nMakefile:1670: recipe for target 'libcurl_la-altsvc.lo' failed\r\n```\r\n\r\n<!-- Only file bugs here! Ask questions on the mailing lists https://curl.se/mail/\r\n\r\n     SECURITY RELATED? Post it here: https://hackerone.com/curl\r\n\r\n     There are collections of known issues to be aware of:\r\n     https://curl.se/docs/knownbugs.html\r\n     https://curl.se/docs/todo.html       -->\r\n\r\n### I did this\r\n`./configure --target=aarch64-openwrt-linux --host=aarch64-openwrt-linux --build=x86_64-pc-linux-gnu --program-prefix=\"\" --program-suffix=\"\" --prefix=/usr --exec-prefix=/usr --bindir=/usr/bin --sbindir=/usr/sbin --libexecdir=/usr/lib --sysconfdir=/etc --datadir=/usr/share --localstatedir=/var --mandir=/usr/man --infodir=/usr/info --disable-nls  --disable-debug --disable-ares --enable-shared --enable-static --disable-manual --without-nss --without-librtmp --without-libidn --without-ca-path --without-libpsl --without-zstd --with-ca-bundle=/etc/ssl/certs/ca-certificates.crt --enable-ipv6 --without-wolfssl --without-gnutls --with-ssl=\"/home/chiouss/galaxy-ap/release-655/mt7981/openwrt/staging_dir/target-aarch64-openwrt-linux_musl/usr\" --without-mbedtls --without-libidn2 --without-libssh2 --without-zlib --without-zstd --without-nghttp2 --disable-dict --enable-file --enable-ftp --disable-gopher --enable-http --disable-imap --disable-ldap --disable-ldaps --disable-pop3 --disable-rtsp --disable-smb --disable-smtp --disable-telnet --disable-tftp --enable-cookies --disable-crypto-auth --disable-libcurl-option --enable-proxy --enable-threaded-resolver --disable-tls-srp --disable-unix-sockets --enable-verbose`\r\nthen `make`\r\n\r\n### I expected the following\r\na success build of curl\r\n\r\n### curl/libcurl version\r\n7.83.1\r\n\r\n### operating system\r\nUbuntu 18.04/Openwrt 21.02\r\n\r\n<!-- On Unix please post the output of \"uname -a\" -->\r\n","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/10793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/10793/timeline","performed_via_github_app":null,"state_reason":"completed"}