{"url":"https://api.github.com/repos/curl/curl/issues/10537","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/10537/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/10537/comments","events_url":"https://api.github.com/repos/curl/curl/issues/10537/events","html_url":"https://github.com/curl/curl/issues/10537","id":1588186576,"node_id":"I_kwDOAAiu0c5eqc3Q","number":10537,"title":"DoH cannot be used with SOCKS5 proxy","user":{"login":"roughtex","id":8452778,"node_id":"MDQ6VXNlcjg0NTI3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/8452778?v=4","gravatar_id":"","url":"https://api.github.com/users/roughtex","html_url":"https://github.com/roughtex","followers_url":"https://api.github.com/users/roughtex/followers","following_url":"https://api.github.com/users/roughtex/following{/other_user}","gists_url":"https://api.github.com/users/roughtex/gists{/gist_id}","starred_url":"https://api.github.com/users/roughtex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roughtex/subscriptions","organizations_url":"https://api.github.com/users/roughtex/orgs","repos_url":"https://api.github.com/users/roughtex/repos","events_url":"https://api.github.com/users/roughtex/events{/privacy}","received_events_url":"https://api.github.com/users/roughtex/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":370011580,"node_id":"MDU6TGFiZWwzNzAwMTE1ODA=","url":"https://api.github.com/repos/curl/curl/labels/connecting%20&%20proxies","name":"connecting & proxies","color":"c2e0c6","default":false,"description":null},{"id":975635480,"node_id":"MDU6TGFiZWw5NzU2MzU0ODA=","url":"https://api.github.com/repos/curl/curl/labels/name%20lookup","name":"name lookup","color":"0052cc","default":false,"description":"DNS and related tech"}],"state":"closed","locked":false,"assignee":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2023-02-16T18:40:32Z","updated_at":"2024-02-17T16:06:03Z","closed_at":"2023-02-17T08:19:24Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"curl manpage states that `--socks5` option resolves host names locally. I thought that *\"locally\"* meant *\"not by the proxy server itself\"*. When it comes to `--doh-url` option, it's assumed that the name resolving is done by the DoH server that may be local as well.\r\n\r\nThe result of combining these options together is weird: curl attempts to use the default system resolver and doesn't connect to the DoH server. If the default system resolver is not working or returns spurious IP addresses, then there is no way to reach the host.\r\n\r\n### I did this\r\n\r\n`curl.exe --doh-url https://cloudflare-dns.com/dns-query --socks5 127.0.0.1:1080 https://example.com/`\r\n\r\n### I expected the following\r\n\r\ncurl utilizes Cloudflare's DNS server to resolve `example.com` and connects to the host using the local SOCKS5 proxy.\r\n\r\n### curl/libcurl version\r\n\r\ncurl 7.88.0\r\n\r\n### operating system\r\n\r\nWindows\r\n","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/10537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/10537/timeline","performed_via_github_app":null,"state_reason":"completed"}