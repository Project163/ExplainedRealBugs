{"url":"https://api.github.com/repos/curl/curl/issues/9560","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/9560/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/9560/comments","events_url":"https://api.github.com/repos/curl/curl/issues/9560/events","html_url":"https://github.com/curl/curl/issues/9560","id":1380597095,"node_id":"I_kwDOAAiu0c5SSj1n","number":9560,"title":"curl 7.85 can not be built with musl-libc","user":{"login":"georgthegreat","id":1121500,"node_id":"MDQ6VXNlcjExMjE1MDA=","avatar_url":"https://avatars.githubusercontent.com/u/1121500?v=4","gravatar_id":"","url":"https://api.github.com/users/georgthegreat","html_url":"https://github.com/georgthegreat","followers_url":"https://api.github.com/users/georgthegreat/followers","following_url":"https://api.github.com/users/georgthegreat/following{/other_user}","gists_url":"https://api.github.com/users/georgthegreat/gists{/gist_id}","starred_url":"https://api.github.com/users/georgthegreat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/georgthegreat/subscriptions","organizations_url":"https://api.github.com/users/georgthegreat/orgs","repos_url":"https://api.github.com/users/georgthegreat/repos","events_url":"https://api.github.com/users/georgthegreat/events{/privacy}","received_events_url":"https://api.github.com/users/georgthegreat/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118182,"node_id":"MDU6TGFiZWwxODQxMTgxODI=","url":"https://api.github.com/repos/curl/curl/labels/build","name":"build","color":"bfdadc","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":5,"created_at":"2022-09-21T09:11:49Z","updated_at":"2022-09-21T21:15:45Z","closed_at":"2022-09-21T21:15:45Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Compilation is broken with the following output:\r\n\r\n```\r\nIn file included from contrib/libs/curl/lib/easy.c:89:\r\nIn file included from contrib/libs/curl/lib/easy_lock.h:53:\r\ncontrib/libs/musl/include/sched.h:84:7: error: redefinition of 'Curl_ccalloc' as different kind of symbol\r\nvoid *calloc(size_t, size_t);\r\n      ^\r\ncontrib/libs/curl/lib/curl_memory.h:128:29: note: expanded from macro 'calloc'\r\n#define calloc(nbelem,size) Curl_ccalloc(nbelem, size)\r\n                            ^\r\ncontrib/libs/curl/lib/curl_memory.h:107:29: note: previous definition is here\r\nextern curl_calloc_callback Curl_ccalloc;\r\n                            ^\r\nIn file included from contrib/libs/curl/lib/easy.c:89:\r\nIn file included from contrib/libs/curl/lib/easy_lock.h:53:\r\n/home/thegeorg/arcadia/contrib/libs/musl/include/sched.h:85:6: error: redefinition of 'Curl_cfree' as different kind of symbol\r\nvoid free(void *);\r\n     ^\r\ncontrib/libs/curl/lib/curl_memory.h:132:19: note: expanded from macro 'free'\r\n#define free(ptr) Curl_cfree(ptr)\r\n                  ^\r\ncontrib/libs/curl/lib/curl_memory.h:104:27: note: previous definition is here\r\nextern curl_free_callback Curl_cfree;\r\n```\r\n\r\nUpon brief research it looks like curl by default (i. e. when no CURLDEBUG is defined) goes through double definition chain (i. e. defining `#define free(ptr) Curl_cfree(ptr)` and invoke `free()` from `Curl_cfree`.\r\n\r\nIn musl it is impossible to `#undef free`, as free is not a macro in musl.\r\n\r\nBy studying the diff I was unable to find a changeset causing the problem.\r\nCould you, please, take a look?","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/9560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/9560/timeline","performed_via_github_app":null,"state_reason":"completed"}