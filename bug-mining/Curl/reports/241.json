{"url":"https://api.github.com/repos/curl/curl/issues/11162","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/11162/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/11162/comments","events_url":"https://api.github.com/repos/curl/curl/issues/11162/events","html_url":"https://github.com/curl/curl/issues/11162","id":1718092270,"node_id":"I_kwDOAAiu0c5maAHu","number":11162,"title":"8.1.0 download slower than 8.0.1","user":{"login":"pandada8","id":3305174,"node_id":"MDQ6VXNlcjMzMDUxNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3305174?v=4","gravatar_id":"","url":"https://api.github.com/users/pandada8","html_url":"https://github.com/pandada8","followers_url":"https://api.github.com/users/pandada8/followers","following_url":"https://api.github.com/users/pandada8/following{/other_user}","gists_url":"https://api.github.com/users/pandada8/gists{/gist_id}","starred_url":"https://api.github.com/users/pandada8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pandada8/subscriptions","organizations_url":"https://api.github.com/users/pandada8/orgs","repos_url":"https://api.github.com/users/pandada8/repos","events_url":"https://api.github.com/users/pandada8/events{/privacy}","received_events_url":"https://api.github.com/users/pandada8/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":194601710,"node_id":"MDU6TGFiZWwxOTQ2MDE3MTA=","url":"https://api.github.com/repos/curl/curl/labels/HTTP/2","name":"HTTP/2","color":"009800","default":false,"description":null},{"id":865591047,"node_id":"MDU6TGFiZWw4NjU1OTEwNDc=","url":"https://api.github.com/repos/curl/curl/labels/performance","name":"performance","color":"d306dd","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":6,"created_at":"2023-05-20T07:59:34Z","updated_at":"2023-05-20T21:05:38Z","closed_at":"2023-05-20T21:05:38Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!-- Only file bugs here! Ask questions on the mailing lists https://curl.se/mail/\r\n\r\n     SECURITY RELATED? Post it here: https://hackerone.com/curl\r\n\r\n     There are collections of known issues to be aware of:\r\n     https://curl.se/docs/knownbugs.html\r\n     https://curl.se/docs/todo.html       -->\r\n\r\n### I did this\r\n\r\nWhen download from same url with same network, curl 8.1.0 downloads half as fast as curl 8.0.1\r\n\r\n```\r\npan@panda-router ~ ❯❯❯ curl 'https://mirrors.tuna.tsinghua.edu.cn/archlinux/iso/latest/archlinux-2023.05.03-x86_64.iso' -o /dev/null\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100  813M  100  813M    0     0  94.2M      0  0:00:08  0:00:08 --:--:-- 95.8M\r\npan@panda-router ~ ❯❯❯ curl 'https://mirrors.tuna.tsinghua.edu.cn/archlinux/iso/latest/archlinux-2023.05.03-x86_64.iso' -o /dev/null\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100  813M  100  813M    0     0  45.4M      0  0:00:17  0:00:17 --:--:-- 47.0M\r\n```\r\n\r\n(try a nearby mirror to test if you want to replicate, the provided link speed may be not optimal in your location)\r\n\r\nI also tried different endpoint in a different location (vultr vps in la). It seems the slowdown ratio may be different, but 8.1.0 IS slower than 8.0.1\r\n\r\n### I expected the following\r\n\r\ndownload speed shouldn't make any difference\r\n\r\n### curl/libcurl version\r\n\r\n```\r\n# curl -V\r\ncurl 8.1.0 (x86_64-pc-linux-gnu) libcurl/8.1.0 OpenSSL/3.0.8 zlib/1.2.13 brotli/1.0.9 zstd/1.5.5 libidn2/2.3.4 libpsl/0.21.2 (+libidn2/2.3.4) libssh2/1.10.0 nghttp2/1.53.0\r\nRelease-Date: 2023-05-17\r\nProtocols: dict file ftp ftps gopher gophers http https imap imaps mqtt pop3 pop3s rtsp scp sftp smb smbs smtp smtps telnet tftp\r\nFeatures: alt-svc AsynchDNS brotli GSS-API HSTS HTTP2 HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTLM NTLM_WB PSL SPNEGO SSL threadsafe TLS-SRP UnixSockets zstd\r\n```\r\nI did some bisect, it seems the slowdown is introduced by 744dcf22fac6cf12a9112df106b61864982afef9\r\nIndeed, the provided link is http2 enabled\r\n### operating system\r\n\r\n`Linux panda-router 6.2.11-arch1-1 #1 SMP PREEMPT_DYNAMIC Thu, 13 Apr 2023 16:59:24 +0000 x86_64 GNU/Linux`\r\n","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/11162/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/11162/timeline","performed_via_github_app":null,"state_reason":"completed"}