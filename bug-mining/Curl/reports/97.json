{"url":"https://api.github.com/repos/curl/curl/issues/9842","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/9842/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/9842/comments","events_url":"https://api.github.com/repos/curl/curl/issues/9842/events","html_url":"https://github.com/curl/curl/issues/9842","id":1432414374,"node_id":"I_kwDOAAiu0c5VYOim","number":9842,"title":"noproxy tail matching still has an issue","user":{"login":"sthen","id":1006726,"node_id":"MDQ6VXNlcjEwMDY3MjY=","avatar_url":"https://avatars.githubusercontent.com/u/1006726?v=4","gravatar_id":"","url":"https://api.github.com/users/sthen","html_url":"https://github.com/sthen","followers_url":"https://api.github.com/users/sthen/followers","following_url":"https://api.github.com/users/sthen/following{/other_user}","gists_url":"https://api.github.com/users/sthen/gists{/gist_id}","starred_url":"https://api.github.com/users/sthen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sthen/subscriptions","organizations_url":"https://api.github.com/users/sthen/orgs","repos_url":"https://api.github.com/users/sthen/repos","events_url":"https://api.github.com/users/sthen/events{/privacy}","received_events_url":"https://api.github.com/users/sthen/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":370011580,"node_id":"MDU6TGFiZWwzNzAwMTE1ODA=","url":"https://api.github.com/repos/curl/curl/labels/connecting%20&%20proxies","name":"connecting & proxies","color":"c2e0c6","default":false,"description":null},{"id":698723912,"node_id":"MDU6TGFiZWw2OTg3MjM5MTI=","url":"https://api.github.com/repos/curl/curl/labels/not-a-curl-bug","name":"not-a-curl-bug","color":"d4c5f9","default":false,"description":"This is not a bug in curl"}],"state":"closed","locked":false,"assignee":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":8,"created_at":"2022-11-02T03:18:25Z","updated_at":"2022-11-07T07:01:22Z","closed_at":"2022-11-07T07:01:22Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Contrary to https://github.com/curl/curl/blob/master/tests/unit/unit1614.c#L88, traditional behaviour for no_proxy is for example.com to also match host.example.com. \r\n\r\n### I did this\r\n\r\n```\r\n$ curl -V\r\ncurl 7.86.0 (x86_64-unknown-openbsd7.2) libcurl/7.86.0 LibreSSL/3.6.0 zlib/1.2.13 nghttp2/1.50.0\r\nRelease-Date: 2022-10-26\r\nProtocols: dict file ftp ftps gopher gophers http https imap imaps mqtt pop3 pop3s rtsp smb smbs smtp smtps telnet tftp \r\nFeatures: alt-svc AsynchDNS HSTS HTTP2 HTTPS-proxy IPv6 Largefile libz NTLM NTLM_WB SSL threadsafe UnixSockets\r\n\r\n$ no_proxy=google.com https_proxy=http://127.0.0.1:9999/ curl -sI https://www.google.com/ | head -5\r\ncurl: (7) Failed to connect to 127.0.0.1 port 9999 after 0 ms: Couldn't connect to server\r\n```\r\n\r\n### I expected the following\r\n\r\n```\r\n$ curl -V\r\ncurl 7.85.0 (x86_64-unknown-openbsd7.2) libcurl/7.85.0 LibreSSL/3.6.0 zlib/1.2.12 nghttp2/1.49.0\r\nRelease-Date: 2022-08-31\r\nProtocols: dict file ftp ftps gopher gophers http https imap imaps mqtt pop3 pop3s rtsp smb smbs smtp smtps telnet tftp \r\nFeatures: alt-svc AsynchDNS HSTS HTTP2 HTTPS-proxy IPv6 Largefile libz NTLM NTLM_WB SSL threadsafe UnixSockets\r\n\r\n$ no_proxy=google.com https_proxy=http://127.0.0.1:9999/ curl -sI https://www.google.com/ | head -5\r\nHTTP/2 200 \r\ncontent-type: text/html; charset=ISO-8859-1\r\np3p: CP=\"This is not a P3P policy! See g.co/p3phelp for more info.\"\r\ndate: Wed, 02 Nov 2022 03:13:12 GMT\r\nserver: gws\r\n```\r\n\r\nAs also seen in at least lynx, w3m, OpenBSD ftp(1).\r\n\r\n### curl/libcurl version\r\n\r\n[see above]\r\n\r\n### operating system\r\n\r\n`OpenBSD $somehostname 7.2 GENERIC.MP#819 amd64`","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/9842/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/9842/timeline","performed_via_github_app":null,"state_reason":"completed"}