{"url":"https://api.github.com/repos/curl/curl/issues/10433","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/10433/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/10433/comments","events_url":"https://api.github.com/repos/curl/curl/issues/10433/events","html_url":"https://github.com/curl/curl/issues/10433","id":1574324837,"node_id":"I_kwDOAAiu0c5d1kpl","number":10433,"title":"HTTP/2 request content upload stalls when response headers are received","user":{"login":"LPardue","id":6571445,"node_id":"MDQ6VXNlcjY1NzE0NDU=","avatar_url":"https://avatars.githubusercontent.com/u/6571445?v=4","gravatar_id":"","url":"https://api.github.com/users/LPardue","html_url":"https://github.com/LPardue","followers_url":"https://api.github.com/users/LPardue/followers","following_url":"https://api.github.com/users/LPardue/following{/other_user}","gists_url":"https://api.github.com/users/LPardue/gists{/gist_id}","starred_url":"https://api.github.com/users/LPardue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LPardue/subscriptions","organizations_url":"https://api.github.com/users/LPardue/orgs","repos_url":"https://api.github.com/users/LPardue/repos","events_url":"https://api.github.com/users/LPardue/events{/privacy}","received_events_url":"https://api.github.com/users/LPardue/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":194601710,"node_id":"MDU6TGFiZWwxOTQ2MDE3MTA=","url":"https://api.github.com/repos/curl/curl/labels/HTTP/2","name":"HTTP/2","color":"009800","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":3,"created_at":"2023-02-07T13:21:31Z","updated_at":"2023-02-09T08:13:51Z","closed_at":"2023-02-09T08:13:51Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\r\n\r\nScenario: a curl client POSTing a large file (say over 100 KB) to an HTTP/2 server that is configured to respond immediately before  a) waiting for all of the indicated content-length to be received or b) waiting for the request stream FIN. Note that this server also leaves the response side open until it detects the client closes its side.\r\n\r\nI'm aware of reports that in such a scenario, once curl receives the response, the upload no longer progresses. For servers that have some kind of body read timeout (e.g. http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_send_timeout) this means that the stream or connection is eventually timed and reset or closed with an error\r\n\r\n### I expected the following\r\n\r\nWhen a response is received before curl completes a request upload, and the server has not closed its side, curl should continue the upload.\r\n\r\n### curl/libcurl version\r\n\r\nOne confirmed report with an old verion\r\n\r\n```\r\ncurl 7.74.0 (x86_64-pc-linux-gnu) libcurl/7.74.0 OpenSSL/1.1.1n zlib/1.2.11 brotli/1.0.9 libidn2/2.3.0 libpsl/0.21.0 (+libidn2/2.3.0) libssh2/1.9.0 nghttp2/1.43.0 librtmp/2.3\r\nRelease-Date: 2020-12-09\r\n```\r\n\r\nUncomfirmed reports with later versions exhibit the same behaviour.\r\n\r\n### operating system\r\n\r\n```\r\nDebian 5.10.158-2\r\n```\r\n","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/10433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/10433/timeline","performed_via_github_app":null,"state_reason":"completed"}