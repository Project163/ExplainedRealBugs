{"url":"https://api.github.com/repos/curl/curl/issues/13035","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/13035/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/13035/comments","events_url":"https://api.github.com/repos/curl/curl/issues/13035/events","html_url":"https://github.com/curl/curl/issues/13035","id":2165583020,"node_id":"I_kwDOAAiu0c6BFCys","number":13035,"title":"curl using cmake on arm32 systems build error -Werror=cast-align","user":{"login":"heitbaum","id":6086324,"node_id":"MDQ6VXNlcjYwODYzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/6086324?v=4","gravatar_id":"","url":"https://api.github.com/users/heitbaum","html_url":"https://github.com/heitbaum","followers_url":"https://api.github.com/users/heitbaum/followers","following_url":"https://api.github.com/users/heitbaum/following{/other_user}","gists_url":"https://api.github.com/users/heitbaum/gists{/gist_id}","starred_url":"https://api.github.com/users/heitbaum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/heitbaum/subscriptions","organizations_url":"https://api.github.com/users/heitbaum/orgs","repos_url":"https://api.github.com/users/heitbaum/repos","events_url":"https://api.github.com/users/heitbaum/events{/privacy}","received_events_url":"https://api.github.com/users/heitbaum/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118182,"node_id":"MDU6TGFiZWwxODQxMTgxODI=","url":"https://api.github.com/repos/curl/curl/labels/build","name":"build","color":"bfdadc","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":21,"created_at":"2024-03-03T21:44:46Z","updated_at":"2024-03-06T13:38:42Z","closed_at":"2024-03-06T13:38:42Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\nbuild curl using cmake on arm32 systems errors due to `http_chunks.c:399:32: error: cast increases required alignment of target type [-Werror=cast-align]`. Build on aarch64 and x86_64 build correctly\r\n\r\n```\r\nBUILD      curl (target)\r\n    TOOLCHAIN      cmake (auto-detect)\r\nExecuting (target): cmake -GNinja -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DCMAKE_TOOLCHAIN_FILE=/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/toolchain/etc/cmake-armv7ve-libreelec-linux-gnueabihf.conf -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_BUILD_TYPE=MinSizeRel -DENABLE_DEBUG=OFF -DCURL_LTO=ON -DCURL_WERROR=ON -DENABLE_CURLDEBUG=OFF -DENABLE_ARES=OFF -DCURL_DISABLE_HTTP=OFF -DCURL_DISABLE_FTP=OFF -DCURL_DISABLE_FILE=OFF -DCURL_DISABLE_LDAP=ON -DCURL_DISABLE_LDAPS=ON -DCURL_DISABLE_RTSP=OFF -DCURL_DISABLE_PROXY=OFF -DCURL_DISABLE_DICT=ON -DCURL_DISABLE_TELNET=ON -DCURL_DISABLE_TFTP=ON -DCURL_DISABLE_POP3=ON -DCURL_DISABLE_IMAP=ON -DCURL_DISABLE_SMB=ON -DCURL_DISABLE_SMTP=ON -DCURL_DISABLE_GOPHER=ON -DCURL_DISABLE_MQTT=ON -DENABLE_MANUAL=OFF -DENABLE_IPV6=ON -DENABLE_THREADED_RESOLVER=ON -DCURL_DISABLE_VERBOSE_STRINGS=OFF -DCURL_WINDOWS_SSPI=OFF -DCURL_DISABLE_COOKIES=OFF -DCURL_HIDDEN_SYMBOLS=ON -DCURL_USE_GSSAPI=OFF -DUSE_ZLIB=ON -DCURL_BROTLI=OFF -DCURL_ZSTD=OFF -DRANDOM_FILE=/dev/urandom -DCURL_USE_GNUTLS=OFF -DCURL_ENABLE_SSL=ON -DCURL_USE_MBEDTLS=OFF -DCURL_CA_BUNDLE=/run/libreelec/cacert.pem -DCURL_CA_PATH=none -DCURL_USE_LIBPSL=OFF -DCURL_USE_LIBSSH2=OFF -DUSE_LIBRTMP=ON -DUSE_LIBIDN2=ON -DUSE_NGHTTP2=ON /var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0\r\n-- Using CMake version 3.28.3\r\n-- curl version=[8.6.0]\r\n-- Picky compiler options: -pedantic-errors -W -Wall -pedantic -Wbad-function-cast -Wconversion -Winline -Wmissing-declarations -Wmissing-prototypes -Wnested-externs -Wno-long-long -Wno-multichar -Wpointer-arith -Wshadow -Wsign-compare -Wundef -Wunused -Wwrite-strings -Waddress -Wattributes -Wcast-align -Wdeclaration-after-statement -Wdiv-by-zero -Wempty-body -Wendif-labels -Wfloat-equal -Wformat-security -Wignored-qualifiers -Wmissing-field-initializers -Wmissing-noreturn -Wno-format-nonliteral -Wno-system-headers -Wold-style-definition -Wredundant-decls -Wsign-conversion -Wno-error=sign-conversion -Wstrict-prototypes -Wtype-limits -Wunreachable-code -Wunused-parameter -Wvla -Wclobbered -Wmissing-parameter-type -Wold-style-declaration -Wstrict-aliasing=3 -Wtrampolines -Wformat=2 -Warray-bounds=2 -ftree-vrp -Wduplicated-cond -Wnull-dereference -fdelete-null-pointer-checks -Wshift-negative-value -Wshift-overflow=2 -Walloc-zero -Wduplicated-branches -Wformat-overflow=2 -Wformat-truncation=2 -Wimplicit-fallthrough -Wrestrict -Warith-conversion -Wdouble-promotion -Wenum-conversion -Wpragmas -Wunused-const-variable\r\nCMake Warning at CMake/Macros.cmake:96 (message):\r\n  Found no *nroff program\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt:315 (curl_nroff_check)\r\n\r\n\r\nCMake Warning at CMakeLists.txt:321 (message):\r\n  Perl not found, or nroff not useful.  Will not build manuals.\r\n\r\n\r\n-- LTO supported and enabled\r\n-- Enabled features: SSL IPv6 UnixSockets libz AsynchDNS IDN Largefile alt-svc HSTS NTLM TLS-SRP HTTP2 HTTPS-proxy threadsafe\r\n-- Enabled protocols: FILE FTP FTPS HTTP HTTPS IPFS IPNS RTMP RTSP\r\n-- Enabled SSL backends: OpenSSL\r\n-- Configuring done (0.1s)\r\n-- Generating done (0.2s)\r\n-- Build files have been written to: /var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/.armv7ve-libreelec-linux-gnueabihf\r\nExecuting (target): ninja \r\n[25/80] Building C object lib/CMakeFiles/libcurl_shared.dir/http_chunks.c.o\r\nFAILED: lib/CMakeFiles/libcurl_shared.dir/http_chunks.c.o \r\n/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/toolchain/bin/armv7ve-libreelec-linux-gnueabihf-gcc -DBUILDING_LIBCURL -DCURL_HIDDEN_SYMBOLS -DHAVE_CONFIG_H -Dlibcurl_shared_EXPORTS -I/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/include -I/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/.armv7ve-libreelec-linux-gnueabihf/lib/../include -I/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/lib/.. -I/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/lib/../include -I/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/.armv7ve-libreelec-linux-gnueabihf/lib/.. -I/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/lib -I/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/.armv7ve-libreelec-linux-gnueabihf/lib -march=armv7ve -mtune=cortex-a7 -mabi=aapcs-linux -Wno-psabi -Wa,-mno-warn-deprecated -mfloat-abi=hard -mfpu=neon-vfpv4 -Wall -pipe  -O2 -fomit-frame-pointer -DNDEBUG  -pedantic-errors -W -Wall -pedantic -Wbad-function-cast -Wconversion -Winline -Wmissing-declarations -Wmissing-prototypes -Wnested-externs -Wno-long-long -Wno-multichar -Wpointer-arith -Wshadow -Wsign-compare -Wundef -Wunused -Wwrite-strings -Waddress -Wattributes -Wcast-align -Wdeclaration-after-statement -Wdiv-by-zero -Wempty-body -Wendif-labels -Wfloat-equal -Wformat-security -Wignored-qualifiers -Wmissing-field-initializers -Wmissing-noreturn -Wno-format-nonliteral -Wno-system-headers -Wold-style-definition -Wredundant-decls -Wsign-conversion -Wno-error=sign-conversion -Wstrict-prototypes -Wtype-limits -Wunreachable-code -Wunused-parameter -Wvla -Wclobbered -Wmissing-parameter-type -Wold-style-declaration -Wstrict-aliasing=3 -Wtrampolines -Wformat=2 -Warray-bounds=2 -ftree-vrp -Wduplicated-cond -Wnull-dereference -fdelete-null-pointer-checks -Wshift-negative-value -Wshift-overflow=2 -Walloc-zero -Wduplicated-branches -Wformat-overflow=2 -Wformat-truncation=2 -Wimplicit-fallthrough -Wrestrict -Warith-conversion -Wdouble-promotion -Wenum-conversion -Wpragmas -Wunused-const-variable -Werror -DDUMMYOPT -fPIC -fvisibility=hidden -MD -MT lib/CMakeFiles/libcurl_shared.dir/http_chunks.c.o -MF lib/CMakeFiles/libcurl_shared.dir/http_chunks.c.o.d -o lib/CMakeFiles/libcurl_shared.dir/http_chunks.c.o -c /var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/lib/http_chunks.c\r\n/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/lib/http_chunks.c: In function 'cw_chunked_init':\r\n/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/lib/http_chunks.c:389:32: error: cast increases required alignment of target type [-Werror=cast-align]\r\n  389 |   struct chunked_writer *ctx = (struct chunked_writer *)writer;\r\n      |                                ^\r\n/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/lib/http_chunks.c: In function 'cw_chunked_close':\r\n/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/lib/http_chunks.c:399:32: error: cast increases required alignment of target type [-Werror=cast-align]\r\n  399 |   struct chunked_writer *ctx = (struct chunked_writer *)writer;\r\n      |                                ^\r\n/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/lib/http_chunks.c: In function 'cw_chunked_write':\r\n/var/media/DATA/home-rudi/LibreELEC.kernel11/build.LibreELEC-RPi2.arm-12.0-devel/build/curl-8.6.0/lib/http_chunks.c:407:32: error: cast increases required alignment of target type [-Werror=cast-align]\r\n  407 |   struct chunked_writer *ctx = (struct chunked_writer *)writer;\r\n      |                                ^\r\ncc1: all warnings being treated as errors\r\n[40/80] Building C object lib/CMakeFiles/libcurl_shared.dir/vtls/openssl.c.o\r\nninja: build stopped: subcommand failed.\r\n```\n\n### I expected the following\n\nSuccessful compile\n\n### curl/libcurl version\n\ncurl 8.6.0\n\n### operating system\n\nLibreELEC HEAD","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/13035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/13035/timeline","performed_via_github_app":null,"state_reason":"completed"}