{"url":"https://api.github.com/repos/curl/curl/issues/9192","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/9192/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/9192/comments","events_url":"https://api.github.com/repos/curl/curl/issues/9192/events","html_url":"https://github.com/curl/curl/issues/9192","id":1313565964,"node_id":"I_kwDOAAiu0c5OS20M","number":9192,"title":"curl does not automatically resolve `*.localhost` like Chrome does.","user":{"login":"TheKnarf","id":213777,"node_id":"MDQ6VXNlcjIxMzc3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/213777?v=4","gravatar_id":"","url":"https://api.github.com/users/TheKnarf","html_url":"https://github.com/TheKnarf","followers_url":"https://api.github.com/users/TheKnarf/followers","following_url":"https://api.github.com/users/TheKnarf/following{/other_user}","gists_url":"https://api.github.com/users/TheKnarf/gists{/gist_id}","starred_url":"https://api.github.com/users/TheKnarf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TheKnarf/subscriptions","organizations_url":"https://api.github.com/users/TheKnarf/orgs","repos_url":"https://api.github.com/users/TheKnarf/repos","events_url":"https://api.github.com/users/TheKnarf/events{/privacy}","received_events_url":"https://api.github.com/users/TheKnarf/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":228248612,"node_id":"MDU6TGFiZWwyMjgyNDg2MTI=","url":"https://api.github.com/repos/curl/curl/labels/enhancement","name":"enhancement","color":"FCFD96","default":true,"description":null},{"id":975635480,"node_id":"MDU6TGFiZWw5NzU2MzU0ODA=","url":"https://api.github.com/repos/curl/curl/labels/name%20lookup","name":"name lookup","color":"0052cc","default":false,"description":"DNS and related tech"}],"state":"closed","locked":false,"assignee":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":5,"created_at":"2022-07-21T17:15:02Z","updated_at":"2024-12-09T15:43:21Z","closed_at":"2022-08-11T14:21:58Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!-- Only file bugs here! Ask questions on the mailing lists https://curl.se/mail/\r\n\r\n     SECURITY RELATED? Post it here: https://hackerone.com/curl\r\n\r\n     There are collections of known issues to be aware of:\r\n     https://curl.se/docs/knownbugs.html\r\n     https://curl.se/docs/todo.html       -->\r\n\r\n### I did this\r\n\r\nIn my local development env I got Hasura running and responding on `hasura.localhost`. This works fine in Chrome, I can open the web UI and do stuff from there. However when querying it get the following error\r\n\r\n```\r\n$ curl -g \\\r\n-X POST \\\r\n-H \"Content-Type: application/json\" \\\r\n-d '{\"query\":\"query MyQuery { user { id email } }\"}' \\\r\nhttp://hasura.localhost/v1/graphql\r\n\r\ncurl: (6) Could not resolve host: hasura.localhost\r\n```\r\n\r\nThis seems to break [RFC-6761](https://www.rfc-editor.org/rfc/rfc6761#section-6.3):\r\n\r\n>Name resolution APIs and libraries SHOULD recognize localhost names as special and SHOULD always return the IP loopback address for address queries and negative responses for all other query types. Name resolution APIs SHOULD NOT send queries for localhost names to their configured caching DNS server(s).\r\n\r\nSo it seems that Chrome resolves `hasura.localhost` as the localhost loopback, while curl does not.\r\n\r\nNow there is a simple fix for my use case, I can simply add `--resolve hasura.localhost:80:127.0.0.1` to my curl command and it works fine. However this should not be necessary according to [RFC-6761](https://www.rfc-editor.org/rfc/rfc6761#section-6.3).\r\n\r\n### I expected the following\r\n\r\nTo get an result from the endpoint without having to add `--resolve`.\r\n\r\n### curl/libcurl version\r\n\r\n```\r\ncurl -V\r\ncurl 7.79.1 (x86_64-apple-darwin21.0) libcurl/7.79.1 (SecureTransport) LibreSSL/3.3.6 zlib/1.2.11 nghttp2/1.45.1\r\nRelease-Date: 2021-09-22\r\nProtocols: dict file ftp ftps gopher gophers http https imap imaps ldap ldaps mqtt pop3 pop3s rtsp smb smbs smtp smtps telnet tftp\r\nFeatures: alt-svc AsynchDNS GSS-API HSTS HTTP2 HTTPS-proxy IPv6 Kerberos Largefile libz MultiSSL NTLM NTLM_WB SPNEGO SSL UnixSockets\r\n```\r\n\r\n### operating system\r\n\r\n```\r\nuname -a\r\nDarwin Mbp13arm.local 21.5.0 Darwin Kernel Version 21.5.0: Tue Apr 26 21:08:29 PDT 2022; root:xnu-8020.121.3~4/RELEASE_ARM64_T8101 arm64\r\n```\r\n","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/9192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/9192/timeline","performed_via_github_app":null,"state_reason":"completed"}