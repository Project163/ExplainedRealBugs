{"url":"https://api.github.com/repos/curl/curl/issues/15469","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/15469/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/15469/comments","events_url":"https://api.github.com/repos/curl/curl/issues/15469/events","html_url":"https://github.com/curl/curl/issues/15469","id":2628603461,"node_id":"I_kwDOAAiu0c6crU5F","number":15469,"title":"libcurl's package config file unconditionally references mbedtls in Requires.private but it does not exist","user":{"login":"haampie","id":194764,"node_id":"MDQ6VXNlcjE5NDc2NA==","avatar_url":"https://avatars.githubusercontent.com/u/194764?v=4","gravatar_id":"","url":"https://api.github.com/users/haampie","html_url":"https://github.com/haampie","followers_url":"https://api.github.com/users/haampie/followers","following_url":"https://api.github.com/users/haampie/following{/other_user}","gists_url":"https://api.github.com/users/haampie/gists{/gist_id}","starred_url":"https://api.github.com/users/haampie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haampie/subscriptions","organizations_url":"https://api.github.com/users/haampie/orgs","repos_url":"https://api.github.com/users/haampie/repos","events_url":"https://api.github.com/users/haampie/events{/privacy}","received_events_url":"https://api.github.com/users/haampie/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118182,"node_id":"MDU6TGFiZWwxODQxMTgxODI=","url":"https://api.github.com/repos/curl/curl/labels/build","name":"build","color":"bfdadc","default":false,"description":null},{"id":698723912,"node_id":"MDU6TGFiZWw2OTg3MjM5MTI=","url":"https://api.github.com/repos/curl/curl/labels/not-a-curl-bug","name":"not-a-curl-bug","color":"d4c5f9","default":false,"description":"This is not a bug in curl"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2024-11-01T08:35:32Z","updated_at":"2024-11-09T09:39:49Z","closed_at":"2024-11-09T09:39:49Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\nInstall mbedtls 3.6.0 (or any older version) with their makefile build system\r\n\r\nIt does *not* produce a package config file.\r\n\r\nNow install curl with this mbedtls, and it will produce a `libcurl.pc` like this:\r\n\r\n```\r\n...\r\nRequires.private: zlib,mbedtls,libssh2,libnghttp2\r\n...\r\n```\r\n\r\nwhich then breaks builds of dependents of curl such as `elfutils`, because:\r\n\r\n```\r\nconfigure:13512: checking for libcurl >= 7.29.0\r\nconfigure:13519: $PKG_CONFIG --exists --print-errors \"libcurl >= 7.29.0\"\r\nconfigure:13522: $? = 0\r\nconfigure:13536: $PKG_CONFIG --exists --print-errors \"libcurl >= 7.29.0\"\r\nconfigure:13539: $? = 0\r\nconfigure:13553: result: no\r\nPackage 'mbedtls', required by 'libcurl', not found\r\n```\n\n### I expected the following\n\nI would expect curl not to put mbedtls in the Requires.private section of its libcurl.pc file, because it never tested whether this package config file exists.\r\n\r\nI would also expect curl to continue to allow users to build mbedtls using their makefile build system, given that cmake itself depends on curl, so requiring cmake as a build system for mbedtls causes circular dependencies across these packages.\r\n\r\nLastly, I would expect curl to produce a sensible pc file when using old mbedtls, which did not produce a pc file to start with.\n\n### curl/libcurl version\n\ncurl 8.9.0 and up\n\n### operating system\n\nirrelevant","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/15469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/15469/timeline","performed_via_github_app":null,"state_reason":"completed"}