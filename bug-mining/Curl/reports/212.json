{"url":"https://api.github.com/repos/curl/curl/issues/10737","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/10737/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/10737/comments","events_url":"https://api.github.com/repos/curl/curl/issues/10737/events","html_url":"https://github.com/curl/curl/issues/10737","id":1618945187,"node_id":"I_kwDOAAiu0c5gfySj","number":10737,"title":"clang-cl warnings in 'Curl_log_cf_debug()'","user":{"login":"gvanem","id":945271,"node_id":"MDQ6VXNlcjk0NTI3MQ==","avatar_url":"https://avatars.githubusercontent.com/u/945271?v=4","gravatar_id":"","url":"https://api.github.com/users/gvanem","html_url":"https://github.com/gvanem","followers_url":"https://api.github.com/users/gvanem/followers","following_url":"https://api.github.com/users/gvanem/following{/other_user}","gists_url":"https://api.github.com/users/gvanem/gists{/gist_id}","starred_url":"https://api.github.com/users/gvanem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gvanem/subscriptions","organizations_url":"https://api.github.com/users/gvanem/orgs","repos_url":"https://api.github.com/users/gvanem/repos","events_url":"https://api.github.com/users/gvanem/events{/privacy}","received_events_url":"https://api.github.com/users/gvanem/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118182,"node_id":"MDU6TGFiZWwxODQxMTgxODI=","url":"https://api.github.com/repos/curl/curl/labels/build","name":"build","color":"bfdadc","default":false,"description":null},{"id":940032249,"node_id":"MDU6TGFiZWw5NDAwMzIyNDk=","url":"https://api.github.com/repos/curl/curl/labels/Windows","name":"Windows","color":"0e8a16","default":false,"description":"Windows-specific"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2023-03-10T13:01:45Z","updated_at":"2023-09-29T02:59:11Z","closed_at":"2023-03-29T11:13:19Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Simply adding this patch:\r\n```diff\r\n--- a/lib/curl_log.h 2023-01-19 14:43:40\r\n+++ b/lib/curl_log.h 2023-03-10 13:45:46\r\n@@ -81,7 +81,7 @@\r\n #endif\r\n\r\n void Curl_log_cf_debug(struct Curl_easy *data, struct Curl_cfilter *cf,\r\n-#if defined(__GNUC__) && !defined(printf) &&                    \\\r\n+#if (defined(__GNUC__) || defined(__clang__)) && !defined(printf) && \\\r\n   defined(__STDC_VERSION__) && (__STDC_VERSION__ >= 199901L) && \\\r\n   !defined(__MINGW32__)\r\n                        const char *fmt, ...)\r\n```\r\n\r\nand using `clang-cl` to compile with `-DDEBUGBUILD`, causes these warnings in `cf-socket.c` and `connect.c`:\r\n```c\r\ncf-socket.c(978,68): warning: format specifies type 'int' but the argument has type 'curl_socket_t' (aka 'unsigned long long') [-Wformat]\r\n  DEBUGF(LOG_CF(data, cf, \"cf_socket_open() -> %d, fd=%d\", result, ctx->sock));\r\n                                                      ~~           ^~~~~~~~~\r\n                                                      %llu\r\n\r\ncf-socket.c(1585,10): warning: format specifies type 'int' but the argument has type 'curl_socket_t' (aka 'unsigned long long') [-Wformat]\r\n         ctx->sock, ctx->l_ip, ctx->l_port, ctx->r_ip, ctx->r_port));\r\n         ^~~~~~~~~\r\n\r\ncf-socket.c(1638,21): warning: format specifies type 'int' but the argument has type 'curl_socket_t' (aka 'unsigned long long') [-Wformat]\r\n                    ctx->sock, ctx->l_ip, ctx->l_port));\r\n                    ^~~~~~~~~\r\n\r\ncf-socket.c(1642,38): warning: format specifies type 'int' but the argument has type 'curl_socket_t' (aka 'unsigned long long') [-Wformat]\r\n                    \"(unconnected)\", ctx->sock));\r\n                                     ^~~~~~~~~\r\n4 warnings generated.\r\n\r\nconnect.c(667,39): warning: format specifies type 'long' but the argument has type 'timediff_t' (aka 'long long') [-Wformat]\r\n                        baller->name, baller->timeoutms));\r\n                                      ^~~~~~~~~~~~~~~~~\r\n\r\nconnect.c(805,39): warning: format specifies type 'long' but the argument has type 'timediff_t' (aka 'long long') [-Wformat]\r\n                ctx->baller[0]->name, ctx->baller[0]->timeoutms));\r\n                                      ^~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nconnect.c(816,41): warning: format specifies type 'long' but the argument has type 'timediff_t' (aka 'long long') [-Wformat]\r\n                  ctx->baller[1]->name, ctx->baller[1]->timeoutms));\r\n                                        ^~~~~~~~~~~~~~~~~~~~~~~~~\r\n3 warnings generated.\r\n\r\n```\r\n\r\n(edited). I assume the same would occur with gcc on Windows (haven't tested).\r\nCould we use some other format to account for the various `curl_socket_t` and `timediff_t` definitions?","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/10737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/10737/timeline","performed_via_github_app":null,"state_reason":"completed"}