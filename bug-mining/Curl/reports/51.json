{"url":"https://api.github.com/repos/curl/curl/issues/9161","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/9161/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/9161/comments","events_url":"https://api.github.com/repos/curl/curl/issues/9161/events","html_url":"https://github.com/curl/curl/issues/9161","id":1306216277,"node_id":"I_kwDOAAiu0c5N20dV","number":9161,"title":"Getting a directory listing from a FTPS Server hanging on Windows / SChannel","user":{"login":"grafster","id":7203957,"node_id":"MDQ6VXNlcjcyMDM5NTc=","avatar_url":"https://avatars.githubusercontent.com/u/7203957?v=4","gravatar_id":"","url":"https://api.github.com/users/grafster","html_url":"https://github.com/grafster","followers_url":"https://api.github.com/users/grafster/followers","following_url":"https://api.github.com/users/grafster/following{/other_user}","gists_url":"https://api.github.com/users/grafster/gists{/gist_id}","starred_url":"https://api.github.com/users/grafster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grafster/subscriptions","organizations_url":"https://api.github.com/users/grafster/orgs","repos_url":"https://api.github.com/users/grafster/repos","events_url":"https://api.github.com/users/grafster/events{/privacy}","received_events_url":"https://api.github.com/users/grafster/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118265,"node_id":"MDU6TGFiZWwxODQxMTgyNjU=","url":"https://api.github.com/repos/curl/curl/labels/FTP","name":"FTP","color":"bfd4f2","default":false,"description":null},{"id":352090567,"node_id":"MDU6TGFiZWwzNTIwOTA1Njc=","url":"https://api.github.com/repos/curl/curl/labels/KNOWN_BUGS%20material","name":"KNOWN_BUGS material","color":"d93f0b","default":false,"description":null},{"id":657824945,"node_id":"MDU6TGFiZWw2NTc4MjQ5NDU=","url":"https://api.github.com/repos/curl/curl/labels/help%20wanted","name":"help wanted","color":"fbca04","default":true,"description":null},{"id":940032249,"node_id":"MDU6TGFiZWw5NDAwMzIyNDk=","url":"https://api.github.com/repos/curl/curl/labels/Windows","name":"Windows","color":"0e8a16","default":false,"description":"Windows-specific"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-07-15T16:14:16Z","updated_at":"2022-08-14T04:42:48Z","closed_at":"2022-08-12T22:32:36Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\r\n\r\nI set up a local ftps server following these instructions.\r\n\r\nhttps://itnext.io/using-a-local-ftps-server-for-testing-6f2d77873bab\r\n\r\nAnd uploaded some files to it (the problem does not occur if there are no files on the server, but it doesn't seem to matter what files you upload)\r\n\r\nI build libcurl using vcpkg on windows, and created and ran the attached program to get the file listing from the remote server. It works correctly on Linux but not in Windows, when curl is compiled with schannel as opposed to OpenSSL.\r\n\r\nI got similar results from running:-\r\n\r\ncurl  --ssl-reqd -k --insecure ftp://localhost:21/ --user \"foo:pass\" --verbose\r\n\r\n### I expected the following\r\n\r\nI expected the program to exit after displaying the file listing, but it hangs indefinitely.\r\n\r\n### curl/libcurl version\r\n\r\nlibcurl/7.84.0-DEV Schannel zlib/1.2.12\r\n\r\n[curl -V output]\r\n\r\n### operating system\r\n\r\nWindows 10 21H2\r\n\r\n[Source.cpp.txt](https://github.com/curl/curl/files/9122363/Source.cpp.txt)","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/9161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/9161/timeline","performed_via_github_app":null,"state_reason":"completed"}