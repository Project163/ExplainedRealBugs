{"url":"https://api.github.com/repos/curl/curl/issues/12737","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/12737/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/12737/comments","events_url":"https://api.github.com/repos/curl/curl/issues/12737/events","html_url":"https://github.com/curl/curl/issues/12737","id":2088657406,"node_id":"I_kwDOAAiu0c58fmH-","number":12737,"title":"[rustls] Make curl compatible with rustls-ffi 0.12.0","user":{"login":"der-eismann","id":10406217,"node_id":"MDQ6VXNlcjEwNDA2MjE3","avatar_url":"https://avatars.githubusercontent.com/u/10406217?v=4","gravatar_id":"","url":"https://api.github.com/users/der-eismann","html_url":"https://github.com/der-eismann","followers_url":"https://api.github.com/users/der-eismann/followers","following_url":"https://api.github.com/users/der-eismann/following{/other_user}","gists_url":"https://api.github.com/users/der-eismann/gists{/gist_id}","starred_url":"https://api.github.com/users/der-eismann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/der-eismann/subscriptions","organizations_url":"https://api.github.com/users/der-eismann/orgs","repos_url":"https://api.github.com/users/der-eismann/repos","events_url":"https://api.github.com/users/der-eismann/events{/privacy}","received_events_url":"https://api.github.com/users/der-eismann/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118182,"node_id":"MDU6TGFiZWwxODQxMTgxODI=","url":"https://api.github.com/repos/curl/curl/labels/build","name":"build","color":"bfdadc","default":false,"description":null},{"id":184118221,"node_id":"MDU6TGFiZWwxODQxMTgyMjE=","url":"https://api.github.com/repos/curl/curl/labels/TLS","name":"TLS","color":"bfdadc","default":false,"description":""},{"id":657824945,"node_id":"MDU6TGFiZWw2NTc4MjQ5NDU=","url":"https://api.github.com/repos/curl/curl/labels/help%20wanted","name":"help wanted","color":"fbca04","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-01-18T16:33:39Z","updated_at":"2024-02-06T08:36:39Z","closed_at":"2024-02-06T08:36:38Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\nI tried to build curl with rustls-ffi 0.12.0, however it failed with the following errors:\r\n```\r\nvtls/rustls.c:418:13: error: call to undeclared function 'rustls_root_cert_store_new'; ISO C99 and later do not support implicit function declarations [-Wimplicit-function-declaration]\r\n    roots = rustls_root_cert_store_new();\r\n            ^\r\nvtls/rustls.c:418:13: note: did you mean 'rustls_root_cert_store_free'?\r\n/usr/include/rustls.h:1018:6: note: 'rustls_root_cert_store_free' declared here\r\nvoid rustls_root_cert_store_free(const struct rustls_root_cert_store *store);\r\n     ^\r\nvtls/rustls.c:418:11: error: incompatible integer to pointer conversion assigning to 'struct rustls_root_cert_store *' from 'int' [-Wint-conversion]\r\n    roots = rustls_root_cert_store_new();\r\n          ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nvtls/rustls.c:421:14: error: call to undeclared function 'rustls_root_cert_store_add_pem'; ISO C99 and later do not support implicit function declarations [-Wimplicit-function-declaration]\r\n    result = rustls_root_cert_store_add_pem(roots, ca_info_blob->data,\r\n             ^\r\nvtls/rustls.c:431:14: error: call to undeclared function 'rustls_client_config_builder_use_roots'; ISO C99 and later do not support implicit function declarations [-Wimplicit-function-declaration]\r\n    result = rustls_client_config_builder_use_roots(config_builder, roots);\r\n             ^\r\nvtls/rustls.c:441:14: error: call to undeclared function 'rustls_client_config_builder_load_roots_from_file'; ISO C99 and later do not support implicit function declarations [-Wimplicit-function-declaration]\r\n    result = rustls_client_config_builder_load_roots_from_file(\r\n             ^\r\nvtls/rustls.c:441:14: note: did you mean 'rustls_root_cert_store_builder_load_roots_from_file'?\r\n/usr/include/rustls.h:991:15: note: 'rustls_root_cert_store_builder_load_roots_from_file' declared here\r\nrustls_result rustls_root_cert_store_builder_load_roots_from_file(struct rustls_root_cert_store_builder *builder,\r\n              ^\r\n5 errors generated.\r\nmake[2]: *** [Makefile:3193: vtls/libcurl_la-rustls.lo] Error 1\r\n```\r\n\r\nFirst I reported it [in their project](https://github.com/rustls/rustls-ffi/issues/384), but looks like it needs to be addressed in curl code. Also I just saw, that [docs/RUSTLS.md](https://github.com/curl/curl/blob/master/docs/RUSTLS.md) even speaks of 0.10.0, so I guess CI & docs need an update as well.\n\n### I expected the following\n\ncurl should build with the latest rustls-ffi version.\n\n### curl/libcurl version\n\ncurl 8.5.0\n\n### operating system\n\nFedora 39","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/12737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/12737/timeline","performed_via_github_app":null,"state_reason":"completed"}