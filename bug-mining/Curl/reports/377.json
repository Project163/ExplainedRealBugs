{"url":"https://api.github.com/repos/curl/curl/issues/12632","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/12632/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/12632/comments","events_url":"https://api.github.com/repos/curl/curl/issues/12632/events","html_url":"https://github.com/curl/curl/issues/12632","id":2064673491,"node_id":"I_kwDOAAiu0c57EGrT","number":12632,"title":"libcurl 8.5.0 breaks mpd http streaming","user":{"login":"bubbleguuum","id":761164,"node_id":"MDQ6VXNlcjc2MTE2NA==","avatar_url":"https://avatars.githubusercontent.com/u/761164?v=4","gravatar_id":"","url":"https://api.github.com/users/bubbleguuum","html_url":"https://github.com/bubbleguuum","followers_url":"https://api.github.com/users/bubbleguuum/followers","following_url":"https://api.github.com/users/bubbleguuum/following{/other_user}","gists_url":"https://api.github.com/users/bubbleguuum/gists{/gist_id}","starred_url":"https://api.github.com/users/bubbleguuum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bubbleguuum/subscriptions","organizations_url":"https://api.github.com/users/bubbleguuum/orgs","repos_url":"https://api.github.com/users/bubbleguuum/repos","events_url":"https://api.github.com/users/bubbleguuum/events{/privacy}","received_events_url":"https://api.github.com/users/bubbleguuum/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118243,"node_id":"MDU6TGFiZWwxODQxMTgyNDM=","url":"https://api.github.com/repos/curl/curl/labels/HTTP","name":"HTTP","color":"207de5","default":false,"description":null},{"id":192515830,"node_id":"MDU6TGFiZWwxOTI1MTU4MzA=","url":"https://api.github.com/repos/curl/curl/labels/needs-info","name":"needs-info","color":"fbca04","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":15,"created_at":"2024-01-03T21:30:53Z","updated_at":"2024-02-08T23:52:23Z","closed_at":"2024-01-04T14:45:53Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\r\n\r\nlibcurl  v8.5.0 is causing issues in mpd http streaming, for http streams whose size is > 128 MB (which causes mpd to not fully buffer the stream in memory). Shortly after playing such stream, a curl API inexplicably returns CURLE_OUT_OF_MEMORY, causing mpd to immediately stop playback. libcurl v8.4.0 and prior work just fine.\r\n\r\nI reported all the details and findings about it and how to reproduce it on this [mpd issue](https://github.com/MusicPlayerDaemon/MPD/issues/1952).\r\n\r\nThe problematic commit has been found to be https://github.com/curl/curl/commit/47f5b1a37f3e8055dfea446236c05478087858dc via bissecting.\r\n\r\nAfter analysis, the mpd developer thinks this is a curl issue, hence this report.\r\n\r\nInterestingly, mpd running with git libcurl (as of the date of this post) do not cause an OOM but instead will make the mpd \"io\" thread (making curl API calls) to take 100% CPU.\r\n\r\nAny insights for fixing this issue would be appreciated.\r\n\r\n### I expected the following\r\n\r\n_No response_\r\n\r\n### curl/libcurl version\r\n\r\nlibcurl 8.5.0\r\n\r\n### operating system\r\n\r\nopenSUSE Tumbleed (this issue is not OS dependent).","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/12632/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/12632/timeline","performed_via_github_app":null,"state_reason":"completed"}