[{"url":"https://api.github.com/repos/curl/curl/issues/comments/2400213584","html_url":"https://github.com/curl/curl/issues/15201#issuecomment-2400213584","issue_url":"https://api.github.com/repos/curl/curl/issues/15201","id":2400213584,"node_id":"IC_kwDOAAiu0c6PEFpQ","user":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-08T15:47:25Z","updated_at":"2024-10-08T15:47:25Z","body":"I think this is a fair suggestion. Can you turn that into a proper PR?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/2400213584/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null,"event":"commented","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/2400476520","html_url":"https://github.com/curl/curl/issues/15201#issuecomment-2400476520","issue_url":"https://api.github.com/repos/curl/curl/issues/15201","id":2400476520,"node_id":"IC_kwDOAAiu0c6PFF1o","user":{"login":"jay","id":965580,"node_id":"MDQ6VXNlcjk2NTU4MA==","avatar_url":"https://avatars.githubusercontent.com/u/965580?v=4","gravatar_id":"","url":"https://api.github.com/users/jay","html_url":"https://github.com/jay","followers_url":"https://api.github.com/users/jay/followers","following_url":"https://api.github.com/users/jay/following{/other_user}","gists_url":"https://api.github.com/users/jay/gists{/gist_id}","starred_url":"https://api.github.com/users/jay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jay/subscriptions","organizations_url":"https://api.github.com/users/jay/orgs","repos_url":"https://api.github.com/users/jay/repos","events_url":"https://api.github.com/users/jay/events{/privacy}","received_events_url":"https://api.github.com/users/jay/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-08T17:50:04Z","updated_at":"2024-10-08T17:50:04Z","body":"> When curl_multi_cleanup is called, it immediately invalidates multi handle magic. However it doesn't take into account that user callbacks can still be called with that multi handle and those callbacks may call curl_multi_assign (it is permissible to call this function from a callback).\r\n\r\nThis sounds familiar, I think I read about something similar in another issue or discussion but I can't find it.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/2400476520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jay","id":965580,"node_id":"MDQ6VXNlcjk2NTU4MA==","avatar_url":"https://avatars.githubusercontent.com/u/965580?v=4","gravatar_id":"","url":"https://api.github.com/users/jay","html_url":"https://github.com/jay","followers_url":"https://api.github.com/users/jay/followers","following_url":"https://api.github.com/users/jay/following{/other_user}","gists_url":"https://api.github.com/users/jay/gists{/gist_id}","starred_url":"https://api.github.com/users/jay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jay/subscriptions","organizations_url":"https://api.github.com/users/jay/orgs","repos_url":"https://api.github.com/users/jay/repos","events_url":"https://api.github.com/users/jay/events{/privacy}","received_events_url":"https://api.github.com/users/jay/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/2400879900","html_url":"https://github.com/curl/curl/issues/15201#issuecomment-2400879900","issue_url":"https://api.github.com/repos/curl/curl/issues/15201","id":2400879900,"node_id":"IC_kwDOAAiu0c6PGoUc","user":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-08T21:47:10Z","updated_at":"2024-10-08T21:47:10Z","body":"it is a discussion that is cross-issue. It probably started with #14860 and #14862.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/2400879900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":14566350762,"node_id":"CE_lADOAAiu0c6ZYWLwzwAAAANkON-q","url":"https://api.github.com/repos/curl/curl/issues/events/14566350762","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"461ce6c6160b86439ddd74c59541231ec9e8558e","commit_url":"https://api.github.com/repos/curl/curl/commits/461ce6c6160b86439ddd74c59541231ec9e8558e","created_at":"2024-10-09T05:56:39Z","state_reason":null,"performed_via_github_app":null},{"id":14567704570,"node_id":"REFE_lADOAAiu0c6ZYWLwzwAAAANkTYf6","url":"https://api.github.com/repos/curl/curl/issues/events/14567704570","actor":{"login":"katojunya","id":8252213,"node_id":"MDQ6VXNlcjgyNTIyMTM=","avatar_url":"https://avatars.githubusercontent.com/u/8252213?v=4","gravatar_id":"","url":"https://api.github.com/users/katojunya","html_url":"https://github.com/katojunya","followers_url":"https://api.github.com/users/katojunya/followers","following_url":"https://api.github.com/users/katojunya/following{/other_user}","gists_url":"https://api.github.com/users/katojunya/gists{/gist_id}","starred_url":"https://api.github.com/users/katojunya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/katojunya/subscriptions","organizations_url":"https://api.github.com/users/katojunya/orgs","repos_url":"https://api.github.com/users/katojunya/repos","events_url":"https://api.github.com/users/katojunya/events{/privacy}","received_events_url":"https://api.github.com/users/katojunya/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"461ce6c6160b86439ddd74c59541231ec9e8558e","commit_url":"https://api.github.com/repos/katojunya/curl/commits/461ce6c6160b86439ddd74c59541231ec9e8558e","created_at":"2024-10-09T07:38:56Z","performed_via_github_app":null},{"id":14614781820,"node_id":"REFE_lADOAAiu0c6ZYWLwzwAAAANnG998","url":"https://api.github.com/repos/curl/curl/issues/events/14614781820","actor":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"44013f4cedff6ff8e9bdc5e3d4ac96206ade7656","commit_url":"https://api.github.com/repos/tarantool/tarantool/commits/44013f4cedff6ff8e9bdc5e3d4ac96206ade7656","created_at":"2024-10-11T23:28:15Z","performed_via_github_app":null},{"actor":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-11T23:29:47Z","updated_at":"2024-10-11T23:29:47Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/tarantool/tarantool/issues/10681","repository_url":"https://api.github.com/repos/tarantool/tarantool","labels_url":"https://api.github.com/repos/tarantool/tarantool/issues/10681/labels{/name}","comments_url":"https://api.github.com/repos/tarantool/tarantool/issues/10681/comments","events_url":"https://api.github.com/repos/tarantool/tarantool/issues/10681/events","html_url":"https://github.com/tarantool/tarantool/pull/10681","id":2582328875,"node_id":"PR_kwDOAA3qbM5-YyEH","number":10681,"title":"build: update libcurl to curl-8_10_1-241-g461ce6c61","user":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3569694073,"node_id":"LA_kwDOAA3qbM7UxTV5","url":"https://api.github.com/repos/tarantool/tarantool/labels/full-ci","name":"full-ci","color":"2A2CC1","default":false,"description":"Enables all tests for a pull request"},{"id":4077865200,"node_id":"LA_kwDOAA3qbM7zD0jw","url":"https://api.github.com/repos/tarantool/tarantool/labels/integration-ci","name":"integration-ci","color":"BBCF4A","default":false,"description":"Enables integration tests for a pull request"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2024-10-11T23:29:45Z","updated_at":"2024-10-14T20:59:38Z","closed_at":"2024-10-14T14:47:13Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":911980,"node_id":"MDEwOlJlcG9zaXRvcnk5MTE5ODA=","name":"tarantool","full_name":"tarantool/tarantool","private":false,"owner":{"login":"tarantool","id":2344919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIzNDQ5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/2344919?v=4","gravatar_id":"","url":"https://api.github.com/users/tarantool","html_url":"https://github.com/tarantool","followers_url":"https://api.github.com/users/tarantool/followers","following_url":"https://api.github.com/users/tarantool/following{/other_user}","gists_url":"https://api.github.com/users/tarantool/gists{/gist_id}","starred_url":"https://api.github.com/users/tarantool/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tarantool/subscriptions","organizations_url":"https://api.github.com/users/tarantool/orgs","repos_url":"https://api.github.com/users/tarantool/repos","events_url":"https://api.github.com/users/tarantool/events{/privacy}","received_events_url":"https://api.github.com/users/tarantool/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/tarantool/tarantool","description":"Get your data in RAM. Get compute close to data. Enjoy the performance.","fork":false,"url":"https://api.github.com/repos/tarantool/tarantool","forks_url":"https://api.github.com/repos/tarantool/tarantool/forks","keys_url":"https://api.github.com/repos/tarantool/tarantool/keys{/key_id}","collaborators_url":"https://api.github.com/repos/tarantool/tarantool/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/tarantool/tarantool/teams","hooks_url":"https://api.github.com/repos/tarantool/tarantool/hooks","issue_events_url":"https://api.github.com/repos/tarantool/tarantool/issues/events{/number}","events_url":"https://api.github.com/repos/tarantool/tarantool/events","assignees_url":"https://api.github.com/repos/tarantool/tarantool/assignees{/user}","branches_url":"https://api.github.com/repos/tarantool/tarantool/branches{/branch}","tags_url":"https://api.github.com/repos/tarantool/tarantool/tags","blobs_url":"https://api.github.com/repos/tarantool/tarantool/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/tarantool/tarantool/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/tarantool/tarantool/git/refs{/sha}","trees_url":"https://api.github.com/repos/tarantool/tarantool/git/trees{/sha}","statuses_url":"https://api.github.com/repos/tarantool/tarantool/statuses/{sha}","languages_url":"https://api.github.com/repos/tarantool/tarantool/languages","stargazers_url":"https://api.github.com/repos/tarantool/tarantool/stargazers","contributors_url":"https://api.github.com/repos/tarantool/tarantool/contributors","subscribers_url":"https://api.github.com/repos/tarantool/tarantool/subscribers","subscription_url":"https://api.github.com/repos/tarantool/tarantool/subscription","commits_url":"https://api.github.com/repos/tarantool/tarantool/commits{/sha}","git_commits_url":"https://api.github.com/repos/tarantool/tarantool/git/commits{/sha}","comments_url":"https://api.github.com/repos/tarantool/tarantool/comments{/number}","issue_comment_url":"https://api.github.com/repos/tarantool/tarantool/issues/comments{/number}","contents_url":"https://api.github.com/repos/tarantool/tarantool/contents/{+path}","compare_url":"https://api.github.com/repos/tarantool/tarantool/compare/{base}...{head}","merges_url":"https://api.github.com/repos/tarantool/tarantool/merges","archive_url":"https://api.github.com/repos/tarantool/tarantool/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/tarantool/tarantool/downloads","issues_url":"https://api.github.com/repos/tarantool/tarantool/issues{/number}","pulls_url":"https://api.github.com/repos/tarantool/tarantool/pulls{/number}","milestones_url":"https://api.github.com/repos/tarantool/tarantool/milestones{/number}","notifications_url":"https://api.github.com/repos/tarantool/tarantool/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/tarantool/tarantool/labels{/name}","releases_url":"https://api.github.com/repos/tarantool/tarantool/releases{/id}","deployments_url":"https://api.github.com/repos/tarantool/tarantool/deployments","created_at":"2010-09-15T07:59:26Z","updated_at":"2025-11-10T08:10:31Z","pushed_at":"2025-11-10T07:28:30Z","git_url":"git://github.com/tarantool/tarantool.git","ssh_url":"git@github.com:tarantool/tarantool.git","clone_url":"https://github.com/tarantool/tarantool.git","svn_url":"https://github.com/tarantool/tarantool","homepage":"https://www.tarantool.io","size":129254,"stargazers_count":3580,"watchers_count":3580,"language":"Lua","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":395,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1535,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["appserver","database","disk","in-memory","lua","msgpack","tarantool","transactions"],"visibility":"public","forks":395,"open_issues":1535,"watchers":3580,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/tarantool/tarantool/pulls/10681","html_url":"https://github.com/tarantool/tarantool/pull/10681","diff_url":"https://github.com/tarantool/tarantool/pull/10681.diff","patch_url":"https://github.com/tarantool/tarantool/pull/10681.patch","merged_at":"2024-10-14T14:47:13Z"},"body":"The reason is that the previous libcurl submodule update in commit 0919f390802f146852b462215327ef03e2730cfc (\"third_party: update libcurl from 8.8.0 to 8.10.1\") reveals the following regression:\r\n\r\n```c\r\n$ tarantool -e \"require('http.client').new():get('https://google.com')\"\r\ntarantool: ./third_party/curl/lib/multi.c:3691: curl_multi_assign: Assertion `!(multi)' failed.\r\nAborted (core dumped)\r\n```\r\n\r\nThe stacktrace is the following:\r\n\r\n```c\r\n<...>\r\n#4  __assert_fail\r\n#5  curl_multi_assign            // <- called by us\r\n#6  curl_multi_sock_cb           // <- this is our callback\r\n#7  Curl_multi_pollset_ev\r\n#8  cpool_update_shutdown_ev\r\n#9  cpool_discard_conn\r\n#10 cpool_close_and_destroy_all\r\n#11 Curl_cpool_destroy\r\n#12 curl_multi_cleanup\r\n#13 curl_env_finish              // <- destroy the multi handle\r\n#14 httpc_env_finish\r\n#15 luaT_httpc_cleanup\r\n#16 lj_BC_FUNCC\r\n#17 gc_call_finalizer\r\n#18 gc_finalize\r\n#19 gc_onestep\r\n#20 lj_gc_fullgc\r\n#21 lua_gc\r\n#22 lj_cf_collectgarbage\r\n#23 lj_BC_FUNCC\r\n#24 lua_pcall\r\n#25 luaT_call\r\n#26 lua_main\r\n#27 run_script_f\r\n#28 fiber_cxx_invoke\r\n#29 fiber_loop\r\n#30 coro_init\r\n```\r\n\r\nThe multi handle is during the destroy, but our `CURLMOPT_SOCKETFUNCTION` callback is invoked and the `curl_multi_assign()` call (invoked to associate a libev watcher to the given file descriptor) fails on the assertion. Everything is as described in https://github.com/curl/curl/issues/15201.\r\n\r\nThe first bad libcurl's commit is [curl-8_10_0-4-g48f61e781][1], but later it was fixed in [curl-8_10_1-241-g461ce6c61][2]. This commit updates libcurl to this revision to fix the regression.\r\n\r\nAdjusted build options in our build script:\r\n\r\n* Added `CURL_DISABLE_IPFS=ON`: [curl-8_10_1-57-gce7d0d413][3]\r\n* Added `CURL_TEST_BUNDLES=OFF`: [curl-8_10_1-67-g71cf0d1fc][4]\r\n* Changed `ENABLE_WEBSOCKETS=OFF` to `CURL_DISABLE_WEBSOCKETS=ON`: [curl-8_10_1-130-gd78e129d5][5]\r\n\r\n[1]: https://github.com/curl/curl/commit/48f61e781a01e6a8dbc4a347e280644b1c68ab6a\r\n[2]: https://github.com/curl/curl/commit/461ce6c6160b86439ddd74c59541231ec9e8558e\r\n[3]: https://github.com/curl/curl/commit/ce7d0d41378007eda676c83ad6b86c59870cc9f1\r\n[4]: https://github.com/curl/curl/commit/71cf0d1fca9e1f53524e1545ef0c08d174458d80\r\n[5]: https://github.com/curl/curl/commit/d78e129d50b2d190f1c1bde2ad1f62f02f152db0","reactions":{"url":"https://api.github.com/repos/tarantool/tarantool/issues/10681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tarantool/tarantool/issues/10681/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":14633641749,"node_id":"REFE_lADOAAiu0c6ZYWLwzwAAAANoO6cV","url":"https://api.github.com/repos/curl/curl/issues/events/14633641749","actor":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"d48ac5e4ed36a2ad926eb85594a824f659d51981","commit_url":"https://api.github.com/repos/tarantool/tarantool/commits/d48ac5e4ed36a2ad926eb85594a824f659d51981","created_at":"2024-10-14T11:24:05Z","performed_via_github_app":null},{"id":14637693743,"node_id":"REFE_lADOAAiu0c6ZYWLwzwAAAANoeXsv","url":"https://api.github.com/repos/curl/curl/issues/events/14637693743","actor":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"fbe6d0a0a40945c42609f5119a007b5c3980c232","commit_url":"https://api.github.com/repos/tarantool/tarantool/commits/fbe6d0a0a40945c42609f5119a007b5c3980c232","created_at":"2024-10-14T14:47:17Z","performed_via_github_app":null},{"id":14646241012,"node_id":"REFE_lADOAAiu0c6ZYWLwzwAAAANo--b0","url":"https://api.github.com/repos/curl/curl/issues/events/14646241012","actor":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ca5365744909450d641fe71e9f940b82c2ab786a","commit_url":"https://api.github.com/repos/tarantool/tarantool/commits/ca5365744909450d641fe71e9f940b82c2ab786a","created_at":"2024-10-14T20:51:58Z","performed_via_github_app":null},{"actor":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-14T20:54:51Z","updated_at":"2024-10-14T20:54:51Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/tarantool/tarantool/issues/10685","repository_url":"https://api.github.com/repos/tarantool/tarantool","labels_url":"https://api.github.com/repos/tarantool/tarantool/issues/10685/labels{/name}","comments_url":"https://api.github.com/repos/tarantool/tarantool/issues/10685/comments","events_url":"https://api.github.com/repos/tarantool/tarantool/issues/10685/events","html_url":"https://github.com/tarantool/tarantool/pull/10685","id":2587054843,"node_id":"PR_kwDOAA3qbM5-l_Ts","number":10685,"title":"[backport 3.2] build: update libcurl to curl-8_10_1-241-g461ce6c61","user":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3569694073,"node_id":"LA_kwDOAA3qbM7UxTV5","url":"https://api.github.com/repos/tarantool/tarantool/labels/full-ci","name":"full-ci","color":"2A2CC1","default":false,"description":"Enables all tests for a pull request"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-10-14T20:54:50Z","updated_at":"2024-10-14T22:49:47Z","closed_at":"2024-10-14T22:49:45Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":911980,"node_id":"MDEwOlJlcG9zaXRvcnk5MTE5ODA=","name":"tarantool","full_name":"tarantool/tarantool","private":false,"owner":{"login":"tarantool","id":2344919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIzNDQ5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/2344919?v=4","gravatar_id":"","url":"https://api.github.com/users/tarantool","html_url":"https://github.com/tarantool","followers_url":"https://api.github.com/users/tarantool/followers","following_url":"https://api.github.com/users/tarantool/following{/other_user}","gists_url":"https://api.github.com/users/tarantool/gists{/gist_id}","starred_url":"https://api.github.com/users/tarantool/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tarantool/subscriptions","organizations_url":"https://api.github.com/users/tarantool/orgs","repos_url":"https://api.github.com/users/tarantool/repos","events_url":"https://api.github.com/users/tarantool/events{/privacy}","received_events_url":"https://api.github.com/users/tarantool/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/tarantool/tarantool","description":"Get your data in RAM. Get compute close to data. Enjoy the performance.","fork":false,"url":"https://api.github.com/repos/tarantool/tarantool","forks_url":"https://api.github.com/repos/tarantool/tarantool/forks","keys_url":"https://api.github.com/repos/tarantool/tarantool/keys{/key_id}","collaborators_url":"https://api.github.com/repos/tarantool/tarantool/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/tarantool/tarantool/teams","hooks_url":"https://api.github.com/repos/tarantool/tarantool/hooks","issue_events_url":"https://api.github.com/repos/tarantool/tarantool/issues/events{/number}","events_url":"https://api.github.com/repos/tarantool/tarantool/events","assignees_url":"https://api.github.com/repos/tarantool/tarantool/assignees{/user}","branches_url":"https://api.github.com/repos/tarantool/tarantool/branches{/branch}","tags_url":"https://api.github.com/repos/tarantool/tarantool/tags","blobs_url":"https://api.github.com/repos/tarantool/tarantool/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/tarantool/tarantool/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/tarantool/tarantool/git/refs{/sha}","trees_url":"https://api.github.com/repos/tarantool/tarantool/git/trees{/sha}","statuses_url":"https://api.github.com/repos/tarantool/tarantool/statuses/{sha}","languages_url":"https://api.github.com/repos/tarantool/tarantool/languages","stargazers_url":"https://api.github.com/repos/tarantool/tarantool/stargazers","contributors_url":"https://api.github.com/repos/tarantool/tarantool/contributors","subscribers_url":"https://api.github.com/repos/tarantool/tarantool/subscribers","subscription_url":"https://api.github.com/repos/tarantool/tarantool/subscription","commits_url":"https://api.github.com/repos/tarantool/tarantool/commits{/sha}","git_commits_url":"https://api.github.com/repos/tarantool/tarantool/git/commits{/sha}","comments_url":"https://api.github.com/repos/tarantool/tarantool/comments{/number}","issue_comment_url":"https://api.github.com/repos/tarantool/tarantool/issues/comments{/number}","contents_url":"https://api.github.com/repos/tarantool/tarantool/contents/{+path}","compare_url":"https://api.github.com/repos/tarantool/tarantool/compare/{base}...{head}","merges_url":"https://api.github.com/repos/tarantool/tarantool/merges","archive_url":"https://api.github.com/repos/tarantool/tarantool/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/tarantool/tarantool/downloads","issues_url":"https://api.github.com/repos/tarantool/tarantool/issues{/number}","pulls_url":"https://api.github.com/repos/tarantool/tarantool/pulls{/number}","milestones_url":"https://api.github.com/repos/tarantool/tarantool/milestones{/number}","notifications_url":"https://api.github.com/repos/tarantool/tarantool/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/tarantool/tarantool/labels{/name}","releases_url":"https://api.github.com/repos/tarantool/tarantool/releases{/id}","deployments_url":"https://api.github.com/repos/tarantool/tarantool/deployments","created_at":"2010-09-15T07:59:26Z","updated_at":"2025-11-10T08:10:31Z","pushed_at":"2025-11-10T07:28:30Z","git_url":"git://github.com/tarantool/tarantool.git","ssh_url":"git@github.com:tarantool/tarantool.git","clone_url":"https://github.com/tarantool/tarantool.git","svn_url":"https://github.com/tarantool/tarantool","homepage":"https://www.tarantool.io","size":129254,"stargazers_count":3580,"watchers_count":3580,"language":"Lua","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":395,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1535,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["appserver","database","disk","in-memory","lua","msgpack","tarantool","transactions"],"visibility":"public","forks":395,"open_issues":1535,"watchers":3580,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/tarantool/tarantool/pulls/10685","html_url":"https://github.com/tarantool/tarantool/pull/10685","diff_url":"https://github.com/tarantool/tarantool/pull/10685.diff","patch_url":"https://github.com/tarantool/tarantool/pull/10685.patch","merged_at":"2024-10-14T22:49:45Z"},"body":"*(This is a backport of PR #10681 to `release/3.2`.)*\r\n\r\n----\r\n\r\nThe reason is that the previous libcurl submodule update in commit 0919f390802f146852b462215327ef03e2730cfc (\"third_party: update libcurl from 8.8.0 to 8.10.1\") reveals the following regression:\r\n\r\n```c\r\n$ tarantool -e \"require('http.client').new():get('https://google.com')\"\r\ntarantool: ./third_party/curl/lib/multi.c:3691: curl_multi_assign: Assertion `!(multi)' failed.\r\nAborted (core dumped)\r\n```\r\n\r\nThe stacktrace is the following:\r\n\r\n```c\r\n<...>\r\n#4  __assert_fail\r\n#5  curl_multi_assign            // <- called by us\r\n#6  curl_multi_sock_cb           // <- this is our callback\r\n#7  Curl_multi_pollset_ev\r\n#8  cpool_update_shutdown_ev\r\n#9  cpool_discard_conn\r\n#10 cpool_close_and_destroy_all\r\n#11 Curl_cpool_destroy\r\n#12 curl_multi_cleanup\r\n#13 curl_env_finish              // <- destroy the multi handle\r\n#14 httpc_env_finish\r\n#15 luaT_httpc_cleanup\r\n#16 lj_BC_FUNCC\r\n#17 gc_call_finalizer\r\n#18 gc_finalize\r\n#19 gc_onestep\r\n#20 lj_gc_fullgc\r\n#21 lua_gc\r\n#22 lj_cf_collectgarbage\r\n#23 lj_BC_FUNCC\r\n#24 lua_pcall\r\n#25 luaT_call\r\n#26 lua_main\r\n#27 run_script_f\r\n#28 fiber_cxx_invoke\r\n#29 fiber_loop\r\n#30 coro_init\r\n```\r\n\r\nThe multi handle is during the destroy, but our `CURLMOPT_SOCKETFUNCTION` callback is invoked and the `curl_multi_assign()` call (invoked to associate a libev watcher to the given file descriptor) fails on the assertion. Everything is as described in https://github.com/curl/curl/issues/15201.\r\n\r\nThe first bad libcurl's commit is [curl-8_10_0-4-g48f61e781][1], but later it was fixed in [curl-8_10_1-241-g461ce6c61][2]. This commit updates libcurl to this revision to fix the regression.\r\n\r\nAdjusted build options in our build script:\r\n\r\n* Added `CURL_DISABLE_IPFS=ON`: [curl-8_10_1-57-gce7d0d413][3]\r\n* Added `CURL_TEST_BUNDLES=OFF`: [curl-8_10_1-67-g71cf0d1fc][4]\r\n* Changed `ENABLE_WEBSOCKETS=OFF` to `CURL_DISABLE_WEBSOCKETS=ON`: [curl-8_10_1-130-gd78e129d5][5]\r\n\r\n[1]: https://github.com/curl/curl/commit/48f61e781a01e6a8dbc4a347e280644b1c68ab6a\r\n[2]: https://github.com/curl/curl/commit/461ce6c6160b86439ddd74c59541231ec9e8558e\r\n[3]: https://github.com/curl/curl/commit/ce7d0d41378007eda676c83ad6b86c59870cc9f1\r\n[4]: https://github.com/curl/curl/commit/71cf0d1fca9e1f53524e1545ef0c08d174458d80\r\n[5]: https://github.com/curl/curl/commit/d78e129d50b2d190f1c1bde2ad1f62f02f152db0","reactions":{"url":"https://api.github.com/repos/tarantool/tarantool/issues/10685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tarantool/tarantool/issues/10685/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":14646288270,"node_id":"REFE_lADOAAiu0c6ZYWLwzwAAAANo_J-O","url":"https://api.github.com/repos/curl/curl/issues/events/14646288270","actor":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"825a84742bff50b35019fd2833442388407044e3","commit_url":"https://api.github.com/repos/tarantool/tarantool/commits/825a84742bff50b35019fd2833442388407044e3","created_at":"2024-10-14T20:57:31Z","performed_via_github_app":null},{"actor":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-14T20:59:14Z","updated_at":"2024-10-14T20:59:14Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/tarantool/tarantool/issues/10686","repository_url":"https://api.github.com/repos/tarantool/tarantool","labels_url":"https://api.github.com/repos/tarantool/tarantool/issues/10686/labels{/name}","comments_url":"https://api.github.com/repos/tarantool/tarantool/issues/10686/comments","events_url":"https://api.github.com/repos/tarantool/tarantool/issues/10686/events","html_url":"https://github.com/tarantool/tarantool/pull/10686","id":2587063148,"node_id":"PR_kwDOAA3qbM5-mAr3","number":10686,"title":"[backport 2.11] build: update libcurl to curl-8_10_1-241-g461ce6c61","user":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3569694073,"node_id":"LA_kwDOAA3qbM7UxTV5","url":"https://api.github.com/repos/tarantool/tarantool/labels/full-ci","name":"full-ci","color":"2A2CC1","default":false,"description":"Enables all tests for a pull request"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-10-14T20:59:13Z","updated_at":"2024-10-14T22:49:52Z","closed_at":"2024-10-14T22:49:50Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":911980,"node_id":"MDEwOlJlcG9zaXRvcnk5MTE5ODA=","name":"tarantool","full_name":"tarantool/tarantool","private":false,"owner":{"login":"tarantool","id":2344919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIzNDQ5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/2344919?v=4","gravatar_id":"","url":"https://api.github.com/users/tarantool","html_url":"https://github.com/tarantool","followers_url":"https://api.github.com/users/tarantool/followers","following_url":"https://api.github.com/users/tarantool/following{/other_user}","gists_url":"https://api.github.com/users/tarantool/gists{/gist_id}","starred_url":"https://api.github.com/users/tarantool/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tarantool/subscriptions","organizations_url":"https://api.github.com/users/tarantool/orgs","repos_url":"https://api.github.com/users/tarantool/repos","events_url":"https://api.github.com/users/tarantool/events{/privacy}","received_events_url":"https://api.github.com/users/tarantool/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/tarantool/tarantool","description":"Get your data in RAM. Get compute close to data. Enjoy the performance.","fork":false,"url":"https://api.github.com/repos/tarantool/tarantool","forks_url":"https://api.github.com/repos/tarantool/tarantool/forks","keys_url":"https://api.github.com/repos/tarantool/tarantool/keys{/key_id}","collaborators_url":"https://api.github.com/repos/tarantool/tarantool/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/tarantool/tarantool/teams","hooks_url":"https://api.github.com/repos/tarantool/tarantool/hooks","issue_events_url":"https://api.github.com/repos/tarantool/tarantool/issues/events{/number}","events_url":"https://api.github.com/repos/tarantool/tarantool/events","assignees_url":"https://api.github.com/repos/tarantool/tarantool/assignees{/user}","branches_url":"https://api.github.com/repos/tarantool/tarantool/branches{/branch}","tags_url":"https://api.github.com/repos/tarantool/tarantool/tags","blobs_url":"https://api.github.com/repos/tarantool/tarantool/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/tarantool/tarantool/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/tarantool/tarantool/git/refs{/sha}","trees_url":"https://api.github.com/repos/tarantool/tarantool/git/trees{/sha}","statuses_url":"https://api.github.com/repos/tarantool/tarantool/statuses/{sha}","languages_url":"https://api.github.com/repos/tarantool/tarantool/languages","stargazers_url":"https://api.github.com/repos/tarantool/tarantool/stargazers","contributors_url":"https://api.github.com/repos/tarantool/tarantool/contributors","subscribers_url":"https://api.github.com/repos/tarantool/tarantool/subscribers","subscription_url":"https://api.github.com/repos/tarantool/tarantool/subscription","commits_url":"https://api.github.com/repos/tarantool/tarantool/commits{/sha}","git_commits_url":"https://api.github.com/repos/tarantool/tarantool/git/commits{/sha}","comments_url":"https://api.github.com/repos/tarantool/tarantool/comments{/number}","issue_comment_url":"https://api.github.com/repos/tarantool/tarantool/issues/comments{/number}","contents_url":"https://api.github.com/repos/tarantool/tarantool/contents/{+path}","compare_url":"https://api.github.com/repos/tarantool/tarantool/compare/{base}...{head}","merges_url":"https://api.github.com/repos/tarantool/tarantool/merges","archive_url":"https://api.github.com/repos/tarantool/tarantool/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/tarantool/tarantool/downloads","issues_url":"https://api.github.com/repos/tarantool/tarantool/issues{/number}","pulls_url":"https://api.github.com/repos/tarantool/tarantool/pulls{/number}","milestones_url":"https://api.github.com/repos/tarantool/tarantool/milestones{/number}","notifications_url":"https://api.github.com/repos/tarantool/tarantool/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/tarantool/tarantool/labels{/name}","releases_url":"https://api.github.com/repos/tarantool/tarantool/releases{/id}","deployments_url":"https://api.github.com/repos/tarantool/tarantool/deployments","created_at":"2010-09-15T07:59:26Z","updated_at":"2025-11-10T08:10:31Z","pushed_at":"2025-11-10T07:28:30Z","git_url":"git://github.com/tarantool/tarantool.git","ssh_url":"git@github.com:tarantool/tarantool.git","clone_url":"https://github.com/tarantool/tarantool.git","svn_url":"https://github.com/tarantool/tarantool","homepage":"https://www.tarantool.io","size":129254,"stargazers_count":3580,"watchers_count":3580,"language":"Lua","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":395,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1535,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["appserver","database","disk","in-memory","lua","msgpack","tarantool","transactions"],"visibility":"public","forks":395,"open_issues":1535,"watchers":3580,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/tarantool/tarantool/pulls/10686","html_url":"https://github.com/tarantool/tarantool/pull/10686","diff_url":"https://github.com/tarantool/tarantool/pull/10686.diff","patch_url":"https://github.com/tarantool/tarantool/pull/10686.patch","merged_at":"2024-10-14T22:49:50Z"},"body":"*(This is a backport of PR #10681 to `release/2.11`.)*\r\n\r\n----\r\n\r\nThe reason is that the previous libcurl submodule update in commit 0919f390802f146852b462215327ef03e2730cfc (\"third_party: update libcurl from 8.8.0 to 8.10.1\") reveals the following regression:\r\n\r\n```c\r\n$ tarantool -e \"require('http.client').new():get('https://google.com')\"\r\ntarantool: ./third_party/curl/lib/multi.c:3691: curl_multi_assign: Assertion `!(multi)' failed.\r\nAborted (core dumped)\r\n```\r\n\r\nThe stacktrace is the following:\r\n\r\n```c\r\n<...>\r\n#4  __assert_fail\r\n#5  curl_multi_assign            // <- called by us\r\n#6  curl_multi_sock_cb           // <- this is our callback\r\n#7  Curl_multi_pollset_ev\r\n#8  cpool_update_shutdown_ev\r\n#9  cpool_discard_conn\r\n#10 cpool_close_and_destroy_all\r\n#11 Curl_cpool_destroy\r\n#12 curl_multi_cleanup\r\n#13 curl_env_finish              // <- destroy the multi handle\r\n#14 httpc_env_finish\r\n#15 luaT_httpc_cleanup\r\n#16 lj_BC_FUNCC\r\n#17 gc_call_finalizer\r\n#18 gc_finalize\r\n#19 gc_onestep\r\n#20 lj_gc_fullgc\r\n#21 lua_gc\r\n#22 lj_cf_collectgarbage\r\n#23 lj_BC_FUNCC\r\n#24 lua_pcall\r\n#25 luaT_call\r\n#26 lua_main\r\n#27 run_script_f\r\n#28 fiber_cxx_invoke\r\n#29 fiber_loop\r\n#30 coro_init\r\n```\r\n\r\nThe multi handle is during the destroy, but our `CURLMOPT_SOCKETFUNCTION` callback is invoked and the `curl_multi_assign()` call (invoked to associate a libev watcher to the given file descriptor) fails on the assertion. Everything is as described in https://github.com/curl/curl/issues/15201.\r\n\r\nThe first bad libcurl's commit is [curl-8_10_0-4-g48f61e781][1], but later it was fixed in [curl-8_10_1-241-g461ce6c61][2]. This commit updates libcurl to this revision to fix the regression.\r\n\r\nAdjusted build options in our build script:\r\n\r\n* Added `CURL_DISABLE_IPFS=ON`: [curl-8_10_1-57-gce7d0d413][3]\r\n* Added `CURL_TEST_BUNDLES=OFF`: [curl-8_10_1-67-g71cf0d1fc][4]\r\n* Changed `ENABLE_WEBSOCKETS=OFF` to `CURL_DISABLE_WEBSOCKETS=ON`: [curl-8_10_1-130-gd78e129d5][5]\r\n\r\n[1]: https://github.com/curl/curl/commit/48f61e781a01e6a8dbc4a347e280644b1c68ab6a\r\n[2]: https://github.com/curl/curl/commit/461ce6c6160b86439ddd74c59541231ec9e8558e\r\n[3]: https://github.com/curl/curl/commit/ce7d0d41378007eda676c83ad6b86c59870cc9f1\r\n[4]: https://github.com/curl/curl/commit/71cf0d1fca9e1f53524e1545ef0c08d174458d80\r\n[5]: https://github.com/curl/curl/commit/d78e129d50b2d190f1c1bde2ad1f62f02f152db0","reactions":{"url":"https://api.github.com/repos/tarantool/tarantool/issues/10686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tarantool/tarantool/issues/10686/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":14647193874,"node_id":"REFE_lADOAAiu0c6ZYWLwzwAAAANpCnES","url":"https://api.github.com/repos/curl/curl/issues/events/14647193874","actor":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"94be5c18ae21d7d3577d7c48ceba4d924b893800","commit_url":"https://api.github.com/repos/tarantool/tarantool/commits/94be5c18ae21d7d3577d7c48ceba4d924b893800","created_at":"2024-10-14T22:49:49Z","performed_via_github_app":null},{"id":14647194236,"node_id":"REFE_lADOAAiu0c6ZYWLwzwAAAANpCnJ8","url":"https://api.github.com/repos/curl/curl/issues/events/14647194236","actor":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"89b2760ef192a744e09a41a8af347aa148bbdf33","commit_url":"https://api.github.com/repos/tarantool/tarantool/commits/89b2760ef192a744e09a41a8af347aa148bbdf33","created_at":"2024-10-14T22:49:54Z","performed_via_github_app":null},{"id":14674326814,"node_id":"REFE_lADOAAiu0c6ZYWLwzwAAAANqqHUe","url":"https://api.github.com/repos/curl/curl/issues/events/14674326814","actor":{"login":"mandesero","id":88092267,"node_id":"MDQ6VXNlcjg4MDkyMjY3","avatar_url":"https://avatars.githubusercontent.com/u/88092267?v=4","gravatar_id":"","url":"https://api.github.com/users/mandesero","html_url":"https://github.com/mandesero","followers_url":"https://api.github.com/users/mandesero/followers","following_url":"https://api.github.com/users/mandesero/following{/other_user}","gists_url":"https://api.github.com/users/mandesero/gists{/gist_id}","starred_url":"https://api.github.com/users/mandesero/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mandesero/subscriptions","organizations_url":"https://api.github.com/users/mandesero/orgs","repos_url":"https://api.github.com/users/mandesero/repos","events_url":"https://api.github.com/users/mandesero/events{/privacy}","received_events_url":"https://api.github.com/users/mandesero/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"f9a78b292a744f0df92b6a02f0e9d0aa4a970feb","commit_url":"https://api.github.com/repos/mandesero/tarantool/commits/f9a78b292a744f0df92b6a02f0e9d0aa4a970feb","created_at":"2024-10-16T10:58:35Z","performed_via_github_app":null},{"id":17418996913,"node_id":"REFE_lADOAAiu0c6ZYWLwzwAAAAQOQMyx","url":"https://api.github.com/repos/curl/curl/issues/events/17418996913","actor":{"login":"pps83","id":1614246,"node_id":"MDQ6VXNlcjE2MTQyNDY=","avatar_url":"https://avatars.githubusercontent.com/u/1614246?v=4","gravatar_id":"","url":"https://api.github.com/users/pps83","html_url":"https://github.com/pps83","followers_url":"https://api.github.com/users/pps83/followers","following_url":"https://api.github.com/users/pps83/following{/other_user}","gists_url":"https://api.github.com/users/pps83/gists{/gist_id}","starred_url":"https://api.github.com/users/pps83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pps83/subscriptions","organizations_url":"https://api.github.com/users/pps83/orgs","repos_url":"https://api.github.com/users/pps83/repos","events_url":"https://api.github.com/users/pps83/events{/privacy}","received_events_url":"https://api.github.com/users/pps83/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"9028390e64bf50d69b4fc2680668496e45b70599","commit_url":"https://api.github.com/repos/pps83/curl/commits/9028390e64bf50d69b4fc2680668496e45b70599","created_at":"2025-04-26T22:32:32Z","performed_via_github_app":null}]