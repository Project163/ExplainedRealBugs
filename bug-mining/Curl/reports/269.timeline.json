[{"id":9766872221,"node_id":"LE_lADOAAiu0c5rAlhAzwAAAAJGJqSd","url":"https://api.github.com/repos/curl/curl/issues/events/9766872221","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-07-09T09:34:22Z","label":{"name":"build","color":"bfdadc"},"performed_via_github_app":null},{"id":9766872222,"node_id":"LE_lADOAAiu0c5rAlhAzwAAAAJGJqSe","url":"https://api.github.com/repos/curl/curl/issues/events/9766872222","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-07-09T09:34:22Z","label":{"name":"TLS","color":"bfdadc"},"performed_via_github_app":null},{"id":9766872224,"node_id":"LE_lADOAAiu0c5rAlhAzwAAAAJGJqSg","url":"https://api.github.com/repos/curl/curl/issues/events/9766872224","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-07-09T09:34:23Z","label":{"name":"cmake","color":"d4c5f9"},"performed_via_github_app":null},{"id":9766872227,"node_id":"LE_lADOAAiu0c5rAlhAzwAAAAJGJqSj","url":"https://api.github.com/repos/curl/curl/issues/events/9766872227","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-07-09T09:34:23Z","label":{"name":"CI","color":"ffb7ca"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1632045125","html_url":"https://github.com/curl/curl/issues/11413#issuecomment-1632045125","issue_url":"https://api.github.com/repos/curl/curl/issues/11413","id":1632045125,"node_id":"IC_kwDOAAiu0c5hRwhF","user":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T08:09:06Z","updated_at":"2023-07-12T08:09:06Z","body":"Just a interim report of current observations:\r\n\r\n* the link errors are reported in `make test`, I assume because we static link the unit tests\r\n* not all unit test linking fails. As seen in https://github.com/curl/curl/actions/runs/5499059260/jobs/10020987667\r\n * first error is reported linking `unit1305`\r\n * the building of `unit1302` and others before that had no issues\r\n\r\nI assume that `unit1302` could be linked without dragging in the offending `libcurlu_la-openssl.o` and `unit1305` through some dependencies needed it? But I am not certain here. Both init curl and construct an easy handle...\r\n ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1632045125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1633842804","html_url":"https://github.com/curl/curl/issues/11413#issuecomment-1633842804","issue_url":"https://api.github.com/repos/curl/curl/issues/11413","id":1633842804,"node_id":"IC_kwDOAAiu0c5hYnZ0","user":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T08:58:21Z","updated_at":"2023-07-13T08:58:21Z","body":"Ok, now I can now longer build curl with ngtcp2 locally. Because it finds the wrong openssl. Which points in the same direction as this problem.\r\n\r\nWhen I run:\r\n\r\n```\r\ngcc -DHAVE_CONFIG_H -I../include -I../lib  -isystem /opt/quic/openssl/include/ -I/opt/quic/include -c vquic/curl_ngtcp2.c -fno-common -DPIC -o vquic/.libs/libcurl_la-curl_ngtcp2.o\r\n```\r\nthis fails. But when I run:\r\n\r\n```\r\ngcc -DHAVE_CONFIG_H -I../include -I../lib -I/opt/quic/openssl/include -I/opt/quic/include -c vquic/curl_ngtcp2.c -fno-common -DPIC -o vquic/.libs/libcurl_la-curl_ngtcp2.o\r\n```\r\nit works.\r\n\r\nOutput of `echo | gcc -E -Wp,-v -`:\r\n\r\n```\r\nclang -cc1 version 14.0.3 (clang-1403.0.22.14.1) default target x86_64-apple-darwin22.5.0\r\nignoring nonexistent directory \"/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/local/include\"\r\nignoring nonexistent directory \"/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/Library/Frameworks\"\r\n#include \"...\" search starts here:\r\n#include <...> search starts here:\r\n /usr/local/include\r\n /Library/Developer/CommandLineTools/usr/lib/clang/14.0.3/include\r\n /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include\r\n /Library/Developer/CommandLineTools/usr/include\r\n /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/Frameworks (framework directory)\r\nEnd of search list.\r\n```\r\n\r\n`/usr/local/include/openssl` exists and is a standard OpenSSL from homebrew.\r\n\r\nMy understanding is that `-isystem dir` should use `dir` before the standard system includes, but that seems not to work any longer.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1633842804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9808880757,"node_id":"REFE_lADOAAiu0c5rAlhAzwAAAAJIp6R1","url":"https://api.github.com/repos/curl/curl/issues/events/9808880757","actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"6a6ded9d95508cb25a58f87e4e9cfb78b17c9f35","commit_url":"https://api.github.com/repos/icing/curl/commits/6a6ded9d95508cb25a58f87e4e9cfb78b17c9f35","created_at":"2023-07-13T09:42:53Z","performed_via_github_app":null},{"actor":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T09:42:53Z","updated_at":"2023-07-13T09:42:53Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/curl/curl/issues/11436","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/11436/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/11436/comments","events_url":"https://api.github.com/repos/curl/curl/issues/11436/events","html_url":"https://github.com/curl/curl/pull/11436","id":1802636508,"node_id":"PR_kwDOAAiu0c5VZmkL","number":11436,"title":"Brew fix for openssl in default path","user":{"login":"icing","id":15102,"node_id":"MDQ6VXNlcjE1MTAy","avatar_url":"https://avatars.githubusercontent.com/u/15102?v=4","gravatar_id":"","url":"https://api.github.com/users/icing","html_url":"https://github.com/icing","followers_url":"https://api.github.com/users/icing/followers","following_url":"https://api.github.com/users/icing/following{/other_user}","gists_url":"https://api.github.com/users/icing/gists{/gist_id}","starred_url":"https://api.github.com/users/icing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icing/subscriptions","organizations_url":"https://api.github.com/users/icing/orgs","repos_url":"https://api.github.com/users/icing/repos","events_url":"https://api.github.com/users/icing/events{/privacy}","received_events_url":"https://api.github.com/users/icing/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2252760348,"node_id":"MDU6TGFiZWwyMjUyNzYwMzQ4","url":"https://api.github.com/repos/curl/curl/labels/CI","name":"CI","color":"ffb7ca","default":false,"description":"Continuous Integration"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-07-13T09:42:53Z","updated_at":"2024-03-25T03:55:49Z","closed_at":"2023-07-13T13:15:58Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":569041,"node_id":"MDEwOlJlcG9zaXRvcnk1NjkwNDE=","name":"curl","full_name":"curl/curl","private":false,"owner":{"login":"curl","id":16928085,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE2OTI4MDg1","avatar_url":"https://avatars.githubusercontent.com/u/16928085?v=4","gravatar_id":"","url":"https://api.github.com/users/curl","html_url":"https://github.com/curl","followers_url":"https://api.github.com/users/curl/followers","following_url":"https://api.github.com/users/curl/following{/other_user}","gists_url":"https://api.github.com/users/curl/gists{/gist_id}","starred_url":"https://api.github.com/users/curl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/curl/subscriptions","organizations_url":"https://api.github.com/users/curl/orgs","repos_url":"https://api.github.com/users/curl/repos","events_url":"https://api.github.com/users/curl/events{/privacy}","received_events_url":"https://api.github.com/users/curl/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/curl/curl","description":"A command line tool and library for transferring data with URL syntax, supporting DICT, FILE, FTP, FTPS, GOPHER, GOPHERS, HTTP, HTTPS, IMAP, IMAPS, LDAP, LDAPS, MQTT, POP3, POP3S, RTMP, RTMPS, RTSP, SCP, SFTP, SMB, SMBS, SMTP, SMTPS, TELNET, TFTP, WS and WSS. libcurl offers a myriad of powerful features","fork":false,"url":"https://api.github.com/repos/curl/curl","forks_url":"https://api.github.com/repos/curl/curl/forks","keys_url":"https://api.github.com/repos/curl/curl/keys{/key_id}","collaborators_url":"https://api.github.com/repos/curl/curl/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/curl/curl/teams","hooks_url":"https://api.github.com/repos/curl/curl/hooks","issue_events_url":"https://api.github.com/repos/curl/curl/issues/events{/number}","events_url":"https://api.github.com/repos/curl/curl/events","assignees_url":"https://api.github.com/repos/curl/curl/assignees{/user}","branches_url":"https://api.github.com/repos/curl/curl/branches{/branch}","tags_url":"https://api.github.com/repos/curl/curl/tags","blobs_url":"https://api.github.com/repos/curl/curl/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/curl/curl/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/curl/curl/git/refs{/sha}","trees_url":"https://api.github.com/repos/curl/curl/git/trees{/sha}","statuses_url":"https://api.github.com/repos/curl/curl/statuses/{sha}","languages_url":"https://api.github.com/repos/curl/curl/languages","stargazers_url":"https://api.github.com/repos/curl/curl/stargazers","contributors_url":"https://api.github.com/repos/curl/curl/contributors","subscribers_url":"https://api.github.com/repos/curl/curl/subscribers","subscription_url":"https://api.github.com/repos/curl/curl/subscription","commits_url":"https://api.github.com/repos/curl/curl/commits{/sha}","git_commits_url":"https://api.github.com/repos/curl/curl/git/commits{/sha}","comments_url":"https://api.github.com/repos/curl/curl/comments{/number}","issue_comment_url":"https://api.github.com/repos/curl/curl/issues/comments{/number}","contents_url":"https://api.github.com/repos/curl/curl/contents/{+path}","compare_url":"https://api.github.com/repos/curl/curl/compare/{base}...{head}","merges_url":"https://api.github.com/repos/curl/curl/merges","archive_url":"https://api.github.com/repos/curl/curl/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/curl/curl/downloads","issues_url":"https://api.github.com/repos/curl/curl/issues{/number}","pulls_url":"https://api.github.com/repos/curl/curl/pulls{/number}","milestones_url":"https://api.github.com/repos/curl/curl/milestones{/number}","notifications_url":"https://api.github.com/repos/curl/curl/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/curl/curl/labels{/name}","releases_url":"https://api.github.com/repos/curl/curl/releases{/id}","deployments_url":"https://api.github.com/repos/curl/curl/deployments","created_at":"2010-03-18T22:32:22Z","updated_at":"2025-11-10T09:41:55Z","pushed_at":"2025-11-10T12:18:24Z","git_url":"git://github.com/curl/curl.git","ssh_url":"git@github.com:curl/curl.git","clone_url":"https://github.com/curl/curl.git","svn_url":"https://github.com/curl/curl","homepage":"https://curl.se/","size":118458,"stargazers_count":39830,"watchers_count":39830,"language":"C","has_issues":true,"has_projects":false,"has_downloads":false,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6941,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":43,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["c","client","curl","ftp","gopher","hacktoberfest","http","https","imaps","ldap","libcurl","library","mqtt","pop3","scp","sftp","transfer-data","transferring-data","user-agent","websocket"],"visibility":"public","forks":6941,"open_issues":43,"watchers":39830,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/curl/curl/pulls/11436","html_url":"https://github.com/curl/curl/pull/11436","diff_url":"https://github.com/curl/curl/pull/11436.diff","patch_url":"https://github.com/curl/curl/pull/11436.patch","merged_at":null},"body":"- refs #11413\r\n- if brew install/update links openssl into /usr/local, it will be found before anything we add with `-isystem path` to CPP/LDLFAGS. Get rid of that by unlinking the keg.","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/11436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/11436/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":9811057716,"node_id":"CE_lADOAAiu0c5rAlhAzwAAAAJIyNw0","url":"https://api.github.com/repos/curl/curl/issues/events/9811057716","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"5c07439ba3345cef3eb158a8b2b8064cc246199a","commit_url":"https://api.github.com/repos/curl/curl/commits/5c07439ba3345cef3eb158a8b2b8064cc246199a","created_at":"2023-07-13T13:15:58Z","state_reason":null,"performed_via_github_app":null},{"id":9866882305,"node_id":"REFE_lADOAAiu0c5rAlhAzwAAAAJMHK0B","url":"https://api.github.com/repos/curl/curl/issues/events/9866882305","actor":{"login":"bch","id":122211,"node_id":"MDQ6VXNlcjEyMjIxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/122211?v=4","gravatar_id":"","url":"https://api.github.com/users/bch","html_url":"https://github.com/bch","followers_url":"https://api.github.com/users/bch/followers","following_url":"https://api.github.com/users/bch/following{/other_user}","gists_url":"https://api.github.com/users/bch/gists{/gist_id}","starred_url":"https://api.github.com/users/bch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bch/subscriptions","organizations_url":"https://api.github.com/users/bch/orgs","repos_url":"https://api.github.com/users/bch/repos","events_url":"https://api.github.com/users/bch/events{/privacy}","received_events_url":"https://api.github.com/users/bch/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"67735ef276ef70da90027c83f18c40c3e538aa59","commit_url":"https://api.github.com/repos/bch/curl/commits/67735ef276ef70da90027c83f18c40c3e538aa59","created_at":"2023-07-19T20:02:28Z","performed_via_github_app":null},{"id":10459069853,"node_id":"REFE_lADOAAiu0c5rAlhAzwAAAAJvaL2d","url":"https://api.github.com/repos/curl/curl/issues/events/10459069853","actor":{"login":"ptitSeb","id":3250792,"node_id":"MDQ6VXNlcjMyNTA3OTI=","avatar_url":"https://avatars.githubusercontent.com/u/3250792?v=4","gravatar_id":"","url":"https://api.github.com/users/ptitSeb","html_url":"https://github.com/ptitSeb","followers_url":"https://api.github.com/users/ptitSeb/followers","following_url":"https://api.github.com/users/ptitSeb/following{/other_user}","gists_url":"https://api.github.com/users/ptitSeb/gists{/gist_id}","starred_url":"https://api.github.com/users/ptitSeb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ptitSeb/subscriptions","organizations_url":"https://api.github.com/users/ptitSeb/orgs","repos_url":"https://api.github.com/users/ptitSeb/repos","events_url":"https://api.github.com/users/ptitSeb/events{/privacy}","received_events_url":"https://api.github.com/users/ptitSeb/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"281a53804338fb45efff3c462f2fbe05810a7160","commit_url":"https://api.github.com/repos/wasix-org/curl/commits/281a53804338fb45efff3c462f2fbe05810a7160","created_at":"2023-09-25T08:04:33Z","performed_via_github_app":null},{"id":12270306743,"node_id":"REFE_lADOAAiu0c5rAlhAzwAAAALbXgW3","url":"https://api.github.com/repos/curl/curl/issues/events/12270306743","actor":{"login":"pghmcfc","id":947224,"node_id":"MDQ6VXNlcjk0NzIyNA==","avatar_url":"https://avatars.githubusercontent.com/u/947224?v=4","gravatar_id":"","url":"https://api.github.com/users/pghmcfc","html_url":"https://github.com/pghmcfc","followers_url":"https://api.github.com/users/pghmcfc/followers","following_url":"https://api.github.com/users/pghmcfc/following{/other_user}","gists_url":"https://api.github.com/users/pghmcfc/gists{/gist_id}","starred_url":"https://api.github.com/users/pghmcfc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pghmcfc/subscriptions","organizations_url":"https://api.github.com/users/pghmcfc/orgs","repos_url":"https://api.github.com/users/pghmcfc/repos","events_url":"https://api.github.com/users/pghmcfc/events{/privacy}","received_events_url":"https://api.github.com/users/pghmcfc/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"5c07439ba3345cef3eb158a8b2b8064cc246199a","commit_url":"https://api.github.com/repos/pghmcfc/curl/commits/5c07439ba3345cef3eb158a8b2b8064cc246199a","created_at":"2024-03-27T18:20:28Z","performed_via_github_app":null},{"actor":{"login":"sirknightj","id":14988194,"node_id":"MDQ6VXNlcjE0OTg4MTk0","avatar_url":"https://avatars.githubusercontent.com/u/14988194?v=4","gravatar_id":"","url":"https://api.github.com/users/sirknightj","html_url":"https://github.com/sirknightj","followers_url":"https://api.github.com/users/sirknightj/followers","following_url":"https://api.github.com/users/sirknightj/following{/other_user}","gists_url":"https://api.github.com/users/sirknightj/gists{/gist_id}","starred_url":"https://api.github.com/users/sirknightj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sirknightj/subscriptions","organizations_url":"https://api.github.com/users/sirknightj/orgs","repos_url":"https://api.github.com/users/sirknightj/repos","events_url":"https://api.github.com/users/sirknightj/events{/privacy}","received_events_url":"https://api.github.com/users/sirknightj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-03-25T09:55:36Z","updated_at":"2025-03-25T09:55:36Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/issues/478","repository_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c","labels_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/issues/478/labels{/name}","comments_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/issues/478/comments","events_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/issues/478/events","html_url":"https://github.com/awslabs/amazon-kinesis-video-streams-producer-c/pull/478","id":2945955267,"node_id":"PR_kwDODfjCBs6QA2yN","number":478,"title":"Tell curl to use the local Openssl","user":{"login":"sirknightj","id":14988194,"node_id":"MDQ6VXNlcjE0OTg4MTk0","avatar_url":"https://avatars.githubusercontent.com/u/14988194?v=4","gravatar_id":"","url":"https://api.github.com/users/sirknightj","html_url":"https://github.com/sirknightj","followers_url":"https://api.github.com/users/sirknightj/followers","following_url":"https://api.github.com/users/sirknightj/following{/other_user}","gists_url":"https://api.github.com/users/sirknightj/gists{/gist_id}","starred_url":"https://api.github.com/users/sirknightj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sirknightj/subscriptions","organizations_url":"https://api.github.com/users/sirknightj/orgs","repos_url":"https://api.github.com/users/sirknightj/repos","events_url":"https://api.github.com/users/sirknightj/events{/privacy}","received_events_url":"https://api.github.com/users/sirknightj/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2287360428,"node_id":"MDU6TGFiZWwyMjg3MzYwNDI4","url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/labels/Build","name":"Build","color":"d62920","default":false,"description":"Build specific issues"},{"id":7766194724,"node_id":"LA_kwDODfjCBs8AAAABzua6JA","url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/labels/dependencies","name":"dependencies","color":"A497B1","default":false,"description":"Bumping dependencies"},{"id":8052996130,"node_id":"LA_kwDODfjCBs8AAAAB3_74Ig","url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/labels/1.6.0","name":"1.6.0","color":"f9d0c4","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2025-03-25T09:55:34Z","updated_at":"2025-04-04T05:50:11Z","closed_at":"2025-04-04T05:39:15Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":234406406,"node_id":"MDEwOlJlcG9zaXRvcnkyMzQ0MDY0MDY=","name":"amazon-kinesis-video-streams-producer-c","full_name":"awslabs/amazon-kinesis-video-streams-producer-c","private":false,"owner":{"login":"awslabs","id":3299148,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMyOTkxNDg=","avatar_url":"https://avatars.githubusercontent.com/u/3299148?v=4","gravatar_id":"","url":"https://api.github.com/users/awslabs","html_url":"https://github.com/awslabs","followers_url":"https://api.github.com/users/awslabs/followers","following_url":"https://api.github.com/users/awslabs/following{/other_user}","gists_url":"https://api.github.com/users/awslabs/gists{/gist_id}","starred_url":"https://api.github.com/users/awslabs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awslabs/subscriptions","organizations_url":"https://api.github.com/users/awslabs/orgs","repos_url":"https://api.github.com/users/awslabs/repos","events_url":"https://api.github.com/users/awslabs/events{/privacy}","received_events_url":"https://api.github.com/users/awslabs/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/awslabs/amazon-kinesis-video-streams-producer-c","description":null,"fork":false,"url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c","forks_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/forks","keys_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/keys{/key_id}","collaborators_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/teams","hooks_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/hooks","issue_events_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/issues/events{/number}","events_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/events","assignees_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/assignees{/user}","branches_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/branches{/branch}","tags_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/tags","blobs_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/git/refs{/sha}","trees_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/git/trees{/sha}","statuses_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/statuses/{sha}","languages_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/languages","stargazers_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/stargazers","contributors_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/contributors","subscribers_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/subscribers","subscription_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/subscription","commits_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/commits{/sha}","git_commits_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/git/commits{/sha}","comments_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/comments{/number}","issue_comment_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/issues/comments{/number}","contents_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/contents/{+path}","compare_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/compare/{base}...{head}","merges_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/merges","archive_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/downloads","issues_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/issues{/number}","pulls_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/pulls{/number}","milestones_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/milestones{/number}","notifications_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/labels{/name}","releases_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/releases{/id}","deployments_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/deployments","created_at":"2020-01-16T20:33:04Z","updated_at":"2025-10-11T07:54:30Z","pushed_at":"2025-06-30T20:00:36Z","git_url":"git://github.com/awslabs/amazon-kinesis-video-streams-producer-c.git","ssh_url":"git@github.com:awslabs/amazon-kinesis-video-streams-producer-c.git","clone_url":"https://github.com/awslabs/amazon-kinesis-video-streams-producer-c.git","svn_url":"https://github.com/awslabs/amazon-kinesis-video-streams-producer-c","homepage":"https://awslabs.github.io/amazon-kinesis-video-streams-producer-c/group__PublicMemberFunctions.html","size":70667,"stargazers_count":65,"watchers_count":65,"language":"C","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":80,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":12,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":80,"open_issues":12,"watchers":65,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/pulls/478","html_url":"https://github.com/awslabs/amazon-kinesis-video-streams-producer-c/pull/478","diff_url":"https://github.com/awslabs/amazon-kinesis-video-streams-producer-c/pull/478.diff","patch_url":"https://github.com/awslabs/amazon-kinesis-video-streams-producer-c/pull/478.patch","merged_at":"2025-04-04T05:39:15Z"},"body":"*Issue #, if available:*\r\n- https://github.com/actions/runner-images/issues/7945\r\n\r\n*What was changed?*\r\n- Telling libcurl to use the correct OpenSSL\r\n\r\n*Why was it changed?*\r\n\r\n### Background\r\n- When BUILD_DEPENDENCIES=ON, OpenSSL is locally built. In some cases (mac), if you have OpenSSL installed via brew, it will prefer that one (meaning, you built OpenSSL locally for nothing) during the build phase, whereas during the cmake phase, it used local one.\r\n- Use the one by brew, will cause build issues during the build because the local one is using 1.1.1t and the brew one is v3, meaning that there are methods that are missing.\r\n\r\n<details>\r\n<summary>Logs</summary>\r\n\r\n```\r\nUndefined symbols for architecture arm64:\r\n  \"_EVP_PKEY_get_bn_param\", referenced from:\r\n      _Curl_ossl_certchain in openssl.c.o\r\n      _Curl_ossl_certchain in openssl.c.o\r\n      _Curl_ossl_certchain in openssl.c.o\r\n      _Curl_ossl_certchain in openssl.c.o\r\n      _Curl_ossl_certchain in openssl.c.o\r\n      _Curl_ossl_certchain in openssl.c.o\r\n      _Curl_ossl_certchain in openssl.c.o\r\n      _Curl_ossl_certchain in openssl.c.o\r\n      _Curl_ossl_certchain in openssl.c.o\r\n      _Curl_ossl_certchain in openssl.c.o\r\n      ...\r\n  \"_EVP_PKEY_get_id\", referenced from:\r\n      _Curl_ossl_certchain in openssl.c.o\r\n      _cert_stuff in openssl.c.o\r\n  \"_SSL_get1_peer_certificate\", referenced from:\r\n```\r\n\r\n</details>\r\n\r\n- What makes this even more puzzling is that in the CMake logs (Cmake phase), it finds the correct OpenSSL 1.1.1t, which is placed into open-source directory:\r\n\r\n<details>\r\n<summary>Logs</summary>\r\n\r\n```\r\n-- Looking for connect in socket; - not found\r\n-- Looking for gethostbyname in c\r\n-- Looking for gethostbyname in c - found\r\n-- Looking for gethostname\r\n-- Looking for gethostname - found\r\n-- Found OpenSSL: /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/lib/libcrypto.dylib (found version \"1.1.1t\")\r\n-- Looking for openssl/crypto.h\r\n-- Looking for openssl/crypto.h - found\r\n-- Looking for openssl/err.h\r\n-- Looking for openssl/err.h - found\r\n```\r\n\r\n</details>\r\n\r\n### Root-causing\r\n\r\n- Checking `pkg-config` is functioning as expected:\r\n\r\n<details>\r\n<summary>Logs</summary>\r\n\r\n```\r\nexport PKG_CONFIG_PATH=/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/lib/pkgconfig\r\npkg-config --cflags openssl\r\n\r\n-I/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/include\r\n\r\nexport PKG_CONFIG_PATH=\"$(brew --prefix openssl)/lib/pkgconfig\"\r\npkg-config --cflags openssl  \r\n                                                                                     \r\n-I/opt/homebrew/Cellar/openssl@3/3.4.1/include\r\n```\r\n\r\n</details>\r\n\r\n- I ran with `export VERBOSE=1` to see what's happening.\r\n\r\n<details>\r\n<summary>Logs</summary>\r\n\r\n```\r\n[ 66%] Performing build step for 'project_libcurl'\r\ncd /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build && /opt/homebrew/bin/gmake\r\ngmake[3]: Entering directory '/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build'\r\n/opt/homebrew/Cellar/cmake/3.30.0/bin/cmake -S/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl -B/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build --check-build-system CMakeFiles/Makefile.cmake 0\r\n/opt/homebrew/Cellar/cmake/3.30.0/bin/cmake -E cmake_progress_start /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build/CMakeFiles /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build//CMakeFiles/progress.marks\r\n/opt/homebrew/bin/gmake  -f CMakeFiles/Makefile2 all\r\ngmake[4]: Entering directory '/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build'\r\n/opt/homebrew/bin/gmake  -f lib/CMakeFiles/libcurl.dir/build.make lib/CMakeFiles/libcurl.dir/depend\r\ngmake[5]: Entering directory '/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build'\r\ncd /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build && /opt/homebrew/Cellar/cmake/3.30.0/bin/cmake -E cmake_depends \"Unix Makefiles\" /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl/lib /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build/lib /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build/lib/CMakeFiles/libcurl.dir/DependInfo.cmake \"--color=\"\r\ngmake[5]: Leaving directory '/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build'\r\n/opt/homebrew/bin/gmake  -f lib/CMakeFiles/libcurl.dir/build.make lib/CMakeFiles/libcurl.dir/build\r\ngmake[5]: Entering directory '/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build'\r\n[  0%] Building C object lib/CMakeFiles/libcurl.dir/file.c.o\r\ncd /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build/lib && /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc -DBUILDING_LIBCURL -DCURL_HIDDEN_SYMBOLS -DHAVE_CONFIG_H -Dlibcurl_EXPORTS -I/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl/include -I/opt/homebrew/include -I/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build/lib/../include -I/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl/lib/.. -I/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl/lib/../include -I/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build/lib/.. -I/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl/lib -I/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl-build/lib \"-I/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/include\" -O3 -DNDEBUG -arch arm64 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX14.4.sdk -fPIC -fvisibility=hidden -MD -MT lib/CMakeFiles/libcurl.dir/file.c.o -MF CMakeFiles/libcurl.dir/file.c.o.d -o CMakeFiles/libcurl.dir/file.c.o -c /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/libcurl/build/src/project_libcurl/lib/file.c\r\n```\r\n\r\n</details>\r\n\r\n- In the logs above, it is clear that `-I/opt/homebrew/include` is being pulled in by something.\r\n- So, I tried modifying following to try to remove that from the includes list:\r\n  - DOPENSSL_INCLUDE_DIR, DOPENSSL_SSL_LIBRARY, DOPENSSL_CRYPTO_LIBRARY\r\n  - OPENSSL_ROOT_DIR, OPENSSL_INCLUDE_DIR, OPENSSL_SSL_LIBRARY, OPENSSL_CRYPTO_LIBRARY, OPENSSL_LIBRARIES\r\n  - CMAKE_IGNORE_PATH, CMAKE_PREFIX_PATH\r\n  - LD_LIBRARY_PATH\r\n- And none of those seemed to have any effect. The brew OpenSSL was still being included.\r\n- Next, I checked the CMakeCache to check for any \"brew\" and found nothing: `grep -r \"/opt/homebrew/include\" .`\r\n- I checked entire build logs for any instances of that, and all I found was this:\r\n\r\n<details>\r\n<summary>Logs</summary>\r\n\r\n```\r\n-- Looking for include files /opt/homebrew/include/libssh2.h, stdio.h\r\n-- Looking for include files /opt/homebrew/include/libssh2.h, stdio.h - found\r\n-- Looking for 3 include files /opt/homebrew/include/libssh2.h, ..., inttypes.h\r\n```\r\n\r\n</details>\r\n\r\n- Checking the pkg-config for `libssh2`, one of curl's peer dependencies: \r\n\r\n<details>\r\n<summary>Logs</summary>\r\n\r\n```\r\npkg-config --cflags libssh2\r\n-I/opt/homebrew/Cellar/libssh2/1.11.1/include -I/opt/homebrew/Cellar/openssl@3/3.4.1/include\r\n```\r\n\r\n</details>\r\n\r\n- Therefore, it is clear that libssh2 is linked to the v3 OpenSSL. So, during Curl build, since it needs libssh2, which will basically pull in both the local OpenSSL v1.1.1t, and also the v3 OpenSSL through libssh2.\r\n\r\n### Fixing\r\n\r\n- I remedied this by adding libssh2 to the build:\r\n\r\n<details>\r\n<summary>libssh2-CMakeLists.txt</summary>\r\n\r\n```\r\ncmake_minimum_required(VERSION 3.6.3)\r\nproject(libssh2-download LANGUAGES C)\r\n\r\ninclude(ExternalProject)\r\n\r\nfind_program(MAKE_EXE NAMES make)\r\n\r\nif (BUILD_STATIC)\r\n    set(CMAKE_ARGS ${CMAKE_ARGS} -DBUILD_SHARED_LIBS=OFF -DBUILD_STATIC_LIBS=ON)\r\nelse()\r\n    set(CMAKE_ARGS ${CMAKE_ARGS} -DBUILD_SHARED_LIBS=ON -DBUILD_STATIC_LIBS=OFF)\r\nendif()\r\n\r\nset(CMAKE_ARGS\r\n        -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE}\r\n        -DCMAKE_INSTALL_PREFIX=${OPEN_SRC_INSTALL_PREFIX}\r\n        )\r\n\r\nExternalProject_Add(project_libssh2\r\n    GIT_REPOSITORY    https://github.com/libssh2/libssh2.git\r\n    GIT_TAG           libssh2-1.11.1\r\n    GIT_SHALLOW       TRUE\r\n    GIT_PROGRESS      TRUE\r\n    PREFIX            ${CMAKE_CURRENT_BINARY_DIR}/build\r\n    CMAKE_ARGS        ${CMAKE_ARGS}\r\n    BUILD_ALWAYS      TRUE\r\n    TEST_COMMAND      \"\")\r\n```\r\n\r\n</details>\r\n\r\n- While this does work, it would end up posing an issue for the static builds, because that would mean we also need to link against this (add another library to the list of libraries to link to), which would mean users would need to modify their builds slightly to add this, similar to the threadpool library added in WebRTC-C/PIC.\r\n\r\n<details>\r\n<summary>When building static, curl doesn't statically link to libssh2</summary>\r\n\r\n```\r\nnm -g /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/lib/libcurl.a | grep libssh2\r\n\r\nlibssh2.c.o:\r\n                 U _libssh2_agent_connect\r\n                 U _libssh2_agent_disconnect\r\n                 U _libssh2_agent_free\r\n                 U _libssh2_agent_get_identity\r\n                 U _libssh2_agent_init\r\n                 U _libssh2_agent_list_identities\r\n                 U _libssh2_agent_userauth\r\n                 U _libssh2_channel_free\r\n                 U _libssh2_channel_read_ex\r\n                 U _libssh2_channel_send_eof\r\n                 U _libssh2_channel_wait_closed\r\n                 U _libssh2_channel_wait_eof\r\n                 U _libssh2_channel_write_ex\r\n                 U _libssh2_exit\r\n                 U _libssh2_hostkey_hash\r\n                 U _libssh2_init\r\n                 U _libssh2_knownhost_add\r\n                 U _libssh2_knownhost_checkp\r\n                 U _libssh2_knownhost_free\r\n                 U _libssh2_knownhost_get\r\n                 U _libssh2_knownhost_init\r\n                 U _libssh2_knownhost_readfile\r\n                 U _libssh2_knownhost_writefile\r\n                 U _libssh2_scp_recv2\r\n                 U _libssh2_scp_send64\r\n                 U _libssh2_session_block_directions\r\n                 U _libssh2_session_disconnect_ex\r\n                 U _libssh2_session_flag\r\n                 U _libssh2_session_free\r\n                 U _libssh2_session_handshake\r\n                 U _libssh2_session_hostkey\r\n                 U _libssh2_session_init_ex\r\n                 U _libssh2_session_last_errno\r\n                 U _libssh2_session_last_error\r\n                 U _libssh2_session_method_pref\r\n                 U _libssh2_session_set_blocking\r\n                 U _libssh2_sftp_close_handle\r\n                 U _libssh2_sftp_init\r\n                 U _libssh2_sftp_last_error\r\n                 U _libssh2_sftp_mkdir_ex\r\n                 U _libssh2_sftp_open_ex\r\n                 U _libssh2_sftp_read\r\n                 U _libssh2_sftp_readdir_ex\r\n                 U _libssh2_sftp_rename_ex\r\n                 U _libssh2_sftp_rmdir_ex\r\n                 U _libssh2_sftp_seek64\r\n                 U _libssh2_sftp_shutdown\r\n                 U _libssh2_sftp_stat_ex\r\n                 U _libssh2_sftp_statvfs\r\n                 U _libssh2_sftp_symlink_ex\r\n                 U _libssh2_sftp_unlink_ex\r\n                 U _libssh2_sftp_write\r\n                 U _libssh2_userauth_authenticated\r\n                 U _libssh2_userauth_keyboard_interactive_ex\r\n                 U _libssh2_userauth_list\r\n                 U _libssh2_userauth_password_ex\r\n                 U _libssh2_userauth_publickey_fromfile_ex\r\n```\r\n* U is \"undefined\", meaning it needs to be provided by another library (not in this library).\r\n\r\n</details>\r\n\r\n- After doing some more research on what libssh2 is used for, we don't use this functionality (SSH) at all in this SDK. Looking through the curl documentation, I attempted to disable it via `CURL_USE_LIBSSH2=OFF`, but that didn't seem to do anything. Looking through their CMakeLists.txt, the flag is actually called `CMAKE_USE_LIBSSH2=OFF`. It worked after that.\r\n\r\n*How was it changed?*\r\n- Removed SSH functionality from Curl.\r\n- Add 'parallel' flag to make it build faster using multiple CPU cores (without a specific number to let CMake auto-determine it).\r\n\r\n*What testing was done for the changes?*\r\n- CI to check all the different build flavors\r\n- Checked locally with the otool to verify that libssl1.1.1 is being linked instead of the brew v3.0 one. See the output below.\r\n- Make sure libssh2 is fully removed. Refer to the commands below:\r\n\r\n```\r\notool -L /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/lib/libcurl.dylib          \r\n/Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/lib/libcurl.dylib:\r\n        @rpath/libcurl.dylib (compatibility version 0.0.0, current version 0.0.0)\r\n        /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/lib/libssl.1.1.dylib (compatibility version 1.1.0, current version 1.1.0)\r\n        /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/lib/libcrypto.1.1.dylib (compatibility version 1.1.0, current version 1.1.0)\r\n        /usr/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.12)\r\n        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1345.100.2)\r\n\r\nnm -g /Users/me/Downloads/amazon-kinesis-video-streams-producer-c/open-source/lib/libcurl.dylib | grep \"ssh\"\r\n<no output>\r\n\r\n```\r\n\r\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.","reactions":{"url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/issues/478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/awslabs/amazon-kinesis-video-streams-producer-c/issues/478/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]