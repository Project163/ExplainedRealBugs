{"url":"https://api.github.com/repos/curl/curl/issues/12445","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/12445/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/12445/comments","events_url":"https://api.github.com/repos/curl/curl/issues/12445/events","html_url":"https://github.com/curl/curl/issues/12445","id":2022060740,"node_id":"I_kwDOAAiu0c54hjLE","number":12445,"title":"test1545 fails to compile in an AppVeyor CI job with `[-Werror=deprecated-declarations]`","user":{"login":"vszakats","id":1446897,"node_id":"MDQ6VXNlcjE0NDY4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1446897?v=4","gravatar_id":"","url":"https://api.github.com/users/vszakats","html_url":"https://github.com/vszakats","followers_url":"https://api.github.com/users/vszakats/followers","following_url":"https://api.github.com/users/vszakats/following{/other_user}","gists_url":"https://api.github.com/users/vszakats/gists{/gist_id}","starred_url":"https://api.github.com/users/vszakats/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vszakats/subscriptions","organizations_url":"https://api.github.com/users/vszakats/orgs","repos_url":"https://api.github.com/users/vszakats/repos","events_url":"https://api.github.com/users/vszakats/events{/privacy}","received_events_url":"https://api.github.com/users/vszakats/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":887227423,"node_id":"MDU6TGFiZWw4ODcyMjc0MjM=","url":"https://api.github.com/repos/curl/curl/labels/tests","name":"tests","color":"a7a8e8","default":false,"description":""},{"id":2252760348,"node_id":"MDU6TGFiZWwyMjUyNzYwMzQ4","url":"https://api.github.com/repos/curl/curl/labels/CI","name":"CI","color":"ffb7ca","default":false,"description":"Continuous Integration"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-12-02T14:26:38Z","updated_at":"2023-12-02T20:18:29Z","closed_at":"2023-12-02T20:18:29Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\r\n\r\ntest1545 fails to compile in an AppVeyor CI jobs since:\r\n07a3cd83e0456ca17dfd8c3104af7cf45b7a1ff5 #12421:\r\nhttps://ci.appveyor.com/project/curlorg/curl/builds/48662893/job/ol8a78q9gmilb6wt#L1263\r\n\r\nDue to how PowerShell works (or due to me implementing this \r\npoorly), PowerShell just abruptly stops without leaving the details\r\nin the log:\r\n```\r\nThe running command stopped because the preference variable \r\n   \"ErrorActionPreference\" or common parameter is set to Stop:\r\nC:/projects/curl/tests/libtest/lib1545.c: In function 'test':\r\n```\r\nhttps://ci.appveyor.com/project/curlorg/curl/builds/48662115/job/oaos4h0nf8nvwvrp#L1183\r\n\r\nWhat is the way to tell PowerShell to show the full error and stop?\r\n\r\nCurrent `$ErrorActionPreference = 'Stop'` in `appveyor.yml`\r\nclearly stops but hides the error. `Continue` (the default) shows\r\nthe error but won't always stop.\r\n\r\nFor the full error see #12444, in which I left it to `Continue`, and which\r\nactually stopped in this particular case (but I've seen otherwise when\r\ntesting this in #12331):\r\n```\r\ncmake : C:/projects/curl/tests/libtest/lib1545.c: In function 'test':\r\nAt line:112 char:3\r\n+   cmake --build . --config $env:PRJ_CFG --parallel 2 --target testdep ...\r\n+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : NotSpecified: (C:/projects/cur...unction 'test'::String) [], RemoteException\r\n    + FullyQualifiedErrorId : NativeCommandError\r\n \r\nC:/projects/curl/tests/libtest/lib1545.c:38:3: error: 'curl_formadd' is deprecated: since 7.56.0. Use curl_mime_init() [-Werror=deprecated-declarations]\r\n   38 |   curl_formadd(&m_formpost, &lastptr, CURLFORM_COPYNAME, \"file\",\r\n      |   ^~~~~~~~~~~~\r\nIn file included from C:/projects/curl/tests/libtest/test.h:34,\r\n                 from C:/projects/curl/tests/libtest/lib1545.c:24:\r\nC:/projects/curl/include/curl/curl.h:2576:1: note: declared here\r\n 2576 | curl_formadd(struct curl_httppost **httppost,\r\n      | ^~~~~~~~~~~~\r\nC:/projects/curl/tests/libtest/lib1545.c:38:3: error: 'CURLFORM_COPYNAME' is deprecated: since 7.56.0. Use curl_mime_name() [-Werror=deprecated-declarations]\r\n   38 |   curl_formadd(&m_formpost, &lastptr, CURLFORM_COPYNAME, \"file\",\r\n      |   ^~~~~~~~~~~~\r\nC:/projects/curl/include/curl/curl.h:2501:3: note: declared here\r\n 2501 |   CURLFORM_COPYNAME        CURL_DEPRECATED(7.56.0, \"Use curl_mime_name()\"),\r\n      |   ^~~~~~~~~~~~~~~~~\r\nC:/projects/curl/tests/libtest/lib1545.c:39:16: error: 'CURLFORM_FILE' is deprecated: since 7.56.0. Use curl_mime_filedata() [-Werror=deprecated-declarations]\r\n   39 |                CURLFORM_FILE, \"missing-file\", CURLFORM_END);\r\n      |                ^~~~~~~~~~~~~\r\nC:/projects/curl/include/curl/curl.h:2510:3: note: declared here\r\n 2510 |   CURLFORM_FILE            CURL_DEPRECATED(7.56.0, \"Use curl_mime_filedata()\"),\r\n      |   ^~~~~~~~~~~~~\r\nC:/projects/curl/tests/libtest/lib1545.c:40:3: error: 'CURLOPT_HTTPPOST' is deprecated: since 7.56.0. Use CURLOPT_MIMEPOST [-Werror=deprecated-declarations]\r\n   40 |   curl_easy_setopt(eh, CURLOPT_HTTPPOST, m_formpost);\r\n      |   ^~~~~~~~~~~~~~~~\r\nC:/projects/curl/include/curl/curl.h:1190:21: note: declared here\r\n 1190 |   CURLOPTDEPRECATED(CURLOPT_HTTPPOST, CURLOPTTYPE_OBJECTPOINT, 24,\r\n      |                     ^~~~~~~~~~~~~~~~\r\nC:/projects/curl/include/curl/curl.h:1076:40: note: in definition of macro 'CURLOPTDEPRECATED'\r\n 1076 | #define CURLOPTDEPRECATED(na,t,nu,v,m) na CURL_DEPRECATED(v,m) = t + nu\r\n      |                                        ^~\r\nC:/projects/curl/tests/libtest/lib1545.c:47:3: error: 'curl_formfree' is deprecated: since 7.56.0. Use curl_mime_free() [-Werror=deprecated-declarations]\r\n   47 |   curl_formfree(m_formpost);\r\n      |   ^~~~~~~~~~~~~\r\nC:/projects/curl/include/curl/curl.h:2612:1: note: declared here\r\n 2612 | curl_formfree(struct curl_httppost *form);\r\n      | ^~~~~~~~~~~~~\r\ncc1.exe: all warnings being treated as errors\r\n```\r\n\r\nWhy only this single CI job? Possibly because that's the only \r\ngcc 13 one for Windows? Though we must have it for non-Windows\r\nin GHA and there is nothing Windows-specific in this.\r\n\r\n### I expected the following\r\n\r\nGreen CI\r\n\r\n### curl/libcurl version\r\n\r\nmaster / 0eda1f6c9f94b5ead1981f1510f1938ef3c0784b\r\n\r\n### operating system\r\n\r\nWindows","closed_by":{"login":"vszakats","id":1446897,"node_id":"MDQ6VXNlcjE0NDY4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1446897?v=4","gravatar_id":"","url":"https://api.github.com/users/vszakats","html_url":"https://github.com/vszakats","followers_url":"https://api.github.com/users/vszakats/followers","following_url":"https://api.github.com/users/vszakats/following{/other_user}","gists_url":"https://api.github.com/users/vszakats/gists{/gist_id}","starred_url":"https://api.github.com/users/vszakats/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vszakats/subscriptions","organizations_url":"https://api.github.com/users/vszakats/orgs","repos_url":"https://api.github.com/users/vszakats/repos","events_url":"https://api.github.com/users/vszakats/events{/privacy}","received_events_url":"https://api.github.com/users/vszakats/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/12445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/12445/timeline","performed_via_github_app":null,"state_reason":"completed"}