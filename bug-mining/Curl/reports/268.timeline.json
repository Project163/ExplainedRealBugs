[{"id":9435960366,"node_id":"MEE_lADOAAiu0c5n1yTFzwAAAAIybVQu","url":"https://api.github.com/repos/curl/curl/issues/events/9435960366","actor":{"login":"zajdee","id":24385036,"node_id":"MDQ6VXNlcjI0Mzg1MDM2","avatar_url":"https://avatars.githubusercontent.com/u/24385036?v=4","gravatar_id":"","url":"https://api.github.com/users/zajdee","html_url":"https://github.com/zajdee","followers_url":"https://api.github.com/users/zajdee/followers","following_url":"https://api.github.com/users/zajdee/following{/other_user}","gists_url":"https://api.github.com/users/zajdee/gists{/gist_id}","starred_url":"https://api.github.com/users/zajdee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zajdee/subscriptions","organizations_url":"https://api.github.com/users/zajdee/orgs","repos_url":"https://api.github.com/users/zajdee/repos","events_url":"https://api.github.com/users/zajdee/events{/privacy}","received_events_url":"https://api.github.com/users/zajdee/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-06-05T16:43:24Z","performed_via_github_app":null},{"id":9435960379,"node_id":"SE_lADOAAiu0c5n1yTFzwAAAAIybVQ7","url":"https://api.github.com/repos/curl/curl/issues/events/9435960379","actor":{"login":"zajdee","id":24385036,"node_id":"MDQ6VXNlcjI0Mzg1MDM2","avatar_url":"https://avatars.githubusercontent.com/u/24385036?v=4","gravatar_id":"","url":"https://api.github.com/users/zajdee","html_url":"https://github.com/zajdee","followers_url":"https://api.github.com/users/zajdee/followers","following_url":"https://api.github.com/users/zajdee/following{/other_user}","gists_url":"https://api.github.com/users/zajdee/gists{/gist_id}","starred_url":"https://api.github.com/users/zajdee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zajdee/subscriptions","organizations_url":"https://api.github.com/users/zajdee/orgs","repos_url":"https://api.github.com/users/zajdee/repos","events_url":"https://api.github.com/users/zajdee/events{/privacy}","received_events_url":"https://api.github.com/users/zajdee/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-06-05T16:43:24Z","performed_via_github_app":null},{"id":9436414145,"node_id":"REFE_lADOAAiu0c5n1yTFzwAAAAIydEDB","url":"https://api.github.com/repos/curl/curl/issues/events/9436414145","actor":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"eb5772f90ec9b60800204234dcd1146c7463a266","commit_url":"https://api.github.com/repos/stanhu/curl/commits/eb5772f90ec9b60800204234dcd1146c7463a266","created_at":"2023-06-05T17:32:36Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1577198715","html_url":"https://github.com/curl/curl/issues/11252#issuecomment-1577198715","issue_url":"https://api.github.com/repos/curl/curl/issues/11252","id":1577198715,"node_id":"IC_kwDOAAiu0c5eAiR7","user":{"login":"zajdee","id":24385036,"node_id":"MDQ6VXNlcjI0Mzg1MDM2","avatar_url":"https://avatars.githubusercontent.com/u/24385036?v=4","gravatar_id":"","url":"https://api.github.com/users/zajdee","html_url":"https://github.com/zajdee","followers_url":"https://api.github.com/users/zajdee/followers","following_url":"https://api.github.com/users/zajdee/following{/other_user}","gists_url":"https://api.github.com/users/zajdee/gists{/gist_id}","starred_url":"https://api.github.com/users/zajdee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zajdee/subscriptions","organizations_url":"https://api.github.com/users/zajdee/orgs","repos_url":"https://api.github.com/users/zajdee/repos","events_url":"https://api.github.com/users/zajdee/events{/privacy}","received_events_url":"https://api.github.com/users/zajdee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-05T17:32:40Z","updated_at":"2023-06-05T17:32:40Z","body":"We could move it to a global initialization function if that's what makes it safer.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1577198715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zajdee","id":24385036,"node_id":"MDQ6VXNlcjI0Mzg1MDM2","avatar_url":"https://avatars.githubusercontent.com/u/24385036?v=4","gravatar_id":"","url":"https://api.github.com/users/zajdee","html_url":"https://github.com/zajdee","followers_url":"https://api.github.com/users/zajdee/followers","following_url":"https://api.github.com/users/zajdee/following{/other_user}","gists_url":"https://api.github.com/users/zajdee/gists{/gist_id}","starred_url":"https://api.github.com/users/zajdee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zajdee/subscriptions","organizations_url":"https://api.github.com/users/zajdee/orgs","repos_url":"https://api.github.com/users/zajdee/repos","events_url":"https://api.github.com/users/zajdee/events{/privacy}","received_events_url":"https://api.github.com/users/zajdee/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9436417166,"node_id":"REFE_lADOAAiu0c5n1yTFzwAAAAIydEyO","url":"https://api.github.com/repos/curl/curl/issues/events/9436417166","actor":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"544f6154a79f5660f01f4020d5c69c502a9f7ac7","commit_url":"https://api.github.com/repos/stanhu/curl/commits/544f6154a79f5660f01f4020d5c69c502a9f7ac7","created_at":"2023-06-05T17:32:52Z","performed_via_github_app":null},{"actor":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-05T17:33:08Z","updated_at":"2023-06-05T17:33:08Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/curl/curl/issues/11254","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/11254/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/11254/comments","events_url":"https://api.github.com/repos/curl/curl/issues/11254/events","html_url":"https://github.com/curl/curl/pull/11254","id":1742228285,"node_id":"PR_kwDOAAiu0c5SOBBp","number":11254,"title":"src/hostip.c: Move macOS-specific calls into global init call","user":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2023-06-05T17:33:07Z","updated_at":"2023-07-09T17:18:09Z","closed_at":"2023-07-09T17:18:09Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":569041,"node_id":"MDEwOlJlcG9zaXRvcnk1NjkwNDE=","name":"curl","full_name":"curl/curl","private":false,"owner":{"login":"curl","id":16928085,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE2OTI4MDg1","avatar_url":"https://avatars.githubusercontent.com/u/16928085?v=4","gravatar_id":"","url":"https://api.github.com/users/curl","html_url":"https://github.com/curl","followers_url":"https://api.github.com/users/curl/followers","following_url":"https://api.github.com/users/curl/following{/other_user}","gists_url":"https://api.github.com/users/curl/gists{/gist_id}","starred_url":"https://api.github.com/users/curl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/curl/subscriptions","organizations_url":"https://api.github.com/users/curl/orgs","repos_url":"https://api.github.com/users/curl/repos","events_url":"https://api.github.com/users/curl/events{/privacy}","received_events_url":"https://api.github.com/users/curl/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/curl/curl","description":"A command line tool and library for transferring data with URL syntax, supporting DICT, FILE, FTP, FTPS, GOPHER, GOPHERS, HTTP, HTTPS, IMAP, IMAPS, LDAP, LDAPS, MQTT, POP3, POP3S, RTMP, RTMPS, RTSP, SCP, SFTP, SMB, SMBS, SMTP, SMTPS, TELNET, TFTP, WS and WSS. libcurl offers a myriad of powerful features","fork":false,"url":"https://api.github.com/repos/curl/curl","forks_url":"https://api.github.com/repos/curl/curl/forks","keys_url":"https://api.github.com/repos/curl/curl/keys{/key_id}","collaborators_url":"https://api.github.com/repos/curl/curl/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/curl/curl/teams","hooks_url":"https://api.github.com/repos/curl/curl/hooks","issue_events_url":"https://api.github.com/repos/curl/curl/issues/events{/number}","events_url":"https://api.github.com/repos/curl/curl/events","assignees_url":"https://api.github.com/repos/curl/curl/assignees{/user}","branches_url":"https://api.github.com/repos/curl/curl/branches{/branch}","tags_url":"https://api.github.com/repos/curl/curl/tags","blobs_url":"https://api.github.com/repos/curl/curl/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/curl/curl/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/curl/curl/git/refs{/sha}","trees_url":"https://api.github.com/repos/curl/curl/git/trees{/sha}","statuses_url":"https://api.github.com/repos/curl/curl/statuses/{sha}","languages_url":"https://api.github.com/repos/curl/curl/languages","stargazers_url":"https://api.github.com/repos/curl/curl/stargazers","contributors_url":"https://api.github.com/repos/curl/curl/contributors","subscribers_url":"https://api.github.com/repos/curl/curl/subscribers","subscription_url":"https://api.github.com/repos/curl/curl/subscription","commits_url":"https://api.github.com/repos/curl/curl/commits{/sha}","git_commits_url":"https://api.github.com/repos/curl/curl/git/commits{/sha}","comments_url":"https://api.github.com/repos/curl/curl/comments{/number}","issue_comment_url":"https://api.github.com/repos/curl/curl/issues/comments{/number}","contents_url":"https://api.github.com/repos/curl/curl/contents/{+path}","compare_url":"https://api.github.com/repos/curl/curl/compare/{base}...{head}","merges_url":"https://api.github.com/repos/curl/curl/merges","archive_url":"https://api.github.com/repos/curl/curl/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/curl/curl/downloads","issues_url":"https://api.github.com/repos/curl/curl/issues{/number}","pulls_url":"https://api.github.com/repos/curl/curl/pulls{/number}","milestones_url":"https://api.github.com/repos/curl/curl/milestones{/number}","notifications_url":"https://api.github.com/repos/curl/curl/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/curl/curl/labels{/name}","releases_url":"https://api.github.com/repos/curl/curl/releases{/id}","deployments_url":"https://api.github.com/repos/curl/curl/deployments","created_at":"2010-03-18T22:32:22Z","updated_at":"2025-11-10T09:41:55Z","pushed_at":"2025-11-10T12:18:24Z","git_url":"git://github.com/curl/curl.git","ssh_url":"git@github.com:curl/curl.git","clone_url":"https://github.com/curl/curl.git","svn_url":"https://github.com/curl/curl","homepage":"https://curl.se/","size":118458,"stargazers_count":39830,"watchers_count":39830,"language":"C","has_issues":true,"has_projects":false,"has_downloads":false,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6941,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":43,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["c","client","curl","ftp","gopher","hacktoberfest","http","https","imaps","ldap","libcurl","library","mqtt","pop3","scp","sftp","transfer-data","transferring-data","user-agent","websocket"],"visibility":"public","forks":6941,"open_issues":43,"watchers":39830,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/curl/curl/pulls/11254","html_url":"https://github.com/curl/curl/pull/11254","diff_url":"https://github.com/curl/curl/pull/11254.diff","patch_url":"https://github.com/curl/curl/pull/11254.patch","merged_at":null},"body":"https://github.com/curl/curl/pull/7121 introduced a macOS system call to `SCDynamicStoreCopyProxies`, which is invoked every time an IP address needs to be resolved.\r\n\r\nHowever, this system call is not thread-safe, and macOS will kill the process if the system call is run first in a fork. To make it possible for the parent process to call this once and prevent the crash, only invoke this system call in the global initialization routine.\r\n\r\nIn addition, this change is beneficial because it:\r\n\r\n1. Avoids extra macOS system calls for every IP lookup.\r\n2. Consolidates macOS-specific initialization in a separate file.\r\n\r\nCloses #11252","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/11254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/11254/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":9436453428,"node_id":"REFE_lADOAAiu0c5n1yTFzwAAAAIydNo0","url":"https://api.github.com/repos/curl/curl/issues/events/9436453428","actor":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"1d3c869659fc06b6d93fe52daa8927785b9a0455","commit_url":"https://api.github.com/repos/stanhu/curl/commits/1d3c869659fc06b6d93fe52daa8927785b9a0455","created_at":"2023-06-05T17:36:23Z","performed_via_github_app":null},{"id":9436503655,"node_id":"REFE_lADOAAiu0c5n1yTFzwAAAAIydZ5n","url":"https://api.github.com/repos/curl/curl/issues/events/9436503655","actor":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"d21e2b25a537594bd4459ecfcd232b5ca9b7c5e4","commit_url":"https://api.github.com/repos/stanhu/curl/commits/d21e2b25a537594bd4459ecfcd232b5ca9b7c5e4","created_at":"2023-06-05T17:42:33Z","performed_via_github_app":null},{"id":9436574945,"node_id":"REFE_lADOAAiu0c5n1yTFzwAAAAIydrTh","url":"https://api.github.com/repos/curl/curl/issues/events/9436574945","actor":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"0f93c7eaa40014e0b2e7575d833f53ba695fc9c9","commit_url":"https://api.github.com/repos/stanhu/curl/commits/0f93c7eaa40014e0b2e7575d833f53ba695fc9c9","created_at":"2023-06-05T17:50:40Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1577295432","html_url":"https://github.com/curl/curl/issues/11252#issuecomment-1577295432","issue_url":"https://api.github.com/repos/curl/curl/issues/11252","id":1577295432,"node_id":"IC_kwDOAAiu0c5eA55I","user":{"login":"jay","id":965580,"node_id":"MDQ6VXNlcjk2NTU4MA==","avatar_url":"https://avatars.githubusercontent.com/u/965580?v=4","gravatar_id":"","url":"https://api.github.com/users/jay","html_url":"https://github.com/jay","followers_url":"https://api.github.com/users/jay/followers","following_url":"https://api.github.com/users/jay/following{/other_user}","gists_url":"https://api.github.com/users/jay/gists{/gist_id}","starred_url":"https://api.github.com/users/jay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jay/subscriptions","organizations_url":"https://api.github.com/users/jay/orgs","repos_url":"https://api.github.com/users/jay/repos","events_url":"https://api.github.com/users/jay/events{/privacy}","received_events_url":"https://api.github.com/users/jay/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-05T18:50:23Z","updated_at":"2023-06-05T18:50:23Z","body":"Isn't this a forking issue, not a libcurl issue? I don't think we can guarantee forking behavior. See also #788 #6968","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1577295432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jay","id":965580,"node_id":"MDQ6VXNlcjk2NTU4MA==","avatar_url":"https://avatars.githubusercontent.com/u/965580?v=4","gravatar_id":"","url":"https://api.github.com/users/jay","html_url":"https://github.com/jay","followers_url":"https://api.github.com/users/jay/followers","following_url":"https://api.github.com/users/jay/following{/other_user}","gists_url":"https://api.github.com/users/jay/gists{/gist_id}","starred_url":"https://api.github.com/users/jay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jay/subscriptions","organizations_url":"https://api.github.com/users/jay/orgs","repos_url":"https://api.github.com/users/jay/repos","events_url":"https://api.github.com/users/jay/events{/privacy}","received_events_url":"https://api.github.com/users/jay/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1577305761","html_url":"https://github.com/curl/curl/issues/11252#issuecomment-1577305761","issue_url":"https://api.github.com/repos/curl/curl/issues/11252","id":1577305761,"node_id":"IC_kwDOAAiu0c5eA8ah","user":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-05T18:58:46Z","updated_at":"2023-06-05T18:59:22Z","body":"Ultimately it is a forking issue, but I'd argue that https://github.com/curl/curl/pull/11254 would be useful anyways because:\r\n\r\n1. It avoids extra macOS system calls for every IP lookup.\r\n2. Consolidates macOS-specific initialization in a separate file/function.\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1577305761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9488057791,"node_id":"REFE_lADOAAiu0c5n1yTFzwAAAAI1iEW_","url":"https://api.github.com/repos/curl/curl/issues/events/9488057791","actor":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ddae69e0730ae3b39e906660d6ffb763909ada1f","commit_url":"https://api.github.com/repos/stanhu/curl/commits/ddae69e0730ae3b39e906660d6ffb763909ada1f","created_at":"2023-06-09T20:45:42Z","performed_via_github_app":null},{"actor":{"login":"Totktonada","id":92749,"node_id":"MDQ6VXNlcjkyNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/92749?v=4","gravatar_id":"","url":"https://api.github.com/users/Totktonada","html_url":"https://github.com/Totktonada","followers_url":"https://api.github.com/users/Totktonada/followers","following_url":"https://api.github.com/users/Totktonada/following{/other_user}","gists_url":"https://api.github.com/users/Totktonada/gists{/gist_id}","starred_url":"https://api.github.com/users/Totktonada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Totktonada/subscriptions","organizations_url":"https://api.github.com/users/Totktonada/orgs","repos_url":"https://api.github.com/users/Totktonada/repos","events_url":"https://api.github.com/users/Totktonada/events{/privacy}","received_events_url":"https://api.github.com/users/Totktonada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-30T21:30:21Z","updated_at":"2023-06-30T21:30:21Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/tarantool/tarantool/issues/8828","repository_url":"https://api.github.com/repos/tarantool/tarantool","labels_url":"https://api.github.com/repos/tarantool/tarantool/issues/8828/labels{/name}","comments_url":"https://api.github.com/repos/tarantool/tarantool/issues/8828/comments","events_url":"https://api.github.com/repos/tarantool/tarantool/issues/8828/events","html_url":"https://github.com/tarantool/tarantool/issues/8828","id":1782718397,"node_id":"I_kwDOAA3qbM5qQh-9","number":8828,"title":"Node ran with tarantoolctl crashes after 2 minutes on Mac","user":{"login":"qubiq1337","id":25990090,"node_id":"MDQ6VXNlcjI1OTkwMDkw","avatar_url":"https://avatars.githubusercontent.com/u/25990090?v=4","gravatar_id":"","url":"https://api.github.com/users/qubiq1337","html_url":"https://github.com/qubiq1337","followers_url":"https://api.github.com/users/qubiq1337/followers","following_url":"https://api.github.com/users/qubiq1337/following{/other_user}","gists_url":"https://api.github.com/users/qubiq1337/gists{/gist_id}","starred_url":"https://api.github.com/users/qubiq1337/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qubiq1337/subscriptions","organizations_url":"https://api.github.com/users/qubiq1337/orgs","repos_url":"https://api.github.com/users/qubiq1337/repos","events_url":"https://api.github.com/users/qubiq1337/events{/privacy}","received_events_url":"https://api.github.com/users/qubiq1337/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[{"login":"sergepetrenko","id":35663196,"node_id":"MDQ6VXNlcjM1NjYzMTk2","avatar_url":"https://avatars.githubusercontent.com/u/35663196?v=4","gravatar_id":"","url":"https://api.github.com/users/sergepetrenko","html_url":"https://github.com/sergepetrenko","followers_url":"https://api.github.com/users/sergepetrenko/followers","following_url":"https://api.github.com/users/sergepetrenko/following{/other_user}","gists_url":"https://api.github.com/users/sergepetrenko/gists{/gist_id}","starred_url":"https://api.github.com/users/sergepetrenko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergepetrenko/subscriptions","organizations_url":"https://api.github.com/users/sergepetrenko/orgs","repos_url":"https://api.github.com/users/sergepetrenko/repos","events_url":"https://api.github.com/users/sergepetrenko/events{/privacy}","received_events_url":"https://api.github.com/users/sergepetrenko/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":7,"created_at":"2023-06-29T10:03:59Z","updated_at":"2023-11-23T08:45:20Z","closed_at":"2023-09-21T11:57:35Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":911980,"node_id":"MDEwOlJlcG9zaXRvcnk5MTE5ODA=","name":"tarantool","full_name":"tarantool/tarantool","private":false,"owner":{"login":"tarantool","id":2344919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIzNDQ5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/2344919?v=4","gravatar_id":"","url":"https://api.github.com/users/tarantool","html_url":"https://github.com/tarantool","followers_url":"https://api.github.com/users/tarantool/followers","following_url":"https://api.github.com/users/tarantool/following{/other_user}","gists_url":"https://api.github.com/users/tarantool/gists{/gist_id}","starred_url":"https://api.github.com/users/tarantool/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tarantool/subscriptions","organizations_url":"https://api.github.com/users/tarantool/orgs","repos_url":"https://api.github.com/users/tarantool/repos","events_url":"https://api.github.com/users/tarantool/events{/privacy}","received_events_url":"https://api.github.com/users/tarantool/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/tarantool/tarantool","description":"Get your data in RAM. Get compute close to data. Enjoy the performance.","fork":false,"url":"https://api.github.com/repos/tarantool/tarantool","forks_url":"https://api.github.com/repos/tarantool/tarantool/forks","keys_url":"https://api.github.com/repos/tarantool/tarantool/keys{/key_id}","collaborators_url":"https://api.github.com/repos/tarantool/tarantool/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/tarantool/tarantool/teams","hooks_url":"https://api.github.com/repos/tarantool/tarantool/hooks","issue_events_url":"https://api.github.com/repos/tarantool/tarantool/issues/events{/number}","events_url":"https://api.github.com/repos/tarantool/tarantool/events","assignees_url":"https://api.github.com/repos/tarantool/tarantool/assignees{/user}","branches_url":"https://api.github.com/repos/tarantool/tarantool/branches{/branch}","tags_url":"https://api.github.com/repos/tarantool/tarantool/tags","blobs_url":"https://api.github.com/repos/tarantool/tarantool/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/tarantool/tarantool/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/tarantool/tarantool/git/refs{/sha}","trees_url":"https://api.github.com/repos/tarantool/tarantool/git/trees{/sha}","statuses_url":"https://api.github.com/repos/tarantool/tarantool/statuses/{sha}","languages_url":"https://api.github.com/repos/tarantool/tarantool/languages","stargazers_url":"https://api.github.com/repos/tarantool/tarantool/stargazers","contributors_url":"https://api.github.com/repos/tarantool/tarantool/contributors","subscribers_url":"https://api.github.com/repos/tarantool/tarantool/subscribers","subscription_url":"https://api.github.com/repos/tarantool/tarantool/subscription","commits_url":"https://api.github.com/repos/tarantool/tarantool/commits{/sha}","git_commits_url":"https://api.github.com/repos/tarantool/tarantool/git/commits{/sha}","comments_url":"https://api.github.com/repos/tarantool/tarantool/comments{/number}","issue_comment_url":"https://api.github.com/repos/tarantool/tarantool/issues/comments{/number}","contents_url":"https://api.github.com/repos/tarantool/tarantool/contents/{+path}","compare_url":"https://api.github.com/repos/tarantool/tarantool/compare/{base}...{head}","merges_url":"https://api.github.com/repos/tarantool/tarantool/merges","archive_url":"https://api.github.com/repos/tarantool/tarantool/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/tarantool/tarantool/downloads","issues_url":"https://api.github.com/repos/tarantool/tarantool/issues{/number}","pulls_url":"https://api.github.com/repos/tarantool/tarantool/pulls{/number}","milestones_url":"https://api.github.com/repos/tarantool/tarantool/milestones{/number}","notifications_url":"https://api.github.com/repos/tarantool/tarantool/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/tarantool/tarantool/labels{/name}","releases_url":"https://api.github.com/repos/tarantool/tarantool/releases{/id}","deployments_url":"https://api.github.com/repos/tarantool/tarantool/deployments","created_at":"2010-09-15T07:59:26Z","updated_at":"2025-11-10T08:10:31Z","pushed_at":"2025-11-10T07:28:30Z","git_url":"git://github.com/tarantool/tarantool.git","ssh_url":"git@github.com:tarantool/tarantool.git","clone_url":"https://github.com/tarantool/tarantool.git","svn_url":"https://github.com/tarantool/tarantool","homepage":"https://www.tarantool.io","size":129254,"stargazers_count":3580,"watchers_count":3580,"language":"Lua","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":395,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1535,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["appserver","database","disk","in-memory","lua","msgpack","tarantool","transactions"],"visibility":"public","forks":395,"open_issues":1535,"watchers":3580,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"**Bug description**\r\n\r\nTarantool crashes after 2 minutes if run via tarantoolctl on Mac.\r\n\r\nOS: MacOS 13.4\r\nTarantool version:\r\n```\r\nTarantool 3.0.0-entrypoint-439-g47380bb76\r\nTarget: Darwin-x86_64-Debug\r\nBuild options: cmake . -DCMAKE_INSTALL_PREFIX=/usr/local -DENABLE_BACKTRACE=TRUE\r\nCompiler: Clang-14.0.0.14000029\r\nC_FLAGS: -fexceptions -funwind-tables -fasynchronous-unwind-tables -fno-common -msse2 -Wformat -Wformat-security -Werror=format-security -fstack-protector-strong -fPIC -fmacro-prefix-map=/Users/s.petrenko/Source/sptnt=. -std=c11 -Wall -Wextra -Wno-gnu-alignof-expression -Wno-cast-function-type -Werror\r\nCXX_FLAGS: -fexceptions -funwind-tables -fasynchronous-unwind-tables -fno-common -msse2 -Wformat -Wformat-security -Werror=format-security -fstack-protector-strong -fPIC -fmacro-prefix-map=/Users/s.petrenko/Source/sptnt=. -std=c++11 -Wall -Wextra -Wno-invalid-offsetof -Wno-gnu-alignof-expression -Wno-cast-function-type -Werror\r\n```\r\n\r\n**Steps to reproduce:**\r\n1. Build and install tarantool **without** the bundled libcurl: `cmake . -DENABLE_BUNDLED_LIBCURL=OFF -DENABLE_DIST=ON && make -j install`\r\n2. Create a test file `test.lua`:\r\n\r\n```lua\r\nbox.cfg{\r\n    listen = '127.0.0.1:3301',\r\n    log = 'test.log'\r\n}\r\n```\r\n\r\n3. Run `tarantoolctl start test`\r\n4. Wait for ~ 2 minutes and check the logs:\r\n```\r\nexample git:(master) âœ— tail -f test.log \r\n2023-06-30 17:27:39.783 [99962] main/103/test I> update replication_synchro_quorum = 1\r\n2023-06-30 17:27:39.785 [99962] main/103/test I> replicaset uuid 18cedcba-0723-41d2-9363-2e0e1d066933\r\n2023-06-30 17:27:39.788 [99962] snapshot/101/main I> saving snapshot `./data/test/00000000000000000000.snap.inprogress'\r\n2023-06-30 17:27:39.792 [99962] snapshot/101/main I> done\r\n2023-06-30 17:27:39.794 [99962] main/103/test I> ready to accept requests\r\n2023-06-30 17:27:39.794 [99962] main/105/gc I> wal/engine cleanup is resumed\r\n2023-06-30 17:27:39.795 [99962] main/103/test/box.load_cfg I> set 'log' configuration option to \"./test.log\"\r\n2023-06-30 17:27:39.796 [99962] main/103/test/box.load_cfg I> set 'listen' configuration option to \"127.0.0.1:3301\"\r\n2023-06-30 17:27:39.798 [99962] main/106/checkpoint_daemon I> scheduled next checkpoint for Fri Jun 30 19:00:34 2023\r\n2023-06-30 17:27:39.799 [99962] main I> entering the event loop\r\nobjc[99962]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called.\r\nobjc[99962]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.\r\n```\r\n\r\nNote, the issue isn't reproduced when Tarantool is built **with** bundled libcurl. Current bundled libcurl version is 7.87.0 while the system one on my machine is 7.88.1.\r\n\r\n<details><summary>Original description as reported in Vshard repo</summary>\r\n\r\n**Bug description**\r\n\r\nTarantool router and storage instances crash after 2-3 minutes of running without any load.\r\n\r\nOS: MacOS\r\nOS Version: 13.3 (22E252) (Darwin Kernel Version 22.4.0)\r\nArchitecture: amd64\r\nTarantool 2.11.0-0-g247a9a4 installed via brew\r\nTarget: Darwin-x86_64-Release\r\nBuild options: cmake . -DCMAKE_INSTALL_PREFIX=/usr/local/Cellar/tarantool/2.11.0_1 -DENABLE_BACKTRACE=TRUE\r\nCompiler: /usr/bin/clang /usr/bin/clang++\r\nC_FLAGS: -fexceptions -funwind-tables -fasynchronous-unwind-tables -fno-common -fopenmp -msse2 -Wformat -Wformat-security -Werror=format-security -fstack-protector-strong -fPIC -fmacro-prefix-map=/tmp/tarantool-20230615-7372-1i4nu9c/tarantool-2.11.0=. -std=c11 -Wall -Wextra -Wno-gnu-alignof-expression -Wno-cast-function-type\r\nCXX_FLAGS: -fexceptions -funwind-tables -fasynchronous-unwind-tables -fno-common -fopenmp -msse2 -Wformat -Wformat-security -Werror=format-security -fstack-protector-strong -fPIC -fmacro-prefix-map=/tmp/tarantool-20230615-7372-1i4nu9c/tarantool-2.11.0=. -std=c++11 -Wall -Wextra -Wno-invalid-offsetof -Wno-gnu-alignof-expression -Wno-cast-function-type\r\n\r\n**Steps to reproduce**\r\n```\r\ncd vshard/example\r\nmake\r\n```\r\nWait 2-3 minutes\r\n```\r\nmake logcat\r\n==> data/router_1.log <==\r\n2023-06-29 12:51:20.473 [8945] main/118/vshard.failover._static_router/vshard.router I> New replica storage_1_a(storage@127.0.0.1:3301) for replicaset(uuid=\"cbf06940-0790-498b-948d-042b62cf3d29\", master=storage_1_a(storage@127.0.0.1:3301))\r\n2023-06-29 12:51:20.473 [8945] main/118/vshard.failover._static_router/vshard.router I> Failovering step is finished. Schedule next after 1.000000 seconds\r\n2023-06-29 12:51:20.494 [8945] main/119/vshard.discovery._static_router/vshard.router I> Updated replicaset(uuid=\"ac522f65-aa94-4134-9f64-51ee384f1a54\", master=storage_2_a(storage@127.0.0.1:3303)) buckets: was 0, became 1000\r\n2023-06-29 12:51:20.509 [8945] main/119/vshard.discovery._static_router/vshard.router I> Updated replicaset(uuid=\"cbf06940-0790-498b-948d-042b62cf3d29\", master=storage_1_a(storage@127.0.0.1:3301)) buckets: was 0, became 1000\r\n2023-06-29 12:51:21.474 [8945] main/118/vshard.failover._static_router/vshard.router I> All replicas are ok\r\n2023-06-29 12:51:21.529 [8945] main/119/vshard.discovery._static_router/vshard.router I> Updated replicaset(uuid=\"ac522f65-aa94-4134-9f64-51ee384f1a54\", master=storage_2_a(storage@127.0.0.1:3303)) buckets: was 1000, became 1500\r\n2023-06-29 12:51:21.529 [8945] main/119/vshard.discovery._static_router/vshard.router I> Updated replicaset(uuid=\"cbf06940-0790-498b-948d-042b62cf3d29\", master=storage_1_a(storage@127.0.0.1:3301)) buckets: was 1000, became 1500\r\n2023-06-29 12:51:21.529 [8945] main/119/vshard.discovery._static_router/vshard.router I> Discovery enters idle mode, all buckets are known. Discovery works with 10 seconds interval now\r\nobjc[8945]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called.\r\nobjc[8945]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.\r\n\r\n==> data/storage_1_a.log <==\r\n2023-06-29 12:51:19.227 [8917] main/110/main I> subscribed replica 3de2e3e1-9ebe-4d0d-abb1-26d301b84633 at fd 22, aka 127.0.0.1:3301, peer of 127.0.0.1:53724\r\n2023-06-29 12:51:19.227 [8917] main/110/main I> remote vclock {1: 71} local vclock {1: 71}\r\n2023-06-29 12:51:19.228 [8917] relay/127.0.0.1:53724/101/main I> recover from `./data/storage_1_a/00000000000000000058.xlog'\r\n2023-06-29 12:51:20.147 [8917] main/111/applier/storage@127.0.0.1:3302 I> authenticated\r\n2023-06-29 12:51:20.147 [8917] main/111/applier/storage@127.0.0.1:3302 I> subscribed\r\n2023-06-29 12:51:20.147 [8917] main/111/applier/storage@127.0.0.1:3302 I> remote vclock {1: 3071} local vclock {1: 3071}\r\n2023-06-29 12:51:20.147 [8917] main/111/applier/storage@127.0.0.1:3302 I> RAFT: message {term: 1, state: follower} from 2\r\n2023-06-29 12:51:20.149 [8917] main/111/applier/storage@127.0.0.1:3302 I> leaving orphan mode\r\nobjc[8917]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called.\r\nobjc[8917]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.\r\n\r\n==> data/storage_1_b.log <==\r\n2023-06-29 12:51:20.147 [8924] main/110/main I> remote vclock {1: 3071} local vclock {1: 3071}\r\n2023-06-29 12:51:20.147 [8924] main/105/gc I> wal/engine cleanup is resumed\r\n2023-06-29 12:51:20.148 [8924] relay/127.0.0.1:53738/101/main I> recover from `./data/storage_1_b/00000000000000000071.xlog'\r\n2023-06-29 12:53:19.148 [8924] main/112/applier/storage@127.0.0.1:3301 I> can't read row\r\n2023-06-29 12:53:19.148 [8924] main/112/applier/storage@127.0.0.1:3301 coio.c:349 E> SocketError: unexpected EOF when reading from socket, called on fd 22, aka 127.0.0.1:53724, peer of 127.0.0.1:3301: Broken pipe\r\n2023-06-29 12:53:19.148 [8924] main/112/applier/storage@127.0.0.1:3301 I> will retry every 1.00 second\r\n2023-06-29 12:53:19.148 [8924] relay/127.0.0.1:53738/101/main coio.c:349 E> SocketError: unexpected EOF when reading from socket, called on fd 24, aka 127.0.0.1:3302, peer of 127.0.0.1:53738: Broken pipe\r\n2023-06-29 12:53:19.148 [8924] relay/127.0.0.1:53738/101/main I> exiting the relay loop\r\nobjc[8924]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called.\r\nobjc[8924]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.\r\n\r\n==> data/storage_2_a.log <==\r\n2023-06-29 12:51:20.312 [8931] main/112/applier/storage@127.0.0.1:3304 I> authenticated\r\n2023-06-29 12:51:20.312 [8931] main/112/applier/storage@127.0.0.1:3304 I> subscribed\r\n2023-06-29 12:51:20.312 [8931] main/112/applier/storage@127.0.0.1:3304 I> remote vclock {1: 3071} local vclock {1: 3071}\r\n2023-06-29 12:51:20.312 [8931] main/112/applier/storage@127.0.0.1:3304 I> RAFT: message {term: 1, state: follower} from 2\r\n2023-06-29 12:51:20.313 [8931] main/112/applier/storage@127.0.0.1:3304 I> leaving orphan mode\r\n2023-06-29 12:51:29.326 [8931] main/121/vshard.rebalancer/vshard.storage I> The cluster is balanced ok. Schedule next rebalancing after 3600.000000 seconds\r\n2023-06-29 12:53:19.148 [8931] main/124/127.0.0.1:3301 (net.box)/vshard.replicaset I> disconnected from 127.0.0.1:3301\r\n2023-06-29 12:53:19.148 [8931] main/124/127.0.0.1:3301 (net.box)/box.net_box net_box.lua:358 W> 127.0.0.1:3301: Peer closed\r\nobjc[8931]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called.\r\nobjc[8931]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.\r\n\r\n==> data/storage_2_b.log <==\r\n2023-06-29 12:51:20.312 [8938] main/110/main I> remote vclock {1: 3071} local vclock {1: 3071}\r\n2023-06-29 12:51:20.312 [8938] main/105/gc I> wal/engine cleanup is resumed\r\n2023-06-29 12:51:20.313 [8938] relay/127.0.0.1:53740/101/main I> recover from `./data/storage_2_b/00000000000000000071.xlog'\r\n2023-06-29 12:53:19.312 [8938] main/111/applier/storage@127.0.0.1:3303 I> can't read row\r\n2023-06-29 12:53:19.312 [8938] relay/127.0.0.1:53740/101/main coio.c:349 E> SocketError: unexpected EOF when reading from socket, called on fd 24, aka 127.0.0.1:3304, peer of 127.0.0.1:53740: Broken pipe\r\n2023-06-29 12:53:19.312 [8938] relay/127.0.0.1:53740/101/main I> exiting the relay loop\r\n2023-06-29 12:53:19.312 [8938] main/111/applier/storage@127.0.0.1:3303 coio.c:349 E> SocketError: unexpected EOF when reading from socket, called on fd 21, aka 127.0.0.1:53730, peer of 127.0.0.1:3303: Broken pipe\r\n2023-06-29 12:53:19.312 [8938] main/111/applier/storage@127.0.0.1:3303 I> will retry every 1.00 second\r\nobjc[8938]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called.\r\nobjc[8938]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.\r\n^Cmake: *** [logcat] Interrupt: 2\r\n```\r\n\r\n</details>\r\n","reactions":{"url":"https://api.github.com/repos/tarantool/tarantool/issues/8828/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tarantool/tarantool/issues/8828/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":9767578517,"node_id":"CE_lADOAAiu0c5n1yTFzwAAAAJGMWuV","url":"https://api.github.com/repos/curl/curl/issues/events/9767578517","actor":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"c7308592fb8ba213fc2c1bb6ad39781df45bd84a","commit_url":"https://api.github.com/repos/curl/curl/commits/c7308592fb8ba213fc2c1bb6ad39781df45bd84a","created_at":"2023-07-09T17:18:08Z","state_reason":null,"performed_via_github_app":null},{"id":9866882116,"node_id":"REFE_lADOAAiu0c5n1yTFzwAAAAJMHKxE","url":"https://api.github.com/repos/curl/curl/issues/events/9866882116","actor":{"login":"bch","id":122211,"node_id":"MDQ6VXNlcjEyMjIxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/122211?v=4","gravatar_id":"","url":"https://api.github.com/users/bch","html_url":"https://github.com/bch","followers_url":"https://api.github.com/users/bch/followers","following_url":"https://api.github.com/users/bch/following{/other_user}","gists_url":"https://api.github.com/users/bch/gists{/gist_id}","starred_url":"https://api.github.com/users/bch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bch/subscriptions","organizations_url":"https://api.github.com/users/bch/orgs","repos_url":"https://api.github.com/users/bch/repos","events_url":"https://api.github.com/users/bch/events{/privacy}","received_events_url":"https://api.github.com/users/bch/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"80739cb7395249350d0949350f6d183d36ab9d18","commit_url":"https://api.github.com/repos/bch/curl/commits/80739cb7395249350d0949350f6d183d36ab9d18","created_at":"2023-07-19T20:02:27Z","performed_via_github_app":null},{"id":10459069499,"node_id":"REFE_lADOAAiu0c5n1yTFzwAAAAJvaLw7","url":"https://api.github.com/repos/curl/curl/issues/events/10459069499","actor":{"login":"ptitSeb","id":3250792,"node_id":"MDQ6VXNlcjMyNTA3OTI=","avatar_url":"https://avatars.githubusercontent.com/u/3250792?v=4","gravatar_id":"","url":"https://api.github.com/users/ptitSeb","html_url":"https://github.com/ptitSeb","followers_url":"https://api.github.com/users/ptitSeb/followers","following_url":"https://api.github.com/users/ptitSeb/following{/other_user}","gists_url":"https://api.github.com/users/ptitSeb/gists{/gist_id}","starred_url":"https://api.github.com/users/ptitSeb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ptitSeb/subscriptions","organizations_url":"https://api.github.com/users/ptitSeb/orgs","repos_url":"https://api.github.com/users/ptitSeb/repos","events_url":"https://api.github.com/users/ptitSeb/events{/privacy}","received_events_url":"https://api.github.com/users/ptitSeb/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"21c84fec3d0acce8702080e277e4d0e613ef5c9f","commit_url":"https://api.github.com/repos/wasix-org/curl/commits/21c84fec3d0acce8702080e277e4d0e613ef5c9f","created_at":"2023-09-25T08:04:31Z","performed_via_github_app":null},{"actor":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-08T18:19:00Z","updated_at":"2024-01-08T18:19:00Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/elastic/elasticsearch-ruby/issues/2244","repository_url":"https://api.github.com/repos/elastic/elasticsearch-ruby","labels_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/issues/2244/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/issues/2244/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/issues/2244/events","html_url":"https://github.com/elastic/elasticsearch-ruby/issues/2244","id":1997803573,"node_id":"I_kwDOAJYCvc53FBA1","number":2244,"title":"Segfault when using elasticsearch within spring on MacOS 14.1.1","user":{"login":"dvandersluis","id":57964,"node_id":"MDQ6VXNlcjU3OTY0","avatar_url":"https://avatars.githubusercontent.com/u/57964?v=4","gravatar_id":"","url":"https://api.github.com/users/dvandersluis","html_url":"https://github.com/dvandersluis","followers_url":"https://api.github.com/users/dvandersluis/followers","following_url":"https://api.github.com/users/dvandersluis/following{/other_user}","gists_url":"https://api.github.com/users/dvandersluis/gists{/gist_id}","starred_url":"https://api.github.com/users/dvandersluis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dvandersluis/subscriptions","organizations_url":"https://api.github.com/users/dvandersluis/orgs","repos_url":"https://api.github.com/users/dvandersluis/repos","events_url":"https://api.github.com/users/dvandersluis/events{/privacy}","received_events_url":"https://api.github.com/users/dvandersluis/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2023-11-16T21:20:24Z","updated_at":"2024-01-08T22:36:45Z","closed_at":null,"author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":9831101,"node_id":"MDEwOlJlcG9zaXRvcnk5ODMxMTAx","name":"elasticsearch-ruby","full_name":"elastic/elasticsearch-ruby","private":false,"owner":{"login":"elastic","id":6764390,"node_id":"MDEyOk9yZ2FuaXphdGlvbjY3NjQzOTA=","avatar_url":"https://avatars.githubusercontent.com/u/6764390?v=4","gravatar_id":"","url":"https://api.github.com/users/elastic","html_url":"https://github.com/elastic","followers_url":"https://api.github.com/users/elastic/followers","following_url":"https://api.github.com/users/elastic/following{/other_user}","gists_url":"https://api.github.com/users/elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elastic/subscriptions","organizations_url":"https://api.github.com/users/elastic/orgs","repos_url":"https://api.github.com/users/elastic/repos","events_url":"https://api.github.com/users/elastic/events{/privacy}","received_events_url":"https://api.github.com/users/elastic/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/elastic/elasticsearch-ruby","description":"Ruby integrations for Elasticsearch","fork":false,"url":"https://api.github.com/repos/elastic/elasticsearch-ruby","forks_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/forks","keys_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/keys{/key_id}","collaborators_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/teams","hooks_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/hooks","issue_events_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/issues/events{/number}","events_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/events","assignees_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/assignees{/user}","branches_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/branches{/branch}","tags_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/tags","blobs_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/git/refs{/sha}","trees_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/git/trees{/sha}","statuses_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/statuses/{sha}","languages_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/languages","stargazers_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/stargazers","contributors_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/contributors","subscribers_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/subscribers","subscription_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/subscription","commits_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/commits{/sha}","git_commits_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/git/commits{/sha}","comments_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/comments{/number}","issue_comment_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/issues/comments{/number}","contents_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/contents/{+path}","compare_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/compare/{base}...{head}","merges_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/merges","archive_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/downloads","issues_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/issues{/number}","pulls_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/pulls{/number}","milestones_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/milestones{/number}","notifications_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/labels{/name}","releases_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/releases{/id}","deployments_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/deployments","created_at":"2013-05-03T07:39:25Z","updated_at":"2025-11-07T11:24:52Z","pushed_at":"2025-11-10T10:24:27Z","git_url":"git://github.com/elastic/elasticsearch-ruby.git","ssh_url":"git@github.com:elastic/elasticsearch-ruby.git","clone_url":"https://github.com/elastic/elasticsearch-ruby.git","svn_url":"https://github.com/elastic/elasticsearch-ruby","homepage":"https://www.elastic.co/docs/reference/elasticsearch/clients/ruby","size":18556,"stargazers_count":1980,"watchers_count":1980,"language":"Ruby","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":616,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":11,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["client","elastic","elasticsearch","ruby","rubynlp","search"],"visibility":"public","forks":616,"open_issues":11,"watchers":1980,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"**Describe the bug/error/problem**\r\nIf an elasticsearch command is run within spring, the process segfaults with the following error:\r\n\r\n```\r\nobjc[20558]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called.\r\nobjc[20558]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n\r\n- Have Elasticsearch running on localhost:9200 on a newer version of MacOS\r\n- Create a minimal rails application with `spring` and `elasticsearch` in the Gemfile\r\n- Run `bundle install`\r\n- Run `rails console`\r\n- Enter the following in the REPL:\r\n    ```ruby\r\n    client = Elasticsearch::Client.new\r\n    client.ping\r\n    ```\r\n- The process will segfault with the above error.\r\n\r\n**Expected behavior**\r\nUsing elasticsearch within the Rails console should not segfault.\r\n\r\n**Your Environment (please complete the following information):**\r\n - Operating System: MacOS 14.1.1 (23B81)\r\n - Ruby Version: ruby 3.1.4p223\r\n - Elasticsearch client version: 7.12.0, also tried 8.11.0\r\n - Elasticsearch version: 7.3.2\r\n - Any other relevant information\r\n\r\n**Additional context**\r\n\r\nThis is likely related to a lot of other issues such as:\r\n* https://github.com/rails/rails/issues/38560\r\n* https://github.com/rails/spring/issues/606\r\n* https://github.com/ged/ruby-pg/issues/538\r\n\r\nAn older article may be relevant too: https://blog.phusion.nl/2017/10/13/why-ruby-app-servers-break-on-macos-high-sierra-and-what-can-be-done-about-it/\r\n\r\nAdding `export OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES` in `.bash_profile` is often given as a workaround but it's unclear that this is a safe workaround and not just a bandaid.\r\n","reactions":{"url":"https://api.github.com/repos/elastic/elasticsearch-ruby/issues/2244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/elastic/elasticsearch-ruby/issues/2244/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-08T19:57:49Z","updated_at":"2024-01-08T19:57:49Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rails/rails/issues/38560","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/38560/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/38560/comments","events_url":"https://api.github.com/repos/rails/rails/issues/38560/events","html_url":"https://github.com/rails/rails/issues/38560","id":569624293,"node_id":"MDU6SXNzdWU1Njk2MjQyOTM=","number":38560,"title":"[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called","user":{"login":"conradwt","id":20219,"node_id":"MDQ6VXNlcjIwMjE5","avatar_url":"https://avatars.githubusercontent.com/u/20219?v=4","gravatar_id":"","url":"https://api.github.com/users/conradwt","html_url":"https://github.com/conradwt","followers_url":"https://api.github.com/users/conradwt/followers","following_url":"https://api.github.com/users/conradwt/following{/other_user}","gists_url":"https://api.github.com/users/conradwt/gists{/gist_id}","starred_url":"https://api.github.com/users/conradwt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/conradwt/subscriptions","organizations_url":"https://api.github.com/users/conradwt/orgs","repos_url":"https://api.github.com/users/conradwt/repos","events_url":"https://api.github.com/users/conradwt/events{/privacy}","received_events_url":"https://api.github.com/users/conradwt/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":12449438,"node_id":"MDU6TGFiZWwxMjQ0OTQzOA==","url":"https://api.github.com/repos/rails/rails/labels/stale","name":"stale","color":"444444","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":110,"created_at":"2020-02-24T04:01:51Z","updated_at":"2025-10-09T03:30:00Z","closed_at":"2025-10-09T03:30:00Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":8514,"node_id":"MDEwOlJlcG9zaXRvcnk4NTE0","name":"rails","full_name":"rails/rails","private":false,"owner":{"login":"rails","id":4223,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQyMjM=","avatar_url":"https://avatars.githubusercontent.com/u/4223?v=4","gravatar_id":"","url":"https://api.github.com/users/rails","html_url":"https://github.com/rails","followers_url":"https://api.github.com/users/rails/followers","following_url":"https://api.github.com/users/rails/following{/other_user}","gists_url":"https://api.github.com/users/rails/gists{/gist_id}","starred_url":"https://api.github.com/users/rails/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rails/subscriptions","organizations_url":"https://api.github.com/users/rails/orgs","repos_url":"https://api.github.com/users/rails/repos","events_url":"https://api.github.com/users/rails/events{/privacy}","received_events_url":"https://api.github.com/users/rails/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rails/rails","description":"Ruby on Rails","fork":false,"url":"https://api.github.com/repos/rails/rails","forks_url":"https://api.github.com/repos/rails/rails/forks","keys_url":"https://api.github.com/repos/rails/rails/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rails/rails/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rails/rails/teams","hooks_url":"https://api.github.com/repos/rails/rails/hooks","issue_events_url":"https://api.github.com/repos/rails/rails/issues/events{/number}","events_url":"https://api.github.com/repos/rails/rails/events","assignees_url":"https://api.github.com/repos/rails/rails/assignees{/user}","branches_url":"https://api.github.com/repos/rails/rails/branches{/branch}","tags_url":"https://api.github.com/repos/rails/rails/tags","blobs_url":"https://api.github.com/repos/rails/rails/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rails/rails/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rails/rails/git/refs{/sha}","trees_url":"https://api.github.com/repos/rails/rails/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rails/rails/statuses/{sha}","languages_url":"https://api.github.com/repos/rails/rails/languages","stargazers_url":"https://api.github.com/repos/rails/rails/stargazers","contributors_url":"https://api.github.com/repos/rails/rails/contributors","subscribers_url":"https://api.github.com/repos/rails/rails/subscribers","subscription_url":"https://api.github.com/repos/rails/rails/subscription","commits_url":"https://api.github.com/repos/rails/rails/commits{/sha}","git_commits_url":"https://api.github.com/repos/rails/rails/git/commits{/sha}","comments_url":"https://api.github.com/repos/rails/rails/comments{/number}","issue_comment_url":"https://api.github.com/repos/rails/rails/issues/comments{/number}","contents_url":"https://api.github.com/repos/rails/rails/contents/{+path}","compare_url":"https://api.github.com/repos/rails/rails/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rails/rails/merges","archive_url":"https://api.github.com/repos/rails/rails/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rails/rails/downloads","issues_url":"https://api.github.com/repos/rails/rails/issues{/number}","pulls_url":"https://api.github.com/repos/rails/rails/pulls{/number}","milestones_url":"https://api.github.com/repos/rails/rails/milestones{/number}","notifications_url":"https://api.github.com/repos/rails/rails/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rails/rails/labels{/name}","releases_url":"https://api.github.com/repos/rails/rails/releases{/id}","deployments_url":"https://api.github.com/repos/rails/rails/deployments","created_at":"2008-04-11T02:19:47Z","updated_at":"2025-11-10T09:49:52Z","pushed_at":"2025-11-10T09:50:07Z","git_url":"git://github.com/rails/rails.git","ssh_url":"git@github.com:rails/rails.git","clone_url":"https://github.com/rails/rails.git","svn_url":"https://github.com/rails/rails","homepage":"https://rubyonrails.org","size":271651,"stargazers_count":57842,"watchers_count":57842,"language":"Ruby","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":22025,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1338,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["activejob","activerecord","framework","html","mvc","rails","ruby"],"visibility":"public","forks":22025,"open_issues":1338,"watchers":57842,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### Steps to reproduce\r\n\r\n```zsh\r\nrails new testapp -d postgresql\r\ncd testapp\r\nrails g scaffold post title body:text\r\nrails db:migrate\r\nrails c\r\nirb(main):001:0> Post.create(title: \"This is a test 1\", body:  \"This is a body 1\")\r\n```\r\n\r\n### Expected behavior\r\n\r\nI would expect to get a response saying that the Post was successfully created.\r\n\r\n### Actual behavior\r\n\r\n```text\r\nobjc[18501]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called.\r\nobjc[18501]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.\r\n```\r\n\r\n### System configuration\r\n**Rails version**:  Rails 6.0.2.1\r\n\r\n**Ruby version**:  ruby 2.7.0p0 (2019-12-25 revision 647ee6f091) [x86_64-darwin19]\r\n","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/38560/reactions","total_count":38,"+1":38,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/38560/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1906905904","html_url":"https://github.com/curl/curl/issues/11252#issuecomment-1906905904","issue_url":"https://api.github.com/repos/curl/curl/issues/11252","id":1906905904,"node_id":"IC_kwDOAAiu0c5xqRMw","user":{"login":"tristan957","id":11936772,"node_id":"MDQ6VXNlcjExOTM2Nzcy","avatar_url":"https://avatars.githubusercontent.com/u/11936772?v=4","gravatar_id":"","url":"https://api.github.com/users/tristan957","html_url":"https://github.com/tristan957","followers_url":"https://api.github.com/users/tristan957/followers","following_url":"https://api.github.com/users/tristan957/following{/other_user}","gists_url":"https://api.github.com/users/tristan957/gists{/gist_id}","starred_url":"https://api.github.com/users/tristan957/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tristan957/subscriptions","organizations_url":"https://api.github.com/users/tristan957/orgs","repos_url":"https://api.github.com/users/tristan957/repos","events_url":"https://api.github.com/users/tristan957/events{/privacy}","received_events_url":"https://api.github.com/users/tristan957/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-23T20:57:05Z","updated_at":"2024-01-23T21:06:33Z","body":"The call to `SCDynamicStoreCopyProxies` leads to undefined behavior in Postgres (stick with me). Postgres is not a multithreaded program. It is multiprocess using `fork(2)`. Each connection to the server is its own process (backend) which is created by a parent process called the postmaster.\r\n\r\nPostgres has a setting called [`shared_preload_libraries`](https://postgresqlco.nf/doc/en/param/shared_preload_libraries/). These are a list of libraries that are dlopened by the postmaster and initialized by calling a `_PG_init(void)` function. This is seemingly a great place to initialize libcurl for Postgres extensions. Unfortunately, this creates two issues in Postgres related to signal masking and the eventual forks. The signal masking can be worked around via `pthread_sigmask()` instead of `sigprocmask()`, which I will bring up on the list.\r\n\r\nBut the issue with `fork(2)` is harder to fix. When a fork occurs, it only copies data from the calling thread. What this means for Postgres extensions using libcurl on Mac, is that any data initialized by `SCDynamicStoreCopyProxies` is no longer initialized.\r\n\r\nThen I thought, what if I create a hook for extensions to run code when backends are at steady-state. I could call `curl_global_init()` in every backend that starts up, which would cause `SCDynamicStoreCopyProxies` to be called and always have initialized data. Unfortunately, `curl_global_init()` short-circuits if you call it multiple times, not calling `SCDynamicStoreCopyProxies`.\r\n\r\nAt this point, I am currently out of ideas. Do y'all have any suggestions to work-around this terrible situation (where Apple is wholly to blame, not curl developers).","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1906905904/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tristan957","id":11936772,"node_id":"MDQ6VXNlcjExOTM2Nzcy","avatar_url":"https://avatars.githubusercontent.com/u/11936772?v=4","gravatar_id":"","url":"https://api.github.com/users/tristan957","html_url":"https://github.com/tristan957","followers_url":"https://api.github.com/users/tristan957/followers","following_url":"https://api.github.com/users/tristan957/following{/other_user}","gists_url":"https://api.github.com/users/tristan957/gists{/gist_id}","starred_url":"https://api.github.com/users/tristan957/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tristan957/subscriptions","organizations_url":"https://api.github.com/users/tristan957/orgs","repos_url":"https://api.github.com/users/tristan957/repos","events_url":"https://api.github.com/users/tristan957/events{/privacy}","received_events_url":"https://api.github.com/users/tristan957/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1906915077","html_url":"https://github.com/curl/curl/issues/11252#issuecomment-1906915077","issue_url":"https://api.github.com/repos/curl/curl/issues/11252","id":1906915077,"node_id":"IC_kwDOAAiu0c5xqTcF","user":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-23T21:04:04Z","updated_at":"2024-01-23T21:04:04Z","body":"I'm not quite sure what you're trying to do. Are you trying to write a PostgreSQL extension that loads `libcurl` on macOS? ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1906915077/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1906916457","html_url":"https://github.com/curl/curl/issues/11252#issuecomment-1906916457","issue_url":"https://api.github.com/repos/curl/curl/issues/11252","id":1906916457,"node_id":"IC_kwDOAAiu0c5xqTxp","user":{"login":"tristan957","id":11936772,"node_id":"MDQ6VXNlcjExOTM2Nzcy","avatar_url":"https://avatars.githubusercontent.com/u/11936772?v=4","gravatar_id":"","url":"https://api.github.com/users/tristan957","html_url":"https://github.com/tristan957","followers_url":"https://api.github.com/users/tristan957/followers","following_url":"https://api.github.com/users/tristan957/following{/other_user}","gists_url":"https://api.github.com/users/tristan957/gists{/gist_id}","starred_url":"https://api.github.com/users/tristan957/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tristan957/subscriptions","organizations_url":"https://api.github.com/users/tristan957/orgs","repos_url":"https://api.github.com/users/tristan957/repos","events_url":"https://api.github.com/users/tristan957/events{/privacy}","received_events_url":"https://api.github.com/users/tristan957/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-23T21:05:11Z","updated_at":"2024-01-23T21:05:11Z","body":"Yes. Let me edit my message","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1906916457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tristan957","id":11936772,"node_id":"MDQ6VXNlcjExOTM2Nzcy","avatar_url":"https://avatars.githubusercontent.com/u/11936772?v=4","gravatar_id":"","url":"https://api.github.com/users/tristan957","html_url":"https://github.com/tristan957","followers_url":"https://api.github.com/users/tristan957/followers","following_url":"https://api.github.com/users/tristan957/following{/other_user}","gists_url":"https://api.github.com/users/tristan957/gists{/gist_id}","starred_url":"https://api.github.com/users/tristan957/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tristan957/subscriptions","organizations_url":"https://api.github.com/users/tristan957/orgs","repos_url":"https://api.github.com/users/tristan957/repos","events_url":"https://api.github.com/users/tristan957/events{/privacy}","received_events_url":"https://api.github.com/users/tristan957/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1906937272","html_url":"https://github.com/curl/curl/issues/11252#issuecomment-1906937272","issue_url":"https://api.github.com/repos/curl/curl/issues/11252","id":1906937272,"node_id":"IC_kwDOAAiu0c5xqY24","user":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-23T21:20:56Z","updated_at":"2024-01-23T21:23:01Z","body":"This sounds more like a question for the PostgreSQL mailing list, but I thought that the main process (`postmaster`) first attempts to load all shared libraries: https://github.com/postgres/postgres/blob/29275b1d177096597675b5c6e7e7c9db2df8f4df/src/backend/postmaster/postmaster.c#L1016\r\n\r\nOnce that server starts up, then the `fork()` occurs: https://github.com/postgres/postgres/blob/29275b1d177096597675b5c6e7e7c9db2df8f4df/src/backend/postmaster/postmaster.c#L1773-L1776\r\n\r\nI would expect that these forked process would have the right state if `curl_global_init()` were called first.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1906937272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"stanhu","id":963826,"node_id":"MDQ6VXNlcjk2MzgyNg==","avatar_url":"https://avatars.githubusercontent.com/u/963826?v=4","gravatar_id":"","url":"https://api.github.com/users/stanhu","html_url":"https://github.com/stanhu","followers_url":"https://api.github.com/users/stanhu/followers","following_url":"https://api.github.com/users/stanhu/following{/other_user}","gists_url":"https://api.github.com/users/stanhu/gists{/gist_id}","starred_url":"https://api.github.com/users/stanhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanhu/subscriptions","organizations_url":"https://api.github.com/users/stanhu/orgs","repos_url":"https://api.github.com/users/stanhu/repos","events_url":"https://api.github.com/users/stanhu/events{/privacy}","received_events_url":"https://api.github.com/users/stanhu/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11576292450,"node_id":"SE_lADOAAiu0c5n1yTFzwAAAAKyADRi","url":"https://api.github.com/repos/curl/curl/issues/events/11576292450","actor":{"login":"bayandin","id":864213,"node_id":"MDQ6VXNlcjg2NDIxMw==","avatar_url":"https://avatars.githubusercontent.com/u/864213?v=4","gravatar_id":"","url":"https://api.github.com/users/bayandin","html_url":"https://github.com/bayandin","followers_url":"https://api.github.com/users/bayandin/followers","following_url":"https://api.github.com/users/bayandin/following{/other_user}","gists_url":"https://api.github.com/users/bayandin/gists{/gist_id}","starred_url":"https://api.github.com/users/bayandin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bayandin/subscriptions","organizations_url":"https://api.github.com/users/bayandin/orgs","repos_url":"https://api.github.com/users/bayandin/repos","events_url":"https://api.github.com/users/bayandin/events{/privacy}","received_events_url":"https://api.github.com/users/bayandin/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-01-23T21:27:15Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/curl/curl/issues/comments/1907110482","html_url":"https://github.com/curl/curl/issues/11252#issuecomment-1907110482","issue_url":"https://api.github.com/repos/curl/curl/issues/11252","id":1907110482,"node_id":"IC_kwDOAAiu0c5xrDJS","user":{"login":"tristan957","id":11936772,"node_id":"MDQ6VXNlcjExOTM2Nzcy","avatar_url":"https://avatars.githubusercontent.com/u/11936772?v=4","gravatar_id":"","url":"https://api.github.com/users/tristan957","html_url":"https://github.com/tristan957","followers_url":"https://api.github.com/users/tristan957/followers","following_url":"https://api.github.com/users/tristan957/following{/other_user}","gists_url":"https://api.github.com/users/tristan957/gists{/gist_id}","starred_url":"https://api.github.com/users/tristan957/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tristan957/subscriptions","organizations_url":"https://api.github.com/users/tristan957/orgs","repos_url":"https://api.github.com/users/tristan957/repos","events_url":"https://api.github.com/users/tristan957/events{/privacy}","received_events_url":"https://api.github.com/users/tristan957/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-23T23:55:10Z","updated_at":"2024-01-23T23:55:10Z","body":"Postgres has a check for `pthread_is_threaded_np()` here: https://github.com/postgres/postgres/blob/29275b1d177096597675b5c6e7e7c9db2df8f4df/src/backend/postmaster/postmaster.c#L1429-L1445.\r\n\r\nI was reading this SO answer (https://stackoverflow.com/a/42679479/7572728) to understand the problem-space a little bit better. It sounds like there is a potential for problems, which may not exist in the context of this particular situation, but could in others.\r\n\r\nAnyway, I'll take this to the Postgres list. Thanks for your help :).","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/curl/curl/issues/comments/1907110482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tristan957","id":11936772,"node_id":"MDQ6VXNlcjExOTM2Nzcy","avatar_url":"https://avatars.githubusercontent.com/u/11936772?v=4","gravatar_id":"","url":"https://api.github.com/users/tristan957","html_url":"https://github.com/tristan957","followers_url":"https://api.github.com/users/tristan957/followers","following_url":"https://api.github.com/users/tristan957/following{/other_user}","gists_url":"https://api.github.com/users/tristan957/gists{/gist_id}","starred_url":"https://api.github.com/users/tristan957/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tristan957/subscriptions","organizations_url":"https://api.github.com/users/tristan957/orgs","repos_url":"https://api.github.com/users/tristan957/repos","events_url":"https://api.github.com/users/tristan957/events{/privacy}","received_events_url":"https://api.github.com/users/tristan957/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":12270305341,"node_id":"REFE_lADOAAiu0c5n1yTFzwAAAALbXgA9","url":"https://api.github.com/repos/curl/curl/issues/events/12270305341","actor":{"login":"pghmcfc","id":947224,"node_id":"MDQ6VXNlcjk0NzIyNA==","avatar_url":"https://avatars.githubusercontent.com/u/947224?v=4","gravatar_id":"","url":"https://api.github.com/users/pghmcfc","html_url":"https://github.com/pghmcfc","followers_url":"https://api.github.com/users/pghmcfc/followers","following_url":"https://api.github.com/users/pghmcfc/following{/other_user}","gists_url":"https://api.github.com/users/pghmcfc/gists{/gist_id}","starred_url":"https://api.github.com/users/pghmcfc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pghmcfc/subscriptions","organizations_url":"https://api.github.com/users/pghmcfc/orgs","repos_url":"https://api.github.com/users/pghmcfc/repos","events_url":"https://api.github.com/users/pghmcfc/events{/privacy}","received_events_url":"https://api.github.com/users/pghmcfc/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"c7308592fb8ba213fc2c1bb6ad39781df45bd84a","commit_url":"https://api.github.com/repos/pghmcfc/curl/commits/c7308592fb8ba213fc2c1bb6ad39781df45bd84a","created_at":"2024-03-27T18:20:27Z","performed_via_github_app":null},{"actor":{"login":"rui-rafael-lastpass","id":165178585,"node_id":"U_kgDOCdhs2Q","avatar_url":"https://avatars.githubusercontent.com/u/165178585?v=4","gravatar_id":"","url":"https://api.github.com/users/rui-rafael-lastpass","html_url":"https://github.com/rui-rafael-lastpass","followers_url":"https://api.github.com/users/rui-rafael-lastpass/followers","following_url":"https://api.github.com/users/rui-rafael-lastpass/following{/other_user}","gists_url":"https://api.github.com/users/rui-rafael-lastpass/gists{/gist_id}","starred_url":"https://api.github.com/users/rui-rafael-lastpass/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rui-rafael-lastpass/subscriptions","organizations_url":"https://api.github.com/users/rui-rafael-lastpass/orgs","repos_url":"https://api.github.com/users/rui-rafael-lastpass/repos","events_url":"https://api.github.com/users/rui-rafael-lastpass/events{/privacy}","received_events_url":"https://api.github.com/users/rui-rafael-lastpass/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T15:45:47Z","updated_at":"2024-05-13T15:45:47Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/lastpass/lastpass-cli/issues/686","repository_url":"https://api.github.com/repos/lastpass/lastpass-cli","labels_url":"https://api.github.com/repos/lastpass/lastpass-cli/issues/686/labels{/name}","comments_url":"https://api.github.com/repos/lastpass/lastpass-cli/issues/686/comments","events_url":"https://api.github.com/repos/lastpass/lastpass-cli/issues/686/events","html_url":"https://github.com/lastpass/lastpass-cli/pull/686","id":2293183941,"node_id":"PR_kwDOAYZsXs5vR0w7","number":686,"title":"Fix segmentation faults and items with ID 0","user":{"login":"rui-rafael-lastpass","id":165178585,"node_id":"U_kgDOCdhs2Q","avatar_url":"https://avatars.githubusercontent.com/u/165178585?v=4","gravatar_id":"","url":"https://api.github.com/users/rui-rafael-lastpass","html_url":"https://github.com/rui-rafael-lastpass","followers_url":"https://api.github.com/users/rui-rafael-lastpass/followers","following_url":"https://api.github.com/users/rui-rafael-lastpass/following{/other_user}","gists_url":"https://api.github.com/users/rui-rafael-lastpass/gists{/gist_id}","starred_url":"https://api.github.com/users/rui-rafael-lastpass/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rui-rafael-lastpass/subscriptions","organizations_url":"https://api.github.com/users/rui-rafael-lastpass/orgs","repos_url":"https://api.github.com/users/rui-rafael-lastpass/repos","events_url":"https://api.github.com/users/rui-rafael-lastpass/events{/privacy}","received_events_url":"https://api.github.com/users/rui-rafael-lastpass/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"rui-rafael-lastpass","id":165178585,"node_id":"U_kgDOCdhs2Q","avatar_url":"https://avatars.githubusercontent.com/u/165178585?v=4","gravatar_id":"","url":"https://api.github.com/users/rui-rafael-lastpass","html_url":"https://github.com/rui-rafael-lastpass","followers_url":"https://api.github.com/users/rui-rafael-lastpass/followers","following_url":"https://api.github.com/users/rui-rafael-lastpass/following{/other_user}","gists_url":"https://api.github.com/users/rui-rafael-lastpass/gists{/gist_id}","starred_url":"https://api.github.com/users/rui-rafael-lastpass/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rui-rafael-lastpass/subscriptions","organizations_url":"https://api.github.com/users/rui-rafael-lastpass/orgs","repos_url":"https://api.github.com/users/rui-rafael-lastpass/repos","events_url":"https://api.github.com/users/rui-rafael-lastpass/events{/privacy}","received_events_url":"https://api.github.com/users/rui-rafael-lastpass/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"rui-rafael-lastpass","id":165178585,"node_id":"U_kgDOCdhs2Q","avatar_url":"https://avatars.githubusercontent.com/u/165178585?v=4","gravatar_id":"","url":"https://api.github.com/users/rui-rafael-lastpass","html_url":"https://github.com/rui-rafael-lastpass","followers_url":"https://api.github.com/users/rui-rafael-lastpass/followers","following_url":"https://api.github.com/users/rui-rafael-lastpass/following{/other_user}","gists_url":"https://api.github.com/users/rui-rafael-lastpass/gists{/gist_id}","starred_url":"https://api.github.com/users/rui-rafael-lastpass/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rui-rafael-lastpass/subscriptions","organizations_url":"https://api.github.com/users/rui-rafael-lastpass/orgs","repos_url":"https://api.github.com/users/rui-rafael-lastpass/repos","events_url":"https://api.github.com/users/rui-rafael-lastpass/events{/privacy}","received_events_url":"https://api.github.com/users/rui-rafael-lastpass/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":0,"created_at":"2024-05-13T15:45:46Z","updated_at":"2024-05-14T12:24:47Z","closed_at":"2024-05-14T12:24:47Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":25586782,"node_id":"MDEwOlJlcG9zaXRvcnkyNTU4Njc4Mg==","name":"lastpass-cli","full_name":"lastpass/lastpass-cli","private":false,"owner":{"login":"lastpass","id":7076028,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcwNzYwMjg=","avatar_url":"https://avatars.githubusercontent.com/u/7076028?v=4","gravatar_id":"","url":"https://api.github.com/users/lastpass","html_url":"https://github.com/lastpass","followers_url":"https://api.github.com/users/lastpass/followers","following_url":"https://api.github.com/users/lastpass/following{/other_user}","gists_url":"https://api.github.com/users/lastpass/gists{/gist_id}","starred_url":"https://api.github.com/users/lastpass/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lastpass/subscriptions","organizations_url":"https://api.github.com/users/lastpass/orgs","repos_url":"https://api.github.com/users/lastpass/repos","events_url":"https://api.github.com/users/lastpass/events{/privacy}","received_events_url":"https://api.github.com/users/lastpass/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/lastpass/lastpass-cli","description":"LastPass command line interface tool","fork":false,"url":"https://api.github.com/repos/lastpass/lastpass-cli","forks_url":"https://api.github.com/repos/lastpass/lastpass-cli/forks","keys_url":"https://api.github.com/repos/lastpass/lastpass-cli/keys{/key_id}","collaborators_url":"https://api.github.com/repos/lastpass/lastpass-cli/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/lastpass/lastpass-cli/teams","hooks_url":"https://api.github.com/repos/lastpass/lastpass-cli/hooks","issue_events_url":"https://api.github.com/repos/lastpass/lastpass-cli/issues/events{/number}","events_url":"https://api.github.com/repos/lastpass/lastpass-cli/events","assignees_url":"https://api.github.com/repos/lastpass/lastpass-cli/assignees{/user}","branches_url":"https://api.github.com/repos/lastpass/lastpass-cli/branches{/branch}","tags_url":"https://api.github.com/repos/lastpass/lastpass-cli/tags","blobs_url":"https://api.github.com/repos/lastpass/lastpass-cli/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/lastpass/lastpass-cli/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/lastpass/lastpass-cli/git/refs{/sha}","trees_url":"https://api.github.com/repos/lastpass/lastpass-cli/git/trees{/sha}","statuses_url":"https://api.github.com/repos/lastpass/lastpass-cli/statuses/{sha}","languages_url":"https://api.github.com/repos/lastpass/lastpass-cli/languages","stargazers_url":"https://api.github.com/repos/lastpass/lastpass-cli/stargazers","contributors_url":"https://api.github.com/repos/lastpass/lastpass-cli/contributors","subscribers_url":"https://api.github.com/repos/lastpass/lastpass-cli/subscribers","subscription_url":"https://api.github.com/repos/lastpass/lastpass-cli/subscription","commits_url":"https://api.github.com/repos/lastpass/lastpass-cli/commits{/sha}","git_commits_url":"https://api.github.com/repos/lastpass/lastpass-cli/git/commits{/sha}","comments_url":"https://api.github.com/repos/lastpass/lastpass-cli/comments{/number}","issue_comment_url":"https://api.github.com/repos/lastpass/lastpass-cli/issues/comments{/number}","contents_url":"https://api.github.com/repos/lastpass/lastpass-cli/contents/{+path}","compare_url":"https://api.github.com/repos/lastpass/lastpass-cli/compare/{base}...{head}","merges_url":"https://api.github.com/repos/lastpass/lastpass-cli/merges","archive_url":"https://api.github.com/repos/lastpass/lastpass-cli/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/lastpass/lastpass-cli/downloads","issues_url":"https://api.github.com/repos/lastpass/lastpass-cli/issues{/number}","pulls_url":"https://api.github.com/repos/lastpass/lastpass-cli/pulls{/number}","milestones_url":"https://api.github.com/repos/lastpass/lastpass-cli/milestones{/number}","notifications_url":"https://api.github.com/repos/lastpass/lastpass-cli/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/lastpass/lastpass-cli/labels{/name}","releases_url":"https://api.github.com/repos/lastpass/lastpass-cli/releases{/id}","deployments_url":"https://api.github.com/repos/lastpass/lastpass-cli/deployments","created_at":"2014-10-22T14:46:14Z","updated_at":"2025-10-13T21:35:53Z","pushed_at":"2025-04-22T13:42:32Z","git_url":"git://github.com/lastpass/lastpass-cli.git","ssh_url":"git@github.com:lastpass/lastpass-cli.git","clone_url":"https://github.com/lastpass/lastpass-cli.git","svn_url":"https://github.com/lastpass/lastpass-cli","homepage":null,"size":1049,"stargazers_count":2888,"watchers_count":2888,"language":"C","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":false,"forks_count":299,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":210,"license":{"key":"gpl-2.0","name":"GNU General Public License v2.0","spdx_id":"GPL-2.0","url":"https://api.github.com/licenses/gpl-2.0","node_id":"MDc6TGljZW5zZTg="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":299,"open_issues":210,"watchers":2888,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/lastpass/lastpass-cli/pulls/686","html_url":"https://github.com/lastpass/lastpass-cli/pull/686","diff_url":"https://github.com/lastpass/lastpass-cli/pull/686.diff","patch_url":"https://github.com/lastpass/lastpass-cli/pull/686.patch","merged_at":"2024-05-14T12:24:47Z"},"body":"**Segmentation faults**\r\nSegmentation faults were observed within Mac OS X and in a development environment where the CLI was compiled by developers and not distributed via package managers such as Homebrew.\r\n\r\nUpon inspecting the CMakeLists configuration and some tests with the compilation process, we identified that when compiling under Mac OS X, the linker was linking the CLI against the system libraries for OpenSSL and CURL.\r\n\r\nThis is not what we want at all, as the system libraries for OpenSSL and CURL are part of the Mac OS X ecosystem, and they are heavily dependent upon Mac OS X. Rather, what we want is to make sure the final CLI executable is linking against the \"normal\" OpenSSL and CURL versions. To achieve this, we changed the CMakeLists configuration so that it detects if the compilation process is running under Mac OS X, if Homebrew is installed, and if OpenSSL/CURL are installed via Homebrew. In this case, we will make sure that the final CLI executable is linking against the \"normal\" OpenSSL and CURL versions by specifying in pkg-config the Homebrew paths to search for the dependencies.\r\n\r\n**Items with ID 0**\r\nThe issue of items with ID 0 was reproduced on Mac OS X but not on Cygwin or Linux. On Mac OS X, the ID 0 was causing unexpected errors that would lead to the CLI terminating abruptly, therefore, we used the [Console Guide](https://support.apple.com/en-gb/guide/console/welcome/mac) application to obtain the core dump and investigate it. The following is the core dump of the CLI tool when the ID 0 occurred:\r\n\r\n```\r\nApplication Specific Information:\r\n*** multi-threaded process forked ***\r\ncrashed on child side of fork pre-exec\r\n\r\nThread 0 Crashed:: Dispatch queue: com.apple.main-thread\r\n0 libsystem_trace.dylib 0x18db3c23c _os_log_preferences_refresh + 68\r\n1 libsystem_trace.dylib 0x18db3cc9c os_log_type_enabled + 712\r\n2 CoreFoundation 0x18de6e3f8 -[CFPrefsSearchListSource alreadylocked_copyValueForKey:] + 204\r\n3 CoreFoundation 0x18de6e30c -[CFPrefsSource copyValueForKey:] + 52\r\n4 CoreFoundation 0x18de6e2c0 __76-[_CFXPreferences copyAppValueForKey:identifier:container:configurationURL:]_block_invoke + 32\r\n5 CoreFoundation 0x18de6790c __108-[_CFXPreferences(SearchListAdditions) withSearchListForIdentifier:container:cloudConfigurationURL:perform:]_block_invoke + 376\r\n6 CoreFoundation 0x18dfea460 -[_CFXPreferences withSearchListForIdentifier:container:cloudConfigurationURL:perform:] + 384\r\n7 CoreFoundation 0x18de671e8 -[_CFXPreferences copyAppValueForKey:identifier:container:configurationURL:] + 156\r\n8 CoreFoundation 0x18de67110 _CFPreferencesCopyAppValueWithContainerAndConfiguration + 112\r\n9 SystemConfiguration 0x18ebf9478 SCDynamicStoreCopyProxiesWithOptions + 180\r\n10 libcurl.4.dylib 0x101613870 Curl_macos_init + 16\r\n11 libcurl.4.dylib 0x1015f6cf4 global_init + 172\r\n12 libcurl.4.dylib 0x1015f6c38 curl_global_init + 68\r\n13 lpass 0x100ff11e4 upload_queue_ensure_running + 324\r\n14 lpass 0x100fe8b44 cmd_sync + 184\r\n15 lpass 0x100fef42c main + 744\r\n16 dyld 0x18da5d0e0 start + 2360\r\n```\r\n\r\nLooking at the core dump and stack trace information we can derive that the issue happens on a child process of the CLI tool and occurs within a call to a specific Mac OS X function in CURL, which is the curl_macos_init function. The code of that function can be [seen in GitHub](https://github.com/curl/curl/blob/0c49ea4ff253ea605e4b6839a4fa32a52d7d8825/lib/macos.c#L35). \r\n\r\nWithin the codebase we can see that CLI uses a multi-process approach to carry out its functionalities, specifically, the CLI uses its main process to handle the command line arguments and call the necessary set of functions that will process the command line arguments, but the CLI also spins up a child process that handles the actual HTTP/HTTPs communication to create new items. \r\n\r\nThe relevant point of the aforementioned approach is that after the CLI spins up a new child process, it proceeds to call the global cleanup/initialization functions of CURL within the scope of the child process, and this is where the issue occurs. When the child process tries to call the global cleanup/initialization functions of CURL, those functions will access CoreFoundation libraries of the Mac OS X and the child process terminates unexpectedly and the new item never gets sent to the backend, therefore, it never gets an ID, hence the item having an ID 0. Relevant code snippet:\r\n\r\n```\r\n       // CREATION OF CHILD PROCESS\r\n\tpid_t child = fork();\r\n\tif (child < 0)\r\n\t\tdie_errno(\"fork(agent)\");\r\n\t\r\n\tif (child == 0) {\r\n\t\t// CHILD PROCESS EXECUTION\r\n\t\tint null = open(\"/dev/null\", 0);\r\n\t\tint upload_log = null;\r\n\r\n\t\tif (null >= 0) {\r\n\t\t\tdup2(null, 0);\r\n\t\t\tdup2(null, 1);\r\n\t\t\tdup2(null, 2);\r\n\t\t\tclose(null);\r\n\t\t\tclose(upload_log);\r\n\t\t}\r\n\t\tsetsid();\r\n\t\tIGNORE_RESULT(chdir(\"/\"));\r\n\t\tprocess_set_name(\"lpass [upload queue]\");\r\n\t\tsignal(SIGHUP, upload_queue_cleanup);\r\n\t\tsignal(SIGINT, upload_queue_cleanup);\r\n\t\tsignal(SIGQUIT, upload_queue_cleanup);\r\n\t\tsignal(SIGTERM, upload_queue_cleanup);\r\n\t\tsignal(SIGALRM, upload_queue_cleanup);\r\n\t\tsetvbuf(stdout, NULL, _IOLBF, 0);\r\n\t\t\r\n\t\t// PROBLEMATIC CALL\r\n\t\tcurl_global_cleanup();\r\n\t\tcurl_global_init(CURL_GLOBAL_DEFAULT);\r\n\r\n\t\tlpass_log(LOG_DEBUG, \"UQ: starting queue run\\n\");\r\n\t\tupload_queue_upload_all(session, key);\r\n\t\tlpass_log(LOG_DEBUG, \"UQ: queue run complete\\n\");\r\n\t\tupload_queue_cleanup(0);\r\n\t\t_exit(EXIT_SUCCESS);\r\n\t}\r\n```\r\n\r\nThe global cleanup/initialization CURL functions are already called at the start of the CLI execution by the main process, and according to CURL documentation:\r\n\r\nâ€_This function must be called at least once within a program (a program is all the code that shares a memory space) before the program calls any other function in libcurl. The environment it sets up is constant for the life of the program and is the same for every program, so multiple calls have the same effect as one call._â€\r\n\r\nParent and the child processes have their own memory space, but they initially share the same memory contents, which means that the child process inherits the global CURL state so it should not be necessary for the child process to also perform a global cleanup/initialization. There are some articles that also share this view and that advise against calling such functions on child processes:\r\n\r\n[curl_global_init is to be called once. Remember that both fork creates a copy of the process at the time it was called, so it will replicate curl's state as well. Thus, there will be no need to call curl_global_init again in the child if the initialization was already done prior to the fork.](https://stackoverflow.com/questions/9859783/multi-process-using-curl-when-must-curl-global-init-be-called)\r\n\r\n[lib/hostip.c: SCDynamicStoreCopyProxies is not safe to run in a fork Â· Issue #11252 Â· curl/curl](https://github.com/curl/curl/issues/11252) \r\n\r\n[curl_global_init() is, unfortunately, not thread safe, so you must ensure that you only do it once and never simultaneously with another call. It initializes global state so you should only call it once, and once your program is completely done using libcurl you can call curl_global_cleanup() to free and clean up the associated global resources the init call allocated.](https://everything.curl.dev/libcurl/globalinit.html)\r\n\r\n[Better solution than hacking around the issue with ENV flags, is to call Ethon::Curl.init before the application forks (such as in a Rails initializer), since as of Curl v8.2.0, macOS specific calls were moved into the global init.](https://github.com/typhoeus/ethon/issues/206#issuecomment-2087892432)\r\n\r\nBased on the aforementioned information, we decided to remove the global cleanup/initialization function calls from the child process and only let the parent process call such functions, which caused the issue with items having ID 0 to stop. \r\n\r\nOne alternative implementation would be to only let the child process perform the global cleanup/initialization function calls, but this would lead us into a state where if we need to introduce other child process with CURL access, they would also need to call the global cleanup/initialization function calls. Furthermore, its safer to have the global cleanup/initialization within the parent process than in child processes, because executing such actions in child processes means that we are now on multi-process territory, which is inherently less safe.\r\n","reactions":{"url":"https://api.github.com/repos/lastpass/lastpass-cli/issues/686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/lastpass/lastpass-cli/issues/686/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"vhiairrassary","id":6972399,"node_id":"MDQ6VXNlcjY5NzIzOTk=","avatar_url":"https://avatars.githubusercontent.com/u/6972399?v=4","gravatar_id":"","url":"https://api.github.com/users/vhiairrassary","html_url":"https://github.com/vhiairrassary","followers_url":"https://api.github.com/users/vhiairrassary/followers","following_url":"https://api.github.com/users/vhiairrassary/following{/other_user}","gists_url":"https://api.github.com/users/vhiairrassary/gists{/gist_id}","starred_url":"https://api.github.com/users/vhiairrassary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vhiairrassary/subscriptions","organizations_url":"https://api.github.com/users/vhiairrassary/orgs","repos_url":"https://api.github.com/users/vhiairrassary/repos","events_url":"https://api.github.com/users/vhiairrassary/events{/privacy}","received_events_url":"https://api.github.com/users/vhiairrassary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-30T10:53:57Z","updated_at":"2025-07-30T10:53:57Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/suketa/ruby-duckdb/issues/974","repository_url":"https://api.github.com/repos/suketa/ruby-duckdb","labels_url":"https://api.github.com/repos/suketa/ruby-duckdb/issues/974/labels{/name}","comments_url":"https://api.github.com/repos/suketa/ruby-duckdb/issues/974/comments","events_url":"https://api.github.com/repos/suketa/ruby-duckdb/issues/974/events","html_url":"https://github.com/suketa/ruby-duckdb/issues/974","id":3266947708,"node_id":"I_kwDODP7OMc7Cuap8","number":974,"title":"Segfault when using with Solid Queue and Postgres","user":{"login":"vhiairrassary","id":6972399,"node_id":"MDQ6VXNlcjY5NzIzOTk=","avatar_url":"https://avatars.githubusercontent.com/u/6972399?v=4","gravatar_id":"","url":"https://api.github.com/users/vhiairrassary","html_url":"https://github.com/vhiairrassary","followers_url":"https://api.github.com/users/vhiairrassary/followers","following_url":"https://api.github.com/users/vhiairrassary/following{/other_user}","gists_url":"https://api.github.com/users/vhiairrassary/gists{/gist_id}","starred_url":"https://api.github.com/users/vhiairrassary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vhiairrassary/subscriptions","organizations_url":"https://api.github.com/users/vhiairrassary/orgs","repos_url":"https://api.github.com/users/vhiairrassary/repos","events_url":"https://api.github.com/users/vhiairrassary/events{/privacy}","received_events_url":"https://api.github.com/users/vhiairrassary/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2025-07-27T09:54:47Z","updated_at":"2025-07-30T10:53:56Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":218025521,"node_id":"MDEwOlJlcG9zaXRvcnkyMTgwMjU1MjE=","name":"ruby-duckdb","full_name":"suketa/ruby-duckdb","private":false,"owner":{"login":"suketa","id":80150,"node_id":"MDQ6VXNlcjgwMTUw","avatar_url":"https://avatars.githubusercontent.com/u/80150?v=4","gravatar_id":"","url":"https://api.github.com/users/suketa","html_url":"https://github.com/suketa","followers_url":"https://api.github.com/users/suketa/followers","following_url":"https://api.github.com/users/suketa/following{/other_user}","gists_url":"https://api.github.com/users/suketa/gists{/gist_id}","starred_url":"https://api.github.com/users/suketa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/suketa/subscriptions","organizations_url":"https://api.github.com/users/suketa/orgs","repos_url":"https://api.github.com/users/suketa/repos","events_url":"https://api.github.com/users/suketa/events{/privacy}","received_events_url":"https://api.github.com/users/suketa/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/suketa/ruby-duckdb","description":"Ruby binding for DuckDB","fork":false,"url":"https://api.github.com/repos/suketa/ruby-duckdb","forks_url":"https://api.github.com/repos/suketa/ruby-duckdb/forks","keys_url":"https://api.github.com/repos/suketa/ruby-duckdb/keys{/key_id}","collaborators_url":"https://api.github.com/repos/suketa/ruby-duckdb/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/suketa/ruby-duckdb/teams","hooks_url":"https://api.github.com/repos/suketa/ruby-duckdb/hooks","issue_events_url":"https://api.github.com/repos/suketa/ruby-duckdb/issues/events{/number}","events_url":"https://api.github.com/repos/suketa/ruby-duckdb/events","assignees_url":"https://api.github.com/repos/suketa/ruby-duckdb/assignees{/user}","branches_url":"https://api.github.com/repos/suketa/ruby-duckdb/branches{/branch}","tags_url":"https://api.github.com/repos/suketa/ruby-duckdb/tags","blobs_url":"https://api.github.com/repos/suketa/ruby-duckdb/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/suketa/ruby-duckdb/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/suketa/ruby-duckdb/git/refs{/sha}","trees_url":"https://api.github.com/repos/suketa/ruby-duckdb/git/trees{/sha}","statuses_url":"https://api.github.com/repos/suketa/ruby-duckdb/statuses/{sha}","languages_url":"https://api.github.com/repos/suketa/ruby-duckdb/languages","stargazers_url":"https://api.github.com/repos/suketa/ruby-duckdb/stargazers","contributors_url":"https://api.github.com/repos/suketa/ruby-duckdb/contributors","subscribers_url":"https://api.github.com/repos/suketa/ruby-duckdb/subscribers","subscription_url":"https://api.github.com/repos/suketa/ruby-duckdb/subscription","commits_url":"https://api.github.com/repos/suketa/ruby-duckdb/commits{/sha}","git_commits_url":"https://api.github.com/repos/suketa/ruby-duckdb/git/commits{/sha}","comments_url":"https://api.github.com/repos/suketa/ruby-duckdb/comments{/number}","issue_comment_url":"https://api.github.com/repos/suketa/ruby-duckdb/issues/comments{/number}","contents_url":"https://api.github.com/repos/suketa/ruby-duckdb/contents/{+path}","compare_url":"https://api.github.com/repos/suketa/ruby-duckdb/compare/{base}...{head}","merges_url":"https://api.github.com/repos/suketa/ruby-duckdb/merges","archive_url":"https://api.github.com/repos/suketa/ruby-duckdb/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/suketa/ruby-duckdb/downloads","issues_url":"https://api.github.com/repos/suketa/ruby-duckdb/issues{/number}","pulls_url":"https://api.github.com/repos/suketa/ruby-duckdb/pulls{/number}","milestones_url":"https://api.github.com/repos/suketa/ruby-duckdb/milestones{/number}","notifications_url":"https://api.github.com/repos/suketa/ruby-duckdb/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/suketa/ruby-duckdb/labels{/name}","releases_url":"https://api.github.com/repos/suketa/ruby-duckdb/releases{/id}","deployments_url":"https://api.github.com/repos/suketa/ruby-duckdb/deployments","created_at":"2019-10-28T10:53:24Z","updated_at":"2025-11-09T15:12:36Z","pushed_at":"2025-11-03T00:33:38Z","git_url":"git://github.com/suketa/ruby-duckdb.git","ssh_url":"git@github.com:suketa/ruby-duckdb.git","clone_url":"https://github.com/suketa/ruby-duckdb.git","svn_url":"https://github.com/suketa/ruby-duckdb","homepage":"https://github.com/suketa/ruby-duckdb","size":3346,"stargazers_count":231,"watchers_count":231,"language":"Ruby","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":false,"forks_count":28,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":22,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["database","hacktoberfest","ruby"],"visibility":"public","forks":28,"open_issues":22,"watchers":231,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Hello, I have a \"small\" reproducible segfault at https://github.com/vhiairrassary/debug-duckdb-with-solid-queue.\n\nMy notes:\n  - `SELECT` statements are fine, it happens when doing a `CREATE SECRET` statement\n  - Job only fails when running asynchronously in Solid Queue (using `.perform_later`), synchronous executions (`.perform_now`) are fine\n  - The repository contains two commits\n    - a `rails new debug-duckdb-with-solid-queue --database=postgresql` (I do not have the issue with sqlite)\n    - the code causing the issue (see below) and few lines of configuration\n\n```\nclass DebugJob < ApplicationJob\n  def perform\n    DuckDB::Database.open do |db|\n      db.connect do |conn|\n        p conn.query('SELECT 1').to_a\n        p conn.query('SELECT 2').to_a\n\n        conn.query(\"CREATE SECRET s3_secret (TYPE S3, KEY_ID 'abc', SECRET 'def')\")\n      end\n    end\n  end\nend\n```\n\nTo reproduce, open three terminals:\n  - First: run Postgres using `podman run --rm -ti -e 'POSTGRES_USER=my_user' -e 'POSTGRES_PASSWORD=my_password' -e 'POSTGRES_DB=postgres' -p '5432:5432' postgres:17.5-alpine`\n  - Second: prepare database (using `bundle exec rails db:drop db:create db:migrate db:seed` ) and then launch Solid Queue using `./bin/jobs`\n  - Third: in a Rails console\n    - `reload!; DebugJob.perform_now` âœ… \n      <details>\n        <summary>Log</summary>\n\n          Reloading...\n          Performing DebugJob (Job ID: b561988e-dcb7-4a7d-98d6-35f17530297a) from SolidQueue(default)\n          â†³ (debug-duckdb-with-solid-queue):3:in '<main>'\n          [[1]]\n          [[2]]\n          Performed DebugJob (Job ID: b561988e-dcb7-4a7d-98d6-35f17530297a) from SolidQueue(default) in 23.92ms\n          â†³ (debug-duckdb-with-solid-queue):3:in '<main>'\n          => #<DuckDB::Result:0x0000000123dd37a8>\n      </details>\n\n    - `reload!; DebugJob.perform_later` ðŸ”´ \n      <details>\n        <summary>Log</summary>\n\n        ```\n        \n        [[1]]\n        [[2]]\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/extracted_statements.rb:16: [BUG] Segmentation fault at 0x0000000000000110\n        ruby 3.4.5 (2025-07-16 revision 20cda200d3) +PRISM [arm64-darwin24]\n        \n        -- Crash Report log information --------------------------------------------\n           See Crash Report log file in one of the following locations:\n             * ~/Library/Logs/DiagnosticReports\n             * /Library/Logs/DiagnosticReports\n           for more details.\n        Don't forget to include the above Crash Report log file in bug reports.\n        \n        -- Control frame information -----------------------------------------------\n        c:0067 p:---- s:0381 e:000380 CFUNC  :prepared_statement\n        c:0066 p:0008 s:0375 e:000374 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/extracted_statements.rb:16\n        c:0065 p:0024 s:0371 e:000370 METHOD <internal:numeric>:257\n        c:0064 p:0019 s:0366 e:000365 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/extracted_statements.rb:15\n        c:0063 p:0017 s:0362 e:000361 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/connection.rb:38\n        c:0062 p:0017 s:0355 e:000354 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/connection.rb:27\n        c:0061 p:0030 s:0348 e:000347 BLOCK  /Users/vhiairrassary/Code/vhiairrassary/debug-duckdb-with-solid-queue/app/jobs/debug_job.rb:8\n        c:0060 p:0017 s:0344 e:000343 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/database.rb:79\n        c:0059 p:0005 s:0339 e:000338 BLOCK  /Users/vhiairrassary/Code/vhiairrassary/debug-duckdb-with-solid-queue/app/jobs/debug_job.rb:4\n        c:0058 p:0027 s:0335 e:000334 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/database.rb:46\n        c:0057 p:0005 s:0328 e:000327 METHOD /Users/vhiairrassary/Code/vhiairrassary/debug-duckdb-with-solid-queue/app/jobs/debug_job.rb:3\n        c:0056 p:0008 s:0324 e:000323 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/execution.rb:68\n        c:0055 p:0048 s:0321 e:000319 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:120\n        c:0054 p:0026 s:0311 e:000310 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/i18n-1.14.7/lib/i18n.rb:353\n        c:0053 p:0011 s:0305 e:000304 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/translation.rb:9 [FINISH]\n        c:0052 p:---- s:0300 e:000299 CFUNC  :instance_exec\n        c:0051 p:0127 s:0294 e:000293 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:129\n        c:0050 p:0027 s:0285 e:000284 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/core_ext/time/zones.\n        c:0049 p:0011 s:0278 e:000277 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/timezones.rb:9 [FINISH]\n        c:0048 p:---- s:0273 e:000272 CFUNC  :instance_exec\n        c:0047 p:0127 s:0267 e:000266 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:129\n        c:0046 p:0110 s:0258 E:0021a0 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:140\n        c:0045 p:0014 s:0248 E:002210 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/execution.rb:67\n        c:0044 p:0010 s:0244 e:000243 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/instrumentation.rb:32\n        c:0043 p:0022 s:0240 e:000239 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/execution.rb:51\n        c:0042 p:0004 s:0234 e:000233 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/instrumentation.rb:26\n        c:0041 p:0011 s:0231 e:000230 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activerecord-8.0.2/lib/active_record/railties/job_runtime.r\n        c:0040 p:0011 s:0226 e:000225 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/instrumentation.rb:40\n        c:0039 p:0010 s:0222 e:000221 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/notifications.rb:210\n        c:0038 p:0027 s:0219 e:000218 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/notifications/instru\n        c:0037 p:0023 s:0211 e:000210 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/notifications.rb:210\n        c:0036 p:0039 s:0205 e:000204 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/instrumentation.rb:39\n        c:0035 p:0025 s:0198 E:002648 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activerecord-8.0.2/lib/active_record/railties/job_runtime.r\n        c:0034 p:0006 s:0191 E:002610 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/instrumentation.rb:26\n        c:0033 p:0004 s:0187 e:000186 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/logging.rb:32\n        c:0032 p:0003 s:0184 e:000183 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/tagged_logging.rb:14\n        c:0031 p:0014 s:0181 e:000180 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/tagged_logging.rb:38\n        c:0030 p:0015 s:0175 e:000174 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/tagged_logging.rb:14\n        c:0029 p:0052 s:0169 e:000168 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/broadcast_logger.rb:\n        c:0028 p:0034 s:0159 e:000158 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/logging.rb:39\n        c:0027 p:0012 s:0153 e:000152 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/logging.rb:32\n        c:0026 p:0011 s:0149 e:000148 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/execution.rb:29\n        c:0025 p:0048 s:0145 e:000143 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:120\n        c:0024 p:0004 s:0135 e:000134 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/railtie.rb:95\n        c:0023 p:0008 s:0132 e:000131 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/reloader.rb:77\n        c:0022 p:0016 s:0128 e:000127 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/execution_wrapper.rb\n        c:0021 p:0016 s:0120 e:000119 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/reloader.rb:74\n        c:0020 p:0008 s:0115 e:000114 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/railtie.rb:94 [FINISH]\n        c:0019 p:---- s:0110 e:000109 CFUNC  :instance_exec\n        c:0018 p:0127 s:0104 e:000103 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:129\n        c:0017 p:0110 s:0095 E:0012f0 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:140\n        c:0016 p:0007 s:0085 E:001168 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/execution.rb:27\n        c:0015 p:0020 s:0080 E:002438 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/solid_queue-1.2.1/app/models/solid_queue/claimed_execution.\n        c:0014 p:0003 s:0075 E:0007b8 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/solid_queue-1.2.1/app/models/solid_queue/claimed_execution.\n        c:0013 p:0005 s:0070 E:0014f0 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/solid_queue-1.2.1/lib/solid_queue/pool.rb:23\n        c:0012 p:0024 s:0067 E:001eb0 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/execution_wrapper.rb\n        c:0011 p:0018 s:0059 E:000818 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/solid_queue-1.2.1/lib/solid_queue/app_executor.rb:7\n        c:0010 p:0005 s:0054 E:0007e8 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/solid_queue-1.2.1/lib/solid_queue/pool.rb:22\n        c:0009 p:0011 s:0050 E:000128 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/promis\n        c:0008 p:0011 s:0041 E:000850 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/promis\n        c:0007 p:0008 s:0036 E:002230 METHOD /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/execut\n        c:0006 p:0041 s:0028 E:0010a8 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/execut\n        c:0005 p:0017 s:0022 E:0020c8 METHOD <internal:kernel>:168\n        c:0004 p:0004 s:0017 E:001800 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/execut [FINISH]\n        c:0003 p:---- s:0014 e:000013 CFUNC  :catch\n        c:0002 p:0006 s:0009 E:0017d8 BLOCK  /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/execut [FINISH]\n        c:0001 p:---- s:0003 e:000002 DUMMY  [FINISH]\n        \n        -- Ruby level backtrace information ----------------------------------------\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/executor/ruby_thread_pool_executor.rb:340:in 'block in create_worker'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/executor/ruby_thread_pool_executor.rb:340:in 'catch'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/executor/ruby_thread_pool_executor.rb:341:in 'block (2 levels) in create_worker'\n        <internal:kernel>:168:in 'loop'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/executor/ruby_thread_pool_executor.rb:350:in 'block (3 levels) in create_worker'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/executor/ruby_thread_pool_executor.rb:359:in 'run_task'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/promises.rb:1776:in 'block in on_resolvable'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/concurrent-ruby-1.3.5/lib/concurrent-ruby/concurrent/promises.rb:1593:in 'evaluate_to'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/solid_queue-1.2.1/lib/solid_queue/pool.rb:22:in 'block in post'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/solid_queue-1.2.1/lib/solid_queue/app_executor.rb:7:in 'wrap_in_app_executor'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/execution_wrapper.rb:91:in 'wrap'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/solid_queue-1.2.1/lib/solid_queue/pool.rb:23:in 'block (2 levels) in post'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/solid_queue-1.2.1/app/models/solid_queue/claimed_execution.rb:64:in 'perform'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/solid_queue-1.2.1/app/models/solid_queue/claimed_execution.rb:102:in 'execute'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/execution.rb:27:in 'execute'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:140:in 'run_callbacks'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:129:in 'block in run_callbacks'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:129:in 'instance_exec'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/railtie.rb:94:in 'block (3 levels) in <class:Railtie>'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/reloader.rb:74:in 'wrap'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/execution_wrapper.rb:87:in 'wrap'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/reloader.rb:77:in 'block in wrap'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/railtie.rb:95:in 'block (4 levels) in <class:Railtie>'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:120:in 'block in run_callbacks'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/execution.rb:29:in 'block in execute'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/logging.rb:32:in 'perform_now'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/logging.rb:39:in 'tag_logger'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/broadcast_logger.rb:241:in 'method_missing'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/tagged_logging.rb:143:in 'tagged'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/tagged_logging.rb:38:in 'tagged'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/tagged_logging.rb:143:in 'block in tagged'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/logging.rb:32:in 'block in perform_now'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/instrumentation.rb:26:in 'perform_now'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activerecord-8.0.2/lib/active_record/railties/job_runtime.rb:11:in 'instrument'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/instrumentation.rb:39:in 'instrument'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/notifications.rb:210:in 'instrument'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/notifications/instrumenter.rb:58:in 'instrument'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/notifications.rb:210:in 'block in instrument'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/instrumentation.rb:40:in 'block in instrument'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activerecord-8.0.2/lib/active_record/railties/job_runtime.rb:13:in 'block in instrument'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/instrumentation.rb:26:in 'block in perform_now'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/execution.rb:51:in 'perform_now'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/instrumentation.rb:32:in '_perform_job'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/execution.rb:67:in '_perform_job'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:140:in 'run_callbacks'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:129:in 'block in run_callbacks'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:129:in 'instance_exec'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/timezones.rb:9:in 'block (2 levels) in <module:Timezones>'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/core_ext/time/zones.rb:65:in 'use_zone'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:129:in 'block in run_callbacks'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:129:in 'instance_exec'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/translation.rb:9:in 'block (2 levels) in <module:Translation>'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/i18n-1.14.7/lib/i18n.rb:353:in 'with_locale'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activesupport-8.0.2/lib/active_support/callbacks.rb:120:in 'block in run_callbacks'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/activejob-8.0.2/lib/active_job/execution.rb:68:in 'block in _perform_job'\n        /Users/vhiairrassary/Code/vhiairrassary/debug-duckdb-with-solid-queue/app/jobs/debug_job.rb:3:in 'perform'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/database.rb:46:in 'open'\n        /Users/vhiairrassary/Code/vhiairrassary/debug-duckdb-with-solid-queue/app/jobs/debug_job.rb:4:in 'block in perform'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/database.rb:79:in 'connect'\n        /Users/vhiairrassary/Code/vhiairrassary/debug-duckdb-with-solid-queue/app/jobs/debug_job.rb:8:in 'block (2 levels) in perform'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/connection.rb:27:in 'query'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/connection.rb:38:in 'query_multi_sql'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/extracted_statements.rb:15:in 'each'\n        <internal:numeric>:257:in 'times'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/extracted_statements.rb:16:in 'block in each'\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/ruby/gems/3.4.0/gems/duckdb-1.3.1.0/lib/duckdb/extracted_statements.rb:16:in 'prepared_statement'\n        \n        -- Threading information ---------------------------------------------------\n        Total ractor count: 1\n        Ruby thread count for this ractor: 4\n        \n        -- Machine register context ------------------------------------------------\n          x0: 0x00000001218f42d0  x1: 0x00000001218f42d0  x2: 0x0000000000000001\n          x3: 0x0000000000000001  x4: 0x0000000196888024  x5: 0x0000000000000001\n          x6: 0x0000000121e9e260  x7: 0x0000000000000cb0 x18: 0x0000000000000000\n         x19: 0x0000000204b82000 x20: 0x000000016fa470e0 x21: 0x000000016fa47180\n         x22: 0x0000000121e9fcf0 x23: 0x0000000121e9fcf0 x24: 0x0000000121e9fcb0\n         x25: 0x00000000100008ff x26: 0x0000000121e9fcf0 x27: 0x0000000000000001\n         x28: 0x0000000000000104  lr: 0x00000001968cad84  fp: 0x000000016fa3f9c0\n          sp: 0x000000016fa3f910\n        \n        -- C level backtrace information -------------------------------------------\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/libruby.3.4.dylib(rb_vm_bugreport+0xb6c) [0x10160f8c8]\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/libruby.3.4.dylib(rb_bug_for_fatal_signal+0x100) [0x10144a600]\n        /Users/vhiairrassary/.rbenv/versions/3.4.5/lib/libruby.3.4.dylib(sigsegv+0x84) [0x10157048c]\n        /usr/lib/system/libsystem_platform.dylib(_sigtramp+0x38) [0x196aa8624]\n        /usr/lib/system/libdispatch.dylib(_dispatch_apply_with_attr_f+0x4f8) [0x1968cad84]\n        [0x1968caf34]\n        [0x196c8ed98]\n        [0x196b0f2d8]\n        [0x196cd14a0]\n        [0x196b0dbe4]\n        [0x196b0d8f4]\n        [0x196b0d47c]\n        [0x196b0d3b4]\n        [0x196b0d370]\n        [0x196b069b8]\n        [0x196c8f54c]\n        [0x196b06328]\n        [0x196b06260]\n        [0x197d671a0]\n        [0x1538daa90]\n        [0x1538da290]\n        [0x153abca88]\n        ```\n      </details>\n\nI am trying to simplify the example and find the root cause.","reactions":{"url":"https://api.github.com/repos/suketa/ruby-duckdb/issues/974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/suketa/ruby-duckdb/issues/974/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]