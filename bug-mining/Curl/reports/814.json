{"url":"https://api.github.com/repos/curl/curl/issues/19029","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/19029/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/19029/comments","events_url":"https://api.github.com/repos/curl/curl/issues/19029/events","html_url":"https://github.com/curl/curl/issues/19029","id":3506571512,"node_id":"I_kwDOAAiu0c7RAgj4","number":19029,"title":"\"fail-with-body\" in .curlrc is tempting but breaks scripts (including wcurl)","user":{"login":"mitchblank","id":1515225,"node_id":"MDQ6VXNlcjE1MTUyMjU=","avatar_url":"https://avatars.githubusercontent.com/u/1515225?v=4","gravatar_id":"","url":"https://api.github.com/users/mitchblank","html_url":"https://github.com/mitchblank","followers_url":"https://api.github.com/users/mitchblank/followers","following_url":"https://api.github.com/users/mitchblank/following{/other_user}","gists_url":"https://api.github.com/users/mitchblank/gists{/gist_id}","starred_url":"https://api.github.com/users/mitchblank/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitchblank/subscriptions","organizations_url":"https://api.github.com/users/mitchblank/orgs","repos_url":"https://api.github.com/users/mitchblank/repos","events_url":"https://api.github.com/users/mitchblank/events{/privacy}","received_events_url":"https://api.github.com/users/mitchblank/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":192912238,"node_id":"MDU6TGFiZWwxOTI5MTIyMzg=","url":"https://api.github.com/repos/curl/curl/labels/cmdline%20tool","name":"cmdline tool","color":"006b75","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2025-10-12T02:18:13Z","updated_at":"2025-10-13T08:38:52Z","closed_at":"2025-10-13T08:38:52Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\nI was debating about whether to file this as a bug on curl or wcurl.  Ultimately I think the root cause is poor option handing in the curl command line.\n\nI recently updated my `$HOME/.curlrc` file to include the newish `fail-with-body` option.  Maybe this isn't recommended, but it seemed like a better default.  I sometimes use the curl command to interactively test web APIs so seeing failure bodies is nice.\n\nI forgot about this for a long time but then I found that `wcurl` was failing in a weird way:\n```sh\n$ wcurl https://curl.se/docs/projdocs.html\ncurl: option --fail: is badly used here\ncurl: try 'curl --help' or 'curl --manual' for more information\n```\nOf course the problem was obvious once I remembered the `.curlrc` change, but it took some investigation first.\n\n### I expected the following\n\nI think there are a couple things that could be improved.\n\nFirst, the error message \"--fail: is badly used here\" wasn't very helpful.  If it has said something like \"--fail cannot be combined with --fail-with-body\" I probably would have diagnosed the problem quicker.\n\nSecond, if the flags are to be mutually exclusive then that should probably only apply when they're both specified in the same place.  It seems reasonable that curl disallows `curl --fail-with-body --fail`, but it also seems that `--fail` on the command line should just override `fail-with-body` in `$HOME/.curlrc` without complaint.  Otherwise it is impossible to use either `--fail` option in a script without risking breakage from curlrc.\n\n### curl/libcurl version\n\ncurl 8.16.0\n\n### operating system\n\nMacOS 26.0.1 + curl from Homebrew","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/19029/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/19029/timeline","performed_via_github_app":null,"state_reason":"completed"}