{"url":"https://api.github.com/repos/curl/curl/issues/15149","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/15149/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/15149/comments","events_url":"https://api.github.com/repos/curl/curl/issues/15149/events","html_url":"https://github.com/curl/curl/issues/15149","id":2566234232,"node_id":"I_kwDOAAiu0c6Y9aB4","number":15149,"title":"curl using SChannel fails to validate TLS cert by IP SAN","user":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118221,"node_id":"MDU6TGFiZWwxODQxMTgyMjE=","url":"https://api.github.com/repos/curl/curl/labels/TLS","name":"TLS","color":"bfdadc","default":false,"description":""},{"id":352090567,"node_id":"MDU6TGFiZWwzNTIwOTA1Njc=","url":"https://api.github.com/repos/curl/curl/labels/KNOWN_BUGS%20material","name":"KNOWN_BUGS material","color":"d93f0b","default":false,"description":null},{"id":657824945,"node_id":"MDU6TGFiZWw2NTc4MjQ5NDU=","url":"https://api.github.com/repos/curl/curl/labels/help%20wanted","name":"help wanted","color":"fbca04","default":true,"description":null},{"id":940032249,"node_id":"MDU6TGFiZWw5NDAwMzIyNDk=","url":"https://api.github.com/repos/curl/curl/labels/Windows","name":"Windows","color":"0e8a16","default":false,"description":"Windows-specific"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-10-04T12:15:26Z","updated_at":"2024-10-31T19:24:48Z","closed_at":"2024-10-31T08:00:25Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Discussed in https://github.com/curl/curl/discussions/15139\r\n\r\n<div type='discussions-op-text'>\r\n\r\n<sup>Originally posted by **elvinasp** October  3, 2024</sup>\r\nHello,\r\n\r\nI was making some networking labs and one of the examples was to connect via curl using various hosntname combinations and seeing how SNI behaves. When I connected to demo server IP address using windows build-in curl, it failed to validate certificate. Linux curl from WSL environment on same machine successfully connects to service via IP and validated TLS cert. \r\n\r\nHas anything changed since v7 to v8?\r\n\r\nAttaching certs generated with cfssl: [certs.zip](https://github.com/user-attachments/files/17242012/certs.zip)\r\n\r\nWindows curl: \r\n`curl 8.7.1 (Windows) libcurl/8.7.1 Schannel zlib/1.3 WinIDN\r\nRelease-Date: 2024-03-27\r\nProtocols: dict file ftp ftps http https imap imaps ipfs ipns mqtt pop3 pop3s smb smbs smtp smtps telnet tftp\r\nFeatures: alt-svc AsynchDNS HSTS HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTLM SPNEGO SSL SSPI threadsafe Unicode UnixSockets`\r\n\r\nOutput:\r\n```\r\n* schannel: added 2 certificate(s) from CA file './combined-ca.crt'\r\n* schannel: connection hostname (192.168.4.2) did not match against certificate name (default.tp13.internal)\r\n* schannel: connection hostname (192.168.4.2) did not match against certificate name (default)\r\n* schannel: CertGetNameString() failed to match connection hostname (192.168.4.2) against server certificate names\r\n* Closing connection\r\n* schannel: shutting down SSL/TLS connection with 192.168.4.2 port 8443\r\ncurl: (60) schannel: CertGetNameString() failed to match connection hostname (192.168.4.2) against server certificate names\r\n```\r\n\r\nTLS certificate:\r\n\r\nProperly lists all SANS:\r\n```\r\n            X509v3 Subject Alternative Name:\r\n                DNS:default.tp13.internal, DNS:default, IP Address:192.168.4.3, IP Address:192.168.4.2, IP Address:10.20.3.1\r\n```\r\n</div>","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/15149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/15149/timeline","performed_via_github_app":null,"state_reason":"completed"}