{"url":"https://api.github.com/repos/curl/curl/issues/12148","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/12148/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/12148/comments","events_url":"https://api.github.com/repos/curl/curl/issues/12148/events","html_url":"https://github.com/curl/curl/issues/12148","id":1948016065,"node_id":"I_kwDOAAiu0c50HF3B","number":12148,"title":"IPFS/IPNS URLs ignore the path","user":{"login":"Stebalien","id":310393,"node_id":"MDQ6VXNlcjMxMDM5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/310393?v=4","gravatar_id":"","url":"https://api.github.com/users/Stebalien","html_url":"https://github.com/Stebalien","followers_url":"https://api.github.com/users/Stebalien/followers","following_url":"https://api.github.com/users/Stebalien/following{/other_user}","gists_url":"https://api.github.com/users/Stebalien/gists{/gist_id}","starred_url":"https://api.github.com/users/Stebalien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stebalien/subscriptions","organizations_url":"https://api.github.com/users/Stebalien/orgs","repos_url":"https://api.github.com/users/Stebalien/repos","events_url":"https://api.github.com/users/Stebalien/events{/privacy}","received_events_url":"https://api.github.com/users/Stebalien/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":192912238,"node_id":"MDU6TGFiZWwxOTI5MTIyMzg=","url":"https://api.github.com/repos/curl/curl/labels/cmdline%20tool","name":"cmdline tool","color":"006b75","default":false,"description":null},{"id":6096932576,"node_id":"LA_kwDOAAiu0c8AAAABa2fO4A","url":"https://api.github.com/repos/curl/curl/labels/IPFS","name":"IPFS","color":"611E7A","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2023-10-17T18:31:36Z","updated_at":"2023-11-05T10:00:19Z","closed_at":"2023-11-05T10:00:19Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\nI run:\r\n\r\n`curl -v ipns://ipfs.tech/community`\r\n\r\nI get:\r\n\r\n```\r\n*   Trying [::1]:8080...\r\n* Connected to localhost (::1) port 8080\r\n> GET /ipns/ipfs.tech HTTP/1.1\r\n> Host: localhost:8080\r\n> User-Agent: curl/8.4.0\r\n> Accept: */*\r\n> \r\n< HTTP/1.1 301 Moved Permanently\r\n< Access-Control-Allow-Headers: Content-Type\r\n< Access-Control-Allow-Headers: Range\r\n< Access-Control-Allow-Headers: User-Agent\r\n< Access-Control-Allow-Headers: X-Requested-With\r\n< Access-Control-Allow-Methods: GET\r\n< Access-Control-Allow-Methods: HEAD\r\n< Access-Control-Allow-Methods: OPTIONS\r\n< Access-Control-Allow-Origin: *\r\n< Access-Control-Expose-Headers: Content-Length\r\n< Access-Control-Expose-Headers: Content-Range\r\n< Access-Control-Expose-Headers: X-Chunked-Output\r\n< Access-Control-Expose-Headers: X-Ipfs-Path\r\n< Access-Control-Expose-Headers: X-Ipfs-Roots\r\n< Access-Control-Expose-Headers: X-Stream-Output\r\n< Content-Type: text/html; charset=utf-8\r\n< Location: /ipns/ipfs.tech/\r\n< X-Ipfs-Path: /ipns/ipfs.tech\r\n< X-Ipfs-Roots: QmbMTqnawMAbD4Fzgd5NM9GpKT67FdNZ1EsH8D4r52PTeT\r\n< Date: Tue, 17 Oct 2023 18:26:48 GMT\r\n< Content-Length: 51\r\n< \r\n<a href=\"/ipns/ipfs.tech/\">Moved Permanently</a>.\r\n```\r\n\r\nThe same goes for all `ipfs://` urls:\r\n\r\n`curl -v ipfs://bafybeiaysi4s6lnjev27ln5icwm6tueaw2vdykrtjkwiphwekaywqhcjze/wiki/cURL`\r\n\r\nOutput:\r\n\r\n```\r\n*   Trying [::1]:8080...\r\n* Connected to localhost (::1) port 8080\r\n> GET /ipfs/bafybeiaysi4s6lnjev27ln5icwm6tueaw2vdykrtjkwiphwekaywqhcjze HTTP/1.1\r\n> Host: localhost:8080\r\n> User-Agent: curl/8.4.0\r\n> Accept: */*\r\n> \r\n< HTTP/1.1 301 Moved Permanently\r\n< Access-Control-Allow-Headers: Content-Type\r\n< Access-Control-Allow-Headers: Range\r\n< Access-Control-Allow-Headers: User-Agent\r\n< Access-Control-Allow-Headers: X-Requested-With\r\n< Access-Control-Allow-Methods: GET\r\n< Access-Control-Allow-Methods: HEAD\r\n< Access-Control-Allow-Methods: OPTIONS\r\n< Access-Control-Allow-Origin: *\r\n< Access-Control-Expose-Headers: Content-Length\r\n< Access-Control-Expose-Headers: Content-Range\r\n< Access-Control-Expose-Headers: X-Chunked-Output\r\n< Access-Control-Expose-Headers: X-Ipfs-Path\r\n< Access-Control-Expose-Headers: X-Ipfs-Roots\r\n< Access-Control-Expose-Headers: X-Stream-Output\r\n< Content-Type: text/html; charset=utf-8\r\n< Location: /ipfs/bafybeiaysi4s6lnjev27ln5icwm6tueaw2vdykrtjkwiphwekaywqhcjze/\r\n< X-Ipfs-Path: /ipfs/bafybeiaysi4s6lnjev27ln5icwm6tueaw2vdykrtjkwiphwekaywqhcjze\r\n< X-Ipfs-Roots: bafybeiaysi4s6lnjev27ln5icwm6tueaw2vdykrtjkwiphwekaywqhcjze\r\n< Date: Tue, 17 Oct 2023 18:28:37 GMT\r\n< Content-Length: 101\r\n< \r\n<a href=\"/ipfs/bafybeiaysi4s6lnjev27ln5icwm6tueaw2vdykrtjkwiphwekaywqhcjze/\">Moved Permanently</a>.\r\n```\n\n### I expected the following\n\nI'd expect curl to fetch the _requested_ pages. Instead, it ignores the entire path and tries to fetch the root CID/domain.\r\n\r\nE.g., in the first request, I should see:\r\n\r\n```\r\n> GET /ipns/ipfs.tech/community HTTP/1.1\r\n```\r\n\r\nBut instead I see:\r\n\r\n```\r\n> GET /ipns/ipfs.tech HTTP/1.1\r\n```\n\n### curl/libcurl version\n\ncurl 8.4.0\n\n### operating system\n\nArch Linux","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/12148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/12148/timeline","performed_via_github_app":null,"state_reason":"completed"}