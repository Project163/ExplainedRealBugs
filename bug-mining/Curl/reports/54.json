{"url":"https://api.github.com/repos/curl/curl/issues/9300","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/9300/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/9300/comments","events_url":"https://api.github.com/repos/curl/curl/issues/9300/events","html_url":"https://github.com/curl/curl/issues/9300","id":1336871382,"node_id":"I_kwDOAAiu0c5PrwnW","number":9300,"title":"RSA key file leak in C:\\ProgramData\\Microsoft\\Crypto\\RSA\\S-1-5-18","user":{"login":"ShadowZzj","id":22760144,"node_id":"MDQ6VXNlcjIyNzYwMTQ0","avatar_url":"https://avatars.githubusercontent.com/u/22760144?v=4","gravatar_id":"","url":"https://api.github.com/users/ShadowZzj","html_url":"https://github.com/ShadowZzj","followers_url":"https://api.github.com/users/ShadowZzj/followers","following_url":"https://api.github.com/users/ShadowZzj/following{/other_user}","gists_url":"https://api.github.com/users/ShadowZzj/gists{/gist_id}","starred_url":"https://api.github.com/users/ShadowZzj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ShadowZzj/subscriptions","organizations_url":"https://api.github.com/users/ShadowZzj/orgs","repos_url":"https://api.github.com/users/ShadowZzj/repos","events_url":"https://api.github.com/users/ShadowZzj/events{/privacy}","received_events_url":"https://api.github.com/users/ShadowZzj/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118221,"node_id":"MDU6TGFiZWwxODQxMTgyMjE=","url":"https://api.github.com/repos/curl/curl/labels/TLS","name":"TLS","color":"bfdadc","default":false,"description":""},{"id":940032249,"node_id":"MDU6TGFiZWw5NDAwMzIyNDk=","url":"https://api.github.com/repos/curl/curl/labels/Windows","name":"Windows","color":"0e8a16","default":false,"description":"Windows-specific"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":25,"created_at":"2022-08-12T07:46:58Z","updated_at":"2022-10-11T08:05:32Z","closed_at":"2022-10-11T08:05:32Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I use this code to perform tls mutual authentication. It works. However, anytime curl_easy_perform returns, there is a file generated in  C:\\ProgramData\\Microsoft\\Crypto\\RSA\\S-1-5-18. And curl_easy_cleanup doesn't delete the file.  Is this a bug or there is a attribute that I can set to auto delete the file ?\r\n~~~c\r\n   CURL *curl = curl_easy_init();\r\n    CURLcode res;\r\n    int result = 0;\r\n    char errBuf[CURL_ERROR_SIZE]{0};\r\n    char *version = curl_version();\r\n\r\n    struct curl_slist *http_headers = NULL;\r\n    ret                             = \"\";\r\n    http_headers = curl_slist_append(http_headers, \"Accept: application/json\");\r\n    http_headers = curl_slist_append(http_headers, \"Content-Type: application/json\");\r\n    http_headers = curl_slist_append(http_headers, \"charsets: utf-8\");\r\n    curl_easy_setopt(curl, CURLOPT_HTTPHEADER, http_headers);\r\n\r\n    curl_easy_setopt(curl, CURLOPT_URL, apiPath);\r\n    curl_easy_setopt(curl, CURLOPT_POSTFIELDS, str);\r\n    curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, WriteData);\r\n    curl_easy_setopt(curl, CURLOPT_WRITEDATA, &ret);\r\n    curl_easy_setopt(curl, CURLOPT_POST, 1);\r\n    curl_easy_setopt(curl, CURLOPT_FOLLOWLOCATION, 1);\r\n    curl_easy_setopt(curl, CURLOPT_ERRORBUFFER, errBuf);\r\n\r\n    curl_easy_setopt(curl, CURLOPT_CONNECTTIMEOUT, 60);\r\n    curl_easy_setopt(curl, CURLOPT_TIMEOUT, 60);\r\n    curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, true);\r\n    curl_easy_setopt(curl, CURLOPT_SSL_VERIFYHOST, true);\r\n    curl_easy_setopt(curl, CURLOPT_SSLCERTTYPE, \"P12\");\r\n    curl_easy_setopt(curl, CURLOPT_SSLCERT, personalCertificateFile.c_str());\r\n    curl_easy_setopt(curl, CURLOPT_KEYPASSWD, passwd.c_str());\r\n    res = curl_easy_perform(curl);\r\n    curl_slist_free_all(http_headers);\r\n    curl_easy_cleanup(curl);\r\n    return result;\r\n~~~\r\n### I expected the following\r\n\r\n### curl/libcurl version\r\n7.85.0-DEV\r\n\r\n### operating system\r\nWindows 10\r\n\r\n","closed_by":{"login":"jay","id":965580,"node_id":"MDQ6VXNlcjk2NTU4MA==","avatar_url":"https://avatars.githubusercontent.com/u/965580?v=4","gravatar_id":"","url":"https://api.github.com/users/jay","html_url":"https://github.com/jay","followers_url":"https://api.github.com/users/jay/followers","following_url":"https://api.github.com/users/jay/following{/other_user}","gists_url":"https://api.github.com/users/jay/gists{/gist_id}","starred_url":"https://api.github.com/users/jay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jay/subscriptions","organizations_url":"https://api.github.com/users/jay/orgs","repos_url":"https://api.github.com/users/jay/repos","events_url":"https://api.github.com/users/jay/events{/privacy}","received_events_url":"https://api.github.com/users/jay/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/9300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/9300/timeline","performed_via_github_app":null,"state_reason":"completed"}