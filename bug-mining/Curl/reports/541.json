{"url":"https://api.github.com/repos/curl/curl/issues/14860","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/14860/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/14860/comments","events_url":"https://api.github.com/repos/curl/curl/issues/14860/events","html_url":"https://github.com/curl/curl/issues/14860","id":2519438579,"node_id":"I_kwDOAAiu0c6WK5Tz","number":14860,"title":"Application segfault in 8.10.0","user":{"login":"carlocab","id":30379873,"node_id":"MDQ6VXNlcjMwMzc5ODcz","avatar_url":"https://avatars.githubusercontent.com/u/30379873?v=4","gravatar_id":"","url":"https://api.github.com/users/carlocab","html_url":"https://github.com/carlocab","followers_url":"https://api.github.com/users/carlocab/followers","following_url":"https://api.github.com/users/carlocab/following{/other_user}","gists_url":"https://api.github.com/users/carlocab/gists{/gist_id}","starred_url":"https://api.github.com/users/carlocab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carlocab/subscriptions","organizations_url":"https://api.github.com/users/carlocab/orgs","repos_url":"https://api.github.com/users/carlocab/repos","events_url":"https://api.github.com/users/carlocab/events{/privacy}","received_events_url":"https://api.github.com/users/carlocab/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118205,"node_id":"MDU6TGFiZWwxODQxMTgyMDU=","url":"https://api.github.com/repos/curl/curl/labels/crash","name":"crash","color":"bfe5bf","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":25,"created_at":"2024-09-11T11:12:05Z","updated_at":"2024-11-01T23:45:15Z","closed_at":"2024-09-11T21:06:52Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\r\n\r\nWe're upgrading Homebrew's version of `curl` to 8.10.0. When testing dependents, we found this error from [`julia`](https://github.com/JuliaLang/julia):\r\n\r\n<details>\r\n<summary>Backtrace</summary>\r\n\r\n```\r\n  ==> /opt/homebrew/Cellar/julia/1.10.5/bin/julia --startup-file=no --history-file=no --project=/private/tmp/julia-test-20240911-23434-72ttcc --procs 3 --eval using Pkg; Pkg.add(\"Example\")\r\n    Installing known registries into `~/.julia`\r\n         Added `General` registry to ~/.julia/registries\r\n      Updating registry at `~/.julia/registries/General.toml`\r\n     Resolving package versions...\r\n     Installed Example ─ v0.5.3\r\n      Updating `~/Project.toml`\r\n    [7876af07] + Example v0.5.3\r\n      Updating `~/Manifest.toml`\r\n    [7876af07] + Example v0.5.3\r\n  Precompiling project...\r\n    ✓ Example\r\n    1 dependency successfully precompiled in 1 seconds\r\n  \r\n  [23470] signal (11.2): Segmentation fault: 11\r\n  in expression starting at none:0\r\n  Curl_hash_pick at /opt/homebrew/Cellar/curl/8.10.0/lib/libcurl.4.dylib (unknown line)\r\n  curl_multi_assign at /opt/homebrew/Cellar/curl/8.10.0/lib/libcurl.4.dylib (unknown line)\r\n  julia_socket_callback_92891.1 at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/sys.dylib (unknown line)\r\n  jfptr_socket_callback_92892.1 at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/sys.dylib (unknown line)\r\n  ijl_apply_generic at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/libjulia-internal.1.10.5.dylib (unknown line)\r\n  jlcapi_socket_callback_92823.1 at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/sys.dylib (unknown line)\r\n  Curl_multi_pollset_ev at /opt/homebrew/Cellar/curl/8.10.0/lib/libcurl.4.dylib (unknown line)\r\n  cpool_update_shutdown_ev at /opt/homebrew/Cellar/curl/8.10.0/lib/libcurl.4.dylib (unknown line)\r\n  cpool_discard_conn at /opt/homebrew/Cellar/curl/8.10.0/lib/libcurl.4.dylib (unknown line)\r\n  Curl_cpool_destroy at /opt/homebrew/Cellar/curl/8.10.0/lib/libcurl.4.dylib (unknown line)\r\n  curl_multi_cleanup at /opt/homebrew/Cellar/curl/8.10.0/lib/libcurl.4.dylib (unknown line)\r\n  jlplt_curl_multi_cleanup_67119.1 at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/sys.dylib (unknown line)\r\n  julia_YY.31_92837.1 at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/sys.dylib (unknown line)\r\n  jfptr_YY.31_92838.1 at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/sys.dylib (unknown line)\r\n  ijl_apply_generic at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/libjulia-internal.1.10.5.dylib (unknown line)\r\n  julia__atexit_79291.1 at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/sys.dylib (unknown line)\r\n  jfptr__atexit_79292.1 at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/sys.dylib (unknown line)\r\n  ijl_apply_generic at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/libjulia-internal.1.10.5.dylib (unknown line)\r\n  ijl_atexit_hook at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/libjulia-internal.1.10.5.dylib (unknown line)\r\n  jl_repl_entrypoint at /opt/homebrew/Cellar/julia/1.10.5/lib/julia/libjulia-internal.1.10.5.dylib (unknown line)\r\n  Allocations: 11678659 (Pool: 11669911; Big: 8748); GC: 18\r\n```\r\n\r\n</details>\r\n\r\nComplete logs are available [here](https://github.com/Homebrew/homebrew-core/actions/runs/10806031163?pr=186235). The referenced error starts [here](https://github.com/Homebrew/homebrew-core/actions/runs/10806031163/job/29977053272?pr=186235#step:3:284) on macOS 14 arm64.\r\n\r\nI am unsure if the problem is in `curl` or in `julia`, but it seems like the segfault is happening inside `Curl_hash_pick`.\r\n\r\n### I expected the following\r\n\r\nNo segfault. The segfault doesn't occur with `curl` 8.9.1.\r\n\r\n### curl/libcurl version\r\n\r\n```\r\ncurl 8.10.0 (aarch64-apple-darwin23.6.0) libcurl/8.10.0 OpenSSL/3.3.2 (SecureTransport) zlib/1.2.12 brotli/1.1.0 zstd/1.5.6 libidn2/2.3.7 libssh2/1.11.0 nghttp2/1.63.0 librtmp/2.3\r\nRelease-Date: 2024-09-11\r\nProtocols: dict file ftp ftps gopher gophers http https imap imaps ipfs ipns ldap ldaps mqtt pop3 pop3s rtmp rtsp scp sftp smb smbs smtp smtps telnet tftp\r\nFeatures: alt-svc AsynchDNS brotli GSS-API HSTS HTTP2 HTTPS-proxy IDN IPv6 Kerberos Largefile libz MultiSSL NTLM SPNEGO SSL threadsafe TLS-SRP UnixSockets zstd\r\n```\r\n\r\n### operating system\r\n\r\n```\r\nDarwin Frontier.local 23.6.0 Darwin Kernel Version 23.6.0: Mon Jul 29 21:14:46 PDT 2024; root:xnu-10063.141.2~1/RELEASE_ARM64_T6031 arm64\r\n```\r\n\r\nBut note that this occurs on multiple other versions of macOS (macOS 12, 13, and 14 on both Intel and ARM64). We haven't yet been able to verify that this happens on Linux, but I will check this later.","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/14860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/14860/timeline","performed_via_github_app":null,"state_reason":"completed"}