{"url":"https://api.github.com/repos/curl/curl/issues/9847","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/9847/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/9847/comments","events_url":"https://api.github.com/repos/curl/curl/issues/9847/events","html_url":"https://github.com/curl/curl/issues/9847","id":1434030111,"node_id":"I_kwDOAAiu0c5VeZAf","number":9847,"title":"build for AppleTVOS failed because of fork/execl is unavailable","user":{"login":"Cering","id":9027486,"node_id":"MDQ6VXNlcjkwMjc0ODY=","avatar_url":"https://avatars.githubusercontent.com/u/9027486?v=4","gravatar_id":"","url":"https://api.github.com/users/Cering","html_url":"https://github.com/Cering","followers_url":"https://api.github.com/users/Cering/followers","following_url":"https://api.github.com/users/Cering/following{/other_user}","gists_url":"https://api.github.com/users/Cering/gists{/gist_id}","starred_url":"https://api.github.com/users/Cering/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Cering/subscriptions","organizations_url":"https://api.github.com/users/Cering/orgs","repos_url":"https://api.github.com/users/Cering/repos","events_url":"https://api.github.com/users/Cering/events{/privacy}","received_events_url":"https://api.github.com/users/Cering/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118182,"node_id":"MDU6TGFiZWwxODQxMTgxODI=","url":"https://api.github.com/repos/curl/curl/labels/build","name":"build","color":"bfdadc","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-11-03T02:55:00Z","updated_at":"2022-11-05T23:05:48Z","closed_at":"2022-11-05T23:05:48Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!-- Only file bugs here! Ask questions on the mailing lists https://curl.se/mail/\r\n\r\n     SECURITY RELATED? Post it here: https://hackerone.com/curl\r\n\r\n     There are collections of known issues to be aware of:\r\n     https://curl.se/docs/knownbugs.html\r\n     https://curl.se/docs/todo.html       -->\r\n\r\n### I did this\r\n- build curl for AppleTVOS like this:\r\n```bash\r\n#!/bin/bash\r\n\r\narch=arm64\r\nhost=arm-apple-darwin\r\nsdkName=appletvos\r\nsdkPath=$(xcrun -sdk ${sdkName} --show-sdk-path)\r\n\r\nexport DEPLOYMENT_TARGET=9.0\r\nexport CFLAGS=\"-arch ${arch} -isysroot ${sdkPath} -m${sdkName}-version-min=${DEPLOYMENT_TARGET} -pipe -Os -gdwarf-2 -fembed-bitcode\"\r\nexport LDFLAGS=\"-arch ${arch} -isysroot ${sdkPath}\"\r\n\r\nset -e\r\n\r\n./configure --host=${host}\\\r\n            --with-random=/dev/urandom \\\r\n            --with-secure-transport\r\n\r\nmake clean\r\n\r\nmake -j8 V=1\r\n```\r\n- the `configure ` is correct, but the `make` is failed, **error: 'fork' is unavailable: not available on tvOS**\r\n```bash\r\nMaking all in lib\r\n/Applications/Xcode.app/Contents/Developer/usr/bin/make  all-am\r\n/bin/sh ../libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H   -I../include -I../lib -I../lib -DBUILDING_LIBCURL  -DCURL_HIDDEN_SYMBOLS   -fvisibility=hidden -arch arm64 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/SDKs/AppleTVOS14.0.sdk -mappletvos-version-min=9.0 -pipe -Os -gdwarf-2 -fembed-bitcode -Qunused-arguments -Wno-pointer-bool-conversion -Werror=partial-availability  -MT libcurl_la-curl_ntlm_wb.lo -MD -MP -MF .deps/libcurl_la-curl_ntlm_wb.Tpo -c -o libcurl_la-curl_ntlm_wb.lo `test -f 'curl_ntlm_wb.c' || echo './'`curl_ntlm_wb.c\r\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I../include -I../lib -I../lib -DBUILDING_LIBCURL -DCURL_HIDDEN_SYMBOLS -fvisibility=hidden -arch arm64 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/SDKs/AppleTVOS14.0.sdk -mappletvos-version-min=9.0 -pipe -Os -gdwarf-2 -fembed-bitcode -Qunused-arguments -Wno-pointer-bool-conversion -Werror=partial-availability -MT libcurl_la-curl_ntlm_wb.lo -MD -MP -MF .deps/libcurl_la-curl_ntlm_wb.Tpo -c curl_ntlm_wb.c  -fno-common -DPIC -o.libs/libcurl_la-curl_ntlm_wb.o\r\ncurl_ntlm_wb.c:200:15: error: 'fork' is unavailable: not available on tvOS\r\n  child_pid = fork();\r\n              ^\r\n/Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/SDKs/AppleTVOS14.0.sdk/usr/include/unistd.h:447:8: note: 'fork' has been explicitly marked\r\n      unavailable here\r\npid_t    fork(void) __WATCHOS_PROHIBITED __TVOS_PROHIBITED;\r\n         ^\r\ncurl_ntlm_wb.c:228:7: error: 'execl' is unavailable: not available on tvOS\r\n      execl(ntlm_auth, ntlm_auth,\r\n      ^\r\n/Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/SDKs/AppleTVOS14.0.sdk/usr/include/unistd.h:441:6: note: 'execl' has been explicitly\r\n      marked unavailable here\r\nint      execl(const char * __path, const char * __arg0, ...) __WATCHOS_PROHIBITED __TVOS_PROHIBITED;\r\n         ^\r\ncurl_ntlm_wb.c:235:7: error: 'execl' is unavailable: not available on tvOS\r\n      execl(ntlm_auth, ntlm_auth,\r\n      ^\r\n/Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/SDKs/AppleTVOS14.0.sdk/usr/include/unistd.h:441:6: note: 'execl' has been explicitly\r\n      marked unavailable here\r\nint      execl(const char * __path, const char * __arg0, ...) __WATCHOS_PROHIBITED __TVOS_PROHIBITED;\r\n         ^\r\n3 errors generated.\r\nmake[2]: *** [libcurl_la-curl_ntlm_wb.lo] Error 1\r\nmake[1]: *** [all] Error 2\r\nmake: *** [all-recursive] Error 1\r\n```\r\n\r\n### I expected the following\r\n\r\n### curl/libcurl version\r\n\r\n`curl-7.85.0.tar.gz Release`\r\n\r\n### operating system\r\n```bash\r\n$ uname -a\r\nDarwin my-macmini.local 19.6.0 Darwin Kernel Version 19.6.0: Mon Apr 18 21:50:40 PDT 2022; root:xnu-6153.141.62~1/RELEASE_X86_64 x86_64\r\n\r\n$ xcodebuild -version\r\nXcode 12.0\r\nBuild version 12A7209\r\n```","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/9847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/9847/timeline","performed_via_github_app":null,"state_reason":"completed"}