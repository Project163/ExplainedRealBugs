{"url":"https://api.github.com/repos/curl/curl/issues/19228","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/19228/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/19228/comments","events_url":"https://api.github.com/repos/curl/curl/issues/19228/events","html_url":"https://github.com/curl/curl/issues/19228","id":3550790353,"node_id":"I_kwDOAAiu0c7TpMLR","number":19228,"title":"Incorrect CAPA termination detection","user":{"login":"MegaManSec","id":2505339,"node_id":"MDQ6VXNlcjI1MDUzMzk=","avatar_url":"https://avatars.githubusercontent.com/u/2505339?v=4","gravatar_id":"","url":"https://api.github.com/users/MegaManSec","html_url":"https://github.com/MegaManSec","followers_url":"https://api.github.com/users/MegaManSec/followers","following_url":"https://api.github.com/users/MegaManSec/following{/other_user}","gists_url":"https://api.github.com/users/MegaManSec/gists{/gist_id}","starred_url":"https://api.github.com/users/MegaManSec/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MegaManSec/subscriptions","organizations_url":"https://api.github.com/users/MegaManSec/orgs","repos_url":"https://api.github.com/users/MegaManSec/repos","events_url":"https://api.github.com/users/MegaManSec/events{/privacy}","received_events_url":"https://api.github.com/users/MegaManSec/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":294076494,"node_id":"MDU6TGFiZWwyOTQwNzY0OTQ=","url":"https://api.github.com/repos/curl/curl/labels/POP3","name":"POP3","color":"f7c6c7","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-10-24T19:41:24Z","updated_at":"2025-10-26T10:00:52Z","closed_at":"2025-10-26T10:00:52Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\nThe CAPA response termination check treats any line that begins with '.' as the terminating line rather than requiring a single '.' line. According to POP3 multi-line response rules, the terminator is a line consisting of only a single dot (\".\"), so a line like \".capability\" would be misinterpreted as the end of the CAPA response. This can cause premature termination of capability parsing and missing or incorrect capability handling.\n\nThe affected code is here: https://github.com/curl/curl/blob/f4293cd81e9ed8cacee186161fd5294bdfe063dd/lib/pop3.c#L324-L334\n\nFrom https://www.rfc-editor.org/rfc/rfc1939: \"When all lines of the response have been sent, a final line is sent, consisting of a termination octet '.' and a CRLF pair\"\nFrom https://datatracker.ietf.org/doc/html/rfc2449: \"The capability list is terminated by a line containing a termination octet '.' and a CRLF pair\"\n\nThis bug was found with ZeroPath.\n\n### I expected the following\n\n_No response_\n\n### curl/libcurl version\n\nnewest\n\n### operating system\n\nall","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/19228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/19228/timeline","performed_via_github_app":null,"state_reason":"completed"}