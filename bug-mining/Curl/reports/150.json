{"url":"https://api.github.com/repos/curl/curl/issues/10328","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/10328/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/10328/comments","events_url":"https://api.github.com/repos/curl/curl/issues/10328/events","html_url":"https://github.com/curl/curl/issues/10328","id":1551502737,"node_id":"I_kwDOAAiu0c5ceg2R","number":10328,"title":"CURLOPT_READFUNCTION documentation return value confuses bytes with objects","user":{"login":"briangreenery","id":370343,"node_id":"MDQ6VXNlcjM3MDM0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/370343?v=4","gravatar_id":"","url":"https://api.github.com/users/briangreenery","html_url":"https://github.com/briangreenery","followers_url":"https://api.github.com/users/briangreenery/followers","following_url":"https://api.github.com/users/briangreenery/following{/other_user}","gists_url":"https://api.github.com/users/briangreenery/gists{/gist_id}","starred_url":"https://api.github.com/users/briangreenery/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/briangreenery/subscriptions","organizations_url":"https://api.github.com/users/briangreenery/orgs","repos_url":"https://api.github.com/users/briangreenery/repos","events_url":"https://api.github.com/users/briangreenery/events{/privacy}","received_events_url":"https://api.github.com/users/briangreenery/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":200869765,"node_id":"MDU6TGFiZWwyMDA4Njk3NjU=","url":"https://api.github.com/repos/curl/curl/labels/documentation","name":"documentation","color":"f7c6c7","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2023-01-20T22:02:18Z","updated_at":"2023-12-13T04:59:19Z","closed_at":"2023-01-29T09:28:40Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\r\n\r\nI read the documentation at https://curl.se/libcurl/c/CURLOPT_READFUNCTION.html.\r\n\r\n### I expected the following\r\n\r\nI expected to understand if the return value should be the number of _bytes_ read, like the return value of [read](https://pubs.opengroup.org/onlinepubs/9699919799/functions/read.html), or the number of _objects_ read, like the return value of [fread](https://pubs.opengroup.org/onlinepubs/9699919799/functions/fread.html).\r\n\r\nThis is confusing because the documentation is not consistent with itself.\r\n\r\nFirst, it says the return value should be the the number of bytes read:\r\n\r\nhttps://github.com/curl/curl/blob/c12fb3ddaf48e709a7a4deaa55ec485e4df163ee/docs/libcurl/opts/CURLOPT_READFUNCTION.3#L47-L49\r\n\r\nHowever the example it provides uses `fread`, which returns the number of objects read:\r\n\r\nhttps://github.com/curl/curl/blob/c12fb3ddaf48e709a7a4deaa55ec485e4df163ee/docs/libcurl/opts/CURLOPT_READFUNCTION.3#L88\r\n\r\nIf the return value is indeed `bytes`, then it seems the example should instead be something like:\r\n\r\n```C\r\n    size_t retcode = fread(ptr, 1, size*nmemb, readhere); \r\n```\r\n\r\nScanning through the codebase, it looks like one of those arguments is always `1`, so in practice the difference might not matter. If that's the case, explicitly saying that the `size` argument is always `1` would also be helpful to make it less ambiguous.","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/10328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/10328/timeline","performed_via_github_app":null,"state_reason":"completed"}