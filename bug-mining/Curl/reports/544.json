{"url":"https://api.github.com/repos/curl/curl/issues/14898","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/14898/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/14898/comments","events_url":"https://api.github.com/repos/curl/curl/issues/14898/events","html_url":"https://github.com/curl/curl/issues/14898","id":2524884993,"node_id":"I_kwDOAAiu0c6WfrAB","number":14898,"title":"curl_multi is broken in libcurl 8.10.0 - PHPs curl_multi_exec still_running argument is now always non-zero, causing endless loop in reading servers response","user":{"login":"vityank","id":18400127,"node_id":"MDQ6VXNlcjE4NDAwMTI3","avatar_url":"https://avatars.githubusercontent.com/u/18400127?v=4","gravatar_id":"","url":"https://api.github.com/users/vityank","html_url":"https://github.com/vityank","followers_url":"https://api.github.com/users/vityank/followers","following_url":"https://api.github.com/users/vityank/following{/other_user}","gists_url":"https://api.github.com/users/vityank/gists{/gist_id}","starred_url":"https://api.github.com/users/vityank/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vityank/subscriptions","organizations_url":"https://api.github.com/users/vityank/orgs","repos_url":"https://api.github.com/users/vityank/repos","events_url":"https://api.github.com/users/vityank/events{/privacy}","received_events_url":"https://api.github.com/users/vityank/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":184118243,"node_id":"MDU6TGFiZWwxODQxMTgyNDM=","url":"https://api.github.com/repos/curl/curl/labels/HTTP","name":"HTTP","color":"207de5","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2024-09-13T13:41:24Z","updated_at":"2024-09-13T20:38:44Z","closed_at":"2024-09-13T20:22:21Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\n```\r\n<?php\r\n\r\n\r\n// start testing\r\n  echo \"*** Testing curl_exec() : basic functionality ***\\n\";\r\n\r\n  $url = \"http://127.0.0.1:32550/get.inc?test=get\";\r\n  //$url = \"http:/127.0.0.1/index.php\";\r\n  echo \"Preparing handles array...\\n\";\r\n  $chs = array(\r\n    0 => curl_init(),\r\n    1 => curl_init(),\r\n    2 => curl_init(),\r\n  );\r\n\r\n  echo \"Starting ob...\\n\";\r\n  ob_start(); // start output buffering\r\n\r\n  $options = array(\r\n    CURLOPT_RETURNTRANSFER => 1,\r\n    CURLOPT_URL => $url,\r\n  );\r\n\r\n  echo \"Setting options...\\n\";\r\n  curl_setopt_array($chs[0], $options); //set the options\r\n  curl_setopt_array($chs[1], $options); //set the options\r\n  curl_setopt_array($chs[2], $options); //set the options\r\n\r\n  echo \"About to call multi init...\\n\";\r\n  $mh = curl_multi_init();\r\n\r\n  // add handlers\r\n  echo \"Adding handlers...\\n\";\r\n  curl_multi_add_handle($mh, $chs[0]);\r\n  curl_multi_add_handle($mh, $chs[1]);\r\n  curl_multi_add_handle($mh, $chs[2]);\r\n\r\n  $running=null;\r\n  //execute the handles\r\n  echo \"Entering loop...\\n\";\r\n  do {\r\n    $vst = curl_multi_exec($mh, $running);\r\n    echo \"cURL Code is: $vst\\n\";\r\n  } while ($running > 0);\r\n\r\n  echo \"Pulling content...\\n\";\r\n  $curl_content = '';\r\n  $curl_content .= curl_multi_getcontent($chs[0]);\r\n  $curl_content .= curl_multi_getcontent($chs[1]);\r\n  $curl_content .= curl_multi_getcontent($chs[2]);\r\n\r\n  //close the handles\r\n  echo \"Cleaning up...\\n\";\r\n  curl_multi_remove_handle($mh, $chs[0]);\r\n  curl_multi_remove_handle($mh, $chs[1]);\r\n  curl_multi_remove_handle($mh, $chs[2]);\r\n  echo \"Closing multi handle...\\n\";\r\n  curl_multi_close($mh);\r\n\r\n  var_dump( $curl_content );\r\n```\n\n### I expected the following\n\n*** Testing curl_exec() : basic functionality ***\r\nPreparing handles array...\r\nStarting ob...\r\nSetting options...\r\nAbout to call multi init...\r\nAdding handlers...\r\nEntering loop...\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\ncURL Code is: 0\r\nPulling content...\r\nCleaning up...\r\nClosing multi handle...\r\nstring(75) \"Hello World!\r\nHello World!Hello World!\r\nHello World!Hello World!\r\nHello World!\"\n\n### curl/libcurl version\n\ncurl 8.10.0\n\n### operating system\n\nRHEL 9.4","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/14898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/14898/timeline","performed_via_github_app":null,"state_reason":"completed"}