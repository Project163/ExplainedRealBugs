{"url":"https://api.github.com/repos/curl/curl/issues/12983","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/12983/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/12983/comments","events_url":"https://api.github.com/repos/curl/curl/issues/12983/events","html_url":"https://github.com/curl/curl/issues/12983","id":2152478814,"node_id":"I_kwDOAAiu0c6ATDhe","number":12983,"title":"Integer overflow in  lib/vssh/libssh2.c","user":{"login":"vulnerabilityspotter","id":161164518,"node_id":"U_kgDOCZss5g","avatar_url":"https://avatars.githubusercontent.com/u/161164518?v=4","gravatar_id":"","url":"https://api.github.com/users/vulnerabilityspotter","html_url":"https://github.com/vulnerabilityspotter","followers_url":"https://api.github.com/users/vulnerabilityspotter/followers","following_url":"https://api.github.com/users/vulnerabilityspotter/following{/other_user}","gists_url":"https://api.github.com/users/vulnerabilityspotter/gists{/gist_id}","starred_url":"https://api.github.com/users/vulnerabilityspotter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vulnerabilityspotter/subscriptions","organizations_url":"https://api.github.com/users/vulnerabilityspotter/orgs","repos_url":"https://api.github.com/users/vulnerabilityspotter/repos","events_url":"https://api.github.com/users/vulnerabilityspotter/events{/privacy}","received_events_url":"https://api.github.com/users/vulnerabilityspotter/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":269086135,"node_id":"MDU6TGFiZWwyNjkwODYxMzU=","url":"https://api.github.com/repos/curl/curl/labels/SCP/SFTP","name":"SCP/SFTP","color":"bfd4f2","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2024-02-24T20:53:11Z","updated_at":"2024-03-03T20:03:36Z","closed_at":"2024-02-25T21:41:23Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\n\nSecurity Vulnerability Report\r\n\r\nFile: lib/vssh/libssh2.c\r\n\r\nFunction: ssh_statemachact() (Starting at line 2512)\r\n\r\nVulnerability Type: Integer Overflow\r\n\r\nLocation: Line 2547\r\n\r\nSeverity: High\r\n\r\nDescription:\r\n\r\nIn the ssh_statemachact() function, at line 2547, there exists a vulnerability related to an integer overflow. The vulnerability arises from the calculation of the variable size, which is assigned the value of to - from + 1.\r\n\r\nsize = to - from + 1;\r\n\r\nIf the values of to and from are such that to is sufficiently close to the maximum representable value for the data type being used, subtracting from from to may result in an overflow. Adding 1 to this potentially overflowing value could exacerbate the overflow or lead to unexpected behavior.\r\n\r\nExploitation Scenario:\r\n\r\nAn attacker may craft a malicious request with carefully chosen values for to and from such that to is very close to the maximum representable value for the data type, triggering an integer overflow during the calculation of size. This could potentially lead to various security issues, such as memory corruption, buffer overflows, or unexpected behavior, depending on how the size variable is subsequently used.\r\n\r\nImpact:\r\n\r\nThe impact of this vulnerability could be severe, potentially leading to:\r\n\r\n    Memory Corruption: If the calculated size value is used to allocate memory or perform operations such as copying data, an integer overflow could result in memory corruption, leading to crashes or arbitrary code execution.\r\n\r\n    Security Bypass: In scenarios where size is used to enforce boundaries or permissions, an attacker may exploit the integer overflow to bypass security checks or gain unauthorized access to sensitive resources.\r\n\r\n    Denial of Service (DoS): A carefully crafted request exploiting the integer overflow could cause the application to enter an unexpected state or consume excessive resources, leading to a denial of service condition.\r\n\r\nRecommendations:\r\n\r\n    Bounds Checking: Implement proper bounds checking to ensure that the values of to and from are within acceptable ranges before performing calculations.\r\n\r\n    Safe Arithmetic Operations: Consider using safer arithmetic operations or alternative calculation methods to prevent integer overflows, especially when dealing with potentially large or close-to-boundary values.\r\n\r\n    Input Validation: Validate input parameters (to and from) to ensure they adhere to expected ranges and constraints before performing calculations.\r\n\r\n    Error Handling: Implement robust error handling mechanisms to gracefully handle scenarios where input parameters result in unexpected or invalid calculations.\r\n\r\nSeverity Justification:\r\n\r\nThe presence of an integer overflow vulnerability at line 2547 poses a high risk to the security and stability of the application. Exploitation of this vulnerability could lead to severe consequences, including memory corruption, security bypass, or denial of service conditions.\r\n\r\nAffected Versions:\r\n\r\nThis vulnerability affects all versions of the application that include the vulnerable ssh_statemachact() function.\r\n\r\nReferences:\r\n\r\n    OWASP Integer Overflow\r\n    CWE-190: Integer Overflow or Wraparound\r\n    CERT Secure Coding - INT32-C\r\n\r\nConclusion:\r\n\r\nThe presence of an integer overflow vulnerability at line 2547 in the ssh_statemachact() function poses a high risk to the security and stability of the application. It is imperative to address this vulnerability promptly by implementing appropriate bounds checking and error handling mechanisms to prevent potential exploitation and associated security risks.\r\n\n\n### I expected the following\n\n-\n\n### curl/libcurl version\n\n7448054c38c547af171cb1a8df4c5c08b9d86ae5\n\n### operating system\n\nAll","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/12983/reactions","total_count":143,"+1":0,"-1":111,"laugh":31,"hooray":0,"confused":1,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/12983/timeline","performed_via_github_app":null,"state_reason":"completed"}