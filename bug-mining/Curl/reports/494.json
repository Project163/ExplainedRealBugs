{"url":"https://api.github.com/repos/curl/curl/issues/14177","repository_url":"https://api.github.com/repos/curl/curl","labels_url":"https://api.github.com/repos/curl/curl/issues/14177/labels{/name}","comments_url":"https://api.github.com/repos/curl/curl/issues/14177/comments","events_url":"https://api.github.com/repos/curl/curl/issues/14177/events","html_url":"https://github.com/curl/curl/issues/14177","id":2406933554,"node_id":"I_kwDOAAiu0c6PduQy","number":14177,"title":"tests: frequent failure of test 2600 on Windows","user":{"login":"vszakats","id":1446897,"node_id":"MDQ6VXNlcjE0NDY4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1446897?v=4","gravatar_id":"","url":"https://api.github.com/users/vszakats","html_url":"https://github.com/vszakats","followers_url":"https://api.github.com/users/vszakats/followers","following_url":"https://api.github.com/users/vszakats/following{/other_user}","gists_url":"https://api.github.com/users/vszakats/gists{/gist_id}","starred_url":"https://api.github.com/users/vszakats/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vszakats/subscriptions","organizations_url":"https://api.github.com/users/vszakats/orgs","repos_url":"https://api.github.com/users/vszakats/repos","events_url":"https://api.github.com/users/vszakats/events{/privacy}","received_events_url":"https://api.github.com/users/vszakats/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":887227423,"node_id":"MDU6TGFiZWw4ODcyMjc0MjM=","url":"https://api.github.com/repos/curl/curl/labels/tests","name":"tests","color":"a7a8e8","default":false,"description":""},{"id":940032249,"node_id":"MDU6TGFiZWw5NDAwMzIyNDk=","url":"https://api.github.com/repos/curl/curl/labels/Windows","name":"Windows","color":"0e8a16","default":false,"description":"Windows-specific"},{"id":2252760348,"node_id":"MDU6TGFiZWwyMjUyNzYwMzQ4","url":"https://api.github.com/repos/curl/curl/labels/CI","name":"CI","color":"ffb7ca","default":false,"description":"Continuous Integration"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-07-13T13:35:30Z","updated_at":"2024-07-15T21:25:09Z","closed_at":"2024-07-15T21:25:09Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### I did this\r\n\r\nStarted seeing lots `unit2600` failures recently (in the last week or so). This\r\ncan be been related to disabling more test groups and thus giving way to\r\nthis one, so it's not necessarly a recent regression.\r\n\r\nThis is often the last reported test, before the jobs hanging and timing out.\r\n\r\nIt happened with various mingw and MSVC configurations and versions.\r\n\r\nExample:\r\n```\r\n  test 2600...[connection filter connect/destroy unit tests]\r\n  \r\n  unit2600 returned 20, when expecting 0\r\n   2600: exit FAILED\r\n  == Contents of files in the log/3/ dir after test 2600\r\n  === Start of file server.cmd\r\n   Testnum 2600\r\n  === End of file server.cmd\r\n  === Start of file stderr2600\r\n   URL: -\r\n   * !!! WARNING !!\r\n   * This is a debug build of libcurl, do not use in production.\r\n   * Added test.com:123:192.0.2.1 to DNS cache\r\n   * STATE: INIT => SETUP handle 0x2d15b7a1e28; line 1936\r\n   * STATE: SETUP => CONNECT handle 0x2d15b7a1e28; line 1952\r\n   * Added connection 0. The cache now contains 1 members\r\n   * Hostname test.com was found in DNS cache\r\n   * STATE: CONNECT => CONNECTING handle 0x2d15b7a1e28; line 1988\r\n   * 0001ms: cf[v4-0] created\r\n   * multi_done[CONNECTING]: status: 0 prem: 1 done: 0\r\n   * multi_done, not reusing connection=0, forbid=0, close=0, premature=1, conn_multiplex=0\r\n   * The cache now contains 0 members\r\n   * Curl_disconnect(conn #0, aborted=1)\r\n   * closing connection #0\r\n   * [CCACHE] closing #0\r\n   * 0001ms: cf[v4-0] destroyed\r\n   * Expire cleared\r\n   1: test case took 1ms\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:256 test FAILED: '1: expected result 7 but got 27'\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:273 test FAILED: '1: expected min duration of 200ms, but took 1ms'\r\n   * RESOLVE test.com:123 - old addresses discarded\r\n   * Added test.com:123:192.0.2.1,192.0.2.2 to DNS cache\r\n   * STATE: INIT => SETUP handle 0x2d15b7a1e28; line 1936\r\n   * STATE: SETUP => CONNECT handle 0x2d15b7a1e28; line 1952\r\n   * Added connection 1. The cache now contains 1 members\r\n   * Hostname test.com was found in DNS cache\r\n   * STATE: CONNECT => CONNECTING handle 0x2d15b7a1e28; line 1988\r\n   * 0000ms: cf[v4-0] created\r\n   * multi_done[CONNECTING]: status: 0 prem: 1 done: 0\r\n   * multi_done, not reusing connection=1, forbid=0, close=0, premature=1, conn_multiplex=0\r\n   * The cache now contains 0 members\r\n   * Curl_disconnect(conn #1, aborted=1)\r\n   * closing connection #1\r\n   * [CCACHE] closing #1\r\n   * 0000ms: cf[v4-0] destroyed\r\n   * Expire cleared\r\n   2: test case took 0ms\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:256 test FAILED: '2: expected result 7 but got 27'\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:261 test FAILED: '2: expected 2 ipv4 creations, but got 1'\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:273 test FAILED: '2: expected min duration of 400ms, but took 0ms'\r\n   * RESOLVE test.com:123 - old addresses discarded\r\n   * Added test.com:123:::1 to DNS cache\r\n   * STATE: INIT => SETUP handle 0x2d15b7a1e28; line 1936\r\n   * STATE: SETUP => CONNECT handle 0x2d15b7a1e28; line 1952\r\n   * Added connection 2. The cache now contains 1 members\r\n   * Hostname test.com was found in DNS cache\r\n   * STATE: CONNECT => CONNECTING handle 0x2d15b7a1e28; line 1988\r\n   * 0000ms: cf[v6-0] created\r\n   * multi_done[CONNECTING]: status: 0 prem: 1 done: 0\r\n   * multi_done, not reusing connection=2, forbid=0, close=0, premature=1, conn_multiplex=0\r\n   * The cache now contains 0 members\r\n   * Curl_disconnect(conn #2, aborted=1)\r\n   * closing connection #2\r\n   * [CCACHE] closing #2\r\n   * 0000ms: cf[v6-0] destroyed\r\n   * Expire cleared\r\n   3: test case took 0ms\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:256 test FAILED: '3: expected result 7 but got 27'\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:273 test FAILED: '3: expected min duration of 200ms, but took 0ms'\r\n   * RESOLVE test.com:123 - old addresses discarded\r\n   * Added test.com:123:::1,::2 to DNS cache\r\n   * STATE: INIT => SETUP handle 0x2d15b7a1e28; line 1936\r\n   * STATE: SETUP => CONNECT handle 0x2d15b7a1e28; line 1952\r\n   * Added connection 3. The cache now contains 1 members\r\n   * Hostname test.com was found in DNS cache\r\n   * STATE: CONNECT => CONNECTING handle 0x2d15b7a1e28; line 1988\r\n   * 0002ms: cf[v6-0] created\r\n   * multi_done[CONNECTING]: status: 0 prem: 1 done: 0\r\n   * multi_done, not reusing connection=3, forbid=0, close=0, premature=1, conn_multiplex=0\r\n   * The cache now contains 0 members\r\n   * Curl_disconnect(conn #3, aborted=1)\r\n   * closing connection #3\r\n   * [CCACHE] closing #3\r\n   * 0002ms: cf[v6-0] destroyed\r\n   * Expire cleared\r\n   4: test case took 2ms\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:256 test FAILED: '4: expected result 7 but got 27'\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:266 test FAILED: '4: expected 2 ipv6 creations, but got 1'\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:273 test FAILED: '4: expected min duration of 400ms, but took 2ms'\r\n   * RESOLVE test.com:123 - old addresses discarded\r\n   * Added test.com:123:192.0.2.1,::1 to DNS cache\r\n   * STATE: INIT => SETUP handle 0x2d15b7a1e28; line 1936\r\n   * STATE: SETUP => CONNECT handle 0x2d15b7a1e28; line 1952\r\n   * Added connection 4. The cache now contains 1 members\r\n   * Hostname test.com was found in DNS cache\r\n   * STATE: CONNECT => CONNECTING handle 0x2d15b7a1e28; line 1988\r\n   * 0000ms: cf[v4-0] created\r\n   * multi_done[CONNECTING]: status: 0 prem: 1 done: 0\r\n   * multi_done, not reusing connection=4, forbid=0, close=0, premature=1, conn_multiplex=0\r\n   * The cache now contains 0 members\r\n   * Curl_disconnect(conn #4, aborted=1)\r\n   * closing connection #4\r\n   * [CCACHE] closing #4\r\n   * 0000ms: cf[v4-0] destroyed\r\n   * Expire cleared\r\n   5: test case took 0ms\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:256 test FAILED: '5: expected result 7 but got 27'\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:266 test FAILED: '5: expected 1 ipv6 creations, but got 0'\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:273 test FAILED: '5: expected min duration of 350ms, but took 0ms'\r\n   * RESOLVE test.com:123 - old addresses discarded\r\n   * Added test.com:123:::1,192.0.2.1 to DNS cache\r\n   * STATE: INIT => SETUP handle 0x2d15b7a1e28; line 1936\r\n   * STATE: SETUP => CONNECT handle 0x2d15b7a1e28; line 1952\r\n   * Added connection 5. The cache now contains 1 members\r\n   * Hostname test.com was found in DNS cache\r\n   * STATE: CONNECT => CONNECTING handle 0x2d15b7a1e28; line 1988\r\n   * 0000ms: cf[v6-0] created\r\n   * multi_done[CONNECTING]: status: 0 prem: 1 done: 0\r\n   * multi_done, not reusing connection=5, forbid=0, close=0, premature=1, conn_multiplex=0\r\n   * The cache now contains 0 members\r\n   * Curl_disconnect(conn #5, aborted=1)\r\n   * closing connection #5\r\n   * [CCACHE] closing #5\r\n   * 0000ms: cf[v6-0] destroyed\r\n   * Expire cleared\r\n   6: test case took 2ms\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:256 test FAILED: '6: expected result 7 but got 27'\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:261 test FAILED: '6: expected 1 ipv4 creations, but got 0'\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:273 test FAILED: '6: expected min duration of 350ms, but took 2ms'\r\n   * RESOLVE test.com:123 - old addresses discarded\r\n   * Added test.com:123:192.0.2.1,::1 to DNS cache\r\n   * STATE: INIT => SETUP handle 0x2d15b7a1e28; line 1936\r\n   * STATE: SETUP => CONNECT handle 0x2d15b7a1e28; line 1952\r\n   * Added connection 6. The cache now contains 1 members\r\n   * Hostname test.com was found in DNS cache\r\n   * STATE: CONNECT => CONNECTING handle 0x2d15b7a1e28; line 1988\r\n   * 0000ms: cf[v4-0] created\r\n   * multi_done[CONNECTING]: status: 0 prem: 1 done: 0\r\n   * multi_done, not reusing connection=6, forbid=0, close=0, premature=1, conn_multiplex=0\r\n   * The cache now contains 0 members\r\n   * Curl_disconnect(conn #6, aborted=1)\r\n   * closing connection #6\r\n   * [CCACHE] closing #6\r\n   * 0000ms: cf[v4-0] destroyed\r\n   * Expire cleared\r\n   7: test case took 0ms\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:256 test FAILED: '7: expected result 7 but got 27'\r\n   D:\\a\\curl\\curl\\tests\\unit\\unit2600.c:273 test FAILED: '7: expected min duration of 400ms, but took 0ms'\r\n   * RESOLVE test.com:123 - old addresses discarded\r\n   * Added test.com:123:::1,192.0.2.1 to DNS cache\r\nError: The action 'cmake run tests' has timed out after 30 minutes.\r\n```\r\nRef: https://github.com/curl/curl/actions/runs/9919874100/job/27406166474?pr=14175#step:13:5436\r\n\r\nA collection of similar failures:\r\n1. https://github.com/curl/curl/actions/runs/9775422731/job/26985795679 (old-mingw-w64, 9.5.0) location unknown, last executed was test2600 with a failure\r\n1. https://github.com/curl/curl/actions/runs/9796121067/job/27049861121?pr=14096#step:14:2887 (msys2 cmake, mingw-w64, x86_64) last test in log: 2603\r\n1. https://github.com/curl/curl/actions/runs/9831904667/job/27139950536#step:9:5148 (msvc, libressl) last test: 2600\r\n1. https://github.com/curl/curl/actions/runs/9837611706/job/27155835549?pr=14117#step:9:5156 (msvc, boringssl) last test: 2600\r\n1. https://github.com/curl/curl/actions/runs/9841853460/job/27169458913?pr=14125#step:13:5265 (msvc, boringssl) last test: 2600\r\n1. https://github.com/curl/curl/actions/runs/9841771973/job/27169174607?pr=14124 (mingw, CM x86_64 schannel U) 'cmake run tests' step failed to start.\r\n1. https://github.com/curl/curl/actions/runs/9843527144/job/27174924074?pr=14129#step:23:3322 (mingw, CM x86_64 schannel U) last test: 2600\r\n1. https://github.com/curl/curl/actions/runs/9843961100/job/27176348727?pr=14097#step:23:3323 (mingw, CM x86_64 schannel U) last test: 2600\r\n1. https://github.com/curl/curl/actions/runs/9857526570/job/27216813548?pr=14137#step:13:5265 (msvc, boringssl) last test: 2600\r\n1. https://github.com/curl/curl/actions/runs/9918753161/attempts/1?pr=14174 (4 jobs) all test 2600\r\n\r\nvia https://github.com/curl/curl/pull/13599#issuecomment-2119372376\r\n\r\n\r\n### I expected the following\r\n\r\nTest to finish, ideally with success.\r\n\r\n\r\n### curl/libcurl version\r\n\r\nmaster (8.9.0-DEV)\r\n\r\n\r\n### operating system\r\n\r\nWindows\r\n","closed_by":{"login":"bagder","id":177011,"node_id":"MDQ6VXNlcjE3NzAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/177011?v=4","gravatar_id":"","url":"https://api.github.com/users/bagder","html_url":"https://github.com/bagder","followers_url":"https://api.github.com/users/bagder/followers","following_url":"https://api.github.com/users/bagder/following{/other_user}","gists_url":"https://api.github.com/users/bagder/gists{/gist_id}","starred_url":"https://api.github.com/users/bagder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagder/subscriptions","organizations_url":"https://api.github.com/users/bagder/orgs","repos_url":"https://api.github.com/users/bagder/repos","events_url":"https://api.github.com/users/bagder/events{/privacy}","received_events_url":"https://api.github.com/users/bagder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/curl/curl/issues/14177/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/curl/curl/issues/14177/timeline","performed_via_github_app":null,"state_reason":"completed"}