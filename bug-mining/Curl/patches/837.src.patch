diff --git a/tests/data/test1571 b/tests/data/test1571
index 622ec5ad1..8a2bfb461 100644
--- a/tests/data/test1571
+++ b/tests/data/test1571
@@ -75,9 +75,6 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes" nonewline="yes">
 IGLOO /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
diff --git a/tests/data/test1572 b/tests/data/test1572
index 36f3eef6e..53683ed88 100644
--- a/tests/data/test1572
+++ b/tests/data/test1572
@@ -75,9 +75,6 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes" nonewline="yes">
 IGLOO /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
diff --git a/tests/data/test1573 b/tests/data/test1573
index 62f5a0e88..e13522964 100644
--- a/tests/data/test1573
+++ b/tests/data/test1573
@@ -75,9 +75,6 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes">
 IGLOO /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
diff --git a/tests/data/test1574 b/tests/data/test1574
index 501c40538..fe4d7688c 100644
--- a/tests/data/test1574
+++ b/tests/data/test1574
@@ -75,9 +75,6 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes">
 IGLOO /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
diff --git a/tests/data/test1575 b/tests/data/test1575
index d02080b2d..53452af2c 100644
--- a/tests/data/test1575
+++ b/tests/data/test1575
@@ -75,9 +75,6 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes" nonewline="yes">
 IGLOO /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
diff --git a/tests/data/test1576 b/tests/data/test1576
index 8048e1329..fc24dd3e5 100644
--- a/tests/data/test1576
+++ b/tests/data/test1576
@@ -75,9 +75,6 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes" nonewline="yes">
 CURL /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
diff --git a/tests/data/test1577 b/tests/data/test1577
index 42d26ae46..eeb3119fd 100644
--- a/tests/data/test1577
+++ b/tests/data/test1577
@@ -75,9 +75,6 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER %TESTNUMBER
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes" nonewline="yes">
 CURL /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
diff --git a/tests/data/test1578 b/tests/data/test1578
index a8c9e7925..b8e7c308c 100644
--- a/tests/data/test1578
+++ b/tests/data/test1578
@@ -75,9 +75,6 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes" nonewline="yes">
 CURL /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
diff --git a/tests/data/test1579 b/tests/data/test1579
index 309f17a8b..c835eaf70 100644
--- a/tests/data/test1579
+++ b/tests/data/test1579
@@ -75,9 +75,6 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER %TESTNUMBER
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes">
 CURL /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
diff --git a/tests/data/test1580 b/tests/data/test1580
index e67164a42..99626c53a 100644
--- a/tests/data/test1580
+++ b/tests/data/test1580
@@ -75,9 +75,6 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER 1578
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes" nonewline="yes">
 CURL /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
diff --git a/tests/data/test1581 b/tests/data/test1581
index 5dac5229f..f3f29757a 100644
--- a/tests/data/test1581
+++ b/tests/data/test1581
@@ -75,9 +75,6 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes" nonewline="yes">
 IGLOO /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
diff --git a/tests/data/test1631 b/tests/data/test1631
index 7c2f81c3e..6e28263b3 100644
--- a/tests/data/test1631
+++ b/tests/data/test1631
@@ -59,17 +59,16 @@ proxy
 # opens for us, so we can't compare with a known pre-existing number!
 <strippart>
 s/((https.proxy):(\d+))/$2:12345/
-s/^(User-Agent: curl).*/$1/
 </strippart>
 <proxy crlf="headers">
 CONNECT ftp.site.thru.https.proxy:12345 HTTP/1.1
 Host: ftp.site.thru.https.proxy:12345
-User-Agent: curl
+User-Agent: curl/%VERSION
 Proxy-Connection: Keep-Alive
 
 CONNECT ftp.site.thru.https.proxy:12345 HTTP/1.1
 Host: ftp.site.thru.https.proxy:12345
-User-Agent: curl
+User-Agent: curl/%VERSION
 Proxy-Connection: Keep-Alive
 
 </proxy>
diff --git a/tests/data/test1632 b/tests/data/test1632
index 90cb56f61..ebf91098d 100644
--- a/tests/data/test1632
+++ b/tests/data/test1632
@@ -69,22 +69,21 @@ proxy
 
 <strippart>
 s/((https.proxy):(\d+))/$2:12345/
-s/^(User-Agent: curl).*/$1/
 </strippart>
 <proxy crlf="headers">
 CONNECT ftp.site.thru.https.proxy:12345 HTTP/1.1
 Host: ftp.site.thru.https.proxy:12345
-User-Agent: curl
+User-Agent: curl/%VERSION
 Proxy-Connection: Keep-Alive
 
 CONNECT ftp.site.thru.https.proxy:12345 HTTP/1.1
 Host: ftp.site.thru.https.proxy:12345
-User-Agent: curl
+User-Agent: curl/%VERSION
 Proxy-Connection: Keep-Alive
 
 CONNECT ftp.site.thru.https.proxy:12345 HTTP/1.1
 Host: ftp.site.thru.https.proxy:12345
-User-Agent: curl
+User-Agent: curl/%VERSION
 Proxy-Connection: Keep-Alive
 
 </proxy>
diff --git a/tests/data/test1933 b/tests/data/test1933
index a26d29585..57706dcf9 100644
--- a/tests/data/test1933
+++ b/tests/data/test1933
@@ -55,7 +55,6 @@ http://xxx:yyy@127.0.0.1:9000/%TESTNUMBER/testapi/test 127.0.0.1:9000:%HOSTIP:%H
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1934 b/tests/data/test1934
index 9520c8193..a5bead447 100644
--- a/tests/data/test1934
+++ b/tests/data/test1934
@@ -55,7 +55,6 @@ http://127.0.0.1:9000/%TESTNUMBER/testapi/test 127.0.0.1:9000:%HOSTIP:%HTTPPORT
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1935 b/tests/data/test1935
index 4e0f11cb4..64f0c21e0 100644
--- a/tests/data/test1935
+++ b/tests/data/test1935
@@ -55,7 +55,6 @@ http://127.0.0.1:9000/%TESTNUMBER/testapi/test 127.0.0.1:9000:%HOSTIP:%HTTPPORT
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1936 b/tests/data/test1936
index d57b8161e..3ee3788f2 100644
--- a/tests/data/test1936
+++ b/tests/data/test1936
@@ -55,7 +55,6 @@ http://127.0.0.1:9000/%TESTNUMBER/testapi/test 127.0.0.1:9000:%HOSTIP:%HTTPPORT
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1937 b/tests/data/test1937
index 816b9c18d..72fce57c5 100644
--- a/tests/data/test1937
+++ b/tests/data/test1937
@@ -56,7 +56,6 @@ http://127.0.0.1:9000/%TESTNUMBER/testapi/test 127.0.0.1:9000:%HOSTIP:%HTTPPORT
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1938 b/tests/data/test1938
index e2ed9837e..7f719376e 100644
--- a/tests/data/test1938
+++ b/tests/data/test1938
@@ -56,7 +56,6 @@ http://127.0.0.1:9000/%TESTNUMBER/testapi/test 127.0.0.1:9000:%HOSTIP:%HTTPPORT
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1955 b/tests/data/test1955
index be23a9d62..93d1422e8 100644
--- a/tests/data/test1955
+++ b/tests/data/test1955
@@ -55,7 +55,6 @@ http://exam.ple.com:9000/aws_sigv4/testapi/test exam.ple.com:9000:%HOSTIP:%HTTPP
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1956 b/tests/data/test1956
index 324de3391..b8c4710f9 100644
--- a/tests/data/test1956
+++ b/tests/data/test1956
@@ -55,7 +55,6 @@ http://exam.ple.com:9000/aws_sigv4/testapi/test exam.ple.com:9000:%HOSTIP:%HTTPP
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1957 b/tests/data/test1957
index 5a3c914b5..0036b6064 100644
--- a/tests/data/test1957
+++ b/tests/data/test1957
@@ -55,7 +55,6 @@ http://exam.ple.com:9000/aws_sigv4/testapi/test exam.ple.com:9000:%HOSTIP:%HTTPP
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1958 b/tests/data/test1958
index 220f49aa5..f5e38868c 100644
--- a/tests/data/test1958
+++ b/tests/data/test1958
@@ -55,7 +55,6 @@ http://exam.ple.com:9000/aws_sigv4/testapi/test exam.ple.com:9000:%HOSTIP:%HTTPP
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1959 b/tests/data/test1959
index e91a3128e..8f43ed625 100644
--- a/tests/data/test1959
+++ b/tests/data/test1959
@@ -55,7 +55,6 @@ http://exam.ple.com:9000/aws_sigv4/testapi/test exam.ple.com:9000:%HOSTIP:%HTTPP
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1964 b/tests/data/test1964
index 9b7e2c968..5cadbee5b 100644
--- a/tests/data/test1964
+++ b/tests/data/test1964
@@ -54,7 +54,6 @@ http://xxx:yyy@127.0.0.1:9000/%TESTNUMBER/testapi/test 127.0.0.1:9000:%HOSTIP:%H
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1970 b/tests/data/test1970
index 43df45e31..af1522359 100644
--- a/tests/data/test1970
+++ b/tests/data/test1970
@@ -55,7 +55,6 @@ http://exam.ple.com:9000/aws_sigv4/testapi/test exam.ple.com:9000:%HOSTIP:%HTTPP
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1971 b/tests/data/test1971
index 57cb834e9..52320d434 100644
--- a/tests/data/test1971
+++ b/tests/data/test1971
@@ -48,7 +48,6 @@ http://exam.ple.com:9000/aws_sigv4/testapi/test exam.ple.com:9000:%HOSTIP:%HTTPP
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1972 b/tests/data/test1972
index 7b4168d11..d16ed4f77 100644
--- a/tests/data/test1972
+++ b/tests/data/test1972
@@ -58,7 +58,6 @@ http://exam.ple.com:9000/aws_sigv4/testapi/test exam.ple.com:9000:%HOSTIP:%HTTPP
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1973 b/tests/data/test1973
index 8b10e9ec4..7c45ceb5d 100644
--- a/tests/data/test1973
+++ b/tests/data/test1973
@@ -55,7 +55,6 @@ http://exam.ple.com:9000/aws_sigv4/testapi/test exam.ple.com:9000:%HOSTIP:%HTTPP
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1974 b/tests/data/test1974
index 74213d0ab..bac259715 100644
--- a/tests/data/test1974
+++ b/tests/data/test1974
@@ -55,7 +55,6 @@ http://exam.ple.com:9000/aws_sigv4/testapi/test exam.ple.com:9000:%HOSTIP:%HTTPP
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1975 b/tests/data/test1975
index 92fd563da..e5a29d293 100644
--- a/tests/data/test1975
+++ b/tests/data/test1975
@@ -48,7 +48,6 @@ http://exam.ple.com:9000/aws_sigv4/testapi/test exam.ple.com:9000:%HOSTIP:%HTTPP
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Type:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test1976 b/tests/data/test1976
index 51e3b242b..b573bf7de 100644
--- a/tests/data/test1976
+++ b/tests/data/test1976
@@ -39,7 +39,6 @@ HTTP AWS_SIGV4 canonical request header sorting test
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Length:.*
 ^Accept:.*
 </strip>
@@ -53,6 +52,7 @@ Host: %HOSTIP:%HTTPPORT
 Authorization: AWS4-HMAC-SHA256 Credential=xxx/19700101/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date;x-amz-meta-test;x-amz-meta-test-two, Signature=stripped
 X-Amz-Date: 19700101T000000Z
 x-amz-content-sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
+User-Agent: curl/%VERSION
 X-Amz-Meta-Test-Two: test2
 x-amz-meta-test: test
 
diff --git a/tests/data/test1978 b/tests/data/test1978
index 007bbac55..a6c1272d9 100644
--- a/tests/data/test1978
+++ b/tests/data/test1978
@@ -42,7 +42,6 @@ http://xxx:yyy@127.0.0.1:9000/%TESTNUMBER/testapi/test 127.0.0.1:9000:%HOSTIP:%H
 # Verify data after the test has been "shot"
 <verify>
 <strip>
-^User-Agent:.*
 ^Content-Length:.*
 ^Accept:.*
 </strip>
diff --git a/tests/data/test545 b/tests/data/test545
index 363fe4dd7..99bf04685 100644
--- a/tests/data/test545
+++ b/tests/data/test545
@@ -40,9 +40,6 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER
 #
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="headers" nonewline="yes">
 POST /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
diff --git a/tests/data/test794 b/tests/data/test794
index 63d3d36ba..5fd1f76a0 100644
--- a/tests/data/test794
+++ b/tests/data/test794
@@ -72,18 +72,17 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER --no-progress-meter -X IGLOO -d moo --locat
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes" nonewline="yes">
 IGLOO /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
+User-Agent: curl/%VERSION
 Accept: */*
 Content-Length: 3
 Content-Type: application/x-www-form-urlencoded
 
 mooGET /%TESTNUMBER0001 HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
+User-Agent: curl/%VERSION
 Accept: */*
 
 
diff --git a/tests/data/test796 b/tests/data/test796
index e87505881..b945556a4 100644
--- a/tests/data/test796
+++ b/tests/data/test796
@@ -72,18 +72,17 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER -X IGLOO -d moo --follow
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes" nonewline="yes">
 IGLOO /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
+User-Agent: curl/%VERSION
 Accept: */*
 Content-Length: 3
 Content-Type: application/x-www-form-urlencoded
 
 mooGET /%TESTNUMBER0001 HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
+User-Agent: curl/%VERSION
 Accept: */*
 
 
diff --git a/tests/data/test797 b/tests/data/test797
index f1f1a1ff1..2033829d1 100644
--- a/tests/data/test797
+++ b/tests/data/test797
@@ -72,18 +72,17 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER -X IGLOO -d moo --follow
 
 # Verify data after the test has been "shot"
 <verify>
-<strip>
-^User-Agent:.*
-</strip>
 <protocol crlf="yes" nonewline="yes">
 IGLOO /%TESTNUMBER HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
+User-Agent: curl/%VERSION
 Accept: */*
 Content-Length: 3
 Content-Type: application/x-www-form-urlencoded
 
 mooIGLOO /%TESTNUMBER0001 HTTP/1.1
 Host: %HOSTIP:%HTTPPORT
+User-Agent: curl/%VERSION
 Accept: */*
 Content-Length: 3
 Content-Type: application/x-www-form-urlencoded
