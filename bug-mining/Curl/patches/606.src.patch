diff --git a/.github/workflows/linux.yml b/.github/workflows/linux.yml
index a169a0f74..ee06e069e 100644
--- a/.github/workflows/linux.yml
+++ b/.github/workflows/linux.yml
@@ -119,7 +119,7 @@ jobs:
 
           - name: mbedtls-pkg
             install_packages: libnghttp2-dev libmbedtls-dev
-            generate: -DCURL_USE_MBEDTLS=ON -DENABLE_DEBUG=ON
+            generate: -DCURL_USE_MBEDTLS=ON -DENABLE_DEBUG=ON -DBUILD_LIBCURL_DOCS=OFF -DBUILD_MISC_DOCS=OFF -DENABLE_CURL_MANUAL=OFF
 
           - name: mbedtls-pkg !pc
             install_packages: libnghttp2-dev libmbedtls-dev
@@ -167,7 +167,7 @@ jobs:
 
           - name: openssl clang krb5
             install_packages: zlib1g-dev libkrb5-dev clang
-            configure: CC=clang --with-openssl --with-gssapi --enable-debug
+            configure: CC=clang --with-openssl --with-gssapi --enable-debug --disable-docs --disable-manual
 
           - name: openssl clang krb5
             install_packages: zlib1g-dev libkrb5-dev clang
diff --git a/configure.ac b/configure.ac
index fa6c6198a..e3ecf00c6 100644
--- a/configure.ac
+++ b/configure.ac
@@ -4215,11 +4215,11 @@ fi
 
 CURL_CHECK_NONBLOCKING_SOCKET
 
-if test "x$BUILD_DOCS" != "x0" -o "x$USE_MANUAL" != "x0" -o "x$CURL_CA_EMBED" != "x"; then
-  AC_PATH_PROG(PERL, perl,,
-    $PATH:/usr/local/bin/perl:/usr/bin/:/usr/local/bin)
-  AC_SUBST(PERL)
+AC_PATH_PROG(PERL, perl,,
+  $PATH:/usr/local/bin/perl:/usr/bin/:/usr/local/bin)
+AC_SUBST(PERL)
 
+if test "x$BUILD_DOCS" != "x0" -o "x$USE_MANUAL" != "x0" -o "x$CURL_CA_EMBED" != "x"; then
   if test -z "$PERL"; then
     AC_MSG_ERROR([perl was not found, needed for docs, manual and CA embed])
   fi
diff --git a/tests/CMakeLists.txt b/tests/CMakeLists.txt
index 165b49dfe..0e40b2e19 100644
--- a/tests/CMakeLists.txt
+++ b/tests/CMakeLists.txt
@@ -43,6 +43,9 @@ function(add_runtests _targetname _test_flags)
   if(CURL_TEST_BUNDLES)
     set(_test_flags "${_test_flags} -bundle")
   endif()
+  if(NOT BUILD_LIBCURL_DOCS)
+    set(_test_flags "${_test_flags} !documentation")
+  endif()
   # Skip walking through dependent targets before running tests in CI.
   # This avoids: GNU Make doing a slow re-evaluation of all targets and
   # skipping them, MSBuild doing a re-evaluation, and actually rebuilding them.
diff --git a/tests/Makefile.am b/tests/Makefile.am
index 56329f4a8..46d58fed8 100644
--- a/tests/Makefile.am
+++ b/tests/Makefile.am
@@ -128,6 +128,11 @@ if USE_TEST_BUNDLES
 TEST_COMMON += -bundle
 endif
 
+if BUILD_DOCS
+else
+TEST_COMMON += !documentation
+endif
+
 TEST = srcdir=$(srcdir) $(PERL) $(PERLFLAGS) $(srcdir)/runtests.pl $(TEST_COMMON)
 TEST_Q = -a -s
 TEST_AM = -a -am
diff --git a/tests/data/test1177 b/tests/data/test1177
index 6cc94a5b1..c1f6d661c 100644
--- a/tests/data/test1177
+++ b/tests/data/test1177
@@ -3,6 +3,7 @@
 <keywords>
 source analysis
 CURL_VERSION
+documentation
 </keywords>
 </info>
 
diff --git a/tests/data/test481 b/tests/data/test481
index f59fec2f9..33e7734bc 100644
--- a/tests/data/test481
+++ b/tests/data/test481
@@ -39,7 +39,11 @@ http://%HOSTIP:%HTTPPORT/%TESTNUMBER --no-clobber -C 1 -o "%LOGDIR/%TESTNUMBER"
 <stderr mode="text">
 curl: --continue-at is mutually exclusive with --no-clobber
 curl: option -C: is badly used here
+%if manual
 curl: try 'curl --help' or 'curl --manual' for more information
+%else
+curl: try 'curl --help' for more information
+%endif
 </stderr>
 </verify>
 </testcase>
diff --git a/tests/data/test482 b/tests/data/test482
index ce7f8f2b4..9b34ca9c4 100644
--- a/tests/data/test482
+++ b/tests/data/test482
@@ -35,7 +35,11 @@ http://non-existing-host.haxx.se. --remove-on-error -C 1 -o "%LOGDIR/%TESTNUMBER
 <stderr mode="text">
 curl: --continue-at is mutually exclusive with --remove-on-error
 curl: option -C: is badly used here
+%if manual
 curl: try 'curl --help' or 'curl --manual' for more information
+%else
+curl: try 'curl --help' for more information
+%endif
 </stderr>
 </verify>
 </testcase>
