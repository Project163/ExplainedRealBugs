diff --git a/.github/workflows/linux.yml b/.github/workflows/linux.yml
index a8bea98b1..62354742f 100644
--- a/.github/workflows/linux.yml
+++ b/.github/workflows/linux.yml
@@ -177,8 +177,8 @@ jobs:
             install_steps: skipall
             generate: -DCURL_USE_OPENSSL=ON -DCURL_USE_GSSAPI=ON -DENABLE_DEBUG=ON -DCURL_LTO=ON
 
-          - name: openssl !ipv6 !--libcurl
-            configure: --with-openssl --disable-ipv6 --enable-debug --disable-unity --disable-libcurl-option
+          - name: openssl !ipv6 !--libcurl !--digest-auth
+            configure: --with-openssl --disable-ipv6 --enable-debug --disable-unity --disable-libcurl-option --disable-digest-auth
 
           - name: openssl https-only
             configure: >-
diff --git a/lib/vauth/vauth.h b/lib/vauth/vauth.h
index ab54e35f3..7d085e33f 100644
--- a/lib/vauth/vauth.h
+++ b/lib/vauth/vauth.h
@@ -116,6 +116,8 @@ CURLcode Curl_auth_create_digest_http_message(struct Curl_easy *data,
 
 /* This is used to clean up the digest specific data */
 void Curl_auth_digest_cleanup(struct digestdata *digest);
+#else
+#define Curl_auth_is_digest_supported()       FALSE
 #endif /* !CURL_DISABLE_DIGEST_AUTH */
 
 #ifdef USE_GSASL
diff --git a/tests/data/test1001 b/tests/data/test1001
index 63eb072fd..6755e7a1e 100644
--- a/tests/data/test1001
+++ b/tests/data/test1001
@@ -67,6 +67,7 @@ http
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP POST --digest with PUT and resumed upload and modified method
diff --git a/tests/data/test1002 b/tests/data/test1002
index 50f7dcf2a..de08c0e72 100644
--- a/tests/data/test1002
+++ b/tests/data/test1002
@@ -66,6 +66,7 @@ http
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP PUT with Digest auth, resumed upload and modified method, twice
diff --git a/tests/data/test1030 b/tests/data/test1030
index 1421e769b..200bd72b3 100644
--- a/tests/data/test1030
+++ b/tests/data/test1030
@@ -62,6 +62,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP PUT with --anyauth authorization (picking Digest)
diff --git a/tests/data/test1060 b/tests/data/test1060
index ce7a37ea0..50ce55a87 100644
--- a/tests/data/test1060
+++ b/tests/data/test1060
@@ -870,6 +870,7 @@ http
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP proxy CONNECT auth Digest, large headers and data
diff --git a/tests/data/test1061 b/tests/data/test1061
index 0e383598d..9e2402a58 100644
--- a/tests/data/test1061
+++ b/tests/data/test1061
@@ -875,6 +875,7 @@ http
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP proxy CONNECT auth Digest, large headers and chunked data
diff --git a/tests/data/test1071 b/tests/data/test1071
index 180c467b1..1b320c2bf 100644
--- a/tests/data/test1071
+++ b/tests/data/test1071
@@ -68,6 +68,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 Downgraded HTTP PUT to HTTP 1.0 with authorization
diff --git a/tests/data/test1079 b/tests/data/test1079
index 180c48316..83de2aedb 100644
--- a/tests/data/test1079
+++ b/tests/data/test1079
@@ -44,6 +44,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP retry after closed connection and empty response
diff --git a/tests/data/test1095 b/tests/data/test1095
index 8480c8a47..8e23ae6a3 100644
--- a/tests/data/test1095
+++ b/tests/data/test1095
@@ -54,6 +54,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with Digest and realm with quoted quotes
diff --git a/tests/data/test1229 b/tests/data/test1229
index 96cdbfe13..cc179499a 100644
--- a/tests/data/test1229
+++ b/tests/data/test1229
@@ -54,6 +54,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with Digest authorization with user name needing escape
diff --git a/tests/data/test1284 b/tests/data/test1284
index 2900c512e..925150b6e 100644
--- a/tests/data/test1284
+++ b/tests/data/test1284
@@ -52,6 +52,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP POST --digest with user-specified Content-Length header
diff --git a/tests/data/test1285 b/tests/data/test1285
index ee5f13c5e..1b6524552 100644
--- a/tests/data/test1285
+++ b/tests/data/test1285
@@ -52,6 +52,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP PUT --digest with user-specified Content-Length header
diff --git a/tests/data/test1286 b/tests/data/test1286
index e898a37d3..b8b47e7ef 100644
--- a/tests/data/test1286
+++ b/tests/data/test1286
@@ -64,6 +64,7 @@ http
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 HTTP GET --digest increasing nonce-count
diff --git a/tests/data/test1412 b/tests/data/test1412
index e4720dcdc..56e016a0c 100644
--- a/tests/data/test1412
+++ b/tests/data/test1412
@@ -89,6 +89,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP GET with --anyauth with two URLs (picking Digest)
diff --git a/tests/data/test1418 b/tests/data/test1418
index 748040811..9fff0b63a 100644
--- a/tests/data/test1418
+++ b/tests/data/test1418
@@ -82,6 +82,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with --anyauth and connection reuse
diff --git a/tests/data/test1437 b/tests/data/test1437
index 29e800a43..ad8fa080e 100644
--- a/tests/data/test1437
+++ b/tests/data/test1437
@@ -54,6 +54,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with duplicated WWW-Authenticate parameters
diff --git a/tests/data/test153 b/tests/data/test153
index b55a70a03..6dfaf6e40 100644
--- a/tests/data/test153
+++ b/tests/data/test153
@@ -76,6 +76,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with Digest authorization with stale=true
diff --git a/tests/data/test154 b/tests/data/test154
index 4f818f00f..7612ce05f 100644
--- a/tests/data/test154
+++ b/tests/data/test154
@@ -62,6 +62,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP PUT with --anyauth authorization (picking Digest)
diff --git a/tests/data/test1568 b/tests/data/test1568
index 409f11f92..899d9b59f 100644
--- a/tests/data/test1568
+++ b/tests/data/test1568
@@ -56,6 +56,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with Digest authorization on custom CURLOPT_PORT
diff --git a/tests/data/test167 b/tests/data/test167
index 031b92077..f8ccd2e9a 100644
--- a/tests/data/test167
+++ b/tests/data/test167
@@ -46,6 +46,7 @@ http
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP with proxy-requiring-Basic to site-requiring-Digest
diff --git a/tests/data/test168 b/tests/data/test168
index d6d4e895c..94e3ec4c1 100644
--- a/tests/data/test168
+++ b/tests/data/test168
@@ -60,6 +60,7 @@ http
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP with proxy-requiring-Digest to site-requiring-Digest
diff --git a/tests/data/test169 b/tests/data/test169
index 3a86cdf51..3e66ee481 100644
--- a/tests/data/test169
+++ b/tests/data/test169
@@ -81,6 +81,7 @@ NTLM
 SSL
 !SSPI
 proxy
+digest
 </features>
 <name>
 HTTP with proxy-requiring-NTLM to site-requiring-Digest
diff --git a/tests/data/test175 b/tests/data/test175
index 19537ebf3..ed6928ce9 100644
--- a/tests/data/test175
+++ b/tests/data/test175
@@ -51,6 +51,7 @@ http
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 HTTP POST --digest to server not requiring any auth at all
diff --git a/tests/data/test177 b/tests/data/test177
index 528b722d6..2034876d9 100644
--- a/tests/data/test177
+++ b/tests/data/test177
@@ -27,6 +27,7 @@ http
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 HTTP POST --digest to server doing a 302-location response
diff --git a/tests/data/test2024 b/tests/data/test2024
index 376552f3f..8407944a1 100644
--- a/tests/data/test2024
+++ b/tests/data/test2024
@@ -118,6 +118,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <tool>
 lib2023
diff --git a/tests/data/test2026 b/tests/data/test2026
index 75fee9b2c..f5d1db87e 100644
--- a/tests/data/test2026
+++ b/tests/data/test2026
@@ -154,6 +154,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <tool>
 lib2023
diff --git a/tests/data/test2027 b/tests/data/test2027
index f13483007..259e43950 100644
--- a/tests/data/test2027
+++ b/tests/data/test2027
@@ -177,6 +177,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <tool>
 lib2023
diff --git a/tests/data/test2028 b/tests/data/test2028
index ad37813c8..461d7ba6a 100644
--- a/tests/data/test2028
+++ b/tests/data/test2028
@@ -234,6 +234,7 @@ Finally, this is the real page!
 NTLM
 SSL
 !SSPI
+digest
 </features>
 <server>
 http
diff --git a/tests/data/test2030 b/tests/data/test2030
index f423adc84..4961e668d 100644
--- a/tests/data/test2030
+++ b/tests/data/test2030
@@ -223,6 +223,7 @@ Finally, this is the real page!
 NTLM
 SSL
 !SSPI
+digest
 </features>
 <server>
 http
diff --git a/tests/data/test2058 b/tests/data/test2058
index c85d534c9..773aab058 100644
--- a/tests/data/test2058
+++ b/tests/data/test2058
@@ -67,6 +67,7 @@ http
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP POST --digest with PUT, resumed upload, modified method and SHA-256
diff --git a/tests/data/test2059 b/tests/data/test2059
index 5b924a584..949d0cb96 100644
--- a/tests/data/test2059
+++ b/tests/data/test2059
@@ -67,6 +67,7 @@ http
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP POST --digest with PUT, resumed upload, modified method, SHA-256 and userhash=true
diff --git a/tests/data/test206 b/tests/data/test206
index 60e103d09..99a949302 100644
--- a/tests/data/test206
+++ b/tests/data/test206
@@ -74,6 +74,7 @@ http
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP proxy CONNECT auth Digest
diff --git a/tests/data/test2061 b/tests/data/test2061
index d232f6251..605d827be 100644
--- a/tests/data/test2061
+++ b/tests/data/test2061
@@ -54,6 +54,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with RFC7616 SHA256 Digest authorization
diff --git a/tests/data/test2063 b/tests/data/test2063
index f769428a9..07e12f3c7 100644
--- a/tests/data/test2063
+++ b/tests/data/test2063
@@ -54,6 +54,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with RFC7616 SHA-256 Digest authorization and userhash=true
diff --git a/tests/data/test2064 b/tests/data/test2064
index 6d6fb14ac..d31427046 100644
--- a/tests/data/test2064
+++ b/tests/data/test2064
@@ -54,6 +54,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with RFC7616 Digest authorization with bad password and SHA256
diff --git a/tests/data/test2066 b/tests/data/test2066
index 999f55ae4..19de8ad64 100644
--- a/tests/data/test2066
+++ b/tests/data/test2066
@@ -54,6 +54,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with RFC7616 Digest authorization with bad password, SHA-256 and userhash=true
diff --git a/tests/data/test2067 b/tests/data/test2067
index a65fb5250..20120e187 100644
--- a/tests/data/test2067
+++ b/tests/data/test2067
@@ -52,6 +52,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP POST --digest with SHA256 and user-specified Content-Length header
diff --git a/tests/data/test2069 b/tests/data/test2069
index 86aa18301..424ce44a1 100644
--- a/tests/data/test2069
+++ b/tests/data/test2069
@@ -52,6 +52,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP POST --digest with SHA-256, userhash=true and user-specified Content-Length header
diff --git a/tests/data/test2076 b/tests/data/test2076
index 646b7dfc8..6ef44c2c7 100644
--- a/tests/data/test2076
+++ b/tests/data/test2076
@@ -46,6 +46,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with digest auth and URI contains query
diff --git a/tests/data/test245 b/tests/data/test245
index 60319ebc2..da2636921 100644
--- a/tests/data/test245
+++ b/tests/data/test245
@@ -52,6 +52,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP POST --digest
diff --git a/tests/data/test246 b/tests/data/test246
index 67bf446d7..3ab338213 100644
--- a/tests/data/test246
+++ b/tests/data/test246
@@ -62,6 +62,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP POST --digest with server doing a 100 before 401 response
diff --git a/tests/data/test258 b/tests/data/test258
index 69f2613f5..23acb0200 100644
--- a/tests/data/test258
+++ b/tests/data/test258
@@ -60,6 +60,7 @@ Mime
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP POST multipart without Expect: header using proxy anyauth (Digest)
diff --git a/tests/data/test259 b/tests/data/test259
index b3796cef3..2b65e5076 100644
--- a/tests/data/test259
+++ b/tests/data/test259
@@ -56,6 +56,7 @@ Mime
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP POST multipart with Expect: header using proxy anyauth (Digest)
diff --git a/tests/data/test273 b/tests/data/test273
index 4dc23e0dd..eb7ab1cc6 100644
--- a/tests/data/test273
+++ b/tests/data/test273
@@ -54,6 +54,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with two Digest authorization headers
diff --git a/tests/data/test335 b/tests/data/test335
index a376f4018..2101d4f29 100644
--- a/tests/data/test335
+++ b/tests/data/test335
@@ -62,6 +62,7 @@ http
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP with proxy Digest and site Digest with creds in URLs
diff --git a/tests/data/test388 b/tests/data/test388
index 300c88f75..aee2063e4 100644
--- a/tests/data/test388
+++ b/tests/data/test388
@@ -76,6 +76,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with Digest and multiple qop values with leading space
diff --git a/tests/data/test540 b/tests/data/test540
index ef13108b1..308d5b339 100644
--- a/tests/data/test540
+++ b/tests/data/test540
@@ -68,6 +68,7 @@ lib%TESTNUMBER
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP proxy auth Digest multi API re-using connection
diff --git a/tests/data/test551 b/tests/data/test551
index 452da3927..c7a560e81 100644
--- a/tests/data/test551
+++ b/tests/data/test551
@@ -64,6 +64,7 @@ lib547
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP proxy auth Digest with POST data from read callback
diff --git a/tests/data/test552 b/tests/data/test552
index 2658e73e6..b38a6b5e2 100644
--- a/tests/data/test552
+++ b/tests/data/test552
@@ -57,6 +57,7 @@ lib%TESTNUMBER
 !SSPI
 crypto
 proxy
+digest
 </features>
 <name>
 HTTP proxy auth Digest with 70K POST data from read callback
diff --git a/tests/data/test565 b/tests/data/test565
index a6b29e17c..b8e418ec7 100644
--- a/tests/data/test565
+++ b/tests/data/test565
@@ -60,6 +60,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 # tool is what to use instead of 'curl'
 <tool>
diff --git a/tests/data/test579 b/tests/data/test579
index eaee6e323..c8e1700b8 100644
--- a/tests/data/test579
+++ b/tests/data/test579
@@ -58,6 +58,7 @@ http
 </server>
 <features>
 crypto
+digest
 </features>
 # tool is what to use instead of 'curl'
 <tool>
diff --git a/tests/data/test64 b/tests/data/test64
index 0f0516ea4..d56b2514c 100644
--- a/tests/data/test64
+++ b/tests/data/test64
@@ -54,6 +54,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with Digest authorization
diff --git a/tests/data/test65 b/tests/data/test65
index fcf43563f..8f82c92b4 100644
--- a/tests/data/test65
+++ b/tests/data/test65
@@ -54,6 +54,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with Digest authorization with bad password
diff --git a/tests/data/test70 b/tests/data/test70
index 69cba7da4..5d44a28e8 100644
--- a/tests/data/test70
+++ b/tests/data/test70
@@ -54,6 +54,7 @@ This IS the real page!
 <features>
 !SSPI
 NTLM
+digest
 </features>
 <server>
 http
diff --git a/tests/data/test72 b/tests/data/test72
index 176d0dff8..775642f8c 100644
--- a/tests/data/test72
+++ b/tests/data/test72
@@ -56,6 +56,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP with Digest *OR* Basic authorization
diff --git a/tests/data/test821 b/tests/data/test821
index 101c40084..417922080 100644
--- a/tests/data/test821
+++ b/tests/data/test821
@@ -35,6 +35,7 @@ imap
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 IMAP CRAM-MD5 authentication
diff --git a/tests/data/test823 b/tests/data/test823
index a3736a6fd..3a7686aff 100644
--- a/tests/data/test823
+++ b/tests/data/test823
@@ -38,6 +38,7 @@ imap
 !SSPI
 Debug
 crypto
+digest
 </features>
 <name>
 IMAP DIGEST-MD5 authentication
diff --git a/tests/data/test830 b/tests/data/test830
index 64172f1b5..1465406e1 100644
--- a/tests/data/test830
+++ b/tests/data/test830
@@ -28,6 +28,7 @@ imap
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 IMAP CRAM-MD5 graceful cancellation
diff --git a/tests/data/test832 b/tests/data/test832
index bbbc0ac73..5787bbc79 100644
--- a/tests/data/test832
+++ b/tests/data/test832
@@ -30,6 +30,7 @@ imap
 !SSPI
 Debug
 crypto
+digest
 </features>
 <name>
 IMAP DIGEST-MD5 graceful cancellation
diff --git a/tests/data/test833 b/tests/data/test833
index f958df4cb..bda66c514 100644
--- a/tests/data/test833
+++ b/tests/data/test833
@@ -39,6 +39,7 @@ imap
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 IMAP CRAM-MD5 authentication with SASL downgrade
diff --git a/tests/data/test835 b/tests/data/test835
index 17c8675eb..aa3a44670 100644
--- a/tests/data/test835
+++ b/tests/data/test835
@@ -41,6 +41,7 @@ imap
 !SSPI
 Debug
 crypto
+digest
 </features>
 <name>
 IMAP DIGEST-MD5 authentication with SASL downgrade
diff --git a/tests/data/test864 b/tests/data/test864
index 4f40a52ab..233764f64 100644
--- a/tests/data/test864
+++ b/tests/data/test864
@@ -32,6 +32,7 @@ pop3
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 POP3 APOP authentication
diff --git a/tests/data/test867 b/tests/data/test867
index 5be5ad6fb..76ad1aa57 100644
--- a/tests/data/test867
+++ b/tests/data/test867
@@ -37,6 +37,7 @@ pop3
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 POP3 CRAM-MD5 authentication
diff --git a/tests/data/test869 b/tests/data/test869
index 56873e038..be374dc2c 100644
--- a/tests/data/test869
+++ b/tests/data/test869
@@ -40,6 +40,7 @@ pop3
 !SSPI
 Debug
 crypto
+digest
 </features>
 <name>
 POP3 DIGEST-MD5 authentication
diff --git a/tests/data/test876 b/tests/data/test876
index a34b97a9d..3cbed8b5e 100644
--- a/tests/data/test876
+++ b/tests/data/test876
@@ -29,6 +29,7 @@ pop3
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 POP3 CRAM-MD5 graceful cancellation
diff --git a/tests/data/test878 b/tests/data/test878
index 657dc71c7..fe578c816 100644
--- a/tests/data/test878
+++ b/tests/data/test878
@@ -31,6 +31,7 @@ pop3
 !SSPI
 Debug
 crypto
+digest
 </features>
 <name>
 POP3 DIGEST-MD5 graceful cancellation
diff --git a/tests/data/test879 b/tests/data/test879
index c7b99efb8..cdf25d02a 100644
--- a/tests/data/test879
+++ b/tests/data/test879
@@ -41,6 +41,7 @@ pop3
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 POP3 CRAM-MD5 authentication with SASL downgrade
diff --git a/tests/data/test88 b/tests/data/test88
index e3f68c0ee..c48364980 100644
--- a/tests/data/test88
+++ b/tests/data/test88
@@ -58,6 +58,7 @@ http
 <features>
 !SSPI
 crypto
+digest
 </features>
 <name>
 HTTP PUT with Digest authorization
diff --git a/tests/data/test881 b/tests/data/test881
index 20e352788..a197cb1e6 100644
--- a/tests/data/test881
+++ b/tests/data/test881
@@ -43,6 +43,7 @@ pop3
 !SSPI
 Debug
 crypto
+digest
 </features>
 <name>
 POP3 DIGEST-MD5 authentication with SASL downgrade
diff --git a/tests/data/test891 b/tests/data/test891
index f022db96a..6d0242800 100644
--- a/tests/data/test891
+++ b/tests/data/test891
@@ -22,6 +22,7 @@ pop3
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 POP3 with short authentication response
diff --git a/tests/data/test905 b/tests/data/test905
index de0b08ac3..9f8d417a4 100644
--- a/tests/data/test905
+++ b/tests/data/test905
@@ -27,6 +27,7 @@ smtp
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 SMTP CRAM-MD5 authentication
diff --git a/tests/data/test907 b/tests/data/test907
index 8c24b68c4..30d05370c 100644
--- a/tests/data/test907
+++ b/tests/data/test907
@@ -30,6 +30,7 @@ smtp
 !SSPI
 Debug
 crypto
+digest
 </features>
 <name>
 SMTP DIGEST-MD5 authentication
diff --git a/tests/data/test932 b/tests/data/test932
index e814cc0f7..e2c9b29a8 100644
--- a/tests/data/test932
+++ b/tests/data/test932
@@ -28,6 +28,7 @@ smtp
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 SMTP CRAM-MD5 graceful cancellation
diff --git a/tests/data/test934 b/tests/data/test934
index 5ebf67fec..891232e5b 100644
--- a/tests/data/test934
+++ b/tests/data/test934
@@ -30,6 +30,7 @@ smtp
 !SSPI
 Debug
 crypto
+digest
 </features>
 <name>
 SMTP DIGEST-MD5 graceful cancellation
diff --git a/tests/data/test935 b/tests/data/test935
index bbd4d9475..57a4c36ca 100644
--- a/tests/data/test935
+++ b/tests/data/test935
@@ -31,6 +31,7 @@ smtp
 </server>
 <features>
 crypto
+digest
 </features>
 <name>
 SMTP CRAM-MD5 authentication with SASL downgrade
diff --git a/tests/data/test937 b/tests/data/test937
index bb761f854..ddd2037e8 100644
--- a/tests/data/test937
+++ b/tests/data/test937
@@ -33,6 +33,7 @@ smtp
 !SSPI
 Debug
 crypto
+digest
 </features>
 <name>
 SMTP DIGEST-MD5 authentication with SASL downgrade
diff --git a/tests/http/test_14_auth.py b/tests/http/test_14_auth.py
index d52b42fce..944cb56fc 100644
--- a/tests/http/test_14_auth.py
+++ b/tests/http/test_14_auth.py
@@ -53,6 +53,8 @@ class TestAuth:
     # download 1 file, authenticated
     @pytest.mark.parametrize("proto", ['http/1.1', 'h2', 'h3'])
     def test_14_02_digest_get_auth(self, env: Env, httpd, nghttpx, proto):
+        if not env.curl_has_feature('digest'):
+            pytest.skip("curl built without digest")
         if proto == 'h3' and not env.have_h3():
             pytest.skip("h3 not supported")
         curl = CurlClient(env=env)
@@ -65,6 +67,8 @@ class TestAuth:
     # PUT data, authenticated
     @pytest.mark.parametrize("proto", ['http/1.1', 'h2', 'h3'])
     def test_14_03_digest_put_auth(self, env: Env, httpd, nghttpx, proto):
+        if not env.curl_has_feature('digest'):
+            pytest.skip("curl built without digest")
         if proto == 'h3' and not env.have_h3():
             pytest.skip("h3 not supported")
         if proto == 'h3' and env.curl_uses_ossl_quic():
@@ -80,6 +84,8 @@ class TestAuth:
     # PUT data, digest auth large pw
     @pytest.mark.parametrize("proto", ['h2', 'h3'])
     def test_14_04_digest_large_pw(self, env: Env, httpd, nghttpx, proto):
+        if not env.curl_has_feature('digest'):
+            pytest.skip("curl built without digest")
         if proto == 'h3' and not env.have_h3():
             pytest.skip("h3 not supported")
         data='0123456789'
