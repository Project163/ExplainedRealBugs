diff --git a/lib/asyn.h b/lib/asyn.h
index d70bc86aa..b963da533 100644
--- a/lib/asyn.h
+++ b/lib/asyn.h
@@ -64,6 +64,7 @@ struct thread_data {
 #if defined(USE_HTTPSRR) && defined(USE_ARES)
   struct Curl_https_rrinfo hinfo;
   ares_channel channel;
+  int num_pending; /* number of outstanding c-ares requests */
 #endif
   bool init;
 };
diff --git a/lib/httpsrr.c b/lib/httpsrr.c
index 7a2ecdbe4..9a0bc827e 100644
--- a/lib/httpsrr.c
+++ b/lib/httpsrr.c
@@ -187,11 +187,9 @@ void Curl_dnsrec_done_cb(void *arg, ares_status_t status,
   struct Curl_easy *data = arg;
   CURLcode result = CURLE_OK;
   size_t i;
-#ifdef CURLRES_ARES
   struct thread_data *res = &data->state.async.thdata;
 
   res->num_pending--;
-#endif
   (void)timeouts;
   if((ARES_SUCCESS != status) || !dnsrec)
     return;
