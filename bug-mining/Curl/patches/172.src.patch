diff --git a/tests/runtests.pl b/tests/runtests.pl
index 5cd87897a..1510527e3 100755
--- a/tests/runtests.pl
+++ b/tests/runtests.pl
@@ -5382,7 +5382,7 @@ sub startservers {
         elsif($what eq "httptls") {
             if(!$httptlssrv) {
                 # for now, we can't run http TLS-EXT tests without gnutls-serv
-                return "no gnutls-serv";
+                return "no gnutls-serv (with SRP support)";
             }
             if($torture && $run{'httptls'} &&
                !responsive_httptls_server($verbose, "IPv4")) {
diff --git a/tests/sshhelp.pm b/tests/sshhelp.pm
index 2a25ca734..6cba41d9e 100644
--- a/tests/sshhelp.pm
+++ b/tests/sshhelp.pm
@@ -408,7 +408,16 @@ sub find_sshkeygen {
 # Find httptlssrv (gnutls-serv) and return canonical filename
 #
 sub find_httptlssrv {
-    return find_exe_file_hpath($httptlssrvexe);
+    my $p = find_exe_file_hpath($httptlssrvexe);
+    my @o = `$p -l`;
+    my $found;
+    for(@o) {
+        if(/Key exchange: SRP/) {
+            $found = 1;
+            last;
+        }
+    }
+    return $p if($found);
 }
 
 
