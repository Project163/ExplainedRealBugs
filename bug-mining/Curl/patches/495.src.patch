diff --git a/lib/sendf.c b/lib/sendf.c
index c80ffc640..24b90d2ad 100644
--- a/lib/sendf.c
+++ b/lib/sendf.c
@@ -1025,6 +1025,12 @@ static CURLcode cr_lc_read(struct Curl_easy *data,
          * the content length after having started the request... */
       }
     }
+
+    if(start < i) { /* leftover */
+      result = Curl_bufq_cwrite(&ctx->buf, buf + start, i - start, &n);
+      if(result)
+        return result;
+    }
   }
 
   DEBUGASSERT(!Curl_bufq_is_empty(&ctx->buf));
diff --git a/tests/data/test941 b/tests/data/test941
index 7c87f5028..79f88a674 100644
--- a/tests/data/test941
+++ b/tests/data/test941
@@ -32,6 +32,7 @@ converted
 with
 the
 --crlf option
+%repeat[650 x 0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789%0a]%
 </file>
 <command>
 smtp://%HOSTIP:%SMTPPORT/%TESTNUMBER --mail-rcpt recipient@example.com --mail-from sender@example.com -T %LOGDIR/upload%TESTNUMBER --crlf
@@ -60,6 +61,7 @@ converted
 with
 the
 --crlf option
+%repeat[650 x 0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
%0a]%
 .
 </upload>
 </verify>
diff --git a/tests/runtests.pl b/tests/runtests.pl
index 059c84057..f81447982 100755
--- a/tests/runtests.pl
+++ b/tests/runtests.pl
@@ -1460,6 +1460,9 @@ sub singletest_check {
             # cut off the final newline from the final line of the upload data
             chomp($upload[-1]);
         }
+        for my $line (@upload) {
+            subbase64(\$line);
+        }
 
         # verify uploaded data
         my @out = loadarray("$logdir/upload.$testnum");
diff --git a/tests/testutil.pm b/tests/testutil.pm
index 1a44083e1..36bbe513c 100644
--- a/tests/testutil.pm
+++ b/tests/testutil.pm
@@ -127,6 +127,7 @@ sub subbase64 {
         # decode %NN characters
         my ($d, $n) = ($2, $1);
         $d =~ s/%([0-9A-Fa-f]{2})/chr(hex($1))/eg;
+        $n =~ s/%([0-9A-Fa-f]{2})/chr(hex($1))/eg;
         my $all = $d x $n;
         $$thing =~ s/%%REPEAT%%/$all/;
     }
