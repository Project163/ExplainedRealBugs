{"url":"https://api.github.com/repos/pydantic/pydantic/issues/408","repository_url":"https://api.github.com/repos/pydantic/pydantic","labels_url":"https://api.github.com/repos/pydantic/pydantic/issues/408/labels{/name}","comments_url":"https://api.github.com/repos/pydantic/pydantic/issues/408/comments","events_url":"https://api.github.com/repos/pydantic/pydantic/issues/408/events","html_url":"https://github.com/pydantic/pydantic/issues/408","id":414710351,"node_id":"MDU6SXNzdWU0MTQ3MTAzNTE=","number":408,"title":"Dataclasses and schema attribute","user":{"login":"blfpd","id":2727048,"node_id":"MDQ6VXNlcjI3MjcwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/2727048?v=4","gravatar_id":"","url":"https://api.github.com/users/blfpd","html_url":"https://github.com/blfpd","followers_url":"https://api.github.com/users/blfpd/followers","following_url":"https://api.github.com/users/blfpd/following{/other_user}","gists_url":"https://api.github.com/users/blfpd/gists{/gist_id}","starred_url":"https://api.github.com/users/blfpd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blfpd/subscriptions","organizations_url":"https://api.github.com/users/blfpd/orgs","repos_url":"https://api.github.com/users/blfpd/repos","events_url":"https://api.github.com/users/blfpd/events{/privacy}","received_events_url":"https://api.github.com/users/blfpd/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":597426502,"node_id":"MDU6TGFiZWw1OTc0MjY1MDI=","url":"https://api.github.com/repos/pydantic/pydantic/labels/bug%20V1","name":"bug V1","color":"ee0701","default":false,"description":"Bug related to Pydantic V1.X"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-02-26T16:46:10Z","updated_at":"2019-03-28T12:57:00Z","closed_at":"2019-03-28T12:57:00Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"When creating a model with the dataclasses backport, the model doesn’t have the `schema()` method, but it’s still forbidden to create a model with this attribute name. Is this a desired behaviour?\r\n```py\r\n>>> from pydantic.dataclasses import dataclass\r\n>>> \r\n>>> @dataclass\r\n... class Card:\r\n...     number: str\r\n... \r\n>>> card = Card(number=\"1234\")\r\n>>> card.schema()\r\nTraceback (most recent call last):\r\n  File \"<input>\", line 1, in <module>\r\n    card.schema()\r\nAttributeError: 'Card' object has no attribute 'schema'\r\n>>> card.__pydantic_model__.schema()\r\nTraceback (most recent call last):\r\n  File \"<input>\", line 1, in <module>\r\n    card.__pydantic_model__.schema()\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/main.py\", line 402, in schema\r\n    s = model_schema(cls, by_alias=by_alias)\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/schema.py\", line 204, in model_schema\r\n    model, by_alias=by_alias, model_name_map=model_name_map, ref_prefix=ref_prefix\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/schema.py\", line 488, in model_process_schema\r\n    model, by_alias=by_alias, model_name_map=model_name_map, ref_prefix=ref_prefix\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/schema.py\", line 514, in model_type_schema\r\n    f, by_alias=by_alias, model_name_map=model_name_map, ref_prefix=ref_prefix\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/schema.py\", line 243, in field_schema\r\n    s['default'] = encode_default(field.default)\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/schema.py\", line 693, in encode_default\r\n    return pydantic_encoder(dft)\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/json.py\", line 40, in pydantic_encoder\r\n    raise TypeError(f\"Object of type '{obj.__class__.__name__}' is not JSON serializable\")\r\nTypeError: Object of type '_MISSING_TYPE' is not JSON serializable\r\n>>> \r\n>>> @dataclass\r\n... class Card:\r\n...     schema: str\r\n... \r\nTraceback (most recent call last):\r\n  File \"<input>\", line 1, in <module>\r\n    @dataclass\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/dataclasses.py\", line 118, in dataclass\r\n    return wrap(_cls)\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/dataclasses.py\", line 113, in wrap\r\n    return _process_class(cls, init, repr, eq, order, unsafe_hash, frozen, config)\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/dataclasses.py\", line 77, in _process_class\r\n    cls.__pydantic_model__ = create_model(cls.__name__, __config__=config, __module__=_cls.__module__, **fields)\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/main.py\", line 562, in create_model\r\n    return type(model_name, (__base__,), namespace)  # type: ignore\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/main.py\", line 184, in __new__\r\n    validate_field_name(bases, var_name)\r\n  File \"~/env/lib/python3.6/site-packages/pydantic/utils.py\", line 194, in validate_field_name\r\n    f'Field name \"{field_name}\" shadows a BaseModel attribute; '\r\nNameError: Field name \"schema\" shadows a BaseModel attribute; use a different field name with \"alias='schema'\".\r\n>>> \r\n```","closed_by":{"login":"samuelcolvin","id":4039449,"node_id":"MDQ6VXNlcjQwMzk0NDk=","avatar_url":"https://avatars.githubusercontent.com/u/4039449?v=4","gravatar_id":"","url":"https://api.github.com/users/samuelcolvin","html_url":"https://github.com/samuelcolvin","followers_url":"https://api.github.com/users/samuelcolvin/followers","following_url":"https://api.github.com/users/samuelcolvin/following{/other_user}","gists_url":"https://api.github.com/users/samuelcolvin/gists{/gist_id}","starred_url":"https://api.github.com/users/samuelcolvin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samuelcolvin/subscriptions","organizations_url":"https://api.github.com/users/samuelcolvin/orgs","repos_url":"https://api.github.com/users/samuelcolvin/repos","events_url":"https://api.github.com/users/samuelcolvin/events{/privacy}","received_events_url":"https://api.github.com/users/samuelcolvin/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pydantic/pydantic/issues/408/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pydantic/pydantic/issues/408/timeline","performed_via_github_app":null,"state_reason":"completed"}