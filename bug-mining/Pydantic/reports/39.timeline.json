[{"url":"https://api.github.com/repos/pydantic/pydantic/issues/comments/470879108","html_url":"https://github.com/pydantic/pydantic/issues/415#issuecomment-470879108","issue_url":"https://api.github.com/repos/pydantic/pydantic/issues/415","id":470879108,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MDg3OTEwOA==","user":{"login":"asmodehn","id":221256,"node_id":"MDQ6VXNlcjIyMTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/221256?v=4","gravatar_id":"","url":"https://api.github.com/users/asmodehn","html_url":"https://github.com/asmodehn","followers_url":"https://api.github.com/users/asmodehn/followers","following_url":"https://api.github.com/users/asmodehn/following{/other_user}","gists_url":"https://api.github.com/users/asmodehn/gists{/gist_id}","starred_url":"https://api.github.com/users/asmodehn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asmodehn/subscriptions","organizations_url":"https://api.github.com/users/asmodehn/orgs","repos_url":"https://api.github.com/users/asmodehn/repos","events_url":"https://api.github.com/users/asmodehn/events{/privacy}","received_events_url":"https://api.github.com/users/asmodehn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-08T10:20:59Z","updated_at":"2019-03-08T10:20:59Z","body":"Currently (pydantic 0.20.1) this code fails with : \r\n```\r\n File \"/home/alexv/Projects/crypy/crypy/desk/bounded_price.py\", line 72, in <module>\r\n    p = BoundedPrice(value=34.56, bounds=[33.5, 35.7])\r\n  File \"<string>\", line 4, in __init__\r\n  File \"/home/alexv/.local/share/virtualenvs/crypy-PletnYfd/lib/python3.7/site-packages/pydantic/dataclasses.py\", line 25, in _pydantic_post_init\r\n    d = validate_model(self.__pydantic_model__, self.__dict__)\r\n  File \"/home/alexv/.local/share/virtualenvs/crypy-PletnYfd/lib/python3.7/site-packages/pydantic/main.py\", line 623, in validate_model\r\n    raise ValidationError(errors)\r\npydantic.error_wrappers.ValidationError: 2 validation errors\r\nvalue\r\n  instance of mpf expected (type=type_error.arbitrary_type; expected_arbitrary_type=mpf)\r\nbounds\r\n  instance of ivmpf expected (type=type_error.arbitrary_type; expected_arbitrary_type=ivmpf)\r\n```\r\nbecause the validators are not called.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/pydantic/pydantic/issues/comments/470879108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"asmodehn","id":221256,"node_id":"MDQ6VXNlcjIyMTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/221256?v=4","gravatar_id":"","url":"https://api.github.com/users/asmodehn","html_url":"https://github.com/asmodehn","followers_url":"https://api.github.com/users/asmodehn/followers","following_url":"https://api.github.com/users/asmodehn/following{/other_user}","gists_url":"https://api.github.com/users/asmodehn/gists{/gist_id}","starred_url":"https://api.github.com/users/asmodehn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asmodehn/subscriptions","organizations_url":"https://api.github.com/users/asmodehn/orgs","repos_url":"https://api.github.com/users/asmodehn/repos","events_url":"https://api.github.com/users/asmodehn/events{/privacy}","received_events_url":"https://api.github.com/users/asmodehn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pydantic/pydantic/issues/comments/470889793","html_url":"https://github.com/pydantic/pydantic/issues/415#issuecomment-470889793","issue_url":"https://api.github.com/repos/pydantic/pydantic/issues/415","id":470889793,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MDg4OTc5Mw==","user":{"login":"samuelcolvin","id":4039449,"node_id":"MDQ6VXNlcjQwMzk0NDk=","avatar_url":"https://avatars.githubusercontent.com/u/4039449?v=4","gravatar_id":"","url":"https://api.github.com/users/samuelcolvin","html_url":"https://github.com/samuelcolvin","followers_url":"https://api.github.com/users/samuelcolvin/followers","following_url":"https://api.github.com/users/samuelcolvin/following{/other_user}","gists_url":"https://api.github.com/users/samuelcolvin/gists{/gist_id}","starred_url":"https://api.github.com/users/samuelcolvin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samuelcolvin/subscriptions","organizations_url":"https://api.github.com/users/samuelcolvin/orgs","repos_url":"https://api.github.com/users/samuelcolvin/repos","events_url":"https://api.github.com/users/samuelcolvin/events{/privacy}","received_events_url":"https://api.github.com/users/samuelcolvin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-08T10:58:23Z","updated_at":"2019-03-08T10:58:23Z","body":"Totally possible. I won't have time to work on this in the near future, but if you'd like to do it I'll happily review the PR.\r\n\r\nFor now, you could probably accomplish this using [custom type validation](https://pydantic-docs.helpmanual.io/#custom-data-types).\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pydantic/pydantic/issues/comments/470889793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"samuelcolvin","id":4039449,"node_id":"MDQ6VXNlcjQwMzk0NDk=","avatar_url":"https://avatars.githubusercontent.com/u/4039449?v=4","gravatar_id":"","url":"https://api.github.com/users/samuelcolvin","html_url":"https://github.com/samuelcolvin","followers_url":"https://api.github.com/users/samuelcolvin/followers","following_url":"https://api.github.com/users/samuelcolvin/following{/other_user}","gists_url":"https://api.github.com/users/samuelcolvin/gists{/gist_id}","starred_url":"https://api.github.com/users/samuelcolvin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samuelcolvin/subscriptions","organizations_url":"https://api.github.com/users/samuelcolvin/orgs","repos_url":"https://api.github.com/users/samuelcolvin/repos","events_url":"https://api.github.com/users/samuelcolvin/events{/privacy}","received_events_url":"https://api.github.com/users/samuelcolvin/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2189801375,"node_id":"MDEyOkxhYmVsZWRFdmVudDIxODk4MDEzNzU=","url":"https://api.github.com/repos/pydantic/pydantic/issues/events/2189801375","actor":{"login":"samuelcolvin","id":4039449,"node_id":"MDQ6VXNlcjQwMzk0NDk=","avatar_url":"https://avatars.githubusercontent.com/u/4039449?v=4","gravatar_id":"","url":"https://api.github.com/users/samuelcolvin","html_url":"https://github.com/samuelcolvin","followers_url":"https://api.github.com/users/samuelcolvin/followers","following_url":"https://api.github.com/users/samuelcolvin/following{/other_user}","gists_url":"https://api.github.com/users/samuelcolvin/gists{/gist_id}","starred_url":"https://api.github.com/users/samuelcolvin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samuelcolvin/subscriptions","organizations_url":"https://api.github.com/users/samuelcolvin/orgs","repos_url":"https://api.github.com/users/samuelcolvin/repos","events_url":"https://api.github.com/users/samuelcolvin/events{/privacy}","received_events_url":"https://api.github.com/users/samuelcolvin/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-03-08T10:58:29Z","label":{"name":"feature request","color":"84b6eb"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/pydantic/pydantic/issues/comments/470920724","html_url":"https://github.com/pydantic/pydantic/issues/415#issuecomment-470920724","issue_url":"https://api.github.com/repos/pydantic/pydantic/issues/415","id":470920724,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MDkyMDcyNA==","user":{"login":"asmodehn","id":221256,"node_id":"MDQ6VXNlcjIyMTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/221256?v=4","gravatar_id":"","url":"https://api.github.com/users/asmodehn","html_url":"https://github.com/asmodehn","followers_url":"https://api.github.com/users/asmodehn/followers","following_url":"https://api.github.com/users/asmodehn/following{/other_user}","gists_url":"https://api.github.com/users/asmodehn/gists{/gist_id}","starred_url":"https://api.github.com/users/asmodehn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asmodehn/subscriptions","organizations_url":"https://api.github.com/users/asmodehn/orgs","repos_url":"https://api.github.com/users/asmodehn/repos","events_url":"https://api.github.com/users/asmodehn/events{/privacy}","received_events_url":"https://api.github.com/users/asmodehn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-08T13:01:43Z","updated_at":"2019-03-08T13:01:43Z","body":"Oh thanks I ll have a look at that.\r\nI should be able to wrap my implementation choice(types from mpmath) into custom types. ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/pydantic/pydantic/issues/comments/470920724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"asmodehn","id":221256,"node_id":"MDQ6VXNlcjIyMTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/221256?v=4","gravatar_id":"","url":"https://api.github.com/users/asmodehn","html_url":"https://github.com/asmodehn","followers_url":"https://api.github.com/users/asmodehn/followers","following_url":"https://api.github.com/users/asmodehn/following{/other_user}","gists_url":"https://api.github.com/users/asmodehn/gists{/gist_id}","starred_url":"https://api.github.com/users/asmodehn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asmodehn/subscriptions","organizations_url":"https://api.github.com/users/asmodehn/orgs","repos_url":"https://api.github.com/users/asmodehn/repos","events_url":"https://api.github.com/users/asmodehn/events{/privacy}","received_events_url":"https://api.github.com/users/asmodehn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"primal100","id":6353787,"node_id":"MDQ6VXNlcjYzNTM3ODc=","avatar_url":"https://avatars.githubusercontent.com/u/6353787?v=4","gravatar_id":"","url":"https://api.github.com/users/primal100","html_url":"https://github.com/primal100","followers_url":"https://api.github.com/users/primal100/followers","following_url":"https://api.github.com/users/primal100/following{/other_user}","gists_url":"https://api.github.com/users/primal100/gists{/gist_id}","starred_url":"https://api.github.com/users/primal100/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/primal100/subscriptions","organizations_url":"https://api.github.com/users/primal100/orgs","repos_url":"https://api.github.com/users/primal100/repos","events_url":"https://api.github.com/users/primal100/events{/privacy}","received_events_url":"https://api.github.com/users/primal100/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-04-03T10:56:33Z","updated_at":"2019-04-03T10:56:33Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pydantic/pydantic/issues/454","repository_url":"https://api.github.com/repos/pydantic/pydantic","labels_url":"https://api.github.com/repos/pydantic/pydantic/issues/454/labels{/name}","comments_url":"https://api.github.com/repos/pydantic/pydantic/issues/454/comments","events_url":"https://api.github.com/repos/pydantic/pydantic/issues/454/events","html_url":"https://github.com/pydantic/pydantic/pull/454","id":428369782,"node_id":"MDExOlB1bGxSZXF1ZXN0MjY2NzUzNDY3","number":454,"title":"Validators for dataclasses","user":{"login":"primal100","id":6353787,"node_id":"MDQ6VXNlcjYzNTM3ODc=","avatar_url":"https://avatars.githubusercontent.com/u/6353787?v=4","gravatar_id":"","url":"https://api.github.com/users/primal100","html_url":"https://github.com/primal100","followers_url":"https://api.github.com/users/primal100/followers","following_url":"https://api.github.com/users/primal100/following{/other_user}","gists_url":"https://api.github.com/users/primal100/gists{/gist_id}","starred_url":"https://api.github.com/users/primal100/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/primal100/subscriptions","organizations_url":"https://api.github.com/users/primal100/orgs","repos_url":"https://api.github.com/users/primal100/repos","events_url":"https://api.github.com/users/primal100/events{/privacy}","received_events_url":"https://api.github.com/users/primal100/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-04-02T18:10:59Z","updated_at":"2019-04-11T22:14:06Z","closed_at":"2019-04-11T22:13:58Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":90194616,"node_id":"MDEwOlJlcG9zaXRvcnk5MDE5NDYxNg==","name":"pydantic","full_name":"pydantic/pydantic","private":false,"owner":{"login":"pydantic","id":110818415,"node_id":"O_kgDOBpr0bw","avatar_url":"https://avatars.githubusercontent.com/u/110818415?v=4","gravatar_id":"","url":"https://api.github.com/users/pydantic","html_url":"https://github.com/pydantic","followers_url":"https://api.github.com/users/pydantic/followers","following_url":"https://api.github.com/users/pydantic/following{/other_user}","gists_url":"https://api.github.com/users/pydantic/gists{/gist_id}","starred_url":"https://api.github.com/users/pydantic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pydantic/subscriptions","organizations_url":"https://api.github.com/users/pydantic/orgs","repos_url":"https://api.github.com/users/pydantic/repos","events_url":"https://api.github.com/users/pydantic/events{/privacy}","received_events_url":"https://api.github.com/users/pydantic/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pydantic/pydantic","description":"Data validation using Python type hints","fork":false,"url":"https://api.github.com/repos/pydantic/pydantic","forks_url":"https://api.github.com/repos/pydantic/pydantic/forks","keys_url":"https://api.github.com/repos/pydantic/pydantic/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pydantic/pydantic/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pydantic/pydantic/teams","hooks_url":"https://api.github.com/repos/pydantic/pydantic/hooks","issue_events_url":"https://api.github.com/repos/pydantic/pydantic/issues/events{/number}","events_url":"https://api.github.com/repos/pydantic/pydantic/events","assignees_url":"https://api.github.com/repos/pydantic/pydantic/assignees{/user}","branches_url":"https://api.github.com/repos/pydantic/pydantic/branches{/branch}","tags_url":"https://api.github.com/repos/pydantic/pydantic/tags","blobs_url":"https://api.github.com/repos/pydantic/pydantic/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pydantic/pydantic/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pydantic/pydantic/git/refs{/sha}","trees_url":"https://api.github.com/repos/pydantic/pydantic/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pydantic/pydantic/statuses/{sha}","languages_url":"https://api.github.com/repos/pydantic/pydantic/languages","stargazers_url":"https://api.github.com/repos/pydantic/pydantic/stargazers","contributors_url":"https://api.github.com/repos/pydantic/pydantic/contributors","subscribers_url":"https://api.github.com/repos/pydantic/pydantic/subscribers","subscription_url":"https://api.github.com/repos/pydantic/pydantic/subscription","commits_url":"https://api.github.com/repos/pydantic/pydantic/commits{/sha}","git_commits_url":"https://api.github.com/repos/pydantic/pydantic/git/commits{/sha}","comments_url":"https://api.github.com/repos/pydantic/pydantic/comments{/number}","issue_comment_url":"https://api.github.com/repos/pydantic/pydantic/issues/comments{/number}","contents_url":"https://api.github.com/repos/pydantic/pydantic/contents/{+path}","compare_url":"https://api.github.com/repos/pydantic/pydantic/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pydantic/pydantic/merges","archive_url":"https://api.github.com/repos/pydantic/pydantic/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pydantic/pydantic/downloads","issues_url":"https://api.github.com/repos/pydantic/pydantic/issues{/number}","pulls_url":"https://api.github.com/repos/pydantic/pydantic/pulls{/number}","milestones_url":"https://api.github.com/repos/pydantic/pydantic/milestones{/number}","notifications_url":"https://api.github.com/repos/pydantic/pydantic/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pydantic/pydantic/labels{/name}","releases_url":"https://api.github.com/repos/pydantic/pydantic/releases{/id}","deployments_url":"https://api.github.com/repos/pydantic/pydantic/deployments","created_at":"2017-05-03T21:23:58Z","updated_at":"2025-11-09T17:32:47Z","pushed_at":"2025-11-09T09:36:17Z","git_url":"git://github.com/pydantic/pydantic.git","ssh_url":"git@github.com:pydantic/pydantic.git","clone_url":"https://github.com/pydantic/pydantic.git","svn_url":"https://github.com/pydantic/pydantic","homepage":"https://docs.pydantic.dev","size":327577,"stargazers_count":25701,"watchers_count":25701,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":2306,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":512,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hints","json-schema","parsing","pydantic","python","python310","python311","python312","python313","python39","validation"],"visibility":"public","forks":2306,"open_issues":512,"watchers":25701,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/pydantic/pydantic/pulls/454","html_url":"https://github.com/pydantic/pydantic/pull/454","diff_url":"https://github.com/pydantic/pydantic/pull/454.diff","patch_url":"https://github.com/pydantic/pydantic/pull/454.patch","merged_at":"2019-04-11T22:13:58Z"},"body":"<!-- Thank you for your contribution! -->\r\n<!-- See https://pydantic-docs.helpmanual.io/#contributing-to-pydantic for help on Contributing -->\r\n<!-- Don't worry about making lots of commits on a pull request, they'll be squashed on merge anyway -->\r\n\r\n## Change Summary\r\n\r\nCustom validator methods work with dataclasses\r\n\r\n## Related issue number\r\n\r\n#415: Validator on dataclasses\r\n\r\nAlso remove a limitation referred to in the docs\r\n\r\n## Checklist\r\n\r\n* [x] Unit tests for the changes exist\r\n* [x] Tests pass on CI and coverage remains at 100% **99.3% some tests skipped**\r\n* [x] Documentation reflects the changes where applicable\r\n* [x] `HISTORY.rst` has been updated\r\n  * if this is the first change since a release, please add a new section\r\n  * include the issue number or this pull request number `#<number>`\r\n  * include your github username `@<whomever>`\r\n\r\nThere are probably a few decisions to be made with regard to the exact implementation. Maybe some of this can be improved?\r\n\r\n- The validators are discovered using a new utils function, gather_validators, which looks for validator methods in the dataclass and parent classes\r\n\r\n- The create_model function now accepts a __validators__ keyword argument to pass in a mapping of method names and methods. These are then added to the namespace by the create_model function. \r\n\r\n- The validate_model now accepts an additional cls keyword argument. The __pydantic_model__ already gets passed in from the dataclass, so the additional cls argument is also added so that the correct class (the dataclass) is passed to the validator classmethods.\r\n\r\n- The example datetime.py was renamed to datetime_example.py as the examples which import datetime were failing to run due to the name clash","reactions":{"url":"https://api.github.com/repos/pydantic/pydantic/issues/454/reactions","total_count":8,"+1":5,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":3,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pydantic/pydantic/issues/454/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":2270797922,"node_id":"MDExOkNsb3NlZEV2ZW50MjI3MDc5NzkyMg==","url":"https://api.github.com/repos/pydantic/pydantic/issues/events/2270797922","actor":{"login":"samuelcolvin","id":4039449,"node_id":"MDQ6VXNlcjQwMzk0NDk=","avatar_url":"https://avatars.githubusercontent.com/u/4039449?v=4","gravatar_id":"","url":"https://api.github.com/users/samuelcolvin","html_url":"https://github.com/samuelcolvin","followers_url":"https://api.github.com/users/samuelcolvin/followers","following_url":"https://api.github.com/users/samuelcolvin/following{/other_user}","gists_url":"https://api.github.com/users/samuelcolvin/gists{/gist_id}","starred_url":"https://api.github.com/users/samuelcolvin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samuelcolvin/subscriptions","organizations_url":"https://api.github.com/users/samuelcolvin/orgs","repos_url":"https://api.github.com/users/samuelcolvin/repos","events_url":"https://api.github.com/users/samuelcolvin/events{/privacy}","received_events_url":"https://api.github.com/users/samuelcolvin/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"50fd2c5b48ffe611b5c4feb24f26f7202217faab","commit_url":"https://api.github.com/repos/pydantic/pydantic/commits/50fd2c5b48ffe611b5c4feb24f26f7202217faab","created_at":"2019-04-11T22:13:59Z","state_reason":null,"performed_via_github_app":null},{"actor":{"login":"samuelcolvin","id":4039449,"node_id":"MDQ6VXNlcjQwMzk0NDk=","avatar_url":"https://avatars.githubusercontent.com/u/4039449?v=4","gravatar_id":"","url":"https://api.github.com/users/samuelcolvin","html_url":"https://github.com/samuelcolvin","followers_url":"https://api.github.com/users/samuelcolvin/followers","following_url":"https://api.github.com/users/samuelcolvin/following{/other_user}","gists_url":"https://api.github.com/users/samuelcolvin/gists{/gist_id}","starred_url":"https://api.github.com/users/samuelcolvin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samuelcolvin/subscriptions","organizations_url":"https://api.github.com/users/samuelcolvin/orgs","repos_url":"https://api.github.com/users/samuelcolvin/repos","events_url":"https://api.github.com/users/samuelcolvin/events{/privacy}","received_events_url":"https://api.github.com/users/samuelcolvin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T18:01:52Z","updated_at":"2021-04-15T18:01:52Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pydantic/pydantic/issues/2678","repository_url":"https://api.github.com/repos/pydantic/pydantic","labels_url":"https://api.github.com/repos/pydantic/pydantic/issues/2678/labels{/name}","comments_url":"https://api.github.com/repos/pydantic/pydantic/issues/2678/comments","events_url":"https://api.github.com/repos/pydantic/pydantic/issues/2678/events","html_url":"https://github.com/pydantic/pydantic/issues/2678","id":859124082,"node_id":"MDU6SXNzdWU4NTkxMjQwODI=","number":2678,"title":"PEP 563, PEP 649 and pydantic","user":{"login":"samuelcolvin","id":4039449,"node_id":"MDQ6VXNlcjQwMzk0NDk=","avatar_url":"https://avatars.githubusercontent.com/u/4039449?v=4","gravatar_id":"","url":"https://api.github.com/users/samuelcolvin","html_url":"https://github.com/samuelcolvin","followers_url":"https://api.github.com/users/samuelcolvin/followers","following_url":"https://api.github.com/users/samuelcolvin/following{/other_user}","gists_url":"https://api.github.com/users/samuelcolvin/gists{/gist_id}","starred_url":"https://api.github.com/users/samuelcolvin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samuelcolvin/subscriptions","organizations_url":"https://api.github.com/users/samuelcolvin/orgs","repos_url":"https://api.github.com/users/samuelcolvin/repos","events_url":"https://api.github.com/users/samuelcolvin/events{/privacy}","received_events_url":"https://api.github.com/users/samuelcolvin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1391910347,"node_id":"MDU6TGFiZWwxMzkxOTEwMzQ3","url":"https://api.github.com/repos/pydantic/pydantic/labels/meta","name":"meta","color":"fce2b8","default":false,"description":"high level, conceptual"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":45,"created_at":"2021-04-15T18:01:52Z","updated_at":"2022-08-31T16:33:43Z","closed_at":"2021-04-20T20:47:24Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":90194616,"node_id":"MDEwOlJlcG9zaXRvcnk5MDE5NDYxNg==","name":"pydantic","full_name":"pydantic/pydantic","private":false,"owner":{"login":"pydantic","id":110818415,"node_id":"O_kgDOBpr0bw","avatar_url":"https://avatars.githubusercontent.com/u/110818415?v=4","gravatar_id":"","url":"https://api.github.com/users/pydantic","html_url":"https://github.com/pydantic","followers_url":"https://api.github.com/users/pydantic/followers","following_url":"https://api.github.com/users/pydantic/following{/other_user}","gists_url":"https://api.github.com/users/pydantic/gists{/gist_id}","starred_url":"https://api.github.com/users/pydantic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pydantic/subscriptions","organizations_url":"https://api.github.com/users/pydantic/orgs","repos_url":"https://api.github.com/users/pydantic/repos","events_url":"https://api.github.com/users/pydantic/events{/privacy}","received_events_url":"https://api.github.com/users/pydantic/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pydantic/pydantic","description":"Data validation using Python type hints","fork":false,"url":"https://api.github.com/repos/pydantic/pydantic","forks_url":"https://api.github.com/repos/pydantic/pydantic/forks","keys_url":"https://api.github.com/repos/pydantic/pydantic/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pydantic/pydantic/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pydantic/pydantic/teams","hooks_url":"https://api.github.com/repos/pydantic/pydantic/hooks","issue_events_url":"https://api.github.com/repos/pydantic/pydantic/issues/events{/number}","events_url":"https://api.github.com/repos/pydantic/pydantic/events","assignees_url":"https://api.github.com/repos/pydantic/pydantic/assignees{/user}","branches_url":"https://api.github.com/repos/pydantic/pydantic/branches{/branch}","tags_url":"https://api.github.com/repos/pydantic/pydantic/tags","blobs_url":"https://api.github.com/repos/pydantic/pydantic/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pydantic/pydantic/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pydantic/pydantic/git/refs{/sha}","trees_url":"https://api.github.com/repos/pydantic/pydantic/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pydantic/pydantic/statuses/{sha}","languages_url":"https://api.github.com/repos/pydantic/pydantic/languages","stargazers_url":"https://api.github.com/repos/pydantic/pydantic/stargazers","contributors_url":"https://api.github.com/repos/pydantic/pydantic/contributors","subscribers_url":"https://api.github.com/repos/pydantic/pydantic/subscribers","subscription_url":"https://api.github.com/repos/pydantic/pydantic/subscription","commits_url":"https://api.github.com/repos/pydantic/pydantic/commits{/sha}","git_commits_url":"https://api.github.com/repos/pydantic/pydantic/git/commits{/sha}","comments_url":"https://api.github.com/repos/pydantic/pydantic/comments{/number}","issue_comment_url":"https://api.github.com/repos/pydantic/pydantic/issues/comments{/number}","contents_url":"https://api.github.com/repos/pydantic/pydantic/contents/{+path}","compare_url":"https://api.github.com/repos/pydantic/pydantic/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pydantic/pydantic/merges","archive_url":"https://api.github.com/repos/pydantic/pydantic/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pydantic/pydantic/downloads","issues_url":"https://api.github.com/repos/pydantic/pydantic/issues{/number}","pulls_url":"https://api.github.com/repos/pydantic/pydantic/pulls{/number}","milestones_url":"https://api.github.com/repos/pydantic/pydantic/milestones{/number}","notifications_url":"https://api.github.com/repos/pydantic/pydantic/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pydantic/pydantic/labels{/name}","releases_url":"https://api.github.com/repos/pydantic/pydantic/releases{/id}","deployments_url":"https://api.github.com/repos/pydantic/pydantic/deployments","created_at":"2017-05-03T21:23:58Z","updated_at":"2025-11-09T17:32:47Z","pushed_at":"2025-11-09T09:36:17Z","git_url":"git://github.com/pydantic/pydantic.git","ssh_url":"git@github.com:pydantic/pydantic.git","clone_url":"https://github.com/pydantic/pydantic.git","svn_url":"https://github.com/pydantic/pydantic","homepage":"https://docs.pydantic.dev","size":327577,"stargazers_count":25701,"watchers_count":25701,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":2306,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":512,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hints","json-schema","parsing","pydantic","python","python310","python311","python312","python313","python39","validation"],"visibility":"public","forks":2306,"open_issues":512,"watchers":25701,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"**Update 2:** see https://github.com/samuelcolvin/pydantic/issues/2678#issuecomment-1008139014, for a summary of how PEP 563 could effect pydantic.\r\n\r\n---\r\n\r\n**Update:** see [below](https://github.com/samuelcolvin/pydantic/issues/2678#issuecomment-823539148) this has been resolved by a changes in python 3.10 from the python steering council.\r\n\r\nThanks everyone for your thoughts, patience and hard work.\r\n\r\n---\r\n\r\n[PEP 563](https://www.python.org/dev/peps/pep-0563/) \"Postponed Evaluation of Annotations\" was introduced in python 3.7 behind the `from __future__ import annotations` switch, it basically meant all annotations are strings, not python objects.\r\n\r\nPydantic has tried to supported Postponed Annotations since `v0.18.0`, see #348.\r\n\r\nThe problem however is that trying to evaluate those strings to get the real annotation objects is really hard, perhaps impossible to always do correctly, see #248 #234 #397 #415 #486 #531 #545 #635 #655 #704 #1298 #1332 #1345 #1370 #1668 #1736 #1873 #1895 #2112 #2314 #2323 #2411 \r\n\r\nThe reasons are complicated but basically `typing.get_type_hints()` doesn't work all the time and neither do the numerous hacks we've introduced to try and get fix it. Even if `typing.get_type_hints()` was faultless, it would still be massively slower than the current semantics or PEP 649 (see below).\r\n\r\nIn short - pydantic doesn't work very well with postponed annotations, perhaps it never will.\r\n\r\n# The Problem\r\n\r\nThe problem is that postponed annotations are set to be come default in 3.10, features of which will be frozen in about three week.\r\n\r\nEven worse, there's no way to switch back to the current behaviour.\r\n\r\n# The Solution\r\n\r\nThe solution to this is [PEP 649](https://www.python.org/dev/peps/pep-0649/) developed by Larry Hastings. This basically means annotations evaluation is lazy - the work of building `__annotations__` isn't done until you access `__annotations__`.\r\n\r\nAs far as I can tell this is the best of both worlds.\r\n\r\n# The Second Problem\r\n\r\nThe sad reality however is that it seems very possible that PEP 649 will get rejected and when python 3.10 is released it will break much of pydantic, and thereby FastAPI and all the other libraries that rely on pydantic (as well as other libraries that use annotations at runtime like [enforce](https://github.com/RussBaz/enforce) and [typer](https://github.com/tiangolo/typer) presumably).\r\n\r\nSee [this very long discussion](https://mail.python.org/archives/list/python-dev@python.org/thread/QSASX6PZ3LIIFIANHQQFS752BJYFUFPY/#UITB2A657TAINAGWGRD6GCKWFC5PEBIZ) of the issue on **python-dev** about whether PEP 649 is a good idea.\r\n\r\n---\r\n\r\n# The Point\r\n\r\nSo why am I saying all this apart from whinging about something I don't agree with?\r\n\r\n## 1. This is fair warning\r\n\r\nThat pydantic might break in a big way if python's core developers continue value principle over pragmatism.\r\n\r\n## 2.  You can help\r\n\r\nThousands of developers and organisations big and small rely on pydantic. Type hints might have been conceived to help readers and static type checkers, but they're now used to great effect at runtime by lots and lots of people - they make python better.\r\n\r\nIn the end I don't think python's core developers and [steering council](https://www.python.org/dev/peps/pep-8102/) want to make your experience of python worse. They just haven't realised how important this is. (Even Larry hadn't heard of pydantic or FastAPI until yesterday when he emailed me, I guess they don't read the [python developer survey](https://www.jetbrains.com/lp/python-developers-survey-2020/) ðŸ˜‰)\r\n\r\n~If you value pydantic or FastAPI or other libraries that use annotations at runtime, please (constructively and respectfully) let the python steering council know that you would like PEP 649 to be accepted.~ Please don't contact members of the python community, they're aware of this issue (see below) and are taking it seriously.\r\n\r\nI understand the decision on PEP 649 will be made over the next few days, ~so if you're going to do anything do it today~.","reactions":{"url":"https://api.github.com/repos/pydantic/pydantic/issues/2678/reactions","total_count":1126,"+1":883,"-1":1,"laugh":0,"hooray":0,"confused":62,"heart":86,"rocket":0,"eyes":94},"timeline_url":"https://api.github.com/repos/pydantic/pydantic/issues/2678/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]