{"url":"https://api.github.com/repos/pydantic/pydantic/issues/1073","repository_url":"https://api.github.com/repos/pydantic/pydantic","labels_url":"https://api.github.com/repos/pydantic/pydantic/issues/1073/labels{/name}","comments_url":"https://api.github.com/repos/pydantic/pydantic/issues/1073/comments","events_url":"https://api.github.com/repos/pydantic/pydantic/issues/1073/events","html_url":"https://github.com/pydantic/pydantic/issues/1073","id":532385682,"node_id":"MDU6SXNzdWU1MzIzODU2ODI=","number":1073,"title":"Can't parse_raw Optional[Json] generated from Pydantic","user":{"login":"volker48","id":69447,"node_id":"MDQ6VXNlcjY5NDQ3","avatar_url":"https://avatars.githubusercontent.com/u/69447?v=4","gravatar_id":"","url":"https://api.github.com/users/volker48","html_url":"https://github.com/volker48","followers_url":"https://api.github.com/users/volker48/followers","following_url":"https://api.github.com/users/volker48/following{/other_user}","gists_url":"https://api.github.com/users/volker48/gists{/gist_id}","starred_url":"https://api.github.com/users/volker48/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/volker48/subscriptions","organizations_url":"https://api.github.com/users/volker48/orgs","repos_url":"https://api.github.com/users/volker48/repos","events_url":"https://api.github.com/users/volker48/events{/privacy}","received_events_url":"https://api.github.com/users/volker48/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":597426502,"node_id":"MDU6TGFiZWw1OTc0MjY1MDI=","url":"https://api.github.com/repos/pydantic/pydantic/labels/bug%20V1","name":"bug V1","color":"ee0701","default":false,"description":"Bug related to Pydantic V1.X"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2019-12-04T01:38:59Z","updated_at":"2019-12-20T14:04:23Z","closed_at":"2019-12-20T14:04:23Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"# Bug\r\n\r\nPlease complete:\r\n* OS: any\r\n* Python version `import sys; print(sys.version)`:3.7.3 (default, Mar 27 2019, 09:23:15)\r\n[Clang 10.0.1 (clang-1001.0.46.3)]\r\n* Pydantic version `import pydantic; print(pydantic.VERSION)`: 1.2\r\n\r\nWhere possible please include a self contained code snippet describing your bug:\r\n\r\n```py\r\nfrom typing import Optional\r\nfrom pydantic import Json, BaseModel\r\n\r\nclass Test(BaseModel):\r\n    name: str\r\n    some_obj: Optional[Json]\r\n\r\nt = Test(name=\"hi\")\r\nserialized = t.json()\r\nprint(serialized)\r\nt_deserialized = Test.parse_raw(serialized)\r\n```\r\n\r\nThe above will fail with:\r\n\r\n```\r\npydantic.error_wrappers.ValidationError: 1 validation error for Test\r\nsome_obj\r\n  JSON object must be str, bytes or bytearray (type=type_error.json)\r\n```\r\nBecause `serialized` is JSON that takes the following form: `{\"name\": \"hi\", \"some_obj\": null}`. If the `some_obj` key is omitted entirely everything works fine.\r\n\r\nI would expect `parse_raw()` to work with the output of `json()`.\r\n\r\nThe crux of the issue seems to be that validation will fail if an Optional[Json] field is present, but has a value of `None`. This will also fail `Test(name='foo', some_obj=None)`. \r\n\r\nThis example works fine in pydantic < 1.","closed_by":{"login":"samuelcolvin","id":4039449,"node_id":"MDQ6VXNlcjQwMzk0NDk=","avatar_url":"https://avatars.githubusercontent.com/u/4039449?v=4","gravatar_id":"","url":"https://api.github.com/users/samuelcolvin","html_url":"https://github.com/samuelcolvin","followers_url":"https://api.github.com/users/samuelcolvin/followers","following_url":"https://api.github.com/users/samuelcolvin/following{/other_user}","gists_url":"https://api.github.com/users/samuelcolvin/gists{/gist_id}","starred_url":"https://api.github.com/users/samuelcolvin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samuelcolvin/subscriptions","organizations_url":"https://api.github.com/users/samuelcolvin/orgs","repos_url":"https://api.github.com/users/samuelcolvin/repos","events_url":"https://api.github.com/users/samuelcolvin/events{/privacy}","received_events_url":"https://api.github.com/users/samuelcolvin/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pydantic/pydantic/issues/1073/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pydantic/pydantic/issues/1073/timeline","performed_via_github_app":null,"state_reason":"completed"}