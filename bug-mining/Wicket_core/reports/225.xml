<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:18:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-3702] wicket:border: inconsistency between add() and remove()</title>
                <link>https://issues.apache.org/jira/browse/WICKET-3702</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Assuming c1 is a Border and c2 is some component, the following sequence crashes with duplicate addition:&lt;/p&gt;

&lt;p&gt;c1.add(c2);&lt;br/&gt;
c1.remove(c2);&lt;br/&gt;
c1.add(c2);&lt;/p&gt;

&lt;p&gt;The reason for this is that remove() doesn&apos;t remove the object from the bodycontainer. The sequence can be made to work by changing the middle line to:&lt;/p&gt;

&lt;p&gt;c1.getBodyContainer().remove(c2);&lt;/p&gt;

&lt;p&gt;That remove() doesn&apos;t look the component from the same container as add() adds it to, seems to violate the principle of least astonishment. Unfortunately the Component structure manipulation API has more methods, such as swap(), size(), get(), etc. which are final, and can&apos;t be overridden by Border as they are. It could be best to force all users to use c1.getBodyContainer().add() instead of c1.add(), because consistent operation is probably easier to deal with in the long run than behavior that conforms to initial assumptions but has flaws elsewhere.&lt;/p&gt;

&lt;p&gt;This ticket suggests removing the overload of add() and documenting the difference in migration guide.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12506898">WICKET-3702</key>
            <summary>wicket:border: inconsistency between add() and remove()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ivaynberg">Igor Vaynberg</assignee>
                                    <reporter username="alankila">Antti S. Lankila</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 May 2011 19:46:48 +0000</created>
                <updated>Tue, 14 Jun 2011 14:59:55 +0000</updated>
                            <resolved>Tue, 14 Jun 2011 14:59:55 +0000</resolved>
                                    <version>1.5-RC4</version>
                                    <fixVersion>1.5-RC5</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="13038132" author="mgrigorov" created="Mon, 23 May 2011 18:55:01 +0000"  >&lt;p&gt;add() is made this way because it is more convenient for the user to add child components to the border body. Most of the time the Border itself adds the components in the &quot;border area&quot;. The other methods are not made this way because they are not so often used. &lt;br/&gt;
The javadoc will be updated.&lt;/p&gt;</comment>
                            <comment id="13038156" author="ivaynberg" created="Mon, 23 May 2011 19:26:01 +0000"  >&lt;p&gt;actually there was a request to make add() behave normally for borders&lt;br/&gt;
clients can use border.addtobody() instead of add()&lt;/p&gt;

&lt;p&gt;this is to make things more consistent. if i add() something i should be able to remove() it and see it in iterator() and size()&lt;/p&gt;</comment>
                            <comment id="13038396" author="mgrigorov" created="Tue, 24 May 2011 05:45:13 +0000"  >&lt;p&gt;Define &quot;behave normally for borders&quot;.&lt;br/&gt;
Also take into account the last few comments at &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-2494&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/WICKET-2494&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13040063" author="ivaynberg" created="Fri, 27 May 2011 05:10:23 +0000"  >&lt;p&gt;the problem is consistency. we either forward all related methods or none.&lt;/p&gt;</comment>
                            <comment id="13040065" author="ivaynberg" created="Fri, 27 May 2011 05:17:56 +0000"  >&lt;p&gt;thinking more about this...&lt;/p&gt;

&lt;p&gt;it would be trivial to forward all the necessary methods. a tweak to markupcontainer with an extra layer of indirection is all it would take. however, if we do this it will make using borders to the user seem consistent, but it will make our own framework code inconsistent.&lt;/p&gt;

&lt;p&gt;it is easy enough to forward add(), remove(), size(), iterator() - most others are written in terms of these. however, do we forward visitChildren()? we would have to to make the experience consistent for user, but by doing those we will make our internal framework code inconsistent. for example - our internal framework code now will not see components added to the actual border - just like the client wont.&lt;/p&gt;

&lt;p&gt;esentially we are creating a portal for the client: OUTSIDE-&amp;gt;?&lt;del&gt;&amp;gt;?&lt;/del&gt;&amp;gt;BODY and letting user manipulate the body from the outside, skipping the layer in-between. but by making it consistent we also make the layer in-between inaccessible to our own code.&lt;/p&gt;

&lt;p&gt;so the question is: what has the bigger impact. how many usecases exist where the user needs to treat the border without knowing it is a border vs how many usecases exist where we traverse components without needing to know what kind of component it is....i think the latter are much more prevalent.&lt;/p&gt;

&lt;p&gt;long story short, i was wrong in &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-2494&quot; title=&quot;Outside form components problem&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-2494&quot;&gt;&lt;del&gt;WICKET-2494&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13040104" author="mgrigorov" created="Fri, 27 May 2011 07:28:57 +0000"  >&lt;p&gt;A test is failing: org.apache.wicket.extensions.markup.html.repeater.data.table.DataTableTest.test_1()&lt;/p&gt;

&lt;p&gt;The problem is that&lt;br/&gt;
org.apache.wicket.extensions.markup.html.repeater.data.table.HeadersToolbar.newSortableHeader(String, String, ISortStateLocator)&lt;br/&gt;
can return a border or non-border and the client code cannot know that it has to use .addToBody() instead of .add().&lt;/p&gt;</comment>
                            <comment id="13045372" author="mgrigorov" created="Tue, 7 Jun 2011 11:27:32 +0000"  >&lt;p&gt;We have to decide what to do here.&lt;br/&gt;
Removing &apos;final&apos; from add(), get(), remove(), ... will be the best from user point of view, but it is not the best for the framework.&lt;/p&gt;

&lt;p&gt;For those who don&apos;t know what is the problem now: if the method signature says &quot;returns Component&quot; but the implementation actually returns a Border then following calls to component.add() will do the wrong thing, it will add to the border itself, not to its body.&lt;/p&gt;

&lt;p&gt;Maybe AWT is not the best example but there Container class doesn&apos;t forbid overriding add(), remove(), ...&lt;/p&gt;</comment>
                            <comment id="13049156" author="mgrigorov" created="Tue, 14 Jun 2011 12:29:43 +0000"  >&lt;p&gt;A patch that removes final from add(), remove(), replace, addOrReplace() and size(). This way Border can override them and delegate them to the respective getBodyContainer().xyz().&lt;/p&gt;

&lt;p&gt;All unit tests pass. My application also uses Borders and all seems OK.&lt;/p&gt;</comment>
                            <comment id="13049216" author="pedrosans" created="Tue, 14 Jun 2011 14:55:46 +0000"  >&lt;p&gt;+1 for Martin&apos;s patch. Some times it is good to look at AWT API because they probably went through component API design questions like us. JFrame for instance required to get the content panel to add a new component in begining &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. But its JFrame#add/remove/etc/Impl got changed to delegate to content panel.&lt;br/&gt;
frame.getContentPanel().add(newComp) --&amp;gt; frame.add(newCompo)&lt;br/&gt;
I see some similarities here.&lt;/p&gt;

&lt;p&gt;1 - &lt;a href=&quot;http://weblogs.java.net/blog/hansmuller/archive/2005/11/jframeadd_conte.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://weblogs.java.net/blog/hansmuller/archive/2005/11/jframeadd_conte.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13049218" author="ivaynberg" created="Tue, 14 Jun 2011 14:59:55 +0000"  >&lt;p&gt;giving up on fixing this properly for now. add and remove are now in sync but iterator/size/get are not.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12482550" name="wicket-3702.patch" size="33593" author="mgrigorov" created="Tue, 14 Jun 2011 12:29:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>71284</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 23 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ka9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116479</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>