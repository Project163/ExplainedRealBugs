<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:18:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-3471] WicketTester checkUsability is called before the request has started</title>
                <link>https://issues.apache.org/jira/browse/WICKET-3471</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;For example, when clicking a link, the checkUsability method is called with the link before RequestCycle.onBeginRequest has been called. This causes tests to fail when, for example, the link has a security check that requires the request cycle. I&apos;ve created a quickstart that demonstrates the problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12499453">WICKET-3471</key>
            <summary>WicketTester checkUsability is called before the request has started</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="papegaaij">Emond Papegaaij</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Feb 2011 09:16:31 +0000</created>
                <updated>Fri, 27 May 2011 14:51:44 +0000</updated>
                            <resolved>Fri, 27 May 2011 14:51:44 +0000</resolved>
                                    <version>1.4.15</version>
                                    <fixVersion>1.4.18</fixVersion>
                    <fixVersion>1.5-RC5</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12998282" author="mgrigorov" created="Wed, 23 Feb 2011 10:04:46 +0000"  >&lt;p&gt;This usecase is a bit strange to me - a component is enabled only when there is a request.&lt;br/&gt;
checkUsability() is there to prevent usage of (e.g. clicking on) disabled/invisible components. In real environment the browser cannot fire event on such component.&lt;br/&gt;
I am not sure your use case can be supported in WicketTester. We either need to remove the whole check or make this method protected so you can override it locally to support your need.&lt;/p&gt;</comment>
                            <comment id="12998291" author="papegaaij" created="Wed, 23 Feb 2011 10:21:45 +0000"  >&lt;p&gt;Of course, we do not use the check I used for the quickstart, it only serves to demonstrate the problem. In our application we set up a context in onBeginRequest and tear it down in onEndRequest. This context is required for some of the security checks to be performed. For example, this context contains the organisation the current user belongs to and one of the security checks verifies that the link targets a page that is part of a module that is active for that organisation. This security check currently fails, because the organisation has not yet been set on the context.&lt;/p&gt;</comment>
                            <comment id="12998764" author="mgrigorov" created="Thu, 24 Feb 2011 08:58:19 +0000"  >&lt;p&gt;I really don&apos;t see a way to move checkUsability() inside the request cycle. There is no information about the component/behavior at that point (it gets resolved at later point when it is too late to make the check and actually is inside Wicket core core, not WicketTester).&lt;/p&gt;

&lt;p&gt;As I said earlier I see two solutions:&lt;br/&gt;
1) make it &apos;protected&apos; so you can override it to do what you need if needed&lt;br/&gt;
2) remove it completely&lt;/p&gt;

&lt;p&gt;I prefer 1).&lt;br/&gt;
checkUsability() may not be perfect and doesn&apos;t cover all cases but seems to be good enough for most of them.&lt;/p&gt;

&lt;p&gt;Other opinions ?  &lt;/p&gt;</comment>
                            <comment id="12998812" author="dashorst" created="Thu, 24 Feb 2011 12:18:09 +0000"  >&lt;p&gt;This fixes our issues, discovers a hidden bug in our test cases, and checks for usability (not-hidden, nor disabled) in even more places&lt;/p&gt;</comment>
                            <comment id="12998846" author="dashorst" created="Thu, 24 Feb 2011 13:42:52 +0000"  >&lt;p&gt;A possible way to address this is to proxy the requestcycle and perform the check after onBeginRequest. Problem is that the component to check is not always known in the code paths...&lt;/p&gt;

&lt;p&gt;Looking at this it seems wickettester is a big pain in the behind: a big giant tangled mess.&lt;/p&gt;</comment>
                            <comment id="12998847" author="dashorst" created="Thu, 24 Feb 2011 13:44:33 +0000"  >&lt;p&gt;&lt;b&gt;The&lt;/b&gt; big question in my opinion is why doesn&apos;t Wicket throw an exception from inside core when an invisible/disabled component receives an event during wickettester processing? Why is that checkUsability necessary?&lt;/p&gt;</comment>
                            <comment id="12998855" author="pedrosans" created="Thu, 24 Feb 2011 14:08:25 +0000"  >&lt;p&gt;Hi Martjin, iirc it was add because the core was failing in to refuse execute behaviors in not enabled/disable behaviors. But it is fixed now and I&apos;m 1+ to bring this check responsibility back to core request processing. Initial investigations shows that we can remove the checkUsability from clickLink and executeAjaxEvent methods. Sending the patch with tests.&lt;/p&gt;</comment>
                            <comment id="12998866" author="dashorst" created="Thu, 24 Feb 2011 14:33:25 +0000"  >&lt;p&gt;Just as a reminder to myself: need to revert r140505 in our svn repository when this issue is resolved.&lt;/p&gt;</comment>
                            <comment id="12998998" author="mgrigorov" created="Thu, 24 Feb 2011 19:26:36 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I have a question for the patch.&lt;br/&gt;
Test &apos;testBehaviorOnDisabledComponentAllowed()&apos; allows execution of Ajax behavior on disabled component. The next test &apos;testClickOnDisableAjaxLinkNotAllowed()&apos; checks that clicking on disabled AjaxLink is not allowed. AjaxLink is just a Link with AjaxEventBehavior(&quot;onclick&quot;).&lt;br/&gt;
It looks to me that both methods contradict to each other. What I&apos;m missing ?&lt;/p&gt;</comment>
                            <comment id="12999004" author="pedrosans" created="Thu, 24 Feb 2011 19:45:08 +0000"  >&lt;p&gt;AjaxLink has an AjaxEventBehavior that do not override Behavior#canCallListenerInterface, so invoking the behavior when its component is not enabled is not allowed, this is the default policy. TestBehaviorDisabledComponentAllowed override the canCallListenerInterface to allow the use case at &apos;testBehaviorOnDisabledComponentAllowed()&apos;&lt;/p&gt;</comment>
                            <comment id="13040264" author="mgrigorov" created="Fri, 27 May 2011 14:51:44 +0000"  >&lt;p&gt;Made the method protected so it can be suppressed when the user app really needs this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12471835" name="WICKET-3471.patch" size="7833" author="pedrosans" created="Thu, 24 Feb 2011 14:08:25 +0000"/>
                            <attachment id="12471828" name="WICKET-3471.patch" size="4606" author="dashorst" created="Thu, 24 Feb 2011 12:18:09 +0000"/>
                            <attachment id="12471709" name="quickstart.tar.bz2" size="4613" author="papegaaij" created="Wed, 23 Feb 2011 09:17:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204256</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 26 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kavj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116579</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>