<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:20:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4286] ListView causes page ID increment</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4286</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;A ListView with setReuseItems(false) causes the page ID to increment when the page is reloaded or the back button is pressed. This new ID is not reflected in the URL so Ajax actions against the new ID are lost when navigating away and back again. &lt;/p&gt;

&lt;p&gt;Steps to reproduce in quickstart&lt;br/&gt;
1) Load quickstart project in browser&lt;br/&gt;
2) Click &quot;Link to Other&quot; then click browser&apos;s back button.&lt;br/&gt;
3) Notice the log statement indicates the HomePage ID is 2, yet the URL remains at ID 0&lt;br/&gt;
4) Click &quot;Ajax Increment Link&quot; a few times&lt;br/&gt;
5) Click &quot;Link to Other&quot; then click browser&apos;s back button&lt;br/&gt;
6) Notice the counter is at zero, and subsequent clicks to the &quot;Ajax Increment Link&quot; start from zero. The current page ID output in the log is 4.&lt;/p&gt;
</description>
                <environment>any</environment>
        <key id="12534538">WICKET-4286</key>
            <summary>ListView causes page ID increment</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ivaynberg">Igor Vaynberg</assignee>
                                    <reporter username="malichtenberg">Mark Lichtenberg</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Dec 2011 20:10:29 +0000</created>
                <updated>Mon, 30 Apr 2012 20:50:24 +0000</updated>
                            <resolved>Wed, 25 Apr 2012 21:24:30 +0000</resolved>
                                    <version>1.5.3</version>
                                    <fixVersion>1.5.6</fixVersion>
                    <fixVersion>6.0.0-beta2</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13166974" author="svenmeier" created="Sat, 10 Dec 2011 20:44:33 +0000"  >&lt;p&gt;If you use the link to OtherPage and then the back button, the browser requests page ?0. The page with id 0 is correctly restored and rendered.&lt;br/&gt;
Before rendering the ListView removes all its children and recreates them. This results in a new page version, which is correctly taken into account by the ajax link and your log output.&lt;/p&gt;

&lt;p&gt;This might look unexpected but actually it&apos;s quite common: the browser requests page version X but gets version Y as response.&lt;/p&gt;

&lt;p&gt;So what is the problem you&apos;re experiencing? Wicket does not (yet) support back button for ajax requests, see &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-271&quot; title=&quot;investigate Ajax back button support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-271&quot;&gt;&lt;del&gt;WICKET-271&lt;/del&gt;&lt;/a&gt; .&lt;/p&gt;</comment>
                            <comment id="13166994" author="dretzlaff" created="Sat, 10 Dec 2011 22:17:27 +0000"  >&lt;p&gt;That&apos;s an old ticket! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;1.5&apos;s liberal advancement of the page identifier changes Wicket&apos;s limited AJAX versioning support significantly, in my opinion detrimentally:&lt;br/&gt;
1. In 1.4 reloading a page (with back or reload buttons) results in the most recent version associated with that URL; in 1.5 it results in the oldest version.&lt;br/&gt;
2. With a 1.5 AJAXy page, it seems quite easy to get into a state where different AJAX behaviors target different versions of the same page. That sounds confusing to debug.&lt;/p&gt;

&lt;p&gt;ListView&apos;s effect on the page version makes the gotcha more unexpected, but I agree it&apos;s working as designed. Maybe Wicket&apos;s AJAX versioning gotchas just get an extra underscore for now, pending full support?&lt;/p&gt;

&lt;p&gt;Was there discussion of the tradeoffs between 1.4 and 1.5&apos;s versioning strategies? I looked but I could not find one. I don&apos;t mean to naysay the new design since I don&apos;t know the history.&lt;/p&gt;</comment>
                            <comment id="13167142" author="malichtenberg" created="Sun, 11 Dec 2011 17:29:55 +0000"  >&lt;p&gt;My concern is after the page ID is advanced due to a reload or back button any model updates done on that version can never be retrieved. With 1.4 the view did not reflect the most recent version of the page, but since the page ID never advanced the model was intact. &lt;/p&gt;

&lt;p&gt;As Dan mentions with 1.5 we can easily get into situations where ajax requests target different page version, and with that a different copies of page models. &lt;/p&gt;</comment>
                            <comment id="13169304" author="thomas.goetz" created="Wed, 14 Dec 2011 12:48:15 +0000"  >&lt;p&gt;I&apos;m not quite sure if this is related to the problem, but I guess so:&lt;/p&gt;

&lt;p&gt;we have a page containing an AJAX wizard. Users can go forward and backward and fill several form components which are correctly written into the model when the wizard step is changed (via AJAX).&lt;/p&gt;

&lt;p&gt;But: if you reload the page, all input data is gone (from all wizard pages), as the URL still shows ?0 ...&lt;/p&gt;</comment>
                            <comment id="13169562" author="dretzlaff" created="Wed, 14 Dec 2011 18:23:27 +0000"  >&lt;p&gt;Thomas, it sounds likely. Look at the AJAX URLs to see if they&apos;re targeting a different page version than in the URL. Note that AJAX requests themselves don&apos;t advance the page identifier (see WebPage#dirty(boolean)), but for example normal reloads containing ListViews will. So maybe you can workaround the issue in your wizard by identifying and suppressing the non-AJAX, page-dirtying operation.&lt;/p&gt;</comment>
                            <comment id="13170818" author="thomas.goetz" created="Fri, 16 Dec 2011 08:12:51 +0000"  >&lt;p&gt;@Dan: what exactly do you mean by that? It seems to me that the page &lt;b&gt;should&lt;/b&gt; be dirtied upon ajax operations (+ model changes)?! Because on page reload the &quot;old&apos; state is restored (after page has been rendered), so everything that happend after this (via AJAX) is not serialized, or do I get this wrong?&lt;/p&gt;</comment>
                            <comment id="13170820" author="thomas.goetz" created="Fri, 16 Dec 2011 08:18:02 +0000"  >&lt;p&gt;And: yes, the ajax URLs target an incremented version of the page, while the URL still shows the &quot;old&quot; one.&lt;/p&gt;</comment>
                            <comment id="13171149" author="dretzlaff" created="Fri, 16 Dec 2011 19:19:51 +0000"  >&lt;p&gt;There are two concepts here: &quot;touched&quot; pages and &quot;dirty&quot; pages. Simply retrieving a page from the page manager &quot;touches&quot; it, scheduling it for serialization into the page store at the end of the request. The question is whether it updates the original page store entry, or goes into a new entry. The page gets a new page map entry if and only if it is marked &quot;dirty&quot; which is triggered by component hierarchy change, component model change, or explicitly with Page#dirty(). However, WebPage#dirty() has a special case which prevents AJAX requests from &lt;b&gt;ever&lt;/b&gt; marking a page dirty.&lt;/p&gt;

&lt;p&gt;So after the request that originally created your wizard&apos;s page, there must be another non-AJAX request which dirties the page and advances its identifier past the one in the browser address bar.&lt;/p&gt;</comment>
                            <comment id="13171150" author="dretzlaff" created="Fri, 16 Dec 2011 19:22:21 +0000"  >&lt;p&gt;And my disclaimer: I didn&apos;t design this, I&apos;m just interpreting the code. If I&apos;m wrong, I hope somebody corrects me. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13181971" author="mgrigorov" created="Sat, 7 Jan 2012 14:23:33 +0000"  >&lt;p&gt;@Thomas: can you attach a quickstart with your case too ?&lt;/p&gt;</comment>
                            <comment id="13181972" author="mgrigorov" created="Sat, 7 Jan 2012 14:26:00 +0000"  >&lt;p&gt;I think this ticket should be closed as &quot;Not a problem&quot; because ListView is designed to work this way - in each call of its onBeforeRender() it recreates its items which makes the page dirty, and therefore increases the page id.&lt;br/&gt;
Thomas can open a new ticket with a quickstart.&lt;/p&gt;</comment>
                            <comment id="13205140" author="ivaynberg" created="Fri, 10 Feb 2012 01:37:06 +0000"  >&lt;p&gt;this is no different then how 1.4.x worked. the back button takes you back to the state of the page before ajax changes. in order for it to take you back to the &quot;last&quot; click we would need ajax history support, which we do not yet have.&lt;/p&gt;</comment>
                            <comment id="13205148" author="dretzlaff" created="Fri, 10 Feb 2012 01:50:39 +0000"  >&lt;p&gt;I agree there isn&apos;t a good solution without AJAX history, but I respectfully disagree that 1.4 worked the same. In 1.4 reloading the page returned the most recent version of a page (the one with the most AJAX updates); in 1.5 those AJAX changes can be lost on reload/back.&lt;/p&gt;</comment>
                            <comment id="13205189" author="ivaynberg" created="Fri, 10 Feb 2012 03:19:02 +0000"  >&lt;p&gt;go to &lt;a href=&quot;http://www.wicket-library.com/wicket-examples/ajax/links&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.wicket-library.com/wicket-examples/ajax/links&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;this is wicket 1.5.x (1.5.4 currently)&lt;/p&gt;

&lt;p&gt;click the ajax link to increment the counter a few times. reload the page. counter retains its value, ajax changes are not lost.&lt;/p&gt;

&lt;p&gt;click the back link, you will be taken wherever you were before. since ajax links did not cause a url change and no browser history change you are not taken to a page with counter&apos;s previous value.&lt;/p&gt;

&lt;p&gt;this is exactly how 1.4 behaves.&lt;/p&gt;

&lt;p&gt;the only difference between the two is that 1.5.x always redirects to a non-bookmarkable url so a refresh never loses ajax changes like it did in 1.4.x which did not redirect to a non-bookmarkable url so a refresh would recreate the page from scratch.&lt;/p&gt;
</comment>
                            <comment id="13205193" author="ivaynberg" created="Fri, 10 Feb 2012 03:29:50 +0000"  >&lt;p&gt;i think the root cause here is the difference in caching, not how page version or ajax is handled. in 1.5.x the back button causes a request back to the server which causes the page to be rerendered and the version incremented. in 1.4.x the back button would not cause a request to the server, instead the cached version of the page would be shown. im not sure why this was changed in 1.5.x, may be worth opening a discussion on dev@.&lt;/p&gt;</comment>
                            <comment id="13205195" author="dretzlaff" created="Fri, 10 Feb 2012 03:38:18 +0000"  >&lt;p&gt;No, I think the issue is that non-AJAX reloads that render ListViews end up calling MarkupContainer#add, incrementing the page ID but not updating the URL. The relevant change is in Page#dirty() which only scheduled a page to be flushed in 1.4, and now assigns it a new page ID.&lt;/p&gt;</comment>
                            <comment id="13252771" author="ivaynberg" created="Thu, 12 Apr 2012 19:46:13 +0000"  >&lt;p&gt;a valid usecase:&lt;/p&gt;

&lt;p&gt;whats happening is this&lt;/p&gt;

&lt;p&gt;user hits the page /foo&lt;br/&gt;
goes to /foo?1&lt;br/&gt;
does a bunch of ajax stuff, staying on /foo?1&lt;br/&gt;
clicks refresh, so hits /foo?1&lt;br/&gt;
listview refreshes, changing hierarchy, creating page version 2&lt;br/&gt;
the ajax behavior&apos;s url is rendered as /foo?2:...&lt;br/&gt;
the page is rendered, but not redirected to /foo?2&lt;/p&gt;

&lt;p&gt;so what we have now is a browser pointing to /foo?1 and ajax (and&lt;br/&gt;
non-ajax) urls pointing to /foo?2&lt;/p&gt;

&lt;p&gt;further clicks work only because the component they repaint has the&lt;br/&gt;
same markup id on page 1 and page 2. however, all model changes are&lt;br/&gt;
stored in page 2. this is why when the browser is refreshed the&lt;br/&gt;
counter reverts to a previous value - because it is page 1 that is&lt;br/&gt;
rerendered.&lt;/p&gt;

&lt;p&gt;there are two ways to fix this:&lt;/p&gt;

&lt;p&gt;1) redirect to correct version. so when the browser is refreshed for&lt;br/&gt;
the first time on /foo?1 the browser would redirect to /foo?2 and it&lt;br/&gt;
would keep doing that for every refresh. not ideal.&lt;/p&gt;

&lt;p&gt;2) freeze the page version when we are accessing a url that we know&lt;br/&gt;
will not mutate the state of the page - meaning urls that just render&lt;br/&gt;
the page and do not invoke any listeners. the only state we will lose&lt;br/&gt;
is noise from component replacement in listviews and user&apos;s&lt;br/&gt;
onbeforerender() overrides which i think is acceptable since they do&lt;br/&gt;
not represent true state mutation that comes from intentional&lt;br/&gt;
callbacks.&lt;/p&gt;</comment>
                            <comment id="13252805" author="nsegura3" created="Thu, 12 Apr 2012 20:37:27 +0000"  >&lt;p&gt;Attached QuickStart. &lt;br/&gt;
Access URL is &lt;a href=&quot;https://localhost:8443/test/ajaxtest&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://localhost:8443/test/ajaxtest&lt;/a&gt;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;click on the buttons several times&lt;/li&gt;
	&lt;li&gt;refresh page: the counters should now reflect the clicks&lt;/li&gt;
	&lt;li&gt;click on the buttons more times&lt;/li&gt;
	&lt;li&gt;refresh page: the counters do not reflect click after first refresh&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12539769">WICKET-4360</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12553273">WICKET-4525</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12506786" name="ajaxtest1.5.3.tar.gz" size="20212" author="malichtenberg" created="Fri, 9 Dec 2011 20:11:11 +0000"/>
                            <attachment id="12522477" name="ajaxupdate.zip" size="29279" author="nsegura3" created="Thu, 12 Apr 2012 20:37:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>220260</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 32 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0k8uf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116250</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>