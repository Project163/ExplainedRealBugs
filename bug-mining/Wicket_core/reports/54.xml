<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:16:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-3413] FLAG_INHERITABLE_MODEL and default model change</title>
                <link>https://issues.apache.org/jira/browse/WICKET-3413</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;The issue is about correctness of Component#setDefaultModel (Component#setModelImpl) method behavior. I expect that the flag FLAG_INHERITABLE_MODEL should be checked there and turned off in case if new model is not a IComponentInheritedModel. &lt;/p&gt;

&lt;p&gt;Let check the next code:&lt;br/&gt;
public MyPanel(String id) {&lt;br/&gt;
 super(id);&lt;br/&gt;
  ...&lt;br/&gt;
  form.setModel(new CompoundPropertyModel(this));&lt;br/&gt;
  DropDownChoice ddc = new DropDownChoice(&quot;variant&quot;, Arrays.ofList(...)) {    // p1&lt;br/&gt;
    @Override&lt;br/&gt;
    protected void onInitialize() &lt;/p&gt;
{
       super.onInitialize();
       setModel(new DefaultingWrapModel(getModel(), Model.of(&quot;default value&quot;));            // p2
    }
&lt;p&gt;  };&lt;br/&gt;
  ddc.setNullValid(false);&lt;br/&gt;
  ddc.setRequired(true);&lt;br/&gt;
  form.add(ddc);&lt;br/&gt;
  ...&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;In the (p1) the DDC will initialize with CompoundPropertyModel and the FLAG_INHERITABLE_MODEL will be turned on soon by the first invocation of FormComponent#getModel().&lt;/p&gt;

&lt;p&gt; In the (p2) we wrap the DDC model with the model which provide the default value (DefaultingWrapModel implements IWrapModel). So we change the model, but the FLAG_INHERITABLE_MODEL is still turned on. On the Component#detach() event, the method Component#setModelImpl(null) will be invoked for the ddc and the DefaultingWrapModel instance will be lost:&lt;/p&gt;

&lt;p&gt;		// reset the model to null when the current model is a IWrapModel and&lt;br/&gt;
		// the model that created it/wrapped in it is a IComponentInheritedModel&lt;br/&gt;
		// The model will be created next time.&lt;br/&gt;
		if (getFlag(FLAG_INHERITABLE_MODEL))&lt;/p&gt;
		{
			setModelImpl(null);
			setFlag(FLAG_INHERITABLE_MODEL, false);
		}

&lt;p&gt;I think that such behavior is unexpected.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://apache-wicket.1842946.n4.nabble.com/1-4-15-FLAG-INHERITABLE-MODEL-and-default-model-change-td3252093.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://apache-wicket.1842946.n4.nabble.com/1-4-15-FLAG-INHERITABLE-MODEL-and-default-model-change-td3252093.html&lt;/a&gt;&lt;/p&gt;</description>
                <environment>Ubuntu 10.10/md64 JDK 1.6u23 x64&lt;br/&gt;
</environment>
        <key id="12497467">WICKET-3413</key>
            <summary>FLAG_INHERITABLE_MODEL and default model change</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="amorozov">Alexander Morozov</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Feb 2011 14:37:18 +0000</created>
                <updated>Sun, 13 Feb 2011 12:11:48 +0000</updated>
                            <resolved>Sun, 13 Feb 2011 11:03:51 +0000</resolved>
                                    <version>1.4.15</version>
                                    <fixVersion>1.4.16</fixVersion>
                    <fixVersion>1.5-RC2</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12994071" author="mgrigorov" created="Sun, 13 Feb 2011 11:03:51 +0000"  >&lt;p&gt;Improved with r1070211 (1.4.x) and r1070210 (trunk).&lt;/p&gt;</comment>
                            <comment id="12994079" author="hudson" created="Sun, 13 Feb 2011 12:11:48 +0000"  >&lt;p&gt;Integrated in Apache Wicket 1.4.x #436 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Apache%20Wicket%201.4.x/436/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Apache%20Wicket%201.4.x/436/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3413&quot; title=&quot;FLAG_INHERITABLE_MODEL and default model change&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3413&quot;&gt;&lt;del&gt;WICKET-3413&lt;/del&gt;&lt;/a&gt; FLAG_INHERITABLE_MODEL and default model change&lt;/p&gt;

&lt;p&gt;reset &apos;inherited model&apos; flag if model changed and a new one is not IComponentInheritedModel&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12470593" name="fix-WICKET-3413.patch" size="956" author="amorozov" created="Tue, 8 Feb 2011 14:01:55 +0000"/>
                            <attachment id="12470592" name="test-WICKET-3413.patch" size="1542" author="amorozov" created="Tue, 8 Feb 2011 14:01:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204206</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kb1z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116608</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>