<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:20:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4443] AbstractClassResolver recreates URL incorrectly</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4443</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;AbstractClassResolver converts java.net.URLs to their external form (java.lang.String), then converts them back to java.net.URLs. It looks like the conversion to external form is for comparison between URLs (comparing URLs is slow, Strings not so - see &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3867&quot; title=&quot;URIs should be used instead of URLs as Set or Map keys.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3867&quot;&gt;&lt;del&gt;WICKET-3867&lt;/del&gt;&lt;/a&gt;), because we only want one result per URL (Set&amp;lt;URL&amp;gt;).&lt;/p&gt;

&lt;p&gt;The problem is that, when converting from the external form back to a java.net.URL, the no context URL is given to the URL constructor, just the external form String is given. Passing a context URL to the java.net.URL constructor is the only way of setting the URLStreamHandler related to the URL. So, if you have some exotic URL schema, like I do, using protocols the standard Java libraries dont know about, you can no longer load your resources.&lt;/p&gt;

&lt;p&gt;Please see the code in CompoundClassResolver#getResources() - it implements a unique list of URL by comparing the external forms of the URLs, while still managing to use the original URL objects, with their URLStreamHandlers attached.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12545581">WICKET-4443</key>
            <summary>AbstractClassResolver recreates URL incorrectly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="jesselong">Jesse Long</reporter>
                        <labels>
                            <label>classloader</label>
                    </labels>
                <created>Thu, 8 Mar 2012 00:29:50 +0000</created>
                <updated>Mon, 12 Mar 2012 13:55:19 +0000</updated>
                            <resolved>Mon, 12 Mar 2012 13:55:03 +0000</resolved>
                                    <version>1.5.4</version>
                                    <fixVersion>1.5.6</fixVersion>
                    <fixVersion>6.0.0-beta1</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13224923" author="jesselong" created="Thu, 8 Mar 2012 01:39:11 +0000"  >&lt;p&gt;Patch that changes various parts, mainly IClassResolvers to use a TreeSet with a Comparator that compares URLs&apos; toExternalForm when a Set&amp;lt;URL&amp;gt; is needed.&lt;/p&gt;

&lt;p&gt;Also, add some docs about possible MalformedURLException in UrlResourceStreamReference (related to this bug)&lt;/p&gt;</comment>
                            <comment id="13225199" author="mgrigorov" created="Thu, 8 Mar 2012 13:34:58 +0000"  >&lt;p&gt;Thanks for the patch!&lt;/p&gt;

&lt;p&gt;I added a note to UrlResourceStreamReference&apos;s javadoc explaining how to deal with custom URL schemes. Unfortunately there is no getter method in j.n.URL to get its handler and reuse it later ...&lt;/p&gt;</comment>
                            <comment id="13225907" author="jesselong" created="Fri, 9 Mar 2012 07:19:35 +0000"  >&lt;p&gt;UrlResourceStreamReference caches the URL as a string. Is there any reason for this? If we just keep a reference to the URL object, it may suffice.&lt;/p&gt;

&lt;p&gt;My first thought was that it caches the URL as a string in external form because it needs to be serialized, but UrlResourceStreamReference does not implement &lt;/p&gt;
{Serializable, IClusterable}
&lt;p&gt; and neither does its parent - AbstractResourceStreamReference, and neither does the interface require serialization - IResourceStreamReference. Could we not just let UrlResourceStreamReference keep a reference to the original URL?&lt;/p&gt;</comment>
                            <comment id="13226866" author="mgrigorov" created="Sat, 10 Mar 2012 14:26:29 +0000"  >&lt;p&gt;I&apos;ll investigate this option next week.&lt;/p&gt;</comment>
                            <comment id="13227005" author="jesselong" created="Sun, 11 Mar 2012 07:10:31 +0000"  >&lt;p&gt;I looked around. UrlResourceStreamReference is package private to the org.apache.wicket.util.resource.locator.caching package. It is used ONLY by the CachingResourceStreamLocator class, which converts UrlResourceStream instances to UrlResourceStreamReference instances, and stores them in a java.util.Map.&lt;/p&gt;

&lt;p&gt;This map acts as a cache of the result of locating resources, including not-found entries. The idea behind the cache it to avoid having to FIND resources every time they are required, but just use the caches find result from the map.&lt;/p&gt;

&lt;p&gt;The map is never serialized, as CachingResourceStreamLocator is not Serializable and neither is IResourceStreamLocator, which it implements.&lt;/p&gt;

&lt;p&gt;IResourceStreamLocator is mainly used from: Application.get().getResourceSettings().getResourceStreamLocator().&lt;/p&gt;

&lt;p&gt;I vote we just keep a reference to the original URL.&lt;/p&gt;

&lt;p&gt;Pro: we can load arbitrary URLs, from any url scheme, using its configured URLStreamHandler.&lt;/p&gt;

&lt;p&gt;Con: the URL object probably uses slightly more memory that the external form string.&lt;/p&gt;</comment>
                            <comment id="13227530" author="mgrigorov" created="Mon, 12 Mar 2012 13:55:19 +0000"  >&lt;p&gt;The suggestion is committed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12517510" name="WICKET-4443.patch" size="8276" author="jesselong" created="Thu, 8 Mar 2012 01:39:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>230767</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00vqf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3073</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>