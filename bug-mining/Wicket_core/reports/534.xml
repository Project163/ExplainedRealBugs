<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:19:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4425] Wicket 1.5 rewrites template content where it should not</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4425</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;I have recently upgraded from Wicket 1.4.14 to 1.5.4. One issue that I&lt;br/&gt;
encountered is that &amp;lt;script&amp;gt; tags in panel templates are rewritten by&lt;br/&gt;
Wicket, even when the &amp;lt;script&amp;gt; tags in question have no wicket handlers&lt;br/&gt;
attached to them. I.e. the following panel template (notice that there&lt;br/&gt;
are no wicket:id attributes whatsoever):&lt;/p&gt;

&lt;p&gt;&amp;lt;wicket:panel&amp;gt;&lt;br/&gt;
    &amp;lt;script id=&quot;template-upload&quot; type=&quot;text/x-jquery-tmpl&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;span&amp;gt;${name}&amp;lt;/span&amp;gt;&lt;br/&gt;
    &amp;lt;/script&amp;gt;&lt;br/&gt;
&amp;lt;/wicket:panel&amp;gt;&lt;/p&gt;

&lt;p&gt;Would render in the panel as:&lt;/p&gt;

&lt;p&gt;&amp;lt;script id=&quot;template-upload&quot; type=&quot;text/x-jquery-tmpl&quot;&amp;gt;&lt;br/&gt;
/&lt;b&gt;&amp;lt;![CDATA[&lt;/b&gt;/&lt;br/&gt;
    &amp;lt;span&amp;gt;${name}&amp;lt;/span&amp;gt;&lt;br/&gt;
/&lt;b&gt;]]&amp;gt;&lt;/b&gt;/&lt;br/&gt;
&amp;lt;/script&amp;gt;&lt;/p&gt;

&lt;p&gt;Imho this is unwanted behavior that is a regression from the behavior in&lt;br/&gt;
Wicket 1.4.x (or at least 1.4.14). Wicket should not add content to the&lt;br/&gt;
body of the script tags (or any other tags in a template, unless their&lt;br/&gt;
content is provided programmatically), as it does not have the knowledge&lt;br/&gt;
how that affects the functionality of the page. Moreover, the content&lt;br/&gt;
that Wicket adds to these script tags is only correct for Javascript&lt;br/&gt;
(hence incorrect for the scripts in the example as they are not&lt;br/&gt;
javascript). In the above example adding /*, */&lt;br/&gt;
will change the functionality of the script tag. If the &quot;/&lt;b&gt;&amp;lt;![CDATA[&lt;/b&gt;/&quot;&lt;br/&gt;
part was necessary in the script tags above, they should be added by the&lt;br/&gt;
person that provides the template, not magically added by Wicket.&lt;/p&gt;

&lt;p&gt;I have attached a quickstart that demonstrates the issue. The quickstart has a &amp;lt;script id=&quot;script1&quot;&amp;gt;Some Text&amp;lt;/script&amp;gt; element in HomePage.html that (by javascript) is shown in an alert box. Because of this bug, the alert will now start with &quot;/&lt;b&gt;&amp;lt;![CDATA[&lt;/b&gt;/&quot;, while it should simply show the text. See HomePage.html in the provided quickstart.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12543490">WICKET-4425</key>
            <summary>Wicket 1.5 rewrites template content where it should not</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="pointbreak">Pointbreak</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Feb 2012 13:53:49 +0000</created>
                <updated>Wed, 22 Feb 2012 09:32:12 +0000</updated>
                            <resolved>Wed, 22 Feb 2012 09:32:12 +0000</resolved>
                                    <version>1.5.4</version>
                                    <fixVersion>1.5.5</fixVersion>
                    <fixVersion>6.0.0-beta1</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13212595" author="pointbreak" created="Tue, 21 Feb 2012 13:54:52 +0000"  >&lt;p&gt;quickstart that demonstrates the issue&lt;/p&gt;</comment>
                            <comment id="13212643" author="mgrigorov" created="Tue, 21 Feb 2012 15:17:37 +0000"  >&lt;p&gt;Here is a patch that wraps the content of &amp;lt;script&amp;gt; element only if its type is a plain javascript.&lt;/p&gt;</comment>
                            <comment id="13212667" author="pointbreak" created="Tue, 21 Feb 2012 15:41:40 +0000"  >&lt;p&gt;Martin, although your patch would probably solve my issue in this particular case, I don&apos;t think it is the correct approach. Imho the content of the &amp;lt;script&amp;gt; tags in this quickstart should not be altered by wicket in any way, even when they contain javascript. Wicket should not try to &quot;correct&quot; what it deems incorrect html in a template. The programmer that provides the template is responsible for that. It would be different if the script elements were attached to a wicket Component (i.e. had a wicket:id) and/or their content was programmatically added to them. But template code should be rendered as-is where not attached to wicket Components. That wicket alters content of html-elements that are not attached to Components a regression from pre 1.5 versions. I don&apos;t really understand why wicket would want to do that.&lt;/p&gt;</comment>
                            <comment id="13212671" author="mgrigorov" created="Tue, 21 Feb 2012 15:45:57 +0000"  >&lt;p&gt;I guess you didn&apos;t notice that I linked this ticket to the one that introduced this change. Check it and you&apos;ll see that we need to &quot;help&quot; in some cases.&lt;/p&gt;</comment>
                            <comment id="13212702" author="pointbreak" created="Tue, 21 Feb 2012 16:21:00 +0000"  >&lt;p&gt;Well actually I did see that, but am still confused. My point is that if there is a verbatim &amp;lt;script&amp;gt; tag in the template and its code needs to be wrapped inside &quot;/&lt;b&gt;&amp;lt;![CDATA[&lt;/b&gt;/&quot;, this should be done by the programmer that writes the &amp;lt;script&amp;gt; tag. NOT as an afterthought by wicket. I don&apos;t see why wicket should help here. (And Wicket did not do that in older versions).&lt;/p&gt;

&lt;p&gt;This also applies to the issue you linked. The SCRIPT tag in that issue should itself contain the wrapping /&lt;b&gt;&amp;lt;![CDATA&lt;span class=&quot;error&quot;&gt;&amp;#91;*/ ... /*&amp;#93;&lt;/span&gt;]&amp;gt;&lt;/b&gt;/ stuff. Not providing that is an error in the template, since the template can&apos;t be parsed by an XML/XHTML parser. Of course Wicket should be smart enough that if such a CDATA wrapper code is available inside contributions in the &amp;lt;wicket:head&amp;gt; section that it doesn&apos;t skip that in the context of e.g. ajax requests. But providing that wrapping code is part of the job of the template writer. I.e. I would argue that the the following template code is faulty, and to fix that is the responsibility of the template programmer:&lt;/p&gt;

&lt;p&gt;&amp;lt;wicket:head&amp;gt;&lt;br/&gt;
&amp;lt;script&amp;gt;&lt;br/&gt;
if (someVariable &amp;lt; 0) {&lt;br/&gt;
someVariable = 0;&lt;br/&gt;
}&lt;br/&gt;
&amp;lt;/script&amp;gt;&lt;br/&gt;
&amp;lt;/wicket:head&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13212796" author="mgrigorov" created="Tue, 21 Feb 2012 18:45:57 +0000"  >&lt;p&gt;The developer should not be aware of the fact that Wicket uses XML to deliver the HTML response in Ajax response. This CDATA is there exactly for this reason - to allow DOMParser (JS) to create a proper JS Document no matter what is the actual content.&lt;/p&gt;

&lt;p&gt;Additionally &amp;lt;div/&amp;gt; is a valid by HTML specs but some browsers don&apos;t behave well with with. And Wicket tries to help in this situation as well, by expanding it to &amp;lt;div&amp;gt;&amp;lt;/div&amp;gt;.&lt;/p&gt;

&lt;p&gt;I&apos;ll commit this patch soon if there are no technical problems with it.&lt;/p&gt;</comment>
                            <comment id="13212870" author="pointbreak" created="Tue, 21 Feb 2012 20:12:34 +0000"  >&lt;p&gt;You are right in that he/she should not need to be aware of details of how wicket TRANSPORTS. He/she should be aware how wicket PARSES templates though. Thus, that &amp;gt; and &amp;lt; have special meaning in XML/XHTML templates, and will trigger a parsing error unless used or escaped correctly. Why would the template parser not simply throw an error on templates that can&apos;t be parsed as valid XML or XHTML? Unbalanced tags in templates also result in parse errors from wicket (even when they are valid in HTML and accepted by browsers). Your &amp;lt;div/&amp;gt; vs. &amp;lt;div&amp;gt;&amp;lt;/div&amp;gt; example has nothing to do with this, as for either choice the template will be valid/parsable by any XML parser. A script tag that contains special characters is not. I don&apos;t understand why you would want a parser that accepts and and tries to fix incorrect use of special characters in scripts tags in template files. Additionally it does a pretty bad job at that. E.g. try this in a template for an actual error message from the template parser; just a variation of the same thing though:&lt;/p&gt;

&lt;p&gt;&amp;lt;script&amp;gt;&lt;br/&gt;
alert(&quot;&amp;lt;/script&amp;gt;&quot;);&lt;br/&gt;
&amp;lt;/script&amp;gt;&lt;/p&gt;

&lt;p&gt;But I fail in getting my message across, so eh.. go ahead, I am happy with your patch either way. Yet convinced that there is a flawed design decision in the (new) wicket template processing logic, that your patch not fixes but works around only for this specific case.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12497607">WICKET-3420</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12515361" name="WICKET-4425.patch" size="1471" author="mgrigorov" created="Tue, 21 Feb 2012 15:17:36 +0000"/>
                            <attachment id="12515357" name="myproject.zip" size="26537" author="pointbreak" created="Tue, 21 Feb 2012 13:54:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>228736</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 39 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00vrr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3079</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>