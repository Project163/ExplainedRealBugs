<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:19:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4014] Wicket 1.5 Form Post Action and Link Get discard Page Class Information</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4014</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Page expiry is a very annoying and perplexing event especially if users stay logged in via remember-me cookie.&lt;/p&gt;

&lt;p&gt;It is therefore not a fancy enhancement but an essential business requirement to not drop the user out of context after session expiry.&lt;br/&gt;
Only stateless pages can fully achieve this, but it is not always desirable to go fully stateless, especially while a recovery solution already exists.&lt;br/&gt;
In 1.4, this appears to be automatic with BookmarkablePageRequestTargetUrlCodingStrategy - without any additional coding.&lt;/p&gt;

&lt;p&gt;The solution is well known - keep as much state in the client as required to recover the page class, and possibly even its page parameters, and to not destroy this information.&lt;/p&gt;

&lt;p&gt;The two attached testcases show two possible methods of page fallback recovery (one with AJAX, one without) that already work behind the scenes.&lt;br/&gt;
Of course it is easy with AJAX, to just force a page reload, but this is not discussed here. AJAX just serves to demonstrate how easy the principle actually is.&lt;br/&gt;
In most cases the user could successfully reload the page but Wicket 1.5 can&apos;t create a response because it has forgotten the class of the expired page.&lt;/p&gt;

&lt;p&gt;In 1.4, it is possible to recover the class of an expired page via its mount path.&lt;br/&gt;
This feature is lost in 1.5.&lt;/p&gt;

&lt;p&gt;To get this functionality back in a more streamlined fashion, I am additionaly proposing in a separate jira issue 4013 to store page class and page parameters in PageExpiredException.&lt;/p&gt;

&lt;p&gt;Meanwhile, the focus of this issue is to request whatever means to not overwrite the path of a page in a form post action or get request, and to get the page class back as in 1.4 by whatever means.&lt;/p&gt;

&lt;p&gt;The two attached testcases may be helpful for expermintation. The 1.4 tescase demonstrates how the scheme works, unfortunately I could not fill the blanks in the 1.5 testcase.&lt;/p&gt;

&lt;p&gt;In 1.4,&lt;/p&gt;

&lt;p&gt;a form tag is rendered as:&lt;br/&gt;
&amp;lt;form wicket:id=&quot;form&quot; action=&quot;?wicket:interface=:0:form::IFormSubmitListener::&quot;&lt;br/&gt;
This is requested as:&lt;br/&gt;
/testForm.0?wicket:interface=:0:form::IFormSubmitListener::&lt;br/&gt;
and the page class can be recovered from the mount path &quot;testForm&quot; as in&lt;br/&gt;
    mount(new HybridUrlCodingStrategy(&quot;testForm&quot;, TestPageForm.class));&lt;/p&gt;

&lt;p&gt;an anchor tag is rendered as:&lt;br/&gt;
&amp;lt;a href=&quot;?wicket:interface=:0:linkSwitch::ILinkListener::&quot;&lt;br/&gt;
This is requested as:&lt;br/&gt;
/testLink.0?wicket:interface=:0:linkSwitch::ILinkListener::&lt;br/&gt;
and the page class can be recovered from the mount path &quot;test&quot; as in&lt;br/&gt;
    mount(new HybridUrlCodingStrategy(&quot;testLink&quot;, TestPageLink.class));&lt;/p&gt;



&lt;p&gt;In 1.5,&lt;/p&gt;

&lt;p&gt;a form tag is rendered as:&lt;br/&gt;
&amp;lt;form wicket:id=&quot;form&quot; action=&quot;wicket/page?0-2.IFormSubmitListener-form&quot;&lt;br/&gt;
This is requested requested as:&lt;br/&gt;
/wicket/page?0-1.IFormSubmitListener-form&lt;/p&gt;

&lt;p&gt;This overwrites the mount path &quot;testForm&quot; as in&lt;br/&gt;
    mountPage(&quot;testForm&quot;, TestPageForm.class);&lt;br/&gt;
Consequently the server cannot discover the page class&lt;/p&gt;


&lt;p&gt;an anchor tag is rendered as:&lt;br/&gt;
&amp;lt;a href=&quot;wicket/page?0-1.ILinkListener-linkSwitch&quot;&lt;br/&gt;
This is requested requested as:&lt;br/&gt;
/wicket/page?0-1.ILinkListener-linkSwitch&lt;/p&gt;

&lt;p&gt;This overwrites the mount path &quot;testLink&quot; as in&lt;br/&gt;
    mountPage(&quot;testLink&quot;, TestPageLink.class);&lt;br/&gt;
Consequently the server cannot discover the page class&lt;/p&gt;</description>
                <environment>Wicket version: 1.5-RC7&lt;br/&gt;
java version &amp;quot;1.6.0_25&amp;quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_25-b06)&lt;br/&gt;
Java HotSpot(TM) Client VM (build 20.0-b11, mixed mode, sharing)&lt;br/&gt;
Server: GlassFish 3.1.1</environment>
        <key id="12520994">WICKET-4014</key>
            <summary>Wicket 1.5 Form Post Action and Link Get discard Page Class Information</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="bht@actrix.gen.nz">bernard</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Sep 2011 00:04:56 +0000</created>
                <updated>Thu, 24 Jan 2013 20:02:20 +0000</updated>
                            <resolved>Wed, 7 Sep 2011 14:28:19 +0000</resolved>
                                    <version>1.5-RC7</version>
                                    <fixVersion>1.5.1</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                                                            <comments>
                            <comment id="13095010" author="bht@actrix.gen.nz" created="Thu, 1 Sep 2011 00:06:13 +0000"  >&lt;p&gt;Testcases&lt;/p&gt;</comment>
                            <comment id="13099264" author="bht@actrix.gen.nz" created="Wed, 7 Sep 2011 19:57:09 +0000"  >&lt;p&gt;Thanks very much for fixing this. How I can test? Are there any snapshot builds that I can download?&lt;/p&gt;</comment>
                            <comment id="13099265" author="mgrigorov" created="Wed, 7 Sep 2011 19:59:58 +0000"  >&lt;p&gt;Either SVN checkout and build Wicket locally or use 1.5-SNAPSHOT from &lt;a href=&quot;http://wicket.apache.org/start/quickstart.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wicket.apache.org/start/quickstart.html&lt;/a&gt;.&lt;br/&gt;
The latter relies on Apache Jenkins servers which is not the most stable CI service.&lt;/p&gt;</comment>
                            <comment id="13099656" author="bht@actrix.gen.nz" created="Wed, 7 Sep 2011 23:26:48 +0000"  >&lt;p&gt;Thanks. I am impressed. It looks like this is a major improvement compared with 1.4 - we don&apos;t have to catch PageExpiredException anymore &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13100137" author="mgrigorov" created="Thu, 8 Sep 2011 07:51:24 +0000"  >&lt;p&gt;PageExpiredException still can be thrown if the page is not mounted. In this case the link contains only the page id and there is no information which page class to use to create a new instance.&lt;/p&gt;

&lt;p&gt;But I think it was the same in 1.4 with the hybrid url coding strategies.&lt;/p&gt;</comment>
                            <comment id="13100150" author="bht@actrix.gen.nz" created="Thu, 8 Sep 2011 08:20:57 +0000"  >&lt;p&gt;I think we will see a substantial improvement in 1.5 compared with 1.4 because the hybrid strategies DO expire in 1.4. Now we can confidently say that mounting pages will avoid PageExpiredException. But wait, what happens to the PageParameters of the mounted page? Will they be used to reconstruct the page even if the request has POST parameters for the new target? Theoretically, it should be possible because 1.5 distinguishes between GET and POST parameters. Unfortunately I did not supply a testcase for PageParameters.&lt;/p&gt;</comment>
                            <comment id="13100165" author="mgrigorov" created="Thu, 8 Sep 2011 09:01:15 +0000"  >&lt;p&gt;The newly created page will use the parameters which have been send to the expired page.&lt;br/&gt;
Please test it harder and let us know if there are any issues. Thanks!&lt;/p&gt;</comment>
                            <comment id="13100256" author="bht@actrix.gen.nz" created="Thu, 8 Sep 2011 12:18:01 +0000"  >&lt;p&gt;I could verify that recovery works with parameters. This is more than what I could achieve with 1.4. You asked me to test harder. I can break it with the attached testcase where the GET parameter has the same name as the form field. I don&apos;t know whether this is out of scope.&lt;/p&gt;</comment>
                            <comment id="13100259" author="mgrigorov" created="Thu, 8 Sep 2011 12:20:49 +0000"  >&lt;p&gt;Please create a separate ticket (may be a sub-task of this) and explain the problem there.&lt;br/&gt;
Thanks !&lt;/p&gt;</comment>
                            <comment id="13170240" author="thomas.goetz" created="Thu, 15 Dec 2011 14:23:27 +0000"  >&lt;p&gt;The only disadvantage to the solution is IMHO:&lt;br/&gt;
when you have a mounted page with a state (e.g. some ajax components on the page) and the page expires then you now have no chance of informing the user about the session expiry. Instead a fresh page (with a reset/fresh state) is created which can result in a suboptimal user experience (as already discussed today in IRC with martin-g and carl-eric). I&apos;d suggest to make that behavior configurable, should I open a new ticket for that?&lt;/p&gt;</comment>
                            <comment id="13561918" author="bht@actrix.gen.nz" created="Thu, 24 Jan 2013 20:02:20 +0000"  >&lt;p&gt;This issue is not fixed yet. In the the 1.4 test case, WebRequestCycleProcessor succeeds in re-instantiating a page from a form post request. In Wicket 6.5, the form post URL does not include any page information for a mounted page. It does not work although IPageSettings#getRecreateMountedPagesAfterExpiry() == true&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12526359">WICKET-4116</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12493576" name="ExpiryFallbackParametersQuickStart1.5.zip" size="16129" author="bht@actrix.gen.nz" created="Thu, 8 Sep 2011 12:18:01 +0000"/>
                            <attachment id="12492548" name="ExpiryFallbackQuickStart1.4.zip" size="11278" author="bht@actrix.gen.nz" created="Thu, 1 Sep 2011 00:06:13 +0000"/>
                            <attachment id="12492549" name="ExpiryFallbackQuickStart1.5.zip" size="11743" author="bht@actrix.gen.nz" created="Thu, 1 Sep 2011 00:06:13 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12522249">WICKET-4036</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>50926</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 43 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0k9hz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116356</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>