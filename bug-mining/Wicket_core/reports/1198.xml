<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:24:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-5960] Page header isn&apos;t rendered for pages where URL has changed during render</title>
                <link>https://issues.apache.org/jira/browse/WICKET-5960</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Due to the changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5309&quot; title=&quot;No page id appended to some stateful pages using repeaters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5309&quot;&gt;&lt;del&gt;WICKET-5309&lt;/del&gt;&lt;/a&gt;, a page is re-rendered when any of the URL segments is modified during the request:&lt;/p&gt;

&lt;p&gt;From WebPageRenderer.java:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	&lt;span class=&quot;code-comment&quot;&gt;// the url might have changed after page has been rendered (e.g. the
&lt;/span&gt;	&lt;span class=&quot;code-comment&quot;&gt;// stateless flag might have changed because stateful components
&lt;/span&gt;	&lt;span class=&quot;code-comment&quot;&gt;// were added)
&lt;/span&gt;	&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Url afterRenderUrl = requestCycle
		.mapUrlFor(getRenderPageRequestHandler());

	&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (beforeRenderUrl.getSegments().equals(afterRenderUrl.getSegments()) == &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
	{
		&lt;span class=&quot;code-comment&quot;&gt;// the amount of segments is different - generated relative URLs
&lt;/span&gt;		&lt;span class=&quot;code-comment&quot;&gt;// will not work, we need to rerender the page. This can happen
&lt;/span&gt;		&lt;span class=&quot;code-comment&quot;&gt;// with IRequestHandlers that produce different URLs with
&lt;/span&gt;		&lt;span class=&quot;code-comment&quot;&gt;// different amount of segments &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; stateless and stateful pages
&lt;/span&gt;		response = renderPage(afterRenderUrl, requestCycle);
	}

	&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (currentUrl.equals(afterRenderUrl))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The re-render causes the &amp;lt;head&amp;gt; section to be empty because it was already rendered in the first try.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12851098">WICKET-5960</key>
            <summary>Page header isn&apos;t rendered for pages where URL has changed during render</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="svenmeier">Sven Meier</assignee>
                                    <reporter username="dashorst">Martijn Dashorst</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Aug 2015 13:37:01 +0000</created>
                <updated>Sat, 15 Aug 2015 14:37:09 +0000</updated>
                            <resolved>Mon, 10 Aug 2015 12:56:07 +0000</resolved>
                                    <version>7.0.0</version>
                                    <fixVersion>6.21.0</fixVersion>
                    <fixVersion>7.1.0</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14651916" author="jira-bot" created="Mon, 3 Aug 2015 14:30:10 +0000"  >&lt;p&gt;Commit 541a81d127deabf2c355985dfbfdde38f76389ec in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dashorst&quot; class=&quot;user-hover&quot; rel=&quot;dashorst&quot;&gt;dashorst&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=541a81d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=541a81d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5960&quot; title=&quot;Page header isn&amp;#39;t rendered for pages where URL has changed during render&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5960&quot;&gt;&lt;del&gt;WICKET-5960&lt;/del&gt;&lt;/a&gt; Page header isn&apos;t renderen for pages where URL has changed during render&lt;/p&gt;

&lt;p&gt;This adds a disabled test case for the linked issue.&lt;/p&gt;</comment>
                            <comment id="14651958" author="svenmeier" created="Mon, 3 Aug 2015 15:03:22 +0000"  >&lt;p&gt;Problem is that HtmlHeaderContainer#headerResponse is kept until detach is called - i.e. during seconds rendering when Component#internalRenderHead() calls response#wasRendered(this), the component&apos;s header is already marked as rendered :/.&lt;/p&gt;</comment>
                            <comment id="14653546" author="mgrigorov" created="Tue, 4 Aug 2015 12:27:23 +0000"  >&lt;p&gt;Should we detach the page before re-rendering it?&lt;/p&gt;</comment>
                            <comment id="14653765" author="svenmeier" created="Tue, 4 Aug 2015 14:58:07 +0000"  >&lt;p&gt;If we detach the page, we will lose all feedback messages &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14653963" author="svenmeier" created="Tue, 4 Aug 2015 16:55:16 +0000"  >&lt;p&gt;We could drop HtmlHeaderContainer&apos;s headerResponse after rendering:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	@Override
	&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void onAfterRender() {
		&lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.onAfterRender();
		
		headerResponse = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
	}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The test works fine after this change.&lt;/p&gt;</comment>
                            <comment id="14654212" author="jira-bot" created="Tue, 4 Aug 2015 19:29:21 +0000"  >&lt;p&gt;Commit 03663750c3da6703ab56751ce17e9aaa273d3a07 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=0366375&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=0366375&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5960&quot; title=&quot;Page header isn&amp;#39;t rendered for pages where URL has changed during render&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5960&quot;&gt;&lt;del&gt;WICKET-5960&lt;/del&gt;&lt;/a&gt; drop headerResponse and renderedComponentsPerScope in #onAfterRender(), so a second rendering re-renders the header&lt;/p&gt;</comment>
                            <comment id="14654214" author="svenmeier" created="Tue, 4 Aug 2015 19:30:11 +0000"  >&lt;p&gt;moving the code in #onDetach() to #onAfterRender() seems to fix the issue, I didn&apos;t notice any negative side effect&lt;/p&gt;</comment>
                            <comment id="14654236" author="mgrigorov" created="Tue, 4 Aug 2015 19:44:28 +0000"  >&lt;p&gt;Yes. I also thought about similar solution. Some other components (like IPageables) clear their cache in onBeforeRender().&lt;br/&gt;
I think onConfigure/onBeforeRender should be a bit better if an error happens during rendering and onAfterRender is not called. Then if the application tries to re-render (also Wicket does this with org.apache.wicket.request.cycle.RequestCycle#getExceptionRetryCount) the page the cache will be still there.&lt;/p&gt;</comment>
                            <comment id="14655125" author="jira-bot" created="Wed, 5 Aug 2015 10:07:53 +0000"  >&lt;p&gt;Commit 4601ff3a7a3cfec6db3f54d913050faf03a5536b in wicket&apos;s branch refs/heads/wicket-6.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dashorst&quot; class=&quot;user-hover&quot; rel=&quot;dashorst&quot;&gt;dashorst&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=4601ff3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=4601ff3&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5960&quot; title=&quot;Page header isn&amp;#39;t rendered for pages where URL has changed during render&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5960&quot;&gt;&lt;del&gt;WICKET-5960&lt;/del&gt;&lt;/a&gt; Page header isn&apos;t renderen for pages where URL has changed during render&lt;/p&gt;

&lt;p&gt;This adds a disabled test case for the linked issue.&lt;/p&gt;</comment>
                            <comment id="14655126" author="jira-bot" created="Wed, 5 Aug 2015 10:07:54 +0000"  >&lt;p&gt;Commit c34f2f9dd2838d075968280b042b8826e325f012 in wicket&apos;s branch refs/heads/wicket-6.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=c34f2f9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=c34f2f9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5960&quot; title=&quot;Page header isn&amp;#39;t rendered for pages where URL has changed during render&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5960&quot;&gt;&lt;del&gt;WICKET-5960&lt;/del&gt;&lt;/a&gt; drop headerResponse and renderedComponentsPerScope in #onAfterRender(), so a second rendering re-renders the header&lt;/p&gt;</comment>
                            <comment id="14655242" author="svenmeier" created="Wed, 5 Aug 2015 11:54:45 +0000"  >&lt;p&gt;#afterRender() and thus #onAfterRender() are called from a finally block in component, so I think this cleanup is pretty safe.&lt;/p&gt;</comment>
                            <comment id="14679996" author="mgrigorov" created="Mon, 10 Aug 2015 11:56:12 +0000"  >&lt;p&gt;Anything else to be done here?&lt;/p&gt;</comment>
                            <comment id="14679997" author="svenmeier" created="Mon, 10 Aug 2015 11:58:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dashorst&quot; class=&quot;user-hover&quot; rel=&quot;dashorst&quot;&gt;dashorst&lt;/a&gt; Martijn, are you satisfied with the solution?&lt;/p&gt;</comment>
                            <comment id="14680052" author="dashorst" created="Mon, 10 Aug 2015 12:52:38 +0000"  >&lt;p&gt;If it fixes the testcase I&apos;m content!&lt;/p&gt;</comment>
                            <comment id="14680059" author="svenmeier" created="Mon, 10 Aug 2015 12:56:07 +0000"  >&lt;p&gt;Thanks for the test!&lt;/p&gt;</comment>
                            <comment id="14693547" author="dashorst" created="Wed, 12 Aug 2015 14:16:44 +0000"  >&lt;p&gt;It appears that this fix doesn&apos;t solve all our problems. While the test case is fixed, we encounter reproducible empty &amp;lt;head&amp;gt; sections. &lt;/p&gt;

&lt;p&gt;From what I gather it is mostly to do with &apos;back&apos; navigations where we tell wicket to rerender a previous page from the page store (setResponsePage(....getPage(pageId)));. However I&apos;m investigating if this is the cause, or something else is in play.&lt;/p&gt;</comment>
                            <comment id="14693598" author="svenmeier" created="Wed, 12 Aug 2015 14:37:45 +0000"  >&lt;p&gt;Perhaps a case where #onAfterRender() is not called, as Martin has guessed?&lt;/p&gt;</comment>
                            <comment id="14694992" author="dashorst" created="Thu, 13 Aug 2015 09:57:49 +0000"  >&lt;p&gt;Apparently this is caused by line 475 from PartialPageUpdate.java:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void writeHeaderContribution(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Response response, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Component component)
	{
		headerRendering = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;

		&lt;span class=&quot;code-comment&quot;&gt;// create the htmlheadercontainer &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; needed
&lt;/span&gt;		&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (header == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
		{
			header = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PartialHtmlHeaderContainer(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
			&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Page parentPage = component.getPage();
			parentPage.addOrReplace(header);
		}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the offending line is &quot;parentPage.addOrReplace(header);&quot;&lt;/p&gt;</comment>
                            <comment id="14695010" author="svenmeier" created="Thu, 13 Aug 2015 10:07:36 +0000"  >&lt;p&gt;Any idea how to reproduce this?&lt;/p&gt;</comment>
                            <comment id="14695188" author="dashorst" created="Thu, 13 Aug 2015 13:06:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/dashorst/wicket-5960&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/dashorst/wicket-5960&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Scenario:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;have ajax update render a component&lt;/li&gt;
	&lt;li&gt;click on normal submit&lt;/li&gt;
	&lt;li&gt;see background go from gray to white&lt;br/&gt;
(and header be empty)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14695304" author="dashorst" created="Thu, 13 Aug 2015 14:31:24 +0000"  >&lt;p&gt;It appears that HtmlHeaderResponse&apos;s onAfterRender is not called when rendering an AJAX response.&lt;/p&gt;</comment>
                            <comment id="14695315" author="dashorst" created="Thu, 13 Aug 2015 14:44:51 +0000"  >&lt;p&gt;Fixing the HtmlHeaderResponse such that also an onDetach is present to clear out the temporary state, it solves this issue.&lt;/p&gt;</comment>
                            <comment id="14695348" author="jira-bot" created="Thu, 13 Aug 2015 15:19:35 +0000"  >&lt;p&gt;Commit 8fbe6c7d5810debbab10395893a31aea7423aaad in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dashorst&quot; class=&quot;user-hover&quot; rel=&quot;dashorst&quot;&gt;dashorst&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=8fbe6c7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=8fbe6c7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Re-introduced onDetach to fix &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5960&quot; title=&quot;Page header isn&amp;#39;t rendered for pages where URL has changed during render&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5960&quot;&gt;&lt;del&gt;WICKET-5960&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This might be a temporary fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5960&quot; title=&quot;Page header isn&amp;#39;t rendered for pages where URL has changed during render&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5960&quot;&gt;&lt;del&gt;WICKET-5960&lt;/del&gt;&lt;/a&gt;, because it is odd that&lt;br/&gt;
HtmlHeaderContainer.onAfterRender is not called during an AJAX render.&lt;/p&gt;

&lt;p&gt;Adding onDetach fixes the bug introduced by renaming it to onAfterRender.&lt;/p&gt;</comment>
                            <comment id="14695349" author="jira-bot" created="Thu, 13 Aug 2015 15:19:36 +0000"  >&lt;p&gt;Commit 8fbe6c7d5810debbab10395893a31aea7423aaad in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dashorst&quot; class=&quot;user-hover&quot; rel=&quot;dashorst&quot;&gt;dashorst&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=8fbe6c7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=8fbe6c7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Re-introduced onDetach to fix &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5960&quot; title=&quot;Page header isn&amp;#39;t rendered for pages where URL has changed during render&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5960&quot;&gt;&lt;del&gt;WICKET-5960&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This might be a temporary fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5960&quot; title=&quot;Page header isn&amp;#39;t rendered for pages where URL has changed during render&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5960&quot;&gt;&lt;del&gt;WICKET-5960&lt;/del&gt;&lt;/a&gt;, because it is odd that&lt;br/&gt;
HtmlHeaderContainer.onAfterRender is not called during an AJAX render.&lt;/p&gt;

&lt;p&gt;Adding onDetach fixes the bug introduced by renaming it to onAfterRender.&lt;/p&gt;</comment>
                            <comment id="14695934" author="svenmeier" created="Thu, 13 Aug 2015 20:59:36 +0000"  >&lt;p&gt;I don&apos;t understand your commit:&lt;br/&gt;
Why should the HtmlHeaderContainer of RerenderAjaxPage be rendered at all, when just the feedback is updated via Ajax?&lt;/p&gt;</comment>
                            <comment id="14696675" author="dashorst" created="Fri, 14 Aug 2015 08:06:29 +0000"  >&lt;p&gt;I see... Apparently I didn&apos;t commit the accompanying test case. There&apos;s a separate test case for this.&lt;/p&gt;</comment>
                            <comment id="14696685" author="jira-bot" created="Fri, 14 Aug 2015 08:16:52 +0000"  >&lt;p&gt;Commit 02d586477a0e9dabf82ab839bd53499c1b78d616 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dashorst&quot; class=&quot;user-hover&quot; rel=&quot;dashorst&quot;&gt;dashorst&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=02d5864&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=02d5864&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Added test case for &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5960&quot; title=&quot;Page header isn&amp;#39;t rendered for pages where URL has changed during render&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5960&quot;&gt;&lt;del&gt;WICKET-5960&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14696687" author="dashorst" created="Fri, 14 Aug 2015 08:17:34 +0000"  >&lt;p&gt;The AJAX request replaces (or introduces) the PartialMarkupHtmlHeadContainer in the page when it is performing the render of the feedback panel. My guess is to capture any new header contributions. The issue is not this, it is that at the end of the AJAX request the PartialMarkupHeaderContainer is still attached to the page and the subsequent non-AJAX request uses this container to render the head section, causing an empty &amp;lt;head&amp;gt;.&lt;/p&gt;

&lt;p&gt;When you renamed onDetach to onAfterRender this problem was introduced because somehow onAfterRender is not called in an AJAX update for the , but onDetach is.&lt;/p&gt;

&lt;p&gt;I&apos;ve committed the test case. When you comment out the two lines in HtmlHeaderContainer&apos;s onDetach you can reproduce the bug.&lt;/p&gt;</comment>
                            <comment id="14698265" author="svenmeier" created="Sat, 15 Aug 2015 13:34:02 +0000"  >&lt;p&gt;The PartialHtmlHeaderContainer isn&apos;t rendered actually, it&apos;s just used to provide the Ajax header response.&lt;br/&gt;
Thus #onAfterRender() is not called until after the next full render of the page.&lt;/p&gt;</comment>
                            <comment id="14698266" author="jira-bot" created="Sat, 15 Aug 2015 13:40:23 +0000"  >&lt;p&gt;Commit a9056384f018e10e6d7cfc0af674057f6660d906 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=a905638&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=a905638&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5960&quot; title=&quot;Page header isn&amp;#39;t rendered for pages where URL has changed during render&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5960&quot;&gt;&lt;del&gt;WICKET-5960&lt;/del&gt;&lt;/a&gt; remove PartialHtmlHeaderContainer from page after writing to the response&lt;/p&gt;</comment>
                            <comment id="14698288" author="jira-bot" created="Sat, 15 Aug 2015 14:37:09 +0000"  >&lt;p&gt;Commit 562d43ccdd7f305f8ca641817f4b63a07ee8b6a6 in wicket&apos;s branch refs/heads/wicket-6.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=562d43c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=562d43c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5960&quot; title=&quot;Page header isn&amp;#39;t rendered for pages where URL has changed during render&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5960&quot;&gt;&lt;del&gt;WICKET-5960&lt;/del&gt;&lt;/a&gt; remove PartialHtmlHeaderContainer from page after writing to the response&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2i9lb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>