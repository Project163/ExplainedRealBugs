<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:23:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-5909] Session style is not taken into account when loading mounted resources.</title>
                <link>https://issues.apache.org/jira/browse/WICKET-5909</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Session#getStyle is not considered when a mounted package resource is loaded. Wicket loads the default one.&lt;br/&gt;
If the resource is not mounted, everything works fine and Wicket delivers the correct resource file.&lt;/p&gt;

&lt;p&gt;Quickstart is attached. There are two CSS files: styled.css and styled_orange.css. The corresponding package resource is mounted. The session style is set to orange in WicketApplication#newSession. Expected behavior is that styled_orange.css is delivered to a browser. Instead styled.css is delivered.&lt;br/&gt;
There is a workaround: see WorkaroundResourceStreamLocator.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12830816">WICKET-5909</key>
            <summary>Session style is not taken into account when loading mounted resources.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bitstorm">Andrea Del Bene</assignee>
                                    <reporter username="barlabanov">Sergiy Barlabanov</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 May 2015 20:34:52 +0000</created>
                <updated>Tue, 7 Jul 2015 19:34:50 +0000</updated>
                            <resolved>Sun, 5 Jul 2015 20:20:43 +0000</resolved>
                                    <version>7.0.0-M5</version>
                    <version>6.19.0</version>
                                    <fixVersion>7.0.0</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14549174" author="barlabanov" created="Mon, 18 May 2015 20:35:27 +0000"  >&lt;p&gt;quickstart&lt;/p&gt;</comment>
                            <comment id="14549230" author="bitstorm" created="Mon, 18 May 2015 21:05:43 +0000"  >&lt;p&gt;should be caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5793&quot; title=&quot;Request for static resource creating a session in 6.13.0+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5793&quot;&gt;&lt;del&gt;WICKET-5793&lt;/del&gt;&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="14550856" author="klopfdreh" created="Tue, 19 May 2015 17:43:20 +0000"  >&lt;p&gt;The issue here is that if you mount a resource it gets a fixed count of url segments like you put into the first arg of mountResource. For a normal ResourceReference the style is added as query behind and resolves directly to the resource - to test (not mounted ResourceReference)&lt;/p&gt;

&lt;p&gt;This will give you the orange css&lt;br/&gt;
./wicket/resource/org.barlabanov.HomePage/styled-ver-1432053148000.css?-orange&lt;/p&gt;

&lt;p&gt;This will give you the blue&lt;br/&gt;
./wicket/resource/org.barlabanov.HomePage/styled-ver-1432053148000.css&lt;/p&gt;

&lt;p&gt;If you mount that ResourceReference a ResourceMapper is initialized at the startup of the application which delegates the requests of the mount to the ResourceReference, but at this point there is no session to get the style from and if it would be there the style is not redirected to the actual ResourceReference.&lt;/p&gt;

&lt;p&gt;I tried to modify the ResourceMapper, but without any success.&lt;/p&gt;

&lt;p&gt;@&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bitstorm&quot; class=&quot;user-hover&quot; rel=&quot;bitstorm&quot;&gt;bitstorm&lt;/a&gt; What do you think? I don&apos;t think it has something to do with &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5793&quot; title=&quot;Request for static resource creating a session in 6.13.0+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5793&quot;&gt;&lt;del&gt;WICKET-5793&lt;/del&gt;&lt;/a&gt; - but correct me if I am wrong.&lt;/p&gt;

&lt;p&gt;Edit: I reverted your changes of the session locally and the bug isn&apos;t fixed - so this is something else then you fixed with &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5793&quot; title=&quot;Request for static resource creating a session in 6.13.0+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5793&quot;&gt;&lt;del&gt;WICKET-5793&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14552326" author="bitstorm" created="Wed, 20 May 2015 13:36:06 +0000"  >&lt;p&gt;yep! you are right, the actual style is correctly resolved. the problem must be somewhere else &lt;/p&gt;</comment>
                            <comment id="14556390" author="bitstorm" created="Fri, 22 May 2015 16:21:53 +0000"  >&lt;p&gt;I&apos;ve attached a patch for Wicket 7. I&apos;ve simply turned ResourceMapper into a subclass of AbstractResourceReferenceMapper in order to have a consistent behavior with the other resource mappers. This is a simple solution, BUT:&lt;/p&gt;

&lt;p&gt;-it&apos;s not possible to backport it to 6.x&lt;br/&gt;
-ResourceMapper does not use the original resourceReference anymore but creates a new resource reference using the informations coded as query parameters.&lt;/p&gt;
</comment>
                            <comment id="14556614" author="klopfdreh" created="Fri, 22 May 2015 18:53:31 +0000"  >&lt;p&gt;I thank you so much! I just wanted to fix this issue during the weekend and now I have more time left! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Great!&lt;/p&gt;</comment>
                            <comment id="14556681" author="mgrigorov" created="Fri, 22 May 2015 19:28:33 +0000"  >&lt;p&gt;Let me take a look.&lt;br/&gt;
Please do not apply the patch for now.&lt;/p&gt;</comment>
                            <comment id="14556744" author="jira-bot" created="Fri, 22 May 2015 20:01:47 +0000"  >&lt;p&gt;Commit eced7b96301436de388e8f7ee7af6d366544b905 in wicket&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5909&quot; title=&quot;Session style is not taken into account when loading mounted resources.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5909&quot;&gt;&lt;del&gt;WICKET-5909&lt;/del&gt;&lt;/a&gt; from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mgrigorov&quot; class=&quot;user-hover&quot; rel=&quot;mgrigorov&quot;&gt;mgrigorov&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=eced7b9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=eced7b9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5909&quot; title=&quot;Session style is not taken into account when loading mounted resources.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5909&quot;&gt;&lt;del&gt;WICKET-5909&lt;/del&gt;&lt;/a&gt; Session style is not taken into account when loading mounted resources.&lt;/p&gt;

&lt;p&gt;Use the current session style and locale if there are no explicitly specified ones in PackageResource&apos;s constructor.&lt;/p&gt;</comment>
                            <comment id="14556759" author="jira-bot" created="Fri, 22 May 2015 20:10:45 +0000"  >&lt;p&gt;Commit eb5b07b585753734cc989c72fce8a3f941bb538d in wicket&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5909&quot; title=&quot;Session style is not taken into account when loading mounted resources.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5909&quot;&gt;&lt;del&gt;WICKET-5909&lt;/del&gt;&lt;/a&gt; from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mgrigorov&quot; class=&quot;user-hover&quot; rel=&quot;mgrigorov&quot;&gt;mgrigorov&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=eb5b07b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=eb5b07b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5909&quot; title=&quot;Session style is not taken into account when loading mounted resources.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5909&quot;&gt;&lt;del&gt;WICKET-5909&lt;/del&gt;&lt;/a&gt; Simplify #getResourceStream(). It should do what #getCacheableResourceStream() does.&lt;/p&gt;</comment>
                            <comment id="14556773" author="mgrigorov" created="Fri, 22 May 2015 20:18:55 +0000"  >&lt;p&gt;I&apos;m suggesting a different solution in branch &apos;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5909&quot; title=&quot;Session style is not taken into account when loading mounted resources.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5909&quot;&gt;&lt;del&gt;WICKET-5909&lt;/del&gt;&lt;/a&gt;&apos;.&lt;br/&gt;
Now #getResourceStream() will use the current session locale/style if there is no explicitly specified ones in PackageResource&apos;s constructor.&lt;br/&gt;
IMO this should be the default behavior and there shouldn&apos;t be a need to have #getCacheableResourseStream() that always uses the session&apos;s locale/style.&lt;/p&gt;

&lt;p&gt;The quickstart app is a bit broken - there is no bound session. A temporary Session is created for the request serving the page, but the request for the PackageResource doesn&apos;t create any session, even temporary, and thus the style is null.&lt;/p&gt;

&lt;p&gt;While writing the explanation I realized that #getCacheableResourceStream() does exactly what I believe should be the expected behavior. I just pushed a new commit that delegates #getResoureStream() to #getCacheableResourceStream(). All tests pass!&lt;/p&gt;

&lt;p&gt;I&apos;ve modified few tests because WicketTester simulates an USA user (Accept-Language: en-us) and thus the test loads package1_en.txt version now. &lt;/p&gt;</comment>
                            <comment id="14557853" author="bitstorm" created="Sun, 24 May 2015 21:29:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mgrigorov&quot; class=&quot;user-hover&quot; rel=&quot;mgrigorov&quot;&gt;mgrigorov&lt;/a&gt;&lt;br/&gt;
In which sense the quickstart is broken? Because it&apos;s stateless (no bound session)?&lt;/p&gt;</comment>
                            <comment id="14558010" author="mgrigorov" created="Mon, 25 May 2015 06:43:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bitstorm&quot; class=&quot;user-hover&quot; rel=&quot;bitstorm&quot;&gt;bitstorm&lt;/a&gt; Yes, this is what I meant. But now I agree that Wicket should store the session style and locale as request parameters, like BasicResourceReferenceMapper does. So the actual fix should be a mix of mine and your changes.&lt;/p&gt;</comment>
                            <comment id="14572837" author="bitstorm" created="Thu, 4 Jun 2015 14:16:53 +0000"  >&lt;p&gt;I&apos;ve create a new branch to work for a fix for 7.x. It&apos;s called  &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5906&quot; title=&quot;Use default on missing resource does not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5906&quot;&gt;&lt;del&gt;WICKET-5906&lt;/del&gt;&lt;/a&gt;-7.x (see &lt;a href=&quot;https://git1-us-west.apache.org/repos/asf?p=wicket.git;a=shortlog;h=refs/heads/WICKET-5906-7.x&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git1-us-west.apache.org/repos/asf?p=wicket.git;a=shortlog;h=refs/heads/WICKET-5906-7.x&lt;/a&gt;). This solution is slightly different from the previous patch I&apos;ve attached. I&apos;ve moved most of the logic from AbstractResourceReferenceMapper to ResourceUtil in order to share it across different mappers or classes that needs to encode/decode resource attributes in the URL.&lt;br/&gt;
Maybe is more radical as solution but I prefer it over the previous idea of turning ResourceMapper into a subclass of AbstractResourceReferenceMapper.&lt;/p&gt;</comment>
                            <comment id="14573453" author="jira-bot" created="Thu, 4 Jun 2015 19:39:33 +0000"  >&lt;p&gt;Commit c3523805f4ec1f4599ad16873efc20d457d28130 in wicket&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5906&quot; title=&quot;Use default on missing resource does not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5906&quot;&gt;&lt;del&gt;WICKET-5906&lt;/del&gt;&lt;/a&gt;-7.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bitstorm&quot; class=&quot;user-hover&quot; rel=&quot;bitstorm&quot;&gt;bitstorm&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=c352380&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=c352380&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5909&quot; title=&quot;Session style is not taken into account when loading mounted resources.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5909&quot;&gt;&lt;del&gt;WICKET-5909&lt;/del&gt;&lt;/a&gt; code improvement&lt;/p&gt;</comment>
                            <comment id="14577749" author="mgrigorov" created="Mon, 8 Jun 2015 20:02:35 +0000"  >&lt;p&gt;The change is good.&lt;br/&gt;
It misses javadocs and tests for the new helper methods.&lt;/p&gt;

&lt;p&gt;I still believe org.apache.wicket.request.resource.PackageResource#getResourceStream() should just delegate to org.apache.wicket.request.resource.PackageResource#getCacheableResourceStream().&lt;/p&gt;</comment>
                            <comment id="14617237" author="jira-bot" created="Tue, 7 Jul 2015 19:34:50 +0000"  >&lt;p&gt;Commit 5c829c4ac40d95c78010697dd093aceba4b54877 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mgrigorov&quot; class=&quot;user-hover&quot; rel=&quot;mgrigorov&quot;&gt;mgrigorov&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=5c829c4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=5c829c4&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5909&quot; title=&quot;Session style is not taken into account when loading mounted resources.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5909&quot;&gt;&lt;del&gt;WICKET-5909&lt;/del&gt;&lt;/a&gt; Session style is not taken into account when loading mounted resources.&lt;/p&gt;

&lt;p&gt;Rename IStaticCacheableResource#getCacheableResourceStream() to #getResourceStream().&lt;br/&gt;
Merge PackageResource#getCacheableResourceStream() and #getResourceStream() by preserving the behavior of #getCacheableResourceStream()&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12733616" name="style-bug.zip" size="24151" author="barlabanov" created="Mon, 18 May 2015 20:35:27 +0000"/>
                            <attachment id="12734861" name="wicket.patch" size="3230" author="bitstorm" created="Fri, 22 May 2015 16:22:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 19 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ew67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>