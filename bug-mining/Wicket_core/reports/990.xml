<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:22:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-5492] WebApplication ignores a SecurityException when reading the configuration type</title>
                <link>https://issues.apache.org/jira/browse/WICKET-5492</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;The WebApplication class has a piece of code in the method getConfigurationType(), that ignores a SecurityException.&lt;/p&gt;

&lt;p&gt;Code snippet:&lt;br/&gt;
               try&lt;/p&gt;
               {
                       result = System.getProperty(&quot;wicket.&quot; + Application.CONFIGURATION);
               }
&lt;p&gt;               catch (SecurityException e)&lt;/p&gt;
               {
                       // Ignore - we&apos;re not allowed to read system properties.
               }

&lt;p&gt;This apparently causes a performance problem at one of our customers, where they had shared classloading enabled. &lt;/p&gt;

&lt;p&gt;Permissions were set differently on shared classloader level, which caused the retrieval of the property to fail silently, while taking about 10ms longer. This code is called everytime Component.getMarkupId is called, which means with 300+ components on a page, you get a delay of 3 seconds or more.&lt;/p&gt;

&lt;p&gt;Ofcourse the problem can be (and has been) solved with a correct configuration. My request however is that the exception is atleast logged at some level (warning for example), so spotting the problem will become a lot easier (it took us 2 weeks to narrow it down).&lt;/p&gt;</description>
                <environment>WebSphere 6.1 with shared classloading enabled. Linux system.</environment>
        <key id="12691985">WICKET-5492</key>
            <summary>WebApplication ignores a SecurityException when reading the configuration type</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="a.zwaan">Arjan Zwaan</reporter>
                        <labels>
                            <label>exception-handling</label>
                            <label>security</label>
                    </labels>
                <created>Wed, 29 Jan 2014 09:33:37 +0000</created>
                <updated>Thu, 30 Jan 2014 08:54:19 +0000</updated>
                            <resolved>Thu, 30 Jan 2014 08:48:32 +0000</resolved>
                                    <version>1.4.18</version>
                                    <fixVersion>6.14.0</fixVersion>
                    <fixVersion>7.0.0-M1</fixVersion>
                    <fixVersion>1.5.12</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="13885173" author="svenmeier" created="Wed, 29 Jan 2014 09:41:19 +0000"  >&lt;p&gt;But the configurationType is set to DEVELOPMENT if it cannot be determined otherwise, so how can this code be called &apos;everytime Component.getMarkupId is called&apos;?&lt;/p&gt;</comment>
                            <comment id="13885176" author="mgrigorov" created="Wed, 29 Jan 2014 09:43:19 +0000"  >&lt;p&gt;The configuration type is initialized just once.&lt;br/&gt;
See at &lt;a href=&quot;https://github.com/apache/wicket/blob/wicket-1.5.x/wicket-core/src/main/java/org/apache/wicket/protocol/http/WebApplication.java?source=c#L702&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/blob/wicket-1.5.x/wicket-core/src/main/java/org/apache/wicket/protocol/http/WebApplication.java?source=c#L702&lt;/a&gt; - if it is null then it is set to DEVELOPMENT.&lt;/p&gt;

&lt;p&gt;This would explain some slowessness.&lt;br/&gt;
But I don&apos;t think WebApplication#getConfigurationType() would fail again and again with SecurityException.&lt;/p&gt;

&lt;p&gt;Can you please re-check that again ?&lt;br/&gt;
Logging a warning once at app start is OK-ish. But logging warnings again and again when SecurityManager forbids System#getProperty() would be problematic.&lt;/p&gt;</comment>
                            <comment id="13885194" author="a.zwaan" created="Wed, 29 Jan 2014 10:10:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=martin-g&quot; class=&quot;user-hover&quot; rel=&quot;martin-g&quot;&gt;martin-g&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;We have the servlet configuration in the web.xml set to DEPLOYMENT.&lt;/p&gt;

&lt;p&gt;		&amp;lt;init-param&amp;gt;&lt;br/&gt;
			&amp;lt;param-name&amp;gt;configuration&amp;lt;/param-name&amp;gt;&lt;br/&gt;
			&amp;lt;param-value&amp;gt;DEPLOYMENT&amp;lt;/param-value&amp;gt;&lt;br/&gt;
		&amp;lt;/init-param&amp;gt;&lt;/p&gt;

&lt;p&gt;The logging at our customer shows this call being the problem:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1/28/14 10:14:56:361 CET&amp;#93;&lt;/span&gt; 0000007f SecurityManag 3   &lt;br/&gt;
Java SecurityException:&lt;br/&gt;
perm.getName&amp;lt;&amp;gt;: wicket.configuration&lt;br/&gt;
e.getMessage&amp;lt;&amp;gt;: Access denied (java.util.PropertyPermission wicket.configuration read)&lt;br/&gt;
Begin SecurityException&lt;br/&gt;
java.security.AccessControlException: Access denied (java.util.PropertyPermission wicket.configuration read)&lt;br/&gt;
      at java.security.AccessController.throwACE(AccessController.java:99)&lt;br/&gt;
      at java.security.AccessController.checkPermission(AccessController.java:173)&lt;br/&gt;
      at java.lang.SecurityManager.checkPermission(SecurityManager.java:558)&lt;br/&gt;
      at com.ibm.ws.security.core.SecurityManager.checkPermission(SecurityManager.java:214)&lt;br/&gt;
      at java.lang.SecurityManager.checkPropertyAccess(SecurityManager.java:1311)&lt;br/&gt;
      at java.lang.System.getProperty(System.java:397)&lt;br/&gt;
      at java.lang.System.getProperty(System.java:381)&lt;br/&gt;
      at org.apache.wicket.protocol.http.WebApplication.getConfigurationType(WebApplication.java:582)&lt;br/&gt;
      at org.apache.wicket.Component.getMarkupId(Component.java:1609)&lt;br/&gt;
      at org.apache.wicket.Component.getMarkupId(Component.java:1645)&lt;/p&gt;

&lt;p&gt;Looking at the code in the component class, this line is calling the getConfigurationType:&lt;/p&gt;

&lt;p&gt;		if (!Application.get().getConfigurationType().equals(Application.DEPLOYMENT))&lt;/p&gt;

&lt;p&gt;which is in the getMarkupId method, as seen in the stacktrace.&lt;/p&gt;

&lt;p&gt;Checking the link it seems that 1.5.x indeed only initializes it once, the 1.4.x version however does not yet have this check.&lt;/p&gt;

&lt;p&gt;So in 1.5.x it still ignores the exception, but only in 1.4.18 it causes the problems we have. I&apos;ll updated affected versions.&lt;/p&gt;

&lt;p&gt;Unfortunately we are still stuck on WebSphere 6.1 and therefore Wicket 1.4.18 for a little while, we are working on moving to Websphere 7 or above, but it is a slow process.&lt;/p&gt;</comment>
                            <comment id="13885198" author="mgrigorov" created="Wed, 29 Jan 2014 10:15:40 +0000"  >&lt;p&gt;Right, now I remember that we had the same problem in early 1.5.0-SNAPSHOT days and I made the improvement to initialize the config type just once at app start.&lt;br/&gt;
I think it is OK to log a warning when the system property cannot be read.&lt;br/&gt;
But we will do this only for 1.5.x, 6.x and 7.x branches.&lt;br/&gt;
1.4.x branch receives only security related fixes and I don&apos;t want to port the improvement.&lt;/p&gt;</comment>
                            <comment id="13885201" author="a.zwaan" created="Wed, 29 Jan 2014 10:21:32 +0000"  >&lt;p&gt;Understood, I already kind of expected 1.4.x would no longer get these kind of changes. &lt;/p&gt;

&lt;p&gt;Thanks for the feedback and responses, hopefully we will be able to switch to 1.5.x or higher in the near future.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>370575</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 42 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1rvav:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>370885</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>