<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:23:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-5578] Stateless/Statefull pages - incorrect behaviour</title>
                <link>https://issues.apache.org/jira/browse/WICKET-5578</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Please advise how to do in following situation or confirm that&apos;s a bug and should be fixed.&lt;/p&gt;

&lt;p&gt;There is a page (login page) with stateless form. That page has lots of common components (menu and etc.). There are some stateful components in the components tree that are visible only for signed in users: but once user isn&apos;t signed in - that components are hidden. That&apos;s why page is becoming &quot;stateless&quot; (no visible components) and form prepared correspondingly. But when form data is submitted: during obtaining of form component to process request - wicket thinks that page actually is stateful. As a result - the page is recreated and fully rendered - instead of processing of the form.&lt;/p&gt;

&lt;p&gt;There is a workaround: setStatelessHint(false). But imho reason is a little bit another:&lt;br/&gt;
1) After construction of page: page is stateful - because of some stateful components are in the tree.&lt;br/&gt;
2) After initialization of page: page is still stateful - because there are that stateful components&lt;br/&gt;
3) After configuration of page (method onConfigure) - page is becoming stateless - because all stateful components marked as invisible.&lt;br/&gt;
4) Form has been rendered as stateless - with no version number is in the URL.&lt;br/&gt;
5) Page can&apos;be reconstructed correctly because of p.1 and p.2&lt;/p&gt;

&lt;p&gt;I think that stateless flag should be precalculated right after initialization step and should be changed due to some stuff in &quot;configuration&quot; methods.&lt;/p&gt;

&lt;p&gt;What do you think?&lt;/p&gt;

&lt;p&gt;Will provide &quot;quick start&quot; in near future!&lt;/p&gt;</description>
                <environment></environment>
        <key id="12712327">WICKET-5578</key>
            <summary>Stateless/Statefull pages - incorrect behaviour</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bitstorm">Andrea Del Bene</assignee>
                                    <reporter username="phantom">Ilia Naryzhny</reporter>
                        <labels>
                            <label>stateful</label>
                            <label>stateless</label>
                    </labels>
                <created>Mon, 5 May 2014 14:56:45 +0000</created>
                <updated>Wed, 16 Jul 2014 07:44:37 +0000</updated>
                            <resolved>Wed, 16 Jul 2014 07:44:37 +0000</resolved>
                                    <version>7.0.0-M1</version>
                    <version>6.15.0</version>
                                    <fixVersion>7.0.0-M3</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13989730" author="phantom" created="Mon, 5 May 2014 17:23:01 +0000"  >&lt;p&gt;Please find quick start is in attachment.&lt;/p&gt;

&lt;p&gt;You can find &quot;special&quot; stateful component on HomePage which is making loginin impossible because of explained by me earler reasons.&lt;/p&gt;

&lt;p&gt;You can:&lt;br/&gt;
1) Either comment line HomePage#62&lt;br/&gt;
2) Or remove component &quot;ajaxLink&quot; from the page&lt;br/&gt;
to make logging process to work perfectly.&lt;/p&gt;</comment>
                            <comment id="13989735" author="phantom" created="Mon, 5 May 2014 17:25:12 +0000"  >&lt;p&gt;May be I&apos;m wrong, but in our case this issue directly related to issue &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5539&quot; title=&quot;Allow preserving of the parsed PageParameters when re-creating an expired page&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5539&quot;&gt;&lt;del&gt;WICKET-5539&lt;/del&gt;&lt;/a&gt; which was closed with reason &quot;Won&apos;t fix&quot;.&lt;/p&gt;</comment>
                            <comment id="13991219" author="bitstorm" created="Tue, 6 May 2014 22:02:00 +0000"  >&lt;p&gt;The issue is also related to &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5426&quot; title=&quot;Page not recognized as stateless although stateful component is hidden in #onConfigure()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5426&quot;&gt;&lt;del&gt;WICKET-5426&lt;/del&gt;&lt;/a&gt;. We could solve it adding isStateless to canCallListenerInterfaceAfterExpiry inside Component class:&lt;/p&gt;

&lt;p&gt;@Override&lt;br/&gt;
	public boolean canCallListenerInterfaceAfterExpiry()&lt;/p&gt;
	{
		return isStateless() || getApplication().getPageSettings()
			.getCallListenerInterfaceAfterExpiry();
	}

&lt;p&gt;I successfully tested it, but I need to know the opinion of the other developers.&lt;/p&gt;</comment>
                            <comment id="13992527" author="phantom" created="Thu, 8 May 2014 05:43:50 +0000"  >&lt;p&gt;Imho flag stateless/statefull should be checked once after onInitialize and if page is statefull it shouldn&apos;t be turned to stateless on the next steps of the page&apos;s life-cycle...&lt;/p&gt;</comment>
                            <comment id="13992632" author="mgrigorov" created="Thu, 8 May 2014 09:49:18 +0000"  >&lt;p&gt;The statefulness is checked for every render of the page.&lt;br/&gt;
The page may hide (setVisible(false)) or remove(statefulComponent) its stateful components at anytime and Wicket should respect that.&lt;br/&gt;
There was a ticket by another user recently exactly for this problem. See &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5424&quot; title=&quot;Page.isPageStateless() returning true in regular run but false in WicketTester&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5424&quot;&gt;&lt;del&gt;WICKET-5424&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5426&quot; title=&quot;Page not recognized as stateless although stateful component is hidden in #onConfigure()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5426&quot;&gt;&lt;del&gt;WICKET-5426&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13992865" author="bitstorm" created="Thu, 8 May 2014 15:54:02 +0000"  >&lt;p&gt;And what about using isStateless inside canCallListenerInterfaceAfterExpiry? &lt;br/&gt;
IMHO it makes perfectly sense to always invoke listener on stateless component, even on new instances. This would avoid to enter into the if statement in class ListenerInterfaceRequestHandler at line 197.&lt;/p&gt;</comment>
                            <comment id="13992911" author="phantom" created="Thu, 8 May 2014 16:44:30 +0000"  >&lt;p&gt;I understand that there are workarounds. But, I think, logic is stright forward:&lt;br/&gt;
1) Page is stateful after creation and initialization&lt;br/&gt;
2) Page is becoming stateless after configuration&lt;br/&gt;
3) Once page is stateless: server side will not store any &quot;state&quot;&lt;br/&gt;
4) Any internal request on the stateless page will request &quot;recreation&quot; of the page instance for request processing. But once page is statefull right after initialization: there will be an incorrect behaviour like on provided quick start.&lt;/p&gt;</comment>
                            <comment id="14056252" author="mgrigorov" created="Wed, 9 Jul 2014 13:59:19 +0000"  >&lt;p&gt;An easy workaround for the current case is to use:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;AjaxLink#isVisible() {&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; AuthenticatedWebSession.get().isSignedIn() &amp;amp;&amp;amp; &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.isVisible(); } 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;instead of using &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;onConfigure() { setVisible(AuthenticatedWebSession.get().isSignedIn()) }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The problem with onConfigure() is that it is called at the RENDER phase (onBeforeRender, onConfigure, render, onAfterRender) of the component lifecycle. By using #isVisible() you have the chance to decide whether the page is stateless also in the ACTION phase (onClick/onSubmit/etc.).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bitstorm&quot; class=&quot;user-hover&quot; rel=&quot;bitstorm&quot;&gt;bitstorm&lt;/a&gt; canCallListenerInterfaceAfterExpiry() is only in 7.x. I agree with your suggested change. Please convert the attached quickstart to a unit test and apply it in 7.x. Thanks!&lt;/p&gt;</comment>
                            <comment id="14060193" author="bitstorm" created="Sun, 13 Jul 2014 18:00:37 +0000"  >&lt;p&gt;I&apos;ve committed my change to 7.x. Rather than creating a new test case, I&apos;ve added a testing method to WicketTesterLazyIsPageStatelessRedirectToBufferTest which was created by Sven for &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5426&quot; title=&quot;Page not recognized as stateless although stateful component is hidden in #onConfigure()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5426&quot;&gt;&lt;del&gt;WICKET-5426&lt;/del&gt;&lt;/a&gt;. I think it makes sense, but if you don&apos;t agree let me know.&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12702749">WICKET-5539</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12643393" name="wicket5578.zip" size="27578" author="phantom" created="Mon, 5 May 2014 17:23:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>390643</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 18 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1vabz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>390890</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>