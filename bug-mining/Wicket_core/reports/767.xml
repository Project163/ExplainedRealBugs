<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:21:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4906] Form#visitFormComponents can cause ClassCastException</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4906</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;The current method signature of Form#visitComponents allows for passing in an implementation of IVisitor that will cause a ClassCastException. &lt;br/&gt;
Example&lt;br/&gt;
Add a CheckBox and TextField to the Form. Pass in an IVisitor&amp;lt;CheckBox&amp;gt; to visitComponents. There will be a ClassCastException when the IVisitor&amp;lt;CheckBox&amp;gt; attempts to visit the TextField.&lt;/p&gt;

&lt;p&gt;The method signature should be changed to&lt;br/&gt;
public final &amp;lt;R&amp;gt; R visitFormComponents(final IVisitor&amp;lt;FormComponent&amp;lt;?&amp;gt;, R&amp;gt; visitor)&lt;br/&gt;
or the method should be removed to prevent confusion.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12618616">WICKET-4906</key>
            <summary>Form#visitFormComponents can cause ClassCastException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vitiate">Jesse Bonzo</reporter>
                        <labels>
                            <label>form</label>
                            <label>visit</label>
                            <label>wicket</label>
                    </labels>
                <created>Mon, 3 Dec 2012 19:14:50 +0000</created>
                <updated>Mon, 7 Jan 2013 15:35:01 +0000</updated>
                            <resolved>Mon, 7 Jan 2013 15:35:01 +0000</resolved>
                                    <version>6.3.0</version>
                                    <fixVersion>6.5.0</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13508952" author="vitiate" created="Mon, 3 Dec 2012 19:18:15 +0000"  >&lt;p&gt;This project demonstrates the problem&lt;/p&gt;</comment>
                            <comment id="13510527" author="bitstorm" created="Wed, 5 Dec 2012 15:18:23 +0000"  >&lt;p&gt;We could use reflection to extract the actual component type from IVisitor interface and pass it to method visitChildren (see method visitFormComponents in Form.java).&lt;/p&gt;</comment>
                            <comment id="13510681" author="vitiate" created="Wed, 5 Dec 2012 18:53:07 +0000"  >&lt;p&gt;This patch shows how it could be done with reflection&lt;/p&gt;</comment>
                            <comment id="13510682" author="vitiate" created="Wed, 5 Dec 2012 18:53:31 +0000"  >&lt;p&gt;I noticed visitFormComponentsPostOrder has the same problem.&lt;/p&gt;</comment>
                            <comment id="13525897" author="bitstorm" created="Thu, 6 Dec 2012 22:50:08 +0000"  >&lt;p&gt;The idea behind your code is ok, but it should work also with raw visitors, i.e. implementations of IVisitor without parameter types. I&apos;ve attached my patch which is based on generic interfaces rather than class methods. &lt;/p&gt;</comment>
                            <comment id="13526239" author="mgrigorov" created="Fri, 7 Dec 2012 08:54:35 +0000"  >&lt;p&gt;Form#visitFormComponents() is about visiting the FormComponents in a Form.&lt;/p&gt;

&lt;p&gt;If you replace it with myForm.visitChildren(CheckBox.class, new MyVisitor()); then it works as needed.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure that all the reflection is needed. We can update the javadocs...&lt;/p&gt;</comment>
                            <comment id="13526507" author="vitiate" created="Fri, 7 Dec 2012 16:26:18 +0000"  >&lt;p&gt;The method signature suggests that its about visiting FormComponents and subclasses of FormComponents because of the type parameter &amp;lt;? extends FormComponent&amp;lt;?&amp;gt; which allows subclasses of FormComponents. I would go back to my original suggestion and change the method signature to&lt;br/&gt;
public final &amp;lt;R&amp;gt; R visitFormComponents(final IVisitor&amp;lt;FormComponent&amp;lt;?&amp;gt;, R&amp;gt; visitor) &lt;br/&gt;
That would better reflect what the method is actually doing. I would argue that this doesn&apos;t break the API since anyone who was passing in IVisitor&amp;lt;CheckBox&amp;gt; (or some other subclass) would get a ClassCastException at runtime. It would be better for the compiler to report this error.&lt;/p&gt;</comment>
                            <comment id="13545965" author="mgrigorov" created="Mon, 7 Jan 2013 15:35:01 +0000"  >&lt;p&gt;The method signature has been simplified as suggested.&lt;br/&gt;
Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12555810" name="WicketQuickStart.zip" size="33110" author="vitiate" created="Mon, 3 Dec 2012 19:18:15 +0000"/>
                            <attachment id="12559663" name="detectVisitorComponentClass.patch" size="1720" author="bitstorm" created="Thu, 6 Dec 2012 22:50:25 +0000"/>
                            <attachment id="12556132" name="visitFormComponentsfix.patch" size="925" author="vitiate" created="Wed, 5 Dec 2012 18:53:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>295775</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 45 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i13xw7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>231121</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>