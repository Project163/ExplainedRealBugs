<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:23:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-5822] AjaxSelfUpdatingTimer stops working after ajax download</title>
                <link>https://issues.apache.org/jira/browse/WICKET-5822</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;I&apos;ve encountered a strange behavior related to AjaxSelfUpdatingTimerBahavior. It triggers normally until I click a link that downloads a dynamic resource. The ajax download link is constructed using the recommendations from:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/WICKET/AJAX+update+and+file+download+in+one+blow&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/WICKET/AJAX+update+and+file+download+in+one+blow&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The problem seems to be related to:&lt;br/&gt;
target.appendJavaScript(&quot;setTimeout(\&quot;window.location.href=&apos;&quot;&lt;br/&gt;
+ url + &quot;&apos;\&quot;, 100);&quot;); &lt;br/&gt;
from ajax download initiate, but if i comment it the download doesn&apos;t work&lt;br/&gt;
anymore.&lt;/p&gt;</description>
                <environment>Linux</environment>
        <key id="12770598">WICKET-5822</key>
            <summary>AjaxSelfUpdatingTimer stops working after ajax download</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="svenmeier">Sven Meier</assignee>
                                    <reporter username="elvis.ciocoiu">Elvis Ciocoiu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Jan 2015 06:41:36 +0000</created>
                <updated>Fri, 30 Jan 2015 10:45:33 +0000</updated>
                            <resolved>Fri, 30 Jan 2015 10:45:33 +0000</resolved>
                                    <version>6.18.0</version>
                                    <fixVersion>6.20.0</fixVersion>
                    <fixVersion>7.0.0-M6</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14294784" author="elvis.ciocoiu" created="Wed, 28 Jan 2015 06:44:33 +0000"  >&lt;p&gt;A sample page to reproduce the problem&lt;/p&gt;</comment>
                            <comment id="14298396" author="svenmeier" created="Fri, 30 Jan 2015 09:10:36 +0000"  >&lt;p&gt;wicket-ajax-query.js clears all timers on &quot;beforeunload&quot; - initiating the download will trigger this event, although the page is never left.&lt;/p&gt;</comment>
                            <comment id="14298404" author="mgrigorov" created="Fri, 30 Jan 2015 09:21:10 +0000"  >&lt;p&gt;This is to prevent memory leaks.&lt;br/&gt;
There is no way how to detect with JS whether the page is really left/closed :-/&lt;/p&gt;

&lt;p&gt;I wonder whether window.open() could be used instead of location.href for setting the download url ?&lt;br/&gt;
This should keep the current page state. &lt;br/&gt;
The question is when/how to close the new window after the download. Maybe setTimeout(function() &lt;/p&gt;
{downloadWindow.close()}
&lt;p&gt;, 100) will do the job ?&lt;/p&gt;</comment>
                            <comment id="14298409" author="svenmeier" created="Fri, 30 Jan 2015 09:29:07 +0000"  >&lt;p&gt;What&apos;s the reason you didn&apos;t use &quot;unload&quot; instead? Do you see a memory leak problem with that?&lt;/p&gt;

&lt;p&gt;JavaScript event handlers have the ability to stop unloading from &quot;beforeunload&quot;. It wouldn&apos;t be nice to lose all timers on the page, just because a confirmation popup returns false.&lt;/p&gt;

&lt;p&gt;I just tried &quot;unload&quot; instead on Firefox, this seems to work fine.&lt;/p&gt;</comment>
                            <comment id="14298411" author="mgrigorov" created="Fri, 30 Jan 2015 09:34:40 +0000"  >&lt;p&gt;AFAIR the support for &quot;unload&quot; differs in the browsers. &quot;beforeunload&quot; is more consistent.&lt;br/&gt;
If using &quot;unload&quot; works also in IE and Chrome then change it!&lt;/p&gt;</comment>
                            <comment id="14298422" author="svenmeier" created="Fri, 30 Jan 2015 09:53:23 +0000"  >&lt;p&gt;To my knowledge it is &quot;beforeunload&quot; which had mixed support on browser:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers.onbeforeunload&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers.onbeforeunload&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers.onunload&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers.onunload&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14298439" author="reiern70" created="Fri, 30 Jan 2015 10:15:34 +0000"  >&lt;p&gt;By the way:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/wicket/blob/master/wicket-core/src/main/java/org/apache/wicket/ajax/res/js/wicket-ajax-jquery.js#L2830&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/blob/master/wicket-core/src/main/java/org/apache/wicket/ajax/res/js/wicket-ajax-jquery.js#L2830&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Wouldn&apos;t it be nicer to have a generic way for components register beforeunload JS handlers? and for other events? So, that handling of timers remove is just part of something more general/abstract? e.g. there where also some memory leaks with YUI date pickers... They could be handled by the same machinery &lt;/p&gt;</comment>
                            <comment id="14298451" author="svenmeier" created="Fri, 30 Jan 2015 10:38:12 +0000"  >&lt;p&gt;I don&apos;t know how that could be improved into something more abstract, but go ahead an suggest something &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14298469" author="jira-bot" created="Fri, 30 Jan 2015 10:41:54 +0000"  >&lt;p&gt;Commit 5f1a816768cfc143ba84a8e1d74c44b374663be7 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=5f1a816&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=5f1a816&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5822&quot; title=&quot;AjaxSelfUpdatingTimer stops working after ajax download&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5822&quot;&gt;&lt;del&gt;WICKET-5822&lt;/del&gt;&lt;/a&gt; use unload instead of beforeunload, so timers are not cleared when browser downloads a file&lt;/p&gt;</comment>
                            <comment id="14298470" author="jira-bot" created="Fri, 30 Jan 2015 10:42:12 +0000"  >&lt;p&gt;Commit f17820482841d1440db2c2229d5736e8daec3351 in wicket&apos;s branch refs/heads/wicket-6.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=f178204&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=f178204&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5822&quot; title=&quot;AjaxSelfUpdatingTimer stops working after ajax download&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5822&quot;&gt;&lt;del&gt;WICKET-5822&lt;/del&gt;&lt;/a&gt; use unload instead of beforeunload, so timers are not cleared when browser downloads a file&lt;/p&gt;</comment>
                            <comment id="14298484" author="svenmeier" created="Fri, 30 Jan 2015 10:45:33 +0000"  >&lt;p&gt;Now using &quot;unload&quot; instead.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12718370">WICKET-5607</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12694929" name="timer test.zip" size="2065" author="elvis.ciocoiu" created="Wed, 28 Jan 2015 06:44:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 42 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24vvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>