<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:23:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-5793] Request for static resource creating a session in 6.13.0+</title>
                <link>https://issues.apache.org/jira/browse/WICKET-5793</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Up to version 6.12.0 we were not seeing any session being established when static resources were being requested - which is desirable because often search engines will hit thousands of times a day and most don&apos;t use cookies or session rewriting so we end up creating a new session for every static resource request that a search engine makes and that just blows out the number of sessions.&lt;/p&gt;

&lt;p&gt;We use:&lt;/p&gt;


&lt;p&gt;    // Use message digest over resource content for resource caching&lt;br/&gt;
    // cache the version information for the lifetime of the application&lt;br/&gt;
    IResourceVersion resourceVersion = new CachingResourceVersion(new MessageDigestResourceVersion());&lt;/p&gt;

&lt;p&gt;    // cache resource with a version string in the filename&lt;br/&gt;
    IResourceCachingStrategy cachingStrategy =&lt;br/&gt;
            new&lt;br/&gt;
FilenameWithVersionResourceCachingStrategy(&quot;&lt;del&gt;ver-static&lt;/del&gt;&quot;,&lt;br/&gt;
resourceVersion);&lt;/p&gt;

&lt;p&gt;    resourceSettings.setCachingStrategy(cachingStrategy);&lt;/p&gt;

&lt;p&gt;and this worked fine up to version 6.12.0 where the code for FilenameWithVersionResourceCachingStrategy.decorateReponse was:&lt;/p&gt;

&lt;p&gt;            /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;set resource caching to maximum and set cache-visibility to &apos;public&apos;&lt;/li&gt;
	&lt;li&gt;&lt;/li&gt;
	&lt;li&gt;@param response&lt;br/&gt;
             */&lt;br/&gt;
            @Override&lt;br/&gt;
            public void&lt;br/&gt;
decorateResponse(AbstractResource.ResourceResponse response, IStaticCacheableResource resource)
            {
                        response.setCacheDurationToMaximum();
 
response.setCacheScope(WebResponse.CacheScope.PUBLIC);
            }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Unfortunately in 6.13.0+ this code became:&lt;/p&gt;

&lt;p&gt;            /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;set resource caching to maximum and set cache-visibility to &apos;public&apos;&lt;/li&gt;
	&lt;li&gt;&lt;/li&gt;
	&lt;li&gt;@param response&lt;br/&gt;
             */&lt;br/&gt;
            @Override&lt;br/&gt;
            public void&lt;br/&gt;
decorateResponse(AbstractResource.ResourceResponse response, IStaticCacheableResource resource)&lt;br/&gt;
            {&lt;br/&gt;
                        String requestedVersion = RequestCycle.get().getMetaData(URL_VERSION);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;
			&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
				&lt;li&gt;&amp;gt;                 String calculatedVersion =&lt;br/&gt;
this.resourceVersion.getVersion(resource);     &amp;lt; ------------&lt;br/&gt;
                        if (calculatedVersion != null &amp;amp;&amp;amp;&lt;br/&gt;
calculatedVersion.equals(requestedVersion))
                        {
 
response.setCacheDurationToMaximum();
 
response.setCacheScope(WebResponse.CacheScope.PUBLIC);
                        }
&lt;p&gt;            }&lt;/p&gt;&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So the line marked above calls code that always creates a new session.&lt;br/&gt;
You can see the stack of this scenario below:&lt;/p&gt;

&lt;p&gt;        at&lt;br/&gt;
com.sas.av.ui.wicket.templates.WicketModelExposerApplication.newSession(&lt;br/&gt;
WicketModelExposerApplication.java:157)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.wicket.Application.fetchCreateAndSetSession(Application.java:&lt;br/&gt;
1569)&lt;br/&gt;
        at org.apache.wicket.Session.get(Session.java:171)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.wicket.request.resource.PackageResource.getCurrentStyle(Packa&lt;br/&gt;
geResource.java:192)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.wicket.request.resource.PackageResource.getCacheableResourceS&lt;br/&gt;
tream(PackageResource.java:398)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.wicket.request.resource.PackageResource.getCacheKey(PackageRe&lt;br/&gt;
source.java:230)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.wicket.request.resource.caching.version.CachingResourceVersio&lt;br/&gt;
n.getVersion(CachingResourceVersion.java:100)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.wicket.request.resource.caching.FilenameWithVersionResourceCa&lt;br/&gt;
chingStrategy.decorateResponse(FilenameWithVersionResourceCachingStrateg&lt;br/&gt;
y.java:200)&lt;/p&gt;

&lt;p&gt;PackageResource.getCurrentStyle() seems to be the culprit.&lt;/p&gt;

&lt;p&gt;Does wicket really need to create a session when a static resource is requested? &lt;/p&gt;

&lt;p&gt;I hope the answer is no because I think the 6.12.0 approach worked well because it did not create a new session for each static request from a search engine.&lt;/p&gt;

&lt;p&gt;Martijn-G said in email group:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;It creates a temporary Wicket Session, no http session but it could be avoided.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We end up doing a lot of work in the WicketSession because it is an object and it&apos;s typed and we can extend it to hold any interesting pieces we need, such as a reference to the current User object etc.,&lt;/p&gt;</description>
                <environment></environment>
        <key id="12763562">WICKET-5793</key>
            <summary>Request for static resource creating a session in 6.13.0+</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bitstorm">Andrea Del Bene</assignee>
                                    <reporter username="chrisc">Chris Colman</reporter>
                        <labels>
                            <label>searchengines</label>
                            <label>seo</label>
                            <label>session</label>
                    </labels>
                <created>Tue, 23 Dec 2014 21:49:31 +0000</created>
                <updated>Sat, 31 Jan 2015 01:36:52 +0000</updated>
                            <resolved>Wed, 14 Jan 2015 21:48:02 +0000</resolved>
                                    <version>6.13.0</version>
                    <version>7.0.0-M4</version>
                                    <fixVersion>7.0.0-M5</fixVersion>
                    <fixVersion>6.19.0</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14263629" author="bitstorm" created="Sat, 3 Jan 2015 20:49:02 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Martijn-G said in email group:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;    It creates a temporary Wicket Session, no http session but it could be avoided.&lt;/p&gt;
    &lt;blockquote&gt;
&lt;p&gt;We end up doing a lot of work in the WicketSession because it is an object and it&apos;s typed and we can extend it to hold any interesting pieces we need, such as a reference to the current User object etc.,&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;As Martin said this shouldn&apos;t be a problem &lt;b&gt;per se&lt;/b&gt; as the lifespan of a temporary session is equal to the one of the current request (in our case the request for a static resource). Hence you shouldn&apos;t see an explosion of the number of open session. Maybe your custom Session becomes permanent by default (does it call Session#bind() ? ).&lt;/p&gt;</comment>
                            <comment id="14263648" author="chrisc" created="Sat, 3 Jan 2015 21:46:06 +0000"  >&lt;p&gt;We have code in our override of WebApplication.newSession that we expected would not be called for static resources - and indeed wasn&apos;t up to 6.12.0 - but since 6.13.0 is. The code assumes that if newSession is called that it should perform all kinds of determination of cookies, current user, traffic statistics etc., which is all pretty much a waste of CPU and other resources when simply serving a static resource. Some of this code assumes that if newSession is being called that a Servlet session is also present.&lt;/p&gt;

&lt;p&gt;Apache webserver is more efficient at serving static resources than a servlet container like Apache Tomcat and so I was thinking that reducing any extra processing on top of the processing that the servlet container already does when serving static resources would help make serving static resources more efficient.&lt;/p&gt;</comment>
                            <comment id="14277725" author="jira-bot" created="Wed, 14 Jan 2015 21:36:40 +0000"  >&lt;p&gt;Commit b78aedb09bce8e10d0970aa1746cc1d9da1e5878 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bitstorm&quot; class=&quot;user-hover&quot; rel=&quot;bitstorm&quot;&gt;bitstorm&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=b78aedb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=b78aedb&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5793&quot; title=&quot;Request for static resource creating a session in 6.13.0+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5793&quot;&gt;&lt;del&gt;WICKET-5793&lt;/del&gt;&lt;/a&gt; Request for static resource creating a session in 6.13.0+&lt;/p&gt;</comment>
                            <comment id="14277741" author="jira-bot" created="Wed, 14 Jan 2015 21:43:33 +0000"  >&lt;p&gt;Commit 160c0f64356da6f66cff33101fe59e2f7b355da3 in wicket&apos;s branch refs/heads/wicket-6.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bitstorm&quot; class=&quot;user-hover&quot; rel=&quot;bitstorm&quot;&gt;bitstorm&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=160c0f6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=160c0f6&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5793&quot; title=&quot;Request for static resource creating a session in 6.13.0+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5793&quot;&gt;&lt;del&gt;WICKET-5793&lt;/del&gt;&lt;/a&gt; Request for static resource creating a session in 6.13.0+&lt;/p&gt;</comment>
                            <comment id="14277753" author="bitstorm" created="Wed, 14 Jan 2015 21:47:49 +0000"  >&lt;p&gt;Added a check inside PackageResource.getCurrentStyle() and PackageResource.getCurrentLocale() to see if we have already a session. Couldn&apos;t find a better solution.&lt;/p&gt;</comment>
                            <comment id="14299541" author="chrisc" created="Sat, 31 Jan 2015 01:36:52 +0000"  >&lt;p&gt;Confirmed this fix is working. We no longer have a session created for static resource requests.&lt;/p&gt;

&lt;p&gt;Thanks for your quick response.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 42 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i23qpz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>