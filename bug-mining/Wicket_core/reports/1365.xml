<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:25:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-6317] AuthenticatedWebSession#signOut() calls twice after session invalidation</title>
                <link>https://issues.apache.org/jira/browse/WICKET-6317</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;When the user wants to log out, I call AuthenticatedWebSession#invalidate(), which, in turn, calls AuthenticatedWebSession#signOut() and sets Session#sessionInvalidated to true.&lt;/p&gt;

&lt;p&gt;After that, at the end of request processing, RequestCycle#onDetach() is called, which in turn calls Session#detach(). The last method checks Session#sessionInvalidated state, and because it is true, invalidates session again with Session#invalidateNow().&lt;/p&gt;

&lt;p&gt;So, if I place some business logic code in #signOut() (as in example class BasicAuthenticationSession from &lt;a href=&quot;https://ci.apache.org/projects/wicket/guide/7.x/single.html#_using_roles_with_metadata&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;official guide&lt;/a&gt;), this code also calls twice, which may be inappropriate in some cases.&lt;/p&gt;

&lt;p&gt;I know about &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6228&quot; title=&quot;Hide AuthenticatedWebSession#signOut() from the public API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6228&quot;&gt;&lt;del&gt;WICKET-6228&lt;/del&gt;&lt;/a&gt; ticket - now #invalidate() doesn&apos;t call #signOut(), and this can be solution for issue, but that changes not ported to Wicket 7 branch.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13040950">WICKET-6317</key>
            <summary>AuthenticatedWebSession#signOut() calls twice after session invalidation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="mitring">Alexey Prudnikov</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Feb 2017 11:39:54 +0000</created>
                <updated>Sun, 5 Mar 2017 20:57:45 +0000</updated>
                            <resolved>Sun, 5 Mar 2017 20:57:45 +0000</resolved>
                                    <version>7.6.0</version>
                                    <fixVersion>7.7.0</fixVersion>
                    <fixVersion>8.0.0-M5</fixVersion>
                                    <component>wicket</component>
                    <component>wicket-auth-roles</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15855848" author="mgrigorov" created="Tue, 7 Feb 2017 12:04:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6228&quot; title=&quot;Hide AuthenticatedWebSession#signOut() from the public API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6228&quot;&gt;&lt;del&gt;WICKET-6228&lt;/del&gt;&lt;/a&gt; is not applied to 7.x because it might break (silently) applications in production.&lt;br/&gt;
There is an entry in the migration guide for 8.x about it so hopefully the developers will take it into account.&lt;/p&gt;

&lt;p&gt;We should definitely improve the example in the guide!&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                            <comment id="15855869" author="mitring" created="Tue, 7 Feb 2017 12:20:04 +0000"  >&lt;p&gt;Thank you for quick response!&lt;/p&gt;

&lt;p&gt;I realize that changes from &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6228&quot; title=&quot;Hide AuthenticatedWebSession#signOut() from the public API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6228&quot;&gt;&lt;del&gt;WICKET-6228&lt;/del&gt;&lt;/a&gt; is API break, no doubt about it.&lt;/p&gt;

&lt;p&gt;But I didn&apos;t understand about 7.x branch - it is my incorrect implementation (probably because of the mistake in documentation) or bug? If it is the incorrect implementation, what is the right way to process user logout with some application-specific business rules?&lt;/p&gt;</comment>
                            <comment id="15855884" author="mgrigorov" created="Tue, 7 Feb 2017 12:27:48 +0000"  >&lt;p&gt;OK, I see. We should not call invalidate() in invalidateNow() if the session is already invalidated.&lt;br/&gt;
You can do the same in your signOut() in the meantime, just wrap your logic with &quot;if (!isSessionInvalidated()) &lt;/p&gt;
{ your logic here }
&lt;p&gt;&quot;.&lt;/p&gt;</comment>
                            <comment id="15855908" author="mitring" created="Tue, 7 Feb 2017 12:42:36 +0000"  >&lt;p&gt;Martin, thank you! I already refactor my business code so it doesn&apos;t afraid of multiple signOut() calls now, but your tip still very useful!&lt;/p&gt;</comment>
                            <comment id="15896545" author="jira-bot" created="Sun, 5 Mar 2017 20:57:21 +0000"  >&lt;p&gt;Commit 237a830f4f412276cc31b236d46f67cec7498dd8 in wicket&apos;s branch refs/heads/wicket-7.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mgrigorov&quot; class=&quot;user-hover&quot; rel=&quot;mgrigorov&quot;&gt;mgrigorov&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=237a830&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=237a830&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6317&quot; title=&quot;AuthenticatedWebSession#signOut() calls twice after session invalidation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6317&quot;&gt;&lt;del&gt;WICKET-6317&lt;/del&gt;&lt;/a&gt; AuthenticatedWebSession#signOut() calls twice after session invalidation&lt;/p&gt;

&lt;p&gt;Do not call #invalidate() inside #invalidateNow() if the session is already invalidated.&lt;/p&gt;</comment>
                            <comment id="15896546" author="jira-bot" created="Sun, 5 Mar 2017 20:57:41 +0000"  >&lt;p&gt;Commit 21ae5a9fb26eba66e593bf8566004c9296548001 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mgrigorov&quot; class=&quot;user-hover&quot; rel=&quot;mgrigorov&quot;&gt;mgrigorov&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=21ae5a9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=21ae5a9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6317&quot; title=&quot;AuthenticatedWebSession#signOut() calls twice after session invalidation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6317&quot;&gt;&lt;del&gt;WICKET-6317&lt;/del&gt;&lt;/a&gt; AuthenticatedWebSession#signOut() calls twice after session invalidation&lt;/p&gt;

&lt;p&gt;Do not call #invalidate() inside #invalidateNow() if the session is already invalidated.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i39puv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>