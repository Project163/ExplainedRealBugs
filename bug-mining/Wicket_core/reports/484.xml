<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:19:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-3927] Use a resource loading lib to setup order for processing ajax response fragments</title>
                <link>https://issues.apache.org/jira/browse/WICKET-3927</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;When css head contributions are added by an ajax response, executed / contributed javascript  can not rely on the css to be rendered. This can for example be a problem for a javascript layout manager which gets triggered with the ajax response. &lt;/p&gt;

&lt;p&gt;It is more a short-come of current browsers, but can be worked around for example by the method described in the blog post:&lt;/p&gt;

&lt;p&gt;&quot;CSSP: Loading CSS with Javascript - and getting an onload callback.&quot;&lt;br/&gt;
&lt;a href=&quot;http://otaqui.com/blog/890/cssp-loading-css-with-javascript-and-getting-an-onload-callback/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://otaqui.com/blog/890/cssp-loading-css-with-javascript-and-getting-an-onload-callback/&lt;/a&gt;&lt;/p&gt;</description>
                <environment>I tested Firefox 4, IE 7, 8, 9 and Chromium 12.0.742.112</environment>
        <key id="12514898">WICKET-3927</key>
            <summary>Use a resource loading lib to setup order for processing ajax response fragments</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jbloemendal">Jannis Bloemendal</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Jul 2011 12:33:36 +0000</created>
                <updated>Thu, 23 Feb 2012 10:29:06 +0000</updated>
                            <resolved>Thu, 23 Feb 2012 10:29:06 +0000</resolved>
                                    <version>1.4.17</version>
                    <version>1.5-RC5.1</version>
                                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13068958" author="jbloemendal" created="Thu, 21 Jul 2011 12:36:43 +0000"  >&lt;p&gt;This is an example demonstration of the issue&lt;/p&gt;</comment>
                            <comment id="13068961" author="jbloemendal" created="Thu, 21 Jul 2011 12:41:01 +0000"  >&lt;p&gt;The patch gives a possible solution for the improvement and is created against the tagged version wicket 1.4.17&lt;/p&gt;</comment>
                            <comment id="13072262" author="jbloemendal" created="Thu, 28 Jul 2011 09:07:40 +0000"  >&lt;p&gt;I was running into several issues in IE using the patch which I provided.&lt;/p&gt;

&lt;p&gt;I propose another solution which pre-loads the css resource via an ajax request to fill the cache of the browser and then proceed adding the link element to the head like it was done before.&lt;/p&gt;</comment>
                            <comment id="13073461" author="jbloemendal" created="Mon, 1 Aug 2011 08:40:04 +0000"  >&lt;p&gt;Initially I thought it is an improvement, but it is more a bug. So the the additional java methods and code which I added can also be left out and the css ajax pre-loading can be used as default behaviour for a link head contribution.&lt;/p&gt;</comment>
                            <comment id="13107192" author="ivaynberg" created="Sat, 17 Sep 2011 18:12:28 +0000"  >&lt;p&gt;we will get to this when we rewrite ajax for 1.6.&lt;/p&gt;

&lt;p&gt;essentially what we can do is use a loader lib and do this:&lt;/p&gt;

&lt;p&gt;load all css resources in parallel&lt;br/&gt;
wait for all of them to finish&lt;br/&gt;
execute any inline css&lt;br/&gt;
load all javascript resources in parallel&lt;br/&gt;
wait for all of them to finish&lt;br/&gt;
execute any inline js&lt;/p&gt;</comment>
                            <comment id="13119148" author="mgrigorov" created="Mon, 3 Oct 2011 06:05:25 +0000"  >&lt;p&gt;Last week I added some improvements related to this ticket in 1.5.x. Now the header contributions are executed one by one waiting for external scripts and CSSs to be loaded before proceeding.&lt;br/&gt;
I think they should be good enough for the requirements in this ticket. Please give them a try.&lt;/p&gt;</comment>
                            <comment id="13133965" author="lankvelt" created="Mon, 24 Oct 2011 10:33:45 +0000"  >&lt;p&gt;The attached backport indeed fixes the issue.&lt;br/&gt;
Verified using Firefox 7.0.1.&lt;/p&gt;</comment>
                            <comment id="13133967" author="mgrigorov" created="Mon, 24 Oct 2011 10:39:54 +0000"  >&lt;p&gt;Any chance that you can upgrade to 1.5.x ?&lt;br/&gt;
The end of life of 1.4.x will be soon - either with 1.5.3 or 1.5.4. After that only security related fixes will be committed in this branch.&lt;/p&gt;</comment>
                            <comment id="13135779" author="lankvelt" created="Wed, 26 Oct 2011 07:51:28 +0000"  >&lt;p&gt;That&apos;s hopefully something we can do for the next major release.&lt;/p&gt;

&lt;p&gt;We&apos;ll be supporting older 1.4 releases for quite some time to come, so it would be very helpful if the patch would be in an official tag.  This is the only patch that we need (i.e. have built our own version of wicket for).&lt;/p&gt;</comment>
                            <comment id="13135782" author="mgrigorov" created="Wed, 26 Oct 2011 07:55:49 +0000"  >&lt;p&gt;The patch is applied in 1.4.x.&lt;/p&gt;</comment>
                            <comment id="13162774" author="jcompagner" created="Mon, 5 Dec 2011 13:31:24 +0000"  >&lt;p&gt;this patch doesn&apos;t work for mobile browsers.&lt;br/&gt;
on android the notify() is never called.. because somehow there onerror is not called so wicket still thinks it is busy with a request that never ends. and is stuck for always..&lt;/p&gt;

&lt;p&gt;i tried also to add img.onload = function()&lt;/p&gt;
{notify()}

&lt;p&gt;and hoped that maybe on some browsers the onload is then triggered, but this is also not the case.&lt;/p&gt;</comment>
                            <comment id="13162775" author="mgrigorov" created="Mon, 5 Dec 2011 13:37:50 +0000"  >&lt;p&gt;Until now IE was the problematic browser but this is strange.&lt;/p&gt;

&lt;p&gt;Here is a hacky solution until there is a better one:&lt;br/&gt;
if (Wicket.Browser.isMobile()) &lt;/p&gt;
{ notify(); }

&lt;p&gt;You&apos;ll have to add impl for .isMobile().&lt;br/&gt;
Where are these people who claim that sniffing the user agent is bad. I want to see a feature detection mechanism for this. WebKit for desktops works and WebKit for mobiles doesn&apos;t...&lt;/p&gt;</comment>
                            <comment id="13162804" author="jcompagner" created="Mon, 5 Dec 2011 14:28:05 +0000"  >&lt;p&gt;i found the problem:&lt;br/&gt;
instead of doing this:&lt;/p&gt;

&lt;p&gt;			var img = document.createElement(&apos;img&apos;);&lt;br/&gt;
			img.onerror = function() &lt;/p&gt;
{
				notify();
			}
&lt;p&gt;			img.src = css.href;&lt;/p&gt;

&lt;p&gt;i do now this:&lt;/p&gt;

&lt;p&gt;			var img = document.createElement(&apos;img&apos;);&lt;br/&gt;
			img.src = css.href;&lt;br/&gt;
			if (img.complete) &lt;/p&gt;
{
           	          notify();
			}
&lt;p&gt;			else {&lt;br/&gt;
		   	  img.onerror = function() &lt;/p&gt;
{
         		    notify();
       		          }
&lt;p&gt;      		        }&lt;/p&gt;


&lt;p&gt;because i think mobile browsers are really somehow single threaded. when a link is created with a href it will really load that css already (this is not  done in the background somehow)&lt;br/&gt;
and because of that at the time we make the img and assign the href everything is already loaded and the img is directly in a complete stage&lt;/p&gt;

&lt;p&gt;In the desktop browsers it will for me always come in the else, but in the mobile browser it always goes to the if part.&lt;br/&gt;
i did find here some more info:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://lucassmith.name/2008/11/is-my-image-loaded.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://lucassmith.name/2008/11/is-my-image-loaded.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We do already large parts what is explained there, except the part of testing &apos;complete&apos; &lt;/p&gt;</comment>
                            <comment id="13162809" author="mgrigorov" created="Mon, 5 Dec 2011 14:40:51 +0000"  >&lt;p&gt;Looks better than Wicket.Browser.isMobile() !&lt;br/&gt;
Apply it.&lt;/p&gt;</comment>
                            <comment id="13172349" author="jcompagner" created="Mon, 19 Dec 2011 15:38:50 +0000"  >&lt;p&gt;i see that this original patch is tested in IE7 or IE8 ?&lt;br/&gt;
but onerror doesn&apos;t work...&lt;/p&gt;

&lt;p&gt;just go to this:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.w3schools.com/xml/tryit.asp?filename=cd_catalog_island&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.w3schools.com/xml/tryit.asp?filename=cd_catalog_island&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;paste in this code:&lt;/p&gt;

&lt;p&gt;&amp;lt;html&amp;gt;&lt;br/&gt;
&amp;lt;head&amp;gt;&lt;br/&gt;
&amp;lt;script&amp;gt;&lt;br/&gt;
function test() {&lt;br/&gt;
var img = document.createElement(&apos;img&apos;);&lt;br/&gt;
img.src = &apos;/tryit.css&apos;;&lt;br/&gt;
if (img.complete) {&lt;br/&gt;
alert(&apos;complete&apos;);&lt;br/&gt;
}&lt;br/&gt;
else {&lt;br/&gt;
img.onerror = function() {&lt;br/&gt;
alert(&apos;onerror&apos;);&lt;br/&gt;
}&lt;br/&gt;
img.onload = function() {&lt;br/&gt;
alert(&apos;onload&apos;);&lt;br/&gt;
}&lt;br/&gt;
}&lt;br/&gt;
}&lt;br/&gt;
&amp;lt;/script&amp;gt;&lt;br/&gt;
&amp;lt;/head&amp;gt;&lt;br/&gt;
&amp;lt;body&amp;gt;&lt;br/&gt;
&amp;lt;button onclick=&quot;test()&quot;&amp;gt;test&amp;lt;/button&amp;gt;&lt;br/&gt;
&amp;lt;/body&amp;gt;&lt;br/&gt;
&amp;lt;/html&amp;gt;&lt;/p&gt;

&lt;p&gt;and you will see that in IE7 or IE8 nothing is alerted..&lt;/p&gt;

&lt;p&gt;So this is patch is currently still a major problem...&lt;/p&gt;</comment>
                            <comment id="13172354" author="jcompagner" created="Mon, 19 Dec 2011 15:48:17 +0000"  >&lt;p&gt;i think i found a solution that works:&lt;/p&gt;

&lt;p&gt;			var img = document.createElement(&apos;img&apos;);&lt;br/&gt;
			var notifyCalled = false;&lt;br/&gt;
		   	img.onerror = function() {&lt;br/&gt;
		   	    if (!notifyCalled) &lt;/p&gt;
{
		   	    	notifyCalled = true;
         			notify();
         		}&lt;br/&gt;
			}&lt;br/&gt;
			img.src = css.href;&lt;br/&gt;
			if (img.complete) {&lt;br/&gt;
		   	    if (!notifyCalled) {		   	    	notifyCalled = true;         			notify();         		}
&lt;p&gt;      		}&lt;/p&gt;
</comment>
                            <comment id="13174853" author="mgrigorov" created="Thu, 22 Dec 2011 15:47:01 +0000"  >&lt;p&gt;Is the current solution good enough or we still want to use third party .js library for this ?&lt;/p&gt;</comment>
                            <comment id="13214531" author="mgrigorov" created="Thu, 23 Feb 2012 10:29:06 +0000"  >&lt;p&gt;An third party JavaScript library wont be used for now.&lt;br/&gt;
We implemented our custom logic that seems to handle OK this problem.&lt;br/&gt;
It is in use since a several versions of 1.4.x and 1.5.x already.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12500423" name="WICKET-3927-backport-mgrigorov.patch" size="943" author="lankvelt" created="Mon, 24 Oct 2011 10:33:44 +0000"/>
                            <attachment id="12487293" name="WICKET-3927-quickstart.tar.gz" size="3711" author="jbloemendal" created="Thu, 21 Jul 2011 12:36:43 +0000"/>
                            <attachment id="12487295" name="WICKET-3927.patch" size="19681" author="jbloemendal" created="Thu, 21 Jul 2011 12:41:01 +0000"/>
                            <attachment id="12488075" name="WICKET-3927_2.patch" size="14720" author="jbloemendal" created="Thu, 28 Jul 2011 09:07:40 +0000"/>
                            <attachment id="12506116" name="wicket-3927-with-complete-check.patch" size="893" author="jcompagner" created="Mon, 5 Dec 2011 14:29:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2602</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 39 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1gfxr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>304175</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>