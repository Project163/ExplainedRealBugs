<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:19:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4000] Header contributions order is not stable</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4000</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;In the last RCs, I started to experience problems with the contributions order.&lt;br/&gt;
For example, I add jQuery, and until 1.5RC5, it worked well, but now the call to the jQuery script has been moved to the bottom of the page head, and this disables all my other scripts that are expecting jQuery&apos;s $ to be defined.&lt;/p&gt;

&lt;p&gt;I attach a quickstart to demonstrate the problem.&lt;br/&gt;
Maybe the order in the quickstart is not the expected one, but what it shows is that the order does not make real sense (at least to me) :&lt;br/&gt;
In the quickstart, the wicket:head tag contributions are in the order 3 - 8 - 9 - 5, and the renderHead methods contributions are in the order 4 - 1 - 2 - 6 - 7.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12520497">WICKET-4000</key>
            <summary>Header contributions order is not stable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="svieujot">Sylvain Vieujot</reporter>
                        <labels>
                    </labels>
                <created>Sun, 28 Aug 2011 23:17:02 +0000</created>
                <updated>Wed, 21 Dec 2011 15:17:42 +0000</updated>
                            <resolved>Wed, 21 Dec 2011 15:17:42 +0000</resolved>
                                    <version>1.5-RC6</version>
                                    <fixVersion>6.0.0-beta1</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13092746" author="mgrigorov" created="Mon, 29 Aug 2011 10:18:25 +0000"  >&lt;p&gt;Running the quickstart with trunk and RC5.1 produces the same sequences: 3, 8, 9, 5, 4, 1, 2, 6, 7.&lt;br/&gt;
And according to org.apache.wicket.markup.renderStrategy.ChildFirstHeaderRenderStrategy this is correct.&lt;/p&gt;</comment>
                            <comment id="13092759" author="mgrigorov" created="Mon, 29 Aug 2011 10:58:48 +0000"  >&lt;p&gt;Actually it seems in both versions wicket:head may play wrong.&lt;br/&gt;
ChildFirstHeaderRenderStrategy says that components&apos; contributions are rendered before page&apos;s contributions. So it seems script 5 must be rendered first, not fourth.&lt;/p&gt;</comment>
                            <comment id="13092761" author="svieujot" created="Mon, 29 Aug 2011 11:03:45 +0000"  >&lt;p&gt;Ok. I understand the advantage of being able to have a child replace a parent contribution, but I wouldn&apos;t it be possible to keep an intuitive order, and to still have the last contribution replace the previous ones inplace ?&lt;/p&gt;

&lt;p&gt;Also here the logic is not followed completely as the Application contributions are rendered first anyway.&lt;/p&gt;

&lt;p&gt;Last, what I see is that the &amp;lt;wicket:head&amp;gt; is rendered before the code contributions of the renderHead method.&lt;br/&gt;
I would suggest to invert this, as usually I guess you would use the renderHead to include more general code / libraries, and then the &amp;lt;wicket:head&amp;gt; to include more specific code, most likely using the libraries contributed by the renderHead method.&lt;/p&gt;</comment>
                            <comment id="13092768" author="mgrigorov" created="Mon, 29 Aug 2011 11:17:02 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3761&quot; title=&quot;unexpected order of head contributions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3761&quot;&gt;&lt;del&gt;WICKET-3761&lt;/del&gt;&lt;/a&gt; for the reasons.&lt;/p&gt;</comment>
                            <comment id="13092769" author="svieujot" created="Mon, 29 Aug 2011 11:18:44 +0000"  >&lt;p&gt;It looks to me that the above suggestion (contribution order identical to wicket 1.4, but still allowed contributions code override from children) can be implemented by adding a kind of buffer in HeaderResponse, and flushing it once all the headerContributions are done.&lt;/p&gt;

&lt;p&gt;It would seem to me a much more user friendly approach, whilst keeping the advantage of being able to override previous contributions.&lt;br/&gt;
At least, when I look at my webapps, the current wicket 1.5 contributions order gives me headaches.&lt;/p&gt;

&lt;p&gt;What do you think ?&lt;/p&gt;</comment>
                            <comment id="13092771" author="mgrigorov" created="Mon, 29 Aug 2011 11:24:02 +0000"  >&lt;p&gt;This buffering is possible with ResponseHeaderDecorator. See &lt;a href=&quot;http://www.wicket-library.com/wicket-examples/resourceaggregation&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.wicket-library.com/wicket-examples/resourceaggregation&lt;/a&gt; for example.&lt;br/&gt;
But I think this example doesn&apos;t use wicket:head.&lt;/p&gt;</comment>
                            <comment id="13093774" author="mgrigorov" created="Tue, 30 Aug 2011 14:33:43 +0000"  >&lt;p&gt;What we are going to do here ?&lt;br/&gt;
The order is the same as in previous RCs of 1.5 (after &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3761&quot; title=&quot;unexpected order of head contributions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3761&quot;&gt;&lt;del&gt;WICKET-3761&lt;/del&gt;&lt;/a&gt;).&lt;br/&gt;
Reordering is possible with custom IHeaderResponseDecorator. See org.apache.wicket.resource.aggregation.AbstractResourceAggregatingHeaderResponse.&lt;/p&gt;</comment>
                            <comment id="13093822" author="ivaynberg" created="Tue, 30 Aug 2011 15:29:58 +0000"  >&lt;p&gt;imho its too late to tweak this. save it for wicket.next&lt;/p&gt;</comment>
                            <comment id="13094146" author="svieujot" created="Tue, 30 Aug 2011 22:02:06 +0000"  >&lt;p&gt;I don&apos;t think we should postpone this for 1.6.&lt;br/&gt;
Indeed, 1.5 is changing the default order, and I think this might lead to some breaks in the webapps that are hard to track.&lt;br/&gt;
For example, when it breaks the javascript ordering, no compilation warning is going to alert the developers, and only a careful integration testing can detect this. I think webapps using wiquery might suffer from this new ordering (my webapps at least failed).&lt;/p&gt;

&lt;p&gt;Furthermore, changing the order in 1.5 whilst knowing that we might revert back to the 1.4 order in 1.6 does not seem right to me.&lt;br/&gt;
I would suggest trying to fix this asap, and I am ready to start a patch if you think I am on the right track (It would be my first wicket hack, so don&apos;t expect miracles ...).&lt;/p&gt;</comment>
                            <comment id="13094391" author="mgrigorov" created="Wed, 31 Aug 2011 09:04:22 +0000"  >&lt;p&gt;The order from 1.4 is still possible. See org.apache.wicket.markup.renderStrategy.AbstractHeaderRenderStrategy.get().&lt;br/&gt;
For Wicket.next we will consider making it easier for the application developer to specify the contribution order. But I can see how this can be problematic for component libraries.&lt;/p&gt;

&lt;p&gt;With the current approach (child first) the components contribute their js/css and the page can override them. This is also what you are trying to so, right ?&lt;/p&gt;</comment>
                            <comment id="13094426" author="svieujot" created="Wed, 31 Aug 2011 11:05:37 +0000"  >&lt;p&gt;In fact, I am not too much concerned about the override capability. It might be an advantage, but I do not use it or see any use case for this in my applications.&lt;/p&gt;

&lt;p&gt;Here are 2 simple scenari that fail with me and that would seem quite an intuitive way to use wicket :&lt;/p&gt;

&lt;p&gt;1) You use jQuery in part of the public pages of your website. so it makes sense to add the jQuery contribution in the PublicBasePage.&lt;br/&gt;
But as the PublicBasePage contributions come after the children ones, any Panel using jQuery will fail as jQuery will not be loaded yet.&lt;/p&gt;

&lt;p&gt;2) Again you want to use jQuery in a page. It makes more sense to put the contribution in the renderHead than in the wicket:head as it is more type safe.&lt;br/&gt;
Also, in renderHead, you can use Wiquery&apos;s response.renderJavaScriptReference( CoreJavaScriptResourceReference.get() );&lt;br/&gt;
In the page, you want to add a custom jquery one liner. It is then much easier to put this one liner in the wicket:head as it will be in the same html, and much less verbose than doing this in the renderHead.&lt;br/&gt;
But again this fails, as currently the default is to have first the wicket:head contributions, and later the renderHead.&lt;/p&gt;

&lt;p&gt;I understood that you can re-write your own strategy (even if I am not sure that the wicket:head / renderHead order can be altered), but I am quite reluctant to do so, as this means you might have a component library that can work only with some specific webapps.&lt;br/&gt;
Also, those problems are quite nasty, as you do not detect them on compilation.&lt;/p&gt;

&lt;p&gt;That&apos;s why I would suggest :&lt;br/&gt;
1) To have 2 renderHead methods renderHeadBeforeMarkup &amp;amp; renderHeadAfterMarkup (or whatever better name).&lt;br/&gt;
At least this make the component libraries completely safe and the coding intuitive.&lt;/p&gt;

&lt;p&gt;2) To use the former wicket 1.4 default order which is much more intuitive (and which will have the advantage to limit the breakage in the legacy applications).&lt;br/&gt;
This is also in line with the java code where the base class constructor is always called before the sub class one (hence the order assumed in my quickstart which would be the natural one for someone not delving into wicket&apos;s code).&lt;br/&gt;
The implementation would require implementing a buffer in the HeaderResponse to allow the override of parent contributions by the children (if this is a useful feature - frankly I am not sure).&lt;br/&gt;
I guess that would also require an additional method (like header.flush) that would be called in the renderCycle.&lt;/p&gt;

&lt;p&gt;With those changes, it would also remove the need to have a configurable renderStrategy.&lt;/p&gt;</comment>
                            <comment id="13094441" author="mgrigorov" created="Wed, 31 Aug 2011 11:43:13 +0000"  >&lt;p&gt;I see you are confused.&lt;/p&gt;

&lt;p&gt;If a component depends on JS library then the component should add a reference for it. It should not expect that the page that uses this component will provide it. The component can implement means to switch off the contribution or to override the ResourceReference if it wants, so it will be possible to use different version of the JS library.&lt;/p&gt;

&lt;p&gt;The page contribution should come after the components so that even if the component library doesn&apos;t provide ways to switch off/replace the contribution then the page can still override it. This is more valid for CSS contributions and less for JS ones.&lt;br/&gt;
As final resort Wicket provides IHeaderResponseDecorator hook so you are able to suppress any ResourceReference you want.&lt;/p&gt;

&lt;p&gt;Additionally there are Application scoped IHeaderContributor&apos;s which will render their CSS/JS for all pages and always before the pages/components.&lt;/p&gt;

&lt;p&gt;The only difference between 1.4 and 1.5 if that components now contribute before the page. That&apos;s all. There are no differences in wicket:head vs. renderHead() order.&lt;br/&gt;
Additionally there is no sense to use wicket:head in the base Page. It is for Panels and Borders and inherited Pages. In the base page you can (and should) use &amp;lt;head&amp;gt;.&lt;/p&gt;

&lt;p&gt;About Java constructors: it is the same in Wicket.&lt;br/&gt;
wicket:head order in the quickstart: 3 (BasePage.html) and then 8, 9 (HomePage.html)&lt;br/&gt;
renderHead order: 1, 2 (BasePage.java) and then 6, 7 (HomePage.java)&lt;/p&gt;

&lt;p&gt;As I said earlier the only one that looks out of order is the Panel contribution. I expect 5 (Header.html) and 4 (Header.java) to be the first two in the line, not in the middle as now. &lt;/p&gt;

&lt;p&gt;1.5.0 is already voted so it is not possible to shuffle them more for 1.5.x thus the ticket is moved to 1.6.x.&lt;/p&gt;</comment>
                            <comment id="13094966" author="svieujot" created="Wed, 31 Aug 2011 22:36:03 +0000"  >&lt;p&gt;Then I think my problem boils down to &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3761&quot; title=&quot;unexpected order of head contributions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3761&quot;&gt;&lt;del&gt;WICKET-3761&lt;/del&gt;&lt;/a&gt; .&lt;br/&gt;
I want to contribute jQuery via a renderHead method, or via the Applications&apos;s HeaderContributors, and currently this means that the jquery library will never be available to any code in a wicket:head.&lt;/p&gt;

&lt;p&gt;This is the same as Igor mentioned here : &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3761?focusedCommentId=13044321&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044321&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/WICKET-3761?focusedCommentId=13044321&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044321&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Do I have a solution for this ?&lt;br/&gt;
The only one I see now is to avoid using wicket:head, and use a &amp;lt;script&amp;gt; tag in the &amp;lt;body&amp;gt; instead.&lt;/p&gt;

&lt;p&gt;Thank you.&lt;/p&gt;</comment>
                            <comment id="13095001" author="ivaynberg" created="Wed, 31 Aug 2011 23:46:33 +0000"  >&lt;p&gt;we should consider reverting &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3761&quot; title=&quot;unexpected order of head contributions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3761&quot;&gt;&lt;del&gt;WICKET-3761&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13095019" author="svieujot" created="Thu, 1 Sep 2011 00:15:13 +0000"  >&lt;p&gt;This would be very helpful !&lt;/p&gt;</comment>
                            <comment id="13096107" author="svieujot" created="Fri, 2 Sep 2011 16:38:26 +0000"  >&lt;p&gt;For information, there was another problem linked to WiQuery (Maybe this issue : &lt;a href=&quot;http://code.google.com/p/wiquery/issues/detail?id=203&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://code.google.com/p/wiquery/issues/detail?id=203&lt;/a&gt; ), and this was inverting the order of some renderHead contributions ... making the all issue even stranger.&lt;br/&gt;
wiquery-jquery-ui 1.5-M4 still has the issue, but switching to wiquery-jquery-ui 1.5-SNAPSHOT resolved this specific issue.&lt;/p&gt;</comment>
                            <comment id="13168312" author="papegaaij" created="Tue, 13 Dec 2011 11:53:06 +0000"  >&lt;p&gt;Reverting &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3761&quot; title=&quot;unexpected order of head contributions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3761&quot;&gt;&lt;del&gt;WICKET-3761&lt;/del&gt;&lt;/a&gt; just inverts the arbitrarily chosen order and breaks applications that depend on this order. The major issue is that wicket:head is rendered by a different code path than other header contributions. wicket:head should be rendered by IHeaderResponse, making it possible to change the order using rendering strategies or a HeaderResponseDecorator. The default order should stay as it is right now as both orders are equally valid. I&apos;m willing to take this issue after I&apos;m finished with &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-4273&quot; title=&quot;Rendering of resources in the header with dependency resolving and support for bundles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-4273&quot;&gt;&lt;del&gt;WICKET-4273&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13172999" author="papegaaij" created="Tue, 20 Dec 2011 07:30:32 +0000"  >&lt;p&gt;With this patch, all header rendering is done by IHeaderResponse from within the HeaderRenderStrategy. Some tests are failing now, because the order changed, but I think the order defined in these testcases is wrong.&lt;/p&gt;</comment>
                            <comment id="13173424" author="papegaaij" created="Tue, 20 Dec 2011 19:01:06 +0000"  >&lt;p&gt;Final version of the patch&lt;/p&gt;</comment>
                            <comment id="13174137" author="mgrigorov" created="Wed, 21 Dec 2011 15:17:42 +0000"  >&lt;p&gt;Fixed in 6.0.x.&lt;br/&gt;
The only difference is that wicket:head contributes before same component&apos;s #renderHead(). This way the dynamic code can override the static code &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12509027">WICKET-3761</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12508116" name="0001-WICKET-4000-render-all-headers-through-IHeaderRespon.patch" size="67372" author="papegaaij" created="Tue, 20 Dec 2011 19:01:06 +0000"/>
                            <attachment id="12492019" name="quickstart-scriptsOrder.zip" size="12009" author="svieujot" created="Sun, 28 Aug 2011 23:17:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2562</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 48 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0k9jb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116362</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>