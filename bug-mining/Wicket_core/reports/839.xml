<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:21:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-5142] Generating invalid JavaScript for ajax update</title>
                <link>https://issues.apache.org/jira/browse/WICKET-5142</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Suppose I have BlinkBehaviour &lt;/p&gt;

&lt;p&gt;public static class BlinkBehaviour extends Behavior { &lt;br/&gt;
        @Override &lt;br/&gt;
        public void renderHead(Component component, IHeaderResponse response) { &lt;br/&gt;
            AjaxRequestTarget target = component.getRequestCycle().find(AjaxRequestTarget.class); &lt;br/&gt;
            if (target != null) &lt;/p&gt;
{ 
                target.prependJavaScript(&quot;notify|jQuery(&apos;#&quot; + component.getMarkupId() + &quot;&apos;).fadeOut(400, notify);&quot;); 
                target.appendJavaScript(&quot;jQuery(&apos;#&quot;+component.getMarkupId()+&quot;&apos;).fadeIn(400);&quot;); 
            }
&lt;p&gt; &lt;br/&gt;
        } &lt;br/&gt;
    } &lt;/p&gt;

&lt;p&gt;If I add it twice to a control and update the control via ajax 6.7.0-SNAPSHOT will yield error: &lt;/p&gt;

&lt;p&gt;ERROR: Wicket.Ajax.Call.processEvaluation: Exception evaluating javascript: SyntaxError: Unexpected token ), text: f = function(notify) &lt;/p&gt;
{jQuery(&apos;#version2&apos;).fadeOut(400, notify);}
&lt;p&gt;)();(function()&lt;/p&gt;
{notify|jQuery(&apos;#version2&apos;).fadeOut(400, notify);}
&lt;p&gt;;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12642210">WICKET-5142</key>
            <summary>Generating invalid JavaScript for ajax update</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="amukas">Alexey Mukas</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Apr 2013 08:45:07 +0000</created>
                <updated>Mon, 22 Apr 2013 11:49:22 +0000</updated>
                            <resolved>Mon, 22 Apr 2013 11:49:22 +0000</resolved>
                                                    <fixVersion>6.8.0</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13629974" author="mgrigorov" created="Fri, 12 Apr 2013 10:26:10 +0000"  >&lt;p&gt;This is more trickier than it seems.&lt;br/&gt;
The problem at the moment is the Regex that we use to detect that a manual execution of &apos;notify&apos; is needed. But the deeper problem is that the user code has two executions of &apos;notify&apos;, i.e. the first execution will release FunctionsExecutor to proceed with the following steps.&lt;/p&gt;

&lt;p&gt;The solution that I see is to split the combined JavaScript into parts again. For example:&lt;/p&gt;

&lt;p&gt;combined: (function()&lt;/p&gt;
{notify|jQuery(&apos;#version4&apos;).fadeOut(400, notify);})();(function(){notify|jQuery(&apos;#version4&apos;).fadeOut(400, notify);}
&lt;p&gt;)();&lt;br/&gt;
to:&lt;br/&gt;
1) (function()&lt;/p&gt;
{notify|jQuery(&apos;#version4&apos;).fadeOut(400, notify);})();&lt;br/&gt;
2) (function(){notify|jQuery(&apos;#version4&apos;).fadeOut(400, notify);}
&lt;p&gt;)();&lt;/p&gt;

&lt;p&gt;and then execute them one by one, so they wait for each other.&lt;/p&gt;</comment>
                            <comment id="13629978" author="amukas" created="Fri, 12 Apr 2013 10:36:31 +0000"  >&lt;p&gt;Looks good&lt;/p&gt;</comment>
                            <comment id="13629998" author="mgrigorov" created="Fri, 12 Apr 2013 11:27:44 +0000"  >&lt;p&gt;I&apos;m not quite sure.&lt;br/&gt;
Splitting will lead to bad performance, especially on IE.&lt;br/&gt;
The best is to chain the JS snippets and call Wicket&apos;s notify() (the callback passed by Wicket) at the end.&lt;br/&gt;
For example the perfect JS should look like:&lt;/p&gt;

&lt;p&gt;(function(){notify|jQuery(&apos;#version4&apos;).fadeOut(400, function()&lt;/p&gt;
{
   jQuery(&apos;#version4&apos;).fadeOut(400, notify);
})}
&lt;p&gt;)();&lt;/p&gt;

&lt;p&gt;But it will be hard to compose this at the client side.&lt;/p&gt;</comment>
                            <comment id="13637939" author="mgrigorov" created="Mon, 22 Apr 2013 11:49:22 +0000"  >&lt;p&gt;Improved the code by splitting the text with all-functions-in-one in &amp;lt;evaluate&amp;gt; element to separate functions which are executed one by one and each of them can execute &apos;notify&apos; manually.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12578400" name="myproject.zip" size="35116" author="amukas" created="Fri, 12 Apr 2013 08:45:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>322624</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 30 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1jnwv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>322969</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>