<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:20:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4645] encodeURL broken on Tomcat 7.0.28</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4645</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;During page transition wicket used to encode an &apos;../../tisch&apos; which results in an exception:&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.IllegalArgumentException&lt;br/&gt;
	at org.apache.catalina.connector.Response.normalize(Response.java:1799)&lt;/p&gt;

&lt;p&gt;The transition (within an ajax call) :&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8080/wicket/bookmarkable/de.test.pool.manage.ManagePool?11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/wicket/bookmarkable/de.test.pool.manage.ManagePool?11&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://localhost:8080/tisch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/tisch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;IMHO the double parent &quot;..&quot; is correct&lt;/p&gt;

&lt;p&gt;There exists already an bugzilla issue created but rejected as invalid &lt;a href=&quot;https://issues.apache.org/bugzilla/show_bug.cgi?id=53469&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://issues.apache.org/bugzilla/show_bug.cgi?id=53469&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If the wicket code works as expected there must be an error in the tomcat. &lt;br/&gt;
Maybe the wicket development team has closer access to the tomcat developers &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12598022">WICKET-4645</key>
            <summary>encodeURL broken on Tomcat 7.0.28</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="mcbain4711">Jens Zastrow</reporter>
                        <labels>
                    </labels>
                <created>Mon, 9 Jul 2012 12:00:53 +0000</created>
                <updated>Sat, 15 Oct 2016 18:56:59 +0000</updated>
                            <resolved>Tue, 28 Aug 2012 15:19:04 +0000</resolved>
                                    <version>6.0.0-beta2</version>
                                    <fixVersion>6.1.0</fixVersion>
                    <fixVersion>1.5.9</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                                                            <comments>
                            <comment id="13409373" author="mgrigorov" created="Mon, 9 Jul 2012 12:11:22 +0000"  >&lt;p&gt;Actually, I was the one who requested this normalization in Tomcat.&lt;br/&gt;
Let&apos;s see whether we can convince the Tomcat devs that the urls above are OK.&lt;/p&gt;</comment>
                            <comment id="13409400" author="thyzz" created="Mon, 9 Jul 2012 12:49:51 +0000"  >&lt;p&gt;Hi Martin,&lt;br/&gt;
I was the one who filed the issue at tomcat.&lt;br/&gt;
I&apos;ll try to create a small test case. And attach it to this and the bugzilla ticket. and here&lt;/p&gt;</comment>
                            <comment id="13409405" author="mgrigorov" created="Mon, 9 Jul 2012 12:54:15 +0000"  >&lt;p&gt;As Mark Thomas described in Tomcat&apos;s Bugzilla he added unit tests for this and they pass.&lt;br/&gt;
Please create a demo app that demonstrates the problem and attach it to their Bugzilla.&lt;/p&gt;

&lt;p&gt;Additionally: the URLs you pasted in this ticket are generated by Wicket 1.4, not by Wicket 6.&lt;/p&gt;</comment>
                            <comment id="13409409" author="thyzz" created="Mon, 9 Jul 2012 12:59:41 +0000"  >&lt;p&gt;This is with wicket 1.4.20 as we are still using that version&lt;br/&gt;
install this on tomcat 7.0.28&lt;br/&gt;
hit it with &lt;a href=&quot;http://localhost:8080/test-1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/test-1&lt;/a&gt;, click the link and everything works&lt;br/&gt;
do the same with &lt;a href=&quot;http://localhost:8080/test-1/testpage/param1/value1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/test-1/testpage/param1/value1&lt;/a&gt;, then click the link and check you&apos;re tomcat log...&lt;/p&gt;</comment>
                            <comment id="13409443" author="mcbain4711" created="Mon, 9 Jul 2012 13:23:37 +0000"  >&lt;p&gt;Have&apos;nt used the version 1.4.x for month.... &lt;/p&gt;

&lt;p&gt;org.apache.wicket.protocol.http.WebApplication &lt;span class=&quot;error&quot;&gt;&amp;#91;wicket&amp;#93;&lt;/span&gt; Started Wicket version 6.0.0-beta2 in DEVELOPMENT mode&lt;/p&gt;</comment>
                            <comment id="13409454" author="mgrigorov" created="Mon, 9 Jul 2012 13:37:05 +0000"  >&lt;p&gt;@Jens:&lt;br/&gt;
From the ticket in Tomcat:&lt;br/&gt;
&quot;The URL that is being encoded is:&lt;br/&gt;
../../resources/org.apache.wicket.markup.html.WicketEventReference/wicket-event.js?w:lm=1340711670&quot;&lt;/p&gt;

&lt;p&gt;1) &apos;resources&apos; is a the special path for Wicket resources in 1.4. &lt;br/&gt;
In 1.5+ it is wicket/resource/...&lt;/p&gt;

&lt;p&gt;2) In Wicket 6 there is no wicket-event.js&lt;br/&gt;
There is wicket-event-jquery.js now.&lt;/p&gt;


&lt;p&gt;@Both: You see this is an issue with Tomcat, not Wicket one.&lt;br/&gt;
As you see Mark Thomas is responsive. Just follow up with him in Tomcat&apos;s issue tracker.&lt;/p&gt;</comment>
                            <comment id="13409674" author="thyzz" created="Mon, 9 Jul 2012 17:45:05 +0000"  >&lt;p&gt;Ok so Mark points back to Wicket.&lt;br/&gt;
I know 1.4.x is probably eol as soon as Wicket 6 hits the floor (or maybe it even already is).&lt;br/&gt;
 But is there a chance you could have a look. Or point me to the location where I should start digging?&lt;/p&gt;</comment>
                            <comment id="13410085" author="mgrigorov" created="Tue, 10 Jul 2012 06:25:12 +0000"  >&lt;p&gt;1.4.x branch is closed. Only security related fixes go in.&lt;br/&gt;
Look in the URL coding strategy that is in use.&lt;/p&gt;

&lt;p&gt;Or just use Tomcat 7.0.27 until you upgrade to Wicket 6.&lt;/p&gt;</comment>
                            <comment id="13423566" author="pedrosans" created="Thu, 26 Jul 2012 23:53:56 +0000"  >&lt;p&gt;quickstart simulating the issue with Wicket 6&lt;/p&gt;</comment>
                            <comment id="13442334" author="mgrigorov" created="Mon, 27 Aug 2012 08:50:11 +0000"  >&lt;p&gt;REDIRECT_TO_BUFFER (the default strategy) is broken with the new checks in Tomcat if your application needs to encode jsessionid in the url instead of using a cookie.&lt;br/&gt;
Use REDIRECT_TO_RENDER until there is a solution.&lt;/p&gt;

&lt;p&gt;MyApp#init() {&lt;br/&gt;
   ...&lt;br/&gt;
   getRequestCycleSettings().setRenderStrategy(IRequestCycleSettings.RenderStrategy.REDIRECT_TO_RENDER)&lt;br/&gt;
}&lt;/p&gt;</comment>
                            <comment id="13442433" author="mgrigorov" created="Mon, 27 Aug 2012 14:22:16 +0000"  >&lt;p&gt;Fixed by making the url absolute before passing it to the web container.&lt;/p&gt;</comment>
                            <comment id="13442485" author="mgrigorov" created="Mon, 27 Aug 2012 15:54:08 +0000"  >&lt;p&gt;Some more testing needs to be done here. UrlRenderer&apos;s baseUrl miss the contextPath and filterPath and this makes the resolved relative url invalid. &lt;/p&gt;</comment>
                            <comment id="13489620" author="zeratul" created="Fri, 2 Nov 2012 18:17:40 +0000"  >&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I&apos;ve attached test file with added unit test that fails due to a change to UrlRenderer in commit dda3eea1911dab0b58846221ae22bf795a03fd12&lt;/p&gt;

&lt;p&gt;Now resource URL get their context and filter paths stripped and replaced with &quot;./&quot; - this leads to URL&apos;s being out of sync with actual resource locations in portal (portlet container).&lt;/p&gt;</comment>
                            <comment id="13490493" author="mgrigorov" created="Mon, 5 Nov 2012 07:56:03 +0000"  >&lt;p&gt;The produced result looks correct to me:&lt;/p&gt;

&lt;p&gt;base url: /my-portlets/my-app/configuration-page&lt;br/&gt;
input: /my-portlets/my-app/wicket/resource/com.foo.bar.portlets.Anchor/res/Style-ver-1352751065000.css&lt;br/&gt;
output: ./wicket/resource/com.foo.bar.portlets.Anchor/res/Style-ver-1352751065000.css&lt;br/&gt;
used method: renderer.renderRelativeUrl(input);&lt;/p&gt;

&lt;p&gt;You ask for relative Url and Wicket produces a correct (I think) relative url.&lt;/p&gt;

&lt;p&gt;Here is the code that would produce what you need:&lt;br/&gt;
String encodedFullUrlString = &quot;/my-portlets/my-app/wicket/resource/com.foo.bar.portlets.Anchor/res/Style-ver-1352751065000.css&quot;;&lt;br/&gt;
        Url baseUrl = Url.parse(&quot;/my-portlets/my-app/configuration-page&quot;);&lt;br/&gt;
        Url encodedFullUrl = Url.parse(encodedFullUrlString);&lt;br/&gt;
	    UrlRenderer renderer = new UrlRenderer(new MockWebRequest(baseUrl));&lt;br/&gt;
        String mangledUrl = renderer.renderFullUrl(encodedFullUrl);&lt;br/&gt;
	    System.err.println(Url.parse(mangledUrl).toString(Url.StringMode.LOCAL));&lt;/p&gt;</comment>
                            <comment id="13490685" author="zeratul" created="Mon, 5 Nov 2012 15:24:29 +0000"  >&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I agree that I get what I ask for with renderRelativeUrl, let me be more specific:&lt;/p&gt;

&lt;p&gt;I create JavascriptReferenceHeaderItem. In it&apos;s render method it calls private getUrl(), which calls RequectCycle.get().urlFor(). In that method I get correct mappedUrl. Then it&apos;s passed to private renderUrl() which calls UrlRenderer&apos;s renderUrl() and as the condition shouldRenderAsFull() return false - it is rendered as relative.&lt;/p&gt;

&lt;p&gt;shouldRenderAsFull() tests protocol, host and port. Neither of that is in my resource mappedUrl, it looks like &quot;/my-portlets/my-app/wicket/resource/com.foo.bar.portlets.Anchor/res/Style-ver-1352751065000.css&quot;.&lt;/p&gt;

&lt;p&gt;For now I override render method and provide custom URL but I think we should try to reintroduce this back to Wicket core. Possibly find a spot in UrlRenderer where the removed condition ... return isAbsolute() ? mappedUrl.toString() :... (e.g. UrlRenderer#137) can be reinserted to allow absolute URLs without schema/host/port.&lt;/p&gt;

&lt;p&gt;Best regards&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12617470">WICKET-4882</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12551898" name="UrlRendererTest.java" size="13270" author="zeratul" created="Fri, 2 Nov 2012 18:17:40 +0000"/>
                            <attachment id="12535664" name="test.zip" size="10587" author="thyzz" created="Mon, 9 Jul 2012 12:59:41 +0000"/>
                            <attachment id="12538095" name="wicket-4645.zip" size="5083" author="pedrosans" created="Thu, 26 Jul 2012 23:53:56 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12614755">WICKET-4854</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>252565</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 2 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0cuu7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72940</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>