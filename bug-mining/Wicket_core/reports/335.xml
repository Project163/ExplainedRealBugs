<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:18:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-3869] ResponseIOException when ajax response contains resource reference</title>
                <link>https://issues.apache.org/jira/browse/WICKET-3869</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;When ajax response (show modal window) contains shared image response, server log reports ResponseIOException.&lt;/p&gt;

&lt;p&gt;See attached example application. Using maven, type mvn package jetty:run. Open &lt;a href=&quot;http://localhost/8080/iwicket/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost/8080/iwicket/&lt;/a&gt; in Internet Explorer, click the link, watch server log (may need to open/close modal window a few times, but usually appears on first attempt). &lt;/p&gt;</description>
                <environment>Internet Explorer</environment>
        <key id="12512742">WICKET-3869</key>
            <summary>ResponseIOException when ajax response contains resource reference</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sodasmile">Sodasmile</reporter>
                        <labels>
                            <label>ResponseIOException</label>
                            <label>explorer</label>
                            <label>internet</label>
                    </labels>
                <created>Mon, 4 Jul 2011 20:38:35 +0000</created>
                <updated>Tue, 7 Oct 2014 05:43:34 +0000</updated>
                                            <version>1.5-RC5.1</version>
                                    <fixVersion>1.5-RC6</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>12</votes>
                                    <watches>21</watches>
                                                                                                                <comments>
                            <comment id="13059605" author="sodasmile" created="Mon, 4 Jul 2011 20:40:22 +0000"  >&lt;p&gt;Example application&lt;/p&gt;</comment>
                            <comment id="13059606" author="sodasmile" created="Mon, 4 Jul 2011 20:41:02 +0000"  >&lt;p&gt;Stacktrace:&lt;/p&gt;


&lt;p&gt;ERROR - DefaultExceptionMapper     - Connection lost, give up responding.&lt;br/&gt;
org.apache.wicket.protocol.http.servlet.ResponseIOException: org.mortbay.jetty.EofException&lt;br/&gt;
	at org.apache.wicket.protocol.http.servlet.ServletWebResponse.flush(ServletWebResponse.java:271)&lt;br/&gt;
	at org.apache.wicket.protocol.http.HeaderBufferingWebResponse.flush(HeaderBufferingWebResponse.java:92)&lt;br/&gt;
	at org.apache.wicket.request.resource.AbstractResource.setResponseHeaders(AbstractResource.java:528)&lt;br/&gt;
	at org.apache.wicket.request.resource.AbstractResource.respond(AbstractResource.java:436)&lt;br/&gt;
	at org.apache.wicket.request.handler.resource.ResourceRequestHandler.respond(ResourceRequestHandler.java:77)&lt;br/&gt;
	at org.apache.wicket.request.handler.resource.ResourceReferenceRequestHandler.respond(ResourceReferenceRequestHandler.java:92)&lt;br/&gt;
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:717)&lt;br/&gt;
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:63)&lt;br/&gt;
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:212)&lt;br/&gt;
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:253)&lt;br/&gt;
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:160)&lt;br/&gt;
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:216)&lt;br/&gt;
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)&lt;br/&gt;
	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)&lt;br/&gt;
	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)&lt;br/&gt;
	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)&lt;br/&gt;
	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)&lt;br/&gt;
	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)&lt;br/&gt;
	at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)&lt;br/&gt;
	at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)&lt;br/&gt;
	at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)&lt;br/&gt;
	at org.mortbay.jetty.Server.handle(Server.java:326)&lt;br/&gt;
	at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)&lt;br/&gt;
	at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)&lt;br/&gt;
	at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)&lt;br/&gt;
	at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)&lt;br/&gt;
	at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)&lt;br/&gt;
	at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:410)&lt;br/&gt;
	at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)&lt;br/&gt;
Caused by: org.mortbay.jetty.EofException&lt;br/&gt;
	at org.mortbay.jetty.HttpGenerator.flush(HttpGenerator.java:791)&lt;br/&gt;
	at org.mortbay.jetty.HttpConnection.flushResponse(HttpConnection.java:693)&lt;br/&gt;
	at org.mortbay.jetty.Response.flushBuffer(Response.java:958)&lt;br/&gt;
	at org.apache.wicket.protocol.http.servlet.ServletWebResponse.flush(ServletWebResponse.java:267)&lt;br/&gt;
	... 28 more&lt;br/&gt;
Caused by: java.io.IOException: Broken pipe&lt;br/&gt;
	at sun.nio.ch.FileDispatcher.write0(Native Method)&lt;br/&gt;
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:29)&lt;br/&gt;
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:72)&lt;br/&gt;
	at sun.nio.ch.IOUtil.write(IOUtil.java:43)&lt;br/&gt;
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:334)&lt;br/&gt;
	at org.mortbay.io.nio.ChannelEndPoint.flush(ChannelEndPoint.java:170)&lt;br/&gt;
	at org.mortbay.io.nio.SelectChannelEndPoint.flush(SelectChannelEndPoint.java:221)&lt;br/&gt;
	at org.mortbay.jetty.HttpGenerator.flush(HttpGenerator.java:720)&lt;br/&gt;
	... 31 more&lt;/p&gt;</comment>
                            <comment id="13059984" author="sodasmile" created="Tue, 5 Jul 2011 16:21:20 +0000"  >&lt;p&gt;It appears from the Internet Explorer F12 developer tools, network inspector that the image references from the ajax response may be resolved twice? It first makes a request for the image URL, initiated by an &amp;lt;img&amp;gt; element, the request takes &amp;lt; 1ms to complete, with result &quot;(Aborted)&quot;, it then makes another request for the very same image URL, and this time the request completes with 200 OK, and the image is downloaded as expected.&lt;/p&gt;

&lt;p&gt;Can it be the case that the ajax response is transferred back to the browser and the html is evaluated in a different way than earlier, so that Internet Explorer first tries to resolve the images, then gets interrupted, then tries another time when the html is properly attached to the DOM tree??&lt;/p&gt;

&lt;p&gt;We did not see anything like this when the application was running on 1.4&lt;/p&gt;</comment>
                            <comment id="13060542" author="mgrigorov" created="Wed, 6 Jul 2011 12:56:07 +0000"  >&lt;p&gt;Your usage of SharedResourceReference is wrong.&lt;br/&gt;
In your case you need PackageResourceReference.&lt;/p&gt;

&lt;p&gt;SharedResourceReference should be used with org.apache.wicket.Application.getSharedResources().add().&lt;/p&gt;

&lt;p&gt;I&apos;ll investigate further.&lt;/p&gt;</comment>
                            <comment id="13060565" author="sodasmile" created="Wed, 6 Jul 2011 13:20:37 +0000"  >&lt;p&gt;Ok, I see, I&apos;ll remember that. But I changed the image reference from ImageWicketModalPanel in the example application to &lt;/p&gt;

&lt;p&gt;private static final ResourceReference IMAGE_REFERENCE = new PackageResourceReference(ImageWicketModalPanel.class, &quot;mtn.jpg&quot;);&lt;/p&gt;

&lt;p&gt;and I still get the same above mentioned stacktrace in the log.&lt;/p&gt;</comment>
                            <comment id="13063849" author="mgrigorov" created="Tue, 12 Jul 2011 12:29:43 +0000"  >&lt;p&gt;It seems this is a general problem with ModalWindow + IE.&lt;/p&gt;

&lt;p&gt;I removed the image and image resource completely and it still fails in IE with this exception.&lt;/p&gt;</comment>
                            <comment id="13063850" author="mgrigorov" created="Tue, 12 Jul 2011 12:31:08 +0000"  >&lt;p&gt;Attaching the simplified version without usage of image.&lt;/p&gt;</comment>
                            <comment id="13067575" author="jomarl" created="Tue, 19 Jul 2011 08:24:59 +0000"  >&lt;p&gt;The problem is not only related to modal windows. Loading a image resource as part of a component added to a AjaxRequestTarget seems to result in this error in Internet Explorer. This can easily be reproduced by changing the use of a ModalWindow in the example application with a LazyLoadPanel:&lt;/p&gt;

&lt;p&gt;        AjaxLazyLoadPanel lazyLoadPanel = new AjaxLazyLoadPanel(&quot;modalWindow&quot;) {&lt;/p&gt;

&lt;p&gt;            @Override&lt;br/&gt;
            public Component getLazyLoadComponent(final String id) &lt;/p&gt;
{
                return new ImageWicketModalPanel(id);
            }
&lt;p&gt;        };&lt;br/&gt;
        add(lazyLoadPanel);&lt;/p&gt;

&lt;p&gt;IE starts to process the request for the image but then decides to cancel the operation (just after sending the request to the server). There are several reasons why IE might decide to abort the request, for example if it finds out that the resource was allready cached or that a javascript do not wait for the server response.&lt;/p&gt;

&lt;p&gt;Disabling the Image anticaching seems to prevent the ResponseIOException on the server, but IE still tries to load the image resource two times (aborting the first operation).&lt;/p&gt;</comment>
                            <comment id="13067603" author="jomarl" created="Tue, 19 Jul 2011 10:18:00 +0000"  >&lt;p&gt;Im not a javascript expert, but there seems to be an error in the javascript function Wicket.replaceOuterHtmlIE in wicket-ajax.js. There seems to be some special handling code for getting &amp;lt;script&amp;gt; tags inside the response that generate the first (aborted) request for the image resource. &lt;/p&gt;

&lt;p&gt;		// this is not exactly nice, but we need to get invalid markup inside innerHTML,&lt;br/&gt;
		// because otherwise IE just swallows the &amp;lt;script&amp;gt; tags (sometimes)	&lt;br/&gt;
		tempDiv.innerHTML = &apos;&amp;lt;table style=&quot;display:none&quot;&amp;gt;&apos; + markIframe(text) + &apos;&amp;lt;/table&amp;gt;&apos;;&lt;/p&gt;

&lt;p&gt;                ..&lt;/p&gt;

&lt;p&gt;		// now use regular div so that we won&apos;t mess the DOM&lt;br/&gt;
		tempDiv.innerHTML = &apos;&amp;lt;div style=&quot;display:none&quot;&amp;gt;&apos; + text + &apos;&amp;lt;/div&amp;gt;&apos;;&lt;/p&gt;

&lt;p&gt;The second call to tempDiv.innerHTML happens after the browser has requested the image resource evaluated between the (invalid) &amp;lt;table&amp;gt;&amp;lt;/table&amp;gt; markup but before any server response is made, hence it cancels the request and make a new one. &lt;/p&gt;

&lt;p&gt;Delaying the execution just before &quot;tempDiv.innerHTML = &apos;&amp;lt;div style=&quot;display:none&quot;&amp;gt;&apos; + text + &apos;&amp;lt;/div&amp;gt;&apos;&quot; until the first request for the image gets a server response removed the second call to the image and the resulting error on the serverside.&lt;/p&gt;</comment>
                            <comment id="13068916" author="mgrigorov" created="Thu, 21 Jul 2011 11:33:36 +0000"  >&lt;p&gt;Here are the requests being made to the server during opening of the modal:&lt;br/&gt;
GET /wicket/page?0-3.IBehaviorListener.0-showModalWindow&amp;amp;random=0.2886669956730594 HTTP/1.1&lt;br/&gt;
GET /wicket/resource/iwicket.ImageWicketModalPanel/mtn-ver-1311247057000.jpg?wicket:antiCache=1311247826026 HTTP/1.1&lt;br/&gt;
GET /wicket/resource/org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow/res/transparent2.png HTTP/1.1&lt;/p&gt;

&lt;p&gt;I.e. there is no request to the same resource (mtn.jpg) twice.&lt;/p&gt;</comment>
                            <comment id="13068943" author="jomarl" created="Thu, 21 Jul 2011 12:05:41 +0000"  >&lt;p&gt;Example application that uses a image in a lazy loaded panel.&lt;/p&gt;</comment>
                            <comment id="13068944" author="jomarl" created="Thu, 21 Jul 2011 12:08:06 +0000"  >&lt;p&gt;Internet Explorer 9 debugbar showing all requests made when accessing the context of the example application (lazyloadpanel.zip).&lt;/p&gt;</comment>
                            <comment id="13071175" author="mgrigorov" created="Tue, 26 Jul 2011 15:55:18 +0000"  >&lt;p&gt;Fixed it.&lt;/p&gt;

&lt;p&gt;It was the usage of &apos;:&apos; in wicket:antiCache parameter.&lt;br/&gt;
This character is not allowed in parameter names.&lt;br/&gt;
Now the parameter is just &apos;antiCache&apos;.&lt;/p&gt;</comment>
                            <comment id="13115437" author="jomarl" created="Tue, 27 Sep 2011 12:25:59 +0000"  >&lt;p&gt;Is this fixed in 1.5.0? Changing the version in the attached quickstart application still give a ResponseIOException on the serverside when using Internet Explorer.&lt;/p&gt;</comment>
                            <comment id="13120152" author="raspoutine" created="Tue, 4 Oct 2011 14:17:00 +0000"  >&lt;p&gt;I have the same error in 1.5.1 and internet explorer 8 when i run this code :&lt;/p&gt;

&lt;p&gt;public void onClick(AjaxRequestTarget target) {&lt;br/&gt;
	replacePanel(target, new ImagePanel(&quot;panel&quot;, item.getModelObject().getName());&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;private void replacePanel(AjaxRequestTarget target, Panel newPanel) {&lt;br/&gt;
    this.dynamicPanel.replaceWith(newPanel);&lt;br/&gt;
    this.dynamicPanel = newPanel;&lt;br/&gt;
    target.add(this.dynamicPanel);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;public class ImagePanel extends Panel {&lt;/p&gt;

&lt;p&gt;        public ImagePanel(String id, String path) {&lt;br/&gt;
            super(id);&lt;br/&gt;
            setOutputMarkupId(true);&lt;br/&gt;
            final ResourceReference ref = getPicResource(new File(path));&lt;br/&gt;
            Image image = new Image(&quot;image&quot;, ref) {&lt;br/&gt;
                @Override&lt;br/&gt;
                protected void onComponentTag(final ComponentTag tag) &lt;/p&gt;
{
                    CharSequence url = RequestCycle.get().urlFor(ref, new PageParameters());
                    checkComponentTag(tag, &quot;img&quot;);
                    tag.put(&quot;src&quot;, url);
                    tag.put(&quot;alt&quot;, &quot;&quot;);
                }
&lt;p&gt;            };&lt;br/&gt;
            add(image);&lt;br/&gt;
        }&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;public ResourceReference getPicResource(final File pic) {&lt;/p&gt;

&lt;p&gt;        return new ResourceReference(pic.getName()) {&lt;/p&gt;

&lt;p&gt;            @Override&lt;br/&gt;
            public AbstractResource getResource() {&lt;br/&gt;
                final BufferedDynamicImageResource resource = new BufferedDynamicImageResource();&lt;br/&gt;
                BufferedImage bi = null;&lt;br/&gt;
                try &lt;/p&gt;
{
                    bi = ImageIO.read(im);
                }
&lt;p&gt; catch (IOException e) &lt;/p&gt;
{
                    e.printStackTrace();
                }
&lt;p&gt;                resource.setImage(bi);&lt;br/&gt;
                return resource;&lt;br/&gt;
            }&lt;br/&gt;
        };&lt;br/&gt;
}&lt;/p&gt;</comment>
                            <comment id="13143056" author="jomarl" created="Thu, 3 Nov 2011 12:02:57 +0000"  >&lt;p&gt;Just checked this with the quickstart application in lazyloaderror.zip using wicket 1.5.2 and it&apos;s still broken (IE8). &lt;/p&gt;</comment>
                            <comment id="13143070" author="sodasmile" created="Thu, 3 Nov 2011 12:18:45 +0000"  >&lt;p&gt;This issue should be reopened, it is not fixed. However I cannot figure out how to do that in this tool.&lt;/p&gt;</comment>
                            <comment id="13143097" author="mgrigorov" created="Thu, 3 Nov 2011 12:58:17 +0000"  >&lt;p&gt;The attached lazyloaderror.zip works without any problems here on IE9 with all possible browser modes and compatibility modes.&lt;/p&gt;</comment>
                            <comment id="13143113" author="mgrigorov" created="Thu, 3 Nov 2011 13:01:54 +0000"  >&lt;p&gt;I see that in all quickstarts mentioned in this ticket an Image updated in Ajax request is made.&lt;br/&gt;
Since I cannot reproduce the problem locally I&apos;d like to ask you to override Image#shouldAddAntiCacheParameter() and always return &apos;false&apos;.&lt;/p&gt;

&lt;p&gt;Let&apos;s see whether this will solve the problem for you.&lt;/p&gt;</comment>
                            <comment id="13143123" author="mgrigorov" created="Thu, 3 Nov 2011 13:10:38 +0000"  >&lt;p&gt;Also please try with 1.5-SNAPSHOT from &lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/&lt;/a&gt;&lt;br/&gt;
I just tried with 1.5.2 and there is indeed one aborted load of the image but still I don&apos;t have any ResponseIOException logged. Unfortunatelly IE9 doesn&apos;t explain why it is aborted.&lt;br/&gt;
With 1.5-SNAPSHOT there is no aborted load of the image.&lt;/p&gt;</comment>
                            <comment id="13143124" author="mgrigorov" created="Thu, 3 Nov 2011 13:13:44 +0000"  >&lt;p&gt;With 1.5.2 and with:&lt;/p&gt;

&lt;p&gt;LazyLoadPanel.java:&lt;br/&gt;
 @Override&lt;br/&gt;
    protected void onInitialize() {&lt;br/&gt;
        super.onInitialize();&lt;/p&gt;

&lt;p&gt;        add(new Image(&quot;image&quot;, new PackageResourceReference(LazyLoadedPanel.class, &quot;logo.png&quot;)) {&lt;/p&gt;

&lt;p&gt;            @Override&lt;br/&gt;
            protected boolean shouldAddAntiCacheParameter() &lt;/p&gt;
{
                return false;   // THIS IS IMPORTANT
            }
&lt;p&gt;            &lt;br/&gt;
        });&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;there is no aborted load of the image.&lt;br/&gt;
With 1.5-SNAPSHOT there is no need to override this method but I also don&apos;t know of any change in Wicket that &quot;fixes&quot; this problem.&lt;/p&gt;</comment>
                            <comment id="13143126" author="jomarl" created="Thu, 3 Nov 2011 13:15:34 +0000"  >&lt;p&gt;Overriding the shouldAddAntiCacheParameter to always return false seems to resolve the issue when running in IE 8.&lt;/p&gt;</comment>
                            <comment id="13143163" author="jomarl" created="Thu, 3 Nov 2011 13:37:04 +0000"  >&lt;p&gt;Tried with 1.5-SNAPSHOT (wicket-core-1.5-20111103.110737-1071, wicket-request-1.5-20111103.110552-1629, wicket-util-1.5-20111103.110535-1639 and wicket-extensions-1.5-20111103.110833-1551) and I still get the same error in the log for both IE 8 and 9 mode. &lt;/p&gt;</comment>
                            <comment id="13143168" author="mgrigorov" created="Thu, 3 Nov 2011 13:42:06 +0000"  >&lt;p&gt;Thanks Andre!&lt;/p&gt;

&lt;p&gt;Then maybe we should not add this antiCache parameter by default even in Ajax request.&lt;br/&gt;
IE is such a lame browser ...&lt;/p&gt;</comment>
                            <comment id="13143234" author="ivaynberg" created="Thu, 3 Nov 2011 15:22:16 +0000"  >&lt;p&gt;if we dont add it by default we will have 10000 emails asking why images dont update&lt;/p&gt;</comment>
                            <comment id="13143247" author="mgrigorov" created="Thu, 3 Nov 2011 15:42:54 +0000"  >&lt;p&gt;The other solution is to leave it as it is now and explain users once in a while what could be the reason of ResponseIOException.&lt;/p&gt;</comment>
                            <comment id="13143249" author="ivaynberg" created="Thu, 3 Nov 2011 15:45:50 +0000"  >&lt;p&gt;but why does the io exception happen?&lt;/p&gt;</comment>
                            <comment id="13143285" author="mgrigorov" created="Thu, 3 Nov 2011 16:29:57 +0000"  >&lt;p&gt;IE makes a request to load the &amp;lt;img .../&amp;gt; that came from the Ajax response and then for some reason decides to abort the request and do a new one. The abort causes &quot;Socket closed&quot; exception at the server side, i.e. the client closed the connection earlier for some reason.&lt;br/&gt;
This happens on IE and not always. I can see the abort in IE9 Dev tools &amp;gt; Network tab but I don&apos;t see ResponseIOException in the server logs. Andre sees the ResponseIOException. &lt;/p&gt;</comment>
                            <comment id="13143295" author="ivaynberg" created="Thu, 3 Nov 2011 16:37:33 +0000"  >&lt;p&gt;we should figure out why it aborts. maybe we are not sending the correct content type? maybe the abort is actually from that resource loader you put in place for css files?&lt;/p&gt;</comment>
                            <comment id="13143297" author="mgrigorov" created="Thu, 3 Nov 2011 16:42:21 +0000"  >&lt;p&gt;The reason is the antiCache parameter as we can see. Both me and Andre verified that without it all is fine.&lt;br/&gt;
But for now I cannot say why IE doesn&apos;t like the random parameter.&lt;/p&gt;</comment>
                            <comment id="13143497" author="raspoutine" created="Thu, 3 Nov 2011 20:12:50 +0000"  >&lt;p&gt;If it can helps, my quickstart reproduce logs every time&lt;/p&gt;</comment>
                            <comment id="13143931" author="jomarl" created="Fri, 4 Nov 2011 11:40:36 +0000"  >&lt;p&gt;Martin,&lt;/p&gt;

&lt;p&gt;I&apos;ve done some more testing and it seems that overriding shouldAddAntiCacheParameter() to always return false don&apos;t fix the problem. Even without the antiCache parameter I get the ResponseIOException on the serverside the first time the page loads and dont get a cache hit on the image (resulting in the aborted request). Clearing the browser cache and opening the page again in a new tab/browser window usually results in the serverside error, but Im unable to consistently reproduce it.&lt;/p&gt;</comment>
                            <comment id="13149087" author="nhsoft.yhw" created="Sat, 12 Nov 2011 14:54:34 +0000"  >&lt;p&gt;I also encountered a similar problem in my application only when  IE9 compatibility mode. IE9, Firefox9, Chrome 16 will not occur.&lt;/p&gt;

&lt;p&gt;when click ajaxlink to show modalwindow(without any image resource), IE display 404 page, and server side throws &quot;ClientAbortException: java.io.IOException&quot; &lt;/p&gt;

&lt;p&gt;Wicket 1.5.1,1.5.2,1.5.3&lt;br/&gt;
Tomcat 7&lt;br/&gt;
JDK1.6&lt;/p&gt;


&lt;p&gt;Same code, there is no problem in wicket1.4.x or wicket 1.5.0 versions&lt;/p&gt;</comment>
                            <comment id="13156597" author="m_seko" created="Thu, 24 Nov 2011 08:49:34 +0000"  >&lt;p&gt;I encountered an trouble likely involved.&lt;br/&gt;
I using wicket 1.5.3.&lt;/p&gt;

&lt;p&gt;When using a modal window(org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow)&lt;br/&gt;
with IE, I&apos;m having trouble socket write error.&lt;br/&gt;
is called when AbstractResource#setResponseHeaders, with high probability to cause trouble.&lt;/p&gt;

&lt;p&gt;When rendering modal window, sometimes not called AbstractResource#setResponseHeaders.&lt;br/&gt;
if so, socket write error does not occur.&lt;/p&gt;

&lt;p&gt;The root problem is unknown.&lt;/p&gt;

&lt;p&gt;I want to know how to prevent a socket write error.&lt;/p&gt;

&lt;p&gt;The following stack trace:&lt;br/&gt;
org.apache.wicket.protocol.http.servlet.ResponseIOException: ClientAbortException:  java.net.SocketException:&lt;br/&gt;
Connection reset by peer: socket write error&lt;br/&gt;
    at org.apache.wicket.protocol.http.servlet.ServletWebResponse.flush(ServletWebResponse.java:255)&lt;br/&gt;
    at org.apache.wicket.protocol.http.HeaderBufferingWebResponse.flush(HeaderBufferingWebResponse.java:92)&lt;br/&gt;
    at org.apache.wicket.request.resource.AbstractResource.setResponseHeaders(AbstractResource.java:611)&lt;br/&gt;
    at org.apache.wicket.request.resource.AbstractResource.respond(AbstractResource.java:485)&lt;br/&gt;
    at org.apache.wicket.request.handler.resource.ResourceRequestHandler.respond(ResourceRequestHandler.java:77)&lt;br/&gt;
    at org.apache.wicket.request.handler.resource.ResourceReferenceRequestHandler.respond(ResourceReferenceRequestHandler.java:105)&lt;br/&gt;
    at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:750)&lt;br/&gt;
    at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)&lt;br/&gt;
    at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:252)&lt;br/&gt;
    at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:209)&lt;br/&gt;
    at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:280)&lt;br/&gt;
    at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:162)&lt;br/&gt;
    at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:218)&lt;br/&gt;
    Snip&lt;/p&gt;</comment>
                            <comment id="13157038" author="m_seko" created="Fri, 25 Nov 2011 09:02:43 +0000"  >&lt;p&gt;This problem does not occur that seem to set the Proxy in IE.&lt;br/&gt;
I do not know why.&lt;/p&gt;

&lt;p&gt;For analysis using burpsuite. Then does not reproduce the problem.&lt;/p&gt;</comment>
                            <comment id="13174861" author="mgrigorov" created="Thu, 22 Dec 2011 15:59:13 +0000"  >&lt;p&gt;@Ras Poutine: I cannot reproduce the problem with your quickstart at all.&lt;/p&gt;</comment>
                            <comment id="13174867" author="mgrigorov" created="Thu, 22 Dec 2011 16:02:45 +0000"  >&lt;p&gt;With Wicket 6.0 I cannot reproduce the problems with Andre&apos;s quickstart too...&lt;/p&gt;</comment>
                            <comment id="13288561" author="truesdk" created="Mon, 4 Jun 2012 13:45:06 +0000"  >&lt;p&gt;I see no one has commented on this since December. Has this issue been fixed? I am seeing this error in 1.5.6&lt;/p&gt;</comment>
                            <comment id="13288564" author="mgrigorov" created="Mon, 4 Jun 2012 13:48:13 +0000"  >&lt;p&gt;@Sean,&lt;/p&gt;

&lt;p&gt;Any help here is highly appreciated!&lt;br/&gt;
If it is easy to reproduce it then try to debug it and let us know what causes the problem.&lt;/p&gt;</comment>
                            <comment id="13289231" author="jonno_c" created="Tue, 5 Jun 2012 08:10:40 +0000"  >&lt;p&gt;A work-around for this problem, that I&apos;ve implemented in our applications and works. Is to create a custom ServletWebResponse which extends the org.apache.wicket.protocol.http.servlet.ServletWebResponse. In your custom version override the flush method to do the flush and catch any exceptions, and ignore Socket Exceptions.&lt;/p&gt;

&lt;p&gt;for example..&lt;br/&gt;
&amp;lt;code&amp;gt;&lt;br/&gt;
    @Override&lt;br/&gt;
    public void flush() {&lt;br/&gt;
        try &lt;/p&gt;
{
            getContainerResponse().flushBuffer();
        }
&lt;p&gt; catch (SocketException e) &lt;/p&gt;
{
            LOGGER.debug(&quot;Socket exception encountered, ignoring&quot;, e);
        }
&lt;p&gt; catch (IOException e) {&lt;br/&gt;
            // Socket Exception can be wrapped by a container specific exception.&lt;br/&gt;
            // So we check the cause of the container exception&lt;br/&gt;
            Throwable rootCause = null != getRootCause(e) ? getRootCause(e) : e;&lt;br/&gt;
            if (rootCause instanceof SocketException) &lt;/p&gt;
{
                LOGGER.debug(&quot;Socket exception encountered, ignoring.&quot;, rootCause);
                return;
            }
&lt;p&gt;            throw new ResponseIOException(e);&lt;br/&gt;
        }&lt;br/&gt;
    }&lt;br/&gt;
&amp;lt;/code&amp;gt;&lt;br/&gt;
( getRootCause() come from apache ExceptionUtils )&lt;/p&gt;

&lt;p&gt;Then to use this you need to override the newWebResponse method in your WebApplication to return an instance of you custom WebResponse.&lt;/p&gt;

&lt;p&gt;Hope this is useful for anyone who wants to avoid spurious exceptions in thier logs.&lt;/p&gt;</comment>
                            <comment id="13546786" author="neilmusgrove" created="Tue, 8 Jan 2013 11:06:20 +0000"  >&lt;p&gt;This problem still seems to exist in 6.4. I&apos;m using images generated from byte arrays and have to use a non-caching image (otherwise on refresh the images change to ones used on another page). This gives the following error (and I can see the abort in IE dev tools):&lt;/p&gt;

&lt;p&gt;2013-01-08 10:59:56 DefaultExceptionMapper &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Connection lost, give up responding.&lt;br/&gt;
org.apache.wicket.protocol.http.servlet.ResponseIOException: ClientAbortException:  java.io.IOException&lt;/p&gt;

&lt;p&gt;I have tried the workaround suggested by Jonathan Crabtree to supress the errors but I just get other errors instead:&lt;/p&gt;

&lt;p&gt;2013-01-08 11:02:57 DefaultExceptionMapper &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; unexpected exception when handling another exception: Header was already written to response!&lt;br/&gt;
java.lang.IllegalStateException: Header was already written to response!&lt;/p&gt;

&lt;p&gt;This problem only exists with Internet Explorer and doesn&apos;t appear to affect the functionality of the application however I need to find a way to at least supress the errors if there is no fix.&lt;/p&gt;

&lt;p&gt;Cheers&lt;/p&gt;</comment>
                            <comment id="13546809" author="crudh" created="Tue, 8 Jan 2013 11:45:51 +0000"  >&lt;p&gt;@Neil: Try this to supress the errors, it&apos;s an extension to the example by Jonathan that seems to work fine for me:&lt;/p&gt;

&lt;p&gt;public class MyWebResponse extends ServletWebResponse {&lt;/p&gt;

&lt;p&gt;  public MyWebResponse(ServletWebRequest webRequest, HttpServletResponse httpServletResponse) &lt;/p&gt;
{
    super(webRequest, httpServletResponse);
  }

&lt;p&gt;  @Override&lt;br/&gt;
  public void write(CharSequence sequence) {&lt;br/&gt;
    try &lt;/p&gt;
{
      super.write(sequence);
    }
&lt;p&gt; catch (ResponseIOException e) {&lt;br/&gt;
      if (e.getCause() != null &amp;amp;&amp;amp; e.getCause() instanceof SocketException) &lt;/p&gt;
{
        // Ignore
      } else {
        throw e;
      }&lt;br/&gt;
    }&lt;br/&gt;
  }&lt;br/&gt;
  &lt;br/&gt;
  @Override&lt;br/&gt;
  public void write(byte[] array) {&lt;br/&gt;
    try {
      super.write(array);
    } catch (ResponseIOException e) {&lt;br/&gt;
      if (e.getCause() != null &amp;amp;&amp;amp; e.getCause() instanceof SocketException) {        // Ignore      }
&lt;p&gt; else &lt;/p&gt;
{
        throw e;
      }&lt;br/&gt;
    }&lt;br/&gt;
  }&lt;br/&gt;
  &lt;br/&gt;
  @Override&lt;br/&gt;
  public void flush() {&lt;br/&gt;
    try {
      super.flush();
    } catch (ResponseIOException e) {&lt;br/&gt;
      if (e.getCause() != null &amp;amp;&amp;amp; e.getCause() instanceof SocketException) {
        // Ignore
      } else {        throw e;      }
&lt;p&gt;    }&lt;br/&gt;
  }&lt;br/&gt;
}&lt;/p&gt;</comment>
                            <comment id="13546815" author="neilmusgrove" created="Tue, 8 Jan 2013 11:53:03 +0000"  >&lt;p&gt;Great, seems to work. I had to change the instanceof evaluation to ClientAbortException but once I&apos;d done that it stopped the errors.&lt;/p&gt;

&lt;p&gt;Thanks for your help.&lt;/p&gt;</comment>
                            <comment id="13588189" author="mgrigorov" created="Wed, 27 Feb 2013 10:08:03 +0000"  >&lt;p&gt;Users on the mailing lists reported that they workaround such error with:&lt;br/&gt;
&amp;lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;http://markmail.org/thread/at7mhctll27akzj4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://markmail.org/thread/at7mhctll27akzj4&lt;/a&gt; and &lt;a href=&quot;http://markmail.org/thread/5sbhcqbjxxb7arwy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://markmail.org/thread/5sbhcqbjxxb7arwy&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="13588228" author="crudh" created="Wed, 27 Feb 2013 11:13:59 +0000"  >&lt;p&gt;We have had that meta tag for a long time and it doesn&apos;t affect this issue for us at least.&lt;/p&gt;</comment>
                            <comment id="13588237" author="neilmusgrove" created="Wed, 27 Feb 2013 11:24:37 +0000"  >&lt;p&gt;Yeah doesn&apos;t seem to make any difference to me. The only workaround I found to work was to make a custom ServletWebResponse as above.&lt;/p&gt;</comment>
                            <comment id="13686465" author="iceaxon" created="Tue, 18 Jun 2013 07:23:33 +0000"  >&lt;p&gt;@Christian Thanks, worked fine for me to. The meta tag did not affect this issue for me either.&lt;/p&gt;</comment>
                            <comment id="13686469" author="mariusvanwyk" created="Tue, 18 Jun 2013 07:27:22 +0000"  >&lt;p&gt;I will be out of the office today - back on Wednesday 19 June. In case of emergency please contact Vincent Dupuis &amp;lt;VDupuis@temenos.com&amp;gt; else I will respond to your email tomorrow.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Marius&lt;/p&gt;

&lt;p&gt;The information in this e-mail and any attachments is confidential and may be legally privileged. It is intended solely for the addressee or addressees. Any use or disclosure of the contents of this e-mail/attachments by a not intended recipient is unauthorized and may be unlawful. If you have received this e-mail in error please notify the sender. Please note that any views or opinions presented in this e-mail are solely those of the author and do not necessarily represent those of TEMENOS. We recommend that you check this e-mail and any attachments against viruses. TEMENOS accepts no liability for any damage caused by any malicious code or virus transmitted by this e-mail.&lt;/p&gt;</comment>
                            <comment id="13812702" author="mgrigorov" created="Mon, 4 Nov 2013 09:28:11 +0000"  >&lt;p&gt;There is a possibility that this problem has been fixed with &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5392&quot; title=&quot;Responses for package resources cannot be compressed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5392&quot;&gt;&lt;del&gt;WICKET-5392&lt;/del&gt;&lt;/a&gt; in master branch (7.x).&lt;br/&gt;
If your application reproduces the problem then override AbstractResource#flushResponseAfterHeaders(WebResponse) to do nothing and tell us whether it helped you.&lt;/p&gt;</comment>
                            <comment id="14013377" author="rakesh.a" created="Fri, 30 May 2014 07:25:34 +0000"  >&lt;p&gt;We are using Wicket 6.12.0, and overriding &quot;AbstractResource#flushResponseAfterHeaders(WebResponse)&quot; and not calling super implementation to avoid flushing headers didn&apos;t solve the issue. We observed that it is more frequent in IE8 in our case.&lt;/p&gt;</comment>
                            <comment id="14161504" author="rakesh.a" created="Tue, 7 Oct 2014 05:43:34 +0000"  >&lt;p&gt;One specific case we observed, which might also help identifying the cause is with &apos;background image of modal dialog mask&apos;. Wicket sets the &apos;background-image&apos; property of modal dialog mask to &apos;none&apos; using JavaScript, but the CSS sets the background image prior to this. May be because of some delay IE starts requesting the image set via CSS, and JavaScript sets it to &apos;none&apos; before it completes loading the image, and causes the exception.&lt;/p&gt;

&lt;p&gt;We fixed by setting the &apos;background-image&apos; property to &apos;none&apos; in our CSS.&lt;/p&gt;

&lt;p&gt;body div.wicket-mask-dark {&lt;br/&gt;
   background-image: none;&lt;br/&gt;
   ...&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;But now we get the same exception for other resources.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12529828">WICKET-4191</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12502213" name="Eofproject.7z" size="112057" author="raspoutine" created="Thu, 3 Nov 2011 20:11:29 +0000"/>
                            <attachment id="12487290" name="internetexplorer-requests.png" size="91829" author="jomarl" created="Thu, 21 Jul 2011 12:08:06 +0000"/>
                            <attachment id="12486171" name="iwicket-no-image.tgz" size="16281" author="mgrigorov" created="Tue, 12 Jul 2011 12:31:08 +0000"/>
                            <attachment id="12485181" name="iwicket.zip" size="18576" author="sodasmile" created="Mon, 4 Jul 2011 20:40:22 +0000"/>
                            <attachment id="12487289" name="lazyloaderror.zip" size="13107" author="jomarl" created="Thu, 21 Jul 2011 12:05:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19180</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 6 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00wo7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3225</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>