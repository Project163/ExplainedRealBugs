<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:20:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4715] WebApplication doesn&apos;t recognize if an incoming request is multipart.</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4715</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Thanks to the mail at &lt;a href=&quot;http://apache-wicket.1842946.n4.nabble.com/Read-POST-based-request-from-external-site-td4651269.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://apache-wicket.1842946.n4.nabble.com/Read-POST-based-request-from-external-site-td4651269.html&lt;/a&gt; we have spotted a problem with method  newWebRequest of class WebApplication. &lt;br/&gt;
It seems that this method doesn&apos;t test if the original request is multipart and doing so post parameters go lost. &lt;br/&gt;
We should create a  MultipartServletWebRequestImpl when such a type of request is being served. I attach a possible patch but I&apos;m not 100% about two things:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;which is the best way to determinate if a HttpServletRequest is multipart?&lt;/li&gt;
	&lt;li&gt;in order to build a MultipartServletWebRequestImpl we need to provide a string identifier for the upload.   How can we generate it (in my patch it&apos;s a constant value)?&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12603736">WICKET-4715</key>
            <summary>WebApplication doesn&apos;t recognize if an incoming request is multipart.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="bitstorm">Andrea Del Bene</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Aug 2012 15:03:09 +0000</created>
                <updated>Mon, 1 Oct 2012 08:59:37 +0000</updated>
                            <resolved>Fri, 7 Sep 2012 09:03:19 +0000</resolved>
                                    <version>1.5.7</version>
                    <version>6.0.0-beta3</version>
                                    <fixVersion>1.5.8</fixVersion>
                    <fixVersion>6.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                                                            <comments>
                            <comment id="13436247" author="bitstorm" created="Thu, 16 Aug 2012 19:19:59 +0000"  >&lt;p&gt;I&apos;ve seen how Commons FileUpload library solved the problem of determining if a HttpServletRequest is multipart and is quite similar to what I&apos;ve done, so now I&apos;m confident with my code &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;br/&gt;
I&apos;ve improved my patch adding a test case for multipart requests.&lt;/p&gt;</comment>
                            <comment id="13437684" author="mgrigorov" created="Mon, 20 Aug 2012 06:51:00 +0000"  >&lt;p&gt;I think this patch will break normal form submit with multipart content in org.apache.wicket.markup.html.form.Form#handleMultiPart(), but let me check it.&lt;/p&gt;</comment>
                            <comment id="13437697" author="mgrigorov" created="Mon, 20 Aug 2012 07:16:30 +0000"  >&lt;p&gt;False alarm. Seems to work fine.&lt;/p&gt;</comment>
                            <comment id="13447430" author="petr.nejedlik" created="Tue, 4 Sep 2012 00:09:47 +0000"  >&lt;p&gt;We have upgraded from wicket 1.5.7 to 1.5.8 and I must say that changes in WebApplication in method createWebRequest (where in multipart case method newMultipartWebRequest is called) are bad for us.&lt;br/&gt;
We have maxSizeLimit defined in every UploadPanel (component that upload files) not in application.&lt;br/&gt;
In this situation, there is even no chance to declare maxSize on Form component. You can declare it by setMaxSize, but when Form calls method newMultipartWebRequest this defined size is not used because MultipartServletWebRequestImpl class has been already created in createWebRequest in method createWebRequest in WebApplicationClass.&lt;/p&gt;

&lt;p&gt;I tried to inherit from WebApplication, overiide method newWebRequest a then in own descendant of ServletWebRequest owerride method newMultipartWebRequest.&lt;br/&gt;
But there is problem - method newMultipartWebRequest must return MultipartServletWebRequest (abstract class) not WebRequest.&lt;/p&gt;

&lt;p&gt;Is it possible to change method newMultipartWebRequest to return only WebRequest.&lt;br/&gt;
In that situation we can override method newMultipartWebRequest, return self (descendant of ServletWebRequest) and create MultipartServletWebRequestImpl later (in onRespond method)&lt;/p&gt;

&lt;p&gt;Thanks Petr Nejedlik&lt;/p&gt;</comment>
                            <comment id="13447546" author="mgrigorov" created="Tue, 4 Sep 2012 07:58:54 +0000"  >&lt;p&gt;Hi Petr,&lt;/p&gt;

&lt;p&gt;I&apos;ve just committed an improvement for this regression.&lt;br/&gt;
Can you test with latest 1.5-SNAPSHOT ? Or attach a quickstart so we can test it.&lt;br/&gt;
Thanks!&lt;/p&gt;</comment>
                            <comment id="13450453" author="vanger" created="Fri, 7 Sep 2012 08:20:03 +0000"  >&lt;p&gt;I also have some strange related problems with multipart:&lt;br/&gt;
we have several jsp pages which doesn&apos;t have anything to do with wicket. But they use multipart upload forms served by Apache ServletFileUpload.&lt;br/&gt;
When we make single change in our project - upgrade wicket version from 1.5.7 to 1.5.8 (in pom) this forms becomes broken:&lt;br/&gt;
line &lt;br/&gt;
List&amp;lt;FileItem&amp;gt; items = upload.parseRequest(request);&lt;br/&gt;
always returns zero items with wicket 1.5.8 in project.&lt;br/&gt;
I can&apos;t even imagine how change of wicket  can affect some JSPs...&lt;br/&gt;
Example:&lt;/p&gt;

&lt;p&gt;&amp;lt;%@ page import=&quot;org.apache.commons.fileupload.FileItem&quot; %&amp;gt;&lt;br/&gt;
&amp;lt;%@ page import=&quot;org.apache.commons.fileupload.disk.DiskFileItemFactory&quot; %&amp;gt;&lt;br/&gt;
&amp;lt;%@ page import=&quot;org.apache.commons.fileupload.servlet.ServletFileUpload&quot; %&amp;gt;&lt;br/&gt;
&amp;lt;%@ page import=&quot;java.util.ArrayList&quot; %&amp;gt;&lt;br/&gt;
&amp;lt;%@ page import=&quot;java.util.List&quot; %&amp;gt;&lt;br/&gt;
&amp;lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; session=&quot;false&quot; %&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;form action=&quot;&amp;lt;%=request.getRequestURI()%&amp;gt;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;input type=&quot;file&quot; name=&quot;file&quot; size=&quot;120&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;input type=&quot;submit&quot; value=&quot;Upload&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/form&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;%&lt;br/&gt;
        final int maxSize = 16 * 1024 * 1024;&lt;br/&gt;
        DiskFileItemFactory factory = new DiskFileItemFactory();&lt;br/&gt;
        factory.setSizeThreshold(maxSize);&lt;/p&gt;

&lt;p&gt;        ServletFileUpload upload = new ServletFileUpload(factory);&lt;br/&gt;
        upload.setSizeMax(maxSize);&lt;br/&gt;
        List items = upload.parseRequest(request); //This always returns empty list in 1.5.8&lt;br/&gt;
%&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13450458" author="mgrigorov" created="Fri, 7 Sep 2012 08:26:27 +0000"  >&lt;p&gt;The problem is that WicketFilter is executed before the JspServlet and thus the POST request parameters are already consumed.&lt;/p&gt;

&lt;p&gt;The previous fix that I&apos;ve added for 1.5.9 wont help for this new case.&lt;br/&gt;
I think we should revert the change completely. To support the original use case for this ticket the user application should create the MultipartWebRequest itself in the page constructor to be able to read the file upload parameters. I see no other way :-/&lt;/p&gt;</comment>
                            <comment id="13450477" author="mgrigorov" created="Fri, 7 Sep 2012 09:03:19 +0000"  >&lt;p&gt;I&apos;m closing this ticket.&lt;br/&gt;
The change will be most probably reverted with &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-4752&quot; title=&quot;Revert Wicket-4715 -Read multipart request params in WebApplication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-4752&quot;&gt;&lt;del&gt;WICKET-4752&lt;/del&gt;&lt;/a&gt; unless someone finds a solution that will work for all cases.&lt;/p&gt;</comment>
                            <comment id="13466703" author="mgrigorov" created="Mon, 1 Oct 2012 08:59:37 +0000"  >&lt;p&gt;The change has been reverted for Wicket 1.5.9 and 6.2.0.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12609442">WICKET-4791</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12541265" name="WICKET-4715.patch" size="6847" author="bitstorm" created="Thu, 16 Aug 2012 19:14:17 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12606548">WICKET-4752</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>250931</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 7 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0b2jr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>62525</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>