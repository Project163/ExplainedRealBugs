<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:21:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-5104] AjaxSelfUpdatingTimerBehavior in hidden component in ModalWindow causes Ajax Response Error</title>
                <link>https://issues.apache.org/jira/browse/WICKET-5104</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;I have a ModalWindow which shows a panel with a hidden label with an AjaxSelfUpdatingTimerBehavior. When the modal window is shown, the following error occurs in the Wicket Ajax Debug console:&lt;/p&gt;

&lt;p&gt;ERROR: Wicket.Ajax.Call.processEvaluation: Exception evaluating javascript: TypeError: Cannot read property &apos;label5&apos; of undefined, text: (function()&lt;/p&gt;
{clearTimeout(Wicket.TimerHandles[&apos;label5&apos;]); delete Wicket.TimerHandles[&apos;label5&apos;];}
&lt;p&gt;)();&lt;/p&gt;</description>
                <environment></environment>
        <key id="12637461">WICKET-5104</key>
            <summary>AjaxSelfUpdatingTimerBehavior in hidden component in ModalWindow causes Ajax Response Error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="mscoon">Marios Skounakis</reporter>
                        <labels>
                    </labels>
                <created>Sun, 17 Mar 2013 22:00:08 +0000</created>
                <updated>Mon, 8 Apr 2013 21:11:56 +0000</updated>
                            <resolved>Mon, 8 Apr 2013 21:08:28 +0000</resolved>
                                    <version>6.3.0</version>
                    <version>6.6.0</version>
                                    <fixVersion>6.7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13604767" author="mscoon" created="Sun, 17 Mar 2013 22:05:49 +0000"  >&lt;p&gt;Quickstart to reproduce the problem - just click on the link on the home page to open the modal window and cause the error to appear.&lt;/p&gt;</comment>
                            <comment id="13612095" author="cedricgatay" created="Sun, 24 Mar 2013 13:51:11 +0000"  >&lt;p&gt;You&apos;ll find the patch attached, the problem still exists with Wicket 6.7.0-SNAPSHOT.&lt;/p&gt;

&lt;p&gt;The problem was we were not checking if the head had already been rendered before pushing JavaScript asking to stop the behavior.&lt;/p&gt;</comment>
                            <comment id="13625340" author="mgrigorov" created="Mon, 8 Apr 2013 12:56:01 +0000"  >&lt;p&gt;I cannot reproduce the problem with the attached quickstart.&lt;br/&gt;
The Label is set invisible in the panel constructor thus the Ajax timer behavior is disabled and its #renderHead() is not called at all, so it doesn&apos;t contribute the JS which should lead to this error.&lt;/p&gt;

&lt;p&gt;What do I miss ?&lt;/p&gt;</comment>
                            <comment id="13625342" author="cedricgatay" created="Mon, 8 Apr 2013 12:59:14 +0000"  >&lt;p&gt;For me it happened only the second time the page was rendered. The first display everything was fine, after a second display it was all messed up with the JavaScript error in the Wicket Ajax Debug window&lt;/p&gt;</comment>
                            <comment id="13625348" author="mgrigorov" created="Mon, 8 Apr 2013 13:10:16 +0000"  >&lt;p&gt;I just tried again.&lt;br/&gt;
I&apos;ve opened the modal several times without problem.&lt;br/&gt;
I removed ?pageId from the url to create a new page instance and tried again and there is no error.&lt;/p&gt;</comment>
                            <comment id="13625354" author="cedricgatay" created="Mon, 8 Apr 2013 13:19:08 +0000"  >&lt;p&gt;My brain hurts me this monday &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; It is not the second page load but the second click on the link to open the modal. I just checked it with the latest 6.7.0-SNAPSHOT.&lt;/p&gt;

&lt;p&gt;Launched quickstart, clicked open, closed the modal, clicked open another time &amp;gt; bam Wicket Ajax Debug fever is on.&lt;/p&gt;</comment>
                            <comment id="13625355" author="mgrigorov" created="Mon, 8 Apr 2013 13:23:53 +0000"  >&lt;p&gt;No error here :-/&lt;br/&gt;
I&apos;ve put breakpoints both at org.apache.wicket.ajax.AbstractAjaxTimerBehavior#stop() and org.apache.wicket.ajax.AbstractAjaxTimerBehavior#renderHead() and they are never called no matter how many times I open and the close the modal.&lt;/p&gt;</comment>
                            <comment id="13625356" author="mgrigorov" created="Mon, 8 Apr 2013 13:24:15 +0000"  >&lt;p&gt;And yes, I also use master branch.&lt;/p&gt;</comment>
                            <comment id="13625363" author="cedricgatay" created="Mon, 8 Apr 2013 13:39:16 +0000"  >&lt;p&gt;Hum, I just built the master branch (mvn clean install -Dmaven.test.skip=true) locally, then ran mvn clean jetty:run and could reproduce it. I am using Chrome 28.0.1464.0 dev (the built war is available at the following URL &lt;a href=&quot;http://cl.ly/1c0C30212e3j&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cl.ly/1c0C30212e3j&lt;/a&gt;). The steps to reproduce are the one I detailed previously.&lt;/p&gt;</comment>
                            <comment id="13625494" author="svenmeier" created="Mon, 8 Apr 2013 16:08:20 +0000"  >&lt;p&gt;I can reproduce this issue:&lt;/p&gt;

&lt;p&gt;On second click the first MessageBoxPanel&apos;s behavior tries to stop itself (because its owning component is removed). Since the modal window is not visible, it&apos;s markup is not present on the currently rendered page.&lt;/p&gt;</comment>
                            <comment id="13625585" author="cedricgatay" created="Mon, 8 Apr 2013 17:40:52 +0000"  >&lt;p&gt;The attached patch fixes this issue, as far as I can tell, a review could be necessary to do it the right way though.&lt;/p&gt;</comment>
                            <comment id="13625766" author="svenmeier" created="Mon, 8 Apr 2013 20:26:11 +0000"  >&lt;p&gt;I would think a test on isVisibleInHierarchy() should suffice.&lt;/p&gt;</comment>
                            <comment id="13625780" author="mgrigorov" created="Mon, 8 Apr 2013 20:38:29 +0000"  >&lt;p&gt;Sven: can you reproduce the issue ?&lt;br/&gt;
org.apache.wicket.Component#renderHead(HtmlHeaderContainer) checks whether the component is visible(InHierarchy) and only then calls behavior#renderHead().&lt;br/&gt;
As I said earlier neither org.apache.wicket.ajax.AbstractAjaxTimerBehavior#renderHead() nor org.apache.wicket.ajax.AbstractAjaxTimerBehavior#stop() is called here.&lt;br/&gt;
Please put breakpoints in these methods and attach/paste the stacktraces.&lt;/p&gt;</comment>
                            <comment id="13625799" author="svenmeier" created="Mon, 8 Apr 2013 20:55:03 +0000"  >&lt;p&gt;Martin: The issue can easily be reproduced with Cedric instructions:&lt;/p&gt;

&lt;p&gt;Thread &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp1028384965-18&amp;#93;&lt;/span&gt; (Suspended (breakpoint at line 201 in AbstractAjaxTimerBehavior))	&lt;br/&gt;
	AjaxSelfUpdatingTimerBehavior(AbstractAjaxTimerBehavior).onRemove(Component) line: 201	&lt;br/&gt;
	Behaviors.onRemove(Component) line: 235	&lt;br/&gt;
	MessageBoxPanel$1(Component).internalOnRemove() line: 1110	&lt;br/&gt;
	MessageBoxPanel(MarkupContainer).removeChildren() line: 1590	&lt;br/&gt;
	MessageBoxPanel(Component).internalOnRemove() line: 1111	&lt;br/&gt;
	ModalWindow(MarkupContainer).removedComponent(Component) line: 1343	&lt;br/&gt;
	ModalWindow(MarkupContainer).replace(Component) line: 740	&lt;br/&gt;
	ModalWindow.setContent(Component) line: 944	&lt;br/&gt;
	HomePage$1.onClick(AjaxRequestTarget) line: 26	&lt;br/&gt;
	...&lt;/p&gt;

&lt;p&gt;As you can see this has nothing to do with #renderHead().&lt;/p&gt;</comment>
                            <comment id="13625805" author="mgrigorov" created="Mon, 8 Apr 2013 21:00:51 +0000"  >&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13625814" author="mgrigorov" created="Mon, 8 Apr 2013 21:08:28 +0000"  >&lt;p&gt;Thanks, Cedric!&lt;/p&gt;</comment>
                            <comment id="13625818" author="cedricgatay" created="Mon, 8 Apr 2013 21:11:56 +0000"  >&lt;p&gt;I&apos;m glad it is finally fixed. Looking forward to help fixing more &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12626744">WICKET-4959</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12574087" name="5104.zip" size="26467" author="mscoon" created="Sun, 17 Mar 2013 22:05:49 +0000"/>
                            <attachment id="12575227" name="fix-WICKET-5104.patch" size="937" author="cedricgatay" created="Sun, 24 Mar 2013 13:51:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>317952</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 32 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1iv27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>318293</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>