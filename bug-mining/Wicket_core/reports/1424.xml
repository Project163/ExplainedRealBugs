<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:25:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-6506] Performance issue when large component isn&apos;t visible</title>
                <link>https://issues.apache.org/jira/browse/WICKET-6506</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Okay, so here&apos;s the situation, I have a component where an Ajax request displays a large table (1000ish rows).  It display fast, no problem, not a great use of resources (not paginating), but ignore that for now.  I then have another Ajax request where I tell the wicket component to not be visible and refresh an area.  No problem so far (although slightly slow, since it&apos;s not generating much html, should be faster).  Now EVERY Ajax request that updates the same area (with the component not in the html) takes a long time to respond (half second), even though it should be returning in ms, because the html is pretty minimal.&lt;/p&gt;

&lt;p&gt;I hooked it up to a profiler and found that it&apos;s spending a large amount of CPU time in &lt;em&gt;MarkupContainer$MarkupChildIterator.refreshInternalIteratorIfNeeded()&lt;/em&gt;. I&apos;m not sure why it would be traversing the component hierarchy of the table that&apos;s not even visible&#8230;but I don&apos;t know enough of the architecture of wicket to really say&#8230;which is why I&apos;ve come here. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ve gone back to 7.1.0 and can confirm that in that version this &quot;problem&quot; does not exist.  The Ajax request is as fast as if I&apos;ve never loaded the large table.&lt;/p&gt;

&lt;p&gt;So I&apos;ve attached a Quickstart showing the problem (currently configured for 8.0.0-M8, but can be complied down to 7.0.0).  When loading the page, first click the refresh link&#8230;this will essentially refresh all the contents in an Ajax request and give you a sense of how fast it &lt;em&gt;should&lt;/em&gt; be.  The table has not been visible yet, so there have been no ListView items created yet.  Then click &quot;show table&quot;, this will generate 2k dummy rows and redisplay the area.  It&apos;s obviously slower because it&apos;s generating 350k of html (but surprisingly fast &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;).  Then click hide table.  It takes about the same amount of time to hide the table as it does to show it, which is odd, because the html being regenerated is the same as if there were no table displayed.  Then go ahead and click &quot;refresh&quot; and you&apos;ll see that refreshing a basically empty component is slow because it&apos;s referencing all the components in the wicket hierarchy (MarkupChildIterator.refreshInternalIteratorIfNeeded) even though they&apos;re not visible.&lt;/p&gt;

&lt;p&gt;This affects all versions from 7.2.0 and onward.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13124744">WICKET-6506</key>
            <summary>Performance issue when large component isn&apos;t visible</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="papegaaij">Emond Papegaaij</assignee>
                                    <reporter username="varscsak">Lon Varscsak</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Dec 2017 17:29:13 +0000</created>
                <updated>Tue, 6 Feb 2018 12:52:33 +0000</updated>
                            <resolved>Tue, 19 Dec 2017 13:20:46 +0000</resolved>
                                    <version>7.2.0</version>
                    <version>8.0.0-M8</version>
                                    <fixVersion>7.10.0</fixVersion>
                    <fixVersion>8.0.0-M9</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16291091" author="jira-bot" created="Thu, 14 Dec 2017 16:06:01 +0000"  >&lt;p&gt;Commit 0dc04e448ba31de15d8c32b1ee964bebed55bc36 in wicket&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6506&quot; title=&quot;Performance issue when large component isn&amp;#39;t visible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6506&quot;&gt;&lt;del&gt;WICKET-6506&lt;/del&gt;&lt;/a&gt; from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emond&quot; class=&quot;user-hover&quot; rel=&quot;emond&quot;&gt;emond&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=0dc04e4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=0dc04e4&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6506&quot; title=&quot;Performance issue when large component isn&amp;#39;t visible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6506&quot;&gt;&lt;del&gt;WICKET-6506&lt;/del&gt;&lt;/a&gt;: Fix performance regression&lt;/p&gt;

&lt;p&gt;Due to the way modcount == 0 was handled, the iterator was reinitialized&lt;br/&gt;
on every call to next. The fix is to no longer reset the modcount on&lt;br/&gt;
detach but increment it. This even fixed a corner case that was marked&lt;br/&gt;
in the tests.&lt;/p&gt;</comment>
                            <comment id="16291092" author="papegaaij" created="Thu, 14 Dec 2017 16:07:03 +0000"  >&lt;p&gt;As you can see, I&apos;ve probably found a solution for this problem. However, I want to discuss this with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dashorst&quot; class=&quot;user-hover&quot; rel=&quot;dashorst&quot;&gt;dashorst&lt;/a&gt; first.&lt;/p&gt;</comment>
                            <comment id="16291127" author="varscsak" created="Thu, 14 Dec 2017 16:26:35 +0000"  >&lt;p&gt;That&apos;s awesome, thanks Edmond.&lt;/p&gt;</comment>
                            <comment id="16296769" author="jira-bot" created="Tue, 19 Dec 2017 13:13:33 +0000"  >&lt;p&gt;Commit 0dc04e448ba31de15d8c32b1ee964bebed55bc36 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emond&quot; class=&quot;user-hover&quot; rel=&quot;emond&quot;&gt;emond&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=0dc04e4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=0dc04e4&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6506&quot; title=&quot;Performance issue when large component isn&amp;#39;t visible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6506&quot;&gt;&lt;del&gt;WICKET-6506&lt;/del&gt;&lt;/a&gt;: Fix performance regression&lt;/p&gt;

&lt;p&gt;Due to the way modcount == 0 was handled, the iterator was reinitialized&lt;br/&gt;
on every call to next. The fix is to no longer reset the modcount on&lt;br/&gt;
detach but increment it. This even fixed a corner case that was marked&lt;br/&gt;
in the tests.&lt;/p&gt;</comment>
                            <comment id="16296770" author="jira-bot" created="Tue, 19 Dec 2017 13:14:04 +0000"  >&lt;p&gt;Commit a352fe2befbbf6ce60c1d9617df34f54fa7190ac in wicket&apos;s branch refs/heads/wicket-7.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emond&quot; class=&quot;user-hover&quot; rel=&quot;emond&quot;&gt;emond&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=a352fe2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=a352fe2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6506&quot; title=&quot;Performance issue when large component isn&amp;#39;t visible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6506&quot;&gt;&lt;del&gt;WICKET-6506&lt;/del&gt;&lt;/a&gt;: Fix performance regression&lt;/p&gt;

&lt;p&gt;Due to the way modcount == 0 was handled, the iterator was reinitialized&lt;br/&gt;
on every call to next. The fix is to no longer reset the modcount on&lt;br/&gt;
detach but increment it. This even fixed a corner case that was marked&lt;br/&gt;
in the tests.&lt;/p&gt;</comment>
                            <comment id="16296775" author="papegaaij" created="Tue, 19 Dec 2017 13:20:46 +0000"  >&lt;p&gt;I&apos;ve pushed the fix for the performance regression. This speeds up rendering the table considerably (visible and invisible).&lt;/p&gt;

&lt;p&gt;The refresh is still much slower after rendering the table at least once. This is caused by how ListView works. A ListView creates its items on first render. Even when the ListView is not visible anymore, these items still need to be processed during rendering (for example detached) and this takes time. To get back to the fast state, you have to call ListView.removeAll() when its made invisible to remove all its children.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12901917" name="slownesstest.tar.gz" size="23713" author="varscsak" created="Wed, 13 Dec 2017 17:24:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 47 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3nvb3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>