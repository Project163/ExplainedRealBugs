<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:23:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-5569] Unable to find markup for children of deeply nested IComponentResolvers during Ajax response</title>
                <link>https://issues.apache.org/jira/browse/WICKET-5569</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Component hierarchy: Page -&amp;gt; WebMarkupContainer -&amp;gt; IComponentResolver (that uses Page to resolve) and Page -&amp;gt; Panel.&lt;/p&gt;

&lt;p&gt;Markup hierarchy: Page -&amp;gt; WebMarkupContainer -&amp;gt; IComponentResolver -&amp;gt; Panel.&lt;/p&gt;

&lt;p&gt;When rendering whole page, it works, because it is markup driven. Wicket encounters ComponentTag for Panel and resolves the Panel using IComponentResolver, which retrieves the Panel from the Page.&lt;/p&gt;

&lt;p&gt;When you add the Panel to an AjaxRequestTarget, the render is component driven. In order to render the Panel, we must retrieve the markup for the Panel from its parent MarkupContainer, which happens to be the Page.&lt;/p&gt;

&lt;p&gt;Markup.java around line 230 skips to closing tags of ComponentTag, so when Page gets to the opening tag of the WebMarkupContainer, it skips to the closing tag of the WebMarkupContainer, and so passes over the ComponentTag for Panel without noticing it. There is actually another check, in DefaultMarkupSourcingStrategy, that tries to fetch from all the &quot;transparent&quot; components in the markup container, but this is not good enough, because in our example, the IComponentResolver is not actually a direct child of the Panel&apos;s parent, to it is never used to try find the markup.&lt;/p&gt;

&lt;p&gt;One solution might be to traverse the tree, and attempt to find the markup from all IComponentResolving MarkupContainers, but we should be careful. I&apos;m a bit concerned at how various parts of Wicket just assume that an IComponentResolver is transparent and resolves from its direct parent only.&lt;/p&gt;

&lt;p&gt;If we do go down the route of traversing the tree to find IComponentResolvers, then try find the markup from each of them, we really should add a check in AbstractMarkupSourcingStrategy#searchMarkupInTransparentResolvers() to check that the Component that the IComponentResolver resolves for the markup id is the same component for which we are looking for markup.&lt;/p&gt;

&lt;p&gt;This is a difficult one. I am working around it for the mean time, just recording the difficulty here. Will try make a patch when I can.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12709761">WICKET-5569</key>
            <summary>Unable to find markup for children of deeply nested IComponentResolvers during Ajax response</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="jesselong">Jesse Long</reporter>
                        <labels>
                    </labels>
                <created>Tue, 22 Apr 2014 13:15:36 +0000</created>
                <updated>Wed, 15 Oct 2014 08:07:09 +0000</updated>
                            <resolved>Mon, 26 May 2014 19:45:01 +0000</resolved>
                                    <version>6.14.0</version>
                                    <fixVersion>6.16.0</fixVersion>
                    <fixVersion>7.0.0-M2</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13982446" author="jesselong" created="Sun, 27 Apr 2014 20:03:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5569&quot; title=&quot;Unable to find markup for children of deeply nested IComponentResolvers during Ajax response&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5569&quot;&gt;&lt;del&gt;WICKET-5569&lt;/del&gt;&lt;/a&gt;-1.patch&lt;/p&gt;

&lt;p&gt;Patch against Wicket 6. This solution uses the visitor pattern to traverse all children of the markup container to find descendants which are both MarkupContainers and IComponentResolvers. It then attempts to retrieve markup for the component from the MarkupContainer. If markup is found, a the IComponentResolver interface of the MarkupContainer is used to resolve the Component for that markup to ensure that we get the correct markup fragment.&lt;/p&gt;

&lt;p&gt;The exact implementation is supposed to match that of MarkupContainer#renderNext(). Please note that MarkupContainer#renderNext() is not final. I think it should be.&lt;/p&gt;

&lt;p&gt;I added a comment asking whether or not it is safe to assume that MarkupStream#atTag() would return true. I&apos;m not sure, please check and fix if my assumption is wrong.&lt;/p&gt;

&lt;p&gt;Included are tests.&lt;/p&gt;</comment>
                            <comment id="13982451" author="jesselong" created="Sun, 27 Apr 2014 20:13:01 +0000"  >&lt;p&gt;More on MarkupContainer#renderNext(). It is marked as not part of the public API, and is protected. Nothing in Wicket overrides this method, and I cant see how anyone would want to override it without a lot of copy and paste.&lt;/p&gt;

&lt;p&gt;The specific part I care about in the context of this issue is: when an attempting to resolve a component, first try get(String) from the MarkupContainer, then, if that did not work, try resolve using IComponentResolvers. This is the current behavior, and my patch does the same. However, if we allow custom ways of resolving components (non-final MarkupContainer#renderNext()) then the patch will not always be correct. I dont think that any custom resolving is necessary outside of what IComponentResolver provides, so I think MarkupContainer#renderNext() should be made final.&lt;/p&gt;</comment>
                            <comment id="13989667" author="jesselong" created="Mon, 5 May 2014 16:19:22 +0000"  >&lt;p&gt;Please dont apply this patch yet, I think that have a better solution by changing Markup#find() and MarkupFragment#find(). Will update once implemented and tested.&lt;/p&gt;</comment>
                            <comment id="13990541" author="jesselong" created="Tue, 6 May 2014 11:12:24 +0000"  >&lt;p&gt;I have proposed the alternative solution by modifying Markup#find() as &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5580&quot; title=&quot;Allow markup to find child fragments when wicket:child is inside a component tag&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5580&quot;&gt;&lt;del&gt;WICKET-5580&lt;/del&gt;&lt;/a&gt;. While the &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5580&quot; title=&quot;Allow markup to find child fragments when wicket:child is inside a component tag&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5580&quot;&gt;&lt;del&gt;WICKET-5580&lt;/del&gt;&lt;/a&gt; solution will solve my specific needs as far as &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5569&quot; title=&quot;Unable to find markup for children of deeply nested IComponentResolvers during Ajax response&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5569&quot;&gt;&lt;del&gt;WICKET-5569&lt;/del&gt;&lt;/a&gt; is concerned, there is still a theoretical problem to be solved with &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5569&quot; title=&quot;Unable to find markup for children of deeply nested IComponentResolvers during Ajax response&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5569&quot;&gt;&lt;del&gt;WICKET-5569&lt;/del&gt;&lt;/a&gt;. I still think that AbstractMarkupSourcingStrategy#searchMarkupInTransparentResolvers() is better with the &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5569&quot; title=&quot;Unable to find markup for children of deeply nested IComponentResolvers during Ajax response&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5569&quot;&gt;&lt;del&gt;WICKET-5569&lt;/del&gt;&lt;/a&gt; patch applied, but it it will be used less with &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5580&quot; title=&quot;Allow markup to find child fragments when wicket:child is inside a component tag&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5580&quot;&gt;&lt;del&gt;WICKET-5580&lt;/del&gt;&lt;/a&gt; patch applied.&lt;/p&gt;</comment>
                            <comment id="14009052" author="mgrigorov" created="Mon, 26 May 2014 19:45:01 +0000"  >&lt;p&gt;I&apos;ve improved a bit your patch and applied it.&lt;br/&gt;
Thanks again for your contributions!&lt;/p&gt;</comment>
                            <comment id="14172112" author="jira-bot" created="Wed, 15 Oct 2014 07:46:36 +0000"  >&lt;p&gt;Commit a4ae23c635b6e8f71d9e616fbc22f60c74e176d0 in wicket&apos;s branch refs/heads/wicket-6.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jesselong&quot; class=&quot;user-hover&quot; rel=&quot;jesselong&quot;&gt;jesselong&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=a4ae23c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=a4ae23c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Avoid visiting some children more than once when searching for markup of a child.&lt;/p&gt;

&lt;p&gt;When the ComponentTag of a child Component is nested inside a sibling&lt;br/&gt;
Component&apos;s ComponentTag,&lt;br/&gt;
AssociatedMarkupSourcingStrategy.searchMarkupInTransparentResolvers() is&lt;br/&gt;
called to attempt find the markup from inside component resolving markup&lt;br/&gt;
containers.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5569&quot; title=&quot;Unable to find markup for children of deeply nested IComponentResolvers during Ajax response&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5569&quot;&gt;&lt;del&gt;WICKET-5569&lt;/del&gt;&lt;/a&gt; introduced behavior to use the visitor pattern to traverse&lt;br/&gt;
the Component tree and find these component resolving markup containers&lt;br/&gt;
however nested they may be.&lt;/p&gt;

&lt;p&gt;Since the highest (page-most) component resolving markup container&lt;br/&gt;
component tree will probably cause a call to&lt;br/&gt;
searchMarkupInTransparentResolvers() if the markup is not found, there&lt;br/&gt;
is no need to descend any deeper than the first component resolving&lt;br/&gt;
markup container in that method.&lt;/p&gt;</comment>
                            <comment id="14172113" author="jira-bot" created="Wed, 15 Oct 2014 07:46:56 +0000"  >&lt;p&gt;Commit a9e82296a772d35b5d07900d5946e2cbdeb05a64 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jesselong&quot; class=&quot;user-hover&quot; rel=&quot;jesselong&quot;&gt;jesselong&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=a9e8229&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=a9e8229&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Avoid visiting some children more than once when searching for markup of a child.&lt;/p&gt;

&lt;p&gt;When the ComponentTag of a child Component is nested inside a sibling&lt;br/&gt;
Component&apos;s ComponentTag,&lt;br/&gt;
AssociatedMarkupSourcingStrategy.searchMarkupInTransparentResolvers() is&lt;br/&gt;
called to attempt find the markup from inside component resolving markup&lt;br/&gt;
containers.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5569&quot; title=&quot;Unable to find markup for children of deeply nested IComponentResolvers during Ajax response&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5569&quot;&gt;&lt;del&gt;WICKET-5569&lt;/del&gt;&lt;/a&gt; introduced behavior to use the visitor pattern to traverse&lt;br/&gt;
the Component tree and find these component resolving markup containers&lt;br/&gt;
however nested they may be.&lt;/p&gt;

&lt;p&gt;Since the highest (page-most) component resolving markup container&lt;br/&gt;
component tree will probably cause a call to&lt;br/&gt;
searchMarkupInTransparentResolvers() if the markup is not found, there&lt;br/&gt;
is no need to descend any deeper than the first component resolving&lt;br/&gt;
markup container in that method.&lt;/p&gt;

&lt;p&gt;(cherry picked from commit a4ae23c635b6e8f71d9e616fbc22f60c74e176d0)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12743728">WICKET-5709</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12642151" name="WICKET-5569-1.patch" size="8600" author="jesselong" created="Sun, 27 Apr 2014 20:03:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>388083</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 5 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1uuov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>388341</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>