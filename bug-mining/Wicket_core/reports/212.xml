<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:18:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-3730] extremely slow performance in development mode</title>
                <link>https://issues.apache.org/jira/browse/WICKET-3730</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;I just finished migrating application to 1.5 and it became VERY unresponsive and slow in development mode. In &lt;del&gt;deployment&lt;/del&gt; it is OK.&lt;/p&gt;

&lt;p&gt;No changes were made to backend services, only necessary Wicket API use changes related to request cycle.&lt;/p&gt;


&lt;p&gt;=======================&lt;br/&gt;
Below is the originals bug: &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3194&quot; title=&quot;IResourceSettings.setUseTimestampOnResources(true) and performance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3194&quot;&gt;&lt;del&gt;WICKET-3194&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Hello, &lt;br/&gt;
I had a problem with slow loading of pages and response to ajax requests. After some debugging I traced the problem to be that wicket constantly tries: &lt;/p&gt;

&lt;p&gt;DEBUG - UrlResourceStream          - cannot convert url: jar:&lt;a href=&quot;file:/C:/Users/hok/.m2/repository/org/apache/wicket/wicket/1.5-M3/wicket-1.5-M3.jar!/org/apache/wicket/markup/html/wicket-event.js&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/C:/Users/hok/.m2/repository/org/apache/wicket/wicket/1.5-M3/wicket-1.5-M3.jar!/org/apache/wicket/markup/html/wicket-event.js&lt;/a&gt; to file (URI is not hierarchical), falling back to the inputstream for polling &lt;br/&gt;
DEBUG - ResourceStreamLocator      - Attempting to locate resource &apos;org/apache/wicket/markup/html/wicket-event_en_US.js&apos; on path [folders = [], webapppaths: []] &lt;br/&gt;
DEBUG - ResourceStreamLocator      - Attempting to locate resource &apos;org/apache/wicket/markup/html/wicket-event_en_US.js&apos; using classloader sun.misc.Launcher$AppClassLoader@cac268 &lt;/p&gt;

&lt;p&gt;and this happens because that by default (or at least I think so) wicket adds timestamp on the resources - ResourceSettings.setUseTimestampOnResources(true) and every resource is read from the jar files on every request. When a resource is in a jar file a java.lang.IllegalArgumentException: URI is not hierarchical is thrown in the UrlResourceStream constructor and a lot of attempts are made to load the jar file through different loaders. In my case this led to a slow response times. &lt;br/&gt;
After disabling timestamp on resources (ResourceSettings.setUseTimestampOnResources(false)) the problem disappears and the performance is fine. However in the javadoc of setUseTimestampOnResources: &lt;/p&gt;

&lt;p&gt;Enabling timestamps on resources will inject the last modification time of the resource into the filename (the name will look something like &apos;style-ts1282915831000.css&apos; where the large number is the last modified date in milliseconds and &apos;-ts&apos; is a prefix to avoid conflicts with filenames that already contain a number before their extension. * &lt;/p&gt;

&lt;p&gt;Since browsers and proxies use the filename of the resource as a cache key the changed filename will not hit the cache and the page gets rendered with the changed file.&lt;/p&gt;

&lt;p&gt;In this case this useful functionality is lost. Is it possible to have &quot;the best of both worlds&quot;? Thanks.&lt;/p&gt;

&lt;p&gt;This issue is raised from the discussion:&lt;br/&gt;
&lt;a href=&quot;http://apache-wicket.1842946.n4.nabble.com/IResourceSettings-setUseTimestampOnResources-true-and-performance-td3057946.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://apache-wicket.1842946.n4.nabble.com/IResourceSettings-setUseTimestampOnResources-true-and-performance-td3057946.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To observe the performance improvement, please change&lt;br/&gt;
getResourceSettings().setUseTimestampOnResources(true);&lt;br/&gt;
to&lt;br/&gt;
getResourceSettings().setUseTimestampOnResources(false);&lt;br/&gt;
in TestApplication. It&apos;s most obvious when you press Refresh All link and observe the time for the refresh in both cases&lt;/p&gt;
</description>
                <environment>OS X, java 1.6</environment>
        <key id="12507798">WICKET-3730</key>
            <summary>extremely slow performance in development mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="kgignatyev">Konstantin Ignatyev</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 May 2011 18:57:03 +0000</created>
                <updated>Fri, 20 May 2011 14:15:27 +0000</updated>
                            <resolved>Fri, 20 May 2011 14:15:27 +0000</resolved>
                                    <version>1.5-RC4</version>
                                    <fixVersion>1.5-RC5</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13036391" author="mgrigorov" created="Thu, 19 May 2011 19:26:41 +0000"  >&lt;p&gt;Another thing that slows down is org.apache.wicket.settings.def.ResourceSettings.getResourceStreamLocator().&lt;br/&gt;
It caches only in DEPLOYMENT mode.&lt;/p&gt;</comment>
                            <comment id="13036392" author="mgrigorov" created="Thu, 19 May 2011 19:27:35 +0000"  >&lt;p&gt;Our app is also relatively big but I cannot say it is extremely slow in DEV mode.&lt;/p&gt;</comment>
                            <comment id="13036397" author="kgignatyev" created="Thu, 19 May 2011 19:33:36 +0000"  >&lt;p&gt;I have attached visual-vm screenshot, and the the 12 seconds accumulated - that is only ONE page request was performed. In W 1.4 in dev mode the request took about a second.&lt;/p&gt;</comment>
                            <comment id="13036406" author="kgignatyev" created="Thu, 19 May 2011 19:56:28 +0000"  >&lt;p&gt;CPU profiling was focused on Wicket package only&lt;/p&gt;</comment>
                            <comment id="13036710" author="mgrigorov" created="Fri, 20 May 2011 07:49:34 +0000"  >&lt;p&gt;The problem here is that org.apache.wicket.request.resource.caching.AbstractResourceCachingStrategy.getLastModified(ResourceReference) uses RequestCycle as holder of the cache for resourceReference-&amp;gt;lastModifiedTime. Thus it is recreated for each request and helps only in the case when the same resource is decorated several times in one request. An improvement here is to move the cache on application level and add logic to ModificationWatcher to clean the entry for each modified resource.&lt;/p&gt;</comment>
                            <comment id="13036717" author="mgrigorov" created="Fri, 20 May 2011 08:10:17 +0000"  >&lt;p&gt;The next problem is that ModificationWatcher actually doesn&apos;t watch for ResourceReferences&apos; resources and cannot clean this cache.&lt;br/&gt;
I don&apos;t see much value in this cache as it is now (RequestCycle scope). It would help only if the same ResRef is contributed by several components.&lt;br/&gt;
And I don&apos;t see differences in the configuration of the IResourceCachingStrategy for DEPLOYMENT and DEVELOPMENT mode, so the actual improvement is in CachingResourceStreamLocator which is used only in DEPLOYMENT mode.&lt;/p&gt;

&lt;p&gt;As an improvement I suggest to use RequestCycle cache for DEV mode and Application for DEPLOY mode and decide whether to use CachingResourceStreamLocator always. The downside of using CachingResourceStreamLocator in DEV mode is that the user app may have a typo in the name of the resource and this will be cached as a miss, then the developer may fix it and she will have to restart the app to see the fix ...&lt;/p&gt;</comment>
                            <comment id="13036720" author="pete" created="Fri, 20 May 2011 08:29:50 +0000"  >&lt;p&gt;+1 for caching on application level in deployment mode&lt;/p&gt;</comment>
                            <comment id="13036757" author="pete" created="Fri, 20 May 2011 10:14:38 +0000"  >&lt;p&gt;I added some optimization for retrieving the last modified timestamp on urls that point to local jar files. This will not solve this issue in general but eventually makes things a little faster (&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3732&quot; title=&quot;Optimize retrieval of last modification timestamp for urls that point to local files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3732&quot;&gt;&lt;del&gt;WICKET-3732&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="13036801" author="pete" created="Fri, 20 May 2011 12:50:04 +0000"  >&lt;p&gt;I also reworked the logic of UrlResourceStream: for retrieving last modified timestamps it should be noticeably faster now&lt;/p&gt;</comment>
                            <comment id="13036844" author="mgrigorov" created="Fri, 20 May 2011 14:15:27 +0000"  >&lt;p&gt;With r1125410 it should be the same in DEV and DEPLOY modes.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                            <outwardlinks description="is a clone of">
                                        <issuelink>
            <issuekey id="12480862">WICKET-3194</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12479822" name="ASF.LICENSE.NOT.GRANTED--screenshot-1.jpg" size="165802" author="kgignatyev" created="Thu, 19 May 2011 19:56:28 +0000"/>
                            <attachment id="12479820" name="ASF.LICENSE.NOT.GRANTED--screenshot-visualvm.jpg" size="140491" author="kgignatyev" created="Thu, 19 May 2011 19:30:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204474</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 27 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ka7b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116470</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>