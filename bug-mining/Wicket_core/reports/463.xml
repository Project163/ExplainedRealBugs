<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:19:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4256] onBeforeRender() is called on components that are not allowed to render</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4256</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;pasted from the list:&lt;/p&gt;

&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I ran into an odd problem this week. A model fed to a ListView was&lt;br/&gt;
calling service methods the current user wasn&apos;t allowed to use, and I&lt;br/&gt;
was wondering how that could happen. A panel far above this ListView in&lt;br/&gt;
the hierarchy had been secured (using Shiro annotations, but that turns&lt;br/&gt;
out to not matter at all) and was not supposed to be rendered for this&lt;br/&gt;
user. From this I had expected the ListView not to be rendered either,&lt;br/&gt;
but here it was trying to assemble itself in onBeforeRender and thus&lt;br/&gt;
calling the &quot;forbidden&quot; service methods.&lt;/p&gt;

&lt;p&gt;I investigated Component and friends for a bit, and have found a&lt;br/&gt;
potential problem.&lt;/p&gt;

&lt;p&gt;internalBeforeRender() checks determineVisibility() before doing&lt;br/&gt;
anything. So far so good. determineVisibility() then checks&lt;br/&gt;
isRenderAllowed() so the application&apos;s IAuthorizationStrategy can block&lt;br/&gt;
certain components. This is where it goes wrong though:&lt;br/&gt;
isRenderAllowed() only looks at FLAG_IS_RENDER_ALLOWED for performance&lt;br/&gt;
reasons, and that flag hasn&apos;t been set yet! internalPrepareForRender()&lt;br/&gt;
only calls setRenderAllowed() &lt;b&gt;after&lt;/b&gt; beforeRender().&lt;/p&gt;

&lt;p&gt;Due to this, the supposedly secure panel was going through its own&lt;br/&gt;
beforeRender and thus calling that ListView&apos;s beforeRender.&lt;/p&gt;

&lt;p&gt;I think this can be a serious problem, such as in my case described&lt;br/&gt;
above. I&apos;d expect that if isActionAuthorized(RENDER) is false, the&lt;br/&gt;
secured component should basically never get to the beforeRender phase.&lt;br/&gt;
My questions are now:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Is this intentional? If yes, please explain the reasoning behind it,&lt;br/&gt;
 because it isn&apos;t obvious to me.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;If not, can we fix it? My intuitive suggestion would be to simply&lt;br/&gt;
 move the call to setRenderAllowed() from the end of&lt;br/&gt;
 internalBeforeRender() (prepareForRender in 1.4) to the beginning of&lt;br/&gt;
 that method, so beforeRender() can reliably look at that flag.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;If we can fix it, when and where do we fix it? This hit me in 1.4,&lt;br/&gt;
 and looking at the code it&apos;s still there in 1.5. I&apos;d &lt;b&gt;really&lt;/b&gt; like it&lt;br/&gt;
 fixed in the last 1.4 release, and certainly in 1.5, given that this&lt;br/&gt;
 has the potential to impact security.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; It&apos;s not an API break, but I&apos;m not sure whether the implications for&lt;br/&gt;
 application behavior are tolerable for all existing applications. On&lt;br/&gt;
 the other hand, it seems to be a real security problem, so maybe the&lt;br/&gt;
 change is justified. I&apos;d like some core dev opinions please &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;If this is in fact a bug, I&apos;m of course willing to provide a ticket and&lt;br/&gt;
a patch &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;Carl-Eric&lt;br/&gt;
www.wicketbuch.de&lt;/p&gt;</description>
                <environment></environment>
        <key id="12532431">WICKET-4256</key>
            <summary>onBeforeRender() is called on components that are not allowed to render</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ivaynberg">Igor Vaynberg</assignee>
                                    <reporter username="ivaynberg">Igor Vaynberg</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Nov 2011 06:33:13 +0000</created>
                <updated>Tue, 17 Jan 2012 08:38:43 +0000</updated>
                            <resolved>Wed, 23 Nov 2011 06:46:25 +0000</resolved>
                                    <version>1.5.3</version>
                                    <fixVersion>1.5.4</fixVersion>
                    <fixVersion>6.0.0-beta1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                    <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12538604">WICKET-4340</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>218164</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0k8xj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116264</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>