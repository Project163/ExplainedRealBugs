<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:22:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4997] Mounted bookmarkable Page not recreated on Session Expiry</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4997</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;With the default true of org.apache.wicket.settings.IPageSettings#getRecreateMountedPagesAfterExpiry() PageExpiryException is thrown when a Link on a page is clicked.&lt;/p&gt;

&lt;p&gt;I find it very useful and in fact indispensible to rely on RecreateMountedPagesAfterExpiry especially on logout links.&lt;/p&gt;

&lt;p&gt;But it doesn&apos;t seem to work for me in 6.4.0. I think this is because Link#getUrl() calls Component#utlFor() which requires a stateless page for this to work:&lt;/p&gt;

&lt;p&gt;		if (page.isPageStateless())&lt;/p&gt;
		{
			handler = new BookmarkableListenerInterfaceRequestHandler(provider, listener);
		}
&lt;p&gt;		else&lt;/p&gt;
		{
			handler = new ListenerInterfaceRequestHandler(provider, listener);
		}

&lt;p&gt;With a stateless page a url is:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8080/wicket/HomePage?-1.ILinkListener-toolBar-signout&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/wicket/HomePage?-1.ILinkListener-toolBar-signout&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;With a non stateless but bookmarkable page a url is:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8080/wicket/page?1-1.ILinkListener-toolBar-signout&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/wicket/page?1-1.ILinkListener-toolBar-signout&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So I guess that a stateful page cannot be recovered because after session expiry Wicket cannot find out what the page is. It is not coded in the URL.&lt;/p&gt;

&lt;p&gt;Looking at the semantics of UrlFor(), I thought this might be a bug and I copied and changed the code in my Link subclass from&lt;/p&gt;

&lt;p&gt;//		if (page.isPageStateless()) {&lt;br/&gt;
to:&lt;br/&gt;
        if (page.isBookmarkable()) {&lt;/p&gt;

&lt;p&gt;It works as expected but I don&apos;t know whether it would break other things if implemented in Wicket.&lt;/p&gt;

&lt;p&gt;I guess I am not the only one who needs recovery for bookmarkable pages in this way. Would it be possible to change Wicket to fix this so it becomes possible?&lt;/p&gt;</description>
                <environment>JDK 7, GlassFish 3.1.2.2</environment>
        <key id="12628616">WICKET-4997</key>
            <summary>Mounted bookmarkable Page not recreated on Session Expiry</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="papegaaij">Emond Papegaaij</assignee>
                                    <reporter username="bht@actrix.gen.nz">bernard</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Jan 2013 21:19:23 +0000</created>
                <updated>Wed, 28 Jan 2015 07:52:40 +0000</updated>
                            <resolved>Tue, 26 Nov 2013 08:16:31 +0000</resolved>
                                    <version>6.4.0</version>
                                    <fixVersion>6.13.0</fixVersion>
                    <fixVersion>7.0.0-M1</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13561395" author="bht@actrix.gen.nz" created="Thu, 24 Jan 2013 03:48:44 +0000"  >&lt;p&gt;Test case&lt;/p&gt;</comment>
                            <comment id="13736197" author="bht@actrix.gen.nz" created="Sun, 11 Aug 2013 05:16:36 +0000"  >&lt;p&gt;I changed Component#urlFor() in 6.9.2 with good success. This eliminates PageExpiredException for bookmarkable pages. &lt;/p&gt;

&lt;p&gt;There are many cosmetic test failures due to a different expectation of the target URL in the generated responses: Instead of &quot;wicket/page?0-1.IBehaviorListener.0-test&quot; we should expect a more specific value &quot;wicket/bookmarkable/org.apache.wicket.ajax.DomReadyOrderPage?0-1.IBehaviorListener.0-test&quot;, or a mounted path.&lt;/p&gt;

&lt;p&gt;I have made real pages in a quickstart out of some test cases - they work fine. Test cases that expect PageExpiredException should no longer do so because of the improvement.&lt;/p&gt;

&lt;p&gt;We can expect a performance improvement because Page#isPageStateless(), called for every generated URL on the page is very expensive compared with Page#isBookmarkable().&lt;/p&gt;
</comment>
                            <comment id="13743858" author="papegaaij" created="Mon, 19 Aug 2013 14:38:27 +0000"  >&lt;p&gt;I&apos;ve pushed a branch (wicket-4997) against 6.x with a proposed fix for this issue. A problem I&apos;m facing is that urls for mounted pages with required page parameters are rendered as bookmarkable urls (wicket/bookmarkable) when recreateMountedPagesAfterExpiry is disabled. This can be prevented by overriding isBookmarkable on the page (see PageWithLink), but I&apos;m not sure if that&apos;s a good thing or not.&lt;/p&gt;</comment>
                            <comment id="13744055" author="bht@actrix.gen.nz" created="Mon, 19 Aug 2013 17:47:12 +0000"  >&lt;p&gt;Thanks Emond.&lt;/p&gt;

&lt;p&gt;Yes, I agree with your concerns. Have you tried Page#wasCreatedBookmarkable instead? I have just discoverd this on line 384 in AbstractBookmarkableMapper#mapHandler&lt;/p&gt;

&lt;p&gt;			if (checkPageInstance(page) &amp;amp;&amp;amp;&lt;br/&gt;
				(!pageMustHaveBeenCreatedBookmarkable() || page.wasCreatedBookmarkable()))&lt;br/&gt;
			{&lt;/p&gt;

&lt;p&gt;I was getting second thoughts about using Page#isBookmarkable() because it creates a bookmarkable URL for an unmounted page that was in fact created by a non-bookmarkable constructor i.e. with IModel parameter as provided with the test case. Sorry if I first suggested the wrong approach.&lt;/p&gt;</comment>
                            <comment id="13744098" author="bht@actrix.gen.nz" created="Mon, 19 Aug 2013 18:42:21 +0000"  >&lt;p&gt;On the other hand expiry in the non-bookmarkable constructor case can be handled nicely in the constructor with a customised response so Page#isBookmarkable() is more flexible and less disrupting to the user. We just don&apos;t want PageExpiredException. That weakens the point in my last comment.&lt;/p&gt;

&lt;p&gt;In other words if the developer codes bookmarkable constructors then these constructors must be supported properly i.e. validated.&lt;/p&gt;

&lt;p&gt;This is the kind of scenario that makes me I think that Wicket should call a no-args page constructor instead of creating bogus PageParameters, if no PageParameters are provided.&lt;/p&gt;

&lt;p&gt;Also, regarding your concern, there is still an outstanding issue &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5068&quot; title=&quot;PageParameters missing from re-created Page&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5068&quot;&gt;&lt;del&gt;WICKET-5068&lt;/del&gt;&lt;/a&gt;. When we get the PageParameters back, then there is less motivation to prevent the page from being re-created.&lt;/p&gt;


&lt;p&gt;BTW this fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5043&quot; title=&quot;Page not mounted with WebApplication#mountPackage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5043&quot;&gt;&lt;del&gt;WICKET-5043&lt;/del&gt;&lt;/a&gt; which is essentially a duplicate of this issue.&lt;/p&gt;</comment>
                            <comment id="13745862" author="bht@actrix.gen.nz" created="Wed, 21 Aug 2013 08:11:26 +0000"  >&lt;p&gt;Some source files in a zip archive for consideration.&lt;/p&gt;

&lt;p&gt;I think that WebResponseExceptionsTest#expirePage must fail with a bookmarkable TestExpirePage because clicking the link should re-create the page. That is why I changed it to be non-bookmarkable.&lt;/p&gt;

&lt;p&gt;We still need a trivial additional test that positively verifies that a bookmarkable page does NOT expire with PageExpiredException but with the same page re-created after session expiry.&lt;/p&gt;</comment>
                            <comment id="13745865" author="papegaaij" created="Wed, 21 Aug 2013 08:18:49 +0000"  >&lt;p&gt;Please provide code changes in unified diff format and in this case against the wicket-4997 branch. The easiest way to create a diff is using git diff.&lt;/p&gt;</comment>
                            <comment id="13745872" author="bht@actrix.gen.nz" created="Wed, 21 Aug 2013 08:31:04 +0000"  >&lt;p&gt;I can see a lot of remote branches but can&apos;t see that 4997 remote branch in my git client. I don&apos;t have much experience with git. What else can I do?&lt;/p&gt;</comment>
                            <comment id="13745875" author="papegaaij" created="Wed, 21 Aug 2013 08:41:33 +0000"  >&lt;p&gt;The branch is there (you can also see it on the github mirror). Perhaps you need to fetch it.&lt;/p&gt;</comment>
                            <comment id="13745877" author="bht@actrix.gen.nz" created="Wed, 21 Aug 2013 08:51:33 +0000"  >&lt;p&gt;I have fetched the branch. What is the diff command please?&lt;/p&gt;</comment>
                            <comment id="13749076" author="bht@actrix.gen.nz" created="Fri, 23 Aug 2013 22:18:48 +0000"  >&lt;p&gt;Please see the attached 6 files. I changed only 4  main source files in addition to the obvious Component. MountedMapper#mapHandler now additionally handles BookmarkableListenerInterfaceRequestHandler via a new interface IListenerInterfaceRequestHandler which is implemented by BookmarkableListenerInterfaceRequestHandler and ListenerInterfaceRequestHandler.&lt;/p&gt;

&lt;p&gt;Wicket needs this to add the bookmarkable URL component to link URLs to avoid PageExpiredException for bookmarkable pages.&lt;/p&gt;</comment>
                            <comment id="13749557" author="bht@actrix.gen.nz" created="Sun, 25 Aug 2013 07:27:02 +0000"  >&lt;p&gt;Hi Emond,&lt;/p&gt;

&lt;p&gt;Many thanks again. The results of your changes look good to me. The tests look fine, too. I may have overlooked a couple of things or looked at an older version.&lt;/p&gt;</comment>
                            <comment id="13832400" author="papegaaij" created="Tue, 26 Nov 2013 08:16:31 +0000"  >&lt;p&gt;We now use the following condition to render bookmarkable urls:&lt;br/&gt;
getApplication().getPageSettings().getRecreateMountedPagesAfterExpiry() &amp;amp;&amp;amp; ((page.isBookmarkable() &amp;amp;&amp;amp; page.wasCreatedBookmarkable()) || page.isPageStateless())&lt;/p&gt;

&lt;p&gt;This results in bookmarkable urls for pages that are bookmarkable and were created bookmarkable. These pages can be recreated after session expiry.&lt;/p&gt;</comment>
                            <comment id="13832890" author="bht@actrix.gen.nz" created="Tue, 26 Nov 2013 19:02:42 +0000"  >&lt;p&gt;Emond, my big thanks for that!&lt;/p&gt;</comment>
                            <comment id="14294839" author="imeleshkov" created="Wed, 28 Jan 2015 07:46:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=papegaaij&quot; class=&quot;user-hover&quot; rel=&quot;papegaaij&quot;&gt;papegaaij&lt;/a&gt; sorry for disturbing you, but, but I&apos;d like to get your opinion on few things related with commit bf43914fd7f0ed5ff57a56a82420cda76d3cbaee&lt;br/&gt;
Thus, &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;once you amend
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;Component.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (page.isBookmarkable())
{
    handler = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BookmarkableListenerInterfaceRequestHandler(provider, listener);
}
&lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
{
   handler = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ListenerInterfaceRequestHandler(provider, listener);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;,&lt;br/&gt;
does &quot;if conditon&quot;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;MountedMapper.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Url mapHandler(IRequestHandler requestHandler)
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (url == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; requestHandler &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; ListenerInterfaceRequestHandler &amp;amp;&amp;amp;
			getRecreateMountedPagesAfterExpiry())
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;can ever trigger?&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;if I dealing with stateless bookmarkable pages and buld link for the next page, for example, I have now something like &lt;tt&gt;/url?pageIdx=0&amp;amp;pageIdx=1&lt;/tt&gt;, does it meat that you expect me switch off &lt;tt&gt;recreateMountedPagesAfterExpiry&lt;/tt&gt; option? But it will means that my statefull bookmarkable pages won&apos;t be able to restore state if session expired.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks in advance.&lt;/p&gt;</comment>
                            <comment id="14294841" author="mgrigorov" created="Wed, 28 Jan 2015 07:52:40 +0000"  >&lt;p&gt;Please use users@wicket.apache.org for questions.&lt;br/&gt;
The description above is not very clear about your use case and the problem you face.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12635905">WICKET-5084</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12697655">WICKET-5521</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12566248" name="TestCase.zip" size="12316" author="bht@actrix.gen.nz" created="Thu, 24 Jan 2013 03:48:44 +0000"/>
                            <attachment id="12599140" name="WICKET-4997-bernard-sources.zip" size="45051" author="bht@actrix.gen.nz" created="Wed, 21 Aug 2013 08:11:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>307106</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 42 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1a5bb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>267327</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>