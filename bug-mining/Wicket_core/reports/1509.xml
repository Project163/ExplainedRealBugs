<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:25:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-6746] HttpsMapper cannot deal with resources over websockets</title>
                <link>https://issues.apache.org/jira/browse/WICKET-6746</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Wicket Examples WebSocket demo &quot;Initiate download with Web Socket message&quot; is broken in current master due to the new wicket-core.css:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ERROR - DefaultExceptionMapper     - unexpected exception when handling another exception: An error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; generating an Url &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; handler &lt;span class=&quot;code-quote&quot;&gt;&apos;ResourceReferenceRequestHandler{resourceReference=scope: org.apache.wicket.css.WicketCoreCSSResourceReference; name: wicket-core.css; locale: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; style: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; variation: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, pageParameters=}&apos;&lt;/span&gt;
org.apache.wicket.WicketRuntimeException: An error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; generating an Url &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; handler &lt;span class=&quot;code-quote&quot;&gt;&apos;ResourceReferenceRequestHandler{resourceReference=scope: org.apache.wicket.css.WicketCoreCSSResourceReference; name: wicket-core.css; locale: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; style: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; variation: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, pageParameters=}&apos;&lt;/span&gt;
	at org.apache.wicket.request.cycle.RequestCycle.urlFor(RequestCycle.java:560)
	at org.apache.wicket.markup.head.CssReferenceHeaderItem.getUrl(CssReferenceHeaderItem.java:151)
	at org.apache.wicket.markup.head.CssReferenceHeaderItem.getRenderTokens(CssReferenceHeaderItem.java:138)
	at org.apache.wicket.markup.head.internal.HeaderResponse.wasItemRendered(HeaderResponse.java:61)
	at org.apache.wicket.markup.head.internal.HeaderResponse.render(HeaderResponse.java:52)
	at org.apache.wicket.page.PartialPageUpdate$PartialHeaderResponse.render(PartialPageUpdate.java:702)
	at org.apache.wicket.markup.head.ResourceAggregator.renderHeaderItems(ResourceAggregator.java:339)
	at org.apache.wicket.markup.head.ResourceAggregator.close(ResourceAggregator.java:308)
	at org.apache.wicket.page.PartialPageUpdate.writeComponents(PartialPageUpdate.java:299)
	at org.apache.wicket.page.PartialPageUpdate.writeTo(PartialPageUpdate.java:167)
	at org.apache.wicket.protocol.ws.api.WebSocketRequestHandler.respond(WebSocketRequestHandler.java:239)
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:917)
	at org.apache.wicket.request.RequestHandlerExecutor.execute(RequestHandlerExecutor.java:63)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:283)
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:254)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:222)
	at org.apache.wicket.protocol.ws.api.AbstractWebSocketProcessor.broadcastMessage(AbstractWebSocketProcessor.java:260)
	at org.apache.wicket.protocol.ws.api.AbstractWebSocketProcessor.onMessage(AbstractWebSocketProcessor.java:148)
	at org.apache.wicket.protocol.ws.javax.JavaxWebSocketProcessor$StringMessageHandler.onMessage(JavaxWebSocketProcessor.java:65)
	at org.apache.wicket.protocol.ws.javax.JavaxWebSocketProcessor$StringMessageHandler.onMessage(JavaxWebSocketProcessor.java:60)
	at org.apache.tomcat.websocket.WsFrameBase.sendMessageText(WsFrameBase.java:395)
	at org.apache.tomcat.websocket.server.WsFrameServer.sendMessageText(WsFrameServer.java:119)
	at org.apache.tomcat.websocket.WsFrameBase.processDataText(WsFrameBase.java:495)
	at org.apache.tomcat.websocket.WsFrameBase.processData(WsFrameBase.java:294)
	at org.apache.tomcat.websocket.WsFrameBase.processInputBuffer(WsFrameBase.java:133)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:82)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:171)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:151)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:148)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:54)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:59)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1639)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:834)
Caused by: java.lang.IllegalStateException: Could not resolve protocol &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; request: org.apache.wicket.protocol.ws.api.ServletRequestCopy@5c61f8d8
	at org.apache.wicket.protocol.https.HttpsMapper.getSchemeOf(HttpsMapper.java:224)
	at org.apache.wicket.protocol.https.HttpsMapper.mapHandler(HttpsMapper.java:176)
	at org.apache.wicket.protocol.https.HttpsMapper.mapHandler(HttpsMapper.java:121)
	at org.apache.wicket.request.mapper.CompoundRequestMapper.mapHandler(CompoundRequestMapper.java:210)
	at org.apache.wicket.protocol.ws.api.WebSocketRequestMapper.mapHandler(WebSocketRequestMapper.java:61)
	at org.apache.wicket.request.cycle.RequestCycle.mapUrlFor(RequestCycle.java:454)
	at org.apache.wicket.request.cycle.RequestCycle.urlFor(RequestCycle.java:554)
	... 37 more
WARN  - WebSocketResponse          - An HTTP error response in WebSocket communication would not be processed by the browser! If you need to send the error code and message to the client then configure custom WebSocketResponse via WebSocketSettings#newWebSocketResponse() factory method and override #sendError() method to write them in an appropriate format &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; your application. The ignored error code is &lt;span class=&quot;code-quote&quot;&gt;&apos;500&apos;&lt;/span&gt; and the message: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&apos;&lt;/span&gt;.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13283685">WICKET-6746</key>
            <summary>HttpsMapper cannot deal with resources over websockets</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="papegaaij">Emond Papegaaij</assignee>
                                    <reporter username="mgrigorov">Martin Tzvetanov Grigorov</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Feb 2020 11:57:18 +0000</created>
                <updated>Tue, 11 Feb 2020 20:10:42 +0000</updated>
                            <resolved>Tue, 11 Feb 2020 18:14:11 +0000</resolved>
                                    <version>9.0.0-M4</version>
                                    <fixVersion>9.0.0-M5</fixVersion>
                    <fixVersion>8.8.0</fixVersion>
                                    <component>wicket</component>
                    <component>wicket-native-websocket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17031618" author="papegaaij" created="Thu, 6 Feb 2020 14:21:05 +0000"  >&lt;p&gt;This seems to be a more general issue with WebSocket. How does this work when a component is added to the WebSocketRequestHandler that renders a css or js HeaderItem? I&apos;m not entirely familiar with the Wicket WebSocket code, but my understanding is that &lt;tt&gt;onMessage&lt;/tt&gt; is sort of equivalent to methods like &lt;tt&gt;onClick&lt;/tt&gt; on &lt;tt&gt;AjaxLink&lt;/tt&gt;. Shouldn&apos;t it be possible to render components with {{HeaderItem}}s in this method?&lt;/p&gt;</comment>
                            <comment id="17033878" author="papegaaij" created="Mon, 10 Feb 2020 19:30:42 +0000"  >&lt;p&gt;I&apos;ve nailed the problem to &lt;tt&gt;HttpsMapper&lt;/tt&gt;. It doesn&apos;t understand the ws scheme and therefore cannot render the URL. Any websocket message that renders a resource breaks. The attached quickstart demonstrates the problem in 8.7.0. Removing the &lt;tt&gt;HttpsMapper&lt;/tt&gt; from &lt;tt&gt;JSR356Application&lt;/tt&gt; fixes the examples. Is this mapper really needed for this example?&lt;/p&gt;</comment>
                            <comment id="17034052" author="solomax" created="Tue, 11 Feb 2020 00:54:18 +0000"  >&lt;p&gt;Is it possible the CSS file is too big?&lt;br/&gt;
Maybe License header can be replaced with smaller one?&lt;/p&gt;</comment>
                            <comment id="17034067" author="solomax" created="Tue, 11 Feb 2020 01:28:45 +0000"  >&lt;p&gt;Or maybe the url for css should be absolute (with protocol)? &lt;/p&gt;</comment>
                            <comment id="17034169" author="papegaaij" created="Tue, 11 Feb 2020 06:49:41 +0000"  >&lt;p&gt;This doesn&apos;t have anything to do with the file itself. This will happen for any file, css, js, images. The HttpsMapper tries to determine if it should render a http or https scheme, but it doesn&apos;t know the ws scheme. I think it should just ignore these. However is this HttpsMapper still relevant when we have things like HSTS to force https?&lt;/p&gt;</comment>
                            <comment id="17034674" author="jira-bot" created="Tue, 11 Feb 2020 18:08:04 +0000"  >&lt;p&gt;Commit 0a8d941e922884e9d92efc673b4065e44fd508b0 in wicket&apos;s branch refs/heads/csp from Emond Papegaaij&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=wicket.git;h=0a8d941&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=wicket.git;h=0a8d941&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6746&quot; title=&quot;HttpsMapper cannot deal with resources over websockets&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6746&quot;&gt;&lt;del&gt;WICKET-6746&lt;/del&gt;&lt;/a&gt;: no need to resolve current scheme is desired is ANY&lt;/p&gt;

&lt;p&gt;Resolving the current scheme breaks on WebSocket requests when rendering&lt;br/&gt;
urls for resources, because HttpsMapper only knows http and https, not&lt;br/&gt;
ws.&lt;/p&gt;</comment>
                            <comment id="17034676" author="jira-bot" created="Tue, 11 Feb 2020 18:11:21 +0000"  >&lt;p&gt;Commit a868311d1875454129baac75e620a13c0311bb28 in wicket&apos;s branch refs/heads/master from Emond Papegaaij&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=wicket.git;h=a868311&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=wicket.git;h=a868311&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6746&quot; title=&quot;HttpsMapper cannot deal with resources over websockets&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6746&quot;&gt;&lt;del&gt;WICKET-6746&lt;/del&gt;&lt;/a&gt;: no need to resolve current scheme is desired is ANY&lt;/p&gt;

&lt;p&gt;Resolving the current scheme breaks on WebSocket requests when rendering&lt;br/&gt;
urls for resources, because HttpsMapper only knows http and https, not&lt;br/&gt;
ws.&lt;/p&gt;</comment>
                            <comment id="17034678" author="jira-bot" created="Tue, 11 Feb 2020 18:11:58 +0000"  >&lt;p&gt;Commit 689065dedc94e6327222009428af992ae70fb6b4 in wicket&apos;s branch refs/heads/wicket-8.x from Emond Papegaaij&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=wicket.git;h=689065d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=wicket.git;h=689065d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6746&quot; title=&quot;HttpsMapper cannot deal with resources over websockets&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6746&quot;&gt;&lt;del&gt;WICKET-6746&lt;/del&gt;&lt;/a&gt;: no need to resolve current scheme is desired is ANY&lt;/p&gt;

&lt;p&gt;Resolving the current scheme breaks on WebSocket requests when rendering&lt;br/&gt;
urls for resources, because HttpsMapper only knows http and https, not&lt;br/&gt;
ws.&lt;/p&gt;</comment>
                            <comment id="17034799" author="jira-bot" created="Tue, 11 Feb 2020 20:10:42 +0000"  >&lt;p&gt;Commit a868311d1875454129baac75e620a13c0311bb28 in wicket&apos;s branch refs/heads/csp-examples from Emond Papegaaij&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=wicket.git;h=a868311&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=wicket.git;h=a868311&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6746&quot; title=&quot;HttpsMapper cannot deal with resources over websockets&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6746&quot;&gt;&lt;del&gt;WICKET-6746&lt;/del&gt;&lt;/a&gt;: no need to resolve current scheme is desired is ANY&lt;/p&gt;

&lt;p&gt;Resolving the current scheme breaks on WebSocket requests when rendering&lt;br/&gt;
urls for resources, because HttpsMapper only knows http and https, not&lt;br/&gt;
ws.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12993086" name="wicket-6746.tar.gz" size="22730" author="papegaaij" created="Mon, 10 Feb 2020 19:25:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 39 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0b7vs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>