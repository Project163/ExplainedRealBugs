<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:20:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4575] AjaxButton / AjaxFormSubmitBehavior behaviour in wicket 1.5</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4575</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;I&apos;ve just been going through an upgrade form wicket 1.4 to 1.5 and noticed a big change in the AjaxFormSubmitBehavior.onEvent(AjaxRequestTarget).&lt;/p&gt;

&lt;p&gt;In 1.4 the code would submit the From.onSubmit() first and then fire the AjaxFormSubmitBehavior.onSubmit() event, now this behaviour is reversed to process the AjaxFormSubmitBehavior first.&lt;/p&gt;

&lt;p&gt;I have lots of examples of requiring the AjaxButton to perform &quot;on after submit&quot; ajax events, e.g. Ajax Wizard navigation, closing modals after form submit. These ajax events change the component heirachy so that the form is no longer present, thus never gets submitted e.g. Next button. I have no particular cases where I would want the AjaxButton onSubmit called before the form submit, I&apos;m wondering if there are many at all.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure of the implications of changing the AjaxFormSubmitBehavior logic for other components which use it so I will make a suggestion to modify the AjaxFormSubmitBehaviour&apos;s onEvent and onSubmit in the AjaxButton to emulate the original behaviour:&lt;/p&gt;

&lt;p&gt;new AjaxFormSubmitBehavior(form, &quot;onclick&quot;) {&lt;/p&gt;

&lt;p&gt;	boolean formSubmited;&lt;/p&gt;

&lt;p&gt;	protected void onEvent(AjaxRequestTarget target) {&lt;br/&gt;
		formSubmited = false;&lt;br/&gt;
		super.onEvent(target);&lt;br/&gt;
		if (formSubmited) &lt;/p&gt;
{
			LegacyAjaxButton.this.onSubmit(target, LegacyAjaxButton.this.getForm());
		}
&lt;p&gt;	}&lt;/p&gt;

&lt;p&gt;	protected void onSubmit(AjaxRequestTarget target) &lt;/p&gt;
{
		formSubmited = true;
		LegacyAjaxButton.this.onBeforeSubmit(target, LegacyAjaxButton.this.getForm());
 	}

&lt;p&gt; 	...&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;and add an onBeforeSubmit method to the AjaxButton.&lt;/p&gt;

&lt;p&gt;protected void onBeforeSubmit(AjaxRequestTarget target, Form&amp;lt;?&amp;gt; form) {		&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;The other possible solution would be to change the IFormSubmitter to have both an onAfterSubmit() and call it in Form.delegateSubmit().&lt;/p&gt;


&lt;p&gt;Just as a side note, I&apos;ve noticed some other chatter on mailing lists around this (see below) so thought I would raise it.&lt;/p&gt;

&lt;p&gt;AjaxWizard issue:&lt;br/&gt;
&lt;a href=&quot;http://www.mail-archive.com/users@wicket.apache.org/msg71273.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.mail-archive.com/users@wicket.apache.org/msg71273.html&lt;/a&gt;&lt;br/&gt;
AjaxButton issue:&lt;br/&gt;
&lt;a href=&quot;http://comments.gmane.org/gmane.comp.java.wicket.user/96947&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://comments.gmane.org/gmane.comp.java.wicket.user/96947&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12558375">WICKET-4575</key>
            <summary>AjaxButton / AjaxFormSubmitBehavior behaviour in wicket 1.5</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cmenzel">Carl-Eric Menzel</assignee>
                                    <reporter username="jamesmcintosh">James McIntosh</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 May 2012 01:46:02 +0000</created>
                <updated>Tue, 26 Jun 2012 16:21:30 +0000</updated>
                            <resolved>Tue, 26 Jun 2012 16:21:30 +0000</resolved>
                                    <version>1.5.0</version>
                    <version>6.0.0-beta2</version>
                                    <fixVersion>1.5.8</fixVersion>
                    <fixVersion>6.0.0-beta3</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                    <workratio workratioPercent="0"/>
                                                                    <timeoriginalestimate seconds="0">0h</timeoriginalestimate>
                            <timeestimate seconds="0">0h</timeestimate>
                                        <comments>
                            <comment id="13288077" author="mgrigorov" created="Sun, 3 Jun 2012 04:49:00 +0000"  >&lt;p&gt;The change in the order is caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-1894&quot; title=&quot;AjaxFallbackButton: inconsistent submit order&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-1894&quot;&gt;&lt;del&gt;WICKET-1894&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13295657" author="cmenzel" created="Fri, 15 Jun 2012 13:36:27 +0000"  >&lt;p&gt;Both this and &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-1894&quot; title=&quot;AjaxFallbackButton: inconsistent submit order&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-1894&quot;&gt;&lt;del&gt;WICKET-1894&lt;/del&gt;&lt;/a&gt; present valid use cases, so I think we need to support both. Ideally, each submit button should be able to choose whether it wants to run before or after Form#onSubmit.&lt;/p&gt;

&lt;p&gt;In 6.0 this should be easy - I&apos;m going to give IFormSubmitter an additional method #getSubmitOrder to return an enum value, either BEFORE_FORM or AFTER_FORM. The existing buttons can default to return BEFORE_FORM as 1.5 is doing now. Form#delegateSubmit can then simply switch the order around depending on this value.&lt;/p&gt;

&lt;p&gt;This would be an API break for 1.5 though. What are good options to add this anyway? We could give 1.5 an additional Interface IOrderedFormSubmitter extends IFormSubmitter, and have all default implementations like AjaxFallbackButton etc implement it. In 6.0 it could be dropped again.&lt;/p&gt;

&lt;p&gt;Opinions?&lt;/p&gt;</comment>
                            <comment id="13295682" author="cmenzel" created="Fri, 15 Jun 2012 14:17:58 +0000"  >&lt;p&gt;Okay, 6.0 was easy enough.&lt;/p&gt;

&lt;p&gt;Any objections to adding a temporary IOrderedFormSubmitter interface in 1.5?&lt;/p&gt;</comment>
                            <comment id="13295685" author="cmenzel" created="Fri, 15 Jun 2012 14:25:08 +0000"  >&lt;p&gt;On second thought, having an onBeforeFormSubmit and an onAfterFormSubmit in ISubmittingComponent sounds good too, instead of opting for just one of the two with the enum solution. The drawback is that the old onSubmit method wouldn&apos;t make any sense then anymore and should be removed, thus increasing the migration work for all users.&lt;/p&gt;

&lt;p&gt;Again, opinions? Which of these is better:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;put the enum-based solution (BEFORE_FORM, AFTER_FORM, currently in master) in 1.5 too?&lt;/li&gt;
	&lt;li&gt;drop the enum and change onSubmit to onBeforeFormSubmit and onAfterFormSubmit in 6, and add onAfterFormSubmit in 1.5?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13393406" author="jamesmcintosh" created="Sat, 16 Jun 2012 23:30:41 +0000"  >&lt;p&gt;The second option (adding methods without enum) is definitely more elegant.&lt;/p&gt;</comment>
                            <comment id="13395771" author="cmenzel" created="Mon, 18 Jun 2012 09:43:34 +0000"  >&lt;p&gt;Hm. I guess we could deprecate IFormSubmitter#onSubmit in both 1.5 and 6.0, and add onBeforeFormSubmit and onAfterFormSubmit (in IFS for 6.0 and in a temp interface in 1.5). For the time being, #onSubmit could be called together with onBeforeFormSubmit (which is what is happening today).&lt;/p&gt;</comment>
                            <comment id="13396801" author="cmenzel" created="Tue, 19 Jun 2012 14:28:35 +0000"  >&lt;p&gt;I have an implementation for both 6.0 and 1.5.&lt;/p&gt;

&lt;p&gt;In 1.5 I have deprecated onSubmit and added onSubmitBeforeForm and onSubmitAfterForm in an extension interface.&lt;/p&gt;

&lt;p&gt;In 6.0 I have moved onSubmit to onSubmitBeforeForm and added onSubmitAfterForm.&lt;/p&gt;

&lt;p&gt;It works, the two methods seem intuitive, so that is nice. The implementation is as simple as I could get it. Still, after talking with martin-g I didn&apos;t push it out to the main branches directly, but set up two sandbox branches instead so others can have a look. See sandbox/formsubmit-beforeafter-1.5 and sandbox/formsubmit-beforeafter-6.0.&lt;/p&gt;

&lt;p&gt;It&apos;s ready to be merged, I&apos;d just like some more comments.&lt;/p&gt;</comment>
                            <comment id="13396808" author="mgrigorov" created="Tue, 19 Jun 2012 14:32:20 +0000"  >&lt;p&gt;Copy my comments from dev@ mailing list:&lt;/p&gt;

&lt;p&gt;Looks OK to me.&lt;/p&gt;

&lt;p&gt;Just a few minor things:&lt;/p&gt;

&lt;p&gt;1) I prefer on(Before|After)FormSubmit than&lt;br/&gt;
onSubmit(Before|After)Form. Sounds more clear to me&lt;/p&gt;

&lt;p&gt;2) I see you removed &apos;abstract&apos; from the methods.&lt;br/&gt;
I agree that it will be worse if I have to override both new methods&lt;br/&gt;
for every Link/Button I use. But I also remember that in earlier&lt;br/&gt;
versions of Wicket #onSubmit() was abstract and #onError() wasn&apos;t and&lt;br/&gt;
some people complained about this. I think #onError() became abstract&lt;br/&gt;
for 1.5.x.&lt;br/&gt;
We just need to decide which way to go here.&lt;/p&gt;</comment>
                            <comment id="13396822" author="cmenzel" created="Tue, 19 Jun 2012 14:41:28 +0000"  >&lt;p&gt;&amp;gt; 1) I prefer on(Before|After)FormSubmit than&lt;br/&gt;
&amp;gt; onSubmit(Before|After)Form. Sounds more clear to me  &lt;/p&gt;

&lt;p&gt;I had those first, but it seemed odd - &quot;onBeforeFormSubmit&quot; sounds like&lt;br/&gt;
it happens before the submit, like onBeforeRender happens before render.&lt;br/&gt;
onSubmitBeforeForm is clearly a part of the submit, just invoked before&lt;br/&gt;
the form is called.&lt;/p&gt;

&lt;p&gt;&amp;gt; 2) I see you removed &apos;abstract&apos; from the methods.&lt;br/&gt;
&amp;gt; I agree that it will be worse if I have to override both new methods&lt;br/&gt;
&amp;gt; for every Link/Button I use. But I also remember that in earlier&lt;br/&gt;
&amp;gt; versions of Wicket #onSubmit() was abstract and #onError() wasn&apos;t and&lt;br/&gt;
&amp;gt; some people complained about this. I think #onError() became abstract&lt;br/&gt;
&amp;gt; for 1.5.x.&lt;br/&gt;
&amp;gt; We just need to decide which way to go here.  &lt;/p&gt;

&lt;p&gt;With the two new methods I don&apos;t think any of them should be abstract.&lt;br/&gt;
Almost all buttons will only need one of them. In our application the&lt;br/&gt;
abstract onError added a lot of noise that we didn&apos;t need, and this&lt;br/&gt;
would triple it.&lt;/p&gt;</comment>
                            <comment id="13399303" author="cmenzel" created="Fri, 22 Jun 2012 13:22:33 +0000"  >&lt;p&gt;Commited the patches to both 1.5 and 6.0.&lt;/p&gt;</comment>
                            <comment id="13401113" author="pedrosans" created="Tue, 26 Jun 2012 02:12:21 +0000"  >&lt;p&gt;It&apos;s natural to expect that IFormSubmitter#onSubmit will be invoked before the form&apos;s one. IMO a better API would be:&lt;/p&gt;

&lt;p&gt;public interface IFormSubmitter{&lt;br/&gt;
	void onSubmit();  &amp;lt;-- keeps the current signature&lt;br/&gt;
	void onAfterSubmit(); &amp;lt;-- adding the exception case. Also onAfterFormSubmit sounds a pleonasm&lt;br/&gt;
}&lt;/p&gt;</comment>
                            <comment id="13401459" author="cmenzel" created="Tue, 26 Jun 2012 15:36:13 +0000"  >&lt;p&gt;I had initially wanted the symmetry of onAfter/onBefore, and the onAfter*Form*Submit part to make it clear that it&apos;s not actually &quot;after submit&quot; but &quot;after Form#onSubmit&quot;.&lt;/p&gt;

&lt;p&gt;Howevery, I now think you&apos;re correct. 1.5 has firmly established that IFS#onSubmit is called before Form#onSubmit. So we&apos;ll simply add #onAfterSubmit now.&lt;/p&gt;</comment>
                            <comment id="13401487" author="cmenzel" created="Tue, 26 Jun 2012 16:21:30 +0000"  >&lt;p&gt;Fixed again in 1.5 and 6.0.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12407157">WICKET-1894</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>257754</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 21 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0k8iv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116198</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>