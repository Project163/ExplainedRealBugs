<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:17:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-3441] org.apache.wicket.util.lang.PropertyResolverConverter Type Erasure leads to Sloppy Typing</title>
                <link>https://issues.apache.org/jira/browse/WICKET-3441</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;There seems to be some problems with the&lt;br/&gt;
org.apache.wicket.util.lang.PropertyResolverConverter convert method&lt;br/&gt;
that the Java compiler lets slip because of type erasure.&lt;br/&gt;
To show this, lets let the convert method had type parameterized arguments:&lt;/p&gt;

&lt;p&gt;public &amp;lt;OT, CT&amp;gt; Object convert(OT object, Class&amp;lt;CT&amp;gt; clz)&lt;/p&gt;

&lt;p&gt;and the converter is then typed:&lt;/p&gt;

&lt;p&gt;  IConverter&amp;lt;CT&amp;gt; converter = converterSupplier.getConverter(clz);&lt;/p&gt;

&lt;p&gt;then the block of code:&lt;/p&gt;

&lt;p&gt;  else if (clz == String.class) &lt;/p&gt;
{
    return converter.convertToString(object, locale);
  }&lt;br/&gt;
&lt;br/&gt;
has an issue because the convertToString expects object to have&lt;br/&gt;
type CT. Because of type erasure, the Java compiler lets this&lt;br/&gt;
slip by. In addition, since the class type is String, the&lt;br/&gt;
converter used is just the ConverterLocator,DefaultConverter&lt;br/&gt;
whose convertToString method ends up calling&lt;br/&gt;
&lt;br/&gt;
    return (String)Objects.convertValue(value, String.class);&lt;br/&gt;
&lt;br/&gt;
which, when nothing can be found to convert to a &quot;known&quot; value&lt;br/&gt;
simply returns the value parameter. Again, all this is allowed&lt;br/&gt;
because the Java compiler gets sloppy due to type erasure.&lt;br/&gt;
But calling Objects.convertValue is just what the block of code&lt;br/&gt;
following the above convert method code does:&lt;br/&gt;
&lt;br/&gt;
  else {&lt;br/&gt;
    try {
     return Objects.convertValue(object, clz);
    } catch (RuntimeException ex) {
     // ignore that try it the other way
    }&lt;br/&gt;
    // go through string to convert to the right object.&lt;br/&gt;
    String tmp = converter.convertToString(object, locale);&lt;br/&gt;
    return converter.convertToObject(tmp, locale);&lt;br/&gt;
  }&lt;br/&gt;
&lt;br/&gt;
So, the previous block of code:&lt;br/&gt;
&lt;br/&gt;
  else if (clz == String.class) {    return converter.convertToString(object, locale);  }

&lt;p&gt;can be removed 1) allowing for correct typing and 2) with the&lt;br/&gt;
same results.&lt;/p&gt;

&lt;p&gt;Also, if one examines the code:&lt;/p&gt;

&lt;p&gt;    // go through string to convert to the right object.&lt;br/&gt;
    String tmp = converter.convertToString(object, locale);&lt;br/&gt;
    return converter.convertToObject(tmp, locale);&lt;/p&gt;

&lt;p&gt;one sees that this has the same sloppy typing as the code block&lt;br/&gt;
just remove, that is:&lt;/p&gt;

&lt;p&gt;    return converter.convertToString(object, locale);&lt;/p&gt;

&lt;p&gt;Again, object is of type OT while the convertToString method&lt;br/&gt;
of the IConverter is expecting a type of CT.&lt;br/&gt;
The fix is to use an IConverter of the type of OT to convert to&lt;br/&gt;
String and then the IConverter of type CT to convert to the&lt;br/&gt;
return object:&lt;/p&gt;

&lt;p&gt;    // go through string to convert to the right object.&lt;br/&gt;
    IConverter&amp;lt;OT&amp;gt; converterForObj =&lt;br/&gt;
        converterSupplier.getConverter(object.getClass());&lt;br/&gt;
    String tmp = converterForObj.convertToString(object, locale);&lt;br/&gt;
    return converter.convertToObject(tmp, locale);&lt;/p&gt;

&lt;p&gt;This is now correctly typed.&lt;/p&gt;

&lt;p&gt;I noticed this because there is rather more theory behind Scala&apos;s&lt;br/&gt;
type system than Java&apos;s so that the Scala compiler complained about&lt;br/&gt;
the attempt to sneak around the type erasure.&lt;/p&gt;</description>
                <environment>all</environment>
        <key id="12498307">WICKET-3441</key>
            <summary>org.apache.wicket.util.lang.PropertyResolverConverter Type Erasure leads to Sloppy Typing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdonnerstag">Juegen Donnerstag</assignee>
                                    <reporter username="emberson">Richard Emberson</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Feb 2011 00:46:51 +0000</created>
                <updated>Sun, 17 Apr 2011 15:45:56 +0000</updated>
                            <resolved>Sun, 17 Apr 2011 15:45:56 +0000</resolved>
                                    <version>1.5-RC1</version>
                                                    <component>wicket</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13020799" author="akiraly" created="Sun, 17 Apr 2011 13:33:13 +0000"  >&lt;p&gt;Attaching patch against current trunk.&lt;/p&gt;

&lt;p&gt;Patch contains fix for the issue and 2 new unit tests. The tests fail with the original implementation and pass with the new one.&lt;/p&gt;</comment>
                            <comment id="13020816" author="jdonnerstag" created="Sun, 17 Apr 2011 15:45:56 +0000"  >&lt;p&gt;thanks a lot&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12476558" name="fix-WICKET-3441.patch" size="5153" author="akiraly" created="Sun, 17 Apr 2011 13:33:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204228</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 31 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kayf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116592</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>