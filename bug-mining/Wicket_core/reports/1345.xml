<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:25:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-6250] FileUploadField does not deteach models and fails to null the reference to the transient fileUploads field if forceCloseStreamsOnDetach is false</title>
                <link>https://issues.apache.org/jira/browse/WICKET-6250</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;FileUpload does not clear our references and its model when the forceCloseStreamsOnDetach is false - which does not match the expectation from the javadoc:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  /**                                                                 
   * The FileUploadField will close any input streams you have opened in its FileUpload by
   * &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;. If you wish to manage the stream yourself (e.g. you want to use it in another
   * thread) then you can override &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; method to prevent &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; behavior.
   *                                                                  
   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &amp;lt;code&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/code&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; stream should be closed at the end of request
   */   
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So it just is about not closing the streams.&lt;br/&gt;
However the fileupload component does not only &lt;b&gt;not&lt;/b&gt; close the streams - it also &lt;b&gt;fails&lt;/b&gt; (if you return false from the &lt;b&gt;forceCloseStreamsOnDetach&lt;/b&gt; method) to reset the model and forget about the current file uploads cached in the transient fileUploads variable.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void onDetach()                                           
  {                                                                   
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((fileUploads != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &amp;amp;&amp;amp; forceCloseStreamsOnDetach())         
    {                                                                 
      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (FileUpload fu : fileUploads)                               
      {                                                               
        fu.closeStreams();                                            
      }                                                               
      fileUploads = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;                                             
                                                                      
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (getModel() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)                                         
      {                                                               
        getModel().setObject(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);                                   
      }                                                               
    }                                                                 
    &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.onDetach();                                                 
  }  
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Shouldn&apos;t that read more like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void onDetach()                                           
  {                                                                   
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((fileUploads != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;))         
    { 
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(forceCloseStreamsOnDetach() {
	 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (FileUpload fu : fileUploads)                               
	 {                                                               
	  fu.closeStreams();                                            
	 }                                                               
      }
      fileUploads = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;                                             
                                                                      
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (getModel() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)                                         
      {                                                               
        getModel().setObject(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);                                   
      }                                                               
    }                                                                 
    &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.onDetach();                                                 
  }  
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In this case my streams wouldn&apos;t be closed but you could provide new streams in the next request.&lt;/p&gt;

&lt;p&gt;As the variable is private and i don&apos;t want to close the stream i have to use reflection at the moment to reset the field to null in an overridden onDeteach().&lt;/p&gt;</description>
                <environment></environment>
        <key id="13008581">WICKET-6250</key>
            <summary>FileUploadField does not deteach models and fails to null the reference to the transient fileUploads field if forceCloseStreamsOnDetach is false</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="svenmeier">Sven Meier</assignee>
                                    <reporter username="tkrah">Torsten Krah</reporter>
                        <labels>
                            <label>file_upload</label>
                    </labels>
                <created>Thu, 29 Sep 2016 16:02:40 +0000</created>
                <updated>Wed, 4 Jan 2017 09:43:36 +0000</updated>
                            <resolved>Sat, 1 Oct 2016 21:45:51 +0000</resolved>
                                    <version>6.24.0</version>
                                    <fixVersion>8.0.0-M2</fixVersion>
                    <fixVersion>7.5.0</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15539181" author="svenmeier" created="Sat, 1 Oct 2016 21:24:12 +0000"  >&lt;p&gt;Changes for uploading of multiple files introduced a performance optimization in #getFileUploads() to parse the request once only.&lt;/p&gt;

&lt;p&gt;If the page does not get serialized, the previous fileUploads are still present on the next request.&lt;/p&gt;</comment>
                            <comment id="15539201" author="jira-bot" created="Sat, 1 Oct 2016 21:41:20 +0000"  >&lt;p&gt;Commit c615cca9e0d1a6236f321e4692da4b0a3f99b9fe in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=c615cca&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=c615cca&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6250&quot; title=&quot;FileUploadField does not deteach models and fails to null the reference to the transient fileUploads field if forceCloseStreamsOnDetach is false&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6250&quot;&gt;&lt;del&gt;WICKET-6250&lt;/del&gt;&lt;/a&gt; always clear reference to fileUploads in onDetach()&lt;/p&gt;</comment>
                            <comment id="15539203" author="jira-bot" created="Sat, 1 Oct 2016 21:41:51 +0000"  >&lt;p&gt;Commit 4b251c03bdfc0afb00fea2f51ab46eabc01cac44 in wicket&apos;s branch refs/heads/wicket-6.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=4b251c0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=4b251c0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6250&quot; title=&quot;FileUploadField does not deteach models and fails to null the reference to the transient fileUploads field if forceCloseStreamsOnDetach is false&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6250&quot;&gt;&lt;del&gt;WICKET-6250&lt;/del&gt;&lt;/a&gt; always clear reference to fileUploads in onDetach()&lt;/p&gt;</comment>
                            <comment id="15539204" author="jira-bot" created="Sat, 1 Oct 2016 21:42:21 +0000"  >&lt;p&gt;Commit 30d2669eed71f34b3dabd0870380d1504b6edac9 in wicket&apos;s branch refs/heads/wicket-7.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=30d2669&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=30d2669&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6250&quot; title=&quot;FileUploadField does not deteach models and fails to null the reference to the transient fileUploads field if forceCloseStreamsOnDetach is false&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6250&quot;&gt;&lt;del&gt;WICKET-6250&lt;/del&gt;&lt;/a&gt; always clear reference to fileUploads in onDetach()&lt;/p&gt;</comment>
                            <comment id="15539211" author="svenmeier" created="Sat, 1 Oct 2016 21:45:52 +0000"  >&lt;p&gt;#fileUploads are always cleared now in #onDetach().&lt;/p&gt;

&lt;p&gt;Models are &lt;b&gt;not&lt;/b&gt; set to null though - this is how #forceCloseStreamsOnDetach worked before introduction of multiple file uploads.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12496419">WICKET-3370</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 7 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3492n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>