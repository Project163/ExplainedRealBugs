<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:18:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-3449] Tree doesn&apos;t update correctly</title>
                <link>https://issues.apache.org/jira/browse/WICKET-3449</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;When we add a first child to the root node junction link (near the root) doesn&apos;t appear in the tree. &lt;br/&gt;
This bug easily can be reproduced with the next piece of code.&lt;/p&gt;


&lt;p&gt;TestPage.html &lt;/p&gt;

&lt;p&gt;&amp;lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xmlns:wicket=&quot;http://wicket.apache.org/dtds.data/wicket-xhtml1.4-strict.dtd&quot;&amp;gt;&lt;br/&gt;
&amp;lt;body&amp;gt;&lt;br/&gt;
&amp;lt;table&amp;gt;&lt;br/&gt;
    &amp;lt;tr&amp;gt;        &amp;lt;td&amp;gt;            &amp;lt;div wicket:id=&quot;tree&quot;&amp;gt;&amp;lt;/div&amp;gt;        &amp;lt;/td&amp;gt;    &amp;lt;/tr&amp;gt;&lt;br/&gt;
    &amp;lt;tr&amp;gt;        &amp;lt;td&amp;gt;            &amp;lt;input type=&quot;submit&quot; wicket:id=&quot;addChild&quot; class=&quot;btn btnStd&quot; /&amp;gt;        &amp;lt;/td&amp;gt;    &amp;lt;/tr&amp;gt;&lt;br/&gt;
&amp;lt;/table&amp;gt;&lt;br/&gt;
&amp;lt;/body&amp;gt;&lt;br/&gt;
&amp;lt;/html&amp;gt;&lt;/p&gt;

&lt;p&gt;TestPage.java&lt;/p&gt;

&lt;p&gt;public class TestPage extends WebPage {&lt;br/&gt;
    public TestPage() {&lt;br/&gt;
        final DefaultMutableTreeNode root = new DefaultMutableTreeNode(&quot;root&quot;);&lt;/p&gt;

&lt;p&gt;        final DefaultTreeModel treeModel = new DefaultTreeModel(root);&lt;br/&gt;
        final BaseTree tree = new LinkTree(&quot;tree&quot;, treeModel);&lt;/p&gt;

&lt;p&gt;        add(tree);&lt;br/&gt;
        tree.getTreeState().expandNode(root);&lt;/p&gt;

&lt;p&gt;        AjaxLink addButton = new AjaxLink(&quot;addChild&quot;) {&lt;br/&gt;
            public void onClick(AjaxRequestTarget ajaxRequestTarget) &lt;/p&gt;
{
                DefaultMutableTreeNode child = new DefaultMutableTreeNode(&quot;child&quot;);
                root.add(child); // it doesn&apos;t matter how we add this child
                treeModel.insertNodeInto(child, root, 0);
                tree.updateTree(ajaxRequestTarget);
            }
&lt;p&gt;        };&lt;br/&gt;
        add(addButton);&lt;br/&gt;
    }&lt;br/&gt;
}&lt;/p&gt;</description>
                <environment>tomcat 6.0.26, win 7</environment>
        <key id="12498905">WICKET-3449</key>
            <summary>Tree doesn&apos;t update correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pedrosans">Pedro Santos</assignee>
                                    <reporter username="lotos">Sergey Plevko</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Feb 2011 15:47:52 +0000</created>
                <updated>Tue, 14 Jun 2011 20:37:52 +0000</updated>
                            <resolved>Tue, 14 Jun 2011 20:37:52 +0000</resolved>
                                    <version>1.4.15</version>
                                    <fixVersion>1.4.18</fixVersion>
                    <fixVersion>1.5-RC5</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                                                            <comments>
                            <comment id="12995866" author="lotos" created="Thu, 17 Feb 2011 16:02:01 +0000"  >&lt;p&gt;fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-2886&quot; title=&quot;Tree doesn&amp;#39;t update correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-2886&quot;&gt;&lt;del&gt;WICKET-2886&lt;/del&gt;&lt;/a&gt; doesn&apos;t cover &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3449&quot; title=&quot;Tree doesn&amp;#39;t update correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3449&quot;&gt;&lt;del&gt;WICKET-3449&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12995885" author="mgrigorov" created="Thu, 17 Feb 2011 16:22:03 +0000"  >&lt;p&gt;Can you please test with latest 1.4.x ?&lt;br/&gt;
There were some fixes in Tree component lately.&lt;br/&gt;
Please create a quickstart application that reproduces the problem.&lt;/p&gt;</comment>
                            <comment id="12995898" author="lotos" created="Thu, 17 Feb 2011 16:45:29 +0000"  >&lt;p&gt;It&apos;s also actual for version 1.4.15&lt;/p&gt;</comment>
                            <comment id="12996280" author="lotos" created="Fri, 18 Feb 2011 08:17:10 +0000"  >&lt;p&gt;QuickStart project&lt;/p&gt;</comment>
                            <comment id="12996320" author="mgrigorov" created="Fri, 18 Feb 2011 10:14:12 +0000"  >&lt;p&gt;Adding nodes works fine with 1.4-SNAPSHOT and 1.5-SNAPSHOT.&lt;br/&gt;
Cannot reproduce the problem.&lt;/p&gt;</comment>
                            <comment id="12996367" author="lotos" created="Fri, 18 Feb 2011 12:11:14 +0000"  >&lt;p&gt;There is no &apos;-&apos; sign near the root node&lt;/p&gt;</comment>
                            <comment id="12996377" author="mgrigorov" created="Fri, 18 Feb 2011 12:42:21 +0000"  >&lt;p&gt;I&apos;m not expert in Swing but if you add &quot;treeModel.nodeChanged(root);&quot; right after treeModel.insertNodeInto(child, root, 0); call the collapse link is updated.&lt;/p&gt;</comment>
                            <comment id="12996381" author="mgrigorov" created="Fri, 18 Feb 2011 12:46:44 +0000"  >&lt;p&gt;treeModel.nodeStructureChanged() also solves your problem:&lt;/p&gt;

&lt;p&gt;             public void onClick(AjaxRequestTarget ajaxRequestTarget) &lt;/p&gt;
{ 
                 DefaultMutableTreeNode child = new DefaultMutableTreeNode(&quot;child&quot;); 
                 root.add(child); // it doesn&apos;t matter how we add this child 
                 treeModel.nodeStructureChanged(root);
                 tree.updateTree(ajaxRequestTarget); 
             }
&lt;p&gt; &lt;/p&gt;</comment>
                            <comment id="12996388" author="lotos" created="Fri, 18 Feb 2011 12:59:12 +0000"  >&lt;p&gt;You a definitely not an expert in Swing. It&apos;s not fair to call nodeStructureChanged in this case.&lt;br/&gt;
This is a java doc for the method:&lt;br/&gt;
     /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Invoke this method if you&apos;ve totally changed the children of&lt;/li&gt;
	&lt;li&gt;node and its childrens children...  This will post a&lt;/li&gt;
	&lt;li&gt;treeStructureChanged event.&lt;br/&gt;
      */&lt;br/&gt;
It must work without nodeStructureChanged(...).&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13015802" author="lotos" created="Tue, 5 Apr 2011 08:18:00 +0000"  >&lt;p&gt;Martin, this issue is not fixed. Please, reopen.&lt;/p&gt;</comment>
                            <comment id="13015806" author="mgrigorov" created="Tue, 5 Apr 2011 08:22:19 +0000"  >&lt;p&gt;Please add more information.&lt;br/&gt;
Calling the method I suggested fixes the problem.&lt;/p&gt;</comment>
                            <comment id="13015878" author="lotos" created="Tue, 5 Apr 2011 11:42:23 +0000"  >&lt;p&gt;Martin, if you go back to &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-2886&quot; title=&quot;Tree doesn&amp;#39;t update correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-2886&quot;&gt;&lt;del&gt;WICKET-2886&lt;/del&gt;&lt;/a&gt;, you&apos;ll see that the problem with junction link was not only with ROOT. There was the fix for that issue. Unfortunately, that fix doesn&apos;t cover current issue. You propose to use nodeChanged() method, but it looks like a hot fix. Sure, this way works, but it&apos;s rather strange to use nodeChanged() only for the case when you add first child to the root. I don&apos;t doubt this issue must be fixed internally in the wicket framework.&lt;/p&gt;

&lt;p&gt;I suppose the problem is in &lt;/p&gt;

&lt;p&gt;AbstractTree.java&lt;/p&gt;

&lt;p&gt;public final void treeNodesInserted(TreeModelEvent e)&lt;br/&gt;
{&lt;br/&gt;
              ...&lt;br/&gt;
	// parentNode now has children for the first time, so we may need to invalidate&lt;br/&gt;
	// grandparent so that parentNode&apos;s junctionLink gets rebuilt with a plus/minus link&lt;br/&gt;
	Object grandparentNode = getParentNode(parentNode);&lt;br/&gt;
	// not invalidating if the grandparent is a not presented root&lt;br/&gt;
	if (!(getParentNode(grandparentNode) == null &amp;amp;&amp;amp; isRootLess()))&lt;/p&gt;
	{
		invalidateNodeWithChildren(grandparentNode);
	}
&lt;p&gt;	...&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;In our case &apos;parentNode&apos; is ROOT and &apos;grandparentNode&apos; is null. So invalidateNodeWithChildren() does nothing.&lt;/p&gt;</comment>
                            <comment id="13049364" author="pedrosans" created="Tue, 14 Jun 2011 19:38:12 +0000"  >&lt;p&gt;Invalidating parent node even if it is a root - without a grandparent&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                            <outwardlinks description="is a clone of">
                                        <issuelink>
            <issuekey id="12465269">WICKET-2886</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12465269">WICKET-2886</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12471392" name="3.jpg" size="8631" author="lotos" created="Fri, 18 Feb 2011 12:11:14 +0000"/>
                            <attachment id="12482585" name="WICKET-3449.patch" size="1443" author="pedrosans" created="Tue, 14 Jun 2011 19:38:12 +0000"/>
                            <attachment id="12471376" name="quickStart.zip" size="6745" author="lotos" created="Fri, 18 Feb 2011 08:17:10 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12498906">WICKET-3450</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>71245</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 23 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kaxr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116589</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>