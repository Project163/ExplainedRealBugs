<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:26:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-6966] IndexOutOfBounds in InSessionPageStore</title>
                <link>https://issues.apache.org/jira/browse/WICKET-6966</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Recently (since wicket 9?) we are seeing the following exception in our log.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;ERROR | &lt;span class=&quot;error&quot;&gt;&amp;#91;default task-43&amp;#93;&lt;/span&gt; | 2022-03-28 10:19:03,978 | org.apache.wicket.util.listener.ListenerCollection$1.java:124 | Error invoking listener: org.apache.wicket.Application$2@6e1ac438 &quot;mdw=152293&quot;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;java.lang.IndexOutOfBoundsException: Index: 0, Size: -1&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.util.LinkedList.checkPositionIndex(LinkedList.java:564)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.util.LinkedList.listIterator(LinkedList.java:871)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.util.AbstractList.listIterator(AbstractList.java:311)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.util.AbstractSequentialList.iterator(AbstractSequentialList.java:238)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.pageStore.InSessionPageStore$SessionData.remove(InSessionPageStore.java:226)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.pageStore.InSessionPageStore$SessionData.add(InSessionPageStore.java:212)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.pageStore.InSessionPageStore$CountLimitedData.add(InSessionPageStore.java:320)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.pageStore.InSessionPageStore.addPage(InSessionPageStore.java:127)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.pageStore.CachingPageStore.addPage(CachingPageStore.java:71)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.pageStore.RequestPageStore.detach(RequestPageStore.java:114)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.page.PageManager.detach(PageManager.java:91)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.Application$2.onDetach(Application.java:1582)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.request.cycle.RequestCycleListenerCollection$3.notify(RequestCycleListenerCollection.java:105)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.request.cycle.RequestCycleListenerCollection$3.notify(RequestCycleListenerCollection.java:101)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.util.listener.ListenerCollection$1.notify(ListenerCollection.java:120)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.util.listener.ListenerCollection.reversedNotify(ListenerCollection.java:144)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.util.listener.ListenerCollection.reversedNotifyIgnoringExceptions(ListenerCollection.java:113)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.request.cycle.RequestCycleListenerCollection.onDetach(RequestCycleListenerCollection.java:100)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.request.cycle.RequestCycle.onDetach(RequestCycle.java:670)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.request.cycle.RequestCycle.detach(RequestCycle.java:625)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:285)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:208)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.protocol.http.WicketServlet.doGet(WicketServlet.java:137)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at javax.servlet.api@2.0.0.Final-redhat-00001//javax.servlet.http.HttpServlet.service(HttpServlet.java:503)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;When this occurs it typically appears about 100 times in a very short time span. The users experiences a hanging page.&lt;/p&gt;

&lt;p&gt;Obviously, the size of a list can not be -1; I believe this to be a result of a race condition between one of the public methods (which are synchronized) and the writeObject method, which is not synchronized.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;One additional note: we are running 2 wars (with wicket) on the same container.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13436386">WICKET-6966</key>
            <summary>IndexOutOfBounds in InSessionPageStore</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="svenmeier">Sven Meier</assignee>
                                    <reporter username="Youri219">Youri de Boer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Mar 2022 09:40:44 +0000</created>
                <updated>Thu, 4 May 2023 18:38:52 +0000</updated>
                            <resolved>Fri, 1 Apr 2022 07:55:45 +0000</resolved>
                                    <version>9.8.0</version>
                                    <fixVersion>10.0.0-M1</fixVersion>
                    <fixVersion>9.9.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17514169" author="svenmeier" created="Tue, 29 Mar 2022 16:03:58 +0000"  >&lt;p&gt;That would mean that the container is serializing the session while a web thread is still processing a request, wouldn&apos;t it?&lt;/p&gt;

&lt;p&gt;What servlet container are you using?&lt;/p&gt;</comment>
                            <comment id="17514446" author="JIRAUSER287238" created="Wed, 30 Mar 2022 05:43:37 +0000"  >&lt;p&gt;We&apos;re using 2 JBoss 7.3.9 servers, but they&apos;re configured to run standalone (sticky sessions provided by the load balancer).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;EDIT: I actually also had it this morning on my own development environment which runs on Jetty 9.4.15. First time I&apos;ve seen it there.&lt;/p&gt;</comment>
                            <comment id="17514785" author="svenmeier" created="Wed, 30 Mar 2022 15:57:19 +0000"  >&lt;p&gt;Jetty does not serialize session by default, how did you configure Jetty&apos;s session manager?&lt;/p&gt;</comment>
                            <comment id="17515124" author="JIRAUSER287238" created="Thu, 31 Mar 2022 07:23:34 +0000"  >&lt;p&gt;We don&apos;t configure Jetty&apos;s session manager, so that should be default.&lt;/p&gt;

&lt;p&gt;I made a copy of the InSessionPageStore class that prints a stacktrace in the &apos;writeObject&apos; method. This is the result I got:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&#160; &#160; at mypackage.InSessionPageStore$SessionData.writeObject(InSessionPageStore.java:261)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.lang.reflect.Method.invoke(Method.java:566)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:1145)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1497)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1433)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1179)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1553)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1510)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1433)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1179)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeArray(ObjectOutputStream.java:1379)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1175)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1553)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1510)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1433)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1179)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:349)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.serialize.java.JavaSerializer$SerializationCheckerObjectOutputStream.writeObjectOverride(JavaSerializer.java:383)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at java.base/java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:345)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.serialize.java.JavaSerializer.serialize(JavaSerializer.java:97)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.core.util.lang.WicketObjects$SerializingObjectSizeOfStrategy.sizeOf(WicketObjects.java:123)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.core.util.lang.WicketObjects.sizeof(WicketObjects.java:256)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.Session.getSizeInBytes(Session.java:500)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.protocol.http.AbstractRequestLogger.requestTime(AbstractRequestLogger.java:232)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.Application$2.onDetach(Application.java:1587)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.request.cycle.RequestCycleListenerCollection$3.notify(RequestCycleListenerCollection.java:105)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.request.cycle.RequestCycleListenerCollection$3.notify(RequestCycleListenerCollection.java:101)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.util.listener.ListenerCollection$1.notify(ListenerCollection.java:120)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.util.listener.ListenerCollection.reversedNotify(ListenerCollection.java:144)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.util.listener.ListenerCollection.reversedNotifyIgnoringExceptions(ListenerCollection.java:113)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.request.cycle.RequestCycleListenerCollection.onDetach(RequestCycleListenerCollection.java:100)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.request.cycle.RequestCycle.onDetach(RequestCycle.java:670)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.request.cycle.RequestCycle.detach(RequestCycle.java:625)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:285)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:208)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at org.apache.wicket.protocol.http.WicketServlet.doGet(WicketServlet.java:137)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;This stacktrace appears every single request. It appears that serialization does not only occur when the container decides to serialize the session, but also when using the request logger.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I did als find this reference from the session to the InSessionPageStore: it&apos;s one of the elements in the metaData array.&lt;/p&gt;</comment>
                            <comment id="17515133" author="svenmeier" created="Thu, 31 Mar 2022 07:39:40 +0000"  >&lt;p&gt;Ah, so the requestlogger is causing the session serialization.&lt;/p&gt;

&lt;p&gt;Do you have RequestLoggerSettings#requestLoggerEnabled&#160; set to true in production too?&lt;/p&gt;</comment>
                            <comment id="17515152" author="JIRAUSER287238" created="Thu, 31 Mar 2022 08:02:31 +0000"  >&lt;p&gt;Yes, it&apos;s also enabled in production. Next patch we will exclude the session size in the log.&lt;/p&gt;</comment>
                            <comment id="17515292" author="svenmeier" created="Thu, 31 Mar 2022 12:17:10 +0000"  >&lt;p&gt;For performance reasons alone, RequestLoggerSettings#recordSessionSize should be disabled in production.&lt;/p&gt;

&lt;p&gt;Please report back whether this helps.&lt;/p&gt;

&lt;p&gt;@devs maybe we should change the default here, so users setting RequestLoggerSettings#requestLoggerEnabled don&apos;t record session automatically.&lt;/p&gt;</comment>
                            <comment id="17515298" author="mgrigorov" created="Thu, 31 Mar 2022 12:22:50 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17515307" author="JIRAUSER287238" created="Thu, 31 Mar 2022 12:36:52 +0000"  >&lt;p&gt;We will keep it disabled for now, it will probably take a few weeks before it will reach PRD before I can report back, but I have good hopes. The bug doesn&apos;t occur that frequently to justify an emergency hotfix on our side.&lt;/p&gt;</comment>
                            <comment id="17515563" author="bitstorm" created="Thu, 31 Mar 2022 19:58:06 +0000"  >&lt;p&gt;Since we have to release an hotfix for &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6963&quot; title=&quot;Use singletons for PanelMarkupSourcingStrategy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6963&quot;&gt;&lt;del&gt;WICKET-6963&lt;/del&gt;&lt;/a&gt; we might include this change in it. WDYT?&lt;/p&gt;</comment>
                            <comment id="17515767" author="jira-bot" created="Fri, 1 Apr 2022 07:49:10 +0000"  >&lt;p&gt;Commit 4764ac8010e34160bb61716ba3dc33cd1468e412 in wicket&apos;s branch refs/heads/master from Sven Meier&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=wicket.git;h=4764ac8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=wicket.git;h=4764ac8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6966&quot; title=&quot;IndexOutOfBounds in InSessionPageStore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6966&quot;&gt;&lt;del&gt;WICKET-6966&lt;/del&gt;&lt;/a&gt; do not record session size by default&lt;/p&gt;

&lt;p&gt;if request logging is enabled&lt;/p&gt;</comment>
                            <comment id="17515768" author="jira-bot" created="Fri, 1 Apr 2022 07:50:10 +0000"  >&lt;p&gt;Commit a37fecc1c4302b6895dcd9084b628cc1d65e2bf8 in wicket&apos;s branch refs/heads/wicket-9.x from Sven Meier&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=wicket.git;h=a37fecc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=wicket.git;h=a37fecc&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6966&quot; title=&quot;IndexOutOfBounds in InSessionPageStore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6966&quot;&gt;&lt;del&gt;WICKET-6966&lt;/del&gt;&lt;/a&gt; do not record session size by default&lt;/p&gt;

&lt;p&gt;if request logging is enabled&lt;/p&gt;</comment>
                            <comment id="17515769" author="svenmeier" created="Fri, 1 Apr 2022 07:55:45 +0000"  >&lt;p&gt;RequestLoggerSettings is now changed to &lt;b&gt;not&lt;/b&gt; record session size by default, this is not something you want to have activated in production.&lt;/p&gt;</comment>
                            <comment id="17716854" author="githubbot" created="Wed, 26 Apr 2023 18:22:05 +0000"  >&lt;p&gt;dr0ps commented on PR #587:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/wicket/pull/587#issuecomment-1523860983&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/pull/587#issuecomment-1523860983&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   It would be possible to prevent the list corruption by switching it to a synchronized collection. However, writeObject does first get the list size, then it for-loops over the list (btw an expensive operation on a LinkedList) and it individually removes the pages. It is not hard to imagine that the pages list might end up in all kinds of states if concurrent changes can occur.&lt;/p&gt;

</comment>
                            <comment id="17717025" author="githubbot" created="Thu, 27 Apr 2023 07:25:08 +0000"  >&lt;p&gt;theigl commented on PR #587:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/wicket/pull/587#issuecomment-1524963137&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/pull/587#issuecomment-1524963137&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Since all other methods in the class are already synchronized, I think your approach to fixing this is correct.&lt;/p&gt;

&lt;p&gt;   It would be great to have a test for this, but I don&apos;t know how hard it is to simulate the failure in a multi-threaded test.&lt;/p&gt;

</comment>
                            <comment id="17717251" author="githubbot" created="Thu, 27 Apr 2023 14:40:59 +0000"  >&lt;p&gt;dr0ps commented on PR #587:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/wicket/pull/587#issuecomment-1525820938&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/pull/587#issuecomment-1525820938&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   I added a test case that pretty reliably fails without synchronization. I would not make this test part of the Wicket distribution but it helps showing the issue.&lt;/p&gt;

</comment>
                            <comment id="17717254" author="githubbot" created="Thu, 27 Apr 2023 14:51:23 +0000"  >&lt;p&gt;renoth commented on PR #587:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/wicket/pull/587#issuecomment-1525837943&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/pull/587#issuecomment-1525837943&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   You could try to make it 100% reliable with executorservice and Threadpool like here for a similar Testcase:&lt;br/&gt;
   &lt;a href=&quot;https://github.com/apache/wicket/blob/5d46ca58cc835b2ac925c14190260c6253db2c3e/wicket-spring/src/test/java/org/apache/wicket/spring/injection/bytebuddy/ParallelInjectionTest.java#L115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/blob/5d46ca58cc835b2ac925c14190260c6253db2c3e/wicket-spring/src/test/java/org/apache/wicket/spring/injection/bytebuddy/ParallelInjectionTest.java#L115&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="17717262" author="githubbot" created="Thu, 27 Apr 2023 15:08:22 +0000"  >&lt;p&gt;dr0ps commented on PR #587:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/wicket/pull/587#issuecomment-1525869235&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/pull/587#issuecomment-1525869235&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   &amp;gt; You could try to make it 100% reliable with executorservice and Threadpool like here for a similar Testcase:&lt;br/&gt;
   &amp;gt; &lt;br/&gt;
   &amp;gt; &lt;a href=&quot;https://github.com/apache/wicket/blob/5d46ca58cc835b2ac925c14190260c6253db2c3e/wicket-spring/src/test/java/org/apache/wicket/spring/injection/bytebuddy/ParallelInjectionTest.java#L115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/blob/5d46ca58cc835b2ac925c14190260c6253db2c3e/wicket-spring/src/test/java/org/apache/wicket/spring/injection/bytebuddy/ParallelInjectionTest.java#L115&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   That is just as reliable as my test. AbstractExecutorService#invokeAll uses a loop to execute each tests. In no way it guarantees parallel execution as in the end this is very much depending on the underlying OS and hardware. So for consistency reasons I think my test should look like the ParallelInjectionTest. But both tests do not actually prove the absence of a problem.&lt;/p&gt;

</comment>
                            <comment id="17717284" author="githubbot" created="Thu, 27 Apr 2023 16:05:28 +0000"  >&lt;p&gt;dr0ps commented on PR #587:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/wicket/pull/587#issuecomment-1525961165&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/pull/587#issuecomment-1525961165&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   I changed it to look more like the ParallelInjectionTest. It looks better than the old version but actually performs worse. As it is non-deterministic (just like ParallelInjectionTest) I would not want to have it in my project. But that is your call. I only really want the synchronized keyword at InSessionPageStore.SessionData#writeObject&lt;/p&gt;

</comment>
                            <comment id="17717286" author="githubbot" created="Thu, 27 Apr 2023 16:13:06 +0000"  >&lt;p&gt;renoth commented on PR #587:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/wicket/pull/587#issuecomment-1525975693&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/pull/587#issuecomment-1525975693&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   If it does not improve the reliability, disregard my comment, i was thinking the code would look cleaner that way, nevermind.&lt;/p&gt;

</comment>
                            <comment id="17719476" author="githubbot" created="Thu, 4 May 2023 18:37:08 +0000"  >&lt;p&gt;martin-g merged PR #587:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/wicket/pull/587&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/pull/587&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="17719477" author="jira-bot" created="Thu, 4 May 2023 18:37:12 +0000"  >&lt;p&gt;Commit 125fe8ab96ce54565aaadaa3ba911b57439b85e1 in wicket&apos;s branch refs/heads/master from dr0ps&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=wicket.git;h=125fe8ab96&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=wicket.git;h=125fe8ab96&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6966&quot; title=&quot;IndexOutOfBounds in InSessionPageStore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6966&quot;&gt;&lt;del&gt;WICKET-6966&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-7013&quot; title=&quot;IndexOutOfBoundsException in InSessionPageStore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-7013&quot;&gt;&lt;del&gt;WICKET-7013&lt;/del&gt;&lt;/a&gt;: prevent unsynchronized access to pages (#587)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Wicket-6966: prevent unsynchronized access to pages&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Added concurrency test case&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;---------&lt;/p&gt;

&lt;p&gt;Co-authored-by: dr0ps &amp;lt;dr0ps@users.noreply.github.com&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17719479" author="jira-bot" created="Thu, 4 May 2023 18:37:41 +0000"  >&lt;p&gt;Commit bd13a77cbccdd37ff058225ea1d0c06e257c9bdf in wicket&apos;s branch refs/heads/wicket-9.x from dr0ps&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=wicket.git;h=bd13a77cbc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=wicket.git;h=bd13a77cbc&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6966&quot; title=&quot;IndexOutOfBounds in InSessionPageStore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6966&quot;&gt;&lt;del&gt;WICKET-6966&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-7013&quot; title=&quot;IndexOutOfBoundsException in InSessionPageStore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-7013&quot;&gt;&lt;del&gt;WICKET-7013&lt;/del&gt;&lt;/a&gt;: prevent unsynchronized access to pages (#587)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Wicket-6966: prevent unsynchronized access to pages&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Added concurrency test case&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;---------&lt;/p&gt;

&lt;p&gt;Co-authored-by: dr0ps &amp;lt;dr0ps@users.noreply.github.com&amp;gt;&lt;br/&gt;
(cherry picked from commit 125fe8ab96ce54565aaadaa3ba911b57439b85e1)&lt;/p&gt;</comment>
                            <comment id="17719482" author="githubbot" created="Thu, 4 May 2023 18:38:52 +0000"  >&lt;p&gt;martin-g commented on PR #587:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/wicket/pull/587#issuecomment-1535234334&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/pull/587#issuecomment-1535234334&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Thank you, @dr0ps !&lt;/p&gt;

</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 27 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10xaw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>