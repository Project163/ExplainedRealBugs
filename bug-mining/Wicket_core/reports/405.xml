<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:19:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4105] Using ajax to update a component that has an AbstractTransformerBehavior attached throws a ClassCastException</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4105</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Using ajax to update a component that has an AbstractTransformerBehavior attached throws a ClassCastException:&lt;/p&gt;

&lt;p&gt;java.lang.ClassCastException:&lt;br/&gt;
org.apache.wicket.ajax.AjaxRequestTarget$AjaxResponse cannot be cast&lt;br/&gt;
to org.apache.wicket.request.http.WebResponse&lt;br/&gt;
      at org.apache.wicket.markup.transformer.AbstractTransformerBehavior.beforeRender(AbstractTransformerBehavior.java:68)&lt;/p&gt;

&lt;p&gt;      at org.apache.wicket.Component.notifyBehaviorsComponentBeforeRender(Component.java:3421)&lt;br/&gt;
      at org.apache.wicket.Component.internalRender(Component.java:2344)&lt;br/&gt;
      at org.apache.wicket.Component.render(Component.java:2273)&lt;/p&gt;

&lt;p&gt;      at org.apache.wicket.MarkupContainer.renderNext(MarkupContainer.java:1474)&lt;br/&gt;
      at org.apache.wicket.MarkupContainer.renderAll(MarkupContainer.java:1638)&lt;br/&gt;
      at org.apache.wicket.MarkupContainer.renderComponentTagBody(MarkupContainer.java:1613)&lt;/p&gt;

&lt;p&gt;      at org.apache.wicket.MarkupContainer.onComponentTagBody(MarkupContainer.java:1567)&lt;br/&gt;
      at org.apache.wicket.markup.html.form.Form.onComponentTagBody(Form.java:1570)&lt;br/&gt;
      at org.apache.wicket.markup.html.panel.DefaultMarkupSourcingStrategy.onComponentTagBody(DefaultMarkupSourcingStrategy.java:72)&lt;/p&gt;

&lt;p&gt;      at org.apache.wicket.Component.internalRenderComponent(Component.java:2515)&lt;br/&gt;
      at org.apache.wicket.MarkupContainer.onRender(MarkupContainer.java:1576)&lt;br/&gt;
      at org.apache.wicket.Component.internalRender(Component.java:2345)&lt;/p&gt;

&lt;p&gt;      at org.apache.wicket.Component.render(Component.java:2273)&lt;br/&gt;
      at org.apache.wicket.MarkupContainer.renderNext(MarkupContainer.java:1474)&lt;br/&gt;
      at org.apache.wicket.MarkupContainer.renderAll(MarkupContainer.java:1638)&lt;/p&gt;

&lt;p&gt;      at org.apache.wicket.MarkupContainer.renderComponentTagBody(MarkupContainer.java:1613)&lt;br/&gt;
      at org.apache.wicket.MarkupContainer.renderAssociatedMarkup(MarkupContainer.java:735)&lt;br/&gt;
      at org.apache.wicket.markup.html.panel.AssociatedMarkupSourcingStrategy.renderAssociatedMarkup(AssociatedMarkupSourcingStrategy.java:76)&lt;/p&gt;

&lt;p&gt;      at org.apache.wicket.markup.html.panel.PanelMarkupSourcingStrategy.onComponentTagBody(PanelMarkupSourcingStrategy.java:112)&lt;br/&gt;
      at org.apache.wicket.Component.internalRenderComponent(Component.java:2515)&lt;br/&gt;
      at org.apache.wicket.MarkupContainer.onRender(MarkupContainer.java:1576)&lt;/p&gt;

&lt;p&gt;      at org.apache.wicket.Component.internalRender(Component.java:2345)&lt;br/&gt;
      at org.apache.wicket.Component.render(Component.java:2273)&lt;br/&gt;
      at org.apache.wicket.ajax.AjaxRequestTarget.respondComponent(AjaxRequestTarget.java:982)&lt;/p&gt;

&lt;p&gt;      at org.apache.wicket.ajax.AjaxRequestTarget.respondComponents(AjaxRequestTarget.java:796)&lt;br/&gt;
      at org.apache.wicket.ajax.AjaxRequestTarget.constructResponseBody(AjaxRequestTarget.java:676)&lt;br/&gt;
      at org.apache.wicket.ajax.AjaxRequestTarget.respond(AjaxRequestTarget.java:637)&lt;/p&gt;

&lt;p&gt;      at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:712)&lt;br/&gt;
      at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:63)&lt;br/&gt;
      at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:96)&lt;/p&gt;

&lt;p&gt;      at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:208)&lt;br/&gt;
      at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:251)&lt;br/&gt;
      at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:162)&lt;/p&gt;

&lt;p&gt;      at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:218)&lt;br/&gt;
      at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)&lt;br/&gt;
      at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)&lt;/p&gt;

&lt;p&gt;      at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)&lt;br/&gt;
      at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)&lt;br/&gt;
      at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)&lt;/p&gt;

&lt;p&gt;      at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)&lt;br/&gt;
      at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)&lt;br/&gt;
      at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)&lt;/p&gt;

&lt;p&gt;      at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)&lt;br/&gt;
      at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)&lt;br/&gt;
      at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)&lt;/p&gt;

&lt;p&gt;      at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12525554">WICKET-4105</key>
            <summary>Using ajax to update a component that has an AbstractTransformerBehavior attached throws a ClassCastException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="bitstorm">Andrea Del Bene</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Oct 2011 17:37:35 +0000</created>
                <updated>Wed, 5 Oct 2011 09:38:39 +0000</updated>
                            <resolved>Wed, 5 Oct 2011 09:38:38 +0000</resolved>
                                                    <fixVersion>1.5.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13119427" author="bitstorm" created="Mon, 3 Oct 2011 17:38:21 +0000"  >&lt;p&gt;run quickstart and click on &apos;update&apos; link.&lt;/p&gt;</comment>
                            <comment id="13119687" author="bitstorm" created="Mon, 3 Oct 2011 22:16:22 +0000"  >&lt;p&gt;Thee problem was introduced with commit 916364, when cast to WebRequest was introduced inside method &apos;beforeRender(Component component)&apos;. I&apos;ve reverted methods &apos;beforeRender(Component component)&apos; and &apos;afterRender(final Component component)&apos; to commit 895520 and this solves issue.&lt;br/&gt;
See attached patch.&lt;/p&gt;

&lt;p&gt;PS: patch passes all unit tests.&lt;/p&gt;</comment>
                            <comment id="13119939" author="svenmeier" created="Tue, 4 Oct 2011 07:48:57 +0000"  >&lt;p&gt;I don&apos;t think we want to go back to StringResponse, as this way we&apos;d lose some WebResponse features (e.g. encoding, headers).&lt;/p&gt;

&lt;p&gt;Seems we have to check whether the transformation is happening on a WebResponse or a Response only. WDYT?&lt;/p&gt;</comment>
                            <comment id="13119961" author="mgrigorov" created="Tue, 4 Oct 2011 08:34:57 +0000"  >&lt;p&gt;I think Andrea&apos;s patch is OK.&lt;br/&gt;
The old headers will be obsolete after the transformation - the content length most probably will be different, the encoding may be changed as well, the content type too ...&lt;/p&gt;

&lt;p&gt;I&apos;d also like to add this as a test case to org.apache.wicket.markup.transformer.AbstractTransformerBehaviorTest. Otherwise next time again no tests will fail &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12497555" name="WICKET-4105.patch" size="2662" author="bitstorm" created="Mon, 3 Oct 2011 22:16:50 +0000"/>
                            <attachment id="12497495" name="myproject.zip" size="38110" author="bitstorm" created="Mon, 3 Oct 2011 17:38:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43833</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 7 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0k9af:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116322</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>