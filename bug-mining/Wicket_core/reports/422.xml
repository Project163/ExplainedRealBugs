<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:19:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4134] Localizer.getCacheKey() generating redundant keys for same values causing memory leak.</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4134</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Note:  To reproduce this, just add a breakpoint or a logger in Localizer.addKeyToCache().  After running all pages/scenarios once that method should not be called again.  But if it does get called you know that there are redundant keys being produced for the same value.&lt;/p&gt;

&lt;p&gt;After running a web app for about a day, I will get out of mem exception.  With a heap dump I will see most of the memory taken by Localizer, with keys such as:&lt;/p&gt;

&lt;p&gt;androidapp-10:_wicket_link-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-28-4-4-4-4-4-4-28-52-4-4-76-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-27-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-28-4-4-4-4-4-4-4-30-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-41-4-4-4-4-26-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-41-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4-4...&lt;/p&gt;

&lt;p&gt;Each of these types of keys are duplicated several thousand times.  Here is a snipplet if the report:&lt;/p&gt;

&lt;p&gt;Found 60 occurrences of char[] with at least 10 instances having identical content. Total size is 401,451,248 bytes.&lt;/p&gt;

&lt;p&gt;Top elements include:&lt;/p&gt;

&lt;p&gt;6,454 x androidapp-10:_wicket_link-4-4-4-4-4-4-4-4-4-4-4-4... (15,722 bytes)&lt;br/&gt;
6,453 x facebook-10:_wicket_link-4-4-4-4-4-4-4-4-4-4-4-4-4... (15,720 bytes)&lt;br/&gt;
5,866 x home-9:_autolink_5-10:_wicket_link-4-4-4-4-4-4-4-4... (15,720 bytes)&lt;br/&gt;
5,183 x candidates-9:_autolink_7-10:_wicket_link-4-4-4-4-4... (15,614 bytes)&lt;br/&gt;
686 x candidates-9:_autolink_8-10:_wicket_link-4-4-4-4-4... (16,567 bytes)&lt;/p&gt;</description>
                <environment>Linux, Jboss/Jetty 4g Ram</environment>
        <key id="12527280">WICKET-4134</key>
            <summary>Localizer.getCacheKey() generating redundant keys for same values causing memory leak.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ivaynberg">Igor Vaynberg</assignee>
                                    <reporter username="nepoez">lucius</reporter>
                        <labels>
                            <label>memory_leak</label>
                    </labels>
                <created>Sat, 15 Oct 2011 04:17:30 +0000</created>
                <updated>Tue, 18 Oct 2011 08:00:40 +0000</updated>
                            <resolved>Tue, 18 Oct 2011 06:50:50 +0000</resolved>
                                    <version>1.5.1</version>
                                    <fixVersion>1.5.2</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13128064" author="nepoez" created="Sat, 15 Oct 2011 04:22:52 +0000"  >&lt;p&gt;Heap dump report screenshot attached.  thanks again!&lt;/p&gt;</comment>
                            <comment id="13128070" author="nepoez" created="Sat, 15 Oct 2011 04:59:34 +0000"  >&lt;p&gt;OK.  tracking a single link I have on a page to see what key is used.&lt;/p&gt;

&lt;p&gt;Going to the exact same URL, One time the getCacheKey generates this key:&lt;/p&gt;

&lt;p&gt;home-2:_autolink_5-3:_wicket_link-4-27-4-4-4-27-27-4-4-4-4-4-4-4-25-4-4-4-4-38-4-4-4-1-en_US-desktop-null&lt;/p&gt;

&lt;p&gt;The subsequent hit will generate this.  &lt;/p&gt;

&lt;p&gt;home-2:_autolink_5-3:_wicket_link-4-27-4-4-4-27-27-4-4-4-4-4-4-4-25-4-4-4-4-38-4-4-4-4-1-en_US-desktop-null&lt;/p&gt;


&lt;p&gt;Trying again a few mins later, 3 consecutive hits to same url:&lt;/p&gt;

&lt;p&gt;home-2:_autolink_29-3:_wicket_link-4-27-4-4-4-27-27-4-4-4-4-4-4-4-25-4-4-4-4-38-4-4-4-4-28-1-en_US-desktop-null&lt;br/&gt;
home-2:_autolink_29-3:_wicket_link-4-27-4-4-4-27-27-4-4-4-4-4-4-4-25-4-4-4-4-38-4-4-4-4-28-28-1-en_US-desktop-null&lt;br/&gt;
home-2:_autolink_5-3:_wicket_link-4-27-4-4-4-27-27-4-4-4-4-4-4-4-25-4-4-4-4-38-4-4-4-4-28-28-4-1-en_US-desktop-null&lt;/p&gt;</comment>
                            <comment id="13128072" author="nepoez" created="Sat, 15 Oct 2011 05:07:43 +0000"  >&lt;p&gt;As it appends the cursorId, I noticed this id keeps getting longer each page hit&lt;br/&gt;
[TransparentWebMarkupContainer &lt;span class=&quot;error&quot;&gt;&amp;#91;Component id = _wicket_link-4-27-4-4-4-27-27-4-4-4-4-4-4-4-25-4-4-4-4-38-4-4-4-4-28-28-4-4&amp;#93;&lt;/span&gt;]&lt;/p&gt;</comment>
                            <comment id="13128083" author="nepoez" created="Sat, 15 Oct 2011 05:52:58 +0000"  >&lt;p&gt;As a work around for now I am changing getCacheKey so the following is happening, skipping the appedending of id for TransparentWebMarkupContainer.  It will probably break some applications but it&apos;s ok for mine.&lt;/p&gt;

&lt;p&gt;final boolean skip = parent instanceof AbstractRepeater || cursor instanceof TransparentWebMarkupContainer;&lt;/p&gt;

&lt;p&gt;							if (skip == false)&lt;/p&gt;
							{
								buffer.append(&apos;:&apos;).append(cursor.getId());
							}</comment>
                            <comment id="13128273" author="nepoez" created="Sat, 15 Oct 2011 20:37:58 +0000"  >&lt;p&gt;this component also generates a new id, on a form submit:&lt;br/&gt;
[AutolinkBookmarkablePageLink &lt;span class=&quot;error&quot;&gt;&amp;#91;Component id = _autolink_203&amp;#93;&lt;/span&gt;]&lt;/p&gt;

&lt;p&gt;causing a new key to be cached every click to a submit post back.&lt;/p&gt;</comment>
                            <comment id="13128278" author="nepoez" created="Sat, 15 Oct 2011 20:51:55 +0000"  >&lt;p&gt;same problem with WebComponent for a button like this &amp;lt;input type=&quot;submit&quot; wicket:message=&quot;value:uploadPhoto&quot;/&amp;gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Component id = _message_attr_159&amp;#93;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;the message_attr_159 is a new id every post back&lt;/p&gt;</comment>
                            <comment id="13129551" author="nepoez" created="Tue, 18 Oct 2011 06:55:36 +0000"  >&lt;p&gt;Thanks for fixing!  Just curious what was the fix applied?&lt;/p&gt;</comment>
                            <comment id="13129577" author="mgrigorov" created="Tue, 18 Oct 2011 08:00:40 +0000"  >&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc/wicket/trunk/wicket-core/src/main/java/org/apache/wicket/Localizer.java/?rev=1185501&amp;amp;view=diff&amp;amp;r1=1185501&amp;amp;r2=1185500&amp;amp;p1=/wicket/trunk/wicket-core/src/main/java/org/apache/wicket/Localizer.java&amp;amp;p2=/wicket/trunk/wicket-core/src/main/java/org/apache/wicket/Localizer.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/wicket/trunk/wicket-core/src/main/java/org/apache/wicket/Localizer.java/?rev=1185501&amp;amp;view=diff&amp;amp;r1=1185501&amp;amp;r2=1185500&amp;amp;p1=/wicket/trunk/wicket-core/src/main/java/org/apache/wicket/Localizer.java&amp;amp;p2=/wicket/trunk/wicket-core/src/main/java/org/apache/wicket/Localizer.java&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12527248">WICKET-4133</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12499124" name="Screen Shot 2011-10-14 at 9.20.26 PM.png" size="139278" author="nepoez" created="Sat, 15 Oct 2011 04:22:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>85679</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 5 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0k97r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116310</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>