<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:24:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-6085] AjaxTimerBehavior with failure handler cause memory leak in browser</title>
                <link>https://issues.apache.org/jira/browse/WICKET-6085</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Please see the attached quickstart.&lt;br/&gt;
Start the application and run memory profiler in browser. Memory consumption gets high very quickly.&lt;/p&gt;

&lt;p&gt;I&apos;ve tried to find the cause, but I&apos;m too lame in Javascript to analyse that.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12935611">WICKET-6085</key>
            <summary>AjaxTimerBehavior with failure handler cause memory leak in browser</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="svenmeier">Sven Meier</assignee>
                                    <reporter username="vlastimil.dolejs">Vlastimil</reporter>
                        <labels>
                    </labels>
                <created>Mon, 1 Feb 2016 12:55:28 +0000</created>
                <updated>Sat, 6 Feb 2016 21:43:32 +0000</updated>
                            <resolved>Sat, 6 Feb 2016 21:43:32 +0000</resolved>
                                    <version>6.21.0</version>
                    <version>7.1.0</version>
                                    <fixVersion>7.3.0</fixVersion>
                    <fixVersion>8.0.0-M1</fixVersion>
                    <fixVersion>6.22.0</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15134219" author="svenmeier" created="Fri, 5 Feb 2016 14:06:16 +0000"  >&lt;p&gt;I&apos;ve checked with Chrome&apos;s memory tool and it seems any function in the ajaxAttributes leaks a reference to the &amp;lt;evaluate&amp;gt; node from the response.&lt;/p&gt;

&lt;p&gt;Moving eval(script) out of scope fixes this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	safeEval = function(script) {
		&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; eval(script);
	};
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ll investigate further.&lt;/p&gt;</comment>
                            <comment id="15135199" author="svenmeier" created="Fri, 5 Feb 2016 22:54:32 +0000"  >&lt;p&gt;Actually it is even simpler to execute eval() in global scope, just call: window.eval(script).&lt;/p&gt;

&lt;p&gt;Here&apos;s a good discussion of all  the options: &lt;a href=&quot;http://perfectionkills.com/global-eval-what-are-the-options/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://perfectionkills.com/global-eval-what-are-the-options/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I can&apos;t think of any reason why a script returned inside an Ajax call might need access to the local scope in #processEvaluation().&lt;/p&gt;</comment>
                            <comment id="15135238" author="jira-bot" created="Fri, 5 Feb 2016 23:21:21 +0000"  >&lt;p&gt;Commit 330ba3b31aafffb0f39c5f41c391cb0f9b7726da in wicket&apos;s branch refs/heads/wicket-6.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=330ba3b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=330ba3b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6085&quot; title=&quot;AjaxTimerBehavior with failure handler cause memory leak in browser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6085&quot;&gt;&lt;del&gt;WICKET-6085&lt;/del&gt;&lt;/a&gt; eval in global scope, to prevent leak of local variables into the evaluated script&lt;/p&gt;</comment>
                            <comment id="15135239" author="jira-bot" created="Fri, 5 Feb 2016 23:21:54 +0000"  >&lt;p&gt;Commit 3e745e7b6ca98fc2ce5dc77137b36c5144525e0c in wicket&apos;s branch refs/heads/wicket-7.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=3e745e7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=3e745e7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6085&quot; title=&quot;AjaxTimerBehavior with failure handler cause memory leak in browser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6085&quot;&gt;&lt;del&gt;WICKET-6085&lt;/del&gt;&lt;/a&gt; eval in global scope, to prevent leak of local variables into the evaluated script&lt;/p&gt;</comment>
                            <comment id="15135241" author="jira-bot" created="Fri, 5 Feb 2016 23:22:09 +0000"  >&lt;p&gt;Commit 94f8fd3c66909694db043b33443a2f21b21fa784 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=94f8fd3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=94f8fd3&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6085&quot; title=&quot;AjaxTimerBehavior with failure handler cause memory leak in browser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6085&quot;&gt;&lt;del&gt;WICKET-6085&lt;/del&gt;&lt;/a&gt; eval in global scope, to prevent leak of local variables into the evaluated script&lt;/p&gt;</comment>
                            <comment id="15135249" author="svenmeier" created="Fri, 5 Feb 2016 23:26:17 +0000"  >&lt;p&gt;All Javascript tests are ok, including those with deferred step notification.&lt;/p&gt;

&lt;p&gt;All #eval() calls are done in global scope now.&lt;/p&gt;</comment>
                            <comment id="15135808" author="mgrigorov" created="Sat, 6 Feb 2016 15:05:11 +0000"  >&lt;p&gt;&quot;asyncTest(&apos;processEvaluation with identifier|code.&apos;, function () &quot;  fails for me. It times out.&lt;br/&gt;
I&apos;m reopening the ticket to not forget it, but I won&apos;t have time today to debug it.&lt;/p&gt;

&lt;p&gt;To reproduce:&lt;br/&gt;
1) cd testing/wicket-js-tests&lt;br/&gt;
2) mvn test -Pjs-test&lt;/p&gt;

&lt;p&gt;To see which tests times out enable the &quot;verbose&quot; argument for &apos;grunt&apos; in pom.xml.&lt;/p&gt;</comment>
                            <comment id="15136014" author="jira-bot" created="Sat, 6 Feb 2016 21:35:23 +0000"  >&lt;p&gt;Commit 75422cc984fe2766b0ab2a481c16e032a7904d40 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=75422cc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=75422cc&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6085&quot; title=&quot;AjaxTimerBehavior with failure handler cause memory leak in browser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6085&quot;&gt;&lt;del&gt;WICKET-6085&lt;/del&gt;&lt;/a&gt; return evaluated function so that it can be invoked&lt;/p&gt;</comment>
                            <comment id="15136015" author="jira-bot" created="Sat, 6 Feb 2016 21:36:31 +0000"  >&lt;p&gt;Commit fb8c1e3e33f292504fbdffa3de3f175194a19549 in wicket&apos;s branch refs/heads/wicket-7.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=fb8c1e3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=fb8c1e3&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6085&quot; title=&quot;AjaxTimerBehavior with failure handler cause memory leak in browser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6085&quot;&gt;&lt;del&gt;WICKET-6085&lt;/del&gt;&lt;/a&gt; return evaluated function so that it can be invoked&lt;/p&gt;</comment>
                            <comment id="15136016" author="jira-bot" created="Sat, 6 Feb 2016 21:37:34 +0000"  >&lt;p&gt;Commit 77f30ce4eb5daa70da51ddb9bdf1599b159047fe in wicket&apos;s branch refs/heads/wicket-6.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=svenmeier&quot; class=&quot;user-hover&quot; rel=&quot;svenmeier&quot;&gt;svenmeier&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=77f30ce&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=77f30ce&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6085&quot; title=&quot;AjaxTimerBehavior with failure handler cause memory leak in browser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6085&quot;&gt;&lt;del&gt;WICKET-6085&lt;/del&gt;&lt;/a&gt; return evaluated function so that it can be invoked&lt;/p&gt;</comment>
                            <comment id="15136018" author="svenmeier" created="Sat, 6 Feb 2016 21:38:48 +0000"  >&lt;p&gt;Strange, I thought all js tests worked fine when I executed them in the browser.&lt;/p&gt;</comment>
                            <comment id="15136021" author="svenmeier" created="Sat, 6 Feb 2016 21:43:32 +0000"  >&lt;p&gt;By evaluating the expression in the global scope, the result can of course no longer access any local variables:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the resulting function could no longer be assigned to &apos;f&apos;, I fixed this by returning the function from the evaluated expression&lt;/li&gt;
	&lt;li&gt;the JS evaluation can no longer access the &apos;context&apos;, so I removed the counter increment from twoEvaluationsWithIdentifier.xml - the qunit assertions should be sufficient to ensure the test outcome&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12785508" name="ajax-memory-leak-quickstart.zip" size="28152" author="vlastimil.dolejs" created="Mon, 1 Feb 2016 12:56:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 41 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2s8dz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>