<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:20:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4617] ResourceStreamLocator vs ResourceFinder</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4617</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;I&apos;m a bit confused by the responsibilities of ResourceFinder vs ResourceStreamLocator. Looking around in the code, I found the following:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;IResourceFinder is apparently only implemented via its extension interface IResourcePath. Its two implementations Path and WebApplicationPath look through a list of filesystem folders for files.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ResourceStreamLocator does two things:&lt;/li&gt;
	&lt;li&gt;it loads resources, either via an IResourceFinder (which only finds filesystem resources) or via the classloader (it does this itself).&lt;/li&gt;
	&lt;li&gt;it uses a ResourceNameIterator to generate all possible filename variations based on locale and style and then tries to load one of them via the above mechanisms.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Is this correct?&lt;/p&gt;

&lt;p&gt;If so, I think we have some mixed-up responsibilities here. I propose the following:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;add a third IResourcePath implementation (e.g. ClassloaderPath) that handles loading of resources in classpaths. It should be able to try multiple paths (e.g. &quot;/&quot;, &quot;META-INF/resources&quot; etc).&lt;/li&gt;
	&lt;li&gt;Instead of a single ResourceFinder, Application should have a list of them, by default containing WebApplicationPath (today&apos;s default) and the new ClassloaderPath.&lt;/li&gt;
	&lt;li&gt;ResourceStreamLocator should not do any loading on its own at all and just use the ResourceFinders defined in this new list in Application.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This would also get rid of the hard-coded &quot;META-INF/resources&quot; lookup that currently is done in ResourceStreamLocator (I&apos;ll write a second ticket about that, it&apos;s causing us some problems).&lt;/p&gt;

&lt;p&gt;I think this could still be done within 6.0. Objections?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12595251">WICKET-4617</key>
            <summary>ResourceStreamLocator vs ResourceFinder</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cmenzel">Carl-Eric Menzel</assignee>
                                    <reporter username="cmenzel">Carl-Eric Menzel</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Jun 2012 11:12:22 +0000</created>
                <updated>Tue, 3 Jul 2012 13:15:02 +0000</updated>
                            <resolved>Tue, 3 Jul 2012 13:15:02 +0000</resolved>
                                    <version>1.5.7</version>
                    <version>6.0.0-beta2</version>
                                    <fixVersion>6.0.0-beta3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13401775" author="cmenzel" created="Tue, 26 Jun 2012 23:09:10 +0000"  >&lt;p&gt;I pushed some work in progress (actually pretty far design-wise) to sandbox/resourcefinder. I&apos;m going to continue this work tomorrow, though I hit a roadblock:&lt;/p&gt;

&lt;p&gt;IResourceFinder and friends are in wicket-util while UrlResourceStream is in wicket-core. To do classpath-based resource loading I need UrlResourceStream. Why are IResourceFinder and its implementations in wicket-util rather than -core? I tried moving UrlResourceStream to -util, but it needs the Application, which has to stay in -core, obviously.&lt;/p&gt;</comment>
                            <comment id="13402031" author="mgrigorov" created="Wed, 27 Jun 2012 07:43:08 +0000"  >&lt;p&gt;Put the new class in -core if it depends on something that is in -core.&lt;/p&gt;</comment>
                            <comment id="13402038" author="cmenzel" created="Wed, 27 Jun 2012 07:48:58 +0000"  >&lt;p&gt;I would have done that already, but the IResourceFinder interface is in -util. I wanted to ask first whether there is a pressing reason for it being in -util.&lt;/p&gt;</comment>
                            <comment id="13402043" author="mgrigorov" created="Wed, 27 Jun 2012 07:57:01 +0000"  >&lt;p&gt;We split wicket.jar to -util, -request and -core to make it more modular. Otherwise even simple util classes had access to Application/Session/... for no good reason and it was hard to use them e.g. in tests. You need to run WicketTester to test something simple.&lt;/p&gt;

&lt;p&gt;If you want to move IResourceFinder in -core then you may have to put it in o.a.w.core.util... and this will be yet another API change (package name change) for no reason ...&lt;/p&gt;</comment>
                            <comment id="13402216" author="cmenzel" created="Wed, 27 Jun 2012 13:27:18 +0000"  >&lt;p&gt;Okay, I just put my new class in -core without moving the rest.&lt;/p&gt;

&lt;p&gt;I found a basically broken test: org.apache.wicket.util.resource.ResourceTest plays around with Path, but never actually tests that class. Path never finds the resources the test wants it to find. Instead, the test is fooled by ResourceStreamLocator always falling back on classpath loading, which finds the resource.&lt;/p&gt;

&lt;p&gt;This is exactly what I had in mind when I mentioned the mixed-up responsibilities of RF and RSL &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;This test is trying to test Path but is actually testing RSL&apos;s classpath loading. I&apos;m going to refactor it to actually test those two things separately in master, and then port it over to the new resource loading.&lt;/p&gt;</comment>
                            <comment id="13402219" author="cmenzel" created="Wed, 27 Jun 2012 13:29:30 +0000"  >&lt;p&gt;My new solution (will be in sandbox/resourcefinder later today) clarifies ResourceStreamLocator and ResourceFinder like this:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ResourceStreamLocator uses a ResourceNameIterator to generate filenames to try and then uses a list of ResourceFinders to load the file.&lt;/li&gt;
	&lt;li&gt;ResourceStreamLocator no longer does any loading on its own&lt;/li&gt;
	&lt;li&gt;IResourcePath is removed - adding multiple paths to a single Path instance is rather odd&lt;/li&gt;
	&lt;li&gt;Path and WebApplicationPath both just implement IResourceFinder&lt;/li&gt;
	&lt;li&gt;ResourceSettings now contains a list of IResourceFinders instead of just one&lt;/li&gt;
	&lt;li&gt;to look in multiple paths, you add Path instances to that list&lt;/li&gt;
	&lt;li&gt;Instead of ResourceStreamLocator&apos;s hackish classpath loading, there is a new ClassPathResourceFinder that cleanly separates this stuff. it also simply resides in the list in ResourceSettings, put there by Application and WebApplication.&lt;/li&gt;
	&lt;li&gt;the META-INF/resources lookup is just another ClassPathResourceFinder, instead of being hardcoded in RSL.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13402220" author="mgrigorov" created="Wed, 27 Jun 2012 13:33:20 +0000"  >&lt;p&gt;Looks good!&lt;/p&gt;</comment>
                            <comment id="13402373" author="cmenzel" created="Wed, 27 Jun 2012 17:25:43 +0000"  >&lt;p&gt;All done. It&apos;s now available to look at in sandbox/resourcefinder. I&apos;ll add Javadoc tomorrow. I think this is much cleaner than before.&lt;/p&gt;</comment>
                            <comment id="13402896" author="mgrigorov" created="Thu, 28 Jun 2012 07:15:31 +0000"  >&lt;p&gt;Here is a URL to compare against master: &lt;a href=&quot;https://github.com/apache/wicket/compare/master...sandbox%2Fresourcefinder&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/compare/master...sandbox%2Fresourcefinder&lt;/a&gt;&lt;br/&gt;
I&apos;ll review it later today.&lt;/p&gt;</comment>
                            <comment id="13404749" author="mgrigorov" created="Sun, 1 Jul 2012 15:45:42 +0000"  >&lt;p&gt;Few comments from me:&lt;/p&gt;

&lt;p&gt;1) Do we really need : Application#getResourceFinderForPath(String path) ?&lt;br/&gt;
I find this as a helper method which place is not in Application API. &lt;br/&gt;
Additionally I&apos;m not sure that we really need this helper method in any helper class. I personally never needed to create IResourceFinder in my apps.&lt;br/&gt;
Additionally it is overridden in WebApplication, so I think no one will ever use the one in Application. AFAIK there are no non-Web impls&lt;/p&gt;

&lt;p&gt;I think IResourceSettings#addResourceFolder(String) should become IResourceSettings#addResourceFinder(IResourceFinder). Or just remove this method and let the user use #getResourceFinders().add(myFinder) as all listener related methods in WebApplication currently work.&lt;/p&gt;

&lt;p&gt;2) make member fields &apos;final&apos; if they are not going to change after class construction. E.g. WebApplicationPath#path&lt;/p&gt;

&lt;p&gt;3) In ClassPathResourceFinder, line 46:&lt;br/&gt;
 this.prefix = prefix + &quot;/&quot;;&lt;/p&gt;

&lt;p&gt;What if the passed argument already have the trailing slash ?&lt;br/&gt;
Also there is concatenation at &lt;a href=&quot;https://github.com/apache/wicket/compare/master...sandbox%2Fresourcefinder#L2R53&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/compare/master...sandbox%2Fresourcefinder#L2R53&lt;/a&gt; which may make this even more broken if &apos;path&apos; has a leading slash.&lt;/p&gt;

&lt;p&gt;4) Use SLF4J &apos;{}&apos; placeholders and avoid logger.isXyzEnabled() is possible.&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/wicket/compare/master...sandbox%2Fresourcefinder#L4R132&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/compare/master...sandbox%2Fresourcefinder#L4R132&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;5)  &lt;a href=&quot;https://github.com/apache/wicket/compare/master...sandbox%2Fresourcefinder#L7R387&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/compare/master...sandbox%2Fresourcefinder#L7R387&lt;/a&gt;&lt;br/&gt;
Is there a need for Args.nonNull() here ?&lt;/p&gt;
</comment>
                            <comment id="13405898" author="cmenzel" created="Tue, 3 Jul 2012 13:04:10 +0000"  >&lt;p&gt;1) No, we don&apos;t. I had kept that stuff for some semblance of backward compatibility, but since we&apos;re moving and breaking things anyway, it might as well go.&lt;/p&gt;

&lt;p&gt;2) Absolutely.&lt;/p&gt;

&lt;p&gt;3) In all my tests so far, double slashes were no problem. I&apos;m making this conditional in ClassPathResourceFinder now though.&lt;/p&gt;

&lt;p&gt;4) Done.&lt;/p&gt;

&lt;p&gt;5) Yes.&lt;/p&gt;</comment>
                            <comment id="13405906" author="cmenzel" created="Tue, 3 Jul 2012 13:15:02 +0000"  >&lt;p&gt;All done and pushed to master. I&apos;ll add something to the migration page in the wiki next.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>253139</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 20 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0dbtb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>75843</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>