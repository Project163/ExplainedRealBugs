<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:21:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-5146] Application not destroyed if WicketFilter#init() fails</title>
                <link>https://issues.apache.org/jira/browse/WICKET-5146</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;WicketFilter calls Application#initApplication() which calls Application#init().&lt;/p&gt;

&lt;p&gt;In case of Exception thrown in the application&apos;s init() method, there is no cleanup in WicketFilter&apos;s finally block.&lt;/p&gt;

&lt;p&gt;The result of this is, in case where Wicket is in the application server&apos;s libraries (not deployed with the war file), that the application cannot be re-deployed withhout re-starting the application server.&lt;/p&gt;

&lt;p&gt;That is because Application#setName() crashes with IllegalStateException(&quot;Application name can only be set once.&quot;).&lt;/p&gt;

&lt;p&gt;In Application, private static final Map&amp;lt;String, Application&amp;gt; applicationKeyToApplication holds a reference to the crashed instance after the application is undeployed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12642797">WICKET-5146</key>
            <summary>Application not destroyed if WicketFilter#init() fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="svenmeier">Sven Meier</assignee>
                                    <reporter username="bht@actrix.gen.nz">bernard</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Apr 2013 19:36:09 +0000</created>
                <updated>Fri, 19 Apr 2013 10:00:06 +0000</updated>
                            <resolved>Fri, 19 Apr 2013 10:00:06 +0000</resolved>
                                    <version>1.5.10</version>
                    <version>6.7.0</version>
                                    <fixVersion>6.8.0</fixVersion>
                    <fixVersion>1.5.11</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13635373" author="cedricgatay" created="Thu, 18 Apr 2013 17:23:28 +0000"  >&lt;p&gt;Could you provide a Quickstart regarding this issue please ?&lt;/p&gt;</comment>
                            <comment id="13635422" author="cedricgatay" created="Thu, 18 Apr 2013 17:51:33 +0000"  >&lt;p&gt;You&apos;ll find a patch that should work around the issue you described. However, without a quickstart, it would be difficult to check if it is ok. Please test it and tell me if it works for you.&lt;/p&gt;</comment>
                            <comment id="13635583" author="bht@actrix.gen.nz" created="Thu, 18 Apr 2013 19:39:19 +0000"  >&lt;p&gt;Quick start.&lt;/p&gt;</comment>
                            <comment id="13635599" author="bht@actrix.gen.nz" created="Thu, 18 Apr 2013 19:53:05 +0000"  >&lt;p&gt;I have attached the quickstart as requested. But to reproduce the problem you have to deploy the app to the server in a way that the libraries are not deployed with it. You can do this by adding an attribute to the dependencies &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;&lt;/p&gt;

&lt;p&gt;You could try this on an application server e.g. GlassFish that installs itself with NetBeans as follows:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Install the app server&lt;/li&gt;
	&lt;li&gt;copy wicket libraries to the domain&apos;s lib folder&lt;/li&gt;
	&lt;li&gt;Run the app with the exception in init()&lt;/li&gt;
	&lt;li&gt;Take out the exception, recompile and run again&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In the error scenario, private static final Map&amp;lt;String, Application&amp;gt; applicationKeyToApplication is not cleared. I don&apos;t know how the patch addresses this.&lt;/p&gt;</comment>
                            <comment id="13635601" author="cedricgatay" created="Thu, 18 Apr 2013 19:57:16 +0000"  >&lt;p&gt;Thanks. I&apos;ll have a look at it. I think the way I fixed it the flag in the hash map will not be cleared but overwritten by the second deploy. &lt;/p&gt;</comment>
                            <comment id="13635635" author="bht@actrix.gen.nz" created="Thu, 18 Apr 2013 20:21:47 +0000"  >&lt;p&gt;The hash map cannot be overwritten because it is final. I think you need to call Application#internalDestroy()&lt;/p&gt;</comment>
                            <comment id="13635758" author="cedricgatay" created="Thu, 18 Apr 2013 22:13:14 +0000"  >&lt;p&gt;After testing against your test application, it appears that one need to call internalDestroy() as you stated in order to properly unregister the application from the static application hashmap.&lt;/p&gt;

&lt;p&gt;The attached fix-&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5146&quot; title=&quot;Application not destroyed if WicketFilter#init() fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5146&quot;&gt;&lt;del&gt;WICKET-5146&lt;/del&gt;&lt;/a&gt;-2.patch file include this update wrapped inside another try / catch block.&lt;/p&gt;</comment>
                            <comment id="13636229" author="svenmeier" created="Fri, 19 Apr 2013 10:00:06 +0000"  >&lt;p&gt;I changed the patch to call #destroy(), thus safely destroying the application factory too.&lt;/p&gt;

&lt;p&gt;Thanks Cedric.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12579439" name="fix-WICKET-5146-2.patch" size="1105" author="cedricgatay" created="Thu, 18 Apr 2013 22:13:14 +0000"/>
                            <attachment id="12579400" name="testcase.zip" size="24687" author="bht@actrix.gen.nz" created="Thu, 18 Apr 2013 19:39:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323211</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 31 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1jrj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323556</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>