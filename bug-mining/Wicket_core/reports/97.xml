<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:17:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-3420] javascript with a less than character (&quot;&lt;&quot;) fails to execute when added through a header contribution in ajax response</title>
                <link>https://issues.apache.org/jira/browse/WICKET-3420</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;This is adapted from a wicket users post I made (links are to the same thread in two archive systems):&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://markmail.org/search/?q=wicket%20users%20wicket-ajax.js#query:wicket%20users%20wicket-ajax.js+page:1+mid:rfts3ar3upffhbbt+state:results&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://markmail.org/search/?q=wicket%20users%20wicket-ajax.js#query:wicket%20users%20wicket-ajax.js+page:1+mid:rfts3ar3upffhbbt+state:results&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/wicket-users/201102.mbox/%3CAANLkTi=EkmTA0RnA+GyJE-CQWmkCxRLsjp+z8jwv-Aw9@mail.gmail.com%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/wicket-users/201102.mbox/%3CAANLkTi=EkmTA0RnA+GyJE-CQWmkCxRLsjp+z8jwv-Aw9@mail.gmail.com%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The problem:  I have a panel with this:&lt;/p&gt;

&lt;p&gt;    &amp;lt;wicket:head&amp;gt;&lt;br/&gt;
	&amp;lt;script&amp;gt;&lt;br/&gt;
		if (someVariable &amp;lt; 0) &lt;/p&gt;
{
			someVariable = 0;		
		}
&lt;p&gt;	&amp;lt;/script&amp;gt;&lt;br/&gt;
    &amp;lt;/wicket:head&amp;gt;&lt;/p&gt;

&lt;p&gt;This script fails to execute when the panel is loaded by ajax.  If I replace the less than character &quot;&amp;lt;&quot; with equals &quot;==&quot;, then it executes (but of course, this is not what I need).&lt;/p&gt;

&lt;p&gt;I tested this in Firefox 4.0b10 and Chrome 8.&lt;/p&gt;

&lt;p&gt;After some debugging, it seems to me that this needs to be corrected in wicket-ajax.js. The header contribution is sent to the browser inside of a CDATA section so the &quot;&amp;lt;&quot; character arrives to javascript intact. However, in parsing the script tag, the &quot;&amp;lt;&quot; seems to signal the beginning of an HTML tag that then is considered malformed.&lt;/p&gt;


&lt;p&gt;Possible workarounds for apps:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Invert the logic so a greater-than is used. In my example, this would be: &quot;if (0 &amp;gt; someVariable) {&quot;&lt;/li&gt;
	&lt;li&gt;Put the code into a separate JS file (the downside is it requires another network hop from the browser)&lt;/li&gt;
	&lt;li&gt;Embed the script in &amp;lt;wicket:panel&amp;gt; rather than &amp;lt;wicket:head&amp;gt; (the disadvantage is the script will be re-sent with the panel content when the panel is re-used on the same page)&lt;/li&gt;
&lt;/ul&gt;

</description>
                <environment>Validated this bug on my dev environment: Windows 7 64 bit using Firefox 4.0beta10 and Chrome 8.</environment>
        <key id="12497607">WICKET-3420</key>
            <summary>javascript with a less than character (&quot;&lt;&quot;) fails to execute when added through a header contribution in ajax response</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="randypower">Randy Schnedler</reporter>
                        <labels>
                            <label>ajax</label>
                            <label>header-contribution</label>
                            <label>javascript</label>
                            <label>wicket-ajax.js</label>
                    </labels>
                <created>Thu, 3 Feb 2011 19:07:13 +0000</created>
                <updated>Tue, 21 Feb 2012 14:57:21 +0000</updated>
                            <resolved>Mon, 21 Mar 2011 09:26:04 +0000</resolved>
                                    <version>1.4.15</version>
                                    <fixVersion>1.5-RC3</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12993576" author="mgrigorov" created="Fri, 11 Feb 2011 16:51:47 +0000"  >&lt;p&gt;another workaround is to use &quot;if (someVar &amp;lt; 0) {&quot;&lt;/p&gt;</comment>
                            <comment id="12994431" author="mgrigorov" created="Mon, 14 Feb 2011 19:11:27 +0000"  >&lt;p&gt;Please a provide a quickstart that reproduces the problem.&lt;br/&gt;
Thanks!&lt;/p&gt;</comment>
                            <comment id="12996310" author="mgrigorov" created="Fri, 18 Feb 2011 09:54:40 +0000"  >&lt;p&gt;With r1071930 (trunk0 and r1071931 (1.4.x) I added logic to log an error with the message provided by the Javascript engine about the problem.&lt;br/&gt;
Tested with Firefox 3.6, Chrome 10.x and Opera 11. FF3 gives the best description of the problem. IE uses ActiveXObject to parse XML and has its own logic to log errors.&lt;/p&gt;

&lt;p&gt;I think Wicket cannot do more here. Even my IDE marks this line as XML error. &lt;br/&gt;
The best solution is to wrap the JS code in HTML comments:&lt;br/&gt;
&amp;lt;script&amp;gt;&lt;br/&gt;
&amp;lt;!--&lt;br/&gt;
  if (a &amp;lt; 0) &lt;/p&gt;
{...}
&lt;p&gt;--&amp;gt;&lt;br/&gt;
&amp;lt;/script&amp;gt;&lt;/p&gt;

&lt;p&gt;This is proven to work with the years.&lt;/p&gt;

&lt;p&gt;If anyone else has better solution please share, otherwise I think we can close the ticket as &quot;Won&apos;t fix&quot;,&lt;/p&gt;</comment>
                            <comment id="12996322" author="hudson" created="Fri, 18 Feb 2011 10:17:52 +0000"  >&lt;p&gt;Integrated in Apache Wicket 1.4.x #448 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Apache%20Wicket%201.4.x/448/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Apache%20Wicket%201.4.x/448/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3420&quot; title=&quot;javascript with a less than character (&amp;quot;&amp;lt;&amp;quot;) fails to execute when added through a header contribution in ajax response&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3420&quot;&gt;&lt;del&gt;WICKET-3420&lt;/del&gt;&lt;/a&gt; javascript with a less than character (&quot;&amp;lt;&quot;) fails to execute when added through a header contribution in ajax response&lt;/p&gt;

&lt;p&gt;Add logging for the cases when there is an error in the parsing of XML with DOMParser&lt;/p&gt;</comment>
                            <comment id="12996855" author="ivaynberg" created="Sat, 19 Feb 2011 20:35:56 +0000"  >&lt;p&gt;attaching quickstart that reproduces the problem&lt;/p&gt;</comment>
                            <comment id="12997170" author="ivaynberg" created="Sun, 20 Feb 2011 17:49:02 +0000"  >&lt;p&gt;can we not do the wrapping within &amp;lt;!-- --&amp;gt; automatically?&lt;/p&gt;</comment>
                            <comment id="12997523" author="mgrigorov" created="Mon, 21 Feb 2011 18:55:31 +0000"  >&lt;p&gt;If possible then it is hard to achieve.&lt;br/&gt;
With a custom MarkupFilter I was able to prepend raw markup only. That is I can add &apos;-&lt;del&gt;&amp;gt;&apos; before &amp;lt;/script&amp;gt; but I cannot find a way to add &apos;&amp;lt;!&lt;/del&gt;-&apos; after &amp;lt;script&amp;gt; and before script&apos;s body.&lt;br/&gt;
Reasons:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;XmlPullParser doesn&apos;t create MarkupElements for text content. Just for open and close tags.&lt;/li&gt;
	&lt;li&gt;XmlPullParser doesn&apos;t go deeper in &amp;lt;script&amp;gt; tags&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Another problem is org.apache.wicket.markup.AbstractMarkupParser.handleRawText(String) which strips HTML comments if org.apache.wicket.settings.IMarkupSettings.getStripComments() returns true. So even my suggested workaround would completely fail in this case (the whole Javascript will be stripped).  &lt;/p&gt;</comment>
                            <comment id="12997531" author="jdonnerstag" created="Mon, 21 Feb 2011 19:16:37 +0000"  >&lt;p&gt;you can add elements before and after. It&apos;s not immediately obvious though. Essentially you must remember what you want to return after the &amp;lt;script&amp;gt; tag and you return that when next() is called next time (don&apos;t forget to reset your &quot;rememberme&quot; variable).  You&apos;ll understand the idea when you realize that the MarkupFilters are chained rather than called separately from an interator.&lt;/p&gt;

&lt;p&gt;might be I&apos;m mistaken, but I think handleRawText() only removed comments inside a single rawmarkup element. If we manually add &amp;lt;!-- and --&amp;gt;, it&apos;ll be in 3+ markupelements.&lt;/p&gt;</comment>
                            <comment id="12997875" author="mgrigorov" created="Tue, 22 Feb 2011 16:15:22 +0000"  >&lt;p&gt;I give up. i tried many things and I cannot make it working.&lt;br/&gt;
I&apos;m attaching a patch so you can use it as a start.&lt;/p&gt;</comment>
                            <comment id="13001907" author="mgrigorov" created="Thu, 3 Mar 2011 08:22:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://developer.mozilla.org/en/Writing_JavaScript_for_XHTML&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://developer.mozilla.org/en/Writing_JavaScript_for_XHTML&lt;/a&gt; recommends to use CDATA for cases like this one instead of XML comments, otherwise XHTML will not work.&lt;br/&gt;
They also show the same for &amp;lt;style type=&quot;text/css&quot;&amp;gt; - otherwise CSS selector can break the application the same way.&lt;/p&gt;</comment>
                            <comment id="13008815" author="jdonnerstag" created="Sat, 19 Mar 2011 19:54:58 +0000"  >&lt;p&gt;fixed&lt;/p&gt;</comment>
                            <comment id="13009066" author="mgrigorov" created="Mon, 21 Mar 2011 09:20:09 +0000"  >&lt;p&gt;Reopen because FF 3.6 fails here with: &quot;invalid syntax CDATA&quot;.&lt;/p&gt;</comment>
                            <comment id="13009068" author="mgrigorov" created="Mon, 21 Mar 2011 09:26:04 +0000"  >&lt;p&gt;Improved with r1083712.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12503398">WICKET-3597</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12543490">WICKET-4425</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12471630" name="WICKET-3420.patch" size="7011" author="mgrigorov" created="Tue, 22 Feb 2011 16:15:22 +0000"/>
                            <attachment id="12471486" name="myproject.rar" size="6796" author="ivaynberg" created="Sat, 19 Feb 2011 20:35:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204213</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 35 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kb13:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116604</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>