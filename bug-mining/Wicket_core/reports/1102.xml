<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:23:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-5747] Wicket Ajax Click handling gets requeued in OnDomReady so fire out of order</title>
                <link>https://issues.apache.org/jira/browse/WICKET-5747</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;While debugging some jquery script ordering, we noticed the following and I&apos;m looking for views on why this is done and/or if it&apos;s a bug:&lt;/p&gt;

&lt;p&gt;1. Wicket assembles all ajax click handlers and writes them out into a single Wicket.Event.add(window,&quot;domready&quot; function(event) { .... script invocation written in to the &amp;lt;head&amp;gt; element of the page.&lt;br/&gt;
2. For things like click handlers, Wicket writes out Wicket.Ajax.ajax( &lt;/p&gt;
{&quot;c&quot;: &quot;selection4e2&quot;, &quot;u&quot;:&quot;.....&quot;, &quot;m&quot;:&quot;POST&quot;}
&lt;p&gt;) calls that execute within the onDomReady function defined in (1)&lt;br/&gt;
3. This invocation of (2) in turn invokes jquery( fn );  This requeues the function invocation at the back of the jquery event queue for onDomReady processing&lt;br/&gt;
4. Any custom scripts that we added using OnDomReadyHeaderItem, regardless of where we put them on the page after the standard Wicket click handler JS, are now invoked, according to page order.&lt;br/&gt;
5. The re-queued functions from (3) now execute after my custom scripts.  &lt;/p&gt;

&lt;p&gt;These custom scripts modify the DOM (table paging/filtering etc) and this mechanism now results in Wicket JS errors since the Wicket click handler binding fail to find the required elements in the DOM.&lt;/p&gt;

&lt;p&gt;Is this re-queueing intentional, and is there a reason that we couldnt just execute the click handler additions in step (1) rather than re-queuing the JS call?&lt;/p&gt;

&lt;p&gt;A workaround for this is to wrap all of our application JS functions in a separate jQuery( ... ) invocation, so that we can requeue all of our functions after all the requeued Wicket ones.  It works, but we dont understand the need for Wicket to perform this requeueing instead of just executing the function as and where defined on the page.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12752434">WICKET-5747</key>
            <summary>Wicket Ajax Click handling gets requeued in OnDomReady so fire out of order</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="nickpratt">Nick Pratt</reporter>
                        <labels>
                            <label>ajax</label>
                            <label>javascript</label>
                    </labels>
                <created>Mon, 3 Nov 2014 14:21:46 +0000</created>
                <updated>Mon, 17 Nov 2014 15:48:40 +0000</updated>
                            <resolved>Mon, 17 Nov 2014 15:48:40 +0000</resolved>
                                    <version>6.17.0</version>
                                    <fixVersion>7.0.0-M5</fixVersion>
                    <fixVersion>6.19.0</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14214698" author="mgrigorov" created="Mon, 17 Nov 2014 14:42:02 +0000"  >&lt;p&gt;Wicket usually adds &apos;e&apos; to &lt;/p&gt;
{&quot;c&quot;: &quot;selection4e2&quot;, &quot;u&quot;:&quot;.....&quot;, &quot;m&quot;:&quot;POST&quot;}
&lt;p&gt;. It looks like: &apos;e&apos;: &apos;click&apos; (or &apos;change&apos;, &apos;focus&apos;, &apos;my-event&apos;, etc.).&lt;/p&gt;

&lt;p&gt;At &lt;a href=&quot;https://github.com/apache/wicket/blob/master/wicket-core/src/main/java/org/apache/wicket/ajax/res/js/wicket-ajax-jquery.js#L1902&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/blob/master/wicket-core/src/main/java/org/apache/wicket/ajax/res/js/wicket-ajax-jquery.js#L1902&lt;/a&gt; Wicket uses &apos;domready&apos; only if there is no specified event, so it will execute the function as soon as the DOM is ready.&lt;/p&gt;

&lt;p&gt;To resolve the problem you need to use an event.&lt;br/&gt;
The flow then would be:&lt;br/&gt;
1) all OnDomReadyHeaderItems are executed at Wicket.Event.add(window,&quot;domready&quot;, ...)&lt;br/&gt;
2) they will bind JS event listeners for the event they are interested in (e.g. &quot;For things like click handlers&quot; the event is &apos;click&apos; and it will be handled by the &apos;else&apos; branch at &lt;a href=&quot;https://github.com/apache/wicket/blob/master/wicket-core/src/main/java/org/apache/wicket/ajax/res/js/wicket-event-jquery.js#L213&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/wicket/blob/master/wicket-core/src/main/java/org/apache/wicket/ajax/res/js/wicket-event-jquery.js#L213&lt;/a&gt;, not by the &apos;if (type === &apos;domready&apos;) {&apos; branch). So there won&apos;t be rescheduling.&lt;/p&gt;</comment>
                            <comment id="14214706" author="nickpratt" created="Mon, 17 Nov 2014 14:55:22 +0000"  >&lt;p&gt;Im not sure I follow here - the events in question that are firing out of order are the basic Ajax click events for standard Wicket components (not ours) in the usual Wicket onDomReady header block.  Wicket is requeuing those events, which results in an out-of-order sequence in the browser. What we cant understand is why the standard Wicket click handlers are being requeued and not simply executed at the time of eval.&lt;/p&gt;

&lt;p&gt;We&apos;re using Wicket 6.17.0&lt;/p&gt;

&lt;p&gt;Our work around for the time being is to cause all of our application specific events to be requeued.  That way, they fire after the requeued Wicket events.  &lt;/p&gt;</comment>
                            <comment id="14214708" author="mgrigorov" created="Mon, 17 Nov 2014 14:59:30 +0000"  >&lt;p&gt;Please update the flow in your description with the new knowledge from my comment.&lt;br/&gt;
Better add a new comment with the flow.&lt;br/&gt;
I don&apos;t see any requeueing if there is &apos;e&apos; in the Ajax attributes.&lt;/p&gt;</comment>
                            <comment id="14214712" author="nickpratt" created="Mon, 17 Nov 2014 15:04:27 +0000"  >&lt;p&gt;The line you referred to (line 213) invokes: jquery( fn ) &amp;lt;--- That &lt;b&gt;requeues&lt;/b&gt; the event (check the docs for the jquery function) to the &lt;b&gt;back&lt;/b&gt; of the jquery onDomReady event queue.  The function that invokes line 213 is running inside the jquery ondomready function, so invoking jquery( anyFn ) causes it to be requeued to the back of the jquery event queue which leads to an out-of-order sequencing of the events listed in the &amp;lt;head&amp;gt; script on the page.&lt;/p&gt;</comment>
                            <comment id="14214717" author="mgrigorov" created="Mon, 17 Nov 2014 15:10:11 +0000"  >&lt;p&gt;OK. I see. It&apos;s because of &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5181&quot; title=&quot;Problem with OnEventHeaderItem and Wicket.Event.add&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5181&quot;&gt;&lt;del&gt;WICKET-5181&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14214723" author="nickpratt" created="Mon, 17 Nov 2014 15:16:06 +0000"  >&lt;p&gt;Is there a reason why we couldn&apos;t execute those standard Wicket JS handlers directly during invocation of the &lt;/p&gt;

&lt;p&gt;Wicket.Event.add(window, &quot;domready&quot;, function(event) &lt;/p&gt;
{ ... }

&lt;p&gt;method so that all events contained therein fire in the order as laid out on the page (assuming we could detect that we were running inside the jquery domready function?&lt;/p&gt;</comment>
                            <comment id="14214752" author="jira-bot" created="Mon, 17 Nov 2014 15:45:21 +0000"  >&lt;p&gt;Commit 626d93fb0f8aa1997d534f6b2f150db72d06fde6 in wicket&apos;s branch refs/heads/wicket-6.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mgrigorov&quot; class=&quot;user-hover&quot; rel=&quot;mgrigorov&quot;&gt;mgrigorov&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=626d93f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=626d93f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5747&quot; title=&quot;Wicket Ajax Click handling gets requeued in OnDomReady so fire out of order&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5747&quot;&gt;&lt;del&gt;WICKET-5747&lt;/del&gt;&lt;/a&gt; Wicket Ajax Click handling gets requeued in OnDomReady so fire out of order&lt;/p&gt;</comment>
                            <comment id="14214754" author="jira-bot" created="Mon, 17 Nov 2014 15:48:36 +0000"  >&lt;p&gt;Commit 5fb0c772b4259eae31514272f9479fbdbe6c6470 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mgrigorov&quot; class=&quot;user-hover&quot; rel=&quot;mgrigorov&quot;&gt;mgrigorov&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=5fb0c77&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=5fb0c77&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5747&quot; title=&quot;Wicket Ajax Click handling gets requeued in OnDomReady so fire out of order&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5747&quot;&gt;&lt;del&gt;WICKET-5747&lt;/del&gt;&lt;/a&gt; Wicket Ajax Click handling gets requeued in OnDomReady so fire out of order&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 626d93fb0f8aa1997d534f6b2f150db72d06fde6)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12646380">WICKET-5181</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21w9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>