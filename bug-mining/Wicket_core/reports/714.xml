<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:21:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4777] JavaScriptReference escapes given URL</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4777</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>
&lt;p&gt;while trying to integrate gmaps3 in our webapp i had issues with the wicketstuff-gmap3 stuff ( - we need a client-id for our request) ...&lt;/p&gt;

&lt;p&gt;so i have:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;public static final String GMAP_API_URL = &quot;%s://maps.google.com/maps/api/js?v=3&amp;amp;sensor=%s&amp;amp;client-id=%s&quot;;

response.render(JavaScriptHeaderItem.forUrl(String.format(GMAP_API_URL, schema, sensor, clientid)));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the rendered result of this is:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;script type=&quot;text/javascript&quot; src=&quot;http://maps.google.com/maps/api/js?v=3&amp;amp;amp;sensor=false&amp;amp;amp;client-id=....&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;so the requestparameters are encoded&lt;/p&gt;

&lt;p&gt;which is happening in the JavaScriptUtils Helper:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;public static void writeJavaScriptUrl(final Response response, final CharSequence url, final String id, boolean defer, String charset)
{
        response.write(&quot;&amp;lt;script type=\&quot;text/javascript\&quot; &quot;);
        if (id != null)
        {
            response.write(&quot;id=\&quot;&quot; + Strings.escapeMarkup(id) + &quot;\&quot; &quot;);
        }
        if (defer)
        {
            response.write(&quot;defer=\&quot;defer\&quot; &quot;);
        }
        if (charset != null)
        {
            response.write(&quot;charset=\&quot;&quot; + Strings.escapeMarkup(charset) + &quot;\&quot; &quot;);
        }
        response.write(&quot;src=\&quot;&quot;);
        response.write(Strings.escapeMarkup(url));
        response.write(&quot;\&quot;&amp;gt;&amp;lt;/script&amp;gt;&quot;);
        response.write(&quot;\n&quot;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but ... is this right to escape the url?&lt;/p&gt;

&lt;p&gt;when i open the above mentioned script, google tells me i have no parameter &quot;sensor&quot; ... which i can understand as ther is only a parameter amp ... &lt;/p&gt;</description>
                <environment></environment>
        <key id="12608612">WICKET-4777</key>
            <summary>JavaScriptReference escapes given URL</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="gb6881">Georg Buschbeck</reporter>
                        <labels>
                    </labels>
                <created>Fri, 21 Sep 2012 10:54:58 +0000</created>
                <updated>Mon, 5 Aug 2019 20:12:05 +0000</updated>
                            <resolved>Mon, 15 Oct 2012 13:38:14 +0000</resolved>
                                    <version>6.0.0</version>
                                    <fixVersion>6.2.0</fixVersion>
                    <fixVersion>1.5.9</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13473925" author="gb6881" created="Thu, 11 Oct 2012 07:50:07 +0000"  >
&lt;p&gt;Hi&lt;/p&gt;

&lt;p&gt;one addition, so i&apos;ve seen you&apos;ve fixed that issue (&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-4777&quot; title=&quot;JavaScriptReference escapes given URL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-4777&quot;&gt;&lt;del&gt;WICKET-4777&lt;/del&gt;&lt;/a&gt;) , but i think, there is a part missing, which i also didn&apos;t think of.&lt;/p&gt;

&lt;p&gt;on the delivered page the html code looks fine now (switched to 6.2.0-SNAPSHOT).&lt;br/&gt;
-&lt;del&gt;snip&lt;/del&gt;-&lt;br/&gt;
&amp;lt;script type=&quot;text/javascript&quot; src=&quot;http://maps.googleapis.com/maps/api/js?sensor=false&amp;amp;client-id=google-id&amp;amp;callback=initialize&quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;br/&gt;
-&lt;del&gt;snap&lt;/del&gt;-&lt;br/&gt;
when doing an ajax request whose response contains that rendered url it is represented the same way ..&lt;/p&gt;

&lt;p&gt;-&lt;del&gt;snip&lt;/del&gt;-&lt;br/&gt;
&amp;lt;header-contribution encoding=&quot;wicket1&quot; &amp;gt;&amp;lt;![CDATA[&amp;lt;head xmlns:wicket=&quot;http://wicket.apache.org&quot;&amp;gt;&amp;lt;script type=&quot;text/javascript&quot; src=&quot;http://maps.googleapis.com/maps/api/js?sensor=false&amp;amp;client-id=google-id&amp;amp;callback=initialize&quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;br/&gt;
-&lt;del&gt;snap&lt;/del&gt;-&lt;/p&gt;


&lt;p&gt;which at this point leads to an javascript error:&lt;br/&gt;
-&lt;del&gt;snip&lt;/del&gt;-&lt;br/&gt;
ERROR: Error in parsing: This page contains the following errors:error on line 1 at column 98: EntityRef: expecting &apos;;&apos;&lt;br/&gt;
Below is a rendering of the page up to the first error.&lt;br/&gt;
-&lt;del&gt;snap&lt;/del&gt;-&lt;/p&gt;

&lt;p&gt;so i guess, it has to be escaped?&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Georg&lt;/p&gt;</comment>
                            <comment id="13476102" author="mgrigorov" created="Mon, 15 Oct 2012 12:21:14 +0000"  >&lt;p&gt;For me the rendered script is: &lt;br/&gt;
&amp;lt;script type=&quot;text/javascript&quot; src=&quot;http://maps.googleapis.com/maps/api/js?sensor=false&amp;amp;callback=initialize;&quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/p&gt;

&lt;p&gt;Notice the &apos;;&apos; at the end of the url. I&apos;ll debug why it is there.&lt;/p&gt;</comment>
                            <comment id="13476108" author="mgrigorov" created="Mon, 15 Oct 2012 12:31:10 +0000"  >&lt;p&gt;The problem is at org.wicketstuff.gmap.GMap#renderHead() :&lt;br/&gt;
response.render(JavaScriptHeaderItem.forUrl(&quot;http://maps.googleapis.com/maps/api/js?sensor=&quot; + sensor + &quot;&amp;amp;callback=initialize;&quot;));&lt;/p&gt;</comment>
                            <comment id="13476111" author="mgrigorov" created="Mon, 15 Oct 2012 12:44:02 +0000"  >&lt;p&gt;This doesn&apos;t solve the problem.&lt;br/&gt;
It still sees an entity: &amp;amp;callback without the closing ;&lt;/p&gt;</comment>
                            <comment id="13476142" author="gb6881" created="Mon, 15 Oct 2012 13:37:47 +0000"  >&lt;p&gt;in our code i now inherited form GMap, overiding Gmap#renderHead():&lt;/p&gt;

&lt;p&gt;            if (WicketHelper.isAjaxRequest())&lt;/p&gt;
            {
                // FIX WICKET-4777
                response.render(new StringHeaderItem(&quot;&amp;lt;script type=\&quot;text/javascript\&quot; src=\&quot;&quot;
                        + Strings.escapeMarkup(schema
                                + &quot;://maps.google.com/maps/api/js?v=3&amp;amp;sensor=false&amp;amp;&quot;)
                        + &quot;\&quot;&amp;gt;&amp;lt;/script&amp;gt;&quot;));

            }
&lt;p&gt;            else&lt;/p&gt;
            {
                response.render(JavaScriptHeaderItem.forUrl(schema + &quot;://maps.googleapis.com/maps/api/js?sensor=&quot;
                        + false +  &quot;&amp;amp;callback=initialize&quot;));
            }

&lt;p&gt;which solved the ajax problems for us&lt;/p&gt;</comment>
                            <comment id="13476143" author="mgrigorov" created="Mon, 15 Oct 2012 13:38:14 +0000"  >&lt;p&gt;Now Wicket escapes the url in Ajax requests and render the non-escaped url in normal requests.&lt;/p&gt;</comment>
                            <comment id="16900384" author="jira-bot" created="Mon, 5 Aug 2019 20:10:47 +0000"  >&lt;p&gt;Commit 4027b5456031dae79af7ca0a14a1fe59719653ad in wicket&apos;s branch refs/heads/master from Andrew Kondratev&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=wicket.git;h=4027b54&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=wicket.git;h=4027b54&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6682&quot; title=&quot;Improve JavaScriptContentHeaderItem and JavaScriptUtils to support nonce&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6682&quot;&gt;&lt;del&gt;WICKET-6682&lt;/del&gt;&lt;/a&gt; add CSP nonce support&lt;/p&gt;

&lt;p&gt;reverts &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-4777&quot; title=&quot;JavaScriptReference escapes given URL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-4777&quot;&gt;&lt;del&gt;WICKET-4777&lt;/del&gt;&lt;/a&gt; since all markup attributes have to be encoded&lt;/p&gt;

&lt;p&gt;this closes #376&lt;/p&gt;</comment>
                            <comment id="16900385" author="svenmeier" created="Mon, 5 Aug 2019 20:12:05 +0000"  >&lt;p&gt;This change was reverted with &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-6682&quot; title=&quot;Improve JavaScriptContentHeaderItem and JavaScriptUtils to support nonce&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-6682&quot;&gt;&lt;del&gt;WICKET-6682&lt;/del&gt;&lt;/a&gt; since all markup attributes have to be encoded (whether Ajax or not).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12548707" name="de.thomasdaily.WICKET4777.tgz" size="20707" author="gb6881" created="Thu, 11 Oct 2012 07:50:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>247282</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 14 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i089lz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46156</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>