<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:17:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-3608] input button escapes escaped value</title>
                <link>https://issues.apache.org/jira/browse/WICKET-3608</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;An input button with a value attribute containing escaped characters (&amp;gt;) is double escaped when rendered. Worked in 1.4.x.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12503964">WICKET-3608</key>
            <summary>input button escapes escaped value</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="svenmeier">Sven Meier</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Apr 2011 19:00:57 +0000</created>
                <updated>Tue, 28 Aug 2012 18:33:07 +0000</updated>
                            <resolved>Fri, 6 May 2011 10:20:31 +0000</resolved>
                                    <version>1.5-RC3</version>
                                    <fixVersion>1.5-RC4</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13018512" author="svenmeier" created="Mon, 11 Apr 2011 19:11:02 +0000"  >&lt;p&gt;test&lt;/p&gt;</comment>
                            <comment id="13018553" author="mgrigorov" created="Mon, 11 Apr 2011 20:27:06 +0000"  >&lt;p&gt;The cause is &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-2829&quot; title=&quot;Tag attributes values are not escaped properly during writeOutput&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-2829&quot;&gt;&lt;del&gt;WICKET-2829&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13018558" author="mgrigorov" created="Mon, 11 Apr 2011 20:35:00 +0000"  >&lt;p&gt;possible solution&lt;/p&gt;</comment>
                            <comment id="13018732" author="ivaynberg" created="Tue, 12 Apr 2011 05:38:16 +0000"  >&lt;p&gt;applied martin&apos;s patch. makes sense and makes things more consistent.&lt;/p&gt;</comment>
                            <comment id="13019324" author="pedrosans" created="Wed, 13 Apr 2011 13:47:00 +0000"  >&lt;p&gt;In the way XmlTag and ComponentTag were changed in &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-2829&quot; title=&quot;Tag attributes values are not escaped properly during writeOutput&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-2829&quot;&gt;&lt;del&gt;WICKET-2829&lt;/del&gt;&lt;/a&gt;, I thought we would suggest users to entrust tag attribute escaping to framework. It is not consistent to decide to escape an attribute or not based in a component flag designed to model text, and not for tag attribute content.&lt;br/&gt;
I&apos;m sending the Sven patch back still failing after r1091299. If suggest user to entrust tag attribute escaping to framework is not a good idea, I guess we need a new flag, API and doc explaining that Wicket escapes tag attribute by default, and you can change this default behavior by setting (...)&lt;/p&gt;</comment>
                            <comment id="13019330" author="mgrigorov" created="Wed, 13 Apr 2011 13:54:56 +0000"  >&lt;p&gt;Reopening the issue since it broke few tests.&lt;/p&gt;</comment>
                            <comment id="13019332" author="mgrigorov" created="Wed, 13 Apr 2011 13:55:47 +0000"  >&lt;p&gt;From IRC:&lt;br/&gt;
(03:52:21 PM) martin-g: the problem is that the user cannot provide: &amp;lt;input value=&quot; aaa &amp;lt; bb&quot; .../&amp;gt;&lt;br/&gt;
(03:52:51 PM) martin-g: ComponentTag will encode it properly but the problem is that XmlPullParser will fail to parse it&lt;br/&gt;
(03:53:06 PM) pedrosans: hum, I missed that&lt;br/&gt;
(03:53:56 PM) martin-g: if the attribute value comes from the code then it works out of the box - wicket encodes it for you&lt;br/&gt;
(03:54:12 PM) martin-g: but if you try to set it in the html then the parser chokes&lt;/p&gt;</comment>
                            <comment id="13025127" author="mgrigorov" created="Tue, 26 Apr 2011 08:05:54 +0000"  >&lt;p&gt;Nice solution/workaround here is to use resource bundle for this special value.&lt;br/&gt;
E.g. &lt;br/&gt;
in markup : &amp;lt;input type=&quot;button&quot; wicket:message=&quot;value:myKey&quot;/&amp;gt;&lt;br/&gt;
in MyApp.properties: myKey=Bla a&amp;lt;b&amp;gt;c.&lt;/p&gt;

&lt;p&gt;I understand that it looks like a hack but the automatic encoding for attribute values in one central place (ComponentTag.writeOutput()) is too cool to be sacrificed for this special use case.&lt;/p&gt;</comment>
                            <comment id="13025239" author="akiraly" created="Tue, 26 Apr 2011 14:13:53 +0000"  >&lt;p&gt;Imho the markup document and its file representation should be two different things). Converting (reading/deserializing) from file to document should involve a step where the xml entities are decoded. So if in the file it is &amp;lt;input type=&quot;button&quot; value=&quot;Bla a&amp;lt;b&amp;gt;c&quot; /&amp;gt; in the parsed document (in memory) this should be &amp;lt;input type=&quot;button&quot; value=&quot;Bla a&amp;lt;b&amp;gt;c&quot; /&amp;gt; (or a DOM object representing this). Afaik this is how xml, html parsers work too.&lt;/p&gt;

&lt;p&gt;Similarly the converting (writing/serializing) from document to file now involves a central encoding step (&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-2829&quot; title=&quot;Tag attributes values are not escaped properly during writeOutput&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-2829&quot;&gt;&lt;del&gt;WICKET-2829&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="13025288" author="jdonnerstag" created="Tue, 26 Apr 2011 15:41:43 +0000"  >&lt;p&gt;I agree with Attila. A IMarkupFilter would probably the right place, because there tag attributes are available. Tags which are irrelevant for Wicket are passed on as RawMarkup without any conversion anyways.&lt;/p&gt;</comment>
                            <comment id="13028376" author="mgrigorov" created="Tue, 3 May 2011 19:14:48 +0000"  >&lt;p&gt;Here is a IMarkupFilter based solution which unescapes all ComponentTag attribute values.&lt;br/&gt;
It is based on &lt;a href=&quot;http://www.docjar.com/html/api/org/apache/commons/lang/Entities.java.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.docjar.com/html/api/org/apache/commons/lang/Entities.java.html&lt;/a&gt; but without the support for all the HTML entities.&lt;br/&gt;
Currently supported ones are: nbsp, lt, gt, amp, quot and #039. If we want to support all other entities then maybe it will be better to copy the whole Entities class from commons-lang.&lt;/p&gt;

&lt;p&gt;@All: Please share your opinion so I can finish the task.&lt;/p&gt;</comment>
                            <comment id="13028384" author="mgrigorov" created="Tue, 3 May 2011 19:46:11 +0000"  >&lt;p&gt;Attach the new patch.&lt;/p&gt;</comment>
                            <comment id="13028795" author="pedrosans" created="Wed, 4 May 2011 15:58:53 +0000"  >&lt;p&gt;Thanks Attila, I think you solved the puzzle &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Sending Martin&apos;s patch with a test case.&lt;/p&gt;

&lt;p&gt;How about unscape tag attributes in XmlTag.put(key, value) method instead of the filter solution? IMO it is the correct place and will prevent double escaping even when user add an escaped value in ComponentTag directly.&lt;/p&gt;</comment>
                            <comment id="13028799" author="mgrigorov" created="Wed, 4 May 2011 16:04:01 +0000"  >&lt;p&gt;Moving the logic in XmlTag sounds better!&lt;br/&gt;
So we just need to copy Entities.java from commons-java and the case is solved completely &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13028817" author="pedrosans" created="Wed, 4 May 2011 16:42:32 +0000"  >&lt;p&gt;Sending Martin&apos;s patch again but moving the unescape call&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;unescaping attribute at TagAttributes level because XmlPullParser uses its API directly&lt;/li&gt;
	&lt;li&gt;improving the test case to cover the escaped attribute value add in ComponentTag&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13028937" author="mgrigorov" created="Wed, 4 May 2011 20:26:08 +0000"  >&lt;p&gt;With r1099592 I committed the last patch by Pedro + two classes copied from commons-lang and now unescaping works for all (I assume) HTML entities.&lt;/p&gt;

&lt;p&gt;Thanks Pedro!&lt;/p&gt;</comment>
                            <comment id="13029604" author="berniegp" created="Thu, 5 May 2011 21:58:15 +0000"  >&lt;p&gt;The modifications made to XmlTag.java produce a flood of warnings for components with setOutputMarkupId(true).&lt;/p&gt;

&lt;p&gt;The warning is :&lt;br/&gt;
WARN  - TagAttributes              - WARNING: Please use component.setMarkupId(String) to change the tag&apos;s &apos;id&apos; attribute.&lt;/p&gt;

&lt;p&gt;TagAttribute.checkIdAttribure(String key) does the following:&lt;br/&gt;
private void checkIdAttribute(String key)&lt;br/&gt;
{&lt;br/&gt;
    if ((key != null) &amp;amp;&amp;amp; (key.equalsIgnoreCase(&quot;id&quot;)))&lt;/p&gt;
    {
        log.warn(&quot;WARNING: Please use component.setMarkupId(String) to change the tag&apos;s &apos;id&apos; attribute.&quot;);
    }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;Tracing a little bit, the warnings originate from the statements :&lt;br/&gt;
if (getFlag(FLAG_OUTPUT_MARKUP_ID))&lt;br/&gt;
{&lt;br/&gt;
    tag.put(MARKUP_ID_ATTR_NAME, getMarkupId());&lt;br/&gt;
}&lt;br/&gt;
in&lt;br/&gt;
Component.onComponentTag(ComponentTag tag)&lt;/p&gt;

&lt;p&gt;As far as I can see, this happens because XmlTag uses TagAttributes instead of ValueMap in  void copyPropertiesTo(final XmlTag dest)&lt;/p&gt;</comment>
                            <comment id="13029830" author="mgrigorov" created="Fri, 6 May 2011 08:26:39 +0000"  >&lt;p&gt;A patch that moves the check for setting &apos;id&apos; attribute in ComponentTag itself.&lt;br/&gt;
This way it is closer to the user-space code. We don&apos;t want the user code to set the id via ComponentTag.put().&lt;/p&gt;</comment>
                            <comment id="13029879" author="mgrigorov" created="Fri, 6 May 2011 10:20:31 +0000"  >&lt;p&gt;Improved with r1100160.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12551265">WICKET-4505</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12605207">WICKET-4734</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12461540">WICKET-2829</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12478171" name="WICKET-3608-martinsfix-test.patch" size="8652" author="pedrosans" created="Wed, 4 May 2011 15:58:53 +0000"/>
                            <attachment id="12476236" name="WICKET-3608-test.patch" size="2018" author="pedrosans" created="Wed, 13 Apr 2011 13:47:00 +0000"/>
                            <attachment id="12478177" name="WICKET-3608-unescaping-at-TagAttribute.patch" size="7762" author="pedrosans" created="Wed, 4 May 2011 16:42:32 +0000"/>
                            <attachment id="12478088" name="WICKET-3608.patch" size="6246" author="mgrigorov" created="Tue, 3 May 2011 19:46:11 +0000"/>
                            <attachment id="12476036" name="double_escaped_test.diff" size="2073" author="svenmeier" created="Mon, 11 Apr 2011 19:11:02 +0000"/>
                            <attachment id="12478389" name="tagIdWarning.patch" size="7200" author="mgrigorov" created="Fri, 6 May 2011 08:26:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204375</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 29 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kaif:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>116520</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>