diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWebMarkupContainerTest.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWebMarkupContainerTest.java
index e4fc9c700a..e5eecf082e 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWebMarkupContainerTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWebMarkupContainerTest.java
@@ -17,13 +17,16 @@
 package org.apache.wicket.markup.html;
 
 import org.apache.wicket.MarkupContainer;
+import org.apache.wicket.Page;
 import org.apache.wicket.WicketTestCase;
 import org.apache.wicket.markup.IMarkupResourceStreamProvider;
 import org.apache.wicket.markup.MarkupException;
 import org.apache.wicket.markup.html.basic.Label;
 import org.apache.wicket.markup.html.border.Border;
+import org.apache.wicket.util.lang.WicketObjects;
 import org.apache.wicket.util.resource.IResourceStream;
 import org.apache.wicket.util.resource.StringResourceStream;
+import org.apache.wicket.util.tester.WicketTester;
 
 /**
  * @author Pedro Santos
@@ -83,6 +86,28 @@ public class TransparentWebMarkupContainerTest extends WicketTestCase
 		assertTrue(tester.getLastResponseAsString().contains(expected));
 	}
 
+	/**
+	 * Test case for <a href="https://issues.apache.org/jira/browse/WICKET-3719">WICKET-3719</a>
+	 */
+	public void bug_testAjaxUpdate()
+	{
+		WicketTester wicketTester = new WicketTester()
+		{
+			@Override
+			public Page getLastRenderedPage()
+			{
+				// emulate serialization of the page so the components
+				// loose their "private transient Markup markup" and Component.getMarkup() use
+				// the respective MarkupSourcingStrategy
+				Page lastRenderedPage = super.getLastRenderedPage();
+				return (Page)WicketObjects.cloneObject(lastRenderedPage);
+			}
+		};
+
+		wicketTester.startPage(TransparentWithAjaxUpdatePage.class);
+		wicketTester.clickLink("link", true);
+	}
+
 	/** */
 	public static class TestPage extends WebPage implements IMarkupResourceStreamProvider
 	{
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWithAjaxUpdatePage.html b/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWithAjaxUpdatePage.html
new file mode 100644
index 0000000000..d6156d0b0f
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWithAjaxUpdatePage.html
@@ -0,0 +1,14 @@
+<!DOCTYPE html>
+<html wicket:id="html-tag"">
+	
+	<head>
+		<title>A page</title>
+	</head>
+	
+	<body>
+
+        <div wicket:id="panel">blah</div>
+        <a wicket:id="link">Update</a>
+	</body>
+	
+</html>
\ No newline at end of file
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWithAjaxUpdatePage.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWithAjaxUpdatePage.java
new file mode 100644
index 0000000000..df507c2327
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWithAjaxUpdatePage.java
@@ -0,0 +1,57 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.markup.html;
+
+import org.apache.wicket.ajax.AjaxRequestTarget;
+import org.apache.wicket.ajax.markup.html.AjaxLink;
+import org.apache.wicket.request.mapper.parameter.PageParameters;
+
+/**
+ * Test page for <a href="https://issues.apache.org/jira/browse/WICKET-3719">WICKET-3719</a>
+ * 
+ * @see TransparentWebMarkupContainerTest#testAjaxUpdate()
+ */
+public class TransparentWithAjaxUpdatePage extends WebPage
+{
+	private static final long serialVersionUID = 1L;
+
+	/**
+	 * Construct.
+	 * 
+	 * @param parameters
+	 */
+	public TransparentWithAjaxUpdatePage(PageParameters parameters)
+	{
+		super(parameters);
+
+		add(new TransparentWebMarkupContainer("html-tag"));
+
+		final TransparentWithAjaxUpdatePanel panel = new TransparentWithAjaxUpdatePanel("panel");
+		add(panel);
+
+		add(new AjaxLink<Void>("link")
+		{
+			private static final long serialVersionUID = 1L;
+
+			@Override
+			public void onClick(AjaxRequestTarget target)
+			{
+				target.add(panel);
+			}
+		});
+	}
+}
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWithAjaxUpdatePanel.html b/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWithAjaxUpdatePanel.html
new file mode 100644
index 0000000000..d7cd9c65de
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWithAjaxUpdatePanel.html
@@ -0,0 +1,3 @@
+<wicket:panel>
+    panel content
+</wicket:panel>
\ No newline at end of file
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWithAjaxUpdatePanel.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWithAjaxUpdatePanel.java
new file mode 100644
index 0000000000..29a8494186
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/TransparentWithAjaxUpdatePanel.java
@@ -0,0 +1,31 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.markup.html;
+
+import org.apache.wicket.markup.html.panel.Panel;
+
+class TransparentWithAjaxUpdatePanel extends Panel
+{
+	private static final long serialVersionUID = 1L;
+
+	public TransparentWithAjaxUpdatePanel(String id)
+	{
+		super(id);
+		setOutputMarkupId(true);
+	}
+
+}
\ No newline at end of file
