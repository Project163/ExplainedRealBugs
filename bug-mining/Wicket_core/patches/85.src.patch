diff --git a/wicket-core/src/main/java/org/apache/wicket/request/mapper/ResourceMapper.java b/wicket-core/src/main/java/org/apache/wicket/request/mapper/ResourceMapper.java
index dd1ae12a18..ef5204464c 100644
--- a/wicket-core/src/main/java/org/apache/wicket/request/mapper/ResourceMapper.java
+++ b/wicket-core/src/main/java/org/apache/wicket/request/mapper/ResourceMapper.java
@@ -35,7 +35,7 @@ import org.apache.wicket.util.lang.Args;
  * </ul>
  * 
  * <strong>sample structure of url</strong>
- *
+ * 
  * <pre>
  *    /resources/${category}/images/[indexed-param-0]/[indexed-param-1]?[named-param-1=value]&[named-param-2=value2]
  * </pre>
@@ -48,9 +48,10 @@ import org.apache.wicket.util.lang.Args;
  * <pre>
  * getRootRequestMapperAsCompound().add(new ResourceMapper(&quot;/images&quot;, new ImagesResourceReference()));
  * </pre>
- *
- * @see org.apache.wicket.protocol.http.WebApplication#mountResource(String, org.apache.wicket.request.resource.ResourceReference)
- *
+ * 
+ * @see org.apache.wicket.protocol.http.WebApplication#mountResource(String,
+ *      org.apache.wicket.request.resource.ResourceReference)
+ * 
  * @author Peter Ertl
  */
 public class ResourceMapper extends AbstractMapper implements IRequestMapper
@@ -71,8 +72,9 @@ public class ResourceMapper extends AbstractMapper implements IRequestMapper
 	 *            mount path for the resource
 	 * @param resourceReference
 	 *            resource reference that should be linked to the mount path
-	 *
-	 * @see #ResourceMapper(String, org.apache.wicket.request.resource.ResourceReference, org.apache.wicket.request.mapper.parameter.IPageParametersEncoder)
+	 * 
+	 * @see #ResourceMapper(String, org.apache.wicket.request.resource.ResourceReference,
+	 *      org.apache.wicket.request.mapper.parameter.IPageParametersEncoder)
 	 */
 	public ResourceMapper(String path, ResourceReference resourceReference)
 	{
@@ -81,7 +83,7 @@ public class ResourceMapper extends AbstractMapper implements IRequestMapper
 
 	/**
 	 * create a resource mapper for a resource
-	 *
+	 * 
 	 * @param path
 	 *            mount path for the resource
 	 * @param resourceReference
@@ -89,15 +91,16 @@ public class ResourceMapper extends AbstractMapper implements IRequestMapper
 	 * @param encoder
 	 *            encoder for url parameters
 	 */
-	public ResourceMapper(String path, ResourceReference resourceReference, IPageParametersEncoder encoder)
+	public ResourceMapper(String path, ResourceReference resourceReference,
+		IPageParametersEncoder encoder)
 	{
 		Args.notEmpty(path, "path");
 		Args.notNull(resourceReference, "resourceReference");
 		Args.notNull(encoder, "encoder");
 
 		this.resourceReference = resourceReference;
-		this.mountSegments = getMountSegments(path);
-		this.parametersEncoder = encoder;
+		mountSegments = getMountSegments(path);
+		parametersEncoder = encoder;
 	}
 
 	public IRequestHandler mapRequest(final Request request)
@@ -111,7 +114,8 @@ public class ResourceMapper extends AbstractMapper implements IRequestMapper
 		}
 
 		// now extract the page parameters from the request url
-		PageParameters parameters = extractPageParameters(request, mountSegments.length, parametersEncoder);
+		PageParameters parameters = extractPageParameters(request, mountSegments.length,
+			parametersEncoder);
 
 		// check if there are placeholders in mount segments
 		for (int index = 0; index < mountSegments.length; ++index)
@@ -146,7 +150,8 @@ public class ResourceMapper extends AbstractMapper implements IRequestMapper
 		ResourceReferenceRequestHandler handler = (ResourceReferenceRequestHandler)requestHandler;
 
 		// see if request handler addresses the resource we serve
-		if (resourceReference.getResource().equals(handler.getResource()) == false)
+		if (resourceReference.equals(handler.getResourceReference()) == false &&
+			resourceReference.getResource().equals(handler.getResource()) == false)
 		{
 			return null;
 		}
diff --git a/wicket-core/src/main/java/org/apache/wicket/request/resource/ContextRelativeResource.java b/wicket-core/src/main/java/org/apache/wicket/request/resource/ContextRelativeResource.java
index d464a5a317..590c934b6f 100644
--- a/wicket-core/src/main/java/org/apache/wicket/request/resource/ContextRelativeResource.java
+++ b/wicket-core/src/main/java/org/apache/wicket/request/resource/ContextRelativeResource.java
@@ -106,4 +106,35 @@ public class ContextRelativeResource extends AbstractResource
 
 		return resourceResponse;
 	}
+
+	@Override
+	public int hashCode()
+	{
+		final int prime = 31;
+		int result = 1;
+		result = prime * result + ((path == null) ? 0 : path.hashCode());
+		return result;
+	}
+
+	@Override
+	public boolean equals(Object obj)
+	{
+		if (this == obj)
+			return true;
+		if (obj == null)
+			return false;
+		if (getClass() != obj.getClass())
+			return false;
+		ContextRelativeResource other = (ContextRelativeResource)obj;
+		if (path == null)
+		{
+			if (other.path != null)
+				return false;
+		}
+		else if (!path.equals(other.path))
+			return false;
+		return true;
+	}
+
+
 }
diff --git a/wicket-core/src/main/java/org/apache/wicket/request/resource/PackageResource.java b/wicket-core/src/main/java/org/apache/wicket/request/resource/PackageResource.java
index 913a404cf6..66c5b4e1d9 100644
--- a/wicket-core/src/main/java/org/apache/wicket/request/resource/PackageResource.java
+++ b/wicket-core/src/main/java/org/apache/wicket/request/resource/PackageResource.java
@@ -251,7 +251,10 @@ public class PackageResource extends AbstractResource
 		}
 
 		// modify the resource response depending on the current caching strategy needs
-		Application.get().getResourceSettings().getCachingStrategy().decorateResponse(resourceResponse);
+		Application.get()
+			.getResourceSettings()
+			.getCachingStrategy()
+			.decorateResponse(resourceResponse);
 
 		return resourceResponse;
 	}
@@ -357,4 +360,75 @@ public class PackageResource extends AbstractResource
 			.append(']');
 		return result.toString();
 	}
+
+	@Override
+	public int hashCode()
+	{
+		final int prime = 31;
+		int result = 1;
+		result = prime * result + ((absolutePath == null) ? 0 : absolutePath.hashCode());
+		result = prime * result + ((locale == null) ? 0 : locale.hashCode());
+		result = prime * result + ((path == null) ? 0 : path.hashCode());
+		result = prime * result + ((scopeName == null) ? 0 : scopeName.hashCode());
+		result = prime * result + ((style == null) ? 0 : style.hashCode());
+		result = prime * result + ((variation == null) ? 0 : variation.hashCode());
+		return result;
+	}
+
+	@Override
+	public boolean equals(Object obj)
+	{
+		if (this == obj)
+			return true;
+		if (obj == null)
+			return false;
+		if (getClass() != obj.getClass())
+			return false;
+		PackageResource other = (PackageResource)obj;
+		if (absolutePath == null)
+		{
+			if (other.absolutePath != null)
+				return false;
+		}
+		else if (!absolutePath.equals(other.absolutePath))
+			return false;
+		if (locale == null)
+		{
+			if (other.locale != null)
+				return false;
+		}
+		else if (!locale.equals(other.locale))
+			return false;
+		if (path == null)
+		{
+			if (other.path != null)
+				return false;
+		}
+		else if (!path.equals(other.path))
+			return false;
+		if (scopeName == null)
+		{
+			if (other.scopeName != null)
+				return false;
+		}
+		else if (!scopeName.equals(other.scopeName))
+			return false;
+		if (style == null)
+		{
+			if (other.style != null)
+				return false;
+		}
+		else if (!style.equals(other.style))
+			return false;
+		if (variation == null)
+		{
+			if (other.variation != null)
+				return false;
+		}
+		else if (!variation.equals(other.variation))
+			return false;
+		return true;
+	}
+
+
 }
