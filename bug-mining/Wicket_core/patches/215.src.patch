diff --git a/wicket-core/src/main/java/org/apache/wicket/protocol/http/StoredResponsesMap.java b/wicket-core/src/main/java/org/apache/wicket/protocol/http/StoredResponsesMap.java
index 51d45c2c0d..29b61774d4 100644
--- a/wicket-core/src/main/java/org/apache/wicket/protocol/http/StoredResponsesMap.java
+++ b/wicket-core/src/main/java/org/apache/wicket/protocol/http/StoredResponsesMap.java
@@ -70,11 +70,14 @@ class StoredResponsesMap extends MostRecentlyUsedMap<String, Object>
 		if (removed == false)
 		{
 			Value value = (Value)eldest.getValue();
-			Duration elapsedTime = Time.now().subtract(value.creationTime);
-			if (lifetime.lessThanOrEqual(elapsedTime))
+			if (value != null)
 			{
-				removedValue = value.response;
-				removed = true;
+				Duration elapsedTime = Time.now().subtract(value.creationTime);
+				if (lifetime.lessThanOrEqual(elapsedTime))
+				{
+					removedValue = value.response;
+					removed = true;
+				}
 			}
 		}
 		return removed;
diff --git a/wicket-core/src/main/java/org/apache/wicket/protocol/http/WebApplication.java b/wicket-core/src/main/java/org/apache/wicket/protocol/http/WebApplication.java
index c23fc9b136..62fa114656 100644
--- a/wicket-core/src/main/java/org/apache/wicket/protocol/http/WebApplication.java
+++ b/wicket-core/src/main/java/org/apache/wicket/protocol/http/WebApplication.java
@@ -16,6 +16,13 @@
  */
 package org.apache.wicket.protocol.http;
 
+import java.io.UnsupportedEncodingException;
+
+import javax.servlet.ServletContext;
+import javax.servlet.http.HttpServletRequest;
+import javax.servlet.http.HttpServletResponse;
+import javax.servlet.http.HttpSession;
+
 import org.apache.wicket.Application;
 import org.apache.wicket.IPageRendererProvider;
 import org.apache.wicket.Page;
@@ -62,13 +69,6 @@ import org.apache.wicket.util.watch.IModificationWatcher;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
-import java.io.UnsupportedEncodingException;
-
-import javax.servlet.ServletContext;
-import javax.servlet.http.HttpServletRequest;
-import javax.servlet.http.HttpServletResponse;
-import javax.servlet.http.HttpSession;
-
 
 /**
  * A web application is a subclass of Application which associates with an instance of WicketServlet
@@ -681,8 +681,8 @@ public abstract class WebApplication extends Application
 	}
 
 	/*
-	 * Can contain at most 1000 responses and each entry can live at most one minute for now there
-	 * is no need to configure these parameters externally
+	 * Can contain at most 1000 responses and each entry can live at most one minute. For now there
+	 * is no need to configure these parameters externally.
 	 */
 	private final StoredResponsesMap storedResponses = new StoredResponsesMap(1000,
 		Duration.seconds(60));
diff --git a/wicket-core/src/test/java/org/apache/wicket/protocol/http/StoredResponsesMapTest.java b/wicket-core/src/test/java/org/apache/wicket/protocol/http/StoredResponsesMapTest.java
index 54ee5cd110..12effe3d29 100644
--- a/wicket-core/src/test/java/org/apache/wicket/protocol/http/StoredResponsesMapTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/protocol/http/StoredResponsesMapTest.java
@@ -20,10 +20,16 @@ import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertNull;
 import static org.junit.Assert.assertTrue;
 
+import java.security.SecureRandom;
+import java.util.ArrayList;
+import java.util.List;
+import java.util.concurrent.CountDownLatch;
 import java.util.concurrent.TimeUnit;
 
 import org.apache.wicket.util.time.Duration;
+import org.junit.Ignore;
 import org.junit.Test;
+import org.junit.experimental.categories.Category;
 
 /**
  * @see <a href="https://issues.apache.org/jira/browse/WICKET-3209">WICKET-3209</a>
@@ -75,4 +81,62 @@ public class StoredResponsesMapTest
 		StoredResponsesMap map = new StoredResponsesMap(1000, Duration.days(1));
 		map.put("1", new Object());
 	}
+
+	/**
+	 * <a href="https://issues.apache.org/jira/browse/WICKET-3736">WICKET-3736</a>
+	 * 
+	 * Tries to simulate heavy load on the {@link StoredResponsesMap} by putting many entries and
+	 * removing randomly them.
+	 * 
+	 * The test is disabled by default because it is slow (~ 30secs). Enable it when we have
+	 * categorized tests ({@link Category}) and run slow ones only at Apache CI servers
+	 * 
+	 * @throws InterruptedException
+	 */
+	@Test
+	@Ignore
+	public void heavyLoad() throws InterruptedException
+	{
+		int numberOfThreads = 100;
+		final int iterations = 10000;
+		final CountDownLatch startLatch = new CountDownLatch(numberOfThreads);
+		final CountDownLatch endLatch = new CountDownLatch(numberOfThreads);
+		final SecureRandom rnd = new SecureRandom();
+		final StoredResponsesMap map = new StoredResponsesMap(1000, Duration.seconds(60));
+		final List<String> keys = new ArrayList<String>();
+
+		Runnable r = new Runnable()
+		{
+			public void run()
+			{
+				startLatch.countDown();
+				try
+				{
+					// wait all threads before starting the test
+					startLatch.await();
+				}
+				catch (InterruptedException e)
+				{
+					throw new RuntimeException(e);
+				}
+
+				for (int i = 0; i < iterations; i++)
+				{
+					String key = "abc" + (rnd.nextDouble() * iterations);
+					keys.add(key);
+					map.put(key, new BufferedWebResponse(null));
+
+					String key2 = keys.get(rnd.nextInt(keys.size() - 1));
+					map.remove(key2);
+				}
+				endLatch.countDown();
+			}
+		};
+
+		for (int t = 0; t < numberOfThreads; t++)
+		{
+			new Thread(r).start();
+		}
+		endLatch.await();
+	}
 }
