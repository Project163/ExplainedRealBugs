diff --git a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/CryptoMapper.java b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/CryptoMapper.java
index fcc52a7855..4f038ec6fb 100755
--- a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/CryptoMapper.java
+++ b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/CryptoMapper.java
@@ -500,7 +500,7 @@ public class CryptoMapper implements IRequestMapperDelegate
 		int segNo = 1;
 		for (; segNo < encryptedNumberOfSegments; segNo++)
 		{
-			if (segNo > originalNumberOfSegments)
+			if (segNo >= originalNumberOfSegments)
 			{
 				break;
 			}
diff --git a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/CryptoMapperTest.java b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/CryptoMapperTest.java
index b44e2144ae..7c9bf6b886 100644
--- a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/CryptoMapperTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/CryptoMapperTest.java
@@ -205,6 +205,28 @@ public class CryptoMapperTest extends AbstractMapperTest
 		assertEquals(Page2.class, handler.getPageClass());
 	}
 
+	/**
+	 * https://issues.apache.org/jira/browse/WICKET-6131
+	 *
+	 * Tests that encrypted URLs for bookmarkable pages are decrypted and passed to the wrapped mapper.
+	 * Extra segments should be ignored.
+	 */
+	@Test
+	public void bookmarkablePageDecrypt2()
+	{
+		String encryptedExtraSegments = "/i87b7/i87b7";
+		Request request = getRequest(Url.parse(ENCRYPTED_BOOKMARKABLE_URL + encryptedExtraSegments));
+		IRequestHandler requestHandler = mapper.mapRequest(request);
+
+		assertNotNull(requestHandler);
+		requestHandler = unwrapRequestHandlerDelegate(requestHandler);
+
+		assertTrue(requestHandler instanceof RenderPageRequestHandler);
+
+		RenderPageRequestHandler handler = (RenderPageRequestHandler) requestHandler;
+		assertEquals(Page2.class, handler.getPageClass());
+	}
+
 	/**
 	 * Tests that encrypted URLs for bookmarkable pages are decrypted and passed to the wrapped mapper when there is more than
 	 * one cryptomapper installed.
