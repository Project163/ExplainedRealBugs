diff --git a/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java b/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java
index 09705ff61d..6df5316b3f 100644
--- a/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java
+++ b/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java
@@ -1643,7 +1643,7 @@ public abstract class MarkupContainer extends Component implements Iterable<Comp
 	 */
 	protected final void renderAll(final MarkupStream markupStream, final ComponentTag openTag)
 	{
-		while (markupStream.hasMore())
+		while (markupStream.isCurrentIndexInsideTheStream())
 		{
 			// In case of Page we need to render the whole file. For all other components just what
 			// is in between the open and the close tag.
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/MarkupStream.java b/wicket-core/src/main/java/org/apache/wicket/markup/MarkupStream.java
index 99a5165e9b..d5d8b74034 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/MarkupStream.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/MarkupStream.java
@@ -134,7 +134,7 @@ public class MarkupStream
 	public boolean equalTo(final MarkupStream that)
 	{
 		// While a has more markup elements
-		while (hasMore())
+		while (isCurrentIndexInsideTheStream())
 		{
 			// Get an element from each
 			final MarkupElement thisElement = this.get();
@@ -163,7 +163,7 @@ public class MarkupStream
 		}
 
 		// If we've run out of markup elements in b
-		if (!that.hasMore())
+		if (!that.isCurrentIndexInsideTheStream())
 		{
 			// then the two streams match perfectly
 			return true;
@@ -270,12 +270,20 @@ public class MarkupStream
 		return markup.getMarkupResourceStream().getWicketNamespace();
 	}
 
+	/**
+	 * @return True if this markup stream is moved to a MarkupElement element
+	 */
+	public boolean isCurrentIndexInsideTheStream()
+	{
+		return currentIndex < markup.size();
+	}
+
 	/**
 	 * @return True if this markup stream has more MarkupElement elements
 	 */
 	public boolean hasMore()
 	{
-		return currentIndex < markup.size();
+		return currentIndex < (markup.size() - 1);
 	}
 
 	/**
@@ -417,7 +425,7 @@ public class MarkupStream
 	 */
 	public boolean skipUntil(final Class<? extends MarkupElement> clazz)
 	{
-		while (hasMore())
+		while (isCurrentIndexInsideTheStream())
 		{
 			if (clazz.isInstance(current))
 			{
@@ -462,7 +470,7 @@ public class MarkupStream
 	public void skipToMatchingCloseTag(final ComponentTag openTag)
 	{
 		// Loop through the markup in this container
-		while (hasMore())
+		while (isCurrentIndexInsideTheStream())
 		{
 			// If the current markup tag closes the openTag
 			if (get().closes(openTag))
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/TagUtils.java b/wicket-core/src/main/java/org/apache/wicket/markup/TagUtils.java
index 9bd9433381..bd0ee75ff7 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/TagUtils.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/TagUtils.java
@@ -242,7 +242,7 @@ public class TagUtils
 
 		MarkupStream stream = new MarkupStream(fragment);
 		stream.setCurrentIndex(streamOffset);
-		while (stream.hasMore())
+		while (stream.isCurrentIndexInsideTheStream())
 		{
 			MarkupElement elem = stream.get();
 
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/html/TransparentWebMarkupContainer.java b/wicket-core/src/main/java/org/apache/wicket/markup/html/TransparentWebMarkupContainer.java
index f9f76dedd7..69599143aa 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/html/TransparentWebMarkupContainer.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/html/TransparentWebMarkupContainer.java
@@ -133,7 +133,7 @@ public class TransparentWebMarkupContainer extends WebMarkupContainer implements
 	{
 		MarkupStream stream = new MarkupStream(getMarkup());
 
-		while (stream.hasMore())
+		while (stream.isCurrentIndexInsideTheStream())
 		{
 			MarkupElement childOpenTag = stream.nextOpenTag();
 
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/html/border/BorderBehavior.java b/wicket-core/src/main/java/org/apache/wicket/markup/html/border/BorderBehavior.java
index ecb15b8729..9459918fa8 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/html/border/BorderBehavior.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/html/border/BorderBehavior.java
@@ -61,7 +61,7 @@ public class BorderBehavior extends Behavior
 		stream.setCurrentIndex(0);
 
 		boolean insideBorderMarkup = false;
-		while (stream.hasMore())
+		while (stream.isCurrentIndexInsideTheStream())
 		{
 			MarkupElement elem = stream.get();
 			stream.next();
@@ -104,7 +104,7 @@ public class BorderBehavior extends Behavior
 			}
 		}
 
-		if (!stream.hasMore())
+		if (!stream.isCurrentIndexInsideTheStream())
 		{
 			throw new WicketRuntimeException("Markup for component border " + getClass().getName() +
 				" ended prematurely, was expecting </wicket:border>");
@@ -117,7 +117,7 @@ public class BorderBehavior extends Behavior
 		final MarkupStream stream = getMarkupStream(component);
 		final Response response = component.getResponse();
 
-		while (stream.hasMore())
+		while (stream.isCurrentIndexInsideTheStream())
 		{
 			MarkupElement elem = stream.get();
 			stream.next();
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/html/internal/Enclosure.java b/wicket-core/src/main/java/org/apache/wicket/markup/html/internal/Enclosure.java
index 2d72ac0839..1daa4c74dc 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/html/internal/Enclosure.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/html/internal/Enclosure.java
@@ -229,7 +229,7 @@ public class Enclosure extends WebMarkupContainer implements IComponentResolver
 			int orgIndex = markupStream.getCurrentIndex();
 			try
 			{
-				while (markupStream.hasMore())
+				while (markupStream.isCurrentIndexInsideTheStream())
 				{
 					markupStream.next();
 					if (markupStream.skipUntil(ComponentTag.class))
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/resolver/WicketMessageResolver.java b/wicket-core/src/main/java/org/apache/wicket/markup/resolver/WicketMessageResolver.java
index f2f99f88bf..bbb5643aa7 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/resolver/WicketMessageResolver.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/resolver/WicketMessageResolver.java
@@ -230,7 +230,7 @@ public class WicketMessageResolver implements IComponentResolver
 				log.warn("No value found for wicket:message tag with key: {}", key);
 
 				// If open tag was open-close
-				if (markupStream.hasMore() == false)
+				if (markupStream.isCurrentIndexInsideTheStream() == false)
 				{
 					String formatedNotFound = String.format(NOT_FOUND, key);
 					getResponse().write(formatedNotFound);
@@ -358,7 +358,7 @@ public class WicketMessageResolver implements IComponentResolver
 			// child component and save their tag index
 			if (!tag.isOpenClose())
 			{
-				while (markupStream.hasMore() && !markupStream.get().closes(openTag))
+				while (markupStream.isCurrentIndexInsideTheStream() && !markupStream.get().closes(openTag))
 				{
 					MarkupElement element = markupStream.get();
 
