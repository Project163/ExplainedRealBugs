diff --git a/wicket-core/src/main/java/org/apache/wicket/Session.java b/wicket-core/src/main/java/org/apache/wicket/Session.java
index da5ad50d5e..d04fb42904 100644
--- a/wicket-core/src/main/java/org/apache/wicket/Session.java
+++ b/wicket-core/src/main/java/org/apache/wicket/Session.java
@@ -631,7 +631,7 @@ public abstract class Session implements IClusterable, IEventSink
 	 * Any detach logic for session subclasses. This is called on the end of handling a request,
 	 * when the RequestCycle is about to be detached from the current thread.
 	 */
-	protected void detach()
+	public void detach()
 	{
 		if (sessionInvalidated)
 		{
@@ -639,6 +639,21 @@ public abstract class Session implements IClusterable, IEventSink
 		}
 	}
 
+	/**
+	 * NOT PART OF PUBLIC API, DO NOT CALL
+	 * 
+	 * Detaches internal state of {@link Session}
+	 */
+	public void internalDetach()
+	{
+		if (dirty)
+		{
+			Request request = RequestCycle.get().getRequest();
+			getSessionStore().flushSession(request, this);
+		}
+		dirty = false;
+	}
+
 	/**
 	 * Marks session state as dirty so that it will be flushed at the end of the request.
 	 */
diff --git a/wicket-core/src/main/java/org/apache/wicket/mock/MockSessionStore.java b/wicket-core/src/main/java/org/apache/wicket/mock/MockSessionStore.java
index 4617d1b31a..0eb0abe9be 100644
--- a/wicket-core/src/main/java/org/apache/wicket/mock/MockSessionStore.java
+++ b/wicket-core/src/main/java/org/apache/wicket/mock/MockSessionStore.java
@@ -129,4 +129,9 @@ public class MockSessionStore implements ISessionStore
 		unboundListeners.remove(listener);
 	}
 
+	public void flushSession(Request request, Session session)
+	{
+		this.session = session;
+	}
+
 }
diff --git a/wicket-core/src/main/java/org/apache/wicket/request/cycle/RequestCycle.java b/wicket-core/src/main/java/org/apache/wicket/request/cycle/RequestCycle.java
index 8bfdce89de..10894d8859 100644
--- a/wicket-core/src/main/java/org/apache/wicket/request/cycle/RequestCycle.java
+++ b/wicket-core/src/main/java/org/apache/wicket/request/cycle/RequestCycle.java
@@ -259,6 +259,7 @@ public class RequestCycle implements IRequestCycle, IEventSink
 		return result;
 	}
 
+
 	/**
 	 * 
 	 * @param handler
@@ -468,11 +469,42 @@ public class RequestCycle implements IRequestCycle, IEventSink
 	}
 
 	/**
-	 * @see org.apache.wicket.request.RequestHandlerStack#detach()
+	 * Detaches {@link RequestCycle} state. Called after request processing is complete
 	 */
-	public void detach()
+	public final void detach()
 	{
 		set(this);
+		try
+		{
+			onDetach();
+		}
+		finally
+		{
+			try
+			{
+				onInternalDetach();
+			}
+			finally
+			{
+				set(null);
+			}
+		}
+	}
+
+	private void onInternalDetach()
+	{
+		if (Session.exists())
+		{
+			Session.get().internalDetach();
+		}
+	}
+
+	/**
+	 * Called after request processing is complete, usually takes care of detaching state
+	 */
+	public void onDetach()
+	{
+
 
 		if (cleanupFeedbackMessagesOnDetach)
 		{
@@ -482,6 +514,11 @@ public class RequestCycle implements IRequestCycle, IEventSink
 			}
 		}
 
+		if (Session.exists())
+		{
+			Session.get().detach();
+		}
+
 		try
 		{
 			onEndRequest();
@@ -499,7 +536,6 @@ public class RequestCycle implements IRequestCycle, IEventSink
 		finally
 		{
 			listeners.onDetach(this);
-			set(null);
 		}
 	}
 
diff --git a/wicket-core/src/main/java/org/apache/wicket/session/HttpSessionStore.java b/wicket-core/src/main/java/org/apache/wicket/session/HttpSessionStore.java
index 8474a704a1..da96c9b835 100644
--- a/wicket-core/src/main/java/org/apache/wicket/session/HttpSessionStore.java
+++ b/wicket-core/src/main/java/org/apache/wicket/session/HttpSessionStore.java
@@ -123,6 +123,19 @@ public class HttpSessionStore implements ISessionStore
 		}
 	}
 
+	public void flushSession(Request request, Session session)
+	{
+		if (getAttribute(request, getSessionAttribute()) != session)
+		{
+			// this session is not yet bound, bind it
+			bind(request, session);
+		}
+		else
+		{
+			setAttribute(request, getSessionAttribute(), session);
+		}
+	}
+
 	/**
 	 * @see org.apache.wicket.session.ISessionStore#destroy()
 	 */
diff --git a/wicket-core/src/main/java/org/apache/wicket/session/ISessionStore.java b/wicket-core/src/main/java/org/apache/wicket/session/ISessionStore.java
index 0e31fa29e5..f4894d77b0 100644
--- a/wicket-core/src/main/java/org/apache/wicket/session/ISessionStore.java
+++ b/wicket-core/src/main/java/org/apache/wicket/session/ISessionStore.java
@@ -123,6 +123,27 @@ public interface ISessionStore
 	 */
 	void bind(Request request, Session newSession);
 
+
+	/**
+	 * Flushes the session. Flushing the session generally means setting the attribute with the
+	 * value of the current session. Some servlet containers use the setAttribute() as a signal that
+	 * the value is dirty and needs to be replicated. Essentially this call comes down to:
+	 * 
+	 * <code>
+	 * String attr=getSessionAttributeName();
+	 * Session session=getAttribute(attr);
+	 * setAttribute(attr, session);
+	 * </code>
+	 * 
+	 * If the session is not yet bound it will be.
+	 * 
+	 * @param request
+	 *            current request
+	 * @param session
+	 *            session to be flushed
+	 */
+	void flushSession(Request request, Session session);
+
 	/**
 	 * Called when the WebApplication is destroyed.
 	 */
