diff --git a/wicket-core/src/main/java/org/apache/wicket/settings/def/ResourceSettings.java b/wicket-core/src/main/java/org/apache/wicket/settings/def/ResourceSettings.java
index b62b8d85e5..83782a1a58 100644
--- a/wicket-core/src/main/java/org/apache/wicket/settings/def/ResourceSettings.java
+++ b/wicket-core/src/main/java/org/apache/wicket/settings/def/ResourceSettings.java
@@ -44,9 +44,9 @@ import org.apache.wicket.util.file.Path;
 import org.apache.wicket.util.lang.Args;
 import org.apache.wicket.util.lang.Generics;
 import org.apache.wicket.util.resource.IResourceStream;
-import org.apache.wicket.util.resource.locator.CachingResourceStreamLocator;
 import org.apache.wicket.util.resource.locator.IResourceStreamLocator;
 import org.apache.wicket.util.resource.locator.ResourceStreamLocator;
+import org.apache.wicket.util.resource.locator.caching.CachingResourceStreamLocator;
 import org.apache.wicket.util.time.Duration;
 import org.apache.wicket.util.watch.IModificationWatcher;
 import org.apache.wicket.util.watch.ModificationWatcher;
@@ -223,10 +223,7 @@ public class ResourceSettings implements IResourceSettings
 			// Create compound resource locator using source path from
 			// application settings
 			resourceStreamLocator = new ResourceStreamLocator(getResourceFinder());
-			if (Application.get().usesDeploymentConfig())
-			{
-				resourceStreamLocator = new CachingResourceStreamLocator(resourceStreamLocator);
-			}
+			resourceStreamLocator = new CachingResourceStreamLocator(resourceStreamLocator);
 		}
 		return resourceStreamLocator;
 	}
diff --git a/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/AbstractResourceStreamReference.java b/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/AbstractResourceStreamReference.java
new file mode 100644
index 0000000000..5a4c42d8d0
--- /dev/null
+++ b/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/AbstractResourceStreamReference.java
@@ -0,0 +1,46 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.util.resource.locator.caching;
+
+import java.util.Locale;
+
+import org.apache.wicket.util.resource.IResourceStream;
+
+abstract class AbstractResourceStreamReference
+	implements
+		IResourceStreamReference
+{
+	private String style;
+
+	private Locale locale;
+
+	private String variation;
+
+	protected void saveResourceStream(final IResourceStream resourceStream)
+	{
+		style = resourceStream.getStyle();
+		locale = resourceStream.getLocale();
+		variation = resourceStream.getVariation();
+	}
+
+	protected void restoreResourceStream(final IResourceStream resourceStream)
+	{
+		resourceStream.setStyle(style);
+		resourceStream.setLocale(locale);
+		resourceStream.setVariation(variation);
+	}
+}
\ No newline at end of file
diff --git a/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/CachingResourceStreamLocator.java b/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/CachingResourceStreamLocator.java
similarity index 67%
rename from wicket-core/src/main/java/org/apache/wicket/util/resource/locator/CachingResourceStreamLocator.java
rename to wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/CachingResourceStreamLocator.java
index dba49765d0..0c95d84c0d 100644
--- a/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/CachingResourceStreamLocator.java
+++ b/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/CachingResourceStreamLocator.java
@@ -14,21 +14,19 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.wicket.util.resource.locator;
+package org.apache.wicket.util.resource.locator.caching;
 
-import java.net.MalformedURLException;
-import java.net.URL;
 import java.util.Locale;
 import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.ConcurrentMap;
 
-import org.apache.wicket.WicketRuntimeException;
 import org.apache.wicket.request.resource.ResourceReference.Key;
-import org.apache.wicket.util.file.File;
 import org.apache.wicket.util.lang.Args;
 import org.apache.wicket.util.resource.FileResourceStream;
 import org.apache.wicket.util.resource.IResourceStream;
 import org.apache.wicket.util.resource.UrlResourceStream;
+import org.apache.wicket.util.resource.locator.IResourceStreamLocator;
+import org.apache.wicket.util.resource.locator.ResourceNameIterator;
 
 
 /**
@@ -45,74 +43,6 @@ import org.apache.wicket.util.resource.UrlResourceStream;
  */
 public class CachingResourceStreamLocator implements IResourceStreamLocator
 {
-	/**
-	 * Lightweight reference to the cached {@link IResourceStream}
-	 */
-	private static interface IResourceStreamReference
-	{
-		IResourceStream getReference();
-	}
-
-	/**
-	 * A singleton reference that is used for resource streams which do not exists. I.e. if there is
-	 * a key in the cache which value is NullResourceStreamReference.INSTANCE then there is no need
-	 * to lookup again for this key anymore.
-	 */
-	private static class NullResourceStreamReference implements IResourceStreamReference
-	{
-		private final static NullResourceStreamReference INSTANCE = new NullResourceStreamReference();
-
-		public IResourceStream getReference()
-		{
-			return null;
-		}
-	}
-
-	/**
-	 * A reference which can be used to recreate {@link FileResourceStream}
-	 */
-	private static class FileResourceStreamReference implements IResourceStreamReference
-	{
-		private final String fileName;
-
-		private FileResourceStreamReference(final String fileName)
-		{
-			this.fileName = fileName;
-		}
-
-		public FileResourceStream getReference()
-		{
-			return new FileResourceStream(new File(fileName));
-		}
-	}
-
-	/**
-	 * A reference which may be used to recreate {@link UrlResourceStream}
-	 */
-	private static class UrlResourceStreamReference implements IResourceStreamReference
-	{
-		private final String url;
-
-		private UrlResourceStreamReference(final String url)
-		{
-			this.url = url;
-		}
-
-		public UrlResourceStream getReference()
-		{
-			try
-			{
-				return new UrlResourceStream(new URL(url));
-			}
-			catch (MalformedURLException e)
-			{
-				// should not ever happen. The cached url is created by previously existing URL
-				// instance
-				throw new WicketRuntimeException(e);
-			}
-		}
-	}
-
 	private final ConcurrentMap<Key, IResourceStreamReference> cache;
 
 	private final IResourceStreamLocator delegate;
@@ -169,14 +99,12 @@ public class CachingResourceStreamLocator implements IResourceStreamLocator
 		else if (stream instanceof FileResourceStream)
 		{
 			FileResourceStream fileResourceStream = (FileResourceStream)stream;
-			String absolutePath = fileResourceStream.getFile().getAbsolutePath();
-			cache.put(key, new FileResourceStreamReference(absolutePath));
+			cache.put(key, new FileResourceStreamReference(fileResourceStream));
 		}
 		else if (stream instanceof UrlResourceStream)
 		{
 			UrlResourceStream urlResourceStream = (UrlResourceStream)stream;
-			String url = urlResourceStream.getURL().toExternalForm();
-			cache.put(key, new UrlResourceStreamReference(url));
+			cache.put(key, new UrlResourceStreamReference(urlResourceStream));
 		}
 	}
 
diff --git a/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/FileResourceStreamReference.java b/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/FileResourceStreamReference.java
new file mode 100644
index 0000000000..7ce722c01c
--- /dev/null
+++ b/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/FileResourceStreamReference.java
@@ -0,0 +1,41 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.util.resource.locator.caching;
+
+import org.apache.wicket.util.file.File;
+import org.apache.wicket.util.resource.FileResourceStream;
+
+/**
+ * A reference which can be used to recreate {@link FileResourceStream}
+ */
+class FileResourceStreamReference extends AbstractResourceStreamReference
+{
+	private final String fileName;
+
+	FileResourceStreamReference(final FileResourceStream fileResourceStream)
+	{
+		fileName = fileResourceStream.getFile().getAbsolutePath();
+		saveResourceStream(fileResourceStream);
+	}
+
+	public FileResourceStream getReference()
+	{
+		FileResourceStream fileResourceStream = new FileResourceStream(new File(fileName));
+		restoreResourceStream(fileResourceStream);
+		return fileResourceStream;
+	}
+}
\ No newline at end of file
diff --git a/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/IResourceStreamReference.java b/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/IResourceStreamReference.java
new file mode 100644
index 0000000000..04c7e66e63
--- /dev/null
+++ b/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/IResourceStreamReference.java
@@ -0,0 +1,27 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.util.resource.locator.caching;
+
+import org.apache.wicket.util.resource.IResourceStream;
+
+/**
+ * Lightweight reference to the cached {@link IResourceStream}
+ */
+interface IResourceStreamReference
+{
+	IResourceStream getReference();
+}
\ No newline at end of file
diff --git a/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/NullResourceStreamReference.java b/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/NullResourceStreamReference.java
new file mode 100644
index 0000000000..6880392472
--- /dev/null
+++ b/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/NullResourceStreamReference.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.util.resource.locator.caching;
+
+import org.apache.wicket.util.resource.IResourceStream;
+
+/**
+ * A singleton reference that is used for resource streams which do not exists. I.e. if there is a
+ * key in the cache which value is NullResourceStreamReference.INSTANCE then there is no need to
+ * lookup again for this key anymore.
+ */
+class NullResourceStreamReference implements IResourceStreamReference
+{
+	final static NullResourceStreamReference INSTANCE = new NullResourceStreamReference();
+
+	public IResourceStream getReference()
+	{
+		return null;
+	}
+}
\ No newline at end of file
diff --git a/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/UrlResourceStreamReference.java b/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/UrlResourceStreamReference.java
new file mode 100644
index 0000000000..ddbae631d4
--- /dev/null
+++ b/wicket-core/src/main/java/org/apache/wicket/util/resource/locator/caching/UrlResourceStreamReference.java
@@ -0,0 +1,53 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.util.resource.locator.caching;
+
+import java.net.MalformedURLException;
+import java.net.URL;
+
+import org.apache.wicket.WicketRuntimeException;
+import org.apache.wicket.util.resource.UrlResourceStream;
+
+/**
+ * A reference which may be used to recreate {@link UrlResourceStream}
+ */
+class UrlResourceStreamReference extends AbstractResourceStreamReference
+{
+	private final String url;
+
+	UrlResourceStreamReference(final UrlResourceStream urlResourceStream)
+	{
+		url = urlResourceStream.getURL().toExternalForm();
+		saveResourceStream(urlResourceStream);
+	}
+
+	public UrlResourceStream getReference()
+	{
+		try
+		{
+			UrlResourceStream resourceStream = new UrlResourceStream(new URL(url));
+			restoreResourceStream(resourceStream);
+			return resourceStream;
+		}
+		catch (MalformedURLException e)
+		{
+			// should not ever happen. The cached url is created by previously existing URL
+			// instance
+			throw new WicketRuntimeException(e);
+		}
+	}
+}
\ No newline at end of file
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/link/AutolinkPageExpectedResult_1.html b/wicket-core/src/test/java/org/apache/wicket/markup/html/link/AutolinkPageExpectedResult_1.html
index 90818f6a6e..251018a5b8 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/link/AutolinkPageExpectedResult_1.html
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/link/AutolinkPageExpectedResult_1.html
@@ -24,9 +24,9 @@
 <a href="../../Page1.html">Home</a>
 <wicket:link autolink="true">
 <a href="org.apache.wicket.markup.html.link.subdir.Page1">Home</a>
-<link href="../resource/org.apache.wicket.markup.html.link.AutolinkPage_1/test.css?-myStyle"/>
+<link href="../resource/org.apache.wicket.markup.html.link.AutolinkPage_1/test.css"/>
 <link href="../resource/org.apache.wicket.markup.html.link.AutolinkPage_1/test2.css?-myStyle"/>
-<link href="../resource/org.apache.wicket.markup.html.link.AutolinkPage_1/test3.css?de_DE-myStyle"/>
+<link href="../resource/org.apache.wicket.markup.html.link.AutolinkPage_1/test3.css?de_DE"/>
 <link href="../resource/org.apache.wicket.markup.html.link.AutolinkPage_1/$up$/$up$/html/link/test2.css?-myStyle"/>
 <a href="/root/test.html">Home</a>
 <a href="org.apache.wicket.markup.html.link.Page1">Home</a>
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/link/AutolinkPageExpectedResult_2.html b/wicket-core/src/test/java/org/apache/wicket/markup/html/link/AutolinkPageExpectedResult_2.html
index 5efa55f1a4..a0c7335f3e 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/link/AutolinkPageExpectedResult_2.html
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/link/AutolinkPageExpectedResult_2.html
@@ -24,7 +24,7 @@
 <a href="../../Page1.html">Home</a>
 
 <a href="org.apache.wicket.markup.html.link.subdir.Page1">Home</a>
-<link href="../resource/org.apache.wicket.markup.html.link.AutolinkPage_2/test.css?-myStyle"/>
+<link href="../resource/org.apache.wicket.markup.html.link.AutolinkPage_2/test.css"/>
 <a href="/root/test.html">Home</a>
 <a href="org/apache/wicket/markup/html/link/Page1.html">Home</a>
   <a href="http://www.google.com">Google</a>
diff --git a/wicket-core/src/test/java/org/apache/wicket/util/resource/locator/CachingResourceStreamLocatorTest.java b/wicket-core/src/test/java/org/apache/wicket/util/resource/locator/CachingResourceStreamLocatorTest.java
index 3e030663e8..4ec4f5d621 100644
--- a/wicket-core/src/test/java/org/apache/wicket/util/resource/locator/CachingResourceStreamLocatorTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/util/resource/locator/CachingResourceStreamLocatorTest.java
@@ -27,6 +27,7 @@ import java.net.URL;
 import org.apache.wicket.util.resource.FileResourceStream;
 import org.apache.wicket.util.resource.StringResourceStream;
 import org.apache.wicket.util.resource.UrlResourceStream;
+import org.apache.wicket.util.resource.locator.caching.CachingResourceStreamLocator;
 import org.junit.Test;
 
 /**
