diff --git a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/BookmarkableMapper.java b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/BookmarkableMapper.java
index bf1d8885e1..8862c35b96 100644
--- a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/BookmarkableMapper.java
+++ b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/BookmarkableMapper.java
@@ -106,6 +106,11 @@ public class BookmarkableMapper extends AbstractBookmarkableMapper
 				className = segments.get(1);
 			}
 
+			if (Strings.isEmpty(className))
+			{
+				return null;
+			}
+
 			Class<? extends IRequestablePage> pageClass = getPageClass(className);
 
 			if (pageClass != null && IRequestablePage.class.isAssignableFrom(pageClass))
diff --git a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/PackageMapper.java b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/PackageMapper.java
index ff13a62efc..6883eceee3 100644
--- a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/PackageMapper.java
+++ b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/PackageMapper.java
@@ -17,6 +17,7 @@
 package org.apache.wicket.core.request.mapper;
 
 import java.lang.reflect.Modifier;
+import java.util.List;
 
 import org.apache.wicket.protocol.http.WebApplication;
 import org.apache.wicket.request.Request;
@@ -28,6 +29,7 @@ import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.request.mapper.parameter.PageParametersEncoder;
 import org.apache.wicket.util.lang.Args;
 import org.apache.wicket.util.lang.PackageName;
+import org.apache.wicket.util.string.Strings;
 
 /**
  * A request mapper that mounts all bookmarkable pages in a given package.
@@ -138,8 +140,20 @@ public class PackageMapper extends AbstractBookmarkableMapper
 			// try to extract page and component information from URL
 			PageComponentInfo info = getPageComponentInfo(url);
 
+			final List<String> segments = url.getSegments();
+			if (segments.size() <= mountSegments.length)
+			{
+				return null;
+			}
+
 			// load the page class
-			String name = url.getSegments().get(mountSegments.length);
+			String name = segments.get(mountSegments.length);
+
+			if (Strings.isEmpty(name))
+			{
+				return null;
+			}
+
 			String className = cleanClassName(name);
 
 			if (isValidClassName(className) == false)
@@ -178,7 +192,7 @@ public class PackageMapper extends AbstractBookmarkableMapper
 	private boolean isValidClassName(String className)
 	{
 		// darn simple check - feel free to enhance this method to your needs
-		if (className == null)
+		if (Strings.isEmpty(className))
 		{
 			return false;
 		}
diff --git a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/BookmarkableMapperTest.java b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/BookmarkableMapperTest.java
index 75ce9f17f1..bcd4ba68e4 100644
--- a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/BookmarkableMapperTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/BookmarkableMapperTest.java
@@ -470,6 +470,30 @@ public class BookmarkableMapperTest extends AbstractMapperTest
 		assertThat(score, is(0));
 	}
 
+	/**
+	 * https://issues.apache.org/jira/browse/WICKET-5996
+	 */
+	@Test
+	public void decode15()
+	{
+		Url url = Url.parse("wicket/bookmarkable");
+		final AbstractBookmarkableMapper.UrlInfo urlInfo = encoder.parseRequest(getRequest(url));
+
+		assertThat(urlInfo, is(nullValue()));
+	}
+
+	/**
+	 * https://issues.apache.org/jira/browse/WICKET-5996
+	 */
+	@Test
+	public void decode16()
+	{
+		Url url = Url.parse("wicket/bookmarkable/");
+		final AbstractBookmarkableMapper.UrlInfo urlInfo = encoder.parseRequest(getRequest(url));
+
+		assertThat(urlInfo, is(nullValue()));
+	}
+
 	/**
 	 *
 	 */
diff --git a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/PackageMapperTest.java b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/PackageMapperTest.java
index 413c70dbf1..3716397d47 100644
--- a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/PackageMapperTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/PackageMapperTest.java
@@ -16,7 +16,9 @@
  */
 package org.apache.wicket.core.request.mapper;
 
-import static org.hamcrest.CoreMatchers.instanceOf;
+import static org.hamcrest.Matchers.instanceOf;
+import static org.hamcrest.Matchers.nullValue;
+import static org.hamcrest.Matchers.is;
 
 import org.apache.wicket.MockPage;
 import org.apache.wicket.core.request.handler.BookmarkableListenerInterfaceRequestHandler;
@@ -371,6 +373,30 @@ public class PackageMapperTest extends AbstractMapperTest
 		assertNull("A non-page class should not create a request handler!", handler);
 	}
 
+	/**
+	 * https://issues.apache.org/jira/browse/WICKET-5996
+	 */
+	@Test
+	public void decode11()
+	{
+		Url url = Url.parse(MOUNT_PATH);
+		IRequestHandler handler = encoder.mapRequest(getRequest(url));
+
+		assertThat(handler, is(nullValue()));
+	}
+
+	/**
+	 * https://issues.apache.org/jira/browse/WICKET-5996
+	 */
+	@Test
+	public void decode12()
+	{
+		Url url = Url.parse(MOUNT_PATH + '/');
+		IRequestHandler handler = encoder.mapRequest(getRequest(url));
+
+		assertThat(handler, is(nullValue()));
+	}
+
 	/**
 	 *
 	 */
