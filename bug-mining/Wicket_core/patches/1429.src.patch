diff --git a/wicket-core/src/main/java/org/apache/wicket/protocol/http/mock/MockHttpSession.java b/wicket-core/src/main/java/org/apache/wicket/protocol/http/mock/MockHttpSession.java
index dc92f1daf1..28aa536715 100755
--- a/wicket-core/src/main/java/org/apache/wicket/protocol/http/mock/MockHttpSession.java
+++ b/wicket-core/src/main/java/org/apache/wicket/protocol/http/mock/MockHttpSession.java
@@ -24,6 +24,8 @@ import java.util.UUID;
 import javax.servlet.ServletContext;
 import javax.servlet.http.HttpSession;
 
+import org.apache.wicket.Session;
+import org.apache.wicket.util.tester.BaseWicketTester;
 import org.apache.wicket.util.value.ValueMap;
 
 
@@ -186,6 +188,11 @@ public class MockHttpSession implements HttpSession, Serializable
 	@Override
 	public void invalidate()
 	{
+		Session session = (Session) attributes.get("wicket:" + BaseWicketTester.TestFilterConfig.class.getName() + ":session");
+		if (session != null)
+		{
+			session.onInvalidate();
+		}
 		attributes.clear();
 		id = generateSessionId();
 	}
diff --git a/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java b/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java
index fe66d12604..54e78089f2 100644
--- a/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java
+++ b/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java
@@ -2932,7 +2932,7 @@ public class BaseWicketTester
 		}
 	}
 
-	private class TestFilterConfig implements FilterConfig
+	public class TestFilterConfig implements FilterConfig
 	{
 		private final Map<String, String> initParameters = new HashMap<String, String>();
 
