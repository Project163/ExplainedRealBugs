diff --git a/wicket-core/src/main/java/org/apache/wicket/Session.java b/wicket-core/src/main/java/org/apache/wicket/Session.java
index 7551b58fa2..83e55d2f31 100644
--- a/wicket-core/src/main/java/org/apache/wicket/Session.java
+++ b/wicket-core/src/main/java/org/apache/wicket/Session.java
@@ -392,11 +392,8 @@ public abstract class Session implements IClusterable, IEventSink
 	{
 		if (id == null)
 		{
-			RequestCycle requestCycle = RequestCycle.get();
-			if (requestCycle != null)
-			{
-				id = getSessionStore().getSessionId(requestCycle.getRequest(), false);
-			}
+			updateId();
+
 			// we have one?
 			if (id != null)
 			{
@@ -406,6 +403,15 @@ public abstract class Session implements IClusterable, IEventSink
 		return id;
 	}
 
+	private void updateId()
+	{
+		RequestCycle requestCycle = RequestCycle.get();
+		if (requestCycle != null)
+		{
+			id = getSessionStore().getSessionId(requestCycle.getRequest(), false);
+		}
+	}
+
 	/**
 	 * Get this session's locale.
 	 * 
@@ -666,6 +672,11 @@ public abstract class Session implements IClusterable, IEventSink
 		{
 			invalidateNow();
 		}
+		else
+		{
+			// WICKET-5103 container might have changed id
+			updateId();
+		}
 	}
 
 	private void detachFeedback()
