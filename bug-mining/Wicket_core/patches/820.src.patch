diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/html/PackageResourceGuard.java b/wicket-core/src/main/java/org/apache/wicket/markup/html/PackageResourceGuard.java
index 4fd6450760..9bcff90fde 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/html/PackageResourceGuard.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/html/PackageResourceGuard.java
@@ -127,6 +127,11 @@ public class PackageResourceGuard implements IPackageResourceGuard
 			}
 		}
 
+		//
+		// for windows we have to check both File.separator ('\') and the usual '/' since both can
+		// be used and are used interchangeably
+		//
+
 		if (!allowAccessToRootResources)
 		{
 			String absolute = path;
@@ -134,18 +139,23 @@ public class PackageResourceGuard implements IPackageResourceGuard
 			{
 				// handle a windows path which may have a drive letter in it
 
-				if (absolute.indexOf(":\\") > 0)
+				int drive = absolute.indexOf(":\\");
+				if (drive < 0)
+				{
+					drive = absolute.indexOf(":/");
+				}
+				if (drive > 0)
 				{
 					// strip the drive letter off the path
-					absolute = absolute.substring(absolute.indexOf(":\\") + 2);
+					absolute = absolute.substring(drive + 2);
 				}
 			}
 
-			if (absolute.startsWith(File.separator))
+			if (absolute.startsWith(File.separator) || absolute.startsWith("/"))
 			{
 				absolute = absolute.substring(1);
 			}
-			if (!absolute.contains(File.separator))
+			if (!absolute.contains(File.separator) && !absolute.contains("/"))
 			{
 				log.warn("Access to root directory is by default disabled for shared resources: " +
 					path);
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/PackageResourceGuardTest.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/PackageResourceGuardTest.java
index 2e6a7927d2..7a2a70a6b5 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/PackageResourceGuardTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/PackageResourceGuardTest.java
@@ -62,8 +62,15 @@ public class PackageResourceGuardTest extends WicketTestCase
 			assertTrue(guard.acceptAbsolutePath("\\test\\org\\apache\\test.js"));
 			assertFalse(guard.acceptAbsolutePath("c:\\test.js"));
 			assertFalse(guard.acceptAbsolutePath("\\test.js"));
+
+			// java also generates file paths with '/' on windows
+			assertTrue(guard.acceptAbsolutePath("c:/test/org/apache/test.js"));
+			assertTrue(guard.acceptAbsolutePath("/test/org/apache/test.js"));
+			assertFalse(guard.acceptAbsolutePath("c:/test.js"));
+			assertFalse(guard.acceptAbsolutePath("/test.js"));
 		}
 
+
 	}
 
 }
