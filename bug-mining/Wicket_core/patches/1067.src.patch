diff --git a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/AbstractBookmarkableMapper.java b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/AbstractBookmarkableMapper.java
index 659f7f2d2e..658c98f28c 100644
--- a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/AbstractBookmarkableMapper.java
+++ b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/AbstractBookmarkableMapper.java
@@ -39,6 +39,7 @@ import org.apache.wicket.request.http.WebRequest;
 import org.apache.wicket.request.mapper.info.ComponentInfo;
 import org.apache.wicket.request.mapper.info.PageComponentInfo;
 import org.apache.wicket.request.mapper.info.PageInfo;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.IPageParametersEncoder;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.request.mapper.parameter.PageParametersEncoder;
@@ -629,12 +630,12 @@ public abstract class AbstractBookmarkableMapper extends AbstractComponentMapper
 				if (placeholder != null)
 				{
 					pageParameters.add(placeholder,
-							url.getSegments().get(curSegmentIndex - skippedParameters));
+							url.getSegments().get(curSegmentIndex - skippedParameters), INamedParameters.Type.PATH);
 				}
 				else if (optionalPlaceholder != null && optionalParameterMatch > 0)
 				{
 					pageParameters.add(optionalPlaceholder,
-							url.getSegments().get(curSegmentIndex - skippedParameters));
+							url.getSegments().get(curSegmentIndex - skippedParameters), INamedParameters.Type.PATH);
 					optionalParameterMatch--;
 				}
 			}
diff --git a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/ResourceMapper.java b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/ResourceMapper.java
index 718ede2540..cc6f6d3964 100644
--- a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/ResourceMapper.java
+++ b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/ResourceMapper.java
@@ -28,6 +28,7 @@ import org.apache.wicket.request.Url;
 import org.apache.wicket.request.handler.resource.ResourceReferenceRequestHandler;
 import org.apache.wicket.request.http.flow.AbortWithHttpErrorCodeException;
 import org.apache.wicket.request.mapper.AbstractMapper;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.IPageParametersEncoder;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.request.mapper.parameter.PageParametersEncoder;
@@ -148,7 +149,7 @@ public class ResourceMapper extends AbstractMapper implements IRequestMapper
 				{
 					parameters = new PageParameters();
 				}
-				parameters.add(placeholder, url.getSegments().get(index));
+				parameters.add(placeholder, url.getSegments().get(index), INamedParameters.Type.PATH);
 			}
 		}
 		return new ResourceReferenceRequestHandler(resourceReference, parameters);
diff --git a/wicket-core/src/main/java/org/apache/wicket/protocol/http/RequestUtils.java b/wicket-core/src/main/java/org/apache/wicket/protocol/http/RequestUtils.java
index 9a041643c0..ab3c80878d 100644
--- a/wicket-core/src/main/java/org/apache/wicket/protocol/http/RequestUtils.java
+++ b/wicket-core/src/main/java/org/apache/wicket/protocol/http/RequestUtils.java
@@ -26,6 +26,7 @@ import javax.servlet.http.HttpServletRequest;
 
 import org.apache.wicket.Application;
 import org.apache.wicket.request.cycle.RequestCycle;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.util.encoding.UrlDecoder;
 import org.apache.wicket.util.string.Strings;
@@ -77,11 +78,11 @@ public final class RequestUtils
 			if (bits.length == 2)
 			{
 				params.add(UrlDecoder.QUERY_INSTANCE.decode(bits[0], currentCharset),
-					UrlDecoder.QUERY_INSTANCE.decode(bits[1], currentCharset));
+					UrlDecoder.QUERY_INSTANCE.decode(bits[1], currentCharset), INamedParameters.Type.QUERY_STRING);
 			}
 			else
 			{
-				params.add(UrlDecoder.QUERY_INSTANCE.decode(bits[0], currentCharset), "");
+				params.add(UrlDecoder.QUERY_INSTANCE.decode(bits[0], currentCharset), "", INamedParameters.Type.QUERY_STRING);
 			}
 		}
 	}
@@ -209,7 +210,7 @@ public final class RequestUtils
 	 * @return the request's charset or a default it request is {@code null} or has an unsupported
 	 *         character encoding
 	 * 
-	 * @see IRequestCycleSettings#getResponseRequestEncoding()
+	 * @see org.apache.wicket.settings.RequestCycleSettings#getResponseRequestEncoding()
 	 */
 	public static Charset getCharset(HttpServletRequest request)
 	{
diff --git a/wicket-core/src/main/java/org/apache/wicket/request/resource/caching/QueryStringWithVersionResourceCachingStrategy.java b/wicket-core/src/main/java/org/apache/wicket/request/resource/caching/QueryStringWithVersionResourceCachingStrategy.java
index b3d6465460..117db371b7 100644
--- a/wicket-core/src/main/java/org/apache/wicket/request/resource/caching/QueryStringWithVersionResourceCachingStrategy.java
+++ b/wicket-core/src/main/java/org/apache/wicket/request/resource/caching/QueryStringWithVersionResourceCachingStrategy.java
@@ -101,7 +101,7 @@ public class QueryStringWithVersionResourceCachingStrategy implements IResourceC
 
 		if (version != null)
 		{
-			url.getParameters().set(versionParameter, version);
+			url.getParameters().set(versionParameter, version, INamedParameters.Type.MANUAL);
 		}
 	}
 
diff --git a/wicket-core/src/test/java/org/apache/wicket/RequestEncodingTest.java b/wicket-core/src/test/java/org/apache/wicket/RequestEncodingTest.java
index c0a36a67de..c5d7a0d6a0 100644
--- a/wicket-core/src/test/java/org/apache/wicket/RequestEncodingTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/RequestEncodingTest.java
@@ -16,6 +16,7 @@
  */
 package org.apache.wicket;
 
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.util.tester.WicketTester;
 import org.junit.After;
@@ -37,7 +38,7 @@ public class RequestEncodingTest extends Assert
 	private WicketTester tester;
 
 	/**
-	 * @see org.apache.wicket.WicketTestCase#setUp()
+	 * @see WicketTestCase#commonBefore()
 	 */
 	@Before
 	public void setUp()
@@ -64,7 +65,7 @@ public class RequestEncodingTest extends Assert
 	public void defaultTest()
 	{
 		tester.startPage(RedirectA.class,
-			new PageParameters().set("file", "umlaut-\u00E4-\u00F6-\u00FC"));
+			new PageParameters().set("file", "umlaut-\u00E4-\u00F6-\u00FC", INamedParameters.Type.MANUAL));
 		tester.assertRenderedPage(RedirectB.class);
 
 		String url2 = ((RedirectB)tester.getLastRenderedPage()).getInterceptContinuationURL();
diff --git a/wicket-core/src/test/java/org/apache/wicket/SharedResourceUrlTest.java b/wicket-core/src/test/java/org/apache/wicket/SharedResourceUrlTest.java
index 947e16b03c..6e16fe6dba 100644
--- a/wicket-core/src/test/java/org/apache/wicket/SharedResourceUrlTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/SharedResourceUrlTest.java
@@ -16,6 +16,7 @@
  */
 package org.apache.wicket;
 
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.request.resource.PackageResourceReference;
 import org.apache.wicket.request.resource.ResourceReference;
@@ -50,13 +51,13 @@ public class SharedResourceUrlTest extends WicketTestCase
 	{
 		ResourceReference rr = new SharedResourceReference("test");
 		CharSequence url = tester.getRequestCycle()
-			.mapUrlFor(rr, new PageParameters().set("param", "value"))
+			.mapUrlFor(rr, new PageParameters().set("param", "value", INamedParameters.Type.MANUAL))
 			.toString();
 		assertEquals("wicket/resource/org.apache.wicket.Application/test?param=value", url);
 
 		rr = new PackageResourceReference(SharedResourceUrlTest.class, "test");
 		url = tester.getRequestCycle()
-			.mapUrlFor(rr, new PageParameters().set("param", "value"))
+			.mapUrlFor(rr, new PageParameters().set("param", "value", INamedParameters.Type.MANUAL))
 			.toString();
 		assertEquals("wicket/resource/org.apache.wicket.SharedResourceUrlTest/test?param=value",
 			url);
diff --git a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/BasicResourceReferenceMapperTest.java b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/BasicResourceReferenceMapperTest.java
index d7cce88705..8f0e752cc0 100644
--- a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/BasicResourceReferenceMapperTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/BasicResourceReferenceMapperTest.java
@@ -49,7 +49,7 @@ import org.junit.Test;
  */
 public class BasicResourceReferenceMapperTest extends AbstractResourceReferenceMapperTest
 {
-	private static final IProvider<IResourceCachingStrategy> NO_CACHING = new ValueProvider<IResourceCachingStrategy>(
+	private static final IProvider<IResourceCachingStrategy> NO_CACHING = new ValueProvider<>(
 		NoOpResourceCachingStrategy.INSTANCE);
 
 	private final BasicResourceReferenceMapper encoder = new BasicResourceReferenceMapper(
@@ -345,8 +345,8 @@ public class BasicResourceReferenceMapperTest extends AbstractResourceReferenceM
 	{
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "X");
-		parameters.add("p1", "v1");
-		parameters.add("p2", "v2");
+		parameters.add("p1", "v1", INamedParameters.Type.QUERY_STRING);
+		parameters.add("p2", "v2", INamedParameters.Type.QUERY_STRING);
 		ResourceReferenceRequestHandler handler = new ResourceReferenceRequestHandler(reference1,
 			parameters);
 
@@ -374,8 +374,8 @@ public class BasicResourceReferenceMapperTest extends AbstractResourceReferenceM
 	{
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "X");
-		parameters.add("p1", "v1");
-		parameters.add("p2", "v2");
+		parameters.add("p1", "v1", INamedParameters.Type.QUERY_STRING);
+		parameters.add("p2", "v2", INamedParameters.Type.QUERY_STRING);
 		ResourceReferenceRequestHandler handler = new ResourceReferenceRequestHandler(reference2,
 			parameters);
 
@@ -404,8 +404,8 @@ public class BasicResourceReferenceMapperTest extends AbstractResourceReferenceM
 	{
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "X");
-		parameters.add("p1", "v1");
-		parameters.add("p2", "v2");
+		parameters.add("p1", "v1", INamedParameters.Type.QUERY_STRING);
+		parameters.add("p2", "v2", INamedParameters.Type.QUERY_STRING);
 		ResourceReferenceRequestHandler handler = new ResourceReferenceRequestHandler(reference3,
 			parameters);
 
@@ -434,8 +434,8 @@ public class BasicResourceReferenceMapperTest extends AbstractResourceReferenceM
 	{
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "X");
-		parameters.add("p1", "v1");
-		parameters.add("p2", "v2");
+		parameters.add("p1", "v1", INamedParameters.Type.QUERY_STRING);
+		parameters.add("p2", "v2", INamedParameters.Type.QUERY_STRING);
 		ResourceReferenceRequestHandler handler = new ResourceReferenceRequestHandler(reference4,
 			parameters);
 
@@ -491,18 +491,6 @@ public class BasicResourceReferenceMapperTest extends AbstractResourceReferenceM
 			}
 		};
 
-		final ResourceReference reference = new ResourceReference(getClass(), "versioned",
-			Locale.ENGLISH, "style", null)
-		{
-			private static final long serialVersionUID = 1L;
-
-			@Override
-			public IResource getResource()
-			{
-				return resource;
-			}
-		};
-
 		IResourceCachingStrategy strategy = new FilenameWithVersionResourceCachingStrategy(
 			"-version-", new AlphaDigitResourceVersion("foobar"));
 
diff --git a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/BookmarkableMapperTest.java b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/BookmarkableMapperTest.java
index 910c8211dd..b35ec084cc 100644
--- a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/BookmarkableMapperTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/BookmarkableMapperTest.java
@@ -34,6 +34,7 @@ import org.apache.wicket.request.Request;
 import org.apache.wicket.request.Url;
 import org.apache.wicket.request.component.IRequestableComponent;
 import org.apache.wicket.request.component.IRequestablePage;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.junit.Test;
 
@@ -476,8 +477,8 @@ public class BookmarkableMapperTest extends AbstractMapperTest
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "i1");
 		parameters.set(1, "i2");
-		parameters.set("a", "b");
-		parameters.set("b", "c");
+		parameters.set("a", "b", INamedParameters.Type.QUERY_STRING);
+		parameters.set("b", "c", INamedParameters.Type.QUERY_STRING);
 		PageProvider provider = new PageProvider(MockPage.class, parameters);
 		provider.setPageSource(context);
 		IRequestHandler handler = new BookmarkablePageRequestHandler(provider);
@@ -494,8 +495,8 @@ public class BookmarkableMapperTest extends AbstractMapperTest
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "i1");
 		parameters.set(1, "i2");
-		parameters.set("a", "b");
-		parameters.set("b", "c");
+		parameters.set("a", "b", INamedParameters.Type.QUERY_STRING);
+		parameters.set("b", "c", INamedParameters.Type.QUERY_STRING);
 
 		PageProvider provider = new PageProvider(MockPage.class, parameters);
 		provider.setPageSource(context);
@@ -514,8 +515,8 @@ public class BookmarkableMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 		page.setCreatedBookmarkable(true);
 
 		IPageProvider provider = new PageProvider(page);
@@ -534,8 +535,8 @@ public class BookmarkableMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 
 		page.setCreatedBookmarkable(false);
 
@@ -559,8 +560,8 @@ public class BookmarkableMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 
 		// shouldn't make any difference for
 		// BookmarkableListenerInterfaceRequestHandler,
@@ -588,8 +589,8 @@ public class BookmarkableMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 
 		// shouldn't make any difference for
 		// BookmarkableListenerInterfaceRequestHandler,
diff --git a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/CryptoMapperTest.java b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/CryptoMapperTest.java
index d1e33df4ec..0eb0653b57 100644
--- a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/CryptoMapperTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/CryptoMapperTest.java
@@ -32,6 +32,7 @@ import org.apache.wicket.request.Url;
 import org.apache.wicket.request.Url.StringMode;
 import org.apache.wicket.request.component.IRequestableComponent;
 import org.apache.wicket.request.handler.resource.ResourceReferenceRequestHandler;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.request.resource.PackageResourceReference;
 import org.apache.wicket.request.resource.UrlResourceReference;
@@ -178,8 +179,8 @@ public class CryptoMapperTest extends AbstractMapperTest
 		String expectedEncrypted = "ywKWg-Qpk7YQBiYCmj9MaAJSIV1gtssNinjiALijtet62VMQc2-sMK_RchttkidUpYM_cplXKeZSfGxBkvWzH_E_zWv4Ii7MNSm5nXKno7o/ywK6c/MK_c0/nji3c/Qpk1b/XKnba/c2-cd";
 
 		PageParameters expectedParameters = new PageParameters();
-		expectedParameters.add("namedKey1", "namedValue1");
-		expectedParameters.add("namedKey2", "namedValue2");
+		expectedParameters.add("namedKey1", "namedValue1", INamedParameters.Type.MANUAL);
+		expectedParameters.add("namedKey2", "namedValue2", INamedParameters.Type.MANUAL);
 		expectedParameters.set(0, "indexedValue1");
 		expectedParameters.set(1, "indexedValue2");
 		RenderPageRequestHandler renderPageRequestHandler = new RenderPageRequestHandler(
@@ -209,7 +210,7 @@ public class CryptoMapperTest extends AbstractMapperTest
 	{
 		String expectedEncrypted = "?namedKey1=namedValue1";
 		PageParameters expectedParameters = new PageParameters();
-		expectedParameters.add("namedKey1", "namedValue1");
+		expectedParameters.add("namedKey1", "namedValue1", INamedParameters.Type.MANUAL);
 
 		RenderPageRequestHandler renderPageRequestHandler = new RenderPageRequestHandler(
 			new PageProvider(tester.getApplication().getHomePage(), expectedParameters));
@@ -365,4 +366,4 @@ public class CryptoMapperTest extends AbstractMapperTest
 		assertEquals("foo", ((RequestSettingRequestHandler)requestHandler).getRequest().getUrl()
 			.getQueryParameterValue("q").toString());
 	}
-}
\ No newline at end of file
+}
diff --git a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/MountedMapperTest.java b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/MountedMapperTest.java
index 0024874d6d..6d65a7b1d3 100644
--- a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/MountedMapperTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/MountedMapperTest.java
@@ -35,6 +35,7 @@ import org.apache.wicket.request.Url;
 import org.apache.wicket.request.component.IRequestableComponent;
 import org.apache.wicket.request.component.IRequestablePage;
 import org.apache.wicket.request.http.WebRequest;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.junit.Test;
 
@@ -370,8 +371,8 @@ public class MountedMapperTest extends AbstractMapperTest
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "i1");
 		parameters.set(1, "i2");
-		parameters.set("a", "b");
-		parameters.set("b", "c");
+		parameters.set("a", "b", INamedParameters.Type.QUERY_STRING);
+		parameters.set("b", "c", INamedParameters.Type.QUERY_STRING);
 		PageProvider provider = new PageProvider(MockPage.class, parameters);
 		provider.setPageSource(context);
 		IRequestHandler handler = new BookmarkablePageRequestHandler(provider);
@@ -388,8 +389,8 @@ public class MountedMapperTest extends AbstractMapperTest
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "i1");
 		parameters.set(1, "i2");
-		parameters.set("a", "b");
-		parameters.set("b", "c");
+		parameters.set("a", "b", INamedParameters.Type.QUERY_STRING);
+		parameters.set("b", "c", INamedParameters.Type.QUERY_STRING);
 
 		PageProvider provider = new PageProvider(MockPage.class, parameters);
 		provider.setPageSource(context);
@@ -408,8 +409,8 @@ public class MountedMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 		page.setCreatedBookmarkable(true);
 
 		IPageProvider provider = new PageProvider(page);
@@ -428,8 +429,8 @@ public class MountedMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 
 		page.setCreatedBookmarkable(false);
 
@@ -454,8 +455,8 @@ public class MountedMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 		page.setRenderCount(4);
 
 		// shouldn't make any difference for
@@ -486,17 +487,17 @@ public class MountedMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 
 		// WICKET-4038
-		page.getPageParameters().add(WebRequest.PARAM_AJAX, "true");
-		page.getPageParameters().add(WebRequest.PARAM_AJAX_BASE_URL, "some/base/url");
+		page.getPageParameters().add(WebRequest.PARAM_AJAX, "true", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().add(WebRequest.PARAM_AJAX_BASE_URL, "some/base/url", INamedParameters.Type.QUERY_STRING);
 
 		page.setRenderCount(4);
 
 		// shouldn't make any difference for ListenerInterfaceRequestHandler,
-		// as this explicitely says the url must be bookmarkable
+		// as this explicitly says the url must be bookmarkable
 		page.setCreatedBookmarkable(false);
 
 		IRequestableComponent c = page.get("foo:bar");
@@ -519,8 +520,8 @@ public class MountedMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 		page.setRenderCount(5);
 
 		// shouldn't make any difference for
@@ -551,8 +552,8 @@ public class MountedMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 		page.setRenderCount(5);
 
 		// shouldn't make any difference for ListenerInterfaceRequestHandler,
@@ -676,10 +677,10 @@ public class MountedMapperTest extends AbstractMapperTest
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "i1");
 		parameters.set(1, "i2");
-		parameters.set("a", "b");
-		parameters.set("b", "c");
-		parameters.set("param1", "p1");
-		parameters.set("param2", "p2");
+		parameters.set("a", "b", INamedParameters.Type.QUERY_STRING);
+		parameters.set("b", "c", INamedParameters.Type.QUERY_STRING);
+		parameters.set("param1", "p1", INamedParameters.Type.PATH);
+		parameters.set("param2", "p2", INamedParameters.Type.PATH);
 
 
 		PageProvider provider = new PageProvider(MockPage.class, parameters);
@@ -699,10 +700,10 @@ public class MountedMapperTest extends AbstractMapperTest
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "i1");
 		parameters.set(1, "i2");
-		parameters.set("a", "b");
-		parameters.set("b", "c");
-		parameters.set("param1", "p1");
-		parameters.set("param2", "p2");
+		parameters.set("a", "b", INamedParameters.Type.QUERY_STRING);
+		parameters.set("b", "c", INamedParameters.Type.QUERY_STRING);
+		parameters.set("param1", "p1", INamedParameters.Type.PATH);
+		parameters.set("param2", "p2", INamedParameters.Type.PATH);
 
 		PageProvider provider = new PageProvider(MockPage.class, parameters)
 		{
@@ -836,10 +837,10 @@ public class MountedMapperTest extends AbstractMapperTest
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "i1");
 		parameters.set(1, "i2");
-		parameters.set("a", "b");
-		parameters.set("b", "c");
-		parameters.set("param1", "p1");
-		parameters.set("param2", "p2");
+		parameters.set("a", "b", INamedParameters.Type.QUERY_STRING);
+		parameters.set("b", "c", INamedParameters.Type.QUERY_STRING);
+		parameters.set("param1", "p1", INamedParameters.Type.PATH);
+		parameters.set("param2", "p2", INamedParameters.Type.PATH);
 
 
 		PageProvider provider = new PageProvider(MockPage.class, parameters);
@@ -856,10 +857,10 @@ public class MountedMapperTest extends AbstractMapperTest
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "i1");
 		parameters.set(1, "i2");
-		parameters.set("a", "b");
-		parameters.set("b", "c");
-		parameters.set("param2", "p2");
-		parameters.set("param3", "p3");
+		parameters.set("a", "b", INamedParameters.Type.QUERY_STRING);
+		parameters.set("b", "c", INamedParameters.Type.QUERY_STRING);
+		parameters.set("param2", "p2", INamedParameters.Type.PATH);
+		parameters.set("param3", "p3", INamedParameters.Type.PATH);
 
 
 		PageProvider provider = new PageProvider(MockPage.class, parameters);
diff --git a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/PackageMapperTest.java b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/PackageMapperTest.java
index 9285fa0107..413c70dbf1 100644
--- a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/PackageMapperTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/PackageMapperTest.java
@@ -34,6 +34,7 @@ import org.apache.wicket.request.IRequestHandler;
 import org.apache.wicket.request.Url;
 import org.apache.wicket.request.component.IRequestableComponent;
 import org.apache.wicket.request.component.IRequestablePage;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.util.lang.PackageName;
 import org.junit.Test;
@@ -392,8 +393,8 @@ public class PackageMapperTest extends AbstractMapperTest
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "i1");
 		parameters.set(1, "i2");
-		parameters.set("a", "b");
-		parameters.set("b", "c");
+		parameters.set("a", "b", INamedParameters.Type.QUERY_STRING);
+		parameters.set("b", "c", INamedParameters.Type.QUERY_STRING);
 		PageProvider provider = new PageProvider(MockPage.class, parameters);
 		provider.setPageSource(context);
 		IRequestHandler handler = new BookmarkablePageRequestHandler(provider);
@@ -410,8 +411,8 @@ public class PackageMapperTest extends AbstractMapperTest
 		PageParameters parameters = new PageParameters();
 		parameters.set(0, "i1");
 		parameters.set(1, "i2");
-		parameters.set("a", "b");
-		parameters.set("b", "c");
+		parameters.set("a", "b", INamedParameters.Type.QUERY_STRING);
+		parameters.set("b", "c", INamedParameters.Type.QUERY_STRING);
 
 		PageProvider provider = new PageProvider(MockPage.class, parameters);
 		provider.setPageSource(context);
@@ -430,8 +431,8 @@ public class PackageMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 		page.setCreatedBookmarkable(true);
 
 		IPageProvider provider = new PageProvider(page);
@@ -450,8 +451,8 @@ public class PackageMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 
 		page.setCreatedBookmarkable(false);
 
@@ -471,8 +472,8 @@ public class PackageMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 
 		// shouldn't make any difference for
 		// BookmarkableListenerInterfaceRequestHandler,
@@ -499,8 +500,8 @@ public class PackageMapperTest extends AbstractMapperTest
 		MockPage page = new MockPage(15);
 		page.getPageParameters().set(0, "i1");
 		page.getPageParameters().set(1, "i2");
-		page.getPageParameters().set("a", "b");
-		page.getPageParameters().set("b", "c");
+		page.getPageParameters().set("a", "b", INamedParameters.Type.QUERY_STRING);
+		page.getPageParameters().set("b", "c", INamedParameters.Type.QUERY_STRING);
 
 		// shouldn't make any difference for
 		// BookmarkableListenerInterfaceRequestHandler,
@@ -550,8 +551,8 @@ public class PackageMapperTest extends AbstractMapperTest
 		page.setPageStateless(true);
 
 		IPageProvider provider = new PageProvider(page);
-		page.getPageParameters().set("foo", "fooValue");
-		page.getPageParameters().set("bar", "barValue");
+		page.getPageParameters().set("foo", "fooValue", INamedParameters.Type.PATH);
+		page.getPageParameters().set("bar", "barValue", INamedParameters.Type.PATH);
 		IRequestHandler handler = new RenderPageRequestHandler(provider);
 
 		Url url = namedParametersEncoder.mapHandler(handler);
diff --git a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/UrlInfoTest.java b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/UrlInfoTest.java
index c3c4666d32..04cfceec56 100644
--- a/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/UrlInfoTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/core/request/mapper/UrlInfoTest.java
@@ -19,6 +19,7 @@ package org.apache.wicket.core.request.mapper;
 import org.apache.wicket.MockPage;
 import org.apache.wicket.request.http.WebRequest;
 import org.apache.wicket.core.request.mapper.AbstractBookmarkableMapper.UrlInfo;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.junit.Assert;
 import org.junit.Test;
@@ -36,9 +37,9 @@ public class UrlInfoTest extends Assert
 	public void wicket4038()
 	{
 		PageParameters parameters = new PageParameters();
-		parameters.add(WebRequest.PARAM_AJAX, "true");
-		parameters.add(WebRequest.PARAM_AJAX_BASE_URL, "base/url");
-		parameters.add(WebRequest.PARAM_AJAX_REQUEST_ANTI_CACHE, "12345.6879");
+		parameters.add(WebRequest.PARAM_AJAX, "true", INamedParameters.Type.MANUAL);
+		parameters.add(WebRequest.PARAM_AJAX_BASE_URL, "base/url", INamedParameters.Type.MANUAL);
+		parameters.add(WebRequest.PARAM_AJAX_REQUEST_ANTI_CACHE, "12345.6879", INamedParameters.Type.MANUAL);
 
 		AbstractBookmarkableMapper.UrlInfo info = new UrlInfo(null, MockPage.class, parameters);
 		assertNull(info.getPageParameters());
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/basic/SimpleResponsePageClass.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/basic/SimpleResponsePageClass.java
index 84d3c13574..7b266849e7 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/basic/SimpleResponsePageClass.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/basic/SimpleResponsePageClass.java
@@ -18,6 +18,7 @@ package org.apache.wicket.markup.html.basic;
 
 import org.apache.wicket.markup.html.WebPage;
 import org.apache.wicket.markup.html.form.Form;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 
 /**
@@ -41,7 +42,7 @@ public class SimpleResponsePageClass extends WebPage
 			protected void onSubmit()
 			{
 				// use Page "class"
-				setResponsePage(SimplePage.class, new PageParameters().set("test", "test"));
+				setResponsePage(SimplePage.class, new PageParameters().set("test", "test", INamedParameters.Type.MANUAL));
 			}
 		};
 		add(form);
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/form/FormTest.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/form/FormTest.java
index e63458df56..35b4c8a05e 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/form/FormTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/form/FormTest.java
@@ -21,6 +21,7 @@ import org.apache.wicket.MockPageParametersAware;
 import org.apache.wicket.WicketTestCase;
 import org.apache.wicket.markup.IMarkupResourceStreamProvider;
 import org.apache.wicket.markup.html.WebPage;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.util.resource.IResourceStream;
 import org.apache.wicket.util.resource.StringResourceStream;
@@ -173,8 +174,8 @@ public class FormTest extends WicketTestCase
 	public void pageWithParameters() throws Exception
 	{
 		PageParameters parameters = new PageParameters();
-		parameters.add("first", "foo");
-		parameters.add("second", "bar");
+		parameters.add("first", "foo", INamedParameters.Type.MANUAL);
+		parameters.add("second", "bar", INamedParameters.Type.MANUAL);
 		executeTest(FormMethodTestPage.class, parameters, "pageWithParameters_expected.html");
 	}
 }
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/EnclosureTest.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/EnclosureTest.java
index 743d2c0cd1..289ad5caa5 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/EnclosureTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/EnclosureTest.java
@@ -30,6 +30,7 @@ import org.apache.wicket.markup.html.basic.Label;
 import org.apache.wicket.markup.html.form.CheckBox;
 import org.apache.wicket.markup.html.link.Link;
 import org.apache.wicket.mock.MockApplication;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.util.resource.IResourceStream;
 import org.apache.wicket.util.resource.StringResourceStream;
@@ -78,7 +79,7 @@ public class EnclosureTest extends WicketTestCase
 	@Test
 	public void testRenderHomePage4() throws Exception
 	{
-		executeTest(EnclosurePage_4.class, new PageParameters().set("visible", false),
+		executeTest(EnclosurePage_4.class, new PageParameters().set("visible", false, INamedParameters.Type.MANUAL),
 			"EnclosurePageExpectedResult_4.html");
 	}
 
@@ -88,7 +89,7 @@ public class EnclosureTest extends WicketTestCase
 	@Test
 	public void testRenderHomePage4_1() throws Exception
 	{
-		executeTest(EnclosurePage_4.class, new PageParameters().set("visible", true),
+		executeTest(EnclosurePage_4.class, new PageParameters().set("visible", true, INamedParameters.Type.MANUAL),
 			"EnclosurePageExpectedResult_4-1.html");
 	}
 
@@ -98,7 +99,7 @@ public class EnclosureTest extends WicketTestCase
 	@Test
 	public void testRenderHomePage5() throws Exception
 	{
-		executeTest(EnclosurePage_5.class, new PageParameters().set("visible", false),
+		executeTest(EnclosurePage_5.class, new PageParameters().set("visible", false, INamedParameters.Type.MANUAL),
 			"EnclosurePageExpectedResult_5.html");
 	}
 
@@ -108,7 +109,7 @@ public class EnclosureTest extends WicketTestCase
 	@Test
 	public void testRenderHomePage5_1() throws Exception
 	{
-		executeTest(EnclosurePage_5.class, new PageParameters().set("visible", true),
+		executeTest(EnclosurePage_5.class, new PageParameters().set("visible", true, INamedParameters.Type.MANUAL),
 			"EnclosurePageExpectedResult_5-1.html");
 	}
 
@@ -432,4 +433,4 @@ public class EnclosureTest extends WicketTestCase
 
 		tester.assertContainsNot(ChildWithDeeperPathInTransparentContainerPage.LABEL_TEXT);
 	}
-}
\ No newline at end of file
+}
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/link/BookmarkableHomePageLinksPage.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/link/BookmarkableHomePageLinksPage.java
index 199b5104bc..f1df588a6a 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/link/BookmarkableHomePageLinksPage.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/link/BookmarkableHomePageLinksPage.java
@@ -19,6 +19,7 @@ package org.apache.wicket.markup.html.link;
 import org.apache.wicket.Application;
 import org.apache.wicket.Page;
 import org.apache.wicket.markup.html.WebPage;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 
 /**
@@ -37,7 +38,7 @@ public class BookmarkableHomePageLinksPage extends WebPage
 		Class<? extends Page> homePage = Application.get().getHomePage();
 		add(new BookmarkablePageLink<Void>("defaulthompage", homePage));
 		add(new BookmarkablePageLink<Void>("defaulthompagewithparams", homePage,
-			new PageParameters().set("param1",1).set("param2", "test")));
+			new PageParameters().set("param1",1, INamedParameters.Type.MANUAL).set("param2", "test", INamedParameters.Type.MANUAL)));
 		add(new BookmarkablePageLink<Void>("defaulthompagewithpagemap", homePage));
 	}
 
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/link/BookmarkablePageLinkTest.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/link/BookmarkablePageLinkTest.java
index f0412efc69..1b0830f6a2 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/link/BookmarkablePageLinkTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/link/BookmarkablePageLinkTest.java
@@ -18,6 +18,7 @@ package org.apache.wicket.markup.html.link;
 
 import org.apache.wicket.MockPageWithLink;
 import org.apache.wicket.WicketTestCase;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.junit.Assert;
 import org.junit.Test;
@@ -58,7 +59,7 @@ public class BookmarkablePageLinkTest extends WicketTestCase
 	public void bookmarkableRequestWithInterceptWithParams() throws Exception
 	{
 		PageParameters pp = new PageParameters();
-		pp.set("test", "test");
+		pp.set("test", "test", INamedParameters.Type.MANUAL);
 
 		tester.startPage(BookmarkableThrowsInterceptPage.class, pp);
 
@@ -76,7 +77,7 @@ public class BookmarkablePageLinkTest extends WicketTestCase
 	{
 		BookmarkablePageLink<MockPageWithLink> link = new BookmarkablePageLink<MockPageWithLink>(
 			"link", MockPageWithLink.class);
-		link.getPageParameters().set("urlEscapeNeeded", "someone's ^b%a&d pa\"rameter");
+		link.getPageParameters().set("urlEscapeNeeded", "someone's ^b%a&d pa\"rameter", INamedParameters.Type.MANUAL);
 
 		tester.startComponentInPage(link, null);
 		String response = tester.getLastResponse().getDocument();
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/link/MountedPageLinkTest.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/link/MountedPageLinkTest.java
index 0093571f0d..0ea7156394 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/link/MountedPageLinkTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/link/MountedPageLinkTest.java
@@ -22,6 +22,7 @@ import java.util.Collection;
 import org.apache.wicket.WicketTestCase;
 import org.apache.wicket.core.request.mapper.PageInstanceMapper;
 import org.apache.wicket.protocol.http.PageExpiredException;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.junit.Before;
 import org.junit.Test;
@@ -69,7 +70,7 @@ public class MountedPageLinkTest extends WicketTestCase
 	public void testPageParametersInLink()
 	{
 		PageWithLink page = tester.startPage(PageWithLink.class,
-			new PageParameters().add("param", "value"));
+			new PageParameters().add("param", "value", INamedParameters.Type.MANUAL));
 		Link<?> link = (Link<?>)page.get("link");
 		String url = link.getURL().toString();
 		if (mount)
@@ -89,7 +90,7 @@ public class MountedPageLinkTest extends WicketTestCase
 	public void testLinkOnExpiredPage()
 	{
 		PageWithLink page = tester.startPage(PageWithLink.class,
-			new PageParameters().add("param", "value"));
+			new PageParameters().add("param", "value", INamedParameters.Type.MANUAL));
 		assertEquals("value", page.getPageParameters().get("param").toString());
 		tester.assertContains("param=value");
 		Link<?> link = (Link<?>)page.get("link");
@@ -111,7 +112,7 @@ public class MountedPageLinkTest extends WicketTestCase
 	{
 		tester.getApplication().getPageSettings().setRecreateMountedPagesAfterExpiry(false);
 		PageWithLink page = tester.startPage(PageWithLink.class,
-			new PageParameters().add("param", "value"));
+			new PageParameters().add("param", "value", INamedParameters.Type.MANUAL));
 		Link<?> link = (Link<?>)page.get("link");
 		String url = link.getURL().toString();
 		assertEquals("./wicket/page?0-1.ILinkListener-link", url);
@@ -126,7 +127,7 @@ public class MountedPageLinkTest extends WicketTestCase
 	{
 		tester.getApplication().getPageSettings().setRecreateMountedPagesAfterExpiry(false);
 		PageWithLink page = tester.startPage(PageWithLink.class,
-			new PageParameters().add("param", "value"));
+			new PageParameters().add("param", "value", INamedParameters.Type.MANUAL));
 		Link<?> link = (Link<?>)page.get("link");
 		String url = link.getURL().toString();
 		assertEquals("./wicket/page?0-1.ILinkListener-link", url);
diff --git a/wicket-core/src/test/java/org/apache/wicket/page/expirationrecovery/PageExpirationRecoveryTest.java b/wicket-core/src/test/java/org/apache/wicket/page/expirationrecovery/PageExpirationRecoveryTest.java
index 67c4b46ef1..b3322c631c 100644
--- a/wicket-core/src/test/java/org/apache/wicket/page/expirationrecovery/PageExpirationRecoveryTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/page/expirationrecovery/PageExpirationRecoveryTest.java
@@ -18,6 +18,7 @@ package org.apache.wicket.page.expirationrecovery;
 
 import org.apache.wicket.WicketTestCase;
 import org.apache.wicket.protocol.http.PageExpiredException;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.settings.PageSettings;
 import org.apache.wicket.util.tester.FormTester;
@@ -33,7 +34,9 @@ import org.junit.Test;
 public class PageExpirationRecoveryTest extends WicketTestCase
 {
 
-	private final PageParameters parameters = new PageParameters().set("a", "b").set("c", "d");
+	private final PageParameters parameters = new PageParameters()
+			.set("a", "b", INamedParameters.Type.MANUAL)
+			.set("c", "d", INamedParameters.Type.MANUAL);
 
 	@Before
 	public void before()
diff --git a/wicket-core/src/test/java/org/apache/wicket/redirect/abort/AbortExceptionTest.java b/wicket-core/src/test/java/org/apache/wicket/redirect/abort/AbortExceptionTest.java
index b26988af30..2c6e3e0f3d 100644
--- a/wicket-core/src/test/java/org/apache/wicket/redirect/abort/AbortExceptionTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/redirect/abort/AbortExceptionTest.java
@@ -16,6 +16,7 @@
  */
 package org.apache.wicket.redirect.abort;
 
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.junit.Assert;
 
 import org.apache.wicket.WicketTestCase;
@@ -39,7 +40,7 @@ public class AbortExceptionTest extends WicketTestCase
 	@Test
 	public void testNoAbort()
 	{
-		tester.startPage(AbortExceptionPage.class, new PageParameters().set("trigger", false));
+		tester.startPage(AbortExceptionPage.class, new PageParameters().set("trigger", false, INamedParameters.Type.MANUAL));
 		Assert.assertEquals(1234, tester.getLastResponse().getStatus());
 	}
 
@@ -51,7 +52,7 @@ public class AbortExceptionTest extends WicketTestCase
 	{
 		try
 		{
-			tester.startPage(AbortExceptionPage.class, new PageParameters().set("trigger", true));
+			tester.startPage(AbortExceptionPage.class, new PageParameters().set("trigger", true, INamedParameters.Type.MANUAL));
 			Assert.assertEquals(1234, tester.getLastResponse().getStatus()); // this will
 			// fail
 		}
diff --git a/wicket-core/src/test/java/org/apache/wicket/request/handler/render/StatelessPageManipulatingPageParametersTest.java b/wicket-core/src/test/java/org/apache/wicket/request/handler/render/StatelessPageManipulatingPageParametersTest.java
index 415776675e..00254ef55d 100644
--- a/wicket-core/src/test/java/org/apache/wicket/request/handler/render/StatelessPageManipulatingPageParametersTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/request/handler/render/StatelessPageManipulatingPageParametersTest.java
@@ -22,6 +22,7 @@ import org.apache.wicket.markup.IMarkupResourceStreamProvider;
 import org.apache.wicket.markup.html.WebPage;
 import org.apache.wicket.markup.html.form.StatelessForm;
 import org.apache.wicket.protocol.http.WebApplication;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.util.resource.IResourceStream;
 import org.apache.wicket.util.resource.StringResourceStream;
@@ -61,7 +62,7 @@ public class StatelessPageManipulatingPageParametersTest extends WicketTestCase
 				protected void onSubmit()
 				{
 					PageParameters parameters = new PageParameters();
-					parameters.add("login", "");
+					parameters.add("login", "", INamedParameters.Type.MANUAL);
 					setResponsePage(SecondPage.class, parameters);
 				}
 			};
diff --git a/wicket-core/src/test/java/org/apache/wicket/request/resource/caching/QueryStringWithVersionResourceCachingStrategyTest.java b/wicket-core/src/test/java/org/apache/wicket/request/resource/caching/QueryStringWithVersionResourceCachingStrategyTest.java
index 6611a57ff1..7e7b6db680 100644
--- a/wicket-core/src/test/java/org/apache/wicket/request/resource/caching/QueryStringWithVersionResourceCachingStrategyTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/request/resource/caching/QueryStringWithVersionResourceCachingStrategyTest.java
@@ -20,6 +20,7 @@ import org.apache.wicket.Application;
 import org.apache.wicket.ThreadContext;
 import org.apache.wicket.request.cycle.RequestCycle;
 import org.apache.wicket.request.http.WebResponse;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.request.resource.AbstractResource;
 import org.apache.wicket.request.resource.caching.version.IResourceVersion;
@@ -56,7 +57,7 @@ public class QueryStringWithVersionResourceCachingStrategyTest extends Assert
 	public void testUndecorateUrl() throws Exception
 	{
 		PageParameters urlParameters = new PageParameters();
-		urlParameters.add(versionParameter, TEST_RESOURCE_VERSION);
+		urlParameters.add(versionParameter, TEST_RESOURCE_VERSION, INamedParameters.Type.QUERY_STRING);
 		ResourceUrl resourceUrl = new ResourceUrl("some-resource.txt", urlParameters);
 		strategy.undecorateUrl(resourceUrl);
 
@@ -109,7 +110,7 @@ public class QueryStringWithVersionResourceCachingStrategyTest extends Assert
 		try
 		{
 			PageParameters urlParameters = new PageParameters();
-			urlParameters.add(versionParameter, "9A0364B9E99BB480DD25E1F0284C8555");
+			urlParameters.add(versionParameter, "9A0364B9E99BB480DD25E1F0284C8555", INamedParameters.Type.QUERY_STRING);
 			ResourceUrl resourceUrl = new ResourceUrl("some-resource.txt", urlParameters);
 			strategy.undecorateUrl(resourceUrl);
 
diff --git a/wicket-core/src/test/java/org/apache/wicket/session/DefaultPageFactoryTest.java b/wicket-core/src/test/java/org/apache/wicket/session/DefaultPageFactoryTest.java
index 7f372ba348..910fbe01b8 100644
--- a/wicket-core/src/test/java/org/apache/wicket/session/DefaultPageFactoryTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/session/DefaultPageFactoryTest.java
@@ -22,6 +22,7 @@ import org.apache.wicket.WicketTestCase;
 import org.apache.wicket.markup.html.WebPage;
 import org.apache.wicket.request.flow.ResetResponseException;
 import org.apache.wicket.request.handler.EmptyRequestHandler;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.junit.Rule;
 import org.junit.Test;
@@ -187,7 +188,7 @@ public class DefaultPageFactoryTest extends WicketTestCase
 		expectedException.expectMessage("Can't instantiate page using constructor 'private org.apache.wicket.session.DefaultPageFactoryTest$PrivateConstructorWithParametersPage(org.apache.wicket.request.mapper.parameter.PageParameters)' and argument 'key=[value]'. This constructor is private!");
 
 		PageParameters parameters = new PageParameters();
-		parameters.add("key", "value");
+		parameters.add("key", "value", INamedParameters.Type.MANUAL);
 		pageFactory.newPage(PrivateConstructorWithParametersPage.class, parameters);
 	}
 
diff --git a/wicket-core/src/test/java/org/apache/wicket/stateless/StatelessComponentTest.java b/wicket-core/src/test/java/org/apache/wicket/stateless/StatelessComponentTest.java
index 996c051c80..8538774985 100644
--- a/wicket-core/src/test/java/org/apache/wicket/stateless/StatelessComponentTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/stateless/StatelessComponentTest.java
@@ -18,6 +18,7 @@ package org.apache.wicket.stateless;
 
 import org.apache.wicket.WicketTestCase;
 import org.apache.wicket.request.Url;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.junit.Test;
 
@@ -79,8 +80,8 @@ public class StatelessComponentTest extends WicketTestCase
 	public void statelessComponentPageWithParams() throws Exception
 	{
 		PageParameters params = new PageParameters();
-		params.set("testParam1", "testValue1");
-		params.set("testParam2", "testValue2");
+		params.set("testParam1", "testValue1", INamedParameters.Type.QUERY_STRING);
+		params.set("testParam2", "testValue2", INamedParameters.Type.QUERY_STRING);
 
 		executeTest(StatelessComponentPageWithParams.class, params,
 			"StatelessComponentPageWithParams_result.html");
@@ -107,8 +108,8 @@ public class StatelessComponentTest extends WicketTestCase
 	public void statelessComponentPageWithParamsWithMount() throws Exception
 	{
 		PageParameters params = new PageParameters();
-		params.set("testParam1", "testValue1");
-		params.set("testParam2", "testValue2");
+		params.set("testParam1", "testValue1", INamedParameters.Type.QUERY_STRING);
+		params.set("testParam2", "testValue2", INamedParameters.Type.QUERY_STRING);
 		tester.getApplication().mountPage("/stateless", StatelessComponentPageWithParams.class);
 		// test is always the home page. it doesn't work then
 		executeTest(StatelessComponentPageWithParams.class, params,
diff --git a/wicket-core/src/test/java/org/apache/wicket/stateless/StatelessFormTest.java b/wicket-core/src/test/java/org/apache/wicket/stateless/StatelessFormTest.java
index 4150d91c8a..e5de4c3cd6 100644
--- a/wicket-core/src/test/java/org/apache/wicket/stateless/StatelessFormTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/stateless/StatelessFormTest.java
@@ -20,6 +20,7 @@ import org.apache.wicket.Page;
 import org.apache.wicket.WicketTestCase;
 import org.apache.wicket.mock.MockApplication;
 import org.apache.wicket.protocol.http.WebApplication;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.stateless.pages.HomePage;
 import org.apache.wicket.stateless.pages.LoginPage;
@@ -99,8 +100,8 @@ public class StatelessFormTest extends WicketTestCase
 	public void pageWithParameters() throws Exception
 	{
 		PageParameters parameters = new PageParameters();
-		parameters.add("first", "foo");
-		parameters.add("second", "bar");
+		parameters.add("first", "foo", INamedParameters.Type.MANUAL);
+		parameters.add("second", "bar", INamedParameters.Type.MANUAL);
 		executeTest(StatelessPageWithForm.class, parameters, "StatelessPageWithForm_expected.html");
 	}
 
diff --git a/wicket-core/src/test/java/org/apache/wicket/util/tester/FormTesterTest.java b/wicket-core/src/test/java/org/apache/wicket/util/tester/FormTesterTest.java
index 1274683067..0e30610b18 100644
--- a/wicket-core/src/test/java/org/apache/wicket/util/tester/FormTesterTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/util/tester/FormTesterTest.java
@@ -31,6 +31,7 @@ import org.apache.wicket.markup.html.form.DropDownChoice;
 import org.apache.wicket.markup.html.form.Form;
 import org.apache.wicket.markup.html.form.upload.FileUpload;
 import org.apache.wicket.model.Model;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.util.file.File;
 import org.apache.wicket.util.resource.IResourceStream;
@@ -197,7 +198,7 @@ public class FormTesterTest extends WicketTestCase
 	@Test
 	public void submitMultipartForm()
 	{
-		tester.startPage(MockFormFileUploadPage.class, new PageParameters().set("required", false));
+		tester.startPage(MockFormFileUploadPage.class, new PageParameters().set("required", false, INamedParameters.Type.MANUAL));
 		MockFormFileUploadPage page = (MockFormFileUploadPage)tester.getLastRenderedPage();
 		MockDomainObjectFileUpload domainObject = page.getDomainObject();
 
diff --git a/wicket-core/src/test/java/org/apache/wicket/util/tester/MockFormFileUploadPage.java b/wicket-core/src/test/java/org/apache/wicket/util/tester/MockFormFileUploadPage.java
index ee2def7bb9..0a221398c6 100644
--- a/wicket-core/src/test/java/org/apache/wicket/util/tester/MockFormFileUploadPage.java
+++ b/wicket-core/src/test/java/org/apache/wicket/util/tester/MockFormFileUploadPage.java
@@ -25,6 +25,7 @@ import org.apache.wicket.markup.html.form.upload.FileUpload;
 import org.apache.wicket.markup.html.form.upload.FileUploadField;
 import org.apache.wicket.model.CompoundPropertyModel;
 import org.apache.wicket.model.util.ListModel;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.util.lang.Bytes;
 import org.apache.wicket.util.string.StringValue;
@@ -79,7 +80,7 @@ public class MockFormFileUploadPage extends WebPage
 	@SuppressWarnings("deprecation")
 	public MockFormFileUploadPage()
 	{
-		this(new PageParameters().set("required", "true"));
+		this(new PageParameters().set("required", "true", INamedParameters.Type.MANUAL));
 	}
 
 	/**
diff --git a/wicket-core/src/test/java/org/apache/wicket/util/tester/MockPageParameterPage.java b/wicket-core/src/test/java/org/apache/wicket/util/tester/MockPageParameterPage.java
index 3bac5946ef..65c1105318 100644
--- a/wicket-core/src/test/java/org/apache/wicket/util/tester/MockPageParameterPage.java
+++ b/wicket-core/src/test/java/org/apache/wicket/util/tester/MockPageParameterPage.java
@@ -19,6 +19,7 @@ package org.apache.wicket.util.tester;
 import org.apache.wicket.markup.html.WebPage;
 import org.apache.wicket.markup.html.basic.Label;
 import org.apache.wicket.markup.html.link.BookmarkablePageLink;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 
 /**
@@ -38,7 +39,7 @@ public class MockPageParameterPage extends WebPage
 	public MockPageParameterPage(PageParameters pageParameters)
 	{
 		add(new BookmarkablePageLink<Void>("link", MockPageParameterPage.class,
-			new PageParameters().set("id", 1)));
+			new PageParameters().set("id", 1, INamedParameters.Type.MANUAL)));
 		add(new Label("label", pageParameters.get("id").toString()));
 	}
 
diff --git a/wicket-core/src/test/java/org/apache/wicket/util/tester/WicketTesterTest.java b/wicket-core/src/test/java/org/apache/wicket/util/tester/WicketTesterTest.java
index 8754fc25f6..e6ffeb0d86 100644
--- a/wicket-core/src/test/java/org/apache/wicket/util/tester/WicketTesterTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/util/tester/WicketTesterTest.java
@@ -57,6 +57,7 @@ import org.apache.wicket.request.IRequestParameters;
 import org.apache.wicket.request.Url;
 import org.apache.wicket.request.component.IRequestableComponent;
 import org.apache.wicket.request.flow.RedirectToUrlException;
+import org.apache.wicket.request.mapper.parameter.INamedParameters;
 import org.apache.wicket.request.mapper.parameter.PageParameters;
 import org.apache.wicket.request.resource.ByteArrayResource;
 import org.apache.wicket.request.resource.IResource;
@@ -749,7 +750,7 @@ public class WicketTesterTest extends WicketTestCase
 	public void setQueryParameterWhenRequestHasAnQueryUrl()
 	{
 		PageParameters parameters = new PageParameters();
-		parameters.set("q_1", "q_1_value");
+		parameters.set("q_1", "q_1_value", INamedParameters.Type.MANUAL);
 		IPageProvider testPageProvider = new PageProvider(MockPageParametersAware.class, parameters);
 		IRequestHandler pageRequestHandler = new BookmarkablePageRequestHandler(testPageProvider);
 		Url url = tester.getApplication().getRootRequestMapper().mapHandler(pageRequestHandler);
@@ -770,8 +771,8 @@ public class WicketTesterTest extends WicketTestCase
 	public void setMultiValueQueryParameter()
 	{
 		PageParameters parameters = new PageParameters();
-		parameters.add("q_1", "q_1_value_1");
-		parameters.add("q_1", "q_1_value_2");
+		parameters.add("q_1", "q_1_value_1", INamedParameters.Type.MANUAL);
+		parameters.add("q_1", "q_1_value_2", INamedParameters.Type.MANUAL);
 		IPageProvider testPageProvider = new PageProvider(MockPageParametersAware.class, parameters);
 		IRequestHandler pageRequestHandler = new BookmarkablePageRequestHandler(testPageProvider);
 		Url url = tester.getApplication().getRootRequestMapper().mapHandler(pageRequestHandler);
