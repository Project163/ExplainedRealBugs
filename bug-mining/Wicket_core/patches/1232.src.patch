diff --git a/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java b/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java
index 3b1bf8dc10..e04341bf47 100644
--- a/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java
+++ b/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java
@@ -519,25 +519,7 @@ public abstract class MarkupContainer extends Component implements Iterable<Comp
 		return new Iterator<Component>()
 		{
 			Component currentComponent = null;
-			Iterator<Component> internalIterator;
-			{
-				if (children == null)
-				{
-					internalIterator = Collections.emptyIterator();
-				}
-				else if (children instanceof Component)
-				{
-					internalIterator = Collections.singleton((Component)children).iterator();
-				}
-				else if (children instanceof List)
-				{
-					internalIterator = ((List<Component>)children).iterator();
-				}
-				else
-				{
-					internalIterator = ((Map<String, Component>)children).values().iterator();
-				}
-			}
+			Iterator<Component> internalIterator = copyChildren().iterator();
 
 			@Override
 			public boolean hasNext()
