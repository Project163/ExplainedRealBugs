diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/head/filter/FilteringHeaderResponse.java b/wicket-core/src/main/java/org/apache/wicket/markup/head/filter/FilteringHeaderResponse.java
index 81d6f667c5..b3ec1d81f5 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/head/filter/FilteringHeaderResponse.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/head/filter/FilteringHeaderResponse.java
@@ -77,8 +77,8 @@ public class FilteringHeaderResponse extends DecoratingHeaderResponse
 	}
 
 	/**
-	 * we store this FilteringHeaderResponse in the RequestCycle so that the
-	 * containers can access it to render their bucket of stuff
+	 * we store this FilteringHeaderResponse in the RequestCycle so that the containers can access
+	 * it to render their bucket of stuff
 	 */
 	private static final MetaDataKey<FilteringHeaderResponse> RESPONSE_KEY = new MetaDataKey<FilteringHeaderResponse>()
 	{
@@ -151,7 +151,7 @@ public class FilteringHeaderResponse extends DecoratingHeaderResponse
 	{
 		if (item instanceof FilteredHeaderItem)
 		{
-			String filterName = ((FilteredHeaderItem) item).getFilterName();
+			String filterName = ((FilteredHeaderItem)item).getFilterName();
 			render(item, filterName);
 		}
 		else
@@ -206,6 +206,18 @@ public class FilteringHeaderResponse extends DecoratingHeaderResponse
 			{
 				return strResponse;
 			}
+
+			@Override
+			public boolean wasRendered(Object object)
+			{
+				return FilteringHeaderResponse.this.getRealResponse().wasRendered(object);
+			}
+
+			@Override
+			public void markRendered(Object object)
+			{
+				FilteringHeaderResponse.this.getRealResponse().markRendered(object);
+			}
 		};
 
 		ResourceAggregator resourceAggregator = new ResourceAggregator(headerRenderer);
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/head/internal/HeaderResponse.java b/wicket-core/src/main/java/org/apache/wicket/markup/head/internal/HeaderResponse.java
index 1cc36986f9..aee2f8b390 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/head/internal/HeaderResponse.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/head/internal/HeaderResponse.java
@@ -48,7 +48,7 @@ public abstract class HeaderResponse implements IHeaderResponse
 	 * @see org.apache.wicket.markup.head.IHeaderResponse#markRendered(java.lang.Object)
 	 */
 	@Override
-	public final void markRendered(Object object)
+	public void markRendered(Object object)
 	{
 		Set<Object> rendered = getRenderedResources();
 		rendered.add(object);
@@ -86,7 +86,7 @@ public abstract class HeaderResponse implements IHeaderResponse
 	 * @see org.apache.wicket.markup.head.IHeaderResponse#wasRendered(java.lang.Object)
 	 */
 	@Override
-	public final boolean wasRendered(Object object)
+	public boolean wasRendered(Object object)
 	{
 		Set<Object> rendered = getRenderedResources();
 		return rendered.contains(object);
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteredHeaderPage.html b/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteredHeaderPage.html
new file mode 100644
index 0000000000..316fadc4f2
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteredHeaderPage.html
@@ -0,0 +1,5 @@
+<html xmlns:wicket="http://wicket.apache.org/dtds.data/wicket-xhtml1.4-strict.dtd" >
+    <body>
+    	<wicket:container wicket:id="footerJS"></wicket:container>
+    </body>
+</html>
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteredHeaderPage.java b/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteredHeaderPage.java
new file mode 100644
index 0000000000..e187cb5f47
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteredHeaderPage.java
@@ -0,0 +1,84 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.markup.head.filter;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import org.apache.wicket.markup.head.HeaderItem;
+import org.apache.wicket.markup.head.IHeaderResponse;
+import org.apache.wicket.markup.head.JavaScriptHeaderItem;
+import org.apache.wicket.markup.html.WebPage;
+import org.apache.wicket.request.mapper.parameter.PageParameters;
+import org.apache.wicket.request.resource.JavaScriptResourceReference;
+import org.apache.wicket.resource.JQueryPluginResourceReference;
+
+/**
+ * @author papegaaij
+ */
+public class FilteredHeaderPage extends WebPage
+{
+	private static final long serialVersionUID = 1L;
+
+	/**
+	 * Construct.
+	 * 
+	 * @param parameters
+	 */
+	public FilteredHeaderPage(final PageParameters parameters)
+	{
+		super(parameters);
+
+		/*
+		 * a container for all collected JavaScript contributions that will be loaded at the page
+		 * footer (after </body>)
+		 */
+		add(new HeaderResponseContainer("footerJS", "footerJS"));
+	}
+
+	@Override
+	public void renderHead(IHeaderResponse response)
+	{
+		// rendered at the default header bucket
+		final JavaScriptResourceReference topJsReference = new JavaScriptResourceReference(
+			FilteredHeaderPage.class, "top.js");
+		response.render(new FilteredHeaderItem(JavaScriptHeaderItem.forReference(topJsReference),
+			JavaScriptFilteredIntoFooterHeaderResponse.HEADER_FILTER_NAME));
+
+		// rendered at the bottom of the body bucket
+		JQueryPluginResourceReference bottomJs = new JQueryPluginResourceReference(
+			FilteredHeaderPage.class, "bottom.js")
+		{
+			private static final long serialVersionUID = 1L;
+
+			@Override
+			public Iterable<? extends HeaderItem> getDependencies()
+			{
+				Iterable<? extends HeaderItem> dependencies = super.getDependencies();
+				List<HeaderItem> deps = new ArrayList<HeaderItem>();
+				for (HeaderItem hi : dependencies)
+				{
+					deps.add(hi);
+				}
+				// WICKET-4566 : depend on a resource which is rendered in a different bucket
+				deps.add(JavaScriptHeaderItem.forReference(topJsReference));
+				return deps;
+			}
+		};
+		response.render(JavaScriptHeaderItem.forReference(bottomJs));
+	}
+}
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteredHeaderPageExpected.html b/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteredHeaderPageExpected.html
new file mode 100644
index 0000000000..837c9f4cee
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteredHeaderPageExpected.html
@@ -0,0 +1,8 @@
+<html xmlns:wicket="http://wicket.apache.org/dtds.data/wicket-xhtml1.4-strict.dtd" >
+    <head><script type="text/javascript" src="../resource/org.apache.wicket.markup.head.filter.FilteredHeaderPage/top.js"></script>
+</head><body>
+    	<script type="text/javascript" src="../resource/org.apache.wicket.resource.JQueryResourceReference/jquery/jquery.js"></script>
+<script type="text/javascript" src="../resource/org.apache.wicket.markup.head.filter.FilteredHeaderPage/bottom.js"></script>
+
+    </body>
+</html>
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteringHeaderResponseTest.java b/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteringHeaderResponseTest.java
index 9418d32531..ac373d55ef 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteringHeaderResponseTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/head/filter/FilteringHeaderResponseTest.java
@@ -31,16 +31,16 @@ import org.junit.Test;
 
 /**
  * Tests for FilteringHeaderResponse
- *
+ * 
  * @since 6.0
  */
-@Ignore
 public class FilteringHeaderResponseTest extends WicketTestCase
 {
 	@Override
 	protected WebApplication newApplication()
 	{
-		MockApplication application = new MockApplication() {
+		MockApplication application = new MockApplication()
+		{
 			@Override
 			protected void init()
 			{
@@ -56,23 +56,26 @@ public class FilteringHeaderResponseTest extends WicketTestCase
 				});
 			}
 		};
-		
+
 		return application;
 	}
 
 	/**
 	 * Tests using FilteredResponseContainer in <head>
-	 *
+	 * 
 	 * https://issues.apache.org/jira/browse/WICKET-4396
 	 */
 	@Test
+	@Ignore
 	public void filter()
 	{
 		HeaderFilteringPage page = new HeaderFilteringPage();
 		tester.startPage(page);
 	}
-	
-	private static class HeaderFilteringPage extends WebPage implements IMarkupResourceStreamProvider
+
+	private static class HeaderFilteringPage extends WebPage
+		implements
+			IMarkupResourceStreamProvider
 	{
 		private HeaderFilteringPage()
 		{
@@ -80,9 +83,27 @@ public class FilteringHeaderResponseTest extends WicketTestCase
 		}
 
 		@Override
-		public IResourceStream getMarkupResourceStream(MarkupContainer container, Class<?> containerClass)
+		public IResourceStream getMarkupResourceStream(MarkupContainer container,
+			Class<?> containerClass)
 		{
-			return new StringResourceStream("<html><head><wicket:container wicket:id='headerJS'/></head></html>");
+			return new StringResourceStream(
+				"<html><head><wicket:container wicket:id='headerJS'/></head></html>");
 		}
 	}
+
+	@Test
+	public void footerDependsOnHeadItem() throws Exception
+	{
+		tester.getApplication().setHeaderResponseDecorator(new IHeaderResponseDecorator()
+		{
+
+			public IHeaderResponse decorate(IHeaderResponse response)
+			{
+				// use this header resource decorator to load all JavaScript resources in the page
+				// footer (after </body>)
+				return new JavaScriptFilteredIntoFooterHeaderResponse(response, "footerJS");
+			}
+		});
+		executeTest(FilteredHeaderPage.class, "FilteredHeaderPageExpected.html");
+	}
 }
