diff --git a/wicket-core/src/main/java/org/apache/wicket/Component.java b/wicket-core/src/main/java/org/apache/wicket/Component.java
index f94cf41533..7a3df6abe9 100644
--- a/wicket-core/src/main/java/org/apache/wicket/Component.java
+++ b/wicket-core/src/main/java/org/apache/wicket/Component.java
@@ -2956,6 +2956,12 @@ public abstract class Component
 			if (model != null)
 			{
 				data_set(0, model);
+				// WICKET-3413 reset 'inherited model' flag if model changed
+				// and a new one is not IComponentInheritedModel
+				if (getFlag(FLAG_INHERITABLE_MODEL) && !(model instanceof IComponentInheritedModel))
+				{
+					setFlag(FLAG_INHERITABLE_MODEL, false);
+				}
 			}
 			else
 			{
diff --git a/wicket-core/src/test/java/org/apache/wicket/model/InheritedModelTest.java b/wicket-core/src/test/java/org/apache/wicket/model/InheritedModelTest.java
index 120892e1c1..d6b90003cc 100644
--- a/wicket-core/src/test/java/org/apache/wicket/model/InheritedModelTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/model/InheritedModelTest.java
@@ -73,4 +73,31 @@ public class InheritedModelTest extends WicketTestCase
 		data2.put("label", "foo");
 		assertEquals("foo", label.getDefaultModelObject());
 	}
+
+	/**
+	 * Tests if Component#FLAG_INHERITABLE_MODEL reset after model change (WICKET-3413).
+	 */
+	public void testResetInheritedModelFlag()
+	{
+		ValueMap data1 = new ValueMap();
+		data1.put("label", "foo");
+
+		ValueMap data2 = new ValueMap();
+		data2.put("value", "bar");
+
+		InheritedTestPage page = new InheritedTestPage();
+
+		page.setDefaultModel(new CompoundPropertyModel(data1));
+		tester.startPage(page);
+		assertEquals("foo", page.label.getDefaultModelObject());
+
+		page.label.setDefaultModel(new PropertyModel(data2, "value"));
+		tester.startPage(page);
+		assertEquals("bar", page.label.getDefaultModelObject());
+
+		page.detach();
+
+		tester.startPage(page);
+		assertEquals("bar", page.label.getDefaultModelObject());
+	}
 }
