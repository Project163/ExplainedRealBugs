diff --git a/wicket-core/src/main/java/org/apache/wicket/util/cookies/CookieUtils.java b/wicket-core/src/main/java/org/apache/wicket/util/cookies/CookieUtils.java
index caf6720d42..a3cfcf6cb5 100644
--- a/wicket-core/src/main/java/org/apache/wicket/util/cookies/CookieUtils.java
+++ b/wicket-core/src/main/java/org/apache/wicket/util/cookies/CookieUtils.java
@@ -20,6 +20,7 @@ import javax.servlet.http.Cookie;
 
 import org.apache.wicket.markup.html.form.FormComponent;
 import org.apache.wicket.protocol.http.servlet.ServletWebRequest;
+import org.apache.wicket.request.Response;
 import org.apache.wicket.request.cycle.RequestCycle;
 import org.apache.wicket.request.http.WebRequest;
 import org.apache.wicket.request.http.WebResponse;
@@ -333,7 +334,13 @@ public class CookieUtils
 	 */
 	private WebResponse getWebResponse()
 	{
-		return (WebResponse)RequestCycle.get().getOriginalResponse();
+		RequestCycle cycle = RequestCycle.get();
+		Response response = cycle.getResponse();
+		if (!(response instanceof WebResponse))
+		{
+			response = cycle.getOriginalResponse();
+		}
+		return (WebResponse)response;
 	}
 
 	/**
