diff --git a/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java b/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java
index c8ee07bf16..c0aaa7de97 100644
--- a/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java
+++ b/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java
@@ -358,6 +358,20 @@ public class BaseWicketTester
 	{
 		request = new MockHttpServletRequest(application, httpSession, servletContext);
 		request.setURL(request.getContextPath() + request.getServletPath() + "/");
+
+		// assign protocol://host:port to next request unless the last request was ajax
+		final boolean assignBaseLocation =
+			lastRequest != null && lastRequest.getHeader("Wicket-Ajax") == null;
+
+		// resume request processing with scheme://host:port from last request
+		if (assignBaseLocation)
+		{
+			request.setScheme(lastRequest.getScheme());
+			request.setSecure(lastRequest.isSecure());
+			request.setServerName(lastRequest.getServerName());
+			request.setServerPort(lastRequest.getServerPort());
+		}
+		
 		response = new MockHttpServletResponse(request);
 
 		ServletWebRequest servletWebRequest = newServletWebRequest();
diff --git a/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsMapperApplicationTest.java b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsMapperApplicationTest.java
index 5f97e8d8bc..fdae7a773a 100644
--- a/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsMapperApplicationTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsMapperApplicationTest.java
@@ -115,4 +115,18 @@ public class HttpsMapperApplicationTest
 		assertEquals("https", tester.getLastRequest().getScheme());
 		assertEquals(456, tester.getLastRequest().getServerPort());
 	}
+
+	@Test
+	public void testProtocolSwitchForNextRequest()
+	{
+		WicketTester tester = new WicketTester(new HttpsMapperApplication());
+
+		requestPage(tester, HttpsPage.class);
+
+		assertEquals("https", tester.getLastRequest().getScheme());
+		assertEquals(443, tester.getLastRequest().getServerPort());
+		
+		assertEquals("https", tester.getRequest().getScheme());
+		assertEquals(443, tester.getRequest().getServerPort());
+	}
 }
