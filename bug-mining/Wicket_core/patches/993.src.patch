diff --git a/wicket-core/src/main/java/org/apache/wicket/ajax/json/JsonUtils.java b/wicket-core/src/main/java/org/apache/wicket/ajax/json/JsonUtils.java
index f4b8a9b062..ece4997152 100644
--- a/wicket-core/src/main/java/org/apache/wicket/ajax/json/JsonUtils.java
+++ b/wicket-core/src/main/java/org/apache/wicket/ajax/json/JsonUtils.java
@@ -58,23 +58,23 @@ public final class JsonUtils
 						}
 					}
 				}
-				else if (value.getClass().isArray())
+				else if (value != null)
 				{
-					Object[] array = (Object[]) value;
-					for (Object v : array)
+					if (value.getClass().isArray())
 					{
-						if (v != null)
+						Object[] array = (Object[]) value;
+						for (Object v : array)
 						{
-							JSONObject object = new JSONObject();
-							object.put("name", name);
-							object.put("value", v);
-							jsonArray.put(object);
+							if (v != null)
+							{
+								JSONObject object = new JSONObject();
+								object.put("name", name);
+								object.put("value", v);
+								jsonArray.put(object);
+							}
 						}
 					}
-				}
-				else
-				{
-					if (value != null)
+					else
 					{
 						JSONObject object = new JSONObject();
 						object.put("name", name);
diff --git a/wicket-core/src/test/java/org/apache/wicket/ajax/json/JsonUtilsTest.java b/wicket-core/src/test/java/org/apache/wicket/ajax/json/JsonUtilsTest.java
index f127c34ca3..b78003bcfd 100644
--- a/wicket-core/src/test/java/org/apache/wicket/ajax/json/JsonUtilsTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/ajax/json/JsonUtilsTest.java
@@ -56,5 +56,11 @@ public class JsonUtilsTest extends Assert
 		Object[] arrayValues = {"arrayValue", 3, null, true};
 		map.put("array", arrayValues);
 		assertEquals("[{\"name\":\"array\",\"value\":\"arrayValue\"},{\"name\":\"array\",\"value\":3},{\"name\":\"array\",\"value\":true}]", JsonUtils.asArray(map).toString());
+
+		map.clear();
+		map.put("null", null);
+		assertEquals("[]", JsonUtils.asArray(map).toString());
+		map.put("notNull", "notNull");
+		assertEquals("[{\"name\":\"notNull\",\"value\":\"notNull\"}]", JsonUtils.asArray(map).toString());
 	}
 }
