diff --git a/wicket-core/src/test/java/org/apache/wicket/request/cycle/UrlRendererTest.java b/wicket-core/src/test/java/org/apache/wicket/request/cycle/UrlRendererTest.java
index 1f3cc56542..c706593f9c 100644
--- a/wicket-core/src/test/java/org/apache/wicket/request/cycle/UrlRendererTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/request/cycle/UrlRendererTest.java
@@ -174,9 +174,9 @@ public class UrlRendererTest extends Assert
 	}
 
 	/**
-	 * Verify that absolute urls are rendered as is, ignoring
-	 * the current client url and base url completely.
-	 *
+	 * Verify that absolute urls are rendered as is, ignoring the current client url and base url
+	 * completely.
+	 * 
 	 * https://issues.apache.org/jira/browse/WICKET-4466
 	 */
 	@Test
@@ -214,7 +214,8 @@ public class UrlRendererTest extends Assert
 		baseUrl.setPort(8888);
 		UrlRenderer renderer = new UrlRenderer(new MockWebRequest(baseUrl));
 		renderer.setBaseUrl(baseUrl); // this is needed because MockWebRequest cuts data
-		String fullUrl = renderer.renderFullUrl(Url.parse("/four")); // url starting with slash is considered absolute
+		String fullUrl = renderer.renderFullUrl(Url.parse("/four")); // url starting with slash is
+// considered absolute
 		assertEquals("http://www.example.com:8888/four", fullUrl);
 	}
 
@@ -302,6 +303,21 @@ public class UrlRendererTest extends Assert
 		assertEquals("../../b;jsessionid=123456", encodedRelativeUrl);
 	}
 
+	@Test
+	public void renderFullUrlAsRelativeToBaseUrlWithoutComposedContextAndFilterPaths()
+	{
+		Url baseUrl = Url.parse("a/b/c/d"); // base url without context path and filter path
+		Url encodedFullUrl = Url.parse("http://host:8080/context/path/filter/path/a/b;jsessionid=123456");
+
+		MockWebRequest request = new MockWebRequest(baseUrl);
+		request.setContextPath("context/path");
+		request.setFilterPath("filter/path");
+		UrlRenderer renderer = new UrlRenderer(request);
+		String encodedRelativeUrl = renderer.renderRelativeUrl(encodedFullUrl);
+
+		assertEquals("../../b;jsessionid=123456", encodedRelativeUrl);
+	}
+
 	@Test
 	public void renderFullUrlAsRelativeToBaseUrlWithoutContextPath()
 	{
@@ -309,7 +325,6 @@ public class UrlRendererTest extends Assert
 		Url encodedFullUrl = Url.parse("http://host:8080/filterPath/a/b;jsessionid=123456");
 
 		MockWebRequest request = new MockWebRequest(baseUrl);
-		request.setContextPath("contextPath");
 		request.setFilterPath("filterPath");
 		UrlRenderer renderer = new UrlRenderer(request);
 		String encodedRelativeUrl = renderer.renderRelativeUrl(encodedFullUrl);
@@ -317,6 +332,20 @@ public class UrlRendererTest extends Assert
 		assertEquals("../../b;jsessionid=123456", encodedRelativeUrl);
 	}
 
+	@Test
+	public void renderFullUrlAsRelativeToBaseUrlWithoutComposedContextPath()
+	{
+		Url baseUrl = Url.parse("a/b/c/d"); // base url without context path and filter path
+		Url encodedFullUrl = Url.parse("http://host:8080/filter/path/a/b;jsessionid=123456");
+
+		MockWebRequest request = new MockWebRequest(baseUrl);
+		request.setFilterPath("filter/path");
+		UrlRenderer renderer = new UrlRenderer(request);
+		String encodedRelativeUrl = renderer.renderRelativeUrl(encodedFullUrl);
+
+		assertEquals("../../b;jsessionid=123456", encodedRelativeUrl);
+	}
+
 	@Test
 	public void renderFullUrlAsRelativeToBaseUrlWithoutFilterPath()
 	{
@@ -325,7 +354,20 @@ public class UrlRendererTest extends Assert
 
 		MockWebRequest request = new MockWebRequest(baseUrl);
 		request.setContextPath("contextPath");
-		request.setFilterPath("filterPath");
+		UrlRenderer renderer = new UrlRenderer(request);
+		String encodedRelativeUrl = renderer.renderRelativeUrl(encodedFullUrl);
+
+		assertEquals("../../b;jsessionid=123456", encodedRelativeUrl);
+	}
+
+	@Test
+	public void renderFullUrlAsRelativeToBaseUrlWithoutComposedFilterPath()
+	{
+		Url baseUrl = Url.parse("a/b/c/d"); // base url without context path and filter path
+		Url encodedFullUrl = Url.parse("http://host:8080/context/path/a/b;jsessionid=123456");
+
+		MockWebRequest request = new MockWebRequest(baseUrl);
+		request.setContextPath("context/path");
 		UrlRenderer renderer = new UrlRenderer(request);
 		String encodedRelativeUrl = renderer.renderRelativeUrl(encodedFullUrl);
 
@@ -344,7 +386,6 @@ public class UrlRendererTest extends Assert
 
 		MockWebRequest request = new MockWebRequest(baseUrl);
 		request.setContextPath("contextPath");
-		request.setFilterPath("filterPath");
 		UrlRenderer renderer = new UrlRenderer(request);
 		String encodedRelativeUrl = renderer.renderRelativeUrl(encodedFullUrl);
 
@@ -377,11 +418,10 @@ public class UrlRendererTest extends Assert
 		// 'filterPath' here is a normal segment with the same value
 		Url baseUrl = Url.parse("filterPath/a/b/c/d");
 
-		// here 'contextPath' is the actual context path and should be ignored
+		// here 'filterPath' is the actual filter path and should be ignored
 		Url encodedFullUrl = Url.parse("http://host:8080/filterPath/a/b;jsessionid=123456");
 
 		MockWebRequest request = new MockWebRequest(baseUrl);
-		request.setContextPath("contextPath");
 		request.setFilterPath("filterPath");
 		UrlRenderer renderer = new UrlRenderer(request);
 		String encodedRelativeUrl = renderer.renderRelativeUrl(encodedFullUrl);
