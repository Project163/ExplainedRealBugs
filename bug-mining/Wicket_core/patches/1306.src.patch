diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/html/form/Form.java b/wicket-core/src/main/java/org/apache/wicket/markup/html/form/Form.java
index 701576ae6b..a711c377f2 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/html/form/Form.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/html/form/Form.java
@@ -35,6 +35,7 @@ import org.apache.wicket.Page;
 import org.apache.wicket.WicketRuntimeException;
 import org.apache.wicket.ajax.AjaxRequestTarget;
 import org.apache.wicket.behavior.Behavior;
+import org.apache.wicket.event.IEvent;
 import org.apache.wicket.markup.ComponentTag;
 import org.apache.wicket.markup.MarkupStream;
 import org.apache.wicket.markup.head.IHeaderResponse;
@@ -296,7 +297,13 @@ public class Form<T> extends WebMarkupContainer
 	 * The form has discovered a multipart component before rendering and is marking itself as
 	 * multipart until next render
 	 */
-	private static final short MULTIPART_HINT = 0x02;
+	private static final short MULTIPART_HINT_YES = 0x02;
+
+	/**
+	 * The form has discovered no multipart component before rendering and is marking itself as
+	 * not multipart until next render
+	 */
+	private static final short MULTIPART_HINT_NO = 0x04;
 
 	/**
 	 * Constructs a form with no validation.
@@ -1361,50 +1368,48 @@ public class Form<T> extends WebMarkupContainer
 	 */
 	public boolean isMultiPart()
 	{
-		if (multiPart != 0)
+		if (multiPart == 0)
 		{
-			return true;
-		}
-
-		Boolean anyEmbeddedMultipart = visitChildren(Component.class,
-			new IVisitor<Component, Boolean>()
-			{
-				@Override
-				public void component(final Component component, final IVisit<Boolean> visit)
-				{
-					boolean isMultiPart = false;
-					if (component instanceof Form<?>)
+			Boolean anyEmbeddedMultipart = visitChildren(Component.class,
+					new IVisitor<Component, Boolean>()
 					{
-						Form<?> form = (Form<?>)component;
-						if (form.isVisibleInHierarchy() && form.isEnabledInHierarchy())
+						@Override
+						public void component(final Component component, final IVisit<Boolean> visit)
 						{
-							isMultiPart = (form.multiPart != 0);
-						}
-					}
-					else if (component instanceof FormComponent<?>)
-					{
-						FormComponent<?> fc = (FormComponent<?>)component;
-						if (fc.isVisibleInHierarchy() && fc.isEnabledInHierarchy())
-						{
-							isMultiPart = fc.isMultiPart();
-						}
-					}
-
-					if (isMultiPart)
-					{
-						visit.stop(true);
-					}
-				}
-
-			});
+							boolean isMultiPart = false;
+							if (component instanceof Form<?>)
+							{
+								Form<?> form = (Form<?>)component;
+								if (form.isVisibleInHierarchy() && form.isEnabledInHierarchy())
+								{
+									isMultiPart = (form.multiPart & MULTIPART_HARD) != 0;
+								}
+							}
+							else if (component instanceof FormComponent<?>)
+							{
+								FormComponent<?> fc = (FormComponent<?>)component;
+								if (fc.isVisibleInHierarchy() && fc.isEnabledInHierarchy())
+								{
+									isMultiPart = fc.isMultiPart();
+								}
+							}
 
-		boolean mp = Boolean.TRUE.equals(anyEmbeddedMultipart);
+							if (isMultiPart)
+							{
+								visit.stop(true);
+							}
+						}
 
-		if (mp)
-		{
-			multiPart |= MULTIPART_HINT;
+					});
+			
+			if (Boolean.TRUE.equals(anyEmbeddedMultipart)) {
+				multiPart |= MULTIPART_HINT_YES;
+			} else {
+				multiPart |= MULTIPART_HINT_NO;
+			}
 		}
-		return mp;
+
+		return (multiPart & (MULTIPART_HARD | MULTIPART_HINT_YES)) != 0;
 	}
 
 	/**
@@ -1798,11 +1803,19 @@ public class Form<T> extends WebMarkupContainer
 	{
 	}
 
+	@Override
+	public void onEvent(IEvent<?> event) {
+		if (event.getPayload() instanceof AjaxRequestTarget) {
+			// WICKET-6171 clear multipart hint, it might change during Ajax requests without this form being rendered
+			this.multiPart &= MULTIPART_HARD;
+		}
+	}
+	
 	@Override
 	protected void onBeforeRender()
 	{
-		// clear multipart hint, it will be set if necessary by the visitor
-		this.multiPart &= ~MULTIPART_HINT;
+		// clear multipart hint, it will be reevaluated by #isMultiPart()
+		this.multiPart &= MULTIPART_HARD;
 
 		super.onBeforeRender();
 	}
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/form/FormMultiPartTest.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/form/FormMultiPartTest.java
new file mode 100644
index 0000000000..cb8effbbcd
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/form/FormMultiPartTest.java
@@ -0,0 +1,81 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.markup.html.form;
+
+import org.apache.wicket.util.tester.WicketTestCase;
+import org.junit.Test;
+
+/**
+ */
+public class FormMultiPartTest extends WicketTestCase
+{
+	
+	@Test
+	public void multipartHard()
+	{
+		MultiPartFormPage page = new MultiPartFormPage();
+		
+		page.form.setMultiPart(true);
+		tester.startPage(page);
+
+		assertEquals(0, page.asked);
+
+		assertEquals(true, page.form.isMultiPart());
+	}
+
+	@Test
+	public void multipartHint()
+	{
+		MultiPartFormPage page = new MultiPartFormPage();
+
+		page.multiPart = false;
+		tester.startPage(page);
+		assertEquals(1, page.asked);
+		assertEquals(false, page.form.isMultiPart());
+		
+		page.multiPart = true;
+		tester.newFormTester("form").submit(page.button1);
+		assertEquals(2, page.asked);
+		assertEquals(true, page.form.isMultiPart());
+		
+		page.multiPart = false;
+		tester.newFormTester("form").submit(page.button1);
+		assertEquals(3, page.asked);
+		assertEquals(false, page.form.isMultiPart());		
+	}
+	
+	@Test
+	public void multipartHintAjax()
+	{
+		MultiPartFormPage page = new MultiPartFormPage();
+
+		page.multiPart = false;
+		tester.startPage(page);
+		assertEquals(1, page.asked);
+		assertEquals(false, page.form.isMultiPart());
+		
+		page.multiPart = true;
+		tester.executeAjaxEvent(page.button1, "click");
+		assertEquals(2, page.asked);
+		assertEquals(true, page.form.isMultiPart());
+		
+		page.multiPart = false;
+		tester.executeAjaxEvent(page.button1, "click");
+		assertEquals(3, page.asked);
+		assertEquals(false, page.form.isMultiPart());		
+	}
+}
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/form/MultiPartFormPage.html b/wicket-core/src/test/java/org/apache/wicket/markup/html/form/MultiPartFormPage.html
new file mode 100644
index 0000000000..fafc541ee5
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/form/MultiPartFormPage.html
@@ -0,0 +1,10 @@
+<html>
+<body>
+	<form wicket:id="form">
+		<input wicket:id="input" />
+		
+		<input type="button" wicket:id="button1" />
+		<input type="button" wicket:id="button2" />
+	</form>
+</body>
+</html>
\ No newline at end of file
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/form/MultiPartFormPage.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/form/MultiPartFormPage.java
new file mode 100644
index 0000000000..c8c1c74a3e
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/form/MultiPartFormPage.java
@@ -0,0 +1,83 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.markup.html.form;
+
+import java.util.Optional;
+
+import org.apache.wicket.ajax.AjaxRequestTarget;
+import org.apache.wicket.ajax.markup.html.form.AjaxFallbackButton;
+import org.apache.wicket.markup.html.WebPage;
+import org.apache.wicket.model.Model;
+
+/**
+ */
+public class MultiPartFormPage extends WebPage
+{
+	private static final long serialVersionUID = 1L;
+	
+	public boolean multiPart;
+	
+	public int asked = 0;
+
+	public Form<?> form;
+
+	private TextField<String> input;
+
+	public AjaxFallbackButton button1;
+
+	public AjaxFallbackButton button2;
+
+	/**
+	 * Construct.
+	 */
+	public MultiPartFormPage()
+	{
+		form = new Form<Void>("form");
+		add(form.setOutputMarkupId(true));
+		
+		input = new TextField<String>("input", Model.of(""))
+		{
+			@Override
+			public boolean isMultiPart() {
+				asked++;
+				
+				return multiPart;
+			}
+		};
+		form.add(input);
+		
+		button1 = new AjaxFallbackButton("button1", null)
+		{
+			@Override
+			protected void onSubmit(Optional<AjaxRequestTarget> target, Form<?> form)
+			{
+				target.ifPresent(t -> t.add(this));
+			}
+		};
+		form.add(button1);
+		
+		button2 = new AjaxFallbackButton("button2", null)
+		{
+			@Override
+			protected void onSubmit(Optional<AjaxRequestTarget> target, Form<?> form)
+			{
+				target.ifPresent(t -> t.add(this));
+			}
+		};
+		form.add(button2);
+	}
+}
\ No newline at end of file
