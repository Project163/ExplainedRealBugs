diff --git a/wicket-core/src/main/java/org/apache/wicket/ComponentSourceEntry.java b/wicket-core/src/main/java/org/apache/wicket/ComponentSourceEntry.java
index ffdfa40e78..f0621940d3 100644
--- a/wicket-core/src/main/java/org/apache/wicket/ComponentSourceEntry.java
+++ b/wicket-core/src/main/java/org/apache/wicket/ComponentSourceEntry.java
@@ -214,12 +214,10 @@ abstract class ComponentSourceEntry implements IClusterable
 
 		final String id = parts[0];
 		final Object markupId;
-		final int markupIndex;
 
 		if (parts.length == 2)
 		{
 			markupId = null;
-			markupIndex = Integer.parseInt(parts[1]);
 		}
 		else if (parts.length == 3)
 		{
@@ -232,7 +230,6 @@ abstract class ComponentSourceEntry implements IClusterable
 			{
 				markupId = parts[1];
 			}
-			markupIndex = Integer.parseInt(parts[2]);
 		}
 		else
 		{
diff --git a/wicket-core/src/main/java/org/apache/wicket/ConverterLocator.java b/wicket-core/src/main/java/org/apache/wicket/ConverterLocator.java
index 2ef939cc97..eed93a0d78 100644
--- a/wicket-core/src/main/java/org/apache/wicket/ConverterLocator.java
+++ b/wicket-core/src/main/java/org/apache/wicket/ConverterLocator.java
@@ -56,11 +56,11 @@ public class ConverterLocator implements IConverterLocator
 	/**
 	 * CoverterLocator that is to be used when no registered converter is found.
 	 */
-	private class DefaultConverter<C> implements IConverter<C>
+	private static class DefaultConverter<C> implements IConverter<C>
 	{
 		private static final long serialVersionUID = 1L;
 
-		private final WeakReference<Class<C>> type;
+		private final transient WeakReference<Class<C>> type;
 
 		/**
 		 * Construct.
diff --git a/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java b/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java
index a077d5faa1..422dc3f075 100644
--- a/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java
+++ b/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java
@@ -1044,7 +1044,7 @@ public abstract class MarkupContainer extends Component implements Iterable<Comp
 			}
 			else
 			{
-				Object[] children = null;
+				Object[] children;
 				if (this.children instanceof ChildList)
 				{
 					// we have a list
@@ -1113,7 +1113,7 @@ public abstract class MarkupContainer extends Component implements Iterable<Comp
 		}
 		else
 		{
-			Object[] children = null;
+			Object[] children;
 			int size = 0;
 			if (this.children instanceof ChildList)
 			{
diff --git a/wicket-core/src/main/java/org/apache/wicket/Page.java b/wicket-core/src/main/java/org/apache/wicket/Page.java
index a19874558b..6dfafa4ab1 100644
--- a/wicket-core/src/main/java/org/apache/wicket/Page.java
+++ b/wicket-core/src/main/java/org/apache/wicket/Page.java
@@ -600,7 +600,7 @@ public abstract class Page extends MarkupContainer
 			{
 				stateless = Boolean.TRUE;
 			}
-			else if (returnValue instanceof Boolean)
+			else
 			{
 				stateless = returnValue;
 			}
diff --git a/wicket-core/src/main/java/org/apache/wicket/authorization/strategies/CompoundAuthorizationStrategy.java b/wicket-core/src/main/java/org/apache/wicket/authorization/strategies/CompoundAuthorizationStrategy.java
index 32247cc3c1..b65e82a75d 100644
--- a/wicket-core/src/main/java/org/apache/wicket/authorization/strategies/CompoundAuthorizationStrategy.java
+++ b/wicket-core/src/main/java/org/apache/wicket/authorization/strategies/CompoundAuthorizationStrategy.java
@@ -57,7 +57,6 @@ public class CompoundAuthorizationStrategy implements IAuthorizationStrategy
 	public final <T extends IRequestableComponent> boolean isInstantiationAuthorized(
 		Class<T> componentClass)
 	{
-		int size = strategies.size();
 		for (IAuthorizationStrategy strategy : strategies)
 		{
 			if (!strategy.isInstantiationAuthorized(componentClass))
diff --git a/wicket-core/src/main/java/org/apache/wicket/authorization/strategies/page/AbstractPageAuthorizationStrategy.java b/wicket-core/src/main/java/org/apache/wicket/authorization/strategies/page/AbstractPageAuthorizationStrategy.java
index c0143d1ffa..3c88f5bf7f 100644
--- a/wicket-core/src/main/java/org/apache/wicket/authorization/strategies/page/AbstractPageAuthorizationStrategy.java
+++ b/wicket-core/src/main/java/org/apache/wicket/authorization/strategies/page/AbstractPageAuthorizationStrategy.java
@@ -67,7 +67,7 @@ public abstract class AbstractPageAuthorizationStrategy implements IAuthorizatio
 	 */
 	protected boolean instanceOf(final Class<?> type, final Class<?> superType)
 	{
-		return superType.isAssignableFrom(type);
+		return superType != null && superType.isAssignableFrom(type);
 	}
 
 	/**
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/ContainerInfo.java b/wicket-core/src/main/java/org/apache/wicket/markup/ContainerInfo.java
index 8fa18b575c..ed634e653d 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/ContainerInfo.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/ContainerInfo.java
@@ -120,6 +120,8 @@ public class ContainerInfo
 	@Override
 	public String toString()
 	{
-		return containerClassRef.get().getName() + ":" + locale + ":" + style + ":" + fileExtension;
+		Class<?> classRef = containerClassRef.get();
+		return (classRef != null ? classRef.getName() : "null class") + ":" + locale + ":" + style +
+			":" + fileExtension;
 	}
 }
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/MarkupCache.java b/wicket-core/src/main/java/org/apache/wicket/markup/MarkupCache.java
index 9d05d6f9ba..c66210c565 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/MarkupCache.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/MarkupCache.java
@@ -237,7 +237,8 @@ public class MarkupCache implements IMarkupCache
 	 * I still don't like this method being part of the API but I didn't find a suitable other
 	 * solution.
 	 * 
-	 * @see org.apache.wicket.markup.IMarkupCache#getMarkup(org.apache.wicket.MarkupContainer, Class, boolean)
+	 * @see org.apache.wicket.markup.IMarkupCache#getMarkup(org.apache.wicket.MarkupContainer,
+	 *      Class, boolean)
 	 */
 	public final Markup getMarkup(final MarkupContainer container, final Class<?> clazz,
 		final boolean enforceReload)
@@ -598,7 +599,7 @@ public class MarkupCache implements IMarkupCache
 	 * @param <K>
 	 * @param <V>
 	 */
-	public class DefaultCacheImplementation<K, V> implements ICache<K, V>
+	public static class DefaultCacheImplementation<K, V> implements ICache<K, V>
 	{
 		private final ConcurrentHashMap<K, V> cache = new ConcurrentHashMap<K, V>();
 
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/MarkupResourceStream.java b/wicket-core/src/main/java/org/apache/wicket/markup/MarkupResourceStream.java
index 34280d25c2..f7627c1c4a 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/MarkupResourceStream.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/MarkupResourceStream.java
@@ -51,7 +51,7 @@ public class MarkupResourceStream implements IResourceStream, IFixedLocationReso
 	private final IResourceStream resourceStream;
 
 	/** Container info like Class, locale and style which were used to locate the resource */
-	private final ContainerInfo containerInfo;
+	private final transient ContainerInfo containerInfo;
 
 	/**
 	 * The actual component class the markup is directly associated with. It might be super class of
@@ -63,7 +63,7 @@ public class MarkupResourceStream implements IResourceStream, IFixedLocationReso
 	private String cacheKey;
 
 	/** In case of the inherited markup, this is the base markup */
-	private Markup baseMarkup;
+	private transient Markup baseMarkup;
 
 	/** If found in the markup, the <?xml ...?> string */
 	private CharSequence xmlDeclaration;
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/RawMarkup.java b/wicket-core/src/main/java/org/apache/wicket/markup/RawMarkup.java
index aed234bbef..15d2073a7d 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/RawMarkup.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/RawMarkup.java
@@ -50,7 +50,7 @@ public final class RawMarkup extends MarkupElement
 	@Override
 	public boolean equals(final Object o)
 	{
-		if (o instanceof String)
+		if (o instanceof CharSequence)
 		{
 			return string.equals(o);
 		}
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/html/link/DownloadLink.java b/wicket-core/src/main/java/org/apache/wicket/markup/html/link/DownloadLink.java
index 3cd7ccc2b7..df4110dae4 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/html/link/DownloadLink.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/html/link/DownloadLink.java
@@ -24,6 +24,7 @@ import org.apache.wicket.request.IRequestCycle;
 import org.apache.wicket.request.UrlEncoder;
 import org.apache.wicket.request.handler.resource.ResourceStreamRequestHandler;
 import org.apache.wicket.request.resource.ContentDisposition;
+import org.apache.wicket.util.file.Files;
 import org.apache.wicket.util.resource.FileResourceStream;
 import org.apache.wicket.util.resource.IResourceStream;
 import org.apache.wicket.util.string.Strings;
@@ -141,8 +142,8 @@ public class DownloadLink extends Link<File>
 			throw new IllegalStateException(getClass().getName() +
 				" failed to retrieve a File object from model");
 		}
-		final String fn = UrlEncoder.QUERY_INSTANCE.encode((fileName != null) ? fileName
-			: file.getName(), getRequest().getCharset());
+		final String fn = UrlEncoder.QUERY_INSTANCE.encode(
+			(fileName != null) ? fileName : file.getName(), getRequest().getCharset());
 
 
 		IResourceStream resourceStream = new FileResourceStream(
@@ -157,7 +158,7 @@ public class DownloadLink extends Link<File>
 
 					if (deleteAfter)
 					{
-						file.delete();
+						Files.remove(file);
 					}
 				}
 			}.setFileName(fn).setContentDisposition(ContentDisposition.ATTACHMENT));
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/html/pages/BrowserInfoForm.java b/wicket-core/src/main/java/org/apache/wicket/markup/html/pages/BrowserInfoForm.java
index 6b5b8eef0a..38dd73097b 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/html/pages/BrowserInfoForm.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/html/pages/BrowserInfoForm.java
@@ -64,7 +64,7 @@ public class BrowserInfoForm extends Panel
 
 				RequestCycle requestCycle = getRequestCycle();
 				WebSession session = (WebSession)getSession();
-				ClientInfo clientInfo = session.getClientInfo();
+				WebClientInfo clientInfo = session.getClientInfo();
 
 				if (clientInfo == null)
 				{
@@ -72,16 +72,8 @@ public class BrowserInfoForm extends Panel
 					getSession().setClientInfo(clientInfo);
 				}
 
-				if (clientInfo instanceof WebClientInfo)
-				{
-					WebClientInfo info = (WebClientInfo)clientInfo;
-					ClientProperties properties = info.getProperties();
-					propertiesBean.merge(properties);
-				}
-				else
-				{
-					warnNotUsingWebClientInfo(clientInfo);
-				}
+				ClientProperties properties = clientInfo.getProperties();
+				propertiesBean.merge(properties);
 
 				afterSubmit();
 			}
@@ -289,6 +281,16 @@ public class BrowserInfoForm extends Panel
 			return utcOffset;
 		}
 
+		/**
+		 * Gets utcDSTOffset.
+		 * 
+		 * @return utcOffset
+		 */
+		public String getUtcDSTOffset()
+		{
+			return utcDSTOffset;
+		}
+
 		/**
 		 * Merge this with the given properties object.
 		 * 
@@ -300,7 +302,8 @@ public class BrowserInfoForm extends Panel
 			properties.setNavigatorAppName(navigatorAppName);
 			properties.setNavigatorAppVersion(navigatorAppVersion);
 			properties.setNavigatorAppCodeName(navigatorAppCodeName);
-			properties.setCookiesEnabled((navigatorCookieEnabled != null) ? navigatorCookieEnabled : false);
+			properties.setCookiesEnabled((navigatorCookieEnabled != null) ? navigatorCookieEnabled
+				: false);
 			properties.setJavaEnabled((navigatorJavaEnabled != null) ? navigatorJavaEnabled : false);
 			properties.setNavigatorLanguage(navigatorLanguage);
 			properties.setNavigatorPlatform(navigatorPlatform);
@@ -486,6 +489,17 @@ public class BrowserInfoForm extends Panel
 			this.utcOffset = utcOffset;
 		}
 
+		/**
+		 * Sets utcDSTOffset.
+		 * 
+		 * @param utcDSTOffset
+		 *            utcDSTOffset
+		 */
+		public void setUtcDSTOffset(String utcDSTOffset)
+		{
+			this.utcDSTOffset = utcDSTOffset;
+		}
+
 		private int getInt(String value)
 		{
 			int intValue = -1;
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/html/pages/BrowserInfoPage.java b/wicket-core/src/main/java/org/apache/wicket/markup/html/pages/BrowserInfoPage.java
index 675e64c7e5..5e5023401e 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/html/pages/BrowserInfoPage.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/html/pages/BrowserInfoPage.java
@@ -77,21 +77,16 @@ public class BrowserInfoPage extends WebPage
 		initComps();
 		RequestCycle requestCycle = getRequestCycle();
 		WebSession session = (WebSession)getSession();
-		ClientInfo clientInfo = session.getClientInfo();
+		WebClientInfo clientInfo = session.getClientInfo();
 		if (clientInfo == null)
 		{
 			clientInfo = new WebClientInfo(requestCycle);
 			getSession().setClientInfo(clientInfo);
 		}
-		else if (clientInfo instanceof WebClientInfo)
-		{
-			WebClientInfo info = (WebClientInfo)clientInfo;
-			ClientProperties properties = info.getProperties();
-			properties.setJavaEnabled(false);
-		}
 		else
 		{
-			warnNotUsingWebClientInfo(clientInfo);
+			ClientProperties properties = clientInfo.getProperties();
+			properties.setJavaEnabled(false);
 		}
 		continueToPrevious();
 	}
diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/html/pages/ExceptionErrorPage.java b/wicket-core/src/main/java/org/apache/wicket/markup/html/pages/ExceptionErrorPage.java
index 60299013ae..4d027f636d 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/html/pages/ExceptionErrorPage.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/html/pages/ExceptionErrorPage.java
@@ -45,7 +45,7 @@ public class ExceptionErrorPage extends WebPage
 	private static final long serialVersionUID = 1L;
 
 	/** Keep a reference to the root cause. WicketTester will use it */
-	private final transient Throwable throwable;
+	private final Throwable throwable;
 
 	/**
 	 * Constructor.
@@ -121,13 +121,13 @@ public class ExceptionErrorPage extends WebPage
 	{
 		if (throwable != null)
 		{
-			List<Throwable> al = convertToList(throwable);
-
 			AppendingStringBuffer sb = new AppendingStringBuffer(256);
 
 			// first print the last cause
+			List<Throwable> al = convertToList(throwable);
 			int length = al.size() - 1;
 			Throwable cause = al.get(length);
+			sb.append("Last cause: ").append(cause.getMessage()).append('\n');
 			if (throwable instanceof WicketRuntimeException)
 			{
 				String msg = throwable.getMessage();
diff --git a/wicket-core/src/main/java/org/apache/wicket/pageStore/DefaultPageStore.java b/wicket-core/src/main/java/org/apache/wicket/pageStore/DefaultPageStore.java
index 87ccac6d19..4740091d78 100644
--- a/wicket-core/src/main/java/org/apache/wicket/pageStore/DefaultPageStore.java
+++ b/wicket-core/src/main/java/org/apache/wicket/pageStore/DefaultPageStore.java
@@ -192,7 +192,7 @@ public class DefaultPageStore implements IPageStore
 			return null;
 		}
 
-		String type = object != null ? object.getClass().getName() : null;
+		String type = object.getClass().getName();
 		throw new IllegalArgumentException("Unknown object type " + type);
 	}
 
@@ -290,7 +290,7 @@ public class DefaultPageStore implements IPageStore
 			return page;
 		}
 
-		String type = serializable != null ? serializable.getClass().getName() : null;
+		String type = serializable.getClass().getName();
 		throw new IllegalArgumentException("Unknown object type " + type);
 	}
 
@@ -385,7 +385,7 @@ public class DefaultPageStore implements IPageStore
 	 * 
 	 * @author Matej Knopp
 	 */
-	class SerializedPagesCache
+	static class SerializedPagesCache
 	{
 		private final int size;
 
diff --git a/wicket-core/src/main/java/org/apache/wicket/pageStore/DiskDataStore.java b/wicket-core/src/main/java/org/apache/wicket/pageStore/DiskDataStore.java
index f01b1c9ac6..4e63c08448 100644
--- a/wicket-core/src/main/java/org/apache/wicket/pageStore/DiskDataStore.java
+++ b/wicket-core/src/main/java/org/apache/wicket/pageStore/DiskDataStore.java
@@ -37,6 +37,7 @@ import org.apache.wicket.Application;
 import org.apache.wicket.WicketRuntimeException;
 import org.apache.wicket.pageStore.PageWindowManager.PageWindow;
 import org.apache.wicket.protocol.http.WebApplication;
+import org.apache.wicket.util.file.Files;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -226,7 +227,7 @@ public class DiskDataStore implements IDataStore
 				log.error("Couldn't load DiskDataStore index from file " + index + ".", e);
 			}
 		}
-		index.delete();
+		Files.remove(index);
 	}
 
 	/**
@@ -238,7 +239,7 @@ public class DiskDataStore implements IDataStore
 		if (storeFolder.exists())
 		{
 			File index = new File(storeFolder, INDEX_FILE_NAME);
-			index.delete();
+			Files.remove(index);
 			try
 			{
 				OutputStream stream = new FileOutputStream(index);
@@ -422,7 +423,7 @@ public class DiskDataStore implements IDataStore
 			File sessionFolder = diskDataStore.getSessionFolder(sessionId, false);
 			if (sessionFolder.exists())
 			{
-				sessionFolder.delete();
+				Files.remove(sessionFolder);
 			}
 			unbound = true;
 		}
diff --git a/wicket-core/src/main/java/org/apache/wicket/pageStore/FileChannelPool.java b/wicket-core/src/main/java/org/apache/wicket/pageStore/FileChannelPool.java
index b4980f635a..36e7b9eae7 100644
--- a/wicket-core/src/main/java/org/apache/wicket/pageStore/FileChannelPool.java
+++ b/wicket-core/src/main/java/org/apache/wicket/pageStore/FileChannelPool.java
@@ -27,6 +27,7 @@ import java.util.LinkedList;
 import java.util.Map;
 import java.util.Set;
 
+import org.apache.wicket.util.file.Files;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -266,7 +267,7 @@ public class FileChannelPool
 		}
 
 		File file = new File(name);
-		file.delete();
+		Files.remove(file);
 	}
 
 	/**
@@ -296,7 +297,7 @@ public class FileChannelPool
 		else
 		{
 			File file = new File(name);
-			file.delete();
+			Files.remove(file);
 		}
 	}
 
diff --git a/wicket-core/src/main/java/org/apache/wicket/protocol/http/WicketServlet.java b/wicket-core/src/main/java/org/apache/wicket/protocol/http/WicketServlet.java
index bffa2f3075..d4466bd836 100644
--- a/wicket-core/src/main/java/org/apache/wicket/protocol/http/WicketServlet.java
+++ b/wicket-core/src/main/java/org/apache/wicket/protocol/http/WicketServlet.java
@@ -117,7 +117,7 @@ public class WicketServlet extends HttpServlet
 	private static final Logger log = LoggerFactory.getLogger(WicketServlet.class);
 
 	/** The WicketFilter where all the handling is done */
-	protected WicketFilter wicketFilter;
+	protected transient WicketFilter wicketFilter;
 
 	/**
 	 * Handles servlet page requests.
diff --git a/wicket-core/src/main/java/org/apache/wicket/protocol/http/mock/MockHttpServletRequest.java b/wicket-core/src/main/java/org/apache/wicket/protocol/http/mock/MockHttpServletRequest.java
index 1e9bfed860..b87f994e34 100755
--- a/wicket-core/src/main/java/org/apache/wicket/protocol/http/mock/MockHttpServletRequest.java
+++ b/wicket-core/src/main/java/org/apache/wicket/protocol/http/mock/MockHttpServletRequest.java
@@ -76,7 +76,7 @@ public class MockHttpServletRequest implements HttpServletRequest
 	 * 
 	 * @author Frank Bille (billen)
 	 */
-	private class UploadedFile
+	private static class UploadedFile
 	{
 		private String fieldName;
 		private File file;
diff --git a/wicket-core/src/main/java/org/apache/wicket/protocol/http/mock/MockHttpSession.java b/wicket-core/src/main/java/org/apache/wicket/protocol/http/mock/MockHttpSession.java
index 11a50d0cc0..d2d89ea445 100755
--- a/wicket-core/src/main/java/org/apache/wicket/protocol/http/mock/MockHttpSession.java
+++ b/wicket-core/src/main/java/org/apache/wicket/protocol/http/mock/MockHttpSession.java
@@ -38,7 +38,7 @@ public class MockHttpSession implements HttpSession, Serializable
 
 	private final ValueMap attributes = new ValueMap();
 
-	private final ServletContext context;
+	private final transient ServletContext context;
 
 	private final long creationTime = System.currentTimeMillis();
 
diff --git a/wicket-core/src/main/java/org/apache/wicket/request/handler/render/WebPageRenderer.java b/wicket-core/src/main/java/org/apache/wicket/request/handler/render/WebPageRenderer.java
index ed986dd61f..453de89f29 100644
--- a/wicket-core/src/main/java/org/apache/wicket/request/handler/render/WebPageRenderer.java
+++ b/wicket-core/src/main/java/org/apache/wicket/request/handler/render/WebPageRenderer.java
@@ -76,11 +76,6 @@ public class WebPageRenderer extends PageRenderer
 		return Application.get().getRequestCycleSettings().getRenderStrategy() == RenderStrategy.REDIRECT_TO_BUFFER;
 	}
 
-	private void renderPage()
-	{
-		getPage().renderPage();
-	}
-
 	/**
 	 * @return the current session id for stateful pages and <code>null</code> for stateless pages
 	 */
diff --git a/wicket-core/src/main/java/org/apache/wicket/util/crypt/KeyInSessionSunJceCryptFactory.java b/wicket-core/src/main/java/org/apache/wicket/util/crypt/KeyInSessionSunJceCryptFactory.java
index f01c526b42..39ccf1aa26 100644
--- a/wicket-core/src/main/java/org/apache/wicket/util/crypt/KeyInSessionSunJceCryptFactory.java
+++ b/wicket-core/src/main/java/org/apache/wicket/util/crypt/KeyInSessionSunJceCryptFactory.java
@@ -20,7 +20,6 @@ import java.util.UUID;
 
 import org.apache.wicket.MetaDataKey;
 import org.apache.wicket.Session;
-import org.apache.wicket.request.cycle.RequestCycle;
 
 /**
  * Crypt factory that produces {@link SunJceCrypt} instances based on http session-specific
@@ -42,12 +41,9 @@ public class KeyInSessionSunJceCryptFactory implements ICryptFactory
 
 	public ICrypt newCrypt()
 	{
-		RequestCycle rc = RequestCycle.get();
-
 		Session session = Session.get();
 		session.bind();
 
-
 		// retrieve or generate encryption key from session
 		String key = session.getMetaData(KEY);
 		if (key == null)
diff --git a/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java b/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java
index 841a2bb070..bc4afbca1e 100644
--- a/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java
+++ b/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java
@@ -270,7 +270,7 @@ public class BaseWicketTester
 
 		hsession = new MockHttpSession(servletContext);
 
-		ThreadContext oldThreadContext = ThreadContext.detach();
+		ThreadContext.detach();
 
 		this.application = application;
 
@@ -647,7 +647,7 @@ public class BaseWicketTester
 	{
 		XmlPullParser parser = new XmlPullParser();
 		parser.parse(getLastResponseAsString());
-		XmlTag tag = null;
+		XmlTag tag;
 		do
 		{
 			tag = (XmlTag)parser.nextTag();
@@ -2193,13 +2193,12 @@ public class BaseWicketTester
 	/**
 	 * 
 	 */
-	private class TestPageManagerProvider implements IPageManagerProvider
+	private static class TestPageManagerProvider implements IPageManagerProvider
 	{
 		public IPageManager get(IPageManagerContext pageManagerContext)
 		{
 			return new MockPageManager();
 		}
-
 	}
 
 	/**
@@ -2235,7 +2234,7 @@ public class BaseWicketTester
 		}
 	}
 
-	private class WicketTesterServletWebResponse extends ServletWebResponse
+	private static class WicketTesterServletWebResponse extends ServletWebResponse
 		implements
 			IMetaDataBufferingWebResponse
 	{
diff --git a/wicket-core/src/main/java/org/apache/wicket/util/tester/TagTester.java b/wicket-core/src/main/java/org/apache/wicket/util/tester/TagTester.java
index 2913b06698..480350375f 100644
--- a/wicket-core/src/main/java/org/apache/wicket/util/tester/TagTester.java
+++ b/wicket-core/src/main/java/org/apache/wicket/util/tester/TagTester.java
@@ -507,9 +507,10 @@ public class TagTester
 						if (openTag == null)
 						{
 							IValueMap attributeMap = xmlTag.getAttributes();
-							for (String attr : attributeMap.keySet())
+							for (Map.Entry<String, Object> entry : attributeMap.entrySet())
 							{
-								if (attr.equals(attribute) && value.equals(attributeMap.get(attr)))
+								if (entry.getKey().equals(attribute) &&
+									value.equals(entry.getValue()))
 								{
 									if (xmlTag.isOpen())
 									{
