diff --git a/wicket-core/src/main/java/org/apache/wicket/request/mapper/CryptoMapper.java b/wicket-core/src/main/java/org/apache/wicket/request/mapper/CryptoMapper.java
index a53ce246a0..f0e4c20065 100755
--- a/wicket-core/src/main/java/org/apache/wicket/request/mapper/CryptoMapper.java
+++ b/wicket-core/src/main/java/org/apache/wicket/request/mapper/CryptoMapper.java
@@ -186,8 +186,14 @@ public class CryptoMapper implements IRequestMapper
 			int segNo = 1;
 			for (; segNo < encryptedNumberOfSegments; segNo++)
 			{
-				if (segNo > originalNumberOfSegments ||
-					!generator.next().equals(encryptedSegments.get(segNo)))
+				if (segNo > originalNumberOfSegments)
+				{
+					break;
+				}
+
+				String next = generator.next();
+				String encryptedSegment = encryptedSegments.get(segNo);
+				if (!next.equals(encryptedSegment))
 				{
 					break;
 				}
