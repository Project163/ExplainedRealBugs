diff --git a/wicket-core/src/main/java/org/apache/wicket/protocol/http/request/UserAgent.java b/wicket-core/src/main/java/org/apache/wicket/protocol/http/request/UserAgent.java
index b6c028ad2c..1f42b0498b 100644
--- a/wicket-core/src/main/java/org/apache/wicket/protocol/http/request/UserAgent.java
+++ b/wicket-core/src/main/java/org/apache/wicket/protocol/http/request/UserAgent.java
@@ -83,6 +83,11 @@ enum UserAgent {
 	 */
 	public boolean matches(String userAgent)
 	{
+		if (userAgent == null)
+		{
+			return false;
+		}
+
 		if (notAllowedList != null)
 		{
 			for (String value : notAllowedList)
