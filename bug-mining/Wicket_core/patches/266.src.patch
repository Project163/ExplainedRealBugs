diff --git a/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java b/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java
index 6fd815dafb..d513425377 100644
--- a/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java
+++ b/wicket-core/src/main/java/org/apache/wicket/util/tester/BaseWicketTester.java
@@ -598,15 +598,31 @@ public class BaseWicketTester
 
 				if (newUrl.isAbsolute())
 				{
-					fail("Can not follow absolute redirect URL.");
+					request.setUrl(newUrl);
+
+					if (newUrl.getProtocol() != null)
+					{
+						request.setScheme(newUrl.getProtocol());
+					}
+					if (newUrl.getHost() != null)
+					{
+						request.setServerName(newUrl.getHost());
+					}
+					if (newUrl.getPort() != null)
+					{
+						request.setServerPort(newUrl.getPort());
+					}
 				}
+				else
+				{
+					// append redirect URL to current URL (what browser would do)
+					Url mergedURL = new Url(lastRequest.getUrl().getSegments(),
+					    newUrl.getQueryParameters());
+					mergedURL.concatSegments(newUrl.getSegments());
 
-				// append redirect URL to current URL (what browser would do)
-				Url mergedURL = new Url(lastRequest.getUrl().getSegments(),
-					newUrl.getQueryParameters());
-				mergedURL.concatSegments(newUrl.getSegments());
+					request.setUrl(mergedURL);
+				}
 
-				request.setUrl(mergedURL);
 				processRequest(null, null, true);
 
 				--redirectCount;
diff --git a/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpPage.html b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpPage.html
new file mode 100644
index 0000000000..cfb9f446a9
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpPage.html
@@ -0,0 +1,11 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE html>
+<html xmlns:wicket="http://wicket.apache.org">
+<head>
+    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
+    <title>Secure Page</title>
+</head>
+<body>
+    insecure page
+</body>
+</html>
\ No newline at end of file
diff --git a/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpPage.java b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpPage.java
new file mode 100644
index 0000000000..bb041f5fd6
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpPage.java
@@ -0,0 +1,24 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.protocol.https;
+
+import org.apache.wicket.markup.html.WebPage;
+
+public class HttpPage extends WebPage
+{
+	private static final long serialVersionUID = 1L;
+}
diff --git a/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsMapperApplication.java b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsMapperApplication.java
new file mode 100644
index 0000000000..e35e839e89
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsMapperApplication.java
@@ -0,0 +1,53 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.protocol.https;
+
+import org.apache.wicket.Page;
+import org.apache.wicket.protocol.http.WebApplication;
+
+public class HttpsMapperApplication extends WebApplication
+{
+	private HttpsConfig config;
+
+	public HttpsMapperApplication(int httpPort, int httpsPort)
+	{
+		config = new HttpsConfig(httpPort, httpsPort);
+	}
+
+	public HttpsMapperApplication()
+	{
+		config = new HttpsConfig();
+	}
+
+	@Override
+	protected void init()
+	{
+		super.init();
+
+		mountPage("/secure", HttpsPage.class);
+		mountPage("/insecure", HttpPage.class);
+
+		setRootRequestMapper(new HttpsMapper(getRootRequestMapper(), config));
+	}
+	
+
+	@Override
+	public Class<? extends Page> getHomePage()
+	{
+		return HttpsPage.class;
+	}
+}
diff --git a/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsMapperApplicationTest.java b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsMapperApplicationTest.java
new file mode 100644
index 0000000000..5f97e8d8bc
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsMapperApplicationTest.java
@@ -0,0 +1,118 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.protocol.https;
+
+import org.apache.wicket.Page;
+import org.apache.wicket.util.tester.WicketTester;
+import org.junit.Test;
+
+import static org.junit.Assert.*;
+
+/**
+ * Test for proper switching of http and https in {@link WicketTester}
+ */
+public class HttpsMapperApplicationTest
+{
+	@SuppressWarnings({"unchecked"})
+	private <T extends Page> T requestPage(WicketTester tester, Class<T> pageClass)
+	{
+		Page page = tester.startPage(pageClass);
+		tester.assertRenderedPage(pageClass);
+		assertNotNull(page);
+		assertEquals(pageClass, page.getClass());
+		assertEquals(page, tester.getLastRenderedPage());
+		return (T)page;
+	}
+
+	@Test
+	public void switchDefaultToHttpsWithDefaultPorts()
+	{
+		WicketTester tester = new WicketTester(new HttpsMapperApplication());
+		
+		requestPage(tester, HttpsPage.class);
+		
+		assertEquals("https", tester.getLastRequest().getScheme());
+		assertEquals(443, tester.getLastRequest().getServerPort());
+	}
+
+	@Test
+	public void switchDefaultToHttpsWithCustomPort()
+	{
+		WicketTester tester = new WicketTester(new HttpsMapperApplication(123, 456));
+
+		requestPage(tester, HttpsPage.class);
+
+		assertEquals("https", tester.getLastRequest().getScheme());
+		assertEquals(456, tester.getLastRequest().getServerPort());
+	}
+
+	@Test
+	public void switchHttpsToHttpWithDefaultPorts()
+	{
+		WicketTester tester = new WicketTester(new HttpsMapperApplication());
+
+		tester.getRequest().setScheme("https");
+		tester.getRequest().setServerPort(443);
+		
+		requestPage(tester, HttpPage.class);
+		
+		assertEquals("http", tester.getLastRequest().getScheme());
+		assertEquals(80, tester.getLastRequest().getServerPort());
+	}
+
+	@Test
+	public void switchHttpsToHttpWithCustomPorts()
+	{
+		WicketTester tester = new WicketTester(new HttpsMapperApplication(123, 456));
+
+		tester.getRequest().setScheme("https");
+		tester.getRequest().setServerPort(443);
+
+		requestPage(tester, HttpPage.class);
+
+		assertEquals("http", tester.getLastRequest().getScheme());
+		assertEquals(123, tester.getLastRequest().getServerPort());
+	}
+
+	@Test
+	public void switchHttpToHttpsWithDefaultPorts()
+	{
+		WicketTester tester = new WicketTester(new HttpsMapperApplication());
+
+		tester.getRequest().setScheme("http");
+		tester.getRequest().setServerPort(80);
+
+		requestPage(tester, HttpsPage.class);
+
+		assertEquals("https", tester.getLastRequest().getScheme());
+		assertEquals(443, tester.getLastRequest().getServerPort());
+	}
+
+	@Test
+	public void switchHttpToHttpsWithCustomPorts()
+	{
+		WicketTester tester = new WicketTester(new HttpsMapperApplication(123, 456));
+
+		tester.getRequest().setScheme("http");
+		tester.getRequest().setServerPort(123);
+
+		requestPage(tester, HttpsPage.class);
+
+		assertEquals("https", tester.getLastRequest().getScheme());
+		assertEquals(456, tester.getLastRequest().getServerPort());
+	}
+}
diff --git a/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsPage.html b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsPage.html
new file mode 100644
index 0000000000..b5185cb6a8
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsPage.html
@@ -0,0 +1,11 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE html>
+<html xmlns:wicket="http://wicket.apache.org">
+<head>
+    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
+    <title>Secure Page</title>
+</head>
+<body>
+    secure page
+</body>
+</html>
\ No newline at end of file
diff --git a/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsPage.java b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsPage.java
new file mode 100644
index 0000000000..391656076f
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsPage.java
@@ -0,0 +1,25 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.protocol.https;
+
+import org.apache.wicket.markup.html.WebPage;
+
+@RequireHttps
+public class HttpsPage extends WebPage
+{
+	private static final long serialVersionUID = 1L;
+}
diff --git a/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsRequestCheckerTest.java b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsRequestCheckerTest.java
index 1f0ad3d299..bbde760356 100644
--- a/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsRequestCheckerTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/protocol/https/HttpsRequestCheckerTest.java
@@ -17,7 +17,6 @@
 package org.apache.wicket.protocol.https;
 
 import org.apache.wicket.WicketTestCase;
-import org.apache.wicket.markup.html.WebPage;
 import org.apache.wicket.request.IRequestHandler;
 import org.apache.wicket.request.handler.IPageRequestHandler;
 import org.junit.Test;
@@ -57,15 +56,4 @@ public class HttpsRequestCheckerTest extends WicketTestCase
 			httpPageRequestHandler, httpsConfig);
 		assertSame(httpPageRequestHandler, httpPageSecureIncoming);
 	}
-
-	@RequireHttps
-	private static class HttpsPage extends WebPage
-	{
-		private static final long serialVersionUID = 1L;
-	}
-
-	private static class HttpPage extends WebPage
-	{
-		private static final long serialVersionUID = 1L;
-	}
 }
