diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/form/encryption/CryptTest.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/form/encryption/CryptTest.java
index ff7abcc364..9c3156bbeb 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/form/encryption/CryptTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/form/encryption/CryptTest.java
@@ -55,6 +55,7 @@ public class CryptTest extends WicketTestCase
 				final String encrypted = crypt.encryptUrlSafe(text);
 				assertEquals(expectedUrlSafeEncrypted, encrypted);
 				assertEquals(text, crypt.decryptUrlSafe(expectedUrlSafeEncrypted));
+				assertNull(crypt.decryptUrlSafe("style.css"));
 			}
 		}
 		catch (Exception ex)
diff --git a/wicket-core/src/test/java/org/apache/wicket/request/mapper/CryptoMapperTest.java b/wicket-core/src/test/java/org/apache/wicket/request/mapper/CryptoMapperTest.java
index 667718dd97..7b2b88f9dc 100644
--- a/wicket-core/src/test/java/org/apache/wicket/request/mapper/CryptoMapperTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/request/mapper/CryptoMapperTest.java
@@ -95,6 +95,18 @@ public class CryptoMapperTest extends AbstractMapperTest
 		assertEquals(DummyHomePage.class, handler.getPageClass());
 	}
 
+	/**
+	 * Test a failed decrypt, WICKET-4139
+	 */
+	public void testDecryptFailed()
+	{
+		String encrypted = "style.css";
+
+		Request request = getRequest(Url.parse(encrypted));
+
+		assertNull(mapper.mapRequest(request));
+	}
+
 	/**
 	 * Tests that named and indexed parameters are properly (en|de)crypted
 	 */
