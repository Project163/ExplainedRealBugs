diff --git a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/AbstractBookmarkableMapper.java b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/AbstractBookmarkableMapper.java
index 94a4b7aae4..15694686e0 100644
--- a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/AbstractBookmarkableMapper.java
+++ b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/AbstractBookmarkableMapper.java
@@ -655,8 +655,25 @@ public abstract class AbstractBookmarkableMapper extends AbstractComponentMapper
 		return ret;
 	}
 
-	protected void setPlaceholders(PageParameters parameters, Url url)
+	/**
+	 * Replaces mandatory and optional parameters with their values.
+	 *
+	 * If a mandatory parameter is not provided then the method returns {@code false}
+	 * indicating that there is a problem.
+	 * Optional parameters with missing values are just dropped.
+	 *
+	 * @param parameters
+	 *          The parameters with the values
+	 * @param url
+	 *          The url with the placeholders
+	 * @return
+	 *          {@code true} if all mandatory parameters are properly substituted,
+	 *          {@code false} - otherwise
+	 */
+	protected boolean setPlaceholders(PageParameters parameters, Url url)
 	{
+		boolean mandatoryParametersSet = true;
+
 		int dropped = 0;
 		for (int i = 0; i < mountSegments.length; ++i)
 		{
@@ -664,8 +681,16 @@ public abstract class AbstractBookmarkableMapper extends AbstractComponentMapper
 			String optionalPlaceholder = getOptionalPlaceholder(mountSegments[i]);
 			if (placeholder != null)
 			{
-				url.getSegments().set(i - dropped, parameters.get(placeholder).toString(""));
-				parameters.remove(placeholder);
+				if (parameters.getNamedKeys().contains(placeholder))
+				{
+					url.getSegments().set(i - dropped, parameters.get(placeholder).toString());
+					parameters.remove(placeholder);
+				}
+				else
+				{
+					mandatoryParametersSet = false;
+					break;
+				}
 			}
 			else if (optionalPlaceholder != null)
 			{
@@ -681,5 +706,7 @@ public abstract class AbstractBookmarkableMapper extends AbstractComponentMapper
 				}
 			}
 		}
+
+		return mandatoryParametersSet;
 	}
 }
diff --git a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/MountedMapper.java b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/MountedMapper.java
index 83e0374134..53fb39471f 100644
--- a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/MountedMapper.java
+++ b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/MountedMapper.java
@@ -216,36 +216,10 @@ public class MountedMapper extends AbstractBookmarkableMapper
 		encodePageComponentInfo(url, info.getPageComponentInfo());
 
 		PageParameters copy = new PageParameters(info.getPageParameters());
-//		setPlaceholders(copy, url);
-
-		int dropped = 0;
-		for (int i = 0; i < mountSegments.length; ++i)
+		if (setPlaceholders(copy, url) == false)
 		{
-			String placeholder = getPlaceholder(mountSegments[i]);
-			String optionalPlaceholder = getOptionalPlaceholder(mountSegments[i]);
-			if (placeholder != null)
-			{
-				if (!copy.getNamedKeys().contains(placeholder))
-				{
-					// no value for placeholder - cannot mount
-					return null;
-				}
-				url.getSegments().set(i - dropped, copy.get(placeholder).toString(""));
-				copy.remove(placeholder);
-			}
-			else if (optionalPlaceholder != null)
-			{
-				if (copy.getNamedKeys().contains(optionalPlaceholder))
-				{
-					url.getSegments().set(i - dropped, copy.get(optionalPlaceholder).toString(""));
-					copy.remove(optionalPlaceholder);
-				}
-				else
-				{
-					url.getSegments().remove(i - dropped);
-					dropped++;
-				}
-			}
+			// mandatory parameter is not provided => cannot build Url
+			return null;
 		}
 
 		return encodePageParameters(url, copy, pageParametersEncoder);
diff --git a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/PackageMapper.java b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/PackageMapper.java
index 2cc3e46330..41c6696f88 100644
--- a/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/PackageMapper.java
+++ b/wicket-core/src/main/java/org/apache/wicket/core/request/mapper/PackageMapper.java
@@ -117,7 +117,11 @@ public class PackageMapper extends AbstractBookmarkableMapper
 			encodePageComponentInfo(url, info.getPageComponentInfo());
 
 			PageParameters copy = new PageParameters(info.getPageParameters());
-			setPlaceholders(copy, url);
+			if (setPlaceholders(copy, url) == false)
+			{
+				// mandatory parameter is not provided => cannot build Url
+				return null;
+			}
 
 			return encodePageParameters(url, copy, pageParametersEncoder);
 		}
