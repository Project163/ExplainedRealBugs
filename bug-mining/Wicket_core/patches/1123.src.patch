diff --git a/wicket-core/src/main/java/org/apache/wicket/markup/html/PackageResourceGuard.java b/wicket-core/src/main/java/org/apache/wicket/markup/html/PackageResourceGuard.java
index 8cd8fe747e..c06590b00d 100644
--- a/wicket-core/src/main/java/org/apache/wicket/markup/html/PackageResourceGuard.java
+++ b/wicket-core/src/main/java/org/apache/wicket/markup/html/PackageResourceGuard.java
@@ -70,7 +70,8 @@ public class PackageResourceGuard implements IPackageResourceGuard
 		int len = path.length();
 		final String ext;
 		if (ixExtension <= 0 || ixExtension == len ||
-			(path.lastIndexOf(File.separator) + 1) == ixExtension)
+			(path.lastIndexOf('/') + 1) == ixExtension ||
+			(path.lastIndexOf('\\') + 1) == ixExtension)
 		{
 			ext = null;
 		}
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/PackageResourceGuardTest.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/PackageResourceGuardTest.java
index bafd8c4efc..bcbcd69d12 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/PackageResourceGuardTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/PackageResourceGuardTest.java
@@ -54,16 +54,21 @@ public class PackageResourceGuardTest extends WicketTestCase
 		guard.setAllowAccessToRootResources(false);
 
 		assertTrue(guard.accept("/test/test.js"));
+		assertTrue(guard.accept("/test/.java"));
 		assertFalse(guard.accept("/test.js"));
 
-		if ("\\".equals(File.pathSeparator))
+		if ("\\".equals(File.separator))
 		{
+			assertTrue(guard.accept("c:\\test\\org\\apache\\.java"));
+			assertTrue(guard.accept("\\test\\org\\apache\\.java"));
 			assertTrue(guard.accept("c:\\test\\org\\apache\\test.js"));
 			assertTrue(guard.accept("\\test\\org\\apache\\test.js"));
 			assertFalse(guard.accept("c:\\test.js"));
 			assertFalse(guard.accept("\\test.js"));
 
 			// java also generates file paths with '/' on windows
+			assertTrue(guard.accept("c:/test/org/apache/.java"));
+			assertTrue(guard.accept("/test/org/apache/.java"));
 			assertTrue(guard.accept("c:/test/org/apache/test.js"));
 			assertTrue(guard.accept("/test/org/apache/test.js"));
 			assertFalse(guard.accept("c:/test.js"));
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/PackageResourceTest.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/PackageResourceTest.java
index 9249f468b1..19624c790d 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/PackageResourceTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/PackageResourceTest.java
@@ -82,6 +82,7 @@ public class PackageResourceTest extends WicketTestCase
 		assertTrue(guard.accept(Packages.absolutePath(PackageResourceTest.class, ".Bar")));
 		assertTrue(guard.accept(Packages.absolutePath(PackageResourceTest.class, ".java")));
 		assertFalse(guard.accept(Packages.absolutePath(PackageResourceTest.class, "Bar.java")));
+		assertTrue(guard.accept(Packages.absolutePath(PackageResourceTest.class, "foo/.java")));
 	}
 
 	/**
