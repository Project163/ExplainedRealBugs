diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/ChildWithDeeperPathInTransparentContainerPage.html b/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/ChildWithDeeperPathInTransparentContainerPage.html
new file mode 100644
index 0000000000..3807d466ad
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/ChildWithDeeperPathInTransparentContainerPage.html
@@ -0,0 +1,30 @@
+<!DOCTYPE html>
+<html xmlns:wicket="http://wicket.apache.org">
+    <head>
+        <meta charset="utf-8" />
+        <title>Apache Wicket Quickstart</title>
+        <link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:regular,bold' rel='stylesheet' type='text/css' />
+        <link rel="stylesheet" href="style.css" type="text/css" media="screen" title="Stylesheet" />
+    </head>
+    <body>
+        <p>
+            Wicket version: <wicket:container wicket:id="version">1.5-SNAPSHOT</wicket:container>
+        </p>
+        <table wicket:id="table_wrapper">
+            <tbody>
+                <wicket:enclosure child="column:info">
+                <tr>
+                    <td wicket:id="column">
+                        <div><h4 wicket:id="info">[Info]</h4></div>
+                    </td>
+                </tr>
+                </wicket:enclosure>
+                <tr>
+                    <td>
+                        <div wicket:id="list">[Item List]</div>
+                    </td>
+                </tr>
+            </tbody>
+        </table>
+    </body>
+</html>
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/ChildWithDeeperPathInTransparentContainerPage.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/ChildWithDeeperPathInTransparentContainerPage.java
new file mode 100644
index 0000000000..329ffd3e08
--- /dev/null
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/ChildWithDeeperPathInTransparentContainerPage.java
@@ -0,0 +1,66 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.wicket.markup.html.internal;
+
+import org.apache.wicket.markup.html.TransparentWebMarkupContainer;
+import org.apache.wicket.markup.html.WebMarkupContainer;
+import org.apache.wicket.markup.html.WebPage;
+import org.apache.wicket.markup.html.basic.Label;
+import org.apache.wicket.model.Model;
+
+/**
+ * Test page for https://issues.apache.org/jira/browse/WICKET-4172
+ */
+public class ChildWithDeeperPathInTransparentContainerPage extends WebPage
+{
+	private static final long serialVersionUID = 1L;
+
+	static final String LABEL_TEXT = "Column Info text";
+
+	/**
+	 * Constructor.
+	 * 
+	 * @param childVisible
+	 */
+	public ChildWithDeeperPathInTransparentContainerPage(final boolean childVisible)
+	{
+		add(new Label("version", getApplication().getFrameworkSettings().getVersion()));
+
+		final TransparentWebMarkupContainer table_wrapper = new TransparentWebMarkupContainer(
+			"table_wrapper");
+		// additional stuff goes here
+		add(table_wrapper);
+
+		final WebMarkupContainer column = new WebMarkupContainer("column");
+		// addition stuff goes here
+		add(column);
+
+		column.add(new Label("info", LABEL_TEXT)
+		{
+			private static final long serialVersionUID = 1L;
+
+			@Override
+			public boolean isVisible()
+			{
+				return childVisible;
+			}
+		});
+		// just for test (returns a list of real items in our project)
+		add(new Label("list", new Model<String>("Test Items")));
+
+	}
+}
diff --git a/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/EnclosureTest.java b/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/EnclosureTest.java
index bf2678e81e..10f22228b8 100644
--- a/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/EnclosureTest.java
+++ b/wicket-core/src/test/java/org/apache/wicket/markup/html/internal/EnclosureTest.java
@@ -37,6 +37,7 @@ import org.apache.wicket.util.resource.StringResourceStream;
 import org.apache.wicket.util.tester.DiffUtil;
 import org.apache.wicket.util.tester.FormTester;
 import org.apache.wicket.util.tester.WicketTester;
+import org.junit.Test;
 
 
 /**
@@ -402,4 +403,21 @@ public class EnclosureTest extends WicketTestCase
 		tester.clickLink("b");
 		assertTrue(tester.getLastResponseAsString().contains("$label$"));
 	}
+
+	/**
+	 * Test case for https://issues.apache.org/jira/browse/WICKET-4172
+	 */
+	@Test
+	public void childWithDeeperPathInTransparentContainer()
+	{
+		boolean enclosureChildVisible = true;
+		tester.startPage(new ChildWithDeeperPathInTransparentContainerPage(enclosureChildVisible));
+
+		tester.assertContains(ChildWithDeeperPathInTransparentContainerPage.LABEL_TEXT);
+
+		enclosureChildVisible = false;
+		tester.startPage(new ChildWithDeeperPathInTransparentContainerPage(enclosureChildVisible));
+
+		tester.assertContainsNot(ChildWithDeeperPathInTransparentContainerPage.LABEL_TEXT);
+	}
 }
\ No newline at end of file
