<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:30:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-8443] GenerateMutableProjection Exceeds JVM Code Size Limits</title>
                <link>https://issues.apache.org/jira/browse/SPARK-8443</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;GenerateMutableProjection put all expressions columns into a single apply function. When there are a lot of columns, the apply function code size exceeds the 64kb limit, which is a hard limit on jvm that cannot change.&lt;/p&gt;

&lt;p&gt;This comes up when we were aggregating about 100 columns using codegen and unsafe feature.&lt;/p&gt;

&lt;p&gt;I wrote an unit test that reproduces this issue. &lt;br/&gt;
&lt;a href=&quot;https://github.com/saurfang/spark/blob/codegen_size_limit/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/expressions/CodeGenerationSuite.scala&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/saurfang/spark/blob/codegen_size_limit/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/expressions/CodeGenerationSuite.scala&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This test currently fails at 2048 expressions. It seems the master is more tolerant than branch-1.4 about this because code is more concise.&lt;/p&gt;

&lt;p&gt;While the code on master has changed since branch-1.4, I am able to reproduce the problem in master. For now I hacked my way in branch-1.4 to workaround this problem by wrapping each expression with a separate function then call those functions sequentially in apply. The proper way is probably check the length of the projectCode and break it up as necessary. (This seems to be easier in master actually since we are building code by string rather than quasiquote)&lt;/p&gt;

&lt;p&gt;Let me know if anyone has additional thoughts on this, I&apos;m happy to contribute a pull request.&lt;/p&gt;

&lt;p&gt;Attaching stack trace produced by unit test&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[info] - code size limit *** FAILED *** (7 seconds, 103 milliseconds)
[info]   com.google.common.util.concurrent.UncheckedExecutionException: org.codehaus.janino.JaninoRuntimeException: Code of method &lt;span class=&quot;code-quote&quot;&gt;&quot;(Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;&quot;&lt;/span&gt; of class &lt;span class=&quot;code-quote&quot;&gt;&quot;SC$SpecificProjection&quot;&lt;/span&gt; grows beyond 64 KB
[info]   at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2263)
[info]   at com.google.common.cache.LocalCache.get(LocalCache.java:4000)
[info]   at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4004)
[info]   at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4874)
[info]   at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator.generate(CodeGenerator.scala:285)
[info]   at org.apache.spark.sql.catalyst.expressions.CodeGenerationSuite$$anonfun$2$$anonfun$apply$mcV$sp$2.apply(CodeGenerationSuite.scala:50)
[info]   at org.apache.spark.sql.catalyst.expressions.CodeGenerationSuite$$anonfun$2$$anonfun$apply$mcV$sp$2.apply(CodeGenerationSuite.scala:48)
[info]   at scala.collection.TraversableOnce$$anonfun$foldLeft$1.apply(TraversableOnce.scala:144)
[info]   at scala.collection.TraversableOnce$$anonfun$foldLeft$1.apply(TraversableOnce.scala:144)
[info]   at scala.collection.immutable.Range.foreach(Range.scala:141)
[info]   at scala.collection.TraversableOnce$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foldLeft(TraversableOnce.scala:144)
[info]   at scala.collection.AbstractTraversable.foldLeft(Traversable.scala:105)
[info]   at org.apache.spark.sql.catalyst.expressions.CodeGenerationSuite$$anonfun$2.apply$mcV$sp(CodeGenerationSuite.scala:47)
[info]   at org.apache.spark.sql.catalyst.expressions.CodeGenerationSuite$$anonfun$2.apply(CodeGenerationSuite.scala:47)
[info]   at org.apache.spark.sql.catalyst.expressions.CodeGenerationSuite$$anonfun$2.apply(CodeGenerationSuite.scala:47)
[info]   at org.scalatest.Transformer$$anonfun$apply$1.apply$mcV$sp(Transformer.scala:22)
[info]   at org.scalatest.OutcomeOf$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;outcomeOf(OutcomeOf.scala:85)
[info]   at org.scalatest.OutcomeOf$.outcomeOf(OutcomeOf.scala:104)
[info]   at org.scalatest.Transformer.apply(Transformer.scala:22)
[info]   at org.scalatest.Transformer.apply(Transformer.scala:20)
[info]   at org.scalatest.FunSuiteLike$$anon$1.apply(FunSuiteLike.scala:166)
[info]   at org.apache.spark.SparkFunSuite.withFixture(SparkFunSuite.scala:42)
[info]   at org.scalatest.FunSuiteLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;invokeWithFixture$1(FunSuiteLike.scala:163)
[info]   at org.scalatest.FunSuiteLike$$anonfun$runTest$1.apply(FunSuiteLike.scala:175)
[info]   at org.scalatest.FunSuiteLike$$anonfun$runTest$1.apply(FunSuiteLike.scala:175)
[info]   at org.scalatest.SuperEngine.runTestImpl(Engine.scala:306)
[info]   at org.scalatest.FunSuiteLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;runTest(FunSuiteLike.scala:175)
[info]   at org.scalatest.FunSuite.runTest(FunSuite.scala:1555)
[info]   at org.scalatest.FunSuiteLike$$anonfun$runTests$1.apply(FunSuiteLike.scala:208)
[info]   at org.scalatest.FunSuiteLike$$anonfun$runTests$1.apply(FunSuiteLike.scala:208)
[info]   at org.scalatest.SuperEngine$$anonfun$traverseSubNodes$1$1.apply(Engine.scala:413)
[info]   at org.scalatest.SuperEngine$$anonfun$traverseSubNodes$1$1.apply(Engine.scala:401)
[info]   at scala.collection.immutable.List.foreach(List.scala:318)
[info]   at org.scalatest.SuperEngine.traverseSubNodes$1(Engine.scala:401)
[info]   at org.scalatest.SuperEngine.org$scalatest$SuperEngine$$runTestsInBranch(Engine.scala:396)
[info]   at org.scalatest.SuperEngine.runTestsImpl(Engine.scala:483)
[info]   at org.scalatest.FunSuiteLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;runTests(FunSuiteLike.scala:208)
[info]   at org.scalatest.FunSuite.runTests(FunSuite.scala:1555)
[info]   at org.scalatest.Suite$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;run(Suite.scala:1424)
[info]   at org.scalatest.FunSuite.org$scalatest$FunSuiteLike$$&lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;$run(FunSuite.scala:1555)
[info]   at org.scalatest.FunSuiteLike$$anonfun$run$1.apply(FunSuiteLike.scala:212)
[info]   at org.scalatest.FunSuiteLike$$anonfun$run$1.apply(FunSuiteLike.scala:212)
[info]   at org.scalatest.SuperEngine.runImpl(Engine.scala:545)
[info]   at org.scalatest.FunSuiteLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;run(FunSuiteLike.scala:212)
[info]   at org.scalatest.FunSuite.run(FunSuite.scala:1555)
[info]   at org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:462)
[info]   at org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:671)
[info]   at sbt.ForkMain$Run$2.call(ForkMain.java:294)
[info]   at sbt.ForkMain$Run$2.call(ForkMain.java:284)
[info]   at java.util.concurrent.FutureTask.run(FutureTask.java:266)
[info]   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
[info]   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
[info]   at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
[info]   Cause: org.codehaus.janino.JaninoRuntimeException: Code of method &lt;span class=&quot;code-quote&quot;&gt;&quot;(Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;&quot;&lt;/span&gt; of class &lt;span class=&quot;code-quote&quot;&gt;&quot;SC$SpecificProjection&quot;&lt;/span&gt; grows beyond 64 KB
[info]   at org.codehaus.janino.CodeContext.makeSpace(CodeContext.java:941)
[info]   at org.codehaus.janino.CodeContext.write(CodeContext.java:874)
[info]   at org.codehaus.janino.CodeContext.writeBranch(CodeContext.java:965)
[info]   at org.codehaus.janino.UnitCompiler.writeBranch(UnitCompiler.java:10261)
[info]   at org.codehaus.janino.UnitCompiler.compileBoolean2(UnitCompiler.java:2862)
[info]   at org.codehaus.janino.UnitCompiler.access$4800(UnitCompiler.java:185)
[info]   at org.codehaus.janino.UnitCompiler$8.visitAmbiguousName(UnitCompiler.java:2832)
[info]   at org.codehaus.janino.Java$AmbiguousName.accept(Java.java:3138)
[info]   at org.codehaus.janino.UnitCompiler.compileBoolean(UnitCompiler.java:2842)
[info]   at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1741)
[info]   at org.codehaus.janino.UnitCompiler.access$1200(UnitCompiler.java:185)
[info]   at org.codehaus.janino.UnitCompiler$4.visitIfStatement(UnitCompiler.java:937)
[info]   at org.codehaus.janino.Java$IfStatement.accept(Java.java:2157)
[info]   at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)
[info]   at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1007)
[info]   at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:2293)
[info]   at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:822)
[info]   at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:794)
[info]   at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:507)
[info]   at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:658)
[info]   at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:662)
[info]   at org.codehaus.janino.UnitCompiler.access$600(UnitCompiler.java:185)
[info]   at org.codehaus.janino.UnitCompiler$2.visitMemberClassDeclaration(UnitCompiler.java:350)
[info]   at org.codehaus.janino.Java$MemberClassDeclaration.accept(Java.java:1035)
[info]   at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:354)
[info]   at org.codehaus.janino.UnitCompiler.compileDeclaredMemberTypes(UnitCompiler.java:769)
[info]   at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:532)
[info]   at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:393)
[info]   at org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:185)
[info]   at org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:347)
[info]   at org.codehaus.janino.Java$PackageMemberClassDeclaration.accept(Java.java:1139)
[info]   at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:354)
[info]   at org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:322)
[info]   at org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:383)
[info]   at org.codehaus.janino.ClassBodyEvaluator.compileToClass(ClassBodyEvaluator.java:315)
[info]   at org.codehaus.janino.ClassBodyEvaluator.cook(ClassBodyEvaluator.java:233)
[info]   at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:192)
[info]   at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:84)
[info]   at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:77)
[info]   at org.codehaus.janino.ClassBodyEvaluator.&amp;lt;init&amp;gt;(ClassBodyEvaluator.java:72)
[info]   at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator.compile(CodeGenerator.scala:245)
[info]   at org.apache.spark.sql.catalyst.expressions.codegen.GenerateMutableProjection$.create(GenerateMutableProjection.scala:87)
[info]   at org.apache.spark.sql.catalyst.expressions.codegen.GenerateMutableProjection$.create(GenerateMutableProjection.scala:29)
[info]   at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:272)
[info]   at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3599)
[info]   at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2379)
[info]   at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2342)
[info]   at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2257)
[info]   at com.google.common.cache.LocalCache.get(LocalCache.java:4000)
[info]   at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4004)
[info]   at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4874)
[info]   at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator.generate(CodeGenerator.scala:285)
[info]   at org.apache.spark.sql.catalyst.expressions.CodeGenerationSuite$$anonfun$2$$anonfun$apply$mcV$sp$2.apply(CodeGenerationSuite.scala:50)
[info]   at org.apache.spark.sql.catalyst.expressions.CodeGenerationSuite$$anonfun$2$$anonfun$apply$mcV$sp$2.apply(CodeGenerationSuite.scala:48)
[info]   at scala.collection.TraversableOnce$$anonfun$foldLeft$1.apply(TraversableOnce.scala:144)
[info]   at scala.collection.TraversableOnce$$anonfun$foldLeft$1.apply(TraversableOnce.scala:144)
[info]   at scala.collection.immutable.Range.foreach(Range.scala:141)
[info]   at scala.collection.TraversableOnce$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foldLeft(TraversableOnce.scala:144)
[info]   at scala.collection.AbstractTraversable.foldLeft(Traversable.scala:105)
[info]   at org.apache.spark.sql.catalyst.expressions.CodeGenerationSuite$$anonfun$2.apply$mcV$sp(CodeGenerationSuite.scala:47)
[info]   at org.apache.spark.sql.catalyst.expressions.CodeGenerationSuite$$anonfun$2.apply(CodeGenerationSuite.scala:47)
[info]   at org.apache.spark.sql.catalyst.expressions.CodeGenerationSuite$$anonfun$2.apply(CodeGenerationSuite.scala:47)
[info]   at org.scalatest.Transformer$$anonfun$apply$1.apply$mcV$sp(Transformer.scala:22)
[info]   at org.scalatest.OutcomeOf$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;outcomeOf(OutcomeOf.scala:85)
[info]   at org.scalatest.OutcomeOf$.outcomeOf(OutcomeOf.scala:104)
[info]   at org.scalatest.Transformer.apply(Transformer.scala:22)
[info]   at org.scalatest.Transformer.apply(Transformer.scala:20)
[info]   at org.scalatest.FunSuiteLike$$anon$1.apply(FunSuiteLike.scala:166)
[info]   at org.apache.spark.SparkFunSuite.withFixture(SparkFunSuite.scala:42)
[info]   at org.scalatest.FunSuiteLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;invokeWithFixture$1(FunSuiteLike.scala:163)
[info]   at org.scalatest.FunSuiteLike$$anonfun$runTest$1.apply(FunSuiteLike.scala:175)
[info]   at org.scalatest.FunSuiteLike$$anonfun$runTest$1.apply(FunSuiteLike.scala:175)
[info]   at org.scalatest.SuperEngine.runTestImpl(Engine.scala:306)
[info]   at org.scalatest.FunSuiteLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;runTest(FunSuiteLike.scala:175)
[info]   at org.scalatest.FunSuite.runTest(FunSuite.scala:1555)
[info]   at org.scalatest.FunSuiteLike$$anonfun$runTests$1.apply(FunSuiteLike.scala:208)
[info]   at org.scalatest.FunSuiteLike$$anonfun$runTests$1.apply(FunSuiteLike.scala:208)
[info]   at org.scalatest.SuperEngine$$anonfun$traverseSubNodes$1$1.apply(Engine.scala:413)
[info]   at org.scalatest.SuperEngine$$anonfun$traverseSubNodes$1$1.apply(Engine.scala:401)
[info]   at scala.collection.immutable.List.foreach(List.scala:318)
[info]   at org.scalatest.SuperEngine.traverseSubNodes$1(Engine.scala:401)
[info]   at org.scalatest.SuperEngine.org$scalatest$SuperEngine$$runTestsInBranch(Engine.scala:396)
[info]   at org.scalatest.SuperEngine.runTestsImpl(Engine.scala:483)
[info]   at org.scalatest.FunSuiteLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;runTests(FunSuiteLike.scala:208)
[info]   at org.scalatest.FunSuite.runTests(FunSuite.scala:1555)
[info]   at org.scalatest.Suite$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;run(Suite.scala:1424)
[info]   at org.scalatest.FunSuite.org$scalatest$FunSuiteLike$$&lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;$run(FunSuite.scala:1555)
[info]   at org.scalatest.FunSuiteLike$$anonfun$run$1.apply(FunSuiteLike.scala:212)
[info]   at org.scalatest.FunSuiteLike$$anonfun$run$1.apply(FunSuiteLike.scala:212)
[info]   at org.scalatest.SuperEngine.runImpl(Engine.scala:545)
[info]   at org.scalatest.FunSuiteLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;run(FunSuiteLike.scala:212)
[info]   at org.scalatest.FunSuite.run(FunSuite.scala:1555)
[info]   at org.scalatest.tools.Framework.org$scalatest$tools$Framework$$runSuite(Framework.scala:462)
[info]   at org.scalatest.tools.Framework$ScalaTestTask.execute(Framework.scala:671)
[info]   at sbt.ForkMain$Run$2.call(ForkMain.java:294)
[info]   at sbt.ForkMain$Run$2.call(ForkMain.java:284)
[info]   at java.util.concurrent.FutureTask.run(FutureTask.java:266)
[info]   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
[info]   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
[info]   at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12838845">SPARK-8443</key>
            <summary>GenerateMutableProjection Exceeds JVM Code Size Limits</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="saurfang">Sen Fang</assignee>
                                    <reporter username="saurfang">Sen Fang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Jun 2015 16:00:23 +0000</created>
                <updated>Mon, 14 Nov 2016 19:32:45 +0000</updated>
                            <resolved>Sun, 19 Jul 2015 04:06:32 +0000</resolved>
                                    <version>1.4.0</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14605028" author="apachespark" created="Mon, 29 Jun 2015 01:44:07 +0000"  >&lt;p&gt;User &apos;saurfang&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7076&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7076&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15385667" author="volkanagun@gmail.com" created="Wed, 20 Jul 2016 10:55:48 +0000"  >&lt;p&gt;The same issue for large sql syntax with a lot of unions and iterations over dataframe at spark 1.6.2&lt;/p&gt;


&lt;p&gt;Caused by: org.codehaus.janino.JaninoRuntimeException: Code of method &quot;(Lorg/apache/spark/sql/catalyst/expressions/GeneratedClass$SpecificUnsafeProjection;Lorg/apache/spark/sql/catalyst/InternalRow;)V&quot; of class &quot;org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection&quot; grows beyond 64 KB&lt;br/&gt;
	at org.codehaus.janino.CodeContext.makeSpace(CodeContext.java:941)&lt;br/&gt;
	at org.codehaus.janino.CodeContext.write(CodeContext.java:854)&lt;br/&gt;
	at org.codehaus.janino.CodeContext.writeShort(CodeContext.java:959)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.writeConstantFieldrefInfo(UnitCompiler.java:10279)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.getfield(UnitCompiler.java:9946)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileGet2(UnitCompiler.java:3322)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$8200(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$10.visitFieldAccess(UnitCompiler.java:3282)&lt;br/&gt;
	at org.codehaus.janino.Java$FieldAccess.accept(Java.java:3232)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileGet(UnitCompiler.java:3290)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileGetValue(UnitCompiler.java:4368)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileContext2(UnitCompiler.java:3190)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$5600(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$9.visitFieldAccess(UnitCompiler.java:3152)&lt;br/&gt;
	at org.codehaus.janino.Java$FieldAccess.accept(Java.java:3232)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileContext(UnitCompiler.java:3160)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileContext2(UnitCompiler.java:3172)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$5400(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$9.visitAmbiguousName(UnitCompiler.java:3150)&lt;br/&gt;
	at org.codehaus.janino.Java$AmbiguousName.accept(Java.java:3138)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileContext(UnitCompiler.java:3160)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileGetValue(UnitCompiler.java:4367)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileGet2(UnitCompiler.java:3975)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$6900(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$10.visitMethodInvocation(UnitCompiler.java:3263)&lt;br/&gt;
	at org.codehaus.janino.Java$MethodInvocation.accept(Java.java:3974)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileGet(UnitCompiler.java:3290)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileGetValue(UnitCompiler.java:4368)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:2662)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$4400(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$7.visitMethodInvocation(UnitCompiler.java:2627)&lt;br/&gt;
	at org.codehaus.janino.Java$MethodInvocation.accept(Java.java:3974)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:2654)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1643)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$1100(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$4.visitExpressionStatement(UnitCompiler.java:936)&lt;br/&gt;
	at org.codehaus.janino.Java$ExpressionStatement.accept(Java.java:2097)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1007)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:993)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$1000(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$4.visitBlock(UnitCompiler.java:935)&lt;br/&gt;
	at org.codehaus.janino.Java$Block.accept(Java.java:2012)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1742)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$1200(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$4.visitIfStatement(UnitCompiler.java:937)&lt;br/&gt;
	at org.codehaus.janino.Java$IfStatement.accept(Java.java:2157)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1007)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:993)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$1000(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$4.visitBlock(UnitCompiler.java:935)&lt;br/&gt;
	at org.codehaus.janino.Java$Block.accept(Java.java:2012)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1745)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$1200(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$4.visitIfStatement(UnitCompiler.java:937)&lt;br/&gt;
	at org.codehaus.janino.Java$IfStatement.accept(Java.java:2157)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1007)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:993)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$1000(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$4.visitBlock(UnitCompiler.java:935)&lt;br/&gt;
	at org.codehaus.janino.Java$Block.accept(Java.java:2012)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1745)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$1200(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$4.visitIfStatement(UnitCompiler.java:937)&lt;br/&gt;
	at org.codehaus.janino.Java$IfStatement.accept(Java.java:2157)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1007)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:993)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$1000(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$4.visitBlock(UnitCompiler.java:935)&lt;br/&gt;
	at org.codehaus.janino.Java$Block.accept(Java.java:2012)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1745)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$1200(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$4.visitIfStatement(UnitCompiler.java:937)&lt;br/&gt;
	at org.codehaus.janino.Java$IfStatement.accept(Java.java:2157)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1007)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:2293)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:822)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:794)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:507)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:658)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:662)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$600(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$2.visitMemberClassDeclaration(UnitCompiler.java:350)&lt;br/&gt;
	at org.codehaus.janino.Java$MemberClassDeclaration.accept(Java.java:1035)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:354)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileDeclaredMemberTypes(UnitCompiler.java:769)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:532)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:393)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:185)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:347)&lt;br/&gt;
	at org.codehaus.janino.Java$PackageMemberClassDeclaration.accept(Java.java:1139)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:354)&lt;br/&gt;
	at org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:322)&lt;br/&gt;
	at org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:383)&lt;br/&gt;
	at org.codehaus.janino.ClassBodyEvaluator.compileToClass(ClassBodyEvaluator.java:315)&lt;br/&gt;
	at org.codehaus.janino.ClassBodyEvaluator.cook(ClassBodyEvaluator.java:233)&lt;br/&gt;
	at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:192)&lt;br/&gt;
	at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:84)&lt;br/&gt;
	at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator.org$apache$spark$sql$catalyst$expressions$codegen$CodeGenerator$$doCompile(CodeGenerator.scala:597)&lt;br/&gt;
	... 46 more&lt;/p&gt;</comment>
                            <comment id="15664779" author="barrybecker4" created="Mon, 14 Nov 2016 19:32:45 +0000"  >&lt;p&gt;I see the same error in spark 1.6.3. Is there a workaround? Should this issue be reopened? I am working with a dataset with more than 200 columns. Before 1.6.3 I could not even try this case because of &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-16664&quot; title=&quot;Spark 1.6.2 - Persist call on Data frames with more than 200 columns is wiping out the data.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-16664&quot;&gt;&lt;del&gt;SPARK-16664&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: org.codehaus.janino.JaninoRuntimeException: Code of method &lt;span class=&quot;code-quote&quot;&gt;&quot;(Lorg/apache/spark/sql/catalyst/InternalRow;Lorg/apache/spark/sql/catalyst/InternalRow;)I&quot;&lt;/span&gt; of class &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificOrdering&quot;&lt;/span&gt; grows beyond 64 KB
        at org.codehaus.janino.CodeContext.makeSpace(CodeContext.java:941)
        at org.codehaus.janino.CodeContext.write(CodeContext.java:836)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12845168">SPARK-9058</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12953408">SPARK-14138</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12960593">SPARK-14793</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 1 week ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2g7un:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>