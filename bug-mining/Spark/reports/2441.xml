<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:32:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-8167] Tasks that fail due to YARN preemption can cause job failure</title>
                <link>https://issues.apache.org/jira/browse/SPARK-8167</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Tasks that are running on preempted executors will count as FAILED with an ExecutorLostFailure. Unfortunately, this can quickly spiral out of control if a large resource shift is occurring, and the tasks get scheduled to executors that immediately get preempted as well.&lt;/p&gt;

&lt;p&gt;The current workaround is to increase spark.task.maxFailures very high, but that can cause delays in true failures. We should ideally differentiate these task statuses so that they don&apos;t count towards the failure limit.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12836250">SPARK-8167</key>
            <summary>Tasks that fail due to YARN preemption can cause job failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mcheah">Matt Cheah</assignee>
                                    <reporter username="pwoody">Patrick Woody</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Jun 2015 19:26:10 +0000</created>
                <updated>Sun, 17 May 2020 17:48:29 +0000</updated>
                            <resolved>Thu, 10 Sep 2015 18:59:08 +0000</resolved>
                                    <version>1.3.1</version>
                                    <fixVersion>1.6.0</fixVersion>
                                    <component>Scheduler</component>
                    <component>Spark Core</component>
                    <component>YARN</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>18</watches>
                                                                                                                <comments>
                            <comment id="14577727" author="mcheah" created="Mon, 8 Jun 2015 19:47:15 +0000"  >&lt;p&gt;To be clear this is independent of &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-7451&quot; title=&quot;Spark on Yarn : Preemption of executors is counted as failure causing Spark job to fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-7451&quot;&gt;&lt;del&gt;SPARK-7451&lt;/del&gt;&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-7451&quot; title=&quot;Spark on Yarn : Preemption of executors is counted as failure causing Spark job to fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-7451&quot;&gt;&lt;del&gt;SPARK-7451&lt;/del&gt;&lt;/a&gt; helps for the case that executors die too many times from preemption, but it doesn&apos;t not help if the exact same task gets preempted many times.&lt;/p&gt;</comment>
                            <comment id="14597956" author="mcheah" created="Tue, 23 Jun 2015 17:03:37 +0000"  >&lt;p&gt;I&apos;m starting to work on this now, sorry for the delay.&lt;/p&gt;</comment>
                            <comment id="14600012" author="mcheah" created="Wed, 24 Jun 2015 19:42:34 +0000"  >&lt;p&gt;What&apos;s curious here as I&apos;m trying to design this is that it&apos;s not immediately obvious how to transfer the exit code of the executor from the remote machine back to the driver. If the Executor dies, the driver immediately sees the connection as dropped and just removes the Executor without question as to what the exit code was; it is hard to know what the exit code is in YARN mode in particular.&lt;/p&gt;

&lt;p&gt;Does anyone have any thoughts as to how to get the exit code of the executor to the driver, in yarn-client mode?&lt;/p&gt;</comment>
                            <comment id="14601678" author="mcheah" created="Thu, 25 Jun 2015 18:26:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=joshrosen&quot; class=&quot;user-hover&quot; rel=&quot;joshrosen&quot;&gt;joshrosen&lt;/a&gt; any thoughts on this?&lt;/p&gt;</comment>
                            <comment id="14603913" author="mcheah" created="Sat, 27 Jun 2015 02:34:28 +0000"  >&lt;p&gt;One thought is to have, whenever a task fails from an executor lost failure, logic specific to YARN to ask the YarnAllocator (ApplicationMaster) if the executor that was just lost had been preempted. There might be some nasty race conditions here though, and would require invoking a blocking RPC call inside of TaskSetManager.executorLost, or something similar - which is on the message loop of RpcEndpoint. And invoking a blocking RPC call in the message loop is something that&apos;s probably not desirable.&lt;/p&gt;</comment>
                            <comment id="14647313" author="zjffdu" created="Thu, 30 Jul 2015 08:01:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mcheah&quot; class=&quot;user-hover&quot; rel=&quot;mcheah&quot;&gt;mcheah&lt;/a&gt; What&apos;s the status of this ticket ?  I don&apos;t think blocking RPC call is a good idea.  I think we could just send executor preempted message to driver when the container is preempted. And let driver to decrease the numTaskAttemptFails. Although we lose some consistency here, at least we could avoid job failures due to preemption. And I think there&apos;s some gap between 2 consecutive failed task attempt, very likely in the gap the driver has received the executor preempted message.  Thoughts ?&lt;/p&gt;</comment>
                            <comment id="14660871" author="apachespark" created="Thu, 6 Aug 2015 22:04:07 +0000"  >&lt;p&gt;User &apos;mccheah&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/8007&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/8007&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14694454" author="vanzin" created="Thu, 13 Aug 2015 00:23:50 +0000"  >&lt;p&gt;Sorry, reviewing your PR is on my list but this won&apos;t make it into 1.5.0.&lt;/p&gt;</comment>
                            <comment id="15185005" author="dubovsky" created="Tue, 8 Mar 2016 14:53:59 +0000"  >&lt;p&gt;I&apos;d like to have a question about this fix. In SparkUI in active stages view there is an entry saying this:&lt;/p&gt;

&lt;p&gt;Tasks: Succeeded/Total&lt;br/&gt;
1480/2880 (1311 failed)&lt;/p&gt;

&lt;p&gt;Does this number of failed tasks include those which &quot;failed&quot; because of preemption?&lt;br/&gt;
It&apos;s useful to know whether my job is failing (I should fix it) or resources are taken only (I should wait).&lt;/p&gt;

&lt;p&gt;Thank you&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 37 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2fs5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333083">1.6.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>