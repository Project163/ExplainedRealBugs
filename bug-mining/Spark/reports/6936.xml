<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:09:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-29188] toPandas gets wrong dtypes when applied on empty DF</title>
                <link>https://issues.apache.org/jira/browse/SPARK-29188</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;When calling toPandas from an empty dataframe, all dtypes are set to `object`.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-python&quot;&gt;
spark_df = spark.createDataFrame([(10, &lt;span class=&quot;code-quote&quot;&gt;&quot;Emy&quot;&lt;/span&gt;, datetime.today() ), (11, &lt;span class=&quot;code-quote&quot;&gt;&quot;Bob&quot;&lt;/span&gt;, datetime.today())], [&lt;span class=&quot;code-quote&quot;&gt;&quot;age&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;date&quot;&lt;/span&gt;])

spark.createDataFrame(spark.sparkContext.emptyRDD(), schema=spark_df.schema).toPandas().dtypes&#160;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Result:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-bash&quot;&gt;
age     object
name    object
date    object
dtype: object
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;While it gets the correct types when converting the entire dataframe (or at least with 1 line of data) to pandas:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-python&quot;&gt;
spark_df = spark.createDataFrame([(10, &lt;span class=&quot;code-quote&quot;&gt;&quot;Emy&quot;&lt;/span&gt;, datetime.today() ), (11, &lt;span class=&quot;code-quote&quot;&gt;&quot;Bob&quot;&lt;/span&gt;, datetime.today())], [&lt;span class=&quot;code-quote&quot;&gt;&quot;age&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;date&quot;&lt;/span&gt;]) 

spark_df.limit(1).toPandas().dtypes 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;Result:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-bash&quot;&gt;
age              int64
name            object
date    datetime64[ns]
dtype: object
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Is this intended ? Why&#160;toPandas does not rely on the Spark DataFrame Schema ?&lt;/p&gt;</description>
                <environment>&lt;p&gt;&amp;gt;&amp;gt; uname -a&lt;/p&gt;

&lt;p&gt;Linux XXXXXXXXXXXXXXXX 4.14.104-95.84.amzn2.x86_64 #1 SMP Sat Mar 2 00:40:20 UTC 2019 x86_64 GNU/Linux&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt; python&lt;/p&gt;

&lt;p&gt;Python 3.6.7 | packaged by conda-forge | (default, Jul 2 2019, 02:18:42)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;GCC 7.3.0&amp;#93;&lt;/span&gt; on linux&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt; conda list&lt;br/&gt;
...&lt;br/&gt;
openjdk   8.0.192   h1de35cc_1003       conda-forge&lt;br/&gt;
pandas    0.25.1      py36h86efe34_0    conda-forge&lt;br/&gt;
py4j         0.10.7      py_1                           conda-forge&lt;br/&gt;
pyspark   2.4.4       py_0                          conda-forge&lt;br/&gt;
....&lt;/p&gt;</environment>
        <key id="13257901">SPARK-29188</key>
            <summary>toPandas gets wrong dtypes when applied on empty DF</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dlindelof">David Lindel&#246;f</assignee>
                                    <reporter username="radcheb">Radhwane Chebaane</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Sep 2019 09:36:24 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:40 +0000</updated>
                            <resolved>Thu, 12 Dec 2019 11:51:52 +0000</resolved>
                                    <version>2.0.0</version>
                    <version>2.4.4</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>PySpark</component>
                    <component>SQL</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16994583" author="gurwls223" created="Thu, 12 Dec 2019 11:51:52 +0000"  >&lt;p&gt;Issue resolved by pull request 26747&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/26747&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/26747&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13280033">SPARK-30537</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 48 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z06uo8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>