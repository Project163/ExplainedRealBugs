<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:13:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-1693] Dependent on multiple versions of servlet-api jars lead to throw an SecurityException when Spark built for hadoop 2.3.0 , 2.4.0 </title>
                <link>https://issues.apache.org/jira/browse/SPARK-1693</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;mvn test -Pyarn -Dhadoop.version=2.4.0 -Dyarn.version=2.4.0 &amp;gt; log.txt&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The log: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;UnpersistSuite:
- unpersist RDD *** FAILED ***
  java.lang.SecurityException: class &lt;span class=&quot;code-quote&quot;&gt;&quot;javax.servlet.FilterRegistration&quot;&lt;/span&gt;&apos;s signer information does not match signer information of other classes in the same &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;
  at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.checkCerts(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:952)
  at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.preDefineClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:666)
  at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.defineClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:794)
  at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
  at java.net.URLClassLoader.defineClass(URLClassLoader.java:449)
  at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
  at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
  at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
  at java.security.AccessController.doPrivileged(Native Method)
  at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12711672">SPARK-1693</key>
            <summary>Dependent on multiple versions of servlet-api jars lead to throw an SecurityException when Spark built for hadoop 2.3.0 , 2.4.0 </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gq">Guoqiang Li</assignee>
                                    <reporter username="gq">Guoqiang Li</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 May 2014 07:43:47 +0000</created>
                <updated>Thu, 2 Mar 2017 21:42:28 +0000</updated>
                            <resolved>Mon, 5 May 2014 00:49:26 +0000</resolved>
                                                    <fixVersion>1.0.0</fixVersion>
                                    <component>Spark Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="13986471" author="srowen" created="Thu, 1 May 2014 10:04:41 +0000"  >&lt;p&gt;I suspect this occurs because two copies of the servlet API jars are included from two sources, and one of those sources includes jar signing information in its manifest. The resulting merged jar has collisions in the signing information and it no longer matches.&lt;/p&gt;

&lt;p&gt;If that&apos;s right, the fastest way to avoid this is usually to drop signing information that is in the manifest since it is not helpful in the assembly jar. Of course it&apos;s ideal to avoid merging two copies of the same dependencies, since only one can be included, and that&apos;s why we see some &lt;span class=&quot;error&quot;&gt;&amp;#91;warn&amp;#93;&lt;/span&gt; in the build. In just about all cases it is harmless since they are actually copies of the same version of the same classes.&lt;/p&gt;

&lt;p&gt;I will look into what ends up in the manifest.&lt;/p&gt;</comment>
                            <comment id="13986490" author="srowen" created="Thu, 1 May 2014 10:46:11 +0000"  >&lt;p&gt;I think this is traceable to a case of jar conflict. I am not sure whether the ultimate cause is signing, but it doesn&apos;t matter, since we should simply resolve the conflict. (But I think something like that may be at play, since one of the problem dependencies is from Eclipse&apos;s jetty, and there is an Eclipse cert in the manifest at META-INF/ECLIPSEF.RSA...) Anyway.&lt;/p&gt;

&lt;p&gt;This is another fun jar hell puzzler, albeit one with a probable solution. The basic issues is that Jetty brings in the Servlet 3.0 API:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[INFO] |  +- org.eclipse.jetty:jetty-server:jar:8.1.14.v20131031:compile
[INFO] |  |  +- org.eclipse.jetty.orbit:javax.servlet:jar:3.0.0.v201112011016:compile
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... but in Hadoop 2.3.0+, so does Hadoop client:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[INFO] |  +- org.apache.hadoop:hadoop-client:jar:2.4.0:compile
...
[INFO] |  |  +- org.apache.hadoop:hadoop-mapreduce-client-core:jar:2.4.0:compile
[INFO] |  |  |  \- org.apache.hadoop:hadoop-yarn-common:jar:2.4.0:compile
[INFO] |  |  |     +- javax.xml.bind:jaxb-api:jar:2.2.2:compile
...
[INFO] |  |  |     +- javax.servlet:servlet-api:jar:2.5:compile
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Eclipse is naughty for packaging the same API classes in a different artifact, rather than just using javax.servlet:servlet-api 3.0. There may be a reason for that, which is what worries me. In theory Servlet 3.0 is a superset of 2.5, so Hadoop&apos;s client should be happy with the 3.0 API on the classpath.&lt;/p&gt;

&lt;p&gt;So solution #1 to try is to exclude javax.servlet:servlet-api from the hadoop-client dependency. It won&apos;t affect earlier versions at all since they don&apos;t have this dependency, and therefore need not even be version-specific.&lt;/p&gt;

&lt;p&gt;Hadoop 2.3+ then in theory should happily find Eclipse&apos;s Servlet 3.0 API classes and work as normal. I give that about an 90% chance of being true.&lt;/p&gt;

&lt;p&gt;Solution #2 is more theoretically sound. We should really exclude Jetty&apos;s custom copy of Servlet 3.0, and depend on javax.servlet:servlet-api:jar:3.0 as a runtime dependency. This should transparently override Hadoop 2.3+&apos;s version, and still work for Hadoop. Messing with Jetty increases the chance of another snag. Probability of success: 80%&lt;/p&gt;


&lt;p&gt;Li would you be able to try either of those ideas?&lt;/p&gt;</comment>
                            <comment id="13986492" author="gq" created="Thu, 1 May 2014 10:52:12 +0000"  >&lt;p&gt;Hi, Sean Owen &lt;br/&gt;
The simplest solution is to remove the dependency of servlet-api&lt;br/&gt;
&lt;a href=&quot;https://github.com/witgo/spark/commit/0ed124dc0e453a0a59d3c387651be970859a9a0a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;The related work &lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13986494" author="srowen" created="Thu, 1 May 2014 10:57:13 +0000"  >&lt;p&gt;Ah didn&apos;t even see that! Yeah that&apos;s my &quot;#1&quot;, which you already identified. It is simple. Does it resolve this error? (I assume so.)&lt;/p&gt;

&lt;p&gt;The only reason this feels undesirable is that Hadoop&apos;s web app then only happens to work because Jetty is also bundled. That kind of accidental working is brittle. (Although, why does the Hadoop client lib need a web app? could be an accident of the dependency graph that totally doesn&apos;t matter.)&lt;/p&gt;

&lt;p&gt;I had thought that the real fix is to declare that the project&apos;s conflicting dependencies must agree, by declaring the dependency they must agree on and then excluding the offenders. That is, does #2 work for you too? It is not much more work and more robust. But I am not 100% sure it works.&lt;/p&gt;</comment>
                            <comment id="13986504" author="gq" created="Thu, 1 May 2014 11:18:09 +0000"  >&lt;p&gt;The dependency path is as follows&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hadoop-client=&amp;gt; hadoop-mapreduce-client-core =&amp;gt; hadoop-yarn-common=&amp;gt;servlet-api&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Yarn work in the hadoop cluster,and hadoop already contains servlet-api in &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;${HADOOP_COMMON_HOME}/share/hadoop/yarn/lib/servlet-api-2.5.jar&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I guess &quot;#1&quot; should be no problem,but there is no test&lt;/p&gt;</comment>
                            <comment id="13986507" author="srowen" created="Thu, 1 May 2014 11:20:35 +0000"  >&lt;p&gt;Correct. I thought you had tried option #1 since you had suggested it too. Can you not test it in the same way that you discovered the problem? If you try, I&apos;d suggest the #2 option, because if that works, it is a more robust solution.&lt;/p&gt;</comment>
                            <comment id="13986518" author="gq" created="Thu, 1 May 2014 11:38:59 +0000"  >&lt;p&gt;Servlet 3.0, 2.5 together on the classpath,Is that ok?&lt;/p&gt;</comment>
                            <comment id="13986523" author="srowen" created="Thu, 1 May 2014 11:44:14 +0000"  >&lt;p&gt;No, that&apos;s exactly the problem as far as I can tell. My suggestion is:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;In core, exclude org.eclipse.jetty.orbit:javax.servlet from org.eclipse.jetty:jetty-server&lt;/li&gt;
	&lt;li&gt;Declare a runtime-scope dependency in core, on javax.servlet:servlet-api:jar:3.0&lt;/li&gt;
	&lt;li&gt;(And that will happen to override Hadoop&apos;s javax.servlet:servlet-api:jar:2.5 !)&lt;/li&gt;
	&lt;li&gt;Update the SBT build as closely as possible to match&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13986607" author="gq" created="Thu, 1 May 2014 14:04:44 +0000"  >&lt;p&gt;Hi Sean Owen&lt;br/&gt;
You have time to review &lt;a href=&quot;https://github.com/witgo/spark/tree/SPARK-1693&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;the code&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13986631" author="srowen" created="Thu, 1 May 2014 14:26:07 +0000"  >&lt;p&gt;Yes looks very close to what I had in mind; I have two suggestions:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;To be ultra-safe, use version 3.0.0 of the Servlet API not 3.0.1&lt;/li&gt;
	&lt;li&gt;Maybe drop a comment in the parent pom about why this dependency exists &amp;#8211; even just a reference to this JIRA&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Does it work for you then? fingers crossed.&lt;/p&gt;</comment>
                            <comment id="13986636" author="gq" created="Thu, 1 May 2014 14:35:16 +0000"  >&lt;p&gt;I didn&apos;t find servlet-api  3.0.0 stable version&lt;br/&gt;
&lt;a href=&quot;http://mvnrepository.com/artifact/javax.servlet&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mvnrepository.com/artifact/javax.servlet&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13986643" author="srowen" created="Thu, 1 May 2014 14:44:35 +0000"  >&lt;p&gt;Huh! you&apos;re right. Yes I agree with what you have done then.&lt;/p&gt;</comment>
                            <comment id="13986656" author="gq" created="Thu, 1 May 2014 15:11:05 +0000"  >&lt;p&gt;Thanks Sean Owen .&lt;br/&gt;
Code has been submitted to &lt;a href=&quot;https://github.com/apache/spark/pull/590&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR 590&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13987316" author="pwendell" created="Fri, 2 May 2014 04:34:23 +0000"  >&lt;p&gt;I&apos;m confused about something &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sowen&quot; class=&quot;user-hover&quot; rel=&quot;sowen&quot;&gt;sowen&lt;/a&gt;: If Hadoop 2.3/2.4 wants version 3 of the servlet-api dependency, why does the Hadoop build declare version 2.5 as a dependency in their POM&apos;s?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://repo1.maven.org/maven2/org/apache/hadoop/hadoop-project/2.3.0/hadoop-project-2.3.0.pom&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://repo1.maven.org/maven2/org/apache/hadoop/hadoop-project/2.3.0/hadoop-project-2.3.0.pom&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://repo1.maven.org/maven2/org/apache/hadoop/hadoop-project/2.4.0/hadoop-project-2.4.0.pom&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://repo1.maven.org/maven2/org/apache/hadoop/hadoop-project/2.4.0/hadoop-project-2.4.0.pom&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also - is there not a risk of bumping this version to 3.X when users are building against older hadoop versions? I noticed the older hadoop versions depend 2.X versions of this... will it break them if 2.X and 3.X are present at runtime?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sowen&quot; class=&quot;user-hover&quot; rel=&quot;sowen&quot;&gt;sowen&lt;/a&gt; If you could look over this PR it would be great. It&apos;s really scary merging a big change like this to the build at the 11th hour. So the more eyes the better.&lt;/p&gt;</comment>
                            <comment id="13987323" author="gq" created="Fri, 2 May 2014 04:48:59 +0000"  >&lt;p&gt;Now, the main problem is to ensure that hadoop 2.3, 2.4 can work in this version.But I don&apos;t have Hadoop 2.3, 2.4 clusters.&lt;/p&gt;</comment>
                            <comment id="13987454" author="srowen" created="Fri, 2 May 2014 07:04:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pwendell&quot; class=&quot;user-hover&quot; rel=&quot;pwendell&quot;&gt;pwendell&lt;/a&gt; The Hadoop artifacts want version 2.5, as you see. The Servlet 3.0.x &lt;b&gt;APIs&lt;/b&gt; should be a superset of 2.5. In theory clients implementing or using 2.5 will be fine with it, which means there&apos;s an 80% chance it&apos;s actually true. Hence I think a solution is to enforce use of 3.0.1, and exclude all other copies of the servlet API.&lt;/p&gt;

&lt;p&gt;Normally that&apos;s as simple as declaring a runtime dependency on the latest version of the artifact, which will override any transitive dependencies. The problem here is exactly because that&apos;s not true; Eclipse has its own artifact for the servlet 3.0 APIs.&lt;/p&gt;

&lt;p&gt;And &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=witgo&quot; class=&quot;user-hover&quot; rel=&quot;witgo&quot;&gt;witgo&lt;/a&gt;, as you noted, the artifact name actually changed from 2.5 to 3.0.1! So depending on it will &lt;b&gt;not&lt;/b&gt; remove Hadoop&apos;s dependency. I think one more change is needed, to exclude Hadoop&apos;s dependency on the old javax.servlet:servlet-api artifact.&lt;/p&gt;

&lt;p&gt;Basically, &quot;mvn ... dependency:tree | grep javax.servlet&quot; should only show the new 3.0.1 dependency.&lt;/p&gt;

&lt;p&gt;This should hopefully solve the client-side, unit test failures at least, which is necessary. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=witgo&quot; class=&quot;user-hover&quot; rel=&quot;witgo&quot;&gt;witgo&lt;/a&gt; I assume you have found it makes the tests pass? I do not think it will affect compatibility with a cluster, as this isn&apos;t changing or affecting how the client talks to a cluster. &lt;/p&gt;</comment>
                            <comment id="13988212" author="tgraves" created="Fri, 2 May 2014 20:41:40 +0000"  >&lt;p&gt;Is this only seen in the tests?  When I run on a real hadoop2.4 cluster with spark built for hadoop 2.4 I don&apos;t see any exceptions. &lt;/p&gt;</comment>
                            <comment id="13988534" author="gq" created="Sat, 3 May 2014 02:19:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tgraves&quot; class=&quot;user-hover&quot; rel=&quot;tgraves&quot;&gt;tgraves&lt;/a&gt;&lt;br/&gt;
You&apos;re right . Different versions of the Servlet APIs are forced to merge into spark-assembly.&lt;b&gt;hadoop.&lt;/b&gt;.jar,each .class file will only have a presence&lt;/p&gt;</comment>
                            <comment id="13988615" author="srowen" created="Sat, 3 May 2014 08:23:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tgraves&quot; class=&quot;user-hover&quot; rel=&quot;tgraves&quot;&gt;tgraves&lt;/a&gt; I see it in tests. It sounds like it does not affect simple, normal operation, which is good. It would still be good to fix up, for propiety&apos;s sake and because of the tests. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gq&quot; class=&quot;user-hover&quot; rel=&quot;gq&quot;&gt;gq&lt;/a&gt; the problem is exactly that several copies of the same class are merged, right?&lt;/p&gt;</comment>
                            <comment id="13988618" author="gq" created="Sat, 3 May 2014 08:34:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srowen&quot; class=&quot;user-hover&quot; rel=&quot;srowen&quot;&gt;srowen&lt;/a&gt; You&apos;re right,preferably only one version exists. &lt;/p&gt;</comment>
                            <comment id="13989219" author="pwendell" created="Mon, 5 May 2014 00:49:26 +0000"  >&lt;p&gt;Issue resolved by pull request 628&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/628&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/628&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14562555" author="skamandros" created="Thu, 28 May 2015 09:14:50 +0000"  >&lt;p&gt;I think the fix version of this issue is incorrect, I could reproduce the problem with spark-core 1.1.0-cdh5.2.1. With version 1.3.0-cdh5.4.2, the same code works fine in local execution.&lt;/p&gt;</comment>
                            <comment id="14728669" author="hudson" created="Thu, 3 Sep 2015 08:16:12 +0000"  >&lt;p&gt;SUCCESS: Integrated in gora-trunk #1610 (See &lt;a href=&quot;https://builds.apache.org/job/gora-trunk/1610/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/gora-trunk/1610/&lt;/a&gt;)&lt;br/&gt;
servlet dependency is excluded from spark, not ant. Without excluding it throws a java security exception. Motivation for it: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-1693&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-1693&lt;/a&gt; and (furkankamaci: rev ad4f5601ebd52e182bf79ba4032dcb85d918b925)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;gora-core/pom.xml&lt;/li&gt;
	&lt;li&gt;pom.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15089936" author="owen.omalley" created="Fri, 8 Jan 2016 21:03:48 +0000"  >&lt;p&gt;Can you explain what the problem is and how to fix it? We are hitting the same problem on the hive on spark work.&lt;/p&gt;</comment>
                            <comment id="15089945" author="srowen" created="Fri, 8 Jan 2016 21:09:29 +0000"  >&lt;p&gt;As I recall this happens because the official JavaEE servlet API jar includes MANIFEST.MF entries with a signature. If these classes are repackaged in an assembly jar with these same MANIFEST.MF entries, you get this failure. There&apos;s a lot of discussion above, but one quick fix is to manage to not include the signatures from anywhere. &lt;/p&gt;</comment>
                            <comment id="15893074" author="ottomata" created="Thu, 2 Mar 2017 21:41:54 +0000"  >&lt;p&gt;We just upgraded to CDH 5.10, which has Spark 1.6.0, Hadoop 2.6.0, Hive 1.1.0, and Oozie 4.1.0.&lt;/p&gt;

&lt;p&gt;We are having trouble running Spark jobs that use HiveContext from Oozie.  They run perfectly fine from the CLI with spark-submit, just not in Oozie.  We aren&apos;t certain that HiveContext is related, but we can reproduce regularly with a job that uses HiveContext.&lt;/p&gt;

&lt;p&gt;Anyway, I post this here, because the error we are getting is the same that started this issue:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;class &lt;span class=&quot;code-quote&quot;&gt;&quot;javax.servlet.FilterRegistration&quot;&lt;/span&gt;&apos;s signer information does not match signer information of other classes in the same &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ve noticed that the Oozie sharelib includes javax.servlet-3.0.0.v201112011016.jar.  I also see that spark-assembly.jar includes a javax.servlet.FilterRegistration class, although its hard for me to tell which version.  The jetty pom.xml files in spark-assembly.jar seem to say &lt;tt&gt;javax.servlet.&amp;#42;;version=&quot;2.6.0&quot;&lt;/tt&gt;, but I&apos;m a little green on how all these dependencies get resolved.  I don&apos;t see any javax.servlet .jars in any of /usr/lib/hadoop* (where CDH installs hadoop jars).&lt;/p&gt;

&lt;p&gt;Help!  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  If this is not related to this issue, I&apos;ll open a new one.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12927337">HIVE-12783</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12642813" name="log.txt" size="67137" author="gq" created="Thu, 1 May 2014 07:44:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>389993</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1v6bb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>390231</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>