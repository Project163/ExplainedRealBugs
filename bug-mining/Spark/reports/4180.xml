<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:48:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-18107] Insert overwrite statement runs much slower in spark-sql than it does in hive-client</title>
                <link>https://issues.apache.org/jira/browse/SPARK-18107</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I find insert overwrite statement running in spark-sql or spark-shell spends much more time than it does in  hive-client (i start it in apache-hive-2.0.1-bin/bin/hive ), where spark costs about ten minutes but hive-client just costs less than 20 seconds.&lt;/p&gt;

&lt;p&gt;These are the steps I took.&lt;/p&gt;

&lt;p&gt;Test sql is :&lt;/p&gt;

&lt;p&gt;insert overwrite table login4game partition(pt=&apos;mix_en&apos;,dt=&apos;2016-10-21&apos;)    select distinct account_name,role_id,server,&apos;1476979200&apos; as recdate, &apos;mix&apos; as platform, &apos;mix&apos; as pid, &apos;mix&apos; as dev from tbllog_login  where pt=&apos;mix_en&apos; and  dt=&apos;2016-10-21&apos; ;&lt;/p&gt;

&lt;p&gt;there are 257128 lines of data in tbllog_login with partition(pt=&apos;mix_en&apos;,dt=&apos;2016-10-21&apos;)&lt;/p&gt;


&lt;p&gt;ps:&lt;/p&gt;

&lt;p&gt;I&apos;m sure it must be &quot;insert overwrite&quot; costing a lot of time in spark, may be when doing overwrite, it need to spend a lot of time in io or in something else.&lt;/p&gt;

&lt;p&gt;I also compare the executing time between insert overwrite statement and insert into statement.&lt;/p&gt;

&lt;p&gt;1. insert overwrite statement and insert into statement in spark:&lt;/p&gt;

&lt;p&gt;insert overwrite statement costs about 10 minutes&lt;br/&gt;
insert into statement costs about 30 seconds&lt;/p&gt;


&lt;p&gt;2. insert into statement in spark and insert into statement in hive-client:&lt;/p&gt;

&lt;p&gt;spark costs about 30 seconds&lt;br/&gt;
hive-client costs about 20 seconds&lt;br/&gt;
the difference is little that we can ignore&lt;/p&gt;





</description>
                <environment>&lt;p&gt;spark 2.0.0&lt;br/&gt;
hive 2.0.1&lt;/p&gt;</environment>
        <key id="13015286">SPARK-18107</key>
            <summary>Insert overwrite statement runs much slower in spark-sql than it does in hive-client</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="viirya">L. C. Hsieh</assignee>
                                    <reporter username="snodawn">snodawn</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Oct 2016 01:53:09 +0000</created>
                <updated>Thu, 17 Jun 2021 18:28:55 +0000</updated>
                            <resolved>Tue, 1 Nov 2016 07:23:46 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="15607896" author="viirya" created="Wed, 26 Oct 2016 08:52:09 +0000"  >&lt;p&gt;Can you provide more information about this? Like is it a Hive table or data source table you insert overwrite into?&lt;/p&gt;</comment>
                            <comment id="15610454" author="snodawn" created="Thu, 27 Oct 2016 02:56:41 +0000"  >&lt;p&gt;sure, the source table and the target table are both Hive table, like this:&lt;/p&gt;

&lt;p&gt;source table:&lt;/p&gt;

&lt;p&gt;CREATE TABLE `tbllog_login`(`server` string,`role_id` bigint, `account_name` string, `happened_time` int)&lt;br/&gt;
PARTITIONED BY (`pt` string, `dt` string)&lt;br/&gt;
stored as orc;&lt;/p&gt;

&lt;p&gt;target table:&lt;/p&gt;

&lt;p&gt;CREATE TABLE `login4game`(`account_name` string, `role_id` string, `server_id` string, `recdate` string)&lt;br/&gt;
PARTITIONED BY (`pt` string, `dt` string) stored as orc;&lt;/p&gt;

&lt;p&gt;to confirm my guess, I also do some tests between insert overwrite and insert into statement, where insert overwrite sometimes can be separated into drop selected partition and then insert into table , so there are my steps:&lt;/p&gt;

&lt;p&gt;insert overwrite statement is :&lt;/p&gt;

&lt;p&gt;insert overwrite table login4game partition(pt=&apos;mix_en&apos;,dt=&apos;2016-10-21&apos;) select distinct account_name,role_id,server,&apos;1476979200&apos; as recdate, &apos;mix&apos; as platform, &apos;mix&apos; as pid, &apos;mix&apos; as dev from tbllog_login where pt=&apos;mix_en&apos; and dt=&apos;2016-10-21&apos;&lt;/p&gt;

&lt;p&gt;I separate it into two steps in spark:&lt;/p&gt;

&lt;p&gt;1. ALTER TABLE login4game DROP IF EXISTS PARTITION (pt=&apos;mix_en&apos;, dt=&apos;2016-10-21&apos;) &lt;/p&gt;

&lt;p&gt;2. insert into table login4game partition(pt=&apos;mix_en&apos;,dt=&apos;2016-10-21&apos;) select distinct account_name,role_id,server,&apos;1476979200&apos; as recdate, &apos;mix&apos; as platform, &apos;mix&apos; as pid, &apos;mix&apos; as dev from tbllog_login where pt=&apos;mix_en&apos; and dt=&apos;2016-10-21&apos;&lt;/p&gt;

&lt;p&gt;where I can get the same result as it does in insert overwrite statement in spark, but it only costs me about 1 minutes, but if I runs insert overwrite statement, it will cost me about 10 minutes.&lt;/p&gt;


&lt;p&gt;if it&apos;s necessary to provide the execution logs, I can upload it later.&lt;/p&gt;
</comment>
                            <comment id="15610962" author="viirya" created="Thu, 27 Oct 2016 07:07:04 +0000"  >&lt;p&gt;I checked the current codes for inserting into Hive table in Spark. It delegates the operation to Hive library.&lt;/p&gt;

&lt;p&gt;Because you use a much new Hive version (2.0.1), I guess the performance difference is between your Hive version and older Hive version Spark uses.&lt;/p&gt;</comment>
                            <comment id="15610979" author="viirya" created="Thu, 27 Oct 2016 07:12:10 +0000"  >&lt;p&gt;I found a PR at Hive which should be the one to largely improve insert overwrite on Hive.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/hive/commit/ba21806b77287e237e1aa68fa169d2a81e07346d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/commit/ba21806b77287e237e1aa68fa169d2a81e07346d&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15611083" author="viirya" created="Thu, 27 Oct 2016 07:54:07 +0000"  >&lt;p&gt;I can create a PR for this. But it may require &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=snodawn&quot; class=&quot;user-hover&quot; rel=&quot;snodawn&quot;&gt;snodawn&lt;/a&gt; to verify the performance since I don&apos;t have Hive 2.0.1 environment to compare them.&lt;/p&gt;</comment>
                            <comment id="15612033" author="snodawn" created="Thu, 27 Oct 2016 14:21:46 +0000"  >&lt;p&gt;Thanks for your reply. I have tested the performance between hive 2.0.1 and hive 1.2.1, which verifies that you may be true !&lt;/p&gt;

&lt;p&gt;The version 1.2.1 is downloaded from here, &lt;a href=&quot;http://mirror.bit.edu.cn/apache/hive/hive-1.2.1/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mirror.bit.edu.cn/apache/hive/hive-1.2.1/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;where the patch &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11940&quot; title=&quot;&amp;quot;INSERT OVERWRITE&amp;quot; query is very slow because it creates one &amp;quot;distcp&amp;quot; per file to copy data from staging directory to target directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11940&quot;&gt;&lt;del&gt;HIVE-11940&lt;/del&gt;&lt;/a&gt; is available after hive 2.0.0&lt;/p&gt;

&lt;p&gt;I run the same sql between version Hive 1.2.1 and Hive 2.0.1 with the same data.&lt;/p&gt;

&lt;p&gt;In Hive 1.2.1, it costs 520.037 seconds to complete the insert overwrite statement which is similar to what it does in spark (with 1.2.1 hive version), but costs 32.183 seconds in completing the insert into statement.&lt;/p&gt;

&lt;p&gt;In Hive 2.0.1, it costs 35.975 seconds to complete the insert overwrite statement.&lt;/p&gt;


&lt;p&gt;I will paste the execution logs in a new comment to show the running process between Hive 1.2.1 and Hive 2.0.1 &lt;/p&gt;


</comment>
                            <comment id="15612043" author="snodawn" created="Thu, 27 Oct 2016 14:25:49 +0000"  >&lt;p&gt;Here is the execution logs of Hive 1.2.1,  &lt;span class=&quot;error&quot;&gt;&amp;#91;Insert overwrite&amp;#93;&lt;/span&gt;&lt;/p&gt;


&lt;p&gt;0: jdbc:hive2://master.mydata.com:23250&amp;gt; insert overwrite table login4game partition(pt=&apos;mix_en&apos;,dt=&apos;2016-10-21&apos;)    select distinct account_name,role_id,server,&apos;1476979200&apos; as recdate, &apos;mix&apos; as platform, &apos;mix&apos; as pid, &apos;mix&apos; as dev from tbllog_login  where pt=&apos;mix_en&apos; and  dt=&apos;2016-10-21&apos; ;&lt;br/&gt;
INFO  : Number of reduce tasks not specified. Estimated from input data size: 1&lt;br/&gt;
INFO  : In order to change the average load for a reducer (in bytes):&lt;br/&gt;
INFO  :   set hive.exec.reducers.bytes.per.reducer=&amp;lt;number&amp;gt;&lt;br/&gt;
INFO  : In order to limit the maximum number of reducers:&lt;br/&gt;
INFO  :   set hive.exec.reducers.max=&amp;lt;number&amp;gt;&lt;br/&gt;
INFO  : In order to set a constant number of reducers:&lt;br/&gt;
INFO  :   set mapreduce.job.reduces=&amp;lt;number&amp;gt;&lt;br/&gt;
INFO  : number of splits:3&lt;br/&gt;
INFO  : Submitting tokens for job: job_1472611548204_72607&lt;br/&gt;
INFO  : The url to track the job: &lt;a href=&quot;http://master.mydata.com:9378/proxy/application_1472611548204_72607/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://master.mydata.com:9378/proxy/application_1472611548204_72607/&lt;/a&gt;&lt;br/&gt;
INFO  : Starting Job = job_1472611548204_72607, Tracking URL = &lt;a href=&quot;http://master.mydata.com:9378/proxy/application_1472611548204_72607/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://master.mydata.com:9378/proxy/application_1472611548204_72607/&lt;/a&gt;&lt;br/&gt;
INFO  : Kill Command = /usr/local/hadoop/bin/hadoop job  -kill job_1472611548204_72607&lt;br/&gt;
INFO  : Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 1&lt;br/&gt;
INFO  : 2016-10-27 21:40:59,879 Stage-1 map = 0%,  reduce = 0%&lt;br/&gt;
INFO  : 2016-10-27 21:41:08,391 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 2.82 sec&lt;br/&gt;
INFO  : 2016-10-27 21:41:09,452 Stage-1 map = 67%,  reduce = 0%, Cumulative CPU 9.79 sec&lt;br/&gt;
INFO  : 2016-10-27 21:41:11,610 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 17.62 sec&lt;br/&gt;
INFO  : 2016-10-27 21:41:21,171 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 25.56 sec&lt;br/&gt;
INFO  : MapReduce Total cumulative CPU time: 25 seconds 560 msec&lt;br/&gt;
INFO  : Ended Job = job_1472611548204_72607&lt;br/&gt;
INFO  : Loading data to table my_log.login4game partition (pt=mix_en, dt=2016-10-21) from hdfs://master.mydata.com:45660/data/warehouse/staging/.hive-staging_hive_2016-10-27_21-40-48_927_5041661215303190236-1/-ext-10000&lt;br/&gt;
INFO  : Partition my_log.login4game&lt;/p&gt;
{pt=mix_en, dt=2016-10-21}
&lt;p&gt; stats: &lt;span class=&quot;error&quot;&gt;&amp;#91;numFiles=1, numRows=66138, totalSize=485769, rawDataSize=41402388&amp;#93;&lt;/span&gt;&lt;br/&gt;
No rows affected (520.037 seconds)&lt;/p&gt;</comment>
                            <comment id="15612044" author="viirya" created="Thu, 27 Oct 2016 14:26:02 +0000"  >&lt;p&gt;Looks like &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11940&quot; title=&quot;&amp;quot;INSERT OVERWRITE&amp;quot; query is very slow because it creates one &amp;quot;distcp&amp;quot; per file to copy data from staging directory to target directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11940&quot;&gt;&lt;del&gt;HIVE-11940&lt;/del&gt;&lt;/a&gt; largely improves insert overwrite performance. I have the patch ready and I will submit a PR tomorrow. It will be good if you can test it to see it improves the performance then.&lt;/p&gt;</comment>
                            <comment id="15612047" author="snodawn" created="Thu, 27 Oct 2016 14:26:45 +0000"  >&lt;p&gt;Here is the execution logs of Hive 1.2.1, &lt;span class=&quot;error&quot;&gt;&amp;#91;Insert into&amp;#93;&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;0: jdbc:hive2://master.mydata.com:23250&amp;gt; insert into table login4game partition(pt=&apos;mix_en&apos;,dt=&apos;2016-10-21&apos;)    select distinct account_name,role_id,server,&apos;1476979200&apos; as recdate, &apos;mix&apos; as platform, &apos;mix&apos; as pid, &apos;mix&apos; as dev from tbllog_login  where pt=&apos;mix_en&apos; and  dt=&apos;2016-10-21&apos; ;&lt;br/&gt;
INFO  : Number of reduce tasks not specified. Estimated from input data size: 1&lt;br/&gt;
INFO  : In order to change the average load for a reducer (in bytes):&lt;br/&gt;
INFO  :   set hive.exec.reducers.bytes.per.reducer=&amp;lt;number&amp;gt;&lt;br/&gt;
INFO  : In order to limit the maximum number of reducers:&lt;br/&gt;
INFO  :   set hive.exec.reducers.max=&amp;lt;number&amp;gt;&lt;br/&gt;
INFO  : In order to set a constant number of reducers:&lt;br/&gt;
INFO  :   set mapreduce.job.reduces=&amp;lt;number&amp;gt;&lt;br/&gt;
INFO  : number of splits:3&lt;br/&gt;
INFO  : Submitting tokens for job: job_1472611548204_72608&lt;br/&gt;
INFO  : The url to track the job: &lt;a href=&quot;http://master.mydata.com:9378/proxy/application_1472611548204_72608/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://master.mydata.com:9378/proxy/application_1472611548204_72608/&lt;/a&gt;&lt;br/&gt;
INFO  : Starting Job = job_1472611548204_72608, Tracking URL = &lt;a href=&quot;http://master.mydata.com:9378/proxy/application_1472611548204_72608/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://master.mydata.com:9378/proxy/application_1472611548204_72608/&lt;/a&gt;&lt;br/&gt;
INFO  : Kill Command = /usr/local/hadoop/bin/hadoop job  -kill job_1472611548204_72608&lt;br/&gt;
INFO  : Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 1&lt;br/&gt;
INFO  : 2016-10-27 21:51:37,717 Stage-1 map = 0%,  reduce = 0%&lt;br/&gt;
INFO  : 2016-10-27 21:51:46,455 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 3.17 sec&lt;br/&gt;
INFO  : 2016-10-27 21:51:48,576 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 16.16 sec&lt;br/&gt;
INFO  : 2016-10-27 21:51:56,945 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 22.7 sec&lt;br/&gt;
INFO  : MapReduce Total cumulative CPU time: 22 seconds 700 msec&lt;br/&gt;
INFO  : Ended Job = job_1472611548204_72608&lt;br/&gt;
INFO  : Loading data to table my_log.login4game partition (pt=mix_en, dt=2016-10-21) from hdfs://master.mydata.com:45660/data/warehouse/staging/.hive-staging_hive_2016-10-27_21-51-26_264_2085348807080462789-1/-ext-10000&lt;br/&gt;
INFO  : Partition my_log.login4game&lt;/p&gt;
{pt=mix_en, dt=2016-10-21}
&lt;p&gt; stats: &lt;span class=&quot;error&quot;&gt;&amp;#91;numFiles=2, numRows=132276, totalSize=971551, rawDataSize=82804776&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;No rows affected (32.183 seconds)&lt;/p&gt;</comment>
                            <comment id="15612050" author="snodawn" created="Thu, 27 Oct 2016 14:28:30 +0000"  >&lt;p&gt;Here is the execution logs of Hive 2.0.1, &lt;span class=&quot;error&quot;&gt;&amp;#91;Insert overwrite&amp;#93;&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;0: jdbc:hive2://master.mydata.com:23250&amp;gt; insert overwrite table login4game partition(pt=&apos;mix_en&apos;,dt=&apos;2016-10-21&apos;)    select distinct account_name,role_id,server,&apos;1476979200&apos; as recdate, &apos;mix&apos; as platform, &apos;mix&apos; as pid, &apos;mix&apos; as dev from tbllog_login  where pt=&apos;mix_en&apos; and  dt=&apos;2016-10-21&apos; ;&lt;br/&gt;
INFO  : Compiling command(queryId=hadoop_20161027215659_8a71044b-364c-4e41-a168-10213add0d5b): insert overwrite table login4game partition(pt=&apos;mix_en&apos;,dt=&apos;2016-10-21&apos;)    select distinct account_name,role_id,server,&apos;1476979200&apos; as recdate, &apos;mix&apos; as platform, &apos;mix&apos; as pid, &apos;mix&apos; as dev from tbllog_login  where pt=&apos;mix_en&apos; and  dt=&apos;2016-10-21&apos;&lt;br/&gt;
INFO  : Semantic Analysis Completed&lt;br/&gt;
INFO  : Returning Hive schema: Schema(fieldSchemas:&lt;span class=&quot;error&quot;&gt;&amp;#91;FieldSchema(name:_col0, type:string, comment:null), FieldSchema(name:_col1, type:string, comment:null), FieldSchema(name:_col2, type:string, comment:null), FieldSchema(name:_col3, type:string, comment:null), FieldSchema(name:_col4, type:string, comment:null), FieldSchema(name:_col5, type:string, comment:null), FieldSchema(name:_col6, type:string, comment:null)&amp;#93;&lt;/span&gt;, properties:null)&lt;br/&gt;
INFO  : Completed compiling command(queryId=hadoop_20161027215659_8a71044b-364c-4e41-a168-10213add0d5b); Time taken: 1.142 seconds&lt;br/&gt;
DEBUG : Encoding valid txns info 109561:56926:56928:56930:56932:56934:56936:56938:56940:56942:56944:56946:56948:56950:56952:56954:56956:56958:56960:56962:56964:56966:56968:56970:56972:56978:56980:56982:56984:57076:57077:57078:57079:57080:57081:57096:57102:57106:57119:57121:57123:57124:57125:57126:57127:57128:57129:57130:57131:57132:57133:57134:57135:57136:57137:57138:57139:57140:57141:80435:80465:80715:80785:93705 txnid:0&lt;br/&gt;
INFO  : Executing command(queryId=hadoop_20161027215659_8a71044b-364c-4e41-a168-10213add0d5b): insert overwrite table login4game partition(pt=&apos;mix_en&apos;,dt=&apos;2016-10-21&apos;)    select distinct account_name,role_id,server,&apos;1476979200&apos; as recdate, &apos;mix&apos; as platform, &apos;mix&apos; as pid, &apos;mix&apos; as dev from tbllog_login  where pt=&apos;mix_en&apos; and  dt=&apos;2016-10-21&apos;&lt;br/&gt;
WARN  : Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.&lt;br/&gt;
INFO  : WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.&lt;br/&gt;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.&lt;br/&gt;
INFO  : Query ID = hadoop_20161027215659_8a71044b-364c-4e41-a168-10213add0d5b&lt;br/&gt;
INFO  : Total jobs = 1&lt;br/&gt;
INFO  : Launching Job 1 out of 1&lt;br/&gt;
INFO  : Starting task &lt;span class=&quot;error&quot;&gt;&amp;#91;Stage-1:MAPRED&amp;#93;&lt;/span&gt; in serial mode&lt;br/&gt;
INFO  : Number of reduce tasks not specified. Estimated from input data size: 1&lt;br/&gt;
INFO  : In order to change the average load for a reducer (in bytes):&lt;br/&gt;
INFO  :   set hive.exec.reducers.bytes.per.reducer=&amp;lt;number&amp;gt;&lt;br/&gt;
INFO  : In order to limit the maximum number of reducers:&lt;br/&gt;
INFO  :   set hive.exec.reducers.max=&amp;lt;number&amp;gt;&lt;br/&gt;
INFO  : In order to set a constant number of reducers:&lt;br/&gt;
INFO  :   set mapreduce.job.reduces=&amp;lt;number&amp;gt;&lt;br/&gt;
DEBUG : Configuring job job_1472611548204_72609 with /tmp/hadoop-yarn/staging/hadoop/.staging/job_1472611548204_72609 as the submit dir&lt;br/&gt;
DEBUG : adding the following namenodes&apos; delegation tokens:&lt;span class=&quot;error&quot;&gt;&amp;#91;hdfs://master.mydata.com:45660&amp;#93;&lt;/span&gt;&lt;br/&gt;
DEBUG : Creating splits at hdfs://master.mydata.com:45660/tmp/hadoop-yarn/staging/hadoop/.staging/job_1472611548204_72609&lt;br/&gt;
INFO  : number of splits:3&lt;br/&gt;
INFO  : Submitting tokens for job: job_1472611548204_72609&lt;br/&gt;
INFO  : The url to track the job: &lt;a href=&quot;http://master.mydata.com:9378/proxy/application_1472611548204_72609/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://master.mydata.com:9378/proxy/application_1472611548204_72609/&lt;/a&gt;&lt;br/&gt;
INFO  : Starting Job = job_1472611548204_72609, Tracking URL = &lt;a href=&quot;http://master.mydata.com:9378/proxy/application_1472611548204_72609/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://master.mydata.com:9378/proxy/application_1472611548204_72609/&lt;/a&gt;&lt;br/&gt;
INFO  : Kill Command = /usr/local/hadoop/bin/hadoop job  -kill job_1472611548204_72609&lt;br/&gt;
INFO  : Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 1&lt;br/&gt;
INFO  : 2016-10-27 21:57:14,183 Stage-1 map = 0%,  reduce = 0%&lt;br/&gt;
INFO  : 2016-10-27 21:57:22,745 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 3.19 sec&lt;br/&gt;
INFO  : 2016-10-27 21:57:24,910 Stage-1 map = 67%,  reduce = 0%, Cumulative CPU 11.16 sec&lt;br/&gt;
INFO  : 2016-10-27 21:57:25,991 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 19.65 sec&lt;br/&gt;
INFO  : 2016-10-27 21:57:32,455 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 26.72 sec&lt;br/&gt;
INFO  : MapReduce Total cumulative CPU time: 26 seconds 720 msec&lt;br/&gt;
INFO  : Ended Job = job_1472611548204_72609&lt;br/&gt;
INFO  : Starting task &lt;span class=&quot;error&quot;&gt;&amp;#91;Stage-7:CONDITIONAL&amp;#93;&lt;/span&gt; in serial mode&lt;br/&gt;
INFO  : Stage-4 is selected by condition resolver.&lt;br/&gt;
INFO  : Stage-3 is filtered out by condition resolver.&lt;br/&gt;
INFO  : Stage-5 is filtered out by condition resolver.&lt;br/&gt;
INFO  : Starting task &lt;span class=&quot;error&quot;&gt;&amp;#91;Stage-4:MOVE&amp;#93;&lt;/span&gt; in serial mode&lt;br/&gt;
INFO  : Moving data to: hdfs://master.mydata.com:45660/data/warehouse/staging/.hive-staging_hive_2016-10-27_21-56-59_013_3776500562235975275-1/-ext-10000 from hdfs://master.mydata.com:45660/data/warehouse/staging/.hive-staging_hive_2016-10-27_21-56-59_013_3776500562235975275-1/-ext-10002&lt;br/&gt;
INFO  : Starting task &lt;span class=&quot;error&quot;&gt;&amp;#91;Stage-0:MOVE&amp;#93;&lt;/span&gt; in serial mode&lt;br/&gt;
INFO  : Loading data to table my_log.login4game partition (pt=mix_en, dt=2016-10-21) from hdfs://master.mydata.com:45660/data/warehouse/staging/.hive-staging_hive_2016-10-27_21-56-59_013_3776500562235975275-1/-ext-10000&lt;br/&gt;
INFO  : Starting task &lt;span class=&quot;error&quot;&gt;&amp;#91;Stage-2:STATS&amp;#93;&lt;/span&gt; in serial mode&lt;br/&gt;
INFO  : MapReduce Jobs Launched: &lt;br/&gt;
INFO  : Stage-Stage-1: Map: 3  Reduce: 1   Cumulative CPU: 26.72 sec   HDFS Read: 53287090 HDFS Write: 485485 SUCCESS&lt;br/&gt;
INFO  : Total MapReduce CPU Time Spent: 26 seconds 720 msec&lt;br/&gt;
INFO  : Completed executing command(queryId=hadoop_20161027215659_8a71044b-364c-4e41-a168-10213add0d5b); Time taken: 34.541 seconds&lt;br/&gt;
INFO  : OK&lt;br/&gt;
DEBUG : Shutting down query insert overwrite table login4game partition(pt=&apos;mix_en&apos;,dt=&apos;2016-10-21&apos;)    select distinct account_name,role_id,server,&apos;1476979200&apos; as recdate, &apos;mix&apos; as platform, &apos;mix&apos; as pid, &apos;mix&apos; as dev from tbllog_login  where pt=&apos;mix_en&apos; and  dt=&apos;2016-10-21&apos;&lt;br/&gt;
No rows affected (35.975 seconds)&lt;/p&gt;</comment>
                            <comment id="15613944" author="snodawn" created="Fri, 28 Oct 2016 01:38:32 +0000"  >&lt;p&gt;Ok, it sounds good, thanks! I would have a try later.&lt;/p&gt;</comment>
                            <comment id="15614009" author="apachespark" created="Fri, 28 Oct 2016 02:08:06 +0000"  >&lt;p&gt;User &apos;viirya&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15667&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15667&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15617645" author="snodawn" created="Sat, 29 Oct 2016 07:33:39 +0000"  >&lt;p&gt; I have tested the performance before and after the patch &lt;a href=&quot;https://github.com/apache/spark/pull/15667&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15667&lt;/a&gt; . But it seems to improve a few after patching, where it costs 531 seconds before patching, and costs 518 seconds after patching. &lt;/p&gt;

&lt;p&gt;I will add the execution logs in a new comment later.&lt;/p&gt;</comment>
                            <comment id="15617654" author="snodawn" created="Sat, 29 Oct 2016 07:40:27 +0000"  >&lt;p&gt;insert overwrite in spark 2.0.0&#65292; without patch&lt;/p&gt;

&lt;p&gt;scala&amp;gt; val befores =System.currentTimeMillis();spark.sql(&quot;insert overwrite table login4game partition(pt=&apos;mix_en&apos;,dt=&apos;2016-10-21&apos;)    select distinct account_name,role_id,server,&apos;1476979200&apos; as recdate, &apos;mix&apos; as platform, &apos;mix&apos; as pid, &apos;mix&apos; as dev from tbllog_login  where pt=&apos;mix_en&apos; and  dt=&apos;2016-10-21&apos; &quot;);val interval=System.currentTimeMillis()-befores;println(s&quot;insertval is =&amp;gt; ${interval/1000} seconds&quot;)&lt;br/&gt;
3549.075: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 435328K-&amp;gt;77744K(566784K)&amp;#93;&lt;/span&gt; 826575K-&amp;gt;469112K(1232384K), 0.0463220 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.27 sys=0.00, real=0.04 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
3549.394: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 511920K-&amp;gt;26018K(566784K)&amp;#93;&lt;/span&gt; 903288K-&amp;gt;459991K(1232384K), 0.0804300 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.44 sys=0.00, real=0.08 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 4:========&amp;gt;                                                (11 + 8) / 72&amp;#93;&lt;/span&gt;3549.698: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 463266K-&amp;gt;55486K(493056K)&amp;#93;&lt;/span&gt; 897239K-&amp;gt;490323K(1158656K), 0.0359570 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.17 sys=0.00, real=0.04 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 4:===============&amp;gt;                                         (19 + 8) / 72&amp;#93;&lt;/span&gt;3549.929: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 492734K-&amp;gt;82976K(563712K)&amp;#93;&lt;/span&gt; 927571K-&amp;gt;522173K(1229312K), 0.0328120 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.16 sys=0.01, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 4:===============================&amp;gt;                         (40 + 8) / 72&amp;#93;&lt;/span&gt;3550.166: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 520736K-&amp;gt;29045K(564736K)&amp;#93;&lt;/span&gt; 959933K-&amp;gt;468617K(1230336K), 0.0244060 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.12 sys=0.00, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 4:====================================&amp;gt;                    (46 + 8) / 72&amp;#93;&lt;/span&gt;3550.392: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 466309K-&amp;gt;41380K(567296K)&amp;#93;&lt;/span&gt; 905881K-&amp;gt;481176K(1232896K), 0.0320150 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.16 sys=0.00, real=0.04 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 4:===========================================&amp;gt;             (55 + 8) / 72&amp;#93;&lt;/span&gt;3550.603: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 486820K-&amp;gt;96197K(541696K)&amp;#93;&lt;/span&gt; 926616K-&amp;gt;536271K(1207296K), 0.0326490 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.17 sys=0.00, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 4:=================================================&amp;gt;       (63 + 8) / 72&amp;#93;&lt;/span&gt;3550.868: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 541637K-&amp;gt;21696K(567296K)&amp;#93;&lt;/span&gt; 981711K-&amp;gt;462242K(1232896K), 0.0259070 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.11 sys=0.00, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:&amp;gt;                                                        (0 + 0) / 200&amp;#93;&lt;/span&gt;3551.127: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 457912K-&amp;gt;125270K(561664K)&amp;#93;&lt;/span&gt; 898458K-&amp;gt;565984K(1227264K), 0.0497940 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.25 sys=0.00, real=0.05 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
3551.328: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 561494K-&amp;gt;104705K(527872K)&amp;#93;&lt;/span&gt; 1002208K-&amp;gt;552355K(1193472K), 0.0489880 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.28 sys=0.00, real=0.05 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
3551.513: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 494819K-&amp;gt;94833K(485376K)&amp;#93;&lt;/span&gt; 942469K-&amp;gt;544947K(1150976K), 0.0472640 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.26 sys=0.00, real=0.05 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:====&amp;gt;                                                   (17 + 8) / 200&amp;#93;&lt;/span&gt;3551.701: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 484977K-&amp;gt;90004K(545792K)&amp;#93;&lt;/span&gt; 935091K-&amp;gt;544576K(1211392K), 0.0543700 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.33 sys=0.00, real=0.06 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:=======&amp;gt;                                                (25 + 8) / 200&amp;#93;&lt;/span&gt;3551.878: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 480005K-&amp;gt;96725K(543744K)&amp;#93;&lt;/span&gt; 934833K-&amp;gt;565661K(1209344K), 0.0475640 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.24 sys=0.00, real=0.05 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:=========&amp;gt;                                              (34 + 8) / 200&amp;#93;&lt;/span&gt;3552.093: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 486869K-&amp;gt;86720K(539136K)&amp;#93;&lt;/span&gt; 964767K-&amp;gt;567333K(1204736K), 0.0383360 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.23 sys=0.00, real=0.04 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:===========&amp;gt;                                            (40 + 8) / 200&amp;#93;&lt;/span&gt;3552.351: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 478363K-&amp;gt;73147K(541696K)&amp;#93;&lt;/span&gt; 958976K-&amp;gt;556404K(1207296K), 0.0401180 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.21 sys=0.00, real=0.04 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:=============&amp;gt;                                          (48 + 8) / 200&amp;#93;&lt;/span&gt;3552.519: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 464827K-&amp;gt;74781K(541184K)&amp;#93;&lt;/span&gt; 948084K-&amp;gt;560529K(1206784K), 0.0459060 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.26 sys=0.00, real=0.05 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:================&amp;gt;                                       (60 + 8) / 200&amp;#93;&lt;/span&gt;3552.834: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 480797K-&amp;gt;68184K(543232K)&amp;#93;&lt;/span&gt; 966545K-&amp;gt;555417K(1208832K), 0.0403320 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.21 sys=0.00, real=0.05 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:==================&amp;gt;                                     (67 + 8) / 200&amp;#93;&lt;/span&gt;3553.031: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 474200K-&amp;gt;53137K(560640K)&amp;#93;&lt;/span&gt; 961433K-&amp;gt;541548K(1226240K), 0.0306190 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.15 sys=0.00, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:=====================&amp;gt;                                  (77 + 8) / 200&amp;#93;&lt;/span&gt;3553.219: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 481681K-&amp;gt;54172K(559616K)&amp;#93;&lt;/span&gt; 970092K-&amp;gt;543955K(1225216K), 0.0334520 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.17 sys=0.00, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:========================&amp;gt;                               (88 + 8) / 200&amp;#93;&lt;/span&gt;3553.408: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 482621K-&amp;gt;61091K(564736K)&amp;#93;&lt;/span&gt; 972404K-&amp;gt;552016K(1230336K), 0.0398400 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.20 sys=0.00, real=0.04 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:==========================&amp;gt;                             (96 + 8) / 200&amp;#93;&lt;/span&gt;3553.596: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 500899K-&amp;gt;63593K(564736K)&amp;#93;&lt;/span&gt; 992091K-&amp;gt;556228K(1230336K), 0.0350330 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.20 sys=0.00, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
3553.780: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 503401K-&amp;gt;63313K(570368K)&amp;#93;&lt;/span&gt; 996039K-&amp;gt;557297K(1235968K), 0.0344000 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.19 sys=0.00, real=0.04 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:============================&amp;gt;                          (104 + 8) / 200&amp;#93;&lt;/span&gt;3553.962: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 516945K-&amp;gt;75754K(570368K)&amp;#93;&lt;/span&gt; 1010929K-&amp;gt;571824K(1235968K), 0.0439400 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.27 sys=0.00, real=0.05 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:================================&amp;gt;                      (119 + 8) / 200&amp;#93;&lt;/span&gt;3554.250: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 529386K-&amp;gt;51713K(581120K)&amp;#93;&lt;/span&gt; 1025456K-&amp;gt;550074K(1246720K), 0.0335360 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.19 sys=0.00, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:===================================&amp;gt;                   (128 + 8) / 200&amp;#93;&lt;/span&gt;3554.449: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 518657K-&amp;gt;82800K(580096K)&amp;#93;&lt;/span&gt; 1017018K-&amp;gt;582606K(1245696K), 0.0401180 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.24 sys=0.00, real=0.04 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:=====================================&amp;gt;                 (136 + 8) / 200&amp;#93;&lt;/span&gt;3554.662: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 549674K-&amp;gt;77682K(584192K)&amp;#93;&lt;/span&gt; 1049481K-&amp;gt;580293K(1249792K), 0.0385940 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.23 sys=0.01, real=0.04 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:=======================================&amp;gt;               (144 + 8) / 200&amp;#93;&lt;/span&gt;3554.863: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 549652K-&amp;gt;96461K(568832K)&amp;#93;&lt;/span&gt; 1052263K-&amp;gt;602122K(1234432K), 0.0415910 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.25 sys=0.00, real=0.05 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:==========================================&amp;gt;            (153 + 8) / 200&amp;#93;&lt;/span&gt;3555.071: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 568372K-&amp;gt;95716K(573952K)&amp;#93;&lt;/span&gt; 1074033K-&amp;gt;616225K(1239552K), 0.0424680 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.24 sys=0.01, real=0.04 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:============================================&amp;gt;          (161 + 8) / 200&amp;#93;&lt;/span&gt;3555.277: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 551396K-&amp;gt;83988K(577536K)&amp;#93;&lt;/span&gt; 1071905K-&amp;gt;606963K(1243136K), 0.0379390 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.22 sys=0.00, real=0.04 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:==============================================&amp;gt;        (170 + 8) / 200&amp;#93;&lt;/span&gt;3555.482: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 539448K-&amp;gt;99534K(569856K)&amp;#93;&lt;/span&gt; 1062423K-&amp;gt;624985K(1235456K), 0.0403270 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.23 sys=0.01, real=0.04 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:================================================&amp;gt;      (178 + 8) / 200&amp;#93;&lt;/span&gt;3555.688: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 548828K-&amp;gt;68376K(574464K)&amp;#93;&lt;/span&gt; 1074279K-&amp;gt;596302K(1240064K), 0.0304960 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.18 sys=0.00, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 5:===================================================&amp;gt;   (186 + 8) / 200&amp;#93;&lt;/span&gt;3555.867: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 517912K-&amp;gt;72104K(565760K)&amp;#93;&lt;/span&gt; 1045838K-&amp;gt;601477K(1231360K), 0.0294950 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.18 sys=0.00, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
Moved: &apos;hdfs://master.com:45660/data/warehouse/my_log.db/login4game/pt=mix_en/dt=2016-10-21/part-00000&apos; to trash at: hdfs://master.com:45660/user/hadoop/.Trash/Current&lt;br/&gt;
Moved: &apos;hdfs://master.com:45660/data/warehouse/my_log.db/login4game/pt=mix_en/dt=2016-10-21/part-00000_copy_1&apos; to trash at: hdfs://master.com:45660/user/hadoop/.Trash/Current&lt;br/&gt;
Moved: &apos;hdfs://master.com:45660/data/warehouse/my_log.db/login4game/pt=mix_en/dt=2016-10-21/part-00001&apos; to trash at: hdfs://master.com:45660/user/hadoop/.Trash/Current&lt;br/&gt;
Moved: &apos;hdfs://master.com:45660/data/warehouse/my_log.db/login4game/pt=mix_en/dt=2016-10-21/part-00001_copy_1&apos; to trash at: hdfs://master.com:45660/user/hadoop/.Trash/Current&lt;/p&gt;

&lt;p&gt;....&lt;/p&gt;

&lt;p&gt;Moved: &apos;hdfs://master.com:45660/data/warehouse/my_log.db/login4game/pt=mix_en/dt=2016-10-21/part-00199&apos; to trash at: hdfs://master.com:45660/user/hadoop/.Trash/Current&lt;br/&gt;
Moved: &apos;hdfs://master.com:45660/data/warehouse/my_log.db/login4game/pt=mix_en/dt=2016-10-21/part-00199_copy_1&apos; to trash at: hdfs://master.com:45660/user/hadoop/.Trash/Current&lt;br/&gt;
3561.575: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 524712K-&amp;gt;1952K(570880K)&amp;#93;&lt;/span&gt; 1054085K-&amp;gt;532733K(1236480K), 0.0148940 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.06 sys=0.00, real=0.01 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
3562.795: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 454560K-&amp;gt;128K(560128K)&amp;#93;&lt;/span&gt; 985341K-&amp;gt;531885K(1225728K), 0.0088420 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.04 sys=0.00, real=0.01 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
3614.152: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 144044K-&amp;gt;1440K(434688K)&amp;#93;&lt;/span&gt; 675801K-&amp;gt;533205K(1100288K), 0.0063920 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.02 sys=0.01, real=0.01 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
3614.159: [Full GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 1440K-&amp;gt;0K(434688K)&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;ParOldGen: 531765K-&amp;gt;191685K(665600K)&amp;#93;&lt;/span&gt; 533205K-&amp;gt;191685K(1100288K) &lt;span class=&quot;error&quot;&gt;&amp;#91;PSPermGen: 123513K-&amp;gt;123511K(253440K)&amp;#93;&lt;/span&gt;, 0.5924720 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=2.71 sys=0.00, real=0.59 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
3820.964: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 433152K-&amp;gt;1120K(560128K)&amp;#93;&lt;/span&gt; 624837K-&amp;gt;192805K(1225728K), 0.0057470 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.02 sys=0.00, real=0.00 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
4052.337: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 425056K-&amp;gt;1088K(561664K)&amp;#93;&lt;/span&gt; 616741K-&amp;gt;192965K(1227264K), 0.0048500 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.02 sys=0.00, real=0.01 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
16/10/29 14:02:40 WARN log: Updating partition stats fast for: login4game&lt;br/&gt;
16/10/29 14:02:40 WARN log: Updated size to 795542&lt;br/&gt;
insertval is =&amp;gt; 531 seconds&lt;br/&gt;
befores: Long = 1477720430016&lt;br/&gt;
interval: Long = 531015&lt;/p&gt;</comment>
                            <comment id="15617663" author="snodawn" created="Sat, 29 Oct 2016 07:45:17 +0000"  >&lt;p&gt;insert overwrite in spark 2.1.0, with patch&lt;/p&gt;

&lt;p&gt;scala&amp;gt; val befores =System.currentTimeMillis();spark.sql(&quot;insert overwrite table login4game partition(pt=&apos;mix_en&apos;,dt=&apos;2016-10-21&apos;)    select distinct account_name,role_id,server,&apos;1476979200&apos; as recdate, &apos;mix&apos; as platform, &apos;mix&apos; as pid, &apos;mix&apos; as dev from tbllog_login  where pt=&apos;mix_en&apos; and  dt=&apos;2016-10-21&apos; &quot;);val interval=System.currentTimeMillis()-befores;println(s&quot;insertval is =&amp;gt; ${interval/1000} seconds&quot;)&lt;br/&gt;
139.850: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 656889K-&amp;gt;42484K(656896K)&amp;#93;&lt;/span&gt; 789101K-&amp;gt;206163K(1343488K), 0.0704840 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.33 sys=0.09, real=0.07 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
16/10/29 14:24:12 WARN HiveConf: HiveConf of name hive.server2.auth.hadoop does not exist&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 0:&amp;gt;                                                         (0 + 8) / 72&amp;#93;&lt;/span&gt;144.774: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 656884K-&amp;gt;42494K(465408K)&amp;#93;&lt;/span&gt; 820563K-&amp;gt;323651K(1152000K), 0.0995720 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.47 sys=0.09, real=0.10 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 0:==========&amp;gt;                                              (13 + 8) / 72&amp;#93;&lt;/span&gt;145.697: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 465406K-&amp;gt;42661K(465920K)&amp;#93;&lt;/span&gt; 746563K-&amp;gt;359222K(1152512K), 0.1012790 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.54 sys=0.05, real=0.10 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 0:==================&amp;gt;                                      (23 + 8) / 72&amp;#93;&lt;/span&gt;146.232: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 465573K-&amp;gt;20917K(547840K)&amp;#93;&lt;/span&gt; 782134K-&amp;gt;340686K(1234432K), 0.0262040 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.12 sys=0.00, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 0:===============================&amp;gt;                         (40 + 8) / 72&amp;#93;&lt;/span&gt;146.725: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 427445K-&amp;gt;8807K(415744K)&amp;#93;&lt;/span&gt; 747214K-&amp;gt;332722K(1102336K), 0.0243020 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.08 sys=0.01, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 0:=========================================&amp;gt;               (53 + 8) / 72&amp;#93;&lt;/span&gt;147.178: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 415335K-&amp;gt;9865K(545792K)&amp;#93;&lt;/span&gt; 739250K-&amp;gt;334857K(1232384K), 0.0186080 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.08 sys=0.00, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:&amp;gt;                                                        (0 + 8) / 200&amp;#93;&lt;/span&gt;148.353: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 404916K-&amp;gt;38320K(433664K)&amp;#93;&lt;/span&gt; 729907K-&amp;gt;363760K(1120256K), 0.0260660 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.10 sys=0.00, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:==&amp;gt;                                                      (8 + 8) / 200&amp;#93;&lt;/span&gt;149.077: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 433417K-&amp;gt;47237K(550912K)&amp;#93;&lt;/span&gt; 758856K-&amp;gt;376034K(1237504K), 0.0219810 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.09 sys=0.00, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:====&amp;gt;                                                   (17 + 8) / 200&amp;#93;&lt;/span&gt;149.800: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 450693K-&amp;gt;17621K(544256K)&amp;#93;&lt;/span&gt; 779490K-&amp;gt;349370K(1230848K), 0.0217030 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.11 sys=0.00, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:=========&amp;gt;                                              (34 + 8) / 200&amp;#93;&lt;/span&gt;150.319: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 420875K-&amp;gt;25444K(553984K)&amp;#93;&lt;/span&gt; 752624K-&amp;gt;359975K(1240576K), 0.0196560 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.11 sys=0.01, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:==========&amp;gt;                                             (38 + 9) / 200&amp;#93;&lt;/span&gt;150.590: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 440156K-&amp;gt;51351K(550400K)&amp;#93;&lt;/span&gt; 774687K-&amp;gt;388898K(1236992K), 0.0216630 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.10 sys=0.01, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:================&amp;gt;                                       (58 + 8) / 200&amp;#93;&lt;/span&gt;150.883: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 466010K-&amp;gt;13379K(553472K)&amp;#93;&lt;/span&gt; 803557K-&amp;gt;353656K(1240064K), 0.0202700 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.09 sys=0.01, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:==================&amp;gt;                                     (67 + 8) / 200&amp;#93;&lt;/span&gt;151.106: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 439211K-&amp;gt;53013K(551936K)&amp;#93;&lt;/span&gt; 779488K-&amp;gt;395761K(1238528K), 0.0248140 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.11 sys=0.01, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:=====================&amp;gt;                                  (75 + 8) / 200&amp;#93;&lt;/span&gt;151.401: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 478804K-&amp;gt;30308K(569344K)&amp;#93;&lt;/span&gt; 821551K-&amp;gt;375786K(1255936K), 0.0210760 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.08 sys=0.00, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:=======================&amp;gt;                                (83 + 8) / 200&amp;#93;&lt;/span&gt;151.621: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 480205K-&amp;gt;55779K(566272K)&amp;#93;&lt;/span&gt; 825682K-&amp;gt;404149K(1252864K), 0.0271460 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.12 sys=0.00, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:===========================&amp;gt;                            (99 + 8) / 200&amp;#93;&lt;/span&gt;151.966: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 505776K-&amp;gt;44022K(577536K)&amp;#93;&lt;/span&gt; 854146K-&amp;gt;395148K(1264128K), 0.0235970 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.11 sys=0.00, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:==============================&amp;gt;                        (112 + 8) / 200&amp;#93;&lt;/span&gt;152.211: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 513424K-&amp;gt;22242K(576512K)&amp;#93;&lt;/span&gt; 864550K-&amp;gt;376234K(1263104K), 0.0188640 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.07 sys=0.01, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:=================================&amp;gt;                     (123 + 8) / 200&amp;#93;&lt;/span&gt;152.420: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 491713K-&amp;gt;72455K(584704K)&amp;#93;&lt;/span&gt; 845705K-&amp;gt;427875K(1271296K), 0.0251320 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.10 sys=0.00, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:====================================&amp;gt;                  (132 + 8) / 200&amp;#93;&lt;/span&gt;152.672: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 552126K-&amp;gt;35637K(589312K)&amp;#93;&lt;/span&gt; 907546K-&amp;gt;393850K(1275904K), 0.0223350 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.09 sys=0.01, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:============================================&amp;gt;          (160 + 8) / 200&amp;#93;&lt;/span&gt;152.907: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 515366K-&amp;gt;41942K(579584K)&amp;#93;&lt;/span&gt; 873578K-&amp;gt;402911K(1266176K), 0.0223650 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.09 sys=0.01, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:===============================================&amp;gt;       (171 + 8) / 200&amp;#93;&lt;/span&gt;153.141: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 526730K-&amp;gt;32197K(584704K)&amp;#93;&lt;/span&gt; 887699K-&amp;gt;395982K(1271296K), 0.0229770 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.11 sys=0.00, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Stage 1:==================================================&amp;gt;    (184 + 8) / 200&amp;#93;&lt;/span&gt;153.375: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 516922K-&amp;gt;54805K(595456K)&amp;#93;&lt;/span&gt; 880707K-&amp;gt;420731K(1282048K), 0.0226350 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.11 sys=0.01, real=0.03 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
16/10/29 14:24:27 ERROR KeyProviderCache: Could not find uri with key &lt;span class=&quot;error&quot;&gt;&amp;#91;dfs.encryption.key.provider.uri&amp;#93;&lt;/span&gt; to create a keyProvider !!&lt;br/&gt;
Moved: &apos;hdfs://master.com:45660/data/warehouse/qjzs_log.db/login4game/pt=mix_en/dt=2016-10-21&apos; to trash at: hdfs://master.com:45660/user/hadoop/.Trash/Current&lt;br/&gt;
157.468: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 557589K-&amp;gt;3078K(598528K)&amp;#93;&lt;/span&gt; 923515K-&amp;gt;371833K(1285120K), 0.0185200 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.06 sys=0.01, real=0.02 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
230.673: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 505862K-&amp;gt;1504K(599552K)&amp;#93;&lt;/span&gt; 874617K-&amp;gt;371303K(1286144K), 0.0089300 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.04 sys=0.00, real=0.01 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
468.206: [GC &lt;span class=&quot;error&quot;&gt;&amp;#91;PSYoungGen: 503264K-&amp;gt;1216K(600576K)&amp;#93;&lt;/span&gt; 873063K-&amp;gt;371447K(1287168K), 0.0077540 secs] &lt;span class=&quot;error&quot;&gt;&amp;#91;Times: user=0.03 sys=0.00, real=0.01 secs&amp;#93;&lt;/span&gt; &lt;br/&gt;
16/10/29 14:32:43 ERROR KeyProviderCache: Could not find uri with key &lt;span class=&quot;error&quot;&gt;&amp;#91;dfs.encryption.key.provider.uri&amp;#93;&lt;/span&gt; to create a keyProvider !!&lt;br/&gt;
16/10/29 14:32:47 WARN log: Updating partition stats fast for: login4game&lt;br/&gt;
16/10/29 14:32:47 WARN log: Updated size to 795542&lt;br/&gt;
insertval is =&amp;gt; 518 seconds&lt;br/&gt;
befores: Long = 1477722249349&lt;br/&gt;
interval: Long = 518026&lt;/p&gt;</comment>
                            <comment id="15627426" author="apachespark" created="Wed, 2 Nov 2016 02:31:06 +0000"  >&lt;p&gt;User &apos;viirya&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15726&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15726&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16841351" author="kaixu" created="Thu, 16 May 2019 13:43:07 +0000"  >&lt;p&gt;it seems this issue have not been fixed? I encountered this issue with spark2.4.3, the query I run is from TPC-DS,&#160;&lt;a href=&quot;https://github.com/hortonworks/hive-testbench/blob/hdp3/ddl-tpcds/bin_partitioned/store_sales.sql&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/hortonworks/hive-testbench/blob/hdp3/ddl-tpcds/bin_partitioned/store_sales.sql&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17365072" author="hemanthbm12" created="Thu, 17 Jun 2021 18:28:55 +0000"  >&lt;p&gt;We are seeing this issue still exists on Spark versions&#160;2.3.1 and&#160;2.4.7.&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 21 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35eaf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>