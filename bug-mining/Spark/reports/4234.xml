<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:49:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-17993] Spark prints an avalanche of warning messages from Parquet when reading parquet files written by older versions of Parquet-mr</title>
                <link>https://issues.apache.org/jira/browse/SPARK-17993</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;It looks like &lt;a href=&quot;https://github.com/apache/spark/pull/14690&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14690&lt;/a&gt; broke parquet log output redirection. After that patch, when querying parquet files written by Parquet-mr 1.6.0 Spark prints a torrent of (harmless) warning messages from the Parquet reader:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Oct 18, 2016 7:42:18 PM WARNING: org.apache.parquet.CorruptStatistics: Ignoring statistics because created_by could not be parsed (see PARQUET-251): parquet-mr version 1.6.0
org.apache.parquet.VersionParser$VersionParseException: Could not parse created_by: parquet-mr version 1.6.0 using format: (.+) version ((.*) )?\(build ?(.*)\)
	at org.apache.parquet.VersionParser.parse(VersionParser.java:112)
	at org.apache.parquet.CorruptStatistics.shouldIgnoreStatistics(CorruptStatistics.java:60)
	at org.apache.parquet.format.converter.ParquetMetadataConverter.fromParquetStatistics(ParquetMetadataConverter.java:263)
	at org.apache.parquet.hadoop.ParquetFileReader$Chunk.readAllPages(ParquetFileReader.java:583)
	at org.apache.parquet.hadoop.ParquetFileReader.readNextRowGroup(ParquetFileReader.java:513)
	at org.apache.spark.sql.execution.datasources.parquet.VectorizedParquetRecordReader.checkEndOfRowGroup(VectorizedParquetRecordReader.java:270)
	at org.apache.spark.sql.execution.datasources.parquet.VectorizedParquetRecordReader.nextBatch(VectorizedParquetRecordReader.java:225)
	at org.apache.spark.sql.execution.datasources.parquet.VectorizedParquetRecordReader.nextKeyValue(VectorizedParquetRecordReader.java:137)
	at org.apache.spark.sql.execution.datasources.RecordReaderIterator.hasNext(RecordReaderIterator.scala:39)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:102)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:162)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:102)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.scan_nextBatch$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8$$anon$1.hasNext(WholeStageCodegenExec.scala:372)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:231)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:225)
	at org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$24.apply(RDD.scala:803)
	at org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$24.apply(RDD.scala:803)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:319)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:283)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)
	at org.apache.spark.scheduler.Task.run(Task.scala:99)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:282)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This only happens during execution, not planning, and it doesn&apos;t matter what log level the &lt;tt&gt;SparkContext&lt;/tt&gt; is set to.&lt;/p&gt;

&lt;p&gt;This is a regression I noted as something we needed to fix as a follow up to PR 14690. I feel responsible, so I&apos;m going to expedite a fix for it. I suspect that PR broke Spark&apos;s Parquet log output redirection. That&apos;s the premise I&apos;m going by.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13013300">SPARK-17993</key>
            <summary>Spark prints an avalanche of warning messages from Parquet when reading parquet files written by older versions of Parquet-mr</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="michael">Michael MacFadden</assignee>
                                    <reporter username="michael">Michael MacFadden</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Oct 2016 19:53:13 +0000</created>
                <updated>Tue, 4 Jul 2017 05:53:11 +0000</updated>
                            <resolved>Thu, 10 Nov 2016 21:40:33 +0000</resolved>
                                                    <fixVersion>2.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15586897" author="michael" created="Tue, 18 Oct 2016 22:37:30 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ekhliang&quot; class=&quot;user-hover&quot; rel=&quot;ekhliang&quot;&gt;ekhliang&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think I have a fix for this. I&apos;m going to submit a PR shortly.&lt;/p&gt;</comment>
                            <comment id="15586987" author="apachespark" created="Tue, 18 Oct 2016 23:17:05 +0000"  >&lt;p&gt;User &apos;mallman&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15538&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15538&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15645322" author="keith.j.kraus" created="Mon, 7 Nov 2016 20:24:16 +0000"  >&lt;p&gt;Following the pull request discussion on GitHub, this is currently blocking us from using Spark 2.0 as we have months of data in parquet generated from Spark 1.6 and trying to do any real job in Spark 2.0 causes 100GB+ of log files until our partition is full. A fix prior to the Parquet-1.9 upgrade would be GREATLY appreciated!&lt;/p&gt;</comment>
                            <comment id="15645495" author="michael" created="Mon, 7 Nov 2016 21:20:18 +0000"  >&lt;p&gt;Thank you for your input, Keith. I agree this is a major issue, and I&apos;m trying to get this resolved for 2.1.&lt;/p&gt;</comment>
                            <comment id="15655355" author="michael" created="Thu, 10 Nov 2016 22:23:44 +0000"  >&lt;p&gt;This patch will be part of Spark 2.1, but it looks like it won&apos;t make it into 2.0.2. If you&apos;d like help backporting this patch to 2.0, mail me privately and I can send you a patch.&lt;/p&gt;</comment>
                            <comment id="15815632" author="emre.colak" created="Tue, 10 Jan 2017 17:44:41 +0000"  >&lt;p&gt;I&apos;m using spark-shell in version 2.1 and still see this issue although the parquet-mr version is different:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;17/01/10 09:36:35 WARN CorruptStatistics: Ignoring statistics because created_by could not be parsed (see PARQUET-251): parquet-mr (build 32c46643845ea8a705c35d4ec8fc654cc8ff816d)
org.apache.parquet.VersionParser$VersionParseException: Could not parse created_by: parquet-mr (build 32c46643845ea8a705c35d4ec8fc654cc8ff816d) using format: (.+) version ((.*) )?\(build ?(.*)\)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And here&apos;s how I get it:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;val df = spark.read.parquet(&lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/colake1/genomics/spark/parquet/repo.parquet&quot;&lt;/span&gt;)
df.count
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="15815965" author="michael" created="Tue, 10 Jan 2017 19:42:40 +0000"  >&lt;p&gt;Hi Emre,&lt;/p&gt;

&lt;p&gt;Thanks for reporting this. To clarify, what do you mean by &quot;the&lt;br/&gt;
parquet-mr version&quot; is different.&lt;/p&gt;
</comment>
                            <comment id="15815967" author="emre.colak" created="Tue, 10 Jan 2017 19:44:00 +0000"  >&lt;p&gt;Hi Michael,&lt;br/&gt;
Thanks for getting back. I see &quot;parquet-mr version 1.6.0&quot; in the original description of this issue. The warning I get says &quot;parquet-mr (build 32c46643845ea8a705c35d4ec8fc654cc8ff816d)&quot;&lt;/p&gt;</comment>
                            <comment id="15816629" author="michael" created="Wed, 11 Jan 2017 00:18:50 +0000"  >&lt;p&gt;Try adding the following line to &lt;tt&gt;conf/log4j.properties&lt;/tt&gt; and restart your app:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;log4j.logger.org.apache.parquet=ERROR
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15816641" author="michael" created="Wed, 11 Jan 2017 00:24:17 +0000"  >&lt;p&gt;Also, if that doesn&apos;t work, add the following line as well:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;log4j.logger.parquet=ERROR
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15816761" author="emre.colak" created="Wed, 11 Jan 2017 01:27:07 +0000"  >&lt;p&gt;Editing the log4j.properties helped. Thanks Michael.&lt;/p&gt;</comment>
                            <comment id="15816771" author="michael" created="Wed, 11 Jan 2017 01:32:22 +0000"  >&lt;p&gt;Cool. I&apos;ll work on a simple PR to silence those warnings in the default log configuration.&lt;/p&gt;</comment>
                            <comment id="15822248" author="michael" created="Fri, 13 Jan 2017 19:46:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emre.colak&quot; class=&quot;user-hover&quot; rel=&quot;emre.colak&quot;&gt;emre.colak&lt;/a&gt; FYI &lt;a href=&quot;https://github.com/apache/spark/pull/16580&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/16580&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16073121" author="jhpoelen" created="Tue, 4 Jul 2017 05:31:52 +0000"  >&lt;p&gt;Please note that this fix is not included in spark 2.1.1 . Suggest to re-open the issue.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/spark/blob/v2.1.1/core/src/main/resources/org/apache/spark/log4j-defaults.properties&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/v2.1.1/core/src/main/resources/org/apache/spark/log4j-defaults.properties&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;does not include the fix. However, a recent release candidate does:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/blob/v2.2.0-rc6/core/src/main/resources/org/apache/spark/log4j-defaults.properties&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/v2.2.0-rc6/core/src/main/resources/org/apache/spark/log4j-defaults.properties&lt;/a&gt; .&lt;/p&gt;</comment>
                            <comment id="16073141" author="srowen" created="Tue, 4 Jul 2017 05:53:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jhpoelen&quot; class=&quot;user-hover&quot; rel=&quot;jhpoelen&quot;&gt;jhpoelen&lt;/a&gt; those are not files that this change touched?&lt;br/&gt;
The commit is in branch 2.1: &lt;a href=&quot;https://github.com/apache/spark/commit/be3933ddfa3b6b6cf458c0fc4865a61fef40e76a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/be3933ddfa3b6b6cf458c0fc4865a61fef40e76a&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 20 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3521b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12335644">2.1.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>