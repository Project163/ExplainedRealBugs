<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:23:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-34003] Rule conflicts between PaddingAndLengthCheckForCharVarchar and ResolveAggregateFunctions</title>
                <link>https://issues.apache.org/jira/browse/SPARK-34003</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;ResolveAggregateFunctions is a hacky rule and it calls `executeSameContext` to generate a `resolved agg` to determine which unresolved sort attribute should be pushed into the agg. However, after we add the PaddingAndLengthCheckForCharVarchar rule which will rewrite the query output, thus, the `resolved agg` cannot match original attributes anymore. &lt;/p&gt;

&lt;p&gt;It causes some dissociative sort attribute to be pushed in and fails the query&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[info]   Failed to analyze query: org.apache.spark.sql.AnalysisException: expression &lt;span class=&quot;code-quote&quot;&gt;&apos;testcat.t1.`v`&apos;&lt;/span&gt; is neither present in the group by, nor is it an aggregate function. Add to group by or wrap in first() (or first_value) &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; you don&apos;t care which value you get.;
[info]   Project [v#14, sum(i)#11L]
[info]   +- Sort [aggOrder#12 ASC NULLS FIRST], &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
[info]      +- !Aggregate [v#14], [v#14, sum(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(i#7 as bigint)) AS sum(i)#11L, v#13 AS aggOrder#12]
[info]         +- SubqueryAlias testcat.t1
[info]            +- Project [&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((length(v#6) &amp;lt;= 3)) v#6 &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((length(rtrim(v#6, None)) &amp;gt; 3)) &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(raise_error(concat(input string of length , &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(length(v#6) as string),  exceeds varchar type length limitation: 3)) as string) &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; rpad(rtrim(v#6, None), 3,  ) AS v#14, i#7]
[info]               +- RelationV2[v#6, i#7, index#15, _partition#16] testcat.t1
[info]
[info]   Project [v#14, sum(i)#11L]
[info]   +- Sort [aggOrder#12 ASC NULLS FIRST], &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
[info]      +- !Aggregate [v#14], [v#14, sum(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(i#7 as bigint)) AS sum(i)#11L, v#13 AS aggOrder#12]
[info]         +- SubqueryAlias testcat.t1
[info]            +- Project [&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((length(v#6) &amp;lt;= 3)) v#6 &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((length(rtrim(v#6, None)) &amp;gt; 3)) &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(raise_error(concat(input string of length , &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(length(v#6) as string),  exceeds varchar type length limitation: 3)) as string) &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; rpad(rtrim(v#6, None), 3,  ) AS v#14, i#7]
[info]               +- RelationV2[v#6, i#7, index#15, _partition#16] testcat.t1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13349064">SPARK-34003</key>
            <summary>Rule conflicts between PaddingAndLengthCheckForCharVarchar and ResolveAggregateFunctions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Qin Yao">Kent Yao 2</assignee>
                                    <reporter username="Qin Yao">Kent Yao 2</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jan 2021 06:58:50 +0000</created>
                <updated>Tue, 12 Jan 2021 09:23:53 +0000</updated>
                            <resolved>Fri, 8 Jan 2021 09:06:01 +0000</resolved>
                                    <version>3.1.0</version>
                                    <fixVersion>3.1.1</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17258723" author="apachespark" created="Tue, 5 Jan 2021 07:34:44 +0000"  >&lt;p&gt;User &apos;yaooqinn&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31027&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31027&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17261145" author="cloud_fan" created="Fri, 8 Jan 2021 09:06:01 +0000"  >&lt;p&gt;Issue resolved by pull request 31027&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31027&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31027&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17262555" author="apachespark" created="Mon, 11 Jan 2021 10:29:42 +0000"  >&lt;p&gt;User &apos;yaooqinn&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31129&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31129&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17262556" author="apachespark" created="Mon, 11 Jan 2021 10:30:00 +0000"  >&lt;p&gt;User &apos;yaooqinn&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31129&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31129&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13351687">SPARK-34083</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 44 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0m1a0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>