<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:05:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-27778] toPandas with arrow enabled fails for DF with no partitions</title>
                <link>https://issues.apache.org/jira/browse/SPARK-27778</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Calling to pandas with &lt;tt&gt;spark.sql.execution.arrow.enabled: true&lt;/tt&gt; fails for dataframes with no partitions. The error is a &lt;tt&gt;EOFError&lt;/tt&gt;. With &lt;tt&gt;spark.sql.execution.arrow.enabled: false&lt;/tt&gt; the conversion.&lt;/p&gt;

&lt;p&gt;Repro (on current master branch):&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;gt;&amp;gt;&amp;gt; from pyspark.sql.types import *
&amp;gt;&amp;gt;&amp;gt; schema = StructType([StructField(&quot;field1&quot;, StringType(), True)])
&amp;gt;&amp;gt;&amp;gt; df = spark.createDataFrame(sc.emptyRDD(), schema)
&amp;gt;&amp;gt;&amp;gt; spark.conf.set(&quot;spark.sql.execution.arrow.enabled&quot;, &quot;true&quot;)
&amp;gt;&amp;gt;&amp;gt; df.toPandas()
/Users/dvogelbacher/git/spark/python/pyspark/sql/dataframe.py:2162: UserWarning: toPandas attempted Arrow optimization because &apos;spark.sql.execution.arrow.enabled&apos; is set to true, but has reached the error below and can not continue. Note that &apos;spark.sql.execution.arrow.fallback.enabled&apos; does not have an effect on failures in the middle of computation.

  warnings.warn(msg)
Traceback (most recent call last):
  File &quot;&amp;lt;stdin&amp;gt;&quot;, line 1, in &amp;lt;module&amp;gt;
  File &quot;/Users/dvogelbacher/git/spark/python/pyspark/sql/dataframe.py&quot;, line 2143, in toPandas
    batches = self._collectAsArrow()
  File &quot;/Users/dvogelbacher/git/spark/python/pyspark/sql/dataframe.py&quot;, line 2205, in _collectAsArrow
    results = list(_load_from_socket(sock_info, ArrowCollectSerializer()))
  File &quot;/Users/dvogelbacher/git/spark/python/pyspark/serializers.py&quot;, line 210, in load_stream
    num = read_int(stream)
  File &quot;/Users/dvogelbacher/git/spark/python/pyspark/serializers.py&quot;, line 810, in read_int
    raise EOFError
EOFError
&amp;gt;&amp;gt;&amp;gt; spark.conf.set(&quot;spark.sql.execution.arrow.enabled&quot;, &quot;false&quot;)
&amp;gt;&amp;gt;&amp;gt; df.toPandas()
Empty DataFrame
Columns: [field1]
Index: []
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13234321">SPARK-27778</key>
            <summary>toPandas with arrow enabled fails for DF with no partitions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dvogelbacher">David Vogelbacher</assignee>
                                    <reporter username="dvogelbacher">David Vogelbacher</reporter>
                        <labels>
                    </labels>
                <created>Mon, 20 May 2019 13:57:21 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:37 +0000</updated>
                            <resolved>Wed, 22 May 2019 04:23:05 +0000</resolved>
                                    <version>3.0.0</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>PySpark</component>
                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16843987" author="dvogelbacher" created="Mon, 20 May 2019 13:58:28 +0000"  >&lt;p&gt;I will make a pr for this shortly.&lt;/p&gt;</comment>
                            <comment id="16845500" author="gurwls223" created="Wed, 22 May 2019 04:23:05 +0000"  >&lt;p&gt;Issue resolved by pull request 24650&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/24650&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/24650&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02uyg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>