<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:32:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-41741] [SQL] ParquetFilters StringStartsWith push down matching string do not use UTF-8</title>
                <link>https://issues.apache.org/jira/browse/SPARK-41741</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Hello ~&lt;br/&gt;
&#160;&lt;br/&gt;
I found a problem, but there are two ways to solve it.&lt;br/&gt;
&#160;&lt;br/&gt;
The parquet filter is pushed down. When using the like &apos;***%&apos; statement to query, if the system default encoding is not UTF-8, it may cause an error.&lt;br/&gt;
&#160;&lt;br/&gt;
There are two ways to bypass this problem as far as I know&lt;br/&gt;
1. spark.executor.extraJavaOptions=&quot;-Dfile.encoding=UTF-8&quot;&lt;br/&gt;
2.&#160;spark.sql.parquet.filterPushdown.string.startsWith=false&lt;br/&gt;
&#160;&lt;/p&gt;

&lt;p&gt;The following is the information to reproduce this problem&lt;/p&gt;

&lt;p&gt;The parquet sample file is in the attachment&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
spark.read.parquet(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;///home/kylin/hjldir/part-00000-30432312-7cdb-43ef-befe-93bcfd174878-c000.snappy.parquet&quot;&lt;/span&gt;).createTempView(&quot;tmp&#8221;)
&lt;/span&gt;spark.sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;select * from tmp where `1` like &lt;span class=&quot;code-quote&quot;&gt;&apos;&#21862;&#21862;&#20048;&#20048;%&apos;&lt;/span&gt;&quot;&lt;/span&gt;).show(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13054184/13054184_image-2022-12-28-18-00-00-861.png&quot; height=&quot;430&quot; width=&quot;879&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;br/&gt;
&#160;&lt;br/&gt;
&#160; &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13054185/13054185_image-2022-12-28-18-00-21-586.png&quot; height=&quot;731&quot; width=&quot;799&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;br/&gt;
&#160;&lt;br/&gt;
I think the correct code should be:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; val strToBinary = Binary.fromReusedByteArray(v.getBytes(StandardCharsets.UTF_8)) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13515819">SPARK-41741</key>
            <summary>[SQL] ParquetFilters StringStartsWith push down matching string do not use UTF-8</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yumwang">Yuming Wang</assignee>
                                    <reporter username="jlelehe">Jiale He</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Dec 2022 09:59:22 +0000</created>
                <updated>Mon, 20 Feb 2023 11:34:19 +0000</updated>
                            <resolved>Mon, 20 Feb 2023 11:34:19 +0000</resolved>
                                    <version>3.4.0</version>
                                    <fixVersion>3.3.3</fixVersion>
                    <fixVersion>3.4.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17653185" author="bjornjorgensen" created="Fri, 30 Dec 2022 20:03:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jlelehe&quot; class=&quot;user-hover&quot; rel=&quot;jlelehe&quot;&gt;jlelehe&lt;/a&gt; can you change Affects Version/s: from 2.4.0 to 3.4.0 ? &lt;/p&gt;</comment>
                            <comment id="17653269" author="jlelehe" created="Sat, 31 Dec 2022 06:48:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bjornjorgensen&quot; class=&quot;user-hover&quot; rel=&quot;bjornjorgensen&quot;&gt;bjornjorgensen&lt;/a&gt; done&lt;/p&gt;</comment>
                            <comment id="17655882" author="q79969786" created="Mon, 9 Jan 2023 02:58:22 +0000"  >&lt;p&gt;What is your &lt;tt&gt;file.encoding&lt;/tt&gt;?&lt;/p&gt;</comment>
                            <comment id="17655886" author="jlelehe" created="Mon, 9 Jan 2023 03:13:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yumwang&quot; class=&quot;user-hover&quot; rel=&quot;yumwang&quot;&gt;yumwang&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;The Spark application on my side does not specify file.encoding, using the default&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13054424/13054424_image-2023-01-09-11-10-31-262.png&quot; height=&quot;678&quot; width=&quot;903&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17655893" author="q79969786" created="Mon, 9 Jan 2023 03:36:52 +0000"  >&lt;p&gt;What is your env? you can put the env in your terminal.&lt;/p&gt;</comment>
                            <comment id="17656023" author="jlelehe" created="Mon, 9 Jan 2023 10:28:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yumwang&quot; class=&quot;user-hover&quot; rel=&quot;yumwang&quot;&gt;yumwang&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Do you mean this?&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13054440/13054440_image-2023-01-09-18-27-53-479.png&quot; height=&quot;519&quot; width=&quot;967&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17691010" author="apachespark" created="Mon, 20 Feb 2023 05:27:00 +0000"  >&lt;p&gt;User &apos;wangyum&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/40090&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40090&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13054184" name="image-2022-12-28-18-00-00-861.png" size="282340" author="jlelehe" created="Wed, 28 Dec 2022 10:00:02 +0000"/>
                            <attachment id="13054185" name="image-2022-12-28-18-00-21-586.png" size="408765" author="jlelehe" created="Wed, 28 Dec 2022 10:00:22 +0000"/>
                            <attachment id="13054424" name="image-2023-01-09-11-10-31-262.png" size="284112" author="jlelehe" created="Mon, 9 Jan 2023 03:10:34 +0000"/>
                            <attachment id="13054440" name="image-2023-01-09-18-27-53-479.png" size="417715" author="jlelehe" created="Mon, 9 Jan 2023 10:28:00 +0000"/>
                            <attachment id="13054182" name="part-00000-30432312-7cdb-43ef-befe-93bcfd174878-c000.snappy.parquet" size="822" author="jlelehe" created="Wed, 28 Dec 2022 09:59:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 38 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1ef0w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>