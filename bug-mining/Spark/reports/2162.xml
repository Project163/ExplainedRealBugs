<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:29:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-8840] Float type coercion with hiveContext</title>
                <link>https://issues.apache.org/jira/browse/SPARK-8840</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Problem with &lt;ins&gt;float&lt;/ins&gt; type coercion on SparkR with hiveContext.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt; result &amp;lt;- sql(hiveContext, &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT offset, percentage from data limit 100&quot;&lt;/span&gt;)
&amp;gt; show(result)
DataFrame[offset:&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;, percentage:&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;]
&amp;gt; head(result)
Error in as.data.frame.&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;(x[[i]], optional = TRUE) :
    cannot coerce class &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;jobj&quot;&lt;/span&gt;&quot; to a data.frame
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This trouble looks like already exists (&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-2863&quot; title=&quot;Emulate Hive type coercion in native reimplementations of Hive functions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-2863&quot;&gt;&lt;del&gt;SPARK-2863&lt;/del&gt;&lt;/a&gt; - Emulate Hive type&lt;br/&gt;
coercion in native reimplementations of Hive functions) with same&lt;br/&gt;
reason - not completed &quot;native reimplementations of Hive...&quot; not&lt;br/&gt;
&quot;...functions&quot; only.&lt;/p&gt;

&lt;p&gt;I used spark 1.4.0 binaries from official site:&lt;br/&gt;
&lt;a href=&quot;http://spark.apache.org/downloads.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://spark.apache.org/downloads.html&lt;/a&gt;&lt;br/&gt;
And running it on:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Hortonworks HDP 2.2.0.0-2041&lt;/li&gt;
	&lt;li&gt;with Hive 0.14&lt;/li&gt;
	&lt;li&gt;with disabled hooks for Application Timeline Servers (ATSHook) in hive-site.xml, commented:
	&lt;ul&gt;
		&lt;li&gt;hive.exec.failure.hooks,&lt;/li&gt;
		&lt;li&gt;hive.exec.post.hooks,&lt;/li&gt;
		&lt;li&gt;hive.exec.pre.hooks.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12842873">SPARK-8840</key>
            <summary>Float type coercion with hiveContext</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="viirya">L. C. Hsieh</assignee>
                                    <reporter username="esinelnikov">Evgeny SInelnikov</reporter>
                        <labels>
                    </labels>
                <created>Mon, 6 Jul 2015 12:45:47 +0000</created>
                <updated>Thu, 16 Jul 2015 22:24:43 +0000</updated>
                            <resolved>Wed, 15 Jul 2015 16:48:49 +0000</resolved>
                                    <version>1.4.0</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>SparkR</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14615234" author="shivaram" created="Mon, 6 Jul 2015 16:00:34 +0000"  >&lt;p&gt;Does this work in Scala / Python ? This might be a SparkSQL rather than a SparkR issue&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yhuai&quot; class=&quot;user-hover&quot; rel=&quot;yhuai&quot;&gt;yhuai&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davies&quot; class=&quot;user-hover&quot; rel=&quot;davies&quot;&gt;davies&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14616528" author="esinelnikov" created="Tue, 7 Jul 2015 11:10:16 +0000"  >&lt;p&gt;No, this work in R (sparkR shell from spark distribution):&lt;br/&gt;
&lt;a href=&quot;https://spark.apache.org/docs/latest/sparkr.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://spark.apache.org/docs/latest/sparkr.html&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;# spark/bin/sparkR

R version 3.1.3 (2015-03-09) -- &lt;span class=&quot;code-quote&quot;&gt;&quot;Smooth Sidewalk&quot;&lt;/span&gt;
Copyright (C) 2015 The R Foundation &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Statistical Computing
Platform: x86_64-redhat-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &lt;span class=&quot;code-quote&quot;&gt;&apos;license()&apos;&lt;/span&gt; or &lt;span class=&quot;code-quote&quot;&gt;&apos;licence()&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type &lt;span class=&quot;code-quote&quot;&gt;&apos;contributors()&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more information and
&lt;span class=&quot;code-quote&quot;&gt;&apos;citation()&apos;&lt;/span&gt; on how to cite R or R packages in publications.

Type &lt;span class=&quot;code-quote&quot;&gt;&apos;demo()&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; some demos, &lt;span class=&quot;code-quote&quot;&gt;&apos;help()&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; on-line help, or
&lt;span class=&quot;code-quote&quot;&gt;&apos;help.start()&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; an HTML browser &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; to help.
Type &lt;span class=&quot;code-quote&quot;&gt;&apos;q()&apos;&lt;/span&gt; to quit R.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14616918" author="shivaram" created="Tue, 7 Jul 2015 16:11:59 +0000"  >&lt;p&gt;Sorry my question is can you reproduce this in Scala shell or PySpark shell ?&lt;/p&gt;</comment>
                            <comment id="14617267" author="esinelnikov" created="Tue, 7 Jul 2015 19:58:14 +0000"  >&lt;p&gt;I tested it on SparkSQL - problem not reproduced on it.&lt;br/&gt;
I looked into spark/R sources and found, than deserialization for &lt;em&gt;float&lt;/em&gt; type not implemented. But not for double and it works:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt; sql(hiveContext, &lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE float_table (fl &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;, db &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;) row format delimited fields terminated by &lt;span class=&quot;code-quote&quot;&gt;&apos;,&apos;&lt;/span&gt;&quot;&lt;/span&gt;)

&amp;gt; result &amp;lt;- sql(hiveContext, &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * from float_table&quot;&lt;/span&gt;)

&amp;gt; head(result)
Error in readTypedObject(con, type) :
  Unsupported type &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; deserialization

&amp;gt; result &amp;lt;- sql(hiveContext, &lt;span class=&quot;code-quote&quot;&gt;&quot;LOAD DATA INPATH &lt;span class=&quot;code-quote&quot;&gt;&apos;data.csv&apos;&lt;/span&gt; INTO TABLE float_table&quot;&lt;/span&gt;)

&amp;gt; result &amp;lt;- sql(hiveContext, &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * from float_table&quot;&lt;/span&gt;)

&amp;gt; head(result)
Error in as.data.frame.&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;(x[[i]], optional = TRUE) :
    cannot coerce class &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;jobj&quot;&lt;/span&gt;&quot; to a data.frame

&amp;gt; result &amp;lt;- sql(hiveContext, &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT db from float_table&quot;&lt;/span&gt;)

&amp;gt; head(result)
   db
1 1.1
2 2.0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14617363" author="shivaram" created="Tue, 7 Jul 2015 20:46:57 +0000"  >&lt;p&gt;Ah I see &amp;#8211; Yes. we can definitely add a type conversion for Floats to numeric in R (we can just cast the float to doubles ?). Do you want to open a PR for this ?&lt;/p&gt;</comment>
                            <comment id="14617891" author="apachespark" created="Wed, 8 Jul 2015 02:58:05 +0000"  >&lt;p&gt;User &apos;viirya&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7280&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7280&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14628343" author="davies" created="Wed, 15 Jul 2015 16:48:49 +0000"  >&lt;p&gt;Issue resolved by pull request 7280&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7280&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7280&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12843502">SPARK-8897</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 18 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2gvv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>