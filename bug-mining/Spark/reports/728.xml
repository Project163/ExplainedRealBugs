<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:17:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-3500] coalesce() and repartition() of SchemaRDD is broken</title>
                <link>https://issues.apache.org/jira/browse/SPARK-3500</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt;&amp;gt;&amp;gt; sqlCtx.jsonRDD(sc.parallelize([&lt;span class=&quot;code-quote&quot;&gt;&apos;{&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;}&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;{&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;}&apos;&lt;/span&gt;])).coalesce(1)
Py4JError: An error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; calling o94.coalesce. Trace:
py4j.Py4JException: Method coalesce([&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;java.lang.&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;]) does not exist
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;repartition() is also missing too.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12740950">SPARK-3500</key>
            <summary>coalesce() and repartition() of SchemaRDD is broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davies">Davies Liu</assignee>
                                    <reporter username="davies">Davies Liu</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Sep 2014 04:55:27 +0000</created>
                <updated>Sat, 13 Sep 2014 16:56:21 +0000</updated>
                            <resolved>Sat, 13 Sep 2014 02:29:15 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.1.1</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                                    <component>PySpark</component>
                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14131166" author="apachespark" created="Fri, 12 Sep 2014 06:30:31 +0000"  >&lt;p&gt;User &apos;davies&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/2369&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/2369&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14131688" author="nchammas" created="Fri, 12 Sep 2014 16:02:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davies&quot; class=&quot;user-hover&quot; rel=&quot;davies&quot;&gt;davies&lt;/a&gt; - Shouldn&apos;t the target version for this bugfix be 1.1.1?&lt;/p&gt;</comment>
                            <comment id="14131706" author="pwendell" created="Fri, 12 Sep 2014 16:16:40 +0000"  >&lt;p&gt;If it&apos;s just a missing feature we tend to be conservative and only put it in the new minor release. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davies&quot; class=&quot;user-hover&quot; rel=&quot;davies&quot;&gt;davies&lt;/a&gt; - is there code that people can use in 1.1 that works around this (i.e if they add a conversion themselves)? If there is a workaround for 1.1 I think we should just publish that and target this for 1.2. &lt;/p&gt;</comment>
                            <comment id="14131714" author="davies" created="Fri, 12 Sep 2014 16:24:22 +0000"  >&lt;p&gt;I think it&apos;s a bug, there is a workaround for it:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;srdd2 = SchemaRDD(srdd._jschema_rdd.coalesce(N, False, None), sqlCtx)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="14131752" author="nchammas" created="Fri, 12 Sep 2014 17:07:10 +0000"  >&lt;p&gt;Hmm, you &lt;em&gt;could&lt;/em&gt; perhaps consider this a missing feature, though since all base RDD operations should also be valid SchemaRDD operations (right?), it definitely feels like a bug. And it&apos;s not just for SchemaRDDs created by jsonRDD (as noted in the title).&lt;/p&gt;

&lt;p&gt;It looks like &lt;tt&gt;repartition&lt;/tt&gt; is missing, too.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;from pyspark.sql &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; SQLContext
from pyspark.sql &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; Row
sqlContext = SQLContext(sc)

a = sc.parallelize([Row(field1=1, field2=&lt;span class=&quot;code-quote&quot;&gt;&quot;row1&quot;&lt;/span&gt;)])
sqlContext.inferSchema(a).coalesce(1)  # Method coalesce does not exist
sqlContext.inferSchema(a).repartition(1)  # Method repartition does not exist
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14131757" author="nchammas" created="Fri, 12 Sep 2014 17:08:56 +0000"  >&lt;p&gt;Btw, this seems like the same type of problem reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-2797&quot; title=&quot;SchemaRDDs don&amp;#39;t support unpersist()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-2797&quot;&gt;&lt;del&gt;SPARK-2797&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14131869" author="davies" created="Fri, 12 Sep 2014 18:22:15 +0000"  >&lt;p&gt;repartition() and distinct(N) are also missing too.&lt;/p&gt;</comment>
                            <comment id="14131933" author="nchammas" created="Fri, 12 Sep 2014 18:54:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davies&quot; class=&quot;user-hover&quot; rel=&quot;davies&quot;&gt;davies&lt;/a&gt; - PySpark doesn&apos;t seem to support &lt;tt&gt;distinct(N)&lt;/tt&gt; on even a regular RDD. Should it?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt;&amp;gt;&amp;gt; sc.parallelize([1,2,3]).distinct(2)
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;stdin&amp;gt;&quot;&lt;/span&gt;, line 1, in &amp;lt;module&amp;gt;
TypeError: distinct() takes exactly 1 argument (2 given)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This sounds like it&apos;s a separate issue. Maybe it should be tracked in a separate JIRA issue?&lt;/p&gt;

&lt;p&gt;Also, could we edit the title of this JIRA issue to read something like &quot;SchemaRDDs are missing these methods: ...&quot;? The problem is not limited to SchemaRDDs created by jsonRDD().&lt;/p&gt;</comment>
                            <comment id="14132420" author="joshrosen" created="Sat, 13 Sep 2014 01:02:54 +0000"  >&lt;p&gt;This feels like a bug, not a missing feature, since SchemaRDD instances have a public method that always throws an exception when called.  It seems fair to include this fix in 1.1.1.&lt;/p&gt;</comment>
                            <comment id="14132481" author="joshrosen" created="Sat, 13 Sep 2014 02:29:15 +0000"  >&lt;p&gt;Issue resolved by pull request 2369&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/2369&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/2369&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12731429">SPARK-2797</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12741266">SPARK-3519</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 10 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1zyfj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327369">1.2.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>