<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:54:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-20079] Re registration of AM hangs spark cluster in yarn-client mode</title>
                <link>https://issues.apache.org/jira/browse/SPARK-20079</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;The ExecutorAllocationManager.reset method is called when re-registering AM, which sets the ExecutorAllocationManager.initializing field true. When this field is true, the Driver does not start a new executor from the AM request. The following two cases will cause the field to False&lt;/p&gt;

&lt;p&gt;1. A executor idle for some time.&lt;br/&gt;
2. There are new stages to be submitted&lt;/p&gt;


&lt;p&gt;After the a stage was submitted, the AM was killed and restart ,the above two cases will not appear.&lt;/p&gt;

&lt;p&gt;1. When AM is killed, the yarn will kill all running containers. All execuotr will be lost and no executor will be idle.&lt;br/&gt;
2. No surviving executor, resulting in the current stage will never be completed, DAG will not submit a new stage.&lt;/p&gt;


&lt;p&gt;Reproduction steps:&lt;/p&gt;

&lt;p&gt;1. Start cluster&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;echo -e &quot;sc.parallelize(1 to 2000).foreach(_ =&amp;gt; Thread.sleep(1000))&quot; | ./bin/spark-shell  --master yarn-client --executor-cores 1 --conf spark.shuffle.service.enabled=true --conf spark.dynamicAllocation.enabled=true --conf spark.dynamicAllocation.maxExecutors=2
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2.  Kill the AM process when a stage is scheduled. &lt;/p&gt;</description>
                <environment></environment>
        <key id="13058789">SPARK-20079</key>
            <summary>Re registration of AM hangs spark cluster in yarn-client mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vanzin">Marcelo Masiero Vanzin</assignee>
                                    <reporter username="gq">Guoqiang Li</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Mar 2017 02:17:43 +0000</created>
                <updated>Sun, 17 May 2020 18:14:15 +0000</updated>
                            <resolved>Tue, 1 Aug 2017 17:12:58 +0000</resolved>
                                    <version>2.1.0</version>
                                    <fixVersion>2.3.0</fixVersion>
                                    <component>Spark Core</component>
                    <component>YARN</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15944629" author="jerryshao" created="Tue, 28 Mar 2017 06:34:44 +0000"  >&lt;p&gt;What is the specific symptom you met? I believe there&apos;s bunch of corner cases regarding RPC back and forth in yarn-client + AM reattempt scenario, and sometimes these scenarios are quite hard to fix, so usually I would suggest to set max attempt to 1 in yarn client mode.&lt;/p&gt;</comment>
                            <comment id="15949164" author="gq" created="Thu, 30 Mar 2017 14:28:53 +0000"  >&lt;p&gt;I met the problem when doing reliability test. After the restart AM, in more than ten hours it has not applied for a new executor.&lt;/p&gt;</comment>
                            <comment id="15949180" author="apachespark" created="Thu, 30 Mar 2017 14:35:05 +0000"  >&lt;p&gt;User &apos;witgo&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/17480&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/17480&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15999431" author="apachespark" created="Sat, 6 May 2017 13:32:02 +0000"  >&lt;p&gt;User &apos;witgo&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/17882&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/17882&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16090854" author="apachespark" created="Tue, 18 Jul 2017 00:21:03 +0000"  >&lt;p&gt;User &apos;vanzin&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/18663&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/18663&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3cqdb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>