<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:08:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-30201] HiveOutputWriter standardOI should use ObjectInspectorCopyOption.DEFAULT</title>
                <link>https://issues.apache.org/jira/browse/SPARK-30201</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Now spark use `ObjectInspectorCopyOption.JAVA` as oi option which will convert any string to UTF-8 string. When write non UTF-8 code data, then `EFBFBD` will appear.&lt;br/&gt;
We should use `ObjectInspectorCopyOption.DEFAULT` to support pass the bytes.&lt;/p&gt;

&lt;p&gt;Here is the way to reproduce:&lt;br/&gt;
1. make a file contains 16 radix &apos;AABBCC&apos; which is not the UTF-8 code.&lt;br/&gt;
2. create table test1 (c string) location &apos;$file_path&apos;;&lt;br/&gt;
3. select hex(c) from test1; // AABBCC&lt;br/&gt;
4. craete table test2 (c string) as select c from test1;&lt;br/&gt;
5. select hex(c) from test2; // EFBFBDEFBFBDEFBFBD&lt;/p&gt;</description>
                <environment></environment>
        <key id="13273590">SPARK-30201</key>
            <summary>HiveOutputWriter standardOI should use ObjectInspectorCopyOption.DEFAULT</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ulysses">XiDuo You</assignee>
                                    <reporter username="ulysses">XiDuo You</reporter>
                        <labels>
                            <label>correctness</label>
                    </labels>
                <created>Tue, 10 Dec 2019 11:11:29 +0000</created>
                <updated>Tue, 6 Oct 2020 03:13:55 +0000</updated>
                            <resolved>Tue, 17 Dec 2019 04:39:45 +0000</resolved>
                                    <version>2.0.2</version>
                    <version>2.1.3</version>
                    <version>2.2.3</version>
                    <version>2.3.4</version>
                    <version>2.4.7</version>
                    <version>3.0.0</version>
                                    <fixVersion>2.4.8</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16997884" author="cloud_fan" created="Tue, 17 Dec 2019 04:39:45 +0000"  >&lt;p&gt;Issue resolved by pull request 26831&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/26831&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/26831&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17208268" author="dongjoon" created="Mon, 5 Oct 2020 19:16:15 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ulysses&quot; class=&quot;user-hover&quot; rel=&quot;ulysses&quot;&gt;ulysses&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt;. Is this only critical on 3.0.0?&lt;/p&gt;</comment>
                            <comment id="17208385" author="apachespark" created="Mon, 5 Oct 2020 22:33:23 +0000"  >&lt;p&gt;User &apos;anuragmantri&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/29948&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/29948&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17208389" author="anuragmantri" created="Mon, 5 Oct 2020 22:38:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ulysses&quot; class=&quot;user-hover&quot; rel=&quot;ulysses&quot;&gt;ulysses&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt;&#160;- I verified this issue is present in branch-2.4. Test failure below:&lt;/p&gt;



&lt;p&gt;&lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; == Results ==&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; !== Correct Answer - 1 == == Spark Answer - 1 ==&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; !struct&amp;lt;&amp;gt; struct&amp;lt;hex(c):string&amp;gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; !&lt;span class=&quot;error&quot;&gt;&amp;#91;AABBCC&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;EFBFBDEFBFBDEFBFBD&amp;#93;&lt;/span&gt; (QueryTest.scala:163)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; org.scalatest.exceptions.TestFailedException:&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I created a PR to backport it to branch 2.4. It was a clean cherry-pick, could you please take a look? Thanks&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/spark/pull/29948&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/29948&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17208414" author="dongjoon" created="Mon, 5 Oct 2020 23:31:32 +0000"  >&lt;p&gt;I labeled this issue as `correctness` because the query result is wrong.&lt;/p&gt;</comment>
                            <comment id="17208468" author="dongjoon" created="Tue, 6 Oct 2020 03:13:55 +0000"  >&lt;p&gt;This lands at `branch-2.4` via &lt;a href=&quot;https://github.com/apache/spark/pull/29948&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/29948&lt;/a&gt; &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 6 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z09im0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>