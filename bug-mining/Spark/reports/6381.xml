<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:04:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-24935] Problem with Executing Hive UDF&apos;s from Spark 2.2 Onwards</title>
                <link>https://issues.apache.org/jira/browse/SPARK-24935</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;A user of sketches library(&lt;a href=&quot;https://github.com/DataSketches/sketches-hive&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/DataSketches/sketches-hive&lt;/a&gt;) reported an issue with HLL Sketch Hive UDAF that seems to be a bug in Spark or Hive. Their code runs fine in 2.1 but has an issue from 2.2 onwards. For more details on the issue, you can refer to the discussion in the sketches-user list:&lt;br/&gt;
&lt;a href=&quot;https://groups.google.com/forum/?utm_medium=email&amp;amp;utm_source=footer#!msg/sketches-user/GmH4-OlHP9g/MW-J7Hg4BwAJ&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://groups.google.com/forum/?utm_medium=email&amp;amp;utm_source=footer#!msg/sketches-user/GmH4-OlHP9g/MW-J7Hg4BwAJ&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;On further debugging, we figured out that from 2.2 onwards, Spark hive UDAF provides support for partial aggregation, and has removed the functionality that supported complete mode aggregation(Refer&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-19060&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-19060&lt;/a&gt;&#160;and&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-18186&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-18186&lt;/a&gt;). Thus, instead of expecting update method to be called, merge method is called here (&lt;a href=&quot;https://github.com/DataSketches/sketches-hive/blob/master/src/main/java/com/yahoo/sketches/hive/hll/SketchEvaluator.java#L56)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/DataSketches/sketches-hive/blob/master/src/main/java/com/yahoo/sketches/hive/hll/SketchEvaluator.java#L56)&lt;/a&gt;&#160;which throws the exception as described in the forums above.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13174856">SPARK-24935</key>
            <summary>Problem with Executing Hive UDF&apos;s from Spark 2.2 Onwards</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pgandhi">Parth Gandhi</assignee>
                                    <reporter username="pgandhi">Parth Gandhi</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Jul 2018 13:59:41 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:59 +0000</updated>
                            <resolved>Sun, 24 Mar 2019 23:09:58 +0000</resolved>
                                    <version>2.2.0</version>
                    <version>2.3.1</version>
                                    <fixVersion>2.3.4</fixVersion>
                    <fixVersion>2.4.3</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="16559526" author="gurwls223" created="Fri, 27 Jul 2018 10:09:37 +0000"  >&lt;p&gt;Sounds non trivial and a regression.&lt;/p&gt;</comment>
                            <comment id="16559527" author="gurwls223" created="Fri, 27 Jul 2018 10:10:43 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lian+cheng&quot; class=&quot;user-hover&quot; rel=&quot;lian cheng&quot;&gt;lian cheng&lt;/a&gt;]&lt;/p&gt;</comment>
                            <comment id="16559828" author="cloud_fan" created="Fri, 27 Jul 2018 14:22:48 +0000"  >&lt;p&gt;seems like Hive UDAF can reject partial aggregate?&lt;/p&gt;</comment>
                            <comment id="16561266" author="pgandhi" created="Sun, 29 Jul 2018 20:56:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt; I too had the same doubt that maybe hive UDAF might still have issues supporting partial aggregation completely though I am not so sure. Would it make sense to add support for complete aggregation mode to ensure backward compatibility? Thank you.&lt;/p&gt;</comment>
                            <comment id="16576467" author="pgandhi" created="Fri, 10 Aug 2018 15:47:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lian+cheng&quot; class=&quot;user-hover&quot; rel=&quot;lian cheng&quot;&gt;lian cheng&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;What do you think of my previous comment??&lt;/p&gt;</comment>
                            <comment id="16585259" author="apachespark" created="Sun, 19 Aug 2018 19:40:05 +0000"  >&lt;p&gt;User &apos;pgandhi999&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22144&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22144&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16769692" author="pgandhi" created="Fri, 15 Feb 2019 20:26:58 +0000"  >&lt;p&gt;Have created a new pull request for this issue here:&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/23778&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23778&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16773533" author="zanderl" created="Thu, 21 Feb 2019 00:08:47 +0000"  >&lt;p&gt;Glad to see this has been fixed!&#160; What are the chances this will get into 2.4.1?&lt;/p&gt;</comment>
                            <comment id="16773541" author="pgandhi" created="Thu, 21 Feb 2019 00:25:57 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zanderl&quot; class=&quot;user-hover&quot; rel=&quot;zanderl&quot;&gt;zanderl&lt;/a&gt;, thank you for your comment. Will do my best to work on the reviews, rest depends on the reviewers&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16773574" author="gavin_hu" created="Thu, 21 Feb 2019 01:25:30 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pgandhi&quot; class=&quot;user-hover&quot; rel=&quot;pgandhi&quot;&gt;pgandhi&lt;/a&gt; &#160;&quot;A user of sketches library...&quot; That&apos;s me! I&apos;m so excited that the issue I reported couple months back has got fixed here. Kudos to you for the great work!&lt;/p&gt;

&lt;p&gt;As you may know many users including me are moving towards Spark 2.4.1, getting the fix there will definitely benefit a lot of people. Looking forwards to that.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16774170" author="pgandhi" created="Thu, 21 Feb 2019 15:25:13 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gavin_hu&quot; class=&quot;user-hover&quot; rel=&quot;gavin_hu&quot;&gt;gavin_hu&lt;/a&gt; for reporting the issue in the first place. Have sent an email to the Spark dev mailing list requesting them to push the fix for Spark 2.4.1. Will let you know in case of any updates.&lt;/p&gt;</comment>
                            <comment id="16831250" author="rezasafi" created="Wed, 1 May 2019 20:56:36 +0000"  >&lt;p&gt;Is there any reason that this wasn&apos;t merged into 2.3 line?&lt;/p&gt;</comment>
                            <comment id="16833982" author="cloud_fan" created="Mon, 6 May 2019 16:39:38 +0000"  >&lt;p&gt;I have sent &lt;a href=&quot;https://github.com/apache/spark/pull/24539&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/24539&lt;/a&gt; to backport it.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13236951">SPARK-27907</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 28 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3wcr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>