<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:47:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-17753] Simple case in spark sql throws ParseException</title>
                <link>https://issues.apache.org/jira/browse/SPARK-17753</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Simple case in sql throws parser exception in spark 2.0.&lt;br/&gt;
The following query as well as similar queries fail in spark 2.0 &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scala&amp;gt; spark.sql(&quot;SELECT alias.p_double as a0, alias.p_text as a1, NULL as a2 FROM hadoop_tbl_all alias WHERE  (1 = (CASE (&apos;aaaaabbbbb&apos; = alias.p_text) OR (8 LTE LENGTH(alias.p_text)) WHEN TRUE THEN 1  WHEN FALSE THEN 0 ELSE CAST(NULL AS INT) END))&quot;)
org.apache.spark.sql.catalyst.parser.ParseException:
mismatched input &apos;FROM&apos; expecting {&amp;lt;EOF&amp;gt;, &apos;WHERE&apos;, &apos;GROUP&apos;, &apos;ORDER&apos;, &apos;HAVING&apos;, &apos;LIMIT&apos;, &apos;LATERAL&apos;, &apos;WINDOW&apos;, &apos;UNION&apos;, &apos;EXCEPT&apos;, &apos;INTERSECT&apos;, &apos;SORT&apos;, &apos;CLUSTER&apos;, &apos;DISTRIBUTE&apos;}(line 1, pos 60)

== SQL ==
SELECT alias.p_double as a0, alias.p_text as a1, NULL as a2 FROM hadoop_tbl_all alias WHERE  (1 = (CASE (&apos;aaaaabbbbb&apos; = alias.p_text) OR (8 LTE LENGTH(alias.p_text)) WHEN TRUE THEN 1  WHEN FALSE THEN 0 ELSE CAST(NULL AS INT) END))
------------------------------------------------------------^^^

  at org.apache.spark.sql.catalyst.parser.ParseException.withCommand(ParseDriver.scala:197)
  at org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parse(ParseDriver.scala:99)
  at org.apache.spark.sql.execution.SparkSqlParser.parse(SparkSqlParser.scala:46)
  at org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parsePlan(ParseDriver.scala:53)
  at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:582)
  ... 48 elided
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13009008">SPARK-17753</key>
            <summary>Simple case in spark sql throws ParseException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hvanhovell">Herman van H&#246;vell</assignee>
                                    <reporter username="kdhuria">kanika dhuria</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Sep 2016 22:28:17 +0000</created>
                <updated>Wed, 9 Nov 2016 10:08:49 +0000</updated>
                            <resolved>Tue, 4 Oct 2016 02:33:43 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.2</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15538983" author="dongjoon" created="Sat, 1 Oct 2016 18:36:04 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kdhuria&quot; class=&quot;user-hover&quot; rel=&quot;kdhuria&quot;&gt;kdhuria&lt;/a&gt;.&lt;br/&gt;
Right, `CASE WHEN` seems to have a bug on that. I&apos;ll investigate this.&lt;/p&gt;</comment>
                            <comment id="15539295" author="dongjoon" created="Sat, 1 Oct 2016 23:00:35 +0000"  >&lt;p&gt;Hmm. It&apos;s not so each to fix this. Maybe, I&apos;ll try later.&lt;/p&gt;</comment>
                            <comment id="15539354" author="hvanhovell" created="Sat, 1 Oct 2016 23:49:43 +0000"  >&lt;p&gt;We do not support the GTE/LTE/GT/LT/EQ/NEQ operators. Use the symbolic versions instead.&lt;/p&gt;

&lt;p&gt;I will open a PR for using complex expressions in a value based case statement.&lt;/p&gt;</comment>
                            <comment id="15539358" author="kdhuria" created="Sat, 1 Oct 2016 23:53:33 +0000"  >&lt;p&gt;Hi Herman,&lt;br/&gt;
I have tried with symbolic also, it doesn&apos;t work. Even this query fails with same error.&lt;br/&gt;
SELECT alias.p_double as a0, alias.p_text as a1, NULL as a2 FROM hadoop_tbl_all alias WHERE  (1 = (CASE (&apos;aaaaabbbbb&apos; = alias.p_text) WHEN TRUE THEN 1  WHEN FALSE THEN 0 ELSE CAST(NULL AS INT) END))&lt;/p&gt;

&lt;p&gt;Any boolean condition after case doesn&apos;t work.&lt;/p&gt;</comment>
                            <comment id="15539368" author="hvanhovell" created="Sun, 2 Oct 2016 00:01:56 +0000"  >&lt;p&gt;Yeah, the current grammar doesn&apos;t allow us to use a complex expression as the input for a simple case when statement. I&apos;ll create a fix (PR) for this. You can quite easily work around this issue, if it is blocking you.&lt;/p&gt;</comment>
                            <comment id="15539376" author="kdhuria" created="Sun, 2 Oct 2016 00:07:47 +0000"  >&lt;p&gt;Yeah, Thanks!&lt;/p&gt;</comment>
                            <comment id="15539441" author="apachespark" created="Sun, 2 Oct 2016 01:07:07 +0000"  >&lt;p&gt;User &apos;hvanhovell&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15322&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15322&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15650529" author="shubhnd" created="Wed, 9 Nov 2016 10:08:49 +0000"  >&lt;p&gt;how have you solved the following error:-&lt;/p&gt;


&lt;p&gt; at org.apache.spark.sql.catalyst.parser.ParseException.withCommand(ParseDriver.scala:197)&lt;br/&gt;
  at org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parse(ParseDriver.scala:99)&lt;br/&gt;
  at org.apache.spark.sql.execution.SparkSqlParser.parse(SparkSqlParser.scala:45)&lt;br/&gt;
  at org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parsePlan(ParseDriver.scala:53)&lt;br/&gt;
  at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:582)&lt;br/&gt;
  at org.apache.spark.sql.SQLContext.sql(SQLContext.scala:682)&lt;br/&gt;
  ... 48 elided&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 1 week, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34bpj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>