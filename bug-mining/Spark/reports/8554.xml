<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:30:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-38846] Teradata&apos;s Number is either converted to its floor value or ceiling value despite its fractional part.</title>
                <link>https://issues.apache.org/jira/browse/SPARK-38846</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I&apos;m trying to load data from Teradata, the code using is:&lt;br/&gt;
&#160; &#160;&#160;&lt;/p&gt;

&lt;p&gt;&#160; &#160; sparkSession.read&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; .format(&quot;jdbc&quot;)&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; .options(&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; Map(&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &quot;url&quot; -&amp;gt; &quot;jdbc:teradata://hostname, user=$username, password=$password&quot;,&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &quot;MAYBENULL&quot; -&amp;gt; &quot;ON&quot;,&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &quot;SIP_SUPPORT&quot; -&amp;gt; &quot;ON&quot;,&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &quot;driver&quot; -&amp;gt; &quot;com.teradata.jdbc.TeraDriver&quot;,&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &quot;dbtable&quot; -&amp;gt; $table_name&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; )&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; )&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; .load()&lt;/p&gt;

&lt;p&gt;However, some data lost its fractional part after loading. To be more concise, the column in Teradata is in the type of &lt;span class=&quot;error&quot;&gt;&amp;#91;Number&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; and after loading, the data type in Spark is `DecimalType(38,0)`, the scale value is 0 which means no digits after decimal point.&#160;&lt;/p&gt;

&lt;p&gt;Data in Teradata is something like,&lt;/p&gt;

&lt;p&gt;&#160; &#160; id column1 column2&lt;br/&gt;
&#160; &#160; 1 &#160; 50.23 &#160; &#160;100.23&lt;br/&gt;
&#160; &#160; 2 &#160; 25.8 &#160; &#160; 20.669&lt;br/&gt;
&#160; &#160; 3 &#160; 30.2 &#160; &#160; 19.23&lt;/p&gt;

&lt;p&gt;The `dataframe` of Spark is like,&lt;/p&gt;

&lt;p&gt;&#160; &#160; id column1 column2&lt;br/&gt;
&#160; &#160; 1 &#160; 50 &#160; &#160; 100&lt;br/&gt;
&#160; &#160; 2 &#160; 26 &#160; &#160; 21&lt;br/&gt;
&#160; &#160; 3 &#160; 30 &#160; &#160; 19&lt;/p&gt;

&lt;p&gt;The meta data of the table in Teradata is like:&lt;/p&gt;

&lt;p&gt;&#160; &#160; CREATE SET TABLE table_name (id BIGINT, column1 NUMBER, column2 NUMBER) PRIMARY INDEX (id);&lt;/p&gt;

&lt;p&gt;The Spark version is 2.3.0/3.2.1 and Teradata is 16.20.32.59.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Spark2.3.0/Spark3.2.1 on Yarn&lt;/p&gt;

&lt;p&gt;Teradata 16.20.32.59&lt;/p&gt;</environment>
        <key id="13438787">SPARK-38846</key>
            <summary>Teradata&apos;s Number is either converted to its floor value or ceiling value despite its fractional part.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eugeneple">eugene</assignee>
                                    <reporter username="eugeneple">eugene</reporter>
                        <labels>
                    </labels>
                <created>Sun, 10 Apr 2022 13:33:45 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:45 +0000</updated>
                            <resolved>Mon, 20 Jun 2022 23:11:36 +0000</resolved>
                                    <version>2.3.0</version>
                    <version>3.2.1</version>
                                    <fixVersion>3.4.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17520249" author="gurwls223" created="Mon, 11 Apr 2022 00:11:49 +0000"  >&lt;p&gt;Spark 2.x is EOL. Mind trying Spark 3+ out?&lt;/p&gt;</comment>
                            <comment id="17520299" author="JIRAUSER287848" created="Mon, 11 Apr 2022 04:36:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt;&#160; Thanks, just tried with latest Spark version (Spark 3.2.1) , the issue is still there.&lt;/p&gt;</comment>
                            <comment id="17523186" author="srowen" created="Sat, 16 Apr 2022 19:22:09 +0000"  >&lt;p&gt;Do you know what JDBC type the teradata driver returns for this? it looks like &quot;DECIMAL&quot; but Spark is going by what the JDBC driver says&lt;/p&gt;</comment>
                            <comment id="17534441" author="apachespark" created="Tue, 10 May 2022 16:15:59 +0000"  >&lt;p&gt;User &apos;Eugene-Mark&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/36499&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/36499&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17534444" author="JIRAUSER287848" created="Tue, 10 May 2022 16:20:24 +0000"  >&lt;p&gt;The JDBC type read from Teradata Numeric is `java.math.BigDecimal`. I thought we might need to implement `getCatalystType` method in TeradataDialect to correctly handle Numeric type. I did some research and managed to keep the fractional part by add getCatalystType method in TeradactDialect. I have submitted a PR-36499 related to the issue for your reference.&lt;/p&gt;</comment>
                            <comment id="17556580" author="srowen" created="Mon, 20 Jun 2022 23:11:36 +0000"  >&lt;p&gt;Issue resolved by pull request 36499&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/36499&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/36499&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>scala</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 21 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z11bm0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>