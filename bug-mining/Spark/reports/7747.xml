<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:24:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-26836] Columns get switched in Spark SQL using Avro backed Hive table if schema evolves</title>
                <link>https://issues.apache.org/jira/browse/SPARK-26836</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I have a hive avro table where the avro schema is stored on s3 next to the avro&#160;files.&#160;&lt;/p&gt;

&lt;p&gt;In the table definiton the avro.schema.url always points to the latest partition&apos;s _schema.avsc file which is always the lates schema. (Avro schemas are backward and forward compatible in a table)&lt;/p&gt;

&lt;p&gt;When new data comes in, I always add a new partition where the&#160;avro.schema.url&#160;properties also set to the _schema.avsc which was used when it was added and of course I always update the table avro.schema.url&#160;property to the latest one.&lt;/p&gt;

&lt;p&gt;Querying&#160;this table works fine until the schema evolves in a way that a new optional property is added in the middle.&#160;&lt;/p&gt;

&lt;p&gt;When this happens then after the spark&#160;sql query the columns in the old partition gets mixed up and it shows the wrong data for the columns.&lt;/p&gt;

&lt;p&gt;If I query the table with Hive then everything is perfectly fine and it gives me back the correct columns for the partitions which were created the old schema and for the new which was created the evolved schema.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Here is how I could reproduce with&#160;the &lt;a href=&quot;https://github.com/apache/spark/blob/master/sql/hive/src/test/resources/data/files/doctors.avro&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;doctors.avro&lt;/a&gt; example data in sql&#160;test suite.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;I have created two partition folder:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[hadoop@ip-192-168-10-158 hadoop]$ hdfs dfs -ls s3:&lt;span class=&quot;code-comment&quot;&gt;//somelocation/doctors/*/
&lt;/span&gt;Found 2 items
-rw-rw-rw- 1 hadoop hadoop 418 2019-02-06 12:48 s3:&lt;span class=&quot;code-comment&quot;&gt;//somelocation/doctors
&lt;/span&gt;/dt=2019-02-05/_schema.avsc
-rw-rw-rw- 1 hadoop hadoop 521 2019-02-06 12:13 s3:&lt;span class=&quot;code-comment&quot;&gt;//somelocation/doctors
&lt;/span&gt;/dt=2019-02-05/doctors.avro
Found 2 items
-rw-rw-rw- 1 hadoop hadoop 580 2019-02-06 12:49 s3:&lt;span class=&quot;code-comment&quot;&gt;//somelocation/doctors
&lt;/span&gt;/dt=2019-02-06/_schema.avsc
-rw-rw-rw- 1 hadoop hadoop 577 2019-02-06 12:13 s3:&lt;span class=&quot;code-comment&quot;&gt;//somelocation/doctors
&lt;/span&gt;/dt=2019-02-06/doctors_evolved.avro&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here the first partition had data which was created with the schema before evolving and the second one had the evolved one. (the evolved schema is the same as in your testcase&#160;except&#160;I moved the extra_field column to the last from the second and I generated two lines of avro&#160;data with the evolved schema.&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;I have created a hive table with the following command:&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
CREATE EXTERNAL TABLE `&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.doctors`
 PARTITIONED BY (
 `dt` string
 )
 ROW FORMAT SERDE
 &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.serde2.avro.AvroSerDe&apos;&lt;/span&gt;
 WITH SERDEPROPERTIES (
 &lt;span class=&quot;code-quote&quot;&gt;&apos;avro.schema.url&apos;&lt;/span&gt;=&apos;s3:&lt;span class=&quot;code-comment&quot;&gt;//somelocation/doctors/
&lt;/span&gt;/dt=2019-02-06/_schema.avsc&apos;)
 STORED AS INPUTFORMAT
 &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.ql.io.avro.AvroContainerInputFormat&apos;&lt;/span&gt;
 OUTPUTFORMAT
 &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat&apos;&lt;/span&gt;
 LOCATION
 &lt;span class=&quot;code-quote&quot;&gt;&apos;s3:&lt;span class=&quot;code-comment&quot;&gt;//somelocation/doctors/&apos;&lt;/span&gt;
&lt;/span&gt; TBLPROPERTIES (
 &lt;span class=&quot;code-quote&quot;&gt;&apos;transient_lastDdlTime&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;1538130975&apos;&lt;/span&gt;)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Here as you can see the table schema url&#160;points to the latest schema&lt;/p&gt;

&lt;p&gt;3. I ran an msck &lt;em&gt;repair table&lt;/em&gt; to pick up all the partitions.&lt;/p&gt;

&lt;p&gt;Fyi: If I run my select * query from here then everything is fine and no columns switch happening.&lt;/p&gt;

&lt;p&gt;4. Then I changed the first partition&apos;s avro.schema.url&#160;url&#160;to points to the schema which is under the partition folder (non-evolved one -&amp;gt; s3://somelocation/doctors/&lt;br/&gt;
/dt=2019-02-05/_schema.avsc)&lt;/p&gt;

&lt;p&gt;Then if you ran a &lt;em&gt;select * from default.spark_test&lt;/em&gt; then the columns will be mixed up (on the data below the first name column becomes the extra_field column. I guess because&#160;in the latest schema it is the second column):&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
number,extra_field,first_name,last_name,dt 
6,Colin,Baker,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,2019-02-05 
3,Jon,Pertwee,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,2019-02-05 
4,Tom,Baker,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,2019-02-05 
5,Peter,Davison,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,2019-02-05 
11,Matt,Smith,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,2019-02-05 
1,William,Hartnell,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,2019-02-05 
7,Sylvester,McCoy,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,2019-02-05 
8,Paul,McGann,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,2019-02-05 
2,Patrick,Troughton,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,2019-02-05 
9,Christopher,Eccleston,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,2019-02-05 
10,David,Tennant,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,2019-02-05 
21,fishfinger,Jim,Baker,2019-02-06 
24,fishfinger,Bean,Pertwee,2019-02-06

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If I try the same query from Hive and not from spark sql&#160;then everything is fine and it never&#160;switches the columns.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;I tested with Hive&#160;and&#160;HCatalog which runs on version 2.3.4&#160;and with Spark 2.3.1 and 2.4&lt;/p&gt;</environment>
        <key id="13214170">SPARK-26836</key>
            <summary>Columns get switched in Spark SQL using Avro backed Hive table if schema evolves</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="attilapiros">Attila Zsolt Piros</assignee>
                                    <reporter username="treff7es">Tam&#225;s N&#233;meth</reporter>
                        <labels>
                            <label>correctness</label>
                    </labels>
                <created>Wed, 6 Feb 2019 14:54:48 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:50 +0000</updated>
                            <resolved>Fri, 5 Feb 2021 18:56:58 +0000</resolved>
                                    <version>2.3.1</version>
                    <version>2.4.0</version>
                    <version>3.0.1</version>
                    <version>3.1.0</version>
                    <version>3.2.0</version>
                                    <fixVersion>3.2.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="16763393" author="dongjoon" created="Fri, 8 Feb 2019 08:08:49 +0000"  >&lt;p&gt;Thank you for reporting, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=treff7es&quot; class=&quot;user-hover&quot; rel=&quot;treff7es&quot;&gt;treff7es&lt;/a&gt;. &lt;br/&gt;
Did you see this issue before at Spark 2.3.x with Databricks Avro libraries?&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gengliang.Wang&quot; class=&quot;user-hover&quot; rel=&quot;Gengliang.Wang&quot;&gt;Gengliang.Wang&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16763438" author="treff7es" created="Fri, 8 Feb 2019 09:21:38 +0000"  >&lt;p&gt;I just tried with Spark 2.3.1 and the same issue. I did not specify&#160;any Avro library because it is a Hive&#160;Avro table originally. I guess it is using Hive&apos;s Avro&#160;serde&#160;for serialization/deserialization (or maybe I&apos;m not right &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;).&lt;/p&gt;</comment>
                            <comment id="16763625" author="treff7es" created="Fri, 8 Feb 2019 14:13:46 +0000"  >&lt;p&gt;In the meantime I checked if using the same hive version in Spark would solve this issue by setting:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
spark.sql.hive.metastore.version 2.3.3
spark.sql.hive.metastore.jars /etc/hadoop/conf:/usr/lib/hadoop/lib/*:/usr/lib/hadoop/.&lt;span class=&quot;code-comment&quot;&gt;//*:/usr/lib/hadoop-hdfs/./:/usr/lib/hadoop-hdfs/lib/*:/usr/lib/hadoop-hdfs/.//*:/usr/lib/hadoop-yarn/lib/*:/usr/lib/hadoop-yarn/.//*:/usr/lib/hadoop-mapreduce/lib/*:/usr/lib/hadoop-mapreduce/.//*::/etc/tez/conf:/usr/lib/tez/*:/usr/lib/tez/lib/*:/usr/lib/hadoop-lzo/lib/*:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/emrfs/conf:/usr/share/aws/emr/emrfs/lib/*:/usr/share/aws/emr/emrfs/auxlib/*:/usr/share/aws/emr/ddb/lib/emr-ddb-hadoop.jar:/usr/share/aws/emr/goodies/lib/emr-hadoop-goodies.jar:/usr/share/aws/emr/kinesis/lib/emr-kinesis-hadoop.jar:/usr/share/aws/emr/cloudwatch-sink/lib/*:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/lib/hive/lib/*&#160;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The issue still exists regardless the hive metastore version spark is using.&lt;/p&gt;</comment>
                            <comment id="16764719" author="gengliang.wang" created="Mon, 11 Feb 2019 07:47:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt;I don&apos;t think the issue is related to spark-avro lib.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=treff7es&quot; class=&quot;user-hover&quot; rel=&quot;treff7es&quot;&gt;treff7es&lt;/a&gt; Can you try reproducing the issue on Hive directly and see what the behavior is? &lt;/p&gt;</comment>
                            <comment id="16764933" author="treff7es" created="Mon, 11 Feb 2019 13:04:36 +0000"  >&lt;p&gt;On hive directly the query returns with the correct resultset regardless if &lt;em&gt;avro.schema.url&lt;/em&gt;&#160;is set for the partitions or not :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
hive&amp;gt; select * from spark_test;
OK
6 fishfingers and custard Colin Baker 2019-02-05
3 fishfingers and custard Jon Pertwee 2019-02-05
4 fishfingers and custard Tom Baker 2019-02-05
5 fishfingers and custard Peter Davison 2019-02-05
11 fishfingers and custard Matt Smith 2019-02-05
1 fishfingers and custard William Hartnell 2019-02-05
7 fishfingers and custard Sylvester McCoy 2019-02-05
8 fishfingers and custard Paul McGann 2019-02-05
2 fishfingers and custard Patrick Troughton 2019-02-05
9 fishfingers and custard Christopher Eccleston 2019-02-05
10 fishfingers and custard David Tennant 2019-02-05
21 fishfinger Jim Baker 2019-02-06
24 fishfinger Bean Pertwee 2019-02-06
Time taken: 4.291 seconds, Fetched: 13 row(s)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16764965" author="treff7es" created="Mon, 11 Feb 2019 13:43:22 +0000"  >&lt;p&gt;And one more thing.&lt;/p&gt;

&lt;p&gt;I also got this warning which I did not get if I run on the table where the partitions do not contain the avro.schema.url&#160;property.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
19/02/11 14:39:40 WARN AvroDeserializer: Received different schemas. Have to re-encode: {&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;doctors&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;namespace&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;testing.hive.avro.serde&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;fields&quot;&lt;/span&gt;:[{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;number&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;doc&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;Order of playing the role&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;extra_field&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;fishfingers and custard&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;doc:&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;an extra field not in the original file&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;first_name&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;doc&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;first name of actor playing role&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;last_name&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;doc&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;last name of actor playing role&quot;&lt;/span&gt;}]}
SIZE{-3ac2eea4:168dcc8e145:-8000=org.apache.hadoop.hive.serde2.avro.AvroDeserializer$SchemaReEncoder@1429dfec} ID -3ac2eea4:168dcc8e145:-8000&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16868414" author="david_ravet" created="Thu, 20 Jun 2019 10:03:02 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;We encounter the same issue with Spark 2.2.0 when reading avro from a partition where avro.schema.url point to a new schema (forward compatibility) but stored avro files were in older schema.&lt;/p&gt;

&lt;p&gt;Querying with Hive client is OK but with Spark Sql we get &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
19/06/20 10:43:47 WARN avro.AvroDeserializer: Received different schemas.  Have to re-encode: {&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;KeyValuePair&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;namespace&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.avro.mapreduce&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;doc&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;A key/value pair&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;fields&quot;&lt;/span&gt;:[{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;key&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: .............
SIZE{4207b7ac:16b740e5ed1:-8000=org.apache.hadoop.hive.serde2.avro.AvroDeserializer$SchemaReEncoder@17173314} ID 4207b7ac:16b740e5ed1:-8000
19/06/20 10:43:47 ERROR executor.Executor: Exception in task 6.0 in stage 1.0 (TID 22)
java.lang.RuntimeException: Hive internal error: conversion of &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; to struct&amp;lt;unscaledamount:bigint,scale:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,currency:string,currencyalphacode:string&amp;gt;not supported yet.
	at org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorConverters$StructConverter.&amp;lt;init&amp;gt;(ObjectInspectorConverters.java:380)
	at org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorConverters.getConverter(ObjectInspectorConverters.java:155)
	at org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorConverters$StructConverter.&amp;lt;init&amp;gt;(ObjectInspectorConverters.java:374)
	at org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorConverters.getConverter(ObjectInspectorConverters.java:155)
	at org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorConverters$ListConverter.convert(ObjectInspectorConverters.java:331)
	at org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorConverters$StructConverter.convert(ObjectInspectorConverters.java:396)
	at org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorConverters$StructConverter.convert(ObjectInspectorConverters.java:396)
	at org.apache.spark.sql.hive.HadoopTableReader$$anonfun$fillObject$2.apply(TableReader.scala:430)
	at org.apache.spark.sql.hive.HadoopTableReader$$anonfun$fillObject$2.apply(TableReader.scala:429)
	at scala.collection.Iterator$$anon$11.next(Iterator.scala:409)
	at scala.collection.Iterator$$anon$11.next(Iterator.scala:409)
	at scala.collection.Iterator$$anon$11.next(Iterator.scala:409)
	at scala.collection.Iterator$$anon$11.next(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:149)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)
	at org.apache.spark.scheduler.Task.run(Task.scala:108)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:338)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16868888" author="dongjoon" created="Thu, 20 Jun 2019 19:58:05 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dbtsai&quot; class=&quot;user-hover&quot; rel=&quot;dbtsai&quot;&gt;dbtsai&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17040853" author="cloud_fan" created="Thu, 20 Feb 2020 11:01:18 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gengliang.Wang&quot; class=&quot;user-hover&quot; rel=&quot;Gengliang.Wang&quot;&gt;Gengliang.Wang&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17047170" author="gurwls223" created="Fri, 28 Feb 2020 02:59:50 +0000"  >&lt;p&gt;I am lowering the priority to Critical as it&apos;s at least not a regression and doesn&apos;t look blocking Spark 3.0; however, indeed we should treat correctness issues at least Critical+.&lt;/p&gt;</comment>
                            <comment id="17261398" author="attilapiros" created="Fri, 8 Jan 2021 16:14:44 +0000"  >&lt;p&gt;I am working on this and a PR can be expected this weekend / next week&lt;/p&gt;</comment>
                            <comment id="17262681" author="apachespark" created="Mon, 11 Jan 2021 14:35:55 +0000"  >&lt;p&gt;User &apos;attilapiros&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31133&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31133&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17279915" author="dongjoon" created="Fri, 5 Feb 2021 18:56:58 +0000"  >&lt;p&gt;Issue resolved by pull request 31133&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31133&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31133&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12957798" name="doctors.avro" size="521" author="treff7es" created="Wed, 6 Feb 2019 15:42:59 +0000"/>
                            <attachment id="12957795" name="doctors_evolved.avro" size="577" author="treff7es" created="Wed, 6 Feb 2019 15:42:59 +0000"/>
                            <attachment id="12957796" name="doctors_evolved.json" size="177" author="treff7es" created="Wed, 6 Feb 2019 15:42:59 +0000"/>
                            <attachment id="12957797" name="original.avsc" size="418" author="treff7es" created="Wed, 6 Feb 2019 15:42:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 40 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi0pqg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>