<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:08:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-29600] array_contains built in function is not backward compatible in 3.0</title>
                <link>https://issues.apache.org/jira/browse/SPARK-29600</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SELECT array_contains(array(0,0.1,0.2,0.3,0.5,0.02,0.033), .2); 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;throws Exception in 3.0 where as in 2.3.2 is working fine.&lt;/p&gt;

&lt;p&gt;Spark 3.0 output:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//10.18.19.208:23040/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;&amp;gt; SELECT array_contains(array(0,0.1,0.2,0.3,0.5,0.02,0.033), .2);
&lt;/span&gt; Error: org.apache.spark.sql.AnalysisException: cannot resolve &lt;span class=&quot;code-quote&quot;&gt;&apos;array_contains(array(CAST(0 AS DECIMAL(13,3)), CAST(0.1BD AS DECIMAL(13,3)), CAST(0.2BD AS DECIMAL(13,3)), CAST(0.3BD AS DECIMAL(13,3)), CAST(0.5BD AS DECIMAL(13,3)), CAST(0.02BD AS DECIMAL(13,3)), CAST(0.033BD AS DECIMAL(13,3))), 0.2BD)&apos;&lt;/span&gt; due to data type mismatch: Input to function array_contains should have been array followed by a value with same element type, but it&apos;s [array&amp;lt;decimal(13,3)&amp;gt;, decimal(1,1)].; line 1 pos 7;
 &apos;Project [unresolvedalias(array_contains(array(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(0 as decimal(13,3)), &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(0.1 as decimal(13,3)), &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(0.2 as decimal(13,3)), &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(0.3 as decimal(13,3)), &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(0.5 as decimal(13,3)), &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(0.02 as decimal(13,3)), &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(0.033 as decimal(13,3))), 0.2), None)]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Spark 2.3.2 output&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//10.18.18.214:23040/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;&amp;gt; SELECT array_contains(array(0,0.1,0.2,0.3,0.5,0.02,0.033), .2);
&lt;/span&gt;|array_contains(array(CAST(0 AS DECIMAL(13,3)), CAST(0.1 AS DECIMAL(13,3)), CAST(0.2 AS DECIMAL(13,3)), CAST(0.3 AS DECIMAL(13,3)), CAST(0.5 AS DECIMAL(13,3)), CAST(0.02 AS DECIMAL(13,3)), CAST(0.033 AS DECIMAL(13,3))), CAST(0.2 AS DECIMAL(13,3)))|
|&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|

1 row selected (0.18 seconds)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13264419">SPARK-29600</key>
            <summary>array_contains built in function is not backward compatible in 3.0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aman_omer">Aman Omer</assignee>
                                    <reporter username="abhishek.akg">ABHISHEK KUMAR GUPTA</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Oct 2019 06:28:01 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:55 +0000</updated>
                            <resolved>Tue, 17 Dec 2019 17:31:49 +0000</resolved>
                                    <version>3.0.0</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16959467" author="udbhav agrawal" created="Fri, 25 Oct 2019 06:29:44 +0000"  >&lt;p&gt;I will check this issue&lt;/p&gt;</comment>
                            <comment id="16960988" author="gurwls223" created="Mon, 28 Oct 2019 12:25:34 +0000"  >&lt;p&gt;Please go ahead but please just don&apos;t copy and paste. Narrow down the problem with analysis otherwise no one can investigate.&lt;/p&gt;</comment>
                            <comment id="16967466" author="gurwls223" created="Tue, 5 Nov 2019 11:59:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Udbhav+Agrawal&quot; class=&quot;user-hover&quot; rel=&quot;Udbhav Agrawal&quot;&gt;Udbhav Agrawal&lt;/a&gt;did you made some progresses on this?&lt;/p&gt;</comment>
                            <comment id="16967567" author="udbhav agrawal" created="Tue, 5 Nov 2019 14:28:48 +0000"  >&lt;p&gt;Yes &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt; ,&lt;br/&gt;
Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abhishek.akg&quot; class=&quot;user-hover&quot; rel=&quot;abhishek.akg&quot;&gt;abhishek.akg&lt;/a&gt; please check there was a behavior change in array_contains function, which has been documented in &lt;a href=&quot;https://github.com/apache/spark/blob/master/docs/sql-migration-guide.md#upgrading-from-spark-sql-23-to-24&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;sql-migration-guide&lt;/a&gt;  &lt;/p&gt;</comment>
                            <comment id="16968909" author="abhishek.akg" created="Thu, 7 Nov 2019 04:15:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Udbhav+Agrawal&quot; class=&quot;user-hover&quot; rel=&quot;Udbhav Agrawal&quot;&gt;Udbhav Agrawal&lt;/a&gt;: I gone through the migration guide and it is more talking about the &quot;In Spark 2.4, AnalysisException is thrown since integer type can not be promoted to string type in a loss-less manner.&quot; which is not the case in the above query.&lt;/p&gt;</comment>
                            <comment id="16976319" author="udbhav agrawal" created="Mon, 18 Nov 2019 06:50:38 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt;, this failure is because we cannot cast the literal to array type after the above behavior change. For example:&lt;br/&gt;
array(0.1,0.2,0.33) is type decimal(2,2) and literal 0.1 and 0.2 is also changed to decimal(2,2) but if we check 0.2 which actually is of type decimal(1,1) this query fails its data type doesn&apos;t match with array&apos;s data type.&lt;/p&gt;</comment>
                            <comment id="16998410" author="cloud_fan" created="Tue, 17 Dec 2019 17:31:49 +0000"  >&lt;p&gt;Issue resolved by pull request 26811&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/26811&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/26811&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16998413" author="aman_omer" created="Tue, 17 Dec 2019 17:37:01 +0000"  >&lt;p&gt;ID: aman_omer&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 48 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z07y0o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>