<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:29:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-8535] PySpark : Can&apos;t create DataFrame from Pandas dataframe with no explicit column name</title>
                <link>https://issues.apache.org/jira/browse/SPARK-8535</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Trying to create a Spark DataFrame from a pandas dataframe with no explicit column name : &lt;/p&gt;

&lt;p&gt;pandasDF = pd.DataFrame([&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2&amp;#93;&lt;/span&gt;, &lt;span class=&quot;error&quot;&gt;&amp;#91;5, 6&amp;#93;&lt;/span&gt;])&lt;br/&gt;
sparkDF = sqlContext.createDataFrame(pandasDF)&lt;/p&gt;

&lt;p&gt;***********&lt;/p&gt;

&lt;p&gt;----&amp;gt; 1 sparkDF = sqlContext.createDataFrame(pandasDF)&lt;/p&gt;

&lt;p&gt;/usr/local/Cellar/apache-spark/1.4.0/libexec/python/pyspark/sql/context.pyc in createDataFrame(self, data, schema, samplingRatio)&lt;br/&gt;
    344 &lt;br/&gt;
    345         jrdd = self._jvm.SerDeUtil.toJavaArray(rdd._to_java_object_rdd())&lt;br/&gt;
--&amp;gt; 346         df = self._ssql_ctx.applySchemaToPythonRDD(jrdd.rdd(), schema.json())&lt;br/&gt;
    347         return DataFrame(df, self)&lt;br/&gt;
    348 &lt;/p&gt;

&lt;p&gt;/usr/local/Cellar/apache-spark/1.4.0/libexec/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py in _&lt;em&gt;call&lt;/em&gt;_(self, *args)&lt;br/&gt;
    536         answer = self.gateway_client.send_command(command)&lt;br/&gt;
    537         return_value = get_return_value(answer, self.gateway_client,&lt;br/&gt;
--&amp;gt; 538                 self.target_id, self.name)&lt;br/&gt;
    539 &lt;br/&gt;
    540         for temp_arg in temp_args:&lt;/p&gt;

&lt;p&gt;/usr/local/Cellar/apache-spark/1.4.0/libexec/python/lib/py4j-0.8.2.1-src.zip/py4j/protocol.py in get_return_value(answer, gateway_client, target_id, name)&lt;br/&gt;
    298                 raise Py4JJavaError(&lt;br/&gt;
    299                     &apos;An error occurred while calling &lt;/p&gt;
{0}
{1}
{2}
&lt;p&gt;.\n&apos;.&lt;br/&gt;
--&amp;gt; 300                     format(target_id, &apos;.&apos;, name), value)&lt;br/&gt;
    301             else:&lt;br/&gt;
    302                 raise Py4JError(&lt;/p&gt;

&lt;p&gt;Py4JJavaError: An error occurred while calling o87.applySchemaToPythonRDD.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12839660">SPARK-8535</key>
            <summary>PySpark : Can&apos;t create DataFrame from Pandas dataframe with no explicit column name</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="x1">Yuri Saito</assignee>
                                    <reporter username="kriss">Christophe Bourguignat</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Jun 2015 20:15:18 +0000</created>
                <updated>Thu, 2 Jul 2015 19:55:17 +0000</updated>
                            <resolved>Wed, 1 Jul 2015 03:36:03 +0000</resolved>
                                    <version>1.4.0</version>
                                    <fixVersion>1.3.2</fixVersion>
                    <fixVersion>1.4.1</fixVersion>
                    <fixVersion>1.5.0</fixVersion>
                                    <component>PySpark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14608132" author="apachespark" created="Tue, 30 Jun 2015 11:11:03 +0000"  >&lt;p&gt;User &apos;x1-&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7124&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7124&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14608133" author="x1" created="Tue, 30 Jun 2015 11:12:00 +0000"  >&lt;p&gt;Because implicit name of &lt;tt&gt;pandas.columns&lt;/tt&gt; are Int, but &lt;tt&gt;StructField&lt;/tt&gt; json expect &lt;tt&gt;String&lt;/tt&gt;.&lt;br/&gt;
So I think &lt;tt&gt;pandas.columns&lt;/tt&gt; are should be convert to &lt;tt&gt;String&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;I create PR below.&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7124&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7124&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14609515" author="davies" created="Wed, 1 Jul 2015 03:36:03 +0000"  >&lt;p&gt;Issue resolved by pull request 7124&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7124&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7124&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14609552" author="x1" created="Wed, 1 Jul 2015 04:49:17 +0000"  >&lt;p&gt;Could you change assignee from no-assignee to me?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 20 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2gcs7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>