<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:44:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-15046] When running hive-thriftserver with yarn on a secure cluster the workers fail with java.lang.NumberFormatException</title>
                <link>https://issues.apache.org/jira/browse/SPARK-15046</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;When running hive-thriftserver with yarn on a secure cluster (spark.yarn.principal and spark.yarn.keytab are set) the workers fail with the following error.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;16/04/30 22:40:50 ERROR yarn.ApplicationMaster: Uncaught exception: 
java.lang.NumberFormatException: For input string: &lt;span class=&quot;code-quote&quot;&gt;&quot;86400079ms&quot;&lt;/span&gt;
	at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.parseLong(&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.java:441)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.parseLong(&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.java:483)
	at scala.collection.immutable.StringLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;toLong(StringLike.scala:276)
	at scala.collection.immutable.StringOps.toLong(StringOps.scala:29)
	at org.apache.spark.SparkConf$$anonfun$getLong$2.apply(SparkConf.scala:380)
	at org.apache.spark.SparkConf$$anonfun$getLong$2.apply(SparkConf.scala:380)
	at scala.Option.map(Option.scala:146)
	at org.apache.spark.SparkConf.getLong(SparkConf.scala:380)
	at org.apache.spark.deploy.SparkHadoopUtil.getTimeFromNowToRenewal(SparkHadoopUtil.scala:289)
	at org.apache.spark.deploy.yarn.AMDelegationTokenRenewer.org$apache$spark$deploy$yarn$AMDelegationTokenRenewer$$scheduleRenewal$1(AMDelegationTokenRenewer.scala:89)
	at org.apache.spark.deploy.yarn.AMDelegationTokenRenewer.scheduleLoginFromKeytab(AMDelegationTokenRenewer.scala:121)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$3.apply(ApplicationMaster.scala:243)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$3.apply(ApplicationMaster.scala:243)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.deploy.yarn.ApplicationMaster.run(ApplicationMaster.scala:243)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$main$1.apply$mcV$sp(ApplicationMaster.scala:723)
	at org.apache.spark.deploy.SparkHadoopUtil$$anon$1.run(SparkHadoopUtil.scala:67)
	at org.apache.spark.deploy.SparkHadoopUtil$$anon$1.run(SparkHadoopUtil.scala:66)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.spark.deploy.SparkHadoopUtil.runAsSparkUser(SparkHadoopUtil.scala:66)
	at org.apache.spark.deploy.yarn.ApplicationMaster$.main(ApplicationMaster.scala:721)
	at org.apache.spark.deploy.yarn.ExecutorLauncher$.main(ApplicationMaster.scala:748)
	at org.apache.spark.deploy.yarn.ExecutorLauncher.main(ApplicationMaster.scala)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12964163">SPARK-15046</key>
            <summary>When running hive-thriftserver with yarn on a secure cluster the workers fail with java.lang.NumberFormatException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vanzin">Marcelo Masiero Vanzin</assignee>
                                    <reporter username="tleftwich">Trystan Leftwich</reporter>
                        <labels>
                    </labels>
                <created>Sun, 1 May 2016 19:14:06 +0000</created>
                <updated>Sun, 17 May 2020 18:16:53 +0000</updated>
                            <resolved>Wed, 15 Jun 2016 14:10:21 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Spark Core</component>
                    <component>YARN</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15265902" author="apachespark" created="Sun, 1 May 2016 19:35:04 +0000"  >&lt;p&gt;User &apos;trystanleftwich&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/12824&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/12824&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15316162" author="grace.huang" created="Mon, 6 Jun 2016 03:33:46 +0000"  >&lt;p&gt;Yes. I met the similar issue. And after that patch applied, it works. &lt;/p&gt;</comment>
                            <comment id="15316163" author="grace.huang" created="Mon, 6 Jun 2016 04:00:32 +0000"  >&lt;p&gt;But the interesting thing is that the bug is not reproducing while changing to 1.6 version. according to my understanding, when we submit a new job, we won&apos;t have the credential file (at the first time). This function won&apos;t be called at that time. That is why we are not noticing that issue before. Actually, that code snippet has been there since 1.6. &lt;/p&gt;</comment>
                            <comment id="15316311" author="srowen" created="Mon, 6 Jun 2016 08:06:03 +0000"  >&lt;p&gt;I don&apos;t see evidence that this parameter is supposed to accept values like &quot;1234ms&quot;. It is a value in ms at least according to the few places in the code that parse it. Is it not just a matter of writing 86400079?&lt;/p&gt;</comment>
                            <comment id="15316546" author="tleftwich" created="Mon, 6 Jun 2016 14:25:32 +0000"  >&lt;p&gt;It looks like the Spark config is converting any Int value over to a TimeUnit MS value: &lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/blob/8b44bd52fa40c0fc7d34798c3654e31533fd3008/yarn/src/main/scala/org/apache/spark/deploy/yarn/config.scala#L246&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/8b44bd52fa40c0fc7d34798c3654e31533fd3008/yarn/src/main/scala/org/apache/spark/deploy/yarn/config.scala#L246&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;So when the configs are written out to be sent to the Worker nodes the values are now TimeUnit ms, which is why this error is happening.&lt;/p&gt;</comment>
                            <comment id="15319817" author="grace.huang" created="Wed, 8 Jun 2016 01:11:44 +0000"  >&lt;p&gt;OK, I see. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tleftwich&quot; class=&quot;user-hover&quot; rel=&quot;tleftwich&quot;&gt;tleftwich&lt;/a&gt;. If so, it seems we&apos;d better to use the new configure API, like:&lt;/p&gt;

 &lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;sparkConf.get(TOKEN_RENEWAL_INTERVAL, (24 hours).toMillis)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="15321037" author="vanzin" created="Wed, 8 Jun 2016 17:44:12 +0000"  >&lt;p&gt;Marking as blocker since this is a regression.&lt;/p&gt;</comment>
                            <comment id="15330723" author="apachespark" created="Tue, 14 Jun 2016 22:03:06 +0000"  >&lt;p&gt;User &apos;vanzin&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/13669&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/13669&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16769890" author="toopt4" created="Sat, 16 Feb 2019 00:08:50 +0000"  >&lt;p&gt;gentle ping&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 39 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2x0o7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12329449">2.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>