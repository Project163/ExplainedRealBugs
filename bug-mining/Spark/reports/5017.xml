<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:54:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-21332] Incorrect result type inferred for some decimal expressions</title>
                <link>https://issues.apache.org/jira/browse/SPARK-21332</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Decimal expressions do not always follow the type inference rules explained in DecimalPrecision.scala.  An incorrect result type is produced when the expressions contains  more than 2 decimals.&lt;/p&gt;

&lt;p&gt;For example:&lt;br/&gt;
spark-sql&amp;gt; CREATE TABLE Decimals(decimal_26_6 DECIMAL(26,6)); &lt;br/&gt;
...&lt;br/&gt;
spark-sql&amp;gt; describe decimals;&lt;br/&gt;
...&lt;br/&gt;
decimal_26_6	decimal(26,6)	NULL&lt;br/&gt;
spark-sql&amp;gt; explain select decimal_26_6 * decimal_26_6 from decimals;&lt;br/&gt;
...&lt;br/&gt;
== Physical Plan ==&lt;br/&gt;
*Project &lt;a href=&quot;#99 * decimal_26_6#99), DecimalType(38,12)) AS (decimal_26_6 * decimal_26_6)#100&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CheckOverflow((decimal_26_6#99 * decimal_26_6#99), DecimalType(38,12)) AS (decimal_26_6 * decimal_26_6)#100&lt;/a&gt;&lt;br/&gt;
+- HiveTableScan &lt;a href=&quot;#99&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;decimal_26_6#99&lt;/a&gt;, MetastoreRelation default, decimals&lt;/p&gt;

&lt;p&gt;However:&lt;br/&gt;
spark-sql&amp;gt; explain select decimal_26_6 * decimal_26_6 * decimal_26_6 from decimals;&lt;br/&gt;
...&lt;br/&gt;
== Physical Plan ==&lt;br/&gt;
*Project &lt;a href=&quot;#104 * decimal_26_6#104), DecimalType(38,12)) as decimal(26,6)) * decimal_26_6#104), DecimalType(38,12)) AS ((decimal_26_6 * decimal_26_6) * decimal_26_6)#105&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CheckOverflow((cast(CheckOverflow((decimal_26_6#104 * decimal_26_6#104), DecimalType(38,12)) as decimal(26,6)) * decimal_26_6#104), DecimalType(38,12)) AS ((decimal_26_6 * decimal_26_6) * decimal_26_6)#105&lt;/a&gt;&lt;br/&gt;
+- HiveTableScan &lt;a href=&quot;#104&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;decimal_26_6#104&lt;/a&gt;, MetastoreRelation default, decimals&lt;/p&gt;

&lt;p&gt;The expected result type is DecimalType(38,18).&lt;/p&gt;

&lt;p&gt;In Hive 1.1.0:&lt;br/&gt;
hive&amp;gt; explain select decimal_26_6 * decimal_26_6 from decimals;&lt;br/&gt;
OK&lt;br/&gt;
STAGE DEPENDENCIES:&lt;br/&gt;
  Stage-0 is a root stage&lt;/p&gt;

&lt;p&gt;STAGE PLANS:&lt;br/&gt;
  Stage: Stage-0&lt;br/&gt;
    Fetch Operator&lt;br/&gt;
      limit: -1&lt;br/&gt;
      Processor Tree:&lt;br/&gt;
        TableScan&lt;br/&gt;
          alias: decimals&lt;br/&gt;
          Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE&lt;br/&gt;
          Select Operator&lt;br/&gt;
            expressions: (decimal_26_6 * decimal_26_6) (type: decimal(38,12))&lt;br/&gt;
            outputColumnNames: _col0&lt;br/&gt;
            Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE&lt;br/&gt;
            ListSink&lt;/p&gt;

&lt;p&gt;Time taken: 0.772 seconds, Fetched: 17 row(s)&lt;br/&gt;
hive&amp;gt; explain select decimal_26_6 * decimal_26_6 * decimal_26_6 from decimals;&lt;br/&gt;
OK&lt;br/&gt;
STAGE DEPENDENCIES:&lt;br/&gt;
  Stage-0 is a root stage&lt;/p&gt;

&lt;p&gt;STAGE PLANS:&lt;br/&gt;
  Stage: Stage-0&lt;br/&gt;
    Fetch Operator&lt;br/&gt;
      limit: -1&lt;br/&gt;
      Processor Tree:&lt;br/&gt;
        TableScan&lt;br/&gt;
          alias: decimals&lt;br/&gt;
          Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE&lt;br/&gt;
          Select Operator&lt;br/&gt;
            expressions: ((decimal_26_6 * decimal_26_6) * decimal_26_6) (type: decimal(38,18))&lt;br/&gt;
            outputColumnNames: _col0&lt;br/&gt;
            Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE&lt;br/&gt;
            ListSink&lt;/p&gt;

&lt;p&gt;Time taken: 0.064 seconds, Fetched: 17 row(s)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13085354">SPARK-21332</key>
            <summary>Incorrect result type inferred for some decimal expressions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aokolnychyi">Anton Okolnychyi</assignee>
                                    <reporter username="ashkapsky">Alexander Shkapsky</reporter>
                        <labels>
                            <label>correctness</label>
                    </labels>
                <created>Thu, 6 Jul 2017 23:42:22 +0000</created>
                <updated>Tue, 12 Dec 2017 18:56:49 +0000</updated>
                            <resolved>Tue, 18 Jul 2017 04:10:09 +0000</resolved>
                                    <version>2.0.2</version>
                                    <fixVersion>2.0.3</fixVersion>
                    <fixVersion>2.1.2</fixVersion>
                    <fixVersion>2.2.1</fixVersion>
                    <fixVersion>2.3.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16079525" author="aokolnychyi" created="Sun, 9 Jul 2017 10:09:03 +0000"  >&lt;p&gt;I know the root cause and will submit a PR soon.&lt;/p&gt;</comment>
                            <comment id="16080029" author="apachespark" created="Mon, 10 Jul 2017 08:44:04 +0000"  >&lt;p&gt;User &apos;aokolnychyi&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/18583&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/18583&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13124164">SPARK-22755</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 19 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3h7vb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>