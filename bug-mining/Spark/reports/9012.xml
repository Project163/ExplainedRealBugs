<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:33:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-43142] DSL expressions fail on attribute with special characters</title>
                <link>https://issues.apache.org/jira/browse/SPARK-43142</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Expressions on implicitly converted attributes fail if the attributes have names containing special characters. They fail even if the attributes are backtick-quoted:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.catalyst.dsl.expressions._
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.catalyst.dsl.expressions._

scala&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;`slashed/col`&quot;&lt;/span&gt;.attr
res0: org.apache.spark.sql.catalyst.analysis.UnresolvedAttribute = &apos;slashed/col

scala&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;`slashed/col`&quot;&lt;/span&gt;.attr.asc
org.apache.spark.sql.catalyst.parser.ParseException:
mismatched input &lt;span class=&quot;code-quote&quot;&gt;&apos;/&apos;&lt;/span&gt; expecting {&amp;lt;EOF&amp;gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;.&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;-&apos;&lt;/span&gt;}(line 1, pos 7)

== SQL ==
slashed/col
-------^^^
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13532662">SPARK-43142</key>
            <summary>DSL expressions fail on attribute with special characters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rshkv">Willi Raschkowski</assignee>
                                    <reporter username="rshkv">Willi Raschkowski</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Apr 2023 13:11:31 +0000</created>
                <updated>Tue, 25 Apr 2023 10:23:52 +0000</updated>
                            <resolved>Tue, 25 Apr 2023 10:23:52 +0000</resolved>
                                    <version>3.4.0</version>
                                    <fixVersion>3.5.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17712382" author="raschkowski" created="Fri, 14 Apr 2023 13:17:20 +0000"  >&lt;p&gt;Here&apos;s what&apos;s happening: &lt;tt&gt;ImplicitOperators&lt;/tt&gt; methods like &lt;tt&gt;asc&lt;/tt&gt; rely on a call to &lt;tt&gt;expr&lt;/tt&gt; &lt;a href=&quot;https://github.com/apache/spark/blob/87a5442f7ed96b11051d8a9333476d080054e5a0/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/dsl/package.scala#L149&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;(Github)&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;The &lt;tt&gt;UnresolvedAttribute&lt;/tt&gt; returned by &lt;tt&gt;.attr&lt;/tt&gt; is implicitly converted to &lt;tt&gt;DslAttr&lt;/tt&gt;. But &lt;tt&gt;DslAttr&lt;/tt&gt; does not implement &lt;tt&gt;expr&lt;/tt&gt; by returning the attribute it&apos;s already wrapping. Instead, it only implements how to convert the attribute it&apos;s wrapping to a string name &lt;a href=&quot;https://github.com/apache/spark/blob/87a5442f7ed96b11051d8a9333476d080054e5a0/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/dsl/package.scala#L273-L275&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;(Github)&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Returning an attribute for an implicitly wrapped attribute is implemented on the super class &lt;tt&gt;ImplicitAttribute&lt;/tt&gt; by creating a new &lt;tt&gt;UnresolvedAttribute&lt;/tt&gt; on the string name return by &lt;tt&gt;DslAttr&lt;/tt&gt; (the method call &lt;tt&gt;s&lt;/tt&gt;, &lt;a href=&quot;https://github.com/apache/spark/blob/87a5442f7ed96b11051d8a9333476d080054e5a0/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/dsl/package.scala#L278-L280&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Github&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;The problem is that this string name returned by &lt;tt&gt;DslAttr&lt;/tt&gt; no longer has the quotes and thus the new &lt;tt&gt;UnresolvedAttribute&lt;/tt&gt; parses an unquoted identifier.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;`col/slash`&quot;&lt;/span&gt;.attr.name
res1: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; = col/slash
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17712383" author="raschkowski" created="Fri, 14 Apr 2023 13:18:03 +0000"  >&lt;p&gt;The solution I&apos;d propose is to have &lt;tt&gt;DslAttr.attr&lt;/tt&gt; return the attribute it&apos;s wrapping instead of creating a new attribute.&lt;/p&gt;

&lt;p&gt;I&apos;ll put up a PR.&lt;/p&gt;</comment>
                            <comment id="17712395" author="raschkowski" created="Fri, 14 Apr 2023 13:45:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/spark/pull/40794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40794&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17714209" author="hudson" created="Wed, 19 Apr 2023 17:08:16 +0000"  >&lt;p&gt;User &apos;rshkv&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/40794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40794&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17714989" author="cloud_fan" created="Fri, 21 Apr 2023 12:55:15 +0000"  >&lt;p&gt;Issue resolved by pull request 40794&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/40794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40794&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17715253" author="githubbot" created="Sat, 22 Apr 2023 09:16:47 +0000"  >&lt;p&gt;User &apos;rshkv&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/40902&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40902&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17716208" author="cloud_fan" created="Tue, 25 Apr 2023 10:23:52 +0000"  >&lt;p&gt;Issue resolved by pull request 40902&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/40902&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40902&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 29 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1hako:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>