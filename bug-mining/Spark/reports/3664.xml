<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:44:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-15247] sqlCtx.read.parquet yields at least n_executors * n_cores tasks</title>
                <link>https://issues.apache.org/jira/browse/SPARK-15247</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;sqlCtx.read.parquet always yields at least n_executors * n_cores tasks, even though this is only 1 very small file&lt;/p&gt;

&lt;p&gt;This issue can increase the latency for small jobs.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12966634">SPARK-15247</key>
            <summary>sqlCtx.read.parquet yields at least n_executors * n_cores tasks</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="maropu">Takeshi Yamamuro</assignee>
                                    <reporter username="johnnyws">Johnny W.</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 May 2016 07:07:08 +0000</created>
                <updated>Tue, 14 Jun 2016 20:18:49 +0000</updated>
                            <resolved>Tue, 14 Jun 2016 20:18:49 +0000</resolved>
                                    <version>1.6.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15278288" author="maropu" created="Tue, 10 May 2016 15:35:49 +0000"  >&lt;p&gt;You tried this in master? Seems this issue has been fixed there; small files are packed into a single partition. Please check &lt;a href=&quot;https://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/FileSourceStrategy.scala#L46&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/FileSourceStrategy.scala#L46&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15281221" author="johnnyws" created="Thu, 12 May 2016 05:26:50 +0000"  >&lt;p&gt;Takeshi, thanks for your reply. However,  I don&apos;t think they are relevant, because even though I have only 1 (very small) file, spark creates n_executors * n_cores tasks, and this is only true for parquet. This issue has been confirmed by others from the community:&lt;br/&gt;
&amp;#8211;&lt;br/&gt;
&lt;a href=&quot;https://www.mail-archive.com/user@spark.apache.org/msg50568.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.mail-archive.com/user@spark.apache.org/msg50568.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Is there any walkaround for this?&lt;/p&gt;</comment>
                            <comment id="15281270" author="maropu" created="Thu, 12 May 2016 07:16:00 +0000"  >&lt;p&gt;Ah, yes. I got you. I try to look into this.&lt;/p&gt;</comment>
                            <comment id="15281408" author="maropu" created="Thu, 12 May 2016 10:34:27 +0000"  >&lt;p&gt;I found that `ParquetRelation` internally checks a schema by using `SparkContext#parallelize` with `defaultParallelism` (that is, _executors * n_cores by default), so `sqlCtx.read.parquet` generates many tasks. One of workarounds is to set a suitable number at `spark.default.parallelism`.&lt;br/&gt;
See: &lt;a href=&quot;https://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/parquet/ParquetRelation.scala#L800&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/parquet/ParquetRelation.scala#L800&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;How big does this issue make performance degradation?&lt;/p&gt;</comment>
                            <comment id="15282351" author="maropu" created="Fri, 13 May 2016 02:27:46 +0000"  >&lt;p&gt;We can easily fix this issue like &lt;a href=&quot;https://github.com/maropu/spark/commit/14769c15fc62ed29aa74ce343d428ac86a32d118&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/maropu/spark/commit/14769c15fc62ed29aa74ce343d428ac86a32d118&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15284432" author="srowen" created="Mon, 16 May 2016 12:36:01 +0000"  >&lt;p&gt;Did you actually open a PR for this?&lt;/p&gt;</comment>
                            <comment id="15284486" author="maropu" created="Mon, 16 May 2016 13:35:20 +0000"  >&lt;p&gt;Not yet. Actually, I&apos;m not 100% sure that this issue needs to be fixed.&lt;/p&gt;</comment>
                            <comment id="15284763" author="maropu" created="Mon, 16 May 2016 16:00:44 +0000"  >&lt;p&gt;I&apos;ll make a pr to fix this.&lt;/p&gt;</comment>
                            <comment id="15284771" author="apachespark" created="Mon, 16 May 2016 16:06:03 +0000"  >&lt;p&gt;User &apos;maropu&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/13137&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/13137&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15330493" author="yhuai" created="Tue, 14 Jun 2016 20:18:49 +0000"  >&lt;p&gt;This issue has been resolved by &lt;a href=&quot;https://github.com/apache/spark/pull/13137&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/13137&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 22 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2xfuv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>