<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:49:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-18187] CompactibleFileStreamLog should not rely on &quot;compactInterval&quot; to detect a compaction batch</title>
                <link>https://issues.apache.org/jira/browse/SPARK-18187</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Right now CompactibleFileStreamLog uses compactInterval to check if a batch is a compaction batch. However, since this conf is controlled by the user, they may just change it, and CompactibleFileStreamLog will just silently return the wrong answer.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13016761">SPARK-18187</key>
            <summary>CompactibleFileStreamLog should not rely on &quot;compactInterval&quot; to detect a compaction batch</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tcondie">Tyson Condie</assignee>
                                    <reporter username="zsxwing">Shixiong Zhu</reporter>
                        <labels>
                    </labels>
                <created>Mon, 31 Oct 2016 23:30:21 +0000</created>
                <updated>Fri, 18 Nov 2016 19:12:53 +0000</updated>
                            <resolved>Fri, 18 Nov 2016 19:12:16 +0000</resolved>
                                    <version>2.0.1</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>Structured Streaming</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15624263" author="lwlin" created="Tue, 1 Nov 2016 03:59:03 +0000"  >&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zsxwing&quot; class=&quot;user-hover&quot; rel=&quot;zsxwing&quot;&gt;zsxwing&lt;/a&gt; how are we planning to fix this? thanks&lt;/p&gt;</comment>
                            <comment id="15627104" author="zsxwing" created="Tue, 1 Nov 2016 23:53:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lwlin&quot; class=&quot;user-hover&quot; rel=&quot;lwlin&quot;&gt;lwlin&lt;/a&gt; I don&apos;t have a sold idea. Feel free to propose your thoughts!&lt;/p&gt;</comment>
                            <comment id="15627134" author="marmbrus" created="Wed, 2 Nov 2016 00:06:35 +0000"  >&lt;p&gt;I think the configuration should only be used when deciding if we should perform a new compaction.  The identification of a compaction vs a delta should be done based on the file itself.  Today this could be done by looking for the &lt;tt&gt;compact&lt;/tt&gt; suffix.  However, I think this mechanism also has issues, as two streams writing to the same log but with different configurations would fail to conflict.&lt;/p&gt;

&lt;p&gt;That said, I think fixing the latter issue is going to require us rev-ing the log version.  Since thats not free, we would probably want to see if there are other changes we should lump into the new version.  Given that, I&apos;d be okay keeping the existing format, looking at file names instead of modular arithmetic, and revisiting moving the compaction identifier into the log itself (rather than the filename) in a follow up.&lt;/p&gt;</comment>
                            <comment id="15646800" author="unclegen" created="Tue, 8 Nov 2016 07:41:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marmbrus&quot; class=&quot;user-hover&quot; rel=&quot;marmbrus&quot;&gt;marmbrus&lt;/a&gt; +1 to your &lt;/p&gt;

&lt;p&gt;&lt;ins&gt;&#8220;I think the configuration should only be used when deciding if we should perform a new compaction. The identification of a compaction vs a delta should be done based on the file itself.&#8220;&lt;/ins&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;howtoset%22compactInterval%22%3F&quot;&gt;&lt;/a&gt;how to set &quot;compactInterval&quot;?&lt;/h4&gt;

&lt;p&gt;&lt;tt&gt;compactInterval&lt;/tt&gt; can be set by user in the first time. In case it is changed by user, we should check-update and use it. If &lt;tt&gt;isDeletingExpiredLog=false&lt;/tt&gt;, we can get original &lt;tt&gt;compactInterval&lt;/tt&gt; by computing the interval of &lt;tt&gt;.compact&lt;/tt&gt; suffix, and then check it against user setting; if &lt;tt&gt;isDeletingExpiredLog=true&lt;/tt&gt;, we can just use user setting , because this no expired meta log.&lt;/p&gt;</comment>
                            <comment id="15650373" author="apachespark" created="Wed, 9 Nov 2016 08:54:05 +0000"  >&lt;p&gt;User &apos;uncleGen&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15827&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15827&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15651353" author="apachespark" created="Wed, 9 Nov 2016 16:27:04 +0000"  >&lt;p&gt;User &apos;lw-lin&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15828&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15828&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15658279" author="apachespark" created="Fri, 11 Nov 2016 21:52:04 +0000"  >&lt;p&gt;User &apos;tcondie&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15852&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15852&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15665239" author="tcondie" created="Mon, 14 Nov 2016 22:28:29 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zsxwing&quot; class=&quot;user-hover&quot; rel=&quot;zsxwing&quot;&gt;zsxwing&lt;/a&gt;, I have added some new logic to the the determination of a compact interval in &lt;span class=&quot;error&quot;&gt;&amp;#91;CompactibleFileStreamLog.scala&amp;#93;&lt;/span&gt;. This new logic is described in the comments. Let me know what you think.&lt;/p&gt;</comment>
                            <comment id="15677492" author="zsxwing" created="Fri, 18 Nov 2016 19:12:53 +0000"  >&lt;p&gt;Resolved by &lt;a href=&quot;https://github.com/apache/spark/pull/15852&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15852&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35ndr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>