<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:45:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-16387] Reserved SQL words are not escaped by JDBC writer</title>
                <link>https://issues.apache.org/jira/browse/SPARK-16387</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Here is a code (imports are omitted)&lt;br/&gt;
object Main extends App {&lt;br/&gt;
  val sqlSession = SparkSession.builder().config(new SparkConf().&lt;br/&gt;
    setAppName(&quot;Sql Test&quot;).set(&quot;spark.app.id&quot;, &quot;SQLTest&quot;).&lt;br/&gt;
    set(&quot;spark.master&quot;, &quot;local&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;&quot;).&lt;br/&gt;
    set(&quot;spark.ui.enabled&quot;, &quot;false&quot;)&lt;br/&gt;
    .setJars(Seq(&quot;/mysql/mysql-connector-java-5.1.38.jar&quot; ))&lt;br/&gt;
  ).getOrCreate()&lt;/p&gt;

&lt;p&gt;  import sqlSession.implicits._&lt;/p&gt;

&lt;p&gt;  val localprops = new Properties&lt;br/&gt;
  localprops.put(&quot;user&quot;, &quot;xxxx&quot;)&lt;br/&gt;
  localprops.put(&quot;password&quot;, &quot;xxxx&quot;)&lt;/p&gt;

&lt;p&gt;  val df = sqlSession.createDataset(Seq(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;)).toDF(&quot;order&quot;)&lt;br/&gt;
  val writer = df.write&lt;br/&gt;
  .mode(SaveMode.Append)&lt;br/&gt;
  writer&lt;br/&gt;
  .jdbc(&quot;jdbc:mysql://localhost:3306/test3&quot;, s&quot;jira_test&quot;, localprops)&lt;br/&gt;
}&lt;/p&gt;


&lt;p&gt;End error is :&lt;br/&gt;
com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;order TEXT )&apos; at line 1&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Constructor.java:422)&lt;/p&gt;

&lt;p&gt;Clearly the reserved word &amp;lt;order&amp;gt; has to be quoted&lt;/p&gt;</description>
                <environment></environment>
        <key id="12986998">SPARK-16387</key>
            <summary>Reserved SQL words are not escaped by JDBC writer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dongjoon">Dongjoon Hyun</assignee>
                                    <reporter username="lev.numerify">Lev</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jul 2016 23:27:23 +0000</created>
                <updated>Thu, 13 Feb 2020 13:07:25 +0000</updated>
                            <resolved>Fri, 8 Jul 2016 23:07:16 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15363802" author="lev.numerify" created="Wed, 6 Jul 2016 05:30:55 +0000"  >&lt;p&gt;JdbcDialect class has a functionality that allows DB-dependent quotation. Please note that quotation has to be applied to all SQL statement generation code&lt;/p&gt;</comment>
                            <comment id="15363850" author="lev.numerify" created="Wed, 6 Jul 2016 06:17:01 +0000"  >&lt;p&gt;I am not sure what PR means.&lt;/p&gt;</comment>
                            <comment id="15368458" author="dongjoon" created="Fri, 8 Jul 2016 20:56:45 +0000"  >&lt;p&gt;You&apos;re right. I&apos;ll make a PR for this.&lt;/p&gt;</comment>
                            <comment id="15368482" author="apachespark" created="Fri, 8 Jul 2016 21:11:04 +0000"  >&lt;p&gt;User &apos;dongjoon-hyun&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14107&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14107&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17035395" author="igreenfi" created="Wed, 12 Feb 2020 14:28:14 +0000"  >&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt; &lt;br/&gt;
I think that PR fix one issue but create other issue and should be fixed in other way.&lt;br/&gt;
not quotation of all but for each supported dialect check if the word is reserved and just in that case quote: like the scaladoc of the function said:&lt;/p&gt;

&lt;p&gt;/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Quotes the identifier. This is used to put quotes around the identifier in case the column&lt;/li&gt;
	&lt;li&gt;name is a reserved keyword, or in case it contains characters that require quotes (e.g. space).&lt;br/&gt;
 */&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;something like: &lt;a href=&quot;https://stackoverflow.com/a/60167628&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;link&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17035774" author="dongjoon" created="Wed, 12 Feb 2020 23:04:56 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=igreenfi&quot; class=&quot;user-hover&quot; rel=&quot;igreenfi&quot;&gt;igreenfi&lt;/a&gt;. What is the problem?&lt;br/&gt;
For case-sensitive database, the general rule is that the user should be consistent in both DBMS side and Spark side. Technically, quotes do not change the case sensitivity of the column names. If you have something to suggest, could you file a new JIRA with your idea with a reproducible example? We are open for the suggestion always.&lt;/p&gt;</comment>
                            <comment id="17036203" author="igreenfi" created="Thu, 13 Feb 2020 13:07:25 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;thanks for the quick response. we found that on oracle the addition of &quot;&quot; cause error in our other servers that try to read that table.&lt;/p&gt;

&lt;p&gt;if the column name is `t_id` and you create it &quot;t_id&quot; if you will try to do `select T_ID from table` you will get an error from oracle.&lt;/p&gt;

&lt;p&gt;from the docs on the method, it says that it will escape only reserved words but it actually escapes all... so I this it could be change to really escape only reserved words.&#160;&lt;/p&gt;

&lt;p&gt;Like I do in the link I put in the previous comment.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12923187">SPARK-12437</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 39 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30khz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>