<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:34:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-11522] input_file_name() returns &quot;&quot; for external tables</title>
                <link>https://issues.apache.org/jira/browse/SPARK-11522</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Given an external table definition where the data consists of many CSV files, &lt;tt&gt;input_file_name()&lt;/tt&gt; returns empty strings.&lt;/p&gt;

&lt;p&gt;Table definition:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE EXTERNAL TABLE external_test(page_id INT, impressions INT) 
ROW FORMAT SERDE &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.serde2.OpenCSVSerde&apos;&lt;/span&gt;
WITH SERDEPROPERTIES (
   &lt;span class=&quot;code-quote&quot;&gt;&quot;separatorChar&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;,
   &lt;span class=&quot;code-quote&quot;&gt;&quot;quoteChar&quot;&lt;/span&gt;     = &lt;span class=&quot;code-quote&quot;&gt;&quot;\&quot;&lt;/span&gt;&quot;,
   &lt;span class=&quot;code-quote&quot;&gt;&quot;escapeChar&quot;&lt;/span&gt;    = &lt;span class=&quot;code-quote&quot;&gt;&quot;\\&quot;&lt;/span&gt;
)  
LOCATION &lt;span class=&quot;code-quote&quot;&gt;&apos;file:&lt;span class=&quot;code-comment&quot;&gt;///Users/sim/spark/test/external_test&apos;&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Query: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT input_file_name() as file FROM external_test&quot;&lt;/span&gt;).show
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+----+
|file|
+----+
|    |
|    |
...
|    |
+----+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12910607">SPARK-11522</key>
            <summary>input_file_name() returns &quot;&quot; for external tables</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xwu0226">Xin Wu</assignee>
                                    <reporter username="simeons">Simeon Simeonov</reporter>
                        <labels>
                            <label>external-tables</label>
                            <label>hive</label>
                            <label>sql</label>
                    </labels>
                <created>Thu, 5 Nov 2015 04:04:33 +0000</created>
                <updated>Mon, 16 Nov 2015 16:11:27 +0000</updated>
                            <resolved>Mon, 16 Nov 2015 16:11:11 +0000</resolved>
                                    <version>1.5.1</version>
                                    <fixVersion>1.6.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14992183" author="xwu0226" created="Thu, 5 Nov 2015 18:26:45 +0000"  >&lt;p&gt;I can recreate this issue with simpler case on 1.6.0 code base too. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;spark-sql&amp;gt; create external table external_test (page_id &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, impressions &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) location &lt;span class=&quot;code-quote&quot;&gt;&apos;file:&lt;span class=&quot;code-comment&quot;&gt;///root/spark-tables/external_test&apos;&lt;/span&gt;;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;where `external_test` contain one file or 2 files. &lt;/p&gt;

&lt;p&gt;And &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; select input_file_name() as file from external_test &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; returns nothing. &lt;/p&gt;

&lt;p&gt;I am looking into this code.. &lt;/p&gt;</comment>
                            <comment id="14993212" author="xwu0226" created="Fri, 6 Nov 2015 06:29:29 +0000"  >&lt;p&gt;Actually this seems not related to whether the table is created as external table or not.. it seems to be related to table file format. When the table is created stored as parquet, regardless of external or not, &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;scala&amp;gt; sqlContext.sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;create table parquet_ab (c1 &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, c2 &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) stored as parquet as select 1, 2&quot;&lt;/span&gt;)
scala&amp;gt; sqlContext.sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;select input_file_name() as file from parquet_ab&quot;&lt;/span&gt;).show
+--------------------+
|                file|
+--------------------+
|file:/user/hive/w...|
+--------------------+

scala&amp;gt; sqlContext.sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;create external table parquet_a(c1 &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, c2 &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) stored as parquet location &lt;span class=&quot;code-quote&quot;&gt;&apos;file:&lt;span class=&quot;code-comment&quot;&gt;///user/hive/warehouse/parquet_a&apos;&lt;/span&gt;&quot;&lt;/span&gt;)
&lt;/span&gt;scala&amp;gt; sqlContext.sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;select input_file_name() as file from parquet_a&quot;&lt;/span&gt;).show
+--------------------+
|                file|
+--------------------+
|file:/user/hive/w...|
+--------------------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Non-external, non-parquet table&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;scala&amp;gt; sqlContext.sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE  TABLE internal_test(c1 INT, c2 INT) as select 1, 2&quot;&lt;/span&gt;)
scala&amp;gt; sqlContext.sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;select input_file_name() as file from internal_test&quot;&lt;/span&gt;).show
+----+
|file|
+----+
|    |
+----+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14994763" author="xwu0226" created="Sat, 7 Nov 2015 00:14:14 +0000"  >&lt;p&gt;running full test against the fix now. will submit the PR soon. &lt;/p&gt;</comment>
                            <comment id="14995322" author="apachespark" created="Sat, 7 Nov 2015 17:48:02 +0000"  >&lt;p&gt;User &apos;xwu0226&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9542&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9542&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15006844" author="yhuai" created="Mon, 16 Nov 2015 16:11:11 +0000"  >&lt;p&gt;Issue resolved by pull request 9542&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9542&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9542&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 1 week, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2nzfr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>