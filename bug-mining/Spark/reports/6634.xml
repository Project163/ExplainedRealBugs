<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:06:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-28709] Memory leaks after stopping of StreamingContext</title>
                <link>https://issues.apache.org/jira/browse/SPARK-28709</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;In&#160;my application spark streaming&#160;is restarted programmatically&#160;by stopping&#160;StreamingContext without stopping of SparkContext and creating/starting a new one .&#160;I use it for&#160;automatic detection of Kafka topic/partition changes and automatic failover in case of non fatal exceptions.&lt;/p&gt;

&lt;p&gt;However&#160;i notice that after&#160;multiple restarts driver fails with OOM. During investigation of heap dump&#160;i figured out that StreamingContext object&#160;isn&apos;t cleared by GC after stopping.&lt;/p&gt;

&lt;p&gt;There are several places which holds reference to it :&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;StreamingTab registers StreamingJobProgressListener which holds reference to Streaming Context directly to&#160;LiveListenerBus shared queue via&#160;ssc.sc.addSparkListener(listener) method invocation. However this listener isn&apos;t unregistered at stop method, moreover the same listener is registered via&#160;ssc.addStreamingListener(listener) one line above so i assume this&#160;listener could just be removed or at least unregistered.&lt;/li&gt;
	&lt;li&gt;json handlers (/streaming/json and /streaming/batch/json)&#160;aren&apos;t unregistered in SparkUI, while they hold reference to&#160;StreamingJobProgressListener. Basically the same issue affects all the pages, i assume that&#160;renderJsonHandler should be added to&#160;pageToHandlers cache on&#160;attachPage method invocation in order to unregistered it as well on&#160;detachPage.&lt;/li&gt;
	&lt;li&gt;SparkUi holds reference to StreamingJobProgressListener in the corresponding local variable&#160;which isn&apos;t cleared after stopping of StreamingContext.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;After i applied these changes via reflection in my app OOM on driver side gone.&lt;/p&gt;

&lt;p&gt;I will&#160;submit a pull request to fix the mentioned issues.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13250487">SPARK-28709</key>
            <summary>Memory leaks after stopping of StreamingContext</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="choojoyq">Nikita Gorbachevski</assignee>
                                    <reporter username="choojoyq">Nikita Gorbachevski</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Aug 2019 09:50:33 +0000</created>
                <updated>Sun, 15 Sep 2019 09:16:19 +0000</updated>
                            <resolved>Mon, 26 Aug 2019 14:31:34 +0000</resolved>
                                    <version>2.4.3</version>
                                    <fixVersion>2.4.5</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                    <component>DStreams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16915849" author="srowen" created="Mon, 26 Aug 2019 14:31:34 +0000"  >&lt;p&gt;Issue resolved by pull request 25439&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/25439&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/25439&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13256710">SPARK-29087</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 12 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z05lxs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>