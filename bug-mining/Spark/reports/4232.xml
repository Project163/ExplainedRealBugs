<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:48:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-18147] Broken Spark SQL Codegen</title>
                <link>https://issues.apache.org/jira/browse/SPARK-18147</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;this is me on purpose trying to break spark sql codegen to uncover potential issues, by creating arbitrately complex data structures using primitives, strings, basic collections (map, seq, option), tuples, and case classes.&lt;/p&gt;

&lt;p&gt;first example: nested case classes&lt;br/&gt;
code:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;class ComplexResultAgg[B: TypeTag, C: TypeTag](val zero: B, result: C) extends Aggregator[Row, B, C] {
  override def reduce(b: B, input: Row): B = b

  override def merge(b1: B, b2: B): B = b1

  override def finish(reduction: B): C = result

  override def bufferEncoder: Encoder[B] = ExpressionEncoder[B]()
  override def outputEncoder: Encoder[C] = ExpressionEncoder[C]()
}

case class Struct2(d: Double = 0.0, s1: Seq[Double] = Seq.empty, s2: Seq[Long] = Seq.empty)

case class Struct3(a: Struct2 = Struct2(), b: Struct2 = Struct2())

val df1 = Seq((&quot;a&quot;, &quot;aa&quot;), (&quot;a&quot;, &quot;aa&quot;), (&quot;b&quot;, &quot;b&quot;), (&quot;b&quot;, null)).toDF(&quot;x&quot;, &quot;y&quot;).groupBy(&quot;x&quot;).agg(
  new ComplexResultAgg(&quot;boo&quot;, Struct3()).toColumn
)
df1.printSchema
df1.show
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the result is:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[info]   Cause: java.util.concurrent.ExecutionException: java.lang.Exception: failed to compile: org.codehaus.commons.compiler.CompileException: File &apos;generated.java&apos;, Line 33, Column 12: Expression &quot;isNull1&quot; is not an rvalue
[info] /* 001 */ public java.lang.Object generate(Object[] references) {
[info] /* 002 */   return new SpecificMutableProjection(references);
[info] /* 003 */ }
[info] /* 004 */
[info] /* 005 */ class SpecificMutableProjection extends org.apache.spark.sql.catalyst.expressions.codegen.BaseMutableProjection {
[info] /* 006 */
[info] /* 007 */   private Object[] references;
[info] /* 008 */   private MutableRow mutableRow;
[info] /* 009 */   private Object[] values;
[info] /* 010 */   private java.lang.String errMsg;
[info] /* 011 */   private Object[] values1;
[info] /* 012 */   private java.lang.String errMsg1;
[info] /* 013 */   private boolean[] argIsNulls;
[info] /* 014 */   private scala.collection.Seq argValue;
[info] /* 015 */   private java.lang.String errMsg2;
[info] /* 016 */   private boolean[] argIsNulls1;
[info] /* 017 */   private scala.collection.Seq argValue1;
[info] /* 018 */   private java.lang.String errMsg3;
[info] /* 019 */   private java.lang.String errMsg4;
[info] /* 020 */   private Object[] values2;
[info] /* 021 */   private java.lang.String errMsg5;
[info] /* 022 */   private boolean[] argIsNulls2;
[info] /* 023 */   private scala.collection.Seq argValue2;
[info] /* 024 */   private java.lang.String errMsg6;
[info] /* 025 */   private boolean[] argIsNulls3;
[info] /* 026 */   private scala.collection.Seq argValue3;
[info] /* 027 */   private java.lang.String errMsg7;
[info] /* 028 */   private boolean isNull_0;
[info] /* 029 */   private InternalRow value_0;
[info] /* 030 */
[info] /* 031 */   private void apply_1(InternalRow i) {
[info] /* 032 */
[info] /* 033 */     if (isNull1) {
[info] /* 034 */       throw new RuntimeException(errMsg3);
[info] /* 035 */     }
[info] /* 036 */
[info] /* 037 */     boolean isNull24 = false;
[info] /* 038 */     final com.tresata.spark.sql.Struct2 value24 = isNull24 ? null : (com.tresata.spark.sql.Struct2) value1.a();
[info] /* 039 */     isNull24 = value24 == null;
[info] /* 040 */
[info] /* 041 */     boolean isNull23 = isNull24;
[info] /* 042 */     final scala.collection.Seq value23 = isNull23 ? null : (scala.collection.Seq) value24.s2();
[info] /* 043 */     isNull23 = value23 == null;
[info] /* 044 */     argIsNulls1[0] = isNull23;
[info] /* 045 */     argValue1 = value23;
[info] /* 046 */
[info] /* 047 */
[info] /* 048 */
[info] /* 049 */     boolean isNull22 = false;
[info] /* 050 */     for (int idx = 0; idx &amp;lt; 1; idx++) {
[info] /* 051 */       if (argIsNulls1[idx]) { isNull22 = true; break; }
[info] /* 052 */     }
[info] /* 053 */
[info] /* 054 */     final ArrayData value22 = isNull22 ? null : new org.apache.spark.sql.catalyst.util.GenericArrayData(argValue1);
[info] /* 055 */     if (isNull22) {
[info] /* 056 */       values1[2] = null;
[info] /* 057 */     } else {
[info] /* 058 */       values1[2] = value22;
[info] /* 059 */     }
[info] /* 060 */   }
[info] /* 061 */
[info] /* 062 */
[info] /* 063 */   private void apply1_1(InternalRow i) {
[info] /* 064 */
[info] /* 065 */     if (isNull1) {
[info] /* 066 */       throw new RuntimeException(errMsg7);
[info] /* 067 */     }
[info] /* 068 */
[info] /* 069 */     boolean isNull41 = false;
[info] /* 070 */     final com.tresata.spark.sql.Struct2 value41 = isNull41 ? null : (com.tresata.spark.sql.Struct2) value1.b();
[info] /* 071 */     isNull41 = value41 == null;
[info] /* 072 */
[info] /* 073 */     boolean isNull40 = isNull41;
[info] /* 074 */     final scala.collection.Seq value40 = isNull40 ? null : (scala.collection.Seq) value41.s2();
[info] /* 075 */     isNull40 = value40 == null;
[info] /* 076 */     argIsNulls3[0] = isNull40;
[info] /* 077 */     argValue3 = value40;
[info] /* 078 */
[info] /* 079 */
[info] /* 080 */
[info] /* 081 */     boolean isNull39 = false;
[info] /* 082 */     for (int idx = 0; idx &amp;lt; 1; idx++) {
[info] /* 083 */       if (argIsNulls3[idx]) { isNull39 = true; break; }
[info] /* 084 */     }
[info] /* 085 */
[info] /* 086 */     final ArrayData value39 = isNull39 ? null : new org.apache.spark.sql.catalyst.util.GenericArrayData(argValue3);
[info] /* 087 */     if (isNull39) {
[info] /* 088 */       values2[2] = null;
[info] /* 089 */     } else {
[info] /* 090 */       values2[2] = value39;
[info] /* 091 */     }
[info] /* 092 */   }
[info] /* 093 */
[info] /* 094 */
[info] /* 095 */   private void apply_0(InternalRow i) {
[info] /* 096 */
[info] /* 097 */     if (isNull1) {
[info] /* 098 */       throw new RuntimeException(errMsg1);
[info] /* 099 */     }
[info] /* 100 */
[info] /* 101 */     boolean isNull16 = false;
[info] /* 102 */     final com.tresata.spark.sql.Struct2 value16 = isNull16 ? null : (com.tresata.spark.sql.Struct2) value1.a();
[info] /* 103 */     isNull16 = value16 == null;
[info] /* 104 */
[info] /* 105 */     boolean isNull15 = isNull16;
[info] /* 106 */     final double value15 = isNull15 ? -1.0 : value16.d();
[info] /* 107 */     if (isNull15) {
[info] /* 108 */       values1[0] = null;
[info] /* 109 */     } else {
[info] /* 110 */       values1[0] = value15;
[info] /* 111 */     }
[info] /* 112 */     if (isNull1) {
[info] /* 113 */       throw new RuntimeException(errMsg2);
[info] /* 114 */     }
[info] /* 115 */
[info] /* 116 */     boolean isNull20 = false;
[info] /* 117 */     final com.tresata.spark.sql.Struct2 value20 = isNull20 ? null : (com.tresata.spark.sql.Struct2) value1.a();
[info] /* 118 */     isNull20 = value20 == null;
[info] /* 119 */
[info] /* 120 */     boolean isNull19 = isNull20;
[info] /* 121 */     final scala.collection.Seq value19 = isNull19 ? null : (scala.collection.Seq) value20.s1();
[info] /* 122 */     isNull19 = value19 == null;
[info] /* 123 */     argIsNulls[0] = isNull19;
[info] /* 124 */     argValue = value19;
[info] /* 125 */
[info] /* 126 */
[info] /* 127 */
[info] /* 128 */     boolean isNull18 = false;
[info] /* 129 */     for (int idx = 0; idx &amp;lt; 1; idx++) {
[info] /* 130 */       if (argIsNulls[idx]) { isNull18 = true; break; }
[info] /* 131 */     }
[info] /* 132 */
[info] /* 133 */     final ArrayData value18 = isNull18 ? null : new org.apache.spark.sql.catalyst.util.GenericArrayData(argValue);
[info] /* 134 */     if (isNull18) {
[info] /* 135 */       values1[1] = null;
[info] /* 136 */     } else {
[info] /* 137 */       values1[1] = value18;
[info] /* 138 */     }
[info] /* 139 */   }
[info] /* 140 */
[info] /* 141 */
[info] /* 142 */   private void apply1_0(InternalRow i) {
[info] /* 143 */
[info] /* 144 */     if (isNull1) {
[info] /* 145 */       throw new RuntimeException(errMsg5);
[info] /* 146 */     }
[info] /* 147 */
[info] /* 148 */     boolean isNull33 = false;
[info] /* 149 */     final com.tresata.spark.sql.Struct2 value33 = isNull33 ? null : (com.tresata.spark.sql.Struct2) value1.b();
[info] /* 150 */     isNull33 = value33 == null;
[info] /* 151 */
[info] /* 152 */     boolean isNull32 = isNull33;
[info] /* 153 */     final double value32 = isNull32 ? -1.0 : value33.d();
[info] /* 154 */     if (isNull32) {
[info] /* 155 */       values2[0] = null;
[info] /* 156 */     } else {
[info] /* 157 */       values2[0] = value32;
[info] /* 158 */     }
[info] /* 159 */     if (isNull1) {
[info] /* 160 */       throw new RuntimeException(errMsg6);
[info] /* 161 */     }
[info] /* 162 */
[info] /* 163 */     boolean isNull37 = false;
[info] /* 164 */     final com.tresata.spark.sql.Struct2 value37 = isNull37 ? null : (com.tresata.spark.sql.Struct2) value1.b();
[info] /* 165 */     isNull37 = value37 == null;
[info] /* 166 */
[info] /* 167 */     boolean isNull36 = isNull37;
[info] /* 168 */     final scala.collection.Seq value36 = isNull36 ? null : (scala.collection.Seq) value37.s1();
[info] /* 169 */     isNull36 = value36 == null;
[info] /* 170 */     argIsNulls2[0] = isNull36;
[info] /* 171 */     argValue2 = value36;
[info] /* 172 */
[info] /* 173 */
[info] /* 174 */
[info] /* 175 */     boolean isNull35 = false;
[info] /* 176 */     for (int idx = 0; idx &amp;lt; 1; idx++) {
[info] /* 177 */       if (argIsNulls2[idx]) { isNull35 = true; break; }
[info] /* 178 */     }
[info] /* 179 */
[info] /* 180 */     final ArrayData value35 = isNull35 ? null : new org.apache.spark.sql.catalyst.util.GenericArrayData(argValue2);
[info] /* 181 */     if (isNull35) {
[info] /* 182 */       values2[1] = null;
[info] /* 183 */     } else {
[info] /* 184 */       values2[1] = value35;
[info] /* 185 */     }
[info] /* 186 */   }
[info] /* 187 */
[info] /* 188 */
[info] /* 189 */   public SpecificMutableProjection(Object[] references) {
[info] /* 190 */     this.references = references;
[info] /* 191 */     mutableRow = new org.apache.spark.sql.catalyst.expressions.GenericMutableRow(1);
[info] /* 192 */     this.values = null;
[info] /* 193 */     this.errMsg = (java.lang.String) references[1];
[info] /* 194 */     this.values1 = null;
[info] /* 195 */     this.errMsg1 = (java.lang.String) references[2];
[info] /* 196 */     argIsNulls = new boolean[1];
[info] /* 197 */
[info] /* 198 */     this.errMsg2 = (java.lang.String) references[3];
[info] /* 199 */     argIsNulls1 = new boolean[1];
[info] /* 200 */
[info] /* 201 */     this.errMsg3 = (java.lang.String) references[4];
[info] /* 202 */     this.errMsg4 = (java.lang.String) references[5];
[info] /* 203 */     this.values2 = null;
[info] /* 204 */     this.errMsg5 = (java.lang.String) references[6];
[info] /* 205 */     argIsNulls2 = new boolean[1];
[info] /* 206 */
[info] /* 207 */     this.errMsg6 = (java.lang.String) references[7];
[info] /* 208 */     argIsNulls3 = new boolean[1];
[info] /* 209 */
[info] /* 210 */     this.errMsg7 = (java.lang.String) references[8];
[info] /* 211 */     this.isNull_0 = true;
[info] /* 212 */     this.value_0 = null;
[info] /* 213 */   }
[info] /* 214 */
[info] /* 215 */   public org.apache.spark.sql.catalyst.expressions.codegen.BaseMutableProjection target(MutableRow row) {
[info] /* 216 */     mutableRow = row;
[info] /* 217 */     return this;
[info] /* 218 */   }
[info] /* 219 */
[info] /* 220 */   /* Provide immutable access to the last projected row. */
[info] /* 221 */   public InternalRow currentValue() {
[info] /* 222 */     return (InternalRow) mutableRow;
[info] /* 223 */   }
[info] /* 224 */
[info] /* 225 */   public java.lang.Object apply(java.lang.Object _i) {
[info] /* 226 */     InternalRow i = (InternalRow) _i;
[info] /* 227 */
[info] /* 228 */
[info] /* 229 */
[info] /* 230 */     Object obj = ((Expression) references[0]).eval(null);
[info] /* 231 */     org.apache.spark.sql.expressions.Aggregator value2 = (org.apache.spark.sql.expressions.Aggregator) obj;
[info] /* 232 */
[info] /* 233 */     boolean isNull4 = i.isNullAt(0);
[info] /* 234 */     UTF8String value4 = isNull4 ? null : (i.getUTF8String(0));
[info] /* 235 */
[info] /* 236 */     boolean isNull3 = isNull4;
[info] /* 237 */     final java.lang.String value3 = isNull3 ? null : (java.lang.String) value4.toString();
[info] /* 238 */     isNull3 = value3 == null;
[info] /* 239 */     boolean isNull1 = false || isNull3;
[info] /* 240 */     final com.tresata.spark.sql.Struct3 value1 = isNull1 ? null : (com.tresata.spark.sql.Struct3) value2.finish(value3);
[info] /* 241 */     isNull1 = value1 == null;
[info] /* 242 */
[info] /* 243 */     boolean isNull5 = false;
[info] /* 244 */     InternalRow value5 = null;
[info] /* 245 */     if (!false &amp;amp;&amp;amp; isNull1) {
[info] /* 246 */
[info] /* 247 */       final InternalRow value7 = null;
[info] /* 248 */       isNull5 = true;
[info] /* 249 */       value5 = value7;
[info] /* 250 */     } else {
[info] /* 251 */
[info] /* 252 */       boolean isNull8 = false;
[info] /* 253 */       this.values = new Object[2];
[info] /* 254 */       if (isNull1) {
[info] /* 255 */         throw new RuntimeException(errMsg);
[info] /* 256 */       }
[info] /* 257 */
[info] /* 258 */       boolean isNull11 = false;
[info] /* 259 */       final com.tresata.spark.sql.Struct2 value11 = isNull11 ? null : (com.tresata.spark.sql.Struct2) value1.a();
[info] /* 260 */       isNull11 = value11 == null;
[info] /* 261 */       boolean isNull9 = false;
[info] /* 262 */       InternalRow value9 = null;
[info] /* 263 */       if (!false &amp;amp;&amp;amp; isNull11) {
[info] /* 264 */
[info] /* 265 */         final InternalRow value13 = null;
[info] /* 266 */         isNull9 = true;
[info] /* 267 */         value9 = value13;
[info] /* 268 */       } else {
[info] /* 269 */
[info] /* 270 */         boolean isNull14 = false;
[info] /* 271 */         values1 = new Object[3];apply_0(i);
[info] /* 272 */         apply_1(i);
[info] /* 273 */         final InternalRow value14 = new org.apache.spark.sql.catalyst.expressions.GenericInternalRow(values1);
[info] /* 274 */         this.values1 = null;
[info] /* 275 */         isNull9 = isNull14;
[info] /* 276 */         value9 = value14;
[info] /* 277 */       }
[info] /* 278 */       if (isNull9) {
[info] /* 279 */         values[0] = null;
[info] /* 280 */       } else {
[info] /* 281 */         values[0] = value9;
[info] /* 282 */       }
[info] /* 283 */       if (isNull1) {
[info] /* 284 */         throw new RuntimeException(errMsg4);
[info] /* 285 */       }
[info] /* 286 */
[info] /* 287 */       boolean isNull28 = false;
[info] /* 288 */       final com.tresata.spark.sql.Struct2 value28 = isNull28 ? null : (com.tresata.spark.sql.Struct2) value1.b();
[info] /* 289 */       isNull28 = value28 == null;
[info] /* 290 */       boolean isNull26 = false;
[info] /* 291 */       InternalRow value26 = null;
[info] /* 292 */       if (!false &amp;amp;&amp;amp; isNull28) {
[info] /* 293 */
[info] /* 294 */         final InternalRow value30 = null;
[info] /* 295 */         isNull26 = true;
[info] /* 296 */         value26 = value30;
[info] /* 297 */       } else {
[info] /* 298 */
[info] /* 299 */         boolean isNull31 = false;
[info] /* 300 */         values2 = new Object[3];apply1_0(i);
[info] /* 301 */         apply1_1(i);
[info] /* 302 */         final InternalRow value31 = new org.apache.spark.sql.catalyst.expressions.GenericInternalRow(values2);
[info] /* 303 */         this.values2 = null;
[info] /* 304 */         isNull26 = isNull31;
[info] /* 305 */         value26 = value31;
[info] /* 306 */       }
[info] /* 307 */       if (isNull26) {
[info] /* 308 */         values[1] = null;
[info] /* 309 */       } else {
[info] /* 310 */         values[1] = value26;
[info] /* 311 */       }
[info] /* 312 */       final InternalRow value8 = new org.apache.spark.sql.catalyst.expressions.GenericInternalRow(values);
[info] /* 313 */       this.values = null;
[info] /* 314 */       isNull5 = isNull8;
[info] /* 315 */       value5 = value8;
[info] /* 316 */     }
[info] /* 317 */     this.isNull_0 = isNull5;
[info] /* 318 */     this.value_0 = value5;
[info] /* 319 */
[info] /* 320 */     // copy all the results into MutableRow
[info] /* 321 */
[info] /* 322 */     if (!this.isNull_0) {
[info] /* 323 */       mutableRow.update(0, this.value_0);
[info] /* 324 */     } else {
[info] /* 325 */       mutableRow.setNullAt(0);
[info] /* 326 */     }
[info] /* 327 */
[info] /* 328 */     return mutableRow;
[info] /* 329 */   }
[info] /* 330 */ }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13015989">SPARK-18147</key>
            <summary>Broken Spark SQL Codegen</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="viirya">L. C. Hsieh</assignee>
                                    <reporter username="koert">koert kuipers</reporter>
                        <labels>
                    </labels>
                <created>Thu, 27 Oct 2016 22:21:52 +0000</created>
                <updated>Thu, 6 Dec 2018 11:21:36 +0000</updated>
                            <resolved>Thu, 10 Nov 2016 05:05:02 +0000</resolved>
                                    <version>2.0.1</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>13</watches>
                                                                                                                <comments>
                            <comment id="15613472" author="koert" created="Thu, 27 Oct 2016 22:28:36 +0000"  >&lt;p&gt;it also breaks with an option of a case class. like this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; val df1 = Seq((&quot;a&quot;, &quot;aa&quot;), (&quot;a&quot;, &quot;aa&quot;), (&quot;b&quot;, &quot;b&quot;), (&quot;b&quot;, null)).toDF(&quot;x&quot;, &quot;y&quot;).groupBy(&quot;x&quot;).agg(
   new ComplexResultAgg(&quot;boo&quot;, Option(Struct2())).toColumn
 )
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15613555" author="marmbrus" created="Thu, 27 Oct 2016 22:56:46 +0000"  >&lt;p&gt;/cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15614959" author="kiszk" created="Fri, 28 Oct 2016 09:55:31 +0000"  >&lt;p&gt;This also cause the same exception.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ComplexResultAgg[B: TypeTag, C: TypeTag](val zero: B, result: C) &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Aggregator[Row, B, C] {
  override def reduce(b: B, input: Row): B = b
  override def merge(b1: B, b2: B): B = b1
  override def finish(reduction: B): C = result
  override def bufferEncoder: Encoder[B] = ExpressionEncoder[B]()
  override def outputEncoder: Encoder[C] = ExpressionEncoder[C]()
}
&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Struct2(i: Int)
&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Struct3(a: Struct2, b: Struct2)
Seq(1).toDF(&lt;span class=&quot;code-quote&quot;&gt;&quot;x&quot;&lt;/span&gt;).groupBy(&lt;span class=&quot;code-quote&quot;&gt;&quot;x&quot;&lt;/span&gt;)
  .agg(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ComplexResultAgg(&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;, Struct3(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)).toColumn).show
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In this case, there is an issue in codegen for &lt;tt&gt;AssertNotNull&lt;/tt&gt;. &lt;tt&gt;isNull1&lt;/tt&gt; (&lt;tt&gt;${childGen.isNull&lt;/tt&gt;) is out of the scope when &lt;tt&gt;ctx.splitExpression&lt;/tt&gt; is called at caller of &lt;tt&gt;AssertNotNull.doGenCode&lt;/tt&gt;. Here, &lt;tt&gt;CreateStruct.doGenCode&lt;/tt&gt; calls &lt;tt&gt;ctx.splitExpression&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15646904" author="apachespark" created="Tue, 8 Nov 2016 08:34:05 +0000"  >&lt;p&gt;User &apos;cloud-fan&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15807&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15807&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15653054" author="cloud_fan" created="Thu, 10 Nov 2016 05:05:03 +0000"  >&lt;p&gt;Issue resolved by pull request 15807&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15807&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15807&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16320159" author="chermenin" created="Wed, 10 Jan 2018 12:23:03 +0000"  >&lt;p&gt;Is it resolved for the 2.2.1 version? I have a similar problem with PySpark and Structured Streaming:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;18/01/10 15:12:37 ERROR CodeGenerator: failed to compile: org.codehaus.commons.compiler.CompileException: File &apos;generated.java&apos;, Line 174, Column 113: Expression &quot;isNull3&quot; is not an rvalue
/* 001 */ public java.lang.Object generate(Object[] references) {
/* 002 */   return new SpecificUnsafeProjection(references);
/* 003 */ }
/* 004 */
/* 005 */ class SpecificUnsafeProjection extends org.apache.spark.sql.catalyst.expressions.UnsafeProjection {
/* 006 */
/* 007 */   private Object[] references;
/* 008 */   private UTF8String lastRegex;
/* 009 */   private java.util.regex.Pattern pattern;
/* 010 */   private String lastReplacement;
/* 011 */   private UTF8String lastReplacementInUTF8;
/* 012 */   private java.lang.StringBuffer result;
/* 013 */   private UTF8String lastRegex1;
/* 014 */   private java.util.regex.Pattern pattern1;
/* 015 */   private String lastReplacement1;
/* 016 */   private UTF8String lastReplacementInUTF81;
/* 017 */   private java.lang.StringBuffer result1;
/* 018 */   private UnsafeRow result2;
/* 019 */   private org.apache.spark.sql.catalyst.expressions.codegen.BufferHolder holder;
/* 020 */   private org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter rowWriter;
/* 021 */
/* 022 */   public SpecificUnsafeProjection(Object[] references) {
/* 023 */     this.references = references;
/* 024 */     lastRegex = null;
/* 025 */     pattern = null;
/* 026 */     lastReplacement = null;
/* 027 */     lastReplacementInUTF8 = null;
/* 028 */     result = new java.lang.StringBuffer();
/* 029 */     lastRegex1 = null;
/* 030 */     pattern1 = null;
/* 031 */     lastReplacement1 = null;
/* 032 */     lastReplacementInUTF81 = null;
/* 033 */     result1 = new java.lang.StringBuffer();
/* 034 */     result2 = new UnsafeRow(3);
/* 035 */     this.holder = new org.apache.spark.sql.catalyst.expressions.codegen.BufferHolder(result2, 64);
/* 036 */     this.rowWriter = new org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter(holder, 3);
/* 037 */
/* 038 */   }
/* 039 */
/* 040 */   public void initialize(int partitionIndex) {
/* 041 */
/* 042 */   }
/* 043 */
/* 044 */
/* 045 */   private void apply_1(InternalRow i) {
/* 046 */
/* 047 */     UTF8String[] args1 = new UTF8String[3];
/* 048 */
/* 049 */
/* 050 */     if (!false) {
/* 051 */       args1[0] = ((UTF8String) references[6]);
/* 052 */     }
/* 053 */
/* 054 */
/* 055 */     if (!false) {
/* 056 */       args1[1] = ((UTF8String) references[7]);
/* 057 */     }
/* 058 */
/* 059 */
/* 060 */     boolean isNull13 = false;
/* 061 */
/* 062 */     UTF8String value14 = i.getUTF8String(2);
/* 063 */
/* 064 */
/* 065 */     UTF8String value13 = null;
/* 066 */
/* 067 */     if (!((UTF8String) references[8]).equals(lastRegex1)) {
/* 068 */       // regex value changed
/* 069 */       lastRegex1 = ((UTF8String) references[8]).clone();
/* 070 */       pattern1 = java.util.regex.Pattern.compile(lastRegex1.toString());
/* 071 */     }
/* 072 */     if (!((UTF8String) references[9]).equals(lastReplacementInUTF81)) {
/* 073 */       // replacement string changed
/* 074 */       lastReplacementInUTF81 = ((UTF8String) references[9]).clone();
/* 075 */       lastReplacement1 = lastReplacementInUTF81.toString();
/* 076 */     }
/* 077 */     result1.delete(0, result1.length());
/* 078 */     java.util.regex.Matcher matcher1 = pattern1.matcher(value14.toString());
/* 079 */
/* 080 */     while (matcher1.find()) {
/* 081 */       matcher1.appendReplacement(result1, lastReplacement1);
/* 082 */     }
/* 083 */     matcher1.appendTail(result1);
/* 084 */     value13 = UTF8String.fromString(result1.toString());
/* 085 */     if (!false) {
/* 086 */       args1[2] = value13;
/* 087 */     }
/* 088 */
/* 089 */     UTF8String value10 = UTF8String.concat(args1);
/* 090 */     boolean isNull10 = value10 == null;
/* 091 */   }
/* 092 */
/* 093 */
/* 094 */   private void apply1_1(InternalRow i) {
/* 095 */
/* 096 */
/* 097 */     final Object value20 = null;
/* 098 */     if (true) {
/* 099 */       rowWriter.setNullAt(2);
/* 100 */     } else {
/* 101 */
/* 102 */     }
/* 103 */
/* 104 */   }
/* 105 */
/* 106 */
/* 107 */   private void apply_0(InternalRow i) {
/* 108 */
/* 109 */     UTF8String[] args = new UTF8String[3];
/* 110 */
/* 111 */
/* 112 */     if (!false) {
/* 113 */       args[0] = ((UTF8String) references[2]);
/* 114 */     }
/* 115 */
/* 116 */
/* 117 */     if (!false) {
/* 118 */       args[1] = ((UTF8String) references[3]);
/* 119 */     }
/* 120 */
/* 121 */
/* 122 */     boolean isNull6 = true;
/* 123 */     UTF8String value6 = null;
/* 124 */
/* 125 */     boolean isNull7 = i.isNullAt(1);
/* 126 */     UTF8String value7 = isNull7 ? null : (i.getUTF8String(1));
/* 127 */     if (!isNull7) {
/* 128 */
/* 129 */
/* 130 */
/* 131 */       isNull6 = false; // resultCode could change nullability.
/* 132 */
/* 133 */       if (!((UTF8String) references[4]).equals(lastRegex)) {
/* 134 */         // regex value changed
/* 135 */         lastRegex = ((UTF8String) references[4]).clone();
/* 136 */         pattern = java.util.regex.Pattern.compile(lastRegex.toString());
/* 137 */       }
/* 138 */       if (!((UTF8String) references[5]).equals(lastReplacementInUTF8)) {
/* 139 */         // replacement string changed
/* 140 */         lastReplacementInUTF8 = ((UTF8String) references[5]).clone();
/* 141 */         lastReplacement = lastReplacementInUTF8.toString();
/* 142 */       }
/* 143 */       result.delete(0, result.length());
/* 144 */       java.util.regex.Matcher matcher = pattern.matcher(value7.toString());
/* 145 */
/* 146 */       while (matcher.find()) {
/* 147 */         matcher.appendReplacement(result, lastReplacement);
/* 148 */       }
/* 149 */       matcher.appendTail(result);
/* 150 */       value6 = UTF8String.fromString(result.toString());
/* 151 */       isNull6 = false;
/* 152 */
/* 153 */
/* 154 */     }
/* 155 */     if (!isNull6) {
/* 156 */       args[2] = value6;
/* 157 */     }
/* 158 */
/* 159 */     UTF8String value3 = UTF8String.concat(args);
/* 160 */     boolean isNull3 = value3 == null;
/* 161 */   }
/* 162 */
/* 163 */
/* 164 */   private void apply1_0(InternalRow i) {
/* 165 */
/* 166 */
/* 167 */     apply_0(i);
/* 168 */     apply_1(i);
/* 169 */     apply_2(i);
/* 170 */     int varargNum = 4;
/* 171 */     int idxInVararg = 0;
/* 172 */
/* 173 */     UTF8String[] array = new UTF8String[varargNum];
/* 174 */     array[idxInVararg ++] = false ? (UTF8String) null : ((UTF8String) references[1]);array[idxInVararg ++] = isNull3 ? (UTF8String) null : value3;array[idxInVararg ++] = isNull10 ? (UTF8String) null : value10;array[idxInVararg ++] = false ? (UTF8String) null : ((UTF8String) references[10]);
/* 175 */     UTF8String value = UTF8String.concatWs(((UTF8String) references[0]), array);
/* 176 */     boolean isNull = value == null;
/* 177 */     if (isNull) {
/* 178 */       rowWriter.setNullAt(0);
/* 179 */     } else {
/* 180 */       rowWriter.write(0, value);
/* 181 */     }
/* 182 */
/* 183 */
/* 184 */     Object obj = ((Expression) references[11]).eval(i);
/* 185 */     boolean isNull19 = obj == null;
/* 186 */     UTF8String value19 = null;
/* 187 */     if (!isNull19) {
/* 188 */       value19 = (UTF8String) obj;
/* 189 */     }
/* 190 */     if (isNull19) {
/* 191 */       rowWriter.setNullAt(1);
/* 192 */     } else {
/* 193 */       rowWriter.write(1, value19);
/* 194 */     }
/* 195 */
/* 196 */   }
/* 197 */
/* 198 */
/* 199 */   private void apply_2(InternalRow i) {
/* 200 */
/* 201 */     final ArrayData value17 = null;
/* 202 */   }
/* 203 */
/* 204 */
/* 205 */   // Scala.Function1 need this
/* 206 */   public java.lang.Object apply(java.lang.Object row) {
/* 207 */     return apply((InternalRow) row);
/* 208 */   }
/* 209 */
/* 210 */   public UnsafeRow apply(InternalRow i) {
/* 211 */     holder.reset();
/* 212 */
/* 213 */     rowWriter.zeroOutNullBytes();
/* 214 */     apply1_0(i);
/* 215 */     apply1_1(i);
/* 216 */     result2.setTotalSize(holder.totalSize());
/* 217 */     return result2;
/* 218 */   }
/* 219 */ }

org.codehaus.commons.compiler.CompileException: File &apos;generated.java&apos;, Line 174, Column 113: Expression &quot;isNull3&quot; is not an rvalue
	at org.codehaus.janino.UnitCompiler.compileError(UnitCompiler.java:11004)
	at org.codehaus.janino.UnitCompiler.toRvalueOrCompileException(UnitCompiler.java:6639)
	at org.codehaus.janino.UnitCompiler.getConstantValue2(UnitCompiler.java:5001)
	at org.codehaus.janino.UnitCompiler.access$10500(UnitCompiler.java:206)
	at org.codehaus.janino.UnitCompiler$13.visitAmbiguousName(UnitCompiler.java:4984)
	at org.codehaus.janino.Java$AmbiguousName.accept(Java.java:3633)
	at org.codehaus.janino.Java$Lvalue.accept(Java.java:3563)
	at org.codehaus.janino.UnitCompiler.getConstantValue(UnitCompiler.java:4956)
	at org.codehaus.janino.UnitCompiler.getConstantValue2(UnitCompiler.java:5027)
	at org.codehaus.janino.UnitCompiler.access$9700(UnitCompiler.java:206)
	at org.codehaus.janino.UnitCompiler$13.visitConditionalExpression(UnitCompiler.java:4964)
	at org.codehaus.janino.Java$ConditionalExpression.accept(Java.java:3877)
	at org.codehaus.janino.UnitCompiler.getConstantValue(UnitCompiler.java:4956)
	at org.codehaus.janino.UnitCompiler.compileGetValue(UnitCompiler.java:4925)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:3189)
	at org.codehaus.janino.UnitCompiler.access$5100(UnitCompiler.java:206)
	at org.codehaus.janino.UnitCompiler$9.visitAssignment(UnitCompiler.java:3143)
	at org.codehaus.janino.UnitCompiler$9.visitAssignment(UnitCompiler.java:3139)
	at org.codehaus.janino.Java$Assignment.accept(Java.java:3847)
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:3139)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:2112)
	at org.codehaus.janino.UnitCompiler.access$1700(UnitCompiler.java:206)
	at org.codehaus.janino.UnitCompiler$6.visitExpressionStatement(UnitCompiler.java:1377)
	at org.codehaus.janino.UnitCompiler$6.visitExpressionStatement(UnitCompiler.java:1370)
	at org.codehaus.janino.Java$ExpressionStatement.accept(Java.java:2558)
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1370)
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1450)
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:2811)
	at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:1262)
	at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:1234)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:538)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:890)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:894)
	at org.codehaus.janino.UnitCompiler.access$600(UnitCompiler.java:206)
	at org.codehaus.janino.UnitCompiler$2.visitMemberClassDeclaration(UnitCompiler.java:377)
	at org.codehaus.janino.UnitCompiler$2.visitMemberClassDeclaration(UnitCompiler.java:369)
	at org.codehaus.janino.Java$MemberClassDeclaration.accept(Java.java:1128)
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:369)
	at org.codehaus.janino.UnitCompiler.compileDeclaredMemberTypes(UnitCompiler.java:1209)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:564)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:420)
	at org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:206)
	at org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:374)
	at org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:369)
	at org.codehaus.janino.Java$AbstractPackageMemberClassDeclaration.accept(Java.java:1309)
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:369)
	at org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:345)
	at org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:396)
	at org.codehaus.janino.ClassBodyEvaluator.compileToClass(ClassBodyEvaluator.java:311)
	at org.codehaus.janino.ClassBodyEvaluator.cook(ClassBodyEvaluator.java:229)
	at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:196)
	at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:91)
	at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.org$apache$spark$sql$catalyst$expressions$codegen$CodeGenerator$$doCompile(CodeGenerator.scala:1000)
	at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1067)
	at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1064)
	at org.spark_project.guava.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3599)
	at org.spark_project.guava.cache.LocalCache$Segment.loadSync(LocalCache.java:2379)
	at org.spark_project.guava.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2342)
	at org.spark_project.guava.cache.LocalCache$Segment.get(LocalCache.java:2257)
	at org.spark_project.guava.cache.LocalCache.get(LocalCache.java:4000)
	at org.spark_project.guava.cache.LocalCache.getOrLoad(LocalCache.java:4004)
	at org.spark_project.guava.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4874)
	at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.compile(CodeGenerator.scala:946)
	at org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:412)
	at org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:366)
	at org.apache.spark.sql.catalyst.expressions.codegen.GenerateUnsafeProjection$.create(GenerateUnsafeProjection.scala:32)
	at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator.generate(CodeGenerator.scala:930)
	at org.apache.spark.sql.catalyst.expressions.UnsafeProjection$.create(Projection.scala:130)
	at org.apache.spark.sql.catalyst.expressions.UnsafeProjection$.create(Projection.scala:140)
	at org.apache.spark.sql.execution.aggregate.AggregationIterator.generateResultProjection(AggregationIterator.scala:219)
	at org.apache.spark.sql.execution.aggregate.TungstenAggregationIterator.generateResultProjection(TungstenAggregationIterator.scala:144)
	at org.apache.spark.sql.execution.aggregate.AggregationIterator.&amp;lt;init&amp;gt;(AggregationIterator.scala:266)
	at org.apache.spark.sql.execution.aggregate.TungstenAggregationIterator.&amp;lt;init&amp;gt;(TungstenAggregationIterator.scala:92)
	at org.apache.spark.sql.execution.aggregate.HashAggregateExec$$anonfun$doExecute$1$$anonfun$4.apply(HashAggregateExec.scala:106)
	at org.apache.spark.sql.execution.aggregate.HashAggregateExec$$anonfun$doExecute$1$$anonfun$4.apply(HashAggregateExec.scala:97)
	at org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:797)
	at org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:797)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:287)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:287)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)
	at org.apache.spark.scheduler.Task.run(Task.scala:108)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:338)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
18/01/10 15:12:37 ERROR Executor: Exception in task 0.0 in stage 1.0 (TID 1)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16711268" author="chamcyl" created="Thu, 6 Dec 2018 10:50:24 +0000"  >&lt;p&gt;I hava a similar problem at version 2.3.0 . but it work well in 2.0.1 and 2.1.0 ..&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2018-12-06 18:45:45,945 ERROR (org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator:91) - failed to compile: org.codehaus.commons.compiler.CompileException: File &lt;span class=&quot;code-quote&quot;&gt;&apos;generated.java&apos;&lt;/span&gt;, Line 250, Column 21: Expression &lt;span class=&quot;code-quote&quot;&gt;&quot;project_isNull22&quot;&lt;/span&gt; is not an rvalue
org.codehaus.commons.compiler.CompileException: File &lt;span class=&quot;code-quote&quot;&gt;&apos;generated.java&apos;&lt;/span&gt;, Line 250, Column 21: Expression &lt;span class=&quot;code-quote&quot;&gt;&quot;project_isNull22&quot;&lt;/span&gt; is not an rvalue
at org.codehaus.janino.UnitCompiler.compileError(UnitCompiler.java:11821)
at org.codehaus.janino.UnitCompiler.toRvalueOrCompileException(UnitCompiler.java:7170)
at org.codehaus.janino.UnitCompiler.getConstantValue2(UnitCompiler.java:5332)
at org.codehaus.janino.UnitCompiler.access$9400(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$13$1.visitAmbiguousName(UnitCompiler.java:5287)
at org.codehaus.janino.Java$AmbiguousName.accept(Java.java:4053)
at org.codehaus.janino.UnitCompiler$13.visitLvalue(UnitCompiler.java:5284)
at org.codehaus.janino.Java$Lvalue.accept(Java.java:3977)
at org.codehaus.janino.UnitCompiler.getConstantValue(UnitCompiler.java:5280)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:2391)
at org.codehaus.janino.UnitCompiler.access$1900(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1474)
at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1466)
at org.codehaus.janino.Java$IfStatement.accept(Java.java:2926)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1466)
at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1546)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1532)
at org.codehaus.janino.UnitCompiler.access$1700(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1472)
at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1466)
at org.codehaus.janino.Java$Block.accept(Java.java:2756)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1466)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:2444)
at org.codehaus.janino.UnitCompiler.access$1900(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1474)
at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1466)
at org.codehaus.janino.Java$IfStatement.accept(Java.java:2926)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1466)
at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1546)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1532)
at org.codehaus.janino.UnitCompiler.access$1700(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1472)
at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1466)
at org.codehaus.janino.Java$Block.accept(Java.java:2756)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1466)
at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1546)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1532)
at org.codehaus.janino.UnitCompiler.access$1700(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1472)
at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1466)
at org.codehaus.janino.Java$Block.accept(Java.java:2756)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1466)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:2455)
at org.codehaus.janino.UnitCompiler.access$1900(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1474)
at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1466)
at org.codehaus.janino.Java$IfStatement.accept(Java.java:2926)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1466)
at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1546)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1532)
at org.codehaus.janino.UnitCompiler.access$1700(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1472)
at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1466)
at org.codehaus.janino.Java$Block.accept(Java.java:2756)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1466)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1571)
at org.codehaus.janino.UnitCompiler.access$2600(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$6.visitDoStatement(UnitCompiler.java:1481)
at org.codehaus.janino.UnitCompiler$6.visitDoStatement(UnitCompiler.java:1466)
at org.codehaus.janino.Java$DoStatement.accept(Java.java:3304)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1466)
at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1546)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1532)
at org.codehaus.janino.UnitCompiler.access$1700(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1472)
at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1466)
at org.codehaus.janino.Java$Block.accept(Java.java:2756)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1466)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1634)
at org.codehaus.janino.UnitCompiler.access$2000(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$6.visitForStatement(UnitCompiler.java:1475)
at org.codehaus.janino.UnitCompiler$6.visitForStatement(UnitCompiler.java:1466)
at org.codehaus.janino.Java$ForStatement.accept(Java.java:2973)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1466)
at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1546)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1532)
at org.codehaus.janino.UnitCompiler.access$1700(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1472)
at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1466)
at org.codehaus.janino.Java$Block.accept(Java.java:2756)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1466)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1821)
at org.codehaus.janino.UnitCompiler.access$2200(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$6.visitWhileStatement(UnitCompiler.java:1477)
at org.codehaus.janino.UnitCompiler$6.visitWhileStatement(UnitCompiler.java:1466)
at org.codehaus.janino.Java$WhileStatement.accept(Java.java:3031)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1466)
at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1546)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:3075)
at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:1336)
at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:1309)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:799)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:958)
at org.codehaus.janino.UnitCompiler.access$700(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$2.visitMemberClassDeclaration(UnitCompiler.java:393)
at org.codehaus.janino.UnitCompiler$2.visitMemberClassDeclaration(UnitCompiler.java:385)
at org.codehaus.janino.Java$MemberClassDeclaration.accept(Java.java:1286)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:385)
at org.codehaus.janino.UnitCompiler.compileDeclaredMemberTypes(UnitCompiler.java:1285)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:825)
at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:411)
at org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:212)
at org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:390)
at org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:385)
at org.codehaus.janino.Java$PackageMemberClassDeclaration.accept(Java.java:1405)
at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:385)
at org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:357)
at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:234)
at org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:446)
at org.codehaus.janino.ClassBodyEvaluator.compileToClass(ClassBodyEvaluator.java:313)
at org.codehaus.janino.ClassBodyEvaluator.cook(ClassBodyEvaluator.java:235)
at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:204)
at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:80)
at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.org$apache$spark$sql$catalyst$expressions$codegen$CodeGenerator$$doCompile(CodeGenerator.scala:1421)
at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1497)
at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1494)
at org.spark_project.guava.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3599)
at org.spark_project.guava.cache.LocalCache$Segment.loadSync(LocalCache.java:2379)
at org.spark_project.guava.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2342)
at org.spark_project.guava.cache.LocalCache$Segment.get(LocalCache.java:2257)
at org.spark_project.guava.cache.LocalCache.get(LocalCache.java:4000)
at org.spark_project.guava.cache.LocalCache.getOrLoad(LocalCache.java:4004)
at org.spark_project.guava.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4874)
at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.compile(CodeGenerator.scala:1369)
at org.apache.spark.sql.execution.WholeStageCodegenExec.liftedTree1$1(WholeStageCodegenExec.scala:579)
at org.apache.spark.sql.execution.WholeStageCodegenExec.doExecute(WholeStageCodegenExec.scala:578)
at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)
at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)
at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)
at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)
at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)
at org.apache.spark.sql.execution.SparkPlan.getByteArrayRdd(SparkPlan.scala:247)
at org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:337)
at org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)
at org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:3272)
at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2484)
at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2484)
at org.apache.spark.sql.Dataset$$anonfun$52.apply(Dataset.scala:3253)
at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)
at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3252)
at org.apache.spark.sql.Dataset.head(Dataset.scala:2484)
at org.apache.spark.sql.Dataset.take(Dataset.scala:2698)
at org.apache.spark.sql.Dataset.showString(Dataset.scala:254)
at org.apache.spark.sql.Dataset.show(Dataset.scala:725)
at org.apache.spark.sql.Dataset.show(Dataset.scala:702)
at com.netentsec.uba.sparksql.SparkSqlRunner.main(SparkSqlRunner.java:211)
2018-12-06 18:45:45,950 INFO (org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator:54) - 
&lt;span class=&quot;code-comment&quot;&gt;/* 001 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; generate(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[] references) {
&lt;span class=&quot;code-comment&quot;&gt;/* 002 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GeneratedIteratorForCodegenStage3(references);
&lt;span class=&quot;code-comment&quot;&gt;/* 003 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 004 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 005 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;GeneratedIteratorForCodegenStage3 &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; org.apache.spark.sql.execution.BufferedRowIterator {
&lt;span class=&quot;code-comment&quot;&gt;/* 006 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[] references;
&lt;span class=&quot;code-comment&quot;&gt;/* 007 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; scala.collection.Iterator[] inputs;
&lt;span class=&quot;code-comment&quot;&gt;/* 008 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; scan_scanTime;
&lt;span class=&quot;code-comment&quot;&gt;/* 009 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; scan_batchIdx;
&lt;span class=&quot;code-comment&quot;&gt;/* 010 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; org.apache.spark.sql.execution.joins.UnsafeHashedRelation bhj_relation;
&lt;span class=&quot;code-comment&quot;&gt;/* 011 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; locallimit_stopEarly;
&lt;span class=&quot;code-comment&quot;&gt;/* 012 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; locallimit_count;
&lt;span class=&quot;code-comment&quot;&gt;/* 013 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.BufferHolder[] scan_mutableStateArray4 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.BufferHolder[7];
&lt;span class=&quot;code-comment&quot;&gt;/* 014 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; org.apache.spark.sql.execution.vectorized.OnHeapColumnVector[] scan_mutableStateArray2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.execution.vectorized.OnHeapColumnVector[3];
&lt;span class=&quot;code-comment&quot;&gt;/* 015 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter[] scan_mutableStateArray5 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter[7];
&lt;span class=&quot;code-comment&quot;&gt;/* 016 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; UnsafeRow[] scan_mutableStateArray3 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnsafeRow[7];
&lt;span class=&quot;code-comment&quot;&gt;/* 017 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; org.apache.spark.sql.vectorized.ColumnarBatch[] scan_mutableStateArray1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.vectorized.ColumnarBatch[1];
&lt;span class=&quot;code-comment&quot;&gt;/* 018 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; scala.collection.Iterator[] scan_mutableStateArray = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; scala.collection.Iterator[1];
&lt;span class=&quot;code-comment&quot;&gt;/* 019 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 020 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; GeneratedIteratorForCodegenStage3(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[] references) {
&lt;span class=&quot;code-comment&quot;&gt;/* 021 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.references = references;
&lt;span class=&quot;code-comment&quot;&gt;/* 022 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 023 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 024 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void init(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; index, scala.collection.Iterator[] inputs) {
&lt;span class=&quot;code-comment&quot;&gt;/* 025 */&lt;/span&gt; partitionIndex = index;
&lt;span class=&quot;code-comment&quot;&gt;/* 026 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.inputs = inputs;
&lt;span class=&quot;code-comment&quot;&gt;/* 027 */&lt;/span&gt; wholestagecodegen_init_0();
&lt;span class=&quot;code-comment&quot;&gt;/* 028 */&lt;/span&gt; wholestagecodegen_init_1();
&lt;span class=&quot;code-comment&quot;&gt;/* 029 */&lt;/span&gt; wholestagecodegen_init_2();
&lt;span class=&quot;code-comment&quot;&gt;/* 030 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 031 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 032 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 033 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void wholestagecodegen_init_0() {
&lt;span class=&quot;code-comment&quot;&gt;/* 034 */&lt;/span&gt; scan_mutableStateArray[0] = inputs[0];
&lt;span class=&quot;code-comment&quot;&gt;/* 035 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 036 */&lt;/span&gt; scan_mutableStateArray3[0] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnsafeRow(3);
&lt;span class=&quot;code-comment&quot;&gt;/* 037 */&lt;/span&gt; scan_mutableStateArray4[0] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.BufferHolder(scan_mutableStateArray3[0], 0);
&lt;span class=&quot;code-comment&quot;&gt;/* 038 */&lt;/span&gt; scan_mutableStateArray5[0] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter(scan_mutableStateArray4[0], 3);
&lt;span class=&quot;code-comment&quot;&gt;/* 039 */&lt;/span&gt; scan_mutableStateArray3[1] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnsafeRow(3);
&lt;span class=&quot;code-comment&quot;&gt;/* 040 */&lt;/span&gt; scan_mutableStateArray4[1] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.BufferHolder(scan_mutableStateArray3[1], 0);
&lt;span class=&quot;code-comment&quot;&gt;/* 041 */&lt;/span&gt; scan_mutableStateArray5[1] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter(scan_mutableStateArray4[1], 3);
&lt;span class=&quot;code-comment&quot;&gt;/* 042 */&lt;/span&gt; scan_mutableStateArray3[2] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnsafeRow(5);
&lt;span class=&quot;code-comment&quot;&gt;/* 043 */&lt;/span&gt; scan_mutableStateArray4[2] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.BufferHolder(scan_mutableStateArray3[2], 32);
&lt;span class=&quot;code-comment&quot;&gt;/* 044 */&lt;/span&gt; scan_mutableStateArray5[2] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter(scan_mutableStateArray4[2], 5);
&lt;span class=&quot;code-comment&quot;&gt;/* 045 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 046 */&lt;/span&gt; bhj_relation = ((org.apache.spark.sql.execution.joins.UnsafeHashedRelation) ((org.apache.spark.broadcast.TorrentBroadcast) references[5] &lt;span class=&quot;code-comment&quot;&gt;/* broadcast */&lt;/span&gt;).value()).asReadOnlyCopy();
&lt;span class=&quot;code-comment&quot;&gt;/* 047 */&lt;/span&gt; incPeakExecutionMemory(bhj_relation.estimatedSize());
&lt;span class=&quot;code-comment&quot;&gt;/* 048 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 049 */&lt;/span&gt; org.apache.spark.TaskContext$.MODULE$.get().addTaskCompletionListener(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.util.TaskCompletionListener() {
&lt;span class=&quot;code-comment&quot;&gt;/* 050 */&lt;/span&gt; @Override
&lt;span class=&quot;code-comment&quot;&gt;/* 051 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void onTaskCompletion(org.apache.spark.TaskContext context) {
&lt;span class=&quot;code-comment&quot;&gt;/* 052 */&lt;/span&gt; ((org.apache.spark.sql.execution.metric.SQLMetric) references[6] &lt;span class=&quot;code-comment&quot;&gt;/* avgHashProbe */&lt;/span&gt;).set(bhj_relation.getAverageProbesPerLookup());
&lt;span class=&quot;code-comment&quot;&gt;/* 053 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 054 */&lt;/span&gt; });
&lt;span class=&quot;code-comment&quot;&gt;/* 055 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 056 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 057 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 058 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void scan_nextBatch() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; java.io.IOException {
&lt;span class=&quot;code-comment&quot;&gt;/* 059 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; getBatchStart = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.nanoTime();
&lt;span class=&quot;code-comment&quot;&gt;/* 060 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (scan_mutableStateArray[0].hasNext()) {
&lt;span class=&quot;code-comment&quot;&gt;/* 061 */&lt;/span&gt; scan_mutableStateArray1[0] = (org.apache.spark.sql.vectorized.ColumnarBatch)scan_mutableStateArray[0].next();
&lt;span class=&quot;code-comment&quot;&gt;/* 062 */&lt;/span&gt; ((org.apache.spark.sql.execution.metric.SQLMetric) references[0] &lt;span class=&quot;code-comment&quot;&gt;/* numOutputRows */&lt;/span&gt;).add(scan_mutableStateArray1[0].numRows());
&lt;span class=&quot;code-comment&quot;&gt;/* 063 */&lt;/span&gt; scan_batchIdx = 0;
&lt;span class=&quot;code-comment&quot;&gt;/* 064 */&lt;/span&gt; scan_mutableStateArray2[0] = (org.apache.spark.sql.execution.vectorized.OnHeapColumnVector) scan_mutableStateArray1[0].column(0);
&lt;span class=&quot;code-comment&quot;&gt;/* 065 */&lt;/span&gt; scan_mutableStateArray2[1] = (org.apache.spark.sql.execution.vectorized.OnHeapColumnVector) scan_mutableStateArray1[0].column(1);
&lt;span class=&quot;code-comment&quot;&gt;/* 066 */&lt;/span&gt; scan_mutableStateArray2[2] = (org.apache.spark.sql.execution.vectorized.OnHeapColumnVector) scan_mutableStateArray1[0].column(2);
&lt;span class=&quot;code-comment&quot;&gt;/* 067 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 068 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 069 */&lt;/span&gt; scan_scanTime += &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.nanoTime() - getBatchStart;
&lt;span class=&quot;code-comment&quot;&gt;/* 070 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 071 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 072 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void wholestagecodegen_init_2() {
&lt;span class=&quot;code-comment&quot;&gt;/* 073 */&lt;/span&gt; scan_mutableStateArray5[6] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter(scan_mutableStateArray4[6], 6);
&lt;span class=&quot;code-comment&quot;&gt;/* 074 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 075 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 076 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 077 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void wholestagecodegen_init_1() {
&lt;span class=&quot;code-comment&quot;&gt;/* 078 */&lt;/span&gt; scan_mutableStateArray3[3] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnsafeRow(2);
&lt;span class=&quot;code-comment&quot;&gt;/* 079 */&lt;/span&gt; scan_mutableStateArray4[3] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.BufferHolder(scan_mutableStateArray3[3], 32);
&lt;span class=&quot;code-comment&quot;&gt;/* 080 */&lt;/span&gt; scan_mutableStateArray5[3] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter(scan_mutableStateArray4[3], 2);
&lt;span class=&quot;code-comment&quot;&gt;/* 081 */&lt;/span&gt; scan_mutableStateArray3[4] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnsafeRow(8);
&lt;span class=&quot;code-comment&quot;&gt;/* 082 */&lt;/span&gt; scan_mutableStateArray4[4] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.BufferHolder(scan_mutableStateArray3[4], 64);
&lt;span class=&quot;code-comment&quot;&gt;/* 083 */&lt;/span&gt; scan_mutableStateArray5[4] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter(scan_mutableStateArray4[4], 8);
&lt;span class=&quot;code-comment&quot;&gt;/* 084 */&lt;/span&gt; scan_mutableStateArray3[5] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnsafeRow(6);
&lt;span class=&quot;code-comment&quot;&gt;/* 085 */&lt;/span&gt; scan_mutableStateArray4[5] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.BufferHolder(scan_mutableStateArray3[5], 192);
&lt;span class=&quot;code-comment&quot;&gt;/* 086 */&lt;/span&gt; scan_mutableStateArray5[5] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter(scan_mutableStateArray4[5], 6);
&lt;span class=&quot;code-comment&quot;&gt;/* 087 */&lt;/span&gt; scan_mutableStateArray3[6] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnsafeRow(6);
&lt;span class=&quot;code-comment&quot;&gt;/* 088 */&lt;/span&gt; scan_mutableStateArray4[6] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.spark.sql.catalyst.expressions.codegen.BufferHolder(scan_mutableStateArray3[6], 192);
&lt;span class=&quot;code-comment&quot;&gt;/* 089 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 090 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 091 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 092 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void processNext() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; java.io.IOException {
&lt;span class=&quot;code-comment&quot;&gt;/* 093 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (scan_mutableStateArray1[0] == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&lt;span class=&quot;code-comment&quot;&gt;/* 094 */&lt;/span&gt; scan_nextBatch();
&lt;span class=&quot;code-comment&quot;&gt;/* 095 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 096 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (scan_mutableStateArray1[0] != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&lt;span class=&quot;code-comment&quot;&gt;/* 097 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; scan_numRows = scan_mutableStateArray1[0].numRows();
&lt;span class=&quot;code-comment&quot;&gt;/* 098 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; scan_localEnd = scan_numRows - scan_batchIdx;
&lt;span class=&quot;code-comment&quot;&gt;/* 099 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; scan_localIdx = 0; scan_localIdx &amp;lt; scan_localEnd; scan_localIdx++) {
&lt;span class=&quot;code-comment&quot;&gt;/* 100 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; scan_rowIdx = scan_batchIdx + scan_localIdx;
&lt;span class=&quot;code-comment&quot;&gt;/* 101 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 102 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; scan_isNull = scan_mutableStateArray2[0].isNullAt(scan_rowIdx);
&lt;span class=&quot;code-comment&quot;&gt;/* 103 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; scan_value = scan_isNull ? -1L : (scan_mutableStateArray2[0].getLong(scan_rowIdx));
&lt;span class=&quot;code-comment&quot;&gt;/* 104 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 105 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; filter_isNull2 = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 106 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; filter_value2 = -1L;
&lt;span class=&quot;code-comment&quot;&gt;/* 107 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 108 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; filter_isNull4 = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 109 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; filter_value4 = -1.0;
&lt;span class=&quot;code-comment&quot;&gt;/* 110 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; || 600.0D == 0) {
&lt;span class=&quot;code-comment&quot;&gt;/* 111 */&lt;/span&gt; filter_isNull4 = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 112 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 113 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; filter_isNull6 = scan_isNull;
&lt;span class=&quot;code-comment&quot;&gt;/* 114 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; filter_value6 = -1L;
&lt;span class=&quot;code-comment&quot;&gt;/* 115 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!filter_isNull6) {
&lt;span class=&quot;code-comment&quot;&gt;/* 116 */&lt;/span&gt; filter_value6 = scan_value / 1000000L;
&lt;span class=&quot;code-comment&quot;&gt;/* 117 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 118 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; filter_isNull5 = filter_isNull6;
&lt;span class=&quot;code-comment&quot;&gt;/* 119 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; filter_value5 = -1.0;
&lt;span class=&quot;code-comment&quot;&gt;/* 120 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!filter_isNull6) {
&lt;span class=&quot;code-comment&quot;&gt;/* 121 */&lt;/span&gt; filter_value5 = (&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;) filter_value6;
&lt;span class=&quot;code-comment&quot;&gt;/* 122 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 123 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (filter_isNull5) {
&lt;span class=&quot;code-comment&quot;&gt;/* 124 */&lt;/span&gt; filter_isNull4 = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 125 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 126 */&lt;/span&gt; filter_value4 = (&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)(filter_value5 / 600.0D);
&lt;span class=&quot;code-comment&quot;&gt;/* 127 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 128 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 129 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; filter_isNull3 = filter_isNull4;
&lt;span class=&quot;code-comment&quot;&gt;/* 130 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; filter_value3 = -1L;
&lt;span class=&quot;code-comment&quot;&gt;/* 131 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 132 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!filter_isNull4) {
&lt;span class=&quot;code-comment&quot;&gt;/* 133 */&lt;/span&gt; filter_value3 = (&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;)(java.lang.&lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.floor(filter_value4));
&lt;span class=&quot;code-comment&quot;&gt;/* 134 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 135 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!filter_isNull3) {
&lt;span class=&quot;code-comment&quot;&gt;/* 136 */&lt;/span&gt; filter_isNull2 = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; &lt;span class=&quot;code-comment&quot;&gt;// resultCode could change nullability.
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;/* 137 */&lt;/span&gt; filter_value2 = filter_value3 * 600L;
&lt;span class=&quot;code-comment&quot;&gt;/* 138 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 139 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 140 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; filter_isNull1 = filter_isNull2;
&lt;span class=&quot;code-comment&quot;&gt;/* 141 */&lt;/span&gt; UTF8String filter_value1 = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 142 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!filter_isNull1) {
&lt;span class=&quot;code-comment&quot;&gt;/* 143 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 144 */&lt;/span&gt; filter_value1 = UTF8String.fromString(((java.text.DateFormat) references[3] &lt;span class=&quot;code-comment&quot;&gt;/* formatter */&lt;/span&gt;).format(
&lt;span class=&quot;code-comment&quot;&gt;/* 145 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; java.util.Date(filter_value2 * 1000L)));
&lt;span class=&quot;code-comment&quot;&gt;/* 146 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (java.lang.IllegalArgumentException e) {
&lt;span class=&quot;code-comment&quot;&gt;/* 147 */&lt;/span&gt; filter_isNull1 = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 148 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 149 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 150 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!(!(filter_isNull1))) &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 151 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 152 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; scan_isNull2 = scan_mutableStateArray2[2].isNullAt(scan_rowIdx);
&lt;span class=&quot;code-comment&quot;&gt;/* 153 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; scan_value2 = scan_isNull2 ? -1L : (scan_mutableStateArray2[2].getLong(scan_rowIdx));
&lt;span class=&quot;code-comment&quot;&gt;/* 154 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 155 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!(!(scan_isNull2))) &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 156 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 157 */&lt;/span&gt; ((org.apache.spark.sql.execution.metric.SQLMetric) references[2] &lt;span class=&quot;code-comment&quot;&gt;/* numOutputRows */&lt;/span&gt;).add(1);
&lt;span class=&quot;code-comment&quot;&gt;/* 158 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 159 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; project_isNull6 = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 160 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; project_value6 = -1L;
&lt;span class=&quot;code-comment&quot;&gt;/* 161 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 162 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; project_isNull8 = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 163 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; project_value8 = -1.0;
&lt;span class=&quot;code-comment&quot;&gt;/* 164 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; || 600.0D == 0) {
&lt;span class=&quot;code-comment&quot;&gt;/* 165 */&lt;/span&gt; project_isNull8 = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 166 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 167 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; project_isNull10 = scan_isNull;
&lt;span class=&quot;code-comment&quot;&gt;/* 168 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; project_value10 = -1L;
&lt;span class=&quot;code-comment&quot;&gt;/* 169 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!project_isNull10) {
&lt;span class=&quot;code-comment&quot;&gt;/* 170 */&lt;/span&gt; project_value10 = scan_value / 1000000L;
&lt;span class=&quot;code-comment&quot;&gt;/* 171 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 172 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; project_isNull9 = project_isNull10;
&lt;span class=&quot;code-comment&quot;&gt;/* 173 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; project_value9 = -1.0;
&lt;span class=&quot;code-comment&quot;&gt;/* 174 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!project_isNull10) {
&lt;span class=&quot;code-comment&quot;&gt;/* 175 */&lt;/span&gt; project_value9 = (&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;) project_value10;
&lt;span class=&quot;code-comment&quot;&gt;/* 176 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 177 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (project_isNull9) {
&lt;span class=&quot;code-comment&quot;&gt;/* 178 */&lt;/span&gt; project_isNull8 = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 179 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 180 */&lt;/span&gt; project_value8 = (&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)(project_value9 / 600.0D);
&lt;span class=&quot;code-comment&quot;&gt;/* 181 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 182 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 183 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; project_isNull7 = project_isNull8;
&lt;span class=&quot;code-comment&quot;&gt;/* 184 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; project_value7 = -1L;
&lt;span class=&quot;code-comment&quot;&gt;/* 185 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 186 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!project_isNull8) {
&lt;span class=&quot;code-comment&quot;&gt;/* 187 */&lt;/span&gt; project_value7 = (&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;)(java.lang.&lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.floor(project_value8));
&lt;span class=&quot;code-comment&quot;&gt;/* 188 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 189 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!project_isNull7) {
&lt;span class=&quot;code-comment&quot;&gt;/* 190 */&lt;/span&gt; project_isNull6 = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; &lt;span class=&quot;code-comment&quot;&gt;// resultCode could change nullability.
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;/* 191 */&lt;/span&gt; project_value6 = project_value7 * 600L;
&lt;span class=&quot;code-comment&quot;&gt;/* 192 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 193 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 194 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; project_isNull5 = project_isNull6;
&lt;span class=&quot;code-comment&quot;&gt;/* 195 */&lt;/span&gt; UTF8String project_value5 = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 196 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!project_isNull5) {
&lt;span class=&quot;code-comment&quot;&gt;/* 197 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 198 */&lt;/span&gt; project_value5 = UTF8String.fromString(((java.text.DateFormat) references[4] &lt;span class=&quot;code-comment&quot;&gt;/* formatter */&lt;/span&gt;).format(
&lt;span class=&quot;code-comment&quot;&gt;/* 199 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; java.util.Date(project_value6 * 1000L)));
&lt;span class=&quot;code-comment&quot;&gt;/* 200 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (java.lang.IllegalArgumentException e) {
&lt;span class=&quot;code-comment&quot;&gt;/* 201 */&lt;/span&gt; project_isNull5 = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 202 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 203 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 204 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 205 */&lt;/span&gt; &lt;span class=&quot;code-comment&quot;&gt;// generate join key &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; stream side
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;/* 206 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 207 */&lt;/span&gt; scan_mutableStateArray4[3].reset();
&lt;span class=&quot;code-comment&quot;&gt;/* 208 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 209 */&lt;/span&gt; scan_mutableStateArray5[3].zeroOutNullBytes();
&lt;span class=&quot;code-comment&quot;&gt;/* 210 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 211 */&lt;/span&gt; scan_mutableStateArray5[3].write(0, scan_value2);
&lt;span class=&quot;code-comment&quot;&gt;/* 212 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 213 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (project_isNull5) {
&lt;span class=&quot;code-comment&quot;&gt;/* 214 */&lt;/span&gt; scan_mutableStateArray5[3].setNullAt(1);
&lt;span class=&quot;code-comment&quot;&gt;/* 215 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 216 */&lt;/span&gt; scan_mutableStateArray5[3].write(1, project_value5);
&lt;span class=&quot;code-comment&quot;&gt;/* 217 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 218 */&lt;/span&gt; scan_mutableStateArray3[3].setTotalSize(scan_mutableStateArray4[3].totalSize());
&lt;span class=&quot;code-comment&quot;&gt;/* 219 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 220 */&lt;/span&gt; &lt;span class=&quot;code-comment&quot;&gt;// find matches from HashedRelation
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;/* 221 */&lt;/span&gt; UnsafeRow bhj_matched = scan_mutableStateArray3[3].anyNull() ? &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;: (UnsafeRow)bhj_relation.getValue(scan_mutableStateArray3[3]);
&lt;span class=&quot;code-comment&quot;&gt;/* 222 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (bhj_matched != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&lt;span class=&quot;code-comment&quot;&gt;/* 223 */&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 224 */&lt;/span&gt; ((org.apache.spark.sql.execution.metric.SQLMetric) references[7] &lt;span class=&quot;code-comment&quot;&gt;/* numOutputRows */&lt;/span&gt;).add(1);
&lt;span class=&quot;code-comment&quot;&gt;/* 225 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 226 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (locallimit_count &amp;lt; 21) {
&lt;span class=&quot;code-comment&quot;&gt;/* 227 */&lt;/span&gt; locallimit_count += 1;
&lt;span class=&quot;code-comment&quot;&gt;/* 228 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 229 */&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; project_isNull19 = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 230 */&lt;/span&gt; UTF8String project_value19 = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 231 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;) {
&lt;span class=&quot;code-comment&quot;&gt;/* 232 */&lt;/span&gt; project_value19 = UTF8String.fromString(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.valueOf(scan_value2));
&lt;span class=&quot;code-comment&quot;&gt;/* 233 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 234 */&lt;/span&gt; scan_mutableStateArray4[6].reset();
&lt;span class=&quot;code-comment&quot;&gt;/* 235 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 236 */&lt;/span&gt; scan_mutableStateArray5[6].zeroOutNullBytes();
&lt;span class=&quot;code-comment&quot;&gt;/* 237 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 238 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (project_isNull19) {
&lt;span class=&quot;code-comment&quot;&gt;/* 239 */&lt;/span&gt; scan_mutableStateArray5[6].setNullAt(0);
&lt;span class=&quot;code-comment&quot;&gt;/* 240 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 241 */&lt;/span&gt; scan_mutableStateArray5[6].write(0, project_value19);
&lt;span class=&quot;code-comment&quot;&gt;/* 242 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 243 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 244 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (project_isNull5) {
&lt;span class=&quot;code-comment&quot;&gt;/* 245 */&lt;/span&gt; scan_mutableStateArray5[6].setNullAt(1);
&lt;span class=&quot;code-comment&quot;&gt;/* 246 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 247 */&lt;/span&gt; scan_mutableStateArray5[6].write(1, project_value5);
&lt;span class=&quot;code-comment&quot;&gt;/* 248 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 249 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 250 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (project_isNull22) {
&lt;span class=&quot;code-comment&quot;&gt;/* 251 */&lt;/span&gt; scan_mutableStateArray5[6].setNullAt(2);
&lt;span class=&quot;code-comment&quot;&gt;/* 252 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 253 */&lt;/span&gt; scan_mutableStateArray5[6].write(2, project_value22);
&lt;span class=&quot;code-comment&quot;&gt;/* 254 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 255 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 256 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (project_isNull24) {
&lt;span class=&quot;code-comment&quot;&gt;/* 257 */&lt;/span&gt; scan_mutableStateArray5[6].setNullAt(3);
&lt;span class=&quot;code-comment&quot;&gt;/* 258 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 259 */&lt;/span&gt; scan_mutableStateArray5[6].write(3, project_value24);
&lt;span class=&quot;code-comment&quot;&gt;/* 260 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 261 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 262 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (project_isNull26) {
&lt;span class=&quot;code-comment&quot;&gt;/* 263 */&lt;/span&gt; scan_mutableStateArray5[6].setNullAt(4);
&lt;span class=&quot;code-comment&quot;&gt;/* 264 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 265 */&lt;/span&gt; scan_mutableStateArray5[6].write(4, project_value26);
&lt;span class=&quot;code-comment&quot;&gt;/* 266 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 267 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 268 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (project_isNull28) {
&lt;span class=&quot;code-comment&quot;&gt;/* 269 */&lt;/span&gt; scan_mutableStateArray5[6].setNullAt(5);
&lt;span class=&quot;code-comment&quot;&gt;/* 270 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 271 */&lt;/span&gt; scan_mutableStateArray5[6].write(5, project_value28);
&lt;span class=&quot;code-comment&quot;&gt;/* 272 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 273 */&lt;/span&gt; scan_mutableStateArray3[6].setTotalSize(scan_mutableStateArray4[6].totalSize());
&lt;span class=&quot;code-comment&quot;&gt;/* 274 */&lt;/span&gt; append(scan_mutableStateArray3[6]);
&lt;span class=&quot;code-comment&quot;&gt;/* 275 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 276 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;code-comment&quot;&gt;/* 277 */&lt;/span&gt; locallimit_stopEarly = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 278 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 279 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 280 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 281 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 282 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 283 */&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&lt;span class=&quot;code-comment&quot;&gt;/* 284 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (shouldStop()) { scan_batchIdx = scan_rowIdx + 1; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;; }
&lt;span class=&quot;code-comment&quot;&gt;/* 285 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 286 */&lt;/span&gt; scan_batchIdx = scan_numRows;
&lt;span class=&quot;code-comment&quot;&gt;/* 287 */&lt;/span&gt; scan_mutableStateArray1[0] = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;/* 288 */&lt;/span&gt; scan_nextBatch();
&lt;span class=&quot;code-comment&quot;&gt;/* 289 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 290 */&lt;/span&gt; ((org.apache.spark.sql.execution.metric.SQLMetric) references[1] &lt;span class=&quot;code-comment&quot;&gt;/* scanTime */&lt;/span&gt;).add(scan_scanTime / (1000 * 1000));
&lt;span class=&quot;code-comment&quot;&gt;/* 291 */&lt;/span&gt; scan_scanTime = 0;
&lt;span class=&quot;code-comment&quot;&gt;/* 292 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 293 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 294 */&lt;/span&gt; @Override
&lt;span class=&quot;code-comment&quot;&gt;/* 295 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; stopEarly() {
&lt;span class=&quot;code-comment&quot;&gt;/* 296 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; locallimit_stopEarly;
&lt;span class=&quot;code-comment&quot;&gt;/* 297 */&lt;/span&gt; }
&lt;span class=&quot;code-comment&quot;&gt;/* 298 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 299 */&lt;/span&gt; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16711277" author="mgaido" created="Thu, 6 Dec 2018 10:56:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chamcyl&quot; class=&quot;user-hover&quot; rel=&quot;chamcyl&quot;&gt;chamcyl&lt;/a&gt; could you try 2.3.2 please? If it fails on 2.3.2, can you please create a new JIRA and provide a reproducer? Thanks.&lt;/p&gt;</comment>
                            <comment id="16711316" author="chamcyl" created="Thu, 6 Dec 2018 11:21:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mgaido&quot; class=&quot;user-hover&quot; rel=&quot;mgaido&quot;&gt;mgaido&lt;/a&gt;&#160; it work well on 2.3.2 .&#160; &#160; It should be&#160;a good idea to upgrade to this stable version.Thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 49 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35imf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12335644">2.1.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>