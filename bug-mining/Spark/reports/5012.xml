<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:54:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-21344] BinaryType comparison does signed byte array comparison</title>
                <link>https://issues.apache.org/jira/browse/SPARK-21344</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;BinaryType used by Spark SQL defines ordering using signed byte comparisons. This can lead to unexpected behavior. Consider the following code snippet that shows this error:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestRecord(col0: Array[&lt;span class=&quot;code-object&quot;&gt;Byte&lt;/span&gt;])
def convertToBytes(i: &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;): Array[&lt;span class=&quot;code-object&quot;&gt;Byte&lt;/span&gt;] = {
    val bb = java.nio.ByteBuffer.allocate(8)
    bb.putLong(i)
    bb.array
  }
def test = {
    val sql = spark.sqlContext
    &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; sql.implicits._
    val timestamp = 1498772083037L
    val data = (timestamp to timestamp + 1000L).map(i =&amp;gt; TestRecord(convertToBytes(i)))
    val testDF = sc.parallelize(data).toDF
    val filter1 = testDF.filter(col(&lt;span class=&quot;code-quote&quot;&gt;&quot;col0&quot;&lt;/span&gt;) &amp;gt;= convertToBytes(timestamp) &amp;amp;&amp;amp; col(&lt;span class=&quot;code-quote&quot;&gt;&quot;col0&quot;&lt;/span&gt;) &amp;lt; convertToBytes(timestamp + 50L))
    val filter2 = testDF.filter(col(&lt;span class=&quot;code-quote&quot;&gt;&quot;col0&quot;&lt;/span&gt;) &amp;gt;= convertToBytes(timestamp + 50L) &amp;amp;&amp;amp; col(&lt;span class=&quot;code-quote&quot;&gt;&quot;col0&quot;&lt;/span&gt;) &amp;lt; convertToBytes(timestamp + 100L))
    val filter3 = testDF.filter(col(&lt;span class=&quot;code-quote&quot;&gt;&quot;col0&quot;&lt;/span&gt;) &amp;gt;= convertToBytes(timestamp) &amp;amp;&amp;amp; col(&lt;span class=&quot;code-quote&quot;&gt;&quot;col0&quot;&lt;/span&gt;) &amp;lt; convertToBytes(timestamp + 100L))
    &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt;(filter1.count == 50)
    &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt;(filter2.count == 50)
    &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt;(filter3.count == 100)
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</description>
                <environment></environment>
        <key id="13085589">SPARK-21344</key>
            <summary>BinaryType comparison does signed byte array comparison</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kiszk">Kazuaki Ishizaki</assignee>
                                    <reporter username="shubhamc">Shubham Chopra</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Jul 2017 20:15:22 +0000</created>
                <updated>Sun, 16 Jul 2017 16:45:20 +0000</updated>
                            <resolved>Sun, 16 Jul 2017 16:45:20 +0000</resolved>
                                    <version>2.0.0</version>
                    <version>2.1.1</version>
                                    <fixVersion>2.0.3</fixVersion>
                    <fixVersion>2.1.2</fixVersion>
                    <fixVersion>2.2.1</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16078825" author="dongjoon" created="Fri, 7 Jul 2017 23:23:41 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shubhamc&quot; class=&quot;user-hover&quot; rel=&quot;shubhamc&quot;&gt;shubhamc&lt;/a&gt;.&lt;br/&gt;
Thank you for reporting. I just change the priority since `Blocker` is set by committers.&lt;/p&gt;</comment>
                            <comment id="16078827" author="dongjoon" created="Fri, 7 Jul 2017 23:26:20 +0000"  >&lt;p&gt;Also, this cannot be blocker because Spark 2.0.0 seems to have the same behavior according to your test code.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;scala&amp;gt; test
java.lang.AssertionError: assertion failed
  at scala.Predef$.&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt;(Predef.scala:156)
  at test(&amp;lt;console&amp;gt;:37)
  ... 48 elided

scala&amp;gt; sc.version
res1: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; = 2.0.0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16079010" author="kiszk" created="Sat, 8 Jul 2017 07:12:09 +0000"  >&lt;p&gt;I will work for this if anyone has finished a PR.&lt;/p&gt;</comment>
                            <comment id="16079017" author="dongjoon" created="Sat, 8 Jul 2017 07:25:08 +0000"  >&lt;p&gt;+1 ! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16079023" author="srowen" created="Sat, 8 Jul 2017 07:32:00 +0000"  >&lt;p&gt;Bytes are signed, as are other int types in Spark SQL / Hive. Is this not normal then?&lt;/p&gt;</comment>
                            <comment id="16079065" author="apachespark" created="Sat, 8 Jul 2017 09:30:04 +0000"  >&lt;p&gt;User &apos;kiszk&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/18571&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/18571&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 19 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3h9av:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>