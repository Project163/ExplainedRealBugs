<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:29:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-5707] Enabling spark.sql.codegen throws ClassNotFound exception</title>
                <link>https://issues.apache.org/jira/browse/SPARK-5707</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Exception thrown:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.spark.SparkException: Job aborted due to stage failure: Task 13 in stage 133.0 failed 4 times, most recent failure: Lost task 13.3 in stage 133.0 (TID 3066, cdh52-node2): java.io.IOException: com.esotericsoftware.kryo.KryoException: Unable to find class: __wrapper$1$81257352e1c844aebf09cb84fe9e7459.__wrapper$1$81257352e1c844aebf09cb84fe9e7459$SpecificRow$1
Serialization trace:
hashTable (org.apache.spark.sql.execution.joins.UniqueKeyHashedRelation)
        at org.apache.spark.util.Utils$.tryOrIOException(Utils.scala:1011)
        at org.apache.spark.broadcast.TorrentBroadcast.readBroadcastBlock(TorrentBroadcast.scala:164)
        at org.apache.spark.broadcast.TorrentBroadcast._value$lzycompute(TorrentBroadcast.scala:64)
        at org.apache.spark.broadcast.TorrentBroadcast._value(TorrentBroadcast.scala:64)
        at org.apache.spark.broadcast.TorrentBroadcast.getValue(TorrentBroadcast.scala:87)
        at org.apache.spark.broadcast.Broadcast.value(Broadcast.scala:70)
        at org.apache.spark.sql.execution.joins.BroadcastHashJoin$$anonfun$3.apply(BroadcastHashJoin.scala:62)
        at org.apache.spark.sql.execution.joins.BroadcastHashJoin$$anonfun$3.apply(BroadcastHashJoin.scala:61)
        at org.apache.spark.rdd.RDD$$anonfun$13.apply(RDD.scala:601)
        at org.apache.spark.rdd.RDD$$anonfun$13.apply(RDD.scala:601)
        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:263)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:230)
        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:263)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:230)
        at org.apache.spark.rdd.MappedRDD.compute(MappedRDD.scala:31)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:263)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:230)
        at org.apache.spark.rdd.CartesianRDD.compute(CartesianRDD.scala:75)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:263)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:230)
        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:263)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:230)
        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:263)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:230)
        at org.apache.spark.rdd.MappedRDD.compute(MappedRDD.scala:31)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:263)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:230)
        at org.apache.spark.rdd.CartesianRDD.compute(CartesianRDD.scala:75)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:263)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:230)
        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:263)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:230)
        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:263)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:230)
        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:263)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:230)
        at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:61)
        at org.apache.spark.scheduler.Task.run(Task.scala:56)
        at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:196)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;SQL:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; ${hiveconf:TEMP_TABLE}
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt;
  s_store_name,
  pr_review_date,
  pr_review_content
&lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; (
  &lt;span class=&quot;code-comment&quot;&gt;--&lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt; store_name &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; stores &lt;span class=&quot;code-keyword&quot;&gt;with&lt;/span&gt; flat &lt;span class=&quot;code-keyword&quot;&gt;or&lt;/span&gt; declining sales &lt;span class=&quot;code-keyword&quot;&gt;in&lt;/span&gt; 3 consecutive months.
&lt;/span&gt;  &lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; s_store_name
  &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; store s
  &lt;span class=&quot;code-keyword&quot;&gt;JOIN&lt;/span&gt; (
    &lt;span class=&quot;code-comment&quot;&gt;-- linear regression part
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt;
      &lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.cat &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; cat,
      &lt;span class=&quot;code-comment&quot;&gt;--&lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x)&lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; sumX,
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;--&lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.y)&lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; sumY,
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;--&lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.xy)&lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; sumXY,
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;--&lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.xx)&lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; sumXSquared,
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;--&lt;span class=&quot;code-keyword&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; N,
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;--N * sumXY - sumX * sumY &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; numerator,
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;--N * sumXSquared - sumX*sumX &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; denom
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;--numerator / denom &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; slope,
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;--(sumY - slope * sumX) / N &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; intercept
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;--(&lt;span class=&quot;code-keyword&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.xy) - &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.y)) &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; numerator,
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;--(&lt;span class=&quot;code-keyword&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.xx) - &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x)) &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; denom
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;--numerator / denom &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; slope,
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;--(sumY - slope * sumX) / N &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; intercept
&lt;/span&gt;      ((&lt;span class=&quot;code-keyword&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.xy) - &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.y)) / (&lt;span class=&quot;code-keyword&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.xx) - &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x)) ) &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; slope,
      (&lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.y) - ((&lt;span class=&quot;code-keyword&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.xy) - &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.y)) / (&lt;span class=&quot;code-keyword&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.xx) - &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x)) ) * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x)) / &lt;span class=&quot;code-keyword&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.x) &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; intercept
    &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; (
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt;
        s.ss_store_sk &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; cat,
        s.ss_sold_date_sk  &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; x,
        &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(s.ss_net_paid) &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; y,
        s.ss_sold_date_sk * &lt;span class=&quot;code-keyword&quot;&gt;SUM&lt;/span&gt;(s.ss_net_paid) &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; xy,
        s.ss_sold_date_sk*s.ss_sold_date_sk &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; xx
      &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; store_sales s
      &lt;span class=&quot;code-comment&quot;&gt;--&lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;date&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;range&lt;/span&gt;
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;LEFT&lt;/span&gt; SEMI &lt;span class=&quot;code-keyword&quot;&gt;JOIN&lt;/span&gt; (
        &lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; d_date_sk
        &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; date_dim d
        &lt;span class=&quot;code-keyword&quot;&gt;WHERE&lt;/span&gt; d.d_date &amp;gt;= &lt;span class=&quot;code-quote&quot;&gt;&apos;${hiveconf:q18_startDate}&apos;&lt;/span&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;AND&lt;/span&gt;   d.d_date &amp;lt;= &lt;span class=&quot;code-quote&quot;&gt;&apos;${hiveconf:q18_endDate}&apos;&lt;/span&gt;
      ) dd &lt;span class=&quot;code-keyword&quot;&gt;ON&lt;/span&gt; ( s.ss_sold_date_sk=dd.d_date_sk )
      &lt;span class=&quot;code-keyword&quot;&gt;WHERE&lt;/span&gt; s.ss_store_sk &amp;lt;= 18
      &lt;span class=&quot;code-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;BY&lt;/span&gt; s.ss_store_sk, s.ss_sold_date_sk
    ) &lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;temp&lt;/span&gt;.cat
  ) &lt;span class=&quot;code-keyword&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;on&lt;/span&gt; s.s_store_sk = &lt;span class=&quot;code-keyword&quot;&gt;c&lt;/span&gt;.cat
  &lt;span class=&quot;code-keyword&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;c&lt;/span&gt;.slope &amp;lt; 0
) tmp
&lt;span class=&quot;code-keyword&quot;&gt;JOIN&lt;/span&gt;  product_reviews pr &lt;span class=&quot;code-keyword&quot;&gt;on&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;WHERE&lt;/span&gt; instr(pr.pr_review_content, tmp.s_store_name) &amp;gt; 0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;yarn-client mode, spark.sql.codegen=true&lt;/p&gt;</environment>
        <key id="12773661">SPARK-5707</key>
            <summary>Enabling spark.sql.codegen throws ClassNotFound exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rams">Ram Sriharsha</assignee>
                                    <reporter username="yiyao">Yi Yao</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Feb 2015 02:21:24 +0000</created>
                <updated>Wed, 8 Jul 2015 17:43:20 +0000</updated>
                            <resolved>Wed, 8 Jul 2015 17:43:20 +0000</resolved>
                                    <version>1.2.0</version>
                    <version>1.3.1</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="14537702" author="nemccarthy" created="Mon, 11 May 2015 08:09:30 +0000"  >&lt;p&gt;+1 seeing this as well. Is there a workaround? &lt;/p&gt;</comment>
                            <comment id="14538926" author="nemccarthy" created="Tue, 12 May 2015 00:07:22 +0000"  >&lt;p&gt;Also throws and error when switching to Java Serialisation &lt;/p&gt;


&lt;p&gt;Error: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 9.0 failed 4 times, most recent failure: Lost task 0.3 in stage 9.0 (TID 515, qtausc-pphd0152.quantium.com.au.local): java.io.IOException: java.lang.ClassNotFoundException: _&lt;em&gt;wrapper$3$5dd511946bf343e58042f4a7fe748b41.&lt;/em&gt;_wrapper$3$5dd511946bf343e58042f4a7fe748b41$SpecificRow$1&lt;br/&gt;
	at org.apache.spark.util.Utils$.tryOrIOException(Utils.scala:1156)&lt;br/&gt;
	at org.apache.spark.broadcast.TorrentBroadcast.readBroadcastBlock(TorrentBroadcast.scala:164)&lt;br/&gt;
	at org.apache.spark.broadcast.TorrentBroadcast._value$lzycompute(TorrentBroadcast.scala:64)&lt;br/&gt;
	at org.apache.spark.broadcast.TorrentBroadcast._value(TorrentBroadcast.scala:64)&lt;br/&gt;
	at org.apache.spark.broadcast.TorrentBroadcast.getValue(TorrentBroadcast.scala:87)&lt;br/&gt;
	at org.apache.spark.broadcast.Broadcast.value(Broadcast.scala:70)&lt;br/&gt;
	at org.apache.spark.sql.execution.joins.BroadcastHashJoin$$anonfun$3.apply(BroadcastHashJoin.scala:73)&lt;br/&gt;
	at org.apache.spark.sql.execution.joins.BroadcastHashJoin$$anonfun$3.apply(BroadcastHashJoin.scala:72)&lt;br/&gt;
	at org.apache.spark.rdd.RDD$$anonfun$14.apply(RDD.scala:634)&lt;br/&gt;
	at org.apache.spark.rdd.RDD$$anonfun$14.apply(RDD.scala:634)&lt;br/&gt;
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)&lt;br/&gt;
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:277)&lt;br/&gt;
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:244)&lt;br/&gt;
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)&lt;br/&gt;
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:277)&lt;br/&gt;
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:244)&lt;br/&gt;
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)&lt;br/&gt;
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:277)&lt;br/&gt;
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:244)&lt;br/&gt;
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:61)&lt;br/&gt;
	at org.apache.spark.scheduler.Task.run(Task.scala:64)&lt;br/&gt;
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:203)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
Caused by: java.lang.ClassNotFoundException: _&lt;em&gt;wrapper$3$5dd511946bf343e58042f4a7fe748b41.&lt;/em&gt;_wrapper$3$5dd511946bf343e58042f4a7fe748b41$SpecificRow$1&lt;br/&gt;
	at java.net.URLClassLoader$1.run(URLClassLoader.java:366)&lt;br/&gt;
	at java.net.URLClassLoader$1.run(URLClassLoader.java:355)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at java.net.URLClassLoader.findClass(URLClassLoader.java:354)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:425)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:358)&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Class.java:274)&lt;br/&gt;
	at org.apache.spark.serializer.JavaDeserializationStream$$anon$1.resolveClass(JavaSerializer.scala:65)&lt;br/&gt;
	at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1612)&lt;br/&gt;
	at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1517)&lt;br/&gt;
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1771)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1350)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:370)&lt;br/&gt;
	at java.util.HashMap.readObject(HashMap.java:1179)&lt;br/&gt;
	at sun.reflect.GeneratedMethodAccessor26.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:606)&lt;br/&gt;
	at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1017)&lt;br/&gt;
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1893)&lt;br/&gt;
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1798)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1350)&lt;br/&gt;
	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1990)&lt;br/&gt;
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1915)&lt;br/&gt;
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1798)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1350)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:370)&lt;br/&gt;
	at org.apache.spark.serializer.JavaDeserializationStream.readObject(JavaSerializer.scala:68)&lt;br/&gt;
	at org.apache.spark.broadcast.TorrentBroadcast$.unBlockifyObject(TorrentBroadcast.scala:216)&lt;br/&gt;
	at org.apache.spark.broadcast.TorrentBroadcast$$anonfun$readBroadcastBlock$1.apply(TorrentBroadcast.scala:177)&lt;br/&gt;
	at org.apache.spark.util.Utils$.tryOrIOException(Utils.scala:1153)&lt;br/&gt;
	... 24 more&lt;/p&gt;

&lt;p&gt;Driver stacktrace:&lt;br/&gt;
SQLState:  null&lt;br/&gt;
ErrorCode: 0&lt;/p&gt;</comment>
                            <comment id="14558823" author="smolav" created="Tue, 26 May 2015 07:56:55 +0000"  >&lt;p&gt;This is probably a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-3846&quot; title=&quot;[SQL] Serialization exception (Kryo) on joins when enabling codegen &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-3846&quot;&gt;&lt;del&gt;SPARK-3846&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14613383" author="marmbrus" created="Fri, 3 Jul 2015 18:37:59 +0000"  >&lt;p&gt;This is still broken even with the recent changes to codegen. /cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davies&quot; class=&quot;user-hover&quot; rel=&quot;davies&quot;&gt;davies&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;sqlContext.range(1000000).repartition(1).write.mode(&lt;span class=&quot;code-quote&quot;&gt;&quot;ignore&quot;&lt;/span&gt;).saveAsTable(&lt;span class=&quot;code-quote&quot;&gt;&quot;1milints&quot;&lt;/span&gt;)
val query = sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * FROM 1milints a JOIN 1milints b ON a.id = b.id&quot;&lt;/span&gt;)
query.explain()

== Physical Plan ==
Project [id#3L,id#12L]
 BroadcastHashJoin [id#3L], [id#12L], BuildRight
  PhysicalRDD [id#3L], MapPartitionsRDD[17] at explain at &amp;lt;console&amp;gt;:28
  PhysicalRDD [id#12L], MapPartitionsRDD[21] at explain at &amp;lt;console&amp;gt;:28
query: org.apache.spark.sql.DataFrame = [id: bigint, id: bigint]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 4.0 failed 4 times, most recent failure: Lost task 0.3 in stage 4.0 (TID 10, 10.0.146.98): java.io.IOException: com.esotericsoftware.kryo.KryoException: Unable to find class: SC$SpecificRow
	at org.apache.spark.util.Utils$.tryOrIOException(Utils.scala:1264)
	at org.apache.spark.broadcast.TorrentBroadcast.readBroadcastBlock(TorrentBroadcast.scala:165)
	at org.apache.spark.broadcast.TorrentBroadcast._value$lzycompute(TorrentBroadcast.scala:64)
	at org.apache.spark.broadcast.TorrentBroadcast._value(TorrentBroadcast.scala:64)
	at org.apache.spark.broadcast.TorrentBroadcast.getValue(TorrentBroadcast.scala:88)
	at org.apache.spark.broadcast.Broadcast.value(Broadcast.scala:70)
	at org.apache.spark.sql.execution.joins.BroadcastHashJoin$$anonfun$3.apply(BroadcastHashJoin.scala:72)
	at org.apache.spark.sql.execution.joins.BroadcastHashJoin$$anonfun$3.apply(BroadcastHashJoin.scala:71)
	at org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$17.apply(RDD.scala:686)
	at org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$17.apply(RDD.scala:686)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:277)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:244)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:277)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:244)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:277)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:244)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14613412" author="apachespark" created="Fri, 3 Jul 2015 19:06:05 +0000"  >&lt;p&gt;User &apos;marmbrus&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7213&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7213&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14617347" author="apachespark" created="Tue, 7 Jul 2015 20:37:03 +0000"  >&lt;p&gt;User &apos;davies&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7264&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7264&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14617664" author="apachespark" created="Tue, 7 Jul 2015 23:40:06 +0000"  >&lt;p&gt;User &apos;davies&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7272&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7272&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14619031" author="marmbrus" created="Wed, 8 Jul 2015 17:43:20 +0000"  >&lt;p&gt;Issue resolved by pull request 7272&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7272&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7272&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12746666">SPARK-3846</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 19 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i25ee7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12332078">1.5.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>