<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:34:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-11661] We should still pushdown filters returned by a data source&apos;s unhandledFilters</title>
                <link>https://issues.apache.org/jira/browse/SPARK-11661</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;We added unhandledFilters interface to &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-10978&quot; title=&quot;Allow PrunedFilterScan to eliminate predicates from further evaluation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-10978&quot;&gt;&lt;del&gt;SPARK-10978&lt;/del&gt;&lt;/a&gt;. So, a data source has a chance to let Spark SQL know that for those returned filters, it is possible that the data source will not apply them to every row. So, Spark SQL should use a Filter operator to evaluate those filters. However, if a filter is a part of returned unhandledFilters, we should still push it down. For example, our internal data sources do not override this method, if we do not push down those filters, we are actually turning off the filter pushdown feature.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12912241">SPARK-11661</key>
            <summary>We should still pushdown filters returned by a data source&apos;s unhandledFilters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yhuai">Yin Huai</assignee>
                                    <reporter username="yhuai">Yin Huai</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Nov 2015 18:25:50 +0000</created>
                <updated>Tue, 5 Jan 2016 04:36:50 +0000</updated>
                            <resolved>Thu, 12 Nov 2015 08:48:51 +0000</resolved>
                                                    <fixVersion>1.6.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15000882" author="apachespark" created="Wed, 11 Nov 2015 18:48:04 +0000"  >&lt;p&gt;User &apos;yhuai&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9634&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9634&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15001857" author="lian cheng" created="Thu, 12 Nov 2015 08:48:51 +0000"  >&lt;p&gt;Issue resolved by pull request 9634&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9634&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9634&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15002256" author="yuzhihong@gmail.com" created="Thu, 12 Nov 2015 15:39:12 +0000"  >&lt;p&gt;Looks like org.apache.spark.streaming.rdd.TrackStateRDDSuite started to fail since this went in:&lt;br/&gt;
&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/Spark-Master-Maven-with-YARN/4084/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/Spark-Master-Maven-with-YARN/4084/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15002263" author="yhuai" created="Thu, 12 Nov 2015 15:44:09 +0000"  >&lt;p&gt;Does that use any data source at all?&lt;/p&gt;</comment>
                            <comment id="15002268" author="yhuai" created="Thu, 12 Nov 2015 15:46:43 +0000"  >&lt;p&gt;It started to fail before my pr (see &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/Spark-Master-Maven-with-YARN/4073/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/Spark-Master-Maven-with-YARN/4073/&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="15002290" author="yuzhihong@gmail.com" created="Thu, 12 Nov 2015 15:55:23 +0000"  >&lt;p&gt;Should have looked back further.&lt;/p&gt;

&lt;p&gt;But it seems the test failure is not intermittent.&lt;/p&gt;</comment>
                            <comment id="15075690" author="rspitzer" created="Thu, 31 Dec 2015 03:44:16 +0000"  >&lt;p&gt;This seems to have a slightly unintended consequence in the explain dialogue. &lt;/p&gt;

&lt;p&gt;It basically makes it seem as if a source is always pushing down all of the filters (even those it cannot handle)&lt;/p&gt;

&lt;p&gt;This can have a confusing effect (I kept checking my code to see where I had broken something &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; )&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;&quot;Query plan for source where nothing is handled by C* Source&quot;&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Filter ((((a#71 = 1) &amp;amp;&amp;amp; (b#72 = 2)) &amp;amp;&amp;amp; (c#73 = 1)) &amp;amp;&amp;amp; (e#75 = 1))
+- Scan org.apache.spark.sql.cassandra.CassandraSourceRelation@4b9cf75c[a#71,b#72,c#73,d#74,e#75,f#76,g#77,h#78] PushedFilters: [EqualTo(a,1), EqualTo(b,2), EqualTo(c,1), EqualTo(e,1)]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Although the tell tale &quot;Filter&quot; step is present my first instinct would tell me that the underlying source relation is using all of those filters.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;&quot;Query plan for source where &lt;b&gt;everything&lt;/b&gt; is handled by C* Source&quot;&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Scan org.apache.spark.sql.cassandra.CassandraSourceRelation@55d4456c[a#79,b#80,c#81,d#82,e#83,f#84,g#85,h#86] PushedFilters: [EqualTo(a,1), EqualTo(b,2), EqualTo(c,1), EqualTo(e,1)]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;I think this would be much clearer if we changed the metadata key to &quot;HandledFilters&quot; and only listed those handled fully by the underlying source.&lt;/p&gt;

&lt;p&gt;wdyt?&lt;/p&gt;</comment>
                            <comment id="15080605" author="yhuai" created="Mon, 4 Jan 2016 01:18:28 +0000"  >&lt;p&gt;Can you create a jira? Do you also want to create a PR to fix it (DataSourceStrategy is the file that needs to updated)?&lt;/p&gt;</comment>
                            <comment id="15082357" author="rspitzer" created="Tue, 5 Jan 2016 04:36:50 +0000"  >&lt;p&gt;Yeah sure, np&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-12639&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-12639&lt;/a&gt;, I&apos;ll work on the PR later this week&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12911771">SPARK-11621</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12911771">SPARK-11621</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12903054">SPARK-10978</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 46 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2o9dj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333083">1.6.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>