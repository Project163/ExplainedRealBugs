<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:48:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-17387] Creating SparkContext() from python without spark-submit ignores user conf</title>
                <link>https://issues.apache.org/jira/browse/SPARK-17387</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Consider the following scenario: user runs a python application not through spark-submit, but by adding the pyspark module and manually creating a Spark context. Kinda like this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ SPARK_HOME=$PWD PYTHONPATH=python:python/lib/py4j-0.10.3-src.zip python
Python 2.7.12 (default, Jul  1 2016, 15:12:24) 
[GCC 5.4.0 20160609] on linux2
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&amp;gt;&amp;gt;&amp;gt; from pyspark import SparkContext
&amp;gt;&amp;gt;&amp;gt; from pyspark import SparkConf
&amp;gt;&amp;gt;&amp;gt; conf = SparkConf().set(&quot;spark.driver.memory&quot;, &quot;4g&quot;)
&amp;gt;&amp;gt;&amp;gt; sc = SparkContext(conf=conf)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you look at the JVM launched by the pyspark code, it ignores the user&apos;s configuration:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ ps ax | grep $(pgrep -f SparkSubmit)
12283 pts/2    Sl+    0:03 /apps/java7/bin/java -cp ... -Xmx1g -XX:MaxPermSize=256m org.apache.spark.deploy.SparkSubmit pyspark-shell
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note the &quot;1g&quot; of memory. If instead you use &quot;pyspark&quot;, you get the correct &quot;4g&quot; in the JVM.&lt;/p&gt;

&lt;p&gt;This also affects other configs; for example, you can&apos;t really add jars to the driver&apos;s classpath using &quot;spark.jars&quot;.&lt;/p&gt;

&lt;p&gt;You can work around this by setting the undocumented env variable Spark itself uses:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ SPARK_HOME=$PWD PYTHONPATH=python:python/lib/py4j-0.10.3-src.zip python
Python 2.7.12 (default, Jul  1 2016, 15:12:24) 
[GCC 5.4.0 20160609] on linux2
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&amp;gt;&amp;gt;&amp;gt; import os
&amp;gt;&amp;gt;&amp;gt; os.environ[&apos;PYSPARK_SUBMIT_ARGS&apos;] = &quot;pyspark-shell --conf spark.driver.memory=4g&quot;
&amp;gt;&amp;gt;&amp;gt; from pyspark import SparkContext
&amp;gt;&amp;gt;&amp;gt; sc = SparkContext()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But it would be nicer if the configs were automatically propagated.&lt;/p&gt;

&lt;p&gt;BTW the reason for this is that the &lt;tt&gt;launch_gateway&lt;/tt&gt; function used to start the JVM does not take any parameters, and the only place where it reads arguments for Spark is that env variable.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13002510">SPARK-17387</key>
            <summary>Creating SparkContext() from python without spark-submit ignores user conf</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zjffdu">Jeff Zhang</assignee>
                                    <reporter username="vanzin">Marcelo Masiero Vanzin</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Sep 2016 23:25:51 +0000</created>
                <updated>Fri, 20 Jan 2017 11:09:02 +0000</updated>
                            <resolved>Tue, 11 Oct 2016 21:57:00 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>PySpark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15459905" author="vanzin" created="Fri, 2 Sep 2016 23:42:54 +0000"  >&lt;p&gt;A note about the workaround I posted: it doesn&apos;t seem to work for &quot;spark.driver.memory&quot; in particular:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;13669 pts/2    Sl+    0:02 /apps/java7/bin/java -cp /work/apache/spark/conf/:/work/apache/spark/assembly/target/scala-2.11/jars/* -Xmx1g -XX:MaxPermSize=256m org.apache.spark.deploy.SparkSubmit pyspark-shell --conf spark.driver.memory=4g
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note the Xmx says &quot;1g&quot; and the conf says &quot;4g&quot;. So some adjustments might be needed in the launcher code to account for that.&lt;/p&gt;</comment>
                            <comment id="15464579" author="apachespark" created="Mon, 5 Sep 2016 09:33:08 +0000"  >&lt;p&gt;User &apos;zjffdu&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14959&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14959&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15475242" author="bryanc" created="Thu, 8 Sep 2016 22:45:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vanzin&quot; class=&quot;user-hover&quot; rel=&quot;vanzin&quot;&gt;vanzin&lt;/a&gt; you said if you use PySpark you could get the correct &quot;4g&quot; memory option, but I was only able to do this through the command line like this&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$&amp;gt; bin/pyspark --conf spark.driver.memory=4g
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is that what you meant?  I think just adding the command line confs to configure the JVM through a plain Python shell would be a simple fix, and still be inline with how the Scala spark-shell works too.&lt;/p&gt;</comment>
                            <comment id="15475253" author="vanzin" created="Thu, 8 Sep 2016 22:48:38 +0000"  >&lt;p&gt;Yeah, that&apos;s what I mean. Running the pyspark shell, or using spark-submit to run a python script, correctly preserves the user&apos;s configuration.&lt;/p&gt;

&lt;p&gt;BTW my workaround above is wrong - &quot;pyspark-shell&quot; needs to be the last argument in &quot;PYSPARK_SUBMIT_ARGS&quot;, not the first.&lt;/p&gt;</comment>
                            <comment id="15475418" author="apachespark" created="Fri, 9 Sep 2016 00:11:06 +0000"  >&lt;p&gt;User &apos;BryanCutler&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15019&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15019&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15475754" author="codlife" created="Fri, 9 Sep 2016 03:10:41 +0000"  >&lt;p&gt;please check &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-17447&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-17447&lt;/a&gt;&lt;br/&gt;
thinks&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13036467">SPARK-19307</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 10 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i337nj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>