<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:39:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-46996] Use AnalyzeTableCommand overwrite statistics information incorrectly</title>
                <link>https://issues.apache.org/jira/browse/SPARK-46996</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;When the size of the table changes but the total number of rows in the table does not change, I use the sql statement &quot;analyze table student compute statistics&quot; to analyze the external table statistics. The Statistics information returned by the sql statement &quot;desc extended student&quot; only contains the table Size information, excluding rowCounts information.&lt;/p&gt;

&lt;p&gt;Specific operating instructions:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;Create&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt;

&lt;span class=&quot;code-keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt; student(id &lt;span class=&quot;code-keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;string&lt;/span&gt;, age &lt;span class=&quot;code-keyword&quot;&gt;int&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;row&lt;/span&gt; format delimited &lt;span class=&quot;code-keyword&quot;&gt;fields&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;terminated&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;,&apos;&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;lines&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;terminated&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;\n&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;hdfs://nameservice/spark/student&apos;&lt;/span&gt;;


The contents &lt;span class=&quot;code-keyword&quot;&gt;of&lt;/span&gt; the &lt;span class=&quot;code-keyword&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;are&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; follows:
&lt;span class=&quot;code-keyword&quot;&gt;class1&lt;/span&gt;.txt:

1,&lt;span class=&quot;code-quote&quot;&gt;&apos;Jack&apos;&lt;/span&gt;,25
2,&lt;span class=&quot;code-quote&quot;&gt;&apos;Thompson&apos;&lt;/span&gt;,28


&lt;span class=&quot;code-keyword&quot;&gt;class2&lt;/span&gt;.txt:

3,&lt;span class=&quot;code-quote&quot;&gt;&apos;Davy&apos;&lt;/span&gt;,30
4,&lt;span class=&quot;code-quote&quot;&gt;&apos;Thompson&apos;&lt;/span&gt;,35


&lt;span class=&quot;code-keyword&quot;&gt;class3&lt;/span&gt;.txt&#65306;

5,&lt;span class=&quot;code-quote&quot;&gt;&apos;Curry&apos;&lt;/span&gt;,40
6,&lt;span class=&quot;code-quote&quot;&gt;&apos;Morgan&apos;&lt;/span&gt;,20


Import &lt;span class=&quot;code-keyword&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;data&lt;/span&gt;

hdfs dfs -put 1.txt /spark/student
hdfs dfs -put 2.txt /spark/student


&lt;span class=&quot;code-keyword&quot;&gt;Analyze&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;statistics&lt;/span&gt;

&lt;span class=&quot;code-keyword&quot;&gt;analyze&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt; student &lt;span class=&quot;code-keyword&quot;&gt;compute&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;statistics&lt;/span&gt;;
&lt;span class=&quot;code-keyword&quot;&gt;desc&lt;/span&gt; extended student;

&lt;span class=&quot;code-keyword&quot;&gt;Return&lt;/span&gt; results

&lt;span class=&quot;code-keyword&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;EXTERNAL&lt;/span&gt;
Provider hive
&lt;span class=&quot;code-keyword&quot;&gt;Table&lt;/span&gt; Properties [transient_lastDdlTime=1707265554]
&lt;span class=&quot;code-keyword&quot;&gt;Statistics&lt;/span&gt; 56 bytes, 4 &lt;span class=&quot;code-keyword&quot;&gt;rows&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;Location&lt;/span&gt; hdfs://nameservice/spark/student
Serde Library org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
InputFormat org.apache.hadoop.mapred.TextInputFormat
OutputFormat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
&lt;span class=&quot;code-keyword&quot;&gt;Storage&lt;/span&gt; Properties [serialization.format=,, line.delim=
, field.delim=,]
&lt;span class=&quot;code-keyword&quot;&gt;Partition&lt;/span&gt; Provider &lt;span class=&quot;code-keyword&quot;&gt;Catalog&lt;/span&gt;


&lt;span class=&quot;code-keyword&quot;&gt;Modify&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt;

hdfs dfs -rm /spark/student/student2.txt
hdfs dfs -put student3.txt /spark/student


&lt;span class=&quot;code-keyword&quot;&gt;Analyze&lt;/span&gt; the &lt;span class=&quot;code-keyword&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt; again

&lt;span class=&quot;code-keyword&quot;&gt;analyze&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt; student &lt;span class=&quot;code-keyword&quot;&gt;compute&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;statistics&lt;/span&gt;;
&lt;span class=&quot;code-keyword&quot;&gt;desc&lt;/span&gt; extended student;

&lt;span class=&quot;code-keyword&quot;&gt;Return&lt;/span&gt; results

&lt;span class=&quot;code-keyword&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;EXTERNAL&lt;/span&gt;
Provider hive
&lt;span class=&quot;code-keyword&quot;&gt;Table&lt;/span&gt; Properties [transient_lastDdlTime=1707265719]
&lt;span class=&quot;code-keyword&quot;&gt;Statistics&lt;/span&gt; 55 bytes
&lt;span class=&quot;code-keyword&quot;&gt;Location&lt;/span&gt; hdfs://nameservice/spark/student
Serde Library org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
InputFormat org.apache.hadoop.mapred.TextInputFormat
OutputFormat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
&lt;span class=&quot;code-keyword&quot;&gt;Storage&lt;/span&gt; Properties [serialization.format=,, line.delim=
, field.delim=,]
&lt;span class=&quot;code-keyword&quot;&gt;Partition&lt;/span&gt; Provider &lt;span class=&quot;code-keyword&quot;&gt;Catalog&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Through the above operation results, I found that when the table size changes but the number of rows does not change, the statistics should include the new table size and the total number of rows. I don&#8217;t know if it is correct to only display the statistics of the table size.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13567672">SPARK-46996</key>
            <summary>Use AnalyzeTableCommand overwrite statistics information incorrectly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="davidxdh">Davy Xu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 7 Feb 2024 02:31:08 +0000</created>
                <updated>Wed, 7 Feb 2024 12:05:41 +0000</updated>
                                            <version>2.4.4</version>
                    <version>3.4.1</version>
                                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 39 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1n9ew:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>