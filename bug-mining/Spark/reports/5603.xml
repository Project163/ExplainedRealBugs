<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:59:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-23525] ALTER TABLE CHANGE COLUMN COMMENT doesn&apos;t work for external hive table</title>
                <link>https://issues.apache.org/jira/browse/SPARK-23525</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
print(spark.sql(&quot;&quot;&quot;
SHOW CREATE TABLE test.trends
&quot;&quot;&quot;).collect()[0].createtab_stmt)

&lt;span class=&quot;code-comment&quot;&gt;/// OUTPUT
&lt;/span&gt;CREATE EXTERNAL TABLE `test`.`trends`(`id` string COMMENT &lt;span class=&quot;code-quote&quot;&gt;&apos;&apos;, `metric` string COMMENT &apos;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&apos;, `amount` bigint COMMENT &apos;&lt;/span&gt;&apos;)
COMMENT &apos;&apos;
PARTITIONED BY (`date` string COMMENT &apos;&apos;)
ROW FORMAT SERDE &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe&apos;&lt;/span&gt;
WITH SERDEPROPERTIES (
  &lt;span class=&quot;code-quote&quot;&gt;&apos;serialization.format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;
)
STORED AS
  INPUTFORMAT &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat&apos;&lt;/span&gt;
  OUTPUTFORMAT &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat&apos;&lt;/span&gt;
LOCATION &lt;span class=&quot;code-quote&quot;&gt;&apos;s3:&lt;span class=&quot;code-comment&quot;&gt;//xxxxx/xxxxx/xxxx&apos;&lt;/span&gt;
&lt;/span&gt;TBLPROPERTIES (
  &lt;span class=&quot;code-quote&quot;&gt;&apos;transient_lastDdlTime&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;1519729384&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;last_modified_time&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;1519645652&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;last_modified_by&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;pavlo&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;last_castor_run_ts&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;1513561658.0&apos;&lt;/span&gt;
)


spark.sql(&quot;&quot;&quot;
DESCRIBE test.trends
&quot;&quot;&quot;).collect()

&lt;span class=&quot;code-comment&quot;&gt;// OUTPUT
&lt;/span&gt;[Row(col_name=&lt;span class=&quot;code-quote&quot;&gt;&apos;id&apos;&lt;/span&gt;, data_type=&lt;span class=&quot;code-quote&quot;&gt;&apos;string&apos;&lt;/span&gt;, comment=&apos;&apos;),
 Row(col_name=&lt;span class=&quot;code-quote&quot;&gt;&apos;metric&apos;&lt;/span&gt;, data_type=&lt;span class=&quot;code-quote&quot;&gt;&apos;string&apos;&lt;/span&gt;, comment=&apos;&apos;),
 Row(col_name=&lt;span class=&quot;code-quote&quot;&gt;&apos;amount&apos;&lt;/span&gt;, data_type=&lt;span class=&quot;code-quote&quot;&gt;&apos;bigint&apos;&lt;/span&gt;, comment=&apos;&apos;),
 Row(col_name=&lt;span class=&quot;code-quote&quot;&gt;&apos;date&apos;&lt;/span&gt;, data_type=&lt;span class=&quot;code-quote&quot;&gt;&apos;string&apos;&lt;/span&gt;, comment=&apos;&apos;),
 Row(col_name=&lt;span class=&quot;code-quote&quot;&gt;&apos;# Partition Information&apos;&lt;/span&gt;, data_type=&lt;span class=&quot;code-quote&quot;&gt;&apos;&apos;, comment=&apos;&lt;/span&gt;&apos;),
 Row(col_name=&lt;span class=&quot;code-quote&quot;&gt;&apos;# col_name&apos;&lt;/span&gt;, data_type=&lt;span class=&quot;code-quote&quot;&gt;&apos;data_type&apos;&lt;/span&gt;, comment=&lt;span class=&quot;code-quote&quot;&gt;&apos;comment&apos;&lt;/span&gt;),
 Row(col_name=&lt;span class=&quot;code-quote&quot;&gt;&apos;date&apos;&lt;/span&gt;, data_type=&lt;span class=&quot;code-quote&quot;&gt;&apos;string&apos;&lt;/span&gt;, comment=&apos;&apos;)]


spark.sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;&quot;alter table test.trends change column id id string comment &lt;span class=&quot;code-quote&quot;&gt;&apos;unique identifier&apos;&lt;/span&gt;&quot;&lt;/span&gt;&quot;&quot;)


spark.sql(&quot;&quot;&quot;
DESCRIBE test.trends
&quot;&quot;&quot;).collect()

&lt;span class=&quot;code-comment&quot;&gt;// OUTPUT
&lt;/span&gt;[Row(col_name=&lt;span class=&quot;code-quote&quot;&gt;&apos;id&apos;&lt;/span&gt;, data_type=&lt;span class=&quot;code-quote&quot;&gt;&apos;string&apos;&lt;/span&gt;, comment=&lt;span class=&quot;code-quote&quot;&gt;&apos;&apos;), Row(col_name=&apos;&lt;/span&gt;metric&lt;span class=&quot;code-quote&quot;&gt;&apos;, data_type=&apos;&lt;/span&gt;string&lt;span class=&quot;code-quote&quot;&gt;&apos;, comment=&apos;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&apos;), Row(col_name=&apos;&lt;/span&gt;amount&lt;span class=&quot;code-quote&quot;&gt;&apos;, data_type=&apos;&lt;/span&gt;bigint&lt;span class=&quot;code-quote&quot;&gt;&apos;, comment=&apos;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&apos;), Row(col_name=&apos;&lt;/span&gt;date&lt;span class=&quot;code-quote&quot;&gt;&apos;, data_type=&apos;&lt;/span&gt;string&lt;span class=&quot;code-quote&quot;&gt;&apos;, comment=&apos;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&apos;), Row(col_name=&apos;&lt;/span&gt;# Partition Information&lt;span class=&quot;code-quote&quot;&gt;&apos;, data_type=&apos;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&apos;, comment=&apos;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&apos;), Row(col_name=&apos;&lt;/span&gt;# col_name&lt;span class=&quot;code-quote&quot;&gt;&apos;, data_type=&apos;&lt;/span&gt;data_type&lt;span class=&quot;code-quote&quot;&gt;&apos;, comment=&apos;&lt;/span&gt;comment&lt;span class=&quot;code-quote&quot;&gt;&apos;), Row(col_name=&apos;&lt;/span&gt;date&lt;span class=&quot;code-quote&quot;&gt;&apos;, data_type=&apos;&lt;/span&gt;string&lt;span class=&quot;code-quote&quot;&gt;&apos;, comment=&apos;&lt;/span&gt;&apos;)]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The strange is that I&apos;ve assigned comment to the id field from hive successfully, and it&apos;s visible in Hue UI, but it&apos;s still not visible in from spark, and any spark requests doesn&apos;t have effect on the comments.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13141192">SPARK-23525</key>
            <summary>ALTER TABLE CHANGE COLUMN COMMENT doesn&apos;t work for external hive table</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jiangxb1987">Xingbo Jiang</assignee>
                                    <reporter username="pavlo.skliar">Pavlo Skliar</reporter>
                        <labels>
                    </labels>
                <created>Tue, 27 Feb 2018 11:13:17 +0000</created>
                <updated>Wed, 2 Jan 2019 23:43:17 +0000</updated>
                            <resolved>Wed, 7 Mar 2018 21:53:00 +0000</resolved>
                                    <version>2.2.0</version>
                    <version>2.3.0</version>
                                    <fixVersion>2.2.2</fixVersion>
                    <fixVersion>2.3.1</fixVersion>
                    <fixVersion>2.4.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16378533" author="jiangxb1987" created="Tue, 27 Feb 2018 12:56:02 +0000"  >&lt;p&gt;Thank you for reporting this. I believe the bug is caused by:&#160;&lt;a href=&quot;https://github.com/apache/spark/blob/8077bb04f350fd35df83ef896135c0672dc3f7b0/sql/hive/src/main/scala/org/apache/spark/sql/hive/HiveExternalCatalog.scala#L613&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/8077bb04f350fd35df83ef896135c0672dc3f7b0/sql/hive/src/main/scala/org/apache/spark/sql/hive/HiveExternalCatalog.scala#L613&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16378546" author="jiangxb1987" created="Tue, 27 Feb 2018 13:06:59 +0000"  >&lt;p&gt;I&apos;m working on a fix for it, and will try to backport the fix to 2.2.&lt;/p&gt;</comment>
                            <comment id="16378550" author="pavlo.skliar" created="Tue, 27 Feb 2018 13:12:36 +0000"  >&lt;p&gt;Unbelievably quick response as for an open-sourced project. so appreciated, thanks&lt;/p&gt;</comment>
                            <comment id="16380486" author="apachespark" created="Wed, 28 Feb 2018 15:39:05 +0000"  >&lt;p&gt;User &apos;jiangxb1987&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/20696&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/20696&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16390305" author="cloud_fan" created="Wed, 7 Mar 2018 21:53:00 +0000"  >&lt;p&gt;Issue resolved by pull request 20696&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/20696&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/20696&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16390649" author="apachespark" created="Thu, 8 Mar 2018 02:57:04 +0000"  >&lt;p&gt;User &apos;jiangxb1987&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/20768&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/20768&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3qn33:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311620" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Shepherd</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jiangxb1987</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>