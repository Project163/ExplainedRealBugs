<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:34:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-10500] sparkr.zip cannot be created if $SPARK_HOME/R/lib is unwritable</title>
                <link>https://issues.apache.org/jira/browse/SPARK-10500</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;As of &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-6797&quot; title=&quot;Add support for YARN cluster mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-6797&quot;&gt;&lt;del&gt;SPARK-6797&lt;/del&gt;&lt;/a&gt;, sparkr.zip is re-created each time spark-submit is run with an R application, which fails if Spark has been installed into a directory to which the current user doesn&apos;t have write permissions. (e.g., on EMR&apos;s emr-4.0.0 release, Spark is installed at /usr/lib/spark, which is only writable by root.)&lt;/p&gt;

&lt;p&gt;Would it be possible to skip creating sparkr.zip if it already exists? That would enable sparkr.zip to be pre-created by the root user and then reused each time spark-submit is run, which I believe is similar to how pyspark works.&lt;/p&gt;

&lt;p&gt;Another option would be to make the location configurable, as it&apos;s currently hardcoded to $SPARK_HOME/R/lib/sparkr.zip. Allowing it to be configured to something like the user&apos;s home directory or a random path in /tmp would get around the permissions issue.&lt;/p&gt;

&lt;p&gt;By the way, why does spark-submit even need to re-create sparkr.zip every time a new R application is launched? This seems unnecessary and inefficient, unless you are actively developing the SparkR libraries and expect the contents of sparkr.zip to change.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12862614">SPARK-10500</key>
            <summary>sparkr.zip cannot be created if $SPARK_HOME/R/lib is unwritable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sunrui">Sun Rui</assignee>
                                    <reporter username="jonathak">Jonathan Kelly</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Sep 2015 01:20:22 +0000</created>
                <updated>Mon, 17 Oct 2016 02:08:30 +0000</updated>
                            <resolved>Mon, 16 Nov 2015 03:29:34 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>1.6.0</fixVersion>
                                    <component>SparkR</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14735965" author="shivaram" created="Wed, 9 Sep 2015 01:36:21 +0000"  >&lt;p&gt;Yeah I think we can try to make it reusable if we the spark-packages in it doesn&apos;t change - I think we zip all dependent Spark packages together which is why we do it everytime, but Burak cc&apos;d can correct me if I am wrong. &lt;/p&gt;

&lt;p&gt;Providing a flag for this or using spark.local.dir might also be good fixes&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brkyvz&quot; class=&quot;user-hover&quot; rel=&quot;brkyvz&quot;&gt;brkyvz&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sunrui&quot; class=&quot;user-hover&quot; rel=&quot;sunrui&quot;&gt;sunrui&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14736152" author="sunrui" created="Wed, 9 Sep 2015 04:38:51 +0000"  >&lt;p&gt;this is caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-8313&quot; title=&quot;Support Spark Packages containing R code with --packages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-8313&quot;&gt;&lt;del&gt;SPARK-8313&lt;/del&gt;&lt;/a&gt;. To solve the problem, I think,&lt;br/&gt;
1. Still create sparkr.zip (contains only SparkR package) during compilation and contains sparkr.zip in the distribution;&lt;br/&gt;
2. Each time spark-submit is called, if there is no jars containing R code, use the default sparkr.zip in the distribution; else: compile the R code in jars, and bundle all the R packages including SparkR package into a zip file located in the temporary directory (which can be specified by spark.local.dir).&lt;/p&gt;</comment>
                            <comment id="14736196" author="sunrui" created="Wed, 9 Sep 2015 05:14:40 +0000"  >&lt;p&gt;Another thought is that each time spark-submit is called, if it needs to creates the R packages bundle, it should create a unique temporary sub-directory in the spark local directory, this would prevent multiple spark-submit sessions from interfering with each other. It would be better that the unique temporary sub-directory be deleted when spark-submit completes.&lt;/p&gt;</comment>
                            <comment id="14736212" author="shivaram" created="Wed, 9 Sep 2015 05:29:13 +0000"  >&lt;p&gt;Yeah creating a unique temp directory per SparkContext seems like the right thing to do.&lt;/p&gt;</comment>
                            <comment id="14736223" author="jonathak" created="Wed, 9 Sep 2015 05:42:57 +0000"  >&lt;p&gt;Ah, I was not aware that the Spark packages ended up in there too. Yes, what you say about building the zip in a unique temporary directory in spark.local.dir seems to make sense.&lt;/p&gt;</comment>
                            <comment id="14738479" author="sunrui" created="Thu, 10 Sep 2015 09:26:01 +0000"  >&lt;p&gt;I also realized that  &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-8313&quot; title=&quot;Support Spark Packages containing R code with --packages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-8313&quot;&gt;&lt;del&gt;SPARK-8313&lt;/del&gt;&lt;/a&gt; has problem in Standalone mode. Currently in standalone mode, R package bundle won&apos;t be shipped to workers. If additional R packages (compiled from R source in packages specified by --packges) are to be used in worker, it will fail.&lt;/p&gt;</comment>
                            <comment id="14966624" author="alexandre linte" created="Wed, 21 Oct 2015 10:43:43 +0000"  >&lt;p&gt;Any update on this JIRA ?&lt;br/&gt;
Still present on Spark 1.5.1&lt;/p&gt;</comment>
                            <comment id="14973444" author="felixcheung" created="Sun, 25 Oct 2015 21:29:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sunrui&quot; class=&quot;user-hover&quot; rel=&quot;sunrui&quot;&gt;sunrui&lt;/a&gt;suggestion 08/Sept makes sense. Would you like to work on this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sunrui&quot; class=&quot;user-hover&quot; rel=&quot;sunrui&quot;&gt;sunrui&lt;/a&gt;? Otherwise I could take a shot.&lt;/p&gt;</comment>
                            <comment id="14973530" author="sunrui" created="Mon, 26 Oct 2015 01:03:15 +0000"  >&lt;p&gt;yes, I am working on this&lt;/p&gt;</comment>
                            <comment id="14983925" author="apachespark" created="Sat, 31 Oct 2015 10:31:02 +0000"  >&lt;p&gt;User &apos;sun-rui&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9390&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9390&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14992857" author="sunrui" created="Fri, 6 Nov 2015 01:14:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Alexandre+LINTE&quot; class=&quot;user-hover&quot; rel=&quot;Alexandre LINTE&quot;&gt;Alexandre LINTE&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jonathak&quot; class=&quot;user-hover&quot; rel=&quot;jonathak&quot;&gt;jonathak&lt;/a&gt;, could you please help to test my PR to see if it solves your problem? I&apos;d like to have it tested before getting merged.&lt;/p&gt;</comment>
                            <comment id="15006194" author="shivaram" created="Mon, 16 Nov 2015 03:29:34 +0000"  >&lt;p&gt;Issue resolved by pull request 9390&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9390&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9390&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15061730" author="jerryshao" created="Thu, 17 Dec 2015 08:45:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sunrui&quot; class=&quot;user-hover&quot; rel=&quot;sunrui&quot;&gt;sunrui&lt;/a&gt; It would be better to back port to 1.5 if possible, for lots of vendor-shipped Spark, normally they will installed with account &quot;root&quot;, without this fix, only user &quot;root&quot; could successfully run SparkR &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="15063241" author="sunrui" created="Fri, 18 Dec 2015 01:25:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryshao&quot; class=&quot;user-hover&quot; rel=&quot;jerryshao&quot;&gt;jerryshao&lt;/a&gt; I am OK with backporting. But will there be any further release on 1.5? for example, 1.5.3? @shivaram, any opinion?&lt;/p&gt;</comment>
                            <comment id="15063295" author="shivaram" created="Fri, 18 Dec 2015 02:12:00 +0000"  >&lt;p&gt;I don&apos;t mind merging this in to branch-1.5 &amp;#8211; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sunrui&quot; class=&quot;user-hover&quot; rel=&quot;sunrui&quot;&gt;sunrui&lt;/a&gt; could you open a PR against branch-1.5 ?  I don&apos;t know when there will be a 1.5.3 release. cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rxin&quot; class=&quot;user-hover&quot; rel=&quot;rxin&quot;&gt;rxin&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12910640">SPARK-11524</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12910641">SPARK-11525</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12819568">SPARK-6797</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12851432">SPARK-9603</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12837249">SPARK-8313</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 48 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jx93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>