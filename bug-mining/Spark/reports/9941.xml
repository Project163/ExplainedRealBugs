<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:44:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-50151] RocksDB Hardening: Fix new file mapping version advancement and ineffective file reuse bug</title>
                <link>https://issues.apache.org/jira/browse/SPARK-50151</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;There are 2 bugs in the recently added new approach for RocksDB SST file mapping in this PR: &lt;a href=&quot;https://github.com/apache/spark/pull/47875&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/47875&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;The file mapping version is not properly advancing and only advances when we are reopening the RocksDB. This causes ineffective file reuse and we end up not reusing files that should have been reused. Leading to a lot of unnecessary file upload/download, and in the worst case it will make us act like file reuse is disabled.&lt;/li&gt;
	&lt;li&gt;Ineffective file reuse when creating a checkpoint. We currently will not reuse the files for creating checkpoint, if it was added in the current version i.e. if you do load(v1) -&amp;gt; save(v2), the SST files loaded in v1 will not be reused in v2, and we will upload them again.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;These two bugs were not caught even though we have tests to catch them, because there was also a bug in the test.&lt;/p&gt;

&lt;p&gt;NOTE: these bugs will not cause corruption and more of a performance bug. They just make file reuse ineffective. And end up working like there&apos;s no file reuse enabled. i.e. A lot of file upload/download&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13596989">SPARK-50151</key>
            <summary>RocksDB Hardening: Fix new file mapping version advancement and ineffective file reuse bug</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="michealok-db">B. Micheal Okutubo</assignee>
                                    <reporter username="michealok-db">B. Micheal Okutubo</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 28 Oct 2024 19:32:15 +0000</created>
                <updated>Sun, 3 Nov 2024 22:31:38 +0000</updated>
                            <resolved>Sun, 3 Nov 2024 22:31:38 +0000</resolved>
                                    <version>4.0.0</version>
                                    <fixVersion>4.0.0</fixVersion>
                                    <component>Structured Streaming</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17895153" author="kabhwan" created="Sun, 3 Nov 2024 22:31:38 +0000"  >&lt;p&gt;Issue resolved by pull request 48685&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/48685&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/48685&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 1 week, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1s960:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>