<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:41:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-14679] UI DAG visualization causes OOM generating data</title>
                <link>https://issues.apache.org/jira/browse/SPARK-14679</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;The UI will hit an OutOfMemoryException when generating the DAG visualization data for large Hive table scans. The problem is that data is being duplicated in the output for each RDD like cluster10 here:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;digraph G {
  subgraph clusterstage_1 {
    label=&lt;span class=&quot;code-quote&quot;&gt;&quot;Stage 1&quot;&lt;/span&gt;;
    subgraph cluster7 {
      label=&lt;span class=&quot;code-quote&quot;&gt;&quot;TungstenAggregate&quot;&lt;/span&gt;;
      9 [label=&lt;span class=&quot;code-quote&quot;&gt;&quot;MapPartitionsRDD [9]\nrun at ThreadPoolExecutor.java:1142&quot;&lt;/span&gt;];
    }
    subgraph cluster10 {
      label=&lt;span class=&quot;code-quote&quot;&gt;&quot;HiveTableScan&quot;&lt;/span&gt;;
      7 [label=&lt;span class=&quot;code-quote&quot;&gt;&quot;MapPartitionsRDD [7]\nrun at ThreadPoolExecutor.java:1142&quot;&lt;/span&gt;];
      6 [label=&lt;span class=&quot;code-quote&quot;&gt;&quot;MapPartitionsRDD [6]\nrun at ThreadPoolExecutor.java:1142&quot;&lt;/span&gt;];
      5 [label=&lt;span class=&quot;code-quote&quot;&gt;&quot;HadoopRDD [5]\nrun at ThreadPoolExecutor.java:1142&quot;&lt;/span&gt;];
    }
    subgraph cluster10 {
      label=&lt;span class=&quot;code-quote&quot;&gt;&quot;HiveTableScan&quot;&lt;/span&gt;;
      7 [label=&lt;span class=&quot;code-quote&quot;&gt;&quot;MapPartitionsRDD [7]\nrun at ThreadPoolExecutor.java:1142&quot;&lt;/span&gt;];
      6 [label=&lt;span class=&quot;code-quote&quot;&gt;&quot;MapPartitionsRDD [6]\nrun at ThreadPoolExecutor.java:1142&quot;&lt;/span&gt;];
      5 [label=&lt;span class=&quot;code-quote&quot;&gt;&quot;HadoopRDD [5]\nrun at ThreadPoolExecutor.java:1142&quot;&lt;/span&gt;];
    }
    subgraph cluster8 {
      label=&lt;span class=&quot;code-quote&quot;&gt;&quot;ConvertToUnsafe&quot;&lt;/span&gt;;
      8 [label=&lt;span class=&quot;code-quote&quot;&gt;&quot;MapPartitionsRDD [8]\nrun at ThreadPoolExecutor.java:1142&quot;&lt;/span&gt;];
    }
    subgraph cluster10 {
      label=&lt;span class=&quot;code-quote&quot;&gt;&quot;HiveTableScan&quot;&lt;/span&gt;;
      7 [label=&lt;span class=&quot;code-quote&quot;&gt;&quot;MapPartitionsRDD [7]\nrun at ThreadPoolExecutor.java:1142&quot;&lt;/span&gt;];
      6 [label=&lt;span class=&quot;code-quote&quot;&gt;&quot;MapPartitionsRDD [6]\nrun at ThreadPoolExecutor.java:1142&quot;&lt;/span&gt;];
      5 [label=&lt;span class=&quot;code-quote&quot;&gt;&quot;HadoopRDD [5]\nrun at ThreadPoolExecutor.java:1142&quot;&lt;/span&gt;];
    }
  }
  8-&amp;amp;gt;9;
  6-&amp;amp;gt;7;
  5-&amp;amp;gt;6;
  7-&amp;amp;gt;8;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hive has a large number of RDDs because it creates a RDD for each partition in the scan returned by the metastore. Each RDD in results in another copy of the. The data is built with a StringBuilder and copied into a String, so the memory required gets huge quickly.&lt;/p&gt;

&lt;p&gt;The cause is how the RDDOperationGraph gets generated. For each RDD, a nested chain of RDDOperationCluster is produced and those are merged. But, there is no implementation of equals for RDDOperationCluster, so they are always distinct and accumulated rather than &lt;a href=&quot;https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/ui/scope/RDDOperationGraph.scala#L135&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;deduped&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12959340">SPARK-14679</key>
            <summary>UI DAG visualization causes OOM generating data</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rdblue">Ryan Blue</assignee>
                                    <reporter username="rdblue">Ryan Blue</reporter>
                        <labels>
                    </labels>
                <created>Sat, 16 Apr 2016 01:21:47 +0000</created>
                <updated>Wed, 20 Apr 2016 10:27:52 +0000</updated>
                            <resolved>Wed, 20 Apr 2016 10:27:36 +0000</resolved>
                                    <version>1.6.1</version>
                                    <fixVersion>1.6.2</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Web UI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15243926" author="apachespark" created="Sat, 16 Apr 2016 01:26:03 +0000"  >&lt;p&gt;User &apos;rdblue&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/12437&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/12437&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15249614" author="srowen" created="Wed, 20 Apr 2016 10:27:36 +0000"  >&lt;p&gt;Issue resolved by pull request 12437&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/12437&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/12437&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 30 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2w7i7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>