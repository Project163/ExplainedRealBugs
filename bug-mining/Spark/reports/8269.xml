<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:28:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-37465] PySpark tests failing on Pandas 0.23</title>
                <link>https://issues.apache.org/jira/browse/SPARK-37465</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I was running Spark tests with Pandas &lt;tt&gt;0.23.4&lt;/tt&gt; and got the error below. The minimum Pandas version is currently &lt;tt&gt;0.23.2&lt;/tt&gt; &lt;a href=&quot;https://github.com/apache/spark/blob/v3.2.0/python/setup.py#L114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;(Github)&lt;/a&gt;. Upgrading to &lt;tt&gt;0.24.0&lt;/tt&gt; fixes the error. I think Spark needs &lt;a href=&quot;https://github.com/pandas-dev/pandas/pull/21160/files#diff-1b7183f5b3970e2a1d39a82d71686e39c765d18a34231b54c857b0c4c9bb8222&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this fix (Github)&lt;/a&gt; in Pandas.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ python/run-tests --testnames &lt;span class=&quot;code-quote&quot;&gt;&apos;pyspark.pandas.tests.data_type_ops.test_boolean_ops BooleanOpsTest.test_floordiv&apos;&lt;/span&gt;

...

======================================================================
ERROR [5.785s]: test_floordiv (pyspark.pandas.tests.data_type_ops.test_boolean_ops.BooleanOpsTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/circleci/project/python/pyspark/pandas/tests/data_type_ops/test_boolean_ops.py&quot;&lt;/span&gt;, line 128, in test_floordiv
    self.assert_eq(b_pser &lt;span class=&quot;code-comment&quot;&gt;// b_pser.astype(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), b_psser // b_psser.astype(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;))
&lt;/span&gt;  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/circleci/miniconda/envs/python3/lib/python3.6/site-packages/pandas/core/ops.py&quot;&lt;/span&gt;, line 1069, in wrapper
    result = safe_na_op(lvalues, rvalues)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/circleci/miniconda/envs/python3/lib/python3.6/site-packages/pandas/core/ops.py&quot;&lt;/span&gt;, line 1033, in safe_na_op
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; na_op(lvalues, rvalues)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/circleci/miniconda/envs/python3/lib/python3.6/site-packages/pandas/core/ops.py&quot;&lt;/span&gt;, line 1027, in na_op
    result = missing.fill_zeros(result, x, y, op_name, fill_zeros)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/circleci/miniconda/envs/python3/lib/python3.6/site-packages/pandas/core/missing.py&quot;&lt;/span&gt;, line 641, in fill_zeros
    signs = np.sign(y &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; name.startswith((&lt;span class=&quot;code-quote&quot;&gt;&apos;r&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;__r&apos;&lt;/span&gt;)) &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; x)
TypeError: ufunc &lt;span class=&quot;code-quote&quot;&gt;&apos;sign&apos;&lt;/span&gt; did not contain a loop with signature matching types dtype(&lt;span class=&quot;code-quote&quot;&gt;&apos;bool&apos;&lt;/span&gt;) dtype(&lt;span class=&quot;code-quote&quot;&gt;&apos;bool&apos;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;These are my relevant package versions:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ conda list | grep -e numpy -e pyarrow -e pandas -e python
# packages in environment at /home/circleci/miniconda/envs/python3:
numpy                     1.16.6           py36h0a8e133_3  
numpy-base                1.16.6           py36h41b4c56_3  
pandas                    0.23.4           py36h04863e7_0  
pyarrow                   1.0.1           py36h6200943_36_cpu    conda-forge
python                    3.6.12               hcff3b4d_2    anaconda
python-dateutil           2.8.1                      py_0    anaconda
python_abi                3.6                     1_cp36m    conda-forg
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13413902">SPARK-37465</key>
            <summary>PySpark tests failing on Pandas 0.23</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yikunkero">Yikun Jiang</assignee>
                                    <reporter username="rshkv">Willi Raschkowski</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Nov 2021 17:21:34 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:34 +0000</updated>
                            <resolved>Tue, 30 Nov 2021 05:14:39 +0000</resolved>
                                    <version>3.2.0</version>
                                    <fixVersion>3.3.0</fixVersion>
                                    <component>PySpark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17449357" author="gurwls223" created="Fri, 26 Nov 2021 01:59:47 +0000"  >&lt;p&gt;Maybe we should rather bump up the minimum pandas version to 1.0.0. Would you be interested in submitting a PR? cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=XinrongM&quot; class=&quot;user-hover&quot; rel=&quot;XinrongM&quot;&gt;XinrongM&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ueshin&quot; class=&quot;user-hover&quot; rel=&quot;ueshin&quot;&gt;ueshin&lt;/a&gt; FYI&lt;/p&gt;</comment>
                            <comment id="17449358" author="gurwls223" created="Fri, 26 Nov 2021 02:00:02 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yikunkero&quot; class=&quot;user-hover&quot; rel=&quot;yikunkero&quot;&gt;yikunkero&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=itholic&quot; class=&quot;user-hover&quot; rel=&quot;itholic&quot;&gt;itholic&lt;/a&gt; FYI&lt;/p&gt;</comment>
                            <comment id="17449584" author="raschkowski" created="Fri, 26 Nov 2021 14:13:03 +0000"  >&lt;p&gt;I also noticed that &lt;tt&gt;CategoricalOpsTest&lt;/tt&gt; fails on pandas 0.25.3 (latest 0.x) and works on 1.x:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ conda list | grep pandas
pandas                    0.25.3           py36he6710b0_0
$ python/run-tests --testnames &lt;span class=&quot;code-quote&quot;&gt;&apos;pyspark.pandas.tests.data_type_ops.test_categorical_ops CategoricalOpsTest&apos;&lt;/span&gt;
...
Running tests...
----------------------------------------------------------------------
/home/circleci/project/python/pyspark/context.py:238: FutureWarning: Python 3.6 support is deprecated in Spark 3.2.
  FutureWarning
  test_abs (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (2.353s)
  test_add (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (1.382s)
  test_and (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.265s)
ok (6.569s)                                                                     alOpsTest) ... 
  test_eq (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... FAIL (1.514s)
  test_floordiv (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.910s)
  test_from_to_pandas (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.143s)
  test_ge (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... FAIL (0.795s)
  test_gt (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... FAIL (0.891s)
  test_invert (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.044s)
  test_isnull (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.097s)
  test_le (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... FAIL (0.863s)
  test_lt (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... FAIL (0.844s)
  test_mod (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.897s)
  test_mul (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.860s)
  test_ne (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... FAIL (1.405s)
  test_neg (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.044s)
  test_or (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.160s)
  test_pow (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.821s)
  test_radd (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.081s)
  test_rand (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.100s)
  test_rfloordiv (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.083s)
  test_rmod (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.050s)
  test_rmul (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.079s)
  test_ror (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.095s)
  test_rpow (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.078s)
  test_rsub (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.078s)
  test_rtruediv (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.079s)
  test_sub (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.818s)
  test_truediv (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest) ... ok (0.832s)

======================================================================
FAIL [1.611s]: test_eq (pyspark.pandas.tests.data_type_ops.test_categorical_ops.CategoricalOpsTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/circleci/project/python/pyspark/testing/pandasutils.py&quot;&lt;/span&gt;, line 122, in assertPandasEqual
    **kwargs
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/circleci/.pyenv/versions/our-miniconda/envs/python3/lib/python3.6/site-packages/pandas/util/testing.py&quot;&lt;/span&gt;, line 1248, in assert_series_equal
    assert_attr_equal(&lt;span class=&quot;code-quote&quot;&gt;&apos;name&apos;&lt;/span&gt;, left, right, obj=obj)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/circleci/.pyenv/versions/our-miniconda/envs/python3/lib/python3.6/site-packages/pandas/util/testing.py&quot;&lt;/span&gt;, line 941, in assert_attr_equal
    raise_assert_detail(obj, msg, left_attr, right_attr)
AssertionError: Series are different

Attribute &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; are different
[left]:  that_numeric_cat
[right]: None

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/circleci/project/python/pyspark/pandas/tests/data_type_ops/test_categorical_ops.py&quot;&lt;/span&gt;, line 268, in test_eq
    psdf[&lt;span class=&quot;code-quote&quot;&gt;&quot;this_numeric_cat&quot;&lt;/span&gt;] == psdf[&lt;span class=&quot;code-quote&quot;&gt;&quot;that_numeric_cat&quot;&lt;/span&gt;],
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/circleci/project/python/pyspark/testing/pandasutils.py&quot;&lt;/span&gt;, line 223, in assert_eq
    self.assertPandasEqual(lobj, robj, check_exact=check_exact)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/circleci/project/python/pyspark/testing/pandasutils.py&quot;&lt;/span&gt;, line 130, in assertPandasEqual
    raise AssertionError(msg) from e
AssertionError: Series are different

Attribute &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; are different
[left]:  that_numeric_cat
[right]: None

Left:
Name: that_numeric_cat, dtype: bool
bool

Right:
dtype: bool
bool

...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Upgrading pandas to 1.x fixes it:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ conda list | grep pandas
pandas                    1.0.0            py36h0573a6f_0  
$ python/run-tests --testnames &lt;span class=&quot;code-quote&quot;&gt;&apos;pyspark.pandas.tests.data_type_ops.test_categorical_ops CategoricalOpsTest&apos;&lt;/span&gt;
Running PySpark tests. Output is in /home/circleci/project/python/unit-tests.log
Will test against the following Python executables: [&lt;span class=&quot;code-quote&quot;&gt;&apos;python3.6&apos;&lt;/span&gt;]
Will test the following Python tests: [&lt;span class=&quot;code-quote&quot;&gt;&apos;pyspark.pandas.tests.data_type_ops.test_categorical_ops CategoricalOpsTest&apos;&lt;/span&gt;]
python3.6 python_implementation is CPython
python3.6 version is: Python 3.6.12 :: Anaconda, Inc.
Starting test(python3.6): pyspark.pandas.tests.data_type_ops.test_categorical_ops CategoricalOpsTest
Finished test(python3.6): pyspark.pandas.tests.data_type_ops.test_categorical_ops CategoricalOpsTest (34s)
Tests passed in 34 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17449619" author="raschkowski" created="Fri, 26 Nov 2021 15:35:02 +0000"  >&lt;p&gt;I&apos;ll give the pandas bump a shot.&lt;/p&gt;</comment>
                            <comment id="17449647" author="apachespark" created="Fri, 26 Nov 2021 17:19:00 +0000"  >&lt;p&gt;User &apos;rshkv&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34724&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34724&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17449711" author="apachespark" created="Sat, 27 Nov 2021 01:04:09 +0000"  >&lt;p&gt;User &apos;Yikun&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34717&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34717&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17449712" author="apachespark" created="Sat, 27 Nov 2021 01:05:27 +0000"  >&lt;p&gt;User &apos;Yikun&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34717&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34717&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17450854" author="gurwls223" created="Tue, 30 Nov 2021 05:14:39 +0000"  >&lt;p&gt;Issue resolved by pull request 34717&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34717&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34717&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13414914">SPARK-37514</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 50 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0x3l4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>