<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:15:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-29314] ProgressReporter.extractStateOperatorMetrics should not overwrite updated as 0 when it actually runs a batch even with no data</title>
                <link>https://issues.apache.org/jira/browse/SPARK-29314</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-24156&quot; title=&quot;Enable no-data micro batches for more eager streaming state clean up &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-24156&quot;&gt;&lt;del&gt;SPARK-24156&lt;/del&gt;&lt;/a&gt; brought the ability to run a batch without actual data to enable fast state cleanup as well as emit evicted outputs without waiting actual data to come.&lt;/p&gt;

&lt;p&gt;This breaks some assumption on `ProgressReporter.extractStateOperatorMetrics`. See comment in source code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// lastExecution could belong to one of the previous triggers &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; `!hasNewData`.
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// Walking the plan again should be inexpensive.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and newNumRowsUpdated is replaced to 0 if hasNewData is false. It makes sense if we copy progress from previous execution (which means no batch is run for this time), but after &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-24156&quot; title=&quot;Enable no-data micro batches for more eager streaming state clean up &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-24156&quot;&gt;&lt;del&gt;SPARK-24156&lt;/del&gt;&lt;/a&gt; the precondition is broken. &lt;/p&gt;

&lt;p&gt;Spark should still replace the value of newNumRowsUpdated with 0 if there&apos;s no batch being run and it needs to copy the old value from previous execution, but it shouldn&apos;t touch the value if it runs a batch for no data.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13259861">SPARK-29314</key>
            <summary>ProgressReporter.extractStateOperatorMetrics should not overwrite updated as 0 when it actually runs a batch even with no data</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kabhwan">Jungtaek Lim</assignee>
                                    <reporter username="kabhwan">Jungtaek Lim</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Oct 2019 09:52:35 +0000</created>
                <updated>Thu, 30 Jul 2020 05:39:01 +0000</updated>
                            <resolved>Thu, 9 Apr 2020 00:01:33 +0000</resolved>
                                    <version>2.4.4</version>
                    <version>3.0.0</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>Structured Streaming</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17078820" author="brkyvz" created="Thu, 9 Apr 2020 00:01:33 +0000"  >&lt;p&gt;Resolved by&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/25987&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/25987&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17167243" author="sandeep.katta2007" created="Wed, 29 Jul 2020 14:07:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kabhwan&quot; class=&quot;user-hover&quot; rel=&quot;kabhwan&quot;&gt;kabhwan&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brkyvz&quot; class=&quot;user-hover&quot; rel=&quot;brkyvz&quot;&gt;brkyvz&lt;/a&gt;&#160;this is required to backport to 2.4 branch&lt;/p&gt;</comment>
                            <comment id="17167642" author="kabhwan" created="Thu, 30 Jul 2020 05:31:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sandeep.katta2007&quot; class=&quot;user-hover&quot; rel=&quot;sandeep.katta2007&quot;&gt;sandeep.katta2007&lt;/a&gt;&lt;br/&gt;
Did you encounter some issue regarding to this? We also need to port back &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-31278&quot; title=&quot;numOutputRows shows value from last micro batch when there is no new data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-31278&quot;&gt;&lt;del&gt;SPARK-31278&lt;/del&gt;&lt;/a&gt; as well to port this back, so it&apos;s not trivial to do.&lt;/p&gt;</comment>
                            <comment id="17167644" author="sandeep.katta2007" created="Thu, 30 Jul 2020 05:39:01 +0000"  >&lt;p&gt;ya my bad, not required to backport&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z076rk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>