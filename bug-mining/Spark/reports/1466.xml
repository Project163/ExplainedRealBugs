<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:24:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-5968] Parquet warning in spark-shell</title>
                <link>https://issues.apache.org/jira/browse/SPARK-5968</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;This may happen in the case of schema evolving, namely appending new Parquet data with different but compatible schema to existing Parquet files:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;15/02/23 23:29:24 WARN ParquetOutputCommitter: could not write summary file &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; rankings
parquet.io.ParquetEncodingException: file:/Users/matei/workspace/apache-spark/rankings/part-r-00001.parquet invalid: all the files must be contained in the root rankings
at parquet.hadoop.ParquetFileWriter.mergeFooters(ParquetFileWriter.java:422)
at parquet.hadoop.ParquetFileWriter.writeMetadataFile(ParquetFileWriter.java:398)
at parquet.hadoop.ParquetOutputCommitter.commitJob(ParquetOutputCommitter.java:51)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The reason is that the Spark SQL schemas stored in Parquet key-value metadata differ. Parquet doesn&apos;t know how to &quot;merge&quot; these opaque user-defined metadata, and just throw an exception and give up writing summary files. Since the Parquet data source in Spark 1.3.0 supports schema merging, it&apos;s harmless.  But this is kind of scary for the user.  We should try to suppress this through the logger. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12777074">SPARK-5968</key>
            <summary>Parquet warning in spark-shell</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lian cheng">Cheng Lian</assignee>
                                    <reporter username="marmbrus">Michael Armbrust</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Feb 2015 07:35:49 +0000</created>
                <updated>Tue, 1 Dec 2015 21:35:22 +0000</updated>
                            <resolved>Tue, 24 Feb 2015 18:49:35 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14335098" author="apachespark" created="Tue, 24 Feb 2015 17:09:25 +0000"  >&lt;p&gt;User &apos;liancheng&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/4744&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/4744&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14335229" author="marmbrus" created="Tue, 24 Feb 2015 18:49:35 +0000"  >&lt;p&gt;Issue resolved by pull request 4744&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/4744&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/4744&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14996160" author="swethakasireddy" created="Mon, 9 Nov 2015 07:45:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marmbrus&quot; class=&quot;user-hover&quot; rel=&quot;marmbrus&quot;&gt;marmbrus&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;How is this issue resolved? I still see the following issue when I try to save my parquet file.&lt;/p&gt;

&lt;p&gt;Nov 8, 2015 11:35:39 PM WARNING: parquet.hadoop.ParquetOutputCommitter: could not write summary file for active_sessions_current &lt;br/&gt;
parquet.io.ParquetEncodingException: maprfs:/user/testId/active_sessions_current/part-r-00142.parquet invalid: all the files must be contained in the root active_sessions_current &lt;br/&gt;
        at parquet.hadoop.ParquetFileWriter.mergeFooters(ParquetFileWriter.java:422) &lt;br/&gt;
        at parquet.hadoop.ParquetFileWriter.writeMetadataFile(ParquetFileWriter.java:398) &lt;br/&gt;
        at parquet.hadoop.ParquetOutputCommitter.commitJob(ParquetOutputCommitter.java:51) &lt;br/&gt;
        at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsNewAPIHadoopDataset$1.apply$mcV$sp(PairRDDFunctions.scala:1056) &lt;br/&gt;
        at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsNewAPIHadoopDataset$1.apply(PairRDDFunctions.scala:998)&lt;/p&gt;</comment>
                            <comment id="15000200" author="lian cheng" created="Wed, 11 Nov 2015 10:32:40 +0000"  >&lt;p&gt;It had once been fixed via a quite hacky trick. Unfortunately it came back again after upgrading to parquet-mr 1.7.0, and there doesn&apos;t seem to be a reliable way to override the log settings because of &lt;a href=&quot;https://issues.apache.org/jira/browse/PARQUET-369&quot; title=&quot;Shading SLF4J prevents SLF4J locating org.slf4j.impl.StaticLoggerBinder&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PARQUET-369&quot;&gt;&lt;del&gt;PARQUET-369&lt;/del&gt;&lt;/a&gt;, which prevents users or other libraries to redirect Parquet JUL logger via SLF4J. It&apos;s fixed in the most recent parquet-format master, but I&apos;m afraid we have to wait for another parquet-format and parquet-mr release to fix this issue completely.&lt;/p&gt;</comment>
                            <comment id="15001294" author="swethakasireddy" created="Wed, 11 Nov 2015 23:00:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lian+cheng&quot; class=&quot;user-hover&quot; rel=&quot;lian cheng&quot;&gt;lian cheng&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Is this just a logger issue or would it have any potential impact on the functionality?&lt;/p&gt;</comment>
                            <comment id="15001885" author="lian cheng" created="Thu, 12 Nov 2015 09:26:20 +0000"  >&lt;p&gt;As explained in the JIRA description, this issue shouldn&apos;t affect functionality.&lt;/p&gt;</comment>
                            <comment id="15034624" author="swethakasireddy" created="Tue, 1 Dec 2015 21:35:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lian+cheng&quot; class=&quot;user-hover&quot; rel=&quot;lian cheng&quot;&gt;lian cheng&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Following are the dependencies and the versions that I am using. I want to know if using a different version would be of any help to fix this.  I see this error in my Spark Batch Job when I save the Parquet files to hdfs.&lt;/p&gt;

&lt;p&gt;        &amp;lt;sparkVersion&amp;gt;1.5.2&amp;lt;/sparkVersion&amp;gt;&lt;br/&gt;
        &amp;lt;avro.version&amp;gt;1.7.7&amp;lt;/avro.version&amp;gt;&lt;br/&gt;
        &amp;lt;parquet.version&amp;gt;1.4.3&amp;lt;/parquet.version&amp;gt;&lt;/p&gt;

&lt;p&gt;        &amp;lt;dependency&amp;gt;&lt;br/&gt;
            &amp;lt;groupId&amp;gt;org.apache.spark&amp;lt;/groupId&amp;gt;&lt;br/&gt;
            &amp;lt;artifactId&amp;gt;spark-core_2.10&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
            &amp;lt;version&amp;gt;${sparkVersion}&amp;lt;/version&amp;gt;&lt;br/&gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;&lt;br/&gt;
        &amp;lt;/dependency&amp;gt;&lt;/p&gt;


&lt;p&gt;        &amp;lt;dependency&amp;gt;&lt;br/&gt;
            &amp;lt;groupId&amp;gt;org.apache.avro&amp;lt;/groupId&amp;gt;&lt;br/&gt;
            &amp;lt;artifactId&amp;gt;avro&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
            &amp;lt;version&amp;gt;${avro.version}&amp;lt;/version&amp;gt;&lt;br/&gt;
        &amp;lt;/dependency&amp;gt;&lt;/p&gt;

&lt;p&gt;        &amp;lt;dependency&amp;gt;&lt;br/&gt;
            &amp;lt;groupId&amp;gt;com.twitter&amp;lt;/groupId&amp;gt;&lt;br/&gt;
            &amp;lt;artifactId&amp;gt;parquet-avro&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
            &amp;lt;version&amp;gt;1.6.0rc7&amp;lt;/version&amp;gt;&lt;br/&gt;
        &amp;lt;/dependency&amp;gt;&lt;/p&gt;

&lt;p&gt;        &amp;lt;dependency&amp;gt;&lt;br/&gt;
            &amp;lt;groupId&amp;gt;com.twitter&amp;lt;/groupId&amp;gt;&lt;br/&gt;
            &amp;lt;artifactId&amp;gt;parquet-hadoop&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
            &amp;lt;version&amp;gt;1.6.0rc7&amp;lt;/version&amp;gt;&lt;br/&gt;
        &amp;lt;/dependency&amp;gt;&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i25ypj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327642">1.3.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>