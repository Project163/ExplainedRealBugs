<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:36:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-11497] PySpark RowMatrix Constructor Has Type Erasure Issue</title>
                <link>https://issues.apache.org/jira/browse/SPARK-11497</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Implementing tallSkinnyQR in &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-9656&quot; title=&quot;Add missing methods to linalg.distributed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-9656&quot;&gt;&lt;del&gt;SPARK-9656&lt;/del&gt;&lt;/a&gt; uncovered a bug with our PySpark RowMatrix constructor. As discussed on the dev list &lt;a href=&quot;http://apache-spark-developers-list.1001551.n3.nabble.com/K-Means-And-Class-Tags-td10038.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;, there appears to be an issue with type erasure with RDDs coming from Java, and by extension from PySpark. Although we are attempting to construct a RowMatrix from an RDD&lt;span class=&quot;error&quot;&gt;&amp;#91;Vector&amp;#93;&lt;/span&gt; in &lt;a href=&quot;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/mllib/api/python/PythonMLLibAPI.scala#L1115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PythonMLlibAPI&lt;/a&gt;, the Vector type is erased, resulting in an RDD&lt;span class=&quot;error&quot;&gt;&amp;#91;Object&amp;#93;&lt;/span&gt;. Thus, when calling Scala&apos;s tallSkinnyQR from PySpark, we get a Java ClassCastException in which an Object cannot be cast to a Spark Vector. As noted in the aforementioned dev list thread, this issue was also encountered with DecisionTrees, and the fix involved an explicit retag of the RDD with a Vector type. Thus, this PR will apply that fix to the createRowMatrix helper function in PythonMLlibAPI. IndexedRowMatrix and CoordinateMatrix do not appear to have this issue likely due to their related helper functions in PythonMLlibAPI creating the RDDs explicitly from DataFrames with pattern matching, thus preserving the types. &lt;/p&gt;

&lt;p&gt;The following reproduces this issue on the latest Git head, 1.5.1, and 1.5.0:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;from pyspark.mllib.linalg.distributed &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; RowMatrix
rows = sc.parallelize([[3, -6], [4, -8], [0, 1]])
mat = RowMatrix(rows)
mat._java_matrix_wrapper.call(&lt;span class=&quot;code-quote&quot;&gt;&quot;tallSkinnyQR&quot;&lt;/span&gt;, True)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Should result in the following exception:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.ClassCastException: [Ljava.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;; cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to [Lorg.apache.spark.mllib.linalg.Vector;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12910226">SPARK-11497</key>
            <summary>PySpark RowMatrix Constructor Has Type Erasure Issue</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dusenberrymw">Mike Dusenberry</assignee>
                                    <reporter username="dusenberrymw">Mike Dusenberry</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Nov 2015 02:18:29 +0000</created>
                <updated>Mon, 4 Jul 2016 22:54:03 +0000</updated>
                            <resolved>Fri, 11 Dec 2015 22:23:11 +0000</resolved>
                                    <version>1.5.0</version>
                    <version>1.5.1</version>
                    <version>1.6.0</version>
                                    <fixVersion>1.5.3</fixVersion>
                    <fixVersion>1.6.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>MLlib</component>
                    <component>PySpark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14988774" author="apachespark" created="Wed, 4 Nov 2015 02:39:03 +0000"  >&lt;p&gt;User &apos;dusenberrymw&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9458&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9458&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14992923" author="josephkb" created="Fri, 6 Nov 2015 01:54:13 +0000"  >&lt;p&gt;Can you please paste code which reproduces this problem here?&lt;/p&gt;

&lt;p&gt;Also, what version of Spark were you using?&lt;/p&gt;</comment>
                            <comment id="14994183" author="mwdusenb@us.ibm.com" created="Fri, 6 Nov 2015 18:43:14 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=josephkb&quot; class=&quot;user-hover&quot; rel=&quot;josephkb&quot;&gt;josephkb&lt;/a&gt;.  The following will reproduce this issue on the latest Git head, 1.5.1, and 1.5.0.  This came up as I was adding the PySpark wrapper for tallSkinnyQR in the PR for &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-9656&quot; title=&quot;Add missing methods to linalg.distributed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-9656&quot;&gt;&lt;del&gt;SPARK-9656&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;from pyspark.mllib.linalg.distributed &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; RowMatrix
rows = sc.parallelize([[3, -6], [4, -8], [0, 1]])
mat = RowMatrix(rows)
mat._java_matrix_wrapper.call(&lt;span class=&quot;code-quote&quot;&gt;&quot;tallSkinnyQR&quot;&lt;/span&gt;, True)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Should result in the following exception:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.ClassCastException: [Ljava.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;; cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to [Lorg.apache.spark.mllib.linalg.Vector;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14995373" author="josephkb" created="Sat, 7 Nov 2015 19:39:08 +0000"  >&lt;p&gt;Oh, I see, I&apos;d forgotten about that discussion!  Since this is a quick fix, I&apos;ll target it at 1.5, 1.6, and master.&lt;/p&gt;</comment>
                            <comment id="14995420" author="josephkb" created="Sat, 7 Nov 2015 21:51:42 +0000"  >&lt;p&gt;Correction: Does this affect any functionality in current versions of Spark?  Or is this only an issue with your wrapper for tallSkinnyQR?&lt;/p&gt;

&lt;p&gt;I&apos;m asking because I can still call things like computePrincipalComponents without this fix.  I can&apos;t call tallSkinnyQR, but that&apos;s also because of its return type not being converted to a Python object.&lt;/p&gt;

&lt;p&gt;Do you have an example of current functionality which is not available?  If not, I might ask that we postpone this for 1.7 (unless it&apos;s needed for something targeted for 1.6).&lt;/p&gt;</comment>
                            <comment id="14995990" author="mwdusenb@us.ibm.com" created="Mon, 9 Nov 2015 03:42:24 +0000"  >&lt;p&gt;So far, I&apos;ve only encountered it as an issue with the tallSkinnyQR wrapper.  We can just postpone this fix and the wrapper for 1.7.&lt;/p&gt;</comment>
                            <comment id="15053683" author="josephkb" created="Fri, 11 Dec 2015 22:23:11 +0000"  >&lt;p&gt;Issue resolved by pull request 9458&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9458&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9458&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12852384">SPARK-9656</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12986684">SPARK-16372</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 49 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2nx3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311620" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Shepherd</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>josephkb</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333969">1.5.3</customfieldvalue>
    <customfieldvalue id="12334009">1.6.1</customfieldvalue>
    <customfieldvalue id="12329449">2.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>