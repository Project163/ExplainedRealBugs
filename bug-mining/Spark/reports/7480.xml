<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:19:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-32898] totalExecutorRunTimeMs is too big</title>
                <link>https://issues.apache.org/jira/browse/SPARK-32898</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;This might be because of incorrectly calculating executorRunTimeMs in Executor.scala&lt;br/&gt;
 The function collectAccumulatorsAndResetStatusOnFailure(taskStartTimeNs) can be called when taskStartTimeNs is not set yet (it is 0).&lt;/p&gt;

&lt;p&gt;As of now in master branch, here is the problematic code:&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/executor/Executor.scala#L470&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/executor/Executor.scala#L470&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;There is a throw exception before this line. The catch branch still updates the metric.&lt;br/&gt;
 However the query shows as SUCCESSful. Maybe this task is speculative. Not sure.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;submissionTime in&#160;LiveExecutionData may also have similar problem.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/ui/SQLAppStatusListener.scala#L449&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/ui/SQLAppStatusListener.scala#L449&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13327787">SPARK-32898</key>
            <summary>totalExecutorRunTimeMs is too big</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Ngone51">wuyi</assignee>
                                    <reporter username="linhongliu-db">Linhong Liu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Sep 2020 05:18:33 +0000</created>
                <updated>Tue, 22 Sep 2020 06:20:55 +0000</updated>
                            <resolved>Fri, 18 Sep 2020 21:06:50 +0000</resolved>
                                    <version>2.4.7</version>
                    <version>3.0.1</version>
                                    <fixVersion>2.4.8</fixVersion>
                    <fixVersion>3.0.2</fixVersion>
                    <fixVersion>3.1.0</fixVersion>
                                    <component>Spark Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17196972" author="tgraves" created="Wed, 16 Sep 2020 13:25:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=linhongliu-db&quot; class=&quot;user-hover&quot; rel=&quot;linhongliu-db&quot;&gt;linhongliu-db&lt;/a&gt;&#160;can you please provide more of a description. You say this was too big, did it cause an error for your job or you just noticed the time was to big? &#160;Do you have a reproducible case?&lt;/p&gt;

&lt;p&gt;You have some details there about what might be wrong with&#160; taskStartTimeNs possibly not initialized, if you can give more details there in generally that would be great as its a bit hard to follow your description. &#160;If you have spent the time to debug you and have a fix in mind please feel free to put up a pull request.&lt;/p&gt;</comment>
                            <comment id="17197341" author="ngone51" created="Thu, 17 Sep 2020 03:17:52 +0000"  >&lt;p&gt;I think the issue is(for executorRunTimeMs): Before a task reaches to &quot;taskStartTimeNs = System.nanoTime()&quot;, it might be already killed(e.g., by another successful attempt).&#160; So,&#160;taskStartTimeNs can not get initialized and remains 0. However, the&#160;executorRunTimeMs is calculated by &quot;System.nanoTime() - taskStartTimeNs&quot; in collectAccumulatorsAndResetStatusOnFailure, which is obviously a wrong big result when&#160;taskStartTimeNs = 0.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I haven&apos;t taken a detail look for the&#160;submissionTime, but it sounds like it&apos;s a different issue? Though, it may be due to the same logic hole.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I&apos;d like to make a fix for the&#160;executorRunTimeMs first if &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=linhongliu-db&quot; class=&quot;user-hover&quot; rel=&quot;linhongliu-db&quot;&gt;linhongliu-db&lt;/a&gt;&#160;doesn&apos;t mind.&lt;/p&gt;</comment>
                            <comment id="17197762" author="apachespark" created="Thu, 17 Sep 2020 15:34:25 +0000"  >&lt;p&gt;User &apos;Ngone51&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/29789&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/29789&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17197763" author="apachespark" created="Thu, 17 Sep 2020 15:35:51 +0000"  >&lt;p&gt;User &apos;Ngone51&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/29789&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/29789&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17199840" author="apachespark" created="Tue, 22 Sep 2020 06:05:38 +0000"  >&lt;p&gt;User &apos;Ngone51&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/29832&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/29832&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 8 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0in2g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>