<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:28:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-37678] Incorrect annotations in SeriesGroupBy._cleanup_and_return </title>
                <link>https://issues.apache.org/jira/browse/SPARK-37678</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/spark/blob/02ee1ae10b938eaa1621c3e878d07c39b9887c2e/python/pyspark/pandas/groupby.py#L2997-L2998&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;SeriesGroupBy._cleanup_and_return&lt;/tt&gt;&lt;/a&gt; annotations&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-python&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; _cleanup_and_return(&lt;span class=&quot;code-keyword&quot;&gt;self&lt;/span&gt;, pdf: pd.DataFrame) -&amp;gt; Series:
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; first_series(pdf).rename().rename(&lt;span class=&quot;code-keyword&quot;&gt;self&lt;/span&gt;._psser.name)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;are inconsistent:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;If &lt;tt&gt;pdf&lt;/tt&gt; is &lt;tt&gt;pd.DataFrame&lt;/tt&gt; then output should be &lt;tt&gt;pd.Series&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;If output is &lt;tt&gt;ps.Series&lt;/tt&gt; then &lt;tt&gt;pdf&lt;/tt&gt; should be &lt;tt&gt;ps.DataFrame&lt;/tt&gt;.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Doesn&apos;t seem like the method is used (it is possible that my search skills and PyCharm inspection failed), so I am not sure which of these options was intended.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13418294">SPARK-37678</key>
            <summary>Incorrect annotations in SeriesGroupBy._cleanup_and_return </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zero323">Maciej Szymkiewicz</assignee>
                                    <reporter username="zero323">Maciej Szymkiewicz</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Dec 2021 18:33:20 +0000</created>
                <updated>Mon, 20 Dec 2021 22:18:13 +0000</updated>
                            <resolved>Mon, 20 Dec 2021 22:18:13 +0000</resolved>
                                    <version>3.3.0</version>
                                    <fixVersion>3.2.1</fixVersion>
                    <fixVersion>3.3.0</fixVersion>
                                    <component>PySpark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17461609" author="zero323" created="Fri, 17 Dec 2021 18:34:16 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ueshin&quot; class=&quot;user-hover&quot; rel=&quot;ueshin&quot;&gt;ueshin&lt;/a&gt; Do you have any thoughts on this one by any chance?&lt;/p&gt;</comment>
                            <comment id="17461677" author="ueshin" created="Fri, 17 Dec 2021 21:25:50 +0000"  >&lt;p&gt;Good catch!&lt;br/&gt;
It must be &lt;tt&gt;_cleanup_and_return(self, psdf: DataFrame) -&amp;gt; Series&lt;/tt&gt;. (not &lt;tt&gt;pd.&lt;/tt&gt;)&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;Doesn&apos;t seem like the method is used&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;It&apos;s an actual implementation of an abstract method &lt;tt&gt;GroupBy._cleanup_and_return&lt;/tt&gt; for &lt;tt&gt;SeriesGroupBy&lt;/tt&gt;.&lt;br/&gt;
&lt;tt&gt;GroupBy._cleanup_and_return&lt;/tt&gt; is called at many places in &lt;tt&gt;GroupBy&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17461679" author="zero323" created="Fri, 17 Dec 2021 21:34:25 +0000"  >&lt;p&gt;&lt;cite&gt;It&apos;s an actual implementation of an abstract method &lt;tt&gt;GroupBy._cleanup_and_return&lt;/tt&gt; for &lt;tt&gt;SeriesGroupBy&lt;/tt&gt;.&lt;/cite&gt;????&lt;/p&gt;

&lt;p&gt;Yeah, my brain must be scrambled at this point.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;So that&apos;s basically &lt;tt&gt;ps.DataFrame -&amp;gt; ps.Series&lt;/tt&gt;, right?&lt;/p&gt;</comment>
                            <comment id="17461681" author="ueshin" created="Fri, 17 Dec 2021 21:39:52 +0000"  >&lt;p&gt;Yes!&lt;/p&gt;</comment>
                            <comment id="17462033" author="apachespark" created="Sat, 18 Dec 2021 23:10:34 +0000"  >&lt;p&gt;User &apos;zero323&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34950&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34950&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17462034" author="apachespark" created="Sat, 18 Dec 2021 23:11:26 +0000"  >&lt;p&gt;User &apos;zero323&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34950&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34950&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17462852" author="ueshin" created="Mon, 20 Dec 2021 22:18:13 +0000"  >&lt;p&gt;Issue resolved by pull request 34950&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34950&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34950&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 47 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0xu68:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>