<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:21:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-33841] Jobs disappear intermittently from the SHS under high load</title>
                <link>https://issues.apache.org/jira/browse/SPARK-33841</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Ran into an issue when a particular job was displayed in the SHS and disappeared after some time, but then, in several minutes showed up again.&lt;/p&gt;

&lt;p&gt;The issue is caused by&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-29043&quot; title=&quot;[History Server]Only one replay thread of FsHistoryProvider work because of straggler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-29043&quot;&gt;&lt;del&gt;SPARK-29043&lt;/del&gt;&lt;/a&gt;, which is designated to improve the concurrent performance of the History Server. The&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/25797/files#&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;change&lt;/a&gt;&#160;breaks the&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/25797/files#diff-128a6af0d78f4a6180774faedb335d6168dfc4defff58f5aa3021fc1bd767bc0R563&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&quot;app deletion&quot; logic&lt;/a&gt;&#160;because of missing proper synchronization for&#160;&lt;tt&gt;processing&lt;/tt&gt;&#160;event log entries. Since SHS now&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/25797/files#diff-128a6af0d78f4a6180774faedb335d6168dfc4defff58f5aa3021fc1bd767bc0R462&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;filters out&lt;/a&gt;&#160;all&#160;&lt;tt&gt;processing&lt;/tt&gt;&#160;event log entries, such entries do not have a chance to be&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/25797/files#diff-128a6af0d78f4a6180774faedb335d6168dfc4defff58f5aa3021fc1bd767bc0R472&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;updated with the new&#160;&lt;tt&gt;lastProcessed&lt;/tt&gt;&lt;/a&gt;&#160;time and thus any entity that completes processing right after&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/25797/files#diff-128a6af0d78f4a6180774faedb335d6168dfc4defff58f5aa3021fc1bd767bc0R462&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;filtering&lt;/a&gt;&#160;and before&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/25797/files#diff-128a6af0d78f4a6180774faedb335d6168dfc4defff58f5aa3021fc1bd767bc0R560&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;the check for stale entities&lt;/a&gt;&#160;will be identified as stale and will be deleted from the UI until the next&#160;&lt;tt&gt;checkForLogs&lt;/tt&gt;&#160;run. This is because&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/25797/files#diff-128a6af0d78f4a6180774faedb335d6168dfc4defff58f5aa3021fc1bd767bc0R557&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;updated&#160;&lt;tt&gt;lastProcessed&lt;/tt&gt;&#160;time is used as criteria&lt;/a&gt;, and event log entries that missed to be updated with a new time, will match that criteria.&lt;/p&gt;

&lt;p&gt;The issue can be reproduced by generating a big number of event logs and uploading them to the SHS event log directory on S3. Essentially, around 800(82.6 MB) copies of an event log file were created using&#160;&lt;a href=&quot;https://github.com/vladhlinsky/shs-monitor&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;shs-monitor&lt;/a&gt;&#160;script. Strange behavior of SHS counting the total number of applications was noticed - at first, the number was increasing as expected, but with the next page refresh, the total number of applications decreased. No errors were logged by SHS.&lt;/p&gt;</description>
                <environment>&lt;p&gt;SHS is running locally on&#160;Ubuntu&#160;19.04&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</environment>
        <key id="13346790">SPARK-33841</key>
            <summary>Jobs disappear intermittently from the SHS under high load</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vladglinskiy">Vladislav Glinskiy</assignee>
                                    <reporter username="vladglinskiy">Vladislav Glinskiy</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Dec 2020 13:01:34 +0000</created>
                <updated>Fri, 18 Dec 2020 23:20:05 +0000</updated>
                            <resolved>Fri, 18 Dec 2020 21:27:20 +0000</resolved>
                                    <version>3.0.0</version>
                    <version>3.0.1</version>
                    <version>3.1.0</version>
                    <version>3.2.0</version>
                                    <fixVersion>3.0.2</fixVersion>
                    <fixVersion>3.1.0</fixVersion>
                    <fixVersion>3.2.0</fixVersion>
                                    <component>Spark Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17251750" author="apachespark" created="Fri, 18 Dec 2020 13:07:20 +0000"  >&lt;p&gt;User &apos;vladhlinsky&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/30842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/30842&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17251751" author="vladglinskiy" created="Fri, 18 Dec 2020 13:07:54 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kabhwan&quot; class=&quot;user-hover&quot; rel=&quot;kabhwan&quot;&gt;kabhwan&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17251932" author="dongjoon" created="Fri, 18 Dec 2020 18:31:24 +0000"  >&lt;p&gt;Thank you for filing a JIRA, but I removed the target version here, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vladglinskiy&quot; class=&quot;user-hover&quot; rel=&quot;vladglinskiy&quot;&gt;vladglinskiy&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17251940" author="apachespark" created="Fri, 18 Dec 2020 18:51:42 +0000"  >&lt;p&gt;User &apos;vladhlinsky&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/30845&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/30845&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17251968" author="vladglinskiy" created="Fri, 18 Dec 2020 19:42:01 +0000"  >&lt;p&gt;Ok, thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="17251969" author="apachespark" created="Fri, 18 Dec 2020 19:42:51 +0000"  >&lt;p&gt;User &apos;vladhlinsky&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/30847&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/30847&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17252015" author="dongjoon" created="Fri, 18 Dec 2020 21:27:20 +0000"  >&lt;p&gt;Issue resolved by pull request 30845&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/30845&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/30845&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 47 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ln94:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>