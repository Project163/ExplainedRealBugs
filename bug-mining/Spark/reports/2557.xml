<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:33:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-10981] R semijoin leads to Java errors, R leftsemi leads to Spark errors</title>
                <link>https://issues.apache.org/jira/browse/SPARK-10981</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I am using SparkR from RStudio, and I ran into an error with the join function that I recreated with a smaller example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;joinTest.R&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Sys.setenv(SPARK_HOME=&lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/liumo1/Applications/spark/&quot;&lt;/span&gt;)
.libPaths(c(file.path(Sys.getenv(&lt;span class=&quot;code-quote&quot;&gt;&quot;SPARK_HOME&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;R&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;lib&quot;&lt;/span&gt;), .libPaths()))
library(SparkR)
sc &amp;lt;- sparkR.init(&lt;span class=&quot;code-quote&quot;&gt;&quot;local[4]&quot;&lt;/span&gt;)
sqlContext &amp;lt;- sparkRSQL.init(sc) 

n = c(2, 3, 5)
s = c(&lt;span class=&quot;code-quote&quot;&gt;&quot;aa&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;bb&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;cc&quot;&lt;/span&gt;)
b = c(TRUE, FALSE, TRUE)
df = data.frame(n, s, b)
df1= createDataFrame(sqlContext, df)
showDF(df1)

x = c(2, 3, 10)
t = c(&lt;span class=&quot;code-quote&quot;&gt;&quot;dd&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;ee&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;ff&quot;&lt;/span&gt;)
c = c(FALSE, FALSE, TRUE)
dff = data.frame(x, t, c)
df2 = createDataFrame(sqlContext, dff)
showDF(df2)
res = join(df1, df2, df1$n == df2$x, &lt;span class=&quot;code-quote&quot;&gt;&quot;semijoin&quot;&lt;/span&gt;)
showDF(res)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Running this code, I encountered the error:&lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;Error in invokeJava(isStatic = FALSE, objId$id, methodName, ...) : &lt;br/&gt;
  java.lang.IllegalArgumentException: Unsupported join type &apos;semijoin&apos;. Supported join types include: &apos;inner&apos;, &apos;outer&apos;, &apos;full&apos;, &apos;fullouter&apos;, &apos;leftouter&apos;, &apos;left&apos;, &apos;rightouter&apos;, &apos;right&apos;, &apos;leftsemi&apos;.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, if I changed the joinType to &quot;leftsemi&quot;, &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;res = join(df1, df2, df1$n == df2$x, &lt;span class=&quot;code-quote&quot;&gt;&quot;leftsemi&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I would get the error:&lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;Error in .local(x, y, ...) : &lt;br/&gt;
  joinType must be one of the following types: &apos;inner&apos;, &apos;outer&apos;, &apos;left_outer&apos;, &apos;right_outer&apos;, &apos;semijoin&apos;&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since the join function in R appears to invoke a Java method, I went into DataFrame.R and changed the code on line 1374 and line 1378 to change the &quot;semijoin&quot; to &quot;leftsemi&quot; to match the Java function&apos;s parameters. These also make the R joinType accepted values match those of Scala&apos;s. &lt;/p&gt;

&lt;p&gt;semijoin:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;DataFrame.R: join(x, y, joinExpr, joinType)&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (joinType %in% c(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;left_outer&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;right_outer&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;semijoin&quot;&lt;/span&gt;)) {
    sdf &amp;lt;- callJMethod(x@sdf, &lt;span class=&quot;code-quote&quot;&gt;&quot;join&quot;&lt;/span&gt;, y@sdf, joinExpr@jc, joinType)
} 
&lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
     stop(&lt;span class=&quot;code-quote&quot;&gt;&quot;joinType must be one of the following types: &quot;&lt;/span&gt;,
             &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;left_outer&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;right_outer&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;semijoin&apos;&lt;/span&gt;&quot;&lt;/span&gt;)
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;leftsemi:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;DataFrame.R: join(x, y, joinExpr, joinType)&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (joinType %in% c(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;left_outer&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;right_outer&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;leftsemi&quot;&lt;/span&gt;)) {
    sdf &amp;lt;- callJMethod(x@sdf, &lt;span class=&quot;code-quote&quot;&gt;&quot;join&quot;&lt;/span&gt;, y@sdf, joinExpr@jc, joinType)
} 
&lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
     stop(&lt;span class=&quot;code-quote&quot;&gt;&quot;joinType must be one of the following types: &quot;&lt;/span&gt;,
             &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;left_outer&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;right_outer&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;leftsemi&apos;&lt;/span&gt;&quot;&lt;/span&gt;)
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This fixed the issue, but I&apos;m not sure if this solution breaks hive compatibility or causes other issues, but I can submit a pull request to change this&lt;/p&gt;</description>
                <environment>&lt;p&gt;SparkR from RStudio on Macbook&lt;/p&gt;</environment>
        <key id="12903116">SPARK-10981</key>
            <summary>R semijoin leads to Java errors, R leftsemi leads to Spark errors</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mfliu">Monica Liu</assignee>
                                    <reporter username="mfliu">Monica Liu</reporter>
                        <labels>
                            <label>easyfix</label>
                            <label>newbie</label>
                    </labels>
                <created>Wed, 7 Oct 2015 20:19:59 +0000</created>
                <updated>Tue, 29 Dec 2015 09:10:44 +0000</updated>
                            <resolved>Wed, 14 Oct 2015 05:26:39 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>1.5.2</fixVersion>
                    <fixVersion>1.6.0</fixVersion>
                                    <component>SparkR</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14948299" author="sunrui" created="Thu, 8 Oct 2015 08:47:33 +0000"  >&lt;p&gt;yes, this is a bug in SparkR. your fix looks good. Could you submit a PR for this?&lt;/p&gt;

&lt;p&gt;In the PR, please:&lt;br/&gt;
1. Support all join types defined in sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/plans/joinTypes.scala (You can remove the &quot;_&quot; char from the currently supported join types in SparkR)&lt;/p&gt;

&lt;p&gt;2. Add test cases for missing join types including &quot;leftsemi&quot;&lt;/p&gt;</comment>
                            <comment id="14949115" author="mfliu" created="Thu, 8 Oct 2015 18:37:08 +0000"  >&lt;p&gt;I submitted a pull request with the changes above. I ran into issues with collect() and orderBy() from the files I cloned from github, namely issues with do.call(c, col) in collect(), so I used the DataFrame.R and test_sparkSQL.R files from Spark-1.5.1, which seemed to fix the issue. &lt;/p&gt;</comment>
                            <comment id="14949129" author="apachespark" created="Thu, 8 Oct 2015 18:44:03 +0000"  >&lt;p&gt;User &apos;mfliu&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9029&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14956301" author="shivaram" created="Wed, 14 Oct 2015 05:26:39 +0000"  >&lt;p&gt;Resolved by &lt;a href=&quot;https://github.com/apache/spark/pull/9029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9029&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 5 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mpl3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>