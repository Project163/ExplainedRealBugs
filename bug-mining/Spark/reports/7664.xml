<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:22:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-33888] JDBC SQL TIME type represents incorrectly as TimestampType, it should be physical Int in millis</title>
                <link>https://issues.apache.org/jira/browse/SPARK-33888</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Currently, for JDBC, SQL TIME type represents incorrectly as Spark TimestampType. This should be represent as physical int in millis Represents a time of day, with no reference to a particular calendar, time zone or date, with a precision of one millisecond. It stores the number of milliseconds after midnight, 00:00:00.000.&lt;/p&gt;

&lt;p&gt;We encountered the issue of Avro logical type of `TimeMillis` not being converted correctly to Spark `Timestamp` struct type using the `SchemaConverters`, but it converts to regular `int` instead. Reproducible by ingest data from MySQL table with a column of TIME type: Spark JDBC dataframe will get the correct type (Timestamp), but enforcing our avro schema (`&lt;/p&gt;
{&quot;type&quot;: &quot;int&quot;,&quot; logicalType&quot;: &quot;time-millis&quot;}
&lt;p&gt;`) externally will fail to apply with the following exception:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;java.lang.RuntimeException: java.sql.Timestamp is not a valid external type for schema of int&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13347503">SPARK-33888</key>
            <summary>JDBC SQL TIME type represents incorrectly as TimestampType, it should be physical Int in millis</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="idyllictux">Duc Hoa Nguyen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Dec 2020 06:53:50 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:34 +0000</updated>
                            <resolved>Mon, 13 Sep 2021 15:10:40 +0000</resolved>
                                    <version>2.4.3</version>
                    <version>3.0.0</version>
                    <version>3.0.1</version>
                                    <fixVersion>3.2.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17253929" author="gurwls223" created="Wed, 23 Dec 2020 07:22:14 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gengliang.Wang&quot; class=&quot;user-hover&quot; rel=&quot;Gengliang.Wang&quot;&gt;Gengliang.Wang&lt;/a&gt; FYI&lt;/p&gt;</comment>
                            <comment id="17253933" author="apachespark" created="Wed, 23 Dec 2020 07:31:03 +0000"  >&lt;p&gt;User &apos;saikocat&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/30902&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/30902&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17253936" author="idyllictux" created="Wed, 23 Dec 2020 07:34:47 +0000"  >&lt;p&gt;I&apos;m making a PR for this at &lt;a href=&quot;https://github.com/apache/spark/pull/30902&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/30902&lt;/a&gt; . Let me figure out the adding test part then I can submit for review.&lt;/p&gt;</comment>
                            <comment id="17253961" author="gengliang.wang" created="Wed, 23 Dec 2020 08:59:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=idyllictux&quot; class=&quot;user-hover&quot; rel=&quot;idyllictux&quot;&gt;idyllictux&lt;/a&gt; I think it&apos;s a missing feature instead of a bug.&lt;br/&gt;
See my comments in &lt;a href=&quot;https://github.com/apache/spark/pull/30902#issuecomment-750019909&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/30902#issuecomment-750019909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17257370" author="idyllictux" created="Sat, 2 Jan 2021 13:31:02 +0000"  >&lt;p&gt;Seems like the PR is accepted. Anything else that is needed before this can be merged?&lt;/p&gt;</comment>
                            <comment id="17258016" author="cloud_fan" created="Mon, 4 Jan 2021 06:53:33 +0000"  >&lt;p&gt;Issue resolved by pull request 30902&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/30902&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/30902&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17267575" author="stephenk" created="Tue, 19 Jan 2021 00:03:50 +0000"  >&lt;p&gt;The change introduces a bug wrt Postgres loading of numeric array types:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/spark/blob/f284218dae23bf91e72e221943188cdb85e13dac/sql/core/src/main/scala/org/apache/spark/sql/jdbc/PostgresDialect.scala#L43&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/f284218dae23bf91e72e221943188cdb85e13dac/sql/core/src/main/scala/org/apache/spark/sql/jdbc/PostgresDialect.scala#L43&lt;/a&gt; wants to load the scale metadata for the ARRAY type, but &lt;br/&gt;
 &lt;a href=&quot;https://github.com/apache/spark/commit/0b647fe69cf201b4dcbc0f4dfc0eb504a523571d#diff-c3859e97335ead4b131263565c987d877bea0af3adbd6c5bf2d3716768d2e083L306&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/0b647fe69cf201b4dcbc0f4dfc0eb504a523571d#diff-c3859e97335ead4b131263565c987d877bea0af3adbd6c5bf2d3716768d2e083L306&lt;/a&gt; removes &quot;scale&quot; as default metadata in favour of specifying the exact types that support it.&lt;/p&gt;

&lt;p&gt;I think I agree with the intent of this change (to be specific about what types support which metadata), but should be amended.&lt;/p&gt;

&lt;p&gt;I&apos;ve built with some changes that I&apos;ve manually verified as working: &lt;a href=&quot;https://github.com/apache/spark/compare/master...skestle:SPARK-33888-postgres-fix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/compare/master...skestle:SPARK-33888-postgres-fix&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17267698" author="cloud_fan" created="Tue, 19 Jan 2021 07:03:37 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stephenk&quot; class=&quot;user-hover&quot; rel=&quot;stephenk&quot;&gt;stephenk&lt;/a&gt;&#160;, thanks for reporting this issue! Your patch looks good, can you submit a PR for it? I&apos;m also wondering if there are more cases like map and struct type that needs the scale field.&lt;/p&gt;</comment>
                            <comment id="17268285" author="stephenk" created="Tue, 19 Jan 2021 23:56:48 +0000"  >&lt;p&gt;I&apos;ve searched for &quot;scale&quot; and only Oracle seems to use it (although it defaults to 0 if not present).&lt;/p&gt;

&lt;p&gt;The tests however define it for other number types (SMALL_INT etc) - which should have defined scale etc:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/spark/blob/master/sql/core/src/test/scala/org/apache/spark/sql/jdbc/JDBCSuite.scala#L901&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/sql/core/src/test/scala/org/apache/spark/sql/jdbc/JDBCSuite.scala#L901&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/spark/blob/master/sql/core/src/test/scala/org/apache/spark/sql/jdbc/JDBCSuite.scala#L938&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/sql/core/src/test/scala/org/apache/spark/sql/jdbc/JDBCSuite.scala#L938&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I think that these probably aren&apos;t necessary.&lt;/p&gt;</comment>
                            <comment id="17268290" author="apachespark" created="Wed, 20 Jan 2021 00:10:33 +0000"  >&lt;p&gt;User &apos;skestle&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31252&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31252&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17268291" author="apachespark" created="Wed, 20 Jan 2021 00:10:35 +0000"  >&lt;p&gt;User &apos;skestle&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31252&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31252&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17268510" author="apachespark" created="Wed, 20 Jan 2021 10:52:18 +0000"  >&lt;p&gt;User &apos;sarutak&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31262&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31262&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17268511" author="apachespark" created="Wed, 20 Jan 2021 10:52:28 +0000"  >&lt;p&gt;User &apos;sarutak&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31262&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31262&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17268512" author="apachespark" created="Wed, 20 Jan 2021 10:53:27 +0000"  >&lt;p&gt;User &apos;sarutak&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31262&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31262&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17269020" author="apachespark" created="Thu, 21 Jan 2021 04:16:19 +0000"  >&lt;p&gt;User &apos;sarutak&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31270&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31270&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17269021" author="apachespark" created="Thu, 21 Jan 2021 04:16:54 +0000"  >&lt;p&gt;User &apos;sarutak&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31270&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31270&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17269022" author="apachespark" created="Thu, 21 Jan 2021 04:17:09 +0000"  >&lt;p&gt;User &apos;sarutak&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31270&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31270&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17269044" author="apachespark" created="Thu, 21 Jan 2021 05:33:15 +0000"  >&lt;p&gt;User &apos;sarutak&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/31274&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31274&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17414255" author="cloud_fan" created="Mon, 13 Sep 2021 15:10:17 +0000"  >&lt;p&gt;This was reverted and replaced by&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/31473&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/31473&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13353505">SPARK-34180</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 9 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0lrnk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>