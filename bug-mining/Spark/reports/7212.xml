<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:16:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-31786] Exception on submitting Spark-Pi to Kubernetes 1.17.3</title>
                <link>https://issues.apache.org/jira/browse/SPARK-31786</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Hi,&lt;br/&gt;
I&apos;m getting exception when submitting Spark-Pi app to Kubernetes cluster.&lt;/p&gt;

&lt;p&gt;Kubernetes version: 1.17.3&lt;br/&gt;
JDK version: openjdk version &quot;1.8.0_252&quot;&lt;/p&gt;

&lt;p&gt;Exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 ./bin/spark-submit --master k8s:&lt;span class=&quot;code-comment&quot;&gt;//https://172.31.23.60:8443 --deploy-mode cluster --name spark-pi --conf spark.kubernetes.container.image=spark-py:2.4.5 --conf spark.kubernetes.executor.request.cores=0.1 --conf spark.kubernetes.authenticate.driver.serviceAccountName=spark --conf spark.executor.instances=1 local:///opt/spark/examples/src/main/python/pi.py
&lt;/span&gt;log4j:WARN No appenders could be found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; logger (io.fabric8.kubernetes.client.Config).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http:&lt;span class=&quot;code-comment&quot;&gt;//logging.apache.org/log4j/1.2/faq.html#noconfig &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more info.
&lt;/span&gt;Using Spark&apos;s &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; log4j profile: org/apache/spark/log4j-defaults.properties
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; io.fabric8.kubernetes.client.KubernetesClientException: Operation: [create]  &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; kind: [Pod]  with name: [&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]  in namespace: [&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;]  failed.
        at io.fabric8.kubernetes.client.KubernetesClientException.launderThrowable(KubernetesClientException.java:64)
        at io.fabric8.kubernetes.client.KubernetesClientException.launderThrowable(KubernetesClientException.java:72)
        at io.fabric8.kubernetes.client.dsl.base.BaseOperation.create(BaseOperation.java:337)
        at io.fabric8.kubernetes.client.dsl.base.BaseOperation.create(BaseOperation.java:330)
        at org.apache.spark.deploy.k8s.submit.Client$$anonfun$run$2.apply(KubernetesClientApplication.scala:141)
        at org.apache.spark.deploy.k8s.submit.Client$$anonfun$run$2.apply(KubernetesClientApplication.scala:140)
        at org.apache.spark.util.Utils$.tryWithResource(Utils.scala:2543)
        at org.apache.spark.deploy.k8s.submit.Client.run(KubernetesClientApplication.scala:140)
        at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication$$anonfun$run$5.apply(KubernetesClientApplication.scala:250)
        at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication$$anonfun$run$5.apply(KubernetesClientApplication.scala:241)
        at org.apache.spark.util.Utils$.tryWithResource(Utils.scala:2543)
        at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication.run(KubernetesClientApplication.scala:241)
        at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication.start(KubernetesClientApplication.scala:204)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:845)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:161)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:184)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:920)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:929)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
Caused by: java.net.SocketException: Broken pipe (Write failed)
        at java.net.SocketOutputStream.socketWrite0(Native Method)
        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:111)
        at java.net.SocketOutputStream.write(SocketOutputStream.java:155)
        at sun.security.ssl.OutputRecord.writeBuffer(OutputRecord.java:431)
        at sun.security.ssl.OutputRecord.write(OutputRecord.java:417)
        at sun.security.ssl.SSLSocketImpl.writeRecordInternal(SSLSocketImpl.java:894)
        at sun.security.ssl.SSLSocketImpl.writeRecord(SSLSocketImpl.java:865)
        at sun.security.ssl.AppOutputStream.write(AppOutputStream.java:123)
        at okio.Okio$1.write(Okio.java:79)
        at okio.AsyncTimeout$1.write(AsyncTimeout.java:180)
        at okio.RealBufferedSink.flush(RealBufferedSink.java:224)
        at okhttp3.internal.http2.Http2Writer.settings(Http2Writer.java:203)
        at okhttp3.internal.http2.Http2Connection.start(Http2Connection.java:515)
        at okhttp3.internal.http2.Http2Connection.start(Http2Connection.java:505)
        at okhttp3.internal.connection.RealConnection.startHttp2(RealConnection.java:298)
        at okhttp3.internal.connection.RealConnection.establishProtocol(RealConnection.java:287)
        at okhttp3.internal.connection.RealConnection.connect(RealConnection.java:168)
        at okhttp3.internal.connection.StreamAllocation.findConnection(StreamAllocation.java:257)
        at okhttp3.internal.connection.StreamAllocation.findHealthyConnection(StreamAllocation.java:135)
        at okhttp3.internal.connection.StreamAllocation.newStream(StreamAllocation.java:114)
        at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.java:42)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:121)
        at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.java:93)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:121)
        at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.java:93)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)
        at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.java:126)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:121)
        at io.fabric8.kubernetes.client.utils.BackwardsCompatibilityInterceptor.intercept(BackwardsCompatibilityInterceptor.java:119)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:121)
        at io.fabric8.kubernetes.client.utils.ImpersonatorInterceptor.intercept(ImpersonatorInterceptor.java:68)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:121)
        at io.fabric8.kubernetes.client.utils.HttpClientUtils.lambda$createHttpClient$3(HttpClientUtils.java:112)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)
        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:121)
        at okhttp3.RealCall.getResponseWithInterceptorChain(RealCall.java:254)
        at okhttp3.RealCall.execute(RealCall.java:92)
        at io.fabric8.kubernetes.client.dsl.base.OperationSupport.handleResponse(OperationSupport.java:411)
        at io.fabric8.kubernetes.client.dsl.base.OperationSupport.handleResponse(OperationSupport.java:372)
        at io.fabric8.kubernetes.client.dsl.base.OperationSupport.handleCreate(OperationSupport.java:241)
        at io.fabric8.kubernetes.client.dsl.base.BaseOperation.handleCreate(BaseOperation.java:819)
        at io.fabric8.kubernetes.client.dsl.base.BaseOperation.create(BaseOperation.java:334)
        ... 17 more
20/05/21 15:17:21 INFO ShutdownHookManager: Shutdown hook called
20/05/21 15:17:21 INFO ShutdownHookManager: Deleting directory /tmp/spark-aa4d1797-0e72-4a7f-8ea0-f2231371bbb1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think problem is with Java version. When I downgraded to 8_u162 then I was able to submit app, but there was similar exception in driver container (which is build on newest openjdk image so u252)&lt;br/&gt;
What can I do to fix this bug ?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13306511">SPARK-31786</key>
            <summary>Exception on submitting Spark-Pi to Kubernetes 1.17.3</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dongjoon">Dongjoon Hyun</assignee>
                                    <reporter username="maver1ck">Maciej Bry&#324;ski</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 May 2020 15:19:43 +0000</created>
                <updated>Tue, 19 Jan 2021 21:59:31 +0000</updated>
                            <resolved>Sat, 23 May 2020 18:10:38 +0000</resolved>
                                    <version>2.4.5</version>
                    <version>3.0.0</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>Kubernetes</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17113429" author="maver1ck" created="Thu, 21 May 2020 17:44:59 +0000"  >&lt;p&gt;I think this is related to:&lt;br/&gt;
&lt;a href=&quot;https://github.com/fabric8io/kubernetes-client/issues/2145&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/fabric8io/kubernetes-client/issues/2145&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17113575" author="dongjoon" created="Thu, 21 May 2020 22:09:08 +0000"  >&lt;p&gt;Thank you for reporting, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maver1ck&quot; class=&quot;user-hover&quot; rel=&quot;maver1ck&quot;&gt;maver1ck&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17113587" author="apachespark" created="Thu, 21 May 2020 22:21:46 +0000"  >&lt;p&gt;User &apos;dongjoon-hyun&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/28601&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/28601&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17113588" author="apachespark" created="Thu, 21 May 2020 22:22:04 +0000"  >&lt;p&gt;User &apos;dongjoon-hyun&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/28601&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/28601&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17113595" author="dongjoon" created="Thu, 21 May 2020 22:32:58 +0000"  >&lt;p&gt;BTW, is there any chance for you to test Apache Spark 3.0 RC2 which is the latest binary?&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://dist.apache.org/repos/dist/dev/spark/v3.0.0-rc2-bin/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dist.apache.org/repos/dist/dev/spark/v3.0.0-rc2-bin/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17113611" author="dongjoon" created="Thu, 21 May 2020 23:08:17 +0000"  >&lt;p&gt;I also verified that Apache Spark 3.0.0-RC2 and 2.4.6-RC3 fails, too.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; io.fabric8.kubernetes.client.KubernetesClientException: Operation: [create]  &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; kind: [Pod]  with name: [&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]  in namespace: [&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;]  failed.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17113613" author="dongjoon" created="Thu, 21 May 2020 23:13:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=holden&quot; class=&quot;user-hover&quot; rel=&quot;holden&quot;&gt;holden&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dbtsai&quot; class=&quot;user-hover&quot; rel=&quot;dbtsai&quot;&gt;dbtsai&lt;/a&gt;. I raised this issue as a blocker for Apache Spark 3.0.0 and 2.4.6.&lt;/p&gt;</comment>
                            <comment id="17113724" author="felixzheng" created="Fri, 22 May 2020 03:37:39 +0000"  >&lt;p&gt;It seems the same issue as &lt;a href=&quot;https://github.com/fabric8io/kubernetes-client/issues/2212&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/fabric8io/kubernetes-client/issues/2212&lt;/a&gt;. I have tried out v4.9.2 in Flink and it works as expected.&lt;br/&gt;
JIRA: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-17565&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-17565&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="17114201" author="dongjoon" created="Fri, 22 May 2020 16:18:08 +0000"  >&lt;p&gt;Thank you for the addition info, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=felixzheng&quot; class=&quot;user-hover&quot; rel=&quot;felixzheng&quot;&gt;felixzheng&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17114912" author="dongjoon" created="Sat, 23 May 2020 18:10:38 +0000"  >&lt;p&gt;I&apos;m working on backporting.&lt;/p&gt;</comment>
                            <comment id="17115008" author="apachespark" created="Sun, 24 May 2020 01:50:12 +0000"  >&lt;p&gt;User &apos;dongjoon-hyun&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/28625&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/28625&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17115009" author="apachespark" created="Sun, 24 May 2020 01:50:58 +0000"  >&lt;p&gt;User &apos;dongjoon-hyun&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/28625&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/28625&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17115024" author="dongjoon" created="Sun, 24 May 2020 02:57:32 +0000"  >&lt;p&gt;We are hitting jackson-core 2.10.0 incompatibility issue.&lt;br/&gt;
Since we cannot upgrade Jackson dependency in Apache Spark 2.4, I closed my PR and remove `2.4.6` from the target version.&lt;br/&gt;
cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=holden&quot; class=&quot;user-hover&quot; rel=&quot;holden&quot;&gt;holden&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dbtsai&quot; class=&quot;user-hover&quot; rel=&quot;dbtsai&quot;&gt;dbtsai&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17115028" author="dongjoon" created="Sun, 24 May 2020 03:53:04 +0000"  >&lt;p&gt;As a workaround for 2.4.6, users can set `HTTP2_DISABLE=true` before executing `spark-submit` and set the driver pod environment like the following.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
spark.kubernetes.driverEnv.HTTP2_DISABLE=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17115144" author="maver1ck" created="Sun, 24 May 2020 11:22:09 +0000"  >&lt;p&gt;I think this should be added at least to documentation.&lt;/p&gt;</comment>
                            <comment id="17115436" author="dongjoon" created="Sun, 24 May 2020 20:02:19 +0000"  >&lt;p&gt;Could you make a PR, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maver1ck&quot; class=&quot;user-hover&quot; rel=&quot;maver1ck&quot;&gt;maver1ck&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="17116460" author="dongjoon" created="Tue, 26 May 2020 05:58:28 +0000"  >&lt;p&gt;Okay. I&apos;ll create a PR for that, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maver1ck&quot; class=&quot;user-hover&quot; rel=&quot;maver1ck&quot;&gt;maver1ck&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17258345" author="smurarka" created="Mon, 4 Jan 2021 17:20:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maver1ck&quot; class=&quot;user-hover&quot; rel=&quot;maver1ck&quot;&gt;maver1ck&lt;/a&gt;&#160;/ &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt;&#160;:&lt;br/&gt;
I am facing this issue. I am using Spark 2.4.7 .&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I have tried the settings mentioned in the above comments&lt;br/&gt;
spark.kubernetes.driverEnv.HTTP2_DISABLE=true&lt;/p&gt;


&lt;p&gt;Following is the exception :&lt;/p&gt;


&lt;p&gt;Exception in thread &quot;main&quot; io.fabric8.kubernetes.client.KubernetesClientException: Operation: &lt;span class=&quot;error&quot;&gt;&amp;#91;create&amp;#93;&lt;/span&gt;&#160;for kind: &lt;span class=&quot;error&quot;&gt;&amp;#91;Pod&amp;#93;&lt;/span&gt;&#160;with name: &lt;span class=&quot;error&quot;&gt;&amp;#91;null&amp;#93;&lt;/span&gt;&#160;in namespace: &lt;span class=&quot;error&quot;&gt;&amp;#91;spark-test&amp;#93;&lt;/span&gt;&#160;failed.&lt;br/&gt;
 at io.fabric8.kubernetes.client.KubernetesClientException.launderThrowable(KubernetesClientException.java:64)&lt;br/&gt;
 at io.fabric8.kubernetes.client.KubernetesClientException.launderThrowable(KubernetesClientException.java:72)&lt;br/&gt;
 at io.fabric8.kubernetes.client.dsl.base.BaseOperation.create(BaseOperation.java:337)&lt;br/&gt;
 at io.fabric8.kubernetes.client.dsl.base.BaseOperation.create(BaseOperation.java:330)&lt;br/&gt;
 at org.apache.spark.deploy.k8s.submit.Client$$anonfun$run$2.apply(KubernetesClientApplication.scala:141)&lt;br/&gt;
 at org.apache.spark.deploy.k8s.submit.Client$$anonfun$run$2.apply(KubernetesClientApplication.scala:140)&lt;br/&gt;
 at org.apache.spark.util.Utils$.tryWithResource(Utils.scala:2543)&lt;br/&gt;
 at org.apache.spark.deploy.k8s.submit.Client.run(KubernetesClientApplication.scala:140)&lt;br/&gt;
 at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication$$anonfun$run$5.apply(KubernetesClientApplication.scala:250)&lt;br/&gt;
 at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication$$anonfun$run$5.apply(KubernetesClientApplication.scala:241)&lt;br/&gt;
 at org.apache.spark.util.Utils$.tryWithResource(Utils.scala:2543)&lt;br/&gt;
 at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication.run(KubernetesClientApplication.scala:241)&lt;br/&gt;
 at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication.start(KubernetesClientApplication.scala:204)&lt;br/&gt;
 at&#160;&lt;a href=&quot;http://org.apache.spark.deploy.sparksubmit.org/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;org.apache.spark.deploy.SparkSubmit.org&lt;/a&gt;$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:845)&lt;br/&gt;
 at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:161)&lt;br/&gt;
 at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:184)&lt;br/&gt;
 at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)&lt;br/&gt;
 at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:920)&lt;br/&gt;
 at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:929)&lt;br/&gt;
 at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)&lt;br/&gt;
Caused by:&#160;&lt;a href=&quot;http://java.net/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java.net&lt;/a&gt;.SocketTimeoutException: connect timed out&lt;br/&gt;
 at&#160;&lt;a href=&quot;http://java.net/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java.net&lt;/a&gt;.PlainSocketImpl.socketConnect(Native Method)&lt;br/&gt;
 at&#160;&lt;a href=&quot;http://java.net/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java.net&lt;/a&gt;.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)&lt;br/&gt;
 at&#160;&lt;a href=&quot;http://java.net/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java.net&lt;/a&gt;.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)&lt;br/&gt;
 at&#160;&lt;a href=&quot;http://java.net/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java.net&lt;/a&gt;.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)&lt;br/&gt;
 at&#160;&lt;a href=&quot;http://java.net/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java.net&lt;/a&gt;.SocksSocketImpl.connect(SocksSocketImpl.java:392)&lt;br/&gt;
 at&#160;&lt;a href=&quot;http://java.net/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java.net&lt;/a&gt;.Socket.connect(Socket.java:589)&lt;br/&gt;
 at okhttp3.internal.platform.Platform.connectSocket(Platform.java:129)&lt;br/&gt;
 at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.java:246)&lt;br/&gt;
 at okhttp3.internal.connection.RealConnection.connect(RealConnection.java:166)&lt;br/&gt;
 at okhttp3.internal.connection.StreamAllocation.findConnection(StreamAllocation.java:257)&lt;br/&gt;
 at okhttp3.internal.connection.StreamAllocation.findHealthyConnection(StreamAllocation.java:135)&lt;br/&gt;
 at okhttp3.internal.connection.StreamAllocation.newStream(StreamAllocation.java:114)&lt;br/&gt;
 at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.java:42)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:121)&lt;br/&gt;
 at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.java:93)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:121)&lt;br/&gt;
 at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.java:93)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)&lt;br/&gt;
 at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.java:126)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:121)&lt;br/&gt;
 at io.fabric8.kubernetes.client.utils.BackwardsCompatibilityInterceptor.intercept(BackwardsCompatibilityInterceptor.java:119)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:121)&lt;br/&gt;
 at io.fabric8.kubernetes.client.utils.ImpersonatorInterceptor.intercept(ImpersonatorInterceptor.java:68)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:121)&lt;br/&gt;
 at io.fabric8.kubernetes.client.utils.HttpClientUtils.lambda$createHttpClient$3(HttpClientUtils.java:110)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:147)&lt;br/&gt;
 at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:121)&lt;br/&gt;
 at okhttp3.RealCall.getResponseWithInterceptorChain(RealCall.java:254)&lt;br/&gt;
 at okhttp3.RealCall.execute(RealCall.java:92)&lt;br/&gt;
 at io.fabric8.kubernetes.client.dsl.base.OperationSupport.handleResponse(OperationSupport.java:411)&lt;br/&gt;
 at io.fabric8.kubernetes.client.dsl.base.OperationSupport.handleResponse(OperationSupport.java:372)&lt;br/&gt;
 at io.fabric8.kubernetes.client.dsl.base.OperationSupport.handleCreate(OperationSupport.java:241)&lt;br/&gt;
 at io.fabric8.kubernetes.client.dsl.base.BaseOperation.handleCreate(BaseOperation.java:819)&lt;br/&gt;
 at io.fabric8.kubernetes.client.dsl.base.BaseOperation.create(BaseOperation.java:334)&lt;br/&gt;
 ... 17 more&#160;&lt;br/&gt;
&#160;&lt;/p&gt;</comment>
                            <comment id="17258383" author="dongjoon" created="Mon, 4 Jan 2021 18:08:03 +0000"  >&lt;p&gt;Did you do `export HTTP2_DISABLE=true` before `spark-submit`? HTTP2_DISABLE is required all places when you use `K8s client` and technically there exist two places.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Your Mac (Outside K8s cluster): `spark-submit`&lt;/li&gt;
	&lt;li&gt;Spark Driver Pod (Inside K8s cluster): spark.kubernetes.driverEnv.HTTP2_DISABLE=true&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="17258411" author="smurarka" created="Mon, 4 Jan 2021 18:40:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt;&#160;-&amp;gt; Yes I have used&#160;`export HTTP2_DISABLE=true` , but only on my machine .&lt;br/&gt;
 Should it on all nodes of Kubernetes?&lt;/p&gt;

&lt;p&gt;Also , regarding you mentioned in second point , spark.kubernetes.driverEnv.HTTP2_DISABLE=true has to be used with spark-submit in form of --conf .&#160;&lt;/p&gt;

&lt;p&gt;Please let me know if my understanding is correct.&lt;/p&gt;

&lt;p&gt;Also , since this is a workaround. What can be the long term solution. Should I consider Spark 3 instead of Spark 2.4.7?&lt;/p&gt;</comment>
                            <comment id="17258670" author="dongjoon" created="Tue, 5 Jan 2021 05:23:16 +0000"  >&lt;p&gt;Yes, you are correct.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;`export` is only required for your machine.&lt;/li&gt;
	&lt;li&gt;`&#8211;conf` should be used for `driverEnv`.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Yes, Spark 3.0 is better for K8s environment and Spark 3.1 is much better because of &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-33005&quot; title=&quot;Kubernetes GA Preparation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-33005&quot;&gt;&lt;del&gt;SPARK-33005&lt;/del&gt;&lt;/a&gt;&#160;(`Kubernetes GA Preparation`).&#160;FYI, Apache Spark 3.1.0 RC1 is already created.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/spark/tree/v3.1.0-rc1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/tree/v3.1.0-rc1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Apache Spark 3.1.0 will arrive this month.&lt;/p&gt;</comment>
                            <comment id="17260046" author="smurarka" created="Wed, 6 Jan 2021 20:27:27 +0000"  >&lt;p&gt;sure &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt;. Thanks a lot for response.&lt;/p&gt;</comment>
                            <comment id="17268214" author="smurarka" created="Tue, 19 Jan 2021 20:46:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt; &lt;br/&gt;
To run spark in kubernetes . I see case &quot;$1&quot; in driver) shift 1 CMD=( &quot;$SPARK_HOME/bin/spark-submit&quot; --conf &quot;spark.driver.bindAddress=$SPARK_DRIVER_BIND_ADDRESS&quot; --deploy-mode client &lt;/p&gt;

&lt;p&gt;Could you pls suggest Why deploy-mode client is mentioned in &lt;a href=&quot;https://t.co/IPbK5sEIqM?amp=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;entrypoint.sh&lt;/a&gt; ? I am running spark submit using deploy mode cluster but inside this &lt;a href=&quot;https://t.co/IPbK5sEIqM?amp=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;entrypoint.sh&lt;/a&gt;&#160;its mentioned like that.&lt;/p&gt;</comment>
                            <comment id="17268257" author="dongjoon" created="Tue, 19 Jan 2021 21:59:31 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smurarka&quot; class=&quot;user-hover&quot; rel=&quot;smurarka&quot;&gt;smurarka&lt;/a&gt;. Apache Jira is not designed for Q&amp;amp;A. You had better use the official mailing list if you have an irrelevant question to this JIRA.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13307340">SPARK-31819</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 42 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0f0bc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12339177">3.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>