<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:48:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-18076] Fix default Locale used in DateFormat, NumberFormat to Locale.US</title>
                <link>https://issues.apache.org/jira/browse/SPARK-18076</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Many parts of the code use &lt;tt&gt;DateFormat&lt;/tt&gt; and &lt;tt&gt;NumberFormat&lt;/tt&gt; instances. Although the behavior of these format is mostly determined by things like format strings, the exact behavior can vary according to the platform&apos;s default locale. Although the locale defaults to &quot;en&quot;, it can be set to something else by env variables. And if it does, it can cause the same code to succeed or fail based just on locale:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.text._
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util._

def parse(s: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, l: Locale) = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SimpleDateFormat(&lt;span class=&quot;code-quote&quot;&gt;&quot;yyyyMMMdd&quot;&lt;/span&gt;, l).parse(s)

parse(&lt;span class=&quot;code-quote&quot;&gt;&quot;1989Dec31&quot;&lt;/span&gt;, Locale.US)
Sun Dec 31 00:00:00 GMT 1989

parse(&lt;span class=&quot;code-quote&quot;&gt;&quot;1989Dec31&quot;&lt;/span&gt;, Locale.UK)
Sun Dec 31 00:00:00 GMT 1989

parse(&lt;span class=&quot;code-quote&quot;&gt;&quot;1989Dec31&quot;&lt;/span&gt;, Locale.CHINA)
java.text.ParseException: Unparseable date: &lt;span class=&quot;code-quote&quot;&gt;&quot;1989Dec31&quot;&lt;/span&gt;
  at java.text.DateFormat.parse(DateFormat.java:366)
  at .parse(&amp;lt;console&amp;gt;:18)
  ... 32 elided

parse(&lt;span class=&quot;code-quote&quot;&gt;&quot;1989Dec31&quot;&lt;/span&gt;, Locale.GERMANY)
java.text.ParseException: Unparseable date: &lt;span class=&quot;code-quote&quot;&gt;&quot;1989Dec31&quot;&lt;/span&gt;
  at java.text.DateFormat.parse(DateFormat.java:366)
  at .parse(&amp;lt;console&amp;gt;:18)
  ... 32 elided
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Where not otherwise specified, I believe all instances in the code should default to some fixed value, and that should probably be &lt;tt&gt;Locale.US&lt;/tt&gt;. This matches the JVM&apos;s default, and specifies both language (&quot;en&quot;) and region (&quot;US&quot;) to remove ambiguity. This most closely matches what the current code behavior would be (unless default locale was changed), because it will currently default to &quot;en&quot;.&lt;/p&gt;

&lt;p&gt;This affects SQL date/time functions. At the moment, the only SQL function that lets the user specify language/country is &quot;sentences&quot;, which is consistent with Hive.&lt;/p&gt;

&lt;p&gt;It affects dates passed in the JSON API. &lt;/p&gt;

&lt;p&gt;It affects some strings rendered in the UI, potentially. Although this isn&apos;t a correctness issue, there may be an argument for not letting that vary &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;It affects a bunch of instances where dates are formatted into strings for things like IDs or file names, which is far less likely to cause a problem, but worth making consistent.&lt;/p&gt;

&lt;p&gt;The other occurrences are in tests.&lt;/p&gt;


&lt;p&gt;The downside to this change is also its upside: the behavior doesn&apos;t depend on default JVM locale, but, also can&apos;t be affected by the default JVM locale. For example, if you wanted to parse some dates in a way that depended on an non-US locale (not just the format string) then it would no longer be possible. There&apos;s no means of specifying this, for example, in SQL functions for parsing dates. However, controlling this by globally changing the locale isn&apos;t exactly great either.&lt;/p&gt;

&lt;p&gt;The purpose of this change is to make the current default behavior deterministic and fixed. PR coming.&lt;/p&gt;

&lt;p&gt;CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13014750">SPARK-18076</key>
            <summary>Fix default Locale used in DateFormat, NumberFormat to Locale.US</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="srowen">Sean R. Owen</assignee>
                                    <reporter username="srowen">Sean R. Owen</reporter>
                        <labels>
                            <label>releasenotes</label>
                    </labels>
                <created>Mon, 24 Oct 2016 14:48:44 +0000</created>
                <updated>Wed, 2 Nov 2016 09:39:33 +0000</updated>
                            <resolved>Wed, 2 Nov 2016 09:39:32 +0000</resolved>
                                    <version>2.0.1</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>MLlib</component>
                    <component>Spark Core</component>
                    <component>SQL</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15602233" author="apachespark" created="Mon, 24 Oct 2016 14:58:05 +0000"  >&lt;p&gt;User &apos;srowen&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15610&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15610&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15628381" author="srowen" created="Wed, 2 Nov 2016 09:39:33 +0000"  >&lt;p&gt;Issue resolved by pull request 15610&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15610&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15610&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35azb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>