<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:36:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-11823] HiveThriftBinaryServerSuite tests timing out, leaves hanging processes</title>
                <link>https://issues.apache.org/jira/browse/SPARK-11823</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;i&apos;ve noticed on a few branches that the HiveThriftBinaryServerSuite tests time out, and when that happens, the build is aborted but the tests leave behind hanging processes that eat up cpu and ram.&lt;/p&gt;

&lt;p&gt;most recently, i discovered this happening w/the 1.6 SBT build, specifically w/the hadoop 2.0 profile:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/Spark-1.6-SBT/AMPLAB_JENKINS_BUILD_PROFILE=hadoop2.0,label=spark-test/56/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/Spark-1.6-SBT/AMPLAB_JENKINS_BUILD_PROFILE=hadoop2.0,label=spark-test/56/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vanzin&quot; class=&quot;user-hover&quot; rel=&quot;vanzin&quot;&gt;vanzin&lt;/a&gt; grabbed the jstack log, which i&apos;ve attached to this issue.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12914216">SPARK-11823</key>
            <summary>HiveThriftBinaryServerSuite tests timing out, leaves hanging processes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="shaneknapp">Shane Knapp</reporter>
                        <labels>
                            <label>bulk-closed</label>
                    </labels>
                <created>Wed, 18 Nov 2015 19:30:30 +0000</created>
                <updated>Tue, 21 May 2019 04:36:24 +0000</updated>
                            <resolved>Tue, 21 May 2019 04:36:24 +0000</resolved>
                                                                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15011764" author="shaneknapp" created="Wed, 18 Nov 2015 19:31:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=joshrosen&quot; class=&quot;user-hover&quot; rel=&quot;joshrosen&quot;&gt;joshrosen&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15011832" author="shaneknapp" created="Wed, 18 Nov 2015 19:53:38 +0000"  >&lt;p&gt;this appears to be happening right now on amp-jenkins-worker-05 (PID 233078):&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/Spark-Master-SBT/AMPLAB_JENKINS_BUILD_PROFILE=hadoop2.0,label=spark-test/4039/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/Spark-Master-SBT/AMPLAB_JENKINS_BUILD_PROFILE=hadoop2.0,label=spark-test/4039/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;i attached to the process and all the threads are currently blocked, just like the stack trace already on this ticket.&lt;/p&gt;</comment>
                            <comment id="15011874" author="shaneknapp" created="Wed, 18 Nov 2015 20:19:43 +0000"  >&lt;p&gt;some suspicious looking stack traces in the thriftserver outfile i attached....&lt;/p&gt;</comment>
                            <comment id="15042260" author="shaneknapp" created="Fri, 4 Dec 2015 21:28:16 +0000"  >&lt;p&gt;it looks like it&apos;s this particular test that&apos;s hanging (and leaving hanging processes):&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; - test jdbc cancel *** FAILED *** (1 hour, 27 minutes, 37 seconds)&lt;/p&gt;

&lt;p&gt;i&apos;ve seen this process hanging for over 3 hours as well.&lt;/p&gt;</comment>
                            <comment id="15067314" author="joshrosen" created="Tue, 22 Dec 2015 00:16:03 +0000"  >&lt;p&gt;It looks like this has caused a huge number of timeouts in the Master Maven Hadoop 2.4 builds this week: &lt;a href=&quot;https://spark-tests.appspot.com/jobs/Spark-Master-Maven-with-YARN%20%C2%BB%20hadoop-2.4%2Cspark-test&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://spark-tests.appspot.com/jobs/Spark-Master-Maven-with-YARN%20%C2%BB%20hadoop-2.4%2Cspark-test&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;m going to pull some logs and take a look.&lt;/p&gt;</comment>
                            <comment id="15067345" author="joshrosen" created="Tue, 22 Dec 2015 00:42:51 +0000"  >&lt;p&gt;I think I spotted the problem; it may be a bad use of Thread.sleep() in a test: &lt;a href=&quot;https://github.com/apache/spark/pull/6207/files#r30935200&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/6207/files#r30935200&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15067430" author="apachespark" created="Tue, 22 Dec 2015 02:02:12 +0000"  >&lt;p&gt;User &apos;JoshRosen&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/10425&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/10425&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15067662" author="joshrosen" created="Tue, 22 Dec 2015 07:13:09 +0000"  >&lt;p&gt;Issue resolved by pull request 10425&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/10425&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/10425&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15093173" author="yhuai" created="Tue, 12 Jan 2016 02:33:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=joshrosen&quot; class=&quot;user-hover&quot; rel=&quot;joshrosen&quot;&gt;joshrosen&lt;/a&gt; pointed out that the jdbc cancellation test still times out (see &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/49175/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/49175/&lt;/a&gt;). Let&apos;s ignore this test and then improve the fix.&lt;/p&gt;</comment>
                            <comment id="15093179" author="apachespark" created="Tue, 12 Jan 2016 02:38:05 +0000"  >&lt;p&gt;User &apos;yhuai&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/10715&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/10715&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15093247" author="joshrosen" created="Tue, 12 Jan 2016 04:00:46 +0000"  >&lt;p&gt;Test is now ignored in master, 1.5, and 1.6. I&apos;ll add instructions here tomorrow specifying how we can fix it.&lt;/p&gt;</comment>
                            <comment id="15223664" author="rxin" created="Mon, 4 Apr 2016 05:02:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=joshrosen&quot; class=&quot;user-hover&quot; rel=&quot;joshrosen&quot;&gt;joshrosen&lt;/a&gt; want to leave an instruction here and see if other people can pick it up?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12915588">SPARK-11931</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12915588">SPARK-11931</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12773066" name="spark-jenkins-org.apache.spark.sql.hive.thriftserver.HiveThriftServer2-1-amp-jenkins-worker-05.out" size="13144814" author="shaneknapp" created="Wed, 18 Nov 2015 20:19:43 +0000"/>
                            <attachment id="12773049" name="stack.log" size="106460" author="shaneknapp" created="Wed, 18 Nov 2015 19:31:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 33 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2olhr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>