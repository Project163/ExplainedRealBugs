<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:43:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-14891] ALS in ML never validates input schema</title>
                <link>https://issues.apache.org/jira/browse/SPARK-14891</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Currently, &lt;tt&gt;ALS.fit&lt;/tt&gt; never validates the input schema. There is a &lt;tt&gt;transformSchema&lt;/tt&gt; impl that calls &lt;tt&gt;validateAndTransformSchema&lt;/tt&gt;, but it is never called in either &lt;tt&gt;ALS.fit&lt;/tt&gt; or &lt;tt&gt;ALSModel.transform&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;This was highlighted in &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-13857&quot; title=&quot;Feature parity for ALS ML with MLLIB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-13857&quot;&gt;&lt;del&gt;SPARK-13857&lt;/del&gt;&lt;/a&gt; (and failing PySpark tests &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/56849/consoleFull&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;)when adding a call to &lt;tt&gt;transformSchema&lt;/tt&gt; in &lt;tt&gt;ALSModel.transform&lt;/tt&gt; that actually validates the input schema. The PySpark docstring tests result in Long inputs by default, which fail validation as Int is required.&lt;/p&gt;

&lt;p&gt;Currently, the inputs for user and item ids are cast to Int, with no input type validation (or warning message). So users could pass in Long, Float, Double, etc. It&apos;s also not made clear anywhere in the docs that only Int types for user and item are supported.&lt;/p&gt;

&lt;p&gt;Enforcing validation seems the best option but might break user code that previously &quot;just worked&quot; especially in PySpark. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12962179">SPARK-14891</key>
            <summary>ALS in ML never validates input schema</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mlnick">Nicholas Pentreath</assignee>
                                    <reporter username="mlnick">Nicholas Pentreath</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Apr 2016 08:44:34 +0000</created>
                <updated>Fri, 20 May 2016 16:50:52 +0000</updated>
                            <resolved>Wed, 18 May 2016 19:14:46 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                                    <component>ML</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15256084" author="mlnick" created="Mon, 25 Apr 2016 08:47:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srowen&quot; class=&quot;user-hover&quot; rel=&quot;srowen&quot;&gt;srowen&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mengxr&quot; class=&quot;user-hover&quot; rel=&quot;mengxr&quot;&gt;mengxr&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=josephkb&quot; class=&quot;user-hover&quot; rel=&quot;josephkb&quot;&gt;josephkb&lt;/a&gt; thoughts? Also, while this has come up, I know that &lt;tt&gt;ALS.train&lt;/tt&gt; is DeveloperApi can can accept arbitrary input types for IDs. How bad is the performance hit for allowing at least &lt;tt&gt;Long&lt;/tt&gt; and &lt;tt&gt;String&lt;/tt&gt; types for user/item ids? We could open that up in the ML API (with appropriate warnings about performance if it&apos;s really a major issue).&lt;/p&gt;</comment>
                            <comment id="15256107" author="srowen" created="Mon, 25 Apr 2016 09:05:36 +0000"  >&lt;p&gt;I&apos;ve lost track of what&apos;s supported but it looks like Rating is specialized for Long and Int. I thought those were supposed to be supported. Not sure about other types. At least, whatever is asserting that Int is required could be relaxed to allow Long?&lt;/p&gt;</comment>
                            <comment id="15256140" author="mlnick" created="Mon, 25 Apr 2016 09:27:49 +0000"  >&lt;p&gt;Currently the only doc is &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;/**
 * :: DeveloperApi ::
 * An implementation of ALS that supports &lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt; ID types, specialized &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Int and &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;. This is
 * exposed as a developer API &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; users who &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; need other ID types. But it is not recommended
 * because it increases the shuffle size and memory requirement during training. For simplicity,
 * users and items must have the same type. The number of distinct users/items should be smaller
 * than 2 billion.
 */
@DeveloperApi
object ALS ... 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The user-facing ML API casts user/item col to &lt;tt&gt;IntegerType&lt;/tt&gt; but with no warnings or enforcing any schema validation, so it implicitly &quot;supports&quot; any numeric input type but silently casts it to Int, which would cause some irritating issues when, say, saving the model and trying to use it in production, or making recommendations and saving those to a datastore for a set of user ids (which were Long, say, and have now been mangled to Ints)&lt;/p&gt;</comment>
                            <comment id="15257004" author="josephkb" created="Mon, 25 Apr 2016 20:39:53 +0000"  >&lt;p&gt;For most use cases, Int should be used to save on memory.  Supporting String in the future would be nice but would require internal indexing.  I&apos;d say we should validate the input for now and require Int types.  Users who need Long can use the ALS.train API.&lt;/p&gt;

&lt;p&gt;+1 for better docs &amp;amp; data validation.  For data validation, it could be nice to accept Long and other types but to make sure that the values are checked before casting to Int types.&lt;/p&gt;</comment>
                            <comment id="15257682" author="mlnick" created="Tue, 26 Apr 2016 07:23:39 +0000"  >&lt;p&gt;&lt;tt&gt;ALS.train&lt;/tt&gt; is generic in the ID type, and so does actually support &lt;tt&gt;String&lt;/tt&gt; already. There is a note there about performance, but nothing about that it can only be &lt;tt&gt;Long&lt;/tt&gt; or &lt;tt&gt;Int&lt;/tt&gt;. I&apos;ve tested using &lt;tt&gt;String&lt;/tt&gt; IDs and it works fine (the model is a bit different because I think the partitioning is different, but the RMSE on e.g. &lt;tt&gt;movielens-latest-small&lt;/tt&gt; is the same between the two with same parameters just changing ID type). cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mengxr&quot; class=&quot;user-hover&quot; rel=&quot;mengxr&quot;&gt;mengxr&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15262739" author="apachespark" created="Thu, 28 Apr 2016 18:59:04 +0000"  >&lt;p&gt;User &apos;MLnick&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/12762&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/12762&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12971568">SPARK-15447</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 29 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2wogv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>