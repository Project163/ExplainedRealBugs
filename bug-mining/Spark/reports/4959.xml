<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:54:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-20555] Incorrect handling of Oracle&apos;s decimal types via JDBC</title>
                <link>https://issues.apache.org/jira/browse/SPARK-20555</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;When querying an Oracle database, Spark maps some Oracle numeric data types to incorrect Catalyst data types:&lt;br/&gt;
1. DECIMAL(1) becomes BooleanType&lt;br/&gt;
In Orcale, a DECIMAL(1) can have values from -9 to 9.&lt;br/&gt;
In Spark now, values larger than 1 become the boolean value true.&lt;br/&gt;
2. DECIMAL(3,2) becomes IntegerType&lt;br/&gt;
In Oracle, a DECIMAL(2) can have values like 1.23&lt;br/&gt;
In Spark now, digits after the decimal point are dropped.&lt;br/&gt;
3. DECIMAL(10) becomes IntegerType&lt;br/&gt;
In Oracle, a DECIMAL(10) can have the value 9999999999 (ten nines), which is more than 2^31&lt;br/&gt;
Spark throws an exception: &quot;java.sql.SQLException: Numeric Overflow&quot;&lt;/p&gt;

&lt;p&gt;I think the best solution is to always keep Oracle&apos;s decimal types. (In theory we could introduce a FloatType in some case of #2, and fix #3 by only introducing IntegerType for DECIMAL(9). But in my opinion, that would end up complicated and error-prone.)&lt;/p&gt;

&lt;p&gt;Note: I think the above problems were introduced as part of  &lt;a href=&quot;https://github.com/apache/spark/pull/14377&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14377&lt;/a&gt;&lt;br/&gt;
The main purpose of that PR seems to be converting Spark types to correct Oracle types, and that part seems good to me. But it also adds the inverse conversions. As it turns out in the above examples, that is not possible.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13068377">SPARK-20555</key>
            <summary>Incorrect handling of Oracle&apos;s decimal types via JDBC</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gfeher">Gabor Feher</assignee>
                                    <reporter username="gfeher">Gabor Feher</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 May 2017 10:19:48 +0000</created>
                <updated>Sat, 9 Dec 2017 00:30:02 +0000</updated>
                            <resolved>Sat, 24 Jun 2017 05:11:01 +0000</resolved>
                                    <version>2.1.0</version>
                                    <fixVersion>2.1.2</fixVersion>
                    <fixVersion>2.2.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15992685" author="apachespark" created="Tue, 2 May 2017 10:26:03 +0000"  >&lt;p&gt;User &apos;gaborfeher&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/17830&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/17830&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16012394" author="gfeher" created="Tue, 16 May 2017 13:34:26 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Maybe it was not clear from the title, but this issue is causing data (precision) loss or crashes when reading from Oracle Databases via Spark. I also have a patch!&lt;/p&gt;</comment>
                            <comment id="16061304" author="apachespark" created="Fri, 23 Jun 2017 17:55:05 +0000"  >&lt;p&gt;User &apos;gatorsmile&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/18408&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/18408&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16282128" author="shankarkool" created="Thu, 7 Dec 2017 16:47:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gfeher&quot; class=&quot;user-hover&quot; rel=&quot;gfeher&quot;&gt;gfeher&lt;/a&gt;&lt;br/&gt;
May i know if first issue has been resolved?&lt;/p&gt;

&lt;p&gt;&quot;1. DECIMAL(1) becomes BooleanType&lt;br/&gt;
In Orcale, a DECIMAL(1) can have values from -9 to 9.&quot;&lt;/p&gt;

&lt;p&gt;I am using the spark 2.2.0 but still i am getting Boolean &quot;false&quot; when source is having NUMBER(1) as 0.  I want it as 0 without customschema Could you please advise?&lt;/p&gt;</comment>
                            <comment id="16284465" author="gfeher" created="Sat, 9 Dec 2017 00:30:02 +0000"  >&lt;p&gt;This issues was fixed, so in theory, you should not be getting Boolean type in Spark if the database has a NUMBER(1) column.&lt;/p&gt;

&lt;p&gt;I checked the code and it seems to be that the fix is still there in Spark 2.2.0:&lt;br/&gt;
Fix: &lt;a href=&quot;https://github.com/apache/spark/pull/18408/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/18408/files&lt;/a&gt;&lt;br/&gt;
Spark 2.2.0 fixed code: &lt;a href=&quot;https://github.com/apache/spark/blob/v2.2.0/sql/core/src/main/scala/org/apache/spark/sql/jdbc/OracleDialect.scala#L33&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/v2.2.0/sql/core/src/main/scala/org/apache/spark/sql/jdbc/OracleDialect.scala#L33&lt;/a&gt;&lt;br/&gt;
Spark 2.2.0 tests: &lt;a href=&quot;https://github.com/apache/spark/blob/v2.2.0/external/docker-integration-tests/src/test/scala/org/apache/spark/sql/jdbc/OracleIntegrationSuite.scala#L108&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/v2.2.0/external/docker-integration-tests/src/test/scala/org/apache/spark/sql/jdbc/OracleIntegrationSuite.scala#L108&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I suggest you the following: double-check that you have a clean Spark 2.2.0 setup, i.e. there are no remnants of earlier Spark versions loaded with your program. If you have confirmed that, then create an as simple as possible step by step guide how to observe your problem, so that another person can do it easily. Perhaps the best would be to demonstrate your problem in a cleanly installed Spark shell.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 49 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ecwf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>