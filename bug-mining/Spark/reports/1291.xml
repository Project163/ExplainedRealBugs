<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:22:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-5119] java.lang.ArrayIndexOutOfBoundsException on trying to train decision tree model</title>
                <link>https://issues.apache.org/jira/browse/SPARK-5119</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;First I tried to see if there was a bug raised before with similar trace. I found &lt;a href=&quot;https://www.mail-archive.com/user@spark.apache.org/msg13708.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.mail-archive.com/user@spark.apache.org/msg13708.html&lt;/a&gt; but the suggestion to upgarde to latest code bae ( I cloned from master branch) does not fix this issue.&lt;/p&gt;

&lt;p&gt;Issue: try to train a decision tree classifier on some data.After training and when it begins colllect, it crashes:&lt;/p&gt;

&lt;p&gt;15/01/06 22:28:15 INFO BlockManagerMaster: Updated info of block rdd_52_1&lt;br/&gt;
15/01/06 22:28:15 ERROR Executor: Exception in task 1.0 in stage 31.0 (TID 1895)&lt;br/&gt;
java.lang.ArrayIndexOutOfBoundsException: -1&lt;br/&gt;
        at org.apache.spark.mllib.tree.impurity.GiniAggregator.update(Gini.scala:93)&lt;br/&gt;
        at org.apache.spark.mllib.tree.impl.DTStatsAggregator.update(DTStatsAggregator.scala:100)&lt;br/&gt;
        at org.apache.spark.mllib.tree.DecisionTree$.orderedBinSeqOp(DecisionTree.scala:419)&lt;br/&gt;
        at org.apache.spark.mllib.tree.DecisionTree$.org$apache$spark$mllib$tree$DecisionTree$$nodeBinSeqOp$1(DecisionTree.scala:511)&lt;br/&gt;
        at org.apache.spark.mllib.tree.DecisionTree$$anonfun$org$apache$spark$mllib$tree$DecisionTree$$binSeqOp$1$1.apply(DecisionTree.scala:536&lt;br/&gt;
)&lt;br/&gt;
        at org.apache.spark.mllib.tree.DecisionTree$$anonfun$org$apache$spark$mllib$tree$DecisionTree$$binSeqOp$1$1.apply(DecisionTree.scala:533&lt;br/&gt;
)&lt;br/&gt;
        at scala.collection.immutable.Map$Map1.foreach(Map.scala:109)&lt;br/&gt;
        at org.apache.spark.mllib.tree.DecisionTree$.org$apache$spark$mllib$tree$DecisionTree$$binSeqOp$1(DecisionTree.scala:533)&lt;br/&gt;
        at org.apache.spark.mllib.tree.DecisionTree$$anonfun$6$$anonfun$apply$8.apply(DecisionTree.scala:628)&lt;br/&gt;
        at org.apache.spark.mllib.tree.DecisionTree$$anonfun$6$$anonfun$apply$8.apply(DecisionTree.scala:628)&lt;br/&gt;
        at scala.collection.Iterator$class.foreach(Iterator.scala:727)&lt;/p&gt;

&lt;p&gt;Minimal code:&lt;br/&gt;
 data = MLUtils.loadLibSVMFile(sc, &apos;/scratch1/vivek/datasets/private/a1a&apos;).cache()&lt;/p&gt;

&lt;p&gt;model = DecisionTree.trainClassifier(data, numClasses=2, categoricalFeaturesInfo={}, maxDepth=5, maxBins=100)&lt;/p&gt;

&lt;p&gt;Just download the data from: &lt;a href=&quot;http://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/binary/a1a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/binary/a1a&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux ubuntu 14.04&lt;/p&gt;</environment>
        <key id="12765285">SPARK-5119</key>
            <summary>java.lang.ArrayIndexOutOfBoundsException on trying to train decision tree model</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lewuathe">Kai</assignee>
                                    <reporter username="vvkulkarni">Vivek Kulkarni</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Jan 2015 03:47:08 +0000</created>
                <updated>Tue, 27 Jan 2015 19:38:50 +0000</updated>
                            <resolved>Tue, 27 Jan 2015 02:03:34 +0000</resolved>
                                    <version>1.1.0</version>
                    <version>1.2.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>ML</component>
                    <component>MLlib</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14270316" author="lewuathe" created="Fri, 9 Jan 2015 00:58:18 +0000"  >&lt;p&gt;I think impurity implemented MLlib cannot keep negative labels. In this case it is -1.&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/mllib/tree/impurity/Gini.scala#L93&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/mllib/tree/impurity/Gini.scala#L93&lt;/a&gt;&lt;br/&gt;
Should impurity support negative label?&lt;/p&gt;</comment>
                            <comment id="14270825" author="srowen" created="Fri, 9 Jan 2015 10:00:28 +0000"  >&lt;p&gt;Yes, the input must contain categories that are nonnegative integers. I think this is a reasonable restriction. Although MLUtils.loadLibSVMFile will convert the 1-based feature numbers to 0-based, it leaves the -1 / 1 target untouched. Simply map your -1 labels to 0.&lt;/p&gt;</comment>
                            <comment id="14270959" author="apachespark" created="Fri, 9 Jan 2015 12:40:03 +0000"  >&lt;p&gt;User &apos;Lewuathe&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/3975&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/3975&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14292846" author="mengxr" created="Tue, 27 Jan 2015 02:03:34 +0000"  >&lt;p&gt;Issue resolved by pull request 3975&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/3975&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/3975&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14294046" author="ngarneau" created="Tue, 27 Jan 2015 19:38:50 +0000"  >&lt;p&gt;Hey guys, I am wondering what you think about letting the user control if its feature vectors are 0-based or 1-based. I used to have 0-based vectors for my datasets (worked a lot with scikit-learn) and I saw in the loadLibSVMFile function that you are &quot;converting&quot; any vectors to a 0-based...&lt;br/&gt;
Thought it would be cool to add a optional parameters or something...&lt;br/&gt;
Thanks guys, I&apos;d be glad to give you some help &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 42 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i240o7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327642">1.3.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>