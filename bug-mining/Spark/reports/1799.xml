<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:27:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-6812] filter() on DataFrame does not work as expected</title>
                <link>https://issues.apache.org/jira/browse/SPARK-6812</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt; filter(df, df$age &amp;gt; 21)
Error in filter(df, df$age &amp;gt; 21) :
  no method &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; coercing &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; S4 &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;to a vector
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12819800">SPARK-6812</key>
            <summary>filter() on DataFrame does not work as expected</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sunrui">Sun Rui</assignee>
                                    <reporter username="davies">Davies Liu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Apr 2015 19:30:57 +0000</created>
                <updated>Fri, 8 May 2015 10:03:16 +0000</updated>
                            <resolved>Thu, 7 May 2015 05:50:02 +0000</resolved>
                                                    <fixVersion>1.4.0</fixVersion>
                                    <component>SparkR</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14488128" author="shivaram" created="Thu, 9 Apr 2015 19:50:21 +0000"  >&lt;p&gt;Hmm - don&apos;t we have a unit test for this ? I&apos;m wondering if this is because of the generics not resolving correctly.&lt;/p&gt;</comment>
                            <comment id="14528488" author="sunrui" created="Tue, 5 May 2015 14:12:01 +0000"  >&lt;p&gt;I think this is due to function conflict with existing R filter() function. &lt;br/&gt;
If you enforce to call filter() inside SparkR scope, that works.&lt;br/&gt;
SparkR:::filter(df, &quot;age &amp;gt; 20&quot;)&lt;/p&gt;

&lt;p&gt;Originally, in RDD API, we rename RDD filter() to filterRDD() and Filter() . But in DataFrame, filter() name is still used. So we can rename filter() to filterDF() and Filter() as RDD API does.&lt;/p&gt;</comment>
                            <comment id="14529863" author="shivaram" created="Wed, 6 May 2015 04:02:36 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sunrui&quot; class=&quot;user-hover&quot; rel=&quot;sunrui&quot;&gt;sunrui&lt;/a&gt; for investigating - It looks like `dplyr` successfully overrides filter in their API. Could you try to see if we can do something similar ? &lt;a href=&quot;https://github.com/hadley/dplyr/blob/master/NAMESPACE#L104&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/hadley/dplyr/blob/master/NAMESPACE#L104&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14529930" author="sunrui" created="Wed, 6 May 2015 05:07:21 +0000"  >&lt;p&gt;Interestingly, we have a unit test case for filter() and the test passes. In R, if multiple packages have a same name, the name in the package loaded lastly overwrites that in the packages loaded before. &lt;br/&gt;
If you use bin/sparkR to start a SparkR shell, the environment list is as follows:&lt;br/&gt;
 &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &quot;.GlobalEnv&quot;        &quot;package:stats&quot;     &quot;package:graphics&quot;&lt;br/&gt;
 &lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt; &quot;package:grDevices&quot; &quot;package:datasets&quot;  &quot;package:SparkR&quot;&lt;br/&gt;
 &lt;span class=&quot;error&quot;&gt;&amp;#91;7&amp;#93;&lt;/span&gt; &quot;package:utils&quot;     &quot;package:methods&quot;   &quot;Autoloads&quot;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;10&amp;#93;&lt;/span&gt; &quot;package:base&quot;&lt;/p&gt;

&lt;p&gt;You can see that &quot;package:stats&quot; is before &quot;package:SparkR&quot;, so its filter() function overwrites the one in SparkR.&lt;/p&gt;

&lt;p&gt;While in the test procedure, the environment list is different:&lt;br/&gt;
.GlobalEnv package:plyr package:SparkR package:testthat package:methods package:stats package:graphics package:grDevices package:utils package:datasets Autoloads package:base&lt;/p&gt;

&lt;p&gt;You can see that package:SparkR is before package:stats. That why filter() in SparkR passes the test.&lt;/p&gt;

&lt;p&gt;Don&apos;t know why the package loading order is different now.&lt;/p&gt;</comment>
                            <comment id="14529935" author="shivaram" created="Wed, 6 May 2015 05:15:13 +0000"  >&lt;p&gt;Ah I see - We ran into a similar issue with `head` before and the workaround was to include utils before SparkR &amp;#8211; See R/pkg/inst/profile/shell.R &lt;br/&gt;
We could do a similar fix for stats&lt;/p&gt;</comment>
                            <comment id="14530106" author="sunrui" created="Wed, 6 May 2015 07:49:00 +0000"  >&lt;p&gt;According to the R manual: &lt;a href=&quot;https://stat.ethz.ch/R-manual/R-devel/library/base/html/Startup.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stat.ethz.ch/R-manual/R-devel/library/base/html/Startup.html&lt;/a&gt;,&lt;br/&gt;
&quot; if a function .First is found on the search path, it is executed as .First(). Finally, function .First.sys() in the base package is run. This calls require to attach the default packages specified by options(&quot;defaultPackages&quot;).&quot;&lt;/p&gt;

&lt;p&gt;In .First() in profile/shell.R, we load SparkR package. This means SparkR package is loaded before default packages. If there are same names in default packages, they will overwrite those in SparkR. This is why filter() in SparkR is masked by filter() in stats, which is usually in the default package list.&lt;/p&gt;

&lt;p&gt;We need to make sure SparkR is loaded after default packages. The solution is to append SparkR to default packages, instead of loading SparkR in .First().&lt;/p&gt;</comment>
                            <comment id="14530268" author="apachespark" created="Wed, 6 May 2015 09:49:36 +0000"  >&lt;p&gt;User &apos;sun-rui&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/5938&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5938&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14530890" author="shivaram" created="Wed, 6 May 2015 16:55:30 +0000"  >&lt;p&gt;Regarding the name conflicts occurring between the Scala API, other R packages etc. there are a couple of points&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;IMHO we don&apos;t need to mimic the Scala API always as SparkR is more geared towards R users than towards users who are switching to it from Scala. So we should still look to override common R functions for DataFrames or Machine learning so that we can maintain familiarity for R-users&lt;/li&gt;
	&lt;li&gt;Also I agree with you that naming conflicts exist even when you load three or four R related packages (without SparkR), so I think the best we can do is to load SparkR at the top of default packages list as you mention.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Regarding sortDF, I was actually planning to name it `arrange` after the dply call as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-7231&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-7231&lt;/a&gt; &amp;#8211; Let me know if this sounds good to you.&lt;/p&gt;</comment>
                            <comment id="14532057" author="shivaram" created="Thu, 7 May 2015 05:49:52 +0000"  >&lt;p&gt;Fixed by &lt;a href=&quot;https://github.com/apache/spark/pull/5938&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5938&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14532070" author="sunrui" created="Thu, 7 May 2015 05:59:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shivaram&quot; class=&quot;user-hover&quot; rel=&quot;shivaram&quot;&gt;shivaram&lt;/a&gt;, Yes I agree. Seems there are still two methods, sampleDF() and saveDF(), we can change them back to sample() and save()?&lt;/p&gt;</comment>
                            <comment id="14533491" author="shivaram" created="Thu, 7 May 2015 22:26:12 +0000"  >&lt;p&gt;Yeah lets change them to sample(), load() and save() &amp;#8211; and we can remove showDF as I described in &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-7435&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-7435&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12828308">SPARK-7482</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2d1yv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12329359">1.4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>