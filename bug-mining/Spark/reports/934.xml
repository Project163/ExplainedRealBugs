<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:19:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-3904] HQL doesn&apos;t support the ConstantObjectInspector to pass into UDFs</title>
                <link>https://issues.apache.org/jira/browse/SPARK-3904</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;In HQL, we convert all of the data type into normal ObjectInspectors for UDFs, most of cases it work, however, some of the UDF actually requires the input ObjectInspector to be the ConstantObjectInspector, which will cause exception.&lt;br/&gt;
e.g.&lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;select named_struct(&quot;x&quot;, &quot;str&quot;) from src limit 1&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It will throws exception like&lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;14/10/10 16:25:17 INFO parse.ParseDriver: Parsing command: select named_struct(&quot;x&quot;, &quot;str&quot;) from src&lt;br/&gt;
14/10/10 16:25:17 INFO parse.ParseDriver: Parse Completed&lt;br/&gt;
14/10/10 16:25:17 INFO metastore.HiveMetaStore: 0: get_table : db=default tbl=src&lt;br/&gt;
14/10/10 16:25:17 INFO HiveMetaStore.audit: ugi=hcheng	ip=unknown-ip-addr	cmd=get_table : db=default tbl=tmp2	&lt;br/&gt;
14/10/10 16:25:17 ERROR thriftserver.SparkSQLDriver: Failed in &lt;span class=&quot;error&quot;&gt;&amp;#91;select named_struct(&amp;quot;x&amp;quot;, &amp;quot;str&amp;quot;) from src&amp;#93;&lt;/span&gt;&lt;br/&gt;
org.apache.hadoop.hive.ql.exec.UDFArgumentTypeException: Even arguments to NAMED_STRUCT must be a constant STRING.org.apache.hadoop.hive.serde2.objectinspector.primitive.JavaStringObjectInspector@2f2dbcfc&lt;br/&gt;
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFNamedStruct.initialize(GenericUDFNamedStruct.java:55)&lt;br/&gt;
	at org.apache.spark.sql.hive.HiveGenericUdf.returnInspector$lzycompute(hiveUdfs.scala:129)&lt;br/&gt;
	at org.apache.spark.sql.hive.HiveGenericUdf.returnInspector(hiveUdfs.scala:129)&lt;br/&gt;
	at org.apache.spark.sql.hive.HiveGenericUdf.eval(hiveUdfs.scala:158)&lt;br/&gt;
	at org.apache.spark.sql.catalyst.optimizer.ConstantFolding$$anonfun$apply$6$$anonfun$applyOrElse$2.applyOrElse(Optimizer.scala:267)&lt;br/&gt;
	at org.apache.spark.sql.catalyst.optimizer.ConstantFolding$$anonfun$apply$6$$anonfun$applyOrElse$2.applyOrElse(Optimizer.scala:260)&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12747480">SPARK-3904</key>
            <summary>HQL doesn&apos;t support the ConstantObjectInspector to pass into UDFs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chenghao">Cheng Hao</assignee>
                                    <reporter username="chenghao">Cheng Hao</reporter>
                        <labels>
                    </labels>
                <created>Sat, 11 Oct 2014 06:45:10 +0000</created>
                <updated>Thu, 7 May 2015 07:49:34 +0000</updated>
                            <resolved>Wed, 29 Oct 2014 02:12:30 +0000</resolved>
                                                    <fixVersion>1.2.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14171011" author="apachespark" created="Tue, 14 Oct 2014 14:41:36 +0000"  >&lt;p&gt;User &apos;chenghao-intel&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/2762&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/2762&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14187902" author="marmbrus" created="Wed, 29 Oct 2014 02:12:30 +0000"  >&lt;p&gt;Issue resolved by pull request 2762&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/2762&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/2762&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14532192" author="baishuo" created="Thu, 7 May 2015 07:49:34 +0000"  >&lt;p&gt;please referrence &lt;a href=&quot;https://github.com/apache/spark/pull/5660&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5660&lt;/a&gt;, thanks&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 28 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i212a7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>