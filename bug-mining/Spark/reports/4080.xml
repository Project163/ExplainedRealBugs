<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:47:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-17612] Support `DESCRIBE table PARTITION` SQL syntax</title>
                <link>https://issues.apache.org/jira/browse/SPARK-17612</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;This issue implements `DESC PARTITION` SQL Syntax again. It was dropped since Spark 2.0.0.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Spark2.0.0&quot;&gt;&lt;/a&gt;Spark 2.0.0&lt;/h4&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;scala&amp;gt; sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE partitioned_table (a STRING, b INT) PARTITIONED BY (c STRING, d STRING)&quot;&lt;/span&gt;)
res0: org.apache.spark.sql.DataFrame = []

scala&amp;gt; sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;ALTER TABLE partitioned_table ADD PARTITION (c=&lt;span class=&quot;code-quote&quot;&gt;&apos;Us&apos;&lt;/span&gt;, d=1)&quot;&lt;/span&gt;)
res1: org.apache.spark.sql.DataFrame = []

scala&amp;gt; sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;DESC partitioned_table PARTITION (c=&lt;span class=&quot;code-quote&quot;&gt;&apos;Us&apos;&lt;/span&gt;, d=1)&quot;&lt;/span&gt;).show(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
org.apache.spark.sql.catalyst.parser.ParseException:
Unsupported SQL statement
== SQL ==
DESC partitioned_table PARTITION (c=&lt;span class=&quot;code-quote&quot;&gt;&apos;Us&apos;&lt;/span&gt;, d=1)
  at org.apache.spark.sql.catalyst.parser.AbstractSqlParser$$anonfun$parsePlan$1.apply(ParseDriver.scala:58)
  at org.apache.spark.sql.catalyst.parser.AbstractSqlParser$$anonfun$parsePlan$1.apply(ParseDriver.scala:53)
  at org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parse(ParseDriver.scala:82)
  at org.apache.spark.sql.execution.SparkSqlParser.parse(SparkSqlParser.scala:45)
  at org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parsePlan(ParseDriver.scala:53)
  at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:573)
  ... 48 elided
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;h4&gt;&lt;a name=&quot;Spark1.6.2&quot;&gt;&lt;/a&gt;Spark 1.6.2&lt;/h4&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;scala&amp;gt; sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE partitioned_table (a STRING, b INT) PARTITIONED BY (c STRING, d STRING)&quot;&lt;/span&gt;)
res1: org.apache.spark.sql.DataFrame = [result: string]

scala&amp;gt; sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;ALTER TABLE partitioned_table ADD PARTITION (c=&lt;span class=&quot;code-quote&quot;&gt;&apos;Us&apos;&lt;/span&gt;, d=1)&quot;&lt;/span&gt;)
res2: org.apache.spark.sql.DataFrame = [result: string]

scala&amp;gt; sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;DESC partitioned_table PARTITION (c=&lt;span class=&quot;code-quote&quot;&gt;&apos;Us&apos;&lt;/span&gt;, d=1)&quot;&lt;/span&gt;).show(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
16/09/20 12:48:36 WARN LazyStruct: Extra bytes detected at the end of the row! Ignoring similar problems.
+----------------------------------------------------------------+
|result                                                          |
+----------------------------------------------------------------+
|a                      string                                        |
|b                      &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;                                           |
|c                      string                                        |
|d                      string                                        |
|                                                                            |
|# Partition Information                                                      |
|# col_name             data_type               comment             |
|                                                                            |
|c                      string                                        |
|d                      string                                        |
+----------------------------------------------------------------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13006289">SPARK-17612</key>
            <summary>Support `DESCRIBE table PARTITION` SQL syntax</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dongjoon">Dongjoon Hyun</assignee>
                                    <reporter username="dongjoon">Dongjoon Hyun</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 Sep 2016 19:56:40 +0000</created>
                <updated>Fri, 28 Oct 2016 21:04:22 +0000</updated>
                            <resolved>Thu, 29 Sep 2016 22:33:17 +0000</resolved>
                                                    <fixVersion>2.0.2</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15507697" author="apachespark" created="Tue, 20 Sep 2016 20:24:06 +0000"  >&lt;p&gt;User &apos;dongjoon-hyun&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15168&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15168&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15534284" author="hvanhovell" created="Thu, 29 Sep 2016 22:33:19 +0000"  >&lt;p&gt;Resolved per Dongjoon&apos;s PR&lt;/p&gt;</comment>
                            <comment id="15546904" author="apachespark" created="Tue, 4 Oct 2016 22:44:04 +0000"  >&lt;p&gt;User &apos;dongjoon-hyun&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15351&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15351&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15616376" author="tafranky@gmail.com" created="Fri, 28 Oct 2016 19:58:32 +0000"  >&lt;p&gt;Hi  &lt;br/&gt;
Basically  I have an issue where I am performing the following operations.&lt;/p&gt;

&lt;p&gt;Partitioned Large  Hive Table (hive table 1)  &amp;#8211;  filter   &amp;#8212;    join &lt;br/&gt;
                                                                                      /    &lt;br/&gt;
                                 Non Partitioned  Large Hive Table&lt;/p&gt;

&lt;p&gt;Basically I am join 2 large tables .  Both table raw size exceed the  broadcast join threshold.&lt;br/&gt;
The filter filter a specific partition . This partition is small enough so that its size is smaller than the broadcast join threshold.&lt;/p&gt;

&lt;p&gt;With Spark 2.0 and Spark 2.0.1 , I do not see  a broadcast join . I see a  sort merge join.  &lt;br/&gt;
Which is really  surprising to me given that this could be a really common  case. You can imagine a user who has a large log table partitioned by date and he filters on a specific date. We should be able to do a broadcast join in that case. &lt;/p&gt;

&lt;p&gt;The question now is the following .  &lt;/p&gt;

&lt;p&gt;I do not think this Spark Issue addresses the cited problem but I could be wrong  . I tried incorporating the change in the spark 2.0 PR but I see the same behavior . That is no broadcast join.  &lt;/p&gt;

&lt;p&gt;Question :  Is this spark issue supposed to address the problem that I mentioned ?  &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;If not  , which i think is the case , do you know if spark currently has a fix for the cited issue.&lt;br/&gt;
I also tried the fix under   &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-15616&quot; title=&quot;CatalogRelation should fallback to HDFS size of partitions that are involved in Query if statistics are not available.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-15616&quot;&gt;&lt;del&gt;SPARK-15616&lt;/del&gt;&lt;/a&gt; but I hit a runtime failure .&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;There has got to be a solution to this problem somewhere.&lt;/p&gt;


</comment>
                            <comment id="15616422" author="dongjoon" created="Fri, 28 Oct 2016 20:09:13 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tafranky%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;tafranky@gmail.com&quot;&gt;tafranky@gmail.com&lt;/a&gt;.&lt;br/&gt;
I think you are asking about &lt;b&gt;join&lt;/b&gt; problem. Is it related to this `DESC PARTITION`?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Hi 
Basically I have an issue where I am performing the following operations.
Partitioned Large Hive Table (hive table 1) &#8211; filter &#8212; join 
/ 
Non Partitioned Large Hive Table
Basically I am join 2 large tables . Both table raw size exceed the broadcast join threshold.
The filter filter a specific partition . This partition is small enough so that its size is smaller than the broadcast join threshold.
With Spark 2.0 and Spark 2.0.1 , I &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not see a broadcast join . I see a sort merge join. 
Which is really surprising to me given that &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; could be a really common &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;. You can imagine a user who has a large log table partitioned by date and he filters on a specific date. We should be able to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; a broadcast join in that &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;.
The question now is the following .
I &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not think &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; Spark Issue addresses the cited problem but I could be wrong . I tried incorporating the change in the spark 2.0 PR but I see the same behavior . That is no broadcast join.
Question : Is &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; spark issue supposed to address the problem that I mentioned ?
If not , which i think is the &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; , &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; you know &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; spark currently has a fix &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the cited issue.
I also tried the fix under SPARK-15616 but I hit a runtime failure .
There has got to be a solution to &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; problem somewhere.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15616542" author="tafranky@gmail.com" created="Fri, 28 Oct 2016 20:56:30 +0000"  >&lt;p&gt;Hi &lt;br/&gt;
Thanks for the quick reply. So I was only trying a long shot , because I wanted to know if the join issue that i described was related somehow to this issue . I know it is not probable but just wanted to check . &lt;/p&gt;</comment>
                            <comment id="15616575" author="dongjoon" created="Fri, 28 Oct 2016 21:04:22 +0000"  >&lt;p&gt;Ah, I see. For that question, this issue isn&apos;t related to that. I think so. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13003612">SPARK-17452</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 3 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33uyf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>