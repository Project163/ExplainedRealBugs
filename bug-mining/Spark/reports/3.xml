<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:11:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-626] deleting security groups gives me a 400 error</title>
                <link>https://issues.apache.org/jira/browse/SPARK-626</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Filing on behalf of Shivaram:&lt;/p&gt;


&lt;p&gt;Deleting security group tinytasks-test-zoo&lt;br/&gt;
ERROR:boto:400 Bad Request&lt;br/&gt;
ERROR:boto:&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;Response&amp;gt;&amp;lt;Errors&amp;gt;&amp;lt;Error&amp;gt;&amp;lt;Code&amp;gt;InvalidGroup.InUse&amp;lt;/Code&amp;gt;&amp;lt;Message&amp;gt;Group 905882038624:tinytasks-test-zoo is used by groups: 905882038624:tinytasks-test-master 905882038624:tinytasks-test-slaves&amp;lt;/Message&amp;gt;&amp;lt;/Error&amp;gt;&amp;lt;/Errors&amp;gt;&amp;lt;RequestID&amp;gt;5067d547-e88c-45d0-8ef0-15db51a444c0&amp;lt;/RequestID&amp;gt;&amp;lt;/Response&amp;gt;&lt;br/&gt;
Traceback (most recent call last):&lt;br/&gt;
  File &quot;./spark_ec2.py&quot;, line 637, in &amp;lt;module&amp;gt;&lt;br/&gt;
    main()&lt;br/&gt;
  File &quot;./spark_ec2.py&quot;, line 571, in main&lt;br/&gt;
    conn.delete_security_group(group.name)&lt;br/&gt;
  File &quot;/home/shivaram/projects/tinytasks/tiny-tasks-spark/ec2/third_party/boto-2.4.1.zip/boto-2.4.1/boto/ec2/connection.py&quot;, line 2039, in delete_security_group&lt;br/&gt;
  File &quot;/home/shivaram/projects/tinytasks/tiny-tasks-spark/ec2/third_party/boto-2.4.1.zip/boto-2.4.1/boto/connection.py&quot;, line 944, in get_status&lt;br/&gt;
boto.exception.EC2ResponseError: EC2ResponseError: 400 Bad Request&lt;br/&gt;
&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;Response&amp;gt;&amp;lt;Errors&amp;gt;&amp;lt;Error&amp;gt;&amp;lt;Code&amp;gt;InvalidGroup.InUse&amp;lt;/Code&amp;gt;&amp;lt;Message&amp;gt;Group 905882038624:tinytasks-test-zoo is used by groups: 905882038624:tinytasks-test-master 905882038624:tinytasks-test-slaves&amp;lt;/Message&amp;gt;&amp;lt;/Error&amp;gt;&amp;lt;/Errors&amp;gt;&amp;lt;RequestID&amp;gt;5067d547-e88c-45d0-8ef0-15db51a444c0&amp;lt;/RequestID&amp;gt;&amp;lt;/Response&amp;gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12705385">SPARK-626</key>
            <summary>deleting security groups gives me a 400 error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pas256">Peter Sankauskas</assignee>
                                    <reporter username="rxin">Reynold Xin</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Nov 2012 21:40:22 +0000</created>
                <updated>Tue, 11 Dec 2012 12:13:57 +0000</updated>
                            <resolved>Tue, 11 Dec 2012 12:13:57 +0000</resolved>
                                                    <fixVersion>0.6.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13952797" author="joshrosen" created="Sat, 1 Dec 2012 23:32:39 +0000"  >&lt;p&gt;I ran into the same issue and tried to investigate it:&lt;/p&gt;

&lt;p&gt;There may be dependencies between security groups (e.g. allow traffic to/from another group), so these dependencies must be removed before the groups can be deleted.  The current script tries to do this, but it needs an additional for-loop: the current script removes an individual group&apos;s rules then deletes that group, but it should first remove all rules from all groups then delete all groups.&lt;/p&gt;

&lt;p&gt;I tried modifying the script to do this (&lt;a href=&quot;https://gist.github.com/4187604&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/4187604&lt;/a&gt;), but it ran into the same error.  When I ran the destroy command a second time, it successfully deleted the groups, so there may be a race condition there.&lt;/p&gt;</comment>
                            <comment id="13952791" author="pas256" created="Tue, 4 Dec 2012 11:45:15 +0000"  >&lt;p&gt;I think that Gist will work, but perhaps there needs to be a delay between the steps. I get the feeling that behind the scenes the AWS backend is using eventual consistency, which is why I didn&apos;t experience this issues but others are.&lt;/p&gt;</comment>
                            <comment id="13952623" author="matei" created="Mon, 10 Dec 2012 16:20:43 +0000"  >&lt;p&gt;Have you tried that, Peter? Would be nice to see this fixed.&lt;/p&gt;</comment>
                            <comment id="13952800" author="pas256" created="Mon, 10 Dec 2012 17:46:49 +0000"  >&lt;p&gt;Here you go:&lt;br/&gt;
&lt;a href=&quot;https://github.com/mesos/spark/pull/323&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mesos/spark/pull/323&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I tried lowering the sleep delay in between deleting the rules and deleting the groups, but anything below 30 seconds caused issues. 30 seconds seems to be as low as we can consistently go.&lt;/p&gt;</comment>
                            <comment id="13952801" author="pas256" created="Tue, 11 Dec 2012 10:54:49 +0000"  >&lt;p&gt;It turns out this is far more error prone than I first though. There are multiple dependencies in play:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;dependencies between rules in security groups&lt;/li&gt;
	&lt;li&gt;instances may not have been terminated completely when trying to delete a security group&lt;/li&gt;
	&lt;li&gt;AWS back-end eventual consistency&lt;/li&gt;
	&lt;li&gt;group.revoke() returns True even when it fails&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The unfortunate result is the code is somewhat messy. This is as clean as I can make - there are 3 retries to delete the all groups, and exceptions are caught.&lt;/p&gt;

&lt;p&gt;By default, groups will not be deleted, so most people won&apos;t experience this. You can delete groups when destroying a cluster by adding `--delete-groups`&lt;/p&gt;</comment>
                            <comment id="13952818" author="matei" created="Tue, 11 Dec 2012 12:02:37 +0000"  >&lt;p&gt;Alright, I&apos;ve merged your commit. Thanks for looking into this and fixing it!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>383582</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 50 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1u30v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>383850</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>