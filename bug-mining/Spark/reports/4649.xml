<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:51:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-19887] __HIVE_DEFAULT_PARTITION__ is not interpreted as NULL partition value in partitioned persisted tables</title>
                <link>https://issues.apache.org/jira/browse/SPARK-19887</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;The following Spark shell snippet under Spark 2.1 reproduces this issue:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;val data = Seq(
  (&lt;span class=&quot;code-quote&quot;&gt;&quot;p1&quot;&lt;/span&gt;, 1, 1),
  (&lt;span class=&quot;code-quote&quot;&gt;&quot;p2&quot;&lt;/span&gt;, 2, 2),
  (&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, 3, 3)
)

&lt;span class=&quot;code-comment&quot;&gt;// Correct &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;: Saving partitioned data to file system.
&lt;/span&gt;
val path = &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/partitioned&quot;&lt;/span&gt;

data.
  toDF(&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;c&quot;&lt;/span&gt;).
  write.
  mode(&lt;span class=&quot;code-quote&quot;&gt;&quot;overwrite&quot;&lt;/span&gt;).
  partitionBy(&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;).
  parquet(path)

spark.read.parquet(path).filter($&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;.isNotNull).show(truncate = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
&lt;span class=&quot;code-comment&quot;&gt;// +---+---+---+
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// |c  |a  |b  |
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// +---+---+---+
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// |2  |p2 |2  |
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// |1  |p1 |1  |
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// +---+---+---+
&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;// Incorrect &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;: Saving partitioned data as persisted table.
&lt;/span&gt;
data.
  toDF(&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;c&quot;&lt;/span&gt;).
  write.
  mode(&lt;span class=&quot;code-quote&quot;&gt;&quot;overwrite&quot;&lt;/span&gt;).
  partitionBy(&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;).
  saveAsTable(&lt;span class=&quot;code-quote&quot;&gt;&quot;test_null&quot;&lt;/span&gt;)

spark.table(&lt;span class=&quot;code-quote&quot;&gt;&quot;test_null&quot;&lt;/span&gt;).filter($&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;.isNotNull).show(truncate = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
&lt;span class=&quot;code-comment&quot;&gt;// +---+--------------------------+---+
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// |c  |a                         |b  |
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// +---+--------------------------+---+
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// |3  |__HIVE_DEFAULT_PARTITION__|3  |     &amp;lt;-- This line should not be here
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// |1  |p1                        |1  |
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// |2  |p2                        |2  |
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// +---+--------------------------+---+&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hive-style partitioned tables use the magic string &lt;tt&gt;&amp;#95;&amp;#95;HIVE_DEFAULT_PARTITION&amp;#95;&amp;#95;&lt;/tt&gt; to indicate &lt;tt&gt;NULL&lt;/tt&gt; partition values in partition directory names. However, in the case persisted partitioned table, this magic string is not interpreted as &lt;tt&gt;NULL&lt;/tt&gt; but a regular string.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13049732">SPARK-19887</key>
            <summary>__HIVE_DEFAULT_PARTITION__ is not interpreted as NULL partition value in partitioned persisted tables</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cloud_fan">Wenchen Fan</assignee>
                                    <reporter username="lian cheng">Cheng Lian</reporter>
                        <labels>
                            <label>correctness</label>
                    </labels>
                <created>Thu, 9 Mar 2017 19:57:43 +0000</created>
                <updated>Wed, 15 Mar 2017 02:31:14 +0000</updated>
                            <resolved>Wed, 15 Mar 2017 02:31:14 +0000</resolved>
                                    <version>2.1.0</version>
                    <version>2.2.0</version>
                                    <fixVersion>2.1.1</fixVersion>
                    <fixVersion>2.2.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15903749" author="lian cheng" created="Thu, 9 Mar 2017 19:58:02 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15907646" author="cloud_fan" created="Mon, 13 Mar 2017 15:19:56 +0000"  >&lt;p&gt;This is actually the same behavior of hive, see &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1309&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1309&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But I think it doesn&apos;t make sense to treat null as an invalid partition value, let&apos;s fix it in Spark SQL.&lt;/p&gt;</comment>
                            <comment id="15907750" author="apachespark" created="Mon, 13 Mar 2017 16:16:03 +0000"  >&lt;p&gt;User &apos;cloud-fan&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/17277&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/17277&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3b76v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12338779">2.1.1</customfieldvalue>
    <customfieldvalue id="12338275">2.2.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>