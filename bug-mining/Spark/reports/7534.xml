<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:19:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-33230] FileOutputWriter jobs have duplicate JobIDs if launched in same second</title>
                <link>https://issues.apache.org/jira/browse/SPARK-33230</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;The Hadoop S3A staging committer has problems with &amp;gt;1 spark sql query being launched simultaneously, as it uses the jobID for its path in the clusterFS to pass the commit information from tasks to job committer. &lt;/p&gt;

&lt;p&gt;If two queries are launched in the same second, they conflict and the output of job 1 includes that of all job2 files written so far; job 2 will fail with FNFE.&lt;/p&gt;

&lt;p&gt;Proposed:&lt;br/&gt;
job conf to set &lt;tt&gt;&quot;spark.sql.sources.writeJobUUID&quot;&lt;/tt&gt; to the value of &lt;tt&gt;WriteJobDescription.uuid&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;That was the property name which used to serve this purpose; any committers already written which use this property will pick it up without needing any changes.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13336928">SPARK-33230</key>
            <summary>FileOutputWriter jobs have duplicate JobIDs if launched in same second</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stevel@apache.org">Steve Loughran</assignee>
                                    <reporter username="stevel@apache.org">Steve Loughran</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Oct 2020 13:39:21 +0000</created>
                <updated>Mon, 9 Nov 2020 20:02:45 +0000</updated>
                            <resolved>Mon, 26 Oct 2020 19:32:44 +0000</resolved>
                                    <version>2.4.7</version>
                    <version>3.0.1</version>
                                    <fixVersion>2.4.8</fixVersion>
                    <fixVersion>3.0.2</fixVersion>
                    <fixVersion>3.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17219705" author="apachespark" created="Fri, 23 Oct 2020 14:16:44 +0000"  >&lt;p&gt;User &apos;steveloughran&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/30141&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/30141&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17219707" author="apachespark" created="Fri, 23 Oct 2020 14:17:17 +0000"  >&lt;p&gt;User &apos;steveloughran&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/30141&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/30141&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17220951" author="dongjoon" created="Mon, 26 Oct 2020 19:32:44 +0000"  >&lt;p&gt;Issue resolved by pull request 30141&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/30141&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/30141&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17221581" author="stevel@apache.org" created="Tue, 27 Oct 2020 17:10:44 +0000"  >&lt;p&gt;Thanks. Still got some changes to work through my side to make sure the are no assumptions that app attempt is unique.&lt;/p&gt;

&lt;p&gt;For the curious see &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-17318&quot; title=&quot;S3A committer to support concurrent jobs with same app attempt ID &amp;amp; dest dir&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-17318&quot;&gt;&lt;del&gt;HADOOP-17318&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Staging committer is using task attemptID (jobId+ taskId + task-attempt) for a path to the local temp dir&lt;/li&gt;
	&lt;li&gt;Magic committer uses app attemptId for the path under the dest/__magic dir. Only an issue once that committer allows &amp;gt;1 job to write to same dest.&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="17221963" author="dongjoon" created="Wed, 28 Oct 2020 05:54:48 +0000"  >&lt;p&gt;Thank you for sharing the status, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stevel%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;stevel@apache.org&quot;&gt;stevel@apache.org&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="17228783" author="stevel@apache.org" created="Mon, 9 Nov 2020 19:47:12 +0000"  >&lt;p&gt;Related issue: classic FileOutputCommitter has the same problem if the same destination is being used simultaneously for two jobs&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13336304">HADOOP-17318</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13339595">SPARK-33402</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="13309653">SPARK-31911</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 1 week ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0jygw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>