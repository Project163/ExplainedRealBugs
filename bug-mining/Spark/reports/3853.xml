<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:46:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-16750] ML GaussianMixture training failed due to feature column type mistake</title>
                <link>https://issues.apache.org/jira/browse/SPARK-16750</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;ML GaussianMixture training failed due to feature column type mistake. The feature column type should be &lt;tt&gt;ml.linalg.VectorUDT&lt;/tt&gt; but got &lt;tt&gt;mllib.linalg.VectorUDT&lt;/tt&gt; by mistake.&lt;br/&gt;
This bug is easy to reproduce by the following code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;val df = spark.createDataFrame(
  Seq(
    (1, Vectors.dense(0.0, 1.0, 4.0)),
    (2, Vectors.dense(1.0, 0.0, 4.0)),
    (3, Vectors.dense(1.0, 0.0, 5.0)),
    (4, Vectors.dense(0.0, 0.0, 5.0)))
).toDF(&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;features&quot;&lt;/span&gt;)

val scaler = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MinMaxScaler()
  .setInputCol(&lt;span class=&quot;code-quote&quot;&gt;&quot;features&quot;&lt;/span&gt;)
  .setOutputCol(&lt;span class=&quot;code-quote&quot;&gt;&quot;features_scaled&quot;&lt;/span&gt;)
  .setMin(0.0)
  .setMax(5.0)

val gmm = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GaussianMixture()
  .setFeaturesCol(&lt;span class=&quot;code-quote&quot;&gt;&quot;features_scaled&quot;&lt;/span&gt;)
  .setK(2)

val pipeline = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Pipeline().setStages(Array(scaler, gmm))
pipeline.fit(df)

requirement failed: Column features_scaled must be of type org.apache.spark.mllib.linalg.VectorUDT@f71b0bce but was actually org.apache.spark.ml.linalg.VectorUDT@3bfc3ba7.
java.lang.IllegalArgumentException: requirement failed: Column features_scaled must be of type org.apache.spark.mllib.linalg.VectorUDT@f71b0bce but was actually org.apache.spark.ml.linalg.VectorUDT@3bfc3ba7.
	at scala.Predef$.require(Predef.scala:224)
	at org.apache.spark.ml.util.SchemaUtils$.checkColumnType(SchemaUtils.scala:42)
	at org.apache.spark.ml.clustering.GaussianMixtureParams$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;validateAndTransformSchema(GaussianMixture.scala:64)
	at org.apache.spark.ml.clustering.GaussianMixture.validateAndTransformSchema(GaussianMixture.scala:275)
	at org.apache.spark.ml.clustering.GaussianMixture.transformSchema(GaussianMixture.scala:342)
	at org.apache.spark.ml.Pipeline$$anonfun$transformSchema$4.apply(Pipeline.scala:180)
	at org.apache.spark.ml.Pipeline$$anonfun$transformSchema$4.apply(Pipeline.scala:180)
	at scala.collection.IndexedSeqOptimized$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foldl(IndexedSeqOptimized.scala:57)
	at scala.collection.IndexedSeqOptimized$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foldLeft(IndexedSeqOptimized.scala:66)
	at scala.collection.mutable.ArrayOps$ofRef.foldLeft(ArrayOps.scala:186)
	at org.apache.spark.ml.Pipeline.transformSchema(Pipeline.scala:180)
	at org.apache.spark.ml.PipelineStage.transformSchema(Pipeline.scala:70)
	at org.apache.spark.ml.Pipeline.fit(Pipeline.scala:132)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Why the unit tests did not complain this errors? Because some estimators/transformers missed calling &lt;tt&gt;transformSchema(dataset.schema)&lt;/tt&gt; firstly during &lt;tt&gt;fit&lt;/tt&gt; or &lt;tt&gt;transform&lt;/tt&gt;. I will also add this function to all estimators/transformers who missed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12992868">SPARK-16750</key>
            <summary>ML GaussianMixture training failed due to feature column type mistake</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yanboliang">Yanbo Liang</assignee>
                                    <reporter username="yanboliang">Yanbo Liang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Jul 2016 09:43:41 +0000</created>
                <updated>Tue, 13 Sep 2016 08:17:15 +0000</updated>
                            <resolved>Fri, 29 Jul 2016 11:40:35 +0000</resolved>
                                                    <fixVersion>2.0.1</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                    <component>ML</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15395338" author="apachespark" created="Wed, 27 Jul 2016 09:53:06 +0000"  >&lt;p&gt;User &apos;yanboliang&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14378&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14378&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15399184" author="srowen" created="Fri, 29 Jul 2016 11:40:35 +0000"  >&lt;p&gt;Issue resolved by pull request 14378&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14378&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14378&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15409632" author="apachespark" created="Fri, 5 Aug 2016 16:09:06 +0000"  >&lt;p&gt;User &apos;yanboliang&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14455&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14455&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15485531" author="silversurfer" created="Mon, 12 Sep 2016 22:48:29 +0000"  >&lt;p&gt;Did this fix make it to the release version 2.0.0. If not, is there a work around for the same ?&lt;/p&gt;</comment>
                            <comment id="15485718" author="silversurfer" created="Tue, 13 Sep 2016 00:07:36 +0000"  >&lt;p&gt;It seems the release branch was cut on 19th July and this change made it post that. Any work around guys ?&lt;/p&gt;</comment>
                            <comment id="15486623" author="srowen" created="Tue, 13 Sep 2016 08:17:15 +0000"  >&lt;p&gt;You can see above that it is resolved for 2.0.1, not 2.0.0. You can also look at what branches / tags contain the commit. Not sure what you mean by workaround &amp;#8211; no, you need a version of Spark with this fix.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 10 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31k73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>