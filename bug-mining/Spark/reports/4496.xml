<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:50:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-14804] Graph vertexRDD/EdgeRDD checkpoint results ClassCastException: </title>
                <link>https://issues.apache.org/jira/browse/SPARK-14804</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    graph3.vertices.checkpoint()
    graph3.vertices.count()
    graph3.vertices.map(_._2).count()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;16/04/21 21:04:43 WARN scheduler.TaskSetManager: Lost task 0.0 in stage 4.0 (TID 13, localhost): java.lang.ClassCastException: org.apache.spark.graphx.impl.ShippableVertexPartition cannot be cast to scala.Tuple2&lt;br/&gt;
	at com.xiaomi.infra.codelab.spark.Graph2$$anonfun$main$1.apply(Graph2.scala:80)&lt;br/&gt;
	at scala.collection.Iterator$$anon$11.next(Iterator.scala:328)&lt;br/&gt;
	at org.apache.spark.util.Utils$.getIteratorSize(Utils.scala:1597)&lt;br/&gt;
	at org.apache.spark.rdd.RDD$$anonfun$count$1.apply(RDD.scala:1161)&lt;br/&gt;
	at org.apache.spark.rdd.RDD$$anonfun$count$1.apply(RDD.scala:1161)&lt;br/&gt;
	at org.apache.spark.SparkContext$$anonfun$runJob$5.apply(SparkContext.scala:1863)&lt;br/&gt;
	at org.apache.spark.SparkContext$$anonfun$runJob$5.apply(SparkContext.scala:1863)&lt;br/&gt;
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:66)&lt;br/&gt;
	at org.apache.spark.scheduler.Task.run(Task.scala:91)&lt;br/&gt;
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:219)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:745)&lt;/p&gt;


&lt;p&gt;look at the code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt;[spark] def computeOrReadCheckpoint(split: Partition, context: TaskContext): Iterator[T] =
  {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isCheckpointedAndMaterialized) {
      firstParent[T].iterator(split, context)
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
      compute(split, context)
    }
  }

 &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt;[spark] def isCheckpointedAndMaterialized: &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; = isCheckpointed

 override def isCheckpointed: &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; = {
   firstParent[(PartitionID, EdgePartition[ED, VD])].isCheckpointed
 }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;for VertexRDD or EdgeRDD, first parent is its partitionRDD  RDD[ShippableVertexPartition&lt;span class=&quot;error&quot;&gt;&amp;#91;VD&amp;#93;&lt;/span&gt;]/RDD[(PartitionID, EdgePartition&lt;span class=&quot;error&quot;&gt;&amp;#91;ED, VD&amp;#93;&lt;/span&gt;)]&lt;/p&gt;

&lt;p&gt;1. we call vertexRDD.checkpoint, it partitionRDD will checkpoint, so VertexRDD.isCheckpointedAndMaterialized=true.&lt;br/&gt;
2. then we call vertexRDD.iterator, because checkoint=true it called firstParent.iterator(which is not CheckpointRDD, actually is partitionRDD). &lt;/p&gt;

&lt;p&gt;so returned iterator is iterator&lt;span class=&quot;error&quot;&gt;&amp;#91;ShippableVertexPartition&amp;#93;&lt;/span&gt; not expect iterator&lt;span class=&quot;error&quot;&gt;&amp;#91;(VertexId, VD)&amp;#93;&lt;/span&gt;]&lt;/p&gt;</description>
                <environment></environment>
        <key id="12960758">SPARK-14804</key>
            <summary>Graph vertexRDD/EdgeRDD checkpoint results ClassCastException: </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tdas">Tathagata Das</assignee>
                                    <reporter username="SuYan">SuYan</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Apr 2016 14:00:58 +0000</created>
                <updated>Thu, 9 Feb 2017 18:53:28 +0000</updated>
                            <resolved>Thu, 26 Jan 2017 01:16:05 +0000</resolved>
                                    <version>1.6.1</version>
                                    <fixVersion>2.0.3</fixVersion>
                    <fixVersion>2.1.1</fixVersion>
                    <fixVersion>2.2.0</fixVersion>
                                    <component>GraphX</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="15253230" author="apachespark" created="Fri, 22 Apr 2016 02:47:03 +0000"  >&lt;p&gt;User &apos;suyanNone&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/12576&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/12576&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15311681" author="adeandrade" created="Thu, 2 Jun 2016 03:34:19 +0000"  >&lt;p&gt;The proposed PR is hacky. It disables independent checkpointing on VertexRDD and EdgeRDD. I have solved this issue for VertexRDD in &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-15717&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-15717&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15556429" author="apachespark" created="Fri, 7 Oct 2016 22:25:07 +0000"  >&lt;p&gt;User &apos;tdas&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15396&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15396&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15561452" author="eyalfa" created="Mon, 10 Oct 2016 06:33:33 +0000"  >&lt;p&gt;I think this relates to &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-12431&quot; title=&quot;add local checkpointing to GraphX&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-12431&quot;&gt;&lt;del&gt;SPARK-12431&lt;/del&gt;&lt;/a&gt;, is it possible to &apos;merge&apos; both efforts?&lt;/p&gt;</comment>
                            <comment id="15567714" author="apachespark" created="Wed, 12 Oct 2016 05:57:05 +0000"  >&lt;p&gt;User &apos;apivovarov&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15447&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15799094" author="josephkb" created="Wed, 4 Jan 2017 19:19:34 +0000"  >&lt;p&gt;I think this is a separate issue from local checkpointing.  The problem appears to be that Graph checkpointing incorrectly uses internal checkpointing APIs.&lt;/p&gt;</comment>
                            <comment id="15838960" author="tdas" created="Thu, 26 Jan 2017 01:16:05 +0000"  >&lt;p&gt;Issue resolved by pull request 15396&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15396&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15396&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310060">
                    <name>Container</name>
                                            <outwardlinks description="contains">
                                        <issuelink>
            <issuekey id="13012970">SPARK-17975</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12974942">SPARK-15717</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13000484">SPARK-17265</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13012970">SPARK-17975</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13011476">SPARK-17877</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2wg93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>