<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:28:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-36554] Error message while trying to use spark sql functions directly on dataframe columns without using select expression</title>
                <link>https://issues.apache.org/jira/browse/SPARK-36554</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;The below code generates a dataframe successfully . Here make_date function is used inside a select expression&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;from pyspark.sql.functions import&#160; expr, make_date&lt;/p&gt;

&lt;p&gt;df = spark.createDataFrame(&lt;span class=&quot;error&quot;&gt;&amp;#91;(2020, 6, 26), (1000, 2, 29), (-44, 1, 1)&amp;#93;&lt;/span&gt;,&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;Y&amp;#39;, &amp;#39;M&amp;#39;, &amp;#39;D&amp;#39;&amp;#93;&lt;/span&gt;)&lt;/p&gt;

&lt;p&gt;df.select(&quot;*&quot;,expr(&quot;make_date(Y,M,D) as lk&quot;)).show()&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The below code fails with a message &quot;cannot import name &apos;make_date&apos; from &apos;pyspark.sql.functions&apos;&quot; . Here the make_date function is directly called on dataframe columns without select expression&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;from pyspark.sql.functions import make_date&lt;/p&gt;

&lt;p&gt;df = spark.createDataFrame(&lt;span class=&quot;error&quot;&gt;&amp;#91;(2020, 6, 26), (1000, 2, 29), (-44, 1, 1)&amp;#93;&lt;/span&gt;,&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;Y&amp;#39;, &amp;#39;M&amp;#39;, &amp;#39;D&amp;#39;&amp;#93;&lt;/span&gt;)&lt;/p&gt;

&lt;p&gt;df.select(make_date(df.Y,df.M,df.D).alias(&quot;datefield&quot;)).show()&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
The error message generated is misleading when it says &quot;cannot  import make_date from pyspark.sql.functions&quot;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13396511">SPARK-36554</key>
            <summary>Error message while trying to use spark sql functions directly on dataframe columns without using select expression</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nicolasazrak">Nicolas Azrak</assignee>
                                    <reporter username="lekshmiii">Lekshmi Ramachandran</reporter>
                        <labels>
                            <label>documentation</label>
                            <label>features</label>
                            <label>functions</label>
                            <label>spark-sql</label>
                    </labels>
                <created>Sun, 22 Aug 2021 02:29:13 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:38 +0000</updated>
                            <resolved>Tue, 2 Nov 2021 01:53:44 +0000</resolved>
                                    <version>3.1.1</version>
                                    <fixVersion>3.3.0</fixVersion>
                                    <component>Documentation</component>
                    <component>Examples</component>
                    <component>PySpark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>
                            <timeestimate seconds="86400">24h</timeestimate>
                                        <comments>
                            <comment id="17402905" author="gurwls223" created="Mon, 23 Aug 2021 01:20:03 +0000"  >&lt;p&gt;&lt;tt&gt;make_date&lt;/tt&gt; is simply missing under &lt;tt&gt;functions.py&lt;/tt&gt;. &lt;tt&gt;functions.py&lt;/tt&gt; only contains commonly used functions.&lt;/p&gt;</comment>
                            <comment id="17432455" author="nicolasazrak" created="Thu, 21 Oct 2021 13:20:23 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lekshmiii&quot; class=&quot;user-hover&quot; rel=&quot;lekshmiii&quot;&gt;lekshmiii&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt;&#160;I&apos;ve created &lt;a href=&quot;https://github.com/apache/spark/pull/34356&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34356&lt;/a&gt;&#160;to fix this. It&apos;s my first PR, can I get a review?&lt;/p&gt;</comment>
                            <comment id="17432482" author="apachespark" created="Thu, 21 Oct 2021 13:39:54 +0000"  >&lt;p&gt;User &apos;nicolasazrak&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34356&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34356&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17432488" author="lekshmiii" created="Thu, 21 Oct 2021 13:48:02 +0000"  >&lt;p&gt;from pyspark.sql.functions import make_date&lt;/p&gt;

&lt;p&gt;df = spark.createDataFrame(&lt;span class=&quot;error&quot;&gt;&amp;#91;(2020, 6, 26), (1000, 2, 29), (-44, 1, 1)&amp;#93;&lt;/span&gt;,&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;Y&amp;#39;, &amp;#39;M&amp;#39;, &amp;#39;D&amp;#39;&amp;#93;&lt;/span&gt;)&lt;/p&gt;

&lt;p&gt;df.select(make_date(df.Y,df.M,df.D).alias(&quot;datefield&quot;)).show()&lt;/p&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nicolasazrak&quot; class=&quot;user-hover&quot; rel=&quot;nicolasazrak&quot;&gt;nicolasazrak&lt;/a&gt; so as part of the change will this code work without error message ?&lt;/p&gt;</comment>
                            <comment id="17432494" author="nicolasazrak" created="Thu, 21 Oct 2021 13:57:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lekshmiii&quot; class=&quot;user-hover&quot; rel=&quot;lekshmiii&quot;&gt;lekshmiii&lt;/a&gt;&#160;yes, that will work without errors&lt;/p&gt;</comment>
                            <comment id="17432640" author="lekshmiii" created="Thu, 21 Oct 2021 17:40:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nicolasazrak&quot; class=&quot;user-hover&quot; rel=&quot;nicolasazrak&quot;&gt;nicolasazrak&lt;/a&gt; what is the fix version ? Will it work on all versions from 3.1.1 onwards?&lt;/p&gt;</comment>
                            <comment id="17432647" author="nicolasazrak" created="Thu, 21 Oct 2021 17:55:02 +0000"  >&lt;p&gt;Depends on when it gets merged. I don&apos;t know about the spark release strategy and which fixes are cherry-picked. That should be decided by an admin&lt;/p&gt;</comment>
                            <comment id="17432714" author="lekshmiii" created="Thu, 21 Oct 2021 20:59:48 +0000"  >&lt;p&gt;@Nicolas Azrak  So how do I test if it is working ?&lt;/p&gt;</comment>
                            <comment id="17433137" author="nicolasazrak" created="Fri, 22 Oct 2021 20:12:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lekshmiii&quot; class=&quot;user-hover&quot; rel=&quot;lekshmiii&quot;&gt;lekshmiii&lt;/a&gt;&#160;I&apos;ve added a test to validate this is working. If you are using spark in a project and need this fix you would have to compile it using the patch I&apos;ve submitted in the PR.&#160;&lt;/p&gt;</comment>
                            <comment id="17437091" author="sarutak" created="Tue, 2 Nov 2021 01:53:44 +0000"  >&lt;p&gt;Issue resolved in &lt;a href=&quot;https://github.com/apache/spark/pull/34356&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34356&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13032268" name="Screen Shot .png" size="206762" author="lekshmiii" created="Sun, 22 Aug 2021 02:31:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311120" key="com.pyxis.greenhopper.jira:gh-epic-link">
                        <customfieldname>Epic Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>SPARK-38783</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>Python</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 2 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0u4h4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311620" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Shepherd</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>lekshmiii</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>