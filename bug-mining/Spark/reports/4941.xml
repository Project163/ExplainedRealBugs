<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:54:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-19688] Spark on Yarn Credentials File set to different application directory</title>
                <link>https://issues.apache.org/jira/browse/SPARK-19688</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;spark.yarn.credentials.file property is set to different application Id instead of actual Application Id &lt;/p&gt;</description>
                <environment></environment>
        <key id="13045003">SPARK-19688</key>
            <summary>Spark on Yarn Credentials File set to different application directory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="saturday_s">Xing Shi</assignee>
                                    <reporter username="j.devaraj">Devaraj Jonnadula</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Feb 2017 23:09:58 +0000</created>
                <updated>Sun, 17 May 2020 18:15:05 +0000</updated>
                            <resolved>Mon, 19 Jun 2017 17:27:50 +0000</resolved>
                                    <version>1.6.3</version>
                                    <fixVersion>1.6.4</fixVersion>
                    <fixVersion>2.0.3</fixVersion>
                    <fixVersion>2.1.2</fixVersion>
                    <fixVersion>2.2.0</fixVersion>
                    <fixVersion>2.3.0</fixVersion>
                                    <component>DStreams</component>
                    <component>Spark Core</component>
                    <component>YARN</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15877587" author="jerryshao" created="Wed, 22 Feb 2017 06:44:13 +0000"  >&lt;p&gt;Can you please elaborate the problem you met, otherwise it is hard for others to identify.&lt;/p&gt;

&lt;p&gt;Also &quot;spark.yarn.credentials.file&quot; is a internal configuration, usually user should not configure it.&lt;/p&gt;</comment>
                            <comment id="15879175" author="j.devaraj" created="Wed, 22 Feb 2017 20:36:34 +0000"  >&lt;p&gt;When Spark Application is restarted  spark.yarn.credentials.file is set to &lt;br/&gt;
hdfs://node/user/*****/.sparkStaging/application_someotherApplicationId/credentials-d8c33609-72f9-4770-9e50-aab848424e62&lt;/p&gt;

&lt;p&gt;Streaming Application with check-pointing enabled.&lt;/p&gt;</comment>
                            <comment id="15879564" author="jerryshao" created="Thu, 23 Feb 2017 00:30:17 +0000"  >&lt;p&gt;I see, so we should exclude this configuration in checkpoint and make it re-configured after restarted.&lt;/p&gt;</comment>
                            <comment id="15879883" author="jerryshao" created="Thu, 23 Feb 2017 05:13:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=j.devaraj&quot; class=&quot;user-hover&quot; rel=&quot;j.devaraj&quot;&gt;j.devaraj&lt;/a&gt;, when you say Spark application is restarted, are you pointing to yarn&apos;s reattempt mechanism or you manually restart the application?&lt;/p&gt;</comment>
                            <comment id="15879888" author="j.devaraj" created="Thu, 23 Feb 2017 05:24:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryshao&quot; class=&quot;user-hover&quot; rel=&quot;jerryshao&quot;&gt;jerryshao&lt;/a&gt; I did not check for Yarn&apos;s reattempt. I am seeing this behavior for manual restarts.&lt;/p&gt;</comment>
                            <comment id="15879893" author="jerryshao" created="Thu, 23 Feb 2017 05:31:19 +0000"  >&lt;p&gt;I see. So what issue did you encounter when you restart the application manually, or you just saw the abnormal credential configuration?&lt;/p&gt;

&lt;p&gt;From my understanding, this credential configuration will be overwritten when you restart the application, so it should be fine.&lt;/p&gt;</comment>
                            <comment id="15882027" author="jerryshao" created="Fri, 24 Feb 2017 05:54:34 +0000"  >&lt;p&gt;According to my test, &quot;spark.yarn.credentials.file&quot; will be overwritten in yarn-client to point to a correct path when launching application (&lt;a href=&quot;https://github.com/apache/spark/blob/master/resource-managers/yarn/src/main/scala/org/apache/spark/deploy/yarn/Client.scala#L737&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/resource-managers/yarn/src/main/scala/org/apache/spark/deploy/yarn/Client.scala#L737&lt;/a&gt;). So even Spark Streaming checkpoint still keeps the old configuration, it will be overwritten when the new application is started. So I don&apos;t see an issue here except this weird setting.&lt;/p&gt;</comment>
                            <comment id="15986378" author="victor-wong" created="Thu, 27 Apr 2017 11:12:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryshao&quot; class=&quot;user-hover&quot; rel=&quot;jerryshao&quot;&gt;jerryshao&lt;/a&gt;&lt;br/&gt;
In yarn-cluster mode, &quot;spark.yarn.credentials.file&quot; will be recovered from checkpoint file. It will not be overwritten when the new application is started. And there will be some unwanted behaviors:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/17782&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/17782&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15986546" author="jerryshao" created="Thu, 27 Apr 2017 12:49:26 +0000"  >&lt;p&gt;Does this issue exist in the latest master code, from the PR seems you submit a patch based on 1.6. I guess this issue could be self recovered in Spark 2.1+.&lt;/p&gt;</comment>
                            <comment id="15988421" author="victor-wong" created="Fri, 28 Apr 2017 08:40:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryshao&quot; class=&quot;user-hover&quot; rel=&quot;jerryshao&quot;&gt;jerryshao&lt;/a&gt;&lt;br/&gt;
I did not test this in Spark 2.1+, but I wrote a test suite and the result showed that it seemed the issue still exist.&lt;br/&gt;
```&lt;br/&gt;
  test(&quot;temp test&quot;) &lt;/p&gt;
{
    ssc = new StreamingContext(master, framework, batchDuration)
    ssc.conf.set(&quot;spark.yarn.credentials.file&quot;, &quot;tmp1&quot;)

    val cp = new Checkpoint(ssc, Time(1000))
    val newCp = Utils.deserialize[Checkpoint](Utils.serialize(cp))

    val newCpConf = newCp.createSparkConf()
    assert(newCpConf.get(&quot;spark.yarn.credentials.file&quot;) === &quot;tmp1&quot;)

    System.setProperty(&quot;spark.yarn.credentials.file&quot;, &quot;tmp2&quot;)
    val newCpConf2 = newCp.createSparkConf()
    assert(newCpConf2.get(&quot;spark.yarn.credentials.file&quot;) === &quot;tmp2&quot;)
  }
&lt;p&gt;```&lt;/p&gt;</comment>
                            <comment id="16042343" author="jerryshao" created="Thu, 8 Jun 2017 07:21:14 +0000"  >&lt;p&gt;The issue still exists in master branch, so reopen it.&lt;/p&gt;</comment>
                            <comment id="16042540" author="apachespark" created="Thu, 8 Jun 2017 10:56:03 +0000"  >&lt;p&gt;User &apos;saturday-shi&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/18230&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/18230&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13077937">SPARK-21008</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 23 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3aenb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>