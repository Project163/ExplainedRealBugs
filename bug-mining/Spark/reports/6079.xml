<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:02:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-21402] Fix java array of structs deserialization</title>
                <link>https://issues.apache.org/jira/browse/SPARK-21402</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I have the following schema in a dataset -&lt;/p&gt;

&lt;p&gt;root&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8211; userId: string (nullable = true)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8211; data: map (nullable = true)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8211; key: string&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8211; value: struct (valueContainsNull = true)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8211; startTime: long (nullable = true)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8211; endTime: long (nullable = true)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8211; offset: long (nullable = true)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;



&lt;p&gt; And I have the following classes (+ setter and getters which I omitted for simplicity) -&lt;/p&gt;



&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyClass {

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; userId;

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, MyDTO&amp;gt; data;

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; offset;
 }

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyDTO {

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; startTime;
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; endTime;

}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;I collect the result the following way - &lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        Encoder&amp;lt;MyClass&amp;gt; myClassEncoder = Encoders.bean(MyClass.class);
        Dataset&amp;lt;MyClass&amp;gt; results = raw_df.as(myClassEncoder);
        List&amp;lt;MyClass&amp;gt; lst = results.collectAsList();

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I do several calculations to get the result I want and the result is correct all through the way before I collect it.&lt;br/&gt;
This is the result for - &lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;results.select(results.col(&lt;span class=&quot;code-quote&quot;&gt;&quot;data&quot;&lt;/span&gt;).getField(&lt;span class=&quot;code-quote&quot;&gt;&quot;2017-07-01&quot;&lt;/span&gt;).getField(&lt;span class=&quot;code-quote&quot;&gt;&quot;startTime&quot;&lt;/span&gt;)).show(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;data&lt;span class=&quot;error&quot;&gt;&amp;#91;2017-07-01&amp;#93;&lt;/span&gt;.startTime&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;data&lt;span class=&quot;error&quot;&gt;&amp;#91;2017-07-01&amp;#93;&lt;/span&gt;.endTime&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;&lt;ins&gt;----------------------------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;-------------+&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1498854000                &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1498870800              &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;



&lt;p&gt;This is the result after collecting the reuslts for - &lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;MyClass userData = results.collectAsList().get(0);
MyDTO userDTO = userData.getData().get(&lt;span class=&quot;code-quote&quot;&gt;&quot;2017-07-01&quot;&lt;/span&gt;);
&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;userDTO startTime: &quot;&lt;/span&gt; + userDTO.getStartTime());
&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;userDTO endTime: &quot;&lt;/span&gt; + userDTO.getEndTime());

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&amp;#8211;&lt;br/&gt;
data startTime: 1498870800&lt;br/&gt;
data endTime: 1498854000&lt;/p&gt;

&lt;p&gt;I tend to believe it is a spark issue. Would love any suggestions on how to bypass it.&lt;/p&gt;</description>
                <environment>&lt;p&gt;mac os&lt;br/&gt;
spark 2.1.1&lt;br/&gt;
Using Scala version 2.11.8, Java HotSpot(TM) 64-Bit Server VM, 1.8.0_121&lt;/p&gt;</environment>
        <key id="13086910">SPARK-21402</key>
            <summary>Fix java array of structs deserialization</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vofque">Vladimir Kuriatkov</assignee>
                                    <reporter username="tomron">Tom</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Jul 2017 14:12:53 +0000</created>
                <updated>Fri, 19 Oct 2018 17:24:35 +0000</updated>
                            <resolved>Thu, 18 Oct 2018 22:12:41 +0000</resolved>
                                    <version>2.1.1</version>
                                    <fixVersion>2.2.3</fixVersion>
                    <fixVersion>2.3.3</fixVersion>
                    <fixVersion>2.4.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="16086154" author="srowen" created="Thu, 13 Jul 2017 18:24:36 +0000"  >&lt;p&gt;Your code kind of suggests you&apos;re reading this data as a different bean class &amp;#8211; getSleepStartTime isn&apos;t defined otherwise. Is that the explanation? then the mapping of fields would just be based on order, I think.&lt;/p&gt;</comment>
                            <comment id="16086179" author="tomron" created="Thu, 13 Jul 2017 18:35:31 +0000"  >&lt;p&gt;Sorry, I was trying to hide my original code so it will be more understandable (changed it now). It reads the class it is suppose to read but when collecting it the fields are mixed. &lt;/p&gt;</comment>
                            <comment id="16096162" author="tomron" created="Fri, 21 Jul 2017 11:52:07 +0000"  >&lt;p&gt;I have a small insight regarding this possible issue as I bumped into something the appeared similar to me.&lt;br/&gt;
If the class we are creating instances for has a method getX when X is not a member of this class it seems that something get messed up.&lt;br/&gt;
E.g. - I had another class with data member which is Long and static data member of type Double, I have method of the following - &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; getX() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; longDataMember / staticDouble;
    }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This alone was enough to mess my class and to assign the value of 103079215144 to all the longDataMember.&lt;/p&gt;</comment>
                            <comment id="16114179" author="tomron" created="Fri, 4 Aug 2017 09:48:31 +0000"  >&lt;p&gt;Additional comment when there are multiple datatypes which are not easily convert to one other (e.g double &amp;lt;-&amp;gt; string) the system get crazy (as well the instruction in the error message didn&apos;t help) - &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-bash&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;#
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;# A fatal error has been detected by the Java Runtime Environment:
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;#
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;#  SIGBUS (0xa) at pc=0x000000011be827bc, pid=992, tid=0x0000000000001c03
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;#
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;# JRE version: Java(TM) SE Runtime Environment (8.0_121-b13) (build 1.8.0_121-b13)
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.121-b13 mixed mode bsd-amd64 compressed oops)
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;# Problematic frame:
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;# v  ~StubRoutines::jlong_disjoint_arraycopy
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;#
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try &lt;span class=&quot;code-quote-red&quot;&gt;&quot;ulimit -c unlimited&quot;&lt;/span&gt; before starting Java again
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;#
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;# If you would like to submit a bug report, please visit:
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;#   http://bugreport.java.com/bugreport/crash.jsp
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;#&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="16121297" author="praetp" created="Thu, 10 Aug 2017 09:02:30 +0000"  >&lt;p&gt;I can confirm this problem persists in Spark 2.2.0: fields get all swapped when you use the bean encoder on a dataset with an array of structs. A plain struct works, an array of structs does not. Pretty big issue if you ask me.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;root
 |-- writeKey: string (nullable = false)
 |-- id: string (nullable = false)
 |-- type: string (nullable = false)
 |-- ssid: string (nullable = false)
+------------+------+--------+--------+
|writeKey    |id    |type    |ssid    |
+------------+------+--------+--------+
|someWriteKey|someId|someType|someSSID|
+------------+------+--------+--------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When I convert into a struct, everything is still fine:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;root
 |-- writeKey: string (nullable = false)
 |-- nodes: struct (nullable = false)
 |    |-- id: string (nullable = false)
 |    |-- type: string (nullable = false)
 |    |-- ssid: string (nullable = false)

+------------+--------------------------+
|writeKey    |nodes                     |
+------------+--------------------------+
|someWriteKey|[someId,someType,someSSID]|
+------------+--------------------------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When I do a groupBy on writeKey and a collect_set() on the nodes, we get:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;root
 |-- writeKey: string (nullable = false)
 |-- nodes: array (nullable = true)
 |    |-- element: struct (containsNull = true)
 |    |    |-- id: string (nullable = false)
 |    |    |-- type: string (nullable = false)
 |    |    |-- ssid: string (nullable = false)

+------------+----------------------------+
|writeKey    |nodes                       |
+------------+----------------------------+
|someWriteKey|[[someId,someType,someSSID]]|
+------------+----------------------------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When I convert  this to Java...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Dataset&amp;lt;Row&amp;gt; dfArray = dfStruct.groupBy(&lt;span class=&quot;code-quote&quot;&gt;&quot;writeKey&quot;&lt;/span&gt;)            .agg(functions.collect_set(&lt;span class=&quot;code-quote&quot;&gt;&quot;nodes&quot;&lt;/span&gt;).alias(&lt;span class=&quot;code-quote&quot;&gt;&quot;nodes&quot;&lt;/span&gt;));
Encoder&amp;lt;Topology&amp;gt; topologyEncoder = Encoders.bean(Topology.class);
Dataset&amp;lt;Topology&amp;gt; datasetMultiple = dfArray.as(topologyEncoder);
&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(datasetMultiple.first());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This prints:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Topology{writeKey=&apos;someWriteKey&apos;, nodes=[Node{id=&apos;someId&apos;, type=&apos;someSSID&apos;, ssid=&apos;someType&apos;}]}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;You can clearly see the type and ssid fields were swapped.&lt;/p&gt;

&lt;p&gt;POJO classes:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Topology {
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; writeKey;
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; List&amp;lt;Node&amp;gt; nodes;

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Topology() {
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getWriteKey() {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; writeKey;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setWriteKey(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; writeKey) {
            &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.writeKey = writeKey;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; List&amp;lt;Node&amp;gt; getNodes() {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; nodes;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setNodes(List&amp;lt;Node&amp;gt; nodes) {
            &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.nodes = nodes;
        }

        @Override
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; toString() {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;Topology{&quot;&lt;/span&gt; +
                    &lt;span class=&quot;code-quote&quot;&gt;&quot;writeKey=&lt;span class=&quot;code-quote&quot;&gt;&apos;&quot;&lt;/span&gt; + writeKey + &apos;&lt;/span&gt;\&apos;&apos; +
                    &lt;span class=&quot;code-quote&quot;&gt;&quot;, nodes=&quot;&lt;/span&gt; + nodes +
                    &lt;span class=&quot;code-quote&quot;&gt;&apos;}&apos;&lt;/span&gt;;
        }
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Node {
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; id;
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; type;
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; ssid;

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Node() {
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getId() {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; id;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setId(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; id) {
            &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.id = id;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getType() {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; type;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setType(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; type) {
            &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.type = type;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getSsid() {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; ssid;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setSsid(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; ssid) {
            &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.ssid = ssid;
        }


        @Override
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; toString() {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;Node{&quot;&lt;/span&gt; +
                    &lt;span class=&quot;code-quote&quot;&gt;&quot;id=&lt;span class=&quot;code-quote&quot;&gt;&apos;&quot;&lt;/span&gt; + id + &apos;&lt;/span&gt;\&apos;&apos; +
                    &lt;span class=&quot;code-quote&quot;&gt;&quot;, type=&lt;span class=&quot;code-quote&quot;&gt;&apos;&quot;&lt;/span&gt; + type + &apos;&lt;/span&gt;\&apos;&apos; +
                    &lt;span class=&quot;code-quote&quot;&gt;&quot;, ssid=&lt;span class=&quot;code-quote&quot;&gt;&apos;&quot;&lt;/span&gt; + ssid + &apos;&lt;/span&gt;\&apos;&apos; +
                    &lt;span class=&quot;code-quote&quot;&gt;&apos;}&apos;&lt;/span&gt;;
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="16121401" author="praetp" created="Thu, 10 Aug 2017 10:16:05 +0000"  >&lt;p&gt;It seems changing the order of the fields in the struct can give some improvements but when I add more fields, the problem just gets worse - some fields just never get filled in or twice.&lt;/p&gt;</comment>
                            <comment id="16636957" author="praetp" created="Wed, 3 Oct 2018 13:32:52 +0000"  >&lt;p&gt;Still there in Spark 2.3.1.&lt;/p&gt;</comment>
                            <comment id="16646337" author="vofque" created="Thu, 11 Oct 2018 11:56:25 +0000"  >&lt;p&gt;Working on this issue.&lt;/p&gt;

&lt;p&gt;The problem can be solved by using unresolved expressions instead of resolved expressions for ArrayType and MapType when building java bean deserializer.&lt;/p&gt;

&lt;p&gt;In this case struct data type of array elements or map&apos;s keys/values is defined during &quot;analysis&quot; and is based on actual data, not on java bean.&lt;/p&gt;

&lt;p&gt;The same approach is currently used to define struct data types of nested structs. In case of array elements or map&apos;s keys/values&#160;struct data types are currently extracted from java beans, hence we get incorrect field order.&lt;/p&gt;</comment>
                            <comment id="16647838" author="apachespark" created="Fri, 12 Oct 2018 12:07:45 +0000"  >&lt;p&gt;User &apos;vofque&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22708&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22708&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16647839" author="apachespark" created="Fri, 12 Oct 2018 12:08:18 +0000"  >&lt;p&gt;User &apos;vofque&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22708&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22708&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16651546" author="apachespark" created="Tue, 16 Oct 2018 11:43:18 +0000"  >&lt;p&gt;User &apos;vofque&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22745&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16651550" author="apachespark" created="Tue, 16 Oct 2018 11:44:09 +0000"  >&lt;p&gt;User &apos;vofque&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22745&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16653749" author="cloud_fan" created="Wed, 17 Oct 2018 15:41:05 +0000"  >&lt;p&gt;Issue resolved by pull request 22708&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22708&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22708&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16655295" author="vofque" created="Thu, 18 Oct 2018 14:20:41 +0000"  >&lt;p&gt;I guess, only array case&#160;has been&#160;fixed yet, the&#160;initial map case is still in progress.&lt;/p&gt;</comment>
                            <comment id="16655314" author="cloud_fan" created="Thu, 18 Oct 2018 14:29:46 +0000"  >&lt;p&gt;Can you create a ticket for the map case? Basically what we need is to resolve the todo at &lt;a href=&quot;https://github.com/apache/spark/blob/v2.4.0-rc3/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/ScalaReflection.scala#L202&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/v2.4.0-rc3/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/ScalaReflection.scala#L202&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16655322" author="cloud_fan" created="Thu, 18 Oct 2018 14:34:04 +0000"  >&lt;p&gt;oh this ticket reports the bug for map type. I&apos;m reopening it. Can you create a ticket for the array type?&lt;/p&gt;</comment>
                            <comment id="16655380" author="apachespark" created="Thu, 18 Oct 2018 15:08:03 +0000"  >&lt;p&gt;User &apos;vofque&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22767&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22767&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16655382" author="apachespark" created="Thu, 18 Oct 2018 15:09:14 +0000"  >&lt;p&gt;User &apos;vofque&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22768&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22768&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16655383" author="apachespark" created="Thu, 18 Oct 2018 15:09:33 +0000"  >&lt;p&gt;User &apos;vofque&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22768&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22768&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16655845" author="dongjoon" created="Thu, 18 Oct 2018 20:46:08 +0000"  >&lt;p&gt;I cloned this JIRA issue. Can we do like the followings? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vofque&quot; class=&quot;user-hover&quot; rel=&quot;vofque&quot;&gt;vofque&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srowen&quot; class=&quot;user-hover&quot; rel=&quot;srowen&quot;&gt;srowen&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tomron&quot; class=&quot;user-hover&quot; rel=&quot;tomron&quot;&gt;tomron&lt;/a&gt;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-21402&quot; title=&quot;Fix java array of structs deserialization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-21402&quot;&gt;&lt;del&gt;SPARK-21402&lt;/del&gt;&lt;/a&gt; (this) for `Fix java array of structs deserialization`&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-25772&quot; title=&quot;Java encoders - switch fields on collectAsList&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-25772&quot;&gt;&lt;del&gt;SPARK-25772&lt;/del&gt;&lt;/a&gt; (new cloned one) for the original Map issue?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16655855" author="dongjoon" created="Thu, 18 Oct 2018 20:48:33 +0000"  >&lt;p&gt;We already committed with SPARK JIRA ID, &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-21402&quot; title=&quot;Fix java array of structs deserialization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-21402&quot;&gt;&lt;del&gt;SPARK-21402&lt;/del&gt;&lt;/a&gt;. Too bad.&lt;/p&gt;</comment>
                            <comment id="16656314" author="cloud_fan" created="Fri, 19 Oct 2018 06:07:16 +0000"  >&lt;p&gt;LGTM, thanks for doing it &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt; !&lt;/p&gt;</comment>
                            <comment id="16657147" author="dongjoon" created="Fri, 19 Oct 2018 17:24:35 +0000"  >&lt;p&gt;Thank you for confirming, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="13192682">SPARK-25772</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13094989">SPARK-21747</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 4 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3hhf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>