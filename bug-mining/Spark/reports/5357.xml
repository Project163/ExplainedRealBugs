<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:57:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-22289] Cannot save LogisticRegressionModel with bounds on coefficients</title>
                <link>https://issues.apache.org/jira/browse/SPARK-22289</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I think this was introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-20047&quot; title=&quot;Constrained Logistic Regression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-20047&quot;&gt;&lt;del&gt;SPARK-20047&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Trying to call save on a logistic regression model trained with bounds on its parameters throws an error. This seems to be because Spark doesn&apos;t know how to serialize the Matrix parameter.&lt;/p&gt;

&lt;p&gt;Model is set up like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    val calibrator = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LogisticRegression()
      .setFeaturesCol(&lt;span class=&quot;code-quote&quot;&gt;&quot;uncalibrated_probability&quot;&lt;/span&gt;)
      .setLabelCol(&lt;span class=&quot;code-quote&quot;&gt;&quot;label&quot;&lt;/span&gt;)
      .setWeightCol(&lt;span class=&quot;code-quote&quot;&gt;&quot;weight&quot;&lt;/span&gt;)
      .setStandardization(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
      .setLowerBoundsOnCoefficients(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DenseMatrix(1, 1, Array(0.0)))
      .setFamily(&lt;span class=&quot;code-quote&quot;&gt;&quot;binomial&quot;&lt;/span&gt;)
      .setProbabilityCol(&lt;span class=&quot;code-quote&quot;&gt;&quot;probability&quot;&lt;/span&gt;)
      .setPredictionCol(&lt;span class=&quot;code-quote&quot;&gt;&quot;logistic_prediction&quot;&lt;/span&gt;)
      .setRawPredictionCol(&lt;span class=&quot;code-quote&quot;&gt;&quot;logistic_raw_prediction&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
17/10/16 15:36:59 ERROR ApplicationMaster: User &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;threw exception: scala.NotImplementedError: The &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; jsonEncode only supports string and vector. org.apache.spark.ml.param.Param must override jsonEncode &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; org.apache.spark.ml.linalg.DenseMatrix.
scala.NotImplementedError: The &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; jsonEncode only supports string and vector. org.apache.spark.ml.param.Param must override jsonEncode &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; org.apache.spark.ml.linalg.DenseMatrix.
	at org.apache.spark.ml.param.Param.jsonEncode(params.scala:98)
	at org.apache.spark.ml.util.DefaultParamsWriter$$anonfun$1$$anonfun$2.apply(ReadWrite.scala:296)
	at org.apache.spark.ml.util.DefaultParamsWriter$$anonfun$1$$anonfun$2.apply(ReadWrite.scala:295)
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
	at scala.collection.mutable.ResizableArray$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreach(ResizableArray.scala:59)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)
	at scala.collection.TraversableLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;map(TraversableLike.scala:234)
	at scala.collection.AbstractTraversable.map(Traversable.scala:104)
	at org.apache.spark.ml.util.DefaultParamsWriter$$anonfun$1.apply(ReadWrite.scala:295)
	at org.apache.spark.ml.util.DefaultParamsWriter$$anonfun$1.apply(ReadWrite.scala:295)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.ml.util.DefaultParamsWriter$.getMetadataToSave(ReadWrite.scala:295)
	at org.apache.spark.ml.util.DefaultParamsWriter$.saveMetadata(ReadWrite.scala:277)
	at org.apache.spark.ml.classification.LogisticRegressionModel$LogisticRegressionModelWriter.saveImpl(LogisticRegression.scala:1182)
	at org.apache.spark.ml.util.MLWriter.save(ReadWrite.scala:114)
	at org.apache.spark.ml.Pipeline$SharedReadWrite$$anonfun$saveImpl$1.apply(Pipeline.scala:254)
	at org.apache.spark.ml.Pipeline$SharedReadWrite$$anonfun$saveImpl$1.apply(Pipeline.scala:253)
	at scala.collection.IndexedSeqOptimized$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreach(IndexedSeqOptimized.scala:33)
	at scala.collection.mutable.ArrayOps$ofRef.foreach(ArrayOps.scala:186)
	at org.apache.spark.ml.Pipeline$SharedReadWrite$.saveImpl(Pipeline.scala:253)
	at org.apache.spark.ml.PipelineModel$PipelineModelWriter.saveImpl(Pipeline.scala:337)
	at org.apache.spark.ml.util.MLWriter.save(ReadWrite.scala:114)
	-snip-
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13109795">SPARK-22289</key>
            <summary>Cannot save LogisticRegressionModel with bounds on coefficients</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yuhaoyan">yuhao yang</assignee>
                                    <reporter username="nseggert">Nic Eggert</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Oct 2017 20:46:18 +0000</created>
                <updated>Thu, 8 Feb 2018 01:32:05 +0000</updated>
                            <resolved>Tue, 12 Dec 2017 19:28:35 +0000</resolved>
                                    <version>2.2.0</version>
                                    <fixVersion>2.2.2</fixVersion>
                    <fixVersion>2.3.0</fixVersion>
                                    <component>ML</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16207063" author="yuhaoyan" created="Tue, 17 Oct 2017 06:05:28 +0000"  >&lt;p&gt;Thanks for reporting the issue. Should be a straight-forward fix. Yet maybe we should cover it better in release QA.&lt;/p&gt;

&lt;p&gt;There&apos;re two ways to support this as I see:&lt;br/&gt;
1. Support save/load on LogisticRegressionParams, and also adjust the save/load in LogisticRegression and LogisticRegressionModel.&lt;/p&gt;

&lt;p&gt;2. Directly support Matrix in Param.jsonEncode, similar to what we have done for Vector.&lt;/p&gt;

&lt;p&gt;IMO we need to collect opinions before sending a fix. Welcome to send other options.&lt;/p&gt;

&lt;p&gt;I&apos;m leaning towards 2, for simplicity and convenience for other classes. &lt;/p&gt;</comment>
                            <comment id="16207115" author="yuhaoyan" created="Tue, 17 Oct 2017 07:27:17 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yanboliang&quot; class=&quot;user-hover&quot; rel=&quot;yanboliang&quot;&gt;yanboliang&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dbtsai&quot; class=&quot;user-hover&quot; rel=&quot;dbtsai&quot;&gt;dbtsai&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16207133" author="mlnick" created="Tue, 17 Oct 2017 07:45:06 +0000"  >&lt;p&gt;I think option (2) is the more general fix here.&lt;/p&gt;</comment>
                            <comment id="16208601" author="yanboliang" created="Tue, 17 Oct 2017 23:44:03 +0000"  >&lt;p&gt;+1 for option 2. Please feel free to send a PR. Thanks.&lt;/p&gt;</comment>
                            <comment id="16208614" author="yuhaoyan" created="Tue, 17 Oct 2017 23:58:44 +0000"  >&lt;p&gt;Thanks for the reply. I&apos;ll start compose a PR.&lt;/p&gt;</comment>
                            <comment id="16208898" author="apachespark" created="Wed, 18 Oct 2017 07:01:03 +0000"  >&lt;p&gt;User &apos;hhbyyh&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/19525&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/19525&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 4 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3lbqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311620" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Shepherd</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>yanboliang</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>