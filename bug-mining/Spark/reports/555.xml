<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:16:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-2678] `Spark-submit` overrides user application options</title>
                <link>https://issues.apache.org/jira/browse/SPARK-2678</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Here is an example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;./bin/spark-submit --&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo some.jar --help
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;SInce &lt;tt&gt;--help&lt;/tt&gt; appears behind the primary resource (i.e. &lt;tt&gt;some.jar&lt;/tt&gt;), it should be recognized as a user application option. But it&apos;s actually overriden by &lt;tt&gt;spark-submit&lt;/tt&gt; and will show &lt;tt&gt;spark-submit&lt;/tt&gt; help message.&lt;/p&gt;

&lt;p&gt;When directly invoking &lt;tt&gt;spark-submit&lt;/tt&gt;, the constraints here are:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Options before primary resource should be recognized as &lt;tt&gt;spark-submit&lt;/tt&gt; options&lt;/li&gt;
	&lt;li&gt;Options after primary resource should be recognized as user application options&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;The tricky part is how to handle scripts like &lt;tt&gt;spark-shell&lt;/tt&gt; that delegate  &lt;tt&gt;spark-submit&lt;/tt&gt;. These scripts allow users specify both &lt;tt&gt;spark-submit&lt;/tt&gt; options like &lt;tt&gt;--master&lt;/tt&gt; and user defined application options together. For example, say we&apos;d like to write a new script &lt;tt&gt;start-thriftserver.sh&lt;/tt&gt; to start the Hive Thrift server, basically we may do this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$SPARK_HOME/bin/spark-submit --&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.spark.sql.hive.thriftserver.HiveThriftServer2 spark-internal $@
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Then user may call this script like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;./sbin/start-thriftserver.sh --master spark:&lt;span class=&quot;code-comment&quot;&gt;//some-host:7077 --hiveconf key=value&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Notice that all options are captured by &lt;tt&gt;$@&lt;/tt&gt;. If we put it before &lt;tt&gt;spark-internal&lt;/tt&gt;, they are all recognized as &lt;tt&gt;spark-submit&lt;/tt&gt; options, thus &lt;tt&gt;-&lt;del&gt;hiveconf&lt;/tt&gt; won&apos;t be passed to &lt;tt&gt;HiveThriftServer2&lt;/tt&gt;; if we put it after &lt;tt&gt;spark-internal&lt;/tt&gt;, they &lt;b&gt;should&lt;/b&gt; all be recognized as options of &lt;tt&gt;HiveThriftServer2&lt;/tt&gt;, but because of this bug, &lt;tt&gt;&lt;/del&gt;-master&lt;/tt&gt; is still recognized as &lt;tt&gt;spark-submit&lt;/tt&gt; option and leads to the right behavior.&lt;/p&gt;

&lt;p&gt;Although currently all scripts using &lt;tt&gt;spark-submit&lt;/tt&gt; work correctly, we still should fix this bug, because it causes option name collision between &lt;tt&gt;spark-submit&lt;/tt&gt; and user application, and every time we add a new option to &lt;tt&gt;spark-submit&lt;/tt&gt;, some existing user applications may break. However, solving this bug may cause some incompatible changes.&lt;/p&gt;

&lt;p&gt;The suggested solution here is using &lt;tt&gt;--&lt;/tt&gt; as separator of &lt;tt&gt;spark-submit&lt;/tt&gt; options and user application options. For the Hive Thrift server example above, user should call it in this way:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;./sbin/start-thriftserver.sh --master spark:&lt;span class=&quot;code-comment&quot;&gt;//some-host:7077 -- --hiveconf key=value&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And &lt;tt&gt;SparkSubmitArguments&lt;/tt&gt; should be responsible for splitting two sets of options and pass them correctly.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12729602">SPARK-2678</key>
            <summary>`Spark-submit` overrides user application options</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sarutak">Kousuke Saruta</assignee>
                                    <reporter username="lian cheng">Cheng Lian</reporter>
                        <labels>
                    </labels>
                <created>Thu, 24 Jul 2014 22:59:03 +0000</created>
                <updated>Fri, 15 Aug 2014 18:54:55 +0000</updated>
                            <resolved>Thu, 7 Aug 2014 23:03:03 +0000</resolved>
                                    <version>1.0.1</version>
                    <version>1.0.2</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>Deploy</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14081302" author="apachespark" created="Thu, 31 Jul 2014 19:21:00 +0000"  >&lt;p&gt;User &apos;liancheng&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/1699&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1699&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14082123" author="apachespark" created="Fri, 1 Aug 2014 10:36:09 +0000"  >&lt;p&gt;User &apos;liancheng&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/1715&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1715&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14088103" author="pwendell" created="Wed, 6 Aug 2014 19:29:44 +0000"  >&lt;p&gt;Fixed in 1.1.0 via:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/1801&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1801&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14088970" author="apachespark" created="Thu, 7 Aug 2014 07:41:53 +0000"  >&lt;p&gt;User &apos;liancheng&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/1831&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1831&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14090005" author="pwendell" created="Thu, 7 Aug 2014 23:02:59 +0000"  >&lt;p&gt;Fixed in 1.0.3 via:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/1831&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1831&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14091318" author="apachespark" created="Fri, 8 Aug 2014 21:27:14 +0000"  >&lt;p&gt;User &apos;chutium&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/1861&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1861&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14091997" author="pwendell" created="Sun, 10 Aug 2014 04:17:03 +0000"  >&lt;p&gt;This issue was fixed by:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/1825&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1825&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12732450">SPARK-2894</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12732279">SPARK-2880</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12720547">SPARK-2110</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12732219">SPARK-2874</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>407676</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 15 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1y5fb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>407686</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12326686">1.1.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>