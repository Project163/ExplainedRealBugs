<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:51:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-19701] the `in` operator in pyspark is broken</title>
                <link>https://issues.apache.org/jira/browse/SPARK-19701</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt;&amp;gt;&amp;gt; textFile = spark.read.text(&lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/cloud/dev/spark/README.md&quot;&lt;/span&gt;)
&amp;gt;&amp;gt;&amp;gt; linesWithSpark = textFile.filter(&lt;span class=&quot;code-quote&quot;&gt;&quot;Spark&quot;&lt;/span&gt; in textFile.value)
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;stdin&amp;gt;&quot;&lt;/span&gt;, line 1, in &amp;lt;module&amp;gt;
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/cloud/product/spark/python/pyspark/sql/column.py&quot;&lt;/span&gt;, line 426, in __nonzero__
    raise ValueError(&lt;span class=&quot;code-quote&quot;&gt;&quot;Cannot convert column into bool: please use &lt;span class=&quot;code-quote&quot;&gt;&apos;&amp;amp;&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;and&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;|&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;or&apos;&lt;/span&gt;, &quot;&lt;/span&gt;
ValueError: Cannot convert column into bool: please use &lt;span class=&quot;code-quote&quot;&gt;&apos;&amp;amp;&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;and&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;|&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;or&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;~&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;not&apos;&lt;/span&gt; when building DataFrame &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; expressions.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13045436">SPARK-19701</key>
            <summary>the `in` operator in pyspark is broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gurwls223">Hyukjin Kwon</assignee>
                                    <reporter username="cloud_fan">Wenchen Fan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Feb 2017 23:26:15 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:34 +0000</updated>
                            <resolved>Mon, 6 Mar 2017 02:05:08 +0000</resolved>
                                    <version>2.2.0</version>
                                    <fixVersion>2.2.0</fixVersion>
                                    <component>PySpark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15894155" author="gurwls223" created="Fri, 3 Mar 2017 11:07:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt;, I took a look this for my curiosity. It seems this is what happens now :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Column(object):
    def __contains__(self, item):
        print &lt;span class=&quot;code-quote&quot;&gt;&quot;I am contains&quot;&lt;/span&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Column()
    def __nonzero__(self):
        raise Exception(&lt;span class=&quot;code-quote&quot;&gt;&quot;I am nonzero.&quot;&lt;/span&gt;)

&amp;gt;&amp;gt;&amp;gt; 1 in Column()
I am contains
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;stdin&amp;gt;&quot;&lt;/span&gt;, line 1, in &amp;lt;module&amp;gt;
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;stdin&amp;gt;&quot;&lt;/span&gt;, line 6, in __nonzero__
Exception: I am nonzero.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It seems it calls &lt;tt&gt;_&lt;em&gt;contains&lt;/em&gt;&lt;em&gt;&lt;/tt&gt; first and then &lt;tt&gt;&lt;/em&gt;&lt;em&gt;nonzero&lt;/em&gt;&lt;em&gt;&lt;/tt&gt; or &lt;tt&gt;&lt;/em&gt;&lt;em&gt;bool&lt;/em&gt;_&lt;/tt&gt; is being called against &lt;tt&gt;Column()&lt;/tt&gt;&lt;br/&gt;
to make this a bool.&lt;/p&gt;

&lt;p&gt;It seems &lt;tt&gt;_&lt;em&gt;nonzero&lt;/em&gt;&lt;em&gt;&lt;/tt&gt; (for Python 2), &lt;tt&gt;&lt;/em&gt;&lt;em&gt;bool&lt;/em&gt;&lt;em&gt;&lt;/tt&gt; (for Python 3) and &lt;tt&gt;&lt;/em&gt;&lt;em&gt;contains&lt;/em&gt;_&lt;/tt&gt; forcing the the return&lt;br/&gt;
into a bool unlike other operators.&lt;/p&gt;

&lt;p&gt;I also referred the references as below to check my assumption and little knowledge:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/12244074/python-source-code-for-built-in-in-operator/12244378#12244378&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/12244074/python-source-code-for-built-in-in-operator/12244378#12244378&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://stackoverflow.com/questions/38542543/functionality-of-python-in-vs-contains/38542777&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/38542543/functionality-of-python-in-vs-contains/38542777&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I tested the codes above in 1.6.3, 2.1.0 and in the master branch. It seems it has not been working so far.&lt;/p&gt;

&lt;p&gt;Should we maybe remove this?&lt;/p&gt;</comment>
                            <comment id="15894159" author="gurwls223" created="Fri, 3 Mar 2017 11:11:07 +0000"  >&lt;p&gt;I was thinking a way to work around (e.g., hijacking..) but it seems we can&apos;t.&lt;br/&gt;
BTW, the below codes seems throwing a &lt;tt&gt;TypeError&lt;/tt&gt; if &lt;tt&gt;_&lt;em&gt;nonzero&lt;/em&gt;&lt;em&gt;&lt;/tt&gt; or &lt;tt&gt;&lt;/em&gt;&lt;em&gt;bool&lt;/em&gt;_&lt;/tt&gt; returns other types.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Column(object):
    def __contains__(self, item):
        print &lt;span class=&quot;code-quote&quot;&gt;&quot;I am contains&quot;&lt;/span&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Column()
    def __nonzero__(self):
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;

&amp;gt;&amp;gt;&amp;gt; 1 in Column()
I am contains
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;stdin&amp;gt;&quot;&lt;/span&gt;, line 1, in &amp;lt;module&amp;gt;
TypeError: __nonzero__ should &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; bool or &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, returned str
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15894796" author="cloud_fan" created="Fri, 3 Mar 2017 18:17:04 +0000"  >&lt;p&gt;let&apos;s remove it then&lt;/p&gt;</comment>
                            <comment id="15895494" author="apachespark" created="Sat, 4 Mar 2017 03:58:02 +0000"  >&lt;p&gt;User &apos;HyukjinKwon&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/17160&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/17160&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15896644" author="cloud_fan" created="Mon, 6 Mar 2017 02:05:08 +0000"  >&lt;p&gt;Issue resolved by pull request 17160&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/17160&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/17160&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 37 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ahan:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>