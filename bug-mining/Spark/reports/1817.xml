<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:27:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-7375] Avoid defensive copying in SQL exchange operator when sort-based shuffle buffers data in serialized form</title>
                <link>https://issues.apache.org/jira/browse/SPARK-7375</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;The original sort-based shuffle buffers shuffle input records in memory while sorting them. This causes problems when mutable records are presented to the shuffle, which happens in Spark SQL&apos;s Exchange operator. To work around this issue, &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-2967&quot; title=&quot;Several SQL unit test failed when sort-based shuffle is enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-2967&quot;&gt;&lt;del&gt;SPARK-2967&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-4479&quot; title=&quot;Avoid unnecessary defensive copies when Sort based shuffle is on&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-4479&quot;&gt;&lt;del&gt;SPARK-4479&lt;/del&gt;&lt;/a&gt; added defensive copying of shuffle inputs in the Exchange operator when sort-based shuffle is enabled.&lt;/p&gt;

&lt;p&gt;I think that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sandyr&quot; class=&quot;user-hover&quot; rel=&quot;sandyr&quot;&gt;sandyr&lt;/a&gt;&apos;s recent patch for enabling serialization of records in sort-based shuffle (&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-4550&quot; title=&quot;In sort-based shuffle, store map outputs in serialized form&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-4550&quot;&gt;&lt;del&gt;SPARK-4550&lt;/del&gt;&lt;/a&gt;) and my proposed &lt;tt&gt;unsafe&lt;/tt&gt;-based shuffle path (&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-7081&quot; title=&quot;Faster sort-based shuffle path using binary processing cache-aware sort&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-7081&quot;&gt;&lt;del&gt;SPARK-7081&lt;/del&gt;&lt;/a&gt;) may allow us to avoid this defensive copying in certain cases (since our patches cause records to be serialized one-at-a-time and remove the buffering of deserialized records).&lt;/p&gt;

&lt;p&gt;As mentioned in &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-4479&quot; title=&quot;Avoid unnecessary defensive copies when Sort based shuffle is on&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-4479&quot;&gt;&lt;del&gt;SPARK-4479&lt;/del&gt;&lt;/a&gt;, a long-term fix for this issue might be to add hooks for informing the shuffle about object (im)mutability in order to allow the shuffle layer to decide whether to copy. In the meantime, though, I think that we should just extend the checks added in &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-4479&quot; title=&quot;Avoid unnecessary defensive copies when Sort based shuffle is on&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-4479&quot;&gt;&lt;del&gt;SPARK-4479&lt;/del&gt;&lt;/a&gt; to avoid copies when these new serialized sort paths are used.&lt;/p&gt;

&lt;p&gt;/cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rxin&quot; class=&quot;user-hover&quot; rel=&quot;rxin&quot;&gt;rxin&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marmbrus&quot; class=&quot;user-hover&quot; rel=&quot;marmbrus&quot;&gt;marmbrus&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yhuai&quot; class=&quot;user-hover&quot; rel=&quot;yhuai&quot;&gt;yhuai&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12827420">SPARK-7375</key>
            <summary>Avoid defensive copying in SQL exchange operator when sort-based shuffle buffers data in serialized form</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="joshrosen">Josh Rosen</assignee>
                                    <reporter username="joshrosen">Josh Rosen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 May 2015 20:41:14 +0000</created>
                <updated>Sat, 9 May 2015 02:10:35 +0000</updated>
                            <resolved>Sat, 9 May 2015 02:10:35 +0000</resolved>
                                                    <fixVersion>1.4.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14531303" author="apachespark" created="Wed, 6 May 2015 20:05:33 +0000"  >&lt;p&gt;User &apos;JoshRosen&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/5948&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5948&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14536113" author="yhuai" created="Sat, 9 May 2015 02:10:35 +0000"  >&lt;p&gt;Issue resolved by pull request 5948&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/5948&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5948&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311120" key="com.pyxis.greenhopper.jira:gh-epic-link">
                        <customfieldname>Epic Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>SPARK-7075</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 28 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ebo7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12329359">1.4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>