<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:59:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-6951] History server slow startup if the event log directory is large</title>
                <link>https://issues.apache.org/jira/browse/SPARK-6951</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I started my history server, then navigated to the web UI where I expected to be able to view some completed applications, but the webpage was not available. It turned out that the History Server was not finished parsing all of the event logs in the event log directory that I had specified. I had accumulated a lot of event logs from months of running Spark, so it would have taken a very long time for the History Server to crunch through them all. I purged the event log directory and started from scratch, and the UI loaded immediately.&lt;/p&gt;

&lt;p&gt;We should have a pagination strategy or parse the directory lazily to avoid needing to wait after starting the history server.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12821345">SPARK-6951</key>
            <summary>History server slow startup if the event log directory is large</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vanzin">Marcelo Masiero Vanzin</assignee>
                                    <reporter username="mcheah">Matt Cheah</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Apr 2015 22:37:58 +0000</created>
                <updated>Wed, 11 Apr 2018 14:49:55 +0000</updated>
                            <resolved>Wed, 11 Apr 2018 14:49:55 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>2.4.0</fixVersion>
                                    <component>Web UI</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>23</watches>
                                                                                                                <comments>
                            <comment id="14497265" author="srowen" created="Wed, 15 Apr 2015 23:12:11 +0000"  >&lt;p&gt;Not exactly the same thing, but automatically cleaning up logs is addressed in &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-3562&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-3562&lt;/a&gt; and kind of fixes the &apos;freeze&apos; problem.&lt;/p&gt;</comment>
                            <comment id="14608287" author="tgraves" created="Tue, 30 Jun 2015 13:43:17 +0000"  >&lt;p&gt;This actually happens more then just at start up.  If you have  large number of files, especially in progress files.  Or even just large history files, it takes forever for the history server to pick up new completed ones and show on the UI. &lt;/p&gt;</comment>
                            <comment id="14710255" author="vladio" created="Mon, 24 Aug 2015 23:20:14 +0000"  >&lt;p&gt;I think this was solved in: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-5522&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-5522&lt;/a&gt;, but it was released in Spark 1.4, while you were using Spark 1.3 at that moment. I&apos;ve also tried to reproduce this locally (with ~5000 log files) but I couldn&apos;t get the expected behavior. I&apos;m not extremely sure about this, but I thought is good to post this here! (thumbsup)&lt;/p&gt;</comment>
                            <comment id="14711226" author="tgraves" created="Tue, 25 Aug 2015 13:05:17 +0000"  >&lt;p&gt;I&apos;m running Spark 1.4.1 history server in production and its still very slow to start up and pick up new versions, especially when there are very large history files.  I haven&apos;t looked at the implementation but it seems like it would be better for the history server to just read some metadata and display it in the list and then when the user clicks on it load the entire thing.  Especially for very large ones.  Or keep a certain number loaded in the background.  &lt;/p&gt;</comment>
                            <comment id="14711292" author="tgraves" created="Tue, 25 Aug 2015 13:53:10 +0000"  >&lt;p&gt;Sorry I was wrong.. I just went and tested it and it does start up fairly quickly now.  I&apos;m having problems with it getting stuck reading large files which is a separate issue.&lt;/p&gt;</comment>
                            <comment id="14935359" author="tgraves" created="Tue, 29 Sep 2015 15:57:59 +0000"  >&lt;p&gt;I&apos;m still seeing history server startup really slow in 1.5.1... &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-5522&quot; title=&quot;Accelerate the History Server start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-5522&quot;&gt;&lt;del&gt;SPARK-5522&lt;/del&gt;&lt;/a&gt; may have helped although I don&apos;t see it showing  list of application names in the UI without the data from those so not sure if that pr did what description says.&lt;/p&gt;

&lt;p&gt;It would be really nice is it could get metadata without having to parse the entire log. &lt;/p&gt;</comment>
                            <comment id="14941121" author="stevel@apache.org" created="Fri, 2 Oct 2015 13:23:06 +0000"  >&lt;p&gt;There&apos;s a way to address this that I&apos;ve been thinking of for the &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-1537&quot; title=&quot;Add integration with Yarn&amp;#39;s Application Timeline Server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-1537&quot;&gt;&lt;del&gt;SPARK-1537&lt;/del&gt;&lt;/a&gt; integration, where there&apos;s the extra dependency on the timeline server running.&lt;/p&gt;

&lt;p&gt;Essentially, it looks like the bus replay operation can be asynchronous: the UI is returned immediately while some (pooled) thread replays the event log.&lt;/p&gt;</comment>
                            <comment id="14976364" author="tgraves" created="Tue, 27 Oct 2015 13:29:01 +0000"  >&lt;p&gt;Unfortunately for us I don&apos;t think the current timeline server will scale at this point. But I&apos;ll have to try it once things are ready.&lt;/p&gt;

&lt;p&gt;There are other ways to make this faster to startup.  &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;we could simply do an ls and show applications without any details and then add details as they are loaded.   Then if user clicks on one load that one first.&lt;/li&gt;
	&lt;li&gt;we could change file name or directory structures to have some basic information that could be displayed by a simple file listing (like the MapReduce history server does).&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15026849" author="stevel@apache.org" created="Wed, 25 Nov 2015 14:33:28 +0000"  >&lt;p&gt;Thomas, I think you are right w.r.t simple fixes: add a metadata document to summarise the ongoing app. Essentially the same stuff that I am pushing out to the timeline server as summary info&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;timestamp of start&lt;/li&gt;
	&lt;li&gt;yarn attempt ID (allows for comparision with running apps and their state)&lt;/li&gt;
	&lt;li&gt;timestamp of finished (if set). Unset ==&amp;gt; app is not finished.&lt;/li&gt;
	&lt;li&gt;updated time&lt;/li&gt;
	&lt;li&gt;spark version (I hope to use this in better incompatibility warnings)&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;There&apos;s a risk of inconsistency with the real log: what if the log saved as finished but the metadata isn&apos;t in sync and tagged as open? Maybe when an app is viewed and the full log pulled in any discrepancies could be corrected there by saving a new metadata file.&lt;/p&gt;</comment>
                            <comment id="15026858" author="stevel@apache.org" created="Wed, 25 Nov 2015 14:37:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-11373&quot; title=&quot;Add metrics to the History Server and providers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-11373&quot;&gt;&lt;del&gt;SPARK-11373&lt;/del&gt;&lt;/a&gt; proposes adding metrics to the history server; if the time to list and load files is included then it&apos;ll help track this problem. my latest &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-7889&quot; title=&quot;Jobs progress of apps on complete page of HistoryServer shows uncompleted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-7889&quot;&gt;&lt;del&gt;SPARK-7889&lt;/del&gt;&lt;/a&gt; adds timings &amp;amp; counts of the getAppUI() invocations in preparation for the monitoring, but does nothing about listings&lt;/p&gt;</comment>
                            <comment id="15591207" author="srowen" created="Thu, 20 Oct 2016 08:36:48 +0000"  >&lt;p&gt;Pointing this to a future issue which has an open PR for the same issue.&lt;/p&gt;</comment>
                            <comment id="15605820" author="vanzin" created="Tue, 25 Oct 2016 16:44:32 +0000"  >&lt;p&gt;I reopened this after discussion in the bug; the other change (&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-18010&quot; title=&quot;Remove unneeded heavy work performed by FsHistoryProvider for building up the application listing UI page&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-18010&quot;&gt;&lt;del&gt;SPARK-18010&lt;/del&gt;&lt;/a&gt;) makes startup a little faster, but not necessarily fast, for large directories / log files.&lt;/p&gt;</comment>
                            <comment id="15889588" author="zshao" created="Wed, 1 Mar 2017 06:25:20 +0000"  >&lt;p&gt;Did we consider using a distributed store to solve the scalability issue?  Single-node LevelDB will hit scalability issue soon.&lt;/p&gt;</comment>
                            <comment id="15890040" author="stevel@apache.org" created="Wed, 1 Mar 2017 11:58:05 +0000"  >&lt;p&gt;Having been downstream of YARN timeline server and its leveldb stuff, I&apos;m not convinced adding a DB will magically solve problems: there&apos;s still the need to populate that DB. In a physical cluster it may stay around, but in a virtual world it won&apos;t, and it does complicate life all round.&lt;/p&gt;

&lt;p&gt;With &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-17843&quot; title=&quot;History Server gives no feedback about the application list being incomplete&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-17843&quot;&gt;&lt;del&gt;SPARK-17843&lt;/del&gt;&lt;/a&gt; giving the UI hints about ongoing async load, at least people can see that there is a load in progress.&lt;/p&gt;</comment>
                            <comment id="15900871" author="lixin" created="Wed, 8 Mar 2017 07:56:37 +0000"  >&lt;p&gt;In my case,the inprogress file is the main reason, so if the inprogress file is necessary for the history server, or if  the  inprogress file can be cleaned up with the &apos;spark.history.fs.cleaner.maxAge&apos;&lt;/p&gt;</comment>
                            <comment id="16420951" author="apachespark" created="Fri, 30 Mar 2018 21:34:04 +0000"  >&lt;p&gt;User &apos;vanzin&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/20952&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/20952&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16434024" author="irashid" created="Wed, 11 Apr 2018 14:49:55 +0000"  >&lt;p&gt;Issue resolved by pull request 20952&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/20952&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/20952&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12845768">SPARK-9123</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12905075">SPARK-11123</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12908530">SPARK-11373</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12951367">SPARK-13988</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13013551">SPARK-18010</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13014927">SPARK-18085</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 31 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2dbcn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>