<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:26:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-6435] spark-shell --jars option does not add all jars to classpath</title>
                <link>https://issues.apache.org/jira/browse/SPARK-6435</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Not all jars supplied via the --jars option will be added to the driver (and presumably executor) classpath.  The first jar(s) will be added, but not all.&lt;/p&gt;

&lt;p&gt;To reproduce this, just add a few jars (I tested 5) to the --jars option, and then try to import a class from the last jar.  This fails.  A simple reproducer: &lt;/p&gt;

&lt;p&gt;Create a bunch of dummy jars:&lt;br/&gt;
jar cfM jar1.jar log.txt&lt;br/&gt;
jar cfM jar2.jar log.txt&lt;br/&gt;
jar cfM jar3.jar log.txt&lt;br/&gt;
jar cfM jar4.jar log.txt&lt;/p&gt;

&lt;p&gt;Start the spark-shell with the dummy jars and guava at the end:&lt;br/&gt;
%SPARK_HOME%\bin\spark-shell --master local --jars jar1.jar,jar2.jar,jar3.jar,jar4.jar,c:\code\lib\guava-14.0.1.jar&lt;/p&gt;

&lt;p&gt;In the shell, try importing from guava; you&apos;ll get an error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;scala&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; com.google.common.base.Strings
&amp;lt;console&amp;gt;:19: error: object Strings is not a member of &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; com.google.common.base
       &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; com.google.common.base.Strings
              ^
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</description>
                <environment>&lt;p&gt;Win64&lt;/p&gt;</environment>
        <key id="12783622">SPARK-6435</key>
            <summary>spark-shell --jars option does not add all jars to classpath</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tsudukim">Masayoshi Tsuzuki</assignee>
                                    <reporter username="vjapache">Vijay Garla</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Mar 2015 14:29:27 +0000</created>
                <updated>Tue, 28 Apr 2015 11:57:32 +0000</updated>
                            <resolved>Tue, 28 Apr 2015 11:57:09 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>Spark Shell</component>
                    <component>Windows</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14371356" author="srowen" created="Fri, 20 Mar 2015 14:31:18 +0000"  >&lt;p&gt;Hm, does it work without the dummy jars? I suspect a different Windows-related problem in your syntax.&lt;/p&gt;</comment>
                            <comment id="14371420" author="vjapache" created="Fri, 20 Mar 2015 14:58:45 +0000"  >&lt;p&gt;It works when guava is the 1st or 2nd jar.  Not sure at what point spark starts dropping jars, but I had this issue with multiple &apos;real&apos; jars (i.e. containing .class files) in the --jars option: If I move a jar to the front of the list, it works; move it to the back, it fails.&lt;/p&gt;</comment>
                            <comment id="14371429" author="srowen" created="Fri, 20 Mar 2015 15:07:05 +0000"  >&lt;p&gt;The weird thing  is the example shows it finds the Guava package, but I suspect that is coming from Spark&apos;s one unshaded Guava class, Optional. It doesn&apos;t really make sense that it would work in position 1 or 2 only. Is this what you are running, exactly? Can you debug further to find out the exact command line that is launched?&lt;/p&gt;</comment>
                            <comment id="14375164" author="srowen" created="Sun, 22 Mar 2015 20:59:00 +0000"  >&lt;p&gt;I tried a simplified version of this with &lt;tt&gt;spark-shell&lt;/tt&gt;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;spark-shell --master local --jars android-core.jar,core.jar,javase.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and it worked as expected. I was able to access code in all the JARs. Same worked on YARN.&lt;/p&gt;

&lt;p&gt;The JARs were added too:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;15/03/22 13:57:53 INFO SparkContext: Added JAR file:/home/srowen/android-core.jar at http:&lt;span class=&quot;code-comment&quot;&gt;//10.16.180.26:49005/jars/android-core.jar with timestamp 1427057873313
&lt;/span&gt;15/03/22 13:57:53 INFO SparkContext: Added JAR file:/home/srowen/core.jar at http:&lt;span class=&quot;code-comment&quot;&gt;//10.16.180.26:49005/jars/core.jar with timestamp 1427057873315
&lt;/span&gt;15/03/22 13:57:53 INFO SparkContext: Added JAR file:/home/srowen/javase.jar at http:&lt;span class=&quot;code-comment&quot;&gt;//10.16.180.26:49005/jars/javase.jar with timestamp 1427057873315&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This wasn&apos;t Windows though. I suppose it&apos;s possible there&apos;s something wrong with how the classpath is reassembled for Windows or something. Or could have been fixed along the way.&lt;/p&gt;</comment>
                            <comment id="14375707" author="vjapache" created="Mon, 23 Mar 2015 10:45:28 +0000"  >&lt;p&gt;I tested this on Linux with the 1.3.0 release, works fine.  Apparently a windows-specific issue.  Apparently on windows only the 1st jar is picked up.  This appears to be a problem with parsing the command line, introduced by the change in windows scripts between 1.2.0 and 1.3.0.  A simple fix to bin\windows-utils.cmd resolves the issue.&lt;/p&gt;

&lt;p&gt;I ran this command to test with &apos;real&apos; jars:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;%SPARK_HOME%\bin\spark-shell --master local --jars c:\code\elasticsearch-1.4.2\lib\lucene-core-4.10.2.jar,c:\temp\guava-14.0.1.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here are some snippets from the console - note that only the 1st jar is added; I can load classes from the 1st jar but not the 2nd:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;15/03/23 10:57:41 INFO SparkUI: Started SparkUI at http:&lt;span class=&quot;code-comment&quot;&gt;//vgarla-t440P.fritz.box
&lt;/span&gt;:4040
15/03/23 10:57:41 INFO SparkContext: Added JAR file:/c:/code/elasticsearch-1.4.2/lib/lucene-core-4.10.2.jar at http:&lt;span class=&quot;code-comment&quot;&gt;//192.168.178.41:54601/jars/lucene-core-4.10.2.jar with timestamp 1427104661969
&lt;/span&gt;15/03/23 10:57:42 INFO Executor: Starting executor ID &amp;lt;driver&amp;gt; on host localhost
...
scala&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.lucene.util.IOUtils
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.lucene.util.IOUtils

scala&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; com.google.common.base.Strings
&amp;lt;console&amp;gt;:20: error: object Strings is not a member of &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; com.google.common.base
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looking at the command line in jvisualvm, I see that only the 1st jar is aded:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Main class: org.apache.spark.deploy.SparkSubmit
Arguments: --&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.spark.repl.Main --master local --jars c:\code\elasticsearch-1.4.2\lib\lucene-core-4.10.2.jar spark-shell c:\temp\guava-14.0.1.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In spark 1.2.0, spark-shell2.cmd just passed arguments &quot;as is&quot; to the java command line:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cmd /V /E /C %SPARK_HOME%\bin\spark-submit.cmd --&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.spark.repl.Main %* spark-shell
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In spark 1.3.0, spark-shell2.cmd calls windows-utils.cmd to parse arguments into SUBMISSION_OPTS and APPLICATION_OPTS.  Only the first jar in the list passed to --jars makes it into the SUBMISSION_OPTS; latter jars are added to APPLICATION_OPTS:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;call %SPARK_HOME%\bin\windows-utils.cmd %*
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; %ERRORLEVEL% equ 1 (
  call :usage
  exit /b 1
)
echo SUBMISSION_OPTS=%SUBMISSION_OPTS%
echo APPLICATION_OPTS=%APPLICATION_OPTS%

cmd /V /E /C %SPARK_HOME%\bin\spark-submit.cmd --&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.spark.repl.Main %SUBMISSION_OPTS% spark-shell %APPLICATION_OPTS%
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The problem is that by the time the command line arguments get to windows-utils.cmd, the windows command line processor has split the comma-separated list into distinct arguments.  The windows way of saying &quot;treat this as a single arg&quot; is to surround in double-quotes.  However, when I surround the jars in quotes, I get an error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;%SPARK_HOME%\bin\spark-shell --master local --jars &lt;span class=&quot;code-quote&quot;&gt;&quot;c:\code\elasticsearch-1.4.2\lib\lucene-core-4.10.2.jar,c:\temp\guava-14.0.1.jar&quot;&lt;/span&gt;
c:\temp\guava-14.0.1.jar&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;==&quot;&lt;/span&gt;x&quot; was unexpected at &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; time.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Digging in, I see this is caused by this line from windows-utils.cmd:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;x%2&quot;&lt;/span&gt;==&lt;span class=&quot;code-quote&quot;&gt;&quot;x&quot;&lt;/span&gt; (
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Replacing the quotes with square brackets does the trick:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; [x%2]==[x] (
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now the command line is processed correctly.&lt;/p&gt;
</comment>
                            <comment id="14376433" author="srowen" created="Mon, 23 Mar 2015 19:20:07 +0000"  >&lt;p&gt;Great debugging! &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tsudukim&quot; class=&quot;user-hover&quot; rel=&quot;tsudukim&quot;&gt;tsudukim&lt;/a&gt; do you have thoughts on this? I think this bit was part of your change in &lt;a href=&quot;https://github.com/apache/spark/commit/8d932475e6759e869c16ce6cac203a2e56558716#diff-7ac5881d6bad553b23f5225775c8fde3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/8d932475e6759e869c16ce6cac203a2e56558716#diff-7ac5881d6bad553b23f5225775c8fde3&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So, it sounds like you do need to quote the comma-separated arg? but then quoting doesn&apos;t work as expected?&lt;/p&gt;

&lt;p&gt;The &lt;tt&gt;&quot;x%2&quot;==&quot;x&quot;&lt;/tt&gt; idiom is used several places in the Windows scripts. Is the square bracket syntax definitely preferred?&lt;/p&gt;</comment>
                            <comment id="14376501" author="vjapache" created="Mon, 23 Mar 2015 19:52:19 +0000"  >&lt;p&gt;I came up with square brackets after 2 minutes of googling/stackoverflowing; a more thorough search/understanding of bat scripts might result in a better/different solution (I can rule myself out of the more thorough bat script understanding).  That being said, this test is used to check for an empty string.  Square brackets is the most upvoted solution: &lt;a href=&quot;http://stackoverflow.com/questions/2541767/what-is-the-proper-way-to-test-if-variable-is-empty-in-a-batch-file-if-not-1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/2541767/what-is-the-proper-way-to-test-if-variable-is-empty-in-a-batch-file-if-not-1&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14381641" author="tsudukim" created="Thu, 26 Mar 2015 09:56:48 +0000"  >&lt;p&gt;I think &lt;tt&gt;&quot;%~2&quot;==&quot;&quot;&lt;/tt&gt; way is better for this.&lt;br/&gt;
But this script no longer exists now because the launching method of spark has changed drastically by &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-4924&quot; title=&quot;Factor out code to launch Spark applications into a separate library&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-4924&quot;&gt;&lt;del&gt;SPARK-4924&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14381797" author="srowen" created="Thu, 26 Mar 2015 12:33:47 +0000"  >&lt;p&gt;Yes this is a moot point in 1.4 and after, but I&apos;d love to get a working solution for 1.3, even if it&apos;s a bit hacky. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tsudukim&quot; class=&quot;user-hover&quot; rel=&quot;tsudukim&quot;&gt;tsudukim&lt;/a&gt; do you think the square-bracket syntax is going to not work in some cases? at least, it seems to fix this issue. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vjapache&quot; class=&quot;user-hover&quot; rel=&quot;vjapache&quot;&gt;vjapache&lt;/a&gt; does the alternative syntax above work, without the &quot;x&quot;?&lt;/p&gt;</comment>
                            <comment id="14383143" author="tsudukim" created="Fri, 27 Mar 2015 01:17:52 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; [%2]==[] (
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think this square bracket style also works properly.&lt;/p&gt;

&lt;p&gt;I tested it on my Windows 8.1. &lt;tt&gt;x&lt;/tt&gt; is not needed.&lt;/p&gt;</comment>
                            <comment id="14383560" author="tsudukim" created="Fri, 27 Mar 2015 09:12:38 +0000"  >&lt;p&gt;I looked into the script of the latest version and unfortunately found that it doesn&apos;t work properly too.&lt;br/&gt;
We have the same symptom when we specify multiple jars with --jars option in spark-shell.cmd, but the cause is different.&lt;/p&gt;

&lt;p&gt;These work fine.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;bin\spark-shell.cmd --jars C:\jar1.jar
bin\spark-shell.cmd --jars &lt;span class=&quot;code-quote&quot;&gt;&quot;C:\jar1.jar&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But this doesn&apos;t work.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;bin\spark-shell.cmd --jars &lt;span class=&quot;code-quote&quot;&gt;&quot;C:\jar1.jar,C:\jar2.jar&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;this gets&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.net.URISyntaxException: Illegal character in path at index 11: C:/jar1.jar C:/jar2.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14383566" author="vjapache" created="Fri, 27 Mar 2015 09:16:59 +0000"  >&lt;p&gt;Strange - when I test it with multiple jars (with the fixed script) everything works.&lt;br/&gt;
Something has changed in some other script wrt the released 1.3.0&lt;/p&gt;</comment>
                            <comment id="14383597" author="tsudukim" created="Fri, 27 Mar 2015 09:42:07 +0000"  >&lt;p&gt;This cause is the following code in spark-class2.cmd&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /f &lt;span class=&quot;code-quote&quot;&gt;&quot;tokens=*&quot;&lt;/span&gt; %%i in (&lt;span class=&quot;code-quote&quot;&gt;&apos;cmd /C &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;%RUNNER%&quot;&lt;/span&gt; -cp %LAUNCHER_CP% org.apache.spark.launcher.Main %*&quot;&apos;&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; (
  set SPARK_CMD=%%i
)
%SPARK_CMD%
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&quot;for&quot; clause is a little bit complex, but we can get this when we expand its variables between the single quotations.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&apos;cmd /C &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;C:\Program Files\Java\jdk1.7.0_67\bin\java&quot;&lt;/span&gt; -cp C:\Users\tsudukim\Documents\workspace\spark-dev\bin\..\launcher\target\scala-2.10\classes org.apache.spark.launcher.Main org.apache.spark.deploy.SparkSubmit --&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.spark.repl.Main --jars &lt;span class=&quot;code-quote&quot;&gt;&quot;C:\jar1.jar,C:\jar2.jar&quot;&lt;/span&gt;&quot;&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and when this is executed, java code (launcher\src\main\java\org\apache\spark\launcher\Main.java) receives the args like followings as &quot;argsArray&quot;.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[0] = {java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;@410}&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.spark.deploy.SparkSubmit&quot;&lt;/span&gt;
[1] = {java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;@417}&lt;span class=&quot;code-quote&quot;&gt;&quot;--class&quot;&lt;/span&gt;
[2] = {java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;@418}&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.spark.repl.Main&quot;&lt;/span&gt;
[3] = {java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;@419}&lt;span class=&quot;code-quote&quot;&gt;&quot;--jars&quot;&lt;/span&gt;
[4] = {java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;@420}&lt;span class=&quot;code-quote&quot;&gt;&quot;C:\jar1.jar C:\jar2.jar&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The comma between C:\jar1.jar and C:\jar2.jar disappeared here.&lt;/p&gt;

&lt;p&gt;The handling of double quotation in Windows batch is so difficult.&lt;br/&gt;
I&apos;m not sure but perhaps it was parsed twice.&lt;br/&gt;
The separator of args is only space in bash, but space, semicolon and comma are also used in Windows batch.&lt;br/&gt;
So comma was converted to space in 1st parse.&lt;/p&gt;

&lt;p&gt;To avoid this problem, I think it&apos;s better to parse only once, not twice.&lt;br/&gt;
(escaping double-quotations in Windows batch is so painful.)&lt;/p&gt;</comment>
                            <comment id="14383599" author="tsudukim" created="Fri, 27 Mar 2015 09:43:53 +0000"  >&lt;p&gt;Release 1.3.0 works fine.&lt;br/&gt;
But the problem occurs in the latest script in master branch (under developing for 1.4).&lt;/p&gt;</comment>
                            <comment id="14383601" author="apachespark" created="Fri, 27 Mar 2015 09:49:50 +0000"  >&lt;p&gt;User &apos;tsudukim&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/5227&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5227&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14383729" author="srowen" created="Fri, 27 Mar 2015 12:02:09 +0000"  >&lt;p&gt;OK, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vjapache&quot; class=&quot;user-hover&quot; rel=&quot;vjapache&quot;&gt;vjapache&lt;/a&gt; would you like to submit a PR that changes to use the brackets? You may need two PRs, one for branch-1.3 and one for master, since some occurrences are now gone in master.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tsudukim&quot; class=&quot;user-hover&quot; rel=&quot;tsudukim&quot;&gt;tsudukim&lt;/a&gt; OK I understand your pull request is to fix a similar issue but in the new 1.4 / master code?&lt;/p&gt;</comment>
                            <comment id="14388155" author="tsudukim" created="Tue, 31 Mar 2015 07:06:28 +0000"  >&lt;p&gt;Sorry to confuse you. My PR is for master code, but not for branch-1.3.&lt;br/&gt;
I assume &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vjapache&quot; class=&quot;user-hover&quot; rel=&quot;vjapache&quot;&gt;vjapache&lt;/a&gt; will send the PR for branch-1.3 but if you don&apos;t have enough time, I can make it.&lt;/p&gt;</comment>
                            <comment id="14388164" author="tsudukim" created="Tue, 31 Mar 2015 07:15:24 +0000"  >&lt;p&gt;Ah, the problems occured in branch-1.3 and in master branch are similar, but their causes are completely different.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srowen&quot; class=&quot;user-hover&quot; rel=&quot;srowen&quot;&gt;srowen&lt;/a&gt; if you think it&apos;s better we manage these problems in separate JIRA tickets, let&apos;s do so. How do you think?&lt;/p&gt;</comment>
                            <comment id="14388455" author="srowen" created="Tue, 31 Mar 2015 12:29:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tsudukim&quot; class=&quot;user-hover&quot; rel=&quot;tsudukim&quot;&gt;tsudukim&lt;/a&gt; I think this JIRA is a fine place to track this work. No need for a separate issue even if there are different changes for branch 1.3 and master.&lt;br/&gt;
You have already started fixing this for master in &lt;a href=&quot;https://github.com/apache/spark/pull/5227&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5227&lt;/a&gt; so I think you can proceed there.&lt;/p&gt;</comment>
                            <comment id="14389829" author="tsudukim" created="Wed, 1 Apr 2015 01:21:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srowen&quot; class=&quot;user-hover&quot; rel=&quot;srowen&quot;&gt;srowen&lt;/a&gt; OK, thank you! Then I&apos;m going to proceed here.&lt;/p&gt;</comment>
                            <comment id="14393856" author="vanzin" created="Fri, 3 Apr 2015 01:05:27 +0000"  >&lt;p&gt;I haven&apos;t tested this on 1.3 so I can&apos;t comment. But are you guys sure this is an issue on master? See the session below:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;C:\cygwin64\home\admin\work\spark&amp;gt;bin\spark-shell --jars ..\jar1.jar,..\jar2.jar,..\jar3.jar
log4j:WARN No appenders could be found for logger (org.apache.hadoop.metrics2.lib.MutableMetricsFactory).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
Using Spark&apos;s default log4j profile: org/apache/spark/log4j-defaults.properties
15/04/02 18:02:56 INFO SecurityManager: Changing view acls to: admin
15/04/02 18:02:56 INFO SecurityManager: Changing modify acls to: admin
15/04/02 18:02:56 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: Set(admin); users with modify permissions: Set(admin)
15/04/02 18:02:56 INFO HttpServer: Starting HTTP Server
15/04/02 18:02:57 INFO Utils: Successfully started service &apos;HTTP class server&apos; on port 49289.
Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  &apos;_/
   /___/ .__/\_,_/_/ /_/\_\   version 1.4.0-SNAPSHOT
      /_/

Using Scala version 2.10.4 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_25)
Type in expressions to have them evaluated.
Type :help for more information.
15/04/02 18:03:44 INFO SparkContext: Running Spark version 1.4.0-SNAPSHOT
15/04/02 18:03:45 INFO SecurityManager: Changing view acls to: admin
15/04/02 18:03:45 INFO SecurityManager: Changing modify acls to: admin
15/04/02 18:03:45 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: Set(admin); users with modify permissions: Set(admin)
15/04/02 18:03:53 INFO Slf4jLogger: Slf4jLogger started
15/04/02 18:03:54 INFO Remoting: Starting remoting
15/04/02 18:04:00 INFO Remoting: Remoting started; listening on addresses :[akka.tcp://sparkDriver@vanzin-win7:49302]
15/04/02 18:04:00 INFO Utils: Successfully started service &apos;sparkDriver&apos; on port 49302.
15/04/02 18:04:00 INFO SparkEnv: Registering MapOutputTracker
15/04/02 18:04:01 INFO SparkEnv: Registering BlockManagerMaster
15/04/02 18:04:01 INFO DiskBlockManager: Created local directory at C:\Users\admin\AppData\Local\Temp\spark-6f29266b-d302-4917-9e7a-cbbc77d87faa\blockmgr-398614d1-f50d-450f-becb-9230aaf5200b
15/04/02 18:04:01 INFO MemoryStore: MemoryStore started with capacity 267.3 MB
15/04/02 18:04:02 INFO HttpFileServer: HTTP File server directory is C:\Users\admin\AppData\Local\Temp\spark-6f29266b-d302-4917-9e7a-cbbc77d87faa\httpd-f4510339-e54b-44cb-a201-22a23d32c8d6
15/04/02 18:04:02 INFO HttpServer: Starting HTTP Server
15/04/02 18:04:02 INFO Utils: Successfully started service &apos;HTTP file server&apos; on port 49303.
15/04/02 18:04:03 INFO SparkEnv: Registering OutputCommitCoordinator
15/04/02 18:04:04 INFO Utils: Successfully started service &apos;SparkUI&apos; on port 4040.
15/04/02 18:04:04 INFO SparkUI: Started SparkUI at http://vanzin-win7:4040
15/04/02 18:04:05 INFO SparkContext: Added JAR file:/C:/cygwin64/home/admin/work/spark/../jar1.jar at http://192.168.56.101:49303/jars/jar1.jar with timestamp 1428023045788
15/04/02 18:04:05 INFO SparkContext: Added JAR file:/C:/cygwin64/home/admin/work/spark/../jar2.jar at http://192.168.56.101:49303/jars/jar2.jar with timestamp 1428023045804
15/04/02 18:04:05 INFO SparkContext: Added JAR file:/C:/cygwin64/home/admin/work/spark/../jar3.jar at http://192.168.56.101:49303/jars/jar3.jar with timestamp 1428023045819
15/04/02 18:04:07 INFO Executor: Starting executor ID &amp;lt;driver&amp;gt; on host localhost
15/04/02 18:04:07 INFO Executor: Using REPL class URI: http://192.168.56.101:49289
15/04/02 18:04:07 INFO AkkaUtils: Connecting to HeartbeatReceiver: akka.tcp://sparkDriver@vanzin-win7:49302/user/HeartbeatReceiver
15/04/02 18:04:10 INFO NettyBlockTransferService: Server created on 49310
15/04/02 18:04:10 INFO BlockManagerMaster: Trying to register BlockManager
15/04/02 18:04:10 INFO BlockManagerMasterActor: Registering block manager localhost:49310 with 267.3 MB RAM, BlockManagerId(&amp;lt;driver&amp;gt;, localhost, 49310)
15/04/02 18:04:10 INFO BlockManagerMaster: Registered BlockManager
15/04/02 18:04:15 INFO SparkILoop: Created spark context..
Spark context available as sc.
15/04/02 18:04:18 INFO SparkILoop: Created sql context (with Hive support)..
SQL context available as sqlContext.

scala&amp;gt; getClass().getResource(&quot;/test.txt&quot;)
res0: java.net.URL = jar:file:/C:/cygwin64/home/admin/work/spark/../jar1.jar!/test.txt

scala&amp;gt; getClass().getResource(&quot;/test2.txt&quot;)
res2: java.net.URL = jar:file:/C:/cygwin64/home/admin/work/spark/../jar2.jar!/test2.txt

scala&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The current PR is against master, and I&apos;d like to avoid changing that code unless it&apos;s reeeeeally needed. Those batch scripts are already cryptic enough.&lt;/p&gt;</comment>
                            <comment id="14394105" author="tsudukim" created="Fri, 3 Apr 2015 05:53:37 +0000"  >&lt;p&gt;Please try with double-quotation. (double-quotation is required when the path includes space etc)&lt;br/&gt;
This doesn&apos;t work.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;bin\spark-shell.cmd --jars &lt;span class=&quot;code-quote&quot;&gt;&quot;..\jar1.jar,..\jar2.jar,..\jar3.jar&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And in this case, the present code has a bug on another bug. So, it is not working as we intend to, but it just only seems to be working coincidentally in some case.&lt;br/&gt;
I think we shouldn&apos;t keep the codes that contains bugs. If we keep them, it will be more difficult to change the codes in the future. (If it did NOT contain bugs, I would agree with you.)&lt;/p&gt;

&lt;p&gt;And I also agree that the batch scripts are cryptic. To avoid it, It&apos;s better to change *.cmd to other language like powershell.&lt;/p&gt;</comment>
                            <comment id="14395609" author="srowen" created="Sat, 4 Apr 2015 07:38:28 +0000"  >&lt;p&gt;I feel like it&apos;s worth fixing, cryptic or not. Try reproducing with the quotes? and if it fails, let&apos;s go with the PR? it seems reasonable and is confined to the Windows support.&lt;/p&gt;</comment>
                            <comment id="14516920" author="srowen" created="Tue, 28 Apr 2015 11:57:09 +0000"  >&lt;p&gt;Issue resolved by pull request 5227&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/5227&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5227&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12763533">SPARK-4941</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 30 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i271lj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>