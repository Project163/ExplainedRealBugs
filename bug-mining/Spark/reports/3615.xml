<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:44:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-15732] Dataset generated code &quot;generated.java&quot; Fails with Certain Case Classes</title>
                <link>https://issues.apache.org/jira/browse/SPARK-15732</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;The Dataset code generation logic fails to handle field-names in case classes that are also Java keywords (e.g. &quot;abstract&quot;). Scala has an escaping mechanism (using backquotes) that allows Java (and Scala) keywords to be used as names in programs, as in the example below:&lt;/p&gt;

&lt;p&gt;case class PatApp(number: Int, title: String, `abstract`: String)&lt;/p&gt;

&lt;p&gt;But this case class trips up the Dataset code generator. The following error message is displayed when Datasets containing instances of such case classes are processed.&lt;/p&gt;

&lt;p&gt;org.apache.spark.SparkException: Job aborted due to stage failure: Task 2 in stage 54.0 failed 1 times, most recent failure: Lost task 2.0 in stage 54.0 (TID 1304, localhost): java.lang.RuntimeException: Error while encoding: java.util.concurrent.ExecutionException: java.lang.Exception: failed to compile: org.codehaus.commons.compiler.CompileException: File &apos;generated.java&apos;, Line 60, Column 84: Unexpected selector &apos;abstract&apos; after &quot;.&quot;&lt;/p&gt;

&lt;p&gt;The following code can be used to replicate the problem. This code was run on the Databricks CE, in a Scala notebook, in 3 separate cells as shown below:&lt;/p&gt;

&lt;p&gt;// CELL 1:&lt;br/&gt;
//&lt;br/&gt;
// Create a Case Class with &quot;abstract&quot; as a field-name ...&lt;br/&gt;
//&lt;br/&gt;
package keywordissue&lt;br/&gt;
// The field-name abstract is a Java keyword ...&lt;br/&gt;
case class PatApp(number: Int, title: String, `abstract`: String)&lt;/p&gt;

&lt;p&gt;// CELL 2:&lt;br/&gt;
//&lt;br/&gt;
// Create a Dataset using the case class ...&lt;br/&gt;
//&lt;br/&gt;
import keywordissue.PatApp&lt;/p&gt;

&lt;p&gt;val applications = List(PatApp(1001, &quot;1001&quot;, &quot;Abstract 1001&quot;), PatApp(1002, &quot;1002&quot;, &quot;Abstract 1002&quot;), PatApp(1003, &quot;1003&quot;, &quot;Abstract for 1003&quot;), PatApp(/* Duplicate! */ 1003, &quot;1004&quot;, &quot;Abstract 1004&quot;))&lt;br/&gt;
val appsDataset = sc.parallelize(applications).toDF.as&lt;span class=&quot;error&quot;&gt;&amp;#91;PatApp&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;// CELL 3:&lt;br/&gt;
//&lt;br/&gt;
// Force Dataset code-generation. This causes the error message to display ...&lt;br/&gt;
//&lt;br/&gt;
val duplicates = appsDataset.groupByKey(&lt;em&gt;.number).mapGroups((k, i) =&amp;gt; (k, i.length)).filter(&lt;/em&gt;._2 &amp;gt; 0)&lt;br/&gt;
duplicates.collect().foreach(println)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Version 2.0 Preview on the Databricks Community Edition&lt;/p&gt;</environment>
        <key id="12975188">SPARK-15732</key>
            <summary>Dataset generated code &quot;generated.java&quot; Fails with Certain Case Classes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cloud_fan">Wenchen Fan</assignee>
                                    <reporter username="sanjay.dasgupta@gmail.com">Sanjay Dasgupta</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Jun 2016 14:59:12 +0000</created>
                <updated>Fri, 3 Jun 2016 01:14:56 +0000</updated>
                            <resolved>Fri, 3 Jun 2016 01:14:56 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15313230" author="bomeng" created="Thu, 2 Jun 2016 22:48:00 +0000"  >&lt;p&gt;There is no easy way to work around this issue since &quot;abstract&quot; is a keyword in Java and Java does not allow keyword as identifier. Try to rename it is the best way I can think of. &lt;/p&gt;</comment>
                            <comment id="15313321" author="cloud_fan" created="Thu, 2 Jun 2016 23:47:10 +0000"  >&lt;p&gt;It&apos;s really hard to support it, and I don&apos;t think this corner case worth a lot of effort to deal with. I&apos;d like to add a check and give better error message when users use java reserved words as field names.&lt;/p&gt;</comment>
                            <comment id="15313330" author="rxin" created="Thu, 2 Jun 2016 23:49:26 +0000"  >&lt;p&gt;Yea we definitely should put a better error message for 2.0.&lt;/p&gt;

&lt;p&gt;In the future we can look into generating bytecode directly (e.g. via reflectasm) or hacking janino to support this.&lt;/p&gt;</comment>
                            <comment id="15313354" author="apachespark" created="Fri, 3 Jun 2016 00:07:04 +0000"  >&lt;p&gt;User &apos;cloud-fan&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/13485&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/13485&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15313431" author="lian cheng" created="Fri, 3 Jun 2016 01:14:56 +0000"  >&lt;p&gt;Resolved by &lt;a href=&quot;https://github.com/apache/spark/pull/13485&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/13485&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 24 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2yw73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12329449">2.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>