<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:15:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-1215] Clustering: Index out of bounds error</title>
                <link>https://issues.apache.org/jira/browse/SPARK-1215</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;code:&lt;br/&gt;
import org.apache.spark.mllib.clustering._&lt;/p&gt;

&lt;p&gt;val test = sc.makeRDD(Array(4,4,4,4,4).map(e =&amp;gt; Array(e.toDouble)))&lt;br/&gt;
val kmeans = new KMeans().setK(4)&lt;br/&gt;
kmeans.run(test) evals with java.lang.ArrayIndexOutOfBoundsException&lt;/p&gt;

&lt;p&gt;error:&lt;br/&gt;
14/01/17 12:35:54 INFO scheduler.DAGScheduler: Stage 25 (collectAsMap at KMeans.scala:243) finished in 0.047 s&lt;br/&gt;
14/01/17 12:35:54 INFO spark.SparkContext: Job finished: collectAsMap at KMeans.scala:243, took 16.389537116 s&lt;br/&gt;
Exception in thread &quot;main&quot; java.lang.reflect.InvocationTargetException&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:606)&lt;br/&gt;
	at com.simontuffs.onejar.Boot.run(Boot.java:340)&lt;br/&gt;
	at com.simontuffs.onejar.Boot.main(Boot.java:166)&lt;br/&gt;
Caused by: java.lang.ArrayIndexOutOfBoundsException: -1&lt;br/&gt;
	at org.apache.spark.mllib.clustering.LocalKMeans$.kMeansPlusPlus(LocalKMeans.scala:47)&lt;br/&gt;
	at org.apache.spark.mllib.clustering.KMeans$$anonfun$19.apply(KMeans.scala:247)&lt;br/&gt;
	at org.apache.spark.mllib.clustering.KMeans$$anonfun$19.apply(KMeans.scala:244)&lt;br/&gt;
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:233)&lt;br/&gt;
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:233)&lt;br/&gt;
	at scala.collection.immutable.Range.foreach(Range.scala:81)&lt;br/&gt;
	at scala.collection.TraversableLike$class.map(TraversableLike.scala:233)&lt;br/&gt;
	at scala.collection.immutable.Range.map(Range.scala:46)&lt;br/&gt;
	at org.apache.spark.mllib.clustering.KMeans.initKMeansParallel(KMeans.scala:244)&lt;br/&gt;
	at org.apache.spark.mllib.clustering.KMeans.run(KMeans.scala:124)&lt;br/&gt;
	at Clustering$$anonfun$1.apply$mcDI$sp(Clustering.scala:21)&lt;br/&gt;
	at Clustering$$anonfun$1.apply(Clustering.scala:19)&lt;br/&gt;
	at Clustering$$anonfun$1.apply(Clustering.scala:19)&lt;br/&gt;
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:233)&lt;br/&gt;
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:233)&lt;br/&gt;
	at scala.collection.immutable.Range.foreach(Range.scala:78)&lt;br/&gt;
	at scala.collection.TraversableLike$class.map(TraversableLike.scala:233)&lt;br/&gt;
	at scala.collection.immutable.Range.map(Range.scala:46)&lt;br/&gt;
	at Clustering$.main(Clustering.scala:19)&lt;br/&gt;
	at Clustering.main(Clustering.scala)&lt;br/&gt;
	... 6 more&lt;/p&gt;</description>
                <environment></environment>
        <key id="12704858">SPARK-1215</key>
            <summary>Clustering: Index out of bounds error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="josephkb">Joseph K. Bradley</assignee>
                                    <reporter username="dewshick">dewshick</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Jan 2014 05:24:22 +0000</created>
                <updated>Wed, 27 Aug 2014 08:57:00 +0000</updated>
                            <resolved>Thu, 17 Jul 2014 22:05:30 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                    <component>MLlib</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13969718" author="mengxr" created="Tue, 15 Apr 2014 16:46:28 +0000"  >&lt;p&gt;The error was due to small number of points and large k. The k-means|| initialization doesn&apos;t collect more than k candidates. This is very unlikely to appear in practice because k is much smaller than number of points. I will re-visit this issue once we implement better weighted sampling algorithms.&lt;/p&gt;</comment>
                            <comment id="14007090" author="dmaverick" created="Fri, 23 May 2014 12:26:55 +0000"  >&lt;p&gt;I don&apos;t think that the problem is about size of dataset. I&apos;ve faced with similar issue on dataset  with about 900 items. As a workaround we&apos;ve decided to fallback with random init mode.&lt;/p&gt;
</comment>
                            <comment id="14007094" author="dmaverick" created="Fri, 23 May 2014 12:28:24 +0000"  >&lt;p&gt;attach test dataset&lt;br/&gt;
MLLib failed to find 4 centers with k-means|| init mode on this data&lt;/p&gt;</comment>
                            <comment id="14061095" author="josephkb" created="Mon, 14 Jul 2014 19:35:06 +0000"  >&lt;p&gt;Submitted fix as PR 1407: &lt;a href=&quot;https://github.com/apache/spark/pull/1407&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1407&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Made default behavior to return k clusters still, with some duplicated&lt;/p&gt;</comment>
                            <comment id="14065654" author="mengxr" created="Thu, 17 Jul 2014 22:05:30 +0000"  >&lt;p&gt;Issue resolved by pull request 1468&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/1468&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1468&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12725334">SPARK-2355</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12736686">SPARK-3218</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12646502" name="test.csv" size="22359" author="dmaverick" created="Fri, 23 May 2014 12:28:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>383031</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1tzmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>383299</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12326686">1.1.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>