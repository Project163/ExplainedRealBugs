<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:46:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-16873] force spill NPE</title>
                <link>https://issues.apache.org/jira/browse/SPARK-16873</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;16/07/31 20:52:38 INFO executor.Executor: Running task 1090.1 in stage 18.0 (TID 23793)&lt;br/&gt;
16/07/31 20:52:38 INFO storage.ShuffleBlockFetcherIterator: Getting 5000 non-empty blocks out of 5000 blocks&lt;br/&gt;
16/07/31 20:52:38 INFO collection.ExternalSorter: Thread 151 spilling in-memory map of 410.3 MB to disk (1 time so far)&lt;br/&gt;
16/07/31 20:52:38 INFO storage.ShuffleBlockFetcherIterator: Started 30 remote fetches in 214 ms&lt;br/&gt;
16/07/31 20:52:44 INFO collection.ExternalSorter: spill memory to &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;file:/data5/yarnenv/local/usercache/tesla/appcache/application_1465785263942_56138/blockmgr-e9cc29b9-ca1a-460a-ad76-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/data5/yarnenv/local/usercache/tesla/appcache/application_1465785263942_56138/blockmgr-e9cc29b9-ca1a-460a-ad76-&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;32f8ee437e51/0d/temp_shuffle_dc8f4489-2289-4b99-a605-81c873dc9e17, fileSize:46.0 MB&lt;br/&gt;
16/07/31 20:52:44 WARN memory.ExecutionMemoryPool: Internal error: release called on 430168384 bytes but task only has &lt;/p&gt;

&lt;p&gt;424958272 bytes of memory from the on-heap execution pool&lt;br/&gt;
16/07/31 20:52:45 INFO collection.ExternalSorter: Thread 152 spilling in-memory map of 398.7 MB to disk (1 time so far)&lt;br/&gt;
16/07/31 20:52:52 INFO collection.ExternalSorter: Thread 151 spilling in-memory map of 389.6 MB to disk (2 times so far)&lt;br/&gt;
16/07/31 20:52:54 INFO collection.ExternalSorter: spill memory to &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;file:/data11/yarnenv/local/usercache/tesla/appcache/application_1465785263942_56138/blockmgr-56e1ec4d-9560-4019-83f7-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/data11/yarnenv/local/usercache/tesla/appcache/application_1465785263942_56138/blockmgr-56e1ec4d-9560-4019-83f7-&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ec6fd3fe78f9/24/temp_shuffle_10a210a4-38df-40e6-821d-00e15da12eaa, fileSize:45.5 MB&lt;br/&gt;
16/07/31 20:52:54 WARN memory.ExecutionMemoryPool: Internal error: release called on 413772021 bytes but task only has &lt;/p&gt;

&lt;p&gt;408561909 bytes of memory from the on-heap execution pool&lt;br/&gt;
16/07/31 20:52:55 INFO collection.ExternalSorter: spill memory to &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;file:/data2/yarnenv/local/usercache/tesla/appcache/application_1465785263942_56138/blockmgr-f4fe32a2-c930-4b49-8feb-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/data2/yarnenv/local/usercache/tesla/appcache/application_1465785263942_56138/blockmgr-f4fe32a2-c930-4b49-8feb-&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;722536c290d7/10/temp_shuffle_4ae9dd49-6039-4a44-901a-ee4650351ebc, fileSize:44.7 MB&lt;br/&gt;
16/07/31 20:52:56 INFO collection.ExternalSorter: Thread 152 spilling in-memory map of 389.6 MB to disk (2 times so far)&lt;br/&gt;
16/07/31 20:53:30 INFO collection.ExternalSorter: spill memory to &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;file:/data6/yarnenv/local/usercache/tesla/appcache/application_1465785263942_56138/blockmgr-95b49f89-4155-435c-826b-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/data6/yarnenv/local/usercache/tesla/appcache/application_1465785263942_56138/blockmgr-95b49f89-4155-435c-826b-&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;7a616662d47a/1b/temp_shuffle_ea43939f-04d4-42a9-805f-44e01afc9a13, fileSize:44.7 MB&lt;br/&gt;
16/07/31 20:53:30 INFO collection.ExternalSorter: Thread 151 spilling in-memory map of 389.6 MB to disk (3 times so far)&lt;br/&gt;
16/07/31 20:53:49 INFO collection.ExternalSorter: spill memory to &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;file:/data10/yarnenv/local/usercache/tesla/appcache/application_1465785263942_56138/blockmgr-4f736364-e192-4f31-bfe9-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/data10/yarnenv/local/usercache/tesla/appcache/application_1465785263942_56138/blockmgr-4f736364-e192-4f31-bfe9-&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;8eaa29ff2114/3f/temp_shuffle_680e07ec-404e-4710-9d14-1665b300e05c, fileSize:44.7 MB&lt;br/&gt;
16/07/31 20:54:04 INFO collection.ExternalSorter: Task 23585 force spilling in-memory map to disk and  it will release 164.3 &lt;/p&gt;

&lt;p&gt;MB memory&lt;br/&gt;
16/07/31 20:54:04 INFO collection.ExternalSorter: spill memory to &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;file:/data4/yarnenv/local/usercache/tesla/appcache/application_1465785263942_56138/blockmgr-db5f46c3-d7a4-4f93-8b77-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/data4/yarnenv/local/usercache/tesla/appcache/application_1465785263942_56138/blockmgr-db5f46c3-d7a4-4f93-8b77-&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;565e469696fb/09/temp_shuffle_ec3ece08-4569-4197-893a-4a5dfcbbf9fa, fileSize:0.0 B&lt;br/&gt;
16/07/31 20:54:04 WARN memory.TaskMemoryManager: leak 164.3 MB memory from &lt;/p&gt;

&lt;p&gt;org.apache.spark.util.collection.ExternalSorter@3db4b52d&lt;br/&gt;
16/07/31 20:54:04 ERROR executor.Executor: Managed memory leak detected; size = 190458101 bytes, TID = 23585&lt;br/&gt;
16/07/31 20:54:04 ERROR executor.Executor: Exception in task 1013.0 in stage 18.0 (TID 23585)&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.spark.util.collection.ExternalSorter$SpillReader.cleanup(ExternalSorter.scala:625)&lt;br/&gt;
	at org.apache.spark.util.collection.ExternalSorter$SpillReader.nextBatchStream(ExternalSorter.scala:540)&lt;br/&gt;
	at org.apache.spark.util.collection.ExternalSorter$SpillReader.&amp;lt;init&amp;gt;(ExternalSorter.scala:508)&lt;br/&gt;
	at org.apache.spark.util.collection.ExternalSorter$SpillableIterator.spill(ExternalSorter.scala:814)&lt;br/&gt;
	at org.apache.spark.util.collection.ExternalSorter.forceSpill(ExternalSorter.scala:254)&lt;br/&gt;
	at org.apache.spark.util.collection.Spillable.spill(Spillable.scala:109)&lt;br/&gt;
	at org.apache.spark.memory.TaskMemoryManager.acquireExecutionMemory(TaskMemoryManager.java:154)&lt;br/&gt;
	at org.apache.spark.memory.TaskMemoryManager.allocatePage(TaskMemoryManager.java:249)&lt;br/&gt;
	at org.apache.spark.memory.MemoryConsumer.allocatePage(MemoryConsumer.java:112)&lt;br/&gt;
	at org.apache.spark.shuffle.sort.ShuffleExternalSorter.acquireNewPageIfNecessary(ShuffleExternalSorter.java:346)&lt;br/&gt;
	at org.apache.spark.shuffle.sort.ShuffleExternalSorter.insertRecord(ShuffleExternalSorter.java:367)&lt;br/&gt;
	at org.apache.spark.shuffle.sort.UnsafeShuffleWriter.insertRecordIntoSorter(UnsafeShuffleWriter.java:237)&lt;br/&gt;
	at org.apache.spark.shuffle.sort.UnsafeShuffleWriter.write(UnsafeShuffleWriter.java:164)&lt;br/&gt;
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:73)&lt;br/&gt;
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:41)&lt;br/&gt;
	at org.apache.spark.scheduler.Task.run(Task.scala:89)&lt;br/&gt;
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:227)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:744)&lt;br/&gt;
16/07/31 20:54:30 INFO executor.Executor: Executor is trying to kill task 1090.1 in stage 18.0 (TID 23793)&lt;br/&gt;
16/07/31 20:54:30 INFO executor.CoarseGrainedExecutorBackend: Driver commanded a shutdown&lt;br/&gt;
16/07/31 20:54:31 INFO storage.MemoryStore: MemoryStore cleared&lt;br/&gt;
16/07/31 20:54:31 INFO storage.BlockManager: BlockManager stopped&lt;br/&gt;
16/07/31 20:54:31 INFO remote.RemoteActorRefProvider$RemotingTerminator: Shutting down remote daemon.&lt;br/&gt;
16/07/31 20:54:31 INFO remote.RemoteActorRefProvider$RemotingTerminator: Remote daemon shut down; proceeding with flushing &lt;/p&gt;

&lt;p&gt;remote transports.&lt;br/&gt;
16/07/31 20:54:31 INFO remote.RemoteActorRefProvider$RemotingTerminator: Remoting shut down.&lt;br/&gt;
16/07/31 20:54:31 INFO util.ShutdownHookManager: Shutdown hook called&lt;/p&gt;</description>
                <environment></environment>
        <key id="12994531">SPARK-16873</key>
            <summary>force spill NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sharkd">sharkd tu</assignee>
                                    <reporter username="sharkd">sharkd tu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Aug 2016 09:35:19 +0000</created>
                <updated>Sun, 6 Nov 2016 14:19:23 +0000</updated>
                            <resolved>Thu, 4 Aug 2016 02:22:12 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>1.6.3</fixVersion>
                    <fixVersion>2.0.1</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                    <component>Spark Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15405718" author="srowen" created="Wed, 3 Aug 2016 10:53:15 +0000"  >&lt;p&gt;Seems easy to avoid dereferencing the null stream reference in the cleanup method, go ahead.&lt;/p&gt;</comment>
                            <comment id="15405807" author="apachespark" created="Wed, 3 Aug 2016 12:04:04 +0000"  >&lt;p&gt;User &apos;sharkdtu&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14479&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14479&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13018599">SPARK-18289</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 15 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31ugf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>