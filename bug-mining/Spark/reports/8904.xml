<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:32:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-42444] DataFrame.drop should handle multi columns properly</title>
                <link>https://issues.apache.org/jira/browse/SPARK-42444</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
from pyspark.sql &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; Row
df1 = spark.createDataFrame([(14, &lt;span class=&quot;code-quote&quot;&gt;&quot;Tom&quot;&lt;/span&gt;), (23, &lt;span class=&quot;code-quote&quot;&gt;&quot;Alice&quot;&lt;/span&gt;), (16, &lt;span class=&quot;code-quote&quot;&gt;&quot;Bob&quot;&lt;/span&gt;)], [&lt;span class=&quot;code-quote&quot;&gt;&quot;age&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;])
df2 = spark.createDataFrame([Row(height=80, name=&lt;span class=&quot;code-quote&quot;&gt;&quot;Tom&quot;&lt;/span&gt;), Row(height=85, name=&lt;span class=&quot;code-quote&quot;&gt;&quot;Bob&quot;&lt;/span&gt;)])
df1.join(df2, df1.name == df2.name, &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;&apos;&lt;/span&gt;).drop(&lt;span class=&quot;code-quote&quot;&gt;&apos;name&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;age&apos;&lt;/span&gt;).show()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This works in 3.3&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+------+
|height|
+------+
|    85|
|    80|
+------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;but fails in 3.4&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
---------------------------------------------------------------------------
AnalysisException                         Traceback (most recent call last)
Cell In[1], line 4
      2 df1 = spark.createDataFrame([(14, &lt;span class=&quot;code-quote&quot;&gt;&quot;Tom&quot;&lt;/span&gt;), (23, &lt;span class=&quot;code-quote&quot;&gt;&quot;Alice&quot;&lt;/span&gt;), (16, &lt;span class=&quot;code-quote&quot;&gt;&quot;Bob&quot;&lt;/span&gt;)], [&lt;span class=&quot;code-quote&quot;&gt;&quot;age&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;])
      3 df2 = spark.createDataFrame([Row(height=80, name=&lt;span class=&quot;code-quote&quot;&gt;&quot;Tom&quot;&lt;/span&gt;), Row(height=85, name=&lt;span class=&quot;code-quote&quot;&gt;&quot;Bob&quot;&lt;/span&gt;)])
----&amp;gt; 4 df1.join(df2, df1.name == df2.name, &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;&apos;&lt;/span&gt;).drop(&lt;span class=&quot;code-quote&quot;&gt;&apos;name&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;age&apos;&lt;/span&gt;).show()

File ~/Dev/spark/python/pyspark/sql/dataframe.py:4913, in DataFrame.drop(self, *cols)
   4911     jcols = [_to_java_column(c) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; c in cols]
   4912     first_column, *remaining_columns = jcols
-&amp;gt; 4913     jdf = self._jdf.drop(first_column, self._jseq(remaining_columns))
   4915 &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; DataFrame(jdf, self.sparkSession)

File ~/Dev/spark/python/lib/py4j-0.10.9.7-src.zip/py4j/java_gateway.py:1322, in JavaMember.__call__(self, *args)
   1316 command = proto.CALL_COMMAND_NAME +\
   1317     self.command_header +\
   1318     args_command +\
   1319     proto.END_COMMAND_PART
   1321 answer = self.gateway_client.send_command(command)
-&amp;gt; 1322 return_value = get_return_value(
   1323     answer, self.gateway_client, self.target_id, self.name)
   1325 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; temp_arg in temp_args:
   1326     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; hasattr(temp_arg, &lt;span class=&quot;code-quote&quot;&gt;&quot;_detach&quot;&lt;/span&gt;):

File ~/Dev/spark/python/pyspark/errors/exceptions/captured.py:159, in capture_sql_exception.&amp;lt;locals&amp;gt;.deco(*a, **kw)
    155 converted = convert_exception(e.java_exception)
    156 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; not isinstance(converted, UnknownException):
    157     # Hide where the exception came from that shows a non-Pythonic
    158     # JVM exception message.
--&amp;gt; 159     raise converted from None
    160 &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;:
    161     raise

AnalysisException: [AMBIGUOUS_REFERENCE] Reference `name` is ambiguous, could be: [`name`, `name`].

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</description>
                <environment></environment>
        <key id="13524752">SPARK-42444</key>
            <summary>DataFrame.drop should handle multi columns properly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="podongfeng">Ruifeng Zheng</assignee>
                                    <reporter username="podongfeng">Ruifeng Zheng</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Feb 2023 02:46:43 +0000</created>
                <updated>Fri, 24 Feb 2023 00:03:57 +0000</updated>
                            <resolved>Fri, 24 Feb 2023 00:03:57 +0000</resolved>
                                    <version>3.4.0</version>
                                    <fixVersion>3.4.0</fixVersion>
                                    <component>PySpark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17692442" author="podongfeng" created="Thu, 23 Feb 2023 02:01:44 +0000"  >&lt;p&gt;I am going to fix this one&lt;/p&gt;</comment>
                            <comment id="17692466" author="apachespark" created="Thu, 23 Feb 2023 03:07:34 +0000"  >&lt;p&gt;User &apos;zhengruifeng&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/40135&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40135&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17692467" author="apachespark" created="Thu, 23 Feb 2023 03:07:55 +0000"  >&lt;p&gt;User &apos;zhengruifeng&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/40135&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40135&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17692955" author="podongfeng" created="Fri, 24 Feb 2023 00:03:57 +0000"  >&lt;p&gt;Issue resolved by pull request 40135&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/40135&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40135&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1fxug:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>