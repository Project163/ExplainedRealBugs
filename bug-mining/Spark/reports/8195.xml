<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:27:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-36926] Discrepancy in Q22 of TPCH for Spark 3.2</title>
                <link>https://issues.apache.org/jira/browse/SPARK-36926</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;When running TPCH scale 100 against 3.2, Query 22 has a discrepancy in the number of rows returned by the query. This was tested with both AQE on and off. All the other queries were matching in results. Below is the results that we got when testing Q22 on 3.2:&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-quote&quot;&gt;&quot;results&quot;&lt;/span&gt;: [
    {
      &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;Q22&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;mode&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;collect&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;parameters&quot;&lt;/span&gt;: {},
      &lt;span class=&quot;code-quote&quot;&gt;&quot;joinTypes&quot;&lt;/span&gt;: [
        &lt;span class=&quot;code-quote&quot;&gt;&quot;SortMergeJoin&quot;&lt;/span&gt;
      ],
      &lt;span class=&quot;code-quote&quot;&gt;&quot;tables&quot;&lt;/span&gt;: [
        &lt;span class=&quot;code-quote&quot;&gt;&quot;customer&quot;&lt;/span&gt;
      ],
      &lt;span class=&quot;code-quote&quot;&gt;&quot;parsingTime&quot;&lt;/span&gt;: 0.016522,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;analysisTime&quot;&lt;/span&gt;: 0.004132,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;optimizationTime&quot;&lt;/span&gt;: 39.173868,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;planningTime&quot;&lt;/span&gt;: 23.10939,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;executionTime&quot;&lt;/span&gt;: 13762.183844,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;result&quot;&lt;/span&gt;: 0,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;breakDown&quot;&lt;/span&gt;: [],
      &lt;span class=&quot;code-quote&quot;&gt;&quot;queryExecution&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;== Parsed Logical Plan ==\n&lt;span class=&quot;code-quote&quot;&gt;&apos;Sort [&apos;&lt;/span&gt;cntrycode ASC NULLS FIRST], &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;\n+- &lt;span class=&quot;code-quote&quot;&gt;&apos;Aggregate [&apos;&lt;/span&gt;cntrycode], [&lt;span class=&quot;code-quote&quot;&gt;&apos;cntrycode, &apos;&lt;/span&gt;count(1) AS numcust#150, &lt;span class=&quot;code-quote&quot;&gt;&apos;sum(&apos;&lt;/span&gt;c_acctbal) AS totacctbal#151]\n   +- &lt;span class=&quot;code-quote&quot;&gt;&apos;SubqueryAlias custsale\n      +- &apos;&lt;/span&gt;Project [&lt;span class=&quot;code-quote&quot;&gt;&apos;substring(&apos;&lt;/span&gt;c_phone, 1, 2) AS cntrycode#147, &lt;span class=&quot;code-quote&quot;&gt;&apos;c_acctbal]\n         +- &apos;&lt;/span&gt;Filter ((&lt;span class=&quot;code-quote&quot;&gt;&apos;substring(&apos;&lt;/span&gt;c_phone, 1, 2) IN (13,31,23,29,30,18,17) AND (&lt;span class=&quot;code-quote&quot;&gt;&apos;c_acctbal &amp;gt; scalar-subquery#148 [])) AND NOT exists#149 [])\n            :  :- &apos;&lt;/span&gt;Project [unresolvedalias(&lt;span class=&quot;code-quote&quot;&gt;&apos;avg(&apos;&lt;/span&gt;c_acctbal), None)]\n            :  :  +- &lt;span class=&quot;code-quote&quot;&gt;&apos;Filter ((&apos;&lt;/span&gt;c_acctbal &amp;gt; 0.00) AND &lt;span class=&quot;code-quote&quot;&gt;&apos;substring(&apos;&lt;/span&gt;c_phone, 1, 2) IN (13,31,23,29,30,18,17))\n            :  :     +- &lt;span class=&quot;code-quote&quot;&gt;&apos;UnresolvedRelation [customer], [], &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;\n            :  +- &apos;&lt;/span&gt;Project [*]\n            :     +- &lt;span class=&quot;code-quote&quot;&gt;&apos;Filter (&apos;&lt;/span&gt;o_custkey = &lt;span class=&quot;code-quote&quot;&gt;&apos;c_custkey)\n            :        +- &apos;&lt;/span&gt;UnresolvedRelation [orders], [], &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;\n            +- &apos;UnresolvedRelation [customer], [], &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;\n\n== Analyzed Logical Plan ==\ncntrycode: string, numcust: bigint, totacctbal: decimal(22,2)\nSort [cntrycode#147 ASC NULLS FIRST], &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;\n+- Aggregate [cntrycode#147], [cntrycode#147, count(1) AS numcust#150L, sum(c_acctbal#11) AS totacctbal#151]\n   +- SubqueryAlias custsale\n      +- Project [substring(c_phone#10, 1, 2) AS cntrycode#147, c_acctbal#11]\n         +- Filter ((substring(c_phone#10, 1, 2) IN (13,31,23,29,30,18,17) AND (&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(c_acctbal#11 as decimal(16,6)) &amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(scalar-subquery#148 [] as decimal(16,6)))) AND NOT exists#149 [c_custkey#6L])\n            :  :- Aggregate [avg(c_acctbal#160) AS avg(c_acctbal)#154]\n            :  :  +- Filter ((&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(c_acctbal#160 as decimal(12,2)) &amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(0.00 as decimal(12,2))) AND substring(c_phone#159, 1, 2) IN (13,31,23,29,30,18,17))\n            :  :     +- SubqueryAlias spark_catalog.tpch_data_orc_100.customer\n            :  :        +- Relation tpch_data_orc_100.customer[c_custkey#155L,c_name#156,c_address#157,c_nationkey#158L,c_phone#159,c_acctbal#160,c_comment#161,c_mktsegment#162] orc\n            :  +- Project [o_orderkey#16L, o_custkey#17L, o_orderstatus#18, o_totalprice#19, o_orderpriority#20, o_clerk#21, o_shippriority#22, o_comment#23, o_orderdate#24]\n            :     +- Filter (o_custkey#17L = &lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt;(c_custkey#6L))\n            :        +- SubqueryAlias spark_catalog.tpch_data_orc_100.orders\n            :           +- Relation tpch_data_orc_100.orders[o_orderkey#16L,o_custkey#17L,o_orderstatus#18,o_totalprice#19,o_orderpriority#20,o_clerk#21,o_shippriority#22,o_comment#23,o_orderdate#24] orc\n            +- SubqueryAlias spark_catalog.tpch_data_orc_100.customer\n               +- Relation tpch_data_orc_100.customer[c_custkey#6L,c_name#7,c_address#8,c_nationkey#9L,c_phone#10,c_acctbal#11,c_comment#12,c_mktsegment#13] orc\n\n== Optimized Logical Plan ==\nSort [cntrycode#147 ASC NULLS FIRST], &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;\n+- Aggregate [cntrycode#147], [cntrycode#147, count(1) AS numcust#150L, sum(c_acctbal#11) AS totacctbal#151]\n   +- Project [substring(c_phone#10, 1, 2) AS cntrycode#147, c_acctbal#11]\n      +- Join LeftAnti, (o_custkey#17L = c_custkey#6L)\n         :- Project [c_custkey#6L, c_phone#10, c_acctbal#11]\n         :  +- Filter ((isnotnull(c_acctbal#11) AND substring(c_phone#10, 1, 2) IN (13,31,23,29,30,18,17)) AND (&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(c_acctbal#11 as decimal(16,6)) &amp;gt; scalar-subquery#148 []))\n         :     :  +- Aggregate [avg(c_acctbal#160) AS avg(c_acctbal)#154]\n         :     :     +- Project [c_acctbal#160]\n         :     :        +- Filter (isnotnull(c_acctbal#160) AND ((c_acctbal#160 &amp;gt; 0.00) AND substring(c_phone#159, 1, 2) IN (13,31,23,29,30,18,17)))\n         :     :           +- Relation tpch_data_orc_100.customer[c_custkey#155L,c_name#156,c_address#157,c_nationkey#158L,c_phone#159,c_acctbal#160,c_comment#161,c_mktsegment#162] orc\n         :     +- Relation tpch_data_orc_100.customer[c_custkey#6L,c_name#7,c_address#8,c_nationkey#9L,c_phone#10,c_acctbal#11,c_comment#12,c_mktsegment#13] orc\n         +- Project [o_custkey#17L]\n            +- Relation tpch_data_orc_100.orders[o_orderkey#16L,o_custkey#17L,o_orderstatus#18,o_totalprice#19,o_orderpriority#20,o_clerk#21,o_shippriority#22,o_comment#23,o_orderdate#24] orc\n\n== Physical Plan ==\n*(7) Sort [cntrycode#147 ASC NULLS FIRST], &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, 0\n+- Exchange rangepartitioning(cntrycode#147 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [id=#314]\n   +- *(6) HashAggregate(keys=[cntrycode#147], functions=[count(1), sum(c_acctbal#11)], output=[cntrycode#147, numcust#150L, totacctbal#151])\n      +- Exchange hashpartitioning(cntrycode#147, 200), ENSURE_REQUIREMENTS, [id=#310]\n         +- *(5) HashAggregate(keys=[cntrycode#147], functions=[partial_count(1), partial_sum(c_acctbal#11)], output=[cntrycode#147, count#170L, sum#171, isEmpty#172])\n            +- *(5) Project [substring(c_phone#10, 1, 2) AS cntrycode#147, c_acctbal#11]\n               +- *(5) SortMergeJoin [c_custkey#6L], [o_custkey#17L], LeftAnti\n                  :- *(2) Sort [c_custkey#6L ASC NULLS FIRST], &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, 0\n                  :  +- Exchange hashpartitioning(c_custkey#6L, 200), ENSURE_REQUIREMENTS, [id=#292]\n                  :     +- *(1) Project [c_custkey#6L, c_phone#10, c_acctbal#11]\n                  :        +- *(1) Filter ((isnotnull(c_acctbal#11) AND substring(c_phone#10, 1, 2) IN (13,31,23,29,30,18,17)) AND (&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(c_acctbal#11 as decimal(16,6)) &amp;gt; Subquery scalar-subquery#148, [id=#249]))\n                  :           :  +- Subquery scalar-subquery#148, [id=#249]\n                  :           :     +- *(2) HashAggregate(keys=[], functions=[avg(c_acctbal#160)], output=[avg(c_acctbal)#154])\n                  :           :        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#245]\n                  :           :           +- *(1) HashAggregate(keys=[], functions=[partial_avg(c_acctbal#160)], output=[sum#175, count#176L])\n                  :           :              +- *(1) Project [c_acctbal#160]\n                  :           :                 +- *(1) Filter ((isnotnull(c_acctbal#160) AND (c_acctbal#160 &amp;gt; 0.00)) AND substring(c_phone#159, 1, 2) IN (13,31,23,29,30,18,17))\n                  :           :                    +- *(1) ColumnarToRow\n                  :           :                       +- FileScan orc tpch_data_orc_100.customer[c_phone#159,c_acctbal#160,c_mktsegment#162] Batched: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, DataFilters: [isnotnull(c_acctbal#160), (c_acctbal#160 &amp;gt; 0.00), substring(c_phone#159, 1, 2) IN (13,31,23,29,3..., Format: ORC, Location: CatalogFileIndex(0 paths)[], PartitionFilters: [], PushedFilters: [IsNotNull(c_acctbal), GreaterThan(c_acctbal,0.00)], ReadSchema: struct&amp;lt;c_phone:string,c_acctbal:decimal(12,2)&amp;gt;\n                  :           +- *(1) ColumnarToRow\n                  :              +- FileScan orc tpch_data_orc_100.customer[c_custkey#6L,c_phone#10,c_acctbal#11,c_mktsegment#13] Batched: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, DataFilters: [isnotnull(c_acctbal#11), substring(c_phone#10, 1, 2) IN (13,31,23,29,30,18,17)], Format: ORC, Location: CatalogFileIndex(0 paths)[], PartitionFilters: [], PushedFilters: [IsNotNull(c_acctbal)], ReadSchema: struct&amp;lt;c_custkey:bigint,c_phone:string,c_acctbal:decimal(12,2)&amp;gt;\n                  +- *(4) Sort [o_custkey#17L ASC NULLS FIRST], &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, 0\n                     +- Exchange hashpartitioning(o_custkey#17L, 200), ENSURE_REQUIREMENTS, [id=#301]\n                        +- *(3) Project [o_custkey#17L]\n                           +- *(3) ColumnarToRow\n                              +- FileScan orc tpch_data_orc_100.orders[o_custkey#17L,o_orderdate#24] Batched: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, DataFilters: [], Format: ORC, Location: CatalogFileIndex(0 paths)[], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&amp;lt;o_custkey:bigint&amp;gt;\n&quot;&lt;/span&gt;
    }
  ]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The correct result should be 7 rows returned, not 0 as shown above. This can be confirmed by testing the same exact query against the hive table using Presto/Hive, which both return 7. Additionally, this link also shows that it should be 7 &lt;a href=&quot;https://github.com/apache/impala/blob/master/testdata/workloads/tpch/queries/tpch-q22.test.&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/impala/blob/master/testdata/workloads/tpch/queries/tpch-q22.test.&lt;/a&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13404826">SPARK-36926</key>
            <summary>Discrepancy in Q22 of TPCH for Spark 3.2</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cloud_fan">Wenchen Fan</assignee>
                                    <reporter username="apatnam">Aravind Patnam</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Oct 2021 17:24:00 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:50 +0000</updated>
                            <resolved>Wed, 6 Oct 2021 05:31:48 +0000</resolved>
                                    <version>3.2.0</version>
                                    <fixVersion>3.2.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17424058" author="apatnam" created="Mon, 4 Oct 2021 17:32:09 +0000"  >&lt;p&gt;cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vsowrirajan&quot; class=&quot;user-hover&quot; rel=&quot;vsowrirajan&quot;&gt;vsowrirajan&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mridulm80&quot; class=&quot;user-hover&quot; rel=&quot;mridulm80&quot;&gt;mridulm80&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17424080" author="vsowrirajan" created="Mon, 4 Oct 2021 18:04:41 +0000"  >&lt;p&gt;The issue seems to be with this subquery part of q22.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;&quot;select avg(c_acctbal) from customer where c_acctbal &amp;gt; 0.00 and substr(c_phone, 1, 2) in (&lt;span class=&quot;code-quote&quot;&gt;&apos;13&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;31&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;23&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;29&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;30&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;18&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;17&apos;&lt;/span&gt;)&quot;&lt;/span&gt;&quot;&quot;).collect
Array([&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;])
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;&quot;select sum(c_acctbal)/count(c_acctbal) from customer where c_acctbal &amp;gt; 0.00 and substr(c_phone, 1, 2) in (&lt;span class=&quot;code-quote&quot;&gt;&apos;13&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;31&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;23&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;29&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;30&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;18&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;17&apos;&lt;/span&gt;)&quot;&lt;/span&gt;&quot;&quot;).collect
Array([4998.769056963132322922])&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It seems like there is some behavior change wrt 3.2.&lt;/p&gt;</comment>
                            <comment id="17424097" author="mridulm80" created="Mon, 4 Oct 2021 18:26:53 +0000"  >&lt;p&gt;+CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gengliang&quot; class=&quot;user-hover&quot; rel=&quot;gengliang&quot;&gt;gengliang&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17424112" author="vsowrirajan" created="Mon, 4 Oct 2021 18:54:39 +0000"  >&lt;p&gt;I tried to get a simpler repro.&#160;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; spark.implicits._
val buf = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; scala.collection.mutable.ArrayBuffer[&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;]
&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (i &amp;lt;- 0.toDouble to 9999.toDouble by 0.01) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (j &amp;lt;- 0 to 5) { buf += i }

val df = buf.toDF
df.selectExpr(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(value as decimal(12, 2))&quot;&lt;/span&gt;).agg(avg(&lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;)).show

Array[&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]

df.selectExpr(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(value as decimal(16, 2))&quot;&lt;/span&gt;).agg(avg(&lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;)).show

+-----------+
| avg(value)|
+-----------+
|4999.500000|
+-----------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17424256" author="gurwls223" created="Tue, 5 Oct 2021 01:55:40 +0000"  >&lt;p&gt;Just to clarify, do you know if this is a regression or not &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apatnam&quot; class=&quot;user-hover&quot; rel=&quot;apatnam&quot;&gt;apatnam&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="17424265" author="vsowrirajan" created="Tue, 5 Oct 2021 02:23:39 +0000"  >&lt;p&gt;This looks like a regression given the behavior of other engines like hive, presto, impala even spark 3.1 all return 7 records.&lt;/p&gt;</comment>
                            <comment id="17424293" author="apachespark" created="Tue, 5 Oct 2021 05:26:45 +0000"  >&lt;p&gt;User &apos;cloud-fan&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34180&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34180&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17424294" author="apachespark" created="Tue, 5 Oct 2021 05:27:40 +0000"  >&lt;p&gt;User &apos;cloud-fan&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34180&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34180&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17424783" author="apachespark" created="Wed, 6 Oct 2021 03:27:26 +0000"  >&lt;p&gt;User &apos;cloud-fan&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34193&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34193&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17424784" author="apachespark" created="Wed, 6 Oct 2021 03:28:24 +0000"  >&lt;p&gt;User &apos;cloud-fan&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34193&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34193&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17424792" author="gengliang.wang" created="Wed, 6 Oct 2021 05:31:48 +0000"  >&lt;p&gt;Issue resolved by pull request 34193&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34193&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34193&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 5 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0vjrk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>