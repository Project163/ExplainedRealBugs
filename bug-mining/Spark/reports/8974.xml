<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:32:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-42655] Incorrect ambiguous column reference error</title>
                <link>https://issues.apache.org/jira/browse/SPARK-42655</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;val df1 = sc.parallelize(List((1,2,3,4,5),(1,2,3,4,5))).toDF(&quot;id&quot;,&quot;col2&quot;,&quot;col3&quot;,&quot;col4&quot;, &quot;col5&quot;)&lt;br/&gt;
val op_cols_same_case = List(&quot;id&quot;,&quot;col2&quot;,&quot;col3&quot;,&quot;col4&quot;, &quot;col5&quot;, &quot;id&quot;)&lt;br/&gt;
val df2 = df1.select(op_cols_same_case.head, op_cols_same_case.tail: _*)&lt;br/&gt;
df2.select(&quot;id&quot;).show()&lt;br/&gt;
&#160;&lt;br/&gt;
This query runs fine.&lt;br/&gt;
&#160;&lt;br/&gt;
But when we change the casing of the op_cols to have mix of upper &amp;amp; lower case (&quot;id&quot; &amp;amp; &quot;ID&quot;) it throws an ambiguous col ref error:&lt;br/&gt;
&#160;&lt;br/&gt;
val df1 = sc.parallelize(List((1,2,3,4,5),(1,2,3,4,5))).toDF(&quot;id&quot;,&quot;col2&quot;,&quot;col3&quot;,&quot;col4&quot;, &quot;col5&quot;)&lt;br/&gt;
val op_cols_mixed_case = List(&quot;id&quot;,&quot;col2&quot;,&quot;col3&quot;,&quot;col4&quot;, &quot;col5&quot;, &quot;ID&quot;)&lt;br/&gt;
val df3 = df1.select(op_cols_mixed_case.head, op_cols_mixed_case.tail: _*)&lt;br/&gt;
df3.select(&quot;id&quot;).show()&lt;/p&gt;



&lt;p&gt;org.apache.spark.sql.AnalysisException: Reference &apos;id&apos; is ambiguous, could be: id, id.&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.expressions.package$AttributeSeq.resolve(package.scala:363)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveChildren(LogicalPlan.scala:112)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$resolveExpressionByPlanChildren$1(Analyzer.scala:1857)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$resolveExpression$2(Analyzer.scala:1787)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.analysis.package$.withPosition(package.scala:60)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.analysis.Analyzer.innerResolve$1(Analyzer.scala:1794)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.analysis.Analyzer.resolveExpression(Analyzer.scala:1812)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.analysis.Analyzer.resolveExpressionByPlanChildren(Analyzer.scala:1863)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$17.$anonfun$applyOrElse$94(Analyzer.scala:1577)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.plans.QueryPlan.$anonfun$mapExpressions$1(QueryPlan.scala:193)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:82)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpression$1(QueryPlan.scala:193)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.plans.QueryPlan.recursiveTransform$1(QueryPlan.scala:204)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.plans.QueryPlan.$anonfun$mapExpressions$3(QueryPlan.scala:209)&lt;/p&gt;

&lt;p&gt;&#160; at scala.collection.TraversableLike.$anonfun$map$1(TraversableLike.scala:286)&lt;/p&gt;

&lt;p&gt;&#160; at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)&lt;/p&gt;

&lt;p&gt;&#160; at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)&lt;/p&gt;

&lt;p&gt;&#160; at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)&lt;/p&gt;

&lt;p&gt;&#160; at scala.collection.TraversableLike.map(TraversableLike.scala:286)&lt;/p&gt;

&lt;p&gt;&#160; at scala.collection.TraversableLike.map$(TraversableLike.scala:279)&lt;/p&gt;

&lt;p&gt;&#160; at scala.collection.AbstractTraversable.map(Traversable.scala:108)&lt;/p&gt;

&lt;p&gt;&#160; at org.apache.spark.sql.catalyst.plans.QueryPlan.recursiveTransform$1(QueryPlan.scala:209)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;


&lt;p&gt;Since, Spark is case insensitive, it should work for second case also when we have upper and lower case column names in the column list.&lt;/p&gt;

&lt;p&gt;It also works fine in Spark 2.3.&lt;br/&gt;
&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13526898">SPARK-42655</key>
            <summary>Incorrect ambiguous column reference error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="unamesk15">Shrikant Prasad</assignee>
                                    <reporter username="unamesk15">Shrikant Prasad</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 2 Mar 2023 18:43:59 +0000</created>
                <updated>Sun, 26 Nov 2023 19:55:34 +0000</updated>
                            <resolved>Tue, 4 Apr 2023 13:16:42 +0000</resolved>
                                    <version>3.2.0</version>
                                    <fixVersion>3.4.0</fixVersion>
                                    <component>Spark Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17695892" author="apachespark" created="Thu, 2 Mar 2023 20:19:49 +0000"  >&lt;p&gt;User &apos;shrprasa&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/40258&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40258&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17708420" author="cloud_fan" created="Tue, 4 Apr 2023 13:16:42 +0000"  >&lt;p&gt;Issue resolved by pull request 40258&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/40258&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40258&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 32 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1gb28:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>