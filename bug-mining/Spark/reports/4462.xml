<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:50:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-19223] InputFileBlockHolder doesn&apos;t work with Python UDF for datasource other than FileFormat</title>
                <link>https://issues.apache.org/jira/browse/SPARK-19223</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;For the datasource other than FileFormat, such as spark-xml which is based on BaseRelation and uses HadoopRDD, NewHadoopRDD, InputFileBlockHolder doesn&apos;t work with Python UDF.&lt;/p&gt;

&lt;p&gt;The method to reproduce it is, running the following codes with &lt;tt&gt;bin/pyspark --packages com.databricks:spark-xml_2.11:0.4.1&lt;/tt&gt;:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;from pyspark.sql.functions &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; udf,input_file_name
from pyspark.sql.types &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; StringType
from pyspark.sql &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; SparkSession

def filename(path):
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; path

session = SparkSession.builder.appName(&lt;span class=&quot;code-quote&quot;&gt;&apos;APP&apos;&lt;/span&gt;).getOrCreate()

session.udf.register(&lt;span class=&quot;code-quote&quot;&gt;&apos;sameText&apos;&lt;/span&gt;,filename)
sameText = udf(filename, StringType())

df = session.read.format(&lt;span class=&quot;code-quote&quot;&gt;&apos;xml&apos;&lt;/span&gt;).load(&lt;span class=&quot;code-quote&quot;&gt;&apos;a.xml&apos;&lt;/span&gt;, rowTag=&lt;span class=&quot;code-quote&quot;&gt;&apos;root&apos;&lt;/span&gt;).select(&lt;span class=&quot;code-quote&quot;&gt;&apos;*&apos;&lt;/span&gt;,input_file_name().alias(&lt;span class=&quot;code-quote&quot;&gt;&apos;file&apos;&lt;/span&gt;))
df.select(&lt;span class=&quot;code-quote&quot;&gt;&apos;file&apos;&lt;/span&gt;).show()  &lt;span class=&quot;code-comment&quot;&gt;// works
&lt;/span&gt;df.select(sameText(df[&lt;span class=&quot;code-quote&quot;&gt;&apos;file&apos;&lt;/span&gt;])).show()  &lt;span class=&quot;code-comment&quot;&gt;// returns empty content&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;a.xml:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;root&amp;gt;
  &amp;lt;x&amp;gt;TEXT&amp;lt;/x&amp;gt;
  &amp;lt;y&amp;gt;TEXT2&amp;lt;/y&amp;gt;
&amp;lt;/root&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</description>
                <environment></environment>
        <key id="13034906">SPARK-19223</key>
            <summary>InputFileBlockHolder doesn&apos;t work with Python UDF for datasource other than FileFormat</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="viirya">L. C. Hsieh</assignee>
                                    <reporter username="viirya">L. C. Hsieh</reporter>
                        <labels>
                    </labels>
                <created>Sat, 14 Jan 2017 06:32:23 +0000</created>
                <updated>Wed, 18 Jan 2017 15:08:07 +0000</updated>
                            <resolved>Wed, 18 Jan 2017 15:08:07 +0000</resolved>
                                                    <fixVersion>2.2.0</fixVersion>
                                    <component>PySpark</component>
                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15822729" author="apachespark" created="Sat, 14 Jan 2017 06:45:02 +0000"  >&lt;p&gt;User &apos;viirya&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/16585&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/16585&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15822733" author="viirya" created="Sat, 14 Jan 2017 06:52:36 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=someonehere15&quot; class=&quot;user-hover&quot; rel=&quot;someonehere15&quot;&gt;someonehere15&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;For the issue on spark-xml package that when applying UDF on the column of input_file_name the result will be empty, I created this jira and submitted a PR to fix it.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 44 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38pjb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>