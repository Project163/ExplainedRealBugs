<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:04:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-26224] Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.</title>
                <link>https://issues.apache.org/jira/browse/SPARK-26224</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Reproduction step:&lt;/p&gt;

&lt;p&gt;Run this sample code on your laptop. I am trying to add 3000 new columns to a base dataframe with 1 column.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; spark.implicits._

val newColumnsToBeAdded : Seq[StructField] = &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (i &amp;lt;- 1 to 3000) yield &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StructField(&lt;span class=&quot;code-quote&quot;&gt;&quot;field_&quot;&lt;/span&gt; + i, DataTypes.LongType)

val baseDataFrame: DataFrame = Seq((1)).toDF(&lt;span class=&quot;code-quote&quot;&gt;&quot;employee_id&quot;&lt;/span&gt;)

val result = newColumnsToBeAdded.foldLeft(baseDataFrame)((df, newColumn) =&amp;gt; df.withColumn(newColumn.name, lit(0)))

result.show(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
&#160;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ends up with following stacktrace:&lt;/p&gt;

&lt;p&gt;java.lang.StackOverflowError&lt;br/&gt;
 at scala.collection.generic.GenTraversableFactory$GenericCanBuildFrom.apply(GenTraversableFactory.scala:57)&lt;br/&gt;
 at scala.collection.generic.GenTraversableFactory$GenericCanBuildFrom.apply(GenTraversableFactory.scala:52)&lt;br/&gt;
 at scala.collection.TraversableLike$class.builder$1(TraversableLike.scala:229)&lt;br/&gt;
 at scala.collection.TraversableLike$class.map(TraversableLike.scala:233)&lt;br/&gt;
 at scala.collection.immutable.List.map(List.scala:296)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:333)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:187)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:304)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:272)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformDown$1.apply(TreeNode.scala:272)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformDown$1.apply(TreeNode.scala:272)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:306)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:187)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:304)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:272)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformDown$1.apply(TreeNode.scala:272)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformDown$1.apply(TreeNode.scala:272)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:306)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:187)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:304)&lt;br/&gt;
 at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:272)&lt;/p&gt;</description>
                <environment>&lt;p&gt;On macbook, used Intellij editor. Ran the above sample code as unit test.&lt;/p&gt;</environment>
        <key id="13201440">SPARK-26224</key>
            <summary>Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgaido">Marco Gaido</assignee>
                                    <reporter username="dotsering">Dorjee Tsering</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Nov 2018 20:49:16 +0000</created>
                <updated>Mon, 12 Dec 2022 18:11:05 +0000</updated>
                            <resolved>Tue, 2 Apr 2019 05:13:19 +0000</resolved>
                                    <version>2.3.0</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="16713494" author="viirya" created="Sat, 8 Dec 2018 02:39:24 +0000"  >&lt;p&gt;I think it is not specified to withColumn. withColumn simply adds a projection on original dataframe.&lt;/p&gt;

&lt;p&gt;I think It is because you create a very deep query plan. So the analyzer or optimizer encounters when traversing down the query plan.&lt;/p&gt;

&lt;p&gt;Even it can traverse down such deep query plan, it might be not efficient to do that. I&apos;d recommend not to create such deep query plan.&lt;/p&gt;

&lt;p&gt;This should not be a bug.&lt;/p&gt;</comment>
                            <comment id="16714991" author="mgaido" created="Mon, 10 Dec 2018 16:03:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=viirya&quot; class=&quot;user-hover&quot; rel=&quot;viirya&quot;&gt;viirya&lt;/a&gt; that is true, but here it comes a question: do we want our DataFrame API to be an imperative or a declarative one? The user here is saying: I want a new column. It is Spark which is adding a new projection. One thing we can do, for instance, is to add a &lt;tt&gt;CollapseProject&lt;/tt&gt; at the end of &lt;tt&gt;withColumn&lt;/tt&gt;: in this way, the problem would be solved.&lt;/p&gt;

&lt;p&gt;You can argue that we are running an optimization in a very early phase in that case, which is not a great thing, but I noticed also that this patter is often used (there have been JIRA for the inefficiency of this approach in the past IIRC, because it caused the whole plan to be re-analyzed every time). cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smilegator&quot; class=&quot;user-hover&quot; rel=&quot;smilegator&quot;&gt;smilegator&lt;/a&gt; for their opinion on this.&lt;/p&gt;</comment>
                            <comment id="16715905" author="cloud_fan" created="Tue, 11 Dec 2018 01:23:37 +0000"  >&lt;p&gt;except `withColumn`, do we have other patterns that create a deep query plan. We did optimize union in `df.union`&lt;/p&gt;</comment>
                            <comment id="16716873" author="githubbot" created="Tue, 11 Dec 2018 11:27:42 +0000"  >&lt;p&gt;mgaido91 opened a new pull request #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285&lt;/a&gt;&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What changes were proposed in this pull request?&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   We have seen many cases when users make several subsequent calls to `withColumn` on a Dataset. This leads now to the generation of a lott of `Project` nodes on the top of the plan, with serious problem which can lead also to `StackOverflowException`s.&lt;/p&gt;

&lt;p&gt;   The PR proposes to run `CollapseProject` on the result of `withColumn` so that subsequent call (if possible) generate anyway a plan with a single project node on the top.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;How was this patch tested?&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   added UT&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716875" author="githubbot" created="Tue, 11 Dec 2018 11:28:03 +0000"  >&lt;p&gt;mgaido91 commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446169638&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446169638&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   cc @cloud-fan @viirya &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716878" author="githubbot" created="Tue, 11 Dec 2018 11:33:00 +0000"  >&lt;p&gt;AmplabJenkins commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446170969&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446170969&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Merged build finished. Test PASSed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716879" author="githubbot" created="Tue, 11 Dec 2018 11:33:01 +0000"  >&lt;p&gt;AmplabJenkins commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446170979&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446170979&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test PASSed.&lt;br/&gt;
   Refer to this link for build results (access rights to CI server needed): &lt;br/&gt;
   &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins//job/testing-k8s-prb-make-spark-distribution-unified/5969/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins//job/testing-k8s-prb-make-spark-distribution-unified/5969/&lt;/a&gt;&lt;br/&gt;
   Test PASSed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716880" author="githubbot" created="Tue, 11 Dec 2018 11:33:18 +0000"  >&lt;p&gt;SparkQA commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446171042&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446171042&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   **&lt;a href=&quot;#99969 has started&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Test build #99969 has started&lt;/a&gt;(&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99969/testReport)**&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99969/testReport)**&lt;/a&gt; for PR 23285 at commit &lt;span class=&quot;error&quot;&gt;&amp;#91;`da2c82e`&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/spark/commit/da2c82ebef5fb2a7e9279d8ce3d9364d2da61ae4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/da2c82ebef5fb2a7e9279d8ce3d9364d2da61ae4&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716882" author="githubbot" created="Tue, 11 Dec 2018 11:34:08 +0000"  >&lt;p&gt;AmplabJenkins removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446170969&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446170969&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Merged build finished. Test PASSed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716883" author="githubbot" created="Tue, 11 Dec 2018 11:34:09 +0000"  >&lt;p&gt;AmplabJenkins removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446170979&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446170979&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test PASSed.&lt;br/&gt;
   Refer to this link for build results (access rights to CI server needed): &lt;br/&gt;
   &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins//job/testing-k8s-prb-make-spark-distribution-unified/5969/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins//job/testing-k8s-prb-make-spark-distribution-unified/5969/&lt;/a&gt;&lt;br/&gt;
   Test PASSed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716892" author="githubbot" created="Tue, 11 Dec 2018 11:39:50 +0000"  >&lt;p&gt;cloud-fan commented on a change in pull request #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#discussion_r240575095&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#discussion_r240575095&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: sql/core/src/main/scala/org/apache/spark/sql/Dataset.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -2164,16 +2164,16 @@ class Dataset&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; private&lt;span class=&quot;error&quot;&gt;&amp;#91;sql&amp;#93;&lt;/span&gt;(&lt;br/&gt;
       columnMap.find &lt;/p&gt;
{ case (colName, _) =&amp;gt;
         resolver(field.name, colName)
       }
&lt;p&gt; match &lt;/p&gt;
{
-        case Some((colName: String, col: Column)) =&amp;gt; col.as(colName)
-        case _ =&amp;gt; Column(field)
+        case Some((colName: String, col: Column)) =&amp;gt; col.as(colName).named
+        case _ =&amp;gt; field
       }
&lt;p&gt;     }&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val newColumns = columnMap.filter 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: { case (colName, col) =&amp;gt;+    val newColumns = columnMap.filter { case (colName, _) =&amp;gt;
       !output.exists(f =&amp;gt; resolver(f.name, colName))
-    }.map { case (colName, col) =&amp;gt; col.as(colName) }+    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;.map &lt;/p&gt;
{ case (colName, col) =&amp;gt; col.as(colName).named }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;select(replacedAndExistingColumns ++ newColumns : _*)&lt;br/&gt;
+    CollapseProject(Project(replacedAndExistingColumns ++ newColumns, logicalPlan))&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Can we reduce the scope of this optimization? e.g. if the root node of this query is `Project`, update its project list to include `withColumns`, otherwise add a new Project.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716902" author="githubbot" created="Tue, 11 Dec 2018 11:47:27 +0000"  >&lt;p&gt;mgaido91 commented on a change in pull request #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#discussion_r240577269&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#discussion_r240577269&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: sql/core/src/main/scala/org/apache/spark/sql/Dataset.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -2164,16 +2164,16 @@ class Dataset&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; private&lt;span class=&quot;error&quot;&gt;&amp;#91;sql&amp;#93;&lt;/span&gt;(&lt;br/&gt;
       columnMap.find &lt;/p&gt;
{ case (colName, _) =&amp;gt;
         resolver(field.name, colName)
       }
&lt;p&gt; match &lt;/p&gt;
{
-        case Some((colName: String, col: Column)) =&amp;gt; col.as(colName)
-        case _ =&amp;gt; Column(field)
+        case Some((colName: String, col: Column)) =&amp;gt; col.as(colName).named
+        case _ =&amp;gt; field
       }
&lt;p&gt;     }&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val newColumns = columnMap.filter 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: { case (colName, col) =&amp;gt;+    val newColumns = columnMap.filter { case (colName, _) =&amp;gt;
       !output.exists(f =&amp;gt; resolver(f.name, colName))
-    }.map { case (colName, col) =&amp;gt; col.as(colName) }+    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;.map &lt;/p&gt;
{ case (colName, col) =&amp;gt; col.as(colName).named }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;select(replacedAndExistingColumns ++ newColumns : _*)&lt;br/&gt;
+    CollapseProject(Project(replacedAndExistingColumns ++ newColumns, logicalPlan))&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   I don&apos;t think we can do that. Imagine the case when all the columns depend on the previously added one: if we would do that, we would end up with an invalid plan. Or am I missing something?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716984" author="githubbot" created="Tue, 11 Dec 2018 12:14:41 +0000"  >&lt;p&gt;SparkQA commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446181860&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446181860&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   **&lt;a href=&quot;#99969 has finished&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Test build #99969 has finished&lt;/a&gt;(&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99969/testReport)**&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99969/testReport)**&lt;/a&gt; for PR 23285 at commit &lt;span class=&quot;error&quot;&gt;&amp;#91;`da2c82e`&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/spark/commit/da2c82ebef5fb2a7e9279d8ce3d9364d2da61ae4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/da2c82ebef5fb2a7e9279d8ce3d9364d2da61ae4&lt;/a&gt;).&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;This patch *&lt;b&gt;fails Spark unit tests&lt;/b&gt;*.&lt;/li&gt;
	&lt;li&gt;This patch merges cleanly.&lt;/li&gt;
	&lt;li&gt;This patch adds no public classes.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716985" author="githubbot" created="Tue, 11 Dec 2018 12:14:50 +0000"  >&lt;p&gt;AmplabJenkins commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446181889&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446181889&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Merged build finished. Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716986" author="githubbot" created="Tue, 11 Dec 2018 12:14:52 +0000"  >&lt;p&gt;AmplabJenkins commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446181893&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446181893&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test FAILed.&lt;br/&gt;
   Refer to this link for build results (access rights to CI server needed): &lt;br/&gt;
   &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins//job/SparkPullRequestBuilder/99969/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins//job/SparkPullRequestBuilder/99969/&lt;/a&gt;&lt;br/&gt;
   Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716987" author="githubbot" created="Tue, 11 Dec 2018 12:15:08 +0000"  >&lt;p&gt;SparkQA removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446171042&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446171042&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   **&lt;a href=&quot;#99969 has started&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Test build #99969 has started&lt;/a&gt;(&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99969/testReport)**&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99969/testReport)**&lt;/a&gt; for PR 23285 at commit &lt;span class=&quot;error&quot;&gt;&amp;#91;`da2c82e`&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/spark/commit/da2c82ebef5fb2a7e9279d8ce3d9364d2da61ae4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/da2c82ebef5fb2a7e9279d8ce3d9364d2da61ae4&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716988" author="githubbot" created="Tue, 11 Dec 2018 12:15:08 +0000"  >&lt;p&gt;AmplabJenkins removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446181889&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446181889&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Merged build finished. Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16716993" author="githubbot" created="Tue, 11 Dec 2018 12:16:07 +0000"  >&lt;p&gt;AmplabJenkins removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446181893&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446181893&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test FAILed.&lt;br/&gt;
   Refer to this link for build results (access rights to CI server needed): &lt;br/&gt;
   &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins//job/SparkPullRequestBuilder/99969/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins//job/SparkPullRequestBuilder/99969/&lt;/a&gt;&lt;br/&gt;
   Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717024" author="githubbot" created="Tue, 11 Dec 2018 12:38:29 +0000"  >&lt;p&gt;viirya commented on a change in pull request #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#discussion_r240592731&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#discussion_r240592731&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: sql/core/src/main/scala/org/apache/spark/sql/Dataset.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -2146,7 +2146,7 @@ class Dataset&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; private&lt;span class=&quot;error&quot;&gt;&amp;#91;sql&amp;#93;&lt;/span&gt;(&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Returns a new Dataset by adding columns or replacing the existing columns that has&lt;/li&gt;
	&lt;li&gt;the same names.&lt;br/&gt;
    */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private&lt;span class=&quot;error&quot;&gt;&amp;#91;spark&amp;#93;&lt;/span&gt; def withColumns(colNames: Seq&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;, cols: Seq&lt;span class=&quot;error&quot;&gt;&amp;#91;Column&amp;#93;&lt;/span&gt;): DataFrame = {&lt;br/&gt;
+  private&lt;span class=&quot;error&quot;&gt;&amp;#91;spark&amp;#93;&lt;/span&gt; def withColumns(colNames: Seq&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;, cols: Seq&lt;span class=&quot;error&quot;&gt;&amp;#91;Column&amp;#93;&lt;/span&gt;): DataFrame = withPlan {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   As stated on the JIRA ticket, the problem is deep query plan. I think we can have many ways to create such deep query plan, not only for `withColumns`. For example, you can call `select` many times to do that too. This change makes `withColumns` a special case.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717112" author="githubbot" created="Tue, 11 Dec 2018 13:19:01 +0000"  >&lt;p&gt;mgaido91 commented on a change in pull request #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#discussion_r240605608&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#discussion_r240605608&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: sql/core/src/main/scala/org/apache/spark/sql/Dataset.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -2146,7 +2146,7 @@ class Dataset&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; private&lt;span class=&quot;error&quot;&gt;&amp;#91;sql&amp;#93;&lt;/span&gt;(&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Returns a new Dataset by adding columns or replacing the existing columns that has&lt;/li&gt;
	&lt;li&gt;the same names.&lt;br/&gt;
    */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private&lt;span class=&quot;error&quot;&gt;&amp;#91;spark&amp;#93;&lt;/span&gt; def withColumns(colNames: Seq&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;, cols: Seq&lt;span class=&quot;error&quot;&gt;&amp;#91;Column&amp;#93;&lt;/span&gt;): DataFrame = {&lt;br/&gt;
+  private&lt;span class=&quot;error&quot;&gt;&amp;#91;spark&amp;#93;&lt;/span&gt; def withColumns(colNames: Seq&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;, cols: Seq&lt;span class=&quot;error&quot;&gt;&amp;#91;Column&amp;#93;&lt;/span&gt;): DataFrame = withPlan {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   yes, but I think this is a special case. I have seen many cases when `withColumn` is used in for loops: with this change such a pattern would be better supported.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717120" author="githubbot" created="Tue, 11 Dec 2018 13:24:55 +0000"  >&lt;p&gt;SparkQA commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446200970&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446200970&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   **&lt;a href=&quot;#99975 has started&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Test build #99975 has started&lt;/a&gt;(&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99975/testReport)**&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99975/testReport)**&lt;/a&gt; for PR 23285 at commit &lt;span class=&quot;error&quot;&gt;&amp;#91;`a40db10`&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/spark/commit/a40db106d4d26966af04afb79edb35a59efd1703&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/a40db106d4d26966af04afb79edb35a59efd1703&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717121" author="githubbot" created="Tue, 11 Dec 2018 13:25:23 +0000"  >&lt;p&gt;AmplabJenkins commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446201096&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446201096&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test FAILed.&lt;br/&gt;
   Refer to this link for build results (access rights to CI server needed): &lt;br/&gt;
   &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins//job/testing-k8s-prb-make-spark-distribution-unified/5974/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins//job/testing-k8s-prb-make-spark-distribution-unified/5974/&lt;/a&gt;&lt;br/&gt;
   Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717123" author="githubbot" created="Tue, 11 Dec 2018 13:26:07 +0000"  >&lt;p&gt;AmplabJenkins removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446201089&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446201089&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Merged build finished. Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717304" author="githubbot" created="Tue, 11 Dec 2018 14:53:11 +0000"  >&lt;p&gt;SparkQA commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446230024&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446230024&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   **&lt;a href=&quot;#99975 has finished&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Test build #99975 has finished&lt;/a&gt;(&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99975/testReport)**&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99975/testReport)**&lt;/a&gt; for PR 23285 at commit &lt;span class=&quot;error&quot;&gt;&amp;#91;`a40db10`&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/spark/commit/a40db106d4d26966af04afb79edb35a59efd1703&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/a40db106d4d26966af04afb79edb35a59efd1703&lt;/a&gt;).&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;This patch *&lt;b&gt;fails Spark unit tests&lt;/b&gt;*.&lt;/li&gt;
	&lt;li&gt;This patch merges cleanly.&lt;/li&gt;
	&lt;li&gt;This patch adds no public classes.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717306" author="githubbot" created="Tue, 11 Dec 2018 14:53:50 +0000"  >&lt;p&gt;AmplabJenkins commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446230298&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446230298&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Merged build finished. Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717307" author="githubbot" created="Tue, 11 Dec 2018 14:53:54 +0000"  >&lt;p&gt;AmplabJenkins commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446230324&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446230324&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test FAILed.&lt;br/&gt;
   Refer to this link for build results (access rights to CI server needed): &lt;br/&gt;
   &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins//job/SparkPullRequestBuilder/99975/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins//job/SparkPullRequestBuilder/99975/&lt;/a&gt;&lt;br/&gt;
   Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717308" author="githubbot" created="Tue, 11 Dec 2018 14:54:10 +0000"  >&lt;p&gt;AmplabJenkins removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446201096&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446201096&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test FAILed.&lt;br/&gt;
   Refer to this link for build results (access rights to CI server needed): &lt;br/&gt;
   &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins//job/testing-k8s-prb-make-spark-distribution-unified/5974/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins//job/testing-k8s-prb-make-spark-distribution-unified/5974/&lt;/a&gt;&lt;br/&gt;
   Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717309" author="githubbot" created="Tue, 11 Dec 2018 14:54:11 +0000"  >&lt;p&gt;SparkQA removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446200970&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446200970&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   **&lt;a href=&quot;#99975 has started&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Test build #99975 has started&lt;/a&gt;(&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99975/testReport)**&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99975/testReport)**&lt;/a&gt; for PR 23285 at commit &lt;span class=&quot;error&quot;&gt;&amp;#91;`a40db10`&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/spark/commit/a40db106d4d26966af04afb79edb35a59efd1703&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/a40db106d4d26966af04afb79edb35a59efd1703&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717310" author="githubbot" created="Tue, 11 Dec 2018 14:54:11 +0000"  >&lt;p&gt;AmplabJenkins removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446230298&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446230298&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Merged build finished. Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717313" author="githubbot" created="Tue, 11 Dec 2018 14:54:46 +0000"  >&lt;p&gt;mgaido91 commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446230611&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446230611&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   retest this please&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717315" author="githubbot" created="Tue, 11 Dec 2018 14:55:08 +0000"  >&lt;p&gt;AmplabJenkins removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446230324&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446230324&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test FAILed.&lt;br/&gt;
   Refer to this link for build results (access rights to CI server needed): &lt;br/&gt;
   &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins//job/SparkPullRequestBuilder/99975/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins//job/SparkPullRequestBuilder/99975/&lt;/a&gt;&lt;br/&gt;
   Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717334" author="githubbot" created="Tue, 11 Dec 2018 15:02:20 +0000"  >&lt;p&gt;AmplabJenkins commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446233443&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446233443&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Merged build finished. Test PASSed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717335" author="githubbot" created="Tue, 11 Dec 2018 15:02:21 +0000"  >&lt;p&gt;AmplabJenkins commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446233451&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446233451&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test PASSed.&lt;br/&gt;
   Refer to this link for build results (access rights to CI server needed): &lt;br/&gt;
   &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins//job/testing-k8s-prb-make-spark-distribution-unified/5980/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins//job/testing-k8s-prb-make-spark-distribution-unified/5980/&lt;/a&gt;&lt;br/&gt;
   Test PASSed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717336" author="githubbot" created="Tue, 11 Dec 2018 15:03:09 +0000"  >&lt;p&gt;AmplabJenkins removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446233443&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446233443&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Merged build finished. Test PASSed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717337" author="githubbot" created="Tue, 11 Dec 2018 15:03:10 +0000"  >&lt;p&gt;AmplabJenkins removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446233451&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446233451&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test PASSed.&lt;br/&gt;
   Refer to this link for build results (access rights to CI server needed): &lt;br/&gt;
   &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins//job/testing-k8s-prb-make-spark-distribution-unified/5980/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins//job/testing-k8s-prb-make-spark-distribution-unified/5980/&lt;/a&gt;&lt;br/&gt;
   Test PASSed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717621" author="githubbot" created="Tue, 11 Dec 2018 17:33:03 +0000"  >&lt;p&gt;SparkQA commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446290453&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446290453&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   **&lt;a href=&quot;#99981 has finished&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Test build #99981 has finished&lt;/a&gt;(&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99981/testReport)**&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99981/testReport)**&lt;/a&gt; for PR 23285 at commit &lt;span class=&quot;error&quot;&gt;&amp;#91;`a40db10`&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/spark/commit/a40db106d4d26966af04afb79edb35a59efd1703&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/a40db106d4d26966af04afb79edb35a59efd1703&lt;/a&gt;).&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;This patch *&lt;b&gt;fails Spark unit tests&lt;/b&gt;*.&lt;/li&gt;
	&lt;li&gt;This patch merges cleanly.&lt;/li&gt;
	&lt;li&gt;This patch adds no public classes.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717622" author="githubbot" created="Tue, 11 Dec 2018 17:33:55 +0000"  >&lt;p&gt;AmplabJenkins commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446290728&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446290728&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Merged build finished. Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717623" author="githubbot" created="Tue, 11 Dec 2018 17:33:57 +0000"  >&lt;p&gt;AmplabJenkins commented on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446290736&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446290736&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test FAILed.&lt;br/&gt;
   Refer to this link for build results (access rights to CI server needed): &lt;br/&gt;
   &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins//job/SparkPullRequestBuilder/99981/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins//job/SparkPullRequestBuilder/99981/&lt;/a&gt;&lt;br/&gt;
   Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717624" author="githubbot" created="Tue, 11 Dec 2018 17:34:10 +0000"  >&lt;p&gt;SparkQA removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446230975&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446230975&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   **&lt;a href=&quot;#99981 has started&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Test build #99981 has started&lt;/a&gt;(&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99981/testReport)**&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/99981/testReport)**&lt;/a&gt; for PR 23285 at commit &lt;span class=&quot;error&quot;&gt;&amp;#91;`a40db10`&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/spark/commit/a40db106d4d26966af04afb79edb35a59efd1703&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/a40db106d4d26966af04afb79edb35a59efd1703&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717625" author="githubbot" created="Tue, 11 Dec 2018 17:34:10 +0000"  >&lt;p&gt;AmplabJenkins removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446290728&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446290728&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Merged build finished. Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16717628" author="githubbot" created="Tue, 11 Dec 2018 17:35:09 +0000"  >&lt;p&gt;AmplabJenkins removed a comment on issue #23285: &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26224&quot; title=&quot;Results in stackOverFlowError when trying to add 3000 new columns using withColumn function of dataframe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26224&quot;&gt;&lt;del&gt;SPARK-26224&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQL&amp;#93;&lt;/span&gt; Avoid creating many project on subsequent calls to withColumn&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/spark/pull/23285#issuecomment-446290736&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285#issuecomment-446290736&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test FAILed.&lt;br/&gt;
   Refer to this link for build results (access rights to CI server needed): &lt;br/&gt;
   &lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins//job/SparkPullRequestBuilder/99981/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins//job/SparkPullRequestBuilder/99981/&lt;/a&gt;&lt;br/&gt;
   Test FAILed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16782496" author="srowen" created="Sat, 2 Mar 2019 19:46:47 +0000"  >&lt;p&gt;The most realistic thing I can imagine is exposing `withColumns`.&lt;br/&gt;
But for this use case, there are pretty easy workarounds, like just mapping the DataFrame Rows to contain a bunch more 0s and specifying your new schema.&lt;/p&gt;</comment>
                            <comment id="16807411" author="gurwls223" created="Tue, 2 Apr 2019 05:13:19 +0000"  >&lt;p&gt;Issue resolved by pull request 23285&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/23285&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23285&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17335374" author="saurabhc100" created="Thu, 29 Apr 2021 11:23:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srowen&quot; class=&quot;user-hover&quot; rel=&quot;srowen&quot;&gt;srowen&lt;/a&gt;&#160;/ &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt;&#160;- Any plan for exposing the &quot;withColumns&quot;, I have similar requirement&#160; where I have to loop for withColumn. For safer side I used the reflection to access the&#160;withColumns.&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
val dataSetClass = &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.forName(&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.spark.sql.Dataset&quot;&lt;/span&gt;)
val newConfigurationMethod =
  dataSetClass.getMethod(&lt;span class=&quot;code-quote&quot;&gt;&quot;withColumns&quot;&lt;/span&gt;, classOf[Seq[&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;]], classOf[Seq[Column]])
newConfigurationMethod.invoke(
  baseDataFrame, columnName, columnValue).asInstanceOf[DataFrame]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It will be great if we use the &quot;withColumns&quot; rather than using the reflection code here.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17337023" author="gurwls223" created="Fri, 30 Apr 2021 02:21:13 +0000"  >&lt;p&gt;There&apos;s a discussion going on in the dev mailing list to expose such a API. It would be great if you have some time to put some input, cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yikunkero&quot; class=&quot;user-hover&quot; rel=&quot;yikunkero&quot;&gt;yikunkero&lt;/a&gt;&#160;FYI&lt;/p&gt;</comment>
                            <comment id="17338809" author="yikunkero" created="Tue, 4 May 2021 07:19:42 +0000"  >&lt;p&gt;FYI, as mentioned as Hyukjin, the mailing list &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; had some discussion to expose `withColumns` in Scala/PySpark.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&#160;&lt;a href=&quot;http://apache-spark-developers-list.1001551.n3.nabble.com/DISCUSS-Multiple-columns-adding-replacing-support-in-PySpark-DataFrame-API-td31164.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://apache-spark-developers-list.1001551.n3.nabble.com/DISCUSS-Multiple-columns-adding-replacing-support-in-PySpark-DataFrame-API-td31164.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;And I personal perfer to introduce the `withColumns` because it bring more friendly development experience rather than select( * ). This is the PR to add&#160;`withColumns`:&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/32431&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/32431&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 28 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s010ew:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>