<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:25:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-5680] Sum function on all null values, should return zero</title>
                <link>https://issues.apache.org/jira/browse/SPARK-5680</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;SELECT  sum(&apos;a&apos;),  avg(&apos;a&apos;),  variance(&apos;a&apos;),  std(&apos;a&apos;) FROM src;&lt;br/&gt;
Current output:&lt;br/&gt;
NULL	NULL	NULL	NULL&lt;br/&gt;
Expected output:&lt;br/&gt;
0.0	NULL	NULL	NULL&lt;/p&gt;

&lt;p&gt;This fixes hive udaf_number_format.q &lt;/p&gt;</description>
                <environment></environment>
        <key id="12773384">SPARK-5680</key>
            <summary>Sum function on all null values, should return zero</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gvramana">Venkata Gollamudi</assignee>
                                    <reporter username="gvramana">Venkata Gollamudi</reporter>
                        <labels>
                    </labels>
                <created>Mon, 9 Feb 2015 07:27:11 +0000</created>
                <updated>Sun, 26 Jul 2015 04:19:08 +0000</updated>
                            <resolved>Sat, 21 Mar 2015 20:25:03 +0000</resolved>
                                                    <fixVersion>1.3.1</fixVersion>
                    <fixVersion>1.4.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14311892" author="apachespark" created="Mon, 9 Feb 2015 07:32:25 +0000"  >&lt;p&gt;User &apos;gvramana&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/4466&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/4466&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14372992" author="marmbrus" created="Sat, 21 Mar 2015 20:25:03 +0000"  >&lt;p&gt;Issue resolved by pull request 4466&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/4466&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/4466&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14584324" author="holmanl" created="Sat, 13 Jun 2015 00:25:31 +0000"  >&lt;p&gt;Hi Guys,&lt;/p&gt;

&lt;p&gt;Just curious about this change to return 0 for the SUM function when all values are NULL as many other data sources (Hive, Impala, SQL Server ...) return NULL in this case. Could you kindly share the motivation behind the change?&lt;/p&gt;

&lt;p&gt;Many thanks,&lt;br/&gt;
Holman&lt;/p&gt;</comment>
                            <comment id="14584338" author="marmbrus" created="Sat, 13 Jun 2015 00:48:18 +0000"  >&lt;p&gt;As stated in the comment, the motivation was to match the result that hive is returning in one of their query tests.  Is this not the case anymore? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gvramana&quot; class=&quot;user-hover&quot; rel=&quot;gvramana&quot;&gt;gvramana&lt;/a&gt; did you have some other motivation?&lt;/p&gt;</comment>
                            <comment id="14584448" author="holmanl" created="Sat, 13 Jun 2015 05:11:54 +0000"  >&lt;p&gt;Thanks. A closer look at the statement in the description I realized that it&apos;s different from our test cases.&lt;/p&gt;

&lt;p&gt;Our test cases are:&lt;br/&gt;
    select sum(c2) from sum_test&lt;br/&gt;
    select c1, sum(c2) from sum_test group by c1&lt;/p&gt;

&lt;p&gt;Where c1 is an int column with non-NULL values and c2 is an int column with all NULL values.&lt;/p&gt;

&lt;p&gt;Spark 1.3.0 and 1.3.1 return NULL for sum(c2) whereas Spark 1.4.0 returns 0. Hive, Impala and SQL Server returns NULL for the both cases.&lt;/p&gt;

&lt;p&gt;For the statement &quot;select sum(&apos;a&apos;) from src&quot; Hive indeed returns 0, my bad. The title of this JIRA caught my attention. Could the change in behavior on sum of all NULL values be related to the changes made for this JIRA?&lt;/p&gt;</comment>
                            <comment id="14587473" author="gvramana" created="Tue, 16 Jun 2015 04:52:59 +0000"  >&lt;p&gt;Holman, You are right that column with all NULL values should return NULL.&lt;br/&gt;
As my motivation was to fix udaf_number_format.q, &quot;select sum(&apos;a&apos;) from src&quot; returns 0 in hive, mysql.&lt;br/&gt;
 and &quot;select cast(&apos;a&apos; as double) from src&quot; returned NULL in hive.&lt;br/&gt;
I assumed or rather wrongly analysed it as &quot;Sum of ALL NULLs return 0&quot; and this has introduced the problem.&lt;br/&gt;
I apologize for this and will submit the patch to revert that fix. &lt;/p&gt;

&lt;p&gt;&quot;select sum(&apos;a&apos;) from src&quot; returning 0 in hive and mysql created this confusion, is still not clear.&lt;/p&gt;</comment>
                            <comment id="14588163" author="holmanl" created="Tue, 16 Jun 2015 15:05:29 +0000"  >&lt;p&gt;Hello Venkata. Thanks very much for looking into this. Could you kindly let us know the JIRA for the patch when you have one created? Thanks.&lt;/p&gt;</comment>
                            <comment id="14614508" author="yhuai" created="Mon, 6 Jul 2015 03:39:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-861&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-861&lt;/a&gt; is the issue added the test of &quot;udaf_number_format.q&quot;. I believe that returning &quot;0.0&quot; for sum(&apos;a&apos;) is a bug (the description of the issue indeed mentioned that sum(&apos;a&apos;) should return null). &lt;/p&gt;</comment>
                            <comment id="14641836" author="apachespark" created="Sun, 26 Jul 2015 04:19:08 +0000"  >&lt;p&gt;User &apos;yjshen&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7667&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7667&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12842791">SPARK-8828</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 17 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i25cpj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12329359">1.4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>