<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:40:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-47202] AttributeError: module &apos;pandas&apos; has no attribute &apos;Timstamp&apos;</title>
                <link>https://issues.apache.org/jira/browse/SPARK-47202</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;When using the pyspark.sql.types.TimestampType, if your value is a datetime.datetime object with a tzinfo, &lt;a href=&quot;https://github.com/apache/spark/blob/master/python/pyspark/sql/pandas/types.py#L996&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this typo&lt;/a&gt; breaks things.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I believe &lt;a href=&quot;https://github.com/apache/spark/commit/46949e692e863992f4c50bdd482d5216d4fd9221&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this commit&lt;/a&gt; introduced the bug 9 months ago&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Full stack trace below:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/worker.py&quot;&lt;/span&gt;, line 1490, in main process() File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/worker.py&quot;&lt;/span&gt;, line 1482, in process serializer.dump_stream(out_iter, outfile) File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/sql/pandas/serializers.py&quot;&lt;/span&gt;, line 531, in dump_stream &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; ArrowStreamSerializer.dump_stream( File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/sql/pandas/serializers.py&quot;&lt;/span&gt;, line 107, in dump_stream &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; batch in iterator: File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/sql/pandas/serializers.py&quot;&lt;/span&gt;, line 525, in init_stream_yield_batches batch = self._create_batch(series) File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/sql/pandas/serializers.py&quot;&lt;/span&gt;, line 511, in _create_batch arrs.append(self._create_array(s, t, arrow_cast=self._arrow_cast)) File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/sql/pandas/serializers.py&quot;&lt;/span&gt;, line 284, in _create_array series = conv(series) File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/sql/pandas/types.py&quot;&lt;/span&gt;, line 1060, in &amp;lt;lambda&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; lambda pser: pser.apply( # type: ignore[&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;-value] File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/python/lib/python3.10/site-packages/pandas/core/series.py&quot;&lt;/span&gt;, line 4771, in apply &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; SeriesApply(self, func, convert_dtype, args, kwargs).apply() File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/python/lib/python3.10/site-packages/pandas/core/apply.py&quot;&lt;/span&gt;, line 1123, in apply &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.apply_standard() File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/python/lib/python3.10/site-packages/pandas/core/apply.py&quot;&lt;/span&gt;, line 1174, in apply_standard mapped = lib.map_infer( File &lt;span class=&quot;code-quote&quot;&gt;&quot;pandas/_libs/lib.pyx&quot;&lt;/span&gt;, line 2924, in pandas._libs.lib.map_infer File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/sql/pandas/types.py&quot;&lt;/span&gt;, line 1061, in &amp;lt;lambda&amp;gt; lambda x: conv(x) &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; x is not None &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; None # type: ignore[misc] File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/sql/pandas/types.py&quot;&lt;/span&gt;, line 889, in convert_array &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; [ File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/sql/pandas/types.py&quot;&lt;/span&gt;, line 890, in &amp;lt;listcomp&amp;gt; _element_conv(v) &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; v is not None &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; None # type: ignore[misc] File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/sql/pandas/types.py&quot;&lt;/span&gt;, line 1010, in convert_struct &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; { File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/sql/pandas/types.py&quot;&lt;/span&gt;, line 1011, in &amp;lt;dictcomp&amp;gt; name: conv(v) &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; conv is not None and v is not None &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; v File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/spark/python/pyspark/sql/pandas/types.py&quot;&lt;/span&gt;, line 1032, in convert_timestamp ts = pd.Timstamp(value) File &lt;span class=&quot;code-quote&quot;&gt;&quot;/databricks/python/lib/python3.10/site-packages/pandas/__init__.py&quot;&lt;/span&gt;, line 264, in __getattr__ raise AttributeError(f&lt;span class=&quot;code-quote&quot;&gt;&quot;module &lt;span class=&quot;code-quote&quot;&gt;&apos;pandas&apos;&lt;/span&gt; has no attribute &lt;span class=&quot;code-quote&quot;&gt;&apos;{name}&apos;&lt;/span&gt;&quot;&lt;/span&gt;) AttributeError: module &lt;span class=&quot;code-quote&quot;&gt;&apos;pandas&apos;&lt;/span&gt; has no attribute &lt;span class=&quot;code-quote&quot;&gt;&apos;Timstamp&apos;&lt;/span&gt;
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13570090">SPARK-47202</key>
            <summary>AttributeError: module &apos;pandas&apos; has no attribute &apos;Timstamp&apos;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="arzavjain">Arzav Jain</assignee>
                                    <reporter username="arzavjain">Arzav Jain</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 28 Feb 2024 02:30:33 +0000</created>
                <updated>Tue, 5 Mar 2024 00:32:54 +0000</updated>
                            <resolved>Wed, 28 Feb 2024 05:11:43 +0000</resolved>
                                    <version>3.5.1</version>
                                    <fixVersion>3.5.2</fixVersion>
                    <fixVersion>4.0.0</fixVersion>
                                    <component>PySpark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="1800">0.5h</timeoriginalestimate>
                            <timeestimate seconds="1800">0.5h</timeestimate>
                                        <comments>
                            <comment id="17821511" author="gurwls223" created="Wed, 28 Feb 2024 05:11:43 +0000"  >&lt;p&gt;Issue resolved by pull request 45301&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/45301&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/45301&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1nnug:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>