<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:09:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-30495] How to disable &apos;spark.security.credentials.${service}.enabled&apos; in Structured streaming while connecting to a kafka cluster</title>
                <link>https://issues.apache.org/jira/browse/SPARK-30495</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Trying to read data from a secured Kafka cluster using spark structured&lt;br/&gt;
 streaming. Also, using the below library to read the data -&lt;br/&gt;
 &lt;ins&gt;&lt;b&gt;&quot;spark-sql-kafka-0-10_2.12&quot;:&quot;3.0.0-preview&quot;&lt;/b&gt;&lt;/ins&gt; since it has the feature to&lt;br/&gt;
 specify our custom group id (instead of spark setting its own custom group&lt;br/&gt;
 id)&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;&lt;b&gt;Dependency used in code:&lt;/b&gt;&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; &amp;lt;groupId&amp;gt;org.apache.spark&amp;lt;/groupId&amp;gt;&lt;br/&gt;
 &#160; &#160; &#160; &#160; &amp;lt;artifactId&amp;gt;spark-sql-kafka-0-10_2.12&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
 &#160; &#160; &#160; &#160; &amp;lt;version&amp;gt;3.0.0-preview&amp;lt;/version&amp;gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;&lt;b&gt;Logs:&lt;/b&gt;&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;Getting the below error - even after specifying the required JAAS&lt;br/&gt;
 configuration in spark options.&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.IllegalArgumentException: requirement failed:&lt;br/&gt;
 &lt;b&gt;Delegation token must exist for this connector&lt;/b&gt;. at&lt;br/&gt;
 scala.Predef$.require(Predef.scala:281) at&lt;/p&gt;

&lt;p&gt;org.apache.spark.kafka010.KafkaTokenUtil$.isConnectorUsingCurrentToken(KafkaTokenUtil.scala:299)&lt;br/&gt;
 at&lt;br/&gt;
 org.apache.spark.sql.kafka010.KafkaDataConsumer.getOrRetrieveConsumer(KafkaDataConsumer.scala:533)&lt;br/&gt;
 at&lt;br/&gt;
 org.apache.spark.sql.kafka010.KafkaDataConsumer.$anonfun$get$1(KafkaDataConsumer.scala:275)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;&lt;b&gt;Spark configuration used to read from Kafka:&lt;/b&gt;&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;val kafkaDF = sparkSession.readStream&lt;br/&gt;
 .format(&quot;kafka&quot;)&lt;br/&gt;
 .option(&quot;kafka.bootstrap.servers&quot;, bootStrapServer)&lt;br/&gt;
 .option(&quot;subscribe&quot;, kafkaTopic )&lt;/p&gt;

&lt;p&gt;//Setting JAAS Configuration&lt;br/&gt;
.option(&quot;kafka.sasl.jaas.config&quot;, KAFKA_JAAS_SASL)&lt;br/&gt;
 .option(&quot;kafka.sasl.mechanism&quot;, &quot;PLAIN&quot;)&lt;br/&gt;
 .option(&quot;kafka.security.protocol&quot;, &quot;SASL_SSL&quot;)&lt;/p&gt;

&lt;p&gt;// Setting custom consumer group id&lt;br/&gt;
.option(&quot;kafka.group.id&quot;, &quot;test_cg&quot;)&lt;br/&gt;
 .load()&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Following document specifies that we can disable the feature of obtaining&lt;br/&gt;
 delegation token -&lt;br/&gt;
 &lt;a href=&quot;https://spark.apache.org/docs/3.0.0-preview/structured-streaming-kafka-integration.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://spark.apache.org/docs/3.0.0-preview/structured-streaming-kafka-integration.html&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Tried setting this property &lt;b&gt;spark.security.credentials.kafka.enabled to&lt;/b&gt;&lt;br/&gt;
 &lt;b&gt;false in spark config,&lt;/b&gt; but it is still failing with the same error.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13278980">SPARK-30495</key>
            <summary>How to disable &apos;spark.security.credentials.${service}.enabled&apos; in Structured streaming while connecting to a kafka cluster</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gsomogyi">Gabor Somogyi</assignee>
                                    <reporter username="act_coder">act_coder</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 Jan 2020 03:07:26 +0000</created>
                <updated>Fri, 17 Apr 2020 16:36:17 +0000</updated>
                            <resolved>Wed, 15 Jan 2020 19:47:08 +0000</resolved>
                                    <version>3.0.0</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>Structured Streaming</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17013994" author="kabhwan" created="Mon, 13 Jan 2020 03:29:56 +0000"  >&lt;p&gt;There seems to be a bug reside on Spark SQL Kafka module - SASL_JAAS available doesn&apos;t not always mean there&apos;s delegation token. We should also check the value of &quot;tokenauth&quot; and apply delegation-token related logic only when the value is &quot;true&quot;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gsomogyi&quot; class=&quot;user-hover&quot; rel=&quot;gsomogyi&quot;&gt;gsomogyi&lt;/a&gt;&#160;Could you confirm whether this is a real bug or not? Once you confirm this is a bug, please update type to &quot;bug&quot; and update title accordingly as well. Thanks in advance!&lt;/p&gt;</comment>
                            <comment id="17014155" author="gsomogyi" created="Mon, 13 Jan 2020 09:29:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=act_coder&quot; class=&quot;user-hover&quot; rel=&quot;act_coder&quot;&gt;act_coder&lt;/a&gt; thanks for reporting, you&apos;ve found a bug.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kabhwan&quot; class=&quot;user-hover&quot; rel=&quot;kabhwan&quot;&gt;kabhwan&lt;/a&gt; you&apos;ve pinpointed the problem properly. The actual code assumes delegation token usage when SASL_JAAS_CONFIG set.&lt;br/&gt;
Started to work on this...&lt;/p&gt;</comment>
                            <comment id="17014273" author="act_coder" created="Mon, 13 Jan 2020 12:27:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gsomogyi&quot; class=&quot;user-hover&quot; rel=&quot;gsomogyi&quot;&gt;gsomogyi&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kabhwan&quot; class=&quot;user-hover&quot; rel=&quot;kabhwan&quot;&gt;kabhwan&lt;/a&gt;&#160;- Thanks..!&#160; &lt;br/&gt;
Can i change the Jira type to BUG from QUESTION ?&lt;/p&gt;</comment>
                            <comment id="17015335" author="kabhwan" created="Tue, 14 Jan 2020 19:17:55 +0000"  >&lt;p&gt;Adjusted priority as it&apos;s a regression. May need higher priority though, but given we have a PR closer to merge, major seems OK.&lt;/p&gt;</comment>
                            <comment id="17016267" author="vanzin" created="Wed, 15 Jan 2020 19:47:08 +0000"  >&lt;p&gt;Issue resolved by pull request 27191&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/27191&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/27191&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17085914" author="ladoe00" created="Fri, 17 Apr 2020 16:36:17 +0000"  >&lt;p&gt;Anyone knows when this fix will make it to a public build?&#160; I see that it is part of the RC1 tag, but I can&apos;t find any RC1 binaries in maven.&#160; I am using 3.0.0 preview2 and this bug is a blocker for us.&#160; Any idea when 3.0.0 will be officially out?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 30 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0afjk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12339177">3.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>