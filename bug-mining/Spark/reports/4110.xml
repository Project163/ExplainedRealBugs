<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:48:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-16896] Loading csv with duplicate column names</title>
                <link>https://issues.apache.org/jira/browse/SPARK-16896</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;It would be great if the library allows us to load csv with duplicate column names. I understand that having duplicate columns in the data is odd but sometimes we get data that has duplicate columns. Getting upstream data like that can happen. We may choose to ignore them but currently there is no way to drop those as we are not able to load them at all. Currently as a pre-processing I loaded the data into R, changed the column names and then make a fixed version with which Spark Java API can work.&lt;/p&gt;

&lt;p&gt;But if talk about other options, e.g. R has read.csv which automatically takes care of such situation by appending a number to the column name.&lt;/p&gt;

&lt;p&gt;Also case sensitivity in column names can also cause problems. I mean if we have columns like&lt;/p&gt;

&lt;p&gt;ColumnName, columnName&lt;/p&gt;

&lt;p&gt;I may want to have them as separate. But the option to do this is not documented.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12994868">SPARK-16896</key>
            <summary>Loading csv with duplicate column names</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gurwls223">Hyukjin Kwon</assignee>
                                    <reporter username="anshbansal">Aseem Bansal</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Aug 2016 11:42:55 +0000</created>
                <updated>Mon, 12 Dec 2022 18:11:03 +0000</updated>
                            <resolved>Tue, 11 Oct 2016 02:22:14 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15407604" author="anshbansal" created="Thu, 4 Aug 2016 11:43:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt; cc&lt;/p&gt;</comment>
                            <comment id="15408715" author="gurwls223" created="Fri, 5 Aug 2016 00:57:39 +0000"  >&lt;p&gt;I agree with appending a number to the deplicated column names. Could you please take a look of this JIRA? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rxin&quot; class=&quot;user-hover&quot; rel=&quot;rxin&quot;&gt;rxin&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=falaki&quot; class=&quot;user-hover&quot; rel=&quot;falaki&quot;&gt;falaki&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15408728" author="falaki" created="Fri, 5 Aug 2016 01:08:45 +0000"  >&lt;p&gt;I suggest we generally follow the restrictions of SparkSQL, which does not accept duplicate column names. So I agree with numbering column names if there are duplicates.&lt;/p&gt;</comment>
                            <comment id="15413007" author="nlauchande" created="Tue, 9 Aug 2016 06:17:32 +0000"  >&lt;p&gt;I wonder if anyone is tackling this issue. I want to get started contributing to Apache Spark and this sound like quite an interesting intro task. &lt;/p&gt;</comment>
                            <comment id="15413038" author="gurwls223" created="Tue, 9 Aug 2016 06:42:18 +0000"  >&lt;p&gt;I don&apos;t mind if you go ahead (I was looking at this problem though).&lt;/p&gt;

&lt;p&gt;One thing I want to say is, we might better match the behaviour to &lt;a href=&quot;https://stat.ethz.ch/R-manual/R-devel/library/utils/html/read.table.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;read.csv&lt;/a&gt; in R if possible in this case.&lt;/p&gt;

&lt;p&gt;In addition, we are handling &lt;tt&gt;nullValue&lt;/tt&gt; in handling the header with making numbers already. I guess we should clarify and write the behaviour in the PR description including the cases in R.&lt;/p&gt;

&lt;p&gt;Also, do not forget to follow &lt;a href=&quot;https://cwiki.apache.org/confluence/display/SPARK/Contributing+to+Spark&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/SPARK/Contributing+to+Spark&lt;/a&gt; for making a contribution.&lt;/p&gt;
</comment>
                            <comment id="15413211" author="nlauchande" created="Tue, 9 Aug 2016 08:43:32 +0000"  >&lt;p&gt;Quick confirmation needed  : this change needs to happen in the &lt;a href=&quot;https://github.com/databricks/spark-csv&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/databricks/spark-csv&lt;/a&gt; package if i understand correctly . &lt;/p&gt;

&lt;p&gt;Will start working on it later today, will come back with some more newbie questions.&lt;/p&gt;</comment>
                            <comment id="15413218" author="srowen" created="Tue, 9 Aug 2016 08:49:53 +0000"  >&lt;p&gt;No, the code is in Spark now. &lt;/p&gt;</comment>
                            <comment id="15413271" author="gurwls223" created="Tue, 9 Aug 2016 09:26:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srowen&quot; class=&quot;user-hover&quot; rel=&quot;srowen&quot;&gt;srowen&lt;/a&gt; Oh, I am sorry, I coundn&apos;t see the comment above. Please ignore the comment I just left.  I thought you left the comment for mine.&lt;/p&gt;</comment>
                            <comment id="15413302" author="nlauchande" created="Tue, 9 Aug 2016 09:50:12 +0000"  >&lt;p&gt;Cool. So i am assuming that the entry point for the loading csv functionality that needs to be fixed is the one described in : &lt;a href=&quot;https://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/DataFrameReader.scala&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/DataFrameReader.scala&lt;/a&gt; .&lt;/p&gt;</comment>
                            <comment id="15413310" author="gurwls223" created="Tue, 9 Aug 2016 09:56:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nlauchande&quot; class=&quot;user-hover&quot; rel=&quot;nlauchande&quot;&gt;nlauchande&lt;/a&gt; Just FYI, actual codes that need to be corrected will be around &lt;a href=&quot;https://github.com/apache/spark/blob/cb1b9d34f37a5574de43f61e7036c4b8b81defbf/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/csv/CSVFileFormat.scala#L61-L67&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Maybe we should check the duplication and then give some numbers. I haven&apos;t checked the behaviour in R though.&lt;/p&gt;

&lt;p&gt;Also, please make sure for a test. I believe we usually need a test for a patch.&lt;/p&gt;</comment>
                            <comment id="15426262" author="gurwls223" created="Thu, 18 Aug 2016 10:57:20 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nlauchande&quot; class=&quot;user-hover&quot; rel=&quot;nlauchande&quot;&gt;nlauchande&lt;/a&gt;, are you currently working on this?&lt;/p&gt;</comment>
                            <comment id="15426266" author="nlauchande" created="Thu, 18 Aug 2016 11:01:33 +0000"  >&lt;p&gt;Hi Hyukjin Kwon  i did start. But couldn&apos;t make a lot of progress within the last couple of days . Feel free to grab it . I can try find another easier and less critical beginner task .&lt;/p&gt;</comment>
                            <comment id="15429950" author="gurwls223" created="Mon, 22 Aug 2016 01:44:19 +0000"  >&lt;p&gt;Yup, then I will work on this and submit a PR within few days. Thank you!&lt;/p&gt;</comment>
                            <comment id="15430040" author="apachespark" created="Mon, 22 Aug 2016 04:50:07 +0000"  >&lt;p&gt;User &apos;HyukjinKwon&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14745&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 13 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31wjb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>