<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:14:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-30668] to_timestamp failed to parse 2020-01-27T20:06:11.847-0800 using pattern &quot;yyyy-MM-dd&apos;T&apos;HH:mm:ss.SSSz&quot;</title>
                <link>https://issues.apache.org/jira/browse/SPARK-30668</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SELECT to_timestamp(&lt;span class=&quot;code-quote&quot;&gt;&quot;2020-01-27T20:06:11.847-0800&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;yyyy-MM-dd&lt;span class=&quot;code-quote&quot;&gt;&apos;T&apos;&lt;/span&gt;HH:mm:ss.SSSz&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This can return a valid value in Spark 2.4 but return NULL in the latest master&lt;/p&gt;

&lt;p&gt;*&lt;b&gt;2.4.5 RC2&lt;/b&gt;*&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt; sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;&quot;SELECT to_timestamp(&quot;&lt;/span&gt;2020-01-27T20:06:11.847-0800&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;yyyy-MM-dd&lt;span class=&quot;code-quote&quot;&gt;&apos;T&apos;&lt;/span&gt;HH:mm:ss.SSSz&lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;&quot;&quot;).show
+----------------------------------------------------------------------------+
|to_timestamp(&lt;span class=&quot;code-quote&quot;&gt;&apos;2020-01-27T20:06:11.847-0800&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;yyyy-MM-dd\&apos;&lt;/span&gt;T\&lt;span class=&quot;code-quote&quot;&gt;&apos;HH:mm:ss.SSSz&apos;&lt;/span&gt;)|
+----------------------------------------------------------------------------+
|                                                         2020-01-27 20:06:11|
+----------------------------------------------------------------------------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;*&lt;b&gt;2.2.3 ~ 2.4.4&lt;/b&gt;* (2.0.2 ~ 2.1.3 doesn&apos;t have `to_timestamp`).&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
spark-sql&amp;gt; SELECT to_timestamp(&lt;span class=&quot;code-quote&quot;&gt;&quot;2020-01-27T20:06:11.847-0800&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;yyyy-MM-dd&lt;span class=&quot;code-quote&quot;&gt;&apos;T&apos;&lt;/span&gt;HH:mm:ss.SSSz&quot;&lt;/span&gt;);
2020-01-27 20:06:11
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13282069">SPARK-30668</key>
            <summary>to_timestamp failed to parse 2020-01-27T20:06:11.847-0800 using pattern &quot;yyyy-MM-dd&apos;T&apos;HH:mm:ss.SSSz&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="maxgekk">Max Gekk</assignee>
                                    <reporter username="smilegator">Xiao Li</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Jan 2020 22:11:27 +0000</created>
                <updated>Thu, 5 Mar 2020 10:20:20 +0000</updated>
                            <resolved>Thu, 5 Mar 2020 08:57:46 +0000</resolved>
                                    <version>3.0.0</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17025467" author="smilegator" created="Tue, 28 Jan 2020 22:15:07 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maxgekk&quot; class=&quot;user-hover&quot; rel=&quot;maxgekk&quot;&gt;maxgekk&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17025549" author="maxgekk" created="Wed, 29 Jan 2020 03:19:52 +0000"  >&lt;p&gt;Date/timestamp parsing is based on Java 8 DateTimeFormat in Spark 3.0 which may have different notion of pattern letters (see &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html&lt;/a&gt;):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   V       time-zone ID                zone-id           America/Los_Angeles; Z; -08:30
   z       time-zone name              zone-name         Pacific Standard Time; PST
   O       localized zone-offset       offset-O          GMT+8; GMT+08:00; UTC-08:00;
   X       zone-offset &lt;span class=&quot;code-quote&quot;&gt;&apos;Z&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; zero    offset-X          Z; -08; -0830; -08:30; -083015; -08:30:15;
   x       zone-offset                 offset-x          +0000; -08; -0830; -08:30; -083015; -08:30:15;
   Z       zone-offset                 offset-Z          +0000; -0800; -08:00;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As you can see &apos;z&apos; is for time zone name, but you is going to parse zone offsets. You can use &apos;x&apos; or &apos;Z&apos; in the pattern instead of &apos;z&apos;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt; spark.sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;&quot;SELECT to_timestamp(&quot;&lt;/span&gt;2020-01-27T20:06:11.847-0800&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;yyyy-MM-dd&lt;span class=&quot;code-quote&quot;&gt;&apos;T&apos;&lt;/span&gt;HH:mm:ss.SSSZ&lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;&quot;&quot;).show(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
+----------------------------------------------------------------------------+
|to_timestamp(&lt;span class=&quot;code-quote&quot;&gt;&apos;2020-01-27T20:06:11.847-0800&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;yyyy-MM-dd\&apos;&lt;/span&gt;T\&lt;span class=&quot;code-quote&quot;&gt;&apos;HH:mm:ss.SSSZ&apos;&lt;/span&gt;)|
+----------------------------------------------------------------------------+
|2020-01-28 07:06:11.847                                                     |
+----------------------------------------------------------------------------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Parsing in Spark 2.4 is based on SimpleDateFormat (see &lt;a href=&quot;https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html&lt;/a&gt;) where &apos;z&apos; has slightly different meaning.&lt;/p&gt;</comment>
                            <comment id="17025643" author="smilegator" created="Wed, 29 Jan 2020 06:56:23 +0000"  >&lt;p&gt;This will make the migration very painful. This is not mentioned in the migration guide. It will also generate different query results. Do we have a simple way to remove such a behavior change? For example, converting the pattern for users?&lt;/p&gt;</comment>
                            <comment id="17025644" author="smilegator" created="Wed, 29 Jan 2020 06:57:15 +0000"  >&lt;p&gt;Can we let users choose different parsing mechanisms between SimpleDateFormat and DateTimeFormat? &lt;/p&gt;</comment>
                            <comment id="17025651" author="maxgekk" created="Wed, 29 Jan 2020 07:14:46 +0000"  >&lt;p&gt;&amp;gt;&#160;This is not mentioned in the migration guide.&lt;/p&gt;

&lt;p&gt;It is mentioned:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    - The `unix_timestamp`, `date_format`, `to_unix_timestamp`, `from_unixtime`, `to_date`, `to_timestamp` functions. New implementation supports pattern formats as described here https:&lt;span class=&quot;code-comment&quot;&gt;//docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html and performs strict checking of its input. For example, the `2015-07-22 10:00:00` timestamp cannot be parse &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; pattern is `yyyy-MM-dd` because the parser does not consume whole input. Another example is the `31/01/2015 00:00` input cannot be parsed by the `dd/MM/yyyy hh:mm` pattern because `hh` supposes hours in the range `1-12`.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;br/&gt;
&amp;gt; Do we have a simple way to remove such a behavior change? &lt;/p&gt;

&lt;p&gt;The change is related to the migration to Proleptic Gregorian calendar. To remove the behavior, you need to revert most of &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26651&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-26651&lt;/a&gt; and maybe more.&lt;/p&gt;

&lt;p&gt;&amp;gt; For example, converting the pattern for users?&lt;/p&gt;

&lt;p&gt;Even it is possible to convert patterns, the result can be different for old dates due to the calendar system.&lt;/p&gt;

&lt;p&gt;&amp;gt; Can we let users choose different parsing mechanisms between SimpleDateFormat and DateTimeFormat?&lt;/p&gt;

&lt;p&gt;No, a flag was removed 1 year ago, see &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26503&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-26503&lt;/a&gt; and see &lt;a href=&quot;https://github.com/apache/spark/pull/23391#discussion_r244414750&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23391#discussion_r244414750&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17025673" author="smilegator" created="Wed, 29 Jan 2020 08:02:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hvanhovell&quot; class=&quot;user-hover&quot; rel=&quot;hvanhovell&quot;&gt;hvanhovell&lt;/a&gt; Making it configurable looks necessary. Today, Michael hit this when they tried the master branch. &lt;/p&gt;</comment>
                            <comment id="17025681" author="maxgekk" created="Wed, 29 Jan 2020 08:18:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marmbrus&quot; class=&quot;user-hover&quot; rel=&quot;marmbrus&quot;&gt;marmbrus&lt;/a&gt; The doc for `to_timestamp` points out DateTimeFormatter: &lt;a href=&quot;https://github.com/apache/spark/blob/d69ed9afdf2bd8d03aaf835292b92692ec8189e9/sql/core/src/main/scala/org/apache/spark/sql/functions.scala#L2964&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/d69ed9afdf2bd8d03aaf835292b92692ec8189e9/sql/core/src/main/scala/org/apache/spark/sql/functions.scala#L2964&lt;/a&gt;, please, have a look at its doc &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html&lt;/a&gt; to see which patterns for time zone and zone offset it supports /cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srowen&quot; class=&quot;user-hover&quot; rel=&quot;srowen&quot;&gt;srowen&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17025698" author="hvanhovell" created="Wed, 29 Jan 2020 08:49:09 +0000"  >&lt;p&gt;I don&apos;t think we should revert the proleptic gregorian patch, the previous behavior was kind of broken.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maxgekk&quot; class=&quot;user-hover&quot; rel=&quot;maxgekk&quot;&gt;maxgekk&lt;/a&gt;&#160;can we move back to the previous behavior by using the old parser? And perhaps feature flag that bit, or make it configurable.&lt;/p&gt;</comment>
                            <comment id="17025729" author="maxgekk" created="Wed, 29 Jan 2020 09:12:04 +0000"  >&lt;p&gt;We can try to revert this&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/23495&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23495&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17028515" author="maxgekk" created="Sun, 2 Feb 2020 18:38:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt;&#160;Output of your example is surprised - it doesn&apos;t contain the fractional part of seconds. 847 is printed on the master if we change the pattern z -&amp;gt; Z. It seems 2.4.x parses the input incorrectly:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt; val ts = sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;&quot;SELECT to_timestamp(&quot;&lt;/span&gt;2020-01-27T20:06:11.847-0800&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;yyyy-MM-dd&lt;span class=&quot;code-quote&quot;&gt;&apos;T&apos;&lt;/span&gt;HH:mm:ss.SSSz&lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;&quot;&quot;).first()(0)
ts: Any = 2020-01-28 07:06:11.0

scala&amp;gt; ts.asInstanceOf[java.sql.Timestamp].getNanos
res11: Int = 0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17028532" author="maxgekk" created="Sun, 2 Feb 2020 19:35:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt;&#160;I have found the reason&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/24420&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/24420&lt;/a&gt;&#160;. Theoretically, it can be backported to 2.4.x. but it could support parsing in millisecond precision. To support parsing in microseconds, need to switch on the parser added to 2.4 by&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/26507&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/26507&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17028533" author="dongjoon" created="Sun, 2 Feb 2020 19:36:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maxgekk&quot; class=&quot;user-hover&quot; rel=&quot;maxgekk&quot;&gt;maxgekk&lt;/a&gt;. You should be the last man who surprised.  It&apos;s &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-27438&quot; title=&quot;Increase precision of to_timestamp&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-27438&quot;&gt;&lt;del&gt;SPARK-27438&lt;/del&gt;&lt;/a&gt;, isn&apos;t it?&lt;/p&gt;</comment>
                            <comment id="17028535" author="dongjoon" created="Sun, 2 Feb 2020 19:38:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maxgekk&quot; class=&quot;user-hover&quot; rel=&quot;maxgekk&quot;&gt;maxgekk&lt;/a&gt;. We don&apos;t backport improvement. You registered that issue as `Improvement`. Also, I think so.&lt;/p&gt;</comment>
                            <comment id="17028537" author="dongjoon" created="Sun, 2 Feb 2020 19:40:46 +0000"  >&lt;p&gt;Given the current circumstance, this seems to be considered as a bug introduced by a new improvement patch. This is irrelevant to `2.4.x`.&lt;/p&gt;</comment>
                            <comment id="17028545" author="maxgekk" created="Sun, 2 Feb 2020 19:53:20 +0000"  >&lt;p&gt;&amp;gt;&#160;as a bug introduced by a new improvement patch.&#160;&lt;/p&gt;

&lt;p&gt;Don&apos;t understand this. The behavior of to_timestamp exists from the beginning. I am not sure that we can classify it as a bug.&lt;/p&gt;

&lt;p&gt;We could improve the description of the function, at least. At the moment, it says nothing about precision in 2.4.x, and the example of supported pattern yyyy-MM-dd HH:mm:ss.SSSS doesn&apos;t make sense.&lt;/p&gt;</comment>
                            <comment id="17028586" author="dongjoon" created="Sun, 2 Feb 2020 22:03:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maxgekk&quot; class=&quot;user-hover&quot; rel=&quot;maxgekk&quot;&gt;maxgekk&lt;/a&gt;. What I meant was the scope of this `BUG` issue (&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-30668&quot; title=&quot;to_timestamp failed to parse 2020-01-27T20:06:11.847-0800 using pattern &amp;quot;yyyy-MM-dd&amp;#39;T&amp;#39;HH:mm:ss.SSSz&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-30668&quot;&gt;&lt;del&gt;SPARK-30668&lt;/del&gt;&lt;/a&gt;) is only 3.0.0. &lt;br/&gt;
It&apos;s because only `3.0.0` returns `NULL`. In 2.4.x world, we don&apos;t return `NULL` for that kind of case. &lt;br/&gt;
&amp;gt; The behavior of to_timestamp exists from the beginning. &lt;/p&gt;</comment>
                            <comment id="17028709" author="cloud_fan" created="Mon, 3 Feb 2020 07:08:55 +0000"  >&lt;p&gt;I checked the doc in &lt;a href=&quot;https://github.com/apache/spark/blob/branch-2.4/sql/core/src/main/scala/org/apache/spark/sql/functions.scala#L2967&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Spark 2.4&lt;/a&gt;, and it says the pattern string follows java.text.SimpleDateFormat, so I think this is a breaking change.&lt;/p&gt;

&lt;p&gt;AFAIK we fixed several bugs by switching to the java.time.format.DateTimeFormatter, so it should be OK to do it in 3.0. We can make the migration more smooth by&lt;br/&gt;
1. providing a legacy config to restore the old behavior&lt;br/&gt;
2. when we use the new formatter, fall back to the old formatter if the new one fails to parse. This can at least fix the problem reported by this ticket.&lt;/p&gt;

&lt;p&gt;thoughts?&lt;/p&gt;</comment>
                            <comment id="17028731" author="maxgekk" created="Mon, 3 Feb 2020 07:41:32 +0000"  >&lt;p&gt;Behind of the removed config&#160;&lt;em&gt;spark.sql.legacy.timeParser.enabled&lt;/em&gt;, there are 2 more fallbacks to behaviors since Spark 1.5, see LegacyFallbackDateFormatter:&lt;br/&gt;
1. &lt;b&gt;s.toInt&lt;/b&gt; - In Spark 1.5.0, we store the data as number of days since epoch in string. So, we just convert it to Int.&lt;br/&gt;
2. &lt;b&gt;DateTimeUtils.millisToDays(DateTimeUtils.stringToTime(s).getTime)&lt;/b&gt; - the way used in 2.0 and 1.x&lt;br/&gt;
3. FastDateFormat or &lt;b&gt;SimpleDateFormat&lt;/b&gt;&lt;br/&gt;
Should we allow users to switch to SimpleDateFormat only or other legacy ways too?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17028748" author="cloud_fan" created="Mon, 3 Feb 2020 07:58:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maxgekk&quot; class=&quot;user-hover&quot; rel=&quot;maxgekk&quot;&gt;maxgekk&lt;/a&gt; can we do them one by one? The SimpleDateFormat fallback is well justified by the examples in this ticket. We should look at the other 2 fallbacks closely as well.&lt;/p&gt;</comment>
                            <comment id="17030576" author="cloud_fan" created="Wed, 5 Feb 2020 11:13:43 +0000"  >&lt;p&gt;Issue resolved by pull request 27441&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/27441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/27441&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17031860" author="smilegator" created="Thu, 6 Feb 2020 18:58:13 +0000"  >&lt;p&gt;I think this is still not resolved. Spark 3.0 should not silently return a wrong result for a query whose pattern was right in the previous versions. I did not see the fallback mentioned in &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17051918" author="cloud_fan" created="Thu, 5 Mar 2020 08:57:46 +0000"  >&lt;p&gt;Issue resolved by pull request 27537&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/27537&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/27537&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13206929">SPARK-26503</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13227384">SPARK-27438</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ay7c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12339177">3.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>