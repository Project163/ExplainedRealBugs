<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:07:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-29890] Unable to fill na with 0 with duplicate columns</title>
                <link>https://issues.apache.org/jira/browse/SPARK-29890</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Trying to fill out na values with 0.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scala&amp;gt; :paste
// Entering paste mode (ctrl-D to finish)
val parent = spark.sparkContext.parallelize(Seq((1,2),(3,4),(5,6))).toDF(&quot;nums&quot;, &quot;abc&quot;)
val c1 = parent.filter(lit(true))
val c2 = parent.filter(lit(true))
c1.join(c2, Seq(&quot;nums&quot;), &quot;left&quot;)
.na.fill(0).show&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;9/11/14 04:24:24 ERROR org.apache.hadoop.security.JniBasedUnixGroupsMapping: error looking up the name of group 820818257: No such file or directory
org.apache.spark.sql.AnalysisException: Reference &apos;abc&apos; is ambiguous, could be: abc, abc.;
  at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolve(LogicalPlan.scala:213)
  at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveQuoted(LogicalPlan.scala:117)
  at org.apache.spark.sql.Dataset.resolve(Dataset.scala:220)
  at org.apache.spark.sql.Dataset.col(Dataset.scala:1246)
  at org.apache.spark.sql.DataFrameNaFunctions.org$apache$spark$sql$DataFrameNaFunctions$$fillCol(DataFrameNaFunctions.scala:443)
  at org.apache.spark.sql.DataFrameNaFunctions$$anonfun$7.apply(DataFrameNaFunctions.scala:500)
  at org.apache.spark.sql.DataFrameNaFunctions$$anonfun$7.apply(DataFrameNaFunctions.scala:492)
  at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
  at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
  at scala.collection.IndexedSeqOptimized$class.foreach(IndexedSeqOptimized.scala:33)
  at scala.collection.mutable.ArrayOps$ofRef.foreach(ArrayOps.scala:186)
  at scala.collection.TraversableLike$class.map(TraversableLike.scala:234)
  at scala.collection.mutable.ArrayOps$ofRef.map(ArrayOps.scala:186)
  at org.apache.spark.sql.DataFrameNaFunctions.fillValue(DataFrameNaFunctions.scala:492)
  at org.apache.spark.sql.DataFrameNaFunctions.fill(DataFrameNaFunctions.scala:171)
  at org.apache.spark.sql.DataFrameNaFunctions.fill(DataFrameNaFunctions.scala:155)
  at org.apache.spark.sql.DataFrameNaFunctions.fill(DataFrameNaFunctions.scala:134)
  ... 54 elided&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13268249">SPARK-29890</key>
            <summary>Unable to fill na with 0 with duplicate columns</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="imback82">Terry Kim</assignee>
                                    <reporter username="sandeshyapuram">sandeshyapuram</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Nov 2019 09:30:31 +0000</created>
                <updated>Mon, 18 Jan 2021 12:56:34 +0000</updated>
                            <resolved>Mon, 25 Nov 2019 16:20:29 +0000</resolved>
                                    <version>2.0.2</version>
                    <version>2.1.3</version>
                    <version>2.2.3</version>
                    <version>2.3.3</version>
                    <version>2.4.3</version>
                                    <fixVersion>2.4.5</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                    <component>Spark Shell</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16974087" author="sandeshyapuram" created="Thu, 14 Nov 2019 09:36:03 +0000"  >&lt;p&gt;I&apos;ve raised it as a bug because I feel fill.na(0) needs to fill 0 regardless of duplicate column names.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt;&#160;Thoughts&lt;/p&gt;</comment>
                            <comment id="16975606" author="cloud_fan" created="Sat, 16 Nov 2019 06:22:43 +0000"  >&lt;p&gt;seems like another self-join bug. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=imback82&quot; class=&quot;user-hover&quot; rel=&quot;imback82&quot;&gt;imback82&lt;/a&gt; can you take a look?&lt;/p&gt;</comment>
                            <comment id="16975609" author="imback82" created="Sat, 16 Nov 2019 06:32:39 +0000"  >&lt;p&gt;Sure. I will take a look.&lt;/p&gt;</comment>
                            <comment id="16975733" author="sandeshyapuram" created="Sat, 16 Nov 2019 16:07:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=imback82&quot; class=&quot;user-hover&quot; rel=&quot;imback82&quot;&gt;imback82&lt;/a&gt; This happens even for a normal join:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;val p1 = spark.sparkContext.parallelize(Seq((1,2),(3,4),(5,6))).toDF(&quot;nums&quot;, &quot;abc&quot;)
val p2 = spark.sparkContext.parallelize(Seq((1,2),(3,4),(5,6))).toDF(&quot;nums&quot;, &quot;abc&quot;)
p1.join(p2, Seq(&quot;nums&quot;), &quot;left&quot;)
.na.fill(0).show
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16975853" author="imback82" created="Sun, 17 Nov 2019 00:27:54 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt; p1.join(p2, Seq(&lt;span class=&quot;code-quote&quot;&gt;&quot;nums&quot;&lt;/span&gt;)).printSchema
root
 |-- nums: integer (nullable = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
 |-- abc: integer (nullable = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
 |-- abc: integer (nullable = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that `fill` takes in column &lt;em&gt;names&lt;/em&gt;. Thus, the following is ambiguous.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt; p1.join(p2, Seq(&lt;span class=&quot;code-quote&quot;&gt;&quot;nums&quot;&lt;/span&gt;)).na.fill(0, Seq(&lt;span class=&quot;code-quote&quot;&gt;&quot;abc&quot;&lt;/span&gt;))
org.apache.spark.sql.AnalysisException: Reference &lt;span class=&quot;code-quote&quot;&gt;&apos;abc&apos;&lt;/span&gt; is ambiguous, could be: abc, abc.;
  at org.apache.spark.sql.catalyst.expressions.&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;$AttributeSeq.resolve(&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;.scala:240)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt;, I think this is an expected behavior. What do you think?&lt;/p&gt;</comment>
                            <comment id="16976448" author="cloud_fan" created="Mon, 18 Nov 2019 11:07:25 +0000"  >&lt;p&gt;When we do `.fill(0, Seq(&quot;abc&quot;))`, I think we should report error. But for `.fill(0)`, we want to apply on all columns, which should not do name lookup?&lt;/p&gt;</comment>
                            <comment id="16977020" author="imback82" created="Tue, 19 Nov 2019 00:23:33 +0000"  >&lt;p&gt;Got it. Thanks.&lt;/p&gt;</comment>
                            <comment id="16977183" author="imback82" created="Tue, 19 Nov 2019 07:10:05 +0000"  >&lt;p&gt;I also noticed that `drop()` behaves the same. I will work on that if this PR gets merged.&lt;/p&gt;</comment>
                            <comment id="16981676" author="cloud_fan" created="Mon, 25 Nov 2019 16:20:29 +0000"  >&lt;p&gt;Issue resolved by pull request 26593&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/26593&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/26593&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17266063" author="petertoth" created="Fri, 15 Jan 2021 14:17:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=imback82&quot; class=&quot;user-hover&quot; rel=&quot;imback82&quot;&gt;imback82&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt;, due this change `fill` started to throw exception when `cols` contains a column that can&apos;t be resolved. I wonder if this behaviour change of `fill` is desired or it is more like bug. I&apos;m happy to open fix PR if you think this side effect is unintended.&lt;/p&gt;</comment>
                            <comment id="17266970" author="imback82" created="Mon, 18 Jan 2021 02:41:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=petertoth&quot; class=&quot;user-hover&quot; rel=&quot;petertoth&quot;&gt;petertoth&lt;/a&gt; Could you share the example and the behavior change? Are you referring to something like the following:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt; Seq(1).toDF(&lt;span class=&quot;code-quote&quot;&gt;&quot;i&quot;&lt;/span&gt;).na.fill(0, Seq(&lt;span class=&quot;code-quote&quot;&gt;&quot;j&quot;&lt;/span&gt;))
org.apache.spark.sql.AnalysisException: Cannot resolve column name &lt;span class=&quot;code-quote&quot;&gt;&quot;j&quot;&lt;/span&gt; among (i)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;, which seems fine to me.&lt;/p&gt;</comment>
                            <comment id="17267059" author="petertoth" created="Mon, 18 Jan 2021 07:57:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=imback82&quot; class=&quot;user-hover&quot; rel=&quot;imback82&quot;&gt;imback82&lt;/a&gt;, yes, that&apos;s a good example. `fill` didn&apos;t throw any exception before this ticket. &lt;/p&gt;</comment>
                            <comment id="17267251" author="cloud_fan" created="Mon, 18 Jan 2021 12:56:34 +0000"  >&lt;p&gt;I think failing makes more sense than silently ignore it.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13253470">SPARK-28897</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13271120">SPARK-30065</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 43 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z08lns:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>