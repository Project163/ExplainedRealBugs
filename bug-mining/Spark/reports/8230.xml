<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:28:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-37121] TestUtils.isPythonVersionAtLeast38 returns incorrect results</title>
                <link>https://issues.apache.org/jira/browse/SPARK-37121</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I was working on &lt;tt&gt;HiveExternalCatalogVersionsSuite&lt;/tt&gt; recently and noticed that it was never running against the Spark 2.x release lines, only the 3.x ones. The problem was coming from here, specifically the Python 3.8+ version check:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    versions
      .filter(v =&amp;gt; v.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;) || !TestUtils.isPythonVersionAtLeast38())
      .filter(v =&amp;gt; v.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;) || !SystemUtils.isJavaVersionAtLeast(JavaVersion.JAVA_9))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I found that &lt;tt&gt;TestUtils.isPythonVersionAtLeast38()&lt;/tt&gt; was always returning true, even when my system installation of Python3 was 3.7. Thinking it was an environment issue, I pulled up a debugger to check which version of Python the test JVM was seeing, and it was in fact Python 3.7.&lt;/p&gt;

&lt;p&gt;Turns out the issue is with the &lt;tt&gt;isPythonVersionAtLeast38&lt;/tt&gt; method:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  def isPythonVersionAtLeast38(): &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; = {
    val attempt = &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (Utils.isWindows) {
      Try(&lt;span class=&quot;code-object&quot;&gt;Process&lt;/span&gt;(Seq(&lt;span class=&quot;code-quote&quot;&gt;&quot;cmd.exe&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/C&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;python3 --version&quot;&lt;/span&gt;))
        .run(ProcessLogger(s =&amp;gt; s.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;Python 3.8&quot;&lt;/span&gt;) || s.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;Python 3.9&quot;&lt;/span&gt;)))
        .exitValue())
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
      Try(&lt;span class=&quot;code-object&quot;&gt;Process&lt;/span&gt;(Seq(&lt;span class=&quot;code-quote&quot;&gt;&quot;sh&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;-c&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;python3 --version&quot;&lt;/span&gt;))
        .run(ProcessLogger(s =&amp;gt; s.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;Python 3.8&quot;&lt;/span&gt;) || s.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;Python 3.9&quot;&lt;/span&gt;)))
        .exitValue())
    }
    attempt.isSuccess &amp;amp;&amp;amp; attempt.get == 0
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It&apos;s trying to evaluate the version of Python using a &lt;tt&gt;ProcessLogger&lt;/tt&gt;, but the logger accepts a &lt;tt&gt;String =&amp;gt; Unit&lt;/tt&gt; function, i.e., it does not make use of the return value in any way (since it&apos;s meant for logging). So the result of the &lt;tt&gt;startsWith&lt;/tt&gt; checks are thrown away, and &lt;tt&gt;attempt.isSuccess &amp;amp;&amp;amp; attempt.get == 0&lt;/tt&gt; will always be true as long as your system has a &lt;tt&gt;python3&lt;/tt&gt; binary of any version.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13408525">SPARK-37121</key>
            <summary>TestUtils.isPythonVersionAtLeast38 returns incorrect results</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xkrogen">Erik Krogen</assignee>
                                    <reporter username="xkrogen">Erik Krogen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Oct 2021 17:55:54 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:35 +0000</updated>
                            <resolved>Thu, 28 Oct 2021 00:46:31 +0000</resolved>
                                    <version>3.2.0</version>
                                    <fixVersion>3.2.1</fixVersion>
                    <fixVersion>3.3.0</fixVersion>
                                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17434503" author="apachespark" created="Tue, 26 Oct 2021 18:07:26 +0000"  >&lt;p&gt;User &apos;xkrogen&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34395&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34395&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17435110" author="gurwls223" created="Thu, 28 Oct 2021 00:46:31 +0000"  >&lt;p&gt;Issue resolved by pull request 34395&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/34395&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/34395&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 2 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0w6k8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>