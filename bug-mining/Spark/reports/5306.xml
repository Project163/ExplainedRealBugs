<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:57:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-22479] SaveIntoDataSourceCommand logs jdbc credentials</title>
                <link>https://issues.apache.org/jira/browse/SPARK-22479</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;JDBC credentials are not redacted in plans including a &apos;SaveIntoDataSourceCommand&apos;.&lt;/p&gt;

&lt;p&gt;Steps to reproduce:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
spark-shell --packages org.postgresql:postgresql:42.1.1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.execution.QueryExecution
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.util.QueryExecutionListener
val listener = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; QueryExecutionListener {
  override def onFailure(funcName: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, qe: QueryExecution, exception: Exception): Unit = {}
  override def onSuccess(funcName: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, qe: QueryExecution, duration: &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;): Unit = {
    &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(qe.toString())
  }
}
spark.listenerManager.register(listener)
spark.range(100).write.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;jdbc&quot;&lt;/span&gt;).option(&lt;span class=&quot;code-quote&quot;&gt;&quot;url&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;jdbc:postgresql:sparkdb&quot;&lt;/span&gt;).option(&lt;span class=&quot;code-quote&quot;&gt;&quot;password&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;pass&quot;&lt;/span&gt;).option(&lt;span class=&quot;code-quote&quot;&gt;&quot;driver&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;org.postgresql.Driver&quot;&lt;/span&gt;).option(&lt;span class=&quot;code-quote&quot;&gt;&quot;dbtable&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;).save()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The above will yield the following plan:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
== Parsed Logical Plan ==
SaveIntoDataSourceCommand jdbc, Map(dbtable -&amp;gt; test10, driver -&amp;gt; org.postgresql.Driver, url -&amp;gt; jdbc:postgresql:sparkdb, password -&amp;gt; pass), ErrorIfExists
   +- Range (0, 100, step=1, splits=Some(8))

== Analyzed Logical Plan ==
SaveIntoDataSourceCommand jdbc, Map(dbtable -&amp;gt; test10, driver -&amp;gt; org.postgresql.Driver, url -&amp;gt; jdbc:postgresql:sparkdb, password -&amp;gt; pass), ErrorIfExists
   +- Range (0, 100, step=1, splits=Some(8))

== Optimized Logical Plan ==
SaveIntoDataSourceCommand jdbc, Map(dbtable -&amp;gt; test10, driver -&amp;gt; org.postgresql.Driver, url -&amp;gt; jdbc:postgresql:sparkdb, password -&amp;gt; pass), ErrorIfExists
   +- Range (0, 100, step=1, splits=Some(8))

== Physical Plan ==
ExecutedCommand
   +- SaveIntoDataSourceCommand jdbc, Map(dbtable -&amp;gt; test10, driver -&amp;gt; org.postgresql.Driver, url -&amp;gt; jdbc:postgresql:sparkdb, password -&amp;gt; pass), ErrorIfExists
         +- Range (0, 100, step=1, splits=Some(8))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;



</description>
                <environment></environment>
        <key id="13117270">SPARK-22479</key>
            <summary>SaveIntoDataSourceCommand logs jdbc credentials</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="onursatici">Onur Satici</assignee>
                                    <reporter username="onursatici">Onur Satici</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Nov 2017 13:49:44 +0000</created>
                <updated>Sat, 13 Oct 2018 21:11:27 +0000</updated>
                            <resolved>Thu, 16 Nov 2017 11:51:07 +0000</resolved>
                                    <version>2.2.0</version>
                                    <fixVersion>2.2.1</fixVersion>
                    <fixVersion>2.3.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16245677" author="onursatici" created="Thu, 9 Nov 2017 13:54:13 +0000"  >&lt;p&gt;will submit a pr&lt;/p&gt;</comment>
                            <comment id="16245766" author="apachespark" created="Thu, 9 Nov 2017 14:54:05 +0000"  >&lt;p&gt;User &apos;onursatici&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/19708&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/19708&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16246328" author="aash" created="Thu, 9 Nov 2017 19:19:10 +0000"  >&lt;p&gt;Completely agree that credentials shouldn&apos;t be in the toString since query plans are logged in many places.  This looks like it brings SaveIntoDataSourceCommand more in-line with JdbcRelation, which also currently redacts credentials from its toString to avoid them being written to logs.&lt;/p&gt;</comment>
                            <comment id="16254424" author="apachespark" created="Wed, 15 Nov 2017 23:18:10 +0000"  >&lt;p&gt;User &apos;onursatici&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/19761&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/19761&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16383709" author="tgraves" created="Fri, 2 Mar 2018 15:44:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aash&quot; class=&quot;user-hover&quot; rel=&quot;aash&quot;&gt;aash&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=onursatici&quot; class=&quot;user-hover&quot; rel=&quot;onursatici&quot;&gt;onursatici&lt;/a&gt; this seems to have redacted user names as well as the passwords.&#160; &#160;We specifically added the User: field to the UI and now its being blocked, which is makes debugging harder.&#160; The user name&#160;does not seem like something that needs to be redacted by default.&#160; what is the reasoning&#160;behind that?&#160;&lt;/p&gt;

&lt;p&gt;Note that at least on yarn there are other ways to easily see the username on the UI (like the Resource Paths) so its definitely not a complete solution anyway.&lt;/p&gt;</comment>
                            <comment id="16383733" author="tgraves" created="Fri, 2 Mar 2018 15:56:32 +0000"  >&lt;p&gt;Also the example above shows the password, but the password should have been already redacted, this pr excluded url, user, and username. Was the password not being redacted for some reason?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13191418">SPARK-25726</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="13142127">SPARK-23567</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13149549">SPARK-23850</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3mld3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12340470">2.2.1</customfieldvalue>
    <customfieldvalue id="12339551">2.3.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>