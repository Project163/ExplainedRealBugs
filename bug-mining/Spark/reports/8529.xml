<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:30:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-39412] IllegalStateException from connector does not work well with error class framework</title>
                <link>https://issues.apache.org/jira/browse/SPARK-39412</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;With &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-39346&quot; title=&quot;Convert asserts/illegal state exception to internal errors on each phase&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-39346&quot;&gt;&lt;del&gt;SPARK-39346&lt;/del&gt;&lt;/a&gt;, Spark SQL binds several exceptions to the internal error, and produces different guidance on dealing with the exception. This assumes these exceptions are only used for noticing internal bugs.&lt;/p&gt;

&lt;p&gt;This applies to &quot;connectors&quot; as well, and introduces side-effect on the error log. For Kafka data source, it is a breaking and unacceptable change, because there is an important use case Kafka data source determines a case of &quot;dataloss&quot;, and throws IllegalStateException with instruction message on workaround.&lt;/p&gt;

&lt;p&gt;I mentioned this as &quot;important&quot; use case, because it can even happen with some valid scenarios - streaming query has some maintenance period and Kafka&apos;s retention on topic removes some records in the meanwhile.&lt;/p&gt;

&lt;p&gt;Two problems arise:&lt;/p&gt;

&lt;p&gt;1) This does not mean Spark has a bug and end users have to report, hence the guidance message on internal error is misleading.&lt;/p&gt;

&lt;p&gt;2) Most importantly, instruction message is shown after a long stack trace. With the modification of existing test suite, I see the message being appeared in &quot;line 90&quot; of the error log.&lt;/p&gt;

&lt;p&gt;We should roll the right error message back, at least for Kafka&apos;s case.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13448925">SPARK-39412</key>
            <summary>IllegalStateException from connector does not work well with error class framework</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="maxgekk">Max Gekk</assignee>
                                    <reporter username="kabhwan">Jungtaek Lim</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Jun 2022 06:41:46 +0000</created>
                <updated>Fri, 10 Jun 2022 04:20:57 +0000</updated>
                            <resolved>Wed, 8 Jun 2022 18:21:51 +0000</resolved>
                                    <version>3.3.0</version>
                                    <fixVersion>3.3.0</fixVersion>
                    <fixVersion>3.4.0</fixVersion>
                                    <component>Structured Streaming</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17551463" author="apachespark" created="Wed, 8 Jun 2022 08:16:03 +0000"  >&lt;p&gt;User &apos;MaxGekk&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/36804&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/36804&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17551741" author="maxgekk" created="Wed, 8 Jun 2022 18:21:51 +0000"  >&lt;p&gt;Issue resolved by pull request 36804&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/36804&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/36804&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17552172" author="apachespark" created="Thu, 9 Jun 2022 12:20:19 +0000"  >&lt;p&gt;User &apos;MaxGekk&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/36824&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/36824&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13044749" name="kafka-dataloss-error-msg-in-spark-3-2.log" size="11832" author="kabhwan" created="Wed, 8 Jun 2022 06:42:10 +0000"/>
                            <attachment id="13044754" name="kafka-dataloss-error-msg-in-spark-3-3-or-master.log" size="12602" author="kabhwan" created="Wed, 8 Jun 2022 07:38:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 22 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z131hc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>