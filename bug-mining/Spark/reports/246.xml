<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:13:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-1789] Multiple versions of Netty dependencies cause FlumeStreamSuite failure</title>
                <link>https://issues.apache.org/jira/browse/SPARK-1789</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;TL;DR is there is a bit of JAR hell trouble with Netty, that can be mostly resolved and will resolve a test failure.&lt;/p&gt;


&lt;p&gt;I hit the error described at &lt;a href=&quot;http://apache-spark-user-list.1001560.n3.nabble.com/SparkContext-startup-time-out-td1753.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://apache-spark-user-list.1001560.n3.nabble.com/SparkContext-startup-time-out-td1753.html&lt;/a&gt; while running FlumeStreamingSuite, and have for a short while (is it just me?)&lt;/p&gt;

&lt;p&gt;velvia notes:&lt;br/&gt;
&quot;I have found a workaround.  If you add akka 2.2.4 to your dependencies, then everything works, probably because akka 2.2.4 brings in newer version of Jetty.&quot; &lt;/p&gt;

&lt;p&gt;There are at least 3 versions of Netty in play in the build:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the new Flume 1.4.0 dependency brings in io.netty:netty:3.4.0.Final, and that is the immediate problem&lt;/li&gt;
	&lt;li&gt;the custom version of akka 2.2.3 depends on io.netty:netty:3.6.6.&lt;/li&gt;
	&lt;li&gt;but, Spark Core directly uses io.netty:netty-all:4.0.17.Final&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The POMs try to exclude other versions of netty, but are excluding org.jboss.netty:netty, when in fact older versions of io.netty:netty (not netty-all) are also an issue.&lt;/p&gt;

&lt;p&gt;The org.jboss.netty:netty excludes are largely unnecessary. I replaced many of them with io.netty:netty exclusions until everything agreed on io.netty:netty-all:4.0.17.Final.&lt;/p&gt;

&lt;p&gt;But this didn&apos;t work, since Akka 2.2.3 doesn&apos;t work with Netty 4.x. Down-grading to 3.6.6.Final across the board made some Spark code not compile.&lt;/p&gt;

&lt;p&gt;If the build &lt;b&gt;keeps&lt;/b&gt; io.netty:netty:3.6.6.Final as well, everything seems to work. Part of the reason seems to be that Netty 3.x used the old `org.jboss.netty` packages. This is less than ideal, but is no worse than the current situation. &lt;/p&gt;


&lt;p&gt;So this PR resolves the issue and improves the JAR hell, even if it leaves the existing theoretical Netty 3-vs-4 conflict:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Remove org.jboss.netty excludes where possible, for clarity; they&apos;re not needed except with Hadoop artifacts&lt;/li&gt;
	&lt;li&gt;Add io.netty:netty excludes where needed &amp;#8211; except, let akka keep its io.netty:netty&lt;/li&gt;
	&lt;li&gt;Change a bit of test code that actually depended on Netty 3.x, to use 4.x equivalent&lt;/li&gt;
	&lt;li&gt;Update SBT build accordingly&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;A better change would be to update Akka far enough such that it agrees on Netty 4.x, but I don&apos;t know if that&apos;s feasible.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12713475">SPARK-1789</key>
            <summary>Multiple versions of Netty dependencies cause FlumeStreamSuite failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="srowen">Sean R. Owen</assignee>
                                    <reporter username="srowen">Sean R. Owen</reporter>
                        <labels>
                            <label>flume</label>
                            <label>netty</label>
                            <label>test</label>
                    </labels>
                <created>Sat, 10 May 2014 20:00:30 +0000</created>
                <updated>Thu, 15 Jan 2015 09:08:42 +0000</updated>
                            <resolved>Sun, 11 May 2014 03:51:05 +0000</resolved>
                                    <version>0.9.1</version>
                                    <fixVersion>1.0.0</fixVersion>
                                    <component>Build</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13994415" author="pwendell" created="Sun, 11 May 2014 03:51:06 +0000"  >&lt;p&gt;Issue resolved by pull request 723&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/723&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13995560" author="willbenton" created="Mon, 12 May 2014 19:57:24 +0000"  >&lt;p&gt;Sean, we&apos;re currently building against Akka 2.3.0 in Fedora (it&apos;s a trivial source patch against 0.9.1; I haven&apos;t investigated the delta against 1.0 yet).  Are there reasons why Akka 2.3.0 is a bad idea for Spark in general?  If not, I&apos;m happy to file a JIRA for updating the dependency and contribute my patch upstream.&lt;/p&gt;</comment>
                            <comment id="13997317" author="srowen" created="Wed, 14 May 2014 06:07:13 +0000"  >&lt;p&gt;I don&apos;t have any info either way on that. Later is always better no? probably OK to consider post-1.0? &lt;/p&gt;

&lt;p&gt;The issue here was to do with Netty, and the comment about Akka that I quoted was really meant to suggest that it was Netty (as it happens being imported by Akka) that was relevant.&lt;/p&gt;</comment>
                            <comment id="13997610" author="willbenton" created="Wed, 14 May 2014 14:50:31 +0000"  >&lt;p&gt;Yes, this is absolutely a post-1.0 thing.  I&apos;m just saying that by updating the version of Akka to 2.3 we&apos;d eliminate one of Spark&apos;s dependencies that can&apos;t work with Netty 4.  The issue of only transitively depending on at most one version of Netty 3 and at most one version of Netty 4 (and choosing ones that can work different coordinates) is orthogonal, but still an issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>391791</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 27 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1vh47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>391994</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>