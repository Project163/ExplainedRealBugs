<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:07:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-26154] Stream-stream joins - left outer join gives inconsistent output</title>
                <link>https://issues.apache.org/jira/browse/SPARK-26154</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Stream-stream joins using left outer join gives inconsistent&#160; output&#160;&lt;/p&gt;

&lt;p&gt;The data processed once, is being processed again and gives null value. In Batch 2, the input data&#160; &quot;3&quot; is processed. But again in batch 6, null value is provided for same data&lt;/p&gt;

&lt;p&gt;Steps&lt;br/&gt;
In spark-shell&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt;     &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.functions.{col, expr}
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.functions.{col, expr}
scala&amp;gt;     &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.streaming.Trigger
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.streaming.Trigger
scala&amp;gt;     val lines_stream1 = spark.readStream.
     |       format(&lt;span class=&quot;code-quote&quot;&gt;&quot;kafka&quot;&lt;/span&gt;).
     |       option(&lt;span class=&quot;code-quote&quot;&gt;&quot;kafka.bootstrap.servers&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;ip:9092&quot;&lt;/span&gt;).
     |       option(&lt;span class=&quot;code-quote&quot;&gt;&quot;subscribe&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;topic1&quot;&lt;/span&gt;).
     |       option(&lt;span class=&quot;code-quote&quot;&gt;&quot;includeTimestamp&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;).
     |       load().
     |       selectExpr(&lt;span class=&quot;code-quote&quot;&gt;&quot;CAST (value AS &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;)&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;CAST(timestamp AS TIMESTAMP)&quot;&lt;/span&gt;).as[(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;,Timestamp)].
     |       select(col(&lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;) as(&lt;span class=&quot;code-quote&quot;&gt;&quot;data&quot;&lt;/span&gt;),col(&lt;span class=&quot;code-quote&quot;&gt;&quot;timestamp&quot;&lt;/span&gt;) as(&lt;span class=&quot;code-quote&quot;&gt;&quot;recordTime&quot;&lt;/span&gt;)).
     |       select(&lt;span class=&quot;code-quote&quot;&gt;&quot;data&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;recordTime&quot;&lt;/span&gt;).
     |       withWatermark(&lt;span class=&quot;code-quote&quot;&gt;&quot;recordTime&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;5 seconds &quot;&lt;/span&gt;)
lines_stream1: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [data: string, recordTime: timestamp]
scala&amp;gt;     val lines_stream2 = spark.readStream.
     |       format(&lt;span class=&quot;code-quote&quot;&gt;&quot;kafka&quot;&lt;/span&gt;).
     |       option(&lt;span class=&quot;code-quote&quot;&gt;&quot;kafka.bootstrap.servers&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;ip:9092&quot;&lt;/span&gt;).
     |       option(&lt;span class=&quot;code-quote&quot;&gt;&quot;subscribe&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;topic2&quot;&lt;/span&gt;).
     |       option(&lt;span class=&quot;code-quote&quot;&gt;&quot;includeTimestamp&quot;&lt;/span&gt;, value = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;).
     |       load().
     |       selectExpr(&lt;span class=&quot;code-quote&quot;&gt;&quot;CAST (value AS &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;)&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;CAST(timestamp AS TIMESTAMP)&quot;&lt;/span&gt;).as[(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;,Timestamp)].
     |       select(col(&lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;) as(&lt;span class=&quot;code-quote&quot;&gt;&quot;data1&quot;&lt;/span&gt;),col(&lt;span class=&quot;code-quote&quot;&gt;&quot;timestamp&quot;&lt;/span&gt;) as(&lt;span class=&quot;code-quote&quot;&gt;&quot;recordTime1&quot;&lt;/span&gt;)).
     |       select(&lt;span class=&quot;code-quote&quot;&gt;&quot;data1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;recordTime1&quot;&lt;/span&gt;).
     |       withWatermark(&lt;span class=&quot;code-quote&quot;&gt;&quot;recordTime1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;10 seconds &quot;&lt;/span&gt;)
lines_stream2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [data1: string, recordTime1: timestamp]
scala&amp;gt;     val query = lines_stream1.join(lines_stream2, expr (
     |       &quot;&quot;&quot;
     |         | data == data1 and
     |         | recordTime1 &amp;gt;= recordTime and
     |         | recordTime1 &amp;lt;= recordTime + interval 5 seconds
     |       &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;&quot;.stripMargin),&quot;&lt;/span&gt;left&quot;).
     |       writeStream.
     |       option(&lt;span class=&quot;code-quote&quot;&gt;&quot;truncate&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;).
     |       outputMode(&lt;span class=&quot;code-quote&quot;&gt;&quot;append&quot;&lt;/span&gt;).
     |       format(&lt;span class=&quot;code-quote&quot;&gt;&quot;console&quot;&lt;/span&gt;).option(&lt;span class=&quot;code-quote&quot;&gt;&quot;checkpointLocation&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/leftouter/&quot;&lt;/span&gt;).
     |       trigger(Trigger.ProcessingTime (&lt;span class=&quot;code-quote&quot;&gt;&quot;5 seconds&quot;&lt;/span&gt;)).
     |       start()
query: org.apache.spark.sql.streaming.StreamingQuery = org.apache.spark.sql.execution.streaming.StreamingQueryWrapper@1a48f55b
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Step2 : Start producing data&lt;/p&gt;

&lt;p&gt;kafka-console-producer.sh --broker-list ip:9092 --topic topic1&lt;br/&gt;
 &amp;gt;1&lt;br/&gt;
 &amp;gt;2&lt;br/&gt;
 &amp;gt;3&lt;br/&gt;
 &amp;gt;4&lt;br/&gt;
 &amp;gt;5&lt;br/&gt;
 &amp;gt;aa&lt;br/&gt;
 &amp;gt;bb&lt;br/&gt;
 &amp;gt;cc&lt;/p&gt;

&lt;p&gt;kafka-console-producer.sh --broker-list ip:9092 --topic topic2&lt;br/&gt;
 &amp;gt;2&lt;br/&gt;
 &amp;gt;2&lt;br/&gt;
 &amp;gt;3&lt;br/&gt;
 &amp;gt;4&lt;br/&gt;
 &amp;gt;5&lt;br/&gt;
 &amp;gt;aa&lt;br/&gt;
 &amp;gt;cc&lt;br/&gt;
 &amp;gt;ee&lt;br/&gt;
 &amp;gt;ee&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Output obtained:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Batch: 0
-------------------------------------------
+----+----------+-----+-----------+
|data|recordTime|data1|recordTime1|
+----+----------+-----+-----------+
+----+----------+-----+-----------+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+----------+-----+-----------+
|data|recordTime|data1|recordTime1|
+----+----------+-----+-----------+
+----+----------+-----+-----------+

-------------------------------------------
Batch: 2
-------------------------------------------
+----+-----------------------+-----+-----------------------+
|data|recordTime             |data1|recordTime1            |
+----+-----------------------+-----+-----------------------+
|3   |2018-11-22 20:09:35.053|3    |2018-11-22 20:09:36.506|
|2   |2018-11-22 20:09:31.613|2    |2018-11-22 20:09:33.116|
+----+-----------------------+-----+-----------------------+

-------------------------------------------
Batch: 3
-------------------------------------------
+----+-----------------------+-----+-----------------------+
|data|recordTime             |data1|recordTime1            |
+----+-----------------------+-----+-----------------------+
|4   |2018-11-22 20:09:38.654|4    |2018-11-22 20:09:39.818|
+----+-----------------------+-----+-----------------------+

-------------------------------------------
Batch: 4
-------------------------------------------
+----+-----------------------+-----+-----------------------+
|data|recordTime             |data1|recordTime1            |
+----+-----------------------+-----+-----------------------+
|5   |2018-11-22 20:09:44.809|5    |2018-11-22 20:09:47.452|
|1   |2018-11-22 20:09:22.662|&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; |&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;                   |
+----+-----------------------+-----+-----------------------+

-------------------------------------------
Batch: 5
-------------------------------------------
+----+-----------------------+-----+-----------------------+
|data|recordTime             |data1|recordTime1            |
+----+-----------------------+-----+-----------------------+
|cc  |2018-11-22 20:10:06.654|cc   |2018-11-22 20:10:08.701|
|aa  |2018-11-22 20:10:01.536|aa   |2018-11-22 20:10:03.259|
+----+-----------------------+-----+-----------------------+

-------------------------------------------
Batch: 6
-------------------------------------------
+----+-----------------------+-----+-----------+
|data|recordTime             |data1|recordTime1|
+----+-----------------------+-----+-----------+
|3   |2018-11-22 20:09:35.053|&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; |&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;       |
+----+-----------------------+-----+-----------+

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</description>
                <environment>&lt;p&gt;Spark version - Spark 2.3.2&lt;/p&gt;

&lt;p&gt;OS- Suse 11&lt;/p&gt;</environment>
        <key id="13200176">SPARK-26154</key>
            <summary>Stream-stream joins - left outer join gives inconsistent output</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kabhwan">Jungtaek Lim</assignee>
                                    <reporter username="hari28">Haripriya</reporter>
                        <labels>
                            <label>correctness</label>
                    </labels>
                <created>Fri, 23 Nov 2018 05:16:40 +0000</created>
                <updated>Wed, 8 Apr 2020 06:41:21 +0000</updated>
                            <resolved>Mon, 11 Nov 2019 23:47:54 +0000</resolved>
                                    <version>2.3.0</version>
                    <version>2.3.2</version>
                    <version>3.0.0</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>Structured Streaming</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>17</watches>
                                                                                                                <comments>
                            <comment id="16724238" author="sandeep.katta2007" created="Tue, 18 Dec 2018 16:43:39 +0000"  >&lt;p&gt;CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cody%40koeninger.org&quot; class=&quot;user-hover&quot; rel=&quot;cody@koeninger.org&quot;&gt;cody@koeninger.org&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tdas&quot; class=&quot;user-hover&quot; rel=&quot;tdas&quot;&gt;tdas&lt;/a&gt; . this looks like potential bug to me.&lt;/p&gt;

&lt;p&gt;can you please look into this issue&lt;/p&gt;</comment>
                            <comment id="16745445" author="chernikovp" created="Thu, 17 Jan 2019 20:00:44 +0000"  >&lt;p&gt;Just in case a&#160;bit more reproducible&#160; example is needed , here it&apos;s documented -&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26187&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-26187&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16750909" author="kabhwan" created="Thu, 24 Jan 2019 09:25:08 +0000"  >&lt;p&gt;As I tracked this with &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26187&quot; title=&quot;Stream-stream left outer join returns outer nulls for already matched rows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26187&quot;&gt;&lt;del&gt;SPARK-26187&lt;/del&gt;&lt;/a&gt;, let&apos;s mark this as duplicated.&lt;/p&gt;</comment>
                            <comment id="16750984" author="hari28" created="Thu, 24 Jan 2019 10:27:18 +0000"  >&lt;p&gt;Since&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26154&quot; title=&quot;Stream-stream joins - left outer join gives inconsistent output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26154&quot;&gt;&lt;del&gt;SPARK-26154&lt;/del&gt;&lt;/a&gt;&#160;has been reported earlier can we mark the other issue as duplicate...&lt;/p&gt;</comment>
                            <comment id="16751665" author="apachespark" created="Thu, 24 Jan 2019 22:51:20 +0000"  >&lt;p&gt;User &apos;HeartSaVioR&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/23634&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23634&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16751670" author="kabhwan" created="Thu, 24 Jan 2019 22:53:21 +0000"  >&lt;p&gt;As issue reporter concerns about handling duplicated issue, I just changed my patch to point to this issue, and will mark &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26187&quot; title=&quot;Stream-stream left outer join returns outer nulls for already matched rows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26187&quot;&gt;&lt;del&gt;SPARK-26187&lt;/del&gt;&lt;/a&gt; as duplicated.&lt;/p&gt;</comment>
                            <comment id="16754335" author="kabhwan" created="Mon, 28 Jan 2019 20:31:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tdas&quot; class=&quot;user-hover&quot; rel=&quot;tdas&quot;&gt;tdas&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zsxwing&quot; class=&quot;user-hover&quot; rel=&quot;zsxwing&quot;&gt;zsxwing&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=joseph.torres&quot; class=&quot;user-hover&quot; rel=&quot;joseph.torres&quot;&gt;joseph.torres&lt;/a&gt;&lt;br/&gt;
Could we please justify whether this is correctness bug and should be prioritized?&lt;/p&gt;</comment>
                            <comment id="16756702" author="srowen" created="Thu, 31 Jan 2019 00:01:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kabhwan&quot; class=&quot;user-hover&quot; rel=&quot;kabhwan&quot;&gt;kabhwan&lt;/a&gt; I think everyone is able to modify the labels and priority (not actually by design we just can&apos;t restrict it). I made this &apos;Critical&apos; though priorities except &apos;Blocker&apos; don&apos;t mean a lot. And labeled it &apos;correctness&apos;.&lt;/p&gt;</comment>
                            <comment id="16756709" author="kabhwan" created="Thu, 31 Jan 2019 00:05:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srowen&quot; class=&quot;user-hover&quot; rel=&quot;srowen&quot;&gt;srowen&lt;/a&gt;&lt;br/&gt;
Yeah, I just wanted to avoid changing priority by myself given I&apos;m frequently seeing comments that &apos;critical&apos; and &apos;blocker&apos; are reserved to committers. Thanks for justifying and changing it!&lt;/p&gt;</comment>
                            <comment id="16756716" author="srowen" created="Thu, 31 Jan 2019 00:11:53 +0000"  >&lt;p&gt;Sure, it&apos;s a judgment call. If you see people contemplating it as blocking a release, I think that change would be fair to make. You can update other JIRA elements if you&apos;re pretty sure, given your experience with the project, that it should have a different label or whatever. &lt;/p&gt;

&lt;p&gt;What we don&apos;t want is simply people with no experience in the project marking things Blocker and setting a bunch of unuseful flags like &apos;Important&apos; or tagging it &apos;spark&apos;. If you know enough to be thoughtful about it, I bet your edits would be OK. If in doubt ask.&lt;/p&gt;</comment>
                            <comment id="16815211" author="kabhwan" created="Thu, 11 Apr 2019 08:44:54 +0000"  >&lt;p&gt;This issue is reported again:&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-27433&quot; title=&quot;Spark Structured Streaming left outer joins returns outer nulls for already matched rows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-27433&quot;&gt;&lt;del&gt;SPARK-27433&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I&apos;d say it should be a blocker for Spark 3.0.0. This slips two bugfix releases, and now major release is coming which I think it will slip again even for major release unless it is marked as a blocker.&lt;/p&gt;

&lt;p&gt;Someone could say it&apos;s not a regression so&#160;it is not necessarily a&#160;blocker, but given we don&apos;t concern about non-blocker issues when releasing, only labelling as &apos;correctness&apos; never works.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://spark.apache.org/contributing.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://spark.apache.org/contributing.html&lt;/a&gt;&#160;page clearly describes that correctness issues should be considered blockers, and this issue has no workaround from Spark side which doesn&apos;t fit to mark as &apos;critical&apos;.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Blocker: pointless to release without this change as the release would be unusable to a large minority of users. Correctness and data loss issues should be considered Blockers.&lt;/li&gt;
	&lt;li&gt;Critical: a large minority of users are missing important functionality without this, and/or a workaround is difficult&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I&apos;ll mark this as a blocker: hope the patch will be reviewed soon.&lt;/p&gt;</comment>
                            <comment id="16816110" author="binitbhaskar" created="Fri, 12 Apr 2019 09:09:48 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kabhwan&quot; class=&quot;user-hover&quot; rel=&quot;kabhwan&quot;&gt;kabhwan&lt;/a&gt; for taking up this issue. I too feel it is a blocker as the basic left_outer join is not working. It is a shame as we have a very tight project delivery timeline and we could proceed further due to this bug.&#160;&lt;/p&gt;

&lt;p&gt;I can see the pull request for this fix is hanging since January, do you have any timeline when it can be merged.&#160;&#160;&lt;/p&gt;</comment>
                            <comment id="16971908" author="vanzin" created="Mon, 11 Nov 2019 23:47:55 +0000"  >&lt;p&gt;Issue resolved by pull request 26108&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/26108&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/26108&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17021627" author="kabhwan" created="Wed, 22 Jan 2020 23:53:34 +0000"  >&lt;p&gt;Leaving information why this issue cannot be easily ported back to 2.x version line although it fixes the correctness.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;We fixed the issue with &quot;destructive way&quot; on existing query as the state in existing query cannot be corrected. In 3.0 migration guide we added below content:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Spark 3.0 fixes the correctness issue on Stream-stream outer join, which changes the schema of state. (&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-26154&quot; title=&quot;Stream-stream joins - left outer join gives inconsistent output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-26154&quot;&gt;&lt;del&gt;SPARK-26154&lt;/del&gt;&lt;/a&gt; for more details) Spark 3.0 will fail the query if you start your query from checkpoint constructed from Spark 2.x which uses stream-stream outer join. Please discard the checkpoint and replay previous inputs to recalculate outputs.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;End users might not be mad if &quot;major&quot; version requires them to lose something. They still have Spark 2.x version line to deny the change and take the risk (as the issue is occurred from &quot;edge-case&quot;). If we put this to 2.x version line they may have no way to deny.&lt;/p&gt;

&lt;p&gt;Please note that unlike other states having versions which can be co-existed, for stream-stream outer join, there&apos;re only &quot;valid&quot; (state format version = 2) and &quot;invalid&quot; (state format version = 1) state format which cannot be co-existed.&lt;/p&gt;

&lt;p&gt;We cannot still simply drop state format version 1, because stream-stream inner join is not affected by this bug and we don&apos;t want to let the case also discard the state. It will affect too many existing queries and I&apos;d like to reduce the impact.&lt;/p&gt;</comment>
                            <comment id="17023483" author="dongjoon" created="Sat, 25 Jan 2020 09:46:51 +0000"  >&lt;p&gt;Hi, All.&lt;br/&gt;
According to the above decision, I set `Target Version` to `3.0.0` in order to distinguish this from the other correctness issues.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13227226">SPARK-27433</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13200928">SPARK-26187</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 42 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s00sn4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12339177">3.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>