<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:45:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-16425] SparkR summary() fails on column of type logical</title>
                <link>https://issues.apache.org/jira/browse/SPARK-16425</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I created a DataFrame.  I added a logical column to the DataFrame using:&lt;br/&gt;
  sdfAdults &amp;lt;- withColumn(sdfAdults, &quot;IsGT50K&quot;, sdfAdults$gt50==&quot; &amp;lt;=50K&quot;)&lt;br/&gt;
The resulting column was reported using str() as being of type logical, with values TRUE and FALSE.&lt;/p&gt;

&lt;p&gt;I subsequently ran the command:&lt;br/&gt;
   summary(sdfAdults)&lt;br/&gt;
The command failed reporting that the mean could not be calculated on a column of type logical.&lt;/p&gt;

&lt;p&gt;Error in invokeJava(isStatic = FALSE, objId$id, methodName, ...) : &lt;br/&gt;
  org.apache.spark.sql.AnalysisException: cannot resolve &apos;avg(IsGT50K)&apos; due to data type mismatch: function average requires numeric types, not BooleanType;&lt;br/&gt;
	at org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)&lt;br/&gt;
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$2.applyOrElse(CheckAnalysis.scala:65)&lt;br/&gt;
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$2.applyOrElse(CheckAnalysis.scala:57)&lt;br/&gt;
	at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformUp$1.apply(TreeNode.scala:335)&lt;br/&gt;
	at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformUp$1.apply(TreeNode.scala:335)&lt;br/&gt;
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:69)&lt;br/&gt;
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformUp(TreeNode.scala:334)&lt;br/&gt;
	at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$5.apply(TreeNode.scala:332)&lt;br/&gt;
	at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$5.apply(TreeNode.scala:332)&lt;br/&gt;
	at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:281)&lt;br/&gt;
	at scala.collection.Iterator$$anon$11.next(Iterator.scala:328)&lt;br/&gt;
	at scala.collection.Iterator$class.foreach(Iterator.scala:727)&lt;br/&gt;
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1157)&lt;br/&gt;
	at scala.collection.generic.Growable$class.$plus$plus$eq(Growable.scala:48)&lt;br/&gt;
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:103)&lt;br/&gt;
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:47)&lt;br/&gt;
	at scala.collection.TraversableOnce$class.to(TraversableOnce.scala:273)&lt;br/&gt;
	at scala.collection.AbstractIterator.to(Iterator.scala:1157)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Databricks.com&lt;/p&gt;</environment>
        <key id="12987572">SPARK-16425</key>
            <summary>SparkR summary() fails on column of type logical</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dongjoon">Dongjoon Hyun</assignee>
                                    <reporter username="neil@dewar-us.com">Neil Dewar</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Jul 2016 18:33:06 +0000</created>
                <updated>Thu, 14 Jul 2016 16:50:44 +0000</updated>
                            <resolved>Fri, 8 Jul 2016 00:48:02 +0000</resolved>
                                    <version>1.6.1</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>SparkR</component>
                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15366604" author="dongjoon" created="Thu, 7 Jul 2016 19:02:12 +0000"  >&lt;p&gt;Unfortunately, Spark seems to support only numeric types for all languages, Scala/Python/R.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;scala&amp;gt; spark.createDataFrame(Seq((1,2.0,&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;,&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;))).describe().collect().foreach(println)
[count,1,1]
[mean,1.0,2.0]
[stddev,NaN,NaN]
[min,1,2.0]
[max,1,2.0]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15366609" author="dongjoon" created="Thu, 7 Jul 2016 19:03:44 +0000"  >&lt;p&gt;The possible quick fix is preventing the failure by excluding non-numeric types. But, that&apos;s not what you want here, isn&apos;t it?&lt;/p&gt;</comment>
                            <comment id="15366612" author="dongjoon" created="Thu, 7 Jul 2016 19:05:57 +0000"  >&lt;p&gt;In SparkR, `summary` is an alias for `describe(all columns)`.&lt;/p&gt;</comment>
                            <comment id="15366624" author="dongjoon" created="Thu, 7 Jul 2016 19:17:28 +0000"  >&lt;p&gt;Oh, sorry. I&apos;ll comment after more investigation.&lt;/p&gt;</comment>
                            <comment id="15366860" author="dongjoon" created="Thu, 7 Jul 2016 22:05:58 +0000"  >&lt;p&gt;I&apos;ll make a PR to prevent errors first.&lt;/p&gt;</comment>
                            <comment id="15366868" author="apachespark" created="Thu, 7 Jul 2016 22:13:06 +0000"  >&lt;p&gt;User &apos;dongjoon-hyun&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14096&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14096&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15367005" author="neil@dewar-us.com" created="Fri, 8 Jul 2016 00:20:24 +0000"  >&lt;p&gt;Thanks very much.  I wasn&apos;t aware of the limitation on data types in DataFrames.  I think it would be a great outcome if withColumn() was not able to create columns of invalid types.  I can re-write my script to initiate the column with 1 or 0 values.&lt;/p&gt;

&lt;p&gt;If I remember rightly, I have seen withColumn do some other inappropriate things in the past - like creating two columns with the same name.  I will try to find some time to research and log another bug with anything else I find.&lt;/p&gt;

&lt;p&gt;Please let me know if I did anything wrong when I logged this request - it was my first attempt.&lt;/p&gt;
</comment>
                            <comment id="15367014" author="dongjoon" created="Fri, 8 Jul 2016 00:30:46 +0000"  >&lt;p&gt;It is a good issue. You&apos;re good at this if it was your first attempt. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15367028" author="shivaram" created="Fri, 8 Jul 2016 00:48:02 +0000"  >&lt;p&gt;Issue resolved by pull request 14096&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14096&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14096&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15367060" author="neil@dewar-us.com" created="Fri, 8 Jul 2016 01:29:39 +0000"  >&lt;p&gt;Thanks so much Dongjoon.  As someone without the programming skills to contribute to the project, thank you for your contribution - Spark is incredibly valuable!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 19 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30o1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>