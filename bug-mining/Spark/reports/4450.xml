<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:50:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-18971] Netty issue may cause the shuffle client hang</title>
                <link>https://issues.apache.org/jira/browse/SPARK-18971</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Check &lt;a href=&quot;https://github.com/netty/netty/issues/6153&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/netty/netty/issues/6153&lt;/a&gt; for details&lt;/p&gt;

&lt;p&gt;You should be able to see the following similar stack track in the executor thread dump.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;shuffle-client-7-4&quot;&lt;/span&gt; daemon prio=5 tid=97 RUNNABLE
        at io.netty.util.Recycler$Stack.scavengeSome(Recycler.java:504)
        at io.netty.util.Recycler$Stack.scavenge(Recycler.java:454)
        at io.netty.util.Recycler$Stack.pop(Recycler.java:435)
        at io.netty.util.Recycler.get(Recycler.java:144)
        at io.netty.buffer.PooledUnsafeDirectByteBuf.newInstance(PooledUnsafeDirectByteBuf.java:39)
        at io.netty.buffer.PoolArena$DirectArena.newByteBuf(PoolArena.java:727)
        at io.netty.buffer.PoolArena.allocate(PoolArena.java:140)
        at io.netty.buffer.PooledByteBufAllocator.newDirectBuffer(PooledByteBufAllocator.java:271)
        at io.netty.buffer.AbstractByteBufAllocator.directBuffer(AbstractByteBufAllocator.java:177)
        at io.netty.buffer.AbstractByteBufAllocator.directBuffer(AbstractByteBufAllocator.java:168)
        at io.netty.buffer.AbstractByteBufAllocator.ioBuffer(AbstractByteBufAllocator.java:129)
        at io.netty.channel.AdaptiveRecvByteBufAllocator$HandleImpl.allocate(AdaptiveRecvByteBufAllocator.java:104)
        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:117)
        at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:652)
        at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:575)
        at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:489)
        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:451)
        at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:140)
        at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:144)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13029974">SPARK-18971</key>
            <summary>Netty issue may cause the shuffle client hang</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zsxwing">Shixiong Zhu</assignee>
                                    <reporter username="zsxwing">Shixiong Zhu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Dec 2016 02:05:07 +0000</created>
                <updated>Tue, 3 Oct 2017 06:10:02 +0000</updated>
                            <resolved>Sun, 15 Jan 2017 11:15:47 +0000</resolved>
                                                    <fixVersion>2.1.2</fixVersion>
                    <fixVersion>2.1.3</fixVersion>
                    <fixVersion>2.2.0</fixVersion>
                                    <component>Spark Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>14</watches>
                                                                                                                <comments>
                            <comment id="15821707" author="apachespark" created="Fri, 13 Jan 2017 12:14:03 +0000"  >&lt;p&gt;User &apos;zsxwing&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/16568&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/16568&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15823108" author="srowen" created="Sun, 15 Jan 2017 11:15:47 +0000"  >&lt;p&gt;Issue resolved by pull request 16568&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/16568&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/16568&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15946882" author="emlyn" created="Wed, 29 Mar 2017 10:14:41 +0000"  >&lt;p&gt;Will this fix go into Spark 2.1.1?&lt;/p&gt;</comment>
                            <comment id="15956209" author="zsxwing" created="Wed, 5 Apr 2017 02:35:12 +0000"  >&lt;p&gt;It&apos;s not backported because there are two many changes in the new Netty version and it&apos;s too risky to upgrade in a maintenance release.. We may backport it to 2.1 if we don&apos;t see any regression after Spark 2.2.0 is released.&lt;/p&gt;</comment>
                            <comment id="15998531" author="tgraves" created="Fri, 5 May 2017 16:31:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zsxwing&quot; class=&quot;user-hover&quot; rel=&quot;zsxwing&quot;&gt;zsxwing&lt;/a&gt;have you seen any issues with the new netty version?  We have hit this same issue.&lt;/p&gt;</comment>
                            <comment id="15998654" author="zsxwing" created="Fri, 5 May 2017 17:48:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tgraves&quot; class=&quot;user-hover&quot; rel=&quot;tgraves&quot;&gt;tgraves&lt;/a&gt; No, as far as I know. But since Spark 2.2.0 has not yet been released, not sure how many people tested master or branch-2.2.&lt;/p&gt;</comment>
                            <comment id="16082109" author="andreu.urruela" created="Tue, 11 Jul 2017 11:59:37 +0000"  >&lt;p&gt;Hi, we are hitting the same problem in a production system. Is there any workaround for this problem using Spark 2.1.1? Any Netty settings?&lt;/p&gt;</comment>
                            <comment id="16082676" author="zsxwing" created="Tue, 11 Jul 2017 18:10:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andreu.urruela&quot; class=&quot;user-hover&quot; rel=&quot;andreu.urruela&quot;&gt;andreu.urruela&lt;/a&gt; Update Spark to 2.2.0 (not yet announce, but the votes passed and you can get from maven: &lt;a href=&quot;https://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.apache.spark%22&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.apache.spark%22&lt;/a&gt;) or build a special Spark 2.1.1 with the new Netty version by yourself? I don&apos;t know any other workarounds. This Netty issue exists for a long time. However, it&apos;s pretty hard to figure out which change makes Spark easy to hit this issue.&lt;/p&gt;</comment>
                            <comment id="16157113" author="niccolo.becchi" created="Thu, 7 Sep 2017 15:47:35 +0000"  >&lt;p&gt;We are facing the same issue, and we are planning to update to Spark 2.2 but it will take weeks. Does anyone know a way to force Spark 2.1.0 to use the netty-all-4.0.43.Final.jar? The options &quot;spark.executor.userClassPathFirst=true&quot;, &quot;spark.jars.exclude&quot;, &quot;spark.jars.packages&quot; don&apos;t seem to work. Any help will be much appreciated!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13036419">SPARK-19300</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13049586">SPARK-19883</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 10 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37wwv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>