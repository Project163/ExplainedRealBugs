<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:48:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-15153] SparkR spark.naiveBayes throws error when label is numeric type</title>
                <link>https://issues.apache.org/jira/browse/SPARK-15153</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;When the label of dataset is numeric type, SparkR spark.naiveBayes will throw error. This bug is easy to reproduce:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;t &amp;lt;- as.data.frame(Titanic)
t1 &amp;lt;- t[t$Freq &amp;gt; 0, -5]
t1$NumericSurvived &amp;lt;- ifelse(t1$Survived == &lt;span class=&quot;code-quote&quot;&gt;&quot;No&quot;&lt;/span&gt;, 0, 1)
t2 &amp;lt;- t1[-4]
df &amp;lt;- suppressWarnings(createDataFrame(sqlContext, t2))
m &amp;lt;- spark.naiveBayes(df, NumericSurvived ~ .)

16/05/05 03:26:17 ERROR RBackendHandler: fit on org.apache.spark.ml.r.NaiveBayesWrapper failed
Error in invokeJava(isStatic = TRUE, className, methodName, ...) :
  java.lang.ClassCastException: org.apache.spark.ml.attribute.UnresolvedAttribute$ cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.spark.ml.attribute.NominalAttribute
	at org.apache.spark.ml.r.NaiveBayesWrapper$.fit(NaiveBayesWrapper.scala:66)
	at org.apache.spark.ml.r.NaiveBayesWrapper.fit(NaiveBayesWrapper.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.spark.api.r.RBackendHandler.handleMethodCall(RBackendHandler.scala:141)
	at org.apache.spark.api.r.RBackendHandler.channelRead0(RBackendHandler.scala:86)
	at org.apache.spark.api.r.RBackendHandler.channelRead0(RBackendHandler.scala:38)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invo
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In RFormula, the response variable type could be string or numeric. If it&apos;s string, RFormula will transform it to label of DoubleType by StringIndexer and set corresponding column metadata; otherwise, RFormula will directly use it as label when training model (and assumes that it was numbered from 0, ..., maxLabelIndex). &lt;br/&gt;
When we extract labels at ml.r.NaiveBayesWrapper, we should handle it according the type of the response variable (string or numeric).&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mengxr&quot; class=&quot;user-hover&quot; rel=&quot;mengxr&quot;&gt;mengxr&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=josephkb&quot; class=&quot;user-hover&quot; rel=&quot;josephkb&quot;&gt;josephkb&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12965240">SPARK-15153</key>
            <summary>SparkR spark.naiveBayes throws error when label is numeric type</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yanboliang">Yanbo Liang</assignee>
                                    <reporter username="yanboliang">Yanbo Liang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 May 2016 10:32:12 +0000</created>
                <updated>Tue, 11 Oct 2016 19:41:59 +0000</updated>
                            <resolved>Tue, 11 Oct 2016 19:41:59 +0000</resolved>
                                                    <fixVersion>2.1.0</fixVersion>
                                    <component>ML</component>
                    <component>SparkR</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15272175" author="yanboliang" created="Thu, 5 May 2016 10:36:21 +0000"  >&lt;p&gt;In native R, this scenario works well.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;t &amp;lt;- as.data.frame(Titanic)
t1 &amp;lt;- t[t$Freq &amp;gt; 0, -5]
t1$NumericSurvived &amp;lt;- ifelse(t1$Survived == &lt;span class=&quot;code-quote&quot;&gt;&quot;No&quot;&lt;/span&gt;, 0, 1)
t2 &amp;lt;- t1[-4]
m &amp;lt;- naiveBayes(NumericSurvived ~ ., data = t2)
m

Naive Bayes Classifier &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Discrete Predictors

Call:
naiveBayes.&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;(x = X, y = Y, laplace = laplace)

A-priori probabilities:
Y
        0         1 
0.4166667 0.5833333 

Conditional probabilities:
   &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;
Y         1st       2nd       3rd      Crew
  0 0.2000000 0.2000000 0.4000000 0.2000000
  1 0.2857143 0.2857143 0.2857143 0.1428571

   Sex
Y   Male Female
  0  0.5    0.5
  1  0.5    0.5

   Age
Y       Child     Adult
  0 0.2000000 0.8000000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15272199" author="apachespark" created="Thu, 5 May 2016 10:58:03 +0000"  >&lt;p&gt;User &apos;yanboliang&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/12930&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/12930&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15565004" author="apachespark" created="Tue, 11 Oct 2016 09:25:06 +0000"  >&lt;p&gt;User &apos;yanboliang&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15431&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15431&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15566251" author="josephkb" created="Tue, 11 Oct 2016 18:50:48 +0000"  >&lt;p&gt;Note I&apos;m setting the target version for 2.1, not 2.0.x, since the fix requires a public API change in the preceding PR.&lt;/p&gt;</comment>
                            <comment id="15566371" author="josephkb" created="Tue, 11 Oct 2016 19:41:59 +0000"  >&lt;p&gt;Issue resolved by pull request 15431&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/15431&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/15431&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310060">
                    <name>Container</name>
                                                                <inwardlinks description="Is contained by">
                                        <issuelink>
            <issuekey id="12972894">SPARK-15540</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12972484">SPARK-15510</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12904931">SPARK-11107</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12979202">SPARK-15957</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 5 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2x7bb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311620" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Shepherd</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>mengxr</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12335644">2.1.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>