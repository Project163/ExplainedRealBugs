<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:28:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-8093] Spark 1.4 branch&apos;s new JSON schema inference has changed the behavior of handling inner empty JSON object.</title>
                <link>https://issues.apache.org/jira/browse/SPARK-8093</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;This is similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-3365&quot; title=&quot;Failure to save Lists to Parquet&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-3365&quot;&gt;&lt;del&gt;SPARK-3365&lt;/del&gt;&lt;/a&gt;. Sample json is attached. Code to reproduce&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt; jsonDF = read.json(&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/t1.json&quot;&lt;/span&gt;)
jsonDF.write.parquet(&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/t1.parquet&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &apos;integration&apos; object is empty in the json.&lt;br/&gt;
StackTrace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;....
Caused by: java.io.IOException: Could not read footer: java.lang.IllegalStateException: Cannot build an empty group
	at parquet.hadoop.ParquetFileReader.readAllFootersInParallel(ParquetFileReader.java:238)
	at org.apache.spark.sql.parquet.ParquetRelation2$MetadataCache.refresh(newParquet.scala:369)
	at org.apache.spark.sql.parquet.ParquetRelation2.org$apache$spark$sql$parquet$ParquetRelation2$$metadataCache$lzycompute(newParquet.scala:154)
	at org.apache.spark.sql.parquet.ParquetRelation2.org$apache$spark$sql$parquet$ParquetRelation2$$metadataCache(newParquet.scala:152)
	at org.apache.spark.sql.parquet.ParquetRelation2.refresh(newParquet.scala:197)
	at org.apache.spark.sql.sources.InsertIntoHadoopFsRelation.insert(commands.scala:134)
	... 69 more
Caused by: java.lang.IllegalStateException: Cannot build an empty group
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12835260">SPARK-8093</key>
            <summary>Spark 1.4 branch&apos;s new JSON schema inference has changed the behavior of handling inner empty JSON object.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="NathanHowell">Nathan Howell</assignee>
                                    <reporter username="rhbutani">Harish Butani</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Jun 2015 01:04:21 +0000</created>
                <updated>Fri, 19 Jun 2015 23:28:37 +0000</updated>
                            <resolved>Fri, 19 Jun 2015 23:23:47 +0000</resolved>
                                    <version>1.4.0</version>
                                    <fixVersion>1.4.1</fixVersion>
                    <fixVersion>1.5.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14574952" author="yhuai" created="Fri, 5 Jun 2015 18:09:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhbutani&quot; class=&quot;user-hover&quot; rel=&quot;rhbutani&quot;&gt;rhbutani&lt;/a&gt; Is your test based on RC4?&lt;/p&gt;</comment>
                            <comment id="14575013" author="rhbutani" created="Fri, 5 Jun 2015 18:53:40 +0000"  >&lt;p&gt;yes&lt;/p&gt;</comment>
                            <comment id="14575023" author="yhuai" created="Fri, 5 Jun 2015 18:57:56 +0000"  >&lt;p&gt;When you get time, can you try it with master? We just bumped the parquet to 1.7. I am wondering if the logic of ParquetFileReader.readAllFootersInParallel has been changed to handle it or now.&lt;/p&gt;</comment>
                            <comment id="14575424" author="rhbutani" created="Fri, 5 Jun 2015 23:55:55 +0000"  >&lt;p&gt;I get the same error with master&lt;/p&gt;</comment>
                            <comment id="14575590" author="yhuai" created="Sat, 6 Jun 2015 05:01:06 +0000"  >&lt;p&gt;Seems the new JSON type infer code has a behavior change.&lt;br/&gt;
For the following command,&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;val df = sqlContext.jsonRDD(sc.parallelize(&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;&quot;{&quot;&lt;/span&gt;a&lt;span class=&quot;code-quote&quot;&gt;&quot;:{}, &quot;&lt;/span&gt;b&lt;span class=&quot;code-quote&quot;&gt;&quot;:1}&quot;&lt;/span&gt;&quot;&quot; :: Nil))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Spark 1.3 returns&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;df: org.apache.spark.sql.DataFrame = [b: bigint]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But Spark 1.4 returns&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;df: org.apache.spark.sql.DataFrame = [a: struct&amp;lt;&amp;gt;, b: bigint]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14575592" author="yhuai" created="Sat, 6 Jun 2015 05:06:57 +0000"  >&lt;p&gt;For now, to keep the same behavior with 1.3, the workaround is to set &quot;spark.sql.json.useJacksonStreamingAPI&quot; to false (use the old code path).&lt;/p&gt;</comment>
                            <comment id="14584739" author="apachespark" created="Sat, 13 Jun 2015 17:53:03 +0000"  >&lt;p&gt;User &apos;NathanHowell&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/6799&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/6799&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14594093" author="yhuai" created="Fri, 19 Jun 2015 23:23:47 +0000"  >&lt;p&gt;Issue resolved by pull request 6799&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/6799&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/6799&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14594097" author="yhuai" created="Fri, 19 Jun 2015 23:28:37 +0000"  >&lt;p&gt;With &lt;a href=&quot;https://github.com/apache/spark/pull/6799&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/6799&lt;/a&gt;, we have changed the behavior back to Spark 1.3&apos;s behavior. Empty inner structs will not be in the schema. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12737427" name="t1.json" size="1103" author="rhbutani" created="Thu, 4 Jun 2015 01:04:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 22 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2flz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311620" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Shepherd</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>yhuai</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12332153">1.4.1</customfieldvalue>
    <customfieldvalue id="12332078">1.5.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>