<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:51:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-19496] to_date with format has weird behavior</title>
                <link>https://issues.apache.org/jira/browse/SPARK-19496</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Today, if we run&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2015-07-22&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;yyyy-dd-MM&apos;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;will result to `2016-10-07`, while running&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-31-12&apos;&lt;/span&gt;)   # &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; format
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;will return null.&lt;/p&gt;

&lt;p&gt;this behavior is weird and we should check other systems like hive to see if this is expected.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13041006">SPARK-19496</key>
            <summary>to_date with format has weird behavior</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="windpiger">Song Jun</assignee>
                                    <reporter username="cloud_fan">Wenchen Fan</reporter>
                        <labels>
                            <label>release-notes</label>
                    </labels>
                <created>Tue, 7 Feb 2017 15:22:51 +0000</created>
                <updated>Mon, 12 Dec 2022 18:11:07 +0000</updated>
                            <resolved>Mon, 13 Feb 2017 11:26:15 +0000</resolved>
                                    <version>2.1.0</version>
                                    <fixVersion>2.2.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15856205" author="windpiger" created="Tue, 7 Feb 2017 15:33:17 +0000"  >&lt;p&gt;I am working on this~&lt;/p&gt;</comment>
                            <comment id="15857459" author="gurwls223" created="Wed, 8 Feb 2017 05:55:40 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Hive&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-31-12&apos;&lt;/span&gt;);
2016-07-12
...

hive&amp;gt; SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-12-32&apos;&lt;/span&gt;);
2015-01-01
...

hive&amp;gt; SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-12-31&apos;&lt;/span&gt;);
2014-12-31
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2015-07-22&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;yyyy-dd-MM&apos;&lt;/span&gt;)
org.apache.hadoop.hive.ql.parse.SemanticException: Line 1:7 Arguments length mismatch &lt;span class=&quot;code-quote&quot;&gt;&apos;&apos;yyyy-dd-MM&apos;&lt;/span&gt;&apos;: to_date() requires 1 argument, got 2
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Postgres&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;postgres=# SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-12-31&apos;&lt;/span&gt;);
ERROR:  function to_date(unknown) does not exist
LINE 1: SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-12-31&apos;&lt;/span&gt;);
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;postgres=# SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-12-31&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;yyyy-MM-dd&apos;&lt;/span&gt;);
  to_date
------------
 2014-12-31
(1 row)

postgres=# SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-13-31&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;yyyy-MM-dd&apos;&lt;/span&gt;);
  to_date
------------
 2015-01-31
(1 row)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Spark&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;spark-sql&amp;gt; SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-31-12&apos;&lt;/span&gt;);
NULL
...

spark-sql&amp;gt; SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-12-32&apos;&lt;/span&gt;);
NULL
...

spark-sql&amp;gt; SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-12-31&apos;&lt;/span&gt;);
2014-12-31
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;spark-sql&amp;gt; SELECT to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2015-07-22&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;yyyy-dd-MM&apos;&lt;/span&gt;)
2016-10-07
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MySQL&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;mysql&amp;gt; SELECT str_to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-12-31&apos;&lt;/span&gt;);
ERROR 1582 (42000): Incorrect parameter count in the call to &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt; function &lt;span class=&quot;code-quote&quot;&gt;&apos;str_to_date&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;mysql&amp;gt; SELECT str_to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-12-31&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;%Y-%m-%d&apos;&lt;/span&gt;);
+---------------------------------------+
| str_to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-12-31&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;%Y-%m-%d&apos;&lt;/span&gt;) |
+---------------------------------------+
| 2014-12-31                            |
+---------------------------------------+
1 row in set (0.00 sec)

mysql&amp;gt; SELECT str_to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-13-31&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;%Y-%m-%d&apos;&lt;/span&gt;);
+---------------------------------------+
| str_to_date(&lt;span class=&quot;code-quote&quot;&gt;&apos;2014-13-31&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;%Y-%m-%d&apos;&lt;/span&gt;) |
+---------------------------------------+
| NULL                                  |
+---------------------------------------+
1 row in set, 1 warning (0.00 sec)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;MySQL/SparkSQL - it seems returning &lt;tt&gt;NULL&lt;/tt&gt;. MySQL seems not supporting omitting the format.&lt;/p&gt;

&lt;p&gt;Hive/Postgres - it seems returning calculated dates. Hive seems not supporting the format. Postgres seems not supporting omitting the format.&lt;/p&gt;</comment>
                            <comment id="15857464" author="cloud_fan" created="Wed, 8 Feb 2017 06:03:05 +0000"  >&lt;p&gt;The weird part is, Spark may have different behaviors depend on if the format is given. I think we should make it consistent, always return null or return calculated dates.&lt;/p&gt;</comment>
                            <comment id="15857473" author="gurwls223" created="Wed, 8 Feb 2017 06:12:42 +0000"  >&lt;p&gt;Oh, yes. I just found and updated my comment.&lt;/p&gt;</comment>
                            <comment id="15857541" author="windpiger" created="Wed, 8 Feb 2017 07:07:43 +0000"  >&lt;p&gt;mysql: select str_to_date(&apos;2014-12-31&apos;,&apos;%Y-%d-%m&apos;)   also return null&lt;/p&gt;

&lt;p&gt;that is mysql both return null when the date is invalidate or the formate is invalidate.&lt;/p&gt;

&lt;p&gt;and hive will transform the invalidate  date to  valid, e.g 2014-31-12 -&amp;gt; 31/12 = 2 -&amp;gt; 2014+2=2016&lt;br/&gt;
, 31 - 12*2=7 -&amp;gt; 2016-07-12&lt;/p&gt;

&lt;p&gt;currently spark can handle wrong format / wrong date  when to_date has the format parameter (like hive&apos;s transform), what about we also make to_date without format parameter follow its action, that is replace null with a transformed date to return&lt;/p&gt;</comment>
                            <comment id="15857554" author="gurwls223" created="Wed, 8 Feb 2017 07:15:27 +0000"  >&lt;p&gt;Yea, thank you for explanation. I was just curious so tested some cases and left it above to share it just in case for people like me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="15857561" author="cloud_fan" created="Wed, 8 Feb 2017 07:17:19 +0000"  >&lt;p&gt;returning null looks better, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smilegator&quot; class=&quot;user-hover&quot; rel=&quot;smilegator&quot;&gt;smilegator&lt;/a&gt; what do you think?&lt;/p&gt;</comment>
                            <comment id="15857570" author="windpiger" created="Wed, 8 Feb 2017 07:20:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt;  &#128513;&lt;/p&gt;</comment>
                            <comment id="15859091" author="smilegator" created="Thu, 9 Feb 2017 06:20:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cloud_fan&quot; class=&quot;user-hover&quot; rel=&quot;cloud_fan&quot;&gt;cloud_fan&lt;/a&gt; Yeah, null looks better. Illegal inputs should not be silently accepted and converted.&lt;/p&gt;</comment>
                            <comment id="15859286" author="apachespark" created="Thu, 9 Feb 2017 10:06:04 +0000"  >&lt;p&gt;User &apos;windpiger&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/16870&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/16870&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15939508" author="joshrosen" created="Fri, 24 Mar 2017 00:55:23 +0000"  >&lt;p&gt;Let&apos;s make sure to document this clearly in the release notes. I just spent a bunch of time debugging what turned out to be an invalid pattern which happened to work by accident before but now is returning &lt;tt&gt;null&lt;/tt&gt;. Adding this to the release notes may save some pain when folks upgrade. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 34 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i39q7b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>