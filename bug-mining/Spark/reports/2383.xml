<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:31:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-10251] Some internal spark classes are not registered with kryo</title>
                <link>https://issues.apache.org/jira/browse/SPARK-10251</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;When running a job using kryo serialization and setting `spark.kryo.registrationRequired=true` some internal classes are not registered, causing the job to die. This is still a problem when this setting is false (which is the default) because it makes the space required to store serialized objects in memory or disk much much more expensive in terms of runtime and storage space.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;15/08/25 20:28:21 WARN spark.scheduler.TaskSetManager: Lost task 0.0 in stage 0.0 (TID 0, a.b.c.d): java.lang.IllegalArgumentException: &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; is not registered: scala.Tuple2[]
Note: To register &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;use: kryo.register(scala.Tuple2[].class);
        at com.esotericsoftware.kryo.Kryo.getRegistration(Kryo.java:442)
        at com.esotericsoftware.kryo.util.DefaultClassResolver.writeClass(DefaultClassResolver.java:79)
        at com.esotericsoftware.kryo.Kryo.writeClass(Kryo.java:472)
        at com.esotericsoftware.kryo.Kryo.writeClassAndObject(Kryo.java:565)
        at org.apache.spark.serializer.KryoSerializerInstance.serialize(KryoSerializer.scala:250)
        at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:236)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12858802">SPARK-10251</key>
            <summary>Some internal spark classes are not registered with kryo</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rams">Ram Sriharsha</assignee>
                                    <reporter username="sorenmacbeth">Soren Macbeth</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Aug 2015 00:49:32 +0000</created>
                <updated>Thu, 28 Jan 2016 18:45:35 +0000</updated>
                            <resolved>Thu, 27 Aug 2015 06:13:01 +0000</resolved>
                                    <version>1.4.1</version>
                                    <fixVersion>1.6.0</fixVersion>
                                    <component>Spark Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="14712586" author="rxin" created="Wed, 26 Aug 2015 06:29:16 +0000"  >&lt;p&gt;Confirming the problem. We can also reproduce this in unit test by changing KryoSerializerSuite&apos;s Scala data structures test case.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  test(&lt;span class=&quot;code-quote&quot;&gt;&quot;Scala data structures&quot;&lt;/span&gt;) {
    val ser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; KryoSerializer(conf.clone.set(&lt;span class=&quot;code-quote&quot;&gt;&quot;spark.kryo.registrationRequired&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;)).newInstance()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We should&apos;ve registered all of these since we are using Chill. Something is wrong somewhere. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rams&quot; class=&quot;user-hover&quot; rel=&quot;rams&quot;&gt;rams&lt;/a&gt; is going to take a look at this.&lt;/p&gt;</comment>
                            <comment id="14714161" author="rams" created="Wed, 26 Aug 2015 15:30:51 +0000"  >&lt;p&gt;as far as I can see, this happens from spark 1.2 onward. haven&apos;t gone back yet to see if this was present before spark 1.2&lt;br/&gt;
a temporary workaround is to register the necessary classes manually by setting the following conf property:&lt;br/&gt;
--conf &quot;spark.kryo.classesToRegister = [Lscala.Tuple2;&quot;&lt;/p&gt;

&lt;p&gt;I&apos;m looking into a better solution now: one option is to automatically register such classes (i.e. arrays of tuples, lists of tuples, None, etc)&lt;/p&gt;</comment>
                            <comment id="14714474" author="apachespark" created="Wed, 26 Aug 2015 16:34:02 +0000"  >&lt;p&gt;User &apos;harsha2010&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/8465&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/8465&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14738390" author="msoutier" created="Thu, 10 Sep 2015 08:25:11 +0000"  >&lt;p&gt;Any chance for a backport to 1.4.2?&lt;/p&gt;</comment>
                            <comment id="14738396" author="rxin" created="Thu, 10 Sep 2015 08:28:35 +0000"  >&lt;p&gt;I think that&apos;s possible &amp;#8211; do you want to submit a patch?&lt;/p&gt;</comment>
                            <comment id="14739367" author="joshrosen" created="Thu, 10 Sep 2015 18:57:06 +0000"  >&lt;p&gt;I don&apos;t think that we properly test Spark with registrationRequired, so people are always finding missing classes. The right way to detect and prevent these problems is to run all of Spark&apos;s tests with Kryo registration enabled. Given that requiring registration is strictly stronger than not requiring it, I&apos;m wondering if we should always turn it on by default for all of our tests; this shouldn&apos;t risk regression for the non-required case, AFAIK.&lt;/p&gt;</comment>
                            <comment id="14739770" author="rxin" created="Thu, 10 Sep 2015 22:42:37 +0000"  >&lt;p&gt;we should have one test suite for that &amp;#8211; just run some basic stuff with Kryo. I don&apos;t think we should run the entire Spark program with that, because that takes a long time ...&lt;/p&gt;</comment>
                            <comment id="14739781" author="joshrosen" created="Thu, 10 Sep 2015 22:49:23 +0000"  >&lt;p&gt;Just to be clear, my suggestion was that we change the defaults (via system properties) for all of our tests, such that our existing tests exercise the registration-required codepath. I was &lt;b&gt;not&lt;/b&gt; proposing to run those tests twice, once with registration required and once without.&lt;/p&gt;</comment>
                            <comment id="14739784" author="rxin" created="Thu, 10 Sep 2015 22:51:18 +0000"  >&lt;p&gt;But the tests by default run Java serialization, not Kryo?&lt;/p&gt;</comment>
                            <comment id="14739788" author="joshrosen" created="Thu, 10 Sep 2015 22:52:31 +0000"  >&lt;p&gt;Ah, right; forgot about that.&lt;/p&gt;</comment>
                            <comment id="14741639" author="glenn.strycker@gmail.com" created="Fri, 11 Sep 2015 22:29:21 +0000"  >&lt;p&gt;I opened a ticket earlier today that might be related to this one:  &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-10569&quot; title=&quot;Kryo serialization fails on sortByKey operation on registered RDDs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-10569&quot;&gt;&lt;del&gt;SPARK-10569&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If so, I&apos;ll close it once this one is re-opened.&lt;/p&gt;</comment>
                            <comment id="15122076" author="zsxwing" created="Thu, 28 Jan 2016 18:45:35 +0000"  >&lt;p&gt;Current KryoSerializer doesn&apos;t provide an approach for other projects (e.g. Streaming) registering their classes (e.g. OpenHashMapBasedStateMap introduced in 1.6). So spark.kryo.registrationRequired cannot be enabled in a Streaming app.&lt;/p&gt;

&lt;p&gt;Maybe we should add some internal configuration for that?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12785143">SPARK-6497</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jddz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311620" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Shepherd</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>rxin</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>