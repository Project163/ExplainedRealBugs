<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:31:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-10162] PySpark filters with datetimes mess up when datetimes have timezones.</title>
                <link>https://issues.apache.org/jira/browse/SPARK-10162</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;PySpark appears to ignore timezone information when filtering on (and working in general with) datetimes.&lt;/p&gt;

&lt;p&gt;Please see the example below. The generated filter in the query plan is 5 hours off (my computer is EST).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;In [1]: df = sc.sql.createDataFrame([], StructType([StructField(&lt;span class=&quot;code-quote&quot;&gt;&quot;dt&quot;&lt;/span&gt;, TimestampType())]))

In [2]: df.filter(df.dt &amp;gt; datetime(2000, 01, 01, tzinfo=UTC)).explain()
Filter (dt#9 &amp;gt; 946702800000000)
 Scan PhysicalRDD[dt#9]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that 946702800000000 == Sat  1 Jan 2000 05:00:00 UTC&lt;/p&gt;</description>
                <environment></environment>
        <key id="12857979">SPARK-10162</key>
            <summary>PySpark filters with datetimes mess up when datetimes have timezones.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="0x0fff">Alexey Grishchenko</assignee>
                                    <reporter username="kevincox">Kevin Cox</reporter>
                        <labels>
                    </labels>
                <created>Fri, 21 Aug 2015 21:55:44 +0000</created>
                <updated>Wed, 2 Sep 2015 12:32:50 +0000</updated>
                            <resolved>Tue, 1 Sep 2015 21:58:37 +0000</resolved>
                                                    <fixVersion>1.6.0</fixVersion>
                                    <component>PySpark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14707526" author="kevincox" created="Fri, 21 Aug 2015 22:05:08 +0000"  >&lt;p&gt;This is probably because the filter argument is never passed though &lt;tt&gt;TimestampType.toInternal()&lt;/tt&gt; (which I have monkey patched to handle timezones properly)&lt;/p&gt;</comment>
                            <comment id="14723356" author="apachespark" created="Mon, 31 Aug 2015 12:27:05 +0000"  >&lt;p&gt;User &apos;0x0FFF&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/8536&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/8536&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14725329" author="apachespark" created="Tue, 1 Sep 2015 12:39:02 +0000"  >&lt;p&gt;User &apos;0x0FFF&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/8555&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/8555&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14726280" author="davies" created="Tue, 1 Sep 2015 21:58:37 +0000"  >&lt;p&gt;Issue resolved by pull request 8555&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/8555&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/8555&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 11 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2j8e7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>