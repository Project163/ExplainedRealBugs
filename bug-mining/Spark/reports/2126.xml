<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:29:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-8908] Calling distinct() with parentheses throws error in Scala DataFrame</title>
                <link>https://issues.apache.org/jira/browse/SPARK-8908</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;To reproduce, please call &lt;tt&gt;distinct()&lt;/tt&gt; on DataFrame in spark-shell. For eg,&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;scala&amp;gt; sqlContext.table(&lt;span class=&quot;code-quote&quot;&gt;&quot;my_table&quot;&lt;/span&gt;).distinct()

&amp;lt;console&amp;gt;:19: error: not enough arguments &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; method apply: (colName: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;)org.apache.spark.sql.Column in &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;DataFrame.
Unspecified value parameter colName.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is confusing because &lt;tt&gt;distinct&lt;/tt&gt; in DataFrame is an alias of &lt;tt&gt;dropDuplicates&lt;/tt&gt;, and both &lt;tt&gt;dropDuplicates&lt;/tt&gt; and &lt;tt&gt;dropDuplicates()&lt;/tt&gt; work.&lt;/p&gt;

&lt;p&gt;Here is the summary-&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Scala code&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Works&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;DF.distinct&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Y&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;DF.distinct()&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;N&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;DF.dropDuplicates&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Y&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;DF.dropDuplicates()&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Y&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Looking at the definition of &lt;tt&gt;distinct&lt;/tt&gt;, it&apos;s missing &lt;tt&gt;()&lt;/tt&gt;-&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;override def distinct: DataFrame = dropDuplicates()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As a result, what seems happening is as follows-&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;distinct()
=&amp;gt; dropDuplicates()()
=&amp;gt; DataFrame() &lt;span class=&quot;code-comment&quot;&gt;// because dropDuplicates() returns DF
&lt;/span&gt;=&amp;gt; DataFrame.apply() &lt;span class=&quot;code-comment&quot;&gt;// fails because apply() takes a column parameter&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I can verify that adding &lt;tt&gt;()&lt;/tt&gt; to the definition makes both &lt;tt&gt;distinct&lt;/tt&gt; and &lt;tt&gt;distinct()&lt;/tt&gt; work.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12843628">SPARK-8908</key>
            <summary>Calling distinct() with parentheses throws error in Scala DataFrame</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cheolsoo">Cheolsoo Park</assignee>
                                    <reporter username="cheolsoo">Cheolsoo Park</reporter>
                        <labels>
                            <label>releasenotes</label>
                    </labels>
                <created>Wed, 8 Jul 2015 20:22:39 +0000</created>
                <updated>Wed, 8 Jul 2015 22:21:26 +0000</updated>
                            <resolved>Wed, 8 Jul 2015 22:18:57 +0000</resolved>
                                    <version>1.4.0</version>
                    <version>1.5.0</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14619298" author="apachespark" created="Wed, 8 Jul 2015 20:28:02 +0000"  >&lt;p&gt;User &apos;piaozhexiu&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7298&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7298&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 19 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2h0gv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>