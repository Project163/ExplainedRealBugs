<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:32:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-8951] support CJK characters in collect()</title>
                <link>https://issues.apache.org/jira/browse/SPARK-8951</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Spark gives an error message and does not show the output when a field of the result DataFrame contains characters in CJK.&lt;br/&gt;
I found out that SerDe in R API only supports ASCII format for strings right now as commented in source code.  &lt;br/&gt;
So, I fixed SerDe.scala a little to support CJK as the file attached. &lt;br/&gt;
I did not care efficiency, but just wanted to see if it works.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;people.json
{&quot;name&quot;:&quot;&#44032;&#45208;&quot;}
{&quot;name&quot;:&quot;&#53580;&#49828;&#53944;123&quot;, &quot;age&quot;:30}
{&quot;name&quot;:&quot;Justin&quot;, &quot;age&quot;:19}

df &amp;lt;- read.df(sqlContext, &quot;./people.json&quot;, &quot;json&quot;)
head(df)

Error in rawtochar(string) : embedded nul in string : &apos;\0 \x98&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;core/src/main/scala/org/apache/spark/api/r/SerDe.scala&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-comment&quot;&gt;// NOTE: Only works &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ASCII right now
&lt;/span&gt;  def writeString(out: DataOutputStream, value: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;): Unit = {
    val len = value.length
    out.writeInt(len + 1) &lt;span class=&quot;code-comment&quot;&gt;// For the \0
&lt;/span&gt;    out.writeBytes(value)
    out.writeByte(0)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12843800">SPARK-8951</key>
            <summary>support CJK characters in collect()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jaehong.choi">Jaehong Choi</assignee>
                                    <reporter username="jaehong.choi">Jaehong Choi</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Jul 2015 08:27:57 +0000</created>
                <updated>Fri, 4 Sep 2015 17:52:59 +0000</updated>
                            <resolved>Thu, 3 Sep 2015 20:38:41 +0000</resolved>
                                                    <fixVersion>1.6.0</fixVersion>
                                    <component>SparkR</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14620216" author="srowen" created="Thu, 9 Jul 2015 09:49:12 +0000"  >&lt;p&gt;Please first read &lt;a href=&quot;https://cwiki.apache.org/confluence/display/SPARK/Contributing+to+Spark&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/SPARK/Contributing+to+Spark&lt;/a&gt;&lt;br/&gt;
We don&apos;t manage changes via patches, but by pull requests. Also, don&apos;t set target version.&lt;/p&gt;

&lt;p&gt;This won&apos;t be specific to CJK right? you are talking about supporting Unicode.&lt;br/&gt;
Why introduce a null terminator? just write the length of the byte encoding in UTF-8 and send UTF-8 bytes.&lt;/p&gt;</comment>
                            <comment id="14620809" author="shivaram" created="Thu, 9 Jul 2015 16:36:32 +0000"  >&lt;p&gt;Yeah the right solution here is to use UTF-8 for serialization and deserialization. We already do this in the readStringBytes function &lt;a href=&quot;https://github.com/apache/spark/blob/a1964e9d902bb31f001893da8bc81f6dce08c908/core/src/main/scala/org/apache/spark/api/r/SerDe.scala#L92&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/a1964e9d902bb31f001893da8bc81f6dce08c908/core/src/main/scala/org/apache/spark/api/r/SerDe.scala#L92&lt;/a&gt; but the `writeString` needs to be fixed. Feel free to open a PR for this as specified in the contribution guide.&lt;/p&gt;</comment>
                            <comment id="14621834" author="jaehong.choi" created="Fri, 10 Jul 2015 06:45:26 +0000"  >&lt;p&gt;Thanks for your advice.&lt;br/&gt;
You&apos;re right. This is about supporting Unicode indeed. I&apos;ll open a PR for this issue. &lt;br/&gt;
I didn&apos;t think about the null terminator much. I am going to figure it out as well. &lt;/p&gt;</comment>
                            <comment id="14632408" author="apachespark" created="Sat, 18 Jul 2015 12:09:08 +0000"  >&lt;p&gt;User &apos;CHOIJAEHONG1&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7494&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7494&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14729742" author="shivaram" created="Thu, 3 Sep 2015 20:38:41 +0000"  >&lt;p&gt;Issue resolved by pull request 7494&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7494&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7494&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14731140" author="jihongma" created="Fri, 4 Sep 2015 17:45:08 +0000"  >&lt;p&gt;This commit cause R style check failure. &lt;/p&gt;

&lt;p&gt;========================================================================&lt;br/&gt;
Running R style checks&lt;br/&gt;
========================================================================&lt;br/&gt;
Loading required package: methods&lt;/p&gt;

&lt;p&gt;Attaching package: &apos;SparkR&apos;&lt;/p&gt;

&lt;p&gt;The following objects are masked from &apos;package:stats&apos;:&lt;/p&gt;

&lt;p&gt;    filter, na.omit&lt;/p&gt;

&lt;p&gt;The following objects are masked from &apos;package:base&apos;:&lt;/p&gt;

&lt;p&gt;    intersect, rbind, sample, subset, summary, table, transform&lt;/p&gt;


&lt;p&gt;Attaching package: &apos;testthat&apos;&lt;/p&gt;

&lt;p&gt;The following object is masked from &apos;package:SparkR&apos;:&lt;/p&gt;

&lt;p&gt;    describe&lt;/p&gt;

&lt;p&gt;R/deserialize.R:63:9: style: Trailing whitespace is superfluous.&lt;br/&gt;
  string &lt;br/&gt;
        ^&lt;br/&gt;
lintr checks failed.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;error&amp;#93;&lt;/span&gt; running /home/jenkins/workspace/SparkPullRequestBuilder/dev/lint-r ; received return code 1&lt;br/&gt;
Archiving unit tests logs...&lt;br/&gt;
&amp;gt; No log files found.&lt;br/&gt;
Attempting to post to Github...&lt;br/&gt;
 &amp;gt; Post successful.&lt;br/&gt;
Build step &apos;Execute shell&apos; marked build as failure&lt;br/&gt;
Archiving artifacts&lt;br/&gt;
Recording test results&lt;br/&gt;
ERROR: Publisher &apos;Publish JUnit test result report&apos; failed: No test report files were found. Configuration error?&lt;br/&gt;
Test FAILed.&lt;br/&gt;
Refer to this link for build results (access rights to CI server needed): &lt;/p&gt;</comment>
                            <comment id="14731151" author="shivaram" created="Fri, 4 Sep 2015 17:49:38 +0000"  >&lt;p&gt;Ah I should have retested this before merging - I&apos;ll send a PR to fix this now&lt;/p&gt;</comment>
                            <comment id="14731155" author="shivaram" created="Fri, 4 Sep 2015 17:52:59 +0000"  >&lt;p&gt;Sent &lt;a href=&quot;https://github.com/apache/spark/pull/8601&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/8601&lt;/a&gt; to fix this&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12744450" name="SerDe.scala.diff" size="258" author="jaehong.choi" created="Thu, 9 Jul 2015 08:45:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 11 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2h1hz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>