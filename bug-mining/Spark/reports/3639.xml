<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:44:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-6320] Adding new query plan strategy to SQLContext</title>
                <link>https://issues.apache.org/jira/browse/SPARK-6320</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I would like to add a new strategy to &lt;tt&gt;SQLContext&lt;/tt&gt;. To do this I created a new class which extends &lt;tt&gt;Strategy&lt;/tt&gt;. In my new class I need to call &lt;tt&gt;planLater&lt;/tt&gt; function. However this method is defined in &lt;tt&gt;SparkPlanner&lt;/tt&gt; (which itself inherits the method from &lt;tt&gt;QueryPlanner&lt;/tt&gt;).&lt;/p&gt;

&lt;p&gt;To my knowledge the only way to make &lt;tt&gt;planLater&lt;/tt&gt; function visible to my new strategy is to define my strategy inside another class that extends &lt;tt&gt;SparkPlanner&lt;/tt&gt; and inherits &lt;tt&gt;planLater&lt;/tt&gt; as a result, by doing so I will have to extend the &lt;tt&gt;SQLContext&lt;/tt&gt; such that I can override the &lt;tt&gt;planner&lt;/tt&gt; field with the new &lt;tt&gt;Planner&lt;/tt&gt; class I created.&lt;/p&gt;

&lt;p&gt;It seems that this is a design problem because adding a new strategy seems to require extending &lt;tt&gt;SQLContext&lt;/tt&gt; (unless I am doing it wrong and there is a better way to do it).&lt;/p&gt;

&lt;p&gt;Thanks a lot,&lt;br/&gt;
Youssef&lt;/p&gt;</description>
                <environment></environment>
        <key id="12781798">SPARK-6320</key>
            <summary>Adding new query plan strategy to SQLContext</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ueshin">Takuya Ueshin</assignee>
                                    <reporter username="HatY">Youssef Hatem</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Mar 2015 13:03:31 +0000</created>
                <updated>Mon, 13 Jun 2016 08:53:09 +0000</updated>
                            <resolved>Fri, 10 Jun 2016 20:08:08 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14364345" author="marmbrus" created="Tue, 17 Mar 2015 01:05:51 +0000"  >&lt;p&gt;Hmm, interesting.  So far I had only considered this interface for planning leaves of the query plan.  Can you tell me more about what you are trying to optimize?&lt;/p&gt;</comment>
                            <comment id="14365274" author="haty" created="Tue, 17 Mar 2015 15:09:54 +0000"  >&lt;p&gt;Thank you Michael for your response,&lt;/p&gt;

&lt;p&gt;Actually I am trying to extend SQL syntax with custom constructs which would require altering the workflow of &lt;tt&gt;SparkSQL&lt;/tt&gt; all the way starting from the lexer and ending with the optimization and physical planning.&lt;/p&gt;

&lt;p&gt;I thought this should be possible without having to extend many classes. However not being able to use &lt;tt&gt;planLater&lt;/tt&gt; forces me to do seemingly unnecessary extension of &lt;tt&gt;SparkPlanner&lt;/tt&gt; specially that there seem to be some logic to handle these scenarios (i.e. the &lt;tt&gt;extraStrategies&lt;/tt&gt; sequence).&lt;/p&gt;</comment>
                            <comment id="14368683" author="smolav" created="Thu, 19 Mar 2015 08:12:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marmbrus&quot; class=&quot;user-hover&quot; rel=&quot;marmbrus&quot;&gt;marmbrus&lt;/a&gt; We could change strategies so that they take a SparkPlanner in their constructor. This should provide enough flexibility for &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=H.Youssef&quot; class=&quot;user-hover&quot; rel=&quot;H.Youssef&quot;&gt;H.Youssef&lt;/a&gt;&apos;s use case and might improve code organization of the core strategies in the future.&lt;/p&gt;</comment>
                            <comment id="14376434" author="marmbrus" created="Mon, 23 Mar 2015 19:20:34 +0000"  >&lt;p&gt;If that can be done in a minimally invasive way that sounds reasonable to me.&lt;/p&gt;</comment>
                            <comment id="14499542" author="evacchi" created="Fri, 17 Apr 2015 09:37:02 +0000"  >&lt;p&gt;My use case is customizing strategies so that operations can be pruned/rewritten, depending on metadata in a custom catalog. For instance, consider the case of a DataFrame where a column X is known to be non-nullable; if the query contains the filter &lt;tt&gt;where(&apos;x is not null)&lt;/tt&gt; the filter can be pruned with a rule of the form:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; logical.Filter(IsNotNull(e: NamedExpression), child)
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; customCatalog.isNonNull(e) =&amp;gt; {
          planLater(child) :: Nil
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I wonder why is &lt;tt&gt;SparkPlanner&lt;/tt&gt; nested inside &lt;tt&gt;SQLContext&lt;/tt&gt;. Cass &lt;tt&gt;SparkPlanner&lt;/tt&gt; may require the &lt;tt&gt;SQLContext&lt;/tt&gt;, &lt;tt&gt;SQLConf&lt;/tt&gt; as constructor parameters and be defined in its own class (and the same could be said for QueryExecution).  suggestion would be to refactor out &lt;tt&gt;SparkPlanner&lt;/tt&gt;. Advanced users would then be able to extend it like any other class.&lt;/p&gt;

&lt;p&gt;I have opened &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-6981&quot; title=&quot;[SQL] SparkPlanner and QueryExecution should be factored out from SQLContext&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-6981&quot;&gt;&lt;del&gt;SPARK-6981&lt;/del&gt;&lt;/a&gt; and a PR to address this issue&lt;/p&gt;</comment>
                            <comment id="15286339" author="apachespark" created="Tue, 17 May 2016 10:02:03 +0000"  >&lt;p&gt;User &apos;ueshin&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/13147&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/13147&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15308824" author="apachespark" created="Tue, 31 May 2016 23:09:03 +0000"  >&lt;p&gt;User &apos;ueshin&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/13426&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/13426&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15325200" author="marmbrus" created="Fri, 10 Jun 2016 20:08:08 +0000"  >&lt;p&gt;Issue resolved by pull request 13147&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/13147&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/13147&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12821882">SPARK-6981</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 23 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i26qlj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>