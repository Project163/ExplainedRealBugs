<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:02:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-25461] PySpark Pandas UDF outputs incorrect results when input columns contain None</title>
                <link>https://issues.apache.org/jira/browse/SPARK-25461</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;The following PySpark script uses a simple pandas UDF to calculate a column given column &apos;A&apos;. When column &apos;A&apos; contains None, the results look incorrect.&lt;/p&gt;

&lt;p&gt;Script:&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; pandas as pd
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; random
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; pyspark
from pyspark.sql.functions &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; col, lit, pandas_udf

values = [None] * 30000 + [1.0] * 170000 + [2.0] * 6000000
random.shuffle(values)
pdf = pd.DataFrame({&lt;span class=&quot;code-quote&quot;&gt;&apos;A&apos;&lt;/span&gt;: values})
df = spark.createDataFrame(pdf)

@pandas_udf(returnType=pyspark.sql.types.BooleanType())
def gt_2(column):
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (column &amp;gt;= 2).where(column.notnull())

calculated_df = (df.select([&lt;span class=&quot;code-quote&quot;&gt;&apos;A&apos;&lt;/span&gt;])
    .withColumn(&lt;span class=&quot;code-quote&quot;&gt;&apos;potential_bad_col&apos;&lt;/span&gt;, gt_2(&lt;span class=&quot;code-quote&quot;&gt;&apos;A&apos;&lt;/span&gt;))
)

calculated_df = calculated_df.withColumn(&lt;span class=&quot;code-quote&quot;&gt;&apos;correct_col&apos;&lt;/span&gt;, (col(&lt;span class=&quot;code-quote&quot;&gt;&quot;A&quot;&lt;/span&gt;) &amp;gt;= lit(2)) | (col(&lt;span class=&quot;code-quote&quot;&gt;&quot;A&quot;&lt;/span&gt;).isNull()))

calculated_df.show()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+---+-----------------+-----------+
| A|potential_bad_col|correct_col|
+---+-----------------+-----------+
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|1.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
+---+-----------------+-----------+
only showing top 20 rows
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This problem disappears when the number of rows is small or when the input column does not contain None.&lt;/p&gt;</description>
                <environment>&lt;p&gt;I reproduced this issue&#160;by running&#160;pyspark locally on mac:&lt;/p&gt;

&lt;p&gt;Spark version: 2.3.1 pre-built with Hadoop 2.7&lt;/p&gt;

&lt;p&gt;Python library versions: pyarrow==0.10.0, pandas==0.20.2&lt;/p&gt;</environment>
        <key id="13185969">SPARK-25461</key>
            <summary>PySpark Pandas UDF outputs incorrect results when input columns contain None</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="viirya">L. C. Hsieh</assignee>
                                    <reporter username="xiangcy">Chongyuan Xiang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Sep 2018 04:49:35 +0000</created>
                <updated>Mon, 12 Dec 2022 18:10:59 +0000</updated>
                            <resolved>Sun, 7 Oct 2018 15:28:38 +0000</resolved>
                                    <version>2.3.1</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>PySpark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="16626198" author="mstewart141" created="Mon, 24 Sep 2018 18:08:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt; I have also recently observed this issue &#8211; it seems potentially rather serious. This is quite different&#160;than the behaviorr of&#160;the pandas function against a (pandas) df, which works exactly as expected.&lt;/p&gt;</comment>
                            <comment id="16628428" author="viirya" created="Wed, 26 Sep 2018 08:42:35 +0000"  >&lt;p&gt;&lt;tt&gt;.where(column.notnull())&lt;/tt&gt; returns pandas dataframe in float64 type, not bool, if there are None values. And looks like float values are interpreted as false, if the pandas udf&apos;s return type is BooleanType:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
values = [1.0] * 5 + [2.0] * 5
pdf = pd.DataFrame({&lt;span class=&quot;code-quote&quot;&gt;&apos;A&apos;&lt;/span&gt;: values})
df = self.spark.createDataFrame(pdf)
@pandas_udf(returnType=BooleanType())
def to_boolean(column):
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; column
df.select([&lt;span class=&quot;code-quote&quot;&gt;&apos;A&apos;&lt;/span&gt;]).withColumn(&lt;span class=&quot;code-quote&quot;&gt;&apos;to_boolean&apos;&lt;/span&gt;, to_boolean(&lt;span class=&quot;code-quote&quot;&gt;&apos;A&apos;&lt;/span&gt;)).show()

+---+----------+                                            
|  A|to_boolean|       
+---+----------+                                                      
|1.0|     &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;|                                                             
|1.0|     &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;|                                                      
|1.0|     &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;|                  
|1.0|     &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;|                                                                                              
|1.0|     &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;|                                                                                                                                       
|2.0|     &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;|                                                                                 
|2.0|     &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;|                              
|2.0|     &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;|                                                                  
|2.0|     &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;|                                            
|2.0|     &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;|                                                      
+---+----------+      
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So that&apos;s said the above &lt;tt&gt;gt_2&lt;/tt&gt; pandas udf returns false for both 1.0 and 2.0 in your input data.&lt;/p&gt;</comment>
                            <comment id="16629831" author="viirya" created="Thu, 27 Sep 2018 07:00:11 +0000"  >&lt;p&gt;That&apos;s said I&apos;m not sure if this can be called a bug now. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt;, WDYT?&lt;/p&gt;</comment>
                            <comment id="16630830" author="csaid" created="Thu, 27 Sep 2018 18:00:24 +0000"  >&lt;p&gt;For what it&apos;s worth, converting all floats to False goes against my expectations.&#160;&lt;/p&gt;</comment>
                            <comment id="16635048" author="viirya" created="Tue, 2 Oct 2018 05:26:47 +0000"  >&lt;p&gt;I&apos;ve looked more at this. We don&apos;t really check if pandas.Series&apos;s type matches with pre-defined return type. For this case, seems the conversion is not correct.&lt;/p&gt;

&lt;p&gt;I was trying to add some check and throw exception when mismatching is detected. But looks like we leverage such behavior in current codebase. For example, there is a test &lt;tt&gt;test_vectorized_udf_null_short&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
data = [(None,), (2,), (3,), (4,)]
schema = StructType().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;short&lt;/span&gt;&quot;&lt;/span&gt;, ShortType())
df = self.spark.createDataFrame(data, schema)
short_f = pandas_udf(lambda x: x, ShortType())
res = df.select(short_f(col(&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;short&lt;/span&gt;&apos;&lt;/span&gt;)))
self.assertEquals(df.collect(), res.collect())
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The Pandas.Series is of float64 but we define return type as ShortType. In this case, it works well. So seems to disallow such conversion is not feasible. For now, I think we can print some warning message if such mismatching is detected.&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt; What do you think about this idea?&lt;/p&gt;</comment>
                            <comment id="16635146" author="apachespark" created="Tue, 2 Oct 2018 08:27:27 +0000"  >&lt;p&gt;User &apos;viirya&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22610&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22610&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16635147" author="apachespark" created="Tue, 2 Oct 2018 08:27:38 +0000"  >&lt;p&gt;User &apos;viirya&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22610&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22610&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16635210" author="gurwls223" created="Tue, 2 Oct 2018 09:39:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=viirya&quot; class=&quot;user-hover&quot; rel=&quot;viirya&quot;&gt;viirya&lt;/a&gt;, I am sorry I missed this. I have been busy this month. Will take a look for PR.&lt;/p&gt;</comment>
                            <comment id="16635216" author="viirya" created="Tue, 2 Oct 2018 09:41:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt; Thanks and no problem at all! You can take a look when you have time. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16635762" author="bryanc" created="Tue, 2 Oct 2018 16:05:35 +0000"  >&lt;p&gt;Thanks for looking into this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=viirya&quot; class=&quot;user-hover&quot; rel=&quot;viirya&quot;&gt;viirya&lt;/a&gt;! You are right that the above udf returns a float64 instead of boolean. I&apos;m not sure what the expected cast from float to bool should be, but it does seem like pyarrow might be doing something wrong here. I&apos;ll look into it some more and raise an issue there if so.&lt;/p&gt;</comment>
                            <comment id="16635811" author="mstewart141" created="Tue, 2 Oct 2018 16:54:28 +0000"  >&lt;p&gt;Thanks all; to me the largest issue with this behavior is the silent failure &#8212; there is a relatively sane workaround to the issue but the silent failure is deeply unnerving. Especially as the same code runs in pandas proper with no hint of the issue. Even raising some runtime error would be a huge win from my perspective! &lt;/p&gt;</comment>
                            <comment id="16637626" author="bryanc" created="Wed, 3 Oct 2018 23:42:59 +0000"  >&lt;p&gt;I filed &lt;a href=&quot;https://issues.apache.org/jira/browse/ARROW-3428&quot; title=&quot;[Python] from_pandas gives incorrect results when converting floating point to bool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ARROW-3428&quot;&gt;&lt;del&gt;ARROW-3428&lt;/del&gt;&lt;/a&gt;, which deals with the incorrect cast from float to bool&lt;/p&gt;</comment>
                            <comment id="16637657" author="xiangcy" created="Thu, 4 Oct 2018 00:36:43 +0000"  >&lt;p&gt;Hi all, thanks for looking into the issue! As a follow up, I noticed that there were&#160;similar issues with casting to float as well. Just reusing my example and changing the return type to be FloatType:&#160;&lt;/p&gt;

&lt;p&gt;Script:&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; pandas as pd
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; random
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; pyspark
from pyspark.sql.functions &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; col, lit, pandas_udf

values = [None] * 30000 + [1.0] * 170000 + [2.0] * 6000000
random.shuffle(values)
pdf = pd.DataFrame({&lt;span class=&quot;code-quote&quot;&gt;&apos;A&apos;&lt;/span&gt;: values})
df = spark.createDataFrame(pdf)

@pandas_udf(returnType=pyspark.sql.types.FloatType())
def gt_2(column):
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (column &amp;gt;= 2).where(column.notnull())

calculated_df = (df.select([&lt;span class=&quot;code-quote&quot;&gt;&apos;A&apos;&lt;/span&gt;])
.withColumn(&lt;span class=&quot;code-quote&quot;&gt;&apos;potential_bad_col&apos;&lt;/span&gt;, gt_2(&lt;span class=&quot;code-quote&quot;&gt;&apos;A&apos;&lt;/span&gt;))
)

calculated_df = calculated_df.withColumn(&lt;span class=&quot;code-quote&quot;&gt;&apos;correct_col&apos;&lt;/span&gt;, (col(&lt;span class=&quot;code-quote&quot;&gt;&quot;A&quot;&lt;/span&gt;) &amp;gt;= lit(2)) | (col(&lt;span class=&quot;code-quote&quot;&gt;&quot;A&quot;&lt;/span&gt;).isNull()))

calculated_df.filter(col(&lt;span class=&quot;code-quote&quot;&gt;&quot;A&quot;&lt;/span&gt;) == 2).show(30)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+---+-----------------+-----------+
| A|potential_bad_col|correct_col|
+---+-----------------+-----------+
|2.0| 1.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 1.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 1.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 1.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
|2.0| 0.0| &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|
+---+-----------------+-----------+&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16640247" author="bryanc" created="Fri, 5 Oct 2018 19:23:32 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xiangcy&quot; class=&quot;user-hover&quot; rel=&quot;xiangcy&quot;&gt;xiangcy&lt;/a&gt;! Converting from bool to other numbers is related to the other problem, but was slightly different.&#160; The fix for this is also included in &lt;a href=&quot;https://issues.apache.org/jira/browse/ARROW-3428&quot; title=&quot;[Python] from_pandas gives incorrect results when converting floating point to bool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ARROW-3428&quot;&gt;&lt;del&gt;ARROW-3428&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16641105" author="gurwls223" created="Sun, 7 Oct 2018 15:28:38 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/spark/pull/22610&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22610&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16642379" author="bryanc" created="Mon, 8 Oct 2018 19:44:55 +0000"  >&lt;p&gt;Just wanted to add that the resolution here added a note for the user to verify the return type and data is correct.&#160; The actual fix for correct data when converting to/from booleans is on the Arrow side and won&apos;t be available until Spark upgrades pyarrow to version 0.12.0+.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13189321">ARROW-3428</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 6 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3y8o7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>