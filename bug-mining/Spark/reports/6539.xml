<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:05:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-28189] Pyspark  - df.drop() is Case Sensitive when Referring to Upstream Tables</title>
                <link>https://issues.apache.org/jira/browse/SPARK-28189</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Column names in general are case insensitive in Pyspark, and df.drop() in general is also case insensitive.&lt;/p&gt;

&lt;p&gt;However, when referring to an upstream table, such as from a join, e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
vals1 = [(&lt;span class=&quot;code-quote&quot;&gt;&apos;Pirate&apos;&lt;/span&gt;, 1),(&lt;span class=&quot;code-quote&quot;&gt;&apos;Monkey&apos;&lt;/span&gt;, 2),(&lt;span class=&quot;code-quote&quot;&gt;&apos;Ninja&apos;&lt;/span&gt;, 3),(&lt;span class=&quot;code-quote&quot;&gt;&apos;Spaghetti&apos;&lt;/span&gt;, 4)]
df1 = spark.createDataFrame(vals1, [&lt;span class=&quot;code-quote&quot;&gt;&apos;KEY&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;field&apos;&lt;/span&gt;])

vals2 = [(&lt;span class=&quot;code-quote&quot;&gt;&apos;Rutabaga&apos;&lt;/span&gt;, 1),(&lt;span class=&quot;code-quote&quot;&gt;&apos;Pirate&apos;&lt;/span&gt;, 2),(&lt;span class=&quot;code-quote&quot;&gt;&apos;Ninja&apos;&lt;/span&gt;, 3),(&lt;span class=&quot;code-quote&quot;&gt;&apos;Darth Vader&apos;&lt;/span&gt;, 4)]
df2 = spark.createDataFrame(vals2, [&lt;span class=&quot;code-quote&quot;&gt;&apos;KEY&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;CAPS&apos;&lt;/span&gt;])


df_joined = df1.join(df2, df1[&lt;span class=&quot;code-quote&quot;&gt;&apos;key&apos;&lt;/span&gt;] == df2[&lt;span class=&quot;code-quote&quot;&gt;&apos;key&apos;&lt;/span&gt;], &lt;span class=&quot;code-quote&quot;&gt;&quot;left&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;drop will become case sensitive. e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
# from above, df1 consists of columns [&lt;span class=&quot;code-quote&quot;&gt;&apos;KEY&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;field&apos;&lt;/span&gt;]
# from above, df2 consists of columns [&lt;span class=&quot;code-quote&quot;&gt;&apos;KEY&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;CAPS&apos;&lt;/span&gt;]

df_joined.select(df2[&lt;span class=&quot;code-quote&quot;&gt;&apos;key&apos;&lt;/span&gt;]) # will give a result
df_joined.drop(&lt;span class=&quot;code-quote&quot;&gt;&apos;caps&apos;&lt;/span&gt;) # will also give a result
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;however, note the following&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
df_joined.drop(df2[&lt;span class=&quot;code-quote&quot;&gt;&apos;key&apos;&lt;/span&gt;]) # no-op
df_joined.drop(df2[&lt;span class=&quot;code-quote&quot;&gt;&apos;caps&apos;&lt;/span&gt;]) # no-op

df_joined.drop(df2[&lt;span class=&quot;code-quote&quot;&gt;&apos;KEY&apos;&lt;/span&gt;]) # will drop column as expected
df_joined.drop(df2[&lt;span class=&quot;code-quote&quot;&gt;&apos;CAPS&apos;&lt;/span&gt;]) # will drop column as expected

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;so in summary, using df.drop(df2&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;col&amp;#39;&amp;#93;&lt;/span&gt;) doesn&apos;t align with expected case insensitivity for column names, even though functions like select, join, and dropping a column generally are case insensitive.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13242024">SPARK-28189</key>
            <summary>Pyspark  - df.drop() is Case Sensitive when Referring to Upstream Tables</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Tonix517">Tony Zhang</assignee>
                                    <reporter username="lchu122">Luke Chu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 27 Jun 2019 20:35:37 +0000</created>
                <updated>Sun, 21 Jul 2019 07:12:29 +0000</updated>
                            <resolved>Sun, 7 Jul 2019 04:45:27 +0000</resolved>
                                    <version>2.4.0</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16878830" author="tonix517" created="Thu, 4 Jul 2019 17:42:38 +0000"  >&lt;p&gt;Working on a fix now.&lt;/p&gt;</comment>
                            <comment id="16878925" author="dongjoon" created="Fri, 5 Jul 2019 01:14:54 +0000"  >&lt;p&gt;Is this only for Spark 2.4? Could you check Spark 2.3, too?&lt;/p&gt;</comment>
                            <comment id="16879793" author="dongjoon" created="Sun, 7 Jul 2019 04:45:27 +0000"  >&lt;p&gt;This is resolved via &lt;a href=&quot;https://github.com/apache/spark/pull/25055&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/25055&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16879794" author="dongjoon" created="Sun, 7 Jul 2019 04:45:50 +0000"  >&lt;p&gt;hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Tonix517&quot; class=&quot;user-hover&quot; rel=&quot;Tonix517&quot;&gt;Tonix517&lt;/a&gt;. You are added to `Apache Spark Contributor`. Welcome!&lt;/p&gt;</comment>
                            <comment id="16879796" author="tonix517" created="Sun, 7 Jul 2019 05:05:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt; thrilled. thanks for you help!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 19 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z046c8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>