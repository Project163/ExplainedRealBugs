<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:19:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-4006] Spark Driver crashes whenever an Executor is registered twice</title>
                <link>https://issues.apache.org/jira/browse/SPARK-4006</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;This is a huge robustness issue for us (Taboola), in mission critical , time sensitive (real time) spark jobs.&lt;/p&gt;

&lt;p&gt;We have long running spark drivers and even though we have state of the art hardware, from time to time executors disconnect. In many cases, the RemoveExecutor is not received, and when the new executor registers, the driver crashes. In mesos coarse grained, executor ids are fixed. &lt;/p&gt;

&lt;p&gt;The issue is with the System.exit(1) in BlockManagerMasterActor&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; def register(id: BlockManagerId, maxMemSize: &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;, slaveActor: ActorRef) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!blockManagerInfo.contains(id)) {
      blockManagerIdByExecutor.get(id.executorId) match {
        &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; Some(manager) =&amp;gt;
          &lt;span class=&quot;code-comment&quot;&gt;// A block manager of the same executor already exists.
&lt;/span&gt;          &lt;span class=&quot;code-comment&quot;&gt;// This should never happen. Let&apos;s just quit.
&lt;/span&gt;          logError(&lt;span class=&quot;code-quote&quot;&gt;&quot;Got two different block manager registrations on &quot;&lt;/span&gt; + id.executorId)
          &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.exit(1)
        &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; None =&amp;gt;
          blockManagerIdByExecutor(id.executorId) = id
      }

      logInfo(&lt;span class=&quot;code-quote&quot;&gt;&quot;Registering block manager %s with %s RAM&quot;&lt;/span&gt;.format(
        id.hostPort, Utils.bytesToString(maxMemSize)))

      blockManagerInfo(id) =
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BlockManagerInfo(id, &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis(), maxMemSize, slaveActor)
    }
    listenerBus.post(SparkListenerBlockManagerAdded(id, maxMemSize))
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Mesos, Coarse Grained&lt;/p&gt;</environment>
        <key id="12749189">SPARK-4006</key>
            <summary>Spark Driver crashes whenever an Executor is registered twice</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tsliwowicz">Tal Sliwowicz</assignee>
                                    <reporter username="tsliwowicz">Tal Sliwowicz</reporter>
                        <labels>
                    </labels>
                <created>Mon, 20 Oct 2014 08:42:25 +0000</created>
                <updated>Fri, 9 Jan 2015 20:07:12 +0000</updated>
                            <resolved>Sat, 27 Dec 2014 08:02:42 +0000</resolved>
                                    <version>0.9.2</version>
                    <version>1.0.2</version>
                    <version>1.1.0</version>
                    <version>1.2.0</version>
                                    <fixVersion>0.9.3</fixVersion>
                    <fixVersion>1.0.3</fixVersion>
                    <fixVersion>1.1.1</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                                    <component>Block Manager</component>
                    <component>Spark Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14176774" author="tsliwowicz" created="Mon, 20 Oct 2014 10:13:43 +0000"  >&lt;p&gt;Fixed in - &lt;a href=&quot;https://github.com/apache/spark/pull/2854&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/2854&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14176798" author="apachespark" created="Mon, 20 Oct 2014 10:42:45 +0000"  >&lt;p&gt;User &apos;tsliwowicz&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/2854&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/2854&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14179347" author="apachespark" created="Tue, 21 Oct 2014 23:54:05 +0000"  >&lt;p&gt;User &apos;tsliwowicz&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/2886&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/2886&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14179625" author="joshrosen" created="Wed, 22 Oct 2014 06:17:24 +0000"  >&lt;p&gt;Thanks for the bug report + patch!  I&apos;d like to see if I can find a way to reproduce this issue in a fault-injection tool that I&apos;m building.  I&apos;ll give it a quick try tomorrow before reviewing (and hopefully merging) your fix.&lt;/p&gt;</comment>
                            <comment id="14180512" author="sliwo" created="Wed, 22 Oct 2014 20:47:57 +0000"  >&lt;p&gt;Cool! Would be very interesting to know.&lt;br/&gt;
For us it&apos;s hard to force reproduce this (because you need two registers without a remove in between), but it always happens eventually, so I can tell for sure that the fix resolved our issue.&lt;/p&gt;</comment>
                            <comment id="14181988" author="apachespark" created="Thu, 23 Oct 2014 21:18:22 +0000"  >&lt;p&gt;User &apos;tsliwowicz&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/2914&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/2914&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14182001" author="apachespark" created="Thu, 23 Oct 2014 21:28:28 +0000"  >&lt;p&gt;User &apos;tsliwowicz&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/2915&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/2915&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14182005" author="sliwo" created="Thu, 23 Oct 2014 21:32:55 +0000"  >&lt;p&gt;After the fix was merged to master, created a PR for 1.0, 1.1 and updated the original 0.9 PR (the merges were not clean).&lt;/p&gt;</comment>
                            <comment id="14259308" author="pwendell" created="Sat, 27 Dec 2014 08:02:42 +0000"  >&lt;p&gt;I verified that this is present in branch 1.2, 1.1, and 1.0, so I&apos;m resolving it.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 47 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21cif:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327384">0.9.3</customfieldvalue>
    <customfieldvalue id="12327468">1.0.3</customfieldvalue>
    <customfieldvalue id="12327368">1.1.1</customfieldvalue>
    <customfieldvalue id="12327369">1.2.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>