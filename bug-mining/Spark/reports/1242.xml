<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:22:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-5172] spark-examples-***.jar shades a wrong Hadoop distribution</title>
                <link>https://issues.apache.org/jira/browse/SPARK-5172</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Steps to check it:&lt;/p&gt;

&lt;p&gt;1. Download  &quot;spark-1.2.0-bin-hadoop2.4.tgz&quot; from &lt;a href=&quot;http://www.apache.org/dyn/closer.cgi/spark/spark-1.2.0/spark-1.2.0-bin-hadoop2.4.tgz&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/dyn/closer.cgi/spark/spark-1.2.0/spark-1.2.0-bin-hadoop2.4.tgz&lt;/a&gt;&lt;br/&gt;
2. unzip `spark-examples-1.2.0-hadoop2.4.0.jar`.&lt;br/&gt;
3. There is a file called `org/apache/hadoop/package-info.class` in the jar. It doesn&apos;t exist in hadoop 2.4. &lt;br/&gt;
4. Run &quot;javap -classpath . -private -c -v  org.apache.hadoop.package-info&quot;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Compiled from &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-info.java&quot;&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; org.apache.hadoop.&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-info
  SourceFile: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-info.java&quot;&lt;/span&gt;
  RuntimeVisibleAnnotations: length = 0x24
   00 01 00 06 00 06 00 07 73 00 08 00 09 73 00 0A
   00 0B 73 00 0C 00 0D 73 00 0E 00 0F 73 00 10 00
   11 73 00 12 
  minor version: 0
  major version: 50
  Constant pool:
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #1 = Asciz	org/apache/hadoop/&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-info;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #2 = class	#1;	&lt;span class=&quot;code-comment&quot;&gt;//  &lt;span class=&quot;code-quote&quot;&gt;&quot;org/apache/hadoop/&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-info&quot;&lt;/span&gt;
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #3 = Asciz	java/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #4 = class	#3;	&lt;span class=&quot;code-comment&quot;&gt;//  java/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #5 = Asciz	&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-info.java;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #6 = Asciz	Lorg/apache/hadoop/HadoopVersionAnnotation;;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #7 = Asciz	version;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #8 = Asciz	1.2.1;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #9 = Asciz	revision;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #10 = Asciz	1503152;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #11 = Asciz	user;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #12 = Asciz	mattf;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #13 = Asciz	date;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #14 = Asciz	Wed Jul 24 13:39:35 PDT 2013;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #15 = Asciz	url;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #16 = Asciz	https:&lt;span class=&quot;code-comment&quot;&gt;//svn.apache.org/repos/asf/hadoop/common/branches/branch-1.2;
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #17 = Asciz	srcChecksum;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #18 = Asciz	6923c86528809c4e7e6f493b6b413a9a;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #19 = Asciz	SourceFile;
&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt; #20 = Asciz	RuntimeVisibleAnnotations;

{
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The version is &lt;tt&gt;1.2.1&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;It comes because a wrong hbase version settings in examples project. Here is a part of the dependencly tree when runnning &quot;mvn -Pyarn -Phadoop-2.4 -Dhadoop.version=2.4.0 -pl examples dependency:tree&quot;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[INFO] +- org.apache.hbase:hbase-testing-util:jar:0.98.7-hadoop1:compile
[INFO] |  +- org.apache.hbase:hbase-common:test-jar:tests:0.98.7-hadoop1:compile
[INFO] |  +- org.apache.hbase:hbase-server:test-jar:tests:0.98.7-hadoop1:compile
[INFO] |  |  +- com.sun.jersey:jersey-core:jar:1.8:compile
[INFO] |  |  +- com.sun.jersey:jersey-json:jar:1.8:compile
[INFO] |  |  |  +- org.codehaus.jettison:jettison:jar:1.1:compile
[INFO] |  |  |  +- com.sun.xml.bind:jaxb-impl:jar:2.2.3-1:compile
[INFO] |  |  |  \- org.codehaus.jackson:jackson-xc:jar:1.7.1:compile
[INFO] |  |  \- com.sun.jersey:jersey-server:jar:1.8:compile
[INFO] |  |     \- asm:asm:jar:3.3.1:test
[INFO] |  +- org.apache.hbase:hbase-hadoop1-compat:jar:0.98.7-hadoop1:compile
[INFO] |  +- org.apache.hbase:hbase-hadoop1-compat:test-jar:tests:0.98.7-hadoop1:compile
[INFO] |  +- org.apache.hadoop:hadoop-core:jar:1.2.1:compile
[INFO] |  |  +- xmlenc:xmlenc:jar:0.52:compile
[INFO] |  |  +- commons-configuration:commons-configuration:jar:1.6:compile
[INFO] |  |  |  +- commons-digester:commons-digester:jar:1.8:compile
[INFO] |  |  |  |  \- commons-beanutils:commons-beanutils:jar:1.7.0:compile
[INFO] |  |  |  \- commons-beanutils:commons-beanutils-core:jar:1.8.0:compile
[INFO] |  |  \- commons-el:commons-el:jar:1.0:compile
[INFO] |  +- org.apache.hadoop:hadoop-test:jar:1.2.1:compile
[INFO] |  |  +- org.apache.ftpserver:ftplet-api:jar:1.0.0:compile
[INFO] |  |  +- org.apache.mina:mina-core:jar:2.0.0-M5:compile
[INFO] |  |  +- org.apache.ftpserver:ftpserver-core:jar:1.0.0:compile
[INFO] |  |  \- org.apache.ftpserver:ftpserver-deprecated:jar:1.0.0-M2:compile
[INFO] |  +- com.github.stephenc.findbugs:findbugs-annotations:jar:1.3.9-1:compile
[INFO] |  \- junit:junit:jar:4.10:test
[INFO] |     \- org.hamcrest:hamcrest-core:jar:1.1:test
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If I ran `mvn -Pyarn -Phadoop-2.4 -Dhadoop.version=2.4.0 -pl examples -am dependency:tree -Dhbase.profile=hadoop2`, the dependency tree is right.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12765988">SPARK-5172</key>
            <summary>spark-examples-***.jar shades a wrong Hadoop distribution</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="srowen">Sean R. Owen</assignee>
                                    <reporter username="zsxwing">Shixiong Zhu</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Jan 2015 10:21:13 +0000</created>
                <updated>Mon, 12 Jan 2015 20:26:08 +0000</updated>
                            <resolved>Mon, 12 Jan 2015 20:26:08 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                                    <component>Build</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14270853" author="zsxwing" created="Fri, 9 Jan 2015 10:34:26 +0000"  >&lt;p&gt;If someone puts the spark-examples.jar in the classpath, it may use a wrong hadoop client.&lt;/p&gt;</comment>
                            <comment id="14270946" author="srowen" created="Fri, 9 Jan 2015 12:21:13 +0000"  >&lt;p&gt;It&apos;s not quite that &amp;#8211; it&apos;s that the HBase examples are being compiled with the hadoop1 compat libraries. &lt;/p&gt;

&lt;p&gt;You have to set &lt;tt&gt;-Phbase-hadoop2&lt;/tt&gt; when building for Hadoop 2, or set &lt;tt&gt;-Dhbase.profile=hadoop2&lt;/tt&gt;. &lt;/p&gt;

&lt;p&gt;This is sort of what I was worried about when these two new profiles were introduced with &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-1297&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-1297&lt;/a&gt; , that nobody is going to remember to set this correctly, and indeed nothing in the Spark build sets these.&lt;/p&gt;

&lt;p&gt;Solutions:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Update build scripts and docs to set this profile for Hadoop 2 builds&lt;/li&gt;
	&lt;li&gt;Push this logic into the existing &lt;tt&gt;hadoop-2.x&lt;/tt&gt; profiles in the parent&lt;/li&gt;
	&lt;li&gt;Make Hadoop 2 the default anyway to make this less likely to come up anyway (cf &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-5134&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-5134&lt;/a&gt; )&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14273041" author="apachespark" created="Sun, 11 Jan 2015 20:12:25 +0000"  >&lt;p&gt;User &apos;srowen&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/3992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/3992&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 45 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2448n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>