<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:26:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-2669] Hadoop configuration is not localised when submitting job in yarn-cluster mode</title>
                <link>https://issues.apache.org/jira/browse/SPARK-2669</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I&apos;d like to propose a fix for a problem when Hadoop configuration is not localized when job is submitted in yarn-cluster mode. Here is a description from github pull request &lt;a href=&quot;https://github.com/apache/spark/pull/1574&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1574&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This patch fixes a problem when Spark driver is run in the container&lt;br/&gt;
managed by YARN ResourceManager it inherits configuration from a&lt;br/&gt;
NodeManager process, which can be different from the Hadoop&lt;br/&gt;
configuration present on the client (submitting machine). Problem is&lt;br/&gt;
most vivid when fs.defaultFS property differs between these two.&lt;/p&gt;

&lt;p&gt;Hadoop MR solves it by serializing client&apos;s Hadoop configuration into&lt;br/&gt;
job.xml in application staging directory and then making Application&lt;br/&gt;
Master to use it. That guarantees that regardless of execution nodes&lt;br/&gt;
configurations all application containers use same config identical to&lt;br/&gt;
one on the client side.&lt;/p&gt;

&lt;p&gt;This patch uses similar approach. YARN ClientBase serializes&lt;br/&gt;
configuration and adds it to ClientDistributedCacheManager under&lt;br/&gt;
&quot;job.xml&quot; link name. ClientDistributedCacheManager is then utilizes&lt;br/&gt;
Hadoop localizer to deliver it to whatever container is started by this&lt;br/&gt;
application, including the one running Spark driver.&lt;/p&gt;

&lt;p&gt;YARN ClientBase also adds &quot;SPARK_LOCAL_HADOOPCONF&quot; env variable to AM&lt;br/&gt;
container request which is then used by SparkHadoopUtil.newConfiguration&lt;br/&gt;
to trigger new behavior when machine-wide hadoop configuration is merged&lt;br/&gt;
with application specific job.xml (exactly how it is done in Hadoop MR).&lt;/p&gt;

&lt;p&gt;SparkContext is then follows same approach, adding&lt;br/&gt;
SPARK_LOCAL_HADOOPCONF env to all spawned containers to make them use&lt;br/&gt;
client-side Hadopo configuration.&lt;/p&gt;

&lt;p&gt;Also all the references to &quot;new Configuration()&quot; which might be executed&lt;br/&gt;
on YARN cluster side are changed to use SparkHadoopUtil.get.conf&lt;/p&gt;

&lt;p&gt;Please note that it fixes only core Spark, the part which I am&lt;br/&gt;
comfortable to test and verify the result. I didn&apos;t descend into&lt;br/&gt;
steaming/shark directories, so things might need to be changed there too.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12729489">SPARK-2669</key>
            <summary>Hadoop configuration is not localised when submitting job in yarn-cluster mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vanzin">Marcelo Masiero Vanzin</assignee>
                                    <reporter username="rossmohax">Maxim Ivanov</reporter>
                        <labels>
                    </labels>
                <created>Thu, 24 Jul 2014 16:12:24 +0000</created>
                <updated>Fri, 17 Apr 2015 19:22:54 +0000</updated>
                            <resolved>Fri, 17 Apr 2015 19:22:54 +0000</resolved>
                                    <version>1.0.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>YARN</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14073338" author="apachespark" created="Thu, 24 Jul 2014 16:15:46 +0000"  >&lt;p&gt;User &apos;redbaron&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/1574&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1574&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14286153" author="apachespark" created="Wed, 21 Jan 2015 19:48:15 +0000"  >&lt;p&gt;User &apos;vanzin&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/4142&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/4142&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>407563</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 43 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1y4s7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>407577</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12329359">1.4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>