<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:46:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-17141] MinMaxScaler behaves weird when min and max have the same value and some values are NaN</title>
                <link>https://issues.apache.org/jira/browse/SPARK-17141</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;When you have a &lt;tt&gt;DataFrame&lt;/tt&gt; with a column named &lt;tt&gt;features&lt;/tt&gt;, which is a &lt;tt&gt;DenseVector&lt;/tt&gt; and the &lt;b&gt;maximum&lt;/b&gt; and &lt;b&gt;minimum&lt;/b&gt; are exactly the same value, but some other are &lt;tt&gt;Double.NaN&lt;/tt&gt; they get replaced by 0.5, and they should remain with the same value, I believe.&lt;/p&gt;

&lt;p&gt;I know how to fix it, but I haven&apos;t ever made a pull request. You can check the bug in this &lt;a href=&quot;https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/2485090270202665/3126465289264547/8589256059752547/latest.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;notebook&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Databrick&apos;s Community, Spark 2.0 + Scala 2.10&lt;/p&gt;</environment>
        <key id="12998284">SPARK-17141</key>
            <summary>MinMaxScaler behaves weird when min and max have the same value and some values are NaN</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yanboliang">Yanbo Liang</assignee>
                                    <reporter username="Bonsanto">Alberto Bonsanto</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Aug 2016 18:54:23 +0000</created>
                <updated>Fri, 19 Aug 2016 11:01:09 +0000</updated>
                            <resolved>Fri, 19 Aug 2016 10:24:51 +0000</resolved>
                                    <version>1.6.2</version>
                    <version>2.0.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>ML</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15426988" author="srowen" created="Thu, 18 Aug 2016 18:57:33 +0000"  >&lt;p&gt;Summarize the reproduction here? best to put it all here for the record.&lt;br/&gt;
If you have a small fix and can describe it then someone else can commit it, though I think making a PR is a useful skill and not that hard. Worth taking a shot at it.&lt;/p&gt;</comment>
                            <comment id="15427409" author="bonsanto" created="Fri, 19 Aug 2016 00:32:31 +0000"  >&lt;p&gt;Crude data.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; id&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;chicken&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;jam&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;roast beef&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    NaN&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;       2.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  2&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    2.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;       2.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  3&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    NaN&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;       2.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  4&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    2.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;      -2.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  5&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    2.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;       2.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  6&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    2.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;       NaN&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;After assemble and normalization, as you can see &lt;tt&gt;Double.NaN&lt;/tt&gt; are replaced for &lt;tt&gt;0.5&lt;/tt&gt;.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;id &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;chicken&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;jam&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;roast beef&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;features      &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;featuresNorm &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;NaN    &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0       &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;NaN,2.0,2.0&amp;#93;&lt;/span&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0.5,1.0,1.0&amp;#93;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0    &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0       &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2.0,0.0,2.0&amp;#93;&lt;/span&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0.5,0.0,1.0&amp;#93;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;3  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;NaN    &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0       &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;NaN,0.0,2.0&amp;#93;&lt;/span&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0.5,0.0,1.0&amp;#93;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;4  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0    &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;-2.0      &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2.0,1.0,-2.0&amp;#93;&lt;/span&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0.5,0.5,0.0&amp;#93;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;5  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0    &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0       &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2.0,2.0,2.0&amp;#93;&lt;/span&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0.5,1.0,1.0&amp;#93;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;6  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0    &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;NaN       &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2.0,2.0,NaN&amp;#93;&lt;/span&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0.5,1.0,NaN&amp;#93;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


</comment>
                            <comment id="15427846" author="apachespark" created="Fri, 19 Aug 2016 08:53:05 +0000"  >&lt;p&gt;User &apos;yanboliang&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14716&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14716&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15427860" author="yanboliang" created="Fri, 19 Aug 2016 09:01:34 +0000"  >&lt;p&gt;In the existing code, &lt;tt&gt;MinMaxScaler&lt;/tt&gt; handle NaN value indeterminately.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;If a column has identity value, that is max == min, &lt;tt&gt;MinMaxScalerModel&lt;/tt&gt; transformation will output 0.5 for all rows even the original value is NaN.&lt;/li&gt;
	&lt;li&gt;Otherwise, it will remain NaN after transformation.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I think we should unify the behavior by remaining NaN value at any condition, since we don&apos;t know how to transform a NaN value. In Python sklearn, it will throw exception when there is NaN in the dataset.&lt;/p&gt;</comment>
                            <comment id="15427996" author="bonsanto" created="Fri, 19 Aug 2016 11:01:09 +0000"  >&lt;p&gt;Just a question, I had to be the pull requester in order to appear as a contributor during the next release right? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 13 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32hlz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>