<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:05:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-27671] Fix error when casting from a nested null in a struct</title>
                <link>https://issues.apache.org/jira/browse/SPARK-27671</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;When a null in a nested field in struct, casting from the struct throws error, currently.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt; sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;select &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(struct(1, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) as struct&amp;lt;a:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,b:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&amp;gt;)&quot;&lt;/span&gt;).show
scala.MatchError: NullType (of &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.spark.sql.types.NullType$)                                                                             
  at org.apache.spark.sql.catalyst.expressions.Cast.castToInt(Cast.scala:447)                                                                          
  at org.apache.spark.sql.catalyst.expressions.Cast.&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(Cast.scala:635)                                                                               
  at org.apache.spark.sql.catalyst.expressions.Cast.$anonfun$castStruct$1(Cast.scala:603)   
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt; sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;select * FROM VALUES ((&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, (10, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;))), ((&lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;, (10, 50))), ((&lt;span class=&quot;code-quote&quot;&gt;&apos;c&apos;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)) AS tab(x, y)&quot;&lt;/span&gt;).show                                             
org.apache.spark.sql.AnalysisException: failed to evaluate expression named_struct(&lt;span class=&quot;code-quote&quot;&gt;&apos;col1&apos;&lt;/span&gt;, 10, &lt;span class=&quot;code-quote&quot;&gt;&apos;col2&apos;&lt;/span&gt;, NULL): NullType (of &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.spark.sql.t
ypes.NullType$); line 1 pos 14                                                                                                                         
  at org.apache.spark.sql.catalyst.analysis.&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;$AnalysisErrorAt.failAnalysis(&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;.scala:47)                                                     
  at org.apache.spark.sql.catalyst.analysis.ResolveInlineTables.$anonfun$convert$6(ResolveInlineTables.scala:106)        
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13232629">SPARK-27671</key>
            <summary>Fix error when casting from a nested null in a struct</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="viirya">L. C. Hsieh</assignee>
                                    <reporter username="viirya">L. C. Hsieh</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 May 2019 10:39:52 +0000</created>
                <updated>Tue, 14 May 2019 16:40:03 +0000</updated>
                            <resolved>Mon, 13 May 2019 19:42:44 +0000</resolved>
                                    <version>2.4.3</version>
                    <version>3.0.0</version>
                                    <fixVersion>2.4.4</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16838692" author="dongjoon" created="Mon, 13 May 2019 16:39:31 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=viirya&quot; class=&quot;user-hover&quot; rel=&quot;viirya&quot;&gt;viirya&lt;/a&gt;. Could you test old Spark and update the `Affects Version/s` please?&lt;/p&gt;</comment>
                            <comment id="16838795" author="dongjoon" created="Mon, 13 May 2019 18:35:06 +0000"  >&lt;p&gt;The patch can land on `master` and `branch-2.4`. From branch-2.3, we need more patches. So, it&apos;s not feasible to backport.&lt;/p&gt;</comment>
                            <comment id="16838840" author="dongjoon" created="Mon, 13 May 2019 19:42:45 +0000"  >&lt;p&gt;This is resolved via &lt;a href=&quot;https://github.com/apache/spark/pull/24576&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/24576&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16839070" author="viirya" created="Tue, 14 May 2019 04:40:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt; Thanks for test and updating `Affects Version/s`. Do we need a patch for branch-2.3? If needed, please let me know.&lt;/p&gt;</comment>
                            <comment id="16839609" author="dongjoon" created="Tue, 14 May 2019 16:40:03 +0000"  >&lt;p&gt;Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=viirya&quot; class=&quot;user-hover&quot; rel=&quot;viirya&quot;&gt;viirya&lt;/a&gt;. For now, it looks okay to me.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02ki8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>