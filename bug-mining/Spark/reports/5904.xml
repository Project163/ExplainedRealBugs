<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:01:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-25084] &quot;distribute by&quot; on multiple columns may lead to codegen issue</title>
                <link>https://issues.apache.org/jira/browse/SPARK-25084</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Test Query:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
select * from store_sales distribute by (ss_sold_time_sk, ss_item_sk, ss_customer_sk, ss_cdemo_sk, ss_addr_sk, ss_promo_sk) limit 1;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: org.codehaus.commons.compiler.CompileException: File &lt;span class=&quot;code-quote&quot;&gt;&apos;generated.java&apos;&lt;/span&gt;, Line 131, Column 67: failed to compile: org.codehaus.commons.compiler.CompileException: File &lt;span class=&quot;code-quote&quot;&gt;&apos;generated.java&apos;&lt;/span&gt;, Line 131, Column 67: One of &lt;span class=&quot;code-quote&quot;&gt;&apos;, )&apos;&lt;/span&gt; expected instead of &lt;span class=&quot;code-quote&quot;&gt;&apos;[&apos;&lt;/span&gt;
at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$.org$apache$spark$sql$catalyst$expressions$codegen$CodeGenerator$$doCompile(CodeGenerator.scala:1435)
at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1497)
at org.apache.spark.sql.catalyst.expressions.codegen.CodeGenerator$$anon$1.load(CodeGenerator.scala:1494)
at org.spark_project.guava.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3599)
at org.spark_project.guava.cache.LocalCache$Segment.loadSync(LocalCache.java:2379)
at org.spark_project.guava.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2342)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Wrong&#160;Codegen:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 131 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; computeHashForStruct_1(InternalRow mutableStateArray[0], &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; value1) {
&lt;span class=&quot;code-comment&quot;&gt;/* 132 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 133 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 134 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!mutableStateArray[0].isNullAt(5)) {
&lt;span class=&quot;code-comment&quot;&gt;/* 135 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 136 */&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; element5 = mutableStateArray[0].getInt(5);
&lt;span class=&quot;code-comment&quot;&gt;/* 137 */&lt;/span&gt; value1 = org.apache.spark.unsafe.hash.Murmur3_x86_32.hashInt(element5, value1);
&lt;span class=&quot;code-comment&quot;&gt;/* 138 */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* 139 */&lt;/span&gt; }&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13178190">SPARK-25084</key>
            <summary>&quot;distribute by&quot; on multiple columns may lead to codegen issue</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yucai">yucai</assignee>
                                    <reporter username="yucai">yucai</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 Aug 2018 05:19:49 +0000</created>
                <updated>Mon, 13 Aug 2018 00:51:50 +0000</updated>
                            <resolved>Sat, 11 Aug 2018 13:39:18 +0000</resolved>
                                    <version>2.3.1</version>
                                    <fixVersion>2.3.2</fixVersion>
                    <fixVersion>2.4.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="16575767" author="apachespark" created="Fri, 10 Aug 2018 05:27:04 +0000"  >&lt;p&gt;User &apos;yucai&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22066&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22066&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16575771" author="q79969786" created="Fri, 10 Aug 2018 05:35:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smilegator&quot; class=&quot;user-hover&quot; rel=&quot;smilegator&quot;&gt;smilegator&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryshao&quot; class=&quot;user-hover&quot; rel=&quot;jerryshao&quot;&gt;jerryshao&lt;/a&gt; I think It should be target 2.3.2.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16575772" author="jerryshao" created="Fri, 10 Aug 2018 05:38:06 +0000"  >&lt;p&gt;I&apos;m already preparing new RC4. If this is not a severe issue, I would not block the RC4 release.&lt;/p&gt;</comment>
                            <comment id="16575774" author="jerryshao" created="Fri, 10 Aug 2018 05:44:51 +0000"  >&lt;p&gt;Is this a regression or just a bug existed in old version?&lt;/p&gt;</comment>
                            <comment id="16575777" author="q79969786" created="Fri, 10 Aug 2018 05:50:10 +0000"  >&lt;p&gt;It&apos;s a regression.&lt;/p&gt;</comment>
                            <comment id="16575778" author="jerryshao" created="Fri, 10 Aug 2018 05:54:10 +0000"  >&lt;p&gt;I see. Unfortunately I&apos;ve cut the RC4, if it worth to include in 2.3.2, I will cut a new RC.&lt;/p&gt;</comment>
                            <comment id="16575790" author="smilegator" created="Fri, 10 Aug 2018 06:12:14 +0000"  >&lt;p&gt;Let us mark it as a blocker. How about the master branch? Does it work?&lt;/p&gt;</comment>
                            <comment id="16575791" author="smilegator" created="Fri, 10 Aug 2018 06:12:53 +0000"  >&lt;p&gt;Could you investigate which PR introduced this bug? What is the error message?&lt;/p&gt;</comment>
                            <comment id="16575808" author="yucai" created="Fri, 10 Aug 2018 06:20:24 +0000"  >&lt;p&gt;It is a regression, when the generated codes size is more than 1024, newer Spark will split it into many functions, but the function definition is wrong, like below:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; computeHashForStruct_0(InternalRow mutableStateArray[0], &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; value1) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In the older version, like 2.1.0, it does not split function, so it has no this issue.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16575856" author="apachespark" created="Fri, 10 Aug 2018 07:15:05 +0000"  >&lt;p&gt;User &apos;LantaoJin&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22067&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22067&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16575860" author="cltlfcjin" created="Fri, 10 Aug 2018 07:18:22 +0000"  >&lt;p&gt;I offer other fix way. &lt;a href=&quot;https://github.com/apache/spark/pull/22067&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22067&lt;/a&gt;&lt;br/&gt;
It doesn&apos;t need &quot;input&quot; as a global variable (If distribute by random)&lt;/p&gt;</comment>
                            <comment id="16576417" author="yucai" created="Fri, 10 Aug 2018 15:16:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smilegator&quot; class=&quot;user-hover&quot; rel=&quot;smilegator&quot;&gt;smilegator&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryshao&quot; class=&quot;user-hover&quot; rel=&quot;jerryshao&quot;&gt;jerryshao&lt;/a&gt;&lt;br/&gt;
Thanks a lot for marking it blocker.&lt;br/&gt;
A lot of eBay&apos;s tables use &quot;distribute by&quot; or &quot;cluster by&quot;, it is important for us to move to Spark 2.3.&lt;/p&gt;</comment>
                            <comment id="16577180" author="cloud_fan" created="Sat, 11 Aug 2018 13:39:18 +0000"  >&lt;p&gt;Issue resolved by pull request 22066&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22066&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22066&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16577211" author="apachespark" created="Sat, 11 Aug 2018 15:13:10 +0000"  >&lt;p&gt;User &apos;LantaoJin&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/22077&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/22077&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 14 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3wx13:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>