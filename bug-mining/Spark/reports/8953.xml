<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:32:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-40082] DAGScheduler may not schduler new stage in condition of push-based shuffle enabled</title>
                <link>https://issues.apache.org/jira/browse/SPARK-40082</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;In condition of push-based shuffle being enabled and speculative tasks existing, a shuffleMapStage will be resubmitting once fetchFailed occurring, then its parent stages will be resubmitting firstly and it will cost some time to compute. Before the shuffleMapStage being resubmitted, its all speculative tasks success and register map output, but speculative task successful events can not trigger shuffleMergeFinalized because this stage has been removed from runningStages.&lt;/p&gt;

&lt;p&gt;Then this stage is resubmitted, but speculative tasks have registered map output and there are no missing tasks to compute, resubmitting stages will also not trigger shuffleMergeFinalized. Eventually this stage&#8216;s&#160;_shuffleMergedFinalized keeps false.&lt;/p&gt;

&lt;p&gt;Then AQE will submit next stages which are dependent on&#160; this shuffleMapStage occurring fetchFailed. And in getMissingParentStages, this stage will be marked as missing and will be resubmitted, but next stages are added to waitingStages after this stage being finished, so next stages will not be submitted even though this stage&apos;s resubmitting has been finished.&lt;/p&gt;

&lt;p&gt;I have only met some times in my production env and it is difficult to reproduce&#12290;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13476788">SPARK-40082</key>
            <summary>DAGScheduler may not schduler new stage in condition of push-based shuffle enabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="StoveM">Fencheng Mei</assignee>
                                    <reporter username="Penglei Shi">Penglei Shi</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Aug 2022 09:24:18 +0000</created>
                <updated>Wed, 22 Mar 2023 06:11:28 +0000</updated>
                            <resolved>Wed, 22 Mar 2023 06:11:28 +0000</resolved>
                                    <version>3.1.1</version>
                                    <fixVersion>3.5.0</fixVersion>
                                    <component>Scheduler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17579612" author="penglei shi" created="Mon, 15 Aug 2022 09:37:30 +0000"  >&lt;p&gt;ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mshen&quot; class=&quot;user-hover&quot; rel=&quot;mshen&quot;&gt;mshen&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17580070" author="mshen" created="Tue, 16 Aug 2022 06:19:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=csingh&quot; class=&quot;user-hover&quot; rel=&quot;csingh&quot;&gt;csingh&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mridul&quot; class=&quot;user-hover&quot; rel=&quot;mridul&quot;&gt;mridul&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Want to bring your attention to this ticket. This seems an issue that we previously saw. Does upstream already have the fix for this?&lt;/p&gt;</comment>
                            <comment id="17698769" author="JIRAUSER284405" created="Fri, 10 Mar 2023 07:14:34 +0000"  >&lt;p&gt;I also encountered this problem on our production environment and solved it&#12290;I will fix it&lt;/p&gt;</comment>
                            <comment id="17699515" author="apachespark" created="Mon, 13 Mar 2023 08:27:20 +0000"  >&lt;p&gt;User &apos;Stove-hust&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/40393&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40393&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17699516" author="apachespark" created="Mon, 13 Mar 2023 08:28:20 +0000"  >&lt;p&gt;User &apos;Stove-hust&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/40393&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/40393&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13048118" name="missParentStages.png" size="224853" author="Penglei Shi" created="Mon, 15 Aug 2022 09:32:17 +0000"/>
                            <attachment id="13048116" name="shuffleMergeFinalized.png" size="132450" author="Penglei Shi" created="Mon, 15 Aug 2022 09:32:03 +0000"/>
                            <attachment id="13048117" name="submitMissingTasks.png" size="175279" author="Penglei Shi" created="Mon, 15 Aug 2022 09:32:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 35 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z17r3c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>