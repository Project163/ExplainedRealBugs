<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:21:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-4866] Support StructType as key in MapType</title>
                <link>https://issues.apache.org/jira/browse/SPARK-4866</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;&lt;a href=&quot;http://apache-spark-user-list.1001560.n3.nabble.com/Error-when-Applying-schema-to-a-dictionary-with-a-Tuple-as-key-td20716.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://apache-spark-user-list.1001560.n3.nabble.com/Error-when-Applying-schema-to-a-dictionary-with-a-Tuple-as-key-td20716.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Hi Guys, &lt;/p&gt;

&lt;p&gt;Im running a spark cluster in AWS with Spark 1.1.0 in EC2 &lt;/p&gt;

&lt;p&gt;I am trying to convert a an RDD with tuple &lt;/p&gt;

&lt;p&gt;(u&apos;string&apos;, int , &lt;/p&gt;
{(int, int): int, (int, int): int}
&lt;p&gt;) &lt;/p&gt;

&lt;p&gt;to a schema rdd using the schema: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;fields = [StructField(&lt;span class=&quot;code-quote&quot;&gt;&apos;field1&apos;&lt;/span&gt;,StringType(),True), 
                StructField(&lt;span class=&quot;code-quote&quot;&gt;&apos;field2&apos;&lt;/span&gt;,IntegerType(),True), 
                StructField(&lt;span class=&quot;code-quote&quot;&gt;&apos;field3&apos;&lt;/span&gt;,MapType(StructType([StructField(&lt;span class=&quot;code-quote&quot;&gt;&apos;field31&apos;&lt;/span&gt;,IntegerType(),True), 
                        StructField(&lt;span class=&quot;code-quote&quot;&gt;&apos;field32&apos;&lt;/span&gt;,IntegerType(),True)]),IntegerType(),True),True) 
                ] 

schema = StructType(fields) 
# generate the schemaRDD with the defined schema 
schemaRDD = sqc.applySchema(RDD, schema) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But when I add &quot;field3&quot; to the schema, it throws an execption: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Traceback (most recent call last): 
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;stdin&amp;gt;&quot;&lt;/span&gt;, line 1, in &amp;lt;module&amp;gt;
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/root/spark/python/pyspark/rdd.py&quot;&lt;/span&gt;, line 1153, in take 
    res = self.context.runJob(self, takeUpToNumLeft, p, True) 
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/root/spark/python/pyspark/context.py&quot;&lt;/span&gt;, line 770, in runJob 
    it = self._jvm.PythonRDD.runJob(self._jsc.sc(), mappedRDD._jrdd, javaPartitions, allowLocal) 
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/root/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py&quot;&lt;/span&gt;, line 538, in __call__ 
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/root/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/protocol.py&quot;&lt;/span&gt;, line 300, in get_return_value 
py4j.protocol.Py4JJavaError: An error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; calling z:org.apache.spark.api.python.PythonRDD.runJob. 
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 28.0 failed 4 times, most recent failure: Lost task 0.3 in stage 28.0 (TID 710, ip-172-31-29-120.ec2.internal): net.razorvine.pickle.PickleException: couldn&apos;t introspect javabean: java.lang.IllegalArgumentException: wrong number of arguments 
        net.razorvine.pickle.Pickler.put_javabean(Pickler.java:603) 
        net.razorvine.pickle.Pickler.dispatch(Pickler.java:299) 
        net.razorvine.pickle.Pickler.save(Pickler.java:125) 
        net.razorvine.pickle.Pickler.put_map(Pickler.java:321) 
        net.razorvine.pickle.Pickler.dispatch(Pickler.java:286) 
        net.razorvine.pickle.Pickler.save(Pickler.java:125) 
        net.razorvine.pickle.Pickler.put_arrayOfObjects(Pickler.java:412) 
        net.razorvine.pickle.Pickler.dispatch(Pickler.java:195) 
        net.razorvine.pickle.Pickler.save(Pickler.java:125) 
        net.razorvine.pickle.Pickler.put_arrayOfObjects(Pickler.java:412) 
        net.razorvine.pickle.Pickler.dispatch(Pickler.java:195) 
        net.razorvine.pickle.Pickler.save(Pickler.java:125) 
        net.razorvine.pickle.Pickler.dump(Pickler.java:95) 
        net.razorvine.pickle.Pickler.dumps(Pickler.java:80) 
        org.apache.spark.sql.SchemaRDD$$anonfun$javaToPython$1$$anonfun$apply$2.apply(SchemaRDD.scala:417) 
        org.apache.spark.sql.SchemaRDD$$anonfun$javaToPython$1$$anonfun$apply$2.apply(SchemaRDD.scala:417) 
        scala.collection.Iterator$$anon$11.next(Iterator.scala:328) 
        org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:331) 
        org.apache.spark.api.python.PythonRDD$WriterThread$$anonfun$run$1.apply$mcV$sp(PythonRDD.scala:209) 
        org.apache.spark.api.python.PythonRDD$WriterThread$$anonfun$run$1.apply(PythonRDD.scala:184) 
        org.apache.spark.api.python.PythonRDD$WriterThread$$anonfun$run$1.apply(PythonRDD.scala:184) 
        org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1311) 
        org.apache.spark.api.python.PythonRDD$WriterThread.run(PythonRDD.scala:183) 
Driver stacktrace: 
        at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1185) 
        at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1174) 
        at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1173) 
        at scala.collection.mutable.ResizableArray$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreach(ResizableArray.scala:59) 
        at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47) 
        at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1173) 
        at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:688) 
        at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:688) 
        at scala.Option.foreach(Option.scala:236) 
        at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:688) 
        at org.apache.spark.scheduler.DAGSchedulerEventProcessActor$$anonfun$receive$2.applyOrElse(DAGScheduler.scala:1391) 
        at akka.actor.ActorCell.receiveMessage(ActorCell.scala:498) 
        at akka.actor.ActorCell.invoke(ActorCell.scala:456) 
        at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:237) 
        at akka.dispatch.Mailbox.run(Mailbox.scala:219) 
        at akka.dispatch.ForkJoinExecutorConfigurator$AkkaForkJoinTask.exec(AbstractDispatcher.scala:386) 
        at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260) 
        at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339) 
        at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979) 
        at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12762122">SPARK-4866</key>
            <summary>Support StructType as key in MapType</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="davies">Davies Liu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Dec 2014 21:18:18 +0000</created>
                <updated>Tue, 5 May 2015 15:34:05 +0000</updated>
                            <resolved>Wed, 17 Dec 2014 05:26:12 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                                    <component>PySpark</component>
                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14249012" author="apachespark" created="Tue, 16 Dec 2014 21:43:11 +0000"  >&lt;p&gt;User &apos;davies&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/3714&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/3714&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14249498" author="marmbrus" created="Wed, 17 Dec 2014 05:26:12 +0000"  >&lt;p&gt;Issue resolved by pull request 3714&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/3714&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/3714&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14528666" author="lisbethron" created="Tue, 5 May 2015 15:34:05 +0000"  >&lt;p&gt;Hi Guys, &lt;/p&gt;

&lt;p&gt;I&apos;m dealing with a situation, working on Spark 1.3.1 with dataframes to train a random forest algorithm with Mmlib and Python Spark. And I have this error, I don&apos;t know where its comes from... somebody can Help me.?&lt;/p&gt;

&lt;p&gt;Thanks &lt;/p&gt;

&lt;p&gt;Lisbeth&lt;/p&gt;


&lt;p&gt;  File &quot;/opt/mapr/spark/spark-1.3.1-bin-mapr4/python/lib/py4j-0.8.2.1-src.zip/py4j/protocol.py&quot;, line 300, in get_return_value&lt;br/&gt;
py4j.protocol.Py4JJavaError: An error occurred while calling o58.sql.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 29 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i23hyf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327642">1.3.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>