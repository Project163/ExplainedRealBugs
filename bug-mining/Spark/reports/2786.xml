<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:35:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-11818] ExecutorClassLoader cannot see any resources from parent class loader</title>
                <link>https://issues.apache.org/jira/browse/SPARK-11818</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;This issue starts from finding root reason from strange problem from spark-shell (and zeppelin) which is not a problem for spark-submit.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://mail-archives.apache.org/mod_mbox/spark-user/201511.mbox/%3CCAF5108jMXyOjiGmCgr%3Ds%2BNvTMcyKWMBVM1GsrH7Pz4xUj48LfA%40mail.gmail.com%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://mail-archives.apache.org/mod_mbox/spark-user/201511.mbox/%3CCAF5108jMXyOjiGmCgr%3Ds%2BNvTMcyKWMBVM1GsrH7Pz4xUj48LfA%40mail.gmail.com%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;After some hours (over days) digging into the detail, I found that ExecutorClassLoader cannot see any resource files which can be seen from parent class loader.&lt;br/&gt;
ExecutorClassLoader itself doesn&apos;t need to lookup resource files cause REPL doesn&apos;t generate these, but it should delegate lookup to parent class loader.&lt;/p&gt;

&lt;p&gt;I&apos;ll provide the pull request which includes tests which fails on master soon.&lt;/p&gt;</description>
                <environment>&lt;p&gt;CentOS 6, spark 1.4.1-hadoop2.4, mesos 0.22.1&lt;/p&gt;</environment>
        <key id="12914127">SPARK-11818</key>
            <summary>ExecutorClassLoader cannot see any resources from parent class loader</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kabhwan">Jungtaek Lim</assignee>
                                    <reporter username="kabhwan">Jungtaek Lim</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Nov 2015 15:01:06 +0000</created>
                <updated>Tue, 24 Nov 2015 17:21:46 +0000</updated>
                            <resolved>Tue, 24 Nov 2015 17:21:46 +0000</resolved>
                                    <version>1.4.1</version>
                                    <fixVersion>1.6.0</fixVersion>
                                    <component>Spark Shell</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15011143" author="srowen" created="Wed, 18 Nov 2015 15:03:58 +0000"  >&lt;p&gt;I&apos;m not clear that&apos;s the problem given your description. This just shows you don&apos;t have hbase config in the classpath. Is it in your assembly jar?&lt;/p&gt;

&lt;p&gt;The REPL classloader should be a child of the one containing your app jar.&lt;/p&gt;</comment>
                            <comment id="15011168" author="kabhwan" created="Wed, 18 Nov 2015 15:17:10 +0000"  >&lt;p&gt;Yes, assembly jar has HBase libs, and unzipped assembly jar has hbase-default.xml (because it is one of files in hbase-common lib).&lt;/p&gt;

&lt;p&gt;I attached assembly jar by --jars options, and run some codes which initializes HBase configuration from &quot;Executor side&quot;.&lt;br/&gt;
Executor found &quot;spark.repl.class.uri&quot; config, and replace current thread&apos;s context class loader to ExecutorClassLoader, which has URLClassLoader to parent class loader.&lt;/p&gt;

&lt;p&gt;Assembly jar is loaded to parent class loader via Executor.updateDependencies(), and ExecutorClassLoader can see classes from parent class loader so there&apos;re no issue to load classes.&lt;br/&gt;
But HBaseConfiguration.addHbaseResources() tries to load hbase-default.xml from classloader which seems not succeed.&lt;/p&gt;</comment>
                            <comment id="15011202" author="kabhwan" created="Wed, 18 Nov 2015 15:30:32 +0000"  >&lt;p&gt;One thing to note is, &lt;br/&gt;
if I remove &quot;spark.repl.class.uri&quot; config to SparkConf, and create new SparkContext with new SparkConf, and use new sc to run codes, it runs normally.&lt;br/&gt;
Without removing &quot;spark.repl.class.uri&quot;, creating new SparkConf / SparkContext doesn&apos;t help.&lt;/p&gt;

&lt;p&gt;Let me explain to the point.&lt;/p&gt;

&lt;p&gt;ExecutorClassLoader extends ClassLoader with no parent. It just has parent class loader as a field wrapped to ParentClassLoader.&lt;br/&gt;
ExecutorClassLoader overrides findClass() which interacts with parent class loader so there&apos;s no problem loading classes. But ExecutorClassLoader doesn&apos;t override methods related to resources, so we can&apos;t find any resources from ExecutorClassLoader although parent class loader can find them.&lt;/p&gt;

&lt;p&gt;May pull request makes it more clear.&lt;/p&gt;</comment>
                            <comment id="15011216" author="apachespark" created="Wed, 18 Nov 2015 15:38:05 +0000"  >&lt;p&gt;User &apos;HeartSaVioR&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9812&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9812&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15011223" author="kabhwan" created="Wed, 18 Nov 2015 15:42:31 +0000"  >&lt;p&gt;Removed &quot;REPL&quot; from title since it could confuse us to ExecutorClassLoader is a REPL classloader. &lt;br/&gt;
It is a classloader for &quot;executor&quot; which is only used for REPL environment.&lt;/p&gt;</comment>
                            <comment id="15012591" author="kabhwan" created="Thu, 19 Nov 2015 01:51:05 +0000"  >&lt;p&gt;More information: I resolved the origin issue I affected via using custom build of Spark 1.4.1 + PR 9812.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2okxz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>