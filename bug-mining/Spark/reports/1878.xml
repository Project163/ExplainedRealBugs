<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:27:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-6246] spark-ec2 can&apos;t handle clusters with &gt; 100 nodes</title>
                <link>https://issues.apache.org/jira/browse/SPARK-6246</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;This appears to be a new restriction, perhaps resulting from our upgrade of boto. Maybe it&apos;s a new restriction from EC2. Not sure yet.&lt;/p&gt;

&lt;p&gt;We didn&apos;t have this issue around the Spark 1.1.0 time frame from what I can remember. I&apos;ll track down where the issue is and when it started.&lt;/p&gt;

&lt;p&gt;Attempting to launch a cluster with 100 slaves yields the following:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Spark AMI: ami-35b1885c
Launching instances...
Launched 100 slaves in us-east-1c, regid = r-9c408776
Launched master in us-east-1c, regid = r-92408778
Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; AWS to propagate instance metadata...
Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; cluster to enter &lt;span class=&quot;code-quote&quot;&gt;&apos;ssh-ready&apos;&lt;/span&gt; state.ERROR:boto:400 Bad Request
ERROR:boto:&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;Response&amp;gt;&amp;lt;Errors&amp;gt;&amp;lt;Error&amp;gt;&amp;lt;Code&amp;gt;InvalidRequest&amp;lt;/Code&amp;gt;&amp;lt;Message&amp;gt;101 exceeds the maximum number of instance IDs that can be specificied (100). Please specify fewer than 100 instance IDs.&amp;lt;/Message&amp;gt;&amp;lt;/Error&amp;gt;&amp;lt;/Errors&amp;gt;&amp;lt;RequestID&amp;gt;217fd6ff-9afa-4e91-86bc-ab16fcc442d8&amp;lt;/RequestID&amp;gt;&amp;lt;/Response&amp;gt;
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;./ec2/spark_ec2.py&quot;&lt;/span&gt;, line 1338, in &amp;lt;module&amp;gt;
    main()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;./ec2/spark_ec2.py&quot;&lt;/span&gt;, line 1330, in main
    real_main()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;./ec2/spark_ec2.py&quot;&lt;/span&gt;, line 1170, in real_main
    cluster_state=&lt;span class=&quot;code-quote&quot;&gt;&apos;ssh-ready&apos;&lt;/span&gt;
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;./ec2/spark_ec2.py&quot;&lt;/span&gt;, line 795, in wait_for_cluster_state
    statuses = conn.get_all_instance_status(instance_ids=[i.id &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; i in cluster_instances])
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/path/apache/spark/ec2/lib/boto-2.34.0/boto/ec2/connection.py&quot;&lt;/span&gt;, line 737, in get_all_instance_status
    InstanceStatusSet, verb=&lt;span class=&quot;code-quote&quot;&gt;&apos;POST&apos;&lt;/span&gt;)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/path/apache/spark/ec2/lib/boto-2.34.0/boto/connection.py&quot;&lt;/span&gt;, line 1204, in get_object
    raise self.ResponseError(response.status, response.reason, body)
boto.exception.EC2ResponseError: EC2ResponseError: 400 Bad Request
&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;Response&amp;gt;&amp;lt;Errors&amp;gt;&amp;lt;Error&amp;gt;&amp;lt;Code&amp;gt;InvalidRequest&amp;lt;/Code&amp;gt;&amp;lt;Message&amp;gt;101 exceeds the maximum number of instance IDs that can be specificied (100). Please specify fewer than 100 instance IDs.&amp;lt;/Message&amp;gt;&amp;lt;/Error&amp;gt;&amp;lt;/Errors&amp;gt;&amp;lt;RequestID&amp;gt;217fd6ff-9afa-4e91-86bc-ab16fcc442d8&amp;lt;/RequestID&amp;gt;&amp;lt;/Response&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This problem seems to be with &lt;tt&gt;get_all_instance_status()&lt;/tt&gt;, though I am not sure if other methods are affected too.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12780870">SPARK-6246</key>
            <summary>spark-ec2 can&apos;t handle clusters with &gt; 100 nodes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="alyaxey">Alex Slusarenko</assignee>
                                    <reporter username="nchammas">Nicholas Chammas</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Mar 2015 14:35:47 +0000</created>
                <updated>Fri, 22 May 2015 17:14:22 +0000</updated>
                            <resolved>Tue, 19 May 2015 23:46:37 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>EC2</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14354969" author="nchammas" created="Tue, 10 Mar 2015 14:36:14 +0000"  >&lt;p&gt;FYI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shivaram&quot; class=&quot;user-hover&quot; rel=&quot;shivaram&quot;&gt;shivaram&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14355004" author="srowen" created="Tue, 10 Mar 2015 14:55:39 +0000"  >&lt;p&gt;The funny thing is, the typo in that error message (&quot;specificied&quot;) makes it easy to find some corroboration:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/skavanagh/EC2Box/issues/8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/skavanagh/EC2Box/issues/8&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/worksap-ate/aws-sdk/issues/139&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/worksap-ate/aws-sdk/issues/139&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Looks like an AWS SDK limit? &lt;/p&gt;</comment>
                            <comment id="14355403" author="shivaram" created="Tue, 10 Mar 2015 18:23:56 +0000"  >&lt;p&gt;Hmm - This seems like a bad problem. And it looks like a AWS side change rather than a boto change I guess.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nchammas&quot; class=&quot;user-hover&quot; rel=&quot;nchammas&quot;&gt;nchammas&lt;/a&gt; Similar to the EC2Box issue above, can we also batch calls to `get_instances` 100 instances at a time ?&lt;/p&gt;</comment>
                            <comment id="14355642" author="nchammas" created="Tue, 10 Mar 2015 20:32:00 +0000"  >&lt;p&gt;I dunno, I haven&apos;t looked into the problem yet (been out all day), but I&apos;m surprised that everything else works with &amp;gt; 100 nodes: creating nodes, destroying them, getting them. It&apos;s just the status check call.&lt;/p&gt;

&lt;p&gt;If we have to, sure I&apos;ll batch the calls. But I suspect there&apos;s a better way to do things. I&apos;m surprised boto doesn&apos;t just abstract this problem away.&lt;/p&gt;

&lt;p&gt;Anyway, I&apos;ll look into it and report back.&lt;/p&gt;</comment>
                            <comment id="14547501" author="shivaram" created="Mon, 18 May 2015 03:42:20 +0000"  >&lt;p&gt;I just ran into this problem as well. This definitely does not happen with some of the older versions of the script. &lt;/p&gt;</comment>
                            <comment id="14550637" author="alyaxey" created="Tue, 19 May 2015 15:36:45 +0000"  >&lt;p&gt;This can be fixed by replacing the line in file ec2/spark_ec2.py&lt;/p&gt;

&lt;p&gt;        statuses = conn.get_all_instance_status(instance_ids=&lt;span class=&quot;error&quot;&gt;&amp;#91;i.id for i in cluster_instances&amp;#93;&lt;/span&gt;)&lt;/p&gt;

&lt;p&gt;with the lines:&lt;/p&gt;

&lt;p&gt;        max_batch = 100&lt;br/&gt;
        statuses = []&lt;br/&gt;
        for j in range((len(cluster_instances) + max_batch - 1) // max_batch):&lt;br/&gt;
            statuses.extend(conn.get_all_instance_status(instance_ids=[i.id for i in cluster_instances&lt;span class=&quot;error&quot;&gt;&amp;#91;j * max_batch:(j + 1) * max_batch&amp;#93;&lt;/span&gt;]))&lt;/p&gt;</comment>
                            <comment id="14550652" author="shivaram" created="Tue, 19 May 2015 15:51:24 +0000"  >&lt;p&gt;Could you send a PR for this ?&lt;/p&gt;</comment>
                            <comment id="14551150" author="apachespark" created="Tue, 19 May 2015 20:24:02 +0000"  >&lt;p&gt;User &apos;alyaxey&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/6267&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/6267&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14551157" author="alyaxey" created="Tue, 19 May 2015 20:29:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shivaram&quot; class=&quot;user-hover&quot; rel=&quot;shivaram&quot;&gt;shivaram&lt;/a&gt; Done. This is my first PR. Do I have to do anything else to contribute to this ticket?&lt;/p&gt;</comment>
                            <comment id="14551483" author="shivaram" created="Tue, 19 May 2015 23:46:37 +0000"  >&lt;p&gt;Issue resolved by pull request 6267&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/6267&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/6267&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14551486" author="shivaram" created="Tue, 19 May 2015 23:47:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srowen&quot; class=&quot;user-hover&quot; rel=&quot;srowen&quot;&gt;srowen&lt;/a&gt; Could you add &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alyaxey&quot; class=&quot;user-hover&quot; rel=&quot;alyaxey&quot;&gt;alyaxey&lt;/a&gt; to the developers group and assign this issue ?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i26kzj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>