<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:17:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-2890] Spark SQL should allow SELECT with duplicated columns</title>
                <link>https://issues.apache.org/jira/browse/SPARK-2890</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Spark reported error java.lang.IllegalArgumentException with messages:&lt;/p&gt;

&lt;p&gt;java.lang.IllegalArgumentException: requirement failed: Found fields with the same name.&lt;br/&gt;
        at scala.Predef$.require(Predef.scala:233)&lt;br/&gt;
        at org.apache.spark.sql.catalyst.types.StructType.&amp;lt;init&amp;gt;(dataTypes.scala:317)&lt;br/&gt;
        at org.apache.spark.sql.catalyst.types.StructType$.fromAttributes(dataTypes.scala:310)&lt;br/&gt;
        at org.apache.spark.sql.parquet.ParquetTypesConverter$.convertToString(ParquetTypes.scala:306)&lt;br/&gt;
        at org.apache.spark.sql.parquet.ParquetTableScan.execute(ParquetTableOperations.scala:83)&lt;br/&gt;
        at org.apache.spark.sql.execution.Filter.execute(basicOperators.scala:57)&lt;br/&gt;
        at org.apache.spark.sql.execution.SparkPlan.executeCollect(SparkPlan.scala:85)&lt;br/&gt;
        at org.apache.spark.sql.SchemaRDD.collect(SchemaRDD.scala:433)&lt;/p&gt;

&lt;p&gt;After trial and error, it seems it&apos;s caused by duplicated columns in my select clause.&lt;/p&gt;

&lt;p&gt;I made the duplication on purpose for my code to parse correctly. I think we should allow users to specify duplicated columns as return value.&lt;/p&gt;

&lt;p&gt;Jianshi&lt;/p&gt;</description>
                <environment></environment>
        <key id="12732433">SPARK-2890</key>
            <summary>Spark SQL should allow SELECT with duplicated columns</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="marmbrus">Michael Armbrust</assignee>
                                    <reporter username="huangjs">Jianshi Huang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Aug 2014 00:17:20 +0000</created>
                <updated>Fri, 3 Jul 2015 18:32:19 +0000</updated>
                            <resolved>Tue, 16 Sep 2014 18:43:09 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.2.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14088939" author="huangjs" created="Thu, 7 Aug 2014 07:20:31 +0000"  >&lt;p&gt;In previous versions, there was no warnings but the result is buggy which contains nulls in duplicated columns.&lt;/p&gt;

&lt;p&gt;Jianshi&lt;/p&gt;</comment>
                            <comment id="14093119" author="yhuai" created="Mon, 11 Aug 2014 18:34:24 +0000"  >&lt;p&gt;What is the semantic when you have columns with same names?&lt;/p&gt;</comment>
                            <comment id="14093746" author="huangjs" created="Tue, 12 Aug 2014 05:08:57 +0000"  >&lt;p&gt;My use case:&lt;/p&gt;

&lt;p&gt;The result will be parsed into (id, type, start, end, properties) tuples. Properties might or might not contain any of (id, type, start end). So it&apos;s easier just to list them at the end and not to worry about duplicated names.&lt;/p&gt;

&lt;p&gt;Jianshi&lt;/p&gt;</comment>
                            <comment id="14095224" author="huangjs" created="Wed, 13 Aug 2014 06:58:33 +0000"  >&lt;p&gt;I think the fault is on my side. I should&apos;ve changed project the duplicated columns into different names.&lt;/p&gt;

&lt;p&gt;So the current behavior makes sense. I&apos;ll close this issue.&lt;/p&gt;

&lt;p&gt;Jianshi&lt;/p&gt;</comment>
                            <comment id="14115939" author="marmbrus" created="Fri, 29 Aug 2014 22:12:34 +0000"  >&lt;p&gt;There are cases where this does actually make it impossible to read data.  For example when you are trying read a schema that becomes ambiguous due to case insensitive resolution. So I think we should do something here.&lt;/p&gt;</comment>
                            <comment id="14115944" author="apachespark" created="Fri, 29 Aug 2014 22:15:41 +0000"  >&lt;p&gt;User &apos;marmbrus&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/2209&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/2209&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14116169" author="yhuai" created="Sat, 30 Aug 2014 01:52:36 +0000"  >&lt;p&gt;Do we also want to handle ambiguity introduced by join?&lt;/p&gt;

&lt;p&gt;For example, &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; t1 (&lt;span class=&quot;code-keyword&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;string&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; t2 (&lt;span class=&quot;code-keyword&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;string&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; x.&lt;span class=&quot;code-keyword&quot;&gt;key&lt;/span&gt;, x.&lt;span class=&quot;code-keyword&quot;&gt;value&lt;/span&gt;, y.&lt;span class=&quot;code-keyword&quot;&gt;key&lt;/span&gt;, y.&lt;span class=&quot;code-keyword&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; t1 &lt;span class=&quot;code-keyword&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;OUTER&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;JOIN&lt;/span&gt; t2 &lt;span class=&quot;code-keyword&quot;&gt;ON&lt;/span&gt; (t1.&lt;span class=&quot;code-keyword&quot;&gt;key&lt;/span&gt; = t2.&lt;span class=&quot;code-keyword&quot;&gt;key&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For this kind of cases, there will be an exception when users try to get the schema of the result SchemaRDD. I feel it is better to keep the exception and ask users to use AS to rename those columns.&lt;/p&gt;</comment>
                            <comment id="14283958" author="btiernay" created="Tue, 20 Jan 2015 16:02:43 +0000"  >&lt;p&gt;What if you request &lt;tt&gt;SELECT x.&amp;#42;, y.&amp;#42;&lt;/tt&gt;? If there are 20 columns on each side, is the user required to specify them all?&lt;/p&gt;</comment>
                            <comment id="14284012" author="yhuai" created="Tue, 20 Jan 2015 17:00:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=btiernay&quot; class=&quot;user-hover&quot; rel=&quot;btiernay&quot;&gt;btiernay&lt;/a&gt; Oh, seems the comments thread of this JIRA is not quite clear on if this issue has been resolved. Actually, we have relaxed this restriction (&lt;a href=&quot;https://github.com/apache/spark/pull/2209/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/2209/files&lt;/a&gt; is the change). &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12842612">SPARK-8817</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>410461</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 44 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ymav:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>410455</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12326686">1.1.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>