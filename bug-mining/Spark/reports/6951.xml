<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:09:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-30556] Copy sparkContext.localproperties to child thread inSubqueryExec.executionContext</title>
                <link>https://issues.apache.org/jira/browse/SPARK-30556</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Local properties set via sparkContext are not available as TaskContext properties when executing&#160; jobs and threadpools have idle threads which are reused&lt;/p&gt;

&lt;p&gt;Explanation:&lt;br/&gt;
When SubqueryExec, the&#160;&lt;tt&gt;relationFuture&lt;/tt&gt;&#160;is evaluated via a separate thread. The threads inherit the&#160;&lt;tt&gt;localProperties&lt;/tt&gt;&#160;from sparkContext as they are the child threads.&lt;br/&gt;
These threads are controlled via the executionContext (thread pools). Each Thread pool has a default&#160;&lt;tt&gt;keepAliveSeconds&lt;/tt&gt;&#160;of 60 seconds for idle threads.&lt;br/&gt;
Scenarios where the thread pool has threads which are idle and reused for a subsequent new query, the thread local properties will not be inherited from spark context (thread properties are inherited only on thread creation) hence end up having old or no properties set. This will cause taskset properties to be missing when properties are transferred by child thread via&#160;&lt;tt&gt;sparkContext.runJob/submitJob&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13280187">SPARK-30556</key>
            <summary>Copy sparkContext.localproperties to child thread inSubqueryExec.executionContext</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ajithshetty">Ajith S</assignee>
                                    <reporter username="ajithshetty">Ajith S</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Jan 2020 17:08:44 +0000</created>
                <updated>Thu, 20 Feb 2020 04:16:41 +0000</updated>
                            <resolved>Thu, 23 Jan 2020 02:21:40 +0000</resolved>
                                    <version>2.3.4</version>
                    <version>2.4.4</version>
                    <version>3.0.0</version>
                                    <fixVersion>2.4.5</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17021418" author="dongjoon" created="Wed, 22 Jan 2020 19:26:15 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ajithshetty&quot; class=&quot;user-hover&quot; rel=&quot;ajithshetty&quot;&gt;ajithshetty&lt;/a&gt;.&lt;br/&gt;
This looks important. Could you check the older Spark versions like 2.3.x and 2.2.x, too? &lt;/p&gt;</comment>
                            <comment id="17021691" author="dongjoon" created="Thu, 23 Jan 2020 02:21:40 +0000"  >&lt;p&gt;Issue resolved by pull request 27267&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/27267&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/27267&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17021936" author="ajithshetty" created="Thu, 23 Jan 2020 10:29:18 +0000"  >&lt;p&gt;Raised backport PR for branch 2.4&#160;&lt;a href=&quot;https://github.com/apache/spark/pull/27340&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/27340&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17021937" author="ajithshetty" created="Thu, 23 Jan 2020 10:29:37 +0000"  >&lt;p&gt;Yes, it exist in lower version like 2.3.x too&lt;/p&gt;</comment>
                            <comment id="17022273" author="dongjoon" created="Thu, 23 Jan 2020 17:02:56 +0000"  >&lt;p&gt;Thank you for confirming, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ajithshetty&quot; class=&quot;user-hover&quot; rel=&quot;ajithshetty&quot;&gt;ajithshetty&lt;/a&gt;.&lt;br/&gt;
This is backported to branch-2.4 via &lt;a href=&quot;https://github.com/apache/spark/pull/27340&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/27340&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0amlc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>