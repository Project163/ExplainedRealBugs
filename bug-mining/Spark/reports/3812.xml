<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:45:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-16230] Executors self-killing after being assigned tasks while still in init</title>
                <link>https://issues.apache.org/jira/browse/SPARK-16230</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I see this happening frequently in our prod clusters:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;EXECUTOR:   &lt;a href=&quot;https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/executor/CoarseGrainedExecutorBackend.scala#L61&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CoarseGrainedExecutorBackend&lt;/a&gt; sends request to register itself to the driver.&lt;/li&gt;
	&lt;li&gt;DRIVER: Registers executor and &lt;a href=&quot;https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/scheduler/cluster/CoarseGrainedSchedulerBackend.scala#L179&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;replies&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;EXECUTOR:  ExecutorBackend receives ACK and &lt;a href=&quot;https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/executor/CoarseGrainedExecutorBackend.scala#L81&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;starts creating an Executor&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;DRIVER:  Tries to launch a task as it knows there is a new executor. Sends a &lt;a href=&quot;https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/scheduler/cluster/CoarseGrainedSchedulerBackend.scala#L268&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;LaunchTask&lt;/a&gt; to this new executor.&lt;/li&gt;
	&lt;li&gt;EXECUTOR:  Executor is not init&apos;ed (one of the reasons I have seen is because it was still trying to register to local external shuffle service). Meanwhile, receives a `LaunchTask`. &lt;a href=&quot;https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/executor/CoarseGrainedExecutorBackend.scala#L90&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Kills itself&lt;/a&gt; as Executor is not init&apos;ed.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The driver assumes that Executor is ready to accept tasks as soon as it is registered but thats not true.&lt;/p&gt;

&lt;p&gt;How this affects jobs / cluster:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;We waste time + resources with these executors but they don&apos;t do any meaningful computation.&lt;/li&gt;
	&lt;li&gt;Driver thinks that the executor has started running the task but since the Executor has self killed, it does not tell driver (BTW: this is also another issue which I think could be fixed separately). Driver waits for 10 mins and then declares the executor dead. This adds up to the latency of the job. Plus, failure attempts also gets bumped up for the tasks despite the tasks were never started. For unlucky tasks, this might cause the job failure.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12983898">SPARK-16230</key>
            <summary>Executors self-killing after being assigned tasks while still in init</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tejasp">Tejas Patil</assignee>
                                    <reporter username="tejasp">Tejas Patil</reporter>
                        <labels>
                    </labels>
                <created>Mon, 27 Jun 2016 18:58:24 +0000</created>
                <updated>Wed, 20 Jul 2016 02:31:43 +0000</updated>
                            <resolved>Fri, 15 Jul 2016 21:28:55 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Spark Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="15351636" author="tejasp" created="Mon, 27 Jun 2016 19:20:48 +0000"  >&lt;p&gt;For now, I can think of these two options:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Change scheduler to not launch tasks on executors until it sees the first heatbeat from the executor.&lt;br/&gt;
OR&lt;/li&gt;
	&lt;li&gt;Queue the `LaunchTask` events if `RegisteredExecutor` was received but the Executor is not up. The change will be completely in the executor side.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15354280" author="jerryshao" created="Wed, 29 Jun 2016 02:14:13 +0000"  >&lt;p&gt;I&apos;m not sure which version Spark are you using? Here is a similar JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-13112&quot; title=&quot;CoarsedExecutorBackend register to driver should wait Executor was ready&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-13112&quot;&gt;&lt;del&gt;SPARK-13112&lt;/del&gt;&lt;/a&gt; address the same issue and it is already fixed (2.0.0). If you&apos;re using lower version of Spark you could backport this patch to see if this issue still occurs.&lt;/p&gt;</comment>
                            <comment id="15355339" author="tejasp" created="Wed, 29 Jun 2016 14:39:12 +0000"  >&lt;p&gt;I am using 1.6.1. I will try out with the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-13112&quot; title=&quot;CoarsedExecutorBackend register to driver should wait Executor was ready&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-13112&quot;&gt;&lt;del&gt;SPARK-13112&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15377055" author="tejasp" created="Thu, 14 Jul 2016 14:46:43 +0000"  >&lt;p&gt;With the fix from &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-13112&quot; title=&quot;CoarsedExecutorBackend register to driver should wait Executor was ready&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-13112&quot;&gt;&lt;del&gt;SPARK-13112&lt;/del&gt;&lt;/a&gt;, I see that `LaunchTask` is always processed after `RegisteredExecutor` is done and so it gets chance to do all retries to startup an executor. There is still a problem that if `Executor` creation itself fails and there is some exception, it gets unnoticed and the executor is killed when it tries to process the `LaunchTask` as `executor` is null : &lt;a href=&quot;https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/executor/CoarseGrainedExecutorBackend.scala#L88&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/executor/CoarseGrainedExecutorBackend.scala#L88&lt;/a&gt; So if one looks at the logs, it does not tell that there was problem during `Executor` creation and thats why it was killed. This needs to be made better.&lt;/p&gt;

&lt;p&gt;PS: This jira is marked as duplicate. Not sure if I should continue the discussion over here OR create a new one.&lt;/p&gt;</comment>
                            <comment id="15377065" author="apachespark" created="Thu, 14 Jul 2016 14:52:04 +0000"  >&lt;p&gt;User &apos;tejasapatil&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14202&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14202&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12935606">SPARK-13112</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i307ev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>