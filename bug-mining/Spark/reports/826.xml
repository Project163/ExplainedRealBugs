<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:18:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-3627] spark on yarn reports success even though job fails</title>
                <link>https://issues.apache.org/jira/browse/SPARK-3627</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I was running a wordcount and saving the output to hdfs.  If the output directory already exists, yarn reports success even though the job fails since it requires the output directory to not be there.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12743046">SPARK-3627</key>
            <summary>spark on yarn reports success even though job fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tgraves">Thomas Graves</assignee>
                                    <reporter username="tgraves">Thomas Graves</reporter>
                        <labels>
                    </labels>
                <created>Sun, 21 Sep 2014 21:16:51 +0000</created>
                <updated>Wed, 16 Oct 2019 04:46:37 +0000</updated>
                            <resolved>Tue, 7 Oct 2014 14:52:02 +0000</resolved>
                                    <version>1.2.0</version>
                                    <fixVersion>1.2.0</fixVersion>
                                    <component>YARN</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14143438" author="tgraves" created="Mon, 22 Sep 2014 17:11:17 +0000"  >&lt;p&gt;We could make this a separate issue, but I&apos;ve also seen it report failure when it actually succeeded.  In that case I believe it did an sc.stop() and System.exit(0). &lt;/p&gt;
</comment>
                            <comment id="14143523" author="tgraves" created="Mon, 22 Sep 2014 17:51:31 +0000"  >&lt;p&gt;this might be the same as &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-3293&quot; title=&quot;yarn&amp;#39;s web show &amp;quot;SUCCEEDED&amp;quot; when the driver throw a exception in yarn-client&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-3293&quot;&gt;&lt;del&gt;SPARK-3293&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14150013" author="tgraves" created="Fri, 26 Sep 2014 21:29:03 +0000"  >&lt;p&gt;I&apos;m going to go through all the exit and status reporting of yarn and clean it up. &lt;/p&gt;

&lt;p&gt;Here is what I plan on handling:&lt;/p&gt;

&lt;p&gt;In all cases make sure stagingDirectory cleaned up, useful messages in log file, RM status correct, and exit code non-zero on failure, user thread stopped &lt;/p&gt;

&lt;p&gt;Things to check and expected results. Assume yarn configured to retries Applications 3 times on failure.&lt;/p&gt;

&lt;p&gt;cluster mode:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;spark context not initialized 100 seconds - not registered yet so just fail after 3 retries&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;client mode:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;spark driver doesn&apos;t respond in 100 seconds - failed after 3 retires&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Both modes:  &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;issues registering AM -  retries 3 and FAIL&lt;/li&gt;
	&lt;li&gt;issues allocating resources - retries 3 and FAIL&lt;/li&gt;
	&lt;li&gt;max exceptions during allocate loop in reporter thread - retries 3 and fail&lt;/li&gt;
	&lt;li&gt;max executor failures - FAIL after 3 retries&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;cluster UserClass:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;system.exit(0) - success&lt;/li&gt;
	&lt;li&gt;clean exit main - success&lt;/li&gt;
	&lt;li&gt;system.exit(1)  - fail, 3 tries&lt;/li&gt;
	&lt;li&gt;system.exit(-1) - fail, 3 tries&lt;/li&gt;
	&lt;li&gt;throws exception - fail 3 tries&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;client UserClass:  (fixing client mode isn&apos;t handled here as I think its best just to change it to unmanaged AM)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;system.exit(0) - succeeds&lt;/li&gt;
	&lt;li&gt;clean exit main -succeeds&lt;/li&gt;
	&lt;li&gt;system.exit(1)  - succeeds&lt;/li&gt;
	&lt;li&gt;system.exit(-1) - succeeds&lt;/li&gt;
	&lt;li&gt;throws exception - succeeds&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14151784" author="apachespark" created="Mon, 29 Sep 2014 15:20:26 +0000"  >&lt;p&gt;User &apos;tgravescs&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/2577&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/2577&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14153558" author="tgraves" created="Tue, 30 Sep 2014 18:53:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrewor&quot; class=&quot;user-hover&quot; rel=&quot;andrewor&quot;&gt;andrewor&lt;/a&gt;  Why was the affects version changed on this?  As far as I&apos;m aware this is a result of the refactoring done in spark 1.2 so this does not exist in spark 1.1.&lt;/p&gt;</comment>
                            <comment id="14153758" author="andrewor14" created="Tue, 30 Sep 2014 21:14:21 +0000"  >&lt;p&gt;Did this problem not exist in 1.1? I vaguely remember seeing something similar on the mailing list even before my refactor.&lt;/p&gt;</comment>
                            <comment id="14153777" author="tgraves" created="Tue, 30 Sep 2014 21:25:52 +0000"  >&lt;p&gt;As far as I am aware the common cases worked in 1.1. I didn&apos;t do an extensive test run like I did with the pr here though so its possible some were broken.     &lt;/p&gt;

&lt;p&gt;Note there has always been the case where yarn-client mode doesn&apos;t report the correct failure case because the AM doesn&apos;t know what happened on the client side.  That isn&apos;t fixed by this jira either.&lt;/p&gt;

&lt;p&gt;I guess I propose we file a separate jira for that if there are known cases or if we just want to go do a full test run.  The code is quite different now too so would require a separate pr anyway.&lt;/p&gt;</comment>
                            <comment id="14153830" author="andrewor14" created="Tue, 30 Sep 2014 21:58:21 +0000"  >&lt;p&gt;Ok, sounds good.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12758341">SPARK-4647</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12737649">SPARK-3293</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13262206">SPARK-29465</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 7 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20b8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327369">1.2.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>