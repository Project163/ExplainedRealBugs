<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:36:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-12470] Incorrect calculation of row size in o.a.s.sql.catalyst.expressions.codegen.GenerateUnsafeRowJoiner</title>
                <link>https://issues.apache.org/jira/browse/SPARK-12470</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;While looking into &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-12319&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-12319&lt;/a&gt; I noticed that the row size is incorrectly calculated.&lt;/p&gt;

&lt;p&gt;The &quot;sizeReduction&quot; value is calculated in words:&lt;/p&gt;

&lt;p&gt;   // The number of words we can reduce when we concat two rows together.&lt;br/&gt;
    // The only reduction comes from merging the bitset portion of the two rows, saving 1 word.&lt;br/&gt;
    val sizeReduction = bitset1Words + bitset2Words - outputBitsetWords&lt;/p&gt;

&lt;p&gt;but then it is subtracted from the size of the row in bytes:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    out.pointTo(buf, ${schema1.size + schema2.size}, sizeInBytes - $sizeReduction);&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


</description>
                <environment></environment>
        <key id="12923588">SPARK-12470</key>
            <summary>Incorrect calculation of row size in o.a.s.sql.catalyst.expressions.codegen.GenerateUnsafeRowJoiner</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="robbinspg">Peter George Robbins</assignee>
                                    <reporter username="robbinspg">Peter George Robbins</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Dec 2015 22:33:23 +0000</created>
                <updated>Tue, 5 Jan 2016 21:11:55 +0000</updated>
                            <resolved>Mon, 4 Jan 2016 18:47:44 +0000</resolved>
                                    <version>1.5.2</version>
                                    <fixVersion>1.6.1</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15067201" author="apachespark" created="Mon, 21 Dec 2015 22:49:03 +0000"  >&lt;p&gt;User &apos;robbinspg&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/10421&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/10421&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15068693" author="robbinspg" created="Tue, 22 Dec 2015 20:34:05 +0000"  >&lt;p&gt;I&apos;m fairly sure the code in my PR is correct but it is causing an ExchangeCoordinatorSuite test to fail. I&apos;m struggling to see why this test is failing with the change I made. The failure is:&lt;/p&gt;

&lt;p&gt; determining the number of reducers: aggregate operator *** FAILED ***&lt;br/&gt;
 3 did not equal 2 (ExchangeCoordinatorSuite.scala:316)&lt;/p&gt;

&lt;p&gt;putting some debug into the test I see that before my change the pre-shuffle partition sizes are 600, 600, 600, 600, 600 an after my change are 800. 800. 800. 800. 720 but I have no idea why. I&apos;d really appreciate anyone with knowledge of this area a) checking my PR and b) helping explain the failing test.&lt;/p&gt;

&lt;p&gt;EDIT Please ignore. Merged with latest head including changes for &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-12388&quot; title=&quot;Change default compressor to LZ4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-12388&quot;&gt;&lt;del&gt;SPARK-12388&lt;/del&gt;&lt;/a&gt; now passes all tests&lt;/p&gt;</comment>
                            <comment id="15081560" author="davies" created="Mon, 4 Jan 2016 18:47:44 +0000"  >&lt;p&gt;Issue resolved by pull request 10421&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/10421&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/10421&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12927244">SPARK-12647</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 46 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2q6qf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>