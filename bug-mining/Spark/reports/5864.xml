<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:00:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-24950] scala DateTimeUtilsSuite daysToMillis and millisToDays fails w/java 8 181-b13</title>
                <link>https://issues.apache.org/jira/browse/SPARK-24950</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;during my travails to port the spark builds to run on ubuntu 16.04LTS, i have encountered a strange and apparently java version-specific failure on &lt;b&gt;one&lt;/b&gt; specific unit test.&lt;/p&gt;

&lt;p&gt;the failure is here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/spark-master-test-sbt-hadoop-2.6-ubuntu-test/868/testReport/junit/org.apache.spark.sql.catalyst.util/DateTimeUtilsSuite/daysToMillis_and_millisToDays/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/spark-master-test-sbt-hadoop-2.6-ubuntu-test/868/testReport/junit/org.apache.spark.sql.catalyst.util/DateTimeUtilsSuite/daysToMillis_and_millisToDays/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;the java version on this worker is:&lt;/p&gt;

&lt;p&gt;sknapp@ubuntu-testing:~$ java -version&lt;br/&gt;
 java version &quot;1.8.0_181&quot;&lt;br/&gt;
 Java(TM) SE Runtime Environment (build 1.8.0_181-b13)&lt;br/&gt;
 Java HotSpot(TM) 64-Bit Server VM (build 25.181-b13, mixed mode)&lt;/p&gt;

&lt;p&gt;however, when i run this exact build on the other ubuntu workers, it passes.&#160; they systems are set up (for the most part) identically except for the java version:&lt;/p&gt;

&lt;p&gt;sknapp@amp-jenkins-staging-worker-02:~$ java -version&lt;br/&gt;
 java version &quot;1.8.0_171&quot;&lt;br/&gt;
 Java(TM) SE Runtime Environment (build 1.8.0_171-b11)&lt;br/&gt;
 Java HotSpot(TM) 64-Bit Server VM (build 25.171-b11, mixed mode)&lt;/p&gt;

&lt;p&gt;there are some minor kernel and other package differences on these ubuntu workers, but nothing that (in my opinion) would affect this test.&#160; i am willing to help investigate this, however.&lt;/p&gt;

&lt;p&gt;the test also passes on the centos 6.9 workers, which have the following java version installed:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;sknapp@amp-jenkins-worker-05 ~&amp;#93;&lt;/span&gt;$ java -version&lt;br/&gt;
java version &quot;1.8.0_60&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.8.0_60-b27)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 25.60-b23, mixed mode)my guess is that either:&lt;/p&gt;

&lt;p&gt;sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/util/DateTimeUtils.scala&lt;/p&gt;

&lt;p&gt;or&lt;/p&gt;

&lt;p&gt;sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/util/DateTimeUtilsSuite.scala&lt;/p&gt;

&lt;p&gt;is doing something wrong.&#160; i am not a scala expert by any means, so i&apos;d really like some help in trying to un-block the project to port the builds to ubuntu.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13175244">SPARK-24950</key>
            <summary>scala DateTimeUtilsSuite daysToMillis and millisToDays fails w/java 8 181-b13</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="d80tb7">Chris Martin</assignee>
                                    <reporter username="shaneknapp">Shane Knapp</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Jul 2018 18:20:36 +0000</created>
                <updated>Wed, 23 Oct 2019 22:28:34 +0000</updated>
                            <resolved>Thu, 9 Aug 2018 22:42:14 +0000</resolved>
                                    <version>2.1.3</version>
                    <version>2.2.2</version>
                    <version>2.3.1</version>
                    <version>2.4.0</version>
                                    <fixVersion>2.1.4</fixVersion>
                    <fixVersion>2.2.3</fixVersion>
                    <fixVersion>2.3.2</fixVersion>
                    <fixVersion>2.4.0</fixVersion>
                                    <component>Build</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16560126" author="shaneknapp" created="Fri, 27 Jul 2018 18:41:36 +0000"  >&lt;p&gt;one solution, of course, is to pin the java version on the upcoming ubuntu workers to one that passes this test, but things like this make build engineers like me die a little bit inside.&lt;/p&gt;</comment>
                            <comment id="16560249" author="srowen" created="Fri, 27 Jul 2018 20:03:51 +0000"  >&lt;p&gt;It&apos;s pretty clear this is down to differences in how time zones are defined, as they change over time and the JDK incorporates updated versions of the standard definitions in each release.&#160;&lt;/p&gt;

&lt;p&gt;It looks like the difference between _171 and _181 is the difference between 2018c and 2018e in this table:&#160;&lt;a href=&quot;http://www.oracle.com/technetwork/java/javase/tzdata-versions-138805.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.oracle.com/technetwork/java/javase/tzdata-versions-138805.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Nothing obviously relevant from Oracle&apos;s release notes. But I found this in the notes for 2018d:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mm.icann.org/pipermail/tz-announce/2018-March/000049.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mm.icann.org/pipermail/tz-announce/2018-March/000049.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&quot;Enderbury and Kiritimati skipped New Year&apos;s Eve 1994, not New Year&apos;s Day 1995.&#160; (Thanks to Kerry Shetline.)&quot;&lt;/p&gt;

&lt;p&gt;So the answer is probably that the test has to be updated to reflect the fix to the timezone definition.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Of course, if the test changes, it also starts failing on older Java 8 versions! probably not worth it.&lt;/p&gt;

&lt;p&gt;I&apos;d suggest we resolve it by commenting this out with a note. There&apos;s no evidence this is a problem in Spark itself.&lt;/p&gt;</comment>
                            <comment id="16560306" author="shaneknapp" created="Fri, 27 Jul 2018 20:44:28 +0000"  >&lt;p&gt;sgtm&lt;/p&gt;

&lt;p&gt;i also dug through the java release notes WRT timezone changes and didn&apos;t find anything (which i forgot to mention).&#160; sorry about that!&#160; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;i&apos;ll start by just commenting out the failing TZ (Pacific/Enderbury) and see if that works.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16560308" author="apachespark" created="Fri, 27 Jul 2018 20:46:05 +0000"  >&lt;p&gt;User &apos;d80tb7&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/21901&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/21901&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16560312" author="d80tb7" created="Fri, 27 Jul 2018 20:48:28 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;just to say that I looked at this and came to the same conclusion as Sean.&#160; I&apos;ve submitted a PR which excludes both New Years Eve and New Years day from the test- which should mean it will work on both old and new jvms.&lt;/p&gt;</comment>
                            <comment id="16560318" author="shaneknapp" created="Fri, 27 Jul 2018 20:54:41 +0000"  >&lt;p&gt;testing this manually:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/job/spark-master-test-sbt-hadoop-2.6-ubuntu-test/878/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/job/spark-master-test-sbt-hadoop-2.6-ubuntu-test/878/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16560411" author="apachespark" created="Fri, 27 Jul 2018 22:20:06 +0000"  >&lt;p&gt;User &apos;srowen&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/21903&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/21903&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16560544" author="shaneknapp" created="Sat, 28 Jul 2018 01:43:17 +0000"  >&lt;p&gt;the spark-master-test-sbt build failed on ubuntu, but the the improtant bit is that the DateTimeUtilsSuite tests passed!&lt;/p&gt;

&lt;p&gt;back to unraveling R...&#160;&#160;:\&lt;/p&gt;

&lt;p&gt;thanks for the quick patch, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=d80tb7&quot; class=&quot;user-hover&quot; rel=&quot;d80tb7&quot;&gt;d80tb7&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16560785" author="srowen" created="Sat, 28 Jul 2018 15:41:18 +0000"  >&lt;p&gt;Issue resolved by pull request 21901&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/21901&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/21901&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16575479" author="shaneknapp" created="Thu, 9 Aug 2018 22:20:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srowen&quot; class=&quot;user-hover&quot; rel=&quot;srowen&quot;&gt;srowen&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=d80tb7&quot; class=&quot;user-hover&quot; rel=&quot;d80tb7&quot;&gt;d80tb7&lt;/a&gt; i&apos;m thinking that we actually need to backport this change to previous branches.&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://amplab.cs.berkeley.edu/jenkins/view/RISELab%20Infra/job/spark-branch-2.1-test-maven-hadoop-2.7-ubuntu-testing/2/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://amplab.cs.berkeley.edu/jenkins/view/RISELab%20Infra/job/spark-branch-2.1-test-maven-hadoop-2.7-ubuntu-testing/2/&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;- daysToMillis and millisToDays *** FAILED ***
  9131 did not equal 9130 Round trip of 9130 did not work in tz sun.util.calendar.ZoneInfo[id=&quot;Pacific/Enderbury&quot;,offset=46800000,dstSavings=0,useDaylight=false,transitions=5,lastRule=null] (DateTimeUtilsSuite.scala:554)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16575488" author="srowen" created="Thu, 9 Aug 2018 22:23:51 +0000"  >&lt;p&gt;Roger that, will back-port back to 2.1 as best I can.&lt;/p&gt;</comment>
                            <comment id="16575493" author="shaneknapp" created="Thu, 9 Aug 2018 22:26:02 +0000"  >&lt;p&gt;word.&#160; let&apos;s leave this open until for a bit longer as i continue to test.&lt;/p&gt;</comment>
                            <comment id="16575504" author="shaneknapp" created="Thu, 9 Aug 2018 22:36:22 +0000"  >&lt;p&gt;booyah!&#160; i love watching the build queue pile up.&#160; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srowen&quot; class=&quot;user-hover&quot; rel=&quot;srowen&quot;&gt;srowen&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16575521" author="shaneknapp" created="Thu, 9 Aug 2018 22:52:48 +0000"  >&lt;p&gt;do we care about 2.0 and 1.6?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13264129">SPARK-29578</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3wf5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>