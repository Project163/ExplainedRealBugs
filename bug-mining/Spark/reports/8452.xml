<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:29:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-38677] pyspark hangs in local mode running rdd map operation</title>
                <link>https://issues.apache.org/jira/browse/SPARK-38677</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;In spark 3.2.1 (spark 3.2.0 doesn&apos;t show this issue), pyspark will hang when running and RDD map operations and converting to a dataframe.&#160; Code is below to reproduce.&#160;&#160;&lt;/p&gt;

&lt;p&gt;Env:&lt;br/&gt;
spark 3.2.1 local mode, just run&#160;&lt;tt&gt;./bin/pyspark --driver-memory XXXXG --driver-cores XXXX&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;download dataset from here&#160;&lt;a href=&quot;https://rapidsai-data.s3.us-east-2.amazonaws.com/spark/mortgage.zip&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://rapidsai-data.s3.us-east-2.amazonaws.com/spark/mortgage.zip&lt;/a&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;just 200000 rows could reproduce the issue&#160;&lt;/tt&gt;&lt;tt&gt;head -n 200000 mortgage_eval_merged.csv &amp;gt; mortgage_eval_merged-small.csv&lt;/tt&gt;&lt;tt&gt;&#160;but if the input dataset is small, such 50000 rows, it works well.&lt;/tt&gt;{&lt;tt&gt;}&lt;/tt&gt;run codes below:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
path = &lt;span class=&quot;code-quote&quot;&gt;&quot;/XXXX/mortgage_eval_merged-small.csv&quot;&lt;/span&gt;
src_data = sc.textFile(path).map(lambda x:x.split(&lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;))
column_list =[&lt;span class=&quot;code-quote&quot;&gt;&apos;c1&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c2&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c3&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c4&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c5&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c6&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c7&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c8&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c9&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c10&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c11&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c12&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c13&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c14&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c15&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c16&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c17&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c18&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c19&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c20&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c21&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c22&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c23&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c24&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c25&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c26&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c27&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;c28&apos;&lt;/span&gt;]
df = spark.createDataFrame(src_data,column_list)
print(df.show(1))&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13436224">SPARK-38677</key>
            <summary>pyspark hangs in local mode running rdd map operation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ankurd">Ankur Dave</assignee>
                                    <reporter username="tgraves">Thomas Graves</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Mar 2022 17:47:02 +0000</created>
                <updated>Mon, 12 Dec 2022 18:11:11 +0000</updated>
                            <resolved>Tue, 12 Apr 2022 03:06:46 +0000</resolved>
                                    <version>3.2.1</version>
                    <version>3.3.0</version>
                                    <fixVersion>3.3.0</fixVersion>
                    <fixVersion>3.2.2</fixVersion>
                                    <component>PySpark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17513536" author="tgraves" created="Mon, 28 Mar 2022 17:53:05 +0000"  >&lt;p&gt;Note, if you kill the python.daemon process while its hung, it will return to pyspark console and have the right results.&lt;/p&gt;

&lt;p&gt;I looked through commits in 3.2.1 and it appears that this was introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-33277&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-33277&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Specifically commit &lt;a href=&quot;https://github.com/apache/spark/commit/243c321db2f02f6b4d926114bd37a6e74c2be185&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/243c321db2f02f6b4d926114bd37a6e74c2be185&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;At least I revert that commit and rebuilt and it then works.&#160; Also this did not reproduce in standalone mode so it might just be a local mode issue.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ueshin&quot; class=&quot;user-hover&quot; rel=&quot;ueshin&quot;&gt;ueshin&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ankurdave&quot; class=&quot;user-hover&quot; rel=&quot;ankurdave&quot;&gt;ankurdave&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17513727" author="gurwls223" created="Mon, 28 Mar 2022 23:59:49 +0000"  >&lt;p&gt;Thanks for the analysis, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tgraves&quot; class=&quot;user-hover&quot; rel=&quot;tgraves&quot;&gt;tgraves&lt;/a&gt;. taking a look now.&lt;/p&gt;</comment>
                            <comment id="17517063" author="apachespark" created="Mon, 4 Apr 2022 19:34:18 +0000"  >&lt;p&gt;User &apos;ankurdave&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/36065&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/36065&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17520891" author="gurwls223" created="Tue, 12 Apr 2022 03:06:46 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/spark/pull/36065&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/36065&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17521446" author="apachespark" created="Wed, 13 Apr 2022 04:54:35 +0000"  >&lt;p&gt;User &apos;HyukjinKwon&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/36172&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/36172&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 30 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10wbs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12350369">3.3.0</customfieldvalue>
    <customfieldvalue id="12351232">3.2.2</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>