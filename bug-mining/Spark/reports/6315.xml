<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:04:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-26930] Tests in ParquetFilterSuite don&apos;t verify filter class</title>
                <link>https://issues.apache.org/jira/browse/SPARK-26930</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;While investigating Parquet predicate pushdown test cases, I noticed that several tests seems to be broken, they don&apos;t test what they were originally intended to. Most of the verification ends up in one of the overloaded checkFilterPredicate functions, which supposed to test if a given filter class is generated or not with this call: &lt;tt&gt;maybeFilter.exists(_.getClass === filterClass)&lt;/tt&gt;, but on one side an assert is missing from here, on the other side, the filters are more complicated, for example equality is checked with an &apos;and&apos; wrapping not null check along with an equality check for the given value. &apos;Exists&apos; function call won&apos;t help with these compounds filters, since they are not collection instances.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13216603">SPARK-26930</key>
            <summary>Tests in ParquetFilterSuite don&apos;t verify filter class</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nkollar">N&#225;ndor Koll&#225;r</assignee>
                                    <reporter username="nkollar">N&#225;ndor Koll&#225;r</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Feb 2019 11:21:50 +0000</created>
                <updated>Mon, 12 Dec 2022 18:11:06 +0000</updated>
                            <resolved>Fri, 22 Feb 2019 06:09:45 +0000</resolved>
                                    <version>2.4.0</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16772690" author="gurwls223" created="Wed, 20 Feb 2019 06:55:45 +0000"  >&lt;p&gt;Sorry but can you show some codes? It&apos;s difficult for me to parse the description &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. Also, technically it&apos;s not broken if it doesn&apos;t test something. Please fix the JIRA title.&lt;/p&gt;</comment>
                            <comment id="16772795" author="gurwls223" created="Wed, 20 Feb 2019 09:15:39 +0000"  >&lt;p&gt;Ah, gotya &lt;tt&gt;maybeFilter.exists(_.getClass === filterClass)&lt;/tt&gt; doesn&apos;t check anything and &lt;tt&gt;assert&lt;/tt&gt; should be added in &lt;tt&gt;ParquetFilterSuite.scala&lt;/tt&gt; s 117 line&lt;/p&gt;</comment>
                            <comment id="16772806" author="nkollar" created="Wed, 20 Feb 2019 09:28:15 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hyukjin.kwon&quot; class=&quot;user-hover&quot; rel=&quot;hyukjin.kwon&quot;&gt;hyukjin.kwon&lt;/a&gt; for taking a look at this Jira. That&apos;s correct, an assert is missing from there, but an other problem is, that if I put it there, the tests will fail. They won&apos;t fail because of a bug in the production code, but because the expression to test for are not just simple eq, lt etc. predicated, but more complex expressions like and(eq, lt). I guess the intent with that exists call was to find the relevant class in this expression, but it seems that optional&apos;s exists doesn&apos;t do this, one should manually iterate through the expression tree. And sorry about the ambiguous description! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Anyway I don&apos;t think this is a serious issue, though it would be nice to improve these tests.&lt;/p&gt;</comment>
                            <comment id="16772812" author="gurwls223" created="Wed, 20 Feb 2019 09:32:45 +0000"  >&lt;p&gt;Yea, &lt;tt&gt;IsNotNull&lt;/tt&gt; will be inserted (see also &lt;a href=&quot;https://github.com/apache/spark/commit/ef77003178eb5cdcb4fe519fc540917656c5d577&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/ef77003178eb5cdcb4fe519fc540917656c5d577&lt;/a&gt;). Looks we should fix anyway.&lt;/p&gt;</comment>
                            <comment id="16772823" author="nkollar" created="Wed, 20 Feb 2019 09:44:00 +0000"  >&lt;p&gt;What do you think is the better approach? Test for the entire expression (verify for and(null check, filter)), or just simply search for the class in the expression tree (I think the relevant filter should be somewhere in the leaf nodes).&lt;/p&gt;</comment>
                            <comment id="16772826" author="gurwls223" created="Wed, 20 Feb 2019 09:45:31 +0000"  >&lt;p&gt;I am not sure which way will be minimised and simple way. Since it&apos;s a test code, any minimised way would be preferred.&lt;/p&gt;</comment>
                            <comment id="16772829" author="nkollar" created="Wed, 20 Feb 2019 09:48:23 +0000"  >&lt;p&gt;I don&apos;t know either, but I feel that the second option might be simpler to implement. I can give a shot.&lt;/p&gt;</comment>
                            <comment id="16774803" author="gurwls223" created="Fri, 22 Feb 2019 06:09:45 +0000"  >&lt;p&gt;Issue resolved by pull request 23855&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/23855&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/23855&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 38 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi14nk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>