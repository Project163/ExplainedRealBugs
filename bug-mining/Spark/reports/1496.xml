<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:24:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-6045] RecordWriter should be checked against null in PairRDDFunctions#saveAsNewAPIHadoopDataset</title>
                <link>https://issues.apache.org/jira/browse/SPARK-6045</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;gtinside reported in the thread &apos;NullPointerException in TaskSetManager&apos; with the following stack trace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;WARN 2015-02-26 14:21:43,217 [task-result-getter-0] TaskSetManager - Lost
task 14.2 in stage 0.0 (TID 29, devntom003.dev.blackrock.com):
java.lang.NullPointerException

org.apache.spark.rdd.PairRDDFunctions.saveAsNewAPIHadoopDataset(PairRDDFunctions.scala:1007)
com.bfm.spark.test.CassandraHadoopMigrator$.main(CassandraHadoopMigrator.scala:77)
com.bfm.spark.test.CassandraHadoopMigrator.main(CassandraHadoopMigrator.scala)
sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method.invoke(Method.java:606)
org.apache.spark.deploy.SparkSubmit$.launch(SparkSubmit.scala:358)
org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:75)
org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Looks like the following call in finally block was the cause:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    writer.close(hadoopContext)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We should check writer against null before calling close().&lt;/p&gt;</description>
                <environment></environment>
        <key id="12778013">SPARK-6045</key>
            <summary>RecordWriter should be checked against null in PairRDDFunctions#saveAsNewAPIHadoopDataset</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tedyu@apache.org">Ted Yu</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Feb 2015 20:56:49 +0000</created>
                <updated>Thu, 26 Feb 2015 23:28:26 +0000</updated>
                            <resolved>Thu, 26 Feb 2015 23:27:49 +0000</resolved>
                                                    <fixVersion>1.4.0</fixVersion>
                                    <component>Input/Output</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14339147" author="yuzhihong@gmail.com" created="Thu, 26 Feb 2015 20:58:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/spark/pull/4794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/4794&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14339149" author="apachespark" created="Thu, 26 Feb 2015 20:58:28 +0000"  >&lt;p&gt;User &apos;tedyu&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/4794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/4794&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14339164" author="srowen" created="Thu, 26 Feb 2015 21:08:20 +0000"  >&lt;p&gt;Per the PR, it&apos;s not so much that this isn&apos;t checked for &lt;tt&gt;null&lt;/tt&gt; but that the &lt;tt&gt;RecordWriter&lt;/tt&gt; is &lt;tt&gt;null&lt;/tt&gt; in the first place. That can be failed earlier, but it still fails with an exception.&lt;/p&gt;

&lt;p&gt;Isn&apos;t the problem with &lt;tt&gt;CassandraHadoopInputOutputWriter&lt;/tt&gt; not returning a &lt;tt&gt;RecordWriter&lt;/tt&gt;? that seems outside of Spark.&lt;/p&gt;</comment>
                            <comment id="14339169" author="yuzhihong@gmail.com" created="Thu, 26 Feb 2015 21:12:19 +0000"  >&lt;p&gt;The logic of CassandraHadoopMigrator.scala is unknown.&lt;/p&gt;

&lt;p&gt;With the current PR, user would be able to see exception earlier so that he / she can perform proper analysis.&lt;/p&gt;</comment>
                            <comment id="14339192" author="srowen" created="Thu, 26 Feb 2015 21:28:16 +0000"  >&lt;p&gt;Yeah, this replaces an NPE-hiding-an-NPE with a clearer IllegalArgumentException, which is good, but that&apos;s all it does. This still dies with an exception, which is I suppose the right-est thing Spark can do since the impl isn&apos;t working.&lt;/p&gt;</comment>
                            <comment id="14339405" author="srowen" created="Thu, 26 Feb 2015 23:27:49 +0000"  >&lt;p&gt;Issue resolved by pull request 4794&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/4794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/4794&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 38 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2645z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>