<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:00:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-24681] Cannot create a view from a table when a nested column name contains &apos;:&apos;</title>
                <link>https://issues.apache.org/jira/browse/SPARK-24681</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Here&apos;s a patch that reproduces the issue:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/sql/hive/src/test/scala/org/apache/spark/sql/hive/HiveParquetSuite.scala b/sql/hive/src/test/scala/org/apache/spark/sql/hive/HiveParquetSuite.scala 
index 09c1547..29bb3db 100644 
--- a/sql/hive/src/test/scala/org/apache/spark/sql/hive/HiveParquetSuite.scala 
+++ b/sql/hive/src/test/scala/org/apache/spark/sql/hive/HiveParquetSuite.scala 
@@ -19,6 +19,7 @@ &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; org.apache.spark.sql.hive 
&#160;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.{QueryTest, Row} 
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.execution.datasources.parquet.ParquetTest 
+&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.functions.{lit, struct} 
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.hive.test.TestHiveSingleton 
&#160;
&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Cases(lower: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, UPPER: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) 
@@ -76,4 +77,21 @@ &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;HiveParquetSuite &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; QueryTest with ParquetTest with TestHiveSingleton 
&#160;&#160;&#160;&#160;&#160;&#160;} 
&#160;&#160;&#160;&#160;} 
&#160;&#160;} 
+ 
+ &#160;test(&lt;span class=&quot;code-quote&quot;&gt;&quot;column names including &lt;span class=&quot;code-quote&quot;&gt;&apos;:&apos;&lt;/span&gt; characters&quot;&lt;/span&gt;) { 
+ &#160;&#160;&#160;withTempPath { path =&amp;gt; 
+ &#160;&#160;&#160;&#160;&#160;withTable(&lt;span class=&quot;code-quote&quot;&gt;&quot;test_table&quot;&lt;/span&gt;) { 
+ &#160;&#160;&#160;&#160;&#160;&#160;&#160;spark.range(0) 
+ &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.select(struct(lit(0).as(&lt;span class=&quot;code-quote&quot;&gt;&quot;nested:column&quot;&lt;/span&gt;)).as(&lt;span class=&quot;code-quote&quot;&gt;&quot;toplevel:column&quot;&lt;/span&gt;)) 
+ &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.write.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;parquet&quot;&lt;/span&gt;) 
+ &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.option(&lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt;, path.getCanonicalPath) 
+ &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.saveAsTable(&lt;span class=&quot;code-quote&quot;&gt;&quot;test_table&quot;&lt;/span&gt;) 
+ 
+ &#160;&#160;&#160;&#160;&#160;&#160;&#160;sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE VIEW test_view_1 AS SELECT `toplevel:column`.* FROM test_table&quot;&lt;/span&gt;) 
+ &#160;&#160;&#160;&#160;&#160;&#160;&#160;sql(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE VIEW test_view_2 AS SELECT * FROM test_table&quot;&lt;/span&gt;) 
+ 
+ &#160;&#160;&#160;&#160;&#160;} 
+ &#160;&#160;&#160;} 
+ &#160;} 
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The first &quot;CREATE VIEW&quot; statement succeeds, but the&#160;second one fails with:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.spark.SparkException: Cannot recognize hive type string: struct&amp;lt;nested:column:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13168913">SPARK-24681</key>
            <summary>Cannot create a view from a table when a nested column name contains &apos;:&apos;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="maropu">Takeshi Yamamuro</assignee>
                                    <reporter username="a.ionescu">Adrian Ionescu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Jun 2018 16:41:22 +0000</created>
                <updated>Tue, 17 Jul 2018 21:15:58 +0000</updated>
                            <resolved>Tue, 17 Jul 2018 21:15:58 +0000</resolved>
                                    <version>2.2.0</version>
                    <version>2.3.0</version>
                    <version>2.4.0</version>
                                    <fixVersion>2.4.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="16530206" author="smilegator" created="Mon, 2 Jul 2018 17:20:02 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maropu&quot; class=&quot;user-hover&quot; rel=&quot;maropu&quot;&gt;maropu&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dongjoon&quot; class=&quot;user-hover&quot; rel=&quot;dongjoon&quot;&gt;dongjoon&lt;/a&gt; Are you interested in this bug fix?&lt;/p&gt;</comment>
                            <comment id="16530561" author="maropu" created="Mon, 2 Jul 2018 23:16:22 +0000"  >&lt;p&gt;ok, I&apos;ll look into this.&lt;/p&gt;</comment>
                            <comment id="16531016" author="maropu" created="Tue, 3 Jul 2018 08:36:42 +0000"  >&lt;p&gt;I&apos;ve looked over related code andI think we cannot use `:` in Hive metastore column names: &lt;a href=&quot;https://github.com/apache/hive/blob/release-1.2.1/serde/src/java/org/apache/hadoop/hive/serde2/typeinfo/TypeInfoUtils.java#L239&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/release-1.2.1/serde/src/java/org/apache/hadoop/hive/serde2/typeinfo/TypeInfoUtils.java#L239&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The current master checks if column names don&apos;t include comma in column names only (you fixed this a year ago): &lt;a href=&quot;https://github.com/apache/spark/blob/a7c8f0c8cb144a026ea21e8780107e363ceacb8d/sql/hive/src/main/scala/org/apache/spark/sql/hive/HiveExternalCatalog.scala#L141&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/a7c8f0c8cb144a026ea21e8780107e363ceacb8d/sql/hive/src/main/scala/org/apache/spark/sql/hive/HiveExternalCatalog.scala#L141&lt;/a&gt;&lt;br/&gt;
IMHO we need to check &apos;:&apos; and &apos;;&apos; here, too. WDYT?&lt;/p&gt;

&lt;p&gt;Or, we need to accept &apos;:&apos; in column names?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16532234" author="apachespark" created="Wed, 4 Jul 2018 04:39:05 +0000"  >&lt;p&gt;User &apos;maropu&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/21711&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/21711&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 19 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3vce7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12342385">2.4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>