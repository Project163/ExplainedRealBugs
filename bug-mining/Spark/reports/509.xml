<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:15:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-2664] Deal with `--conf` options in spark-submit that relate to flags</title>
                <link>https://issues.apache.org/jira/browse/SPARK-2664</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;If someone sets a spark conf that relates to an existing flag `--master`, we should set it correctly like we do with the defaults file. Otherwise it can have confusing semantics. I noticed this after merging it, otherwise I would have mentioned it in the review.&lt;/p&gt;

&lt;p&gt;I think it&apos;s as simple as modifying loadDefaults to check the user-supplied options also. We might change it to loadUserProperties since it&apos;s no longer just the defaults file.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12729372">SPARK-2664</key>
            <summary>Deal with `--conf` options in spark-submit that relate to flags</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sandyr">Sandy Ryza</assignee>
                                    <reporter username="pwendell">Patrick Wendell</reporter>
                        <labels>
                    </labels>
                <created>Thu, 24 Jul 2014 06:25:54 +0000</created>
                <updated>Sun, 21 Sep 2014 01:42:39 +0000</updated>
                            <resolved>Thu, 31 Jul 2014 18:52:15 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14072925" author="sandyr" created="Thu, 24 Jul 2014 07:18:18 +0000"  >&lt;p&gt;I think the right behavior here is worth a little thought.  What&apos;s the mental model we expect the user to have about the relationship between properties specified through --conf and properties that get their own flag?  My first thought is - if we&apos;re ok with taking properties like master through --conf, is there a point (beyond compatibility) in having flags for these properties at all?&lt;/p&gt;

&lt;p&gt;Flags that aren&apos;t Spark confs are there because they impact what happens before the SparkContext is created.  These fall into a couple categories:&lt;br/&gt;
1. Flags that have no property Spark conf equivalent like --executor-cores &lt;br/&gt;
2. Flags that have a direct Spark conf equivalent like --executor-cores (spark.executor.memory)&lt;br/&gt;
3. Flags that impact a Spark conf like --deploy-mode (which can mean we set spark.master to yarn-cluster)&lt;/p&gt;

&lt;p&gt;I think the two ways to look at it are:&lt;br/&gt;
1. We&apos;re OK with taking properties that have related flags.  In the case of a property in the 2nd category, we have a policy over which takes precedence.  In the case of a property in the 3rd category, we have some (possibly complex) resolution logic.  This approach would be the most accepting, but requires the user to have a model of how these conflicts get resolved.&lt;br/&gt;
2. We&apos;re not OK with taking properties that have related flags.  --conf specifies property that gets passed to the SparkContext and has no effect on anything that happens before it&apos;s created. To save users from themselves, if someone passes spark.master or spark.app.name through --conf, we ignore it or throw an error.&lt;/p&gt;

&lt;p&gt;I&apos;m a little more partial to approach 2 because I think the mental model is a little simpler.&lt;/p&gt;

&lt;p&gt;Either way, we should probably enforce the same behavior when a config comes from the defaults file.&lt;/p&gt;

&lt;p&gt;Lastly, how do we allow setting a default for one of these special flags?  E.g. make it so that all jobs run on YARN or Mesos by default.  With approach 1, this is relatively straightforward - we use the same logic we&apos;d use on a property that comes in through --conf for making defaults take effect.  We might need to add spark properties for flags that don&apos;t have them already like --executor-cores.  With approach 2, we&apos;d need to add support in the defaults file or somewhere else for specifying flag defaults.&lt;/p&gt;</comment>
                            <comment id="14074108" author="pwendell" created="Fri, 25 Jul 2014 05:50:09 +0000"  >&lt;p&gt;Hey Sandy,&lt;/p&gt;

&lt;p&gt;The reason why we originally allowed spark-defaults.conf to support spark options that have corresponding flags (which is 1 here) is because there was no other way for users to set things like the master in a configuration file. This seems like something we need to support (at least, IIRC it was one reason some packagers wanted a configuration file in the first place). So my proposal here was to just treat --conf as the same way. I&apos;d also be okay to just throw an exception if users try to set one of these as a --conf when it corresponds to a flag, but then it deviates a bit from the behavior of the config file which could be confusing.&lt;/p&gt;

&lt;p&gt;In terms of adding new configs for flags that don&apos;t currently have a corresponding conf. Personally, I&apos;m also open to doing that. It would certainly simplify the fact that we have two different concepts at the moment for which there is not a 1:1 mapping. In my experience users have been most confused about the fact that those flags and spark conf properties are partially-but-not-completely overlapping. They haven&apos;t been confused about precedence order as much, since we state it clearly.&lt;/p&gt;

&lt;p&gt;In the shorter term, given that we can&apos;t revert the behavior of spark-defaults.conf, I&apos;d prefer to either use that same behavior for flags (the original proposal) or to throw an exception if any of the &quot;reserved&quot; properties are set via the --conf flag instead of their dedicated flag (we can always make it accept more liberally later). Otherwise it&apos;s super confusing what happens if the user sets --conf spark.master and also --master.&lt;/p&gt;</comment>
                            <comment id="14079775" author="apachespark" created="Wed, 30 Jul 2014 19:01:04 +0000"  >&lt;p&gt;User &apos;sryza&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/1665&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1665&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14081267" author="pwendell" created="Thu, 31 Jul 2014 18:52:15 +0000"  >&lt;p&gt;Issue resolved by pull request 1665&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/1665&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/1665&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12742992">SPARK-3620</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>407446</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1y42f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>407460</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12326686">1.1.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>