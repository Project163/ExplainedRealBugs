<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:37:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-12711] ML StopWordsRemover does not protect itself from column name duplication</title>
                <link>https://issues.apache.org/jira/browse/SPARK-12711</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;At work we were &apos;taking a closer look&apos; at ML transformers&amp;amp;estimators and I spotted that anomally.&lt;br/&gt;
On first look, resolution looks simple:&lt;br/&gt;
Add to StopWordsRemover.transformSchema line (as is done in e.g. PCA.transformSchema, StandardScaler.transformSchema, OneHotEncoder.transformSchema):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;require(!schema.fieldNames.contains($(outputCol)), s&lt;span class=&quot;code-quote&quot;&gt;&quot;Output column ${$(outputCol)} already exists.&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Am I correct? Is that a bug?    If yes - I am willing to prepare an appropriate pull request.&lt;br/&gt;
Maybe a better idea is to make use of super.transformSchema in StopWordsRemover (and possibly in all other places)?&lt;/p&gt;


&lt;p&gt;Links to files at github, mentioned above:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/StopWordsRemover.scala#L147&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/StopWordsRemover.scala#L147&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/Transformer.scala#L109-L111&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/Transformer.scala#L109-L111&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/StandardScaler.scala#L101-L102&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/StandardScaler.scala#L101-L102&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/PCA.scala#L138-L139&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/PCA.scala#L138-L139&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/OneHotEncoder.scala#L75-L76&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/OneHotEncoder.scala#L75-L76&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12928629">SPARK-12711</key>
            <summary>ML StopWordsRemover does not protect itself from column name duplication</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gzes">Grzegorz Chilkiewicz</assignee>
                                    <reporter username="gzes">Grzegorz Chilkiewicz</reporter>
                        <labels>
                            <label>ml</label>
                            <label>mllib</label>
                            <label>newbie</label>
                            <label>suggestion</label>
                    </labels>
                <created>Fri, 8 Jan 2016 12:43:20 +0000</created>
                <updated>Tue, 2 Feb 2016 19:18:17 +0000</updated>
                            <resolved>Tue, 2 Feb 2016 19:17:01 +0000</resolved>
                                    <version>1.6.0</version>
                                    <fixVersion>1.6.1</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>ML</component>
                    <component>MLlib</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15089854" author="josephkb" created="Fri, 8 Jan 2016 20:07:40 +0000"  >&lt;p&gt;You&apos;re correct that it should prevent column name duplication.  I&apos;d recommend using SchemaUtils.appendColumn: &lt;a href=&quot;https://github.com/apache/spark/blob/00d9261724feb48d358679efbae6889833e893e0/mllib/src/main/scala/org/apache/spark/ml/util/SchemaUtils.scala#L54&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/00d9261724feb48d358679efbae6889833e893e0/mllib/src/main/scala/org/apache/spark/ml/util/SchemaUtils.scala#L54&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;That will be great if you can send a PR to fix this.  Thanks!&lt;/p&gt;

&lt;p&gt;By the way, please don&apos;t set the target version; committers or component maintainers will set that.&lt;/p&gt;</comment>
                            <comment id="15090535" author="wjur" created="Sat, 9 Jan 2016 10:11:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=josephkb&quot; class=&quot;user-hover&quot; rel=&quot;josephkb&quot;&gt;josephkb&lt;/a&gt;Is there any particular reason why StopWordsRemover is not a UnaryTransformer? As the docs say, the UnaryTransformer is an &quot;Abstract class for transformers that take one input column, apply transformation, and output the result as a new column.&quot; which is the case. Moreover, UnaryTransformer implementation checks whether the output column already exists or not. Then, Making StopWordsRemover a UnaryTransformer would solve the issue. Talking about UnaryTransformers candidates, I think StringIndexer is a similar case (and probably, there are other Transformers that could be UnaryTransformers). It doesn&apos;t check whether the output column exists in the input DataFrame (it has the same flaw). Making StringIndexer a UnaryTransformer would solve the flaw, too. What do you think?&lt;/p&gt;</comment>
                            <comment id="15092686" author="josephkb" created="Mon, 11 Jan 2016 21:14:24 +0000"  >&lt;p&gt;You&apos;re right that these transformers could be UnaryTransformers.  The main problem is that their transform() methods involve a little initialization, which is not supported well by the UnaryTransformer abstraction.&lt;/p&gt;

&lt;p&gt;Relatedly, I&apos;m starting to work on a design doc for Params for MLlib 2.0 which should help handle some of these issues.  Essentially, I&apos;m working on making it so that these checks don&apos;t have to be implemented separately for each class and can be handled in a generic way by an abstraction.  So this JIRA may not be an issue for 2.0+.&lt;/p&gt;</comment>
                            <comment id="15096380" author="apachespark" created="Wed, 13 Jan 2016 15:52:03 +0000"  >&lt;p&gt;User &apos;grzegorz-chilkiewicz&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/10741&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/10741&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15128828" author="josephkb" created="Tue, 2 Feb 2016 19:17:01 +0000"  >&lt;p&gt;Issue resolved by pull request 10741&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/10741&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/10741&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 41 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2r1d3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12334009">1.6.1</customfieldvalue>
    <customfieldvalue id="12329449">2.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>