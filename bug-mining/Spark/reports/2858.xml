<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:36:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-11994] Word2VecModel load and save cause SparkException when model is bigger than spark.kryoserializer.buffer.max</title>
                <link>https://issues.apache.org/jira/browse/SPARK-11994</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;When loading a Word2VecModel of compressed size 58Mb using the Word2VecModel.load() method introduced in Spark 1.4.0 I get a `org.apache.spark.SparkException: Kryo serialization failed: Buffer overflow. Available: 0, required: 2` exception.&lt;br/&gt;
This happens because the model is saved as a unique file with no partitioning and the kryo buffer overflows when tries to serialize it all.&lt;br/&gt;
Increasing `spark.kryoserializer.buffer.max` works as a temporary solution but needs to increased again whenever we increase the model size. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12916223">SPARK-11994</key>
            <summary>Word2VecModel load and save cause SparkException when model is bigger than spark.kryoserializer.buffer.max</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tmnd91">Antonio Murgia</assignee>
                                    <reporter username="tmnd91">Antonio Murgia</reporter>
                        <labels>
                            <label>kryo</label>
                            <label>mllib</label>
                    </labels>
                <created>Wed, 25 Nov 2015 18:02:18 +0000</created>
                <updated>Thu, 2 Jun 2016 22:16:17 +0000</updated>
                            <resolved>Sat, 5 Dec 2015 15:42:16 +0000</resolved>
                                    <version>1.4.1</version>
                    <version>1.5.1</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>MLlib</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15027605" author="josephkb" created="Wed, 25 Nov 2015 20:58:30 +0000"  >&lt;p&gt;Good point; thanks for reporting this.  We should probably increase the partitioning adaptively based on model size in the save method.  Would you be willing to send a PR?&lt;/p&gt;</comment>
                            <comment id="15027648" author="tmnd91" created="Wed, 25 Nov 2015 21:37:03 +0000"  >&lt;p&gt;Sure.&lt;/p&gt;</comment>
                            <comment id="15028016" author="tmnd91" created="Thu, 26 Nov 2015 02:11:50 +0000"  >&lt;p&gt;Since `spark.kryoserializer.buffer.max` defaults to 64MB, I decided to increase the number of partitions the model gets divided into at half that size (32MB).&lt;br/&gt;
One word2vec entry consists of an array of float of size vectorSize and a string, since the size of string is variable and considerably lower than the size of the array, I&apos;m not going consider it in my size computation.&lt;br/&gt;
And obviously we have numWords entries. Stated that the size of a Float is 4 Bytes.&lt;br/&gt;
The number of partitions the model gets splitted into is given by the formulae: (4 * numWords * vectorSize / 33554432) + 1 &lt;br/&gt;
I added a test to verify that the save/load methods works when the file is splitted in 2 parts.&lt;/p&gt;</comment>
                            <comment id="15030454" author="apachespark" created="Sat, 28 Nov 2015 10:27:03 +0000"  >&lt;p&gt;User &apos;tmnd1991&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9989&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9989&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15043355" author="srowen" created="Sat, 5 Dec 2015 15:42:16 +0000"  >&lt;p&gt;Issue resolved by pull request 9989&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9989&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9989&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12818699">SPARK-6725</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12975323">SPARK-15740</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 50 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2oxuv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>