<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:41:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-15067] YARN executors are launched with fixed perm gen size</title>
                <link>https://issues.apache.org/jira/browse/SPARK-15067</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;It is impossible to change the executors max perm gen size using the property &quot;spark.executor.extraJavaOptions&quot; when you are running on YARN.&lt;/p&gt;

&lt;p&gt;When the JVM option &quot;-XX:MaxPermSize&quot; is set through the property &quot;spark.executor.extraJavaOptions&quot;, Spark put it properly in the shell command that will start the JVM container but, in the ending of command, it sets again this option using a fixed value of 256m, as you can see in the log I&apos;ve extracted:&lt;/p&gt;

&lt;p&gt;2016-04-30 17:20:12 INFO  ExecutorRunnable:58 -&lt;br/&gt;
===============================================================================&lt;br/&gt;
YARN executor launch context:&lt;br/&gt;
  env:&lt;br/&gt;
    CLASSPATH -&amp;gt; &lt;tt&gt;PWD&lt;/tt&gt;&amp;lt;CPS&amp;gt;&lt;tt&gt;PWD&lt;/tt&gt;/_&lt;em&gt;spark&lt;/em&gt;_.jar&amp;lt;CPS&amp;gt;$HADOOP_CONF_DIR&amp;lt;CPS&amp;gt;/usr/hdp/current/hadoop-client/&lt;b&gt;&amp;lt;CPS&amp;gt;/usr/hdp/current/hadoop-client/lib/&lt;/b&gt;&amp;lt;CPS&amp;gt;/usr/hdp/current/hadoop-hdfs-client/&lt;b&gt;&amp;lt;CPS&amp;gt;/usr/hdp/current/hadoop-hdfs-client/lib/&lt;/b&gt;&amp;lt;CPS&amp;gt;/usr/hdp/current/hadoop-yarn-client/&lt;b&gt;&amp;lt;CPS&amp;gt;/usr/hdp/current/hadoop-yarn-client/lib/&lt;/b&gt;&amp;lt;CPS&amp;gt;/usr/hdp/mr-framework/hadoop/share/hadoop/mapreduce/&lt;b&gt;:/usr/hdp/mr-framework/hadoop/share/hadoop/mapreduce/lib/&lt;/b&gt;:/usr/hdp/mr-framework/hadoop/share/hadoop/common/&lt;b&gt;:/usr/hdp/mr-framework/hadoop/share/hadoop/common/lib/&lt;/b&gt;:/usr/hdp/mr-framework/hadoop/share/hadoop/yarn/&lt;b&gt;:/usr/hdp/mr-framework/hadoop/share/hadoop/yarn/lib/&lt;/b&gt;:/usr/hdp/mr-framework/hadoop/share/hadoop/hdfs/&lt;b&gt;:/usr/hdp/mr-framework/hadoop/share/hadoop/hdfs/lib/&lt;/b&gt;:/usr/hdp/current/hadoop/lib/hadoop-lzo-0.6.0.jar:/etc/hadoop/conf/secure&lt;br/&gt;
    SPARK_LOG_URL_STDERR -&amp;gt; &lt;a href=&quot;http://xxxxx0668sl.xxxxx.br:8042/node/containerlogs/container_1456962126505_329993_01_000002/h_loadbd/stderr?start=-4096&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://xxxxx0668sl.xxxxx.br:8042/node/containerlogs/container_1456962126505_329993_01_000002/h_loadbd/stderr?start=-4096&lt;/a&gt;&lt;br/&gt;
    SPARK_YARN_STAGING_DIR -&amp;gt; .sparkStaging/application_1456962126505_329993&lt;br/&gt;
    SPARK_YARN_CACHE_FILES_FILE_SIZES -&amp;gt; 191719054,166&lt;br/&gt;
    SPARK_USER -&amp;gt; h_loadbd&lt;br/&gt;
    SPARK_YARN_CACHE_FILES_VISIBILITIES -&amp;gt; PUBLIC,PUBLIC&lt;br/&gt;
    SPARK_YARN_MODE -&amp;gt; true&lt;br/&gt;
    SPARK_YARN_CACHE_FILES_TIME_STAMPS -&amp;gt; 1459806496093,1459808508343&lt;br/&gt;
    SPARK_LOG_URL_STDOUT -&amp;gt; &lt;a href=&quot;http://xxxxx0668sl.xxxxx.br:8042/node/containerlogs/container_1456962126505_329993_01_000002/h_loadbd/stdout?start=-4096&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://xxxxx0668sl.xxxxx.br:8042/node/containerlogs/container_1456962126505_329993_01_000002/h_loadbd/stdout?start=-4096&lt;/a&gt;&lt;br/&gt;
    SPARK_YARN_CACHE_FILES -&amp;gt; hdfs://xxxxx/user/datalab/hdp/spark/lib/spark-assembly-1.6.0.2.3.4.1-10-hadoop2.7.1.2.3.4.1-10.jar#_&lt;em&gt;spark&lt;/em&gt;_.jar,hdfs://tlvcluster/user/datalab/hdp/spark/conf/hive-site.xml#hive-site.xml&lt;/p&gt;

&lt;p&gt;  command:&lt;br/&gt;
    &lt;tt&gt;JAVA_HOME&lt;/tt&gt;/bin/java -server -XX:OnOutOfMemoryError=&apos;kill %p&apos; -Xms6144m -Xmx6144m &apos;-XX:+PrintGCDetails&apos; &apos;-XX:MaxPermSize=1024M&apos; &apos;-XX:+PrintGCTimeStamps&apos; -Djava.io.tmpdir=&lt;tt&gt;PWD&lt;/tt&gt;/tmp &apos;-Dspark.akka.timeout=300000&apos; &apos;-Dspark.driver.port=62875&apos; &apos;-Dspark.rpc.askTimeout=300000&apos; &apos;-Dspark.rpc.lookupTimeout=300000&apos; -Dspark.yarn.app.container.log.dir=&amp;lt;LOG_DIR&amp;gt; -XX:MaxPermSize=256m org.apache.spark.executor.CoarseGrainedExecutorBackend --driver-url spark://CoarseGrainedScheduler@10.125.81.42:62875 --executor-id 1 --hostname xxxxx0668sl.xxxxx.br --cores 1 --app-id application_1456962126505_329993 --user-class-path &lt;a href=&quot;file:$PWD/__app__.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:$PWD/__app__.jar&lt;/a&gt; 1&amp;gt; &amp;lt;LOG_DIR&amp;gt;/stdout 2&amp;gt; &amp;lt;LOG_DIR&amp;gt;/stderr&lt;/p&gt;

&lt;p&gt;Analyzing the code is possible to see that all the options set in the property &quot;spark.executor.extraJavaOptions&quot; are enclosed, one by one, in single quotes (ExecutorRunnable.scala:151) before the launcher take the decision if a default value has to be provided or not for the option &quot;-XX:MaxPermSize&quot; (ExecutorRunnable.scala:202).&lt;/p&gt;

&lt;p&gt;This decision is taken examining all the options set and looking for a string starting with the value &quot;-XX:MaxPermSize&quot; (CommandBuilderUtils.java:328). If that value is not found, the default value is set.&lt;/p&gt;

&lt;p&gt;A string option starting without single quote will never be found, then, a default value will always be provided.&lt;/p&gt;

&lt;p&gt;A possible solution is change the source code of CommandBuilderUtils.java in the line 328:&lt;br/&gt;
From-&amp;gt; if (arg.startsWith(&quot;-XX:MaxPermSize=&quot;))&lt;br/&gt;
To-&amp;gt; if (arg.indexOf(&quot;-XX:MaxPermSize=&quot;) &amp;gt; -1)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12964405">SPARK-15067</key>
            <summary>YARN executors are launched with fixed perm gen size</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="srowen">Sean R. Owen</assignee>
                                    <reporter username="renatojdk">Renato Falchi Brand&#227;o</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 May 2016 19:04:25 +0000</created>
                <updated>Sun, 17 May 2020 18:16:48 +0000</updated>
                            <resolved>Mon, 9 May 2016 18:11:15 +0000</resolved>
                                    <version>1.6.0</version>
                    <version>1.6.1</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Spark Core</component>
                    <component>YARN</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15267294" author="srowen" created="Mon, 2 May 2016 19:11:10 +0000"  >&lt;p&gt;Hm, I think that might be a good catch. CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vanzin&quot; class=&quot;user-hover&quot; rel=&quot;vanzin&quot;&gt;vanzin&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15268659" author="devaraj.k" created="Tue, 3 May 2016 13:03:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=renatojdk&quot; class=&quot;user-hover&quot; rel=&quot;renatojdk&quot;&gt;renatojdk&lt;/a&gt;, are you planning to create PR for this? If not please let me know, I can provide PR for this. Thanks.&lt;/p&gt;</comment>
                            <comment id="15269096" author="renatojdk" created="Tue, 3 May 2016 17:05:27 +0000"  >&lt;p&gt;Hi Devaraj,&lt;br/&gt;
I will create the PR, thank you!&lt;/p&gt;</comment>
                            <comment id="15275527" author="apachespark" created="Sun, 8 May 2016 09:25:04 +0000"  >&lt;p&gt;User &apos;srowen&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/12985&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/12985&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 28 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2x25r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311620" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Shepherd</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>vanzin</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12329449">2.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>