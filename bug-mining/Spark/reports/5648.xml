<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:59:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-23825] [K8s] Spark pods should request memory + memoryOverhead as resources</title>
                <link>https://issues.apache.org/jira/browse/SPARK-23825</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;We currently request  &lt;tt&gt;spark.&lt;span class=&quot;error&quot;&gt;&amp;#91;driver,executor&amp;#93;&lt;/span&gt;.memory&lt;/tt&gt; as memory from Kubernetes (e.g., &lt;a href=&quot;https://github.com/apache/spark/blob/master/resource-managers/kubernetes/core/src/main/scala/org/apache/spark/deploy/k8s/submit/steps/BasicDriverConfigurationStep.scala#L95&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;).&lt;br/&gt;
The limit is set to &lt;tt&gt;spark.&lt;span class=&quot;error&quot;&gt;&amp;#91;driver,executor&amp;#93;&lt;/span&gt;.memory + spark.kubernetes.&lt;span class=&quot;error&quot;&gt;&amp;#91;driver,executor&amp;#93;&lt;/span&gt;.memoryOverhead&lt;/tt&gt;.&lt;br/&gt;
This seems to be using Kubernetes wrong. &lt;br/&gt;
&lt;a href=&quot;https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/#how-pods-with-resource-limits-are-run&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;How Pods with resource limits are run&lt;/a&gt;, states:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;If a Container exceeds its memory request, it is likely that its Pod will be evicted whenever the node runs out of memory.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Thus, if a the  spark driver/executor uses &lt;tt&gt;memory + memoryOverhead&lt;/tt&gt; memory, it can be evicted. While an executor might get restarted (but it would still be very bad performance-wise), the driver would be hard to recover.&lt;/p&gt;

&lt;p&gt;I think spark should be able to run with the requested (and, thus, guaranteed) resources from Kubernetes without being in danger of termination without needing to rely on optional available resources.&lt;/p&gt;

&lt;p&gt;Thus, we shoud request &lt;tt&gt;memory + memoryOverhead&lt;/tt&gt; memory from Kubernetes (and this should also be the limit).&lt;/p&gt;</description>
                <environment></environment>
        <key id="13149022">SPARK-23825</key>
            <summary>[K8s] Spark pods should request memory + memoryOverhead as resources</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dvogelbacher">David Vogelbacher</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Mar 2018 21:59:33 +0000</created>
                <updated>Sun, 17 May 2020 18:23:44 +0000</updated>
                            <resolved>Mon, 2 Apr 2018 19:02:25 +0000</resolved>
                                    <version>2.3.0</version>
                                    <fixVersion>2.4.0</fixVersion>
                                    <component>Kubernetes</component>
                    <component>Spark Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16419857" author="dvogelbacher" created="Thu, 29 Mar 2018 22:05:09 +0000"  >&lt;p&gt;Will make a PR shortly, cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mcheah&quot; class=&quot;user-hover&quot; rel=&quot;mcheah&quot;&gt;mcheah&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16419950" author="dvogelbacher" created="Thu, 29 Mar 2018 23:51:00 +0000"  >&lt;p&gt;addressed by &lt;a href=&quot;https://github.com/apache/spark/pull/20943&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/20943&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16419995" author="apachespark" created="Fri, 30 Mar 2018 00:18:05 +0000"  >&lt;p&gt;User &apos;dvogelbacher&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/20943&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/20943&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 33 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ryvb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>