<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:34:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-11281] Issue with creating and collecting DataFrame using environments </title>
                <link>https://issues.apache.org/jira/browse/SPARK-11281</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;It is not possible to to access Map field created from an environment. Assuming local data frame is created as follows:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ldf &amp;lt;- data.frame(row.names=1:2)
ldf$x &amp;lt;- c(as.environment(list(a=1, b=2)), as.environment(list(c=3)))
str(ldf)
## &lt;span class=&quot;code-quote&quot;&gt;&apos;data.frame&apos;&lt;/span&gt;:	2 obs. of  1 variable:
##  $ x:List of 2
##   ..$ :&amp;lt;environment: 0x35c94d8&amp;gt; 
##   ..$ :&amp;lt;environment: 0x35c7ac0&amp;gt; 

get(&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;, ldf$x[[1]])
## [1] 1

get(&lt;span class=&quot;code-quote&quot;&gt;&quot;c&quot;&lt;/span&gt;, ldf$x[[2]])
## [1] 3
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It is possible to create a Spark data frame:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;sdf &amp;lt;- createDataFrame(sqlContext, ldf)
printSchema(sdf)

## root
##  |-- x: array (nullable = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
##  |    |-- element: map (containsNull = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
##  |    |    |-- key: string
##  |    |    |-- value: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; (valueContainsNull = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;but it throws:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.IllegalArgumentException: Invalid array type e
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;on collect / head. &lt;/p&gt;

&lt;p&gt;Problem seems to be specific to environments and cannot be reproduced when Map comes for example from Cassandra table.&lt;/p&gt;</description>
                <environment>&lt;p&gt;R 3.2.2, Spark build from master  487d409e71767c76399217a07af8de1bb0da7aa8&lt;/p&gt;</environment>
        <key id="12907391">SPARK-11281</key>
            <summary>Issue with creating and collecting DataFrame using environments </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zero323">Maciej Szymkiewicz</assignee>
                                    <reporter username="zero323">Maciej Szymkiewicz</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Oct 2015 12:55:02 +0000</created>
                <updated>Wed, 18 Nov 2015 16:36:23 +0000</updated>
                            <resolved>Wed, 18 Nov 2015 16:36:23 +0000</resolved>
                                    <version>1.6.0</version>
                                    <fixVersion>1.6.0</fixVersion>
                                    <component>SparkR</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15006529" author="sunrui" created="Mon, 16 Nov 2015 11:06:32 +0000"  >&lt;p&gt;fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-11086&quot; title=&quot;createDataFrame should dropFactor column-wise not cell-wise &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-11086&quot;&gt;&lt;del&gt;SPARK-11086&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15006955" author="shivaram" created="Mon, 16 Nov 2015 17:26:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sunrui&quot; class=&quot;user-hover&quot; rel=&quot;sunrui&quot;&gt;sunrui&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zero323&quot; class=&quot;user-hover&quot; rel=&quot;zero323&quot;&gt;zero323&lt;/a&gt; Is there a test case in &lt;a href=&quot;https://github.com/apache/spark/commit/d7d9fa0b8750166f8b74f9bc321df26908683a8b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/commit/d7d9fa0b8750166f8b74f9bc321df26908683a8b&lt;/a&gt; that covers this ? &lt;/p&gt;</comment>
                            <comment id="15006960" author="zero323" created="Mon, 16 Nov 2015 17:31:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shivaram&quot; class=&quot;user-hover&quot; rel=&quot;shivaram&quot;&gt;shivaram&lt;/a&gt; No, there isn&apos;t. I removed this one because there was nothing we could test there. &lt;/p&gt;</comment>
                            <comment id="15006966" author="shivaram" created="Mon, 16 Nov 2015 17:35:19 +0000"  >&lt;p&gt;Does the example posted in the description work now or does it still not work ? Sorry I&apos;m just confused what the resolution to this bug was (i.e. if it was fixed or we decided we won&apos;t fix etc.)&lt;/p&gt;</comment>
                            <comment id="15007038" author="zero323" created="Mon, 16 Nov 2015 18:17:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shivaram&quot; class=&quot;user-hover&quot; rel=&quot;shivaram&quot;&gt;shivaram&lt;/a&gt; I&apos;ve tested both current master and my PR for &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-11086&quot; title=&quot;createDataFrame should dropFactor column-wise not cell-wise &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-11086&quot;&gt;&lt;del&gt;SPARK-11086&lt;/del&gt;&lt;/a&gt; and it looks it is indeed resolved. I would like to add some tests but otherwise it looks like it can be closed.&lt;/p&gt;</comment>
                            <comment id="15007064" author="shivaram" created="Mon, 16 Nov 2015 18:27:58 +0000"  >&lt;p&gt;Thats cool ! lets keep this open till we add tests and then close it as a part of that PR&lt;/p&gt;</comment>
                            <comment id="15007272" author="apachespark" created="Mon, 16 Nov 2015 20:38:14 +0000"  >&lt;p&gt;User &apos;zero323&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9743&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9743&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15011336" author="shivaram" created="Wed, 18 Nov 2015 16:36:23 +0000"  >&lt;p&gt;Resolved by &lt;a href=&quot;https://github.com/apache/spark/pull/9743&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9743&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12904609">SPARK-11086</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2nflz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>