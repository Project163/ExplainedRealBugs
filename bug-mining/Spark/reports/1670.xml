<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:25:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-6506] python support yarn cluster mode requires SPARK_HOME to be set</title>
                <link>https://issues.apache.org/jira/browse/SPARK-6506</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;We added support for python running in yarn cluster mode in &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-5173&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-5173&lt;/a&gt;, but it requires that SPARK_HOME be set in the environment variables for application master and executor.  It doesn&apos;t have to be set to anything real but it fails if its not set.  See the command at the end of: &lt;a href=&quot;https://github.com/apache/spark/pull/3976&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/3976&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12785182">SPARK-6506</key>
            <summary>python support yarn cluster mode requires SPARK_HOME to be set</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vanzin">Marcelo Masiero Vanzin</assignee>
                                    <reporter username="tgraves">Thomas Graves</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Mar 2015 14:46:15 +0000</created>
                <updated>Wed, 8 Apr 2015 17:15:39 +0000</updated>
                            <resolved>Wed, 8 Apr 2015 17:15:25 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.3.2</fixVersion>
                    <fixVersion>1.4.0</fixVersion>
                                    <component>YARN</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14381844" author="lianhuiwang" created="Thu, 26 Mar 2015 13:13:54 +0000"  >&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tgraves&quot; class=&quot;user-hover&quot; rel=&quot;tgraves&quot;&gt;tgraves&lt;/a&gt; I use 1.3.0 to run. if i donot set SPARK_HOME at every node, i get the following exception in every executor:&lt;br/&gt;
Error from python worker:&lt;br/&gt;
  /usr/bin/python: No module named pyspark&lt;br/&gt;
PYTHONPATH was:&lt;br/&gt;
  /data/yarnenv/local/usercache/lianhui/filecache/296/spark-assembly-1.3.0-hadoop2.2.0.jar/python&lt;br/&gt;
java.io.EOFException&lt;br/&gt;
        at java.io.DataInputStream.readInt(DataInputStream.java:392)&lt;br/&gt;
        at org.apache.spark.api.python.PythonWorkerFactory.startDaemon(PythonWorkerFactory.scala:164)&lt;br/&gt;
        at org.apache.spark.api.python.PythonWorkerFactory.createThroughDaemon(PythonWorkerFactory.scala:86)&lt;br/&gt;
        at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:62)&lt;br/&gt;
        at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:105)&lt;br/&gt;
        at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:69)&lt;br/&gt;
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:277)&lt;br/&gt;
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:244)&lt;/p&gt;

&lt;p&gt;from the exception, i can find that pyspark of the spark.jar in nodeManager cannot be worked. and i donot know why pyspark of spark.jar cannot be worked. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrewor14&quot; class=&quot;user-hover&quot; rel=&quot;andrewor14&quot;&gt;andrewor14&lt;/a&gt; can you help me?&lt;br/&gt;
so i think now we should put spark dirs to PYTHONPATH  or SPARK_HOME at every node.&lt;/p&gt;</comment>
                            <comment id="14381860" author="tgraves" created="Thu, 26 Mar 2015 13:22:44 +0000"  >&lt;p&gt;If you are running on yarn you just have to set SPARK_HOME like this:&lt;br/&gt;
spark.yarn.appMasterEnv.SPARK_HOME /bogus&lt;br/&gt;
spark.executorEnv.SPARK_HOME /bogus&lt;/p&gt;

&lt;p&gt;But the error you pasted above isn&apos;t about that.  I&apos;ve seen this when building the assembly with jdk7 or jdk8 due to the python stuff not being packaged properly in the assembly jar.  I have to use jdk6 to package it.  see &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-1920&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SPARK-1920&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14392971" author="vanzin" created="Thu, 2 Apr 2015 17:16:32 +0000"  >&lt;p&gt;Maybe you&apos;re running into &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-5808&quot; title=&quot;Assembly generated by sbt does not contain pyspark&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-5808&quot;&gt;&lt;del&gt;SPARK-5808&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="14392978" author="tgraves" created="Thu, 2 Apr 2015 17:20:06 +0000"  >&lt;p&gt;No it was built with maven and the pyspark artifacts are there.  You just have to set SPARK_HOME to something even though it isn&apos;t used for anything.  Something is looking at SPARK_HOME and blows up if its not set.&lt;/p&gt;</comment>
                            <comment id="14482414" author="kostas" created="Tue, 7 Apr 2015 02:03:36 +0000"  >&lt;p&gt;I ran into this issue too by running:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;spark-submit  --master yarn-cluster examples/pi.py 4&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;it looks like I only had to set: spark.yarn.appMasterEnv.SPARK_HOME=/bogus to get it going:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;spark-submit --conf spark.yarn.appMasterEnv.SPARK_HOME=/bogus --master yarn-cluster pi.py 4&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="14484250" author="kostas" created="Tue, 7 Apr 2015 22:45:01 +0000"  >&lt;p&gt;Here is the exception I saw when I ran the above job:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;pi.py&quot;&lt;/span&gt;, line 29, in &amp;lt;module&amp;gt;
    sc = SparkContext(appName=&lt;span class=&quot;code-quote&quot;&gt;&quot;PythonPi&quot;&lt;/span&gt;)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/opt/cloudera/parcels/CDH-5.4.0-1.cdh5.4.0.p0.23/jars/spark-assembly-1.3.0-cdh5.4.0-hadoop2.6.0-cdh5.4.0.jar/pyspark/context.py&quot;&lt;/span&gt;, line 108, in __init__
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/opt/cloudera/parcels/CDH-5.4.0-1.cdh5.4.0.p0.23/jars/spark-assembly-1.3.0-cdh5.4.0-hadoop2.6.0-cdh5.4.0.jar/pyspark/context.py&quot;&lt;/span&gt;, line 222, in _ensure_initialized
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/opt/cloudera/parcels/CDH-5.4.0-1.cdh5.4.0.p0.23/jars/spark-assembly-1.3.0-cdh5.4.0-hadoop2.6.0-cdh5.4.0.jar/pyspark/java_gateway.py&quot;&lt;/span&gt;, line 32, in launch_gateway
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib64/python2.6/UserDict.py&quot;&lt;/span&gt;, line 22, in __getitem__
    raise KeyError(key)
KeyError: &lt;span class=&quot;code-quote&quot;&gt;&apos;SPARK_HOME&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14484259" author="vanzin" created="Tue, 7 Apr 2015 22:50:13 +0000"  >&lt;p&gt;Ah, makes sense. In yarn-cluster mode, that code should probably figure out what SPARK_HOME is based on what &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;__file__&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; returns, instead. Not sure what that would be when the file is inside a jar, though.&lt;/p&gt;</comment>
                            <comment id="14484271" author="vanzin" created="Tue, 7 Apr 2015 22:52:27 +0000"  >&lt;p&gt;Actually, that may not be enough... what if there really isn&apos;t a SPARK_HOME on the host launching the driver? What if there&apos;s no &quot;spark-submit&quot; to run?&lt;/p&gt;</comment>
                            <comment id="14484474" author="apachespark" created="Wed, 8 Apr 2015 01:00:59 +0000"  >&lt;p&gt;User &apos;vanzin&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/5405&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5405&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14484476" author="vanzin" created="Wed, 8 Apr 2015 01:01:11 +0000"  >&lt;p&gt;Ignore my previous comments, the fix is much, much simpler than that...  :-/&lt;/p&gt;</comment>
                            <comment id="14485571" author="joshrosen" created="Wed, 8 Apr 2015 17:15:25 +0000"  >&lt;p&gt;Issue resolved by pull request 5405&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/5405&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5405&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12788097">SPARK-6701</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12765993">SPARK-5173</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 32 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i27a4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>