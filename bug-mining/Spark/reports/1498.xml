<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:24:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-5529] BlockManager heartbeat expiration does not kill executor</title>
                <link>https://issues.apache.org/jira/browse/SPARK-5529</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;When I run a spark job, one executor is hold, after 120s, blockManager is removed by driver, but after half an hour before the executor is remove by  driver. Here is the log:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;15/02/02 14:58:43 WARN BlockManagerMasterActor: Removing BlockManager BlockManagerId(1, 10.215.143.14, 47234) with no recent heart beats: 147198ms exceeds 120000ms
....
15/02/02 15:26:55 ERROR YarnClientClusterScheduler: Lost executor 1 on 10.215.143.14: remote Akka client disassociated
15/02/02 15:26:55 WARN ReliableDeliverySupervisor: Association with remote system [akka.tcp:&lt;span class=&quot;code-comment&quot;&gt;//sparkExecutor@10.215.143.14:46182] has failed, address is now gated &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; [5000] ms. Reason is: [Disassociated].
&lt;/span&gt;15/02/02 15:26:55 INFO TaskSetManager: Re-queueing tasks &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 1 from TaskSet 0.0
15/02/02 15:26:55 WARN TaskSetManager: Lost task 3.0 in stage 0.0 (TID 3, 10.215.143.14): ExecutorLostFailure (executor 1 lost)
15/02/02 15:26:55 ERROR YarnClientSchedulerBackend: Asked to remove non-existent executor 1
15/02/02 15:26:55 INFO DAGScheduler: Executor lost: 1 (epoch 0)
15/02/02 15:26:55 INFO BlockManagerMasterActor: Trying to remove executor 1 from BlockManagerMaster.
15/02/02 15:26:55 INFO BlockManagerMaster: Removed 1 successfully in removeExecutor
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12771717">SPARK-5529</key>
            <summary>BlockManager heartbeat expiration does not kill executor</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shenhong">shenh062326</assignee>
                                    <reporter username="shenhong">shenh062326</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Feb 2015 12:37:16 +0000</created>
                <updated>Thu, 30 Apr 2015 16:06:14 +0000</updated>
                            <resolved>Fri, 27 Feb 2015 02:43:33 +0000</resolved>
                                    <version>1.2.0</version>
                                    <fixVersion>1.3.2</fixVersion>
                    <fixVersion>1.4.0</fixVersion>
                                    <component>Spark Core</component>
                    <component>YARN</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14301216" author="shenhong" created="Mon, 2 Feb 2015 12:41:35 +0000"  >&lt;p&gt;If a blockManager has not send heartBeat  more than 120s, BlockManagerMasterActor will remove it. But coarseGrainedSchedulerBackend can only remove executor after an DisassociatedEvent. Mybe the executor should remove after removing blockManager.&lt;/p&gt;</comment>
                            <comment id="14301236" author="lianhuiwang" created="Mon, 2 Feb 2015 13:00:02 +0000"  >&lt;p&gt;i think when akka timeout time &amp;gt; blockManagerSlaveTimeoutMs, that is happened. so i think you can set blockManagerSlaveTimeoutMs &amp;gt; akka timeout. because if executor is removed according to timeout, blockmanager on this executor can be removed by driver. &lt;/p&gt;</comment>
                            <comment id="14302665" author="shenhong" created="Tue, 3 Feb 2015 02:15:44 +0000"  >&lt;p&gt;But in fact, I have set spark.akka.timeout  = 100&lt;/p&gt;</comment>
                            <comment id="14302772" author="lianhuiwang" created="Tue, 3 Feb 2015 04:56:08 +0000"  >&lt;p&gt;if set spark.akka.timeout=100, why executor is lost after half a hour. i think we need to find the reason.&lt;/p&gt;</comment>
                            <comment id="14304433" author="shenhong" created="Wed, 4 Feb 2015 01:11:05 +0000"  >&lt;p&gt;Executor will lost when a akka throw a disassociatedEvent.&lt;/p&gt;</comment>
                            <comment id="14304509" author="lianhuiwang" created="Wed, 4 Feb 2015 02:20:45 +0000"  >&lt;p&gt;the phenomenon is:&lt;br/&gt;
blockManagerSlave is timeout  and BlockManagerMasterActor will remove this blockManager, but executor on this blockManager is not timeout because akka&apos;s heartbeat is normal.Because blockManager is in executor, if blockManager is removed, executor on this blockManager should be removed too.&lt;br/&gt;
Especially when dynamicAllocation is enabled, allocationManager listen onBlockManagerRemoved and remove this executor. but actually in CoarseGrainedSchedulerBackend it is still in executorDataMap.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rxin&quot; class=&quot;user-hover&quot; rel=&quot;rxin&quot;&gt;rxin&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrewor14&quot; class=&quot;user-hover&quot; rel=&quot;andrewor14&quot;&gt;andrewor14&lt;/a&gt;  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sandyr&quot; class=&quot;user-hover&quot; rel=&quot;sandyr&quot;&gt;sandyr&lt;/a&gt; when BlockManagerMasterActor remove blockmanager due to timeout of BlockManager, we need to check whether executor on this blockmanager has been removed. if its executor has not been removed, we should firstly remove this executor. how about this way to solve this problem? &lt;/p&gt;</comment>
                            <comment id="14304803" author="rxin" created="Wed, 4 Feb 2015 08:55:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lianhuiwang&quot; class=&quot;user-hover&quot; rel=&quot;lianhuiwang&quot;&gt;lianhuiwang&lt;/a&gt; yes - I think they should fate share. Are you interested in working on this? &lt;/p&gt;</comment>
                            <comment id="14304810" author="lianhuiwang" created="Wed, 4 Feb 2015 09:05:23 +0000"  >&lt;p&gt;OK, I will address a PR later and then please help to review code.&lt;/p&gt;</comment>
                            <comment id="14304819" author="shenhong" created="Wed, 4 Feb 2015 09:15:31 +0000"  >&lt;p&gt;I had changed it in our own branch.&lt;/p&gt;</comment>
                            <comment id="14304849" author="apachespark" created="Wed, 4 Feb 2015 09:47:47 +0000"  >&lt;p&gt;User &apos;shenh062326&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/4363&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/4363&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14305024" author="apachespark" created="Wed, 4 Feb 2015 12:36:14 +0000"  >&lt;p&gt;User &apos;lianhuiwang&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/4367&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/4367&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14305706" author="sandyr" created="Wed, 4 Feb 2015 18:46:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shenhong&quot; class=&quot;user-hover&quot; rel=&quot;shenhong&quot;&gt;shenhong&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lianhuiwang&quot; class=&quot;user-hover&quot; rel=&quot;lianhuiwang&quot;&gt;lianhuiwang&lt;/a&gt; both of these patches look good.  I&apos;m going to review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shenhong&quot; class=&quot;user-hover&quot; rel=&quot;shenhong&quot;&gt;shenhong&lt;/a&gt;&apos;s because it came first.&lt;/p&gt;</comment>
                            <comment id="14306378" author="lianhuiwang" created="Thu, 5 Feb 2015 01:22:01 +0000"  >&lt;p&gt;OK, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sandyr&quot; class=&quot;user-hover&quot; rel=&quot;sandyr&quot;&gt;sandyr&lt;/a&gt; thanks.&lt;/p&gt;</comment>
                            <comment id="14511374" author="arov" created="Fri, 24 Apr 2015 17:26:21 +0000"  >&lt;p&gt;We are facing this issue on cdh5.3.2 spark 1.2.0-SNAPSHOT&lt;/p&gt;

&lt;p&gt;Is there any workaround except upgrading to 1.4 version of spark?&lt;/p&gt;</comment>
                            <comment id="14512244" author="shenhong" created="Sat, 25 Apr 2015 04:29:30 +0000"  >&lt;p&gt;1.4.0 version would be release in june.&lt;/p&gt;</comment>
                            <comment id="14517257" author="arov" created="Tue, 28 Apr 2015 15:51:45 +0000"  >&lt;p&gt;CDH is usually somewhat slow on picking up the latest changes though. Would it be possible to backport this fix into 1.3?&lt;/p&gt;</comment>
                            <comment id="14517280" author="srowen" created="Tue, 28 Apr 2015 16:02:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arov&quot; class=&quot;user-hover&quot; rel=&quot;arov&quot;&gt;arov&lt;/a&gt; CDH always has the latest upstream minor release in minor releases, and back-ports maintenance release fixes into maintenance releases. This is on about the same 3-4 month cycle as Spark, so it&apos;s about as fast one could expect; CDH 5.4 = 1.3.x already. This change isn&apos;t even in a Spark release yet, so yes you want it to be back-ported to 1.3, probably. That has to precede ending up in CDH though.&lt;/p&gt;</comment>
                            <comment id="14517281" author="arov" created="Tue, 28 Apr 2015 16:02:11 +0000"  >&lt;p&gt;Applied patch to 1.3: &lt;a href=&quot;https://github.com/apache/spark/pull/5745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5745&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14517285" author="apachespark" created="Tue, 28 Apr 2015 16:02:45 +0000"  >&lt;p&gt;User &apos;alexrovner&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/5745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5745&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14517298" author="arov" created="Tue, 28 Apr 2015 16:08:30 +0000"  >&lt;p&gt;Sorry to quickly pulled the trigger... Need to resolve some compilation errors &lt;/p&gt;</comment>
                            <comment id="14517498" author="apachespark" created="Tue, 28 Apr 2015 17:35:23 +0000"  >&lt;p&gt;User &apos;alexrovner&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/5747&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5747&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14517499" author="arov" created="Tue, 28 Apr 2015 17:35:38 +0000"  >&lt;p&gt;Sorry about all the pull requests. Here is one rebased against the right branch and without any compilation issues: &lt;a href=&quot;https://github.com/apache/spark/pull/5747&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5747&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14520450" author="apachespark" created="Wed, 29 Apr 2015 22:51:03 +0000"  >&lt;p&gt;User &apos;alexrovner&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/5793&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5793&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14521727" author="srowen" created="Thu, 30 Apr 2015 16:06:14 +0000"  >&lt;p&gt;Backported to 1.3 in &lt;a href=&quot;https://github.com/apache/spark/pull/5793&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/5793&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12696416" name="SPARK-5529.patch" size="2879" author="shenhong" created="Wed, 4 Feb 2015 09:09:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 29 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i252nb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12329359">1.4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>