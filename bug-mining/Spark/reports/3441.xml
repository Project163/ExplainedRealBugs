<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:41:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-14915] Tasks that fail due to CommitDeniedException (a side-effect of speculation) can cause job to never complete</title>
                <link>https://issues.apache.org/jira/browse/SPARK-14915</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-14357&quot; title=&quot;Tasks that fail due to CommitDeniedException (a side-effect of speculation) can cause job failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-14357&quot;&gt;&lt;del&gt;SPARK-14357&lt;/del&gt;&lt;/a&gt;, code was corrected towards the originally intended behavior that a CommitDeniedException should not count towards the failure count for a job.  After having run with this fix for a few weeks, it&apos;s become apparent that this behavior has some unintended consequences - that a speculative task will continuously receive a CDE from the driver, now causing it to fail and retry over and over without limit.&lt;/p&gt;

&lt;p&gt;I&apos;m thinking we could put a task that receives a CDE from the driver, into a TaskState.FINISHED or some other state to indicated that the task shouldn&apos;t be resubmitted by the TaskScheduler. I&apos;d probably need some opinions on whether there are other consequences for doing something like this.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12962511">SPARK-14915</key>
            <summary>Tasks that fail due to CommitDeniedException (a side-effect of speculation) can cause job to never complete</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jasonmoore2k">Jason Moore</assignee>
                                    <reporter username="jasonmoore2k">Jason Moore</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Apr 2016 07:47:24 +0000</created>
                <updated>Fri, 5 Aug 2016 21:13:25 +0000</updated>
                            <resolved>Thu, 5 May 2016 10:02:58 +0000</resolved>
                                    <version>1.5.3</version>
                    <version>1.6.2</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.6.2</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15257773" author="srowen" created="Tue, 26 Apr 2016 08:55:21 +0000"  >&lt;p&gt;Paging &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrewor14&quot; class=&quot;user-hover&quot; rel=&quot;andrewor14&quot;&gt;andrewor14&lt;/a&gt; / &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kayousterhout&quot; class=&quot;user-hover&quot; rel=&quot;kayousterhout&quot;&gt;kayousterhout&lt;/a&gt; who probably know the scheduler logic best. Targeting for 2.0 as this seems relatively important to think through.&lt;/p&gt;</comment>
                            <comment id="15259920" author="jasonmoore2k" created="Wed, 27 Apr 2016 10:12:52 +0000"  >&lt;p&gt;Could I get thoughts on this: at &lt;a href=&quot;https://github.com/apache/spark/blob/branch-1.6/core/src/main/scala/org/apache/spark/scheduler/TaskSetManager.scala#L723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;TaskSetManager.scala#L723&lt;/a&gt; a call is made to addPendingTask after a task has failed.  I can think of a scenario that it might be a good idea not to add the task back into the pending queue: when success(index) == true (which implies that another copy of the task has already succeeded).&lt;/p&gt;

&lt;p&gt;I&apos;m soon going to test it out with the condition, as I think it&apos;s quite possibly what is causing tasks to continually re-queue after a CDE until the stage has completed (further lengthening the duration of the stage, as that take up execution resources).&lt;/p&gt;</comment>
                            <comment id="15260623" author="andrewor14" created="Wed, 27 Apr 2016 17:59:55 +0000"  >&lt;p&gt;I haven&apos;t looked into the scheduler code in detail yet, but it seems to me the bug is not caused by your fix to use the `CausedBy`. Rather, the bug has always existed, but your fix just uncovered it. It does seem like a problem in the scheduler; under no circumstances should we retry a stage without limits.&lt;/p&gt;</comment>
                            <comment id="15261252" author="jasonmoore2k" created="Thu, 28 Apr 2016 00:05:17 +0000"  >&lt;p&gt;That&apos;s exactly my current thinking too.  But even if keep allowing some tasks to be retried without limit in certain contexts (the current two I&apos;m aware of are: commit denied on speculative tasks or an executor lost because of a YARN de-allocation), it does seem that the commit denied is often happening when another copy has already succeeded.  I&apos;m about to do some testing on this now, and not re-queuing in this scenario.&lt;/p&gt;</comment>
                            <comment id="15261607" author="apachespark" created="Thu, 28 Apr 2016 06:30:03 +0000"  >&lt;p&gt;User &apos;jasonmoore2k&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/12751&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/12751&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15272146" author="srowen" created="Thu, 5 May 2016 10:02:58 +0000"  >&lt;p&gt;Issue resolved by pull request 12751&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/12751&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/12751&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15273830" author="apachespark" created="Fri, 6 May 2016 09:17:03 +0000"  >&lt;p&gt;User &apos;srowen&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/12950&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/12950&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12992207">SPARK-16709</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12955661">SPARK-14357</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2wqin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12329449">2.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>