<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:30:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-9366] TaskEnd event emitted for task has different stage attempt ID than TaskStart for same task</title>
                <link>https://issues.apache.org/jira/browse/SPARK-9366</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;During a simple job I ran yesterday, I observed the following in the event log:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;Event&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;SparkListenerTaskStart&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Stage ID&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;Stage Attempt ID&quot;&lt;/span&gt;:1,&lt;span class=&quot;code-quote&quot;&gt;&quot;Task Info&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;Task ID&quot;&lt;/span&gt;:10244,&lt;span class=&quot;code-quote&quot;&gt;&quot;Index&quot;&lt;/span&gt;:55,&lt;span class=&quot;code-quote&quot;&gt;&quot;Attempt&quot;&lt;/span&gt;:1,&lt;span class=&quot;code-quote&quot;&gt;&quot;Launch Time&quot;&lt;/span&gt;:1437767843724,&lt;span class=&quot;code-quote&quot;&gt;&quot;Executor ID&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;8&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Host&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;demeter-csmaz10-6.demeter.hpc.mssm.edu&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Locality&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;PROCESS_LOCAL&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Speculative&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Getting Result Time&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;Finish Time&quot;&lt;/span&gt;:1437767844387,&lt;span class=&quot;code-quote&quot;&gt;&quot;Failed&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Accumulables&quot;&lt;/span&gt;:[]}}
&#8230;
{&lt;span class=&quot;code-quote&quot;&gt;&quot;Event&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;SparkListenerTaskEnd&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Stage ID&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;Stage Attempt ID&quot;&lt;/span&gt;:2,&lt;span class=&quot;code-quote&quot;&gt;&quot;Task Type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;ShuffleMapTask&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Task End Reason&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;Reason&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;Success&quot;&lt;/span&gt;},&lt;span class=&quot;code-quote&quot;&gt;&quot;Task Info&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;Task ID&quot;&lt;/span&gt;:10244,&lt;span class=&quot;code-quote&quot;&gt;&quot;Index&quot;&lt;/span&gt;:55,&lt;span class=&quot;code-quote&quot;&gt;&quot;Attempt&quot;&lt;/span&gt;:1,&lt;span class=&quot;code-quote&quot;&gt;&quot;Launch Time&quot;&lt;/span&gt;:1437767843724,&lt;span class=&quot;code-quote&quot;&gt;&quot;Executor ID&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;8&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Host&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;demeter-csmaz10-6.demeter.hpc.mssm.edu&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Locality&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;PROCESS_LOCAL&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Speculative&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Getting Result Time&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;Finish Time&quot;&lt;/span&gt;:1437767844387,&lt;span class=&quot;code-quote&quot;&gt;&quot;Failed&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Accumulables&quot;&lt;/span&gt;:[]},&lt;span class=&quot;code-quote&quot;&gt;&quot;Task Metrics&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;Host Name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;demeter-csmaz10-6.demeter.hpc.mssm.edu&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Executor Deserialize Time&quot;&lt;/span&gt;:63,&lt;span class=&quot;code-quote&quot;&gt;&quot;Executor Run Time&quot;&lt;/span&gt;:579,&lt;span class=&quot;code-quote&quot;&gt;&quot;Result Size&quot;&lt;/span&gt;:2235,&lt;span class=&quot;code-quote&quot;&gt;&quot;JVM GC Time&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;Result Serialization Time&quot;&lt;/span&gt;:1,&lt;span class=&quot;code-quote&quot;&gt;&quot;Memory Bytes Spilled&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;Disk Bytes Spilled&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;Shuffle Write Metrics&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;Shuffle Bytes Written&quot;&lt;/span&gt;:2736,&lt;span class=&quot;code-quote&quot;&gt;&quot;Shuffle Write Time&quot;&lt;/span&gt;:1388809,&lt;span class=&quot;code-quote&quot;&gt;&quot;Shuffle Records Written&quot;&lt;/span&gt;:100},&lt;span class=&quot;code-quote&quot;&gt;&quot;Input Metrics&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;Data Read Method&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;Network&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Bytes Read&quot;&lt;/span&gt;:636000,&lt;span class=&quot;code-quote&quot;&gt;&quot;Records Read&quot;&lt;/span&gt;:100000}}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;tt&gt;TaskStart&lt;/tt&gt; event for task 10244 listed it (correctly) as coming from stage 0, attempt 1, but the &lt;tt&gt;TaskEnd&lt;/tt&gt; shows it as part of stage 0, attempt 2.&lt;/p&gt;

&lt;p&gt;I&apos;m pretty sure this is due to &lt;a href=&quot;https://github.com/apache/spark/blob/1efe97dc9ed31e3b8727b81be633b7e96dd3cd34/core/src/main/scala/org/apache/spark/scheduler/DAGScheduler.scala#L930&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this line&lt;/a&gt; in the DAGScheduler, which fills in the latest attempt ID for the task&apos;s stage, instead of the attempt that the task actually belongs to.&lt;/p&gt;

&lt;p&gt;I know there&apos;s a lot of flux right now around concurrent stage attempts and attempt-id-tracking, but this seems trivial to fix independent of that so I&apos;ll send a PR momentarily.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12849199">SPARK-9366</key>
            <summary>TaskEnd event emitted for task has different stage attempt ID than TaskStart for same task</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rdub">Ryan Williams</assignee>
                                    <reporter username="rdub">Ryan Williams</reporter>
                        <labels>
                    </labels>
                <created>Mon, 27 Jul 2015 02:37:26 +0000</created>
                <updated>Mon, 27 Jul 2015 17:54:45 +0000</updated>
                            <resolved>Mon, 27 Jul 2015 17:54:32 +0000</resolved>
                                    <version>1.4.1</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>Spark Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14642187" author="apachespark" created="Mon, 27 Jul 2015 02:58:05 +0000"  >&lt;p&gt;User &apos;ryan-williams&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7681&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7681&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14643109" author="irashid" created="Mon, 27 Jul 2015 17:54:32 +0000"  >&lt;p&gt;Issue resolved by pull request 7681&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/7681&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/7681&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 17 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2hy4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>