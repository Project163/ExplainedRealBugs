<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:19:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-13860] TPCDS query 39 returns wrong results compared to TPC official result set </title>
                <link>https://issues.apache.org/jira/browse/SPARK-13860</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;Testing Spark SQL using TPC queries. Query 39 returns wrong results compared to official result set. This is at 1GB SF (validation run).&lt;/p&gt;

&lt;p&gt;q39a - 3 extra rows in SparkSQL output (eg. &lt;span class=&quot;error&quot;&gt;&amp;#91;1,1155,1,184.0,NaN,1,1155,2,343.3333333333333,1.1700233592269733&amp;#93;&lt;/span&gt;)   ;  q39b - 3 extra rows in SparkSQL output (eg. &lt;span class=&quot;error&quot;&gt;&amp;#91;1,1155,1,184.0,NaN,1,1155,2,343.3333333333333,1.1700233592269733&amp;#93;&lt;/span&gt;)&lt;/p&gt;

&lt;p&gt;Actual results 39a:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[1,265,1,324.75,1.2438391781531353,1,265,2,329.0,1.0151581328149208]
[1,363,1,499.5,1.031941572270649,1,363,2,321.0,1.1411766752007977]
[1,679,1,373.75,1.0955498064867504,1,679,2,417.5,1.042970994259454]
[1,695,1,450.75,1.0835888283564505,1,695,2,368.75,1.1356494125569416]
[1,789,1,357.25,1.03450938027956,1,789,2,410.0,1.0284221852702604]
[1,815,1,216.5,1.1702270938111008,1,815,2,150.5,1.3057281471249382]
[1,827,1,271.75,1.1046890134130438,1,827,2,424.75,1.1653198631238286]
[1,1041,1,382.5,1.284808399803008,1,1041,2,424.75,1.000577271456812]
[1,1155,1,184.0,NaN,1,1155,2,343.3333333333333,1.1700233592269733]
[1,1569,1,212.0,1.630213519639535,1,1569,2,239.25,1.2641513267800557]
[1,1623,1,338.25,1.1285483279713715,1,1623,2,261.3333333333333,1.2717809002195564]
[1,2581,1,448.5,1.060429041250449,1,2581,2,476.25,1.0362984739390064]
[1,2705,1,246.25,1.0120308357959693,1,2705,2,294.6666666666667,1.0742134101583702]
[1,3131,1,393.75,1.0037613982687346,1,3131,2,480.5,1.0669144981482768]
[1,3291,1,374.5,1.195189833087008,1,3291,2,265.25,1.572972106948466]
[1,3687,1,279.75,1.4260909081999698,1,3687,2,157.25,1.4534340882531784]
[1,4955,1,495.25,1.0318296151625301,1,4955,2,322.5,1.1693842343776149]
[1,5627,1,282.75,1.5657032366359889,1,5627,2,297.5,1.2084286841430678]
[1,7017,1,175.5,1.0427454215644427,1,7017,2,321.3333333333333,1.0183356932936254]
[1,7317,1,366.3333333333333,1.025466403613547,1,7317,2,378.0,1.2172513189920555]
[1,7569,1,430.5,1.0874396852180854,1,7569,2,360.25,1.047005559314515]
[1,7999,1,166.25,1.7924231710846223,1,7999,2,375.3333333333333,1.008092263550718]
[1,8319,1,306.75,1.1615378040478215,1,8319,2,276.0,1.1420996385609428]
[1,8443,1,327.75,1.256718374192724,1,8443,2,332.5,1.0044167259988928]
[1,8583,1,319.5,1.024108893111539,1,8583,2,310.25,1.2358813775861328]
[1,8591,1,398.0,1.1478168692042447,1,8591,2,355.75,1.0024472149348966]
[1,8611,1,300.5,1.5191545184147954,1,8611,2,243.75,1.2342122780960432]
[1,9081,1,367.0,1.0878932141280895,1,9081,2,435.0,1.0330530776324107]
[1,9357,1,351.6666666666667,1.1902922622025887,1,9357,2,427.0,1.0438583026358363]
[1,9449,1,406.25,1.0183183104803557,1,9449,2,175.0,1.0544779796296408]
[1,9713,1,242.5,1.1035044355064203,1,9713,2,393.0,1.208474608738988]
[1,9809,1,479.0,1.0189602512117633,1,9809,2,317.5,1.0614142074924882]
[1,9993,1,417.75,1.0099832672435247,1,9993,2,204.5,1.552870745350107]
[1,10127,1,239.75,1.0561770587198123,1,10127,2,359.25,1.1857980403742183]
[1,11159,1,407.25,1.0785507154337637,1,11159,2,250.0,1.334757905639321]
[1,11277,1,211.25,1.2615858275316627,1,11277,2,330.75,1.0808767951625093]
[1,11937,1,344.5,1.085804026843784,1,11937,2,200.33333333333334,1.0638527063883725]
[1,12373,1,387.75,1.1014904822941258,1,12373,2,306.0,1.0761744390394028]
[1,12471,1,365.25,1.0607570183728479,1,12471,2,327.25,1.0547560580567852]
[1,12625,1,279.0,1.3016560542373208,1,12625,2,443.25,1.0604958838068959]
[1,12751,1,280.75,1.10833057888089,1,12751,2,369.3333333333333,1.3416504398884601]
[1,12779,1,331.0,1.041690207320035,1,12779,2,359.0,1.028978056175258]
[1,13077,1,367.6666666666667,1.345523904195734,1,13077,2,358.6666666666667,1.5132429058096555]
[1,13191,1,260.25,1.063569632291568,1,13191,2,405.0,1.0197999172180061]
[1,13561,1,335.25,1.2609616961776389,1,13561,2,240.0,1.0513604502245155]
[1,13935,1,311.75,1.0399289695412326,1,13935,2,275.0,1.0367527180321774]
[1,14687,1,358.0,1.4369356919381713,1,14687,2,187.0,1.5493631531474956]
[1,14719,1,209.0,1.0411509639707628,1,14719,2,489.0,1.376616882800804]
[1,15345,1,148.5,1.5295784035794024,1,15345,2,246.5,1.5087987747231526]
[1,15427,1,482.75,1.0124238928335043,1,15427,2,333.25,1.2724770126308678]
[1,15647,1,201.66666666666666,1.2857931876095743,1,15647,2,249.25,1.3648172990142162]
[1,16079,1,280.5,1.2444757416128578,1,16079,2,361.25,1.0737805704078724]
[1,16223,1,245.66666666666666,1.0601148956398867,1,16223,2,412.6666666666667,1.0671231071323724]
[1,16289,1,171.0,1.087263313842661,1,16289,2,316.5,1.3695306694071203]
[1,16451,1,300.0,1.2516507618459831,1,16451,2,467.5,1.2962363881858208]
[1,17051,1,349.75,1.1346423819845488,1,17051,2,319.75,1.0379354897438076]
[2,71,1,221.5,1.563974108334745,2,71,2,309.0,1.4917057895885681]
[2,833,1,363.3333333333333,1.0422813802180273,2,833,2,158.75,1.2130891736268552]
[2,969,1,282.0,1.1374340344037195,2,969,2,386.0,1.1371001187232186]
[2,1401,1,249.0,1.3206237689155225,2,1401,2,296.6666666666667,1.2868121931744592]
[2,1681,1,337.75,1.052156598827189,2,1681,2,252.75,1.03179106854817]
[2,1991,1,356.0,1.1336790046919885,2,1991,2,273.25,1.3324196418089087]
[2,2031,1,407.5,1.0209876826110387,2,2031,2,418.75,1.0053388632912839]
[2,2481,1,319.75,1.116026660755801,2,2481,2,378.3333333333333,1.0597185274084644]
[2,2725,1,349.75,1.1148704918064747,2,2725,2,265.6666666666667,1.5462972148471539]
[2,3073,1,385.0,1.1020845844189129,2,3073,2,231.75,1.0884989063827268]
[2,3769,1,334.0,1.19542966145639,2,3769,2,335.0,1.049464958250903]
[2,4085,1,327.75,1.1005413873145125,2,4085,2,281.75,1.0187608064801108]
[2,4995,1,282.25,1.260418332957406,2,4995,2,248.0,1.2548229018823531]
[2,5099,1,418.6666666666667,1.0680900887970652,2,5099,2,428.6666666666667,1.035237277800474]
[2,5211,1,157.0,1.069551742865467,2,5211,2,270.25,1.1940200809618973]
[2,5429,1,152.0,NaN,2,5429,2,355.25,1.1230959744909077]
[2,5769,1,341.25,1.2723132696563741,2,5769,2,267.0,1.1815791848719037]
[2,6103,1,194.33333333333334,1.5160670179307387,2,6103,2,158.5,1.2743698636165062]
[2,6243,1,168.5,1.0732108100023512,2,6243,2,386.75,1.083290260548026]
[2,6489,1,268.0,1.6956372368432269,2,6489,2,389.0,1.4105780519299767]
[2,6585,1,183.75,1.1151937581317735,2,6585,2,353.75,1.09397071467533]
[2,6767,1,341.0,1.093163984134538,2,6767,2,235.0,1.1399543855818017]
[2,7411,1,460.0,1.0628293255143475,2,7411,2,297.5,1.000576535072398]
[2,8489,1,126.75,1.341646295852091,2,8489,2,398.25,1.0041124840252154]
[2,8633,1,218.5,1.4645189740171023,2,8633,2,230.25,1.3116963014576621]
[2,8807,1,417.25,1.0258112930013772,2,8807,2,356.25,1.1079730633089233]
[2,8883,1,249.25,1.1112271782210548,2,8883,2,189.25,1.010075485139798]
[2,9253,1,413.3333333333333,1.1606659948102405,2,9253,2,465.0,1.0242445824028785]
[2,9467,1,108.25,1.091122388968745,2,9467,2,107.0,1.0309220361224432]
[2,9561,1,190.5,1.0303032513373167,2,9561,2,271.0,1.2058349535542998]
[2,9575,1,452.5,1.0494492226058958,2,9575,2,155.75,1.1534056685643725]
[2,9903,1,322.75,1.0761080062556017,2,9903,2,387.3333333333333,1.2612406773451965]
[2,10535,1,324.3333333333333,1.0571104035094094,2,10535,2,310.25,1.0040634995190338]
[2,10955,1,356.0,1.1582813310955151,2,10955,2,339.0,1.070253213625449]
[2,12089,1,212.0,1.0827501145734215,2,12089,2,173.33333333333334,1.0739812153327328]
[2,12633,1,402.75,1.0071362075740695,2,12633,2,367.0,1.1270535638607155]
[2,12765,1,308.0,1.1188476882701337,2,12765,2,347.0,1.1571744590236304]
[2,13077,1,277.0,1.2323360849352152,2,13077,2,223.5,1.139400344912951]
[2,13687,1,361.25,1.0107341657610867,2,13687,2,468.25,1.00984291842181]
[2,14025,1,371.75,1.0150136083050016,2,14025,2,141.0,1.2543170259746204]
[2,14117,1,298.5,1.0251238034747268,2,14117,2,220.25,1.4152684465941172]
[2,14347,1,366.0,1.0327892946261927,2,14347,2,369.75,1.0185739900192863]
[2,14697,1,397.75,1.008120541714483,2,14697,2,328.75,1.160849558029165]
[2,14987,1,146.75,1.0290040643611427,2,14987,2,436.5,1.0447681541795646]
[2,15321,1,527.0,1.2102662554654002,2,15321,2,298.75,1.1309098406792113]
[2,15347,1,243.0,1.22262397963835,2,15347,2,310.75,1.2036584852655927]
[2,15533,1,223.0,1.096511132968014,2,15533,2,330.0,1.4967488488790472]
[2,15839,1,353.0,1.5063684437542906,2,15839,2,255.5,1.2362393182894105]
[2,16107,1,376.0,1.0133246306103783,2,16107,2,364.75,1.0688677983776653]
[2,16749,1,200.0,1.0944709528656604,2,16749,2,438.25,1.0360646618074532]
[2,17329,1,321.3333333333333,1.3093279467658028,2,17329,2,490.25,1.0756580649722338]
[2,17417,1,321.75,1.1306764803839018,2,17417,2,534.0,1.0010725216798313]
[3,1049,1,252.5,1.1090641101125922,3,1049,2,457.25,1.023984124924537]
[3,1415,1,247.5,1.1321617788582448,3,1415,2,369.75,1.095467956288316]
[3,2199,1,185.75,1.2028125570694115,3,2199,2,300.75,1.0767845064923047]
[3,2403,1,270.75,1.3258705678179297,3,2403,2,384.0,1.0903987183011015]
[3,2541,1,364.75,1.079213526102894,3,2541,2,550.5,1.0545588871101828]
[3,2727,1,303.75,1.030164700291085,3,2727,2,219.25,1.3822091831959378]
[3,3207,1,383.75,1.0854588026477912,3,3207,2,258.25,1.2113392480929654]
[3,3373,1,404.5,1.0143374143806878,3,3373,2,171.25,1.2856653974632997]
[3,3969,1,234.25,1.0422831793090308,3,3969,2,217.25,1.4215490653321186]
[3,4407,1,438.5,1.0656663545113982,3,4407,2,330.75,1.0244403968428872]
[3,6051,1,289.75,1.263888088484336,3,6051,2,439.0,1.1045769245192738]
[3,6521,1,381.0,1.001568291887839,3,6521,2,437.75,1.0365149332658257]
[3,6691,1,377.0,1.1090737292917523,3,6691,2,380.5,1.0581301250281556]
[3,6757,1,282.5,1.089500938688411,3,6757,2,345.25,1.2263828747838474]
[3,6915,1,420.6666666666667,1.0468345634906968,3,6915,2,292.5,1.2506171072716117]
[3,7207,1,329.6666666666667,1.5954482160720393,3,7207,2,414.5,1.017919707908937]
[3,7889,1,318.5,1.2879030049985103,3,7889,2,291.3333333333333,1.0042925323922787]
[3,8559,1,356.25,1.0065193461695627,3,8559,2,393.5,1.0128831652141206]
[3,8829,1,364.25,1.0792852260446875,3,8829,2,350.25,1.1133912240741104]
[3,9555,1,377.0,1.1308469328910158,3,9555,2,444.75,1.0171588175042319]
[3,9623,1,331.3333333333333,1.1551289271934477,3,9623,2,284.6666666666667,1.030372442625732]
[3,9813,1,343.75,1.0516953753508833,3,9813,2,384.6666666666667,1.0815005906604849]
[3,9881,1,351.5,1.1788820554157222,3,9881,2,287.75,1.0909386089510784]
[3,10035,1,378.25,1.0216399511791376,3,10035,2,364.25,1.1567922653398062]
[3,10509,1,420.25,1.0548626901275737,3,10509,2,368.25,1.1820633359473098]
[3,10547,1,182.33333333333334,1.5325641514869042,3,10547,2,320.25,1.302441844373152]
[3,10743,1,233.25,1.2793022354241157,3,10743,2,110.25,1.107204634127507]
[3,11477,1,264.25,1.0953530000836025,3,11477,2,278.5,1.03279098170704]
[3,11959,1,358.0,1.0684835251792983,3,11959,2,268.5,1.0089856798911991]
[3,12043,1,169.25,1.033093808880221,3,12043,2,377.25,1.0161962499718764]
[3,12157,1,326.3333333333333,1.0022318670551493,3,12157,2,396.3333333333333,1.0287818050404882]
[3,12433,1,199.75,1.307258924061962,3,12433,2,478.5,1.0164742071947392]
[3,12867,1,278.25,1.6403800123947352,3,12867,2,350.75,1.2006933321742796]
[3,13499,1,281.0,1.1431965457521192,3,13499,2,446.75,1.0331520262675382]
[3,14589,1,266.5,1.1143243921844956,3,14589,2,334.3333333333333,1.1453146816350117]
[3,15207,1,300.25,1.4844611263753311,3,15207,2,564.0,1.0004808712533066]
[3,15395,1,258.25,1.0513876898285774,3,15395,2,307.5,1.138225319310722]
[3,15973,1,477.5,1.203932592889347,3,15973,2,286.0,1.2872294241999072]
[3,16233,1,260.6666666666667,1.120423550056809,3,16233,2,210.5,1.1788143336685517]
[3,16267,1,456.0,1.00422634651884,3,16267,2,364.3333333333333,1.4818855428309732]
[3,16605,1,394.25,1.1137413572906039,3,16605,2,296.25,1.2885892655671596]
[3,16949,1,155.75,1.1186177285449939,3,16949,2,229.5,1.0289469196724543]
[3,17319,1,364.75,1.2709364445674023,3,17319,2,359.25,1.1578751434862422]
[4,947,1,247.5,1.6933181813486973,4,947,2,203.33333333333334,1.205433145161931]
[4,1895,1,354.75,1.2397341541992284,4,1895,2,383.75,1.0893076992144062]
[4,3429,1,358.5,1.0665593354923446,4,3429,2,346.0,1.251948930065546]
[4,4559,1,215.0,1.2432329900432981,4,4559,2,360.75,1.0333545857247315]
[4,4773,1,328.25,1.0509836592960142,4,4773,2,330.5,1.0062580596877206]
[4,4885,1,151.0,1.3205570350636184,4,4885,2,377.25,1.0489035237886835]
[4,4915,1,289.25,1.0863929490514617,4,4915,2,368.0,1.069658554605372]
[4,5043,1,476.0,1.0155964276489484,4,5043,2,244.25,1.356289369084929]
[4,5095,1,334.0,1.2258861291353158,4,5095,2,390.25,1.0621788063332436]
[4,5193,1,263.3333333333333,1.250170954501139,4,5193,2,323.0,1.0979616195802828]
[4,5975,1,434.0,1.0233614450980864,4,5975,2,359.75,1.1979356900084084]
[4,6251,1,285.0,1.121538025585264,4,6251,2,335.5,1.1602192523957113]
[4,6389,1,280.75,1.2049236089487845,4,6389,2,259.3333333333333,1.4816550575659286]
[4,6487,1,452.75,1.0710626602211524,4,6487,2,350.5,1.17164756896522]
[4,6619,1,430.0,1.0007262551157654,4,6619,2,226.25,1.548557450713079]
[4,7191,1,260.75,1.0012666837154778,4,7191,2,195.25,1.5372675520067365]
[4,7427,1,239.5,1.4183567144406795,4,7427,2,373.25,1.0429791976763843]
[4,8453,1,314.75,1.0259714909803297,4,8453,2,376.75,1.0099023931660849]
[4,8781,1,518.5,1.100549995019371,4,8781,2,521.0,1.123770469908755]
[4,9571,1,314.0,1.216857824298178,4,9571,2,309.0,1.089216738940079]
[4,9587,1,248.0,1.4981887260612339,4,9587,2,248.0,1.0064987840475923]
[4,10249,1,240.75,1.6058403557773568,4,10249,2,689.0,NaN]
[4,10333,1,321.0,1.1486107061789543,4,10333,2,317.0,1.0469226317412668]
[4,10969,1,186.66666666666666,1.104420616413504,4,10969,2,307.0,1.1094764105733856]
[4,10993,1,446.0,1.0092376322965588,4,10993,2,206.66666666666666,1.2355333519949105]
[4,11571,1,342.5,1.142628399354839,4,11571,2,304.6666666666667,1.0319943224652848]
[4,11979,1,225.33333333333334,1.4670656155247088,4,11979,2,438.25,1.1389926990347663]
[4,13409,1,312.3333333333333,1.3427502512651466,4,13409,2,336.25,1.1081978302033695]
[4,13443,1,417.75,1.0217796082231347,4,13443,2,334.0,1.3076430852966527]
[4,13567,1,271.5,1.0087621621432743,4,13567,2,370.0,1.4557686063410562]
[4,13683,1,318.75,1.0149827729946173,4,13683,2,363.5,1.0781154578332095]
[4,14143,1,367.0,1.0441799438931547,4,14143,2,290.0,1.1933060754121454]
[4,14401,1,342.75,1.1836559036030756,4,14401,2,344.25,1.2067083116272619]
[4,14693,1,447.25,1.0516674911652102,4,14693,2,498.0,1.3517382644369342]
[4,14877,1,414.3333333333333,1.1707723877930458,4,14877,2,282.5,1.5830582944346865]
[4,15063,1,378.25,1.1128192588166839,4,15063,2,444.0,1.0632777688204158]
[4,15275,1,335.5,1.1536382939175558,4,15275,2,292.6666666666667,1.2978313681037048]
[4,15509,1,296.3333333333333,1.0246740536582173,4,15509,2,317.6666666666667,1.4470364565078238]
[4,15969,1,423.0,1.0472875497665224,4,15969,2,342.5,1.2511769371808568]
[4,16627,1,485.5,1.0151460895716244,4,16627,2,161.25,1.353325272620004]
[4,16641,1,521.5,1.1050662064564454,4,16641,2,221.5,1.0308590510025117]
[4,16751,1,549.5,1.082214382125362,4,16751,2,223.33333333333334,1.3377897605859543]
[5,75,1,333.0,1.2656318762849212,5,75,2,226.0,1.0358078507992579]
[5,125,1,441.6666666666667,1.095971457377544,5,125,2,331.5,1.0081148286008836]
[5,431,1,159.0,1.1061794752181042,5,431,2,304.0,1.1224225373103636]
[5,671,1,403.3333333333333,1.0056014147334147,5,671,2,281.3333333333333,1.3366835222521476]
[5,745,1,466.75,1.0109065525578562,5,745,2,351.0,1.1147212881684183]
[5,1701,1,374.0,1.086445817024878,5,1701,2,385.0,1.3306308700750535]
[5,2521,1,360.75,1.099248234149208,5,2521,2,265.5,1.1724077694006725]
[5,2855,1,406.0,1.4037637084639343,5,2855,2,183.25,1.0662249910239627]
[5,3137,1,271.25,1.575453220592864,5,3137,2,380.0,1.0834203388600319]
[5,3279,1,299.5,1.053669716363755,5,3279,2,276.75,1.4458878093841827]
[5,3467,1,294.0,1.1477294638716873,5,3467,2,349.6666666666667,1.1674223692818808]
[5,4463,1,338.0,1.0699320081481432,5,4463,2,273.5,1.2369797321835678]
[5,4719,1,340.5,1.0571857801805542,5,4719,2,423.6666666666667,1.0255000206713487]
[5,4739,1,281.3333333333333,1.0242971514325028,5,4739,2,383.5,1.0334337390189823]
[5,4839,1,310.25,1.035903440911969,5,4839,2,232.0,1.2954193820330193]
[5,4979,1,359.5,1.1046408074063157,5,4979,2,323.75,1.1704250950730493]
[5,5401,1,219.25,1.2773870241916032,5,5401,2,203.0,1.0915675205208268]
[5,5635,1,370.0,1.0227054644459215,5,5635,2,351.6666666666667,1.3777664464428738]
[5,5797,1,403.0,1.0234882286709048,5,5797,2,457.5,1.003704010389515]
[5,5901,1,360.25,1.125963126923387,5,5901,2,376.0,1.0095038425625151]
[5,6129,1,419.25,1.0169180165631466,5,6129,2,359.5,1.0478889386811094]
[5,6213,1,351.6666666666667,1.2056212536733542,5,6213,2,361.5,1.116840805855076]
[5,6479,1,301.3333333333333,1.2780010449304997,5,6479,2,395.75,1.1779743547973778]
[5,7333,1,227.0,1.4611346002650127,5,7333,2,243.75,1.1789162497808614]
[5,7923,1,358.0,1.1046770912449826,5,7923,2,342.3333333333333,1.1607781125264065]
[5,8737,1,217.25,1.074213640090777,5,8737,2,403.5,1.044208050277477]
[5,8945,1,344.25,1.1414837656266814,5,8945,2,298.0,1.0008366993492595]
[5,8993,1,399.0,1.1873722892104934,5,8993,2,371.75,1.131635380135078]
[5,10667,1,288.0,1.3453640177579367,5,10667,2,289.5,1.0952238011728228]
[5,10771,1,394.75,1.048068013117441,5,10771,2,323.25,1.2377348818060852]
[5,10949,1,383.0,1.1125677373995029,5,10949,2,378.25,1.125540609959554]
[5,11107,1,446.5,1.2653489768601378,5,11107,2,258.5,1.553612564193816]
[5,11795,1,395.5,1.0104473172545645,5,11795,2,430.75,1.131062588545398]
[5,12017,1,347.75,1.1682379397902218,5,12017,2,308.0,1.1593227968413717]
[5,12027,1,456.25,1.0262940073409625,5,12027,2,390.3333333333333,1.1142770095355214]
[5,13583,1,430.3333333333333,1.0423839290527277,5,13583,2,256.25,1.541034827728967]
[5,13651,1,272.3333333333333,1.169523124191674,5,13651,2,330.5,1.1901873530915061]
[5,13783,1,419.5,1.0584699696320432,5,13783,2,339.5,1.0680909505443135]
[5,13859,1,318.0,1.1422239044797105,5,13859,2,380.25,1.0564496237557859]
[5,14537,1,206.0,1.2283439997338772,5,14537,2,357.75,1.0387982680964687]
[5,15309,1,276.3333333333333,1.2987590579253725,5,15309,2,409.0,1.0102406245856923]
[5,15883,1,385.3333333333333,1.0124777526338786,5,15883,2,173.25,1.3562238248195932]
[5,15935,1,293.5,1.0187659410172984,5,15935,2,271.25,1.4000947515083553]
[5,15949,1,241.5,1.148665986924513,5,15949,2,235.0,1.4072887931753781]
[5,16037,1,327.25,1.1307617323781536,5,16037,2,412.6666666666667,1.1830200153757018]
[5,16291,1,380.5,1.0549595028454235,5,16291,2,411.6666666666667,1.034921399084621]
[5,16459,1,370.0,1.275649908122718,5,16459,2,265.75,1.2988191692443933]
[5,16901,1,305.25,1.1043010533964068,5,16901,2,186.5,1.0231269284283626]
[5,17199,1,376.5,1.1038969766440296,5,17199,2,374.0,1.0873031171988548]
[5,17387,1,298.3333333333333,1.3848741714581234,5,17387,2,327.6666666666667,1.3670875783476784]
[5,17717,1,283.75,1.1557156567771052,5,17717,2,235.25,1.1416239351288795]
[5,17927,1,217.5,1.3549964301320125,5,17927,2,250.75,1.070921305926391]
[5,17943,1,209.75,1.3717071339917375,5,17943,2,428.0,1.1090799349168265]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Expected 39a:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+----------------+-----------+-------+-----------+---------+----------------+-----------+-------+-----------+---------+
| W_WAREHOUSE_SK | I_ITEM_SK | D_MOY |      MEAN |     COV | W_WAREHOUSE_SK | I_ITEM_SK | D_MOY |      MEAN |     COV |
+----------------+-----------+-------+-----------+---------+----------------+-----------+-------+-----------+---------+
|              1 |       265 |     1 | 324.75000 | 1.24384 |              1 |       265 |     2 | 329.00000 | 1.01516 |
|              1 |       363 |     1 | 499.50000 | 1.03194 |              1 |       363 |     2 | 321.00000 | 1.14118 |
|              1 |       679 |     1 | 373.75000 | 1.09555 |              1 |       679 |     2 | 417.50000 | 1.04297 |
|              1 |       695 |     1 | 450.75000 | 1.08359 |              1 |       695 |     2 | 368.75000 | 1.13565 |
|              1 |       789 |     1 | 357.25000 | 1.03451 |              1 |       789 |     2 | 410.00000 | 1.02842 |
|              1 |       815 |     1 | 216.50000 | 1.17023 |              1 |       815 |     2 | 150.50000 | 1.30573 |
|              1 |       827 |     1 | 271.75000 | 1.10469 |              1 |       827 |     2 | 424.75000 | 1.16532 |
|              1 |      1041 |     1 | 382.50000 | 1.28481 |              1 |      1041 |     2 | 424.75000 | 1.00058 |
|              1 |      1569 |     1 | 212.00000 | 1.63021 |              1 |      1569 |     2 | 239.25000 | 1.26415 |
|              1 |      1623 |     1 | 338.25000 | 1.12855 |              1 |      1623 |     2 | 261.33333 | 1.27178 |
|              1 |      2581 |     1 | 448.50000 | 1.06043 |              1 |      2581 |     2 | 476.25000 | 1.03630 |
|              1 |      2705 |     1 | 246.25000 | 1.01203 |              1 |      2705 |     2 | 294.66667 | 1.07421 |
|              1 |      3131 |     1 | 393.75000 | 1.00376 |              1 |      3131 |     2 | 480.50000 | 1.06691 |
|              1 |      3291 |     1 | 374.50000 | 1.19519 |              1 |      3291 |     2 | 265.25000 | 1.57297 |
|              1 |      3687 |     1 | 279.75000 | 1.42609 |              1 |      3687 |     2 | 157.25000 | 1.45343 |
|              1 |      4955 |     1 | 495.25000 | 1.03183 |              1 |      4955 |     2 | 322.50000 | 1.16938 |
|              1 |      5627 |     1 | 282.75000 | 1.56570 |              1 |      5627 |     2 | 297.50000 | 1.20843 |
|              1 |      7017 |     1 | 175.50000 | 1.04275 |              1 |      7017 |     2 | 321.33333 | 1.01834 |
|              1 |      7317 |     1 | 366.33333 | 1.02547 |              1 |      7317 |     2 | 378.00000 | 1.21725 |
|              1 |      7569 |     1 | 430.50000 | 1.08744 |              1 |      7569 |     2 | 360.25000 | 1.04701 |
|              1 |      7999 |     1 | 166.25000 | 1.79242 |              1 |      7999 |     2 | 375.33333 | 1.00809 |
|              1 |      8319 |     1 | 306.75000 | 1.16154 |              1 |      8319 |     2 | 276.00000 | 1.14210 |
|              1 |      8443 |     1 | 327.75000 | 1.25672 |              1 |      8443 |     2 | 332.50000 | 1.00442 |
|              1 |      8583 |     1 | 319.50000 | 1.02411 |              1 |      8583 |     2 | 310.25000 | 1.23588 |
|              1 |      8591 |     1 | 398.00000 | 1.14782 |              1 |      8591 |     2 | 355.75000 | 1.00245 |
|              1 |      8611 |     1 | 300.50000 | 1.51915 |              1 |      8611 |     2 | 243.75000 | 1.23421 |
|              1 |      9081 |     1 | 367.00000 | 1.08789 |              1 |      9081 |     2 | 435.00000 | 1.03305 |
|              1 |      9357 |     1 | 351.66667 | 1.19029 |              1 |      9357 |     2 | 427.00000 | 1.04386 |
|              1 |      9449 |     1 | 406.25000 | 1.01832 |              1 |      9449 |     2 | 175.00000 | 1.05448 |
|              1 |      9713 |     1 | 242.50000 | 1.10350 |              1 |      9713 |     2 | 393.00000 | 1.20847 |
|              1 |      9809 |     1 | 479.00000 | 1.01896 |              1 |      9809 |     2 | 317.50000 | 1.06141 |
|              1 |      9993 |     1 | 417.75000 | 1.00998 |              1 |      9993 |     2 | 204.50000 | 1.55287 |
|              1 |     10127 |     1 | 239.75000 | 1.05618 |              1 |     10127 |     2 | 359.25000 | 1.18580 |
|              1 |     11159 |     1 | 407.25000 | 1.07855 |              1 |     11159 |     2 | 250.00000 | 1.33476 |
|              1 |     11277 |     1 | 211.25000 | 1.26159 |              1 |     11277 |     2 | 330.75000 | 1.08088 |
|              1 |     11937 |     1 | 344.50000 | 1.08580 |              1 |     11937 |     2 | 200.33333 | 1.06385 |
|              1 |     12373 |     1 | 387.75000 | 1.10149 |              1 |     12373 |     2 | 306.00000 | 1.07617 |
|              1 |     12471 |     1 | 365.25000 | 1.06076 |              1 |     12471 |     2 | 327.25000 | 1.05476 |
|              1 |     12625 |     1 | 279.00000 | 1.30166 |              1 |     12625 |     2 | 443.25000 | 1.06050 |
|              1 |     12751 |     1 | 280.75000 | 1.10833 |              1 |     12751 |     2 | 369.33333 | 1.34165 |
|              1 |     12779 |     1 | 331.00000 | 1.04169 |              1 |     12779 |     2 | 359.00000 | 1.02898 |
|              1 |     13077 |     1 | 367.66667 | 1.34552 |              1 |     13077 |     2 | 358.66667 | 1.51324 |
|              1 |     13191 |     1 | 260.25000 | 1.06357 |              1 |     13191 |     2 | 405.00000 | 1.01980 |
|              1 |     13561 |     1 | 335.25000 | 1.26096 |              1 |     13561 |     2 | 240.00000 | 1.05136 |
|              1 |     13935 |     1 | 311.75000 | 1.03993 |              1 |     13935 |     2 | 275.00000 | 1.03675 |
|              1 |     14687 |     1 | 358.00000 | 1.43694 |              1 |     14687 |     2 | 187.00000 | 1.54936 |
|              1 |     14719 |     1 | 209.00000 | 1.04115 |              1 |     14719 |     2 | 489.00000 | 1.37662 |
|              1 |     15345 |     1 | 148.50000 | 1.52958 |              1 |     15345 |     2 | 246.50000 | 1.50880 |
|              1 |     15427 |     1 | 482.75000 | 1.01242 |              1 |     15427 |     2 | 333.25000 | 1.27248 |
|              1 |     15647 |     1 | 201.66667 | 1.28579 |              1 |     15647 |     2 | 249.25000 | 1.36482 |
|              1 |     16079 |     1 | 280.50000 | 1.24448 |              1 |     16079 |     2 | 361.25000 | 1.07378 |
|              1 |     16223 |     1 | 245.66667 | 1.06011 |              1 |     16223 |     2 | 412.66667 | 1.06712 |
|              1 |     16289 |     1 | 171.00000 | 1.08726 |              1 |     16289 |     2 | 316.50000 | 1.36953 |
|              1 |     16451 |     1 | 300.00000 | 1.25165 |              1 |     16451 |     2 | 467.50000 | 1.29624 |
|              1 |     17051 |     1 | 349.75000 | 1.13464 |              1 |     17051 |     2 | 319.75000 | 1.03794 |
|              2 |        71 |     1 | 221.50000 | 1.56397 |              2 |        71 |     2 | 309.00000 | 1.49171 |
|              2 |       833 |     1 | 363.33333 | 1.04228 |              2 |       833 |     2 | 158.75000 | 1.21309 |
|              2 |       969 |     1 | 282.00000 | 1.13743 |              2 |       969 |     2 | 386.00000 | 1.13710 |
|              2 |      1401 |     1 | 249.00000 | 1.32062 |              2 |      1401 |     2 | 296.66667 | 1.28681 |
|              2 |      1681 |     1 | 337.75000 | 1.05216 |              2 |      1681 |     2 | 252.75000 | 1.03179 |
|              2 |      1991 |     1 | 356.00000 | 1.13368 |              2 |      1991 |     2 | 273.25000 | 1.33242 |
|              2 |      2031 |     1 | 407.50000 | 1.02099 |              2 |      2031 |     2 | 418.75000 | 1.00534 |
|              2 |      2481 |     1 | 319.75000 | 1.11603 |              2 |      2481 |     2 | 378.33333 | 1.05972 |
|              2 |      2725 |     1 | 349.75000 | 1.11487 |              2 |      2725 |     2 | 265.66667 | 1.54630 |
|              2 |      3073 |     1 | 385.00000 | 1.10208 |              2 |      3073 |     2 | 231.75000 | 1.08850 |
|              2 |      3769 |     1 | 334.00000 | 1.19543 |              2 |      3769 |     2 | 335.00000 | 1.04946 |
|              2 |      4085 |     1 | 327.75000 | 1.10054 |              2 |      4085 |     2 | 281.75000 | 1.01876 |
|              2 |      4995 |     1 | 282.25000 | 1.26042 |              2 |      4995 |     2 | 248.00000 | 1.25482 |
|              2 |      5099 |     1 | 418.66667 | 1.06809 |              2 |      5099 |     2 | 428.66667 | 1.03524 |
|              2 |      5211 |     1 | 157.00000 | 1.06955 |              2 |      5211 |     2 | 270.25000 | 1.19402 |
|              2 |      5769 |     1 | 341.25000 | 1.27231 |              2 |      5769 |     2 | 267.00000 | 1.18158 |
|              2 |      6103 |     1 | 194.33333 | 1.51607 |              2 |      6103 |     2 | 158.50000 | 1.27437 |
|              2 |      6243 |     1 | 168.50000 | 1.07321 |              2 |      6243 |     2 | 386.75000 | 1.08329 |
|              2 |      6489 |     1 | 268.00000 | 1.69564 |              2 |      6489 |     2 | 389.00000 | 1.41058 |
|              2 |      6585 |     1 | 183.75000 | 1.11519 |              2 |      6585 |     2 | 353.75000 | 1.09397 |
|              2 |      6767 |     1 | 341.00000 | 1.09316 |              2 |      6767 |     2 | 235.00000 | 1.13995 |
|              2 |      7411 |     1 | 460.00000 | 1.06283 |              2 |      7411 |     2 | 297.50000 | 1.00058 |
|              2 |      8489 |     1 | 126.75000 | 1.34165 |              2 |      8489 |     2 | 398.25000 | 1.00411 |
|              2 |      8633 |     1 | 218.50000 | 1.46452 |              2 |      8633 |     2 | 230.25000 | 1.31170 |
|              2 |      8807 |     1 | 417.25000 | 1.02581 |              2 |      8807 |     2 | 356.25000 | 1.10797 |
|              2 |      8883 |     1 | 249.25000 | 1.11123 |              2 |      8883 |     2 | 189.25000 | 1.01008 |
|              2 |      9253 |     1 | 413.33333 | 1.16067 |              2 |      9253 |     2 | 465.00000 | 1.02424 |
|              2 |      9467 |     1 | 108.25000 | 1.09112 |              2 |      9467 |     2 | 107.00000 | 1.03092 |
|              2 |      9561 |     1 | 190.50000 | 1.03030 |              2 |      9561 |     2 | 271.00000 | 1.20583 |
|              2 |      9575 |     1 | 452.50000 | 1.04945 |              2 |      9575 |     2 | 155.75000 | 1.15341 |
|              2 |      9903 |     1 | 322.75000 | 1.07611 |              2 |      9903 |     2 | 387.33333 | 1.26124 |
|              2 |     10535 |     1 | 324.33333 | 1.05711 |              2 |     10535 |     2 | 310.25000 | 1.00406 |
|              2 |     10955 |     1 | 356.00000 | 1.15828 |              2 |     10955 |     2 | 339.00000 | 1.07025 |
|              2 |     12089 |     1 | 212.00000 | 1.08275 |              2 |     12089 |     2 | 173.33333 | 1.07398 |
|              2 |     12633 |     1 | 402.75000 | 1.00714 |              2 |     12633 |     2 | 367.00000 | 1.12705 |
|              2 |     12765 |     1 | 308.00000 | 1.11885 |              2 |     12765 |     2 | 347.00000 | 1.15717 |
|              2 |     13077 |     1 | 277.00000 | 1.23234 |              2 |     13077 |     2 | 223.50000 | 1.13940 |
|              2 |     13687 |     1 | 361.25000 | 1.01073 |              2 |     13687 |     2 | 468.25000 | 1.00984 |
|              2 |     14025 |     1 | 371.75000 | 1.01501 |              2 |     14025 |     2 | 141.00000 | 1.25432 |
|              2 |     14117 |     1 | 298.50000 | 1.02512 |              2 |     14117 |     2 | 220.25000 | 1.41527 |
|              2 |     14347 |     1 | 366.00000 | 1.03279 |              2 |     14347 |     2 | 369.75000 | 1.01857 |
|              2 |     14697 |     1 | 397.75000 | 1.00812 |              2 |     14697 |     2 | 328.75000 | 1.16085 |
|              2 |     14987 |     1 | 146.75000 | 1.02900 |              2 |     14987 |     2 | 436.50000 | 1.04477 |
|              2 |     15321 |     1 | 527.00000 | 1.21027 |              2 |     15321 |     2 | 298.75000 | 1.13091 |
|              2 |     15347 |     1 | 243.00000 | 1.22262 |              2 |     15347 |     2 | 310.75000 | 1.20366 |
|              2 |     15533 |     1 | 223.00000 | 1.09651 |              2 |     15533 |     2 | 330.00000 | 1.49675 |
|              2 |     15839 |     1 | 353.00000 | 1.50637 |              2 |     15839 |     2 | 255.50000 | 1.23624 |
|              2 |     16107 |     1 | 376.00000 | 1.01332 |              2 |     16107 |     2 | 364.75000 | 1.06887 |
|              2 |     16749 |     1 | 200.00000 | 1.09447 |              2 |     16749 |     2 | 438.25000 | 1.03606 |
|              2 |     17329 |     1 | 321.33333 | 1.30933 |              2 |     17329 |     2 | 490.25000 | 1.07566 |
|              2 |     17417 |     1 | 321.75000 | 1.13068 |              2 |     17417 |     2 | 534.00000 | 1.00107 |
|              3 |      1049 |     1 | 252.50000 | 1.10906 |              3 |      1049 |     2 | 457.25000 | 1.02398 |
|              3 |      1415 |     1 | 247.50000 | 1.13216 |              3 |      1415 |     2 | 369.75000 | 1.09547 |
|              3 |      2199 |     1 | 185.75000 | 1.20281 |              3 |      2199 |     2 | 300.75000 | 1.07678 |
|              3 |      2403 |     1 | 270.75000 | 1.32587 |              3 |      2403 |     2 | 384.00000 | 1.09040 |
|              3 |      2541 |     1 | 364.75000 | 1.07921 |              3 |      2541 |     2 | 550.50000 | 1.05456 |
|              3 |      2727 |     1 | 303.75000 | 1.03016 |              3 |      2727 |     2 | 219.25000 | 1.38221 |
|              3 |      3207 |     1 | 383.75000 | 1.08546 |              3 |      3207 |     2 | 258.25000 | 1.21134 |
|              3 |      3373 |     1 | 404.50000 | 1.01434 |              3 |      3373 |     2 | 171.25000 | 1.28567 |
|              3 |      3969 |     1 | 234.25000 | 1.04228 |              3 |      3969 |     2 | 217.25000 | 1.42155 |
|              3 |      4407 |     1 | 438.50000 | 1.06567 |              3 |      4407 |     2 | 330.75000 | 1.02444 |
|              3 |      6051 |     1 | 289.75000 | 1.26389 |              3 |      6051 |     2 | 439.00000 | 1.10458 |
|              3 |      6521 |     1 | 381.00000 | 1.00157 |              3 |      6521 |     2 | 437.75000 | 1.03651 |
|              3 |      6691 |     1 | 377.00000 | 1.10907 |              3 |      6691 |     2 | 380.50000 | 1.05813 |
|              3 |      6757 |     1 | 282.50000 | 1.08950 |              3 |      6757 |     2 | 345.25000 | 1.22638 |
|              3 |      6915 |     1 | 420.66667 | 1.04683 |              3 |      6915 |     2 | 292.50000 | 1.25062 |
|              3 |      7207 |     1 | 329.66667 | 1.59545 |              3 |      7207 |     2 | 414.50000 | 1.01792 |
|              3 |      7889 |     1 | 318.50000 | 1.28790 |              3 |      7889 |     2 | 291.33333 | 1.00429 |
|              3 |      8559 |     1 | 356.25000 | 1.00652 |              3 |      8559 |     2 | 393.50000 | 1.01288 |
|              3 |      8829 |     1 | 364.25000 | 1.07929 |              3 |      8829 |     2 | 350.25000 | 1.11339 |
|              3 |      9555 |     1 | 377.00000 | 1.13085 |              3 |      9555 |     2 | 444.75000 | 1.01716 |
|              3 |      9623 |     1 | 331.33333 | 1.15513 |              3 |      9623 |     2 | 284.66667 | 1.03037 |
|              3 |      9813 |     1 | 343.75000 | 1.05170 |              3 |      9813 |     2 | 384.66667 | 1.08150 |
|              3 |      9881 |     1 | 351.50000 | 1.17888 |              3 |      9881 |     2 | 287.75000 | 1.09094 |
|              3 |     10035 |     1 | 378.25000 | 1.02164 |              3 |     10035 |     2 | 364.25000 | 1.15679 |
|              3 |     10509 |     1 | 420.25000 | 1.05486 |              3 |     10509 |     2 | 368.25000 | 1.18206 |
|              3 |     10547 |     1 | 182.33333 | 1.53256 |              3 |     10547 |     2 | 320.25000 | 1.30244 |
|              3 |     10743 |     1 | 233.25000 | 1.27930 |              3 |     10743 |     2 | 110.25000 | 1.10720 |
|              3 |     11477 |     1 | 264.25000 | 1.09535 |              3 |     11477 |     2 | 278.50000 | 1.03279 |
|              3 |     11959 |     1 | 358.00000 | 1.06848 |              3 |     11959 |     2 | 268.50000 | 1.00899 |
|              3 |     12043 |     1 | 169.25000 | 1.03309 |              3 |     12043 |     2 | 377.25000 | 1.01620 |
|              3 |     12157 |     1 | 326.33333 | 1.00223 |              3 |     12157 |     2 | 396.33333 | 1.02878 |
|              3 |     12433 |     1 | 199.75000 | 1.30726 |              3 |     12433 |     2 | 478.50000 | 1.01647 |
|              3 |     12867 |     1 | 278.25000 | 1.64038 |              3 |     12867 |     2 | 350.75000 | 1.20069 |
|              3 |     13499 |     1 | 281.00000 | 1.14320 |              3 |     13499 |     2 | 446.75000 | 1.03315 |
|              3 |     14589 |     1 | 266.50000 | 1.11432 |              3 |     14589 |     2 | 334.33333 | 1.14531 |
|              3 |     15207 |     1 | 300.25000 | 1.48446 |              3 |     15207 |     2 | 564.00000 | 1.00048 |
|              3 |     15395 |     1 | 258.25000 | 1.05139 |              3 |     15395 |     2 | 307.50000 | 1.13823 |
|              3 |     15973 |     1 | 477.50000 | 1.20393 |              3 |     15973 |     2 | 286.00000 | 1.28723 |
|              3 |     16233 |     1 | 260.66667 | 1.12042 |              3 |     16233 |     2 | 210.50000 | 1.17881 |
|              3 |     16267 |     1 | 456.00000 | 1.00423 |              3 |     16267 |     2 | 364.33333 | 1.48189 |
|              3 |     16605 |     1 | 394.25000 | 1.11374 |              3 |     16605 |     2 | 296.25000 | 1.28859 |
|              3 |     16949 |     1 | 155.75000 | 1.11862 |              3 |     16949 |     2 | 229.50000 | 1.02895 |
|              3 |     17319 |     1 | 364.75000 | 1.27094 |              3 |     17319 |     2 | 359.25000 | 1.15788 |
|              4 |       947 |     1 | 247.50000 | 1.69332 |              4 |       947 |     2 | 203.33333 | 1.20543 |
|              4 |      1895 |     1 | 354.75000 | 1.23973 |              4 |      1895 |     2 | 383.75000 | 1.08931 |
|              4 |      3429 |     1 | 358.50000 | 1.06656 |              4 |      3429 |     2 | 346.00000 | 1.25195 |
|              4 |      4559 |     1 | 215.00000 | 1.24323 |              4 |      4559 |     2 | 360.75000 | 1.03335 |
|              4 |      4773 |     1 | 328.25000 | 1.05098 |              4 |      4773 |     2 | 330.50000 | 1.00626 |
|              4 |      4885 |     1 | 151.00000 | 1.32056 |              4 |      4885 |     2 | 377.25000 | 1.04890 |
|              4 |      4915 |     1 | 289.25000 | 1.08639 |              4 |      4915 |     2 | 368.00000 | 1.06966 |
|              4 |      5043 |     1 | 476.00000 | 1.01560 |              4 |      5043 |     2 | 244.25000 | 1.35629 |
|              4 |      5095 |     1 | 334.00000 | 1.22589 |              4 |      5095 |     2 | 390.25000 | 1.06218 |
|              4 |      5193 |     1 | 263.33333 | 1.25017 |              4 |      5193 |     2 | 323.00000 | 1.09796 |
|              4 |      5975 |     1 | 434.00000 | 1.02336 |              4 |      5975 |     2 | 359.75000 | 1.19794 |
|              4 |      6251 |     1 | 285.00000 | 1.12154 |              4 |      6251 |     2 | 335.50000 | 1.16022 |
|              4 |      6389 |     1 | 280.75000 | 1.20492 |              4 |      6389 |     2 | 259.33333 | 1.48166 |
|              4 |      6487 |     1 | 452.75000 | 1.07106 |              4 |      6487 |     2 | 350.50000 | 1.17165 |
|              4 |      6619 |     1 | 430.00000 | 1.00073 |              4 |      6619 |     2 | 226.25000 | 1.54856 |
|              4 |      7191 |     1 | 260.75000 | 1.00127 |              4 |      7191 |     2 | 195.25000 | 1.53727 |
|              4 |      7427 |     1 | 239.50000 | 1.41836 |              4 |      7427 |     2 | 373.25000 | 1.04298 |
|              4 |      8453 |     1 | 314.75000 | 1.02597 |              4 |      8453 |     2 | 376.75000 | 1.00990 |
|              4 |      8781 |     1 | 518.50000 | 1.10055 |              4 |      8781 |     2 | 521.00000 | 1.12377 |
|              4 |      9571 |     1 | 314.00000 | 1.21686 |              4 |      9571 |     2 | 309.00000 | 1.08922 |
|              4 |      9587 |     1 | 248.00000 | 1.49819 |              4 |      9587 |     2 | 248.00000 | 1.00650 |
|              4 |     10333 |     1 | 321.00000 | 1.14861 |              4 |     10333 |     2 | 317.00000 | 1.04692 |
|              4 |     10969 |     1 | 186.66667 | 1.10442 |              4 |     10969 |     2 | 307.00000 | 1.10948 |
|              4 |     10993 |     1 | 446.00000 | 1.00924 |              4 |     10993 |     2 | 206.66667 | 1.23553 |
|              4 |     11571 |     1 | 342.50000 | 1.14263 |              4 |     11571 |     2 | 304.66667 | 1.03199 |
|              4 |     11979 |     1 | 225.33333 | 1.46707 |              4 |     11979 |     2 | 438.25000 | 1.13899 |
|              4 |     13409 |     1 | 312.33333 | 1.34275 |              4 |     13409 |     2 | 336.25000 | 1.10820 |
|              4 |     13443 |     1 | 417.75000 | 1.02178 |              4 |     13443 |     2 | 334.00000 | 1.30764 |
|              4 |     13567 |     1 | 271.50000 | 1.00876 |              4 |     13567 |     2 | 370.00000 | 1.45577 |
|              4 |     13683 |     1 | 318.75000 | 1.01498 |              4 |     13683 |     2 | 363.50000 | 1.07812 |
|              4 |     14143 |     1 | 367.00000 | 1.04418 |              4 |     14143 |     2 | 290.00000 | 1.19331 |
|              4 |     14401 |     1 | 342.75000 | 1.18366 |              4 |     14401 |     2 | 344.25000 | 1.20671 |
|              4 |     14693 |     1 | 447.25000 | 1.05167 |              4 |     14693 |     2 | 498.00000 | 1.35174 |
|              4 |     14877 |     1 | 414.33333 | 1.17077 |              4 |     14877 |     2 | 282.50000 | 1.58306 |
|              4 |     15063 |     1 | 378.25000 | 1.11282 |              4 |     15063 |     2 | 444.00000 | 1.06328 |
|              4 |     15275 |     1 | 335.50000 | 1.15364 |              4 |     15275 |     2 | 292.66667 | 1.29783 |
|              4 |     15509 |     1 | 296.33333 | 1.02467 |              4 |     15509 |     2 | 317.66667 | 1.44704 |
|              4 |     15969 |     1 | 423.00000 | 1.04729 |              4 |     15969 |     2 | 342.50000 | 1.25118 |
|              4 |     16627 |     1 | 485.50000 | 1.01515 |              4 |     16627 |     2 | 161.25000 | 1.35333 |
|              4 |     16641 |     1 | 521.50000 | 1.10507 |              4 |     16641 |     2 | 221.50000 | 1.03086 |
|              4 |     16751 |     1 | 549.50000 | 1.08221 |              4 |     16751 |     2 | 223.33333 | 1.33779 |
|              5 |        75 |     1 | 333.00000 | 1.26563 |              5 |        75 |     2 | 226.00000 | 1.03581 |
|              5 |       125 |     1 | 441.66667 | 1.09597 |              5 |       125 |     2 | 331.50000 | 1.00811 |
|              5 |       431 |     1 | 159.00000 | 1.10618 |              5 |       431 |     2 | 304.00000 | 1.12242 |
|              5 |       671 |     1 | 403.33333 | 1.00560 |              5 |       671 |     2 | 281.33333 | 1.33668 |
|              5 |       745 |     1 | 466.75000 | 1.01091 |              5 |       745 |     2 | 351.00000 | 1.11472 |
|              5 |      1701 |     1 | 374.00000 | 1.08645 |              5 |      1701 |     2 | 385.00000 | 1.33063 |
|              5 |      2521 |     1 | 360.75000 | 1.09925 |              5 |      2521 |     2 | 265.50000 | 1.17241 |
|              5 |      2855 |     1 | 406.00000 | 1.40376 |              5 |      2855 |     2 | 183.25000 | 1.06622 |
|              5 |      3137 |     1 | 271.25000 | 1.57545 |              5 |      3137 |     2 | 380.00000 | 1.08342 |
|              5 |      3279 |     1 | 299.50000 | 1.05367 |              5 |      3279 |     2 | 276.75000 | 1.44589 |
|              5 |      3467 |     1 | 294.00000 | 1.14773 |              5 |      3467 |     2 | 349.66667 | 1.16742 |
|              5 |      4463 |     1 | 338.00000 | 1.06993 |              5 |      4463 |     2 | 273.50000 | 1.23698 |
|              5 |      4719 |     1 | 340.50000 | 1.05719 |              5 |      4719 |     2 | 423.66667 | 1.02550 |
|              5 |      4739 |     1 | 281.33333 | 1.02430 |              5 |      4739 |     2 | 383.50000 | 1.03343 |
|              5 |      4839 |     1 | 310.25000 | 1.03590 |              5 |      4839 |     2 | 232.00000 | 1.29542 |
|              5 |      4979 |     1 | 359.50000 | 1.10464 |              5 |      4979 |     2 | 323.75000 | 1.17043 |
|              5 |      5401 |     1 | 219.25000 | 1.27739 |              5 |      5401 |     2 | 203.00000 | 1.09157 |
|              5 |      5635 |     1 | 370.00000 | 1.02271 |              5 |      5635 |     2 | 351.66667 | 1.37777 |
|              5 |      5797 |     1 | 403.00000 | 1.02349 |              5 |      5797 |     2 | 457.50000 | 1.00370 |
|              5 |      5901 |     1 | 360.25000 | 1.12596 |              5 |      5901 |     2 | 376.00000 | 1.00950 |
|              5 |      6129 |     1 | 419.25000 | 1.01692 |              5 |      6129 |     2 | 359.50000 | 1.04789 |
|              5 |      6213 |     1 | 351.66667 | 1.20562 |              5 |      6213 |     2 | 361.50000 | 1.11684 |
|              5 |      6479 |     1 | 301.33333 | 1.27800 |              5 |      6479 |     2 | 395.75000 | 1.17797 |
|              5 |      7333 |     1 | 227.00000 | 1.46113 |              5 |      7333 |     2 | 243.75000 | 1.17892 |
|              5 |      7923 |     1 | 358.00000 | 1.10468 |              5 |      7923 |     2 | 342.33333 | 1.16078 |
|              5 |      8737 |     1 | 217.25000 | 1.07421 |              5 |      8737 |     2 | 403.50000 | 1.04421 |
|              5 |      8945 |     1 | 344.25000 | 1.14148 |              5 |      8945 |     2 | 298.00000 | 1.00084 |
|              5 |      8993 |     1 | 399.00000 | 1.18737 |              5 |      8993 |     2 | 371.75000 | 1.13164 |
|              5 |     10667 |     1 | 288.00000 | 1.34536 |              5 |     10667 |     2 | 289.50000 | 1.09522 |
|              5 |     10771 |     1 | 394.75000 | 1.04807 |              5 |     10771 |     2 | 323.25000 | 1.23773 |
|              5 |     10949 |     1 | 383.00000 | 1.11257 |              5 |     10949 |     2 | 378.25000 | 1.12554 |
|              5 |     11107 |     1 | 446.50000 | 1.26535 |              5 |     11107 |     2 | 258.50000 | 1.55361 |
|              5 |     11795 |     1 | 395.50000 | 1.01045 |              5 |     11795 |     2 | 430.75000 | 1.13106 |
|              5 |     12017 |     1 | 347.75000 | 1.16824 |              5 |     12017 |     2 | 308.00000 | 1.15932 |
|              5 |     12027 |     1 | 456.25000 | 1.02629 |              5 |     12027 |     2 | 390.33333 | 1.11428 |
|              5 |     13583 |     1 | 430.33333 | 1.04238 |              5 |     13583 |     2 | 256.25000 | 1.54103 |
|              5 |     13651 |     1 | 272.33333 | 1.16952 |              5 |     13651 |     2 | 330.50000 | 1.19019 |
|              5 |     13783 |     1 | 419.50000 | 1.05847 |              5 |     13783 |     2 | 339.50000 | 1.06809 |
|              5 |     13859 |     1 | 318.00000 | 1.14222 |              5 |     13859 |     2 | 380.25000 | 1.05645 |
|              5 |     14537 |     1 | 206.00000 | 1.22834 |              5 |     14537 |     2 | 357.75000 | 1.03880 |
|              5 |     15309 |     1 | 276.33333 | 1.29876 |              5 |     15309 |     2 | 409.00000 | 1.01024 |
|              5 |     15883 |     1 | 385.33333 | 1.01248 |              5 |     15883 |     2 | 173.25000 | 1.35622 |
|              5 |     15935 |     1 | 293.50000 | 1.01877 |              5 |     15935 |     2 | 271.25000 | 1.40009 |
|              5 |     15949 |     1 | 241.50000 | 1.14867 |              5 |     15949 |     2 | 235.00000 | 1.40729 |
|              5 |     16037 |     1 | 327.25000 | 1.13076 |              5 |     16037 |     2 | 412.66667 | 1.18302 |
|              5 |     16291 |     1 | 380.50000 | 1.05496 |              5 |     16291 |     2 | 411.66667 | 1.03492 |
|              5 |     16459 |     1 | 370.00000 | 1.27565 |              5 |     16459 |     2 | 265.75000 | 1.29882 |
|              5 |     16901 |     1 | 305.25000 | 1.10430 |              5 |     16901 |     2 | 186.50000 | 1.02313 |
|              5 |     17199 |     1 | 376.50000 | 1.10390 |              5 |     17199 |     2 | 374.00000 | 1.08730 |
|              5 |     17387 |     1 | 298.33333 | 1.38487 |              5 |     17387 |     2 | 327.66667 | 1.36709 |
|              5 |     17717 |     1 | 283.75000 | 1.15572 |              5 |     17717 |     2 | 235.25000 | 1.14162 |
|              5 |     17927 |     1 | 217.50000 | 1.35500 |              5 |     17927 |     2 | 250.75000 | 1.07092 |
|              5 |     17943 |     1 | 209.75000 | 1.37171 |              5 |     17943 |     2 | 428.00000 | 1.10908 |
+----------------+-----------+-------+-----------+---------+----------------+-----------+-------+-----------+---------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Actual results 39b:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[1,1155,1,184.0,NaN,1,1155,2,343.3333333333333,1.1700233592269733]
[1,1569,1,212.0,1.630213519639535,1,1569,2,239.25,1.2641513267800557]
[1,5627,1,282.75,1.5657032366359889,1,5627,2,297.5,1.2084286841430678]
[1,7999,1,166.25,1.7924231710846223,1,7999,2,375.3333333333333,1.008092263550718]
[1,8611,1,300.5,1.5191545184147954,1,8611,2,243.75,1.2342122780960432]
[1,15345,1,148.5,1.5295784035794024,1,15345,2,246.5,1.5087987747231526]
[2,71,1,221.5,1.563974108334745,2,71,2,309.0,1.4917057895885681]
[2,5429,1,152.0,NaN,2,5429,2,355.25,1.1230959744909077]
[2,6103,1,194.33333333333334,1.5160670179307387,2,6103,2,158.5,1.2743698636165062]
[2,6489,1,268.0,1.6956372368432269,2,6489,2,389.0,1.4105780519299767]
[2,15839,1,353.0,1.5063684437542906,2,15839,2,255.5,1.2362393182894105]
[3,7207,1,329.6666666666667,1.5954482160720393,3,7207,2,414.5,1.017919707908937]
[3,10547,1,182.33333333333334,1.5325641514869042,3,10547,2,320.25,1.302441844373152]
[3,12867,1,278.25,1.6403800123947352,3,12867,2,350.75,1.2006933321742796]
[4,947,1,247.5,1.6933181813486973,4,947,2,203.33333333333334,1.205433145161931]
[4,10249,1,240.75,1.6058403557773568,4,10249,2,689.0,NaN]
[5,3137,1,271.25,1.575453220592864,5,3137,2,380.0,1.0834203388600319]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Expected results 39b:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+----------------+-----------+-------+-----------+---------+----------------+-----------+-------+-----------+---------+
| W_WAREHOUSE_SK | I_ITEM_SK | D_MOY |      MEAN |     COV | W_WAREHOUSE_SK | I_ITEM_SK | D_MOY |      MEAN |     COV |
+----------------+-----------+-------+-----------+---------+----------------+-----------+-------+-----------+---------+
|              1 |      1569 |     1 | 212.00000 | 1.63021 |              1 |      1569 |     2 | 239.25000 | 1.26415 |
|              1 |      5627 |     1 | 282.75000 | 1.56570 |              1 |      5627 |     2 | 297.50000 | 1.20843 |
|              1 |      7999 |     1 | 166.25000 | 1.79242 |              1 |      7999 |     2 | 375.33333 | 1.00809 |
|              1 |      8611 |     1 | 300.50000 | 1.51915 |              1 |      8611 |     2 | 243.75000 | 1.23421 |
|              1 |     15345 |     1 | 148.50000 | 1.52958 |              1 |     15345 |     2 | 246.50000 | 1.50880 |
|              2 |        71 |     1 | 221.50000 | 1.56397 |              2 |        71 |     2 | 309.00000 | 1.49171 |
|              2 |      6103 |     1 | 194.33333 | 1.51607 |              2 |      6103 |     2 | 158.50000 | 1.27437 |
|              2 |      6489 |     1 | 268.00000 | 1.69564 |              2 |      6489 |     2 | 389.00000 | 1.41058 |
|              2 |     15839 |     1 | 353.00000 | 1.50637 |              2 |     15839 |     2 | 255.50000 | 1.23624 |
|              3 |      7207 |     1 | 329.66667 | 1.59545 |              3 |      7207 |     2 | 414.50000 | 1.01792 |
|              3 |     10547 |     1 | 182.33333 | 1.53256 |              3 |     10547 |     2 | 320.25000 | 1.30244 |
|              3 |     12867 |     1 | 278.25000 | 1.64038 |              3 |     12867 |     2 | 350.75000 | 1.20069 |
|              4 |       947 |     1 | 247.50000 | 1.69332 |              4 |       947 |     2 | 203.33333 | 1.20543 |
|              5 |      3137 |     1 | 271.25000 | 1.57545 |              5 |      3137 |     2 | 380.00000 | 1.08342 |
+----------------+-----------+-------+-----------+---------+----------------+-----------+-------+-----------+---------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Queries used:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;-- start query 39 in stream 0 using template query39.tpl and seed QUALIFICATION
with inv as
(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy
       ,stdev,mean, case mean when 0 then null else stdev/mean end cov
 from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy
            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean
      from inventory
          ,item
          ,warehouse
          ,date_dim
      where inv_item_sk = i_item_sk
        and inv_warehouse_sk = w_warehouse_sk
        and inv_date_sk = d_date_sk
        and d_year =2001
      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo
 where case mean when 0 then 0 else stdev/mean end &amp;gt; 1)
select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov
        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov
from inv inv1,inv inv2
where inv1.i_item_sk = inv2.i_item_sk
  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk
  and inv1.d_moy=1
  and inv2.d_moy=1+1
order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov
        ,inv2.d_moy,inv2.mean, inv2.cov
;
-- end query 39 in stream 0 using template query39.tpl
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;39b&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;with inv as
(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy
       ,stdev,mean, case mean when 0 then null else stdev/mean end cov
 from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy
            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean
      from inventory
          ,item
          ,warehouse
          ,date_dim
      where inv_item_sk = i_item_sk
        and inv_warehouse_sk = w_warehouse_sk
        and inv_date_sk = d_date_sk
        and d_year =2001
      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo
 where case mean when 0 then 0 else stdev/mean end &amp;gt; 1)
select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov
        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov
from inv inv1,inv inv2
where inv1.i_item_sk = inv2.i_item_sk
  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk
  and inv1.d_moy=1
  and inv2.d_moy=1+1
  and inv1.cov &amp;gt; 1.5
order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov
        ,inv2.d_moy,inv2.mean, inv2.cov
;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12949978">SPARK-13860</key>
            <summary>TPCDS query 39 returns wrong results compared to TPC official result set </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="leanken">Leanken.Lin</assignee>
                                    <reporter username="jfchen@us.ibm.com">JESSE CHEN</reporter>
                        <labels>
                            <label>correctness</label>
                    </labels>
                <created>Mon, 14 Mar 2016 17:50:58 +0000</created>
                <updated>Tue, 13 Apr 2021 18:38:48 +0000</updated>
                            <resolved>Tue, 13 Oct 2020 13:23:18 +0000</resolved>
                                    <version>1.6.0</version>
                    <version>2.1.1</version>
                    <version>2.2.0</version>
                    <version>2.3.4</version>
                    <version>2.4.7</version>
                    <version>3.0.1</version>
                                    <fixVersion>3.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="15198670" author="smilegator" created="Thu, 17 Mar 2016 03:07:13 +0000"  >&lt;p&gt;All the missing rows have the same pattern. NaN. &lt;/p&gt;</comment>
                            <comment id="15200330" author="tsuresh" created="Thu, 17 Mar 2016 20:41:14 +0000"  >&lt;p&gt;I looked into this issue and found out NULL values in the input columns to stddev_samp function are  the cause of NaN in the output , which contributes to the difference in the results.   I verified using couple of ways:&lt;/p&gt;

&lt;p&gt;1) Verified by modifying the inventory tables data  to update the null value for inv_quantity_on_hand , and&lt;br/&gt;
ran the query to make sure no NaN&apos;s are returned.&lt;/p&gt;

&lt;p&gt;2) I tried simplified repro on Spark SQL , and Hive. Following is the output:&lt;/p&gt;

&lt;p&gt;--Spark SQL &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;drop table &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists foo;
create table foo (c1 &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;  , c2 &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;);
insert into foo select 1, NULL;
insert into foo select 1, 1;
insert into foo select 2, NULL;
insert into foo select 3,3;
insert into foo select 3,4;
insert into foo select 4,4;

select * from foo
1	NULL
1	1.0
2	NULL
3	3.0
3	4.0
4	4.0
Time taken: 0.168 seconds, Fetched 6 row(s)

select c1 , stddev_sampp(c2) from foo group by c1;

1	NaN
3	0.7071067811865476
4	NaN
2	NULL
Time taken: 0.983 seconds, Fetched 4 row(s)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;--Hive  Results &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;drop table &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists foo;
create table foo (c1 &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;  , c2 &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;);
insert into foo values (1, NULL);
insert into foo values(1, 1);
insert into foo values(2, NULL);
insert into foo values(3,3);
insert into foo values(3,4);
insert into foo values(4,4);
select * from foo;

hive&amp;gt; select * from foo;
OK
1	NULL
1	1.0
2	NULL
3	3.0
3	4.0
4	4.0
Time taken: 0.072 seconds, Fetched: 6 row(s)

select c1 , stddev_samp(c2) from foo group by c1;

OK
1	0.0
2	NULL
3	0.7071067811865476
4	0.0
Time taken: 16.696 seconds, Fetched: 4 row(s)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It looks like Hive is returning 0.0 if there are NULL values in the set , and Spark SQL is returning NaN.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yhuai&quot; class=&quot;user-hover&quot; rel=&quot;yhuai&quot;&gt;yhuai&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mengxr&quot; class=&quot;user-hover&quot; rel=&quot;mengxr&quot;&gt;mengxr&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Is the NaN output  spark expected  behavior  ?  I would appreciate your input.&lt;/p&gt;
</comment>
                            <comment id="15200473" author="smilegator" created="Thu, 17 Mar 2016 22:01:13 +0000"  >&lt;p&gt;Great! Excellent work! Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tsuresh&quot; class=&quot;user-hover&quot; rel=&quot;tsuresh&quot;&gt;tsuresh&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BTW, also confirmed that DB2 returns the same result like Hive. &lt;/p&gt;</comment>
                            <comment id="15200805" author="tsuresh" created="Fri, 18 Mar 2016 01:53:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yhuai&quot; class=&quot;user-hover&quot; rel=&quot;yhuai&quot;&gt;yhuai&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mengxr&quot; class=&quot;user-hover&quot; rel=&quot;mengxr&quot;&gt;mengxr&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I noticed there is discussion on the following PR to return NaN for empty set case for stddev. &lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/9705&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/9705&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Should we address the  stddev inconsistency with Hive  or   stay with  the current behavior ?&lt;/p&gt;</comment>
                            <comment id="15235649" author="jfchen@us.ibm.com" created="Mon, 11 Apr 2016 18:14:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tsuresh&quot; class=&quot;user-hover&quot; rel=&quot;tsuresh&quot;&gt;tsuresh&lt;/a&gt;  Could you inform the correct course of action here please?&lt;/p&gt;</comment>
                            <comment id="16088305" author="dongjoon" created="Fri, 14 Jul 2017 23:52:25 +0000"  >&lt;p&gt;I confirmed that the behavior of Spark 2.1.1 and 2.2.0 is still the same. How can we update this issue?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;1	NaN
3	0.7071067811865476
4	NaN
2	NULL
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17210691" author="apachespark" created="Fri, 9 Oct 2020 07:49:44 +0000"  >&lt;p&gt;User &apos;leanken&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/29983&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/29983&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17214389" author="dongjoon" created="Thu, 15 Oct 2020 03:21:37 +0000"  >&lt;p&gt;I updated the affected versions and added `correctness` label because the result is different.&lt;/p&gt;</comment>
                            <comment id="17320450" author="koert" created="Tue, 13 Apr 2021 18:33:25 +0000"  >&lt;p&gt;this is what i now see:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt; Seq(1.0, 2.0).toDF.select(stddev(col(&lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;))).show
+------------------+
|stddev_samp(value)|
+------------------+
|0.7071067811865476|
+------------------+
scala&amp;gt; Seq(1.0).toDF.select(stddev(col(&lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;))).show
+------------------+                                                            
|stddev_samp(value)|
+------------------+
|              &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;|
+------------------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;so basically now when we have division by zero we return null instead of NaN.&lt;/p&gt;

&lt;p&gt;i think for division by zero NaN is a far better answer than null? it captures exactly what the issue is.&lt;/p&gt;

&lt;p&gt;us changing correct answers to match what SQL does (which has many warts and mistakes we should not try to emulate) saddens me. spark is more than SQL...&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                            <outwardlinks description="is a clone of">
                                        <issuelink>
            <issuekey id="12949975">SPARK-13859</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12949981">SPARK-13861</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 31 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2um8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>