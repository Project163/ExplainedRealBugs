<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:48:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-53491] SS | `inputRowsPerSecond` and `processedRowsPerSecond` in progress report show values in exponential notation for large numbers</title>
                <link>https://issues.apache.org/jira/browse/SPARK-53491</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;In Structured Streaming, the progress metrics &lt;b&gt;inputRowsPerSecond&lt;/b&gt; and &lt;b&gt;processedRowsPerSecond&lt;/b&gt; are currently stored as &lt;b&gt;Double&lt;/b&gt; and passed as Double in the JSON representation. For large values, they can be reported as exponential/scientific notation (e.g., &lt;b&gt;6.923076923076923E7&lt;/b&gt;) or double values with very large scale (e.g., &lt;b&gt;638297.8723404256&lt;/b&gt;)&lt;/p&gt;

&lt;p&gt;This formatting is not user-friendly. A user can easily interpret&#160;&lt;b&gt;6.923076923076923E7 as 6.92&lt;/b&gt;&#160;instead of&#160;&lt;b&gt;69,230,769.23&lt;/b&gt;,&#160;as&#160;&lt;b&gt;E&lt;/b&gt; can be missed to be&#160;spotted.&lt;/p&gt;

&lt;p&gt;Executing this code can reproduce the issue:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
%scala

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.execution.streaming.MemoryStream

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; spark.implicits._ 
implicit val sqlContext = spark.sqlContext

val inputData = MemoryStream[Int]
val df = inputData.toDF()

val query = df.writeStream.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;memory&quot;&lt;/span&gt;).queryName(&lt;span class=&quot;code-quote&quot;&gt;&quot;TestFormatting&quot;&lt;/span&gt;).start() 

val bigBatch = (1 to 900000).toSeq
inputData.addData(bigBatch: _*)

query.processAllAvailable()

val progress = query.lastProgress 
print(progress)

query.stop()&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Progress metrics:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;9b512179-ea36-4b98-9d79-049d13813894&quot;&lt;/span&gt;,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;runId&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;f85e2894-9582-493d-9b94-ce03e5490241&quot;&lt;/span&gt;,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;TestFormatting&quot;&lt;/span&gt;,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;timestamp&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2025-09-04T10:57:02.897Z&quot;&lt;/span&gt;,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;batchId&quot;&lt;/span&gt; : 0,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;batchDuration&quot;&lt;/span&gt; : 1410,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;numInputRows&quot;&lt;/span&gt; : 900000,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;inputRowsPerSecond&quot;&lt;/span&gt; : 6.923076923076923E7,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;processedRowsPerSecond&quot;&lt;/span&gt; : 638297.8723404256,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;durationMs&quot;&lt;/span&gt; : {
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;addBatch&quot;&lt;/span&gt; : 1101,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;commitOffsets&quot;&lt;/span&gt; : 157,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;getBatch&quot;&lt;/span&gt; : 0,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;latestOffset&quot;&lt;/span&gt; : 0,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;queryPlanning&quot;&lt;/span&gt; : 3,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;triggerExecution&quot;&lt;/span&gt; : 1410,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;walCommit&quot;&lt;/span&gt; : 149
&#160; },
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;stateOperators&quot;&lt;/span&gt; : [ ],
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;sources&quot;&lt;/span&gt; : [ {
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;description&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;MemoryStream[value#133]&quot;&lt;/span&gt;,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;startOffset&quot;&lt;/span&gt; : &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;endOffset&quot;&lt;/span&gt; : 0,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;latestOffset&quot;&lt;/span&gt; : &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;numInputRows&quot;&lt;/span&gt; : 900000,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;inputRowsPerSecond&quot;&lt;/span&gt; : 6.923076923076923E7,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;processedRowsPerSecond&quot;&lt;/span&gt; : 638297.8723404256
&#160; } ],
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;sink&quot;&lt;/span&gt; : {
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;description&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;MemorySink&quot;&lt;/span&gt;,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;numOutputRows&quot;&lt;/span&gt; : 900000
&#160; }
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13628112">SPARK-53491</key>
            <summary>SS | `inputRowsPerSecond` and `processedRowsPerSecond` in progress report show values in exponential notation for large numbers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jayantjayant11">Jayant Sharma</assignee>
                                    <reporter username="jayantjayant11">Jayant Sharma</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 4 Sep 2025 12:25:15 +0000</created>
                <updated>Fri, 12 Sep 2025 04:58:31 +0000</updated>
                            <resolved>Fri, 12 Sep 2025 04:58:31 +0000</resolved>
                                    <version>3.5.0</version>
                    <version>3.5.2</version>
                    <version>4.0.0</version>
                                    <fixVersion>4.1.0</fixVersion>
                                    <component>Structured Streaming</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="18018104" author="JIRAUSER310866" created="Thu, 4 Sep 2025 12:26:02 +0000"  >&lt;p&gt;I am working on this issue and will raise a PR soon.&lt;/p&gt;</comment>
                            <comment id="18018148" author="JIRAUSER310866" created="Thu, 4 Sep 2025 15:52:13 +0000"  >&lt;p&gt;I have created a PR: &lt;a href=&quot;https://github.com/apache/spark/pull/52237&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/52237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;With this fix, the ProgressReporter output is as shows below:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;03497c93-7ab7-4e14-ba5f-dadbfc8a4bf6&quot;&lt;/span&gt;,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;runId&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;3933cdde-f99d-4a29-8bb8-d13bbb5df425&quot;&lt;/span&gt;,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;TestFormatting&quot;&lt;/span&gt;,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;timestamp&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2025-09-04T15:50:45.500Z&quot;&lt;/span&gt;,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;batchId&quot;&lt;/span&gt; : 0,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;batchDuration&quot;&lt;/span&gt; : 1444,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;numInputRows&quot;&lt;/span&gt; : 900000,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;inputRowsPerSecond&quot;&lt;/span&gt; : 69230769.2,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;processedRowsPerSecond&quot;&lt;/span&gt; : 623268.7,
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;durationMs&quot;&lt;/span&gt; : {
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;addBatch&quot;&lt;/span&gt; : 1147,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;commitOffsets&quot;&lt;/span&gt; : 152,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;getBatch&quot;&lt;/span&gt; : 0,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;latestOffset&quot;&lt;/span&gt; : 0,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;queryPlanning&quot;&lt;/span&gt; : 3,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;triggerExecution&quot;&lt;/span&gt; : 1444,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;walCommit&quot;&lt;/span&gt; : 142
&#160; },
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;stateOperators&quot;&lt;/span&gt; : [ ],
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;sources&quot;&lt;/span&gt; : [ {
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;description&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;MemoryStream[value#133]&quot;&lt;/span&gt;,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;startOffset&quot;&lt;/span&gt; : &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;endOffset&quot;&lt;/span&gt; : 0,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;latestOffset&quot;&lt;/span&gt; : &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;numInputRows&quot;&lt;/span&gt; : 900000,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;inputRowsPerSecond&quot;&lt;/span&gt; : 69230769.2,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;processedRowsPerSecond&quot;&lt;/span&gt; : 623268.7
&#160; } ],
&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;sink&quot;&lt;/span&gt; : {
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;description&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;MemorySink&quot;&lt;/span&gt;,
&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;numOutputRows&quot;&lt;/span&gt; : 900000
&#160; }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note: I have kept the core implementation of `inputRowsPerSecond` and `processedRowsPerSecond` unchanged, and they will still be available as `Double` type because Double is a standard data type and Decimal is not.&lt;/p&gt;

&lt;p&gt;Accessing using something like &lt;b&gt;query.lastProgress.inputRowsPerSecond&lt;/b&gt; or&#160;&lt;b&gt;query.lastProgress.processedRowsPerSecond&lt;/b&gt; will return double-type values in scientific notation. Downstream apps using these individual metrics (mostly through custom listeners) should be able to cast to Decimal to deal with it.&lt;/p&gt;</comment>
                            <comment id="18019764" author="kabhwan" created="Fri, 12 Sep 2025 04:58:31 +0000"  >&lt;p&gt;Issue resolved by pull request 52237&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/52237&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/52237&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1xk0o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12352874">3.4.1</customfieldvalue>
    <customfieldvalue id="12352848">3.5.0</customfieldvalue>
    <customfieldvalue id="12353980">3.5.2</customfieldvalue>
    <customfieldvalue id="12353359">4.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>