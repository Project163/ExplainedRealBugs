<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 19:28:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-38124] Revive HashClusteredDistribution and apply to stream-stream join</title>
                <link>https://issues.apache.org/jira/browse/SPARK-38124</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-35703&quot; title=&quot;Relax constraint for Spark bucket join and remove HashClusteredDistribution&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-35703&quot;&gt;&lt;del&gt;SPARK-35703&lt;/del&gt;&lt;/a&gt; removed HashClusteredDistribution and replaced its usages with ClusteredDistribution.&lt;/p&gt;

&lt;p&gt;While this works great for non stateful operators, we still need to have a separate requirement of distribution for stateful operator, because the requirement of ClusteredDistribution is too relaxed while the requirement of physical partitioning on stateful operator is quite strict.&lt;/p&gt;

&lt;p&gt;In most cases, stateful operators must require child distribution as HashClusteredDistribution, with below major assumptions:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;HashClusteredDistribution creates HashPartitioning and we will never ever change it for the future.&lt;/li&gt;
	&lt;li&gt;We will never ever change the implementation of&#160;&lt;tt&gt;partitionIdExpression&lt;/tt&gt;&#160;in HashPartitioning for the future, so that Partitioner will behave consistently across Spark versions.&lt;/li&gt;
	&lt;li&gt;No partitioning except HashPartitioning can satisfy HashClusteredDistribution.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;We should revive HashClusteredDistribution (with probably renaming specifically with stateful operator) and apply the distribution to the all stateful operators.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-35703&quot; title=&quot;Relax constraint for Spark bucket join and remove HashClusteredDistribution&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-35703&quot;&gt;&lt;del&gt;SPARK-35703&lt;/del&gt;&lt;/a&gt; only touched stream-stream join, which means stream-stream join hasn&apos;t been broken in actual releases. Let&apos;s aim the partial revert of &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-35703&quot; title=&quot;Relax constraint for Spark bucket join and remove HashClusteredDistribution&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-35703&quot;&gt;&lt;del&gt;SPARK-35703&lt;/del&gt;&lt;/a&gt; in this ticket, and have another ticket to deal with other stateful operators, which have been broken for their introduction (2.2+).&lt;/p&gt;</description>
                <environment></environment>
        <key id="13426857">SPARK-38124</key>
            <summary>Revive HashClusteredDistribution and apply to stream-stream join</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kabhwan">Jungtaek Lim</assignee>
                                    <reporter username="kabhwan">Jungtaek Lim</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Feb 2022 07:04:56 +0000</created>
                <updated>Wed, 16 Mar 2022 07:24:10 +0000</updated>
                            <resolved>Tue, 8 Feb 2022 23:32:48 +0000</resolved>
                                    <version>3.3.0</version>
                                    <fixVersion>3.3.0</fixVersion>
                                    <component>SQL</component>
                    <component>Structured Streaming</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17487956" author="apachespark" created="Mon, 7 Feb 2022 08:29:19 +0000"  >&lt;p&gt;User &apos;HeartSaVioR&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/35419&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/35419&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17489162" author="kabhwan" created="Tue, 8 Feb 2022 23:32:48 +0000"  >&lt;p&gt;Issue resolved by pull request 35419&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/35419&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/35419&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17491933" author="apachespark" created="Mon, 14 Feb 2022 10:53:35 +0000"  >&lt;p&gt;User &apos;HeartSaVioR&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/35512&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/35512&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17492505" author="apachespark" created="Tue, 15 Feb 2022 10:24:42 +0000"  >&lt;p&gt;User &apos;c21&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/35529&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/35529&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17492506" author="apachespark" created="Tue, 15 Feb 2022 10:25:02 +0000"  >&lt;p&gt;User &apos;c21&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/35529&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/35529&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 39 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0zau8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>