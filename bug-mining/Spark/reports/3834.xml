<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:46:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-16561] Potential numerical problem in MultivariateOnlineSummarizer min/max</title>
                <link>https://issues.apache.org/jira/browse/SPARK-16561</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;In `MultivariateOnlineSummarizer` min/max method, &lt;br/&gt;
use judgement &quot;nnz&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &amp;lt; weightSum&quot;, it will cause some numerial problem&lt;br/&gt;
and make result unstable.&lt;/p&gt;

&lt;p&gt;for example,&lt;br/&gt;
add two vector:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;10, -10&amp;#93;&lt;/span&gt; with weight 1e10&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;0, 0&amp;#93;&lt;/span&gt; with weight 1e-10&lt;/p&gt;

&lt;p&gt;using MultivariateOnlineSummarizer.min/max we will get&lt;br/&gt;
minVector = &lt;span class=&quot;error&quot;&gt;&amp;#91;10, -10&amp;#93;&lt;/span&gt;&lt;br/&gt;
maxVector = &lt;span class=&quot;error&quot;&gt;&amp;#91;10, -10&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;but the right result should be&lt;br/&gt;
minVector = &lt;span class=&quot;error&quot;&gt;&amp;#91;0, -10&amp;#93;&lt;/span&gt;&lt;br/&gt;
maxVector = &lt;span class=&quot;error&quot;&gt;&amp;#91;10, 0&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;The bug reason is that&lt;br/&gt;
(1e10 + 1e-10) == 1e10 (Double type)&lt;br/&gt;
because of the floating rounding.&lt;br/&gt;
and different accumulating or merging order may cause different result,&lt;br/&gt;
such as:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;10, -10&amp;#93;&lt;/span&gt; with weight 1e10&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;0, 0&amp;#93;&lt;/span&gt; with weight 1e-7&lt;br/&gt;
....&lt;br/&gt;
(100 lines data &lt;span class=&quot;error&quot;&gt;&amp;#91;0, 0&amp;#93;&lt;/span&gt; with weight 1e-7)&lt;/p&gt;

&lt;p&gt;using the input data order listed above, we will get the result:&lt;br/&gt;
minVector = &lt;span class=&quot;error&quot;&gt;&amp;#91;10, -10&amp;#93;&lt;/span&gt;&lt;br/&gt;
maxVector = &lt;span class=&quot;error&quot;&gt;&amp;#91;10, -10&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;but if the input data order is as following:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0, 0&amp;#93;&lt;/span&gt; with weight 1e-7&lt;br/&gt;
....&lt;br/&gt;
(100 lines data &lt;span class=&quot;error&quot;&gt;&amp;#91;0, 0&amp;#93;&lt;/span&gt; with weight 1e-7)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;10, -10&amp;#93;&lt;/span&gt; with weight 1e10&lt;/p&gt;

&lt;p&gt;than it the result will be:&lt;br/&gt;
minVector = &lt;span class=&quot;error&quot;&gt;&amp;#91;0, -10&amp;#93;&lt;/span&gt;&lt;br/&gt;
maxVector = &lt;span class=&quot;error&quot;&gt;&amp;#91;10, 0&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;that&apos;s because:&lt;br/&gt;
1e10 + 1e-7 + ... + 1e-7(add 100 times) == 1e10  (Double type)&lt;br/&gt;
but&lt;br/&gt;
1e-7 + ... + 1e-7(add 100 times) + 1e10 = 1.000000000000001E10 != 1e10  (Double type)&lt;/p&gt;


</description>
                <environment></environment>
        <key id="12989660">SPARK-16561</key>
            <summary>Potential numerical problem in MultivariateOnlineSummarizer min/max</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="weichenxu123">Weichen Xu</assignee>
                                    <reporter username="weichenxu123">Weichen Xu</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Jul 2016 04:27:11 +0000</created>
                <updated>Fri, 18 Nov 2016 22:23:25 +0000</updated>
                            <resolved>Sat, 23 Jul 2016 11:32:48 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>MLlib</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>
                            <timeestimate seconds="86400">24h</timeestimate>
                                        <comments>
                            <comment id="15378836" author="apachespark" created="Fri, 15 Jul 2016 04:32:03 +0000"  >&lt;p&gt;User &apos;WeichenXu123&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14216&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14216&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15390663" author="srowen" created="Sat, 23 Jul 2016 11:32:49 +0000"  >&lt;p&gt;Issue resolved by pull request 14216&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/14216&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/14216&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 17 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i310en:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>