<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:24:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-6066] Metadata in event log makes it very difficult for external libraries to parse event log</title>
                <link>https://issues.apache.org/jira/browse/SPARK-6066</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;The fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-2261&quot; title=&quot;Spark application event logs are not very NameNode-friendly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-2261&quot;&gt;&lt;del&gt;SPARK-2261&lt;/del&gt;&lt;/a&gt; added a line at the beginning of the event log that encodes metadata.  This line makes it much more difficult to parse the event logs from external libraries (like &lt;a href=&quot;https://github.com/kayousterhout/trace-analysis&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/kayousterhout/trace-analysis&lt;/a&gt;, which is used by folks at Berkeley) because:&lt;/p&gt;

&lt;p&gt;(1) The metadata is not written as JSON, unlike the rest of the file&lt;br/&gt;
(2) More annoyingly, if the file is compressed, the metadata is not compressed.  This has a few side-effects: first, someone can&apos;t just use the command line to uncompress the file and then look at the logs, because the file is in this weird half-compressed format; and second, now external tools that parse these logs also need to deal with this weird format.&lt;/p&gt;

&lt;p&gt;We should fix this before the 1.3 release, because otherwise we&apos;ll have to add a bunch more backward-compatibility code to handle this weird format!&lt;/p&gt;</description>
                <environment></environment>
        <key id="12778304">SPARK-6066</key>
            <summary>Metadata in event log makes it very difficult for external libraries to parse event log</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="andrewor14">Andrew Or</assignee>
                                    <reporter username="kayousterhout">Kay Ousterhout</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Feb 2015 20:10:34 +0000</created>
                <updated>Tue, 3 Mar 2015 00:34:59 +0000</updated>
                            <resolved>Tue, 3 Mar 2015 00:34:59 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>Spark Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14340882" author="pwendell" created="Fri, 27 Feb 2015 21:55:01 +0000"  >&lt;p&gt;What if as a simple fix we do these things:&lt;/p&gt;

&lt;p&gt;1. Put the compression information in the filename. For instance, can we just use an extension indicating the compression format? That&apos;s a very common convention.&lt;br/&gt;
2. Have the meta-data header use the same compression options as the rest of the file.&lt;br/&gt;
3. Have the meta-data header use a single-line JSON dictionary instead of having a second type of format that is not JSON.&lt;/p&gt;

&lt;p&gt;I think this would solve the main inter-op problem with other people trying to read these logs. I do think we should try, within reason, to make these easy for third parties to process without a lot of extra effort. It&apos;s a big win because it allows researchers, etc to run fairly fine grained analysis of Spark&apos;s behavior.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vanzin&quot; class=&quot;user-hover&quot; rel=&quot;vanzin&quot;&gt;vanzin&lt;/a&gt; any thoughts here?&lt;/p&gt;</comment>
                            <comment id="14340904" author="vanzin" created="Fri, 27 Feb 2015 22:03:00 +0000"  >&lt;p&gt;I think the correct option if third parties want to read these files is to add a library that allows them to do so. For example, you don&apos;t try to read a Snappy file with FileInputStream directly, you use Snappy&apos;s library for that, since it handles the header that contains information about how to uncompress the data and the actual decompression.&lt;/p&gt;

&lt;p&gt;That is similar to this case. There&apos;s a header with the metadata about the file contents, just like before there were a bunch of files in a directory that served as that metadata. The only sub-optimal part is that we don&apos;t have a public library to read it.&lt;/p&gt;

&lt;p&gt;The extension can help a little bit; it would still require the user to understand the extension-to-codec mapping, and then the contents of the header and what they mean.&lt;/p&gt;</comment>
                            <comment id="14340944" author="vanzin" created="Fri, 27 Feb 2015 22:28:46 +0000"  >&lt;p&gt;BTW, quick command line-fu for the interested:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;more +/&lt;span class=&quot;code-quote&quot;&gt;&quot;=== LOG_HEADER_END ===&quot;&lt;/span&gt; logfile | tail -n +1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14340953" author="kayousterhout" created="Fri, 27 Feb 2015 22:38:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vanzin&quot; class=&quot;user-hover&quot; rel=&quot;vanzin&quot;&gt;vanzin&lt;/a&gt; what&apos;s wrong with the solution Patrick proposed? I think that makes it easy for external users to parse these files, without really any cost.&lt;/p&gt;</comment>
                            <comment id="14340958" author="vanzin" created="Fri, 27 Feb 2015 22:42:57 +0000"  >&lt;p&gt;Nothing wrong, I just don&apos;t see how it&apos;s much better. The user trying to read it externally still needs to know that if there is a certain extension he needs to use a particular compression codec. And he still needs to understand that the first line, even though it&apos;s JSON, is not actually an event, but a header, and needs to understand the contents of that header. (Right now I don&apos;t think there&apos;s anything particularly interesting there, but at some point there might - e.g. the Spark version might become important to help understand the rest of the file.)&lt;/p&gt;

&lt;p&gt;A library would make all that transparent to this user. Basically something like &quot;java.util.zip.ZipFile&quot;, where instead of bytes you have a collection of &quot;ZipEntries&quot; (here you&apos;d have a collection of &quot;SparkListenerEvent&quot;).&lt;/p&gt;

&lt;p&gt;No strong opinion one way or another, I just thing the library is nicer for the end user and more flexible in the long run.&lt;/p&gt;</comment>
                            <comment id="14341003" author="vanzin" created="Fri, 27 Feb 2015 23:15:15 +0000"  >&lt;p&gt;BTW said library could also contain logic to handle old, directory-based event logs, so even less things for the users to care about.&lt;/p&gt;</comment>
                            <comment id="14341015" author="pwendell" created="Fri, 27 Feb 2015 23:24:36 +0000"  >&lt;p&gt;Hey Marcelo,&lt;/p&gt;

&lt;p&gt;I agree having a public library for reading these logs would be nice, especially if we decide to do fancier things with the way the logs are encoded in the future.&lt;/p&gt;

&lt;p&gt;As it stands today though, it is nice that logs can be read by third party applications, even those that are not JVM based (Kay&apos;s app is actually written in Python), because we are using a very standard serialization format (JSON) and a very widely supported compression library (GZIP, IIRC?). I think we&apos;ll get benefit from this as long as we can support such widely used formats. This is especially important since Spark does not expose a library for importing these things today.&lt;/p&gt;

&lt;p&gt;So making a minor change that allows these logs to be read by many third party systems, that seems worth it to me.&lt;/p&gt;
</comment>
                            <comment id="14341016" author="vanzin" created="Fri, 27 Feb 2015 23:27:09 +0000"  >&lt;p&gt;We only use codecs supported by Spark: snappy, lzo, lzf. Can raw python read those?&lt;/p&gt;

&lt;p&gt;Changing the header to be a single-line JSON thing is probably a very small change. &lt;/p&gt;</comment>
                            <comment id="14341026" author="apachespark" created="Fri, 27 Feb 2015 23:39:14 +0000"  >&lt;p&gt;User &apos;andrewor14&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/4821&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/4821&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14341881" author="pwendell" created="Sun, 1 Mar 2015 01:41:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vanzin&quot; class=&quot;user-hover&quot; rel=&quot;vanzin&quot;&gt;vanzin&lt;/a&gt; - yes you are right (an early scratch version of the feature used a Gzip stream, I think). There are python bindings for all three of those compression codecs. To be fair, I&apos;m not 100% sure the codecs are standardized enough to be compatible across different implementations. Gzip is pretty good in this regard, but not sure about those other three.&lt;/p&gt;</comment>
                            <comment id="14344149" author="pwendell" created="Tue, 3 Mar 2015 00:34:59 +0000"  >&lt;p&gt;Thanks Andrew and Marcelo for your work on this patch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 38 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i265zr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327642">1.3.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>