<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 18:31:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SPARK-10392] Pyspark - Wrong DateType support on JDBC connection</title>
                <link>https://issues.apache.org/jira/browse/SPARK-10392</link>
                <project id="12315420" key="SPARK">Spark</project>
                    <description>&lt;p&gt;I have following problem.&lt;br/&gt;
I created table.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE TABLE `spark_test` (
	`id` INT(11) NULL,
	`date` DATE NULL
)
COLLATE=&lt;span class=&quot;code-quote&quot;&gt;&apos;utf8_general_ci&apos;&lt;/span&gt;
ENGINE=InnoDB
;
INSERT INTO `spark_test` (`id`, `date`) VALUES (1, &lt;span class=&quot;code-quote&quot;&gt;&apos;1970-01-01&apos;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then I&apos;m trying to read data - date &apos;1970-01-01&apos; is converted to int. This makes data frame incompatible with its own schema.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;df = sqlCtx.read.jdbc(&lt;span class=&quot;code-quote&quot;&gt;&quot;jdbc:mysql:&lt;span class=&quot;code-comment&quot;&gt;//host/sandbox?user=user&amp;amp;password=password&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;spark_test&apos;&lt;/span&gt;)
&lt;/span&gt;print(df.collect())
df = sqlCtx.createDataFrame(df.rdd, df.schema)

[Row(id=1, date=0)]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
&amp;lt;ipython-input-36-ebc1d94e0d8c&amp;gt; in &amp;lt;module&amp;gt;()
      1 df = sqlCtx.read.jdbc(&lt;span class=&quot;code-quote&quot;&gt;&quot;jdbc:mysql:&lt;span class=&quot;code-comment&quot;&gt;//host/sandbox?user=user&amp;amp;password=password&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;spark_test&apos;&lt;/span&gt;)
&lt;/span&gt;      2 print(df.collect())
----&amp;gt; 3 df = sqlCtx.createDataFrame(df.rdd, df.schema)

/mnt/spark/spark/python/pyspark/sql/context.py in createDataFrame(self, data, schema, samplingRatio)
    402 
    403         &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; isinstance(data, RDD):
--&amp;gt; 404             rdd, schema = self._createFromRDD(data, schema, samplingRatio)
    405         &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;:
    406             rdd, schema = self._createFromLocal(data, schema)

/mnt/spark/spark/python/pyspark/sql/context.py in _createFromRDD(self, rdd, schema, samplingRatio)
    296             rows = rdd.take(10)
    297             &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; row in rows:
--&amp;gt; 298                 _verify_type(row, schema)
    299 
    300         &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;:

/mnt/spark/spark/python/pyspark/sql/types.py in _verify_type(obj, dataType)
   1152                              &lt;span class=&quot;code-quote&quot;&gt;&quot;length of fields (%d)&quot;&lt;/span&gt; % (len(obj), len(dataType.fields)))
   1153         &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; v, f in zip(obj, dataType.fields):
-&amp;gt; 1154             _verify_type(v, f.dataType)
   1155 
   1156 

/mnt/spark/spark/python/pyspark/sql/types.py in _verify_type(obj, dataType)
   1136         # subclass of them can not be fromInternald in JVM
   1137         &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; type(obj) not in _acceptable_types[_type]:
-&amp;gt; 1138             raise TypeError(&lt;span class=&quot;code-quote&quot;&gt;&quot;%s can not accept object in type %s&quot;&lt;/span&gt; % (dataType, type(obj)))
   1139 
   1140     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; isinstance(dataType, ArrayType):

TypeError: DateType can not accept object in type &amp;lt;class &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&apos;&lt;/span&gt;&amp;gt;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12860941">SPARK-10392</key>
            <summary>Pyspark - Wrong DateType support on JDBC connection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="0x0fff">Alexey Grishchenko</assignee>
                                    <reporter username="maver1ck">Maciej Bry&#324;ski</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Sep 2015 08:55:34 +0000</created>
                <updated>Mon, 7 Sep 2015 18:41:14 +0000</updated>
                            <resolved>Tue, 1 Sep 2015 21:58:57 +0000</resolved>
                                    <version>1.4.1</version>
                                    <fixVersion>1.5.1</fixVersion>
                    <fixVersion>1.6.0</fixVersion>
                                    <component>PySpark</component>
                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14725390" author="0x0fff" created="Tue, 1 Sep 2015 13:31:10 +0000"  >&lt;p&gt;This is a corner case for DateType.fromInternal implementation:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt;&amp;gt;&amp;gt; from pyspark.sql.types &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; *
&amp;gt;&amp;gt;&amp;gt; a = DateType()
&amp;gt;&amp;gt;&amp;gt; a.fromInternal(0)
0
&amp;gt;&amp;gt;&amp;gt; a.fromInternal(1)
datetime.date(1970, 1, 2)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14725403" author="apachespark" created="Tue, 1 Sep 2015 13:38:03 +0000"  >&lt;p&gt;User &apos;0x0FFF&apos; has created a pull request for this issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/8556&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/8556&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14726282" author="davies" created="Tue, 1 Sep 2015 21:58:57 +0000"  >&lt;p&gt;Issue resolved by pull request 8556&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/spark/pull/8556&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/pull/8556&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 11 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jn1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>