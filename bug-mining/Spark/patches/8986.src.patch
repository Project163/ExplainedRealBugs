diff --git a/sql/hive/src/main/scala/org/apache/spark/sql/hive/hiveUDFs.scala b/sql/hive/src/main/scala/org/apache/spark/sql/hive/hiveUDFs.scala
index b07a1b717e7..0f689ea975d 100644
--- a/sql/hive/src/main/scala/org/apache/spark/sql/hive/hiveUDFs.scala
+++ b/sql/hive/src/main/scala/org/apache/spark/sql/hive/hiveUDFs.scala
@@ -52,6 +52,9 @@ private[hive] case class HiveSimpleUDF(
   override lazy val deterministic: Boolean =
     evaluator.isUDFDeterministic && children.forall(_.deterministic)
 
+  // It's stateful because `evaluator.inputs` is stateful.
+  override def stateful: Boolean = true
+
   override def nullable: Boolean = true
 
   override def foldable: Boolean = evaluator.isUDFDeterministic && children.forall(_.foldable)
@@ -115,6 +118,9 @@ private[hive] case class HiveGenericUDF(
   with HiveInspectors
   with UserDefinedExpression {
 
+  // It's stateful because `evaluator.deferredObjects` is stateful.
+  override def stateful: Boolean = true
+
   override def nullable: Boolean = true
 
   override lazy val deterministic: Boolean =
