diff --git a/R/pkg/inst/tests/test_sparkSQL.R b/R/pkg/inst/tests/test_sparkSQL.R
index 8ff06276599..87ab33f6384 100644
--- a/R/pkg/inst/tests/test_sparkSQL.R
+++ b/R/pkg/inst/tests/test_sparkSQL.R
@@ -229,7 +229,7 @@ test_that("create DataFrame from list or data.frame", {
   df <- createDataFrame(sqlContext, l, c("a", "b"))
   expect_equal(columns(df), c("a", "b"))
 
-  l <- list(list(a=1, b=2), list(a=3, b=4))
+  l <- list(list(a = 1, b = 2), list(a = 3, b = 4))
   df <- createDataFrame(sqlContext, l)
   expect_equal(columns(df), c("a", "b"))
 
@@ -292,11 +292,15 @@ test_that("create DataFrame with complex types", {
 })
 
 test_that("create DataFrame from a data.frame with complex types", {
-  ldf <- data.frame(row.names=1:2)
+  ldf <- data.frame(row.names = 1:2)
   ldf$a_list <- list(list(1, 2), list(3, 4))
+  ldf$an_envir <- c(as.environment(list(a = 1, b = 2)), as.environment(list(c = 3)))
+
   sdf <- createDataFrame(sqlContext, ldf)
+  collected <- collect(sdf)
 
-  expect_equivalent(ldf, collect(sdf))
+  expect_identical(ldf[, 1, FALSE], collected[, 1, FALSE])
+  expect_equal(ldf$an_envir, collected$an_envir)
 })
 
 # For test map type and struct type in DataFrame
