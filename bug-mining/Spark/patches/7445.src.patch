diff --git a/sql/core/src/test/scala/org/apache/spark/sql/execution/adaptive/AdaptiveQueryExecSuite.scala b/sql/core/src/test/scala/org/apache/spark/sql/execution/adaptive/AdaptiveQueryExecSuite.scala
index 628bafaef2c..7e7248c312e 100644
--- a/sql/core/src/test/scala/org/apache/spark/sql/execution/adaptive/AdaptiveQueryExecSuite.scala
+++ b/sql/core/src/test/scala/org/apache/spark/sql/execution/adaptive/AdaptiveQueryExecSuite.scala
@@ -1226,16 +1226,16 @@ class AdaptiveQueryExecSuite
   }
 
   test("SPARK-32753: Only copy tags to node with no tags") {
-    withSQLConf(
-      SQLConf.ADAPTIVE_EXECUTION_ENABLED.key -> "true"
-    ) {
-      spark.range(10).union(spark.range(10)).createOrReplaceTempView("v1")
+    withSQLConf(SQLConf.ADAPTIVE_EXECUTION_ENABLED.key -> "true") {
+      withTempView("v1") {
+        spark.range(10).union(spark.range(10)).createOrReplaceTempView("v1")
 
-      val (_, adaptivePlan) = runAdaptiveAndVerifyResult(
-        "SELECT id FROM v1 GROUP BY id DISTRIBUTE BY id")
-      assert(collect(adaptivePlan) {
-        case s: ShuffleExchangeExec => s
-      }.length == 1)
+        val (_, adaptivePlan) = runAdaptiveAndVerifyResult(
+          "SELECT id FROM v1 GROUP BY id DISTRIBUTE BY id")
+        assert(collect(adaptivePlan) {
+          case s: ShuffleExchangeExec => s
+        }.length == 1)
+      }
     }
   }
 }
