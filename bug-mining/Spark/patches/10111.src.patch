diff --git a/sql/connect/common/src/main/scala/org/apache/spark/sql/connect/SparkSession.scala b/sql/connect/common/src/main/scala/org/apache/spark/sql/connect/SparkSession.scala
index 52c8da9ecd1..cf7b6a1ddd6 100644
--- a/sql/connect/common/src/main/scala/org/apache/spark/sql/connect/SparkSession.scala
+++ b/sql/connect/common/src/main/scala/org/apache/spark/sql/connect/SparkSession.scala
@@ -757,13 +757,14 @@ object SparkSession extends SparkSessionCompanion with Logging {
         }
       }
 
+    lazy val serverId = UUID.randomUUID().toString
+
     server.synchronized {
       if (server.isEmpty &&
         (remoteString.exists(_.startsWith("local")) ||
           (remoteString.isDefined && isAPIModeConnect)) &&
         maybeConnectStartScript.exists(Files.exists(_))) {
         val token = java.util.UUID.randomUUID().toString()
-        val serverId = UUID.randomUUID().toString
         server = Some {
           val args =
             Seq(
@@ -813,8 +814,9 @@ object SparkSession extends SparkSessionCompanion with Logging {
         Runtime.getRuntime.addShutdownHook(new Thread() {
           override def run(): Unit = server.synchronized {
             if (server.isDefined) {
-              new ProcessBuilder(maybeConnectStopScript.get.toString)
-                .start()
+              val builder = new ProcessBuilder(maybeConnectStopScript.get.toString)
+              builder.environment().put("SPARK_IDENT_STRING", serverId)
+              builder.start()
             }
           }
         })
