diff --git a/python/pyspark/pandas/sql_processor.py b/python/pyspark/pandas/sql_processor.py
index 1bd1cb9823c..b047417b763 100644
--- a/python/pyspark/pandas/sql_processor.py
+++ b/python/pyspark/pandas/sql_processor.py
@@ -206,9 +206,7 @@ def _get_local_scope() -> Dict[str, Any]:
     # Get 2 scopes above (_get_local_scope -> sql -> ...) to capture the vars there.
     try:
         return inspect.stack()[_CAPTURE_SCOPES][0].f_locals
-    except Exception:
-        # TODO (rxin, thunterdb): use a narrower scope exception.
-        # See https://github.com/databricks/koalas/pull/448
+    except IndexError:
         return {}
 
 
@@ -222,9 +220,7 @@ def _get_ipython_scope() -> Dict[str, Any]:
 
         shell = get_ipython()
         return shell.user_ns
-    except Exception:
-        # TODO (rxin, thunterdb): use a narrower scope exception.
-        # See https://github.com/databricks/koalas/pull/448
+    except (AttributeError, ModuleNotFoundError):
         return None
 
 
