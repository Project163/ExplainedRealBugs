diff --git a/sql/catalyst/src/main/antlr3/org/apache/spark/sql/catalyst/parser/SparkSqlParser.g b/sql/catalyst/src/main/antlr3/org/apache/spark/sql/catalyst/parser/SparkSqlParser.g
index 9935678ca2c..9f2a5eb35cb 100644
--- a/sql/catalyst/src/main/antlr3/org/apache/spark/sql/catalyst/parser/SparkSqlParser.g
+++ b/sql/catalyst/src/main/antlr3/org/apache/spark/sql/catalyst/parser/SparkSqlParser.g
@@ -722,6 +722,18 @@ statement
     | (KW_SET)=> KW_SET -> ^(TOK_SETCONFIG)
 	;
 
+// Rule for expression parsing
+singleNamedExpression
+    :
+    namedExpression EOF
+    ;
+
+// Rule for table name parsing
+singleTableName
+    :
+    tableName EOF
+    ;
+
 explainStatement
 @init { pushMsg("explain statement", state); }
 @after { popMsg(state); }
diff --git a/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/parser/ParseDriver.scala b/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/parser/ParseDriver.scala
index f8e4f214511..9ff41f5bece 100644
--- a/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/parser/ParseDriver.scala
+++ b/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/parser/ParseDriver.scala
@@ -35,12 +35,12 @@ object ParseDriver extends Logging {
 
   /** Create an Expression ASTNode from a SQL command. */
   def parseExpression(command: String, conf: ParserConf): ASTNode = parse(command, conf) { parser =>
-    parser.namedExpression().getTree
+    parser.singleNamedExpression().getTree
   }
 
   /** Create an TableIdentifier ASTNode from a SQL command. */
   def parseTableName(command: String, conf: ParserConf): ASTNode = parse(command, conf) { parser =>
-    parser.tableName().getTree
+    parser.singleTableName().getTree
   }
 
   private def parse(
diff --git a/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/CatalystQlSuite.scala b/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/CatalystQlSuite.scala
index 6d25de98ceb..682b77dc65a 100644
--- a/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/CatalystQlSuite.scala
+++ b/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/CatalystQlSuite.scala
@@ -134,14 +134,15 @@ class CatalystQlSuite extends PlanTest {
           Literal("o") ::
           UnresolvedFunction("o", UnresolvedAttribute("bar") :: Nil, false) ::
           Nil, false)))
+
+    intercept[AnalysisException](parser.parseExpression("1 - f('o', o(bar)) hello * world"))
   }
 
   test("table identifier") {
     assert(TableIdentifier("q") === parser.parseTableIdentifier("q"))
     assert(TableIdentifier("q", Some("d")) === parser.parseTableIdentifier("d.q"))
     intercept[AnalysisException](parser.parseTableIdentifier(""))
-    // TODO parser swallows third identifier.
-    // intercept[AnalysisException](parser.parseTableIdentifier("d.q.g"))
+    intercept[AnalysisException](parser.parseTableIdentifier("d.q.g"))
   }
 
   test("parse union/except/intersect") {
