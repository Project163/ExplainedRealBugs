diff --git a/core/src/main/scala/org/apache/spark/deploy/history/HistoryServerDiskManager.scala b/core/src/main/scala/org/apache/spark/deploy/history/HistoryServerDiskManager.scala
index a542d2b8cb2..31f9d185174 100644
--- a/core/src/main/scala/org/apache/spark/deploy/history/HistoryServerDiskManager.scala
+++ b/core/src/main/scala/org/apache/spark/deploy/history/HistoryServerDiskManager.scala
@@ -250,7 +250,7 @@ private class HistoryServerDiskManager(
     }
   }
 
-  private def appStorePath(appId: String, attemptId: Option[String]): File = {
+  private[history] def appStorePath(appId: String, attemptId: Option[String]): File = {
     val fileName = appId + attemptId.map("_" + _).getOrElse("") + ".ldb"
     new File(appStoreDir, fileName)
   }
diff --git a/core/src/test/scala/org/apache/spark/deploy/history/HistoryServerDiskManagerSuite.scala b/core/src/test/scala/org/apache/spark/deploy/history/HistoryServerDiskManagerSuite.scala
index b17880a7336..9004e863236 100644
--- a/core/src/test/scala/org/apache/spark/deploy/history/HistoryServerDiskManagerSuite.scala
+++ b/core/src/test/scala/org/apache/spark/deploy/history/HistoryServerDiskManagerSuite.scala
@@ -162,6 +162,8 @@ class HistoryServerDiskManagerSuite extends SparkFunSuite with BeforeAndAfter {
     val manager = mockManager()
     val leaseA = manager.lease(2)
     doReturn(3L).when(manager).sizeOf(meq(leaseA.tmpPath))
+    val dstPathA = manager.appStorePath("app1", None)
+    doReturn(3L).when(manager).sizeOf(meq(dstPathA))
     val dstA = leaseA.commit("app1", None)
     assert(manager.free() === 0)
     assert(manager.committed() === 3)
@@ -182,6 +184,8 @@ class HistoryServerDiskManagerSuite extends SparkFunSuite with BeforeAndAfter {
     val leaseB = manager1.lease(2)
     assert(manager1.free() === 1)
     doReturn(2L).when(manager1).sizeOf(meq(leaseB.tmpPath))
+    val dstPathB = manager.appStorePath("app2", None)
+    doReturn(2L).when(manager1).sizeOf(meq(dstPathB))
     val dstB = leaseB.commit("app2", None)
     assert(manager1.committed() === 2)
     // Listing store tracks dstB only, dstA is evicted by "makeRoom()".
@@ -197,6 +201,8 @@ class HistoryServerDiskManagerSuite extends SparkFunSuite with BeforeAndAfter {
     assert(manager2.free() === 0)
     val leaseC = manager2.lease(2)
     doReturn(2L).when(manager2).sizeOf(meq(leaseC.tmpPath))
+    val dstPathC = manager.appStorePath("app3", None)
+    doReturn(2L).when(manager2).sizeOf(meq(dstPathC))
     val dstC = leaseC.commit("app3", None)
     assert(manager2.free() === 1)
     assert(manager2.committed() === 2)
