diff --git a/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/optimizer/DecorrelateInnerQuery.scala b/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/optimizer/DecorrelateInnerQuery.scala
index 01029fe1af0..86fa78e96a5 100644
--- a/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/optimizer/DecorrelateInnerQuery.scala
+++ b/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/optimizer/DecorrelateInnerQuery.scala
@@ -249,6 +249,10 @@ object DecorrelateInnerQuery extends PredicateHelper {
       // or a cast expression after the optimization.
       case EqualNullSafe(left: Attribute, right: Expression) if domainAttrSet.contains(left) =>
         left -> right
+      // IsNull(x) results from a constant folding, so we restore the original predicate as
+      // x <=> Null.
+      case IsNull(child: Attribute) if domainAttrSet.contains(child) =>
+        child -> Literal.create(null, child.dataType)
     }.toMap
   }
 
diff --git a/sql/core/src/test/resources/sql-tests/analyzer-results/subquery/scalar-subquery/scalar-subquery-select.sql.out b/sql/core/src/test/resources/sql-tests/analyzer-results/subquery/scalar-subquery/scalar-subquery-select.sql.out
index 70ea28efb25..3679b98e2a4 100644
--- a/sql/core/src/test/resources/sql-tests/analyzer-results/subquery/scalar-subquery/scalar-subquery-select.sql.out
+++ b/sql/core/src/test/resources/sql-tests/analyzer-results/subquery/scalar-subquery/scalar-subquery-select.sql.out
@@ -1005,3 +1005,35 @@ Project [scalar-subquery#x [] AS scalarsubquery()#x]
    +- View (`t2`, [c1#x,c2#x])
       +- Project [cast(col1#x as int) AS c1#x, cast(col2#x as int) AS c2#x]
          +- LocalRelation [col1#x, col2#x]
+
+
+-- !query
+set spark.sql.optimizer.optimizeOneRowRelationSubquery.alwaysInline=false
+-- !query analysis
+SetCommand (spark.sql.optimizer.optimizeOneRowRelationSubquery.alwaysInline,Some(false))
+
+
+-- !query
+WITH T AS (SELECT 1 AS a)
+SELECT (SELECT sum(1) FROM T WHERE a = col OR upper(col)= 'Y')
+FROM (SELECT null as col) as foo
+-- !query analysis
+WithCTE
+:- CTERelationDef xxxx, false
+:  +- SubqueryAlias T
+:     +- Project [1 AS a#x]
+:        +- OneRowRelation
++- Project [scalar-subquery#x [col#x && col#x] AS scalarsubquery(col, col)#xL]
+   :  +- Aggregate [sum(1) AS sum(1)#xL]
+   :     +- Filter ((a#x = cast(outer(col#x) as int)) OR (upper(cast(outer(col#x) as string)) = Y))
+   :        +- SubqueryAlias T
+   :           +- CTERelationRef xxxx, true, [a#x]
+   +- SubqueryAlias foo
+      +- Project [null AS col#x]
+         +- OneRowRelation
+
+
+-- !query
+set spark.sql.optimizer.optimizeOneRowRelationSubquery.alwaysInline=true
+-- !query analysis
+SetCommand (spark.sql.optimizer.optimizeOneRowRelationSubquery.alwaysInline,Some(true))
diff --git a/sql/core/src/test/resources/sql-tests/inputs/subquery/scalar-subquery/scalar-subquery-select.sql b/sql/core/src/test/resources/sql-tests/inputs/subquery/scalar-subquery/scalar-subquery-select.sql
index a78189e4fca..e487b3d1800 100644
--- a/sql/core/src/test/resources/sql-tests/inputs/subquery/scalar-subquery/scalar-subquery-select.sql
+++ b/sql/core/src/test/resources/sql-tests/inputs/subquery/scalar-subquery/scalar-subquery-select.sql
@@ -240,3 +240,10 @@ SELECT c, (
 SELECT *, (SELECT count(1) is null FROM t2 WHERE t1.c1 = t2.c1) FROM t1;
 
 select (select f from (select false as f, max(c2) from t1 where t1.c1 = t1.c1)) from t2;
+
+-- SPARK-43596: handle IsNull when rewriting the domain join
+set spark.sql.optimizer.optimizeOneRowRelationSubquery.alwaysInline=false;
+WITH T AS (SELECT 1 AS a)
+SELECT (SELECT sum(1) FROM T WHERE a = col OR upper(col)= 'Y')
+FROM (SELECT null as col) as foo;
+set spark.sql.optimizer.optimizeOneRowRelationSubquery.alwaysInline=true;
diff --git a/sql/core/src/test/resources/sql-tests/results/subquery/scalar-subquery/scalar-subquery-select.sql.out b/sql/core/src/test/resources/sql-tests/results/subquery/scalar-subquery/scalar-subquery-select.sql.out
index 05fc7a320a5..e94ceea5f87 100644
--- a/sql/core/src/test/resources/sql-tests/results/subquery/scalar-subquery/scalar-subquery-select.sql.out
+++ b/sql/core/src/test/resources/sql-tests/results/subquery/scalar-subquery/scalar-subquery-select.sql.out
@@ -559,3 +559,29 @@ struct<scalarsubquery():boolean>
 -- !query output
 false
 false
+
+
+-- !query
+set spark.sql.optimizer.optimizeOneRowRelationSubquery.alwaysInline=false
+-- !query schema
+struct<key:string,value:string>
+-- !query output
+spark.sql.optimizer.optimizeOneRowRelationSubquery.alwaysInline	false
+
+
+-- !query
+WITH T AS (SELECT 1 AS a)
+SELECT (SELECT sum(1) FROM T WHERE a = col OR upper(col)= 'Y')
+FROM (SELECT null as col) as foo
+-- !query schema
+struct<scalarsubquery(col, col):bigint>
+-- !query output
+NULL
+
+
+-- !query
+set spark.sql.optimizer.optimizeOneRowRelationSubquery.alwaysInline=true
+-- !query schema
+struct<key:string,value:string>
+-- !query output
+spark.sql.optimizer.optimizeOneRowRelationSubquery.alwaysInline	true
