diff --git a/sql/core/src/test/scala/org/apache/spark/sql/SQLQuerySuite.scala b/sql/core/src/test/scala/org/apache/spark/sql/SQLQuerySuite.scala
index f405989520e..70f891b84f0 100644
--- a/sql/core/src/test/scala/org/apache/spark/sql/SQLQuerySuite.scala
+++ b/sql/core/src/test/scala/org/apache/spark/sql/SQLQuerySuite.scala
@@ -4964,6 +4964,9 @@ class SQLQuerySuite extends QueryTest with SharedSparkSession with AdaptiveSpark
   }
 
   test("SPARK-52686: Union should be resolved only if there are no duplicates") {
+    // Different implementations of `WidenSetOperationTypes` cause an additional Project with ANSI
+    // off.
+    val expectedResult = if (conf.ansiEnabled) { 7 } else { 8 }
     withTable("t1", "t2", "t3") {
       sql("CREATE TABLE t1 (col1 STRING, col2 STRING, col3 STRING)")
       sql("CREATE TABLE t2 (col1 STRING, col2 DOUBLE, col3 STRING)")
@@ -4993,9 +4996,9 @@ class SQLQuerySuite extends QueryTest with SharedSparkSession with AdaptiveSpark
           // outer Union before deduplicating ExprIds in inner union. Because of this we get an
           // additional unnecessary Project (see SPARK-52686).
           if (confValue) {
-            assert(projectCount == 7)
+            assert(projectCount == expectedResult)
           } else {
-            assert(projectCount == 8)
+            assert(projectCount == expectedResult + 1)
           }
         }
       }
