diff --git a/core/src/main/resources/org/apache/spark/ui/static/stagepage.js b/core/src/main/resources/org/apache/spark/ui/static/stagepage.js
index 2f70b47c80f..93b37c29627 100644
--- a/core/src/main/resources/org/apache/spark/ui/static/stagepage.js
+++ b/core/src/main/resources/org/apache/spark/ui/static/stagepage.js
@@ -363,15 +363,24 @@ $(document).ready(function () {
             dataToShow.showBytesSpilledData =
                 (responseBody.diskBytesSpilled > 0 || responseBody.memoryBytesSpilled > 0);
 
+            var columnIndicesToRemove = [];
             if (!dataToShow.showShuffleReadData) {
                 $('#shuffle_read_blocked_time').remove();
                 $('#shuffle_remote_reads').remove();
-                optionalColumns.splice(2, 2);
+                columnIndicesToRemove.push(2);
+                columnIndicesToRemove.push(3);
             }
 
             if (!dataToShow.showShuffleWriteData) {
                 $('#shuffle_write_time').remove();
-                optionalColumns.splice(7, 1)
+                columnIndicesToRemove.push(7);
+            }
+
+            if (columnIndicesToRemove.length > 0) {
+                columnIndicesToRemove.sort(function(a, b) { return b - a; });
+                columnIndicesToRemove.forEach(function(idx) {
+                   optionalColumns.splice(idx, 1);
+                });
             }
 
             // prepare data for executor summary table
