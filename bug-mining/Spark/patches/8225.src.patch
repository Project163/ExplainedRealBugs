diff --git a/appveyor.yml b/appveyor.yml
index c40b23c8341..53ef8527c65 100644
--- a/appveyor.yml
+++ b/appveyor.yml
@@ -39,7 +39,7 @@ cache:
   - C:\Users\appveyor\.m2
 
 install:
-  # Install maven and dependencies
+  # Install SBT and dependencies
   - ps: .\dev\appveyor-install-dependencies.ps1
   # Required package for R unit tests. xml2 is required to use jUnit reporter in testthat.
   - cmd: Rscript -e "install.packages(c('knitr', 'rmarkdown', 'testthat', 'e1071', 'survival', 'arrow', 'xml2'), repos='https://cloud.r-project.org/')"
@@ -49,7 +49,11 @@ build_script:
   # '-Djna.nosys=true' is required to avoid kernel32.dll load failure.
   # See SPARK-28759.
   # Ideally we should check the tests related to Hive in SparkR as well (SPARK-31745).
-  - cmd: mvn -DskipTests -Psparkr -Djna.nosys=true package
+  - cmd: set SBT_MAVEN_PROFILES=-Psparkr
+  - cmd: set SBT_OPTS=-Djna.nosys=true -Dfile.encoding=UTF-8 -Xms4096m -Xms4096m -XX:ReservedCodeCacheSize=128m
+  - cmd: sbt package
+  - cmd: set SBT_MAVEN_PROFILES=
+  - cmd: set SBT_OPTS=
 
 environment:
   NOT_CRAN: true
diff --git a/dev/appveyor-install-dependencies.ps1 b/dev/appveyor-install-dependencies.ps1
index fb4cc22de35..850a6e60c37 100644
--- a/dev/appveyor-install-dependencies.ps1
+++ b/dev/appveyor-install-dependencies.ps1
@@ -79,18 +79,32 @@ if (!(Test-Path $tools)) {
 }
 
 # ========================== Maven
+# Push-Location $tools
+#
+# $mavenVer = "3.6.3"
+# Start-FileDownload "https://archive.apache.org/dist/maven/maven-3/$mavenVer/binaries/apache-maven-$mavenVer-bin.zip" "maven.zip"
+#
+# # extract
+# Invoke-Expression "7z.exe x maven.zip"
+#
+# # add maven to environment variables
+# $env:PATH = "$tools\apache-maven-$mavenVer\bin;" + $env:PATH
+# $env:M2_HOME = "$tools\apache-maven-$mavenVer"
+# $env:MAVEN_OPTS = "-Xmx2g -XX:ReservedCodeCacheSize=1g"
+#
+# Pop-Location
+
+# ========================== SBT
 Push-Location $tools
 
-$mavenVer = "3.6.3"
-Start-FileDownload "https://archive.apache.org/dist/maven/maven-3/$mavenVer/binaries/apache-maven-$mavenVer-bin.zip" "maven.zip"
+$sbtVer = "1.5.5"
+Start-FileDownload "https://github.com/sbt/sbt/releases/download/v$sbtVer/sbt-$sbtVer.zip" "sbt.zip"
 
 # extract
-Invoke-Expression "7z.exe x maven.zip"
+Invoke-Expression "7z.exe x sbt.zip"
 
-# add maven to environment variables
-$env:PATH = "$tools\apache-maven-$mavenVer\bin;" + $env:PATH
-$env:M2_HOME = "$tools\apache-maven-$mavenVer"
-$env:MAVEN_OPTS = "-Xmx2g -XX:ReservedCodeCacheSize=1g"
+# add sbt to environment variables
+$env:PATH = "$tools\sbt\bin;" + $env:PATH
 
 Pop-Location
 
diff --git a/project/SparkBuild.scala b/project/SparkBuild.scala
index 10c6deaa172..1c49eeadb48 100644
--- a/project/SparkBuild.scala
+++ b/project/SparkBuild.scala
@@ -917,7 +917,8 @@ object SparkR {
   val buildRPackage = taskKey[Unit]("Build the R package")
   lazy val settings = Seq(
     buildRPackage := {
-      val command = baseDirectory.value / ".." / "R" / "install-dev.sh"
+      val postfix = if (File.separator == "\\") ".bat" else ".sh"
+      val command = baseDirectory.value / ".." / "R" / s"install-dev$postfix"
       Process(command.toString).!!
     },
     (Compile / compile) := (Def.taskDyn {
diff --git a/project/build.properties b/project/build.properties
index c00a1c15800..51bd4ddef00 100644
--- a/project/build.properties
+++ b/project/build.properties
@@ -14,4 +14,5 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
+# Please update the version in appveyor-install-dependencies.ps1 together.
 sbt.version=1.5.5
