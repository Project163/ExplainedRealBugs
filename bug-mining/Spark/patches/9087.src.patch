diff --git a/connector/protobuf/src/main/scala/org/apache/spark/sql/protobuf/ProtobufDeserializer.scala b/connector/protobuf/src/main/scala/org/apache/spark/sql/protobuf/ProtobufDeserializer.scala
index 954b3de72ca..a46baf51379 100644
--- a/connector/protobuf/src/main/scala/org/apache/spark/sql/protobuf/ProtobufDeserializer.scala
+++ b/connector/protobuf/src/main/scala/org/apache/spark/sql/protobuf/ProtobufDeserializer.scala
@@ -273,7 +273,7 @@ private[sql] class ProtobufDeserializer(
 
       case (ENUM, IntegerType) =>
         (updater, ordinal, value) =>
-          updater.set(ordinal, value.asInstanceOf[EnumValueDescriptor].getNumber)
+          updater.setInt(ordinal, value.asInstanceOf[EnumValueDescriptor].getNumber)
 
       case _ =>
         throw QueryCompilationErrors.cannotConvertProtobufTypeToSqlTypeError(
diff --git a/connector/protobuf/src/test/resources/protobuf/functions_suite.desc b/connector/protobuf/src/test/resources/protobuf/functions_suite.desc
index 215dc05707f..0f994f84f43 100644
Binary files a/connector/protobuf/src/test/resources/protobuf/functions_suite.desc and b/connector/protobuf/src/test/resources/protobuf/functions_suite.desc differ
diff --git a/connector/protobuf/src/test/resources/protobuf/functions_suite.proto b/connector/protobuf/src/test/resources/protobuf/functions_suite.proto
index a9d8d626481..78b75d08fb5 100644
--- a/connector/protobuf/src/test/resources/protobuf/functions_suite.proto
+++ b/connector/protobuf/src/test/resources/protobuf/functions_suite.proto
@@ -120,6 +120,7 @@ message SimpleMessageEnum {
   }
   BasicEnumMessage.BasicEnum basic_enum = 3;
   NestedEnum nested_enum = 4;
+  repeated BasicEnumMessage.BasicEnum repeated_enum = 5;
 }
 
 
diff --git a/connector/protobuf/src/test/scala/org/apache/spark/sql/protobuf/ProtobufFunctionsSuite.scala b/connector/protobuf/src/test/scala/org/apache/spark/sql/protobuf/ProtobufFunctionsSuite.scala
index f0979209f86..726d5775110 100644
--- a/connector/protobuf/src/test/scala/org/apache/spark/sql/protobuf/ProtobufFunctionsSuite.scala
+++ b/connector/protobuf/src/test/scala/org/apache/spark/sql/protobuf/ProtobufFunctionsSuite.scala
@@ -147,13 +147,18 @@ class ProtobufFunctionsSuite extends QueryTest with SharedSparkSession with Prot
 
     checkWithFileAndClassName("SimpleMessageRepeated") {
       case (name, descFilePathOpt) =>
-        val fromProtoDF = df.select(
-          from_protobuf_wrapper($"value", name, descFilePathOpt).as("value_from"))
-        val toProtoDF = fromProtoDF.select(
-          to_protobuf_wrapper($"value_from", name, descFilePathOpt).as("value_to"))
-        val toFromProtoDF = toProtoDF.select(
-          from_protobuf_wrapper($"value_to", name, descFilePathOpt).as("value_to_from"))
-        checkAnswer(fromProtoDF.select($"value_from.*"), toFromProtoDF.select($"value_to_from.*"))
+        List(
+          Map.empty[String, String],
+          Map("enums.as.ints" -> "false"),
+          Map("enums.as.ints" -> "true")).foreach(opts => {
+          val fromProtoDF = df.select(
+            from_protobuf_wrapper($"value", name, descFilePathOpt, opts).as("value_from"))
+          val toProtoDF = fromProtoDF.select(
+            to_protobuf_wrapper($"value_from", name, descFilePathOpt).as("value_to"))
+          val toFromProtoDF = toProtoDF.select(
+            from_protobuf_wrapper($"value_to", name, descFilePathOpt, opts).as("value_to_from"))
+          checkAnswer(fromProtoDF.select($"value_from.*"), toFromProtoDF.select($"value_to_from.*"))
+        })
     }
   }
 
@@ -1497,6 +1502,7 @@ class ProtobufFunctionsSuite extends QueryTest with SharedSparkSession with Prot
         .setValue("value")
         .setBasicEnum(BasicEnumMessage.BasicEnum.FIRST)
         .setNestedEnum(SimpleMessageEnum.NestedEnum.NESTED_SECOND)
+        .addRepeatedEnum(BasicEnumMessage.BasicEnum.FIRST)
         .build().toByteArray).as("raw_proto"))
 
     val expected = spark.range(1).select(
@@ -1504,7 +1510,8 @@ class ProtobufFunctionsSuite extends QueryTest with SharedSparkSession with Prot
         lit("key").as("key"),
         lit("value").as("value"),
         lit("FIRST").as("basic_enum"),
-        lit("NESTED_SECOND").as("nested_enum")
+        lit("NESTED_SECOND").as("nested_enum"),
+        typedLit(Seq("FIRST")).as("repeated_enum")
       ).as("proto")
     )
 
@@ -1515,7 +1522,8 @@ class ProtobufFunctionsSuite extends QueryTest with SharedSparkSession with Prot
         lit("key").as("key"),
         lit("value").as("value"),
         lit(1).as("basic_enum"),
-        lit(2).as("nested_enum")
+        lit(2).as("nested_enum"),
+        typedLit(Seq(1)).as("repeated_enum")
       ).as("proto")
     )
 
