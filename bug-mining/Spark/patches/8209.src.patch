diff --git a/sql/catalyst/src/main/scala/org/apache/spark/sql/connector/catalog/CatalogManager.scala b/sql/catalyst/src/main/scala/org/apache/spark/sql/connector/catalog/CatalogManager.scala
index 7d8bc4faa33..0380621b285 100644
--- a/sql/catalyst/src/main/scala/org/apache/spark/sql/connector/catalog/CatalogManager.scala
+++ b/sql/catalyst/src/main/scala/org/apache/spark/sql/connector/catalog/CatalogManager.scala
@@ -89,12 +89,16 @@ class CatalogManager(
 
   private var _currentNamespace: Option[Array[String]] = None
 
-  def currentNamespace: Array[String] = synchronized {
-    _currentNamespace.getOrElse {
-      if (currentCatalog.name() == SESSION_CATALOG_NAME) {
-        Array(v1SessionCatalog.getCurrentDatabase)
-      } else {
-        currentCatalog.defaultNamespace()
+  def currentNamespace: Array[String] = {
+    val defaultNamespace = if (currentCatalog.name() == SESSION_CATALOG_NAME) {
+      Array(v1SessionCatalog.getCurrentDatabase)
+    } else {
+      currentCatalog.defaultNamespace()
+    }
+
+    this.synchronized {
+      _currentNamespace.getOrElse {
+        defaultNamespace
       }
     }
   }
