diff --git a/common/utils/src/main/scala/org/apache/spark/util/SparkErrorUtils.scala b/common/utils/src/main/scala/org/apache/spark/util/SparkErrorUtils.scala
index 8d8dedfd5ca..c4a2856e5fa 100644
--- a/common/utils/src/main/scala/org/apache/spark/util/SparkErrorUtils.scala
+++ b/common/utils/src/main/scala/org/apache/spark/util/SparkErrorUtils.scala
@@ -47,7 +47,11 @@ private[spark] trait SparkErrorUtils extends Logging {
 
   def tryWithResource[R <: Closeable, T](createResource: => R)(f: R => T): T = {
     val resource = createResource
-    try f.apply(resource) finally resource.close()
+    try {
+      f.apply(resource)
+    } finally {
+      closeQuietly(resource)
+    }
   }
 
   /**
@@ -61,7 +65,7 @@ private[spark] trait SparkErrorUtils extends Logging {
       initialize(resource)
     } catch {
       case e: Throwable =>
-        resource.close()
+        closeQuietly(resource)
         throw e
     }
   }
diff --git a/common/utils/src/test/scala/org/apache/spark/util/SparkErrorUtilsSuite.scala b/common/utils/src/test/scala/org/apache/spark/util/SparkErrorUtilsSuite.scala
index ad1a005d8ba..791003b9cdd 100644
--- a/common/utils/src/test/scala/org/apache/spark/util/SparkErrorUtilsSuite.scala
+++ b/common/utils/src/test/scala/org/apache/spark/util/SparkErrorUtilsSuite.scala
@@ -17,6 +17,8 @@
 
 package org.apache.spark.util
 
+import java.io.{Closeable, IOException}
+
 import scala.annotation.nowarn
 
 import org.scalatest.BeforeAndAfterEach
@@ -60,6 +62,22 @@ class SparkErrorUtilsSuite
     assert(SparkErrorUtils.getRootCause(cyclicCause) == cyclicCause.getCause.getCause)
   }
 
+  test("tryWithResource / tryInitializeResource") {
+    val closeable = new Closeable {
+      override def close(): Unit = {
+        throw new IOException("Catch me if you can")
+      }
+    }
+    val e1 = intercept[IOException] {
+      SparkErrorUtils.tryWithResource(closeable)(_ => throw new IOException("You got me!"))
+    }
+    assert(e1.getMessage === "You got me!")
+    val e2 = intercept[IOException] {
+      SparkErrorUtils.tryInitializeResource(closeable)(_ => throw new IOException("You got me!"))
+    }
+    assert(e2.getMessage === "You got me!")
+  }
+
   private def createExceptionWithoutCause: Throwable =
     try throw new ExceptionWithoutCause
     catch {
