diff --git a/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/expressions/objects/objects.scala b/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/expressions/objects/objects.scala
index 77c76e6f5e3..90ab8725e55 100644
--- a/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/expressions/objects/objects.scala
+++ b/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/expressions/objects/objects.scala
@@ -2064,7 +2064,7 @@ case class ValidateExternalType(child: Expression, expected: DataType, externalD
       (value: Any) => {
         value.getClass.isArray ||
           value.isInstanceOf[scala.collection.Seq[_]] ||
-          value.isInstanceOf[Set[_]] ||
+          value.isInstanceOf[scala.collection.Set[_]] ||
           value.isInstanceOf[java.util.List[_]]
       }
     case _: DateType =>
@@ -2106,7 +2106,7 @@ case class ValidateExternalType(child: Expression, expected: DataType, externalD
       case _: ArrayType =>
         val check = genCheckTypes(Seq(
           classOf[scala.collection.Seq[_]],
-          classOf[Set[_]],
+          classOf[scala.collection.Set[_]],
           classOf[java.util.List[_]]))
         s"$obj.getClass().isArray() || $check"
       case _: DateType =>
diff --git a/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/encoders/ExpressionEncoderSuite.scala b/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/encoders/ExpressionEncoderSuite.scala
index 77c9672fd95..bdd1d507e04 100644
--- a/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/encoders/ExpressionEncoderSuite.scala
+++ b/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/encoders/ExpressionEncoderSuite.scala
@@ -21,6 +21,7 @@ import java.math.BigInteger
 import java.sql.{Date, Timestamp}
 import java.util.Arrays
 
+import scala.collection.mutable
 import scala.collection.mutable.ArrayBuffer
 import scala.reflect.classTag
 import scala.reflect.runtime.universe.TypeTag
@@ -428,6 +429,10 @@ class ExpressionEncoderSuite extends CodegenInterpretedPlanTest with AnalysisTes
 
   encodeDecodeTest(Array(Set(1, 2), Set(2, 3)), "array of sets")
 
+  encodeDecodeTest(Array(mutable.Set(1, 2)), "SPARK-51070: array of mutable set")
+  encodeDecodeTest(Seq(mutable.Set(1, 2)), "SPARK-51070: seq of mutable set")
+  encodeDecodeTest(Map(0 -> mutable.Set(1, 2)), "SPARK-51070: map of mutable set")
+
   productTest(("UDT", new ExamplePoint(0.1, 0.2)))
 
   test("AnyVal class with Any fields") {
diff --git a/sql/core/src/test/scala/org/apache/spark/sql/DatasetSuite.scala b/sql/core/src/test/scala/org/apache/spark/sql/DatasetSuite.scala
index 8963c9de4ee..0e6b1840a6f 100644
--- a/sql/core/src/test/scala/org/apache/spark/sql/DatasetSuite.scala
+++ b/sql/core/src/test/scala/org/apache/spark/sql/DatasetSuite.scala
@@ -21,6 +21,7 @@ import java.io.{Externalizable, ObjectInput, ObjectOutput}
 import java.sql.{Date, Timestamp}
 
 import scala.collection.immutable.HashSet
+import scala.collection.mutable
 import scala.jdk.CollectionConverters._
 import scala.reflect.ClassTag
 import scala.util.Random
@@ -2826,6 +2827,20 @@ class DatasetSuite extends QueryTest
     val transformed = ds.transform(f)
     assert(transformed.collect().sorted === Array(2, 3))
   }
+
+  test("SPARK-51070: array/seq/map of mutable set") {
+    val set: collection.Set[Int] = mutable.Set(1, 2)
+
+    implicit val arrayEncoder = ExpressionEncoder[Array[collection.Set[Int]]]()
+
+    val arrayMutableSet = Array(set)
+    val seqMutableSet = Seq(set)
+    val mapMutableSet = Map(1 -> set)
+
+    checkDataset(Seq(arrayMutableSet).toDS(), arrayMutableSet)
+    checkDataset(Seq(seqMutableSet).toDS(), seqMutableSet)
+    checkDataset(Seq(mapMutableSet).toDS(), mapMutableSet)
+  }
 }
 
 class DatasetLargeResultCollectingSuite extends QueryTest
