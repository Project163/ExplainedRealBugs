diff --git a/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/analysis/DeduplicateRelations.scala b/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/analysis/DeduplicateRelations.scala
index 1d4c7d3f9f1..9837fcd29ec 100644
--- a/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/analysis/DeduplicateRelations.scala
+++ b/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/analysis/DeduplicateRelations.scala
@@ -25,18 +25,15 @@ import org.apache.spark.sql.catalyst.rules.Rule
 import org.apache.spark.sql.catalyst.trees.TreePattern._
 
 /**
- * A helper class used to detect duplicate relations fast in `DeduplicateRelations`
+ * A helper class used to detect duplicate relations fast in `DeduplicateRelations`. Two relations
+ * are duplicated if:
+ *  1. they are the same class.
+ *  2. they have the same output attribute IDs.
+ *
+ * The first condition is necessary because the CTE relation definition node and reference node have
+ * the same output attribute IDs but they are not duplicated.
  */
-case class ReferenceEqualPlanWrapper(plan: LogicalPlan) {
-  private val _hashCode = System.identityHashCode(plan)
-  override def hashCode(): Int = _hashCode
-  override def equals(obj: Any): Boolean = obj match {
-    case wrapper: ReferenceEqualPlanWrapper =>
-      plan.eq(wrapper.plan)
-    case _ =>
-      false
-  }
-}
+case class RelationWrapper(cls: Class[_], outputAttrIds: Seq[Long])
 
 object DeduplicateRelations extends Rule[LogicalPlan] {
   override def apply(plan: LogicalPlan): LogicalPlan = {
@@ -93,12 +90,12 @@ object DeduplicateRelations extends Rule[LogicalPlan] {
    *          whether the plan is changed or not)
    */
   private def renewDuplicatedRelations(
-      existingRelations: mutable.HashSet[ReferenceEqualPlanWrapper],
+      existingRelations: mutable.HashSet[RelationWrapper],
       plan: LogicalPlan): (LogicalPlan, Boolean) = plan match {
     case p: LogicalPlan if p.isStreaming => (plan, false)
 
     case m: MultiInstanceRelation =>
-      val planWrapper = ReferenceEqualPlanWrapper(m)
+      val planWrapper = RelationWrapper(m.getClass, m.output.map(_.exprId.id))
       if (existingRelations.contains(planWrapper)) {
         val newNode = m.newInstance()
         newNode.copyTagsFrom(m)
diff --git a/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/analysis/AnalysisSuite.scala b/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/analysis/AnalysisSuite.scala
index 68ac6fe378a..d1dcf7b76f6 100644
--- a/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/analysis/AnalysisSuite.scala
+++ b/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/analysis/AnalysisSuite.scala
@@ -1438,4 +1438,66 @@ class AnalysisSuite extends AnalysisTest with Matchers {
       ).analyze
     )
   }
+
+  test("SPARK-43030: deduplicate relations in CTE relation definitions") {
+    val join = testRelation.as("left").join(testRelation.as("right"))
+    val cteDef = CTERelationDef(join)
+    val cteRef = CTERelationRef(cteDef.id, false, Nil)
+
+    withClue("flat CTE") {
+      val plan = WithCTE(cteRef.select($"left.a"), Seq(cteDef)).analyze
+      val relations = plan.collect {
+        case r: LocalRelation => r
+      }
+      assert(relations.length == 2)
+      assert(relations.map(_.output).distinct.length == 2)
+    }
+
+    withClue("nested CTE") {
+      val cteDef2 = CTERelationDef(WithCTE(cteRef.join(testRelation), Seq(cteDef)))
+      val cteRef2 = CTERelationRef(cteDef2.id, false, Nil)
+      val plan = WithCTE(cteRef2, Seq(cteDef2)).analyze
+      val relations = plan.collect {
+        case r: LocalRelation => r
+      }
+      assert(relations.length == 3)
+      assert(relations.map(_.output).distinct.length == 3)
+    }
+  }
+
+  test("SPARK-43030: deduplicate CTE relation references") {
+    val cteDef = CTERelationDef(testRelation.select($"a"))
+    val cteRef = CTERelationRef(cteDef.id, false, Nil)
+
+    withClue("single reference") {
+      val plan = WithCTE(cteRef.where($"a" > 1), Seq(cteDef)).analyze
+      val refs = plan.collect {
+        case r: CTERelationRef => r
+      }
+      // Only one CTE ref, no need to deduplicate
+      assert(refs.length == 1)
+      assert(refs(0).output == testRelation.output.take(1))
+    }
+
+    withClue("two references") {
+      val plan = WithCTE(cteRef.join(cteRef), Seq(cteDef)).analyze
+      val refs = plan.collect {
+        case r: CTERelationRef => r
+      }
+      assert(refs.length == 2)
+      assert(refs.map(_.output).distinct.length == 2)
+    }
+
+    withClue("references in both CTE relation definition and main query") {
+      val cteDef2 = CTERelationDef(cteRef.where($"a" > 2))
+      val cteRef2 = CTERelationRef(cteDef2.id, false, Nil)
+      val plan = WithCTE(cteRef.union(cteRef2), Seq(cteDef, cteDef2)).analyze
+      val refs = plan.collect {
+        case r: CTERelationRef => r
+      }
+      assert(refs.length == 3)
+      assert(refs.map(_.cteId).distinct.length == 2)
+      assert(refs.map(_.output).distinct.length == 3)
+    }
+  }
 }
diff --git a/sql/core/src/test/resources/sql-tests/analyzer-results/subquery/in-subquery/in-with-cte.sql.out b/sql/core/src/test/resources/sql-tests/analyzer-results/subquery/in-subquery/in-with-cte.sql.out
index c6eceff7598..9d82c707177 100644
--- a/sql/core/src/test/resources/sql-tests/analyzer-results/subquery/in-subquery/in-with-cte.sql.out
+++ b/sql/core/src/test/resources/sql-tests/analyzer-results/subquery/in-subquery/in-with-cte.sql.out
@@ -198,23 +198,20 @@ WithCTE
          :        :  :     :  +- Filter (cast(t1b#x as int) > 0)
          :        :  :     :     +- SubqueryAlias cte1
          :        :  :     :        +- CTERelationRef xxxx, true, [t1a#x, t1b#x]
-         :        :  :     +- Project [t1b#x AS t1b#x]
-         :        :  :        +- Project [t1b#x]
-         :        :  :           +- Filter (cast(t1b#x as int) > 5)
-         :        :  :              +- SubqueryAlias cte1
-         :        :  :                 +- CTERelationRef xxxx, true, [t1a#x, t1b#x]
-         :        :  +- Project [t1b#x AS t1b#x]
-         :        :     +- Intersect false
-         :        :        :- Project [t1b#x]
-         :        :        :  +- SubqueryAlias cte1
-         :        :        :     +- CTERelationRef xxxx, true, [t1a#x, t1b#x]
-         :        :        +- Project [t1b#x]
-         :        :           +- SubqueryAlias cte1
-         :        :              +- CTERelationRef xxxx, true, [t1a#x, t1b#x]
-         :        +- Project [t1b#x AS t1b#x]
-         :           +- Project [t1b#x]
-         :              +- SubqueryAlias cte1
-         :                 +- CTERelationRef xxxx, true, [t1a#x, t1b#x]
+         :        :  :     +- Project [t1b#x]
+         :        :  :        +- Filter (cast(t1b#x as int) > 5)
+         :        :  :           +- SubqueryAlias cte1
+         :        :  :              +- CTERelationRef xxxx, true, [t1a#x, t1b#x]
+         :        :  +- Intersect false
+         :        :     :- Project [t1b#x]
+         :        :     :  +- SubqueryAlias cte1
+         :        :     :     +- CTERelationRef xxxx, true, [t1a#x, t1b#x]
+         :        :     +- Project [t1b#x]
+         :        :        +- SubqueryAlias cte1
+         :        :           +- CTERelationRef xxxx, true, [t1a#x, t1b#x]
+         :        +- Project [t1b#x]
+         :           +- SubqueryAlias cte1
+         :              +- CTERelationRef xxxx, true, [t1a#x, t1b#x]
          +- SubqueryAlias t1
             +- View (`t1`, [t1a#x,t1b#x,t1c#x,t1d#xL,t1e#x,t1f#x,t1g#x,t1h#x,t1i#x])
                +- Project [cast(t1a#x as string) AS t1a#x, cast(t1b#x as smallint) AS t1b#x, cast(t1c#x as int) AS t1c#x, cast(t1d#xL as bigint) AS t1d#xL, cast(t1e#x as float) AS t1e#x, cast(t1f#x as double) AS t1f#x, cast(t1g#x as double) AS t1g#x, cast(t1h#x as timestamp) AS t1h#x, cast(t1i#x as date) AS t1i#x]
diff --git a/sql/core/src/test/resources/sql-tests/analyzer-results/subquery/scalar-subquery/scalar-subquery-select.sql.out b/sql/core/src/test/resources/sql-tests/analyzer-results/subquery/scalar-subquery/scalar-subquery-select.sql.out
index b4de465903c..e879cf8adac 100644
--- a/sql/core/src/test/resources/sql-tests/analyzer-results/subquery/scalar-subquery/scalar-subquery-select.sql.out
+++ b/sql/core/src/test/resources/sql-tests/analyzer-results/subquery/scalar-subquery/scalar-subquery-select.sql.out
@@ -714,10 +714,9 @@ Project [c1#x, scalar-subquery#x [c1#x] AS scalarsubquery(c1)#xL]
 :                       :- Project [c1#x, c2#x]
 :                       :  +- SubqueryAlias t
 :                       :     +- CTERelationRef xxxx, true, [c1#x, c2#x]
-:                       +- Project [c2#x AS c2#x, c1#x AS c1#x]
-:                          +- Project [c2#x, c1#x]
-:                             +- SubqueryAlias t
-:                                +- CTERelationRef xxxx, true, [c1#x, c2#x]
+:                       +- Project [c2#x, c1#x]
+:                          +- SubqueryAlias t
+:                             +- CTERelationRef xxxx, true, [c1#x, c2#x]
 +- SubqueryAlias t1
    +- View (`t1`, [c1#x,c2#x])
       +- Project [cast(c1#x as int) AS c1#x, cast(c2#x as int) AS c2#x]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q27.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q27.sf100/explain.txt
index 361c26c9b84..a44e0656f3d 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q27.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q27.sf100/explain.txt
@@ -209,208 +209,208 @@ Aggregate Attributes [4]: [avg(agg1#19)#39, avg(UnscaledValue(agg2#20))#40, avg(
 Results [7]: [i_item_id#18, s_state#16, 0 AS g_state#43, avg(agg1#19)#39 AS agg1#44, cast((avg(UnscaledValue(agg2#20))#40 / 100.0) as decimal(11,6)) AS agg2#45, cast((avg(UnscaledValue(agg3#21))#41 / 100.0) as decimal(11,6)) AS agg3#46, cast((avg(UnscaledValue(agg4#22))#42 / 100.0) as decimal(11,6)) AS agg4#47]
 
 (29) Scan parquet spark_catalog.default.store_sales
-Output [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Output [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#8), (ss_sold_date_sk#8 >= 2451545), (ss_sold_date_sk#8 <= 2451910), dynamicpruningexpression(ss_sold_date_sk#8 IN dynamicpruning#9)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#55), (ss_sold_date_sk#55 >= 2451545), (ss_sold_date_sk#55 <= 2451910), dynamicpruningexpression(ss_sold_date_sk#55 IN dynamicpruning#9)]
 PushedFilters: [IsNotNull(ss_cdemo_sk), IsNotNull(ss_store_sk), IsNotNull(ss_item_sk)]
 ReadSchema: struct<ss_item_sk:int,ss_cdemo_sk:int,ss_store_sk:int,ss_quantity:int,ss_list_price:decimal(7,2),ss_sales_price:decimal(7,2),ss_coupon_amt:decimal(7,2)>
 
 (30) ColumnarToRow [codegen id : 11]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Input [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
 
 (31) Filter [codegen id : 11]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Condition : ((isnotnull(ss_cdemo_sk#2) AND isnotnull(ss_store_sk#3)) AND isnotnull(ss_item_sk#1))
+Input [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
+Condition : ((isnotnull(ss_cdemo_sk#49) AND isnotnull(ss_store_sk#50)) AND isnotnull(ss_item_sk#48))
 
 (32) ReusedExchange [Reuses operator id: 78]
-Output [1]: [d_date_sk#10]
+Output [1]: [d_date_sk#56]
 
 (33) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_sold_date_sk#8]
-Right keys [1]: [d_date_sk#10]
+Left keys [1]: [ss_sold_date_sk#55]
+Right keys [1]: [d_date_sk#56]
 Join type: Inner
 Join condition: None
 
 (34) Project [codegen id : 11]
-Output [7]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [9]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, d_date_sk#10]
+Output [7]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54]
+Input [9]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55, d_date_sk#56]
 
 (35) Scan parquet spark_catalog.default.store
-Output [2]: [s_store_sk#15, s_state#16]
+Output [2]: [s_store_sk#57, s_state#58]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store]
 PushedFilters: [In(s_state, [AL,SD,TN]), IsNotNull(s_store_sk)]
 ReadSchema: struct<s_store_sk:int,s_state:string>
 
 (36) ColumnarToRow [codegen id : 8]
-Input [2]: [s_store_sk#15, s_state#16]
+Input [2]: [s_store_sk#57, s_state#58]
 
 (37) Filter [codegen id : 8]
-Input [2]: [s_store_sk#15, s_state#16]
-Condition : (s_state#16 IN (TN,AL,SD) AND isnotnull(s_store_sk#15))
+Input [2]: [s_store_sk#57, s_state#58]
+Condition : (s_state#58 IN (TN,AL,SD) AND isnotnull(s_store_sk#57))
 
 (38) Project [codegen id : 8]
-Output [1]: [s_store_sk#15]
-Input [2]: [s_store_sk#15, s_state#16]
+Output [1]: [s_store_sk#57]
+Input [2]: [s_store_sk#57, s_state#58]
 
 (39) BroadcastExchange
-Input [1]: [s_store_sk#15]
+Input [1]: [s_store_sk#57]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5]
 
 (40) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#15]
+Left keys [1]: [ss_store_sk#50]
+Right keys [1]: [s_store_sk#57]
 Join type: Inner
 Join condition: None
 
 (41) Project [codegen id : 11]
-Output [6]: [ss_item_sk#1, ss_cdemo_sk#2, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, s_store_sk#15]
+Output [6]: [ss_item_sk#48, ss_cdemo_sk#49, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54]
+Input [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, s_store_sk#57]
 
 (42) ReusedExchange [Reuses operator id: 11]
-Output [1]: [cd_demo_sk#11]
+Output [1]: [cd_demo_sk#59]
 
 (43) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#11]
+Left keys [1]: [ss_cdemo_sk#49]
+Right keys [1]: [cd_demo_sk#59]
 Join type: Inner
 Join condition: None
 
 (44) Project [codegen id : 11]
-Output [5]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [7]: [ss_item_sk#1, ss_cdemo_sk#2, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, cd_demo_sk#11]
+Output [5]: [ss_item_sk#48, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54]
+Input [7]: [ss_item_sk#48, ss_cdemo_sk#49, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, cd_demo_sk#59]
 
 (45) ReusedExchange [Reuses operator id: 23]
-Output [2]: [i_item_sk#17, i_item_id#18]
+Output [2]: [i_item_sk#60, i_item_id#61]
 
 (46) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#17]
+Left keys [1]: [ss_item_sk#48]
+Right keys [1]: [i_item_sk#60]
 Join type: Inner
 Join condition: None
 
 (47) Project [codegen id : 11]
-Output [5]: [i_item_id#18, ss_quantity#4 AS agg1#19, ss_list_price#5 AS agg2#20, ss_coupon_amt#7 AS agg3#21, ss_sales_price#6 AS agg4#22]
-Input [7]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, i_item_sk#17, i_item_id#18]
+Output [5]: [i_item_id#61, ss_quantity#51 AS agg1#62, ss_list_price#52 AS agg2#63, ss_coupon_amt#54 AS agg3#64, ss_sales_price#53 AS agg4#65]
+Input [7]: [ss_item_sk#48, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, i_item_sk#60, i_item_id#61]
 
 (48) HashAggregate [codegen id : 11]
-Input [5]: [i_item_id#18, agg1#19, agg2#20, agg3#21, agg4#22]
-Keys [1]: [i_item_id#18]
-Functions [4]: [partial_avg(agg1#19), partial_avg(UnscaledValue(agg2#20)), partial_avg(UnscaledValue(agg3#21)), partial_avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [8]: [sum#48, count#49, sum#50, count#51, sum#52, count#53, sum#54, count#55]
-Results [9]: [i_item_id#18, sum#56, count#57, sum#58, count#59, sum#60, count#61, sum#62, count#63]
+Input [5]: [i_item_id#61, agg1#62, agg2#63, agg3#64, agg4#65]
+Keys [1]: [i_item_id#61]
+Functions [4]: [partial_avg(agg1#62), partial_avg(UnscaledValue(agg2#63)), partial_avg(UnscaledValue(agg3#64)), partial_avg(UnscaledValue(agg4#65))]
+Aggregate Attributes [8]: [sum#66, count#67, sum#68, count#69, sum#70, count#71, sum#72, count#73]
+Results [9]: [i_item_id#61, sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
 
 (49) Exchange
-Input [9]: [i_item_id#18, sum#56, count#57, sum#58, count#59, sum#60, count#61, sum#62, count#63]
-Arguments: hashpartitioning(i_item_id#18, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [9]: [i_item_id#61, sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
+Arguments: hashpartitioning(i_item_id#61, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (50) HashAggregate [codegen id : 12]
-Input [9]: [i_item_id#18, sum#56, count#57, sum#58, count#59, sum#60, count#61, sum#62, count#63]
-Keys [1]: [i_item_id#18]
-Functions [4]: [avg(agg1#19), avg(UnscaledValue(agg2#20)), avg(UnscaledValue(agg3#21)), avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [4]: [avg(agg1#19)#64, avg(UnscaledValue(agg2#20))#65, avg(UnscaledValue(agg3#21))#66, avg(UnscaledValue(agg4#22))#67]
-Results [7]: [i_item_id#18, null AS s_state#68, 1 AS g_state#69, avg(agg1#19)#64 AS agg1#70, cast((avg(UnscaledValue(agg2#20))#65 / 100.0) as decimal(11,6)) AS agg2#71, cast((avg(UnscaledValue(agg3#21))#66 / 100.0) as decimal(11,6)) AS agg3#72, cast((avg(UnscaledValue(agg4#22))#67 / 100.0) as decimal(11,6)) AS agg4#73]
+Input [9]: [i_item_id#61, sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
+Keys [1]: [i_item_id#61]
+Functions [4]: [avg(agg1#62), avg(UnscaledValue(agg2#63)), avg(UnscaledValue(agg3#64)), avg(UnscaledValue(agg4#65))]
+Aggregate Attributes [4]: [avg(agg1#62)#82, avg(UnscaledValue(agg2#63))#83, avg(UnscaledValue(agg3#64))#84, avg(UnscaledValue(agg4#65))#85]
+Results [7]: [i_item_id#61, null AS s_state#86, 1 AS g_state#87, avg(agg1#62)#82 AS agg1#88, cast((avg(UnscaledValue(agg2#63))#83 / 100.0) as decimal(11,6)) AS agg2#89, cast((avg(UnscaledValue(agg3#64))#84 / 100.0) as decimal(11,6)) AS agg3#90, cast((avg(UnscaledValue(agg4#65))#85 / 100.0) as decimal(11,6)) AS agg4#91]
 
 (51) Scan parquet spark_catalog.default.store_sales
-Output [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Output [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#8), (ss_sold_date_sk#8 >= 2451545), (ss_sold_date_sk#8 <= 2451910), dynamicpruningexpression(ss_sold_date_sk#8 IN dynamicpruning#9)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#99), (ss_sold_date_sk#99 >= 2451545), (ss_sold_date_sk#99 <= 2451910), dynamicpruningexpression(ss_sold_date_sk#99 IN dynamicpruning#9)]
 PushedFilters: [IsNotNull(ss_cdemo_sk), IsNotNull(ss_store_sk), IsNotNull(ss_item_sk)]
 ReadSchema: struct<ss_item_sk:int,ss_cdemo_sk:int,ss_store_sk:int,ss_quantity:int,ss_list_price:decimal(7,2),ss_sales_price:decimal(7,2),ss_coupon_amt:decimal(7,2)>
 
 (52) ColumnarToRow [codegen id : 17]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Input [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
 
 (53) Filter [codegen id : 17]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Condition : ((isnotnull(ss_cdemo_sk#2) AND isnotnull(ss_store_sk#3)) AND isnotnull(ss_item_sk#1))
+Input [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
+Condition : ((isnotnull(ss_cdemo_sk#93) AND isnotnull(ss_store_sk#94)) AND isnotnull(ss_item_sk#92))
 
 (54) ReusedExchange [Reuses operator id: 78]
-Output [1]: [d_date_sk#10]
+Output [1]: [d_date_sk#100]
 
 (55) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_sold_date_sk#8]
-Right keys [1]: [d_date_sk#10]
+Left keys [1]: [ss_sold_date_sk#99]
+Right keys [1]: [d_date_sk#100]
 Join type: Inner
 Join condition: None
 
 (56) Project [codegen id : 17]
-Output [7]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [9]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, d_date_sk#10]
+Output [7]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98]
+Input [9]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99, d_date_sk#100]
 
 (57) ReusedExchange [Reuses operator id: 39]
-Output [1]: [s_store_sk#15]
+Output [1]: [s_store_sk#101]
 
 (58) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#15]
+Left keys [1]: [ss_store_sk#94]
+Right keys [1]: [s_store_sk#101]
 Join type: Inner
 Join condition: None
 
 (59) Project [codegen id : 17]
-Output [6]: [ss_item_sk#1, ss_cdemo_sk#2, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, s_store_sk#15]
+Output [6]: [ss_item_sk#92, ss_cdemo_sk#93, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98]
+Input [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, s_store_sk#101]
 
 (60) ReusedExchange [Reuses operator id: 11]
-Output [1]: [cd_demo_sk#11]
+Output [1]: [cd_demo_sk#102]
 
 (61) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#11]
+Left keys [1]: [ss_cdemo_sk#93]
+Right keys [1]: [cd_demo_sk#102]
 Join type: Inner
 Join condition: None
 
 (62) Project [codegen id : 17]
-Output [5]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [7]: [ss_item_sk#1, ss_cdemo_sk#2, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, cd_demo_sk#11]
+Output [5]: [ss_item_sk#92, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98]
+Input [7]: [ss_item_sk#92, ss_cdemo_sk#93, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, cd_demo_sk#102]
 
 (63) Scan parquet spark_catalog.default.item
-Output [1]: [i_item_sk#17]
+Output [1]: [i_item_sk#103]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/item]
 PushedFilters: [IsNotNull(i_item_sk)]
 ReadSchema: struct<i_item_sk:int>
 
 (64) ColumnarToRow [codegen id : 16]
-Input [1]: [i_item_sk#17]
+Input [1]: [i_item_sk#103]
 
 (65) Filter [codegen id : 16]
-Input [1]: [i_item_sk#17]
-Condition : isnotnull(i_item_sk#17)
+Input [1]: [i_item_sk#103]
+Condition : isnotnull(i_item_sk#103)
 
 (66) BroadcastExchange
-Input [1]: [i_item_sk#17]
+Input [1]: [i_item_sk#103]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7]
 
 (67) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#17]
+Left keys [1]: [ss_item_sk#92]
+Right keys [1]: [i_item_sk#103]
 Join type: Inner
 Join condition: None
 
 (68) Project [codegen id : 17]
-Output [4]: [ss_quantity#4 AS agg1#19, ss_list_price#5 AS agg2#20, ss_coupon_amt#7 AS agg3#21, ss_sales_price#6 AS agg4#22]
-Input [6]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, i_item_sk#17]
+Output [4]: [ss_quantity#95 AS agg1#104, ss_list_price#96 AS agg2#105, ss_coupon_amt#98 AS agg3#106, ss_sales_price#97 AS agg4#107]
+Input [6]: [ss_item_sk#92, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, i_item_sk#103]
 
 (69) HashAggregate [codegen id : 17]
-Input [4]: [agg1#19, agg2#20, agg3#21, agg4#22]
+Input [4]: [agg1#104, agg2#105, agg3#106, agg4#107]
 Keys: []
-Functions [4]: [partial_avg(agg1#19), partial_avg(UnscaledValue(agg2#20)), partial_avg(UnscaledValue(agg3#21)), partial_avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [8]: [sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
-Results [8]: [sum#82, count#83, sum#84, count#85, sum#86, count#87, sum#88, count#89]
+Functions [4]: [partial_avg(agg1#104), partial_avg(UnscaledValue(agg2#105)), partial_avg(UnscaledValue(agg3#106)), partial_avg(UnscaledValue(agg4#107))]
+Aggregate Attributes [8]: [sum#108, count#109, sum#110, count#111, sum#112, count#113, sum#114, count#115]
+Results [8]: [sum#116, count#117, sum#118, count#119, sum#120, count#121, sum#122, count#123]
 
 (70) Exchange
-Input [8]: [sum#82, count#83, sum#84, count#85, sum#86, count#87, sum#88, count#89]
+Input [8]: [sum#116, count#117, sum#118, count#119, sum#120, count#121, sum#122, count#123]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=8]
 
 (71) HashAggregate [codegen id : 18]
-Input [8]: [sum#82, count#83, sum#84, count#85, sum#86, count#87, sum#88, count#89]
+Input [8]: [sum#116, count#117, sum#118, count#119, sum#120, count#121, sum#122, count#123]
 Keys: []
-Functions [4]: [avg(agg1#19), avg(UnscaledValue(agg2#20)), avg(UnscaledValue(agg3#21)), avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [4]: [avg(agg1#19)#90, avg(UnscaledValue(agg2#20))#91, avg(UnscaledValue(agg3#21))#92, avg(UnscaledValue(agg4#22))#93]
-Results [7]: [null AS i_item_id#94, null AS s_state#95, 1 AS g_state#96, avg(agg1#19)#90 AS agg1#97, cast((avg(UnscaledValue(agg2#20))#91 / 100.0) as decimal(11,6)) AS agg2#98, cast((avg(UnscaledValue(agg3#21))#92 / 100.0) as decimal(11,6)) AS agg3#99, cast((avg(UnscaledValue(agg4#22))#93 / 100.0) as decimal(11,6)) AS agg4#100]
+Functions [4]: [avg(agg1#104), avg(UnscaledValue(agg2#105)), avg(UnscaledValue(agg3#106)), avg(UnscaledValue(agg4#107))]
+Aggregate Attributes [4]: [avg(agg1#104)#124, avg(UnscaledValue(agg2#105))#125, avg(UnscaledValue(agg3#106))#126, avg(UnscaledValue(agg4#107))#127]
+Results [7]: [null AS i_item_id#128, null AS s_state#129, 1 AS g_state#130, avg(agg1#104)#124 AS agg1#131, cast((avg(UnscaledValue(agg2#105))#125 / 100.0) as decimal(11,6)) AS agg2#132, cast((avg(UnscaledValue(agg3#106))#126 / 100.0) as decimal(11,6)) AS agg3#133, cast((avg(UnscaledValue(agg4#107))#127 / 100.0) as decimal(11,6)) AS agg4#134]
 
 (72) Union
 
@@ -429,29 +429,29 @@ BroadcastExchange (78)
 
 
 (74) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#10, d_year#101]
+Output [2]: [d_date_sk#10, d_year#135]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), GreaterThanOrEqual(d_date_sk,2451545), LessThanOrEqual(d_date_sk,2451910), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (75) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#10, d_year#101]
+Input [2]: [d_date_sk#10, d_year#135]
 
 (76) Filter [codegen id : 1]
-Input [2]: [d_date_sk#10, d_year#101]
-Condition : ((((isnotnull(d_year#101) AND (d_year#101 = 2000)) AND (d_date_sk#10 >= 2451545)) AND (d_date_sk#10 <= 2451910)) AND isnotnull(d_date_sk#10))
+Input [2]: [d_date_sk#10, d_year#135]
+Condition : ((((isnotnull(d_year#135) AND (d_year#135 = 2000)) AND (d_date_sk#10 >= 2451545)) AND (d_date_sk#10 <= 2451910)) AND isnotnull(d_date_sk#10))
 
 (77) Project [codegen id : 1]
 Output [1]: [d_date_sk#10]
-Input [2]: [d_date_sk#10, d_year#101]
+Input [2]: [d_date_sk#10, d_year#135]
 
 (78) BroadcastExchange
 Input [1]: [d_date_sk#10]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=9]
 
-Subquery:2 Hosting operator id = 29 Hosting Expression = ss_sold_date_sk#8 IN dynamicpruning#9
+Subquery:2 Hosting operator id = 29 Hosting Expression = ss_sold_date_sk#55 IN dynamicpruning#9
 
-Subquery:3 Hosting operator id = 51 Hosting Expression = ss_sold_date_sk#8 IN dynamicpruning#9
+Subquery:3 Hosting operator id = 51 Hosting Expression = ss_sold_date_sk#99 IN dynamicpruning#9
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q27/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q27/explain.txt
index 2cab8af1811..6bb72913ab4 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q27/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q27/explain.txt
@@ -209,208 +209,208 @@ Aggregate Attributes [4]: [avg(agg1#19)#39, avg(UnscaledValue(agg2#20))#40, avg(
 Results [7]: [i_item_id#18, s_state#16, 0 AS g_state#43, avg(agg1#19)#39 AS agg1#44, cast((avg(UnscaledValue(agg2#20))#40 / 100.0) as decimal(11,6)) AS agg2#45, cast((avg(UnscaledValue(agg3#21))#41 / 100.0) as decimal(11,6)) AS agg3#46, cast((avg(UnscaledValue(agg4#22))#42 / 100.0) as decimal(11,6)) AS agg4#47]
 
 (29) Scan parquet spark_catalog.default.store_sales
-Output [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Output [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#8), (ss_sold_date_sk#8 >= 2451545), (ss_sold_date_sk#8 <= 2451910), dynamicpruningexpression(ss_sold_date_sk#8 IN dynamicpruning#9)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#55), (ss_sold_date_sk#55 >= 2451545), (ss_sold_date_sk#55 <= 2451910), dynamicpruningexpression(ss_sold_date_sk#55 IN dynamicpruning#9)]
 PushedFilters: [IsNotNull(ss_cdemo_sk), IsNotNull(ss_store_sk), IsNotNull(ss_item_sk)]
 ReadSchema: struct<ss_item_sk:int,ss_cdemo_sk:int,ss_store_sk:int,ss_quantity:int,ss_list_price:decimal(7,2),ss_sales_price:decimal(7,2),ss_coupon_amt:decimal(7,2)>
 
 (30) ColumnarToRow [codegen id : 11]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Input [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
 
 (31) Filter [codegen id : 11]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Condition : ((isnotnull(ss_cdemo_sk#2) AND isnotnull(ss_store_sk#3)) AND isnotnull(ss_item_sk#1))
+Input [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
+Condition : ((isnotnull(ss_cdemo_sk#49) AND isnotnull(ss_store_sk#50)) AND isnotnull(ss_item_sk#48))
 
 (32) ReusedExchange [Reuses operator id: 8]
-Output [1]: [cd_demo_sk#10]
+Output [1]: [cd_demo_sk#56]
 
 (33) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#10]
+Left keys [1]: [ss_cdemo_sk#49]
+Right keys [1]: [cd_demo_sk#56]
 Join type: Inner
 Join condition: None
 
 (34) Project [codegen id : 11]
-Output [7]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Input [9]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, cd_demo_sk#10]
+Output [7]: [ss_item_sk#48, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
+Input [9]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55, cd_demo_sk#56]
 
 (35) ReusedExchange [Reuses operator id: 78]
-Output [1]: [d_date_sk#14]
+Output [1]: [d_date_sk#57]
 
 (36) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_sold_date_sk#8]
-Right keys [1]: [d_date_sk#14]
+Left keys [1]: [ss_sold_date_sk#55]
+Right keys [1]: [d_date_sk#57]
 Join type: Inner
 Join condition: None
 
 (37) Project [codegen id : 11]
-Output [6]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [8]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, d_date_sk#14]
+Output [6]: [ss_item_sk#48, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54]
+Input [8]: [ss_item_sk#48, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55, d_date_sk#57]
 
 (38) Scan parquet spark_catalog.default.store
-Output [2]: [s_store_sk#15, s_state#16]
+Output [2]: [s_store_sk#58, s_state#59]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store]
 PushedFilters: [In(s_state, [AL,SD,TN]), IsNotNull(s_store_sk)]
 ReadSchema: struct<s_store_sk:int,s_state:string>
 
 (39) ColumnarToRow [codegen id : 9]
-Input [2]: [s_store_sk#15, s_state#16]
+Input [2]: [s_store_sk#58, s_state#59]
 
 (40) Filter [codegen id : 9]
-Input [2]: [s_store_sk#15, s_state#16]
-Condition : (s_state#16 IN (TN,AL,SD) AND isnotnull(s_store_sk#15))
+Input [2]: [s_store_sk#58, s_state#59]
+Condition : (s_state#59 IN (TN,AL,SD) AND isnotnull(s_store_sk#58))
 
 (41) Project [codegen id : 9]
-Output [1]: [s_store_sk#15]
-Input [2]: [s_store_sk#15, s_state#16]
+Output [1]: [s_store_sk#58]
+Input [2]: [s_store_sk#58, s_state#59]
 
 (42) BroadcastExchange
-Input [1]: [s_store_sk#15]
+Input [1]: [s_store_sk#58]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5]
 
 (43) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#15]
+Left keys [1]: [ss_store_sk#50]
+Right keys [1]: [s_store_sk#58]
 Join type: Inner
 Join condition: None
 
 (44) Project [codegen id : 11]
-Output [5]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [7]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, s_store_sk#15]
+Output [5]: [ss_item_sk#48, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54]
+Input [7]: [ss_item_sk#48, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, s_store_sk#58]
 
 (45) ReusedExchange [Reuses operator id: 23]
-Output [2]: [i_item_sk#17, i_item_id#18]
+Output [2]: [i_item_sk#60, i_item_id#61]
 
 (46) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#17]
+Left keys [1]: [ss_item_sk#48]
+Right keys [1]: [i_item_sk#60]
 Join type: Inner
 Join condition: None
 
 (47) Project [codegen id : 11]
-Output [5]: [i_item_id#18, ss_quantity#4 AS agg1#19, ss_list_price#5 AS agg2#20, ss_coupon_amt#7 AS agg3#21, ss_sales_price#6 AS agg4#22]
-Input [7]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, i_item_sk#17, i_item_id#18]
+Output [5]: [i_item_id#61, ss_quantity#51 AS agg1#62, ss_list_price#52 AS agg2#63, ss_coupon_amt#54 AS agg3#64, ss_sales_price#53 AS agg4#65]
+Input [7]: [ss_item_sk#48, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, i_item_sk#60, i_item_id#61]
 
 (48) HashAggregate [codegen id : 11]
-Input [5]: [i_item_id#18, agg1#19, agg2#20, agg3#21, agg4#22]
-Keys [1]: [i_item_id#18]
-Functions [4]: [partial_avg(agg1#19), partial_avg(UnscaledValue(agg2#20)), partial_avg(UnscaledValue(agg3#21)), partial_avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [8]: [sum#48, count#49, sum#50, count#51, sum#52, count#53, sum#54, count#55]
-Results [9]: [i_item_id#18, sum#56, count#57, sum#58, count#59, sum#60, count#61, sum#62, count#63]
+Input [5]: [i_item_id#61, agg1#62, agg2#63, agg3#64, agg4#65]
+Keys [1]: [i_item_id#61]
+Functions [4]: [partial_avg(agg1#62), partial_avg(UnscaledValue(agg2#63)), partial_avg(UnscaledValue(agg3#64)), partial_avg(UnscaledValue(agg4#65))]
+Aggregate Attributes [8]: [sum#66, count#67, sum#68, count#69, sum#70, count#71, sum#72, count#73]
+Results [9]: [i_item_id#61, sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
 
 (49) Exchange
-Input [9]: [i_item_id#18, sum#56, count#57, sum#58, count#59, sum#60, count#61, sum#62, count#63]
-Arguments: hashpartitioning(i_item_id#18, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [9]: [i_item_id#61, sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
+Arguments: hashpartitioning(i_item_id#61, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (50) HashAggregate [codegen id : 12]
-Input [9]: [i_item_id#18, sum#56, count#57, sum#58, count#59, sum#60, count#61, sum#62, count#63]
-Keys [1]: [i_item_id#18]
-Functions [4]: [avg(agg1#19), avg(UnscaledValue(agg2#20)), avg(UnscaledValue(agg3#21)), avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [4]: [avg(agg1#19)#64, avg(UnscaledValue(agg2#20))#65, avg(UnscaledValue(agg3#21))#66, avg(UnscaledValue(agg4#22))#67]
-Results [7]: [i_item_id#18, null AS s_state#68, 1 AS g_state#69, avg(agg1#19)#64 AS agg1#70, cast((avg(UnscaledValue(agg2#20))#65 / 100.0) as decimal(11,6)) AS agg2#71, cast((avg(UnscaledValue(agg3#21))#66 / 100.0) as decimal(11,6)) AS agg3#72, cast((avg(UnscaledValue(agg4#22))#67 / 100.0) as decimal(11,6)) AS agg4#73]
+Input [9]: [i_item_id#61, sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
+Keys [1]: [i_item_id#61]
+Functions [4]: [avg(agg1#62), avg(UnscaledValue(agg2#63)), avg(UnscaledValue(agg3#64)), avg(UnscaledValue(agg4#65))]
+Aggregate Attributes [4]: [avg(agg1#62)#82, avg(UnscaledValue(agg2#63))#83, avg(UnscaledValue(agg3#64))#84, avg(UnscaledValue(agg4#65))#85]
+Results [7]: [i_item_id#61, null AS s_state#86, 1 AS g_state#87, avg(agg1#62)#82 AS agg1#88, cast((avg(UnscaledValue(agg2#63))#83 / 100.0) as decimal(11,6)) AS agg2#89, cast((avg(UnscaledValue(agg3#64))#84 / 100.0) as decimal(11,6)) AS agg3#90, cast((avg(UnscaledValue(agg4#65))#85 / 100.0) as decimal(11,6)) AS agg4#91]
 
 (51) Scan parquet spark_catalog.default.store_sales
-Output [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Output [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#8), (ss_sold_date_sk#8 >= 2451545), (ss_sold_date_sk#8 <= 2451910), dynamicpruningexpression(ss_sold_date_sk#8 IN dynamicpruning#9)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#99), (ss_sold_date_sk#99 >= 2451545), (ss_sold_date_sk#99 <= 2451910), dynamicpruningexpression(ss_sold_date_sk#99 IN dynamicpruning#9)]
 PushedFilters: [IsNotNull(ss_cdemo_sk), IsNotNull(ss_store_sk), IsNotNull(ss_item_sk)]
 ReadSchema: struct<ss_item_sk:int,ss_cdemo_sk:int,ss_store_sk:int,ss_quantity:int,ss_list_price:decimal(7,2),ss_sales_price:decimal(7,2),ss_coupon_amt:decimal(7,2)>
 
 (52) ColumnarToRow [codegen id : 17]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Input [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
 
 (53) Filter [codegen id : 17]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Condition : ((isnotnull(ss_cdemo_sk#2) AND isnotnull(ss_store_sk#3)) AND isnotnull(ss_item_sk#1))
+Input [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
+Condition : ((isnotnull(ss_cdemo_sk#93) AND isnotnull(ss_store_sk#94)) AND isnotnull(ss_item_sk#92))
 
 (54) ReusedExchange [Reuses operator id: 8]
-Output [1]: [cd_demo_sk#10]
+Output [1]: [cd_demo_sk#100]
 
 (55) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#10]
+Left keys [1]: [ss_cdemo_sk#93]
+Right keys [1]: [cd_demo_sk#100]
 Join type: Inner
 Join condition: None
 
 (56) Project [codegen id : 17]
-Output [7]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Input [9]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, cd_demo_sk#10]
+Output [7]: [ss_item_sk#92, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
+Input [9]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99, cd_demo_sk#100]
 
 (57) ReusedExchange [Reuses operator id: 78]
-Output [1]: [d_date_sk#14]
+Output [1]: [d_date_sk#101]
 
 (58) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_sold_date_sk#8]
-Right keys [1]: [d_date_sk#14]
+Left keys [1]: [ss_sold_date_sk#99]
+Right keys [1]: [d_date_sk#101]
 Join type: Inner
 Join condition: None
 
 (59) Project [codegen id : 17]
-Output [6]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [8]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, d_date_sk#14]
+Output [6]: [ss_item_sk#92, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98]
+Input [8]: [ss_item_sk#92, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99, d_date_sk#101]
 
 (60) ReusedExchange [Reuses operator id: 42]
-Output [1]: [s_store_sk#15]
+Output [1]: [s_store_sk#102]
 
 (61) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#15]
+Left keys [1]: [ss_store_sk#94]
+Right keys [1]: [s_store_sk#102]
 Join type: Inner
 Join condition: None
 
 (62) Project [codegen id : 17]
-Output [5]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [7]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, s_store_sk#15]
+Output [5]: [ss_item_sk#92, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98]
+Input [7]: [ss_item_sk#92, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, s_store_sk#102]
 
 (63) Scan parquet spark_catalog.default.item
-Output [1]: [i_item_sk#17]
+Output [1]: [i_item_sk#103]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/item]
 PushedFilters: [IsNotNull(i_item_sk)]
 ReadSchema: struct<i_item_sk:int>
 
 (64) ColumnarToRow [codegen id : 16]
-Input [1]: [i_item_sk#17]
+Input [1]: [i_item_sk#103]
 
 (65) Filter [codegen id : 16]
-Input [1]: [i_item_sk#17]
-Condition : isnotnull(i_item_sk#17)
+Input [1]: [i_item_sk#103]
+Condition : isnotnull(i_item_sk#103)
 
 (66) BroadcastExchange
-Input [1]: [i_item_sk#17]
+Input [1]: [i_item_sk#103]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7]
 
 (67) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#17]
+Left keys [1]: [ss_item_sk#92]
+Right keys [1]: [i_item_sk#103]
 Join type: Inner
 Join condition: None
 
 (68) Project [codegen id : 17]
-Output [4]: [ss_quantity#4 AS agg1#19, ss_list_price#5 AS agg2#20, ss_coupon_amt#7 AS agg3#21, ss_sales_price#6 AS agg4#22]
-Input [6]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, i_item_sk#17]
+Output [4]: [ss_quantity#95 AS agg1#104, ss_list_price#96 AS agg2#105, ss_coupon_amt#98 AS agg3#106, ss_sales_price#97 AS agg4#107]
+Input [6]: [ss_item_sk#92, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, i_item_sk#103]
 
 (69) HashAggregate [codegen id : 17]
-Input [4]: [agg1#19, agg2#20, agg3#21, agg4#22]
+Input [4]: [agg1#104, agg2#105, agg3#106, agg4#107]
 Keys: []
-Functions [4]: [partial_avg(agg1#19), partial_avg(UnscaledValue(agg2#20)), partial_avg(UnscaledValue(agg3#21)), partial_avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [8]: [sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
-Results [8]: [sum#82, count#83, sum#84, count#85, sum#86, count#87, sum#88, count#89]
+Functions [4]: [partial_avg(agg1#104), partial_avg(UnscaledValue(agg2#105)), partial_avg(UnscaledValue(agg3#106)), partial_avg(UnscaledValue(agg4#107))]
+Aggregate Attributes [8]: [sum#108, count#109, sum#110, count#111, sum#112, count#113, sum#114, count#115]
+Results [8]: [sum#116, count#117, sum#118, count#119, sum#120, count#121, sum#122, count#123]
 
 (70) Exchange
-Input [8]: [sum#82, count#83, sum#84, count#85, sum#86, count#87, sum#88, count#89]
+Input [8]: [sum#116, count#117, sum#118, count#119, sum#120, count#121, sum#122, count#123]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=8]
 
 (71) HashAggregate [codegen id : 18]
-Input [8]: [sum#82, count#83, sum#84, count#85, sum#86, count#87, sum#88, count#89]
+Input [8]: [sum#116, count#117, sum#118, count#119, sum#120, count#121, sum#122, count#123]
 Keys: []
-Functions [4]: [avg(agg1#19), avg(UnscaledValue(agg2#20)), avg(UnscaledValue(agg3#21)), avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [4]: [avg(agg1#19)#90, avg(UnscaledValue(agg2#20))#91, avg(UnscaledValue(agg3#21))#92, avg(UnscaledValue(agg4#22))#93]
-Results [7]: [null AS i_item_id#94, null AS s_state#95, 1 AS g_state#96, avg(agg1#19)#90 AS agg1#97, cast((avg(UnscaledValue(agg2#20))#91 / 100.0) as decimal(11,6)) AS agg2#98, cast((avg(UnscaledValue(agg3#21))#92 / 100.0) as decimal(11,6)) AS agg3#99, cast((avg(UnscaledValue(agg4#22))#93 / 100.0) as decimal(11,6)) AS agg4#100]
+Functions [4]: [avg(agg1#104), avg(UnscaledValue(agg2#105)), avg(UnscaledValue(agg3#106)), avg(UnscaledValue(agg4#107))]
+Aggregate Attributes [4]: [avg(agg1#104)#124, avg(UnscaledValue(agg2#105))#125, avg(UnscaledValue(agg3#106))#126, avg(UnscaledValue(agg4#107))#127]
+Results [7]: [null AS i_item_id#128, null AS s_state#129, 1 AS g_state#130, avg(agg1#104)#124 AS agg1#131, cast((avg(UnscaledValue(agg2#105))#125 / 100.0) as decimal(11,6)) AS agg2#132, cast((avg(UnscaledValue(agg3#106))#126 / 100.0) as decimal(11,6)) AS agg3#133, cast((avg(UnscaledValue(agg4#107))#127 / 100.0) as decimal(11,6)) AS agg4#134]
 
 (72) Union
 
@@ -429,29 +429,29 @@ BroadcastExchange (78)
 
 
 (74) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#14, d_year#101]
+Output [2]: [d_date_sk#14, d_year#135]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), GreaterThanOrEqual(d_date_sk,2451545), LessThanOrEqual(d_date_sk,2451910), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (75) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#14, d_year#101]
+Input [2]: [d_date_sk#14, d_year#135]
 
 (76) Filter [codegen id : 1]
-Input [2]: [d_date_sk#14, d_year#101]
-Condition : ((((isnotnull(d_year#101) AND (d_year#101 = 2000)) AND (d_date_sk#14 >= 2451545)) AND (d_date_sk#14 <= 2451910)) AND isnotnull(d_date_sk#14))
+Input [2]: [d_date_sk#14, d_year#135]
+Condition : ((((isnotnull(d_year#135) AND (d_year#135 = 2000)) AND (d_date_sk#14 >= 2451545)) AND (d_date_sk#14 <= 2451910)) AND isnotnull(d_date_sk#14))
 
 (77) Project [codegen id : 1]
 Output [1]: [d_date_sk#14]
-Input [2]: [d_date_sk#14, d_year#101]
+Input [2]: [d_date_sk#14, d_year#135]
 
 (78) BroadcastExchange
 Input [1]: [d_date_sk#14]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=9]
 
-Subquery:2 Hosting operator id = 29 Hosting Expression = ss_sold_date_sk#8 IN dynamicpruning#9
+Subquery:2 Hosting operator id = 29 Hosting Expression = ss_sold_date_sk#55 IN dynamicpruning#9
 
-Subquery:3 Hosting operator id = 51 Hosting Expression = ss_sold_date_sk#8 IN dynamicpruning#9
+Subquery:3 Hosting operator id = 51 Hosting Expression = ss_sold_date_sk#99 IN dynamicpruning#9
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q59.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q59.sf100/explain.txt
index 5ce802dabc2..5313a1336fe 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q59.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q59.sf100/explain.txt
@@ -177,143 +177,143 @@ Output [10]: [s_store_name#39 AS s_store_name1#42, d_week_seq#5 AS d_week_seq1#4
 Input [11]: [d_week_seq#5, sun_sales#30, mon_sales#31, tue_sales#32, wed_sales#33, thu_sales#34, fri_sales#35, sat_sales#36, s_store_id#38, s_store_name#39, d_week_seq#41]
 
 (26) Scan parquet spark_catalog.default.store_sales
-Output [3]: [ss_store_sk#1, ss_sales_price#2, ss_sold_date_sk#3]
+Output [3]: [ss_store_sk#52, ss_sales_price#53, ss_sold_date_sk#54]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#3)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#54)]
 PushedFilters: [IsNotNull(ss_store_sk)]
 ReadSchema: struct<ss_store_sk:int,ss_sales_price:decimal(7,2)>
 
 (27) ColumnarToRow [codegen id : 6]
-Input [3]: [ss_store_sk#1, ss_sales_price#2, ss_sold_date_sk#3]
+Input [3]: [ss_store_sk#52, ss_sales_price#53, ss_sold_date_sk#54]
 
 (28) Filter [codegen id : 6]
-Input [3]: [ss_store_sk#1, ss_sales_price#2, ss_sold_date_sk#3]
-Condition : isnotnull(ss_store_sk#1)
+Input [3]: [ss_store_sk#52, ss_sales_price#53, ss_sold_date_sk#54]
+Condition : isnotnull(ss_store_sk#52)
 
 (29) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#4, d_week_seq#5, d_day_name#6]
+Output [3]: [d_date_sk#55, d_week_seq#56, d_day_name#57]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_date_sk), IsNotNull(d_week_seq)]
 ReadSchema: struct<d_date_sk:int,d_week_seq:int,d_day_name:string>
 
 (30) ColumnarToRow [codegen id : 5]
-Input [3]: [d_date_sk#4, d_week_seq#5, d_day_name#6]
+Input [3]: [d_date_sk#55, d_week_seq#56, d_day_name#57]
 
 (31) Filter [codegen id : 5]
-Input [3]: [d_date_sk#4, d_week_seq#5, d_day_name#6]
-Condition : ((isnotnull(d_date_sk#4) AND isnotnull(d_week_seq#5)) AND might_contain(Subquery scalar-subquery#52, [id=#53], xxhash64(d_week_seq#5, 42)))
+Input [3]: [d_date_sk#55, d_week_seq#56, d_day_name#57]
+Condition : ((isnotnull(d_date_sk#55) AND isnotnull(d_week_seq#56)) AND might_contain(Subquery scalar-subquery#58, [id=#59], xxhash64(d_week_seq#56, 42)))
 
 (32) BroadcastExchange
-Input [3]: [d_date_sk#4, d_week_seq#5, d_day_name#6]
+Input [3]: [d_date_sk#55, d_week_seq#56, d_day_name#57]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5]
 
 (33) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [ss_sold_date_sk#3]
-Right keys [1]: [d_date_sk#4]
+Left keys [1]: [ss_sold_date_sk#54]
+Right keys [1]: [d_date_sk#55]
 Join type: Inner
 Join condition: None
 
 (34) Project [codegen id : 6]
-Output [4]: [ss_store_sk#1, ss_sales_price#2, d_week_seq#5, d_day_name#6]
-Input [6]: [ss_store_sk#1, ss_sales_price#2, ss_sold_date_sk#3, d_date_sk#4, d_week_seq#5, d_day_name#6]
+Output [4]: [ss_store_sk#52, ss_sales_price#53, d_week_seq#56, d_day_name#57]
+Input [6]: [ss_store_sk#52, ss_sales_price#53, ss_sold_date_sk#54, d_date_sk#55, d_week_seq#56, d_day_name#57]
 
 (35) HashAggregate [codegen id : 6]
-Input [4]: [ss_store_sk#1, ss_sales_price#2, d_week_seq#5, d_day_name#6]
-Keys [2]: [d_week_seq#5, ss_store_sk#1]
-Functions [6]: [partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))]
-Aggregate Attributes [6]: [sum#54, sum#55, sum#56, sum#57, sum#58, sum#59]
-Results [8]: [d_week_seq#5, ss_store_sk#1, sum#60, sum#61, sum#62, sum#63, sum#64, sum#65]
+Input [4]: [ss_store_sk#52, ss_sales_price#53, d_week_seq#56, d_day_name#57]
+Keys [2]: [d_week_seq#56, ss_store_sk#52]
+Functions [6]: [partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Sunday   ) THEN ss_sales_price#53 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Monday   ) THEN ss_sales_price#53 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Wednesday) THEN ss_sales_price#53 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Thursday ) THEN ss_sales_price#53 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Friday   ) THEN ss_sales_price#53 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Saturday ) THEN ss_sales_price#53 END))]
+Aggregate Attributes [6]: [sum#60, sum#61, sum#62, sum#63, sum#64, sum#65]
+Results [8]: [d_week_seq#56, ss_store_sk#52, sum#66, sum#67, sum#68, sum#69, sum#70, sum#71]
 
 (36) Exchange
-Input [8]: [d_week_seq#5, ss_store_sk#1, sum#60, sum#61, sum#62, sum#63, sum#64, sum#65]
-Arguments: hashpartitioning(d_week_seq#5, ss_store_sk#1, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [8]: [d_week_seq#56, ss_store_sk#52, sum#66, sum#67, sum#68, sum#69, sum#70, sum#71]
+Arguments: hashpartitioning(d_week_seq#56, ss_store_sk#52, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (37) HashAggregate [codegen id : 9]
-Input [8]: [d_week_seq#5, ss_store_sk#1, sum#60, sum#61, sum#62, sum#63, sum#64, sum#65]
-Keys [2]: [d_week_seq#5, ss_store_sk#1]
-Functions [6]: [sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))]
-Aggregate Attributes [6]: [sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END))#23, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END))#24, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END))#26, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END))#27, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END))#28, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))#29]
-Results [8]: [d_week_seq#5, ss_store_sk#1, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END))#23,17,2) AS sun_sales#30, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END))#24,17,2) AS mon_sales#31, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END))#26,17,2) AS wed_sales#33, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END))#27,17,2) AS thu_sales#34, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END))#28,17,2) AS fri_sales#35, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))#29,17,2) AS sat_sales#36]
+Input [8]: [d_week_seq#56, ss_store_sk#52, sum#66, sum#67, sum#68, sum#69, sum#70, sum#71]
+Keys [2]: [d_week_seq#56, ss_store_sk#52]
+Functions [6]: [sum(UnscaledValue(CASE WHEN (d_day_name#57 = Sunday   ) THEN ss_sales_price#53 END)), sum(UnscaledValue(CASE WHEN (d_day_name#57 = Monday   ) THEN ss_sales_price#53 END)), sum(UnscaledValue(CASE WHEN (d_day_name#57 = Wednesday) THEN ss_sales_price#53 END)), sum(UnscaledValue(CASE WHEN (d_day_name#57 = Thursday ) THEN ss_sales_price#53 END)), sum(UnscaledValue(CASE WHEN (d_day_name#57 = Friday   ) THEN ss_sales_price#53 END)), sum(UnscaledValue(CASE WHEN (d_day_name#57 = Saturday ) THEN ss_sales_price#53 END))]
+Aggregate Attributes [6]: [sum(UnscaledValue(CASE WHEN (d_day_name#57 = Sunday   ) THEN ss_sales_price#53 END))#23, sum(UnscaledValue(CASE WHEN (d_day_name#57 = Monday   ) THEN ss_sales_price#53 END))#24, sum(UnscaledValue(CASE WHEN (d_day_name#57 = Wednesday) THEN ss_sales_price#53 END))#26, sum(UnscaledValue(CASE WHEN (d_day_name#57 = Thursday ) THEN ss_sales_price#53 END))#27, sum(UnscaledValue(CASE WHEN (d_day_name#57 = Friday   ) THEN ss_sales_price#53 END))#28, sum(UnscaledValue(CASE WHEN (d_day_name#57 = Saturday ) THEN ss_sales_price#53 END))#29]
+Results [8]: [d_week_seq#56, ss_store_sk#52, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Sunday   ) THEN ss_sales_price#53 END))#23,17,2) AS sun_sales#72, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Monday   ) THEN ss_sales_price#53 END))#24,17,2) AS mon_sales#73, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Wednesday) THEN ss_sales_price#53 END))#26,17,2) AS wed_sales#74, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Thursday ) THEN ss_sales_price#53 END))#27,17,2) AS thu_sales#75, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Friday   ) THEN ss_sales_price#53 END))#28,17,2) AS fri_sales#76, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Saturday ) THEN ss_sales_price#53 END))#29,17,2) AS sat_sales#77]
 
 (38) Scan parquet spark_catalog.default.store
-Output [2]: [s_store_sk#66, s_store_id#67]
+Output [2]: [s_store_sk#78, s_store_id#79]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store]
 PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_id)]
 ReadSchema: struct<s_store_sk:int,s_store_id:string>
 
 (39) ColumnarToRow [codegen id : 7]
-Input [2]: [s_store_sk#66, s_store_id#67]
+Input [2]: [s_store_sk#78, s_store_id#79]
 
 (40) Filter [codegen id : 7]
-Input [2]: [s_store_sk#66, s_store_id#67]
-Condition : (isnotnull(s_store_sk#66) AND isnotnull(s_store_id#67))
+Input [2]: [s_store_sk#78, s_store_id#79]
+Condition : (isnotnull(s_store_sk#78) AND isnotnull(s_store_id#79))
 
 (41) BroadcastExchange
-Input [2]: [s_store_sk#66, s_store_id#67]
+Input [2]: [s_store_sk#78, s_store_id#79]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7]
 
 (42) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_store_sk#1]
-Right keys [1]: [s_store_sk#66]
+Left keys [1]: [ss_store_sk#52]
+Right keys [1]: [s_store_sk#78]
 Join type: Inner
 Join condition: None
 
 (43) Project [codegen id : 9]
-Output [8]: [d_week_seq#5, sun_sales#30, mon_sales#31, wed_sales#33, thu_sales#34, fri_sales#35, sat_sales#36, s_store_id#67]
-Input [10]: [d_week_seq#5, ss_store_sk#1, sun_sales#30, mon_sales#31, wed_sales#33, thu_sales#34, fri_sales#35, sat_sales#36, s_store_sk#66, s_store_id#67]
+Output [8]: [d_week_seq#56, sun_sales#72, mon_sales#73, wed_sales#74, thu_sales#75, fri_sales#76, sat_sales#77, s_store_id#79]
+Input [10]: [d_week_seq#56, ss_store_sk#52, sun_sales#72, mon_sales#73, wed_sales#74, thu_sales#75, fri_sales#76, sat_sales#77, s_store_sk#78, s_store_id#79]
 
 (44) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_month_seq#68, d_week_seq#69]
+Output [2]: [d_month_seq#80, d_week_seq#81]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1197), LessThanOrEqual(d_month_seq,1208), IsNotNull(d_week_seq)]
 ReadSchema: struct<d_month_seq:int,d_week_seq:int>
 
 (45) ColumnarToRow [codegen id : 8]
-Input [2]: [d_month_seq#68, d_week_seq#69]
+Input [2]: [d_month_seq#80, d_week_seq#81]
 
 (46) Filter [codegen id : 8]
-Input [2]: [d_month_seq#68, d_week_seq#69]
-Condition : (((isnotnull(d_month_seq#68) AND (d_month_seq#68 >= 1197)) AND (d_month_seq#68 <= 1208)) AND isnotnull(d_week_seq#69))
+Input [2]: [d_month_seq#80, d_week_seq#81]
+Condition : (((isnotnull(d_month_seq#80) AND (d_month_seq#80 >= 1197)) AND (d_month_seq#80 <= 1208)) AND isnotnull(d_week_seq#81))
 
 (47) Project [codegen id : 8]
-Output [1]: [d_week_seq#69]
-Input [2]: [d_month_seq#68, d_week_seq#69]
+Output [1]: [d_week_seq#81]
+Input [2]: [d_month_seq#80, d_week_seq#81]
 
 (48) BroadcastExchange
-Input [1]: [d_week_seq#69]
+Input [1]: [d_week_seq#81]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=8]
 
 (49) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [d_week_seq#5]
-Right keys [1]: [d_week_seq#69]
+Left keys [1]: [d_week_seq#56]
+Right keys [1]: [d_week_seq#81]
 Join type: Inner
 Join condition: None
 
 (50) Project [codegen id : 9]
-Output [8]: [d_week_seq#5 AS d_week_seq2#70, s_store_id#67 AS s_store_id2#71, sun_sales#30 AS sun_sales2#72, mon_sales#31 AS mon_sales2#73, wed_sales#33 AS wed_sales2#74, thu_sales#34 AS thu_sales2#75, fri_sales#35 AS fri_sales2#76, sat_sales#36 AS sat_sales2#77]
-Input [9]: [d_week_seq#5, sun_sales#30, mon_sales#31, wed_sales#33, thu_sales#34, fri_sales#35, sat_sales#36, s_store_id#67, d_week_seq#69]
+Output [8]: [d_week_seq#56 AS d_week_seq2#82, s_store_id#79 AS s_store_id2#83, sun_sales#72 AS sun_sales2#84, mon_sales#73 AS mon_sales2#85, wed_sales#74 AS wed_sales2#86, thu_sales#75 AS thu_sales2#87, fri_sales#76 AS fri_sales2#88, sat_sales#77 AS sat_sales2#89]
+Input [9]: [d_week_seq#56, sun_sales#72, mon_sales#73, wed_sales#74, thu_sales#75, fri_sales#76, sat_sales#77, s_store_id#79, d_week_seq#81]
 
 (51) BroadcastExchange
-Input [8]: [d_week_seq2#70, s_store_id2#71, sun_sales2#72, mon_sales2#73, wed_sales2#74, thu_sales2#75, fri_sales2#76, sat_sales2#77]
+Input [8]: [d_week_seq2#82, s_store_id2#83, sun_sales2#84, mon_sales2#85, wed_sales2#86, thu_sales2#87, fri_sales2#88, sat_sales2#89]
 Arguments: HashedRelationBroadcastMode(List(input[1, string, true], (input[0, int, true] - 52)),false), [plan_id=9]
 
 (52) BroadcastHashJoin [codegen id : 10]
 Left keys [2]: [s_store_id1#44, d_week_seq1#43]
-Right keys [2]: [s_store_id2#71, (d_week_seq2#70 - 52)]
+Right keys [2]: [s_store_id2#83, (d_week_seq2#82 - 52)]
 Join type: Inner
 Join condition: None
 
 (53) Project [codegen id : 10]
-Output [10]: [s_store_name1#42, s_store_id1#44, d_week_seq1#43, (sun_sales1#45 / sun_sales2#72) AS (sun_sales1 / sun_sales2)#78, (mon_sales1#46 / mon_sales2#73) AS (mon_sales1 / mon_sales2)#79, (tue_sales1#47 / tue_sales1#47) AS (tue_sales1 / tue_sales1)#80, (wed_sales1#48 / wed_sales2#74) AS (wed_sales1 / wed_sales2)#81, (thu_sales1#49 / thu_sales2#75) AS (thu_sales1 / thu_sales2)#82, (fri_sales1#50 / fri_sales2#76) AS (fri_sales1 / fri_sales2)#83, (sat_sales1#51 / sat_sales2#77) AS (sat_sales1 / sat_sales2)#84]
-Input [18]: [s_store_name1#42, d_week_seq1#43, s_store_id1#44, sun_sales1#45, mon_sales1#46, tue_sales1#47, wed_sales1#48, thu_sales1#49, fri_sales1#50, sat_sales1#51, d_week_seq2#70, s_store_id2#71, sun_sales2#72, mon_sales2#73, wed_sales2#74, thu_sales2#75, fri_sales2#76, sat_sales2#77]
+Output [10]: [s_store_name1#42, s_store_id1#44, d_week_seq1#43, (sun_sales1#45 / sun_sales2#84) AS (sun_sales1 / sun_sales2)#90, (mon_sales1#46 / mon_sales2#85) AS (mon_sales1 / mon_sales2)#91, (tue_sales1#47 / tue_sales1#47) AS (tue_sales1 / tue_sales1)#92, (wed_sales1#48 / wed_sales2#86) AS (wed_sales1 / wed_sales2)#93, (thu_sales1#49 / thu_sales2#87) AS (thu_sales1 / thu_sales2)#94, (fri_sales1#50 / fri_sales2#88) AS (fri_sales1 / fri_sales2)#95, (sat_sales1#51 / sat_sales2#89) AS (sat_sales1 / sat_sales2)#96]
+Input [18]: [s_store_name1#42, d_week_seq1#43, s_store_id1#44, sun_sales1#45, mon_sales1#46, tue_sales1#47, wed_sales1#48, thu_sales1#49, fri_sales1#50, sat_sales1#51, d_week_seq2#82, s_store_id2#83, sun_sales2#84, mon_sales2#85, wed_sales2#86, thu_sales2#87, fri_sales2#88, sat_sales2#89]
 
 (54) TakeOrderedAndProject
-Input [10]: [s_store_name1#42, s_store_id1#44, d_week_seq1#43, (sun_sales1 / sun_sales2)#78, (mon_sales1 / mon_sales2)#79, (tue_sales1 / tue_sales1)#80, (wed_sales1 / wed_sales2)#81, (thu_sales1 / thu_sales2)#82, (fri_sales1 / fri_sales2)#83, (sat_sales1 / sat_sales2)#84]
-Arguments: 100, [s_store_name1#42 ASC NULLS FIRST, s_store_id1#44 ASC NULLS FIRST, d_week_seq1#43 ASC NULLS FIRST], [s_store_name1#42, s_store_id1#44, d_week_seq1#43, (sun_sales1 / sun_sales2)#78, (mon_sales1 / mon_sales2)#79, (tue_sales1 / tue_sales1)#80, (wed_sales1 / wed_sales2)#81, (thu_sales1 / thu_sales2)#82, (fri_sales1 / fri_sales2)#83, (sat_sales1 / sat_sales2)#84]
+Input [10]: [s_store_name1#42, s_store_id1#44, d_week_seq1#43, (sun_sales1 / sun_sales2)#90, (mon_sales1 / mon_sales2)#91, (tue_sales1 / tue_sales1)#92, (wed_sales1 / wed_sales2)#93, (thu_sales1 / thu_sales2)#94, (fri_sales1 / fri_sales2)#95, (sat_sales1 / sat_sales2)#96]
+Arguments: 100, [s_store_name1#42 ASC NULLS FIRST, s_store_id1#44 ASC NULLS FIRST, d_week_seq1#43 ASC NULLS FIRST], [s_store_name1#42, s_store_id1#44, d_week_seq1#43, (sun_sales1 / sun_sales2)#90, (mon_sales1 / mon_sales2)#91, (tue_sales1 / tue_sales1)#92, (wed_sales1 / wed_sales2)#93, (thu_sales1 / thu_sales2)#94, (fri_sales1 / fri_sales2)#95, (sat_sales1 / sat_sales2)#96]
 
 ===== Subqueries =====
 
@@ -349,21 +349,21 @@ Input [2]: [d_month_seq#40, d_week_seq#41]
 Input [1]: [d_week_seq#41]
 Keys: []
 Functions [1]: [partial_bloom_filter_agg(xxhash64(d_week_seq#41, 42), 335, 8990, 0, 0)]
-Aggregate Attributes [1]: [buf#85]
-Results [1]: [buf#86]
+Aggregate Attributes [1]: [buf#97]
+Results [1]: [buf#98]
 
 (60) Exchange
-Input [1]: [buf#86]
+Input [1]: [buf#98]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=10]
 
 (61) ObjectHashAggregate
-Input [1]: [buf#86]
+Input [1]: [buf#98]
 Keys: []
 Functions [1]: [bloom_filter_agg(xxhash64(d_week_seq#41, 42), 335, 8990, 0, 0)]
-Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_week_seq#41, 42), 335, 8990, 0, 0)#87]
-Results [1]: [bloom_filter_agg(xxhash64(d_week_seq#41, 42), 335, 8990, 0, 0)#87 AS bloomFilter#88]
+Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_week_seq#41, 42), 335, 8990, 0, 0)#99]
+Results [1]: [bloom_filter_agg(xxhash64(d_week_seq#41, 42), 335, 8990, 0, 0)#99 AS bloomFilter#100]
 
-Subquery:2 Hosting operator id = 31 Hosting Expression = Subquery scalar-subquery#52, [id=#53]
+Subquery:2 Hosting operator id = 31 Hosting Expression = Subquery scalar-subquery#58, [id=#59]
 ObjectHashAggregate (68)
 +- Exchange (67)
    +- ObjectHashAggregate (66)
@@ -374,39 +374,39 @@ ObjectHashAggregate (68)
 
 
 (62) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_month_seq#68, d_week_seq#69]
+Output [2]: [d_month_seq#80, d_week_seq#81]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1197), LessThanOrEqual(d_month_seq,1208), IsNotNull(d_week_seq)]
 ReadSchema: struct<d_month_seq:int,d_week_seq:int>
 
 (63) ColumnarToRow [codegen id : 1]
-Input [2]: [d_month_seq#68, d_week_seq#69]
+Input [2]: [d_month_seq#80, d_week_seq#81]
 
 (64) Filter [codegen id : 1]
-Input [2]: [d_month_seq#68, d_week_seq#69]
-Condition : (((isnotnull(d_month_seq#68) AND (d_month_seq#68 >= 1197)) AND (d_month_seq#68 <= 1208)) AND isnotnull(d_week_seq#69))
+Input [2]: [d_month_seq#80, d_week_seq#81]
+Condition : (((isnotnull(d_month_seq#80) AND (d_month_seq#80 >= 1197)) AND (d_month_seq#80 <= 1208)) AND isnotnull(d_week_seq#81))
 
 (65) Project [codegen id : 1]
-Output [1]: [d_week_seq#69]
-Input [2]: [d_month_seq#68, d_week_seq#69]
+Output [1]: [d_week_seq#81]
+Input [2]: [d_month_seq#80, d_week_seq#81]
 
 (66) ObjectHashAggregate
-Input [1]: [d_week_seq#69]
+Input [1]: [d_week_seq#81]
 Keys: []
-Functions [1]: [partial_bloom_filter_agg(xxhash64(d_week_seq#69, 42), 335, 8990, 0, 0)]
-Aggregate Attributes [1]: [buf#89]
-Results [1]: [buf#90]
+Functions [1]: [partial_bloom_filter_agg(xxhash64(d_week_seq#81, 42), 335, 8990, 0, 0)]
+Aggregate Attributes [1]: [buf#101]
+Results [1]: [buf#102]
 
 (67) Exchange
-Input [1]: [buf#90]
+Input [1]: [buf#102]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=11]
 
 (68) ObjectHashAggregate
-Input [1]: [buf#90]
+Input [1]: [buf#102]
 Keys: []
-Functions [1]: [bloom_filter_agg(xxhash64(d_week_seq#69, 42), 335, 8990, 0, 0)]
-Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_week_seq#69, 42), 335, 8990, 0, 0)#91]
-Results [1]: [bloom_filter_agg(xxhash64(d_week_seq#69, 42), 335, 8990, 0, 0)#91 AS bloomFilter#92]
+Functions [1]: [bloom_filter_agg(xxhash64(d_week_seq#81, 42), 335, 8990, 0, 0)]
+Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_week_seq#81, 42), 335, 8990, 0, 0)#103]
+Results [1]: [bloom_filter_agg(xxhash64(d_week_seq#81, 42), 335, 8990, 0, 0)#103 AS bloomFilter#104]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q59/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q59/explain.txt
index 26da082db27..52f3d74328a 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q59/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-modified/q59/explain.txt
@@ -174,126 +174,126 @@ Output [10]: [s_store_name#37 AS s_store_name1#40, d_week_seq#5 AS d_week_seq1#4
 Input [11]: [d_week_seq#5, sun_sales#28, mon_sales#29, tue_sales#30, wed_sales#31, thu_sales#32, fri_sales#33, sat_sales#34, s_store_id#36, s_store_name#37, d_week_seq#39]
 
 (26) Scan parquet spark_catalog.default.store_sales
-Output [3]: [ss_store_sk#1, ss_sales_price#2, ss_sold_date_sk#3]
+Output [3]: [ss_store_sk#50, ss_sales_price#51, ss_sold_date_sk#52]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#3)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#52)]
 PushedFilters: [IsNotNull(ss_store_sk)]
 ReadSchema: struct<ss_store_sk:int,ss_sales_price:decimal(7,2)>
 
 (27) ColumnarToRow [codegen id : 6]
-Input [3]: [ss_store_sk#1, ss_sales_price#2, ss_sold_date_sk#3]
+Input [3]: [ss_store_sk#50, ss_sales_price#51, ss_sold_date_sk#52]
 
 (28) Filter [codegen id : 6]
-Input [3]: [ss_store_sk#1, ss_sales_price#2, ss_sold_date_sk#3]
-Condition : isnotnull(ss_store_sk#1)
+Input [3]: [ss_store_sk#50, ss_sales_price#51, ss_sold_date_sk#52]
+Condition : isnotnull(ss_store_sk#50)
 
 (29) ReusedExchange [Reuses operator id: 7]
-Output [3]: [d_date_sk#4, d_week_seq#5, d_day_name#6]
+Output [3]: [d_date_sk#53, d_week_seq#54, d_day_name#55]
 
 (30) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [ss_sold_date_sk#3]
-Right keys [1]: [d_date_sk#4]
+Left keys [1]: [ss_sold_date_sk#52]
+Right keys [1]: [d_date_sk#53]
 Join type: Inner
 Join condition: None
 
 (31) Project [codegen id : 6]
-Output [4]: [ss_store_sk#1, ss_sales_price#2, d_week_seq#5, d_day_name#6]
-Input [6]: [ss_store_sk#1, ss_sales_price#2, ss_sold_date_sk#3, d_date_sk#4, d_week_seq#5, d_day_name#6]
+Output [4]: [ss_store_sk#50, ss_sales_price#51, d_week_seq#54, d_day_name#55]
+Input [6]: [ss_store_sk#50, ss_sales_price#51, ss_sold_date_sk#52, d_date_sk#53, d_week_seq#54, d_day_name#55]
 
 (32) HashAggregate [codegen id : 6]
-Input [4]: [ss_store_sk#1, ss_sales_price#2, d_week_seq#5, d_day_name#6]
-Keys [2]: [d_week_seq#5, ss_store_sk#1]
-Functions [6]: [partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))]
-Aggregate Attributes [6]: [sum#50, sum#51, sum#52, sum#53, sum#54, sum#55]
-Results [8]: [d_week_seq#5, ss_store_sk#1, sum#56, sum#57, sum#58, sum#59, sum#60, sum#61]
+Input [4]: [ss_store_sk#50, ss_sales_price#51, d_week_seq#54, d_day_name#55]
+Keys [2]: [d_week_seq#54, ss_store_sk#50]
+Functions [6]: [partial_sum(UnscaledValue(CASE WHEN (d_day_name#55 = Sunday   ) THEN ss_sales_price#51 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#55 = Monday   ) THEN ss_sales_price#51 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#55 = Wednesday) THEN ss_sales_price#51 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#55 = Thursday ) THEN ss_sales_price#51 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#55 = Friday   ) THEN ss_sales_price#51 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#55 = Saturday ) THEN ss_sales_price#51 END))]
+Aggregate Attributes [6]: [sum#56, sum#57, sum#58, sum#59, sum#60, sum#61]
+Results [8]: [d_week_seq#54, ss_store_sk#50, sum#62, sum#63, sum#64, sum#65, sum#66, sum#67]
 
 (33) Exchange
-Input [8]: [d_week_seq#5, ss_store_sk#1, sum#56, sum#57, sum#58, sum#59, sum#60, sum#61]
-Arguments: hashpartitioning(d_week_seq#5, ss_store_sk#1, 5), ENSURE_REQUIREMENTS, [plan_id=5]
+Input [8]: [d_week_seq#54, ss_store_sk#50, sum#62, sum#63, sum#64, sum#65, sum#66, sum#67]
+Arguments: hashpartitioning(d_week_seq#54, ss_store_sk#50, 5), ENSURE_REQUIREMENTS, [plan_id=5]
 
 (34) HashAggregate [codegen id : 9]
-Input [8]: [d_week_seq#5, ss_store_sk#1, sum#56, sum#57, sum#58, sum#59, sum#60, sum#61]
-Keys [2]: [d_week_seq#5, ss_store_sk#1]
-Functions [6]: [sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))]
-Aggregate Attributes [6]: [sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END))#21, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END))#22, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END))#24, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END))#25, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END))#26, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))#27]
-Results [8]: [d_week_seq#5, ss_store_sk#1, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END))#21,17,2) AS sun_sales#28, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END))#22,17,2) AS mon_sales#29, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END))#24,17,2) AS wed_sales#31, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END))#25,17,2) AS thu_sales#32, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END))#26,17,2) AS fri_sales#33, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))#27,17,2) AS sat_sales#34]
+Input [8]: [d_week_seq#54, ss_store_sk#50, sum#62, sum#63, sum#64, sum#65, sum#66, sum#67]
+Keys [2]: [d_week_seq#54, ss_store_sk#50]
+Functions [6]: [sum(UnscaledValue(CASE WHEN (d_day_name#55 = Sunday   ) THEN ss_sales_price#51 END)), sum(UnscaledValue(CASE WHEN (d_day_name#55 = Monday   ) THEN ss_sales_price#51 END)), sum(UnscaledValue(CASE WHEN (d_day_name#55 = Wednesday) THEN ss_sales_price#51 END)), sum(UnscaledValue(CASE WHEN (d_day_name#55 = Thursday ) THEN ss_sales_price#51 END)), sum(UnscaledValue(CASE WHEN (d_day_name#55 = Friday   ) THEN ss_sales_price#51 END)), sum(UnscaledValue(CASE WHEN (d_day_name#55 = Saturday ) THEN ss_sales_price#51 END))]
+Aggregate Attributes [6]: [sum(UnscaledValue(CASE WHEN (d_day_name#55 = Sunday   ) THEN ss_sales_price#51 END))#21, sum(UnscaledValue(CASE WHEN (d_day_name#55 = Monday   ) THEN ss_sales_price#51 END))#22, sum(UnscaledValue(CASE WHEN (d_day_name#55 = Wednesday) THEN ss_sales_price#51 END))#24, sum(UnscaledValue(CASE WHEN (d_day_name#55 = Thursday ) THEN ss_sales_price#51 END))#25, sum(UnscaledValue(CASE WHEN (d_day_name#55 = Friday   ) THEN ss_sales_price#51 END))#26, sum(UnscaledValue(CASE WHEN (d_day_name#55 = Saturday ) THEN ss_sales_price#51 END))#27]
+Results [8]: [d_week_seq#54, ss_store_sk#50, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#55 = Sunday   ) THEN ss_sales_price#51 END))#21,17,2) AS sun_sales#68, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#55 = Monday   ) THEN ss_sales_price#51 END))#22,17,2) AS mon_sales#69, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#55 = Wednesday) THEN ss_sales_price#51 END))#24,17,2) AS wed_sales#70, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#55 = Thursday ) THEN ss_sales_price#51 END))#25,17,2) AS thu_sales#71, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#55 = Friday   ) THEN ss_sales_price#51 END))#26,17,2) AS fri_sales#72, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#55 = Saturday ) THEN ss_sales_price#51 END))#27,17,2) AS sat_sales#73]
 
 (35) Scan parquet spark_catalog.default.store
-Output [2]: [s_store_sk#62, s_store_id#63]
+Output [2]: [s_store_sk#74, s_store_id#75]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store]
 PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_id)]
 ReadSchema: struct<s_store_sk:int,s_store_id:string>
 
 (36) ColumnarToRow [codegen id : 7]
-Input [2]: [s_store_sk#62, s_store_id#63]
+Input [2]: [s_store_sk#74, s_store_id#75]
 
 (37) Filter [codegen id : 7]
-Input [2]: [s_store_sk#62, s_store_id#63]
-Condition : (isnotnull(s_store_sk#62) AND isnotnull(s_store_id#63))
+Input [2]: [s_store_sk#74, s_store_id#75]
+Condition : (isnotnull(s_store_sk#74) AND isnotnull(s_store_id#75))
 
 (38) BroadcastExchange
-Input [2]: [s_store_sk#62, s_store_id#63]
+Input [2]: [s_store_sk#74, s_store_id#75]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=6]
 
 (39) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_store_sk#1]
-Right keys [1]: [s_store_sk#62]
+Left keys [1]: [ss_store_sk#50]
+Right keys [1]: [s_store_sk#74]
 Join type: Inner
 Join condition: None
 
 (40) Project [codegen id : 9]
-Output [8]: [d_week_seq#5, sun_sales#28, mon_sales#29, wed_sales#31, thu_sales#32, fri_sales#33, sat_sales#34, s_store_id#63]
-Input [10]: [d_week_seq#5, ss_store_sk#1, sun_sales#28, mon_sales#29, wed_sales#31, thu_sales#32, fri_sales#33, sat_sales#34, s_store_sk#62, s_store_id#63]
+Output [8]: [d_week_seq#54, sun_sales#68, mon_sales#69, wed_sales#70, thu_sales#71, fri_sales#72, sat_sales#73, s_store_id#75]
+Input [10]: [d_week_seq#54, ss_store_sk#50, sun_sales#68, mon_sales#69, wed_sales#70, thu_sales#71, fri_sales#72, sat_sales#73, s_store_sk#74, s_store_id#75]
 
 (41) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_month_seq#64, d_week_seq#65]
+Output [2]: [d_month_seq#76, d_week_seq#77]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1197), LessThanOrEqual(d_month_seq,1208), IsNotNull(d_week_seq)]
 ReadSchema: struct<d_month_seq:int,d_week_seq:int>
 
 (42) ColumnarToRow [codegen id : 8]
-Input [2]: [d_month_seq#64, d_week_seq#65]
+Input [2]: [d_month_seq#76, d_week_seq#77]
 
 (43) Filter [codegen id : 8]
-Input [2]: [d_month_seq#64, d_week_seq#65]
-Condition : (((isnotnull(d_month_seq#64) AND (d_month_seq#64 >= 1197)) AND (d_month_seq#64 <= 1208)) AND isnotnull(d_week_seq#65))
+Input [2]: [d_month_seq#76, d_week_seq#77]
+Condition : (((isnotnull(d_month_seq#76) AND (d_month_seq#76 >= 1197)) AND (d_month_seq#76 <= 1208)) AND isnotnull(d_week_seq#77))
 
 (44) Project [codegen id : 8]
-Output [1]: [d_week_seq#65]
-Input [2]: [d_month_seq#64, d_week_seq#65]
+Output [1]: [d_week_seq#77]
+Input [2]: [d_month_seq#76, d_week_seq#77]
 
 (45) BroadcastExchange
-Input [1]: [d_week_seq#65]
+Input [1]: [d_week_seq#77]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=7]
 
 (46) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [d_week_seq#5]
-Right keys [1]: [d_week_seq#65]
+Left keys [1]: [d_week_seq#54]
+Right keys [1]: [d_week_seq#77]
 Join type: Inner
 Join condition: None
 
 (47) Project [codegen id : 9]
-Output [8]: [d_week_seq#5 AS d_week_seq2#66, s_store_id#63 AS s_store_id2#67, sun_sales#28 AS sun_sales2#68, mon_sales#29 AS mon_sales2#69, wed_sales#31 AS wed_sales2#70, thu_sales#32 AS thu_sales2#71, fri_sales#33 AS fri_sales2#72, sat_sales#34 AS sat_sales2#73]
-Input [9]: [d_week_seq#5, sun_sales#28, mon_sales#29, wed_sales#31, thu_sales#32, fri_sales#33, sat_sales#34, s_store_id#63, d_week_seq#65]
+Output [8]: [d_week_seq#54 AS d_week_seq2#78, s_store_id#75 AS s_store_id2#79, sun_sales#68 AS sun_sales2#80, mon_sales#69 AS mon_sales2#81, wed_sales#70 AS wed_sales2#82, thu_sales#71 AS thu_sales2#83, fri_sales#72 AS fri_sales2#84, sat_sales#73 AS sat_sales2#85]
+Input [9]: [d_week_seq#54, sun_sales#68, mon_sales#69, wed_sales#70, thu_sales#71, fri_sales#72, sat_sales#73, s_store_id#75, d_week_seq#77]
 
 (48) BroadcastExchange
-Input [8]: [d_week_seq2#66, s_store_id2#67, sun_sales2#68, mon_sales2#69, wed_sales2#70, thu_sales2#71, fri_sales2#72, sat_sales2#73]
+Input [8]: [d_week_seq2#78, s_store_id2#79, sun_sales2#80, mon_sales2#81, wed_sales2#82, thu_sales2#83, fri_sales2#84, sat_sales2#85]
 Arguments: HashedRelationBroadcastMode(List(input[1, string, true], (input[0, int, true] - 52)),false), [plan_id=8]
 
 (49) BroadcastHashJoin [codegen id : 10]
 Left keys [2]: [s_store_id1#42, d_week_seq1#41]
-Right keys [2]: [s_store_id2#67, (d_week_seq2#66 - 52)]
+Right keys [2]: [s_store_id2#79, (d_week_seq2#78 - 52)]
 Join type: Inner
 Join condition: None
 
 (50) Project [codegen id : 10]
-Output [10]: [s_store_name1#40, s_store_id1#42, d_week_seq1#41, (sun_sales1#43 / sun_sales2#68) AS (sun_sales1 / sun_sales2)#74, (mon_sales1#44 / mon_sales2#69) AS (mon_sales1 / mon_sales2)#75, (tue_sales1#45 / tue_sales1#45) AS (tue_sales1 / tue_sales1)#76, (wed_sales1#46 / wed_sales2#70) AS (wed_sales1 / wed_sales2)#77, (thu_sales1#47 / thu_sales2#71) AS (thu_sales1 / thu_sales2)#78, (fri_sales1#48 / fri_sales2#72) AS (fri_sales1 / fri_sales2)#79, (sat_sales1#49 / sat_sales2#73) AS (sat_sales1 / sat_sales2)#80]
-Input [18]: [s_store_name1#40, d_week_seq1#41, s_store_id1#42, sun_sales1#43, mon_sales1#44, tue_sales1#45, wed_sales1#46, thu_sales1#47, fri_sales1#48, sat_sales1#49, d_week_seq2#66, s_store_id2#67, sun_sales2#68, mon_sales2#69, wed_sales2#70, thu_sales2#71, fri_sales2#72, sat_sales2#73]
+Output [10]: [s_store_name1#40, s_store_id1#42, d_week_seq1#41, (sun_sales1#43 / sun_sales2#80) AS (sun_sales1 / sun_sales2)#86, (mon_sales1#44 / mon_sales2#81) AS (mon_sales1 / mon_sales2)#87, (tue_sales1#45 / tue_sales1#45) AS (tue_sales1 / tue_sales1)#88, (wed_sales1#46 / wed_sales2#82) AS (wed_sales1 / wed_sales2)#89, (thu_sales1#47 / thu_sales2#83) AS (thu_sales1 / thu_sales2)#90, (fri_sales1#48 / fri_sales2#84) AS (fri_sales1 / fri_sales2)#91, (sat_sales1#49 / sat_sales2#85) AS (sat_sales1 / sat_sales2)#92]
+Input [18]: [s_store_name1#40, d_week_seq1#41, s_store_id1#42, sun_sales1#43, mon_sales1#44, tue_sales1#45, wed_sales1#46, thu_sales1#47, fri_sales1#48, sat_sales1#49, d_week_seq2#78, s_store_id2#79, sun_sales2#80, mon_sales2#81, wed_sales2#82, thu_sales2#83, fri_sales2#84, sat_sales2#85]
 
 (51) TakeOrderedAndProject
-Input [10]: [s_store_name1#40, s_store_id1#42, d_week_seq1#41, (sun_sales1 / sun_sales2)#74, (mon_sales1 / mon_sales2)#75, (tue_sales1 / tue_sales1)#76, (wed_sales1 / wed_sales2)#77, (thu_sales1 / thu_sales2)#78, (fri_sales1 / fri_sales2)#79, (sat_sales1 / sat_sales2)#80]
-Arguments: 100, [s_store_name1#40 ASC NULLS FIRST, s_store_id1#42 ASC NULLS FIRST, d_week_seq1#41 ASC NULLS FIRST], [s_store_name1#40, s_store_id1#42, d_week_seq1#41, (sun_sales1 / sun_sales2)#74, (mon_sales1 / mon_sales2)#75, (tue_sales1 / tue_sales1)#76, (wed_sales1 / wed_sales2)#77, (thu_sales1 / thu_sales2)#78, (fri_sales1 / fri_sales2)#79, (sat_sales1 / sat_sales2)#80]
+Input [10]: [s_store_name1#40, s_store_id1#42, d_week_seq1#41, (sun_sales1 / sun_sales2)#86, (mon_sales1 / mon_sales2)#87, (tue_sales1 / tue_sales1)#88, (wed_sales1 / wed_sales2)#89, (thu_sales1 / thu_sales2)#90, (fri_sales1 / fri_sales2)#91, (sat_sales1 / sat_sales2)#92]
+Arguments: 100, [s_store_name1#40 ASC NULLS FIRST, s_store_id1#42 ASC NULLS FIRST, d_week_seq1#41 ASC NULLS FIRST], [s_store_name1#40, s_store_id1#42, d_week_seq1#41, (sun_sales1 / sun_sales2)#86, (mon_sales1 / mon_sales2)#87, (tue_sales1 / tue_sales1)#88, (wed_sales1 / wed_sales2)#89, (thu_sales1 / thu_sales2)#90, (fri_sales1 / fri_sales2)#91, (sat_sales1 / sat_sales2)#92]
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1.sf100/explain.txt
index 85e8b1da976..24c55e39a97 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1.sf100/explain.txt
@@ -95,118 +95,118 @@ Input [3]: [ctr_customer_sk#10, ctr_store_sk#11, ctr_total_return#12]
 Condition : isnotnull(ctr_total_return#12)
 
 (11) Scan parquet spark_catalog.default.store_returns
-Output [4]: [sr_customer_sk#1, sr_store_sk#2, sr_return_amt#3, sr_returned_date_sk#4]
+Output [4]: [sr_customer_sk#13, sr_store_sk#14, sr_return_amt#15, sr_returned_date_sk#16]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(sr_returned_date_sk#4), dynamicpruningexpression(sr_returned_date_sk#4 IN dynamicpruning#5)]
+PartitionFilters: [isnotnull(sr_returned_date_sk#16), dynamicpruningexpression(sr_returned_date_sk#16 IN dynamicpruning#5)]
 PushedFilters: [IsNotNull(sr_store_sk)]
 ReadSchema: struct<sr_customer_sk:int,sr_store_sk:int,sr_return_amt:decimal(7,2)>
 
 (12) ColumnarToRow [codegen id : 4]
-Input [4]: [sr_customer_sk#1, sr_store_sk#2, sr_return_amt#3, sr_returned_date_sk#4]
+Input [4]: [sr_customer_sk#13, sr_store_sk#14, sr_return_amt#15, sr_returned_date_sk#16]
 
 (13) Filter [codegen id : 4]
-Input [4]: [sr_customer_sk#1, sr_store_sk#2, sr_return_amt#3, sr_returned_date_sk#4]
-Condition : isnotnull(sr_store_sk#2)
+Input [4]: [sr_customer_sk#13, sr_store_sk#14, sr_return_amt#15, sr_returned_date_sk#16]
+Condition : isnotnull(sr_store_sk#14)
 
 (14) ReusedExchange [Reuses operator id: 48]
-Output [1]: [d_date_sk#6]
+Output [1]: [d_date_sk#17]
 
 (15) BroadcastHashJoin [codegen id : 4]
-Left keys [1]: [sr_returned_date_sk#4]
-Right keys [1]: [d_date_sk#6]
+Left keys [1]: [sr_returned_date_sk#16]
+Right keys [1]: [d_date_sk#17]
 Join type: Inner
 Join condition: None
 
 (16) Project [codegen id : 4]
-Output [3]: [sr_customer_sk#1, sr_store_sk#2, sr_return_amt#3]
-Input [5]: [sr_customer_sk#1, sr_store_sk#2, sr_return_amt#3, sr_returned_date_sk#4, d_date_sk#6]
+Output [3]: [sr_customer_sk#13, sr_store_sk#14, sr_return_amt#15]
+Input [5]: [sr_customer_sk#13, sr_store_sk#14, sr_return_amt#15, sr_returned_date_sk#16, d_date_sk#17]
 
 (17) HashAggregate [codegen id : 4]
-Input [3]: [sr_customer_sk#1, sr_store_sk#2, sr_return_amt#3]
-Keys [2]: [sr_customer_sk#1, sr_store_sk#2]
-Functions [1]: [partial_sum(UnscaledValue(sr_return_amt#3))]
-Aggregate Attributes [1]: [sum#13]
-Results [3]: [sr_customer_sk#1, sr_store_sk#2, sum#14]
+Input [3]: [sr_customer_sk#13, sr_store_sk#14, sr_return_amt#15]
+Keys [2]: [sr_customer_sk#13, sr_store_sk#14]
+Functions [1]: [partial_sum(UnscaledValue(sr_return_amt#15))]
+Aggregate Attributes [1]: [sum#18]
+Results [3]: [sr_customer_sk#13, sr_store_sk#14, sum#19]
 
 (18) Exchange
-Input [3]: [sr_customer_sk#1, sr_store_sk#2, sum#14]
-Arguments: hashpartitioning(sr_customer_sk#1, sr_store_sk#2, 5), ENSURE_REQUIREMENTS, [plan_id=2]
+Input [3]: [sr_customer_sk#13, sr_store_sk#14, sum#19]
+Arguments: hashpartitioning(sr_customer_sk#13, sr_store_sk#14, 5), ENSURE_REQUIREMENTS, [plan_id=2]
 
 (19) HashAggregate [codegen id : 5]
-Input [3]: [sr_customer_sk#1, sr_store_sk#2, sum#14]
-Keys [2]: [sr_customer_sk#1, sr_store_sk#2]
-Functions [1]: [sum(UnscaledValue(sr_return_amt#3))]
-Aggregate Attributes [1]: [sum(UnscaledValue(sr_return_amt#3))#9]
-Results [2]: [sr_store_sk#2 AS ctr_store_sk#11, MakeDecimal(sum(UnscaledValue(sr_return_amt#3))#9,17,2) AS ctr_total_return#12]
+Input [3]: [sr_customer_sk#13, sr_store_sk#14, sum#19]
+Keys [2]: [sr_customer_sk#13, sr_store_sk#14]
+Functions [1]: [sum(UnscaledValue(sr_return_amt#15))]
+Aggregate Attributes [1]: [sum(UnscaledValue(sr_return_amt#15))#9]
+Results [2]: [sr_store_sk#14 AS ctr_store_sk#20, MakeDecimal(sum(UnscaledValue(sr_return_amt#15))#9,17,2) AS ctr_total_return#21]
 
 (20) HashAggregate [codegen id : 5]
-Input [2]: [ctr_store_sk#11, ctr_total_return#12]
-Keys [1]: [ctr_store_sk#11]
-Functions [1]: [partial_avg(ctr_total_return#12)]
-Aggregate Attributes [2]: [sum#15, count#16]
-Results [3]: [ctr_store_sk#11, sum#17, count#18]
+Input [2]: [ctr_store_sk#20, ctr_total_return#21]
+Keys [1]: [ctr_store_sk#20]
+Functions [1]: [partial_avg(ctr_total_return#21)]
+Aggregate Attributes [2]: [sum#22, count#23]
+Results [3]: [ctr_store_sk#20, sum#24, count#25]
 
 (21) Exchange
-Input [3]: [ctr_store_sk#11, sum#17, count#18]
-Arguments: hashpartitioning(ctr_store_sk#11, 5), ENSURE_REQUIREMENTS, [plan_id=3]
+Input [3]: [ctr_store_sk#20, sum#24, count#25]
+Arguments: hashpartitioning(ctr_store_sk#20, 5), ENSURE_REQUIREMENTS, [plan_id=3]
 
 (22) HashAggregate [codegen id : 6]
-Input [3]: [ctr_store_sk#11, sum#17, count#18]
-Keys [1]: [ctr_store_sk#11]
-Functions [1]: [avg(ctr_total_return#12)]
-Aggregate Attributes [1]: [avg(ctr_total_return#12)#19]
-Results [2]: [(avg(ctr_total_return#12)#19 * 1.2) AS (avg(ctr_total_return) * 1.2)#20, ctr_store_sk#11 AS ctr_store_sk#11#21]
+Input [3]: [ctr_store_sk#20, sum#24, count#25]
+Keys [1]: [ctr_store_sk#20]
+Functions [1]: [avg(ctr_total_return#21)]
+Aggregate Attributes [1]: [avg(ctr_total_return#21)#26]
+Results [2]: [(avg(ctr_total_return#21)#26 * 1.2) AS (avg(ctr_total_return) * 1.2)#27, ctr_store_sk#20]
 
 (23) Filter [codegen id : 6]
-Input [2]: [(avg(ctr_total_return) * 1.2)#20, ctr_store_sk#11#21]
-Condition : isnotnull((avg(ctr_total_return) * 1.2)#20)
+Input [2]: [(avg(ctr_total_return) * 1.2)#27, ctr_store_sk#20]
+Condition : isnotnull((avg(ctr_total_return) * 1.2)#27)
 
 (24) BroadcastExchange
-Input [2]: [(avg(ctr_total_return) * 1.2)#20, ctr_store_sk#11#21]
+Input [2]: [(avg(ctr_total_return) * 1.2)#27, ctr_store_sk#20]
 Arguments: HashedRelationBroadcastMode(List(cast(input[1, int, true] as bigint)),false), [plan_id=4]
 
 (25) BroadcastHashJoin [codegen id : 8]
 Left keys [1]: [ctr_store_sk#11]
-Right keys [1]: [ctr_store_sk#11#21]
+Right keys [1]: [ctr_store_sk#20]
 Join type: Inner
-Join condition: (cast(ctr_total_return#12 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#20)
+Join condition: (cast(ctr_total_return#12 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#27)
 
 (26) Project [codegen id : 8]
 Output [2]: [ctr_customer_sk#10, ctr_store_sk#11]
-Input [5]: [ctr_customer_sk#10, ctr_store_sk#11, ctr_total_return#12, (avg(ctr_total_return) * 1.2)#20, ctr_store_sk#11#21]
+Input [5]: [ctr_customer_sk#10, ctr_store_sk#11, ctr_total_return#12, (avg(ctr_total_return) * 1.2)#27, ctr_store_sk#20]
 
 (27) Scan parquet spark_catalog.default.store
-Output [2]: [s_store_sk#22, s_state#23]
+Output [2]: [s_store_sk#28, s_state#29]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store]
 PushedFilters: [IsNotNull(s_state), EqualTo(s_state,TN), IsNotNull(s_store_sk)]
 ReadSchema: struct<s_store_sk:int,s_state:string>
 
 (28) ColumnarToRow [codegen id : 7]
-Input [2]: [s_store_sk#22, s_state#23]
+Input [2]: [s_store_sk#28, s_state#29]
 
 (29) Filter [codegen id : 7]
-Input [2]: [s_store_sk#22, s_state#23]
-Condition : ((isnotnull(s_state#23) AND (s_state#23 = TN)) AND isnotnull(s_store_sk#22))
+Input [2]: [s_store_sk#28, s_state#29]
+Condition : ((isnotnull(s_state#29) AND (s_state#29 = TN)) AND isnotnull(s_store_sk#28))
 
 (30) Project [codegen id : 7]
-Output [1]: [s_store_sk#22]
-Input [2]: [s_store_sk#22, s_state#23]
+Output [1]: [s_store_sk#28]
+Input [2]: [s_store_sk#28, s_state#29]
 
 (31) BroadcastExchange
-Input [1]: [s_store_sk#22]
+Input [1]: [s_store_sk#28]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5]
 
 (32) BroadcastHashJoin [codegen id : 8]
 Left keys [1]: [ctr_store_sk#11]
-Right keys [1]: [s_store_sk#22]
+Right keys [1]: [s_store_sk#28]
 Join type: Inner
 Join condition: None
 
 (33) Project [codegen id : 8]
 Output [1]: [ctr_customer_sk#10]
-Input [3]: [ctr_customer_sk#10, ctr_store_sk#11, s_store_sk#22]
+Input [3]: [ctr_customer_sk#10, ctr_store_sk#11, s_store_sk#28]
 
 (34) Exchange
 Input [1]: [ctr_customer_sk#10]
@@ -217,40 +217,40 @@ Input [1]: [ctr_customer_sk#10]
 Arguments: [ctr_customer_sk#10 ASC NULLS FIRST], false, 0
 
 (36) Scan parquet spark_catalog.default.customer
-Output [2]: [c_customer_sk#24, c_customer_id#25]
+Output [2]: [c_customer_sk#30, c_customer_id#31]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer]
 PushedFilters: [IsNotNull(c_customer_sk)]
 ReadSchema: struct<c_customer_sk:int,c_customer_id:string>
 
 (37) ColumnarToRow [codegen id : 10]
-Input [2]: [c_customer_sk#24, c_customer_id#25]
+Input [2]: [c_customer_sk#30, c_customer_id#31]
 
 (38) Filter [codegen id : 10]
-Input [2]: [c_customer_sk#24, c_customer_id#25]
-Condition : isnotnull(c_customer_sk#24)
+Input [2]: [c_customer_sk#30, c_customer_id#31]
+Condition : isnotnull(c_customer_sk#30)
 
 (39) Exchange
-Input [2]: [c_customer_sk#24, c_customer_id#25]
-Arguments: hashpartitioning(c_customer_sk#24, 5), ENSURE_REQUIREMENTS, [plan_id=7]
+Input [2]: [c_customer_sk#30, c_customer_id#31]
+Arguments: hashpartitioning(c_customer_sk#30, 5), ENSURE_REQUIREMENTS, [plan_id=7]
 
 (40) Sort [codegen id : 11]
-Input [2]: [c_customer_sk#24, c_customer_id#25]
-Arguments: [c_customer_sk#24 ASC NULLS FIRST], false, 0
+Input [2]: [c_customer_sk#30, c_customer_id#31]
+Arguments: [c_customer_sk#30 ASC NULLS FIRST], false, 0
 
 (41) SortMergeJoin [codegen id : 12]
 Left keys [1]: [ctr_customer_sk#10]
-Right keys [1]: [c_customer_sk#24]
+Right keys [1]: [c_customer_sk#30]
 Join type: Inner
 Join condition: None
 
 (42) Project [codegen id : 12]
-Output [1]: [c_customer_id#25]
-Input [3]: [ctr_customer_sk#10, c_customer_sk#24, c_customer_id#25]
+Output [1]: [c_customer_id#31]
+Input [3]: [ctr_customer_sk#10, c_customer_sk#30, c_customer_id#31]
 
 (43) TakeOrderedAndProject
-Input [1]: [c_customer_id#25]
-Arguments: 100, [c_customer_id#25 ASC NULLS FIRST], [c_customer_id#25]
+Input [1]: [c_customer_id#31]
+Arguments: 100, [c_customer_id#31 ASC NULLS FIRST], [c_customer_id#31]
 
 ===== Subqueries =====
 
@@ -263,27 +263,27 @@ BroadcastExchange (48)
 
 
 (44) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#6, d_year#26]
+Output [2]: [d_date_sk#6, d_year#32]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (45) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#6, d_year#26]
+Input [2]: [d_date_sk#6, d_year#32]
 
 (46) Filter [codegen id : 1]
-Input [2]: [d_date_sk#6, d_year#26]
-Condition : ((isnotnull(d_year#26) AND (d_year#26 = 2000)) AND isnotnull(d_date_sk#6))
+Input [2]: [d_date_sk#6, d_year#32]
+Condition : ((isnotnull(d_year#32) AND (d_year#32 = 2000)) AND isnotnull(d_date_sk#6))
 
 (47) Project [codegen id : 1]
 Output [1]: [d_date_sk#6]
-Input [2]: [d_date_sk#6, d_year#26]
+Input [2]: [d_date_sk#6, d_year#32]
 
 (48) BroadcastExchange
 Input [1]: [d_date_sk#6]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=8]
 
-Subquery:2 Hosting operator id = 11 Hosting Expression = sr_returned_date_sk#4 IN dynamicpruning#5
+Subquery:2 Hosting operator id = 11 Hosting Expression = sr_returned_date_sk#16 IN dynamicpruning#5
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1.sf100/simplified.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1.sf100/simplified.txt
index 264eadc569d..ccc543414c8 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1.sf100/simplified.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1.sf100/simplified.txt
@@ -38,7 +38,7 @@ TakeOrderedAndProject [c_customer_id]
                               BroadcastExchange #4
                                 WholeStageCodegen (6)
                                   Filter [(avg(ctr_total_return) * 1.2)]
-                                    HashAggregate [ctr_store_sk,sum,count] [avg(ctr_total_return),(avg(ctr_total_return) * 1.2),ctr_store_sk,sum,count]
+                                    HashAggregate [ctr_store_sk,sum,count] [avg(ctr_total_return),(avg(ctr_total_return) * 1.2),sum,count]
                                       InputAdapter
                                         Exchange [ctr_store_sk] #5
                                           WholeStageCodegen (5)
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1/explain.txt
index 4faa292eddb..564d3388db6 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1/explain.txt
@@ -92,150 +92,150 @@ Input [3]: [ctr_customer_sk#10, ctr_store_sk#11, ctr_total_return#12]
 Condition : isnotnull(ctr_total_return#12)
 
 (11) Scan parquet spark_catalog.default.store_returns
-Output [4]: [sr_customer_sk#1, sr_store_sk#2, sr_return_amt#3, sr_returned_date_sk#4]
+Output [4]: [sr_customer_sk#13, sr_store_sk#14, sr_return_amt#15, sr_returned_date_sk#16]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(sr_returned_date_sk#4), dynamicpruningexpression(sr_returned_date_sk#4 IN dynamicpruning#5)]
+PartitionFilters: [isnotnull(sr_returned_date_sk#16), dynamicpruningexpression(sr_returned_date_sk#16 IN dynamicpruning#5)]
 PushedFilters: [IsNotNull(sr_store_sk)]
 ReadSchema: struct<sr_customer_sk:int,sr_store_sk:int,sr_return_amt:decimal(7,2)>
 
 (12) ColumnarToRow [codegen id : 4]
-Input [4]: [sr_customer_sk#1, sr_store_sk#2, sr_return_amt#3, sr_returned_date_sk#4]
+Input [4]: [sr_customer_sk#13, sr_store_sk#14, sr_return_amt#15, sr_returned_date_sk#16]
 
 (13) Filter [codegen id : 4]
-Input [4]: [sr_customer_sk#1, sr_store_sk#2, sr_return_amt#3, sr_returned_date_sk#4]
-Condition : isnotnull(sr_store_sk#2)
+Input [4]: [sr_customer_sk#13, sr_store_sk#14, sr_return_amt#15, sr_returned_date_sk#16]
+Condition : isnotnull(sr_store_sk#14)
 
 (14) ReusedExchange [Reuses operator id: 45]
-Output [1]: [d_date_sk#6]
+Output [1]: [d_date_sk#17]
 
 (15) BroadcastHashJoin [codegen id : 4]
-Left keys [1]: [sr_returned_date_sk#4]
-Right keys [1]: [d_date_sk#6]
+Left keys [1]: [sr_returned_date_sk#16]
+Right keys [1]: [d_date_sk#17]
 Join type: Inner
 Join condition: None
 
 (16) Project [codegen id : 4]
-Output [3]: [sr_customer_sk#1, sr_store_sk#2, sr_return_amt#3]
-Input [5]: [sr_customer_sk#1, sr_store_sk#2, sr_return_amt#3, sr_returned_date_sk#4, d_date_sk#6]
+Output [3]: [sr_customer_sk#13, sr_store_sk#14, sr_return_amt#15]
+Input [5]: [sr_customer_sk#13, sr_store_sk#14, sr_return_amt#15, sr_returned_date_sk#16, d_date_sk#17]
 
 (17) HashAggregate [codegen id : 4]
-Input [3]: [sr_customer_sk#1, sr_store_sk#2, sr_return_amt#3]
-Keys [2]: [sr_customer_sk#1, sr_store_sk#2]
-Functions [1]: [partial_sum(UnscaledValue(sr_return_amt#3))]
-Aggregate Attributes [1]: [sum#13]
-Results [3]: [sr_customer_sk#1, sr_store_sk#2, sum#14]
+Input [3]: [sr_customer_sk#13, sr_store_sk#14, sr_return_amt#15]
+Keys [2]: [sr_customer_sk#13, sr_store_sk#14]
+Functions [1]: [partial_sum(UnscaledValue(sr_return_amt#15))]
+Aggregate Attributes [1]: [sum#18]
+Results [3]: [sr_customer_sk#13, sr_store_sk#14, sum#19]
 
 (18) Exchange
-Input [3]: [sr_customer_sk#1, sr_store_sk#2, sum#14]
-Arguments: hashpartitioning(sr_customer_sk#1, sr_store_sk#2, 5), ENSURE_REQUIREMENTS, [plan_id=2]
+Input [3]: [sr_customer_sk#13, sr_store_sk#14, sum#19]
+Arguments: hashpartitioning(sr_customer_sk#13, sr_store_sk#14, 5), ENSURE_REQUIREMENTS, [plan_id=2]
 
 (19) HashAggregate [codegen id : 5]
-Input [3]: [sr_customer_sk#1, sr_store_sk#2, sum#14]
-Keys [2]: [sr_customer_sk#1, sr_store_sk#2]
-Functions [1]: [sum(UnscaledValue(sr_return_amt#3))]
-Aggregate Attributes [1]: [sum(UnscaledValue(sr_return_amt#3))#9]
-Results [2]: [sr_store_sk#2 AS ctr_store_sk#11, MakeDecimal(sum(UnscaledValue(sr_return_amt#3))#9,17,2) AS ctr_total_return#12]
+Input [3]: [sr_customer_sk#13, sr_store_sk#14, sum#19]
+Keys [2]: [sr_customer_sk#13, sr_store_sk#14]
+Functions [1]: [sum(UnscaledValue(sr_return_amt#15))]
+Aggregate Attributes [1]: [sum(UnscaledValue(sr_return_amt#15))#9]
+Results [2]: [sr_store_sk#14 AS ctr_store_sk#20, MakeDecimal(sum(UnscaledValue(sr_return_amt#15))#9,17,2) AS ctr_total_return#21]
 
 (20) HashAggregate [codegen id : 5]
-Input [2]: [ctr_store_sk#11, ctr_total_return#12]
-Keys [1]: [ctr_store_sk#11]
-Functions [1]: [partial_avg(ctr_total_return#12)]
-Aggregate Attributes [2]: [sum#15, count#16]
-Results [3]: [ctr_store_sk#11, sum#17, count#18]
+Input [2]: [ctr_store_sk#20, ctr_total_return#21]
+Keys [1]: [ctr_store_sk#20]
+Functions [1]: [partial_avg(ctr_total_return#21)]
+Aggregate Attributes [2]: [sum#22, count#23]
+Results [3]: [ctr_store_sk#20, sum#24, count#25]
 
 (21) Exchange
-Input [3]: [ctr_store_sk#11, sum#17, count#18]
-Arguments: hashpartitioning(ctr_store_sk#11, 5), ENSURE_REQUIREMENTS, [plan_id=3]
+Input [3]: [ctr_store_sk#20, sum#24, count#25]
+Arguments: hashpartitioning(ctr_store_sk#20, 5), ENSURE_REQUIREMENTS, [plan_id=3]
 
 (22) HashAggregate [codegen id : 6]
-Input [3]: [ctr_store_sk#11, sum#17, count#18]
-Keys [1]: [ctr_store_sk#11]
-Functions [1]: [avg(ctr_total_return#12)]
-Aggregate Attributes [1]: [avg(ctr_total_return#12)#19]
-Results [2]: [(avg(ctr_total_return#12)#19 * 1.2) AS (avg(ctr_total_return) * 1.2)#20, ctr_store_sk#11 AS ctr_store_sk#11#21]
+Input [3]: [ctr_store_sk#20, sum#24, count#25]
+Keys [1]: [ctr_store_sk#20]
+Functions [1]: [avg(ctr_total_return#21)]
+Aggregate Attributes [1]: [avg(ctr_total_return#21)#26]
+Results [2]: [(avg(ctr_total_return#21)#26 * 1.2) AS (avg(ctr_total_return) * 1.2)#27, ctr_store_sk#20]
 
 (23) Filter [codegen id : 6]
-Input [2]: [(avg(ctr_total_return) * 1.2)#20, ctr_store_sk#11#21]
-Condition : isnotnull((avg(ctr_total_return) * 1.2)#20)
+Input [2]: [(avg(ctr_total_return) * 1.2)#27, ctr_store_sk#20]
+Condition : isnotnull((avg(ctr_total_return) * 1.2)#27)
 
 (24) BroadcastExchange
-Input [2]: [(avg(ctr_total_return) * 1.2)#20, ctr_store_sk#11#21]
+Input [2]: [(avg(ctr_total_return) * 1.2)#27, ctr_store_sk#20]
 Arguments: HashedRelationBroadcastMode(List(cast(input[1, int, true] as bigint)),false), [plan_id=4]
 
 (25) BroadcastHashJoin [codegen id : 9]
 Left keys [1]: [ctr_store_sk#11]
-Right keys [1]: [ctr_store_sk#11#21]
+Right keys [1]: [ctr_store_sk#20]
 Join type: Inner
-Join condition: (cast(ctr_total_return#12 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#20)
+Join condition: (cast(ctr_total_return#12 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#27)
 
 (26) Project [codegen id : 9]
 Output [2]: [ctr_customer_sk#10, ctr_store_sk#11]
-Input [5]: [ctr_customer_sk#10, ctr_store_sk#11, ctr_total_return#12, (avg(ctr_total_return) * 1.2)#20, ctr_store_sk#11#21]
+Input [5]: [ctr_customer_sk#10, ctr_store_sk#11, ctr_total_return#12, (avg(ctr_total_return) * 1.2)#27, ctr_store_sk#20]
 
 (27) Scan parquet spark_catalog.default.store
-Output [2]: [s_store_sk#22, s_state#23]
+Output [2]: [s_store_sk#28, s_state#29]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store]
 PushedFilters: [IsNotNull(s_state), EqualTo(s_state,TN), IsNotNull(s_store_sk)]
 ReadSchema: struct<s_store_sk:int,s_state:string>
 
 (28) ColumnarToRow [codegen id : 7]
-Input [2]: [s_store_sk#22, s_state#23]
+Input [2]: [s_store_sk#28, s_state#29]
 
 (29) Filter [codegen id : 7]
-Input [2]: [s_store_sk#22, s_state#23]
-Condition : ((isnotnull(s_state#23) AND (s_state#23 = TN)) AND isnotnull(s_store_sk#22))
+Input [2]: [s_store_sk#28, s_state#29]
+Condition : ((isnotnull(s_state#29) AND (s_state#29 = TN)) AND isnotnull(s_store_sk#28))
 
 (30) Project [codegen id : 7]
-Output [1]: [s_store_sk#22]
-Input [2]: [s_store_sk#22, s_state#23]
+Output [1]: [s_store_sk#28]
+Input [2]: [s_store_sk#28, s_state#29]
 
 (31) BroadcastExchange
-Input [1]: [s_store_sk#22]
+Input [1]: [s_store_sk#28]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5]
 
 (32) BroadcastHashJoin [codegen id : 9]
 Left keys [1]: [ctr_store_sk#11]
-Right keys [1]: [s_store_sk#22]
+Right keys [1]: [s_store_sk#28]
 Join type: Inner
 Join condition: None
 
 (33) Project [codegen id : 9]
 Output [1]: [ctr_customer_sk#10]
-Input [3]: [ctr_customer_sk#10, ctr_store_sk#11, s_store_sk#22]
+Input [3]: [ctr_customer_sk#10, ctr_store_sk#11, s_store_sk#28]
 
 (34) Scan parquet spark_catalog.default.customer
-Output [2]: [c_customer_sk#24, c_customer_id#25]
+Output [2]: [c_customer_sk#30, c_customer_id#31]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer]
 PushedFilters: [IsNotNull(c_customer_sk)]
 ReadSchema: struct<c_customer_sk:int,c_customer_id:string>
 
 (35) ColumnarToRow [codegen id : 8]
-Input [2]: [c_customer_sk#24, c_customer_id#25]
+Input [2]: [c_customer_sk#30, c_customer_id#31]
 
 (36) Filter [codegen id : 8]
-Input [2]: [c_customer_sk#24, c_customer_id#25]
-Condition : isnotnull(c_customer_sk#24)
+Input [2]: [c_customer_sk#30, c_customer_id#31]
+Condition : isnotnull(c_customer_sk#30)
 
 (37) BroadcastExchange
-Input [2]: [c_customer_sk#24, c_customer_id#25]
+Input [2]: [c_customer_sk#30, c_customer_id#31]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=6]
 
 (38) BroadcastHashJoin [codegen id : 9]
 Left keys [1]: [ctr_customer_sk#10]
-Right keys [1]: [c_customer_sk#24]
+Right keys [1]: [c_customer_sk#30]
 Join type: Inner
 Join condition: None
 
 (39) Project [codegen id : 9]
-Output [1]: [c_customer_id#25]
-Input [3]: [ctr_customer_sk#10, c_customer_sk#24, c_customer_id#25]
+Output [1]: [c_customer_id#31]
+Input [3]: [ctr_customer_sk#10, c_customer_sk#30, c_customer_id#31]
 
 (40) TakeOrderedAndProject
-Input [1]: [c_customer_id#25]
-Arguments: 100, [c_customer_id#25 ASC NULLS FIRST], [c_customer_id#25]
+Input [1]: [c_customer_id#31]
+Arguments: 100, [c_customer_id#31 ASC NULLS FIRST], [c_customer_id#31]
 
 ===== Subqueries =====
 
@@ -248,27 +248,27 @@ BroadcastExchange (45)
 
 
 (41) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#6, d_year#26]
+Output [2]: [d_date_sk#6, d_year#32]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (42) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#6, d_year#26]
+Input [2]: [d_date_sk#6, d_year#32]
 
 (43) Filter [codegen id : 1]
-Input [2]: [d_date_sk#6, d_year#26]
-Condition : ((isnotnull(d_year#26) AND (d_year#26 = 2000)) AND isnotnull(d_date_sk#6))
+Input [2]: [d_date_sk#6, d_year#32]
+Condition : ((isnotnull(d_year#32) AND (d_year#32 = 2000)) AND isnotnull(d_date_sk#6))
 
 (44) Project [codegen id : 1]
 Output [1]: [d_date_sk#6]
-Input [2]: [d_date_sk#6, d_year#26]
+Input [2]: [d_date_sk#6, d_year#32]
 
 (45) BroadcastExchange
 Input [1]: [d_date_sk#6]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=7]
 
-Subquery:2 Hosting operator id = 11 Hosting Expression = sr_returned_date_sk#4 IN dynamicpruning#5
+Subquery:2 Hosting operator id = 11 Hosting Expression = sr_returned_date_sk#16 IN dynamicpruning#5
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1/simplified.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1/simplified.txt
index d904b503829..9957e8318b1 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1/simplified.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q1/simplified.txt
@@ -32,7 +32,7 @@ TakeOrderedAndProject [c_customer_id]
                   BroadcastExchange #3
                     WholeStageCodegen (6)
                       Filter [(avg(ctr_total_return) * 1.2)]
-                        HashAggregate [ctr_store_sk,sum,count] [avg(ctr_total_return),(avg(ctr_total_return) * 1.2),ctr_store_sk,sum,count]
+                        HashAggregate [ctr_store_sk,sum,count] [avg(ctr_total_return),(avg(ctr_total_return) * 1.2),sum,count]
                           InputAdapter
                             Exchange [ctr_store_sk] #4
                               WholeStageCodegen (5)
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14a.sf100/explain.txt
index e350459c60c..8a53d4f895d 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14a.sf100/explain.txt
@@ -472,169 +472,169 @@ Input [4]: [cs_item_sk#57, cs_quantity#58, cs_list_price#59, cs_sold_date_sk#60]
 Condition : isnotnull(cs_item_sk#57)
 
 (77) ReusedExchange [Reuses operator id: 56]
-Output [1]: [ss_item_sk#35]
+Output [1]: [ss_item_sk#61]
 
 (78) BroadcastHashJoin [codegen id : 75]
 Left keys [1]: [cs_item_sk#57]
-Right keys [1]: [ss_item_sk#35]
+Right keys [1]: [ss_item_sk#61]
 Join type: LeftSemi
 Join condition: None
 
 (79) ReusedExchange [Reuses operator id: 135]
-Output [1]: [d_date_sk#61]
+Output [1]: [d_date_sk#62]
 
 (80) BroadcastHashJoin [codegen id : 75]
 Left keys [1]: [cs_sold_date_sk#60]
-Right keys [1]: [d_date_sk#61]
+Right keys [1]: [d_date_sk#62]
 Join type: Inner
 Join condition: None
 
 (81) Project [codegen id : 75]
 Output [3]: [cs_item_sk#57, cs_quantity#58, cs_list_price#59]
-Input [5]: [cs_item_sk#57, cs_quantity#58, cs_list_price#59, cs_sold_date_sk#60, d_date_sk#61]
+Input [5]: [cs_item_sk#57, cs_quantity#58, cs_list_price#59, cs_sold_date_sk#60, d_date_sk#62]
 
 (82) ReusedExchange [Reuses operator id: 66]
-Output [4]: [i_item_sk#62, i_brand_id#63, i_class_id#64, i_category_id#65]
+Output [4]: [i_item_sk#63, i_brand_id#64, i_class_id#65, i_category_id#66]
 
 (83) BroadcastHashJoin [codegen id : 75]
 Left keys [1]: [cs_item_sk#57]
-Right keys [1]: [i_item_sk#62]
+Right keys [1]: [i_item_sk#63]
 Join type: Inner
 Join condition: None
 
 (84) Project [codegen id : 75]
-Output [5]: [cs_quantity#58, cs_list_price#59, i_brand_id#63, i_class_id#64, i_category_id#65]
-Input [7]: [cs_item_sk#57, cs_quantity#58, cs_list_price#59, i_item_sk#62, i_brand_id#63, i_class_id#64, i_category_id#65]
+Output [5]: [cs_quantity#58, cs_list_price#59, i_brand_id#64, i_class_id#65, i_category_id#66]
+Input [7]: [cs_item_sk#57, cs_quantity#58, cs_list_price#59, i_item_sk#63, i_brand_id#64, i_class_id#65, i_category_id#66]
 
 (85) HashAggregate [codegen id : 75]
-Input [5]: [cs_quantity#58, cs_list_price#59, i_brand_id#63, i_class_id#64, i_category_id#65]
-Keys [3]: [i_brand_id#63, i_class_id#64, i_category_id#65]
+Input [5]: [cs_quantity#58, cs_list_price#59, i_brand_id#64, i_class_id#65, i_category_id#66]
+Keys [3]: [i_brand_id#64, i_class_id#65, i_category_id#66]
 Functions [2]: [partial_sum((cast(cs_quantity#58 as decimal(10,0)) * cs_list_price#59)), partial_count(1)]
-Aggregate Attributes [3]: [sum#66, isEmpty#67, count#68]
-Results [6]: [i_brand_id#63, i_class_id#64, i_category_id#65, sum#69, isEmpty#70, count#71]
+Aggregate Attributes [3]: [sum#67, isEmpty#68, count#69]
+Results [6]: [i_brand_id#64, i_class_id#65, i_category_id#66, sum#70, isEmpty#71, count#72]
 
 (86) Exchange
-Input [6]: [i_brand_id#63, i_class_id#64, i_category_id#65, sum#69, isEmpty#70, count#71]
-Arguments: hashpartitioning(i_brand_id#63, i_class_id#64, i_category_id#65, 5), ENSURE_REQUIREMENTS, [plan_id=12]
+Input [6]: [i_brand_id#64, i_class_id#65, i_category_id#66, sum#70, isEmpty#71, count#72]
+Arguments: hashpartitioning(i_brand_id#64, i_class_id#65, i_category_id#66, 5), ENSURE_REQUIREMENTS, [plan_id=12]
 
 (87) HashAggregate [codegen id : 76]
-Input [6]: [i_brand_id#63, i_class_id#64, i_category_id#65, sum#69, isEmpty#70, count#71]
-Keys [3]: [i_brand_id#63, i_class_id#64, i_category_id#65]
+Input [6]: [i_brand_id#64, i_class_id#65, i_category_id#66, sum#70, isEmpty#71, count#72]
+Keys [3]: [i_brand_id#64, i_class_id#65, i_category_id#66]
 Functions [2]: [sum((cast(cs_quantity#58 as decimal(10,0)) * cs_list_price#59)), count(1)]
-Aggregate Attributes [2]: [sum((cast(cs_quantity#58 as decimal(10,0)) * cs_list_price#59))#72, count(1)#73]
-Results [5]: [i_brand_id#63, i_class_id#64, i_category_id#65, sum((cast(cs_quantity#58 as decimal(10,0)) * cs_list_price#59))#72 AS sales#74, count(1)#73 AS number_sales#75]
+Aggregate Attributes [2]: [sum((cast(cs_quantity#58 as decimal(10,0)) * cs_list_price#59))#73, count(1)#74]
+Results [5]: [i_brand_id#64, i_class_id#65, i_category_id#66, sum((cast(cs_quantity#58 as decimal(10,0)) * cs_list_price#59))#73 AS sales#75, count(1)#74 AS number_sales#76]
 
 (88) Filter [codegen id : 76]
-Input [5]: [i_brand_id#63, i_class_id#64, i_category_id#65, sales#74, number_sales#75]
-Condition : (isnotnull(sales#74) AND (cast(sales#74 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#51, [id=#52] as decimal(32,6))))
+Input [5]: [i_brand_id#64, i_class_id#65, i_category_id#66, sales#75, number_sales#76]
+Condition : (isnotnull(sales#75) AND (cast(sales#75 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#51, [id=#52] as decimal(32,6))))
 
 (89) Project [codegen id : 76]
-Output [6]: [sales#74, number_sales#75, catalog AS channel#76, i_brand_id#63, i_class_id#64, i_category_id#65]
-Input [5]: [i_brand_id#63, i_class_id#64, i_category_id#65, sales#74, number_sales#75]
+Output [6]: [sales#75, number_sales#76, catalog AS channel#77, i_brand_id#64, i_class_id#65, i_category_id#66]
+Input [5]: [i_brand_id#64, i_class_id#65, i_category_id#66, sales#75, number_sales#76]
 
 (90) Scan parquet spark_catalog.default.web_sales
-Output [4]: [ws_item_sk#77, ws_quantity#78, ws_list_price#79, ws_sold_date_sk#80]
+Output [4]: [ws_item_sk#78, ws_quantity#79, ws_list_price#80, ws_sold_date_sk#81]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#80), dynamicpruningexpression(ws_sold_date_sk#80 IN dynamicpruning#5)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#81), dynamicpruningexpression(ws_sold_date_sk#81 IN dynamicpruning#5)]
 PushedFilters: [IsNotNull(ws_item_sk)]
 ReadSchema: struct<ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
 
 (91) ColumnarToRow [codegen id : 113]
-Input [4]: [ws_item_sk#77, ws_quantity#78, ws_list_price#79, ws_sold_date_sk#80]
+Input [4]: [ws_item_sk#78, ws_quantity#79, ws_list_price#80, ws_sold_date_sk#81]
 
 (92) Filter [codegen id : 113]
-Input [4]: [ws_item_sk#77, ws_quantity#78, ws_list_price#79, ws_sold_date_sk#80]
-Condition : isnotnull(ws_item_sk#77)
+Input [4]: [ws_item_sk#78, ws_quantity#79, ws_list_price#80, ws_sold_date_sk#81]
+Condition : isnotnull(ws_item_sk#78)
 
 (93) ReusedExchange [Reuses operator id: 56]
-Output [1]: [ss_item_sk#35]
+Output [1]: [ss_item_sk#82]
 
 (94) BroadcastHashJoin [codegen id : 113]
-Left keys [1]: [ws_item_sk#77]
-Right keys [1]: [ss_item_sk#35]
+Left keys [1]: [ws_item_sk#78]
+Right keys [1]: [ss_item_sk#82]
 Join type: LeftSemi
 Join condition: None
 
 (95) ReusedExchange [Reuses operator id: 135]
-Output [1]: [d_date_sk#81]
+Output [1]: [d_date_sk#83]
 
 (96) BroadcastHashJoin [codegen id : 113]
-Left keys [1]: [ws_sold_date_sk#80]
-Right keys [1]: [d_date_sk#81]
+Left keys [1]: [ws_sold_date_sk#81]
+Right keys [1]: [d_date_sk#83]
 Join type: Inner
 Join condition: None
 
 (97) Project [codegen id : 113]
-Output [3]: [ws_item_sk#77, ws_quantity#78, ws_list_price#79]
-Input [5]: [ws_item_sk#77, ws_quantity#78, ws_list_price#79, ws_sold_date_sk#80, d_date_sk#81]
+Output [3]: [ws_item_sk#78, ws_quantity#79, ws_list_price#80]
+Input [5]: [ws_item_sk#78, ws_quantity#79, ws_list_price#80, ws_sold_date_sk#81, d_date_sk#83]
 
 (98) ReusedExchange [Reuses operator id: 66]
-Output [4]: [i_item_sk#82, i_brand_id#83, i_class_id#84, i_category_id#85]
+Output [4]: [i_item_sk#84, i_brand_id#85, i_class_id#86, i_category_id#87]
 
 (99) BroadcastHashJoin [codegen id : 113]
-Left keys [1]: [ws_item_sk#77]
-Right keys [1]: [i_item_sk#82]
+Left keys [1]: [ws_item_sk#78]
+Right keys [1]: [i_item_sk#84]
 Join type: Inner
 Join condition: None
 
 (100) Project [codegen id : 113]
-Output [5]: [ws_quantity#78, ws_list_price#79, i_brand_id#83, i_class_id#84, i_category_id#85]
-Input [7]: [ws_item_sk#77, ws_quantity#78, ws_list_price#79, i_item_sk#82, i_brand_id#83, i_class_id#84, i_category_id#85]
+Output [5]: [ws_quantity#79, ws_list_price#80, i_brand_id#85, i_class_id#86, i_category_id#87]
+Input [7]: [ws_item_sk#78, ws_quantity#79, ws_list_price#80, i_item_sk#84, i_brand_id#85, i_class_id#86, i_category_id#87]
 
 (101) HashAggregate [codegen id : 113]
-Input [5]: [ws_quantity#78, ws_list_price#79, i_brand_id#83, i_class_id#84, i_category_id#85]
-Keys [3]: [i_brand_id#83, i_class_id#84, i_category_id#85]
-Functions [2]: [partial_sum((cast(ws_quantity#78 as decimal(10,0)) * ws_list_price#79)), partial_count(1)]
-Aggregate Attributes [3]: [sum#86, isEmpty#87, count#88]
-Results [6]: [i_brand_id#83, i_class_id#84, i_category_id#85, sum#89, isEmpty#90, count#91]
+Input [5]: [ws_quantity#79, ws_list_price#80, i_brand_id#85, i_class_id#86, i_category_id#87]
+Keys [3]: [i_brand_id#85, i_class_id#86, i_category_id#87]
+Functions [2]: [partial_sum((cast(ws_quantity#79 as decimal(10,0)) * ws_list_price#80)), partial_count(1)]
+Aggregate Attributes [3]: [sum#88, isEmpty#89, count#90]
+Results [6]: [i_brand_id#85, i_class_id#86, i_category_id#87, sum#91, isEmpty#92, count#93]
 
 (102) Exchange
-Input [6]: [i_brand_id#83, i_class_id#84, i_category_id#85, sum#89, isEmpty#90, count#91]
-Arguments: hashpartitioning(i_brand_id#83, i_class_id#84, i_category_id#85, 5), ENSURE_REQUIREMENTS, [plan_id=13]
+Input [6]: [i_brand_id#85, i_class_id#86, i_category_id#87, sum#91, isEmpty#92, count#93]
+Arguments: hashpartitioning(i_brand_id#85, i_class_id#86, i_category_id#87, 5), ENSURE_REQUIREMENTS, [plan_id=13]
 
 (103) HashAggregate [codegen id : 114]
-Input [6]: [i_brand_id#83, i_class_id#84, i_category_id#85, sum#89, isEmpty#90, count#91]
-Keys [3]: [i_brand_id#83, i_class_id#84, i_category_id#85]
-Functions [2]: [sum((cast(ws_quantity#78 as decimal(10,0)) * ws_list_price#79)), count(1)]
-Aggregate Attributes [2]: [sum((cast(ws_quantity#78 as decimal(10,0)) * ws_list_price#79))#92, count(1)#93]
-Results [5]: [i_brand_id#83, i_class_id#84, i_category_id#85, sum((cast(ws_quantity#78 as decimal(10,0)) * ws_list_price#79))#92 AS sales#94, count(1)#93 AS number_sales#95]
+Input [6]: [i_brand_id#85, i_class_id#86, i_category_id#87, sum#91, isEmpty#92, count#93]
+Keys [3]: [i_brand_id#85, i_class_id#86, i_category_id#87]
+Functions [2]: [sum((cast(ws_quantity#79 as decimal(10,0)) * ws_list_price#80)), count(1)]
+Aggregate Attributes [2]: [sum((cast(ws_quantity#79 as decimal(10,0)) * ws_list_price#80))#94, count(1)#95]
+Results [5]: [i_brand_id#85, i_class_id#86, i_category_id#87, sum((cast(ws_quantity#79 as decimal(10,0)) * ws_list_price#80))#94 AS sales#96, count(1)#95 AS number_sales#97]
 
 (104) Filter [codegen id : 114]
-Input [5]: [i_brand_id#83, i_class_id#84, i_category_id#85, sales#94, number_sales#95]
-Condition : (isnotnull(sales#94) AND (cast(sales#94 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#51, [id=#52] as decimal(32,6))))
+Input [5]: [i_brand_id#85, i_class_id#86, i_category_id#87, sales#96, number_sales#97]
+Condition : (isnotnull(sales#96) AND (cast(sales#96 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#51, [id=#52] as decimal(32,6))))
 
 (105) Project [codegen id : 114]
-Output [6]: [sales#94, number_sales#95, web AS channel#96, i_brand_id#83, i_class_id#84, i_category_id#85]
-Input [5]: [i_brand_id#83, i_class_id#84, i_category_id#85, sales#94, number_sales#95]
+Output [6]: [sales#96, number_sales#97, web AS channel#98, i_brand_id#85, i_class_id#86, i_category_id#87]
+Input [5]: [i_brand_id#85, i_class_id#86, i_category_id#87, sales#96, number_sales#97]
 
 (106) Union
 
 (107) Expand [codegen id : 115]
 Input [6]: [sales#49, number_sales#50, channel#53, i_brand_id#54, i_class_id#55, i_category_id#56]
-Arguments: [[sales#49, number_sales#50, channel#53, i_brand_id#54, i_class_id#55, i_category_id#56, 0], [sales#49, number_sales#50, channel#53, i_brand_id#54, i_class_id#55, null, 1], [sales#49, number_sales#50, channel#53, i_brand_id#54, null, null, 3], [sales#49, number_sales#50, channel#53, null, null, null, 7], [sales#49, number_sales#50, null, null, null, null, 15]], [sales#49, number_sales#50, channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101]
+Arguments: [[sales#49, number_sales#50, channel#53, i_brand_id#54, i_class_id#55, i_category_id#56, 0], [sales#49, number_sales#50, channel#53, i_brand_id#54, i_class_id#55, null, 1], [sales#49, number_sales#50, channel#53, i_brand_id#54, null, null, 3], [sales#49, number_sales#50, channel#53, null, null, null, 7], [sales#49, number_sales#50, null, null, null, null, 15]], [sales#49, number_sales#50, channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103]
 
 (108) HashAggregate [codegen id : 115]
-Input [7]: [sales#49, number_sales#50, channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101]
-Keys [5]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101]
+Input [7]: [sales#49, number_sales#50, channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103]
+Keys [5]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103]
 Functions [2]: [partial_sum(sales#49), partial_sum(number_sales#50)]
-Aggregate Attributes [3]: [sum#102, isEmpty#103, sum#104]
-Results [8]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101, sum#105, isEmpty#106, sum#107]
+Aggregate Attributes [3]: [sum#104, isEmpty#105, sum#106]
+Results [8]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103, sum#107, isEmpty#108, sum#109]
 
 (109) Exchange
-Input [8]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101, sum#105, isEmpty#106, sum#107]
-Arguments: hashpartitioning(channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101, 5), ENSURE_REQUIREMENTS, [plan_id=14]
+Input [8]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103, sum#107, isEmpty#108, sum#109]
+Arguments: hashpartitioning(channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103, 5), ENSURE_REQUIREMENTS, [plan_id=14]
 
 (110) HashAggregate [codegen id : 116]
-Input [8]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101, sum#105, isEmpty#106, sum#107]
-Keys [5]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101]
+Input [8]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103, sum#107, isEmpty#108, sum#109]
+Keys [5]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103]
 Functions [2]: [sum(sales#49), sum(number_sales#50)]
-Aggregate Attributes [2]: [sum(sales#49)#108, sum(number_sales#50)#109]
-Results [6]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, sum(sales#49)#108 AS sum(sales)#110, sum(number_sales#50)#109 AS sum(number_sales)#111]
+Aggregate Attributes [2]: [sum(sales#49)#110, sum(number_sales#50)#111]
+Results [6]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, sum(sales#49)#110 AS sum(sales)#112, sum(number_sales#50)#111 AS sum(number_sales)#113]
 
 (111) TakeOrderedAndProject
-Input [6]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, sum(sales)#110, sum(number_sales)#111]
-Arguments: 100, [channel#97 ASC NULLS FIRST, i_brand_id#98 ASC NULLS FIRST, i_class_id#99 ASC NULLS FIRST, i_category_id#100 ASC NULLS FIRST], [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, sum(sales)#110, sum(number_sales)#111]
+Input [6]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, sum(sales)#112, sum(number_sales)#113]
+Arguments: 100, [channel#99 ASC NULLS FIRST, i_brand_id#100 ASC NULLS FIRST, i_class_id#101 ASC NULLS FIRST, i_category_id#102 ASC NULLS FIRST], [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, sum(sales)#112, sum(number_sales)#113]
 
 ===== Subqueries =====
 
@@ -661,99 +661,99 @@ Subquery:1 Hosting operator id = 72 Hosting Expression = Subquery scalar-subquer
 
 
 (112) Scan parquet spark_catalog.default.store_sales
-Output [3]: [ss_quantity#112, ss_list_price#113, ss_sold_date_sk#114]
+Output [3]: [ss_quantity#114, ss_list_price#115, ss_sold_date_sk#116]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#114), dynamicpruningexpression(ss_sold_date_sk#114 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#116), dynamicpruningexpression(ss_sold_date_sk#116 IN dynamicpruning#12)]
 ReadSchema: struct<ss_quantity:int,ss_list_price:decimal(7,2)>
 
 (113) ColumnarToRow [codegen id : 2]
-Input [3]: [ss_quantity#112, ss_list_price#113, ss_sold_date_sk#114]
+Input [3]: [ss_quantity#114, ss_list_price#115, ss_sold_date_sk#116]
 
 (114) ReusedExchange [Reuses operator id: 140]
-Output [1]: [d_date_sk#115]
+Output [1]: [d_date_sk#117]
 
 (115) BroadcastHashJoin [codegen id : 2]
-Left keys [1]: [ss_sold_date_sk#114]
-Right keys [1]: [d_date_sk#115]
+Left keys [1]: [ss_sold_date_sk#116]
+Right keys [1]: [d_date_sk#117]
 Join type: Inner
 Join condition: None
 
 (116) Project [codegen id : 2]
-Output [2]: [ss_quantity#112 AS quantity#116, ss_list_price#113 AS list_price#117]
-Input [4]: [ss_quantity#112, ss_list_price#113, ss_sold_date_sk#114, d_date_sk#115]
+Output [2]: [ss_quantity#114 AS quantity#118, ss_list_price#115 AS list_price#119]
+Input [4]: [ss_quantity#114, ss_list_price#115, ss_sold_date_sk#116, d_date_sk#117]
 
 (117) Scan parquet spark_catalog.default.catalog_sales
-Output [3]: [cs_quantity#118, cs_list_price#119, cs_sold_date_sk#120]
+Output [3]: [cs_quantity#120, cs_list_price#121, cs_sold_date_sk#122]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#120), dynamicpruningexpression(cs_sold_date_sk#120 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#122), dynamicpruningexpression(cs_sold_date_sk#122 IN dynamicpruning#12)]
 ReadSchema: struct<cs_quantity:int,cs_list_price:decimal(7,2)>
 
 (118) ColumnarToRow [codegen id : 4]
-Input [3]: [cs_quantity#118, cs_list_price#119, cs_sold_date_sk#120]
+Input [3]: [cs_quantity#120, cs_list_price#121, cs_sold_date_sk#122]
 
 (119) ReusedExchange [Reuses operator id: 140]
-Output [1]: [d_date_sk#121]
+Output [1]: [d_date_sk#123]
 
 (120) BroadcastHashJoin [codegen id : 4]
-Left keys [1]: [cs_sold_date_sk#120]
-Right keys [1]: [d_date_sk#121]
+Left keys [1]: [cs_sold_date_sk#122]
+Right keys [1]: [d_date_sk#123]
 Join type: Inner
 Join condition: None
 
 (121) Project [codegen id : 4]
-Output [2]: [cs_quantity#118 AS quantity#122, cs_list_price#119 AS list_price#123]
-Input [4]: [cs_quantity#118, cs_list_price#119, cs_sold_date_sk#120, d_date_sk#121]
+Output [2]: [cs_quantity#120 AS quantity#124, cs_list_price#121 AS list_price#125]
+Input [4]: [cs_quantity#120, cs_list_price#121, cs_sold_date_sk#122, d_date_sk#123]
 
 (122) Scan parquet spark_catalog.default.web_sales
-Output [3]: [ws_quantity#124, ws_list_price#125, ws_sold_date_sk#126]
+Output [3]: [ws_quantity#126, ws_list_price#127, ws_sold_date_sk#128]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#126), dynamicpruningexpression(ws_sold_date_sk#126 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#128), dynamicpruningexpression(ws_sold_date_sk#128 IN dynamicpruning#12)]
 ReadSchema: struct<ws_quantity:int,ws_list_price:decimal(7,2)>
 
 (123) ColumnarToRow [codegen id : 6]
-Input [3]: [ws_quantity#124, ws_list_price#125, ws_sold_date_sk#126]
+Input [3]: [ws_quantity#126, ws_list_price#127, ws_sold_date_sk#128]
 
 (124) ReusedExchange [Reuses operator id: 140]
-Output [1]: [d_date_sk#127]
+Output [1]: [d_date_sk#129]
 
 (125) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [ws_sold_date_sk#126]
-Right keys [1]: [d_date_sk#127]
+Left keys [1]: [ws_sold_date_sk#128]
+Right keys [1]: [d_date_sk#129]
 Join type: Inner
 Join condition: None
 
 (126) Project [codegen id : 6]
-Output [2]: [ws_quantity#124 AS quantity#128, ws_list_price#125 AS list_price#129]
-Input [4]: [ws_quantity#124, ws_list_price#125, ws_sold_date_sk#126, d_date_sk#127]
+Output [2]: [ws_quantity#126 AS quantity#130, ws_list_price#127 AS list_price#131]
+Input [4]: [ws_quantity#126, ws_list_price#127, ws_sold_date_sk#128, d_date_sk#129]
 
 (127) Union
 
 (128) HashAggregate [codegen id : 7]
-Input [2]: [quantity#116, list_price#117]
+Input [2]: [quantity#118, list_price#119]
 Keys: []
-Functions [1]: [partial_avg((cast(quantity#116 as decimal(10,0)) * list_price#117))]
-Aggregate Attributes [2]: [sum#130, count#131]
-Results [2]: [sum#132, count#133]
+Functions [1]: [partial_avg((cast(quantity#118 as decimal(10,0)) * list_price#119))]
+Aggregate Attributes [2]: [sum#132, count#133]
+Results [2]: [sum#134, count#135]
 
 (129) Exchange
-Input [2]: [sum#132, count#133]
+Input [2]: [sum#134, count#135]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=15]
 
 (130) HashAggregate [codegen id : 8]
-Input [2]: [sum#132, count#133]
+Input [2]: [sum#134, count#135]
 Keys: []
-Functions [1]: [avg((cast(quantity#116 as decimal(10,0)) * list_price#117))]
-Aggregate Attributes [1]: [avg((cast(quantity#116 as decimal(10,0)) * list_price#117))#134]
-Results [1]: [avg((cast(quantity#116 as decimal(10,0)) * list_price#117))#134 AS average_sales#135]
+Functions [1]: [avg((cast(quantity#118 as decimal(10,0)) * list_price#119))]
+Aggregate Attributes [1]: [avg((cast(quantity#118 as decimal(10,0)) * list_price#119))#136]
+Results [1]: [avg((cast(quantity#118 as decimal(10,0)) * list_price#119))#136 AS average_sales#137]
 
-Subquery:2 Hosting operator id = 112 Hosting Expression = ss_sold_date_sk#114 IN dynamicpruning#12
+Subquery:2 Hosting operator id = 112 Hosting Expression = ss_sold_date_sk#116 IN dynamicpruning#12
 
-Subquery:3 Hosting operator id = 117 Hosting Expression = cs_sold_date_sk#120 IN dynamicpruning#12
+Subquery:3 Hosting operator id = 117 Hosting Expression = cs_sold_date_sk#122 IN dynamicpruning#12
 
-Subquery:4 Hosting operator id = 122 Hosting Expression = ws_sold_date_sk#126 IN dynamicpruning#12
+Subquery:4 Hosting operator id = 122 Hosting Expression = ws_sold_date_sk#128 IN dynamicpruning#12
 
 Subquery:5 Hosting operator id = 1 Hosting Expression = ss_sold_date_sk#4 IN dynamicpruning#5
 BroadcastExchange (135)
@@ -764,22 +764,22 @@ BroadcastExchange (135)
 
 
 (131) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#36, d_year#136, d_moy#137]
+Output [3]: [d_date_sk#36, d_year#138, d_moy#139]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
 
 (132) ColumnarToRow [codegen id : 1]
-Input [3]: [d_date_sk#36, d_year#136, d_moy#137]
+Input [3]: [d_date_sk#36, d_year#138, d_moy#139]
 
 (133) Filter [codegen id : 1]
-Input [3]: [d_date_sk#36, d_year#136, d_moy#137]
-Condition : ((((isnotnull(d_year#136) AND isnotnull(d_moy#137)) AND (d_year#136 = 2001)) AND (d_moy#137 = 11)) AND isnotnull(d_date_sk#36))
+Input [3]: [d_date_sk#36, d_year#138, d_moy#139]
+Condition : ((((isnotnull(d_year#138) AND isnotnull(d_moy#139)) AND (d_year#138 = 2001)) AND (d_moy#139 = 11)) AND isnotnull(d_date_sk#36))
 
 (134) Project [codegen id : 1]
 Output [1]: [d_date_sk#36]
-Input [3]: [d_date_sk#36, d_year#136, d_moy#137]
+Input [3]: [d_date_sk#36, d_year#138, d_moy#139]
 
 (135) BroadcastExchange
 Input [1]: [d_date_sk#36]
@@ -794,22 +794,22 @@ BroadcastExchange (140)
 
 
 (136) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#13, d_year#138]
+Output [2]: [d_date_sk#13, d_year#140]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (137) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#13, d_year#138]
+Input [2]: [d_date_sk#13, d_year#140]
 
 (138) Filter [codegen id : 1]
-Input [2]: [d_date_sk#13, d_year#138]
-Condition : (((isnotnull(d_year#138) AND (d_year#138 >= 1999)) AND (d_year#138 <= 2001)) AND isnotnull(d_date_sk#13))
+Input [2]: [d_date_sk#13, d_year#140]
+Condition : (((isnotnull(d_year#140) AND (d_year#140 >= 1999)) AND (d_year#140 <= 2001)) AND isnotnull(d_date_sk#13))
 
 (139) Project [codegen id : 1]
 Output [1]: [d_date_sk#13]
-Input [2]: [d_date_sk#13, d_year#138]
+Input [2]: [d_date_sk#13, d_year#140]
 
 (140) BroadcastExchange
 Input [1]: [d_date_sk#13]
@@ -825,6 +825,6 @@ Subquery:10 Hosting operator id = 74 Hosting Expression = cs_sold_date_sk#60 IN
 
 Subquery:11 Hosting operator id = 104 Hosting Expression = ReusedSubquery Subquery scalar-subquery#51, [id=#52]
 
-Subquery:12 Hosting operator id = 90 Hosting Expression = ws_sold_date_sk#80 IN dynamicpruning#5
+Subquery:12 Hosting operator id = 90 Hosting Expression = ws_sold_date_sk#81 IN dynamicpruning#5
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14a/explain.txt
index 50a1d636ffc..9c99ab3ad5b 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14a/explain.txt
@@ -442,169 +442,169 @@ Input [4]: [cs_item_sk#57, cs_quantity#58, cs_list_price#59, cs_sold_date_sk#60]
 Condition : isnotnull(cs_item_sk#57)
 
 (71) ReusedExchange [Reuses operator id: 50]
-Output [1]: [ss_item_sk#35]
+Output [1]: [ss_item_sk#61]
 
 (72) BroadcastHashJoin [codegen id : 51]
 Left keys [1]: [cs_item_sk#57]
-Right keys [1]: [ss_item_sk#35]
+Right keys [1]: [ss_item_sk#61]
 Join type: LeftSemi
 Join condition: None
 
 (73) ReusedExchange [Reuses operator id: 57]
-Output [4]: [i_item_sk#61, i_brand_id#62, i_class_id#63, i_category_id#64]
+Output [4]: [i_item_sk#62, i_brand_id#63, i_class_id#64, i_category_id#65]
 
 (74) BroadcastHashJoin [codegen id : 51]
 Left keys [1]: [cs_item_sk#57]
-Right keys [1]: [i_item_sk#61]
+Right keys [1]: [i_item_sk#62]
 Join type: Inner
 Join condition: None
 
 (75) Project [codegen id : 51]
-Output [6]: [cs_quantity#58, cs_list_price#59, cs_sold_date_sk#60, i_brand_id#62, i_class_id#63, i_category_id#64]
-Input [8]: [cs_item_sk#57, cs_quantity#58, cs_list_price#59, cs_sold_date_sk#60, i_item_sk#61, i_brand_id#62, i_class_id#63, i_category_id#64]
+Output [6]: [cs_quantity#58, cs_list_price#59, cs_sold_date_sk#60, i_brand_id#63, i_class_id#64, i_category_id#65]
+Input [8]: [cs_item_sk#57, cs_quantity#58, cs_list_price#59, cs_sold_date_sk#60, i_item_sk#62, i_brand_id#63, i_class_id#64, i_category_id#65]
 
 (76) ReusedExchange [Reuses operator id: 129]
-Output [1]: [d_date_sk#65]
+Output [1]: [d_date_sk#66]
 
 (77) BroadcastHashJoin [codegen id : 51]
 Left keys [1]: [cs_sold_date_sk#60]
-Right keys [1]: [d_date_sk#65]
+Right keys [1]: [d_date_sk#66]
 Join type: Inner
 Join condition: None
 
 (78) Project [codegen id : 51]
-Output [5]: [cs_quantity#58, cs_list_price#59, i_brand_id#62, i_class_id#63, i_category_id#64]
-Input [7]: [cs_quantity#58, cs_list_price#59, cs_sold_date_sk#60, i_brand_id#62, i_class_id#63, i_category_id#64, d_date_sk#65]
+Output [5]: [cs_quantity#58, cs_list_price#59, i_brand_id#63, i_class_id#64, i_category_id#65]
+Input [7]: [cs_quantity#58, cs_list_price#59, cs_sold_date_sk#60, i_brand_id#63, i_class_id#64, i_category_id#65, d_date_sk#66]
 
 (79) HashAggregate [codegen id : 51]
-Input [5]: [cs_quantity#58, cs_list_price#59, i_brand_id#62, i_class_id#63, i_category_id#64]
-Keys [3]: [i_brand_id#62, i_class_id#63, i_category_id#64]
+Input [5]: [cs_quantity#58, cs_list_price#59, i_brand_id#63, i_class_id#64, i_category_id#65]
+Keys [3]: [i_brand_id#63, i_class_id#64, i_category_id#65]
 Functions [2]: [partial_sum((cast(cs_quantity#58 as decimal(10,0)) * cs_list_price#59)), partial_count(1)]
-Aggregate Attributes [3]: [sum#66, isEmpty#67, count#68]
-Results [6]: [i_brand_id#62, i_class_id#63, i_category_id#64, sum#69, isEmpty#70, count#71]
+Aggregate Attributes [3]: [sum#67, isEmpty#68, count#69]
+Results [6]: [i_brand_id#63, i_class_id#64, i_category_id#65, sum#70, isEmpty#71, count#72]
 
 (80) Exchange
-Input [6]: [i_brand_id#62, i_class_id#63, i_category_id#64, sum#69, isEmpty#70, count#71]
-Arguments: hashpartitioning(i_brand_id#62, i_class_id#63, i_category_id#64, 5), ENSURE_REQUIREMENTS, [plan_id=10]
+Input [6]: [i_brand_id#63, i_class_id#64, i_category_id#65, sum#70, isEmpty#71, count#72]
+Arguments: hashpartitioning(i_brand_id#63, i_class_id#64, i_category_id#65, 5), ENSURE_REQUIREMENTS, [plan_id=10]
 
 (81) HashAggregate [codegen id : 52]
-Input [6]: [i_brand_id#62, i_class_id#63, i_category_id#64, sum#69, isEmpty#70, count#71]
-Keys [3]: [i_brand_id#62, i_class_id#63, i_category_id#64]
+Input [6]: [i_brand_id#63, i_class_id#64, i_category_id#65, sum#70, isEmpty#71, count#72]
+Keys [3]: [i_brand_id#63, i_class_id#64, i_category_id#65]
 Functions [2]: [sum((cast(cs_quantity#58 as decimal(10,0)) * cs_list_price#59)), count(1)]
-Aggregate Attributes [2]: [sum((cast(cs_quantity#58 as decimal(10,0)) * cs_list_price#59))#72, count(1)#73]
-Results [5]: [i_brand_id#62, i_class_id#63, i_category_id#64, sum((cast(cs_quantity#58 as decimal(10,0)) * cs_list_price#59))#72 AS sales#74, count(1)#73 AS number_sales#75]
+Aggregate Attributes [2]: [sum((cast(cs_quantity#58 as decimal(10,0)) * cs_list_price#59))#73, count(1)#74]
+Results [5]: [i_brand_id#63, i_class_id#64, i_category_id#65, sum((cast(cs_quantity#58 as decimal(10,0)) * cs_list_price#59))#73 AS sales#75, count(1)#74 AS number_sales#76]
 
 (82) Filter [codegen id : 52]
-Input [5]: [i_brand_id#62, i_class_id#63, i_category_id#64, sales#74, number_sales#75]
-Condition : (isnotnull(sales#74) AND (cast(sales#74 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#51, [id=#52] as decimal(32,6))))
+Input [5]: [i_brand_id#63, i_class_id#64, i_category_id#65, sales#75, number_sales#76]
+Condition : (isnotnull(sales#75) AND (cast(sales#75 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#51, [id=#52] as decimal(32,6))))
 
 (83) Project [codegen id : 52]
-Output [6]: [sales#74, number_sales#75, catalog AS channel#76, i_brand_id#62, i_class_id#63, i_category_id#64]
-Input [5]: [i_brand_id#62, i_class_id#63, i_category_id#64, sales#74, number_sales#75]
+Output [6]: [sales#75, number_sales#76, catalog AS channel#77, i_brand_id#63, i_class_id#64, i_category_id#65]
+Input [5]: [i_brand_id#63, i_class_id#64, i_category_id#65, sales#75, number_sales#76]
 
 (84) Scan parquet spark_catalog.default.web_sales
-Output [4]: [ws_item_sk#77, ws_quantity#78, ws_list_price#79, ws_sold_date_sk#80]
+Output [4]: [ws_item_sk#78, ws_quantity#79, ws_list_price#80, ws_sold_date_sk#81]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#80), dynamicpruningexpression(ws_sold_date_sk#80 IN dynamicpruning#5)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#81), dynamicpruningexpression(ws_sold_date_sk#81 IN dynamicpruning#5)]
 PushedFilters: [IsNotNull(ws_item_sk)]
 ReadSchema: struct<ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
 
 (85) ColumnarToRow [codegen id : 77]
-Input [4]: [ws_item_sk#77, ws_quantity#78, ws_list_price#79, ws_sold_date_sk#80]
+Input [4]: [ws_item_sk#78, ws_quantity#79, ws_list_price#80, ws_sold_date_sk#81]
 
 (86) Filter [codegen id : 77]
-Input [4]: [ws_item_sk#77, ws_quantity#78, ws_list_price#79, ws_sold_date_sk#80]
-Condition : isnotnull(ws_item_sk#77)
+Input [4]: [ws_item_sk#78, ws_quantity#79, ws_list_price#80, ws_sold_date_sk#81]
+Condition : isnotnull(ws_item_sk#78)
 
 (87) ReusedExchange [Reuses operator id: 50]
-Output [1]: [ss_item_sk#35]
+Output [1]: [ss_item_sk#82]
 
 (88) BroadcastHashJoin [codegen id : 77]
-Left keys [1]: [ws_item_sk#77]
-Right keys [1]: [ss_item_sk#35]
+Left keys [1]: [ws_item_sk#78]
+Right keys [1]: [ss_item_sk#82]
 Join type: LeftSemi
 Join condition: None
 
 (89) ReusedExchange [Reuses operator id: 57]
-Output [4]: [i_item_sk#81, i_brand_id#82, i_class_id#83, i_category_id#84]
+Output [4]: [i_item_sk#83, i_brand_id#84, i_class_id#85, i_category_id#86]
 
 (90) BroadcastHashJoin [codegen id : 77]
-Left keys [1]: [ws_item_sk#77]
-Right keys [1]: [i_item_sk#81]
+Left keys [1]: [ws_item_sk#78]
+Right keys [1]: [i_item_sk#83]
 Join type: Inner
 Join condition: None
 
 (91) Project [codegen id : 77]
-Output [6]: [ws_quantity#78, ws_list_price#79, ws_sold_date_sk#80, i_brand_id#82, i_class_id#83, i_category_id#84]
-Input [8]: [ws_item_sk#77, ws_quantity#78, ws_list_price#79, ws_sold_date_sk#80, i_item_sk#81, i_brand_id#82, i_class_id#83, i_category_id#84]
+Output [6]: [ws_quantity#79, ws_list_price#80, ws_sold_date_sk#81, i_brand_id#84, i_class_id#85, i_category_id#86]
+Input [8]: [ws_item_sk#78, ws_quantity#79, ws_list_price#80, ws_sold_date_sk#81, i_item_sk#83, i_brand_id#84, i_class_id#85, i_category_id#86]
 
 (92) ReusedExchange [Reuses operator id: 129]
-Output [1]: [d_date_sk#85]
+Output [1]: [d_date_sk#87]
 
 (93) BroadcastHashJoin [codegen id : 77]
-Left keys [1]: [ws_sold_date_sk#80]
-Right keys [1]: [d_date_sk#85]
+Left keys [1]: [ws_sold_date_sk#81]
+Right keys [1]: [d_date_sk#87]
 Join type: Inner
 Join condition: None
 
 (94) Project [codegen id : 77]
-Output [5]: [ws_quantity#78, ws_list_price#79, i_brand_id#82, i_class_id#83, i_category_id#84]
-Input [7]: [ws_quantity#78, ws_list_price#79, ws_sold_date_sk#80, i_brand_id#82, i_class_id#83, i_category_id#84, d_date_sk#85]
+Output [5]: [ws_quantity#79, ws_list_price#80, i_brand_id#84, i_class_id#85, i_category_id#86]
+Input [7]: [ws_quantity#79, ws_list_price#80, ws_sold_date_sk#81, i_brand_id#84, i_class_id#85, i_category_id#86, d_date_sk#87]
 
 (95) HashAggregate [codegen id : 77]
-Input [5]: [ws_quantity#78, ws_list_price#79, i_brand_id#82, i_class_id#83, i_category_id#84]
-Keys [3]: [i_brand_id#82, i_class_id#83, i_category_id#84]
-Functions [2]: [partial_sum((cast(ws_quantity#78 as decimal(10,0)) * ws_list_price#79)), partial_count(1)]
-Aggregate Attributes [3]: [sum#86, isEmpty#87, count#88]
-Results [6]: [i_brand_id#82, i_class_id#83, i_category_id#84, sum#89, isEmpty#90, count#91]
+Input [5]: [ws_quantity#79, ws_list_price#80, i_brand_id#84, i_class_id#85, i_category_id#86]
+Keys [3]: [i_brand_id#84, i_class_id#85, i_category_id#86]
+Functions [2]: [partial_sum((cast(ws_quantity#79 as decimal(10,0)) * ws_list_price#80)), partial_count(1)]
+Aggregate Attributes [3]: [sum#88, isEmpty#89, count#90]
+Results [6]: [i_brand_id#84, i_class_id#85, i_category_id#86, sum#91, isEmpty#92, count#93]
 
 (96) Exchange
-Input [6]: [i_brand_id#82, i_class_id#83, i_category_id#84, sum#89, isEmpty#90, count#91]
-Arguments: hashpartitioning(i_brand_id#82, i_class_id#83, i_category_id#84, 5), ENSURE_REQUIREMENTS, [plan_id=11]
+Input [6]: [i_brand_id#84, i_class_id#85, i_category_id#86, sum#91, isEmpty#92, count#93]
+Arguments: hashpartitioning(i_brand_id#84, i_class_id#85, i_category_id#86, 5), ENSURE_REQUIREMENTS, [plan_id=11]
 
 (97) HashAggregate [codegen id : 78]
-Input [6]: [i_brand_id#82, i_class_id#83, i_category_id#84, sum#89, isEmpty#90, count#91]
-Keys [3]: [i_brand_id#82, i_class_id#83, i_category_id#84]
-Functions [2]: [sum((cast(ws_quantity#78 as decimal(10,0)) * ws_list_price#79)), count(1)]
-Aggregate Attributes [2]: [sum((cast(ws_quantity#78 as decimal(10,0)) * ws_list_price#79))#92, count(1)#93]
-Results [5]: [i_brand_id#82, i_class_id#83, i_category_id#84, sum((cast(ws_quantity#78 as decimal(10,0)) * ws_list_price#79))#92 AS sales#94, count(1)#93 AS number_sales#95]
+Input [6]: [i_brand_id#84, i_class_id#85, i_category_id#86, sum#91, isEmpty#92, count#93]
+Keys [3]: [i_brand_id#84, i_class_id#85, i_category_id#86]
+Functions [2]: [sum((cast(ws_quantity#79 as decimal(10,0)) * ws_list_price#80)), count(1)]
+Aggregate Attributes [2]: [sum((cast(ws_quantity#79 as decimal(10,0)) * ws_list_price#80))#94, count(1)#95]
+Results [5]: [i_brand_id#84, i_class_id#85, i_category_id#86, sum((cast(ws_quantity#79 as decimal(10,0)) * ws_list_price#80))#94 AS sales#96, count(1)#95 AS number_sales#97]
 
 (98) Filter [codegen id : 78]
-Input [5]: [i_brand_id#82, i_class_id#83, i_category_id#84, sales#94, number_sales#95]
-Condition : (isnotnull(sales#94) AND (cast(sales#94 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#51, [id=#52] as decimal(32,6))))
+Input [5]: [i_brand_id#84, i_class_id#85, i_category_id#86, sales#96, number_sales#97]
+Condition : (isnotnull(sales#96) AND (cast(sales#96 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#51, [id=#52] as decimal(32,6))))
 
 (99) Project [codegen id : 78]
-Output [6]: [sales#94, number_sales#95, web AS channel#96, i_brand_id#82, i_class_id#83, i_category_id#84]
-Input [5]: [i_brand_id#82, i_class_id#83, i_category_id#84, sales#94, number_sales#95]
+Output [6]: [sales#96, number_sales#97, web AS channel#98, i_brand_id#84, i_class_id#85, i_category_id#86]
+Input [5]: [i_brand_id#84, i_class_id#85, i_category_id#86, sales#96, number_sales#97]
 
 (100) Union
 
 (101) Expand [codegen id : 79]
 Input [6]: [sales#49, number_sales#50, channel#53, i_brand_id#54, i_class_id#55, i_category_id#56]
-Arguments: [[sales#49, number_sales#50, channel#53, i_brand_id#54, i_class_id#55, i_category_id#56, 0], [sales#49, number_sales#50, channel#53, i_brand_id#54, i_class_id#55, null, 1], [sales#49, number_sales#50, channel#53, i_brand_id#54, null, null, 3], [sales#49, number_sales#50, channel#53, null, null, null, 7], [sales#49, number_sales#50, null, null, null, null, 15]], [sales#49, number_sales#50, channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101]
+Arguments: [[sales#49, number_sales#50, channel#53, i_brand_id#54, i_class_id#55, i_category_id#56, 0], [sales#49, number_sales#50, channel#53, i_brand_id#54, i_class_id#55, null, 1], [sales#49, number_sales#50, channel#53, i_brand_id#54, null, null, 3], [sales#49, number_sales#50, channel#53, null, null, null, 7], [sales#49, number_sales#50, null, null, null, null, 15]], [sales#49, number_sales#50, channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103]
 
 (102) HashAggregate [codegen id : 79]
-Input [7]: [sales#49, number_sales#50, channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101]
-Keys [5]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101]
+Input [7]: [sales#49, number_sales#50, channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103]
+Keys [5]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103]
 Functions [2]: [partial_sum(sales#49), partial_sum(number_sales#50)]
-Aggregate Attributes [3]: [sum#102, isEmpty#103, sum#104]
-Results [8]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101, sum#105, isEmpty#106, sum#107]
+Aggregate Attributes [3]: [sum#104, isEmpty#105, sum#106]
+Results [8]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103, sum#107, isEmpty#108, sum#109]
 
 (103) Exchange
-Input [8]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101, sum#105, isEmpty#106, sum#107]
-Arguments: hashpartitioning(channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101, 5), ENSURE_REQUIREMENTS, [plan_id=12]
+Input [8]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103, sum#107, isEmpty#108, sum#109]
+Arguments: hashpartitioning(channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103, 5), ENSURE_REQUIREMENTS, [plan_id=12]
 
 (104) HashAggregate [codegen id : 80]
-Input [8]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101, sum#105, isEmpty#106, sum#107]
-Keys [5]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, spark_grouping_id#101]
+Input [8]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103, sum#107, isEmpty#108, sum#109]
+Keys [5]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, spark_grouping_id#103]
 Functions [2]: [sum(sales#49), sum(number_sales#50)]
-Aggregate Attributes [2]: [sum(sales#49)#108, sum(number_sales#50)#109]
-Results [6]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, sum(sales#49)#108 AS sum(sales)#110, sum(number_sales#50)#109 AS sum(number_sales)#111]
+Aggregate Attributes [2]: [sum(sales#49)#110, sum(number_sales#50)#111]
+Results [6]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, sum(sales#49)#110 AS sum(sales)#112, sum(number_sales#50)#111 AS sum(number_sales)#113]
 
 (105) TakeOrderedAndProject
-Input [6]: [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, sum(sales)#110, sum(number_sales)#111]
-Arguments: 100, [channel#97 ASC NULLS FIRST, i_brand_id#98 ASC NULLS FIRST, i_class_id#99 ASC NULLS FIRST, i_category_id#100 ASC NULLS FIRST], [channel#97, i_brand_id#98, i_class_id#99, i_category_id#100, sum(sales)#110, sum(number_sales)#111]
+Input [6]: [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, sum(sales)#112, sum(number_sales)#113]
+Arguments: 100, [channel#99 ASC NULLS FIRST, i_brand_id#100 ASC NULLS FIRST, i_class_id#101 ASC NULLS FIRST, i_category_id#102 ASC NULLS FIRST], [channel#99, i_brand_id#100, i_class_id#101, i_category_id#102, sum(sales)#112, sum(number_sales)#113]
 
 ===== Subqueries =====
 
@@ -631,99 +631,99 @@ Subquery:1 Hosting operator id = 66 Hosting Expression = Subquery scalar-subquer
 
 
 (106) Scan parquet spark_catalog.default.store_sales
-Output [3]: [ss_quantity#112, ss_list_price#113, ss_sold_date_sk#114]
+Output [3]: [ss_quantity#114, ss_list_price#115, ss_sold_date_sk#116]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#114), dynamicpruningexpression(ss_sold_date_sk#114 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#116), dynamicpruningexpression(ss_sold_date_sk#116 IN dynamicpruning#12)]
 ReadSchema: struct<ss_quantity:int,ss_list_price:decimal(7,2)>
 
 (107) ColumnarToRow [codegen id : 2]
-Input [3]: [ss_quantity#112, ss_list_price#113, ss_sold_date_sk#114]
+Input [3]: [ss_quantity#114, ss_list_price#115, ss_sold_date_sk#116]
 
 (108) ReusedExchange [Reuses operator id: 134]
-Output [1]: [d_date_sk#115]
+Output [1]: [d_date_sk#117]
 
 (109) BroadcastHashJoin [codegen id : 2]
-Left keys [1]: [ss_sold_date_sk#114]
-Right keys [1]: [d_date_sk#115]
+Left keys [1]: [ss_sold_date_sk#116]
+Right keys [1]: [d_date_sk#117]
 Join type: Inner
 Join condition: None
 
 (110) Project [codegen id : 2]
-Output [2]: [ss_quantity#112 AS quantity#116, ss_list_price#113 AS list_price#117]
-Input [4]: [ss_quantity#112, ss_list_price#113, ss_sold_date_sk#114, d_date_sk#115]
+Output [2]: [ss_quantity#114 AS quantity#118, ss_list_price#115 AS list_price#119]
+Input [4]: [ss_quantity#114, ss_list_price#115, ss_sold_date_sk#116, d_date_sk#117]
 
 (111) Scan parquet spark_catalog.default.catalog_sales
-Output [3]: [cs_quantity#118, cs_list_price#119, cs_sold_date_sk#120]
+Output [3]: [cs_quantity#120, cs_list_price#121, cs_sold_date_sk#122]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#120), dynamicpruningexpression(cs_sold_date_sk#120 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#122), dynamicpruningexpression(cs_sold_date_sk#122 IN dynamicpruning#12)]
 ReadSchema: struct<cs_quantity:int,cs_list_price:decimal(7,2)>
 
 (112) ColumnarToRow [codegen id : 4]
-Input [3]: [cs_quantity#118, cs_list_price#119, cs_sold_date_sk#120]
+Input [3]: [cs_quantity#120, cs_list_price#121, cs_sold_date_sk#122]
 
 (113) ReusedExchange [Reuses operator id: 134]
-Output [1]: [d_date_sk#121]
+Output [1]: [d_date_sk#123]
 
 (114) BroadcastHashJoin [codegen id : 4]
-Left keys [1]: [cs_sold_date_sk#120]
-Right keys [1]: [d_date_sk#121]
+Left keys [1]: [cs_sold_date_sk#122]
+Right keys [1]: [d_date_sk#123]
 Join type: Inner
 Join condition: None
 
 (115) Project [codegen id : 4]
-Output [2]: [cs_quantity#118 AS quantity#122, cs_list_price#119 AS list_price#123]
-Input [4]: [cs_quantity#118, cs_list_price#119, cs_sold_date_sk#120, d_date_sk#121]
+Output [2]: [cs_quantity#120 AS quantity#124, cs_list_price#121 AS list_price#125]
+Input [4]: [cs_quantity#120, cs_list_price#121, cs_sold_date_sk#122, d_date_sk#123]
 
 (116) Scan parquet spark_catalog.default.web_sales
-Output [3]: [ws_quantity#124, ws_list_price#125, ws_sold_date_sk#126]
+Output [3]: [ws_quantity#126, ws_list_price#127, ws_sold_date_sk#128]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#126), dynamicpruningexpression(ws_sold_date_sk#126 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#128), dynamicpruningexpression(ws_sold_date_sk#128 IN dynamicpruning#12)]
 ReadSchema: struct<ws_quantity:int,ws_list_price:decimal(7,2)>
 
 (117) ColumnarToRow [codegen id : 6]
-Input [3]: [ws_quantity#124, ws_list_price#125, ws_sold_date_sk#126]
+Input [3]: [ws_quantity#126, ws_list_price#127, ws_sold_date_sk#128]
 
 (118) ReusedExchange [Reuses operator id: 134]
-Output [1]: [d_date_sk#127]
+Output [1]: [d_date_sk#129]
 
 (119) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [ws_sold_date_sk#126]
-Right keys [1]: [d_date_sk#127]
+Left keys [1]: [ws_sold_date_sk#128]
+Right keys [1]: [d_date_sk#129]
 Join type: Inner
 Join condition: None
 
 (120) Project [codegen id : 6]
-Output [2]: [ws_quantity#124 AS quantity#128, ws_list_price#125 AS list_price#129]
-Input [4]: [ws_quantity#124, ws_list_price#125, ws_sold_date_sk#126, d_date_sk#127]
+Output [2]: [ws_quantity#126 AS quantity#130, ws_list_price#127 AS list_price#131]
+Input [4]: [ws_quantity#126, ws_list_price#127, ws_sold_date_sk#128, d_date_sk#129]
 
 (121) Union
 
 (122) HashAggregate [codegen id : 7]
-Input [2]: [quantity#116, list_price#117]
+Input [2]: [quantity#118, list_price#119]
 Keys: []
-Functions [1]: [partial_avg((cast(quantity#116 as decimal(10,0)) * list_price#117))]
-Aggregate Attributes [2]: [sum#130, count#131]
-Results [2]: [sum#132, count#133]
+Functions [1]: [partial_avg((cast(quantity#118 as decimal(10,0)) * list_price#119))]
+Aggregate Attributes [2]: [sum#132, count#133]
+Results [2]: [sum#134, count#135]
 
 (123) Exchange
-Input [2]: [sum#132, count#133]
+Input [2]: [sum#134, count#135]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=13]
 
 (124) HashAggregate [codegen id : 8]
-Input [2]: [sum#132, count#133]
+Input [2]: [sum#134, count#135]
 Keys: []
-Functions [1]: [avg((cast(quantity#116 as decimal(10,0)) * list_price#117))]
-Aggregate Attributes [1]: [avg((cast(quantity#116 as decimal(10,0)) * list_price#117))#134]
-Results [1]: [avg((cast(quantity#116 as decimal(10,0)) * list_price#117))#134 AS average_sales#135]
+Functions [1]: [avg((cast(quantity#118 as decimal(10,0)) * list_price#119))]
+Aggregate Attributes [1]: [avg((cast(quantity#118 as decimal(10,0)) * list_price#119))#136]
+Results [1]: [avg((cast(quantity#118 as decimal(10,0)) * list_price#119))#136 AS average_sales#137]
 
-Subquery:2 Hosting operator id = 106 Hosting Expression = ss_sold_date_sk#114 IN dynamicpruning#12
+Subquery:2 Hosting operator id = 106 Hosting Expression = ss_sold_date_sk#116 IN dynamicpruning#12
 
-Subquery:3 Hosting operator id = 111 Hosting Expression = cs_sold_date_sk#120 IN dynamicpruning#12
+Subquery:3 Hosting operator id = 111 Hosting Expression = cs_sold_date_sk#122 IN dynamicpruning#12
 
-Subquery:4 Hosting operator id = 116 Hosting Expression = ws_sold_date_sk#126 IN dynamicpruning#12
+Subquery:4 Hosting operator id = 116 Hosting Expression = ws_sold_date_sk#128 IN dynamicpruning#12
 
 Subquery:5 Hosting operator id = 1 Hosting Expression = ss_sold_date_sk#4 IN dynamicpruning#5
 BroadcastExchange (129)
@@ -734,22 +734,22 @@ BroadcastExchange (129)
 
 
 (125) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#40, d_year#136, d_moy#137]
+Output [3]: [d_date_sk#40, d_year#138, d_moy#139]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
 
 (126) ColumnarToRow [codegen id : 1]
-Input [3]: [d_date_sk#40, d_year#136, d_moy#137]
+Input [3]: [d_date_sk#40, d_year#138, d_moy#139]
 
 (127) Filter [codegen id : 1]
-Input [3]: [d_date_sk#40, d_year#136, d_moy#137]
-Condition : ((((isnotnull(d_year#136) AND isnotnull(d_moy#137)) AND (d_year#136 = 2001)) AND (d_moy#137 = 11)) AND isnotnull(d_date_sk#40))
+Input [3]: [d_date_sk#40, d_year#138, d_moy#139]
+Condition : ((((isnotnull(d_year#138) AND isnotnull(d_moy#139)) AND (d_year#138 = 2001)) AND (d_moy#139 = 11)) AND isnotnull(d_date_sk#40))
 
 (128) Project [codegen id : 1]
 Output [1]: [d_date_sk#40]
-Input [3]: [d_date_sk#40, d_year#136, d_moy#137]
+Input [3]: [d_date_sk#40, d_year#138, d_moy#139]
 
 (129) BroadcastExchange
 Input [1]: [d_date_sk#40]
@@ -764,22 +764,22 @@ BroadcastExchange (134)
 
 
 (130) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#24, d_year#138]
+Output [2]: [d_date_sk#24, d_year#140]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (131) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#24, d_year#138]
+Input [2]: [d_date_sk#24, d_year#140]
 
 (132) Filter [codegen id : 1]
-Input [2]: [d_date_sk#24, d_year#138]
-Condition : (((isnotnull(d_year#138) AND (d_year#138 >= 1999)) AND (d_year#138 <= 2001)) AND isnotnull(d_date_sk#24))
+Input [2]: [d_date_sk#24, d_year#140]
+Condition : (((isnotnull(d_year#140) AND (d_year#140 >= 1999)) AND (d_year#140 <= 2001)) AND isnotnull(d_date_sk#24))
 
 (133) Project [codegen id : 1]
 Output [1]: [d_date_sk#24]
-Input [2]: [d_date_sk#24, d_year#138]
+Input [2]: [d_date_sk#24, d_year#140]
 
 (134) BroadcastExchange
 Input [1]: [d_date_sk#24]
@@ -795,6 +795,6 @@ Subquery:10 Hosting operator id = 68 Hosting Expression = cs_sold_date_sk#60 IN
 
 Subquery:11 Hosting operator id = 98 Hosting Expression = ReusedSubquery Subquery scalar-subquery#51, [id=#52]
 
-Subquery:12 Hosting operator id = 84 Hosting Expression = ws_sold_date_sk#80 IN dynamicpruning#5
+Subquery:12 Hosting operator id = 84 Hosting Expression = ws_sold_date_sk#81 IN dynamicpruning#5
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14b.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14b.sf100/explain.txt
index 99573a62028..9af375dd69f 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14b.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14b.sf100/explain.txt
@@ -447,75 +447,75 @@ Input [4]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57]
 Condition : isnotnull(ss_item_sk#54)
 
 (76) ReusedExchange [Reuses operator id: 56]
-Output [1]: [ss_item_sk#35]
+Output [1]: [ss_item_sk#59]
 
 (77) BroadcastHashJoin [codegen id : 74]
 Left keys [1]: [ss_item_sk#54]
-Right keys [1]: [ss_item_sk#35]
+Right keys [1]: [ss_item_sk#59]
 Join type: LeftSemi
 Join condition: None
 
 (78) ReusedExchange [Reuses operator id: 128]
-Output [1]: [d_date_sk#59]
+Output [1]: [d_date_sk#60]
 
 (79) BroadcastHashJoin [codegen id : 74]
 Left keys [1]: [ss_sold_date_sk#57]
-Right keys [1]: [d_date_sk#59]
+Right keys [1]: [d_date_sk#60]
 Join type: Inner
 Join condition: None
 
 (80) Project [codegen id : 74]
 Output [3]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56]
-Input [5]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, d_date_sk#59]
+Input [5]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, d_date_sk#60]
 
 (81) ReusedExchange [Reuses operator id: 66]
-Output [4]: [i_item_sk#60, i_brand_id#61, i_class_id#62, i_category_id#63]
+Output [4]: [i_item_sk#61, i_brand_id#62, i_class_id#63, i_category_id#64]
 
 (82) BroadcastHashJoin [codegen id : 74]
 Left keys [1]: [ss_item_sk#54]
-Right keys [1]: [i_item_sk#60]
+Right keys [1]: [i_item_sk#61]
 Join type: Inner
 Join condition: None
 
 (83) Project [codegen id : 74]
-Output [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#61, i_class_id#62, i_category_id#63]
-Input [7]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, i_item_sk#60, i_brand_id#61, i_class_id#62, i_category_id#63]
+Output [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#62, i_class_id#63, i_category_id#64]
+Input [7]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, i_item_sk#61, i_brand_id#62, i_class_id#63, i_category_id#64]
 
 (84) HashAggregate [codegen id : 74]
-Input [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#61, i_class_id#62, i_category_id#63]
-Keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
+Input [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#62, i_class_id#63, i_category_id#64]
+Keys [3]: [i_brand_id#62, i_class_id#63, i_category_id#64]
 Functions [2]: [partial_sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56)), partial_count(1)]
-Aggregate Attributes [3]: [sum#64, isEmpty#65, count#66]
-Results [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#67, isEmpty#68, count#69]
+Aggregate Attributes [3]: [sum#65, isEmpty#66, count#67]
+Results [6]: [i_brand_id#62, i_class_id#63, i_category_id#64, sum#68, isEmpty#69, count#70]
 
 (85) Exchange
-Input [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#67, isEmpty#68, count#69]
-Arguments: hashpartitioning(i_brand_id#61, i_class_id#62, i_category_id#63, 5), ENSURE_REQUIREMENTS, [plan_id=12]
+Input [6]: [i_brand_id#62, i_class_id#63, i_category_id#64, sum#68, isEmpty#69, count#70]
+Arguments: hashpartitioning(i_brand_id#62, i_class_id#63, i_category_id#64, 5), ENSURE_REQUIREMENTS, [plan_id=12]
 
 (86) HashAggregate [codegen id : 75]
-Input [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#67, isEmpty#68, count#69]
-Keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
+Input [6]: [i_brand_id#62, i_class_id#63, i_category_id#64, sum#68, isEmpty#69, count#70]
+Keys [3]: [i_brand_id#62, i_class_id#63, i_category_id#64]
 Functions [2]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56)), count(1)]
-Aggregate Attributes [2]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#70, count(1)#71]
-Results [6]: [store AS channel#72, i_brand_id#61, i_class_id#62, i_category_id#63, sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#70 AS sales#73, count(1)#71 AS number_sales#74]
+Aggregate Attributes [2]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#71, count(1)#72]
+Results [6]: [store AS channel#73, i_brand_id#62, i_class_id#63, i_category_id#64, sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#71 AS sales#74, count(1)#72 AS number_sales#75]
 
 (87) Filter [codegen id : 75]
-Input [6]: [channel#72, i_brand_id#61, i_class_id#62, i_category_id#63, sales#73, number_sales#74]
-Condition : (isnotnull(sales#73) AND (cast(sales#73 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
+Input [6]: [channel#73, i_brand_id#62, i_class_id#63, i_category_id#64, sales#74, number_sales#75]
+Condition : (isnotnull(sales#74) AND (cast(sales#74 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
 
 (88) BroadcastExchange
-Input [6]: [channel#72, i_brand_id#61, i_class_id#62, i_category_id#63, sales#73, number_sales#74]
+Input [6]: [channel#73, i_brand_id#62, i_class_id#63, i_category_id#64, sales#74, number_sales#75]
 Arguments: HashedRelationBroadcastMode(List(input[1, int, true], input[2, int, true], input[3, int, true]),false), [plan_id=13]
 
 (89) BroadcastHashJoin [codegen id : 76]
 Left keys [3]: [i_brand_id#38, i_class_id#39, i_category_id#40]
-Right keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
+Right keys [3]: [i_brand_id#62, i_class_id#63, i_category_id#64]
 Join type: Inner
 Join condition: None
 
 (90) TakeOrderedAndProject
-Input [12]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sales#50, number_sales#51, channel#72, i_brand_id#61, i_class_id#62, i_category_id#63, sales#73, number_sales#74]
-Arguments: 100, [i_brand_id#38 ASC NULLS FIRST, i_class_id#39 ASC NULLS FIRST, i_category_id#40 ASC NULLS FIRST], [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sales#50, number_sales#51, channel#72, i_brand_id#61, i_class_id#62, i_category_id#63, sales#73, number_sales#74]
+Input [12]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sales#50, number_sales#51, channel#73, i_brand_id#62, i_class_id#63, i_category_id#64, sales#74, number_sales#75]
+Arguments: 100, [i_brand_id#38 ASC NULLS FIRST, i_class_id#39 ASC NULLS FIRST, i_category_id#40 ASC NULLS FIRST], [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sales#50, number_sales#51, channel#73, i_brand_id#62, i_class_id#63, i_category_id#64, sales#74, number_sales#75]
 
 ===== Subqueries =====
 
@@ -542,99 +542,99 @@ Subquery:1 Hosting operator id = 72 Hosting Expression = Subquery scalar-subquer
 
 
 (91) Scan parquet spark_catalog.default.store_sales
-Output [3]: [ss_quantity#75, ss_list_price#76, ss_sold_date_sk#77]
+Output [3]: [ss_quantity#76, ss_list_price#77, ss_sold_date_sk#78]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#77), dynamicpruningexpression(ss_sold_date_sk#77 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#78), dynamicpruningexpression(ss_sold_date_sk#78 IN dynamicpruning#12)]
 ReadSchema: struct<ss_quantity:int,ss_list_price:decimal(7,2)>
 
 (92) ColumnarToRow [codegen id : 2]
-Input [3]: [ss_quantity#75, ss_list_price#76, ss_sold_date_sk#77]
+Input [3]: [ss_quantity#76, ss_list_price#77, ss_sold_date_sk#78]
 
 (93) ReusedExchange [Reuses operator id: 123]
-Output [1]: [d_date_sk#78]
+Output [1]: [d_date_sk#79]
 
 (94) BroadcastHashJoin [codegen id : 2]
-Left keys [1]: [ss_sold_date_sk#77]
-Right keys [1]: [d_date_sk#78]
+Left keys [1]: [ss_sold_date_sk#78]
+Right keys [1]: [d_date_sk#79]
 Join type: Inner
 Join condition: None
 
 (95) Project [codegen id : 2]
-Output [2]: [ss_quantity#75 AS quantity#79, ss_list_price#76 AS list_price#80]
-Input [4]: [ss_quantity#75, ss_list_price#76, ss_sold_date_sk#77, d_date_sk#78]
+Output [2]: [ss_quantity#76 AS quantity#80, ss_list_price#77 AS list_price#81]
+Input [4]: [ss_quantity#76, ss_list_price#77, ss_sold_date_sk#78, d_date_sk#79]
 
 (96) Scan parquet spark_catalog.default.catalog_sales
-Output [3]: [cs_quantity#81, cs_list_price#82, cs_sold_date_sk#83]
+Output [3]: [cs_quantity#82, cs_list_price#83, cs_sold_date_sk#84]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#83), dynamicpruningexpression(cs_sold_date_sk#83 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#84), dynamicpruningexpression(cs_sold_date_sk#84 IN dynamicpruning#12)]
 ReadSchema: struct<cs_quantity:int,cs_list_price:decimal(7,2)>
 
 (97) ColumnarToRow [codegen id : 4]
-Input [3]: [cs_quantity#81, cs_list_price#82, cs_sold_date_sk#83]
+Input [3]: [cs_quantity#82, cs_list_price#83, cs_sold_date_sk#84]
 
 (98) ReusedExchange [Reuses operator id: 123]
-Output [1]: [d_date_sk#84]
+Output [1]: [d_date_sk#85]
 
 (99) BroadcastHashJoin [codegen id : 4]
-Left keys [1]: [cs_sold_date_sk#83]
-Right keys [1]: [d_date_sk#84]
+Left keys [1]: [cs_sold_date_sk#84]
+Right keys [1]: [d_date_sk#85]
 Join type: Inner
 Join condition: None
 
 (100) Project [codegen id : 4]
-Output [2]: [cs_quantity#81 AS quantity#85, cs_list_price#82 AS list_price#86]
-Input [4]: [cs_quantity#81, cs_list_price#82, cs_sold_date_sk#83, d_date_sk#84]
+Output [2]: [cs_quantity#82 AS quantity#86, cs_list_price#83 AS list_price#87]
+Input [4]: [cs_quantity#82, cs_list_price#83, cs_sold_date_sk#84, d_date_sk#85]
 
 (101) Scan parquet spark_catalog.default.web_sales
-Output [3]: [ws_quantity#87, ws_list_price#88, ws_sold_date_sk#89]
+Output [3]: [ws_quantity#88, ws_list_price#89, ws_sold_date_sk#90]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#89), dynamicpruningexpression(ws_sold_date_sk#89 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#90), dynamicpruningexpression(ws_sold_date_sk#90 IN dynamicpruning#12)]
 ReadSchema: struct<ws_quantity:int,ws_list_price:decimal(7,2)>
 
 (102) ColumnarToRow [codegen id : 6]
-Input [3]: [ws_quantity#87, ws_list_price#88, ws_sold_date_sk#89]
+Input [3]: [ws_quantity#88, ws_list_price#89, ws_sold_date_sk#90]
 
 (103) ReusedExchange [Reuses operator id: 123]
-Output [1]: [d_date_sk#90]
+Output [1]: [d_date_sk#91]
 
 (104) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [ws_sold_date_sk#89]
-Right keys [1]: [d_date_sk#90]
+Left keys [1]: [ws_sold_date_sk#90]
+Right keys [1]: [d_date_sk#91]
 Join type: Inner
 Join condition: None
 
 (105) Project [codegen id : 6]
-Output [2]: [ws_quantity#87 AS quantity#91, ws_list_price#88 AS list_price#92]
-Input [4]: [ws_quantity#87, ws_list_price#88, ws_sold_date_sk#89, d_date_sk#90]
+Output [2]: [ws_quantity#88 AS quantity#92, ws_list_price#89 AS list_price#93]
+Input [4]: [ws_quantity#88, ws_list_price#89, ws_sold_date_sk#90, d_date_sk#91]
 
 (106) Union
 
 (107) HashAggregate [codegen id : 7]
-Input [2]: [quantity#79, list_price#80]
+Input [2]: [quantity#80, list_price#81]
 Keys: []
-Functions [1]: [partial_avg((cast(quantity#79 as decimal(10,0)) * list_price#80))]
-Aggregate Attributes [2]: [sum#93, count#94]
-Results [2]: [sum#95, count#96]
+Functions [1]: [partial_avg((cast(quantity#80 as decimal(10,0)) * list_price#81))]
+Aggregate Attributes [2]: [sum#94, count#95]
+Results [2]: [sum#96, count#97]
 
 (108) Exchange
-Input [2]: [sum#95, count#96]
+Input [2]: [sum#96, count#97]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=14]
 
 (109) HashAggregate [codegen id : 8]
-Input [2]: [sum#95, count#96]
+Input [2]: [sum#96, count#97]
 Keys: []
-Functions [1]: [avg((cast(quantity#79 as decimal(10,0)) * list_price#80))]
-Aggregate Attributes [1]: [avg((cast(quantity#79 as decimal(10,0)) * list_price#80))#97]
-Results [1]: [avg((cast(quantity#79 as decimal(10,0)) * list_price#80))#97 AS average_sales#98]
+Functions [1]: [avg((cast(quantity#80 as decimal(10,0)) * list_price#81))]
+Aggregate Attributes [1]: [avg((cast(quantity#80 as decimal(10,0)) * list_price#81))#98]
+Results [1]: [avg((cast(quantity#80 as decimal(10,0)) * list_price#81))#98 AS average_sales#99]
 
-Subquery:2 Hosting operator id = 91 Hosting Expression = ss_sold_date_sk#77 IN dynamicpruning#12
+Subquery:2 Hosting operator id = 91 Hosting Expression = ss_sold_date_sk#78 IN dynamicpruning#12
 
-Subquery:3 Hosting operator id = 96 Hosting Expression = cs_sold_date_sk#83 IN dynamicpruning#12
+Subquery:3 Hosting operator id = 96 Hosting Expression = cs_sold_date_sk#84 IN dynamicpruning#12
 
-Subquery:4 Hosting operator id = 101 Hosting Expression = ws_sold_date_sk#89 IN dynamicpruning#12
+Subquery:4 Hosting operator id = 101 Hosting Expression = ws_sold_date_sk#90 IN dynamicpruning#12
 
 Subquery:5 Hosting operator id = 1 Hosting Expression = ss_sold_date_sk#4 IN dynamicpruning#5
 BroadcastExchange (114)
@@ -645,28 +645,28 @@ BroadcastExchange (114)
 
 
 (110) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#36, d_week_seq#99]
+Output [2]: [d_date_sk#36, d_week_seq#100]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_week_seq:int>
 
 (111) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#36, d_week_seq#99]
+Input [2]: [d_date_sk#36, d_week_seq#100]
 
 (112) Filter [codegen id : 1]
-Input [2]: [d_date_sk#36, d_week_seq#99]
-Condition : ((isnotnull(d_week_seq#99) AND (d_week_seq#99 = Subquery scalar-subquery#100, [id=#101])) AND isnotnull(d_date_sk#36))
+Input [2]: [d_date_sk#36, d_week_seq#100]
+Condition : ((isnotnull(d_week_seq#100) AND (d_week_seq#100 = Subquery scalar-subquery#101, [id=#102])) AND isnotnull(d_date_sk#36))
 
 (113) Project [codegen id : 1]
 Output [1]: [d_date_sk#36]
-Input [2]: [d_date_sk#36, d_week_seq#99]
+Input [2]: [d_date_sk#36, d_week_seq#100]
 
 (114) BroadcastExchange
 Input [1]: [d_date_sk#36]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=15]
 
-Subquery:6 Hosting operator id = 112 Hosting Expression = Subquery scalar-subquery#100, [id=#101]
+Subquery:6 Hosting operator id = 112 Hosting Expression = Subquery scalar-subquery#101, [id=#102]
 * Project (118)
 +- * Filter (117)
    +- * ColumnarToRow (116)
@@ -674,22 +674,22 @@ Subquery:6 Hosting operator id = 112 Hosting Expression = Subquery scalar-subque
 
 
 (115) Scan parquet spark_catalog.default.date_dim
-Output [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
+Output [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), EqualTo(d_dom,11)]
 ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
 
 (116) ColumnarToRow [codegen id : 1]
-Input [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
+Input [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
 
 (117) Filter [codegen id : 1]
-Input [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
-Condition : (((((isnotnull(d_year#103) AND isnotnull(d_moy#104)) AND isnotnull(d_dom#105)) AND (d_year#103 = 2000)) AND (d_moy#104 = 12)) AND (d_dom#105 = 11))
+Input [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
+Condition : (((((isnotnull(d_year#104) AND isnotnull(d_moy#105)) AND isnotnull(d_dom#106)) AND (d_year#104 = 2000)) AND (d_moy#105 = 12)) AND (d_dom#106 = 11))
 
 (118) Project [codegen id : 1]
-Output [1]: [d_week_seq#102]
-Input [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
+Output [1]: [d_week_seq#103]
+Input [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
 
 Subquery:7 Hosting operator id = 7 Hosting Expression = ss_sold_date_sk#11 IN dynamicpruning#12
 BroadcastExchange (123)
@@ -700,22 +700,22 @@ BroadcastExchange (123)
 
 
 (119) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#13, d_year#106]
+Output [2]: [d_date_sk#13, d_year#107]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (120) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#13, d_year#106]
+Input [2]: [d_date_sk#13, d_year#107]
 
 (121) Filter [codegen id : 1]
-Input [2]: [d_date_sk#13, d_year#106]
-Condition : (((isnotnull(d_year#106) AND (d_year#106 >= 1999)) AND (d_year#106 <= 2001)) AND isnotnull(d_date_sk#13))
+Input [2]: [d_date_sk#13, d_year#107]
+Condition : (((isnotnull(d_year#107) AND (d_year#107 >= 1999)) AND (d_year#107 <= 2001)) AND isnotnull(d_date_sk#13))
 
 (122) Project [codegen id : 1]
 Output [1]: [d_date_sk#13]
-Input [2]: [d_date_sk#13, d_year#106]
+Input [2]: [d_date_sk#13, d_year#107]
 
 (123) BroadcastExchange
 Input [1]: [d_date_sk#13]
@@ -736,28 +736,28 @@ BroadcastExchange (128)
 
 
 (124) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#59, d_week_seq#107]
+Output [2]: [d_date_sk#60, d_week_seq#108]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_week_seq:int>
 
 (125) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#59, d_week_seq#107]
+Input [2]: [d_date_sk#60, d_week_seq#108]
 
 (126) Filter [codegen id : 1]
-Input [2]: [d_date_sk#59, d_week_seq#107]
-Condition : ((isnotnull(d_week_seq#107) AND (d_week_seq#107 = Subquery scalar-subquery#108, [id=#109])) AND isnotnull(d_date_sk#59))
+Input [2]: [d_date_sk#60, d_week_seq#108]
+Condition : ((isnotnull(d_week_seq#108) AND (d_week_seq#108 = Subquery scalar-subquery#109, [id=#110])) AND isnotnull(d_date_sk#60))
 
 (127) Project [codegen id : 1]
-Output [1]: [d_date_sk#59]
-Input [2]: [d_date_sk#59, d_week_seq#107]
+Output [1]: [d_date_sk#60]
+Input [2]: [d_date_sk#60, d_week_seq#108]
 
 (128) BroadcastExchange
-Input [1]: [d_date_sk#59]
+Input [1]: [d_date_sk#60]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=17]
 
-Subquery:12 Hosting operator id = 126 Hosting Expression = Subquery scalar-subquery#108, [id=#109]
+Subquery:12 Hosting operator id = 126 Hosting Expression = Subquery scalar-subquery#109, [id=#110]
 * Project (132)
 +- * Filter (131)
    +- * ColumnarToRow (130)
@@ -765,21 +765,21 @@ Subquery:12 Hosting operator id = 126 Hosting Expression = Subquery scalar-subqu
 
 
 (129) Scan parquet spark_catalog.default.date_dim
-Output [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
+Output [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), EqualTo(d_dom,11)]
 ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
 
 (130) ColumnarToRow [codegen id : 1]
-Input [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
+Input [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
 
 (131) Filter [codegen id : 1]
-Input [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
-Condition : (((((isnotnull(d_year#111) AND isnotnull(d_moy#112)) AND isnotnull(d_dom#113)) AND (d_year#111 = 1999)) AND (d_moy#112 = 12)) AND (d_dom#113 = 11))
+Input [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
+Condition : (((((isnotnull(d_year#112) AND isnotnull(d_moy#113)) AND isnotnull(d_dom#114)) AND (d_year#112 = 1999)) AND (d_moy#113 = 12)) AND (d_dom#114 = 11))
 
 (132) Project [codegen id : 1]
-Output [1]: [d_week_seq#110]
-Input [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
+Output [1]: [d_week_seq#111]
+Input [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14b/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14b/explain.txt
index bc2fc87cb14..4239018abff 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14b/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q14b/explain.txt
@@ -417,75 +417,75 @@ Input [4]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57]
 Condition : isnotnull(ss_item_sk#54)
 
 (70) ReusedExchange [Reuses operator id: 50]
-Output [1]: [ss_item_sk#35]
+Output [1]: [ss_item_sk#59]
 
 (71) BroadcastHashJoin [codegen id : 50]
 Left keys [1]: [ss_item_sk#54]
-Right keys [1]: [ss_item_sk#35]
+Right keys [1]: [ss_item_sk#59]
 Join type: LeftSemi
 Join condition: None
 
 (72) ReusedExchange [Reuses operator id: 57]
-Output [4]: [i_item_sk#59, i_brand_id#60, i_class_id#61, i_category_id#62]
+Output [4]: [i_item_sk#60, i_brand_id#61, i_class_id#62, i_category_id#63]
 
 (73) BroadcastHashJoin [codegen id : 50]
 Left keys [1]: [ss_item_sk#54]
-Right keys [1]: [i_item_sk#59]
+Right keys [1]: [i_item_sk#60]
 Join type: Inner
 Join condition: None
 
 (74) Project [codegen id : 50]
-Output [6]: [ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, i_brand_id#60, i_class_id#61, i_category_id#62]
-Input [8]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, i_item_sk#59, i_brand_id#60, i_class_id#61, i_category_id#62]
+Output [6]: [ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, i_brand_id#61, i_class_id#62, i_category_id#63]
+Input [8]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, i_item_sk#60, i_brand_id#61, i_class_id#62, i_category_id#63]
 
 (75) ReusedExchange [Reuses operator id: 122]
-Output [1]: [d_date_sk#63]
+Output [1]: [d_date_sk#64]
 
 (76) BroadcastHashJoin [codegen id : 50]
 Left keys [1]: [ss_sold_date_sk#57]
-Right keys [1]: [d_date_sk#63]
+Right keys [1]: [d_date_sk#64]
 Join type: Inner
 Join condition: None
 
 (77) Project [codegen id : 50]
-Output [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#60, i_class_id#61, i_category_id#62]
-Input [7]: [ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, i_brand_id#60, i_class_id#61, i_category_id#62, d_date_sk#63]
+Output [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#61, i_class_id#62, i_category_id#63]
+Input [7]: [ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, i_brand_id#61, i_class_id#62, i_category_id#63, d_date_sk#64]
 
 (78) HashAggregate [codegen id : 50]
-Input [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#60, i_class_id#61, i_category_id#62]
-Keys [3]: [i_brand_id#60, i_class_id#61, i_category_id#62]
+Input [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#61, i_class_id#62, i_category_id#63]
+Keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
 Functions [2]: [partial_sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56)), partial_count(1)]
-Aggregate Attributes [3]: [sum#64, isEmpty#65, count#66]
-Results [6]: [i_brand_id#60, i_class_id#61, i_category_id#62, sum#67, isEmpty#68, count#69]
+Aggregate Attributes [3]: [sum#65, isEmpty#66, count#67]
+Results [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#68, isEmpty#69, count#70]
 
 (79) Exchange
-Input [6]: [i_brand_id#60, i_class_id#61, i_category_id#62, sum#67, isEmpty#68, count#69]
-Arguments: hashpartitioning(i_brand_id#60, i_class_id#61, i_category_id#62, 5), ENSURE_REQUIREMENTS, [plan_id=10]
+Input [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#68, isEmpty#69, count#70]
+Arguments: hashpartitioning(i_brand_id#61, i_class_id#62, i_category_id#63, 5), ENSURE_REQUIREMENTS, [plan_id=10]
 
 (80) HashAggregate [codegen id : 51]
-Input [6]: [i_brand_id#60, i_class_id#61, i_category_id#62, sum#67, isEmpty#68, count#69]
-Keys [3]: [i_brand_id#60, i_class_id#61, i_category_id#62]
+Input [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#68, isEmpty#69, count#70]
+Keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
 Functions [2]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56)), count(1)]
-Aggregate Attributes [2]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#70, count(1)#71]
-Results [6]: [store AS channel#72, i_brand_id#60, i_class_id#61, i_category_id#62, sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#70 AS sales#73, count(1)#71 AS number_sales#74]
+Aggregate Attributes [2]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#71, count(1)#72]
+Results [6]: [store AS channel#73, i_brand_id#61, i_class_id#62, i_category_id#63, sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#71 AS sales#74, count(1)#72 AS number_sales#75]
 
 (81) Filter [codegen id : 51]
-Input [6]: [channel#72, i_brand_id#60, i_class_id#61, i_category_id#62, sales#73, number_sales#74]
-Condition : (isnotnull(sales#73) AND (cast(sales#73 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
+Input [6]: [channel#73, i_brand_id#61, i_class_id#62, i_category_id#63, sales#74, number_sales#75]
+Condition : (isnotnull(sales#74) AND (cast(sales#74 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
 
 (82) BroadcastExchange
-Input [6]: [channel#72, i_brand_id#60, i_class_id#61, i_category_id#62, sales#73, number_sales#74]
+Input [6]: [channel#73, i_brand_id#61, i_class_id#62, i_category_id#63, sales#74, number_sales#75]
 Arguments: HashedRelationBroadcastMode(List(input[1, int, true], input[2, int, true], input[3, int, true]),false), [plan_id=11]
 
 (83) BroadcastHashJoin [codegen id : 52]
 Left keys [3]: [i_brand_id#37, i_class_id#38, i_category_id#39]
-Right keys [3]: [i_brand_id#60, i_class_id#61, i_category_id#62]
+Right keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
 Join type: Inner
 Join condition: None
 
 (84) TakeOrderedAndProject
-Input [12]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sales#50, number_sales#51, channel#72, i_brand_id#60, i_class_id#61, i_category_id#62, sales#73, number_sales#74]
-Arguments: 100, [i_brand_id#37 ASC NULLS FIRST, i_class_id#38 ASC NULLS FIRST, i_category_id#39 ASC NULLS FIRST], [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sales#50, number_sales#51, channel#72, i_brand_id#60, i_class_id#61, i_category_id#62, sales#73, number_sales#74]
+Input [12]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sales#50, number_sales#51, channel#73, i_brand_id#61, i_class_id#62, i_category_id#63, sales#74, number_sales#75]
+Arguments: 100, [i_brand_id#37 ASC NULLS FIRST, i_class_id#38 ASC NULLS FIRST, i_category_id#39 ASC NULLS FIRST], [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sales#50, number_sales#51, channel#73, i_brand_id#61, i_class_id#62, i_category_id#63, sales#74, number_sales#75]
 
 ===== Subqueries =====
 
@@ -512,99 +512,99 @@ Subquery:1 Hosting operator id = 66 Hosting Expression = Subquery scalar-subquer
 
 
 (85) Scan parquet spark_catalog.default.store_sales
-Output [3]: [ss_quantity#75, ss_list_price#76, ss_sold_date_sk#77]
+Output [3]: [ss_quantity#76, ss_list_price#77, ss_sold_date_sk#78]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#77), dynamicpruningexpression(ss_sold_date_sk#77 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#78), dynamicpruningexpression(ss_sold_date_sk#78 IN dynamicpruning#12)]
 ReadSchema: struct<ss_quantity:int,ss_list_price:decimal(7,2)>
 
 (86) ColumnarToRow [codegen id : 2]
-Input [3]: [ss_quantity#75, ss_list_price#76, ss_sold_date_sk#77]
+Input [3]: [ss_quantity#76, ss_list_price#77, ss_sold_date_sk#78]
 
 (87) ReusedExchange [Reuses operator id: 117]
-Output [1]: [d_date_sk#78]
+Output [1]: [d_date_sk#79]
 
 (88) BroadcastHashJoin [codegen id : 2]
-Left keys [1]: [ss_sold_date_sk#77]
-Right keys [1]: [d_date_sk#78]
+Left keys [1]: [ss_sold_date_sk#78]
+Right keys [1]: [d_date_sk#79]
 Join type: Inner
 Join condition: None
 
 (89) Project [codegen id : 2]
-Output [2]: [ss_quantity#75 AS quantity#79, ss_list_price#76 AS list_price#80]
-Input [4]: [ss_quantity#75, ss_list_price#76, ss_sold_date_sk#77, d_date_sk#78]
+Output [2]: [ss_quantity#76 AS quantity#80, ss_list_price#77 AS list_price#81]
+Input [4]: [ss_quantity#76, ss_list_price#77, ss_sold_date_sk#78, d_date_sk#79]
 
 (90) Scan parquet spark_catalog.default.catalog_sales
-Output [3]: [cs_quantity#81, cs_list_price#82, cs_sold_date_sk#83]
+Output [3]: [cs_quantity#82, cs_list_price#83, cs_sold_date_sk#84]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#83), dynamicpruningexpression(cs_sold_date_sk#83 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#84), dynamicpruningexpression(cs_sold_date_sk#84 IN dynamicpruning#12)]
 ReadSchema: struct<cs_quantity:int,cs_list_price:decimal(7,2)>
 
 (91) ColumnarToRow [codegen id : 4]
-Input [3]: [cs_quantity#81, cs_list_price#82, cs_sold_date_sk#83]
+Input [3]: [cs_quantity#82, cs_list_price#83, cs_sold_date_sk#84]
 
 (92) ReusedExchange [Reuses operator id: 117]
-Output [1]: [d_date_sk#84]
+Output [1]: [d_date_sk#85]
 
 (93) BroadcastHashJoin [codegen id : 4]
-Left keys [1]: [cs_sold_date_sk#83]
-Right keys [1]: [d_date_sk#84]
+Left keys [1]: [cs_sold_date_sk#84]
+Right keys [1]: [d_date_sk#85]
 Join type: Inner
 Join condition: None
 
 (94) Project [codegen id : 4]
-Output [2]: [cs_quantity#81 AS quantity#85, cs_list_price#82 AS list_price#86]
-Input [4]: [cs_quantity#81, cs_list_price#82, cs_sold_date_sk#83, d_date_sk#84]
+Output [2]: [cs_quantity#82 AS quantity#86, cs_list_price#83 AS list_price#87]
+Input [4]: [cs_quantity#82, cs_list_price#83, cs_sold_date_sk#84, d_date_sk#85]
 
 (95) Scan parquet spark_catalog.default.web_sales
-Output [3]: [ws_quantity#87, ws_list_price#88, ws_sold_date_sk#89]
+Output [3]: [ws_quantity#88, ws_list_price#89, ws_sold_date_sk#90]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#89), dynamicpruningexpression(ws_sold_date_sk#89 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#90), dynamicpruningexpression(ws_sold_date_sk#90 IN dynamicpruning#12)]
 ReadSchema: struct<ws_quantity:int,ws_list_price:decimal(7,2)>
 
 (96) ColumnarToRow [codegen id : 6]
-Input [3]: [ws_quantity#87, ws_list_price#88, ws_sold_date_sk#89]
+Input [3]: [ws_quantity#88, ws_list_price#89, ws_sold_date_sk#90]
 
 (97) ReusedExchange [Reuses operator id: 117]
-Output [1]: [d_date_sk#90]
+Output [1]: [d_date_sk#91]
 
 (98) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [ws_sold_date_sk#89]
-Right keys [1]: [d_date_sk#90]
+Left keys [1]: [ws_sold_date_sk#90]
+Right keys [1]: [d_date_sk#91]
 Join type: Inner
 Join condition: None
 
 (99) Project [codegen id : 6]
-Output [2]: [ws_quantity#87 AS quantity#91, ws_list_price#88 AS list_price#92]
-Input [4]: [ws_quantity#87, ws_list_price#88, ws_sold_date_sk#89, d_date_sk#90]
+Output [2]: [ws_quantity#88 AS quantity#92, ws_list_price#89 AS list_price#93]
+Input [4]: [ws_quantity#88, ws_list_price#89, ws_sold_date_sk#90, d_date_sk#91]
 
 (100) Union
 
 (101) HashAggregate [codegen id : 7]
-Input [2]: [quantity#79, list_price#80]
+Input [2]: [quantity#80, list_price#81]
 Keys: []
-Functions [1]: [partial_avg((cast(quantity#79 as decimal(10,0)) * list_price#80))]
-Aggregate Attributes [2]: [sum#93, count#94]
-Results [2]: [sum#95, count#96]
+Functions [1]: [partial_avg((cast(quantity#80 as decimal(10,0)) * list_price#81))]
+Aggregate Attributes [2]: [sum#94, count#95]
+Results [2]: [sum#96, count#97]
 
 (102) Exchange
-Input [2]: [sum#95, count#96]
+Input [2]: [sum#96, count#97]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=12]
 
 (103) HashAggregate [codegen id : 8]
-Input [2]: [sum#95, count#96]
+Input [2]: [sum#96, count#97]
 Keys: []
-Functions [1]: [avg((cast(quantity#79 as decimal(10,0)) * list_price#80))]
-Aggregate Attributes [1]: [avg((cast(quantity#79 as decimal(10,0)) * list_price#80))#97]
-Results [1]: [avg((cast(quantity#79 as decimal(10,0)) * list_price#80))#97 AS average_sales#98]
+Functions [1]: [avg((cast(quantity#80 as decimal(10,0)) * list_price#81))]
+Aggregate Attributes [1]: [avg((cast(quantity#80 as decimal(10,0)) * list_price#81))#98]
+Results [1]: [avg((cast(quantity#80 as decimal(10,0)) * list_price#81))#98 AS average_sales#99]
 
-Subquery:2 Hosting operator id = 85 Hosting Expression = ss_sold_date_sk#77 IN dynamicpruning#12
+Subquery:2 Hosting operator id = 85 Hosting Expression = ss_sold_date_sk#78 IN dynamicpruning#12
 
-Subquery:3 Hosting operator id = 90 Hosting Expression = cs_sold_date_sk#83 IN dynamicpruning#12
+Subquery:3 Hosting operator id = 90 Hosting Expression = cs_sold_date_sk#84 IN dynamicpruning#12
 
-Subquery:4 Hosting operator id = 95 Hosting Expression = ws_sold_date_sk#89 IN dynamicpruning#12
+Subquery:4 Hosting operator id = 95 Hosting Expression = ws_sold_date_sk#90 IN dynamicpruning#12
 
 Subquery:5 Hosting operator id = 1 Hosting Expression = ss_sold_date_sk#4 IN dynamicpruning#5
 BroadcastExchange (108)
@@ -615,28 +615,28 @@ BroadcastExchange (108)
 
 
 (104) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#40, d_week_seq#99]
+Output [2]: [d_date_sk#40, d_week_seq#100]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_week_seq:int>
 
 (105) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#40, d_week_seq#99]
+Input [2]: [d_date_sk#40, d_week_seq#100]
 
 (106) Filter [codegen id : 1]
-Input [2]: [d_date_sk#40, d_week_seq#99]
-Condition : ((isnotnull(d_week_seq#99) AND (d_week_seq#99 = Subquery scalar-subquery#100, [id=#101])) AND isnotnull(d_date_sk#40))
+Input [2]: [d_date_sk#40, d_week_seq#100]
+Condition : ((isnotnull(d_week_seq#100) AND (d_week_seq#100 = Subquery scalar-subquery#101, [id=#102])) AND isnotnull(d_date_sk#40))
 
 (107) Project [codegen id : 1]
 Output [1]: [d_date_sk#40]
-Input [2]: [d_date_sk#40, d_week_seq#99]
+Input [2]: [d_date_sk#40, d_week_seq#100]
 
 (108) BroadcastExchange
 Input [1]: [d_date_sk#40]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=13]
 
-Subquery:6 Hosting operator id = 106 Hosting Expression = Subquery scalar-subquery#100, [id=#101]
+Subquery:6 Hosting operator id = 106 Hosting Expression = Subquery scalar-subquery#101, [id=#102]
 * Project (112)
 +- * Filter (111)
    +- * ColumnarToRow (110)
@@ -644,22 +644,22 @@ Subquery:6 Hosting operator id = 106 Hosting Expression = Subquery scalar-subque
 
 
 (109) Scan parquet spark_catalog.default.date_dim
-Output [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
+Output [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), EqualTo(d_dom,11)]
 ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
 
 (110) ColumnarToRow [codegen id : 1]
-Input [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
+Input [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
 
 (111) Filter [codegen id : 1]
-Input [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
-Condition : (((((isnotnull(d_year#103) AND isnotnull(d_moy#104)) AND isnotnull(d_dom#105)) AND (d_year#103 = 2000)) AND (d_moy#104 = 12)) AND (d_dom#105 = 11))
+Input [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
+Condition : (((((isnotnull(d_year#104) AND isnotnull(d_moy#105)) AND isnotnull(d_dom#106)) AND (d_year#104 = 2000)) AND (d_moy#105 = 12)) AND (d_dom#106 = 11))
 
 (112) Project [codegen id : 1]
-Output [1]: [d_week_seq#102]
-Input [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
+Output [1]: [d_week_seq#103]
+Input [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
 
 Subquery:7 Hosting operator id = 7 Hosting Expression = ss_sold_date_sk#11 IN dynamicpruning#12
 BroadcastExchange (117)
@@ -670,22 +670,22 @@ BroadcastExchange (117)
 
 
 (113) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#24, d_year#106]
+Output [2]: [d_date_sk#24, d_year#107]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (114) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#24, d_year#106]
+Input [2]: [d_date_sk#24, d_year#107]
 
 (115) Filter [codegen id : 1]
-Input [2]: [d_date_sk#24, d_year#106]
-Condition : (((isnotnull(d_year#106) AND (d_year#106 >= 1999)) AND (d_year#106 <= 2001)) AND isnotnull(d_date_sk#24))
+Input [2]: [d_date_sk#24, d_year#107]
+Condition : (((isnotnull(d_year#107) AND (d_year#107 >= 1999)) AND (d_year#107 <= 2001)) AND isnotnull(d_date_sk#24))
 
 (116) Project [codegen id : 1]
 Output [1]: [d_date_sk#24]
-Input [2]: [d_date_sk#24, d_year#106]
+Input [2]: [d_date_sk#24, d_year#107]
 
 (117) BroadcastExchange
 Input [1]: [d_date_sk#24]
@@ -706,28 +706,28 @@ BroadcastExchange (122)
 
 
 (118) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#63, d_week_seq#107]
+Output [2]: [d_date_sk#64, d_week_seq#108]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_week_seq:int>
 
 (119) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#63, d_week_seq#107]
+Input [2]: [d_date_sk#64, d_week_seq#108]
 
 (120) Filter [codegen id : 1]
-Input [2]: [d_date_sk#63, d_week_seq#107]
-Condition : ((isnotnull(d_week_seq#107) AND (d_week_seq#107 = Subquery scalar-subquery#108, [id=#109])) AND isnotnull(d_date_sk#63))
+Input [2]: [d_date_sk#64, d_week_seq#108]
+Condition : ((isnotnull(d_week_seq#108) AND (d_week_seq#108 = Subquery scalar-subquery#109, [id=#110])) AND isnotnull(d_date_sk#64))
 
 (121) Project [codegen id : 1]
-Output [1]: [d_date_sk#63]
-Input [2]: [d_date_sk#63, d_week_seq#107]
+Output [1]: [d_date_sk#64]
+Input [2]: [d_date_sk#64, d_week_seq#108]
 
 (122) BroadcastExchange
-Input [1]: [d_date_sk#63]
+Input [1]: [d_date_sk#64]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=15]
 
-Subquery:12 Hosting operator id = 120 Hosting Expression = Subquery scalar-subquery#108, [id=#109]
+Subquery:12 Hosting operator id = 120 Hosting Expression = Subquery scalar-subquery#109, [id=#110]
 * Project (126)
 +- * Filter (125)
    +- * ColumnarToRow (124)
@@ -735,21 +735,21 @@ Subquery:12 Hosting operator id = 120 Hosting Expression = Subquery scalar-subqu
 
 
 (123) Scan parquet spark_catalog.default.date_dim
-Output [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
+Output [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), EqualTo(d_dom,11)]
 ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
 
 (124) ColumnarToRow [codegen id : 1]
-Input [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
+Input [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
 
 (125) Filter [codegen id : 1]
-Input [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
-Condition : (((((isnotnull(d_year#111) AND isnotnull(d_moy#112)) AND isnotnull(d_dom#113)) AND (d_year#111 = 1999)) AND (d_moy#112 = 12)) AND (d_dom#113 = 11))
+Input [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
+Condition : (((((isnotnull(d_year#112) AND isnotnull(d_moy#113)) AND isnotnull(d_dom#114)) AND (d_year#112 = 1999)) AND (d_moy#113 = 12)) AND (d_dom#114 = 11))
 
 (126) Project [codegen id : 1]
-Output [1]: [d_week_seq#110]
-Input [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
+Output [1]: [d_week_seq#111]
+Input [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q2.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q2.sf100/explain.txt
index 3b189de7d34..c638699b275 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q2.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q2.sf100/explain.txt
@@ -161,133 +161,133 @@ Output [8]: [d_week_seq#10 AS d_week_seq1#44, sun_sales#35 AS sun_sales1#45, mon
 Input [9]: [d_week_seq#10, sun_sales#35, mon_sales#36, tue_sales#37, wed_sales#38, thu_sales#39, fri_sales#40, sat_sales#41, d_week_seq#42]
 
 (24) Scan parquet spark_catalog.default.web_sales
-Output [2]: [ws_ext_sales_price#1, ws_sold_date_sk#2]
+Output [2]: [ws_ext_sales_price#52, ws_sold_date_sk#53]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#2)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#53)]
 ReadSchema: struct<ws_ext_sales_price:decimal(7,2)>
 
 (25) ColumnarToRow [codegen id : 6]
-Input [2]: [ws_ext_sales_price#1, ws_sold_date_sk#2]
+Input [2]: [ws_ext_sales_price#52, ws_sold_date_sk#53]
 
 (26) Project [codegen id : 6]
-Output [2]: [ws_sold_date_sk#2 AS sold_date_sk#3, ws_ext_sales_price#1 AS sales_price#4]
-Input [2]: [ws_ext_sales_price#1, ws_sold_date_sk#2]
+Output [2]: [ws_sold_date_sk#53 AS sold_date_sk#3, ws_ext_sales_price#52 AS sales_price#4]
+Input [2]: [ws_ext_sales_price#52, ws_sold_date_sk#53]
 
 (27) Scan parquet spark_catalog.default.catalog_sales
-Output [2]: [cs_ext_sales_price#5, cs_sold_date_sk#6]
+Output [2]: [cs_ext_sales_price#54, cs_sold_date_sk#55]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#6)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#55)]
 ReadSchema: struct<cs_ext_sales_price:decimal(7,2)>
 
 (28) ColumnarToRow [codegen id : 7]
-Input [2]: [cs_ext_sales_price#5, cs_sold_date_sk#6]
+Input [2]: [cs_ext_sales_price#54, cs_sold_date_sk#55]
 
 (29) Project [codegen id : 7]
-Output [2]: [cs_sold_date_sk#6 AS sold_date_sk#7, cs_ext_sales_price#5 AS sales_price#8]
-Input [2]: [cs_ext_sales_price#5, cs_sold_date_sk#6]
+Output [2]: [cs_sold_date_sk#55 AS sold_date_sk#7, cs_ext_sales_price#54 AS sales_price#8]
+Input [2]: [cs_ext_sales_price#54, cs_sold_date_sk#55]
 
 (30) Union
 
 (31) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#9, d_week_seq#10, d_day_name#11]
+Output [3]: [d_date_sk#56, d_week_seq#57, d_day_name#58]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_date_sk), IsNotNull(d_week_seq)]
 ReadSchema: struct<d_date_sk:int,d_week_seq:int,d_day_name:string>
 
 (32) ColumnarToRow [codegen id : 8]
-Input [3]: [d_date_sk#9, d_week_seq#10, d_day_name#11]
+Input [3]: [d_date_sk#56, d_week_seq#57, d_day_name#58]
 
 (33) Filter [codegen id : 8]
-Input [3]: [d_date_sk#9, d_week_seq#10, d_day_name#11]
-Condition : ((isnotnull(d_date_sk#9) AND isnotnull(d_week_seq#10)) AND might_contain(Subquery scalar-subquery#52, [id=#53], xxhash64(d_week_seq#10, 42)))
+Input [3]: [d_date_sk#56, d_week_seq#57, d_day_name#58]
+Condition : ((isnotnull(d_date_sk#56) AND isnotnull(d_week_seq#57)) AND might_contain(Subquery scalar-subquery#59, [id=#60], xxhash64(d_week_seq#57, 42)))
 
 (34) BroadcastExchange
-Input [3]: [d_date_sk#9, d_week_seq#10, d_day_name#11]
+Input [3]: [d_date_sk#56, d_week_seq#57, d_day_name#58]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4]
 
 (35) BroadcastHashJoin [codegen id : 9]
 Left keys [1]: [sold_date_sk#3]
-Right keys [1]: [d_date_sk#9]
+Right keys [1]: [d_date_sk#56]
 Join type: Inner
 Join condition: None
 
 (36) Project [codegen id : 9]
-Output [3]: [sales_price#4, d_week_seq#10, d_day_name#11]
-Input [5]: [sold_date_sk#3, sales_price#4, d_date_sk#9, d_week_seq#10, d_day_name#11]
+Output [3]: [sales_price#4, d_week_seq#57, d_day_name#58]
+Input [5]: [sold_date_sk#3, sales_price#4, d_date_sk#56, d_week_seq#57, d_day_name#58]
 
 (37) HashAggregate [codegen id : 9]
-Input [3]: [sales_price#4, d_week_seq#10, d_day_name#11]
-Keys [1]: [d_week_seq#10]
-Functions [7]: [partial_sum(UnscaledValue(CASE WHEN (d_day_name#11 = Sunday   ) THEN sales_price#4 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#11 = Monday   ) THEN sales_price#4 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#11 = Tuesday  ) THEN sales_price#4 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#11 = Wednesday) THEN sales_price#4 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#11 = Thursday ) THEN sales_price#4 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#11 = Friday   ) THEN sales_price#4 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#11 = Saturday ) THEN sales_price#4 END))]
-Aggregate Attributes [7]: [sum#54, sum#55, sum#56, sum#57, sum#58, sum#59, sum#60]
-Results [8]: [d_week_seq#10, sum#61, sum#62, sum#63, sum#64, sum#65, sum#66, sum#67]
+Input [3]: [sales_price#4, d_week_seq#57, d_day_name#58]
+Keys [1]: [d_week_seq#57]
+Functions [7]: [partial_sum(UnscaledValue(CASE WHEN (d_day_name#58 = Sunday   ) THEN sales_price#4 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#58 = Monday   ) THEN sales_price#4 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#58 = Tuesday  ) THEN sales_price#4 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#58 = Wednesday) THEN sales_price#4 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#58 = Thursday ) THEN sales_price#4 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#58 = Friday   ) THEN sales_price#4 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#58 = Saturday ) THEN sales_price#4 END))]
+Aggregate Attributes [7]: [sum#61, sum#62, sum#63, sum#64, sum#65, sum#66, sum#67]
+Results [8]: [d_week_seq#57, sum#68, sum#69, sum#70, sum#71, sum#72, sum#73, sum#74]
 
 (38) Exchange
-Input [8]: [d_week_seq#10, sum#61, sum#62, sum#63, sum#64, sum#65, sum#66, sum#67]
-Arguments: hashpartitioning(d_week_seq#10, 5), ENSURE_REQUIREMENTS, [plan_id=5]
+Input [8]: [d_week_seq#57, sum#68, sum#69, sum#70, sum#71, sum#72, sum#73, sum#74]
+Arguments: hashpartitioning(d_week_seq#57, 5), ENSURE_REQUIREMENTS, [plan_id=5]
 
 (39) HashAggregate [codegen id : 11]
-Input [8]: [d_week_seq#10, sum#61, sum#62, sum#63, sum#64, sum#65, sum#66, sum#67]
-Keys [1]: [d_week_seq#10]
-Functions [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#11 = Sunday   ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#11 = Monday   ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#11 = Tuesday  ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#11 = Wednesday) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#11 = Thursday ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#11 = Friday   ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#11 = Saturday ) THEN sales_price#4 END))]
-Aggregate Attributes [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#11 = Sunday   ) THEN sales_price#4 END))#28, sum(UnscaledValue(CASE WHEN (d_day_name#11 = Monday   ) THEN sales_price#4 END))#29, sum(UnscaledValue(CASE WHEN (d_day_name#11 = Tuesday  ) THEN sales_price#4 END))#30, sum(UnscaledValue(CASE WHEN (d_day_name#11 = Wednesday) THEN sales_price#4 END))#31, sum(UnscaledValue(CASE WHEN (d_day_name#11 = Thursday ) THEN sales_price#4 END))#32, sum(UnscaledValue(CASE WHEN (d_day_name#11 = Friday   ) THEN sales_price#4 END))#33, sum(UnscaledValue(CASE WHEN (d_day_name#11 = Saturday ) THEN sales_price#4 END))#34]
-Results [8]: [d_week_seq#10, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Sunday   ) THEN sales_price#4 END))#28,17,2) AS sun_sales#35, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Monday   ) THEN sales_price#4 END))#29,17,2) AS mon_sales#36, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Tuesday  ) THEN sales_price#4 END))#30,17,2) AS tue_sales#37, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Wednesday) THEN sales_price#4 END))#31,17,2) AS wed_sales#38, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Thursday ) THEN sales_price#4 END))#32,17,2) AS thu_sales#39, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Friday   ) THEN sales_price#4 END))#33,17,2) AS fri_sales#40, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Saturday ) THEN sales_price#4 END))#34,17,2) AS sat_sales#41]
+Input [8]: [d_week_seq#57, sum#68, sum#69, sum#70, sum#71, sum#72, sum#73, sum#74]
+Keys [1]: [d_week_seq#57]
+Functions [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#58 = Sunday   ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#58 = Monday   ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#58 = Tuesday  ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#58 = Wednesday) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#58 = Thursday ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#58 = Friday   ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#58 = Saturday ) THEN sales_price#4 END))]
+Aggregate Attributes [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#58 = Sunday   ) THEN sales_price#4 END))#28, sum(UnscaledValue(CASE WHEN (d_day_name#58 = Monday   ) THEN sales_price#4 END))#29, sum(UnscaledValue(CASE WHEN (d_day_name#58 = Tuesday  ) THEN sales_price#4 END))#30, sum(UnscaledValue(CASE WHEN (d_day_name#58 = Wednesday) THEN sales_price#4 END))#31, sum(UnscaledValue(CASE WHEN (d_day_name#58 = Thursday ) THEN sales_price#4 END))#32, sum(UnscaledValue(CASE WHEN (d_day_name#58 = Friday   ) THEN sales_price#4 END))#33, sum(UnscaledValue(CASE WHEN (d_day_name#58 = Saturday ) THEN sales_price#4 END))#34]
+Results [8]: [d_week_seq#57, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Sunday   ) THEN sales_price#4 END))#28,17,2) AS sun_sales#75, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Monday   ) THEN sales_price#4 END))#29,17,2) AS mon_sales#76, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Tuesday  ) THEN sales_price#4 END))#30,17,2) AS tue_sales#77, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Wednesday) THEN sales_price#4 END))#31,17,2) AS wed_sales#78, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Thursday ) THEN sales_price#4 END))#32,17,2) AS thu_sales#79, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Friday   ) THEN sales_price#4 END))#33,17,2) AS fri_sales#80, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Saturday ) THEN sales_price#4 END))#34,17,2) AS sat_sales#81]
 
 (40) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_week_seq#68, d_year#69]
+Output [2]: [d_week_seq#82, d_year#83]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_week_seq)]
 ReadSchema: struct<d_week_seq:int,d_year:int>
 
 (41) ColumnarToRow [codegen id : 10]
-Input [2]: [d_week_seq#68, d_year#69]
+Input [2]: [d_week_seq#82, d_year#83]
 
 (42) Filter [codegen id : 10]
-Input [2]: [d_week_seq#68, d_year#69]
-Condition : ((isnotnull(d_year#69) AND (d_year#69 = 2002)) AND isnotnull(d_week_seq#68))
+Input [2]: [d_week_seq#82, d_year#83]
+Condition : ((isnotnull(d_year#83) AND (d_year#83 = 2002)) AND isnotnull(d_week_seq#82))
 
 (43) Project [codegen id : 10]
-Output [1]: [d_week_seq#68]
-Input [2]: [d_week_seq#68, d_year#69]
+Output [1]: [d_week_seq#82]
+Input [2]: [d_week_seq#82, d_year#83]
 
 (44) BroadcastExchange
-Input [1]: [d_week_seq#68]
+Input [1]: [d_week_seq#82]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6]
 
 (45) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [d_week_seq#10]
-Right keys [1]: [d_week_seq#68]
+Left keys [1]: [d_week_seq#57]
+Right keys [1]: [d_week_seq#82]
 Join type: Inner
 Join condition: None
 
 (46) Project [codegen id : 11]
-Output [8]: [d_week_seq#10 AS d_week_seq2#70, sun_sales#35 AS sun_sales2#71, mon_sales#36 AS mon_sales2#72, tue_sales#37 AS tue_sales2#73, wed_sales#38 AS wed_sales2#74, thu_sales#39 AS thu_sales2#75, fri_sales#40 AS fri_sales2#76, sat_sales#41 AS sat_sales2#77]
-Input [9]: [d_week_seq#10, sun_sales#35, mon_sales#36, tue_sales#37, wed_sales#38, thu_sales#39, fri_sales#40, sat_sales#41, d_week_seq#68]
+Output [8]: [d_week_seq#57 AS d_week_seq2#84, sun_sales#75 AS sun_sales2#85, mon_sales#76 AS mon_sales2#86, tue_sales#77 AS tue_sales2#87, wed_sales#78 AS wed_sales2#88, thu_sales#79 AS thu_sales2#89, fri_sales#80 AS fri_sales2#90, sat_sales#81 AS sat_sales2#91]
+Input [9]: [d_week_seq#57, sun_sales#75, mon_sales#76, tue_sales#77, wed_sales#78, thu_sales#79, fri_sales#80, sat_sales#81, d_week_seq#82]
 
 (47) BroadcastExchange
-Input [8]: [d_week_seq2#70, sun_sales2#71, mon_sales2#72, tue_sales2#73, wed_sales2#74, thu_sales2#75, fri_sales2#76, sat_sales2#77]
+Input [8]: [d_week_seq2#84, sun_sales2#85, mon_sales2#86, tue_sales2#87, wed_sales2#88, thu_sales2#89, fri_sales2#90, sat_sales2#91]
 Arguments: HashedRelationBroadcastMode(List(cast((input[0, int, true] - 53) as bigint)),false), [plan_id=7]
 
 (48) BroadcastHashJoin [codegen id : 12]
 Left keys [1]: [d_week_seq1#44]
-Right keys [1]: [(d_week_seq2#70 - 53)]
+Right keys [1]: [(d_week_seq2#84 - 53)]
 Join type: Inner
 Join condition: None
 
 (49) Project [codegen id : 12]
-Output [8]: [d_week_seq1#44, round((sun_sales1#45 / sun_sales2#71), 2) AS round((sun_sales1 / sun_sales2), 2)#78, round((mon_sales1#46 / mon_sales2#72), 2) AS round((mon_sales1 / mon_sales2), 2)#79, round((tue_sales1#47 / tue_sales2#73), 2) AS round((tue_sales1 / tue_sales2), 2)#80, round((wed_sales1#48 / wed_sales2#74), 2) AS round((wed_sales1 / wed_sales2), 2)#81, round((thu_sales1#49 / thu_sales2#75), 2) AS round((thu_sales1 / thu_sales2), 2)#82, round((fri_sales1#50 / fri_sales2#76), 2) AS round((fri_sales1 / fri_sales2), 2)#83, round((sat_sales1#51 / sat_sales2#77), 2) AS round((sat_sales1 / sat_sales2), 2)#84]
-Input [16]: [d_week_seq1#44, sun_sales1#45, mon_sales1#46, tue_sales1#47, wed_sales1#48, thu_sales1#49, fri_sales1#50, sat_sales1#51, d_week_seq2#70, sun_sales2#71, mon_sales2#72, tue_sales2#73, wed_sales2#74, thu_sales2#75, fri_sales2#76, sat_sales2#77]
+Output [8]: [d_week_seq1#44, round((sun_sales1#45 / sun_sales2#85), 2) AS round((sun_sales1 / sun_sales2), 2)#92, round((mon_sales1#46 / mon_sales2#86), 2) AS round((mon_sales1 / mon_sales2), 2)#93, round((tue_sales1#47 / tue_sales2#87), 2) AS round((tue_sales1 / tue_sales2), 2)#94, round((wed_sales1#48 / wed_sales2#88), 2) AS round((wed_sales1 / wed_sales2), 2)#95, round((thu_sales1#49 / thu_sales2#89), 2) AS round((thu_sales1 / thu_sales2), 2)#96, round((fri_sales1#50 / fri_sales2#90), 2) AS round((fri_sales1 / fri_sales2), 2)#97, round((sat_sales1#51 / sat_sales2#91), 2) AS round((sat_sales1 / sat_sales2), 2)#98]
+Input [16]: [d_week_seq1#44, sun_sales1#45, mon_sales1#46, tue_sales1#47, wed_sales1#48, thu_sales1#49, fri_sales1#50, sat_sales1#51, d_week_seq2#84, sun_sales2#85, mon_sales2#86, tue_sales2#87, wed_sales2#88, thu_sales2#89, fri_sales2#90, sat_sales2#91]
 
 (50) Exchange
-Input [8]: [d_week_seq1#44, round((sun_sales1 / sun_sales2), 2)#78, round((mon_sales1 / mon_sales2), 2)#79, round((tue_sales1 / tue_sales2), 2)#80, round((wed_sales1 / wed_sales2), 2)#81, round((thu_sales1 / thu_sales2), 2)#82, round((fri_sales1 / fri_sales2), 2)#83, round((sat_sales1 / sat_sales2), 2)#84]
+Input [8]: [d_week_seq1#44, round((sun_sales1 / sun_sales2), 2)#92, round((mon_sales1 / mon_sales2), 2)#93, round((tue_sales1 / tue_sales2), 2)#94, round((wed_sales1 / wed_sales2), 2)#95, round((thu_sales1 / thu_sales2), 2)#96, round((fri_sales1 / fri_sales2), 2)#97, round((sat_sales1 / sat_sales2), 2)#98]
 Arguments: rangepartitioning(d_week_seq1#44 ASC NULLS FIRST, 5), ENSURE_REQUIREMENTS, [plan_id=8]
 
 (51) Sort [codegen id : 13]
-Input [8]: [d_week_seq1#44, round((sun_sales1 / sun_sales2), 2)#78, round((mon_sales1 / mon_sales2), 2)#79, round((tue_sales1 / tue_sales2), 2)#80, round((wed_sales1 / wed_sales2), 2)#81, round((thu_sales1 / thu_sales2), 2)#82, round((fri_sales1 / fri_sales2), 2)#83, round((sat_sales1 / sat_sales2), 2)#84]
+Input [8]: [d_week_seq1#44, round((sun_sales1 / sun_sales2), 2)#92, round((mon_sales1 / mon_sales2), 2)#93, round((tue_sales1 / tue_sales2), 2)#94, round((wed_sales1 / wed_sales2), 2)#95, round((thu_sales1 / thu_sales2), 2)#96, round((fri_sales1 / fri_sales2), 2)#97, round((sat_sales1 / sat_sales2), 2)#98]
 Arguments: [d_week_seq1#44 ASC NULLS FIRST], true, 0
 
 ===== Subqueries =====
@@ -324,21 +324,21 @@ Input [2]: [d_week_seq#42, d_year#43]
 Input [1]: [d_week_seq#42]
 Keys: []
 Functions [1]: [partial_bloom_filter_agg(xxhash64(d_week_seq#42, 42), 362, 9656, 0, 0)]
-Aggregate Attributes [1]: [buf#85]
-Results [1]: [buf#86]
+Aggregate Attributes [1]: [buf#99]
+Results [1]: [buf#100]
 
 (57) Exchange
-Input [1]: [buf#86]
+Input [1]: [buf#100]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=9]
 
 (58) ObjectHashAggregate
-Input [1]: [buf#86]
+Input [1]: [buf#100]
 Keys: []
 Functions [1]: [bloom_filter_agg(xxhash64(d_week_seq#42, 42), 362, 9656, 0, 0)]
-Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_week_seq#42, 42), 362, 9656, 0, 0)#87]
-Results [1]: [bloom_filter_agg(xxhash64(d_week_seq#42, 42), 362, 9656, 0, 0)#87 AS bloomFilter#88]
+Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_week_seq#42, 42), 362, 9656, 0, 0)#101]
+Results [1]: [bloom_filter_agg(xxhash64(d_week_seq#42, 42), 362, 9656, 0, 0)#101 AS bloomFilter#102]
 
-Subquery:2 Hosting operator id = 33 Hosting Expression = Subquery scalar-subquery#52, [id=#53]
+Subquery:2 Hosting operator id = 33 Hosting Expression = Subquery scalar-subquery#59, [id=#60]
 ObjectHashAggregate (65)
 +- Exchange (64)
    +- ObjectHashAggregate (63)
@@ -349,39 +349,39 @@ ObjectHashAggregate (65)
 
 
 (59) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_week_seq#68, d_year#69]
+Output [2]: [d_week_seq#82, d_year#83]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_week_seq)]
 ReadSchema: struct<d_week_seq:int,d_year:int>
 
 (60) ColumnarToRow [codegen id : 1]
-Input [2]: [d_week_seq#68, d_year#69]
+Input [2]: [d_week_seq#82, d_year#83]
 
 (61) Filter [codegen id : 1]
-Input [2]: [d_week_seq#68, d_year#69]
-Condition : ((isnotnull(d_year#69) AND (d_year#69 = 2002)) AND isnotnull(d_week_seq#68))
+Input [2]: [d_week_seq#82, d_year#83]
+Condition : ((isnotnull(d_year#83) AND (d_year#83 = 2002)) AND isnotnull(d_week_seq#82))
 
 (62) Project [codegen id : 1]
-Output [1]: [d_week_seq#68]
-Input [2]: [d_week_seq#68, d_year#69]
+Output [1]: [d_week_seq#82]
+Input [2]: [d_week_seq#82, d_year#83]
 
 (63) ObjectHashAggregate
-Input [1]: [d_week_seq#68]
+Input [1]: [d_week_seq#82]
 Keys: []
-Functions [1]: [partial_bloom_filter_agg(xxhash64(d_week_seq#68, 42), 362, 9656, 0, 0)]
-Aggregate Attributes [1]: [buf#89]
-Results [1]: [buf#90]
+Functions [1]: [partial_bloom_filter_agg(xxhash64(d_week_seq#82, 42), 362, 9656, 0, 0)]
+Aggregate Attributes [1]: [buf#103]
+Results [1]: [buf#104]
 
 (64) Exchange
-Input [1]: [buf#90]
+Input [1]: [buf#104]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=10]
 
 (65) ObjectHashAggregate
-Input [1]: [buf#90]
+Input [1]: [buf#104]
 Keys: []
-Functions [1]: [bloom_filter_agg(xxhash64(d_week_seq#68, 42), 362, 9656, 0, 0)]
-Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_week_seq#68, 42), 362, 9656, 0, 0)#91]
-Results [1]: [bloom_filter_agg(xxhash64(d_week_seq#68, 42), 362, 9656, 0, 0)#91 AS bloomFilter#92]
+Functions [1]: [bloom_filter_agg(xxhash64(d_week_seq#82, 42), 362, 9656, 0, 0)]
+Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_week_seq#82, 42), 362, 9656, 0, 0)#105]
+Results [1]: [bloom_filter_agg(xxhash64(d_week_seq#82, 42), 362, 9656, 0, 0)#105 AS bloomFilter#106]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q2/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q2/explain.txt
index 72bee887d45..3b66fa7c324 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q2/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q2/explain.txt
@@ -147,66 +147,66 @@ Output [8]: [d_week_seq#10 AS d_week_seq1#42, sun_sales#33 AS sun_sales1#43, mon
 Input [9]: [d_week_seq#10, sun_sales#33, mon_sales#34, tue_sales#35, wed_sales#36, thu_sales#37, fri_sales#38, sat_sales#39, d_week_seq#40]
 
 (24) ReusedExchange [Reuses operator id: 15]
-Output [8]: [d_week_seq#10, sum#50, sum#51, sum#52, sum#53, sum#54, sum#55, sum#56]
+Output [8]: [d_week_seq#50, sum#51, sum#52, sum#53, sum#54, sum#55, sum#56, sum#57]
 
 (25) HashAggregate [codegen id : 11]
-Input [8]: [d_week_seq#10, sum#50, sum#51, sum#52, sum#53, sum#54, sum#55, sum#56]
-Keys [1]: [d_week_seq#10]
-Functions [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#11 = Sunday   ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#11 = Monday   ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#11 = Tuesday  ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#11 = Wednesday) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#11 = Thursday ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#11 = Friday   ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#11 = Saturday ) THEN sales_price#4 END))]
-Aggregate Attributes [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#11 = Sunday   ) THEN sales_price#4 END))#26, sum(UnscaledValue(CASE WHEN (d_day_name#11 = Monday   ) THEN sales_price#4 END))#27, sum(UnscaledValue(CASE WHEN (d_day_name#11 = Tuesday  ) THEN sales_price#4 END))#28, sum(UnscaledValue(CASE WHEN (d_day_name#11 = Wednesday) THEN sales_price#4 END))#29, sum(UnscaledValue(CASE WHEN (d_day_name#11 = Thursday ) THEN sales_price#4 END))#30, sum(UnscaledValue(CASE WHEN (d_day_name#11 = Friday   ) THEN sales_price#4 END))#31, sum(UnscaledValue(CASE WHEN (d_day_name#11 = Saturday ) THEN sales_price#4 END))#32]
-Results [8]: [d_week_seq#10, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Sunday   ) THEN sales_price#4 END))#26,17,2) AS sun_sales#33, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Monday   ) THEN sales_price#4 END))#27,17,2) AS mon_sales#34, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Tuesday  ) THEN sales_price#4 END))#28,17,2) AS tue_sales#35, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Wednesday) THEN sales_price#4 END))#29,17,2) AS wed_sales#36, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Thursday ) THEN sales_price#4 END))#30,17,2) AS thu_sales#37, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Friday   ) THEN sales_price#4 END))#31,17,2) AS fri_sales#38, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#11 = Saturday ) THEN sales_price#4 END))#32,17,2) AS sat_sales#39]
+Input [8]: [d_week_seq#50, sum#51, sum#52, sum#53, sum#54, sum#55, sum#56, sum#57]
+Keys [1]: [d_week_seq#50]
+Functions [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#58 = Sunday   ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#58 = Monday   ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#58 = Tuesday  ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#58 = Wednesday) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#58 = Thursday ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#58 = Friday   ) THEN sales_price#4 END)), sum(UnscaledValue(CASE WHEN (d_day_name#58 = Saturday ) THEN sales_price#4 END))]
+Aggregate Attributes [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#58 = Sunday   ) THEN sales_price#4 END))#26, sum(UnscaledValue(CASE WHEN (d_day_name#58 = Monday   ) THEN sales_price#4 END))#27, sum(UnscaledValue(CASE WHEN (d_day_name#58 = Tuesday  ) THEN sales_price#4 END))#28, sum(UnscaledValue(CASE WHEN (d_day_name#58 = Wednesday) THEN sales_price#4 END))#29, sum(UnscaledValue(CASE WHEN (d_day_name#58 = Thursday ) THEN sales_price#4 END))#30, sum(UnscaledValue(CASE WHEN (d_day_name#58 = Friday   ) THEN sales_price#4 END))#31, sum(UnscaledValue(CASE WHEN (d_day_name#58 = Saturday ) THEN sales_price#4 END))#32]
+Results [8]: [d_week_seq#50, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Sunday   ) THEN sales_price#4 END))#26,17,2) AS sun_sales#59, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Monday   ) THEN sales_price#4 END))#27,17,2) AS mon_sales#60, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Tuesday  ) THEN sales_price#4 END))#28,17,2) AS tue_sales#61, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Wednesday) THEN sales_price#4 END))#29,17,2) AS wed_sales#62, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Thursday ) THEN sales_price#4 END))#30,17,2) AS thu_sales#63, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Friday   ) THEN sales_price#4 END))#31,17,2) AS fri_sales#64, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#58 = Saturday ) THEN sales_price#4 END))#32,17,2) AS sat_sales#65]
 
 (26) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_week_seq#57, d_year#58]
+Output [2]: [d_week_seq#66, d_year#67]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_week_seq)]
 ReadSchema: struct<d_week_seq:int,d_year:int>
 
 (27) ColumnarToRow [codegen id : 10]
-Input [2]: [d_week_seq#57, d_year#58]
+Input [2]: [d_week_seq#66, d_year#67]
 
 (28) Filter [codegen id : 10]
-Input [2]: [d_week_seq#57, d_year#58]
-Condition : ((isnotnull(d_year#58) AND (d_year#58 = 2002)) AND isnotnull(d_week_seq#57))
+Input [2]: [d_week_seq#66, d_year#67]
+Condition : ((isnotnull(d_year#67) AND (d_year#67 = 2002)) AND isnotnull(d_week_seq#66))
 
 (29) Project [codegen id : 10]
-Output [1]: [d_week_seq#57]
-Input [2]: [d_week_seq#57, d_year#58]
+Output [1]: [d_week_seq#66]
+Input [2]: [d_week_seq#66, d_year#67]
 
 (30) BroadcastExchange
-Input [1]: [d_week_seq#57]
+Input [1]: [d_week_seq#66]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4]
 
 (31) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [d_week_seq#10]
-Right keys [1]: [d_week_seq#57]
+Left keys [1]: [d_week_seq#50]
+Right keys [1]: [d_week_seq#66]
 Join type: Inner
 Join condition: None
 
 (32) Project [codegen id : 11]
-Output [8]: [d_week_seq#10 AS d_week_seq2#59, sun_sales#33 AS sun_sales2#60, mon_sales#34 AS mon_sales2#61, tue_sales#35 AS tue_sales2#62, wed_sales#36 AS wed_sales2#63, thu_sales#37 AS thu_sales2#64, fri_sales#38 AS fri_sales2#65, sat_sales#39 AS sat_sales2#66]
-Input [9]: [d_week_seq#10, sun_sales#33, mon_sales#34, tue_sales#35, wed_sales#36, thu_sales#37, fri_sales#38, sat_sales#39, d_week_seq#57]
+Output [8]: [d_week_seq#50 AS d_week_seq2#68, sun_sales#59 AS sun_sales2#69, mon_sales#60 AS mon_sales2#70, tue_sales#61 AS tue_sales2#71, wed_sales#62 AS wed_sales2#72, thu_sales#63 AS thu_sales2#73, fri_sales#64 AS fri_sales2#74, sat_sales#65 AS sat_sales2#75]
+Input [9]: [d_week_seq#50, sun_sales#59, mon_sales#60, tue_sales#61, wed_sales#62, thu_sales#63, fri_sales#64, sat_sales#65, d_week_seq#66]
 
 (33) BroadcastExchange
-Input [8]: [d_week_seq2#59, sun_sales2#60, mon_sales2#61, tue_sales2#62, wed_sales2#63, thu_sales2#64, fri_sales2#65, sat_sales2#66]
+Input [8]: [d_week_seq2#68, sun_sales2#69, mon_sales2#70, tue_sales2#71, wed_sales2#72, thu_sales2#73, fri_sales2#74, sat_sales2#75]
 Arguments: HashedRelationBroadcastMode(List(cast((input[0, int, true] - 53) as bigint)),false), [plan_id=5]
 
 (34) BroadcastHashJoin [codegen id : 12]
 Left keys [1]: [d_week_seq1#42]
-Right keys [1]: [(d_week_seq2#59 - 53)]
+Right keys [1]: [(d_week_seq2#68 - 53)]
 Join type: Inner
 Join condition: None
 
 (35) Project [codegen id : 12]
-Output [8]: [d_week_seq1#42, round((sun_sales1#43 / sun_sales2#60), 2) AS round((sun_sales1 / sun_sales2), 2)#67, round((mon_sales1#44 / mon_sales2#61), 2) AS round((mon_sales1 / mon_sales2), 2)#68, round((tue_sales1#45 / tue_sales2#62), 2) AS round((tue_sales1 / tue_sales2), 2)#69, round((wed_sales1#46 / wed_sales2#63), 2) AS round((wed_sales1 / wed_sales2), 2)#70, round((thu_sales1#47 / thu_sales2#64), 2) AS round((thu_sales1 / thu_sales2), 2)#71, round((fri_sales1#48 / fri_sales2#65), 2) AS round((fri_sales1 / fri_sales2), 2)#72, round((sat_sales1#49 / sat_sales2#66), 2) AS round((sat_sales1 / sat_sales2), 2)#73]
-Input [16]: [d_week_seq1#42, sun_sales1#43, mon_sales1#44, tue_sales1#45, wed_sales1#46, thu_sales1#47, fri_sales1#48, sat_sales1#49, d_week_seq2#59, sun_sales2#60, mon_sales2#61, tue_sales2#62, wed_sales2#63, thu_sales2#64, fri_sales2#65, sat_sales2#66]
+Output [8]: [d_week_seq1#42, round((sun_sales1#43 / sun_sales2#69), 2) AS round((sun_sales1 / sun_sales2), 2)#76, round((mon_sales1#44 / mon_sales2#70), 2) AS round((mon_sales1 / mon_sales2), 2)#77, round((tue_sales1#45 / tue_sales2#71), 2) AS round((tue_sales1 / tue_sales2), 2)#78, round((wed_sales1#46 / wed_sales2#72), 2) AS round((wed_sales1 / wed_sales2), 2)#79, round((thu_sales1#47 / thu_sales2#73), 2) AS round((thu_sales1 / thu_sales2), 2)#80, round((fri_sales1#48 / fri_sales2#74), 2) AS round((fri_sales1 / fri_sales2), 2)#81, round((sat_sales1#49 / sat_sales2#75), 2) AS round((sat_sales1 / sat_sales2), 2)#82]
+Input [16]: [d_week_seq1#42, sun_sales1#43, mon_sales1#44, tue_sales1#45, wed_sales1#46, thu_sales1#47, fri_sales1#48, sat_sales1#49, d_week_seq2#68, sun_sales2#69, mon_sales2#70, tue_sales2#71, wed_sales2#72, thu_sales2#73, fri_sales2#74, sat_sales2#75]
 
 (36) Exchange
-Input [8]: [d_week_seq1#42, round((sun_sales1 / sun_sales2), 2)#67, round((mon_sales1 / mon_sales2), 2)#68, round((tue_sales1 / tue_sales2), 2)#69, round((wed_sales1 / wed_sales2), 2)#70, round((thu_sales1 / thu_sales2), 2)#71, round((fri_sales1 / fri_sales2), 2)#72, round((sat_sales1 / sat_sales2), 2)#73]
+Input [8]: [d_week_seq1#42, round((sun_sales1 / sun_sales2), 2)#76, round((mon_sales1 / mon_sales2), 2)#77, round((tue_sales1 / tue_sales2), 2)#78, round((wed_sales1 / wed_sales2), 2)#79, round((thu_sales1 / thu_sales2), 2)#80, round((fri_sales1 / fri_sales2), 2)#81, round((sat_sales1 / sat_sales2), 2)#82]
 Arguments: rangepartitioning(d_week_seq1#42 ASC NULLS FIRST, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (37) Sort [codegen id : 13]
-Input [8]: [d_week_seq1#42, round((sun_sales1 / sun_sales2), 2)#67, round((mon_sales1 / mon_sales2), 2)#68, round((tue_sales1 / tue_sales2), 2)#69, round((wed_sales1 / wed_sales2), 2)#70, round((thu_sales1 / thu_sales2), 2)#71, round((fri_sales1 / fri_sales2), 2)#72, round((sat_sales1 / sat_sales2), 2)#73]
+Input [8]: [d_week_seq1#42, round((sun_sales1 / sun_sales2), 2)#76, round((mon_sales1 / mon_sales2), 2)#77, round((tue_sales1 / tue_sales2), 2)#78, round((wed_sales1 / wed_sales2), 2)#79, round((thu_sales1 / thu_sales2), 2)#80, round((fri_sales1 / fri_sales2), 2)#81, round((sat_sales1 / sat_sales2), 2)#82]
 Arguments: [d_week_seq1#42 ASC NULLS FIRST], true, 0
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23a.sf100/explain.txt
index 4114749e28d..0cf3752714a 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23a.sf100/explain.txt
@@ -347,58 +347,58 @@ Input [5]: [ws_item_sk#35, ws_bill_customer_sk#36, ws_quantity#37, ws_list_price
 Arguments: [ws_item_sk#35 ASC NULLS FIRST], false, 0
 
 (56) ReusedExchange [Reuses operator id: 11]
-Output [2]: [ss_item_sk#7, d_date#11]
+Output [2]: [ss_item_sk#40, d_date#41]
 
 (57) Sort [codegen id : 22]
-Input [2]: [ss_item_sk#7, d_date#11]
-Arguments: [ss_item_sk#7 ASC NULLS FIRST], false, 0
+Input [2]: [ss_item_sk#40, d_date#41]
+Arguments: [ss_item_sk#40 ASC NULLS FIRST], false, 0
 
 (58) ReusedExchange [Reuses operator id: 16]
-Output [2]: [i_item_sk#12, i_item_desc#13]
+Output [2]: [i_item_sk#42, i_item_desc#43]
 
 (59) Sort [codegen id : 24]
-Input [2]: [i_item_sk#12, i_item_desc#13]
-Arguments: [i_item_sk#12 ASC NULLS FIRST], false, 0
+Input [2]: [i_item_sk#42, i_item_desc#43]
+Arguments: [i_item_sk#42 ASC NULLS FIRST], false, 0
 
 (60) SortMergeJoin [codegen id : 25]
-Left keys [1]: [ss_item_sk#7]
-Right keys [1]: [i_item_sk#12]
+Left keys [1]: [ss_item_sk#40]
+Right keys [1]: [i_item_sk#42]
 Join type: Inner
 Join condition: None
 
 (61) Project [codegen id : 25]
-Output [3]: [d_date#11, i_item_sk#12, substr(i_item_desc#13, 1, 30) AS _groupingexpression#14]
-Input [4]: [ss_item_sk#7, d_date#11, i_item_sk#12, i_item_desc#13]
+Output [3]: [d_date#41, i_item_sk#42, substr(i_item_desc#43, 1, 30) AS _groupingexpression#14]
+Input [4]: [ss_item_sk#40, d_date#41, i_item_sk#42, i_item_desc#43]
 
 (62) HashAggregate [codegen id : 25]
-Input [3]: [d_date#11, i_item_sk#12, _groupingexpression#14]
-Keys [3]: [_groupingexpression#14, i_item_sk#12, d_date#11]
+Input [3]: [d_date#41, i_item_sk#42, _groupingexpression#14]
+Keys [3]: [_groupingexpression#14, i_item_sk#42, d_date#41]
 Functions [1]: [partial_count(1)]
 Aggregate Attributes [1]: [count#15]
-Results [4]: [_groupingexpression#14, i_item_sk#12, d_date#11, count#16]
+Results [4]: [_groupingexpression#14, i_item_sk#42, d_date#41, count#16]
 
 (63) HashAggregate [codegen id : 25]
-Input [4]: [_groupingexpression#14, i_item_sk#12, d_date#11, count#16]
-Keys [3]: [_groupingexpression#14, i_item_sk#12, d_date#11]
+Input [4]: [_groupingexpression#14, i_item_sk#42, d_date#41, count#16]
+Keys [3]: [_groupingexpression#14, i_item_sk#42, d_date#41]
 Functions [1]: [count(1)]
 Aggregate Attributes [1]: [count(1)#17]
-Results [2]: [i_item_sk#12 AS item_sk#18, count(1)#17 AS cnt#19]
+Results [2]: [i_item_sk#42 AS item_sk#44, count(1)#17 AS cnt#45]
 
 (64) Filter [codegen id : 25]
-Input [2]: [item_sk#18, cnt#19]
-Condition : (cnt#19 > 4)
+Input [2]: [item_sk#44, cnt#45]
+Condition : (cnt#45 > 4)
 
 (65) Project [codegen id : 25]
-Output [1]: [item_sk#18]
-Input [2]: [item_sk#18, cnt#19]
+Output [1]: [item_sk#44]
+Input [2]: [item_sk#44, cnt#45]
 
 (66) Sort [codegen id : 25]
-Input [1]: [item_sk#18]
-Arguments: [item_sk#18 ASC NULLS FIRST], false, 0
+Input [1]: [item_sk#44]
+Arguments: [item_sk#44 ASC NULLS FIRST], false, 0
 
 (67) SortMergeJoin [codegen id : 26]
 Left keys [1]: [ws_item_sk#35]
-Right keys [1]: [item_sk#18]
+Right keys [1]: [item_sk#44]
 Join type: LeftSemi
 Join condition: None
 
@@ -415,58 +415,58 @@ Input [4]: [ws_bill_customer_sk#36, ws_quantity#37, ws_list_price#38, ws_sold_da
 Arguments: [ws_bill_customer_sk#36 ASC NULLS FIRST], false, 0
 
 (71) ReusedExchange [Reuses operator id: 33]
-Output [3]: [ss_customer_sk#20, ss_quantity#21, ss_sales_price#22]
+Output [3]: [ss_customer_sk#46, ss_quantity#47, ss_sales_price#48]
 
 (72) Sort [codegen id : 29]
-Input [3]: [ss_customer_sk#20, ss_quantity#21, ss_sales_price#22]
-Arguments: [ss_customer_sk#20 ASC NULLS FIRST], false, 0
+Input [3]: [ss_customer_sk#46, ss_quantity#47, ss_sales_price#48]
+Arguments: [ss_customer_sk#46 ASC NULLS FIRST], false, 0
 
 (73) ReusedExchange [Reuses operator id: 38]
-Output [1]: [c_customer_sk#24]
+Output [1]: [c_customer_sk#49]
 
 (74) Sort [codegen id : 31]
-Input [1]: [c_customer_sk#24]
-Arguments: [c_customer_sk#24 ASC NULLS FIRST], false, 0
+Input [1]: [c_customer_sk#49]
+Arguments: [c_customer_sk#49 ASC NULLS FIRST], false, 0
 
 (75) SortMergeJoin [codegen id : 32]
-Left keys [1]: [ss_customer_sk#20]
-Right keys [1]: [c_customer_sk#24]
+Left keys [1]: [ss_customer_sk#46]
+Right keys [1]: [c_customer_sk#49]
 Join type: Inner
 Join condition: None
 
 (76) Project [codegen id : 32]
-Output [3]: [ss_quantity#21, ss_sales_price#22, c_customer_sk#24]
-Input [4]: [ss_customer_sk#20, ss_quantity#21, ss_sales_price#22, c_customer_sk#24]
+Output [3]: [ss_quantity#47, ss_sales_price#48, c_customer_sk#49]
+Input [4]: [ss_customer_sk#46, ss_quantity#47, ss_sales_price#48, c_customer_sk#49]
 
 (77) HashAggregate [codegen id : 32]
-Input [3]: [ss_quantity#21, ss_sales_price#22, c_customer_sk#24]
-Keys [1]: [c_customer_sk#24]
-Functions [1]: [partial_sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))]
-Aggregate Attributes [2]: [sum#25, isEmpty#26]
-Results [3]: [c_customer_sk#24, sum#27, isEmpty#28]
+Input [3]: [ss_quantity#47, ss_sales_price#48, c_customer_sk#49]
+Keys [1]: [c_customer_sk#49]
+Functions [1]: [partial_sum((cast(ss_quantity#47 as decimal(10,0)) * ss_sales_price#48))]
+Aggregate Attributes [2]: [sum#50, isEmpty#51]
+Results [3]: [c_customer_sk#49, sum#52, isEmpty#53]
 
 (78) HashAggregate [codegen id : 32]
-Input [3]: [c_customer_sk#24, sum#27, isEmpty#28]
-Keys [1]: [c_customer_sk#24]
-Functions [1]: [sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))]
-Aggregate Attributes [1]: [sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))#29]
-Results [2]: [c_customer_sk#24, sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))#29 AS ssales#30]
+Input [3]: [c_customer_sk#49, sum#52, isEmpty#53]
+Keys [1]: [c_customer_sk#49]
+Functions [1]: [sum((cast(ss_quantity#47 as decimal(10,0)) * ss_sales_price#48))]
+Aggregate Attributes [1]: [sum((cast(ss_quantity#47 as decimal(10,0)) * ss_sales_price#48))#29]
+Results [2]: [c_customer_sk#49, sum((cast(ss_quantity#47 as decimal(10,0)) * ss_sales_price#48))#29 AS ssales#54]
 
 (79) Filter [codegen id : 32]
-Input [2]: [c_customer_sk#24, ssales#30]
-Condition : (isnotnull(ssales#30) AND (cast(ssales#30 as decimal(38,8)) > (0.500000 * ReusedSubquery Subquery scalar-subquery#31, [id=#32])))
+Input [2]: [c_customer_sk#49, ssales#54]
+Condition : (isnotnull(ssales#54) AND (cast(ssales#54 as decimal(38,8)) > (0.500000 * ReusedSubquery Subquery scalar-subquery#31, [id=#32])))
 
 (80) Project [codegen id : 32]
-Output [1]: [c_customer_sk#24]
-Input [2]: [c_customer_sk#24, ssales#30]
+Output [1]: [c_customer_sk#49]
+Input [2]: [c_customer_sk#49, ssales#54]
 
 (81) Sort [codegen id : 32]
-Input [1]: [c_customer_sk#24]
-Arguments: [c_customer_sk#24 ASC NULLS FIRST], false, 0
+Input [1]: [c_customer_sk#49]
+Arguments: [c_customer_sk#49 ASC NULLS FIRST], false, 0
 
 (82) SortMergeJoin [codegen id : 34]
 Left keys [1]: [ws_bill_customer_sk#36]
-Right keys [1]: [c_customer_sk#24]
+Right keys [1]: [c_customer_sk#49]
 Join type: LeftSemi
 Join condition: None
 
@@ -475,17 +475,17 @@ Output [3]: [ws_quantity#37, ws_list_price#38, ws_sold_date_sk#39]
 Input [4]: [ws_bill_customer_sk#36, ws_quantity#37, ws_list_price#38, ws_sold_date_sk#39]
 
 (84) ReusedExchange [Reuses operator id: 95]
-Output [1]: [d_date_sk#40]
+Output [1]: [d_date_sk#55]
 
 (85) BroadcastHashJoin [codegen id : 34]
 Left keys [1]: [ws_sold_date_sk#39]
-Right keys [1]: [d_date_sk#40]
+Right keys [1]: [d_date_sk#55]
 Join type: Inner
 Join condition: None
 
 (86) Project [codegen id : 34]
-Output [1]: [(cast(ws_quantity#37 as decimal(10,0)) * ws_list_price#38) AS sales#41]
-Input [4]: [ws_quantity#37, ws_list_price#38, ws_sold_date_sk#39, d_date_sk#40]
+Output [1]: [(cast(ws_quantity#37 as decimal(10,0)) * ws_list_price#38) AS sales#56]
+Input [4]: [ws_quantity#37, ws_list_price#38, ws_sold_date_sk#39, d_date_sk#55]
 
 (87) Union
 
@@ -493,19 +493,19 @@ Input [4]: [ws_quantity#37, ws_list_price#38, ws_sold_date_sk#39, d_date_sk#40]
 Input [1]: [sales#34]
 Keys: []
 Functions [1]: [partial_sum(sales#34)]
-Aggregate Attributes [2]: [sum#42, isEmpty#43]
-Results [2]: [sum#44, isEmpty#45]
+Aggregate Attributes [2]: [sum#57, isEmpty#58]
+Results [2]: [sum#59, isEmpty#60]
 
 (89) Exchange
-Input [2]: [sum#44, isEmpty#45]
+Input [2]: [sum#59, isEmpty#60]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=9]
 
 (90) HashAggregate [codegen id : 36]
-Input [2]: [sum#44, isEmpty#45]
+Input [2]: [sum#59, isEmpty#60]
 Keys: []
 Functions [1]: [sum(sales#34)]
-Aggregate Attributes [1]: [sum(sales#34)#46]
-Results [1]: [sum(sales#34)#46 AS sum(sales)#47]
+Aggregate Attributes [1]: [sum(sales#34)#61]
+Results [1]: [sum(sales#34)#61 AS sum(sales)#62]
 
 ===== Subqueries =====
 
@@ -518,22 +518,22 @@ BroadcastExchange (95)
 
 
 (91) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#33, d_year#48, d_moy#49]
+Output [3]: [d_date_sk#33, d_year#63, d_moy#64]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2000), EqualTo(d_moy,2), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
 
 (92) ColumnarToRow [codegen id : 1]
-Input [3]: [d_date_sk#33, d_year#48, d_moy#49]
+Input [3]: [d_date_sk#33, d_year#63, d_moy#64]
 
 (93) Filter [codegen id : 1]
-Input [3]: [d_date_sk#33, d_year#48, d_moy#49]
-Condition : ((((isnotnull(d_year#48) AND isnotnull(d_moy#49)) AND (d_year#48 = 2000)) AND (d_moy#49 = 2)) AND isnotnull(d_date_sk#33))
+Input [3]: [d_date_sk#33, d_year#63, d_moy#64]
+Condition : ((((isnotnull(d_year#63) AND isnotnull(d_moy#64)) AND (d_year#63 = 2000)) AND (d_moy#64 = 2)) AND isnotnull(d_date_sk#33))
 
 (94) Project [codegen id : 1]
 Output [1]: [d_date_sk#33]
-Input [3]: [d_date_sk#33, d_year#48, d_moy#49]
+Input [3]: [d_date_sk#33, d_year#63, d_moy#64]
 
 (95) BroadcastExchange
 Input [1]: [d_date_sk#33]
@@ -548,22 +548,22 @@ BroadcastExchange (100)
 
 
 (96) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#10, d_date#11, d_year#50]
+Output [3]: [d_date_sk#10, d_date#11, d_year#65]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date,d_year:int>
 
 (97) ColumnarToRow [codegen id : 1]
-Input [3]: [d_date_sk#10, d_date#11, d_year#50]
+Input [3]: [d_date_sk#10, d_date#11, d_year#65]
 
 (98) Filter [codegen id : 1]
-Input [3]: [d_date_sk#10, d_date#11, d_year#50]
-Condition : (d_year#50 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#10))
+Input [3]: [d_date_sk#10, d_date#11, d_year#65]
+Condition : (d_year#65 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#10))
 
 (99) Project [codegen id : 1]
 Output [2]: [d_date_sk#10, d_date#11]
-Input [3]: [d_date_sk#10, d_date#11, d_year#50]
+Input [3]: [d_date_sk#10, d_date#11, d_year#65]
 
 (100) BroadcastExchange
 Input [2]: [d_date_sk#10, d_date#11]
@@ -590,91 +590,91 @@ Subquery:3 Hosting operator id = 44 Hosting Expression = Subquery scalar-subquer
 
 
 (101) Scan parquet spark_catalog.default.store_sales
-Output [4]: [ss_customer_sk#51, ss_quantity#52, ss_sales_price#53, ss_sold_date_sk#54]
+Output [4]: [ss_customer_sk#66, ss_quantity#67, ss_sales_price#68, ss_sold_date_sk#69]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#54), dynamicpruningexpression(ss_sold_date_sk#54 IN dynamicpruning#55)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#69), dynamicpruningexpression(ss_sold_date_sk#69 IN dynamicpruning#70)]
 PushedFilters: [IsNotNull(ss_customer_sk)]
 ReadSchema: struct<ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
 
 (102) ColumnarToRow [codegen id : 2]
-Input [4]: [ss_customer_sk#51, ss_quantity#52, ss_sales_price#53, ss_sold_date_sk#54]
+Input [4]: [ss_customer_sk#66, ss_quantity#67, ss_sales_price#68, ss_sold_date_sk#69]
 
 (103) Filter [codegen id : 2]
-Input [4]: [ss_customer_sk#51, ss_quantity#52, ss_sales_price#53, ss_sold_date_sk#54]
-Condition : isnotnull(ss_customer_sk#51)
+Input [4]: [ss_customer_sk#66, ss_quantity#67, ss_sales_price#68, ss_sold_date_sk#69]
+Condition : isnotnull(ss_customer_sk#66)
 
 (104) ReusedExchange [Reuses operator id: 122]
-Output [1]: [d_date_sk#56]
+Output [1]: [d_date_sk#71]
 
 (105) BroadcastHashJoin [codegen id : 2]
-Left keys [1]: [ss_sold_date_sk#54]
-Right keys [1]: [d_date_sk#56]
+Left keys [1]: [ss_sold_date_sk#69]
+Right keys [1]: [d_date_sk#71]
 Join type: Inner
 Join condition: None
 
 (106) Project [codegen id : 2]
-Output [3]: [ss_customer_sk#51, ss_quantity#52, ss_sales_price#53]
-Input [5]: [ss_customer_sk#51, ss_quantity#52, ss_sales_price#53, ss_sold_date_sk#54, d_date_sk#56]
+Output [3]: [ss_customer_sk#66, ss_quantity#67, ss_sales_price#68]
+Input [5]: [ss_customer_sk#66, ss_quantity#67, ss_sales_price#68, ss_sold_date_sk#69, d_date_sk#71]
 
 (107) Exchange
-Input [3]: [ss_customer_sk#51, ss_quantity#52, ss_sales_price#53]
-Arguments: hashpartitioning(ss_customer_sk#51, 5), ENSURE_REQUIREMENTS, [plan_id=12]
+Input [3]: [ss_customer_sk#66, ss_quantity#67, ss_sales_price#68]
+Arguments: hashpartitioning(ss_customer_sk#66, 5), ENSURE_REQUIREMENTS, [plan_id=12]
 
 (108) Sort [codegen id : 3]
-Input [3]: [ss_customer_sk#51, ss_quantity#52, ss_sales_price#53]
-Arguments: [ss_customer_sk#51 ASC NULLS FIRST], false, 0
+Input [3]: [ss_customer_sk#66, ss_quantity#67, ss_sales_price#68]
+Arguments: [ss_customer_sk#66 ASC NULLS FIRST], false, 0
 
 (109) ReusedExchange [Reuses operator id: 38]
-Output [1]: [c_customer_sk#57]
+Output [1]: [c_customer_sk#72]
 
 (110) Sort [codegen id : 5]
-Input [1]: [c_customer_sk#57]
-Arguments: [c_customer_sk#57 ASC NULLS FIRST], false, 0
+Input [1]: [c_customer_sk#72]
+Arguments: [c_customer_sk#72 ASC NULLS FIRST], false, 0
 
 (111) SortMergeJoin [codegen id : 6]
-Left keys [1]: [ss_customer_sk#51]
-Right keys [1]: [c_customer_sk#57]
+Left keys [1]: [ss_customer_sk#66]
+Right keys [1]: [c_customer_sk#72]
 Join type: Inner
 Join condition: None
 
 (112) Project [codegen id : 6]
-Output [3]: [ss_quantity#52, ss_sales_price#53, c_customer_sk#57]
-Input [4]: [ss_customer_sk#51, ss_quantity#52, ss_sales_price#53, c_customer_sk#57]
+Output [3]: [ss_quantity#67, ss_sales_price#68, c_customer_sk#72]
+Input [4]: [ss_customer_sk#66, ss_quantity#67, ss_sales_price#68, c_customer_sk#72]
 
 (113) HashAggregate [codegen id : 6]
-Input [3]: [ss_quantity#52, ss_sales_price#53, c_customer_sk#57]
-Keys [1]: [c_customer_sk#57]
-Functions [1]: [partial_sum((cast(ss_quantity#52 as decimal(10,0)) * ss_sales_price#53))]
-Aggregate Attributes [2]: [sum#58, isEmpty#59]
-Results [3]: [c_customer_sk#57, sum#60, isEmpty#61]
+Input [3]: [ss_quantity#67, ss_sales_price#68, c_customer_sk#72]
+Keys [1]: [c_customer_sk#72]
+Functions [1]: [partial_sum((cast(ss_quantity#67 as decimal(10,0)) * ss_sales_price#68))]
+Aggregate Attributes [2]: [sum#73, isEmpty#74]
+Results [3]: [c_customer_sk#72, sum#75, isEmpty#76]
 
 (114) HashAggregate [codegen id : 6]
-Input [3]: [c_customer_sk#57, sum#60, isEmpty#61]
-Keys [1]: [c_customer_sk#57]
-Functions [1]: [sum((cast(ss_quantity#52 as decimal(10,0)) * ss_sales_price#53))]
-Aggregate Attributes [1]: [sum((cast(ss_quantity#52 as decimal(10,0)) * ss_sales_price#53))#62]
-Results [1]: [sum((cast(ss_quantity#52 as decimal(10,0)) * ss_sales_price#53))#62 AS csales#63]
+Input [3]: [c_customer_sk#72, sum#75, isEmpty#76]
+Keys [1]: [c_customer_sk#72]
+Functions [1]: [sum((cast(ss_quantity#67 as decimal(10,0)) * ss_sales_price#68))]
+Aggregate Attributes [1]: [sum((cast(ss_quantity#67 as decimal(10,0)) * ss_sales_price#68))#77]
+Results [1]: [sum((cast(ss_quantity#67 as decimal(10,0)) * ss_sales_price#68))#77 AS csales#78]
 
 (115) HashAggregate [codegen id : 6]
-Input [1]: [csales#63]
+Input [1]: [csales#78]
 Keys: []
-Functions [1]: [partial_max(csales#63)]
-Aggregate Attributes [1]: [max#64]
-Results [1]: [max#65]
+Functions [1]: [partial_max(csales#78)]
+Aggregate Attributes [1]: [max#79]
+Results [1]: [max#80]
 
 (116) Exchange
-Input [1]: [max#65]
+Input [1]: [max#80]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=13]
 
 (117) HashAggregate [codegen id : 7]
-Input [1]: [max#65]
+Input [1]: [max#80]
 Keys: []
-Functions [1]: [max(csales#63)]
-Aggregate Attributes [1]: [max(csales#63)#66]
-Results [1]: [max(csales#63)#66 AS tpcds_cmax#67]
+Functions [1]: [max(csales#78)]
+Aggregate Attributes [1]: [max(csales#78)#81]
+Results [1]: [max(csales#78)#81 AS tpcds_cmax#82]
 
-Subquery:4 Hosting operator id = 101 Hosting Expression = ss_sold_date_sk#54 IN dynamicpruning#55
+Subquery:4 Hosting operator id = 101 Hosting Expression = ss_sold_date_sk#69 IN dynamicpruning#70
 BroadcastExchange (122)
 +- * Project (121)
    +- * Filter (120)
@@ -683,25 +683,25 @@ BroadcastExchange (122)
 
 
 (118) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#56, d_year#68]
+Output [2]: [d_date_sk#71, d_year#83]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (119) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#56, d_year#68]
+Input [2]: [d_date_sk#71, d_year#83]
 
 (120) Filter [codegen id : 1]
-Input [2]: [d_date_sk#56, d_year#68]
-Condition : (d_year#68 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#56))
+Input [2]: [d_date_sk#71, d_year#83]
+Condition : (d_year#83 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#71))
 
 (121) Project [codegen id : 1]
-Output [1]: [d_date_sk#56]
-Input [2]: [d_date_sk#56, d_year#68]
+Output [1]: [d_date_sk#71]
+Input [2]: [d_date_sk#71, d_year#83]
 
 (122) BroadcastExchange
-Input [1]: [d_date_sk#56]
+Input [1]: [d_date_sk#71]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=14]
 
 Subquery:5 Hosting operator id = 52 Hosting Expression = ws_sold_date_sk#39 IN dynamicpruning#6
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23a/explain.txt
index 74dcb73f33a..406072290a6 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23a/explain.txt
@@ -291,11 +291,11 @@ ReadSchema: struct<ws_item_sk:int,ws_bill_customer_sk:int,ws_quantity:int,ws_lis
 Input [5]: [ws_item_sk#35, ws_bill_customer_sk#36, ws_quantity#37, ws_list_price#38, ws_sold_date_sk#39]
 
 (48) ReusedExchange [Reuses operator id: 20]
-Output [1]: [item_sk#18]
+Output [1]: [item_sk#40]
 
 (49) BroadcastHashJoin [codegen id : 16]
 Left keys [1]: [ws_item_sk#35]
-Right keys [1]: [item_sk#18]
+Right keys [1]: [item_sk#40]
 Join type: LeftSemi
 Join condition: None
 
@@ -312,30 +312,30 @@ Input [4]: [ws_bill_customer_sk#36, ws_quantity#37, ws_list_price#38, ws_sold_da
 Arguments: [ws_bill_customer_sk#36 ASC NULLS FIRST], false, 0
 
 (53) ReusedExchange [Reuses operator id: 36]
-Output [3]: [c_customer_sk#24, sum#27, isEmpty#28]
+Output [3]: [c_customer_sk#41, sum#42, isEmpty#43]
 
 (54) HashAggregate [codegen id : 20]
-Input [3]: [c_customer_sk#24, sum#27, isEmpty#28]
-Keys [1]: [c_customer_sk#24]
-Functions [1]: [sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))]
-Aggregate Attributes [1]: [sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))#29]
-Results [2]: [c_customer_sk#24, sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))#29 AS ssales#30]
+Input [3]: [c_customer_sk#41, sum#42, isEmpty#43]
+Keys [1]: [c_customer_sk#41]
+Functions [1]: [sum((cast(ss_quantity#44 as decimal(10,0)) * ss_sales_price#45))]
+Aggregate Attributes [1]: [sum((cast(ss_quantity#44 as decimal(10,0)) * ss_sales_price#45))#29]
+Results [2]: [c_customer_sk#41, sum((cast(ss_quantity#44 as decimal(10,0)) * ss_sales_price#45))#29 AS ssales#46]
 
 (55) Filter [codegen id : 20]
-Input [2]: [c_customer_sk#24, ssales#30]
-Condition : (isnotnull(ssales#30) AND (cast(ssales#30 as decimal(38,8)) > (0.500000 * ReusedSubquery Subquery scalar-subquery#31, [id=#32])))
+Input [2]: [c_customer_sk#41, ssales#46]
+Condition : (isnotnull(ssales#46) AND (cast(ssales#46 as decimal(38,8)) > (0.500000 * ReusedSubquery Subquery scalar-subquery#31, [id=#32])))
 
 (56) Project [codegen id : 20]
-Output [1]: [c_customer_sk#24]
-Input [2]: [c_customer_sk#24, ssales#30]
+Output [1]: [c_customer_sk#41]
+Input [2]: [c_customer_sk#41, ssales#46]
 
 (57) Sort [codegen id : 20]
-Input [1]: [c_customer_sk#24]
-Arguments: [c_customer_sk#24 ASC NULLS FIRST], false, 0
+Input [1]: [c_customer_sk#41]
+Arguments: [c_customer_sk#41 ASC NULLS FIRST], false, 0
 
 (58) SortMergeJoin [codegen id : 22]
 Left keys [1]: [ws_bill_customer_sk#36]
-Right keys [1]: [c_customer_sk#24]
+Right keys [1]: [c_customer_sk#41]
 Join type: LeftSemi
 Join condition: None
 
@@ -344,17 +344,17 @@ Output [3]: [ws_quantity#37, ws_list_price#38, ws_sold_date_sk#39]
 Input [4]: [ws_bill_customer_sk#36, ws_quantity#37, ws_list_price#38, ws_sold_date_sk#39]
 
 (60) ReusedExchange [Reuses operator id: 71]
-Output [1]: [d_date_sk#40]
+Output [1]: [d_date_sk#47]
 
 (61) BroadcastHashJoin [codegen id : 22]
 Left keys [1]: [ws_sold_date_sk#39]
-Right keys [1]: [d_date_sk#40]
+Right keys [1]: [d_date_sk#47]
 Join type: Inner
 Join condition: None
 
 (62) Project [codegen id : 22]
-Output [1]: [(cast(ws_quantity#37 as decimal(10,0)) * ws_list_price#38) AS sales#41]
-Input [4]: [ws_quantity#37, ws_list_price#38, ws_sold_date_sk#39, d_date_sk#40]
+Output [1]: [(cast(ws_quantity#37 as decimal(10,0)) * ws_list_price#38) AS sales#48]
+Input [4]: [ws_quantity#37, ws_list_price#38, ws_sold_date_sk#39, d_date_sk#47]
 
 (63) Union
 
@@ -362,19 +362,19 @@ Input [4]: [ws_quantity#37, ws_list_price#38, ws_sold_date_sk#39, d_date_sk#40]
 Input [1]: [sales#34]
 Keys: []
 Functions [1]: [partial_sum(sales#34)]
-Aggregate Attributes [2]: [sum#42, isEmpty#43]
-Results [2]: [sum#44, isEmpty#45]
+Aggregate Attributes [2]: [sum#49, isEmpty#50]
+Results [2]: [sum#51, isEmpty#52]
 
 (65) Exchange
-Input [2]: [sum#44, isEmpty#45]
+Input [2]: [sum#51, isEmpty#52]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=8]
 
 (66) HashAggregate [codegen id : 24]
-Input [2]: [sum#44, isEmpty#45]
+Input [2]: [sum#51, isEmpty#52]
 Keys: []
 Functions [1]: [sum(sales#34)]
-Aggregate Attributes [1]: [sum(sales#34)#46]
-Results [1]: [sum(sales#34)#46 AS sum(sales)#47]
+Aggregate Attributes [1]: [sum(sales#34)#53]
+Results [1]: [sum(sales#34)#53 AS sum(sales)#54]
 
 ===== Subqueries =====
 
@@ -387,22 +387,22 @@ BroadcastExchange (71)
 
 
 (67) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#33, d_year#48, d_moy#49]
+Output [3]: [d_date_sk#33, d_year#55, d_moy#56]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2000), EqualTo(d_moy,2), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
 
 (68) ColumnarToRow [codegen id : 1]
-Input [3]: [d_date_sk#33, d_year#48, d_moy#49]
+Input [3]: [d_date_sk#33, d_year#55, d_moy#56]
 
 (69) Filter [codegen id : 1]
-Input [3]: [d_date_sk#33, d_year#48, d_moy#49]
-Condition : ((((isnotnull(d_year#48) AND isnotnull(d_moy#49)) AND (d_year#48 = 2000)) AND (d_moy#49 = 2)) AND isnotnull(d_date_sk#33))
+Input [3]: [d_date_sk#33, d_year#55, d_moy#56]
+Condition : ((((isnotnull(d_year#55) AND isnotnull(d_moy#56)) AND (d_year#55 = 2000)) AND (d_moy#56 = 2)) AND isnotnull(d_date_sk#33))
 
 (70) Project [codegen id : 1]
 Output [1]: [d_date_sk#33]
-Input [3]: [d_date_sk#33, d_year#48, d_moy#49]
+Input [3]: [d_date_sk#33, d_year#55, d_moy#56]
 
 (71) BroadcastExchange
 Input [1]: [d_date_sk#33]
@@ -417,22 +417,22 @@ BroadcastExchange (76)
 
 
 (72) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#10, d_date#11, d_year#50]
+Output [3]: [d_date_sk#10, d_date#11, d_year#57]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date,d_year:int>
 
 (73) ColumnarToRow [codegen id : 1]
-Input [3]: [d_date_sk#10, d_date#11, d_year#50]
+Input [3]: [d_date_sk#10, d_date#11, d_year#57]
 
 (74) Filter [codegen id : 1]
-Input [3]: [d_date_sk#10, d_date#11, d_year#50]
-Condition : (d_year#50 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#10))
+Input [3]: [d_date_sk#10, d_date#11, d_year#57]
+Condition : (d_year#57 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#10))
 
 (75) Project [codegen id : 1]
 Output [2]: [d_date_sk#10, d_date#11]
-Input [3]: [d_date_sk#10, d_date#11, d_year#50]
+Input [3]: [d_date_sk#10, d_date#11, d_year#57]
 
 (76) BroadcastExchange
 Input [2]: [d_date_sk#10, d_date#11]
@@ -457,83 +457,83 @@ Subquery:3 Hosting operator id = 38 Hosting Expression = Subquery scalar-subquer
 
 
 (77) Scan parquet spark_catalog.default.store_sales
-Output [4]: [ss_customer_sk#51, ss_quantity#52, ss_sales_price#53, ss_sold_date_sk#54]
+Output [4]: [ss_customer_sk#58, ss_quantity#59, ss_sales_price#60, ss_sold_date_sk#61]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#54), dynamicpruningexpression(ss_sold_date_sk#54 IN dynamicpruning#55)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#61), dynamicpruningexpression(ss_sold_date_sk#61 IN dynamicpruning#62)]
 PushedFilters: [IsNotNull(ss_customer_sk)]
 ReadSchema: struct<ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
 
 (78) ColumnarToRow [codegen id : 3]
-Input [4]: [ss_customer_sk#51, ss_quantity#52, ss_sales_price#53, ss_sold_date_sk#54]
+Input [4]: [ss_customer_sk#58, ss_quantity#59, ss_sales_price#60, ss_sold_date_sk#61]
 
 (79) Filter [codegen id : 3]
-Input [4]: [ss_customer_sk#51, ss_quantity#52, ss_sales_price#53, ss_sold_date_sk#54]
-Condition : isnotnull(ss_customer_sk#51)
+Input [4]: [ss_customer_sk#58, ss_quantity#59, ss_sales_price#60, ss_sold_date_sk#61]
+Condition : isnotnull(ss_customer_sk#58)
 
 (80) ReusedExchange [Reuses operator id: 32]
-Output [1]: [c_customer_sk#56]
+Output [1]: [c_customer_sk#63]
 
 (81) BroadcastHashJoin [codegen id : 3]
-Left keys [1]: [ss_customer_sk#51]
-Right keys [1]: [c_customer_sk#56]
+Left keys [1]: [ss_customer_sk#58]
+Right keys [1]: [c_customer_sk#63]
 Join type: Inner
 Join condition: None
 
 (82) Project [codegen id : 3]
-Output [4]: [ss_quantity#52, ss_sales_price#53, ss_sold_date_sk#54, c_customer_sk#56]
-Input [5]: [ss_customer_sk#51, ss_quantity#52, ss_sales_price#53, ss_sold_date_sk#54, c_customer_sk#56]
+Output [4]: [ss_quantity#59, ss_sales_price#60, ss_sold_date_sk#61, c_customer_sk#63]
+Input [5]: [ss_customer_sk#58, ss_quantity#59, ss_sales_price#60, ss_sold_date_sk#61, c_customer_sk#63]
 
 (83) ReusedExchange [Reuses operator id: 96]
-Output [1]: [d_date_sk#57]
+Output [1]: [d_date_sk#64]
 
 (84) BroadcastHashJoin [codegen id : 3]
-Left keys [1]: [ss_sold_date_sk#54]
-Right keys [1]: [d_date_sk#57]
+Left keys [1]: [ss_sold_date_sk#61]
+Right keys [1]: [d_date_sk#64]
 Join type: Inner
 Join condition: None
 
 (85) Project [codegen id : 3]
-Output [3]: [ss_quantity#52, ss_sales_price#53, c_customer_sk#56]
-Input [5]: [ss_quantity#52, ss_sales_price#53, ss_sold_date_sk#54, c_customer_sk#56, d_date_sk#57]
+Output [3]: [ss_quantity#59, ss_sales_price#60, c_customer_sk#63]
+Input [5]: [ss_quantity#59, ss_sales_price#60, ss_sold_date_sk#61, c_customer_sk#63, d_date_sk#64]
 
 (86) HashAggregate [codegen id : 3]
-Input [3]: [ss_quantity#52, ss_sales_price#53, c_customer_sk#56]
-Keys [1]: [c_customer_sk#56]
-Functions [1]: [partial_sum((cast(ss_quantity#52 as decimal(10,0)) * ss_sales_price#53))]
-Aggregate Attributes [2]: [sum#58, isEmpty#59]
-Results [3]: [c_customer_sk#56, sum#60, isEmpty#61]
+Input [3]: [ss_quantity#59, ss_sales_price#60, c_customer_sk#63]
+Keys [1]: [c_customer_sk#63]
+Functions [1]: [partial_sum((cast(ss_quantity#59 as decimal(10,0)) * ss_sales_price#60))]
+Aggregate Attributes [2]: [sum#65, isEmpty#66]
+Results [3]: [c_customer_sk#63, sum#67, isEmpty#68]
 
 (87) Exchange
-Input [3]: [c_customer_sk#56, sum#60, isEmpty#61]
-Arguments: hashpartitioning(c_customer_sk#56, 5), ENSURE_REQUIREMENTS, [plan_id=11]
+Input [3]: [c_customer_sk#63, sum#67, isEmpty#68]
+Arguments: hashpartitioning(c_customer_sk#63, 5), ENSURE_REQUIREMENTS, [plan_id=11]
 
 (88) HashAggregate [codegen id : 4]
-Input [3]: [c_customer_sk#56, sum#60, isEmpty#61]
-Keys [1]: [c_customer_sk#56]
-Functions [1]: [sum((cast(ss_quantity#52 as decimal(10,0)) * ss_sales_price#53))]
-Aggregate Attributes [1]: [sum((cast(ss_quantity#52 as decimal(10,0)) * ss_sales_price#53))#62]
-Results [1]: [sum((cast(ss_quantity#52 as decimal(10,0)) * ss_sales_price#53))#62 AS csales#63]
+Input [3]: [c_customer_sk#63, sum#67, isEmpty#68]
+Keys [1]: [c_customer_sk#63]
+Functions [1]: [sum((cast(ss_quantity#59 as decimal(10,0)) * ss_sales_price#60))]
+Aggregate Attributes [1]: [sum((cast(ss_quantity#59 as decimal(10,0)) * ss_sales_price#60))#69]
+Results [1]: [sum((cast(ss_quantity#59 as decimal(10,0)) * ss_sales_price#60))#69 AS csales#70]
 
 (89) HashAggregate [codegen id : 4]
-Input [1]: [csales#63]
+Input [1]: [csales#70]
 Keys: []
-Functions [1]: [partial_max(csales#63)]
-Aggregate Attributes [1]: [max#64]
-Results [1]: [max#65]
+Functions [1]: [partial_max(csales#70)]
+Aggregate Attributes [1]: [max#71]
+Results [1]: [max#72]
 
 (90) Exchange
-Input [1]: [max#65]
+Input [1]: [max#72]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=12]
 
 (91) HashAggregate [codegen id : 5]
-Input [1]: [max#65]
+Input [1]: [max#72]
 Keys: []
-Functions [1]: [max(csales#63)]
-Aggregate Attributes [1]: [max(csales#63)#66]
-Results [1]: [max(csales#63)#66 AS tpcds_cmax#67]
+Functions [1]: [max(csales#70)]
+Aggregate Attributes [1]: [max(csales#70)#73]
+Results [1]: [max(csales#70)#73 AS tpcds_cmax#74]
 
-Subquery:4 Hosting operator id = 77 Hosting Expression = ss_sold_date_sk#54 IN dynamicpruning#55
+Subquery:4 Hosting operator id = 77 Hosting Expression = ss_sold_date_sk#61 IN dynamicpruning#62
 BroadcastExchange (96)
 +- * Project (95)
    +- * Filter (94)
@@ -542,25 +542,25 @@ BroadcastExchange (96)
 
 
 (92) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#57, d_year#68]
+Output [2]: [d_date_sk#64, d_year#75]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (93) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#57, d_year#68]
+Input [2]: [d_date_sk#64, d_year#75]
 
 (94) Filter [codegen id : 1]
-Input [2]: [d_date_sk#57, d_year#68]
-Condition : (d_year#68 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#57))
+Input [2]: [d_date_sk#64, d_year#75]
+Condition : (d_year#75 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#64))
 
 (95) Project [codegen id : 1]
-Output [1]: [d_date_sk#57]
-Input [2]: [d_date_sk#57, d_year#68]
+Output [1]: [d_date_sk#64]
+Input [2]: [d_date_sk#64, d_year#75]
 
 (96) BroadcastExchange
-Input [1]: [d_date_sk#57]
+Input [1]: [d_date_sk#64]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=13]
 
 Subquery:5 Hosting operator id = 46 Hosting Expression = ws_sold_date_sk#39 IN dynamicpruning#6
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23b.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23b.sf100/explain.txt
index 1c47d62c6ac..038f9478f17 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23b.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23b.sf100/explain.txt
@@ -498,58 +498,58 @@ Input [5]: [ws_item_sk#43, ws_bill_customer_sk#44, ws_quantity#45, ws_list_price
 Arguments: [ws_item_sk#43 ASC NULLS FIRST], false, 0
 
 (79) ReusedExchange [Reuses operator id: 12]
-Output [2]: [ss_item_sk#7, d_date#11]
+Output [2]: [ss_item_sk#48, d_date#49]
 
 (80) Sort [codegen id : 32]
-Input [2]: [ss_item_sk#7, d_date#11]
-Arguments: [ss_item_sk#7 ASC NULLS FIRST], false, 0
+Input [2]: [ss_item_sk#48, d_date#49]
+Arguments: [ss_item_sk#48 ASC NULLS FIRST], false, 0
 
 (81) ReusedExchange [Reuses operator id: 17]
-Output [2]: [i_item_sk#12, i_item_desc#13]
+Output [2]: [i_item_sk#50, i_item_desc#51]
 
 (82) Sort [codegen id : 34]
-Input [2]: [i_item_sk#12, i_item_desc#13]
-Arguments: [i_item_sk#12 ASC NULLS FIRST], false, 0
+Input [2]: [i_item_sk#50, i_item_desc#51]
+Arguments: [i_item_sk#50 ASC NULLS FIRST], false, 0
 
 (83) SortMergeJoin [codegen id : 35]
-Left keys [1]: [ss_item_sk#7]
-Right keys [1]: [i_item_sk#12]
+Left keys [1]: [ss_item_sk#48]
+Right keys [1]: [i_item_sk#50]
 Join type: Inner
 Join condition: None
 
 (84) Project [codegen id : 35]
-Output [3]: [d_date#11, i_item_sk#12, substr(i_item_desc#13, 1, 30) AS _groupingexpression#14]
-Input [4]: [ss_item_sk#7, d_date#11, i_item_sk#12, i_item_desc#13]
+Output [3]: [d_date#49, i_item_sk#50, substr(i_item_desc#51, 1, 30) AS _groupingexpression#14]
+Input [4]: [ss_item_sk#48, d_date#49, i_item_sk#50, i_item_desc#51]
 
 (85) HashAggregate [codegen id : 35]
-Input [3]: [d_date#11, i_item_sk#12, _groupingexpression#14]
-Keys [3]: [_groupingexpression#14, i_item_sk#12, d_date#11]
+Input [3]: [d_date#49, i_item_sk#50, _groupingexpression#14]
+Keys [3]: [_groupingexpression#14, i_item_sk#50, d_date#49]
 Functions [1]: [partial_count(1)]
 Aggregate Attributes [1]: [count#15]
-Results [4]: [_groupingexpression#14, i_item_sk#12, d_date#11, count#16]
+Results [4]: [_groupingexpression#14, i_item_sk#50, d_date#49, count#16]
 
 (86) HashAggregate [codegen id : 35]
-Input [4]: [_groupingexpression#14, i_item_sk#12, d_date#11, count#16]
-Keys [3]: [_groupingexpression#14, i_item_sk#12, d_date#11]
+Input [4]: [_groupingexpression#14, i_item_sk#50, d_date#49, count#16]
+Keys [3]: [_groupingexpression#14, i_item_sk#50, d_date#49]
 Functions [1]: [count(1)]
 Aggregate Attributes [1]: [count(1)#17]
-Results [2]: [i_item_sk#12 AS item_sk#18, count(1)#17 AS cnt#19]
+Results [2]: [i_item_sk#50 AS item_sk#52, count(1)#17 AS cnt#53]
 
 (87) Filter [codegen id : 35]
-Input [2]: [item_sk#18, cnt#19]
-Condition : (cnt#19 > 4)
+Input [2]: [item_sk#52, cnt#53]
+Condition : (cnt#53 > 4)
 
 (88) Project [codegen id : 35]
-Output [1]: [item_sk#18]
-Input [2]: [item_sk#18, cnt#19]
+Output [1]: [item_sk#52]
+Input [2]: [item_sk#52, cnt#53]
 
 (89) Sort [codegen id : 35]
-Input [1]: [item_sk#18]
-Arguments: [item_sk#18 ASC NULLS FIRST], false, 0
+Input [1]: [item_sk#52]
+Arguments: [item_sk#52 ASC NULLS FIRST], false, 0
 
 (90) SortMergeJoin [codegen id : 36]
 Left keys [1]: [ws_item_sk#43]
-Right keys [1]: [item_sk#18]
+Right keys [1]: [item_sk#52]
 Join type: LeftSemi
 Join condition: None
 
@@ -566,164 +566,164 @@ Input [4]: [ws_bill_customer_sk#44, ws_quantity#45, ws_list_price#46, ws_sold_da
 Arguments: [ws_bill_customer_sk#44 ASC NULLS FIRST], false, 0
 
 (94) ReusedExchange [Reuses operator id: 34]
-Output [3]: [ss_customer_sk#20, ss_quantity#21, ss_sales_price#22]
+Output [3]: [ss_customer_sk#54, ss_quantity#55, ss_sales_price#56]
 
 (95) Sort [codegen id : 39]
-Input [3]: [ss_customer_sk#20, ss_quantity#21, ss_sales_price#22]
-Arguments: [ss_customer_sk#20 ASC NULLS FIRST], false, 0
+Input [3]: [ss_customer_sk#54, ss_quantity#55, ss_sales_price#56]
+Arguments: [ss_customer_sk#54 ASC NULLS FIRST], false, 0
 
 (96) ReusedExchange [Reuses operator id: 39]
-Output [1]: [c_customer_sk#24]
+Output [1]: [c_customer_sk#57]
 
 (97) Sort [codegen id : 41]
-Input [1]: [c_customer_sk#24]
-Arguments: [c_customer_sk#24 ASC NULLS FIRST], false, 0
+Input [1]: [c_customer_sk#57]
+Arguments: [c_customer_sk#57 ASC NULLS FIRST], false, 0
 
 (98) SortMergeJoin [codegen id : 42]
-Left keys [1]: [ss_customer_sk#20]
-Right keys [1]: [c_customer_sk#24]
+Left keys [1]: [ss_customer_sk#54]
+Right keys [1]: [c_customer_sk#57]
 Join type: Inner
 Join condition: None
 
 (99) Project [codegen id : 42]
-Output [3]: [ss_quantity#21, ss_sales_price#22, c_customer_sk#24]
-Input [4]: [ss_customer_sk#20, ss_quantity#21, ss_sales_price#22, c_customer_sk#24]
+Output [3]: [ss_quantity#55, ss_sales_price#56, c_customer_sk#57]
+Input [4]: [ss_customer_sk#54, ss_quantity#55, ss_sales_price#56, c_customer_sk#57]
 
 (100) HashAggregate [codegen id : 42]
-Input [3]: [ss_quantity#21, ss_sales_price#22, c_customer_sk#24]
-Keys [1]: [c_customer_sk#24]
-Functions [1]: [partial_sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))]
-Aggregate Attributes [2]: [sum#25, isEmpty#26]
-Results [3]: [c_customer_sk#24, sum#27, isEmpty#28]
+Input [3]: [ss_quantity#55, ss_sales_price#56, c_customer_sk#57]
+Keys [1]: [c_customer_sk#57]
+Functions [1]: [partial_sum((cast(ss_quantity#55 as decimal(10,0)) * ss_sales_price#56))]
+Aggregate Attributes [2]: [sum#58, isEmpty#59]
+Results [3]: [c_customer_sk#57, sum#60, isEmpty#61]
 
 (101) HashAggregate [codegen id : 42]
-Input [3]: [c_customer_sk#24, sum#27, isEmpty#28]
-Keys [1]: [c_customer_sk#24]
-Functions [1]: [sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))]
-Aggregate Attributes [1]: [sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))#29]
-Results [2]: [c_customer_sk#24, sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))#29 AS ssales#30]
+Input [3]: [c_customer_sk#57, sum#60, isEmpty#61]
+Keys [1]: [c_customer_sk#57]
+Functions [1]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_sales_price#56))]
+Aggregate Attributes [1]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_sales_price#56))#29]
+Results [2]: [c_customer_sk#57, sum((cast(ss_quantity#55 as decimal(10,0)) * ss_sales_price#56))#29 AS ssales#62]
 
 (102) Filter [codegen id : 42]
-Input [2]: [c_customer_sk#24, ssales#30]
-Condition : (isnotnull(ssales#30) AND (cast(ssales#30 as decimal(38,8)) > (0.500000 * ReusedSubquery Subquery scalar-subquery#31, [id=#32])))
+Input [2]: [c_customer_sk#57, ssales#62]
+Condition : (isnotnull(ssales#62) AND (cast(ssales#62 as decimal(38,8)) > (0.500000 * ReusedSubquery Subquery scalar-subquery#31, [id=#32])))
 
 (103) Project [codegen id : 42]
-Output [1]: [c_customer_sk#24]
-Input [2]: [c_customer_sk#24, ssales#30]
+Output [1]: [c_customer_sk#57]
+Input [2]: [c_customer_sk#57, ssales#62]
 
 (104) Sort [codegen id : 42]
-Input [1]: [c_customer_sk#24]
-Arguments: [c_customer_sk#24 ASC NULLS FIRST], false, 0
+Input [1]: [c_customer_sk#57]
+Arguments: [c_customer_sk#57 ASC NULLS FIRST], false, 0
 
 (105) SortMergeJoin [codegen id : 44]
 Left keys [1]: [ws_bill_customer_sk#44]
-Right keys [1]: [c_customer_sk#24]
+Right keys [1]: [c_customer_sk#57]
 Join type: LeftSemi
 Join condition: None
 
 (106) ReusedExchange [Reuses operator id: 134]
-Output [1]: [d_date_sk#48]
+Output [1]: [d_date_sk#63]
 
 (107) BroadcastHashJoin [codegen id : 44]
 Left keys [1]: [ws_sold_date_sk#47]
-Right keys [1]: [d_date_sk#48]
+Right keys [1]: [d_date_sk#63]
 Join type: Inner
 Join condition: None
 
 (108) Project [codegen id : 44]
 Output [3]: [ws_bill_customer_sk#44, ws_quantity#45, ws_list_price#46]
-Input [5]: [ws_bill_customer_sk#44, ws_quantity#45, ws_list_price#46, ws_sold_date_sk#47, d_date_sk#48]
+Input [5]: [ws_bill_customer_sk#44, ws_quantity#45, ws_list_price#46, ws_sold_date_sk#47, d_date_sk#63]
 
 (109) ReusedExchange [Reuses operator id: 55]
-Output [3]: [c_customer_sk#49, c_first_name#50, c_last_name#51]
+Output [3]: [c_customer_sk#64, c_first_name#65, c_last_name#66]
 
 (110) Sort [codegen id : 46]
-Input [3]: [c_customer_sk#49, c_first_name#50, c_last_name#51]
-Arguments: [c_customer_sk#49 ASC NULLS FIRST], false, 0
+Input [3]: [c_customer_sk#64, c_first_name#65, c_last_name#66]
+Arguments: [c_customer_sk#64 ASC NULLS FIRST], false, 0
 
 (111) ReusedExchange [Reuses operator id: 34]
-Output [3]: [ss_customer_sk#20, ss_quantity#21, ss_sales_price#22]
+Output [3]: [ss_customer_sk#54, ss_quantity#55, ss_sales_price#56]
 
 (112) Sort [codegen id : 48]
-Input [3]: [ss_customer_sk#20, ss_quantity#21, ss_sales_price#22]
-Arguments: [ss_customer_sk#20 ASC NULLS FIRST], false, 0
+Input [3]: [ss_customer_sk#54, ss_quantity#55, ss_sales_price#56]
+Arguments: [ss_customer_sk#54 ASC NULLS FIRST], false, 0
 
 (113) ReusedExchange [Reuses operator id: 39]
-Output [1]: [c_customer_sk#24]
+Output [1]: [c_customer_sk#57]
 
 (114) Sort [codegen id : 50]
-Input [1]: [c_customer_sk#24]
-Arguments: [c_customer_sk#24 ASC NULLS FIRST], false, 0
+Input [1]: [c_customer_sk#57]
+Arguments: [c_customer_sk#57 ASC NULLS FIRST], false, 0
 
 (115) SortMergeJoin [codegen id : 51]
-Left keys [1]: [ss_customer_sk#20]
-Right keys [1]: [c_customer_sk#24]
+Left keys [1]: [ss_customer_sk#54]
+Right keys [1]: [c_customer_sk#57]
 Join type: Inner
 Join condition: None
 
 (116) Project [codegen id : 51]
-Output [3]: [ss_quantity#21, ss_sales_price#22, c_customer_sk#24]
-Input [4]: [ss_customer_sk#20, ss_quantity#21, ss_sales_price#22, c_customer_sk#24]
+Output [3]: [ss_quantity#55, ss_sales_price#56, c_customer_sk#57]
+Input [4]: [ss_customer_sk#54, ss_quantity#55, ss_sales_price#56, c_customer_sk#57]
 
 (117) HashAggregate [codegen id : 51]
-Input [3]: [ss_quantity#21, ss_sales_price#22, c_customer_sk#24]
-Keys [1]: [c_customer_sk#24]
-Functions [1]: [partial_sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))]
-Aggregate Attributes [2]: [sum#25, isEmpty#26]
-Results [3]: [c_customer_sk#24, sum#27, isEmpty#28]
+Input [3]: [ss_quantity#55, ss_sales_price#56, c_customer_sk#57]
+Keys [1]: [c_customer_sk#57]
+Functions [1]: [partial_sum((cast(ss_quantity#55 as decimal(10,0)) * ss_sales_price#56))]
+Aggregate Attributes [2]: [sum#58, isEmpty#59]
+Results [3]: [c_customer_sk#57, sum#60, isEmpty#61]
 
 (118) HashAggregate [codegen id : 51]
-Input [3]: [c_customer_sk#24, sum#27, isEmpty#28]
-Keys [1]: [c_customer_sk#24]
-Functions [1]: [sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))]
-Aggregate Attributes [1]: [sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))#29]
-Results [2]: [c_customer_sk#24, sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))#29 AS ssales#30]
+Input [3]: [c_customer_sk#57, sum#60, isEmpty#61]
+Keys [1]: [c_customer_sk#57]
+Functions [1]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_sales_price#56))]
+Aggregate Attributes [1]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_sales_price#56))#29]
+Results [2]: [c_customer_sk#57, sum((cast(ss_quantity#55 as decimal(10,0)) * ss_sales_price#56))#29 AS ssales#62]
 
 (119) Filter [codegen id : 51]
-Input [2]: [c_customer_sk#24, ssales#30]
-Condition : (isnotnull(ssales#30) AND (cast(ssales#30 as decimal(38,8)) > (0.500000 * ReusedSubquery Subquery scalar-subquery#31, [id=#32])))
+Input [2]: [c_customer_sk#57, ssales#62]
+Condition : (isnotnull(ssales#62) AND (cast(ssales#62 as decimal(38,8)) > (0.500000 * ReusedSubquery Subquery scalar-subquery#31, [id=#32])))
 
 (120) Project [codegen id : 51]
-Output [1]: [c_customer_sk#24]
-Input [2]: [c_customer_sk#24, ssales#30]
+Output [1]: [c_customer_sk#57]
+Input [2]: [c_customer_sk#57, ssales#62]
 
 (121) Sort [codegen id : 51]
-Input [1]: [c_customer_sk#24]
-Arguments: [c_customer_sk#24 ASC NULLS FIRST], false, 0
+Input [1]: [c_customer_sk#57]
+Arguments: [c_customer_sk#57 ASC NULLS FIRST], false, 0
 
 (122) SortMergeJoin [codegen id : 52]
-Left keys [1]: [c_customer_sk#49]
-Right keys [1]: [c_customer_sk#24]
+Left keys [1]: [c_customer_sk#64]
+Right keys [1]: [c_customer_sk#57]
 Join type: LeftSemi
 Join condition: None
 
 (123) SortMergeJoin [codegen id : 53]
 Left keys [1]: [ws_bill_customer_sk#44]
-Right keys [1]: [c_customer_sk#49]
+Right keys [1]: [c_customer_sk#64]
 Join type: Inner
 Join condition: None
 
 (124) Project [codegen id : 53]
-Output [4]: [ws_quantity#45, ws_list_price#46, c_first_name#50, c_last_name#51]
-Input [6]: [ws_bill_customer_sk#44, ws_quantity#45, ws_list_price#46, c_customer_sk#49, c_first_name#50, c_last_name#51]
+Output [4]: [ws_quantity#45, ws_list_price#46, c_first_name#65, c_last_name#66]
+Input [6]: [ws_bill_customer_sk#44, ws_quantity#45, ws_list_price#46, c_customer_sk#64, c_first_name#65, c_last_name#66]
 
 (125) HashAggregate [codegen id : 53]
-Input [4]: [ws_quantity#45, ws_list_price#46, c_first_name#50, c_last_name#51]
-Keys [2]: [c_last_name#51, c_first_name#50]
+Input [4]: [ws_quantity#45, ws_list_price#46, c_first_name#65, c_last_name#66]
+Keys [2]: [c_last_name#66, c_first_name#65]
 Functions [1]: [partial_sum((cast(ws_quantity#45 as decimal(10,0)) * ws_list_price#46))]
-Aggregate Attributes [2]: [sum#52, isEmpty#53]
-Results [4]: [c_last_name#51, c_first_name#50, sum#54, isEmpty#55]
+Aggregate Attributes [2]: [sum#67, isEmpty#68]
+Results [4]: [c_last_name#66, c_first_name#65, sum#69, isEmpty#70]
 
 (126) Exchange
-Input [4]: [c_last_name#51, c_first_name#50, sum#54, isEmpty#55]
-Arguments: hashpartitioning(c_last_name#51, c_first_name#50, 5), ENSURE_REQUIREMENTS, [plan_id=11]
+Input [4]: [c_last_name#66, c_first_name#65, sum#69, isEmpty#70]
+Arguments: hashpartitioning(c_last_name#66, c_first_name#65, 5), ENSURE_REQUIREMENTS, [plan_id=11]
 
 (127) HashAggregate [codegen id : 54]
-Input [4]: [c_last_name#51, c_first_name#50, sum#54, isEmpty#55]
-Keys [2]: [c_last_name#51, c_first_name#50]
+Input [4]: [c_last_name#66, c_first_name#65, sum#69, isEmpty#70]
+Keys [2]: [c_last_name#66, c_first_name#65]
 Functions [1]: [sum((cast(ws_quantity#45 as decimal(10,0)) * ws_list_price#46))]
-Aggregate Attributes [1]: [sum((cast(ws_quantity#45 as decimal(10,0)) * ws_list_price#46))#56]
-Results [3]: [c_last_name#51, c_first_name#50, sum((cast(ws_quantity#45 as decimal(10,0)) * ws_list_price#46))#56 AS sales#57]
+Aggregate Attributes [1]: [sum((cast(ws_quantity#45 as decimal(10,0)) * ws_list_price#46))#71]
+Results [3]: [c_last_name#66, c_first_name#65, sum((cast(ws_quantity#45 as decimal(10,0)) * ws_list_price#46))#71 AS sales#72]
 
 (128) Union
 
@@ -742,22 +742,22 @@ BroadcastExchange (134)
 
 
 (130) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#33, d_year#58, d_moy#59]
+Output [3]: [d_date_sk#33, d_year#73, d_moy#74]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2000), EqualTo(d_moy,2), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
 
 (131) ColumnarToRow [codegen id : 1]
-Input [3]: [d_date_sk#33, d_year#58, d_moy#59]
+Input [3]: [d_date_sk#33, d_year#73, d_moy#74]
 
 (132) Filter [codegen id : 1]
-Input [3]: [d_date_sk#33, d_year#58, d_moy#59]
-Condition : ((((isnotnull(d_year#58) AND isnotnull(d_moy#59)) AND (d_year#58 = 2000)) AND (d_moy#59 = 2)) AND isnotnull(d_date_sk#33))
+Input [3]: [d_date_sk#33, d_year#73, d_moy#74]
+Condition : ((((isnotnull(d_year#73) AND isnotnull(d_moy#74)) AND (d_year#73 = 2000)) AND (d_moy#74 = 2)) AND isnotnull(d_date_sk#33))
 
 (133) Project [codegen id : 1]
 Output [1]: [d_date_sk#33]
-Input [3]: [d_date_sk#33, d_year#58, d_moy#59]
+Input [3]: [d_date_sk#33, d_year#73, d_moy#74]
 
 (134) BroadcastExchange
 Input [1]: [d_date_sk#33]
@@ -772,22 +772,22 @@ BroadcastExchange (139)
 
 
 (135) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#10, d_date#11, d_year#60]
+Output [3]: [d_date_sk#10, d_date#11, d_year#75]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date,d_year:int>
 
 (136) ColumnarToRow [codegen id : 1]
-Input [3]: [d_date_sk#10, d_date#11, d_year#60]
+Input [3]: [d_date_sk#10, d_date#11, d_year#75]
 
 (137) Filter [codegen id : 1]
-Input [3]: [d_date_sk#10, d_date#11, d_year#60]
-Condition : (d_year#60 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#10))
+Input [3]: [d_date_sk#10, d_date#11, d_year#75]
+Condition : (d_year#75 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#10))
 
 (138) Project [codegen id : 1]
 Output [2]: [d_date_sk#10, d_date#11]
-Input [3]: [d_date_sk#10, d_date#11, d_year#60]
+Input [3]: [d_date_sk#10, d_date#11, d_year#75]
 
 (139) BroadcastExchange
 Input [2]: [d_date_sk#10, d_date#11]
@@ -814,91 +814,91 @@ Subquery:3 Hosting operator id = 45 Hosting Expression = Subquery scalar-subquer
 
 
 (140) Scan parquet spark_catalog.default.store_sales
-Output [4]: [ss_customer_sk#61, ss_quantity#62, ss_sales_price#63, ss_sold_date_sk#64]
+Output [4]: [ss_customer_sk#76, ss_quantity#77, ss_sales_price#78, ss_sold_date_sk#79]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#64), dynamicpruningexpression(ss_sold_date_sk#64 IN dynamicpruning#65)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#79), dynamicpruningexpression(ss_sold_date_sk#79 IN dynamicpruning#80)]
 PushedFilters: [IsNotNull(ss_customer_sk)]
 ReadSchema: struct<ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
 
 (141) ColumnarToRow [codegen id : 2]
-Input [4]: [ss_customer_sk#61, ss_quantity#62, ss_sales_price#63, ss_sold_date_sk#64]
+Input [4]: [ss_customer_sk#76, ss_quantity#77, ss_sales_price#78, ss_sold_date_sk#79]
 
 (142) Filter [codegen id : 2]
-Input [4]: [ss_customer_sk#61, ss_quantity#62, ss_sales_price#63, ss_sold_date_sk#64]
-Condition : isnotnull(ss_customer_sk#61)
+Input [4]: [ss_customer_sk#76, ss_quantity#77, ss_sales_price#78, ss_sold_date_sk#79]
+Condition : isnotnull(ss_customer_sk#76)
 
 (143) ReusedExchange [Reuses operator id: 161]
-Output [1]: [d_date_sk#66]
+Output [1]: [d_date_sk#81]
 
 (144) BroadcastHashJoin [codegen id : 2]
-Left keys [1]: [ss_sold_date_sk#64]
-Right keys [1]: [d_date_sk#66]
+Left keys [1]: [ss_sold_date_sk#79]
+Right keys [1]: [d_date_sk#81]
 Join type: Inner
 Join condition: None
 
 (145) Project [codegen id : 2]
-Output [3]: [ss_customer_sk#61, ss_quantity#62, ss_sales_price#63]
-Input [5]: [ss_customer_sk#61, ss_quantity#62, ss_sales_price#63, ss_sold_date_sk#64, d_date_sk#66]
+Output [3]: [ss_customer_sk#76, ss_quantity#77, ss_sales_price#78]
+Input [5]: [ss_customer_sk#76, ss_quantity#77, ss_sales_price#78, ss_sold_date_sk#79, d_date_sk#81]
 
 (146) Exchange
-Input [3]: [ss_customer_sk#61, ss_quantity#62, ss_sales_price#63]
-Arguments: hashpartitioning(ss_customer_sk#61, 5), ENSURE_REQUIREMENTS, [plan_id=14]
+Input [3]: [ss_customer_sk#76, ss_quantity#77, ss_sales_price#78]
+Arguments: hashpartitioning(ss_customer_sk#76, 5), ENSURE_REQUIREMENTS, [plan_id=14]
 
 (147) Sort [codegen id : 3]
-Input [3]: [ss_customer_sk#61, ss_quantity#62, ss_sales_price#63]
-Arguments: [ss_customer_sk#61 ASC NULLS FIRST], false, 0
+Input [3]: [ss_customer_sk#76, ss_quantity#77, ss_sales_price#78]
+Arguments: [ss_customer_sk#76 ASC NULLS FIRST], false, 0
 
 (148) ReusedExchange [Reuses operator id: 39]
-Output [1]: [c_customer_sk#67]
+Output [1]: [c_customer_sk#82]
 
 (149) Sort [codegen id : 5]
-Input [1]: [c_customer_sk#67]
-Arguments: [c_customer_sk#67 ASC NULLS FIRST], false, 0
+Input [1]: [c_customer_sk#82]
+Arguments: [c_customer_sk#82 ASC NULLS FIRST], false, 0
 
 (150) SortMergeJoin [codegen id : 6]
-Left keys [1]: [ss_customer_sk#61]
-Right keys [1]: [c_customer_sk#67]
+Left keys [1]: [ss_customer_sk#76]
+Right keys [1]: [c_customer_sk#82]
 Join type: Inner
 Join condition: None
 
 (151) Project [codegen id : 6]
-Output [3]: [ss_quantity#62, ss_sales_price#63, c_customer_sk#67]
-Input [4]: [ss_customer_sk#61, ss_quantity#62, ss_sales_price#63, c_customer_sk#67]
+Output [3]: [ss_quantity#77, ss_sales_price#78, c_customer_sk#82]
+Input [4]: [ss_customer_sk#76, ss_quantity#77, ss_sales_price#78, c_customer_sk#82]
 
 (152) HashAggregate [codegen id : 6]
-Input [3]: [ss_quantity#62, ss_sales_price#63, c_customer_sk#67]
-Keys [1]: [c_customer_sk#67]
-Functions [1]: [partial_sum((cast(ss_quantity#62 as decimal(10,0)) * ss_sales_price#63))]
-Aggregate Attributes [2]: [sum#68, isEmpty#69]
-Results [3]: [c_customer_sk#67, sum#70, isEmpty#71]
+Input [3]: [ss_quantity#77, ss_sales_price#78, c_customer_sk#82]
+Keys [1]: [c_customer_sk#82]
+Functions [1]: [partial_sum((cast(ss_quantity#77 as decimal(10,0)) * ss_sales_price#78))]
+Aggregate Attributes [2]: [sum#83, isEmpty#84]
+Results [3]: [c_customer_sk#82, sum#85, isEmpty#86]
 
 (153) HashAggregate [codegen id : 6]
-Input [3]: [c_customer_sk#67, sum#70, isEmpty#71]
-Keys [1]: [c_customer_sk#67]
-Functions [1]: [sum((cast(ss_quantity#62 as decimal(10,0)) * ss_sales_price#63))]
-Aggregate Attributes [1]: [sum((cast(ss_quantity#62 as decimal(10,0)) * ss_sales_price#63))#72]
-Results [1]: [sum((cast(ss_quantity#62 as decimal(10,0)) * ss_sales_price#63))#72 AS csales#73]
+Input [3]: [c_customer_sk#82, sum#85, isEmpty#86]
+Keys [1]: [c_customer_sk#82]
+Functions [1]: [sum((cast(ss_quantity#77 as decimal(10,0)) * ss_sales_price#78))]
+Aggregate Attributes [1]: [sum((cast(ss_quantity#77 as decimal(10,0)) * ss_sales_price#78))#87]
+Results [1]: [sum((cast(ss_quantity#77 as decimal(10,0)) * ss_sales_price#78))#87 AS csales#88]
 
 (154) HashAggregate [codegen id : 6]
-Input [1]: [csales#73]
+Input [1]: [csales#88]
 Keys: []
-Functions [1]: [partial_max(csales#73)]
-Aggregate Attributes [1]: [max#74]
-Results [1]: [max#75]
+Functions [1]: [partial_max(csales#88)]
+Aggregate Attributes [1]: [max#89]
+Results [1]: [max#90]
 
 (155) Exchange
-Input [1]: [max#75]
+Input [1]: [max#90]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=15]
 
 (156) HashAggregate [codegen id : 7]
-Input [1]: [max#75]
+Input [1]: [max#90]
 Keys: []
-Functions [1]: [max(csales#73)]
-Aggregate Attributes [1]: [max(csales#73)#76]
-Results [1]: [max(csales#73)#76 AS tpcds_cmax#77]
+Functions [1]: [max(csales#88)]
+Aggregate Attributes [1]: [max(csales#88)#91]
+Results [1]: [max(csales#88)#91 AS tpcds_cmax#92]
 
-Subquery:4 Hosting operator id = 140 Hosting Expression = ss_sold_date_sk#64 IN dynamicpruning#65
+Subquery:4 Hosting operator id = 140 Hosting Expression = ss_sold_date_sk#79 IN dynamicpruning#80
 BroadcastExchange (161)
 +- * Project (160)
    +- * Filter (159)
@@ -907,25 +907,25 @@ BroadcastExchange (161)
 
 
 (157) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#66, d_year#78]
+Output [2]: [d_date_sk#81, d_year#93]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (158) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#66, d_year#78]
+Input [2]: [d_date_sk#81, d_year#93]
 
 (159) Filter [codegen id : 1]
-Input [2]: [d_date_sk#66, d_year#78]
-Condition : (d_year#78 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#66))
+Input [2]: [d_date_sk#81, d_year#93]
+Condition : (d_year#93 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#81))
 
 (160) Project [codegen id : 1]
-Output [1]: [d_date_sk#66]
-Input [2]: [d_date_sk#66, d_year#78]
+Output [1]: [d_date_sk#81]
+Input [2]: [d_date_sk#81, d_year#93]
 
 (161) BroadcastExchange
-Input [1]: [d_date_sk#66]
+Input [1]: [d_date_sk#81]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=16]
 
 Subquery:5 Hosting operator id = 65 Hosting Expression = ReusedSubquery Subquery scalar-subquery#31, [id=#32]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23b/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23b/explain.txt
index 479bb62b73e..5e90c9067b1 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23b/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q23b/explain.txt
@@ -400,11 +400,11 @@ Input [5]: [ws_item_sk#43, ws_bill_customer_sk#44, ws_quantity#45, ws_list_price
 Condition : isnotnull(ws_bill_customer_sk#44)
 
 (66) ReusedExchange [Reuses operator id: 21]
-Output [1]: [item_sk#18]
+Output [1]: [item_sk#48]
 
 (67) BroadcastHashJoin [codegen id : 23]
 Left keys [1]: [ws_item_sk#43]
-Right keys [1]: [item_sk#18]
+Right keys [1]: [item_sk#48]
 Join type: LeftSemi
 Join condition: None
 
@@ -421,76 +421,76 @@ Input [4]: [ws_bill_customer_sk#44, ws_quantity#45, ws_list_price#46, ws_sold_da
 Arguments: [ws_bill_customer_sk#44 ASC NULLS FIRST], false, 0
 
 (71) ReusedExchange [Reuses operator id: 37]
-Output [3]: [c_customer_sk#24, sum#27, isEmpty#28]
+Output [3]: [c_customer_sk#49, sum#50, isEmpty#51]
 
 (72) HashAggregate [codegen id : 27]
-Input [3]: [c_customer_sk#24, sum#27, isEmpty#28]
-Keys [1]: [c_customer_sk#24]
-Functions [1]: [sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))]
-Aggregate Attributes [1]: [sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))#29]
-Results [2]: [c_customer_sk#24, sum((cast(ss_quantity#21 as decimal(10,0)) * ss_sales_price#22))#29 AS ssales#30]
+Input [3]: [c_customer_sk#49, sum#50, isEmpty#51]
+Keys [1]: [c_customer_sk#49]
+Functions [1]: [sum((cast(ss_quantity#52 as decimal(10,0)) * ss_sales_price#53))]
+Aggregate Attributes [1]: [sum((cast(ss_quantity#52 as decimal(10,0)) * ss_sales_price#53))#29]
+Results [2]: [c_customer_sk#49, sum((cast(ss_quantity#52 as decimal(10,0)) * ss_sales_price#53))#29 AS ssales#54]
 
 (73) Filter [codegen id : 27]
-Input [2]: [c_customer_sk#24, ssales#30]
-Condition : (isnotnull(ssales#30) AND (cast(ssales#30 as decimal(38,8)) > (0.500000 * ReusedSubquery Subquery scalar-subquery#31, [id=#32])))
+Input [2]: [c_customer_sk#49, ssales#54]
+Condition : (isnotnull(ssales#54) AND (cast(ssales#54 as decimal(38,8)) > (0.500000 * ReusedSubquery Subquery scalar-subquery#31, [id=#32])))
 
 (74) Project [codegen id : 27]
-Output [1]: [c_customer_sk#24]
-Input [2]: [c_customer_sk#24, ssales#30]
+Output [1]: [c_customer_sk#49]
+Input [2]: [c_customer_sk#49, ssales#54]
 
 (75) Sort [codegen id : 27]
-Input [1]: [c_customer_sk#24]
-Arguments: [c_customer_sk#24 ASC NULLS FIRST], false, 0
+Input [1]: [c_customer_sk#49]
+Arguments: [c_customer_sk#49 ASC NULLS FIRST], false, 0
 
 (76) SortMergeJoin [codegen id : 35]
 Left keys [1]: [ws_bill_customer_sk#44]
-Right keys [1]: [c_customer_sk#24]
+Right keys [1]: [c_customer_sk#49]
 Join type: LeftSemi
 Join condition: None
 
 (77) ReusedExchange [Reuses operator id: 54]
-Output [3]: [c_customer_sk#48, c_first_name#49, c_last_name#50]
+Output [3]: [c_customer_sk#55, c_first_name#56, c_last_name#57]
 
 (78) BroadcastHashJoin [codegen id : 35]
 Left keys [1]: [ws_bill_customer_sk#44]
-Right keys [1]: [c_customer_sk#48]
+Right keys [1]: [c_customer_sk#55]
 Join type: Inner
 Join condition: None
 
 (79) Project [codegen id : 35]
-Output [5]: [ws_quantity#45, ws_list_price#46, ws_sold_date_sk#47, c_first_name#49, c_last_name#50]
-Input [7]: [ws_bill_customer_sk#44, ws_quantity#45, ws_list_price#46, ws_sold_date_sk#47, c_customer_sk#48, c_first_name#49, c_last_name#50]
+Output [5]: [ws_quantity#45, ws_list_price#46, ws_sold_date_sk#47, c_first_name#56, c_last_name#57]
+Input [7]: [ws_bill_customer_sk#44, ws_quantity#45, ws_list_price#46, ws_sold_date_sk#47, c_customer_sk#55, c_first_name#56, c_last_name#57]
 
 (80) ReusedExchange [Reuses operator id: 92]
-Output [1]: [d_date_sk#51]
+Output [1]: [d_date_sk#58]
 
 (81) BroadcastHashJoin [codegen id : 35]
 Left keys [1]: [ws_sold_date_sk#47]
-Right keys [1]: [d_date_sk#51]
+Right keys [1]: [d_date_sk#58]
 Join type: Inner
 Join condition: None
 
 (82) Project [codegen id : 35]
-Output [4]: [ws_quantity#45, ws_list_price#46, c_first_name#49, c_last_name#50]
-Input [6]: [ws_quantity#45, ws_list_price#46, ws_sold_date_sk#47, c_first_name#49, c_last_name#50, d_date_sk#51]
+Output [4]: [ws_quantity#45, ws_list_price#46, c_first_name#56, c_last_name#57]
+Input [6]: [ws_quantity#45, ws_list_price#46, ws_sold_date_sk#47, c_first_name#56, c_last_name#57, d_date_sk#58]
 
 (83) HashAggregate [codegen id : 35]
-Input [4]: [ws_quantity#45, ws_list_price#46, c_first_name#49, c_last_name#50]
-Keys [2]: [c_last_name#50, c_first_name#49]
+Input [4]: [ws_quantity#45, ws_list_price#46, c_first_name#56, c_last_name#57]
+Keys [2]: [c_last_name#57, c_first_name#56]
 Functions [1]: [partial_sum((cast(ws_quantity#45 as decimal(10,0)) * ws_list_price#46))]
-Aggregate Attributes [2]: [sum#52, isEmpty#53]
-Results [4]: [c_last_name#50, c_first_name#49, sum#54, isEmpty#55]
+Aggregate Attributes [2]: [sum#59, isEmpty#60]
+Results [4]: [c_last_name#57, c_first_name#56, sum#61, isEmpty#62]
 
 (84) Exchange
-Input [4]: [c_last_name#50, c_first_name#49, sum#54, isEmpty#55]
-Arguments: hashpartitioning(c_last_name#50, c_first_name#49, 5), ENSURE_REQUIREMENTS, [plan_id=11]
+Input [4]: [c_last_name#57, c_first_name#56, sum#61, isEmpty#62]
+Arguments: hashpartitioning(c_last_name#57, c_first_name#56, 5), ENSURE_REQUIREMENTS, [plan_id=11]
 
 (85) HashAggregate [codegen id : 36]
-Input [4]: [c_last_name#50, c_first_name#49, sum#54, isEmpty#55]
-Keys [2]: [c_last_name#50, c_first_name#49]
+Input [4]: [c_last_name#57, c_first_name#56, sum#61, isEmpty#62]
+Keys [2]: [c_last_name#57, c_first_name#56]
 Functions [1]: [sum((cast(ws_quantity#45 as decimal(10,0)) * ws_list_price#46))]
-Aggregate Attributes [1]: [sum((cast(ws_quantity#45 as decimal(10,0)) * ws_list_price#46))#56]
-Results [3]: [c_last_name#50, c_first_name#49, sum((cast(ws_quantity#45 as decimal(10,0)) * ws_list_price#46))#56 AS sales#57]
+Aggregate Attributes [1]: [sum((cast(ws_quantity#45 as decimal(10,0)) * ws_list_price#46))#63]
+Results [3]: [c_last_name#57, c_first_name#56, sum((cast(ws_quantity#45 as decimal(10,0)) * ws_list_price#46))#63 AS sales#64]
 
 (86) Union
 
@@ -509,22 +509,22 @@ BroadcastExchange (92)
 
 
 (88) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#36, d_year#58, d_moy#59]
+Output [3]: [d_date_sk#36, d_year#65, d_moy#66]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2000), EqualTo(d_moy,2), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
 
 (89) ColumnarToRow [codegen id : 1]
-Input [3]: [d_date_sk#36, d_year#58, d_moy#59]
+Input [3]: [d_date_sk#36, d_year#65, d_moy#66]
 
 (90) Filter [codegen id : 1]
-Input [3]: [d_date_sk#36, d_year#58, d_moy#59]
-Condition : ((((isnotnull(d_year#58) AND isnotnull(d_moy#59)) AND (d_year#58 = 2000)) AND (d_moy#59 = 2)) AND isnotnull(d_date_sk#36))
+Input [3]: [d_date_sk#36, d_year#65, d_moy#66]
+Condition : ((((isnotnull(d_year#65) AND isnotnull(d_moy#66)) AND (d_year#65 = 2000)) AND (d_moy#66 = 2)) AND isnotnull(d_date_sk#36))
 
 (91) Project [codegen id : 1]
 Output [1]: [d_date_sk#36]
-Input [3]: [d_date_sk#36, d_year#58, d_moy#59]
+Input [3]: [d_date_sk#36, d_year#65, d_moy#66]
 
 (92) BroadcastExchange
 Input [1]: [d_date_sk#36]
@@ -539,22 +539,22 @@ BroadcastExchange (97)
 
 
 (93) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#10, d_date#11, d_year#60]
+Output [3]: [d_date_sk#10, d_date#11, d_year#67]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date,d_year:int>
 
 (94) ColumnarToRow [codegen id : 1]
-Input [3]: [d_date_sk#10, d_date#11, d_year#60]
+Input [3]: [d_date_sk#10, d_date#11, d_year#67]
 
 (95) Filter [codegen id : 1]
-Input [3]: [d_date_sk#10, d_date#11, d_year#60]
-Condition : (d_year#60 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#10))
+Input [3]: [d_date_sk#10, d_date#11, d_year#67]
+Condition : (d_year#67 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#10))
 
 (96) Project [codegen id : 1]
 Output [2]: [d_date_sk#10, d_date#11]
-Input [3]: [d_date_sk#10, d_date#11, d_year#60]
+Input [3]: [d_date_sk#10, d_date#11, d_year#67]
 
 (97) BroadcastExchange
 Input [2]: [d_date_sk#10, d_date#11]
@@ -579,83 +579,83 @@ Subquery:3 Hosting operator id = 39 Hosting Expression = Subquery scalar-subquer
 
 
 (98) Scan parquet spark_catalog.default.store_sales
-Output [4]: [ss_customer_sk#61, ss_quantity#62, ss_sales_price#63, ss_sold_date_sk#64]
+Output [4]: [ss_customer_sk#68, ss_quantity#69, ss_sales_price#70, ss_sold_date_sk#71]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#64), dynamicpruningexpression(ss_sold_date_sk#64 IN dynamicpruning#65)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#71), dynamicpruningexpression(ss_sold_date_sk#71 IN dynamicpruning#72)]
 PushedFilters: [IsNotNull(ss_customer_sk)]
 ReadSchema: struct<ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
 
 (99) ColumnarToRow [codegen id : 3]
-Input [4]: [ss_customer_sk#61, ss_quantity#62, ss_sales_price#63, ss_sold_date_sk#64]
+Input [4]: [ss_customer_sk#68, ss_quantity#69, ss_sales_price#70, ss_sold_date_sk#71]
 
 (100) Filter [codegen id : 3]
-Input [4]: [ss_customer_sk#61, ss_quantity#62, ss_sales_price#63, ss_sold_date_sk#64]
-Condition : isnotnull(ss_customer_sk#61)
+Input [4]: [ss_customer_sk#68, ss_quantity#69, ss_sales_price#70, ss_sold_date_sk#71]
+Condition : isnotnull(ss_customer_sk#68)
 
 (101) ReusedExchange [Reuses operator id: 33]
-Output [1]: [c_customer_sk#66]
+Output [1]: [c_customer_sk#73]
 
 (102) BroadcastHashJoin [codegen id : 3]
-Left keys [1]: [ss_customer_sk#61]
-Right keys [1]: [c_customer_sk#66]
+Left keys [1]: [ss_customer_sk#68]
+Right keys [1]: [c_customer_sk#73]
 Join type: Inner
 Join condition: None
 
 (103) Project [codegen id : 3]
-Output [4]: [ss_quantity#62, ss_sales_price#63, ss_sold_date_sk#64, c_customer_sk#66]
-Input [5]: [ss_customer_sk#61, ss_quantity#62, ss_sales_price#63, ss_sold_date_sk#64, c_customer_sk#66]
+Output [4]: [ss_quantity#69, ss_sales_price#70, ss_sold_date_sk#71, c_customer_sk#73]
+Input [5]: [ss_customer_sk#68, ss_quantity#69, ss_sales_price#70, ss_sold_date_sk#71, c_customer_sk#73]
 
 (104) ReusedExchange [Reuses operator id: 117]
-Output [1]: [d_date_sk#67]
+Output [1]: [d_date_sk#74]
 
 (105) BroadcastHashJoin [codegen id : 3]
-Left keys [1]: [ss_sold_date_sk#64]
-Right keys [1]: [d_date_sk#67]
+Left keys [1]: [ss_sold_date_sk#71]
+Right keys [1]: [d_date_sk#74]
 Join type: Inner
 Join condition: None
 
 (106) Project [codegen id : 3]
-Output [3]: [ss_quantity#62, ss_sales_price#63, c_customer_sk#66]
-Input [5]: [ss_quantity#62, ss_sales_price#63, ss_sold_date_sk#64, c_customer_sk#66, d_date_sk#67]
+Output [3]: [ss_quantity#69, ss_sales_price#70, c_customer_sk#73]
+Input [5]: [ss_quantity#69, ss_sales_price#70, ss_sold_date_sk#71, c_customer_sk#73, d_date_sk#74]
 
 (107) HashAggregate [codegen id : 3]
-Input [3]: [ss_quantity#62, ss_sales_price#63, c_customer_sk#66]
-Keys [1]: [c_customer_sk#66]
-Functions [1]: [partial_sum((cast(ss_quantity#62 as decimal(10,0)) * ss_sales_price#63))]
-Aggregate Attributes [2]: [sum#68, isEmpty#69]
-Results [3]: [c_customer_sk#66, sum#70, isEmpty#71]
+Input [3]: [ss_quantity#69, ss_sales_price#70, c_customer_sk#73]
+Keys [1]: [c_customer_sk#73]
+Functions [1]: [partial_sum((cast(ss_quantity#69 as decimal(10,0)) * ss_sales_price#70))]
+Aggregate Attributes [2]: [sum#75, isEmpty#76]
+Results [3]: [c_customer_sk#73, sum#77, isEmpty#78]
 
 (108) Exchange
-Input [3]: [c_customer_sk#66, sum#70, isEmpty#71]
-Arguments: hashpartitioning(c_customer_sk#66, 5), ENSURE_REQUIREMENTS, [plan_id=14]
+Input [3]: [c_customer_sk#73, sum#77, isEmpty#78]
+Arguments: hashpartitioning(c_customer_sk#73, 5), ENSURE_REQUIREMENTS, [plan_id=14]
 
 (109) HashAggregate [codegen id : 4]
-Input [3]: [c_customer_sk#66, sum#70, isEmpty#71]
-Keys [1]: [c_customer_sk#66]
-Functions [1]: [sum((cast(ss_quantity#62 as decimal(10,0)) * ss_sales_price#63))]
-Aggregate Attributes [1]: [sum((cast(ss_quantity#62 as decimal(10,0)) * ss_sales_price#63))#72]
-Results [1]: [sum((cast(ss_quantity#62 as decimal(10,0)) * ss_sales_price#63))#72 AS csales#73]
+Input [3]: [c_customer_sk#73, sum#77, isEmpty#78]
+Keys [1]: [c_customer_sk#73]
+Functions [1]: [sum((cast(ss_quantity#69 as decimal(10,0)) * ss_sales_price#70))]
+Aggregate Attributes [1]: [sum((cast(ss_quantity#69 as decimal(10,0)) * ss_sales_price#70))#79]
+Results [1]: [sum((cast(ss_quantity#69 as decimal(10,0)) * ss_sales_price#70))#79 AS csales#80]
 
 (110) HashAggregate [codegen id : 4]
-Input [1]: [csales#73]
+Input [1]: [csales#80]
 Keys: []
-Functions [1]: [partial_max(csales#73)]
-Aggregate Attributes [1]: [max#74]
-Results [1]: [max#75]
+Functions [1]: [partial_max(csales#80)]
+Aggregate Attributes [1]: [max#81]
+Results [1]: [max#82]
 
 (111) Exchange
-Input [1]: [max#75]
+Input [1]: [max#82]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=15]
 
 (112) HashAggregate [codegen id : 5]
-Input [1]: [max#75]
+Input [1]: [max#82]
 Keys: []
-Functions [1]: [max(csales#73)]
-Aggregate Attributes [1]: [max(csales#73)#76]
-Results [1]: [max(csales#73)#76 AS tpcds_cmax#77]
+Functions [1]: [max(csales#80)]
+Aggregate Attributes [1]: [max(csales#80)#83]
+Results [1]: [max(csales#80)#83 AS tpcds_cmax#84]
 
-Subquery:4 Hosting operator id = 98 Hosting Expression = ss_sold_date_sk#64 IN dynamicpruning#65
+Subquery:4 Hosting operator id = 98 Hosting Expression = ss_sold_date_sk#71 IN dynamicpruning#72
 BroadcastExchange (117)
 +- * Project (116)
    +- * Filter (115)
@@ -664,25 +664,25 @@ BroadcastExchange (117)
 
 
 (113) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#67, d_year#78]
+Output [2]: [d_date_sk#74, d_year#85]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (114) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#67, d_year#78]
+Input [2]: [d_date_sk#74, d_year#85]
 
 (115) Filter [codegen id : 1]
-Input [2]: [d_date_sk#67, d_year#78]
-Condition : (d_year#78 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#67))
+Input [2]: [d_date_sk#74, d_year#85]
+Condition : (d_year#85 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#74))
 
 (116) Project [codegen id : 1]
-Output [1]: [d_date_sk#67]
-Input [2]: [d_date_sk#67, d_year#78]
+Output [1]: [d_date_sk#74]
+Input [2]: [d_date_sk#74, d_year#85]
 
 (117) BroadcastExchange
-Input [1]: [d_date_sk#67]
+Input [1]: [d_date_sk#74]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=16]
 
 Subquery:5 Hosting operator id = 50 Hosting Expression = ReusedSubquery Subquery scalar-subquery#31, [id=#32]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24a.sf100/explain.txt
index 1a10d275312..3c66d29b802 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24a.sf100/explain.txt
@@ -333,219 +333,219 @@ Subquery:1 Hosting operator id = 49 Hosting Expression = Subquery scalar-subquer
 
 
 (50) Scan parquet spark_catalog.default.store_sales
-Output [6]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, ss_sold_date_sk#6]
+Output [6]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44, ss_sold_date_sk#45]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store_sales]
 PushedFilters: [IsNotNull(ss_ticket_number), IsNotNull(ss_item_sk), IsNotNull(ss_store_sk), IsNotNull(ss_customer_sk)]
 ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_ticket_number:int,ss_net_paid:decimal(7,2)>
 
 (51) ColumnarToRow [codegen id : 2]
-Input [6]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, ss_sold_date_sk#6]
+Input [6]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44, ss_sold_date_sk#45]
 
 (52) Filter [codegen id : 2]
-Input [6]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, ss_sold_date_sk#6]
-Condition : (((isnotnull(ss_ticket_number#4) AND isnotnull(ss_item_sk#1)) AND isnotnull(ss_store_sk#3)) AND isnotnull(ss_customer_sk#2))
+Input [6]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44, ss_sold_date_sk#45]
+Condition : (((isnotnull(ss_ticket_number#43) AND isnotnull(ss_item_sk#40)) AND isnotnull(ss_store_sk#42)) AND isnotnull(ss_customer_sk#41))
 
 (53) Project [codegen id : 2]
-Output [5]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5]
-Input [6]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, ss_sold_date_sk#6]
+Output [5]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44]
+Input [6]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44, ss_sold_date_sk#45]
 
 (54) Scan parquet spark_catalog.default.store
-Output [5]: [s_store_sk#20, s_store_name#21, s_market_id#22, s_state#23, s_zip#24]
+Output [5]: [s_store_sk#46, s_store_name#47, s_market_id#48, s_state#49, s_zip#50]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store]
 PushedFilters: [IsNotNull(s_market_id), EqualTo(s_market_id,8), IsNotNull(s_store_sk), IsNotNull(s_zip)]
 ReadSchema: struct<s_store_sk:int,s_store_name:string,s_market_id:int,s_state:string,s_zip:string>
 
 (55) ColumnarToRow [codegen id : 1]
-Input [5]: [s_store_sk#20, s_store_name#21, s_market_id#22, s_state#23, s_zip#24]
+Input [5]: [s_store_sk#46, s_store_name#47, s_market_id#48, s_state#49, s_zip#50]
 
 (56) Filter [codegen id : 1]
-Input [5]: [s_store_sk#20, s_store_name#21, s_market_id#22, s_state#23, s_zip#24]
-Condition : (((isnotnull(s_market_id#22) AND (s_market_id#22 = 8)) AND isnotnull(s_store_sk#20)) AND isnotnull(s_zip#24))
+Input [5]: [s_store_sk#46, s_store_name#47, s_market_id#48, s_state#49, s_zip#50]
+Condition : (((isnotnull(s_market_id#48) AND (s_market_id#48 = 8)) AND isnotnull(s_store_sk#46)) AND isnotnull(s_zip#50))
 
 (57) Project [codegen id : 1]
-Output [4]: [s_store_sk#20, s_store_name#21, s_state#23, s_zip#24]
-Input [5]: [s_store_sk#20, s_store_name#21, s_market_id#22, s_state#23, s_zip#24]
+Output [4]: [s_store_sk#46, s_store_name#47, s_state#49, s_zip#50]
+Input [5]: [s_store_sk#46, s_store_name#47, s_market_id#48, s_state#49, s_zip#50]
 
 (58) BroadcastExchange
-Input [4]: [s_store_sk#20, s_store_name#21, s_state#23, s_zip#24]
+Input [4]: [s_store_sk#46, s_store_name#47, s_state#49, s_zip#50]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=10]
 
 (59) BroadcastHashJoin [codegen id : 2]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#20]
+Left keys [1]: [ss_store_sk#42]
+Right keys [1]: [s_store_sk#46]
 Join type: Inner
 Join condition: None
 
 (60) Project [codegen id : 2]
-Output [7]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24]
-Input [9]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, s_store_sk#20, s_store_name#21, s_state#23, s_zip#24]
+Output [7]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50]
+Input [9]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44, s_store_sk#46, s_store_name#47, s_state#49, s_zip#50]
 
 (61) Exchange
-Input [7]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24]
-Arguments: hashpartitioning(ss_item_sk#1, 5), ENSURE_REQUIREMENTS, [plan_id=11]
+Input [7]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50]
+Arguments: hashpartitioning(ss_item_sk#40, 5), ENSURE_REQUIREMENTS, [plan_id=11]
 
 (62) Sort [codegen id : 3]
-Input [7]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24]
-Arguments: [ss_item_sk#1 ASC NULLS FIRST], false, 0
+Input [7]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50]
+Arguments: [ss_item_sk#40 ASC NULLS FIRST], false, 0
 
 (63) Scan parquet spark_catalog.default.item
-Output [6]: [i_item_sk#7, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
+Output [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/item]
 PushedFilters: [IsNotNull(i_item_sk)]
 ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_size:string,i_color:string,i_units:string,i_manager_id:int>
 
 (64) ColumnarToRow [codegen id : 4]
-Input [6]: [i_item_sk#7, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 
 (65) Filter [codegen id : 4]
-Input [6]: [i_item_sk#7, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
-Condition : isnotnull(i_item_sk#7)
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Condition : isnotnull(i_item_sk#51)
 
 (66) Exchange
-Input [6]: [i_item_sk#7, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
-Arguments: hashpartitioning(i_item_sk#7, 5), ENSURE_REQUIREMENTS, [plan_id=12]
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Arguments: hashpartitioning(i_item_sk#51, 5), ENSURE_REQUIREMENTS, [plan_id=12]
 
 (67) Sort [codegen id : 5]
-Input [6]: [i_item_sk#7, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
-Arguments: [i_item_sk#7 ASC NULLS FIRST], false, 0
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Arguments: [i_item_sk#51 ASC NULLS FIRST], false, 0
 
 (68) SortMergeJoin [codegen id : 6]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#7]
+Left keys [1]: [ss_item_sk#40]
+Right keys [1]: [i_item_sk#51]
 Join type: Inner
 Join condition: None
 
 (69) Project [codegen id : 6]
-Output [12]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
-Input [13]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_item_sk#7, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
+Output [12]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Input [13]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 
 (70) Exchange
-Input [12]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
-Arguments: hashpartitioning(ss_customer_sk#2, 5), ENSURE_REQUIREMENTS, [plan_id=13]
+Input [12]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Arguments: hashpartitioning(ss_customer_sk#41, 5), ENSURE_REQUIREMENTS, [plan_id=13]
 
 (71) Sort [codegen id : 7]
-Input [12]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
-Arguments: [ss_customer_sk#2 ASC NULLS FIRST], false, 0
+Input [12]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Arguments: [ss_customer_sk#41 ASC NULLS FIRST], false, 0
 
 (72) ReusedExchange [Reuses operator id: 16]
-Output [4]: [c_customer_sk#13, c_first_name#14, c_last_name#15, c_birth_country#16]
+Output [4]: [c_customer_sk#57, c_first_name#58, c_last_name#59, c_birth_country#60]
 
 (73) Sort [codegen id : 9]
-Input [4]: [c_customer_sk#13, c_first_name#14, c_last_name#15, c_birth_country#16]
-Arguments: [c_customer_sk#13 ASC NULLS FIRST], false, 0
+Input [4]: [c_customer_sk#57, c_first_name#58, c_last_name#59, c_birth_country#60]
+Arguments: [c_customer_sk#57 ASC NULLS FIRST], false, 0
 
 (74) SortMergeJoin [codegen id : 10]
-Left keys [1]: [ss_customer_sk#2]
-Right keys [1]: [c_customer_sk#13]
+Left keys [1]: [ss_customer_sk#41]
+Right keys [1]: [c_customer_sk#57]
 Join type: Inner
 Join condition: None
 
 (75) Project [codegen id : 10]
-Output [14]: [ss_item_sk#1, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16]
-Input [16]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_customer_sk#13, c_first_name#14, c_last_name#15, c_birth_country#16]
+Output [14]: [ss_item_sk#40, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Input [16]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_customer_sk#57, c_first_name#58, c_last_name#59, c_birth_country#60]
 
 (76) Exchange
-Input [14]: [ss_item_sk#1, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16]
-Arguments: hashpartitioning(ss_ticket_number#4, ss_item_sk#1, 5), ENSURE_REQUIREMENTS, [plan_id=14]
+Input [14]: [ss_item_sk#40, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Arguments: hashpartitioning(ss_ticket_number#43, ss_item_sk#40, 5), ENSURE_REQUIREMENTS, [plan_id=14]
 
 (77) Sort [codegen id : 11]
-Input [14]: [ss_item_sk#1, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16]
-Arguments: [ss_ticket_number#4 ASC NULLS FIRST, ss_item_sk#1 ASC NULLS FIRST], false, 0
+Input [14]: [ss_item_sk#40, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Arguments: [ss_ticket_number#43 ASC NULLS FIRST, ss_item_sk#40 ASC NULLS FIRST], false, 0
 
 (78) ReusedExchange [Reuses operator id: 26]
-Output [2]: [sr_item_sk#17, sr_ticket_number#18]
+Output [2]: [sr_item_sk#61, sr_ticket_number#62]
 
 (79) Sort [codegen id : 13]
-Input [2]: [sr_item_sk#17, sr_ticket_number#18]
-Arguments: [sr_ticket_number#18 ASC NULLS FIRST, sr_item_sk#17 ASC NULLS FIRST], false, 0
+Input [2]: [sr_item_sk#61, sr_ticket_number#62]
+Arguments: [sr_ticket_number#62 ASC NULLS FIRST, sr_item_sk#61 ASC NULLS FIRST], false, 0
 
 (80) SortMergeJoin [codegen id : 14]
-Left keys [2]: [ss_ticket_number#4, ss_item_sk#1]
-Right keys [2]: [sr_ticket_number#18, sr_item_sk#17]
+Left keys [2]: [ss_ticket_number#43, ss_item_sk#40]
+Right keys [2]: [sr_ticket_number#62, sr_item_sk#61]
 Join type: Inner
 Join condition: None
 
 (81) Project [codegen id : 14]
-Output [12]: [ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16]
-Input [16]: [ss_item_sk#1, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16, sr_item_sk#17, sr_ticket_number#18]
+Output [12]: [ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Input [16]: [ss_item_sk#40, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60, sr_item_sk#61, sr_ticket_number#62]
 
 (82) Exchange
-Input [12]: [ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16]
-Arguments: hashpartitioning(c_birth_country#16, s_zip#24, 5), ENSURE_REQUIREMENTS, [plan_id=15]
+Input [12]: [ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Arguments: hashpartitioning(c_birth_country#60, s_zip#50, 5), ENSURE_REQUIREMENTS, [plan_id=15]
 
 (83) Sort [codegen id : 15]
-Input [12]: [ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16]
-Arguments: [c_birth_country#16 ASC NULLS FIRST, s_zip#24 ASC NULLS FIRST], false, 0
+Input [12]: [ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Arguments: [c_birth_country#60 ASC NULLS FIRST, s_zip#50 ASC NULLS FIRST], false, 0
 
 (84) Scan parquet spark_catalog.default.customer_address
-Output [3]: [ca_state#25, ca_zip#26, ca_country#27]
+Output [3]: [ca_state#63, ca_zip#64, ca_country#65]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [IsNotNull(ca_country), IsNotNull(ca_zip)]
 ReadSchema: struct<ca_state:string,ca_zip:string,ca_country:string>
 
 (85) ColumnarToRow [codegen id : 16]
-Input [3]: [ca_state#25, ca_zip#26, ca_country#27]
+Input [3]: [ca_state#63, ca_zip#64, ca_country#65]
 
 (86) Filter [codegen id : 16]
-Input [3]: [ca_state#25, ca_zip#26, ca_country#27]
-Condition : (isnotnull(ca_country#27) AND isnotnull(ca_zip#26))
+Input [3]: [ca_state#63, ca_zip#64, ca_country#65]
+Condition : (isnotnull(ca_country#65) AND isnotnull(ca_zip#64))
 
 (87) Exchange
-Input [3]: [ca_state#25, ca_zip#26, ca_country#27]
-Arguments: hashpartitioning(upper(ca_country#27), ca_zip#26, 5), ENSURE_REQUIREMENTS, [plan_id=16]
+Input [3]: [ca_state#63, ca_zip#64, ca_country#65]
+Arguments: hashpartitioning(upper(ca_country#65), ca_zip#64, 5), ENSURE_REQUIREMENTS, [plan_id=16]
 
 (88) Sort [codegen id : 17]
-Input [3]: [ca_state#25, ca_zip#26, ca_country#27]
-Arguments: [upper(ca_country#27) ASC NULLS FIRST, ca_zip#26 ASC NULLS FIRST], false, 0
+Input [3]: [ca_state#63, ca_zip#64, ca_country#65]
+Arguments: [upper(ca_country#65) ASC NULLS FIRST, ca_zip#64 ASC NULLS FIRST], false, 0
 
 (89) SortMergeJoin [codegen id : 18]
-Left keys [2]: [c_birth_country#16, s_zip#24]
-Right keys [2]: [upper(ca_country#27), ca_zip#26]
+Left keys [2]: [c_birth_country#60, s_zip#50]
+Right keys [2]: [upper(ca_country#65), ca_zip#64]
 Join type: Inner
 Join condition: None
 
 (90) Project [codegen id : 18]
-Output [11]: [ss_net_paid#5, s_store_name#21, s_state#23, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, ca_state#25]
-Input [15]: [ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16, ca_state#25, ca_zip#26, ca_country#27]
+Output [11]: [ss_net_paid#44, s_store_name#47, s_state#49, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, ca_state#63]
+Input [15]: [ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60, ca_state#63, ca_zip#64, ca_country#65]
 
 (91) HashAggregate [codegen id : 18]
-Input [11]: [ss_net_paid#5, s_store_name#21, s_state#23, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, ca_state#25]
-Keys [10]: [c_last_name#15, c_first_name#14, s_store_name#21, ca_state#25, s_state#23, i_color#10, i_current_price#8, i_manager_id#12, i_units#11, i_size#9]
-Functions [1]: [partial_sum(UnscaledValue(ss_net_paid#5))]
-Aggregate Attributes [1]: [sum#40]
-Results [11]: [c_last_name#15, c_first_name#14, s_store_name#21, ca_state#25, s_state#23, i_color#10, i_current_price#8, i_manager_id#12, i_units#11, i_size#9, sum#41]
+Input [11]: [ss_net_paid#44, s_store_name#47, s_state#49, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, ca_state#63]
+Keys [10]: [c_last_name#59, c_first_name#58, s_store_name#47, ca_state#63, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53]
+Functions [1]: [partial_sum(UnscaledValue(ss_net_paid#44))]
+Aggregate Attributes [1]: [sum#66]
+Results [11]: [c_last_name#59, c_first_name#58, s_store_name#47, ca_state#63, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, sum#67]
 
 (92) Exchange
-Input [11]: [c_last_name#15, c_first_name#14, s_store_name#21, ca_state#25, s_state#23, i_color#10, i_current_price#8, i_manager_id#12, i_units#11, i_size#9, sum#41]
-Arguments: hashpartitioning(c_last_name#15, c_first_name#14, s_store_name#21, ca_state#25, s_state#23, i_color#10, i_current_price#8, i_manager_id#12, i_units#11, i_size#9, 5), ENSURE_REQUIREMENTS, [plan_id=17]
+Input [11]: [c_last_name#59, c_first_name#58, s_store_name#47, ca_state#63, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, sum#67]
+Arguments: hashpartitioning(c_last_name#59, c_first_name#58, s_store_name#47, ca_state#63, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, 5), ENSURE_REQUIREMENTS, [plan_id=17]
 
 (93) HashAggregate [codegen id : 19]
-Input [11]: [c_last_name#15, c_first_name#14, s_store_name#21, ca_state#25, s_state#23, i_color#10, i_current_price#8, i_manager_id#12, i_units#11, i_size#9, sum#41]
-Keys [10]: [c_last_name#15, c_first_name#14, s_store_name#21, ca_state#25, s_state#23, i_color#10, i_current_price#8, i_manager_id#12, i_units#11, i_size#9]
-Functions [1]: [sum(UnscaledValue(ss_net_paid#5))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_paid#5))#30]
-Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_paid#5))#30,17,2) AS netpaid#31]
+Input [11]: [c_last_name#59, c_first_name#58, s_store_name#47, ca_state#63, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, sum#67]
+Keys [10]: [c_last_name#59, c_first_name#58, s_store_name#47, ca_state#63, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53]
+Functions [1]: [sum(UnscaledValue(ss_net_paid#44))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_paid#44))#30]
+Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_paid#44))#30,17,2) AS netpaid#68]
 
 (94) HashAggregate [codegen id : 19]
-Input [1]: [netpaid#31]
+Input [1]: [netpaid#68]
 Keys: []
-Functions [1]: [partial_avg(netpaid#31)]
-Aggregate Attributes [2]: [sum#42, count#43]
-Results [2]: [sum#44, count#45]
+Functions [1]: [partial_avg(netpaid#68)]
+Aggregate Attributes [2]: [sum#69, count#70]
+Results [2]: [sum#71, count#72]
 
 (95) Exchange
-Input [2]: [sum#44, count#45]
+Input [2]: [sum#71, count#72]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=18]
 
 (96) HashAggregate [codegen id : 20]
-Input [2]: [sum#44, count#45]
+Input [2]: [sum#71, count#72]
 Keys: []
-Functions [1]: [avg(netpaid#31)]
-Aggregate Attributes [1]: [avg(netpaid#31)#46]
-Results [1]: [(0.05 * avg(netpaid#31)#46) AS (0.05 * avg(netpaid))#47]
+Functions [1]: [avg(netpaid#68)]
+Aggregate Attributes [1]: [avg(netpaid#68)#73]
+Results [1]: [(0.05 * avg(netpaid#68)#73) AS (0.05 * avg(netpaid))#74]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24a/explain.txt
index 454a150d12e..c579d821ed2 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24a/explain.txt
@@ -298,130 +298,130 @@ Subquery:1 Hosting operator id = 46 Hosting Expression = Subquery scalar-subquer
 
 
 (47) ReusedExchange [Reuses operator id: 5]
-Output [5]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5]
+Output [5]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44]
 
 (48) Sort [codegen id : 2]
-Input [5]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5]
-Arguments: [ss_ticket_number#4 ASC NULLS FIRST, ss_item_sk#1 ASC NULLS FIRST], false, 0
+Input [5]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44]
+Arguments: [ss_ticket_number#43 ASC NULLS FIRST, ss_item_sk#40 ASC NULLS FIRST], false, 0
 
 (49) ReusedExchange [Reuses operator id: 11]
-Output [2]: [sr_item_sk#7, sr_ticket_number#8]
+Output [2]: [sr_item_sk#45, sr_ticket_number#46]
 
 (50) Sort [codegen id : 4]
-Input [2]: [sr_item_sk#7, sr_ticket_number#8]
-Arguments: [sr_ticket_number#8 ASC NULLS FIRST, sr_item_sk#7 ASC NULLS FIRST], false, 0
+Input [2]: [sr_item_sk#45, sr_ticket_number#46]
+Arguments: [sr_ticket_number#46 ASC NULLS FIRST, sr_item_sk#45 ASC NULLS FIRST], false, 0
 
 (51) SortMergeJoin [codegen id : 9]
-Left keys [2]: [ss_ticket_number#4, ss_item_sk#1]
-Right keys [2]: [sr_ticket_number#8, sr_item_sk#7]
+Left keys [2]: [ss_ticket_number#43, ss_item_sk#40]
+Right keys [2]: [sr_ticket_number#46, sr_item_sk#45]
 Join type: Inner
 Join condition: None
 
 (52) Project [codegen id : 9]
-Output [4]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_net_paid#5]
-Input [7]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, sr_item_sk#7, sr_ticket_number#8]
+Output [4]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_net_paid#44]
+Input [7]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44, sr_item_sk#45, sr_ticket_number#46]
 
 (53) ReusedExchange [Reuses operator id: 19]
-Output [4]: [s_store_sk#10, s_store_name#11, s_state#13, s_zip#14]
+Output [4]: [s_store_sk#47, s_store_name#48, s_state#49, s_zip#50]
 
 (54) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#10]
+Left keys [1]: [ss_store_sk#42]
+Right keys [1]: [s_store_sk#47]
 Join type: Inner
 Join condition: None
 
 (55) Project [codegen id : 9]
-Output [6]: [ss_item_sk#1, ss_customer_sk#2, ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14]
-Input [8]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_net_paid#5, s_store_sk#10, s_store_name#11, s_state#13, s_zip#14]
+Output [6]: [ss_item_sk#40, ss_customer_sk#41, ss_net_paid#44, s_store_name#48, s_state#49, s_zip#50]
+Input [8]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_net_paid#44, s_store_sk#47, s_store_name#48, s_state#49, s_zip#50]
 
 (56) Scan parquet spark_catalog.default.item
-Output [6]: [i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
+Output [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/item]
 PushedFilters: [IsNotNull(i_item_sk)]
 ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_size:string,i_color:string,i_units:string,i_manager_id:int>
 
 (57) ColumnarToRow [codegen id : 6]
-Input [6]: [i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 
 (58) Filter [codegen id : 6]
-Input [6]: [i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
-Condition : isnotnull(i_item_sk#15)
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Condition : isnotnull(i_item_sk#51)
 
 (59) BroadcastExchange
-Input [6]: [i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=9]
 
 (60) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#15]
+Left keys [1]: [ss_item_sk#40]
+Right keys [1]: [i_item_sk#51]
 Join type: Inner
 Join condition: None
 
 (61) Project [codegen id : 9]
-Output [10]: [ss_customer_sk#2, ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
-Input [12]: [ss_item_sk#1, ss_customer_sk#2, ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
+Output [10]: [ss_customer_sk#41, ss_net_paid#44, s_store_name#48, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Input [12]: [ss_item_sk#40, ss_customer_sk#41, ss_net_paid#44, s_store_name#48, s_state#49, s_zip#50, i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 
 (62) ReusedExchange [Reuses operator id: 31]
-Output [4]: [c_customer_sk#21, c_first_name#22, c_last_name#23, c_birth_country#24]
+Output [4]: [c_customer_sk#57, c_first_name#58, c_last_name#59, c_birth_country#60]
 
 (63) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_customer_sk#2]
-Right keys [1]: [c_customer_sk#21]
+Left keys [1]: [ss_customer_sk#41]
+Right keys [1]: [c_customer_sk#57]
 Join type: Inner
 Join condition: None
 
 (64) Project [codegen id : 9]
-Output [12]: [ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_first_name#22, c_last_name#23, c_birth_country#24]
-Input [14]: [ss_customer_sk#2, ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_customer_sk#21, c_first_name#22, c_last_name#23, c_birth_country#24]
+Output [12]: [ss_net_paid#44, s_store_name#48, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Input [14]: [ss_customer_sk#41, ss_net_paid#44, s_store_name#48, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_customer_sk#57, c_first_name#58, c_last_name#59, c_birth_country#60]
 
 (65) ReusedExchange [Reuses operator id: 37]
-Output [3]: [ca_state#25, ca_zip#26, ca_country#27]
+Output [3]: [ca_state#61, ca_zip#62, ca_country#63]
 
 (66) BroadcastHashJoin [codegen id : 9]
-Left keys [2]: [c_birth_country#24, s_zip#14]
-Right keys [2]: [upper(ca_country#27), ca_zip#26]
+Left keys [2]: [c_birth_country#60, s_zip#50]
+Right keys [2]: [upper(ca_country#63), ca_zip#62]
 Join type: Inner
 Join condition: None
 
 (67) Project [codegen id : 9]
-Output [11]: [ss_net_paid#5, s_store_name#11, s_state#13, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_first_name#22, c_last_name#23, ca_state#25]
-Input [15]: [ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_first_name#22, c_last_name#23, c_birth_country#24, ca_state#25, ca_zip#26, ca_country#27]
+Output [11]: [ss_net_paid#44, s_store_name#48, s_state#49, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, ca_state#61]
+Input [15]: [ss_net_paid#44, s_store_name#48, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60, ca_state#61, ca_zip#62, ca_country#63]
 
 (68) HashAggregate [codegen id : 9]
-Input [11]: [ss_net_paid#5, s_store_name#11, s_state#13, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_first_name#22, c_last_name#23, ca_state#25]
-Keys [10]: [c_last_name#23, c_first_name#22, s_store_name#11, ca_state#25, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17]
-Functions [1]: [partial_sum(UnscaledValue(ss_net_paid#5))]
-Aggregate Attributes [1]: [sum#40]
-Results [11]: [c_last_name#23, c_first_name#22, s_store_name#11, ca_state#25, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17, sum#41]
+Input [11]: [ss_net_paid#44, s_store_name#48, s_state#49, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, ca_state#61]
+Keys [10]: [c_last_name#59, c_first_name#58, s_store_name#48, ca_state#61, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53]
+Functions [1]: [partial_sum(UnscaledValue(ss_net_paid#44))]
+Aggregate Attributes [1]: [sum#64]
+Results [11]: [c_last_name#59, c_first_name#58, s_store_name#48, ca_state#61, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, sum#65]
 
 (69) Exchange
-Input [11]: [c_last_name#23, c_first_name#22, s_store_name#11, ca_state#25, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17, sum#41]
-Arguments: hashpartitioning(c_last_name#23, c_first_name#22, s_store_name#11, ca_state#25, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17, 5), ENSURE_REQUIREMENTS, [plan_id=10]
+Input [11]: [c_last_name#59, c_first_name#58, s_store_name#48, ca_state#61, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, sum#65]
+Arguments: hashpartitioning(c_last_name#59, c_first_name#58, s_store_name#48, ca_state#61, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, 5), ENSURE_REQUIREMENTS, [plan_id=10]
 
 (70) HashAggregate [codegen id : 10]
-Input [11]: [c_last_name#23, c_first_name#22, s_store_name#11, ca_state#25, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17, sum#41]
-Keys [10]: [c_last_name#23, c_first_name#22, s_store_name#11, ca_state#25, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17]
-Functions [1]: [sum(UnscaledValue(ss_net_paid#5))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_paid#5))#30]
-Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_paid#5))#30,17,2) AS netpaid#31]
+Input [11]: [c_last_name#59, c_first_name#58, s_store_name#48, ca_state#61, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, sum#65]
+Keys [10]: [c_last_name#59, c_first_name#58, s_store_name#48, ca_state#61, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53]
+Functions [1]: [sum(UnscaledValue(ss_net_paid#44))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_paid#44))#30]
+Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_paid#44))#30,17,2) AS netpaid#66]
 
 (71) HashAggregate [codegen id : 10]
-Input [1]: [netpaid#31]
+Input [1]: [netpaid#66]
 Keys: []
-Functions [1]: [partial_avg(netpaid#31)]
-Aggregate Attributes [2]: [sum#42, count#43]
-Results [2]: [sum#44, count#45]
+Functions [1]: [partial_avg(netpaid#66)]
+Aggregate Attributes [2]: [sum#67, count#68]
+Results [2]: [sum#69, count#70]
 
 (72) Exchange
-Input [2]: [sum#44, count#45]
+Input [2]: [sum#69, count#70]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=11]
 
 (73) HashAggregate [codegen id : 11]
-Input [2]: [sum#44, count#45]
+Input [2]: [sum#69, count#70]
 Keys: []
-Functions [1]: [avg(netpaid#31)]
-Aggregate Attributes [1]: [avg(netpaid#31)#46]
-Results [1]: [(0.05 * avg(netpaid#31)#46) AS (0.05 * avg(netpaid))#47]
+Functions [1]: [avg(netpaid#66)]
+Aggregate Attributes [1]: [avg(netpaid#66)#71]
+Results [1]: [(0.05 * avg(netpaid#66)#71) AS (0.05 * avg(netpaid))#72]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24b.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24b.sf100/explain.txt
index 3e7dba5d01a..6bc05d9d874 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24b.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24b.sf100/explain.txt
@@ -333,219 +333,219 @@ Subquery:1 Hosting operator id = 49 Hosting Expression = Subquery scalar-subquer
 
 
 (50) Scan parquet spark_catalog.default.store_sales
-Output [6]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, ss_sold_date_sk#6]
+Output [6]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44, ss_sold_date_sk#45]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store_sales]
 PushedFilters: [IsNotNull(ss_ticket_number), IsNotNull(ss_item_sk), IsNotNull(ss_store_sk), IsNotNull(ss_customer_sk)]
 ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_ticket_number:int,ss_net_paid:decimal(7,2)>
 
 (51) ColumnarToRow [codegen id : 2]
-Input [6]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, ss_sold_date_sk#6]
+Input [6]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44, ss_sold_date_sk#45]
 
 (52) Filter [codegen id : 2]
-Input [6]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, ss_sold_date_sk#6]
-Condition : (((isnotnull(ss_ticket_number#4) AND isnotnull(ss_item_sk#1)) AND isnotnull(ss_store_sk#3)) AND isnotnull(ss_customer_sk#2))
+Input [6]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44, ss_sold_date_sk#45]
+Condition : (((isnotnull(ss_ticket_number#43) AND isnotnull(ss_item_sk#40)) AND isnotnull(ss_store_sk#42)) AND isnotnull(ss_customer_sk#41))
 
 (53) Project [codegen id : 2]
-Output [5]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5]
-Input [6]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, ss_sold_date_sk#6]
+Output [5]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44]
+Input [6]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44, ss_sold_date_sk#45]
 
 (54) Scan parquet spark_catalog.default.store
-Output [5]: [s_store_sk#20, s_store_name#21, s_market_id#22, s_state#23, s_zip#24]
+Output [5]: [s_store_sk#46, s_store_name#47, s_market_id#48, s_state#49, s_zip#50]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store]
 PushedFilters: [IsNotNull(s_market_id), EqualTo(s_market_id,8), IsNotNull(s_store_sk), IsNotNull(s_zip)]
 ReadSchema: struct<s_store_sk:int,s_store_name:string,s_market_id:int,s_state:string,s_zip:string>
 
 (55) ColumnarToRow [codegen id : 1]
-Input [5]: [s_store_sk#20, s_store_name#21, s_market_id#22, s_state#23, s_zip#24]
+Input [5]: [s_store_sk#46, s_store_name#47, s_market_id#48, s_state#49, s_zip#50]
 
 (56) Filter [codegen id : 1]
-Input [5]: [s_store_sk#20, s_store_name#21, s_market_id#22, s_state#23, s_zip#24]
-Condition : (((isnotnull(s_market_id#22) AND (s_market_id#22 = 8)) AND isnotnull(s_store_sk#20)) AND isnotnull(s_zip#24))
+Input [5]: [s_store_sk#46, s_store_name#47, s_market_id#48, s_state#49, s_zip#50]
+Condition : (((isnotnull(s_market_id#48) AND (s_market_id#48 = 8)) AND isnotnull(s_store_sk#46)) AND isnotnull(s_zip#50))
 
 (57) Project [codegen id : 1]
-Output [4]: [s_store_sk#20, s_store_name#21, s_state#23, s_zip#24]
-Input [5]: [s_store_sk#20, s_store_name#21, s_market_id#22, s_state#23, s_zip#24]
+Output [4]: [s_store_sk#46, s_store_name#47, s_state#49, s_zip#50]
+Input [5]: [s_store_sk#46, s_store_name#47, s_market_id#48, s_state#49, s_zip#50]
 
 (58) BroadcastExchange
-Input [4]: [s_store_sk#20, s_store_name#21, s_state#23, s_zip#24]
+Input [4]: [s_store_sk#46, s_store_name#47, s_state#49, s_zip#50]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=10]
 
 (59) BroadcastHashJoin [codegen id : 2]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#20]
+Left keys [1]: [ss_store_sk#42]
+Right keys [1]: [s_store_sk#46]
 Join type: Inner
 Join condition: None
 
 (60) Project [codegen id : 2]
-Output [7]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24]
-Input [9]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, s_store_sk#20, s_store_name#21, s_state#23, s_zip#24]
+Output [7]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50]
+Input [9]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44, s_store_sk#46, s_store_name#47, s_state#49, s_zip#50]
 
 (61) Exchange
-Input [7]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24]
-Arguments: hashpartitioning(ss_item_sk#1, 5), ENSURE_REQUIREMENTS, [plan_id=11]
+Input [7]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50]
+Arguments: hashpartitioning(ss_item_sk#40, 5), ENSURE_REQUIREMENTS, [plan_id=11]
 
 (62) Sort [codegen id : 3]
-Input [7]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24]
-Arguments: [ss_item_sk#1 ASC NULLS FIRST], false, 0
+Input [7]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50]
+Arguments: [ss_item_sk#40 ASC NULLS FIRST], false, 0
 
 (63) Scan parquet spark_catalog.default.item
-Output [6]: [i_item_sk#7, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
+Output [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/item]
 PushedFilters: [IsNotNull(i_item_sk)]
 ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_size:string,i_color:string,i_units:string,i_manager_id:int>
 
 (64) ColumnarToRow [codegen id : 4]
-Input [6]: [i_item_sk#7, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 
 (65) Filter [codegen id : 4]
-Input [6]: [i_item_sk#7, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
-Condition : isnotnull(i_item_sk#7)
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Condition : isnotnull(i_item_sk#51)
 
 (66) Exchange
-Input [6]: [i_item_sk#7, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
-Arguments: hashpartitioning(i_item_sk#7, 5), ENSURE_REQUIREMENTS, [plan_id=12]
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Arguments: hashpartitioning(i_item_sk#51, 5), ENSURE_REQUIREMENTS, [plan_id=12]
 
 (67) Sort [codegen id : 5]
-Input [6]: [i_item_sk#7, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
-Arguments: [i_item_sk#7 ASC NULLS FIRST], false, 0
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Arguments: [i_item_sk#51 ASC NULLS FIRST], false, 0
 
 (68) SortMergeJoin [codegen id : 6]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#7]
+Left keys [1]: [ss_item_sk#40]
+Right keys [1]: [i_item_sk#51]
 Join type: Inner
 Join condition: None
 
 (69) Project [codegen id : 6]
-Output [12]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
-Input [13]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_item_sk#7, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
+Output [12]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Input [13]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 
 (70) Exchange
-Input [12]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
-Arguments: hashpartitioning(ss_customer_sk#2, 5), ENSURE_REQUIREMENTS, [plan_id=13]
+Input [12]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Arguments: hashpartitioning(ss_customer_sk#41, 5), ENSURE_REQUIREMENTS, [plan_id=13]
 
 (71) Sort [codegen id : 7]
-Input [12]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12]
-Arguments: [ss_customer_sk#2 ASC NULLS FIRST], false, 0
+Input [12]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Arguments: [ss_customer_sk#41 ASC NULLS FIRST], false, 0
 
 (72) ReusedExchange [Reuses operator id: 16]
-Output [4]: [c_customer_sk#13, c_first_name#14, c_last_name#15, c_birth_country#16]
+Output [4]: [c_customer_sk#57, c_first_name#58, c_last_name#59, c_birth_country#60]
 
 (73) Sort [codegen id : 9]
-Input [4]: [c_customer_sk#13, c_first_name#14, c_last_name#15, c_birth_country#16]
-Arguments: [c_customer_sk#13 ASC NULLS FIRST], false, 0
+Input [4]: [c_customer_sk#57, c_first_name#58, c_last_name#59, c_birth_country#60]
+Arguments: [c_customer_sk#57 ASC NULLS FIRST], false, 0
 
 (74) SortMergeJoin [codegen id : 10]
-Left keys [1]: [ss_customer_sk#2]
-Right keys [1]: [c_customer_sk#13]
+Left keys [1]: [ss_customer_sk#41]
+Right keys [1]: [c_customer_sk#57]
 Join type: Inner
 Join condition: None
 
 (75) Project [codegen id : 10]
-Output [14]: [ss_item_sk#1, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16]
-Input [16]: [ss_item_sk#1, ss_customer_sk#2, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_customer_sk#13, c_first_name#14, c_last_name#15, c_birth_country#16]
+Output [14]: [ss_item_sk#40, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Input [16]: [ss_item_sk#40, ss_customer_sk#41, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_customer_sk#57, c_first_name#58, c_last_name#59, c_birth_country#60]
 
 (76) Exchange
-Input [14]: [ss_item_sk#1, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16]
-Arguments: hashpartitioning(ss_ticket_number#4, ss_item_sk#1, 5), ENSURE_REQUIREMENTS, [plan_id=14]
+Input [14]: [ss_item_sk#40, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Arguments: hashpartitioning(ss_ticket_number#43, ss_item_sk#40, 5), ENSURE_REQUIREMENTS, [plan_id=14]
 
 (77) Sort [codegen id : 11]
-Input [14]: [ss_item_sk#1, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16]
-Arguments: [ss_ticket_number#4 ASC NULLS FIRST, ss_item_sk#1 ASC NULLS FIRST], false, 0
+Input [14]: [ss_item_sk#40, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Arguments: [ss_ticket_number#43 ASC NULLS FIRST, ss_item_sk#40 ASC NULLS FIRST], false, 0
 
 (78) ReusedExchange [Reuses operator id: 26]
-Output [2]: [sr_item_sk#17, sr_ticket_number#18]
+Output [2]: [sr_item_sk#61, sr_ticket_number#62]
 
 (79) Sort [codegen id : 13]
-Input [2]: [sr_item_sk#17, sr_ticket_number#18]
-Arguments: [sr_ticket_number#18 ASC NULLS FIRST, sr_item_sk#17 ASC NULLS FIRST], false, 0
+Input [2]: [sr_item_sk#61, sr_ticket_number#62]
+Arguments: [sr_ticket_number#62 ASC NULLS FIRST, sr_item_sk#61 ASC NULLS FIRST], false, 0
 
 (80) SortMergeJoin [codegen id : 14]
-Left keys [2]: [ss_ticket_number#4, ss_item_sk#1]
-Right keys [2]: [sr_ticket_number#18, sr_item_sk#17]
+Left keys [2]: [ss_ticket_number#43, ss_item_sk#40]
+Right keys [2]: [sr_ticket_number#62, sr_item_sk#61]
 Join type: Inner
 Join condition: None
 
 (81) Project [codegen id : 14]
-Output [12]: [ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16]
-Input [16]: [ss_item_sk#1, ss_ticket_number#4, ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16, sr_item_sk#17, sr_ticket_number#18]
+Output [12]: [ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Input [16]: [ss_item_sk#40, ss_ticket_number#43, ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60, sr_item_sk#61, sr_ticket_number#62]
 
 (82) Exchange
-Input [12]: [ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16]
-Arguments: hashpartitioning(c_birth_country#16, s_zip#24, 5), ENSURE_REQUIREMENTS, [plan_id=15]
+Input [12]: [ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Arguments: hashpartitioning(c_birth_country#60, s_zip#50, 5), ENSURE_REQUIREMENTS, [plan_id=15]
 
 (83) Sort [codegen id : 15]
-Input [12]: [ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16]
-Arguments: [c_birth_country#16 ASC NULLS FIRST, s_zip#24 ASC NULLS FIRST], false, 0
+Input [12]: [ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Arguments: [c_birth_country#60 ASC NULLS FIRST, s_zip#50 ASC NULLS FIRST], false, 0
 
 (84) Scan parquet spark_catalog.default.customer_address
-Output [3]: [ca_state#25, ca_zip#26, ca_country#27]
+Output [3]: [ca_state#63, ca_zip#64, ca_country#65]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [IsNotNull(ca_country), IsNotNull(ca_zip)]
 ReadSchema: struct<ca_state:string,ca_zip:string,ca_country:string>
 
 (85) ColumnarToRow [codegen id : 16]
-Input [3]: [ca_state#25, ca_zip#26, ca_country#27]
+Input [3]: [ca_state#63, ca_zip#64, ca_country#65]
 
 (86) Filter [codegen id : 16]
-Input [3]: [ca_state#25, ca_zip#26, ca_country#27]
-Condition : (isnotnull(ca_country#27) AND isnotnull(ca_zip#26))
+Input [3]: [ca_state#63, ca_zip#64, ca_country#65]
+Condition : (isnotnull(ca_country#65) AND isnotnull(ca_zip#64))
 
 (87) Exchange
-Input [3]: [ca_state#25, ca_zip#26, ca_country#27]
-Arguments: hashpartitioning(upper(ca_country#27), ca_zip#26, 5), ENSURE_REQUIREMENTS, [plan_id=16]
+Input [3]: [ca_state#63, ca_zip#64, ca_country#65]
+Arguments: hashpartitioning(upper(ca_country#65), ca_zip#64, 5), ENSURE_REQUIREMENTS, [plan_id=16]
 
 (88) Sort [codegen id : 17]
-Input [3]: [ca_state#25, ca_zip#26, ca_country#27]
-Arguments: [upper(ca_country#27) ASC NULLS FIRST, ca_zip#26 ASC NULLS FIRST], false, 0
+Input [3]: [ca_state#63, ca_zip#64, ca_country#65]
+Arguments: [upper(ca_country#65) ASC NULLS FIRST, ca_zip#64 ASC NULLS FIRST], false, 0
 
 (89) SortMergeJoin [codegen id : 18]
-Left keys [2]: [c_birth_country#16, s_zip#24]
-Right keys [2]: [upper(ca_country#27), ca_zip#26]
+Left keys [2]: [c_birth_country#60, s_zip#50]
+Right keys [2]: [upper(ca_country#65), ca_zip#64]
 Join type: Inner
 Join condition: None
 
 (90) Project [codegen id : 18]
-Output [11]: [ss_net_paid#5, s_store_name#21, s_state#23, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, ca_state#25]
-Input [15]: [ss_net_paid#5, s_store_name#21, s_state#23, s_zip#24, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, c_birth_country#16, ca_state#25, ca_zip#26, ca_country#27]
+Output [11]: [ss_net_paid#44, s_store_name#47, s_state#49, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, ca_state#63]
+Input [15]: [ss_net_paid#44, s_store_name#47, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60, ca_state#63, ca_zip#64, ca_country#65]
 
 (91) HashAggregate [codegen id : 18]
-Input [11]: [ss_net_paid#5, s_store_name#21, s_state#23, i_current_price#8, i_size#9, i_color#10, i_units#11, i_manager_id#12, c_first_name#14, c_last_name#15, ca_state#25]
-Keys [10]: [c_last_name#15, c_first_name#14, s_store_name#21, ca_state#25, s_state#23, i_color#10, i_current_price#8, i_manager_id#12, i_units#11, i_size#9]
-Functions [1]: [partial_sum(UnscaledValue(ss_net_paid#5))]
-Aggregate Attributes [1]: [sum#40]
-Results [11]: [c_last_name#15, c_first_name#14, s_store_name#21, ca_state#25, s_state#23, i_color#10, i_current_price#8, i_manager_id#12, i_units#11, i_size#9, sum#41]
+Input [11]: [ss_net_paid#44, s_store_name#47, s_state#49, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, ca_state#63]
+Keys [10]: [c_last_name#59, c_first_name#58, s_store_name#47, ca_state#63, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53]
+Functions [1]: [partial_sum(UnscaledValue(ss_net_paid#44))]
+Aggregate Attributes [1]: [sum#66]
+Results [11]: [c_last_name#59, c_first_name#58, s_store_name#47, ca_state#63, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, sum#67]
 
 (92) Exchange
-Input [11]: [c_last_name#15, c_first_name#14, s_store_name#21, ca_state#25, s_state#23, i_color#10, i_current_price#8, i_manager_id#12, i_units#11, i_size#9, sum#41]
-Arguments: hashpartitioning(c_last_name#15, c_first_name#14, s_store_name#21, ca_state#25, s_state#23, i_color#10, i_current_price#8, i_manager_id#12, i_units#11, i_size#9, 5), ENSURE_REQUIREMENTS, [plan_id=17]
+Input [11]: [c_last_name#59, c_first_name#58, s_store_name#47, ca_state#63, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, sum#67]
+Arguments: hashpartitioning(c_last_name#59, c_first_name#58, s_store_name#47, ca_state#63, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, 5), ENSURE_REQUIREMENTS, [plan_id=17]
 
 (93) HashAggregate [codegen id : 19]
-Input [11]: [c_last_name#15, c_first_name#14, s_store_name#21, ca_state#25, s_state#23, i_color#10, i_current_price#8, i_manager_id#12, i_units#11, i_size#9, sum#41]
-Keys [10]: [c_last_name#15, c_first_name#14, s_store_name#21, ca_state#25, s_state#23, i_color#10, i_current_price#8, i_manager_id#12, i_units#11, i_size#9]
-Functions [1]: [sum(UnscaledValue(ss_net_paid#5))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_paid#5))#30]
-Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_paid#5))#30,17,2) AS netpaid#31]
+Input [11]: [c_last_name#59, c_first_name#58, s_store_name#47, ca_state#63, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, sum#67]
+Keys [10]: [c_last_name#59, c_first_name#58, s_store_name#47, ca_state#63, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53]
+Functions [1]: [sum(UnscaledValue(ss_net_paid#44))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_paid#44))#30]
+Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_paid#44))#30,17,2) AS netpaid#68]
 
 (94) HashAggregate [codegen id : 19]
-Input [1]: [netpaid#31]
+Input [1]: [netpaid#68]
 Keys: []
-Functions [1]: [partial_avg(netpaid#31)]
-Aggregate Attributes [2]: [sum#42, count#43]
-Results [2]: [sum#44, count#45]
+Functions [1]: [partial_avg(netpaid#68)]
+Aggregate Attributes [2]: [sum#69, count#70]
+Results [2]: [sum#71, count#72]
 
 (95) Exchange
-Input [2]: [sum#44, count#45]
+Input [2]: [sum#71, count#72]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=18]
 
 (96) HashAggregate [codegen id : 20]
-Input [2]: [sum#44, count#45]
+Input [2]: [sum#71, count#72]
 Keys: []
-Functions [1]: [avg(netpaid#31)]
-Aggregate Attributes [1]: [avg(netpaid#31)#46]
-Results [1]: [(0.05 * avg(netpaid#31)#46) AS (0.05 * avg(netpaid))#47]
+Functions [1]: [avg(netpaid#68)]
+Aggregate Attributes [1]: [avg(netpaid#68)#73]
+Results [1]: [(0.05 * avg(netpaid#68)#73) AS (0.05 * avg(netpaid))#74]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24b/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24b/explain.txt
index 36e95dab7ba..26c1f610480 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24b/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q24b/explain.txt
@@ -298,130 +298,130 @@ Subquery:1 Hosting operator id = 46 Hosting Expression = Subquery scalar-subquer
 
 
 (47) ReusedExchange [Reuses operator id: 5]
-Output [5]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5]
+Output [5]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44]
 
 (48) Sort [codegen id : 2]
-Input [5]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5]
-Arguments: [ss_ticket_number#4 ASC NULLS FIRST, ss_item_sk#1 ASC NULLS FIRST], false, 0
+Input [5]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44]
+Arguments: [ss_ticket_number#43 ASC NULLS FIRST, ss_item_sk#40 ASC NULLS FIRST], false, 0
 
 (49) ReusedExchange [Reuses operator id: 11]
-Output [2]: [sr_item_sk#7, sr_ticket_number#8]
+Output [2]: [sr_item_sk#45, sr_ticket_number#46]
 
 (50) Sort [codegen id : 4]
-Input [2]: [sr_item_sk#7, sr_ticket_number#8]
-Arguments: [sr_ticket_number#8 ASC NULLS FIRST, sr_item_sk#7 ASC NULLS FIRST], false, 0
+Input [2]: [sr_item_sk#45, sr_ticket_number#46]
+Arguments: [sr_ticket_number#46 ASC NULLS FIRST, sr_item_sk#45 ASC NULLS FIRST], false, 0
 
 (51) SortMergeJoin [codegen id : 9]
-Left keys [2]: [ss_ticket_number#4, ss_item_sk#1]
-Right keys [2]: [sr_ticket_number#8, sr_item_sk#7]
+Left keys [2]: [ss_ticket_number#43, ss_item_sk#40]
+Right keys [2]: [sr_ticket_number#46, sr_item_sk#45]
 Join type: Inner
 Join condition: None
 
 (52) Project [codegen id : 9]
-Output [4]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_net_paid#5]
-Input [7]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, sr_item_sk#7, sr_ticket_number#8]
+Output [4]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_net_paid#44]
+Input [7]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_ticket_number#43, ss_net_paid#44, sr_item_sk#45, sr_ticket_number#46]
 
 (53) ReusedExchange [Reuses operator id: 19]
-Output [4]: [s_store_sk#10, s_store_name#11, s_state#13, s_zip#14]
+Output [4]: [s_store_sk#47, s_store_name#48, s_state#49, s_zip#50]
 
 (54) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#10]
+Left keys [1]: [ss_store_sk#42]
+Right keys [1]: [s_store_sk#47]
 Join type: Inner
 Join condition: None
 
 (55) Project [codegen id : 9]
-Output [6]: [ss_item_sk#1, ss_customer_sk#2, ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14]
-Input [8]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_net_paid#5, s_store_sk#10, s_store_name#11, s_state#13, s_zip#14]
+Output [6]: [ss_item_sk#40, ss_customer_sk#41, ss_net_paid#44, s_store_name#48, s_state#49, s_zip#50]
+Input [8]: [ss_item_sk#40, ss_customer_sk#41, ss_store_sk#42, ss_net_paid#44, s_store_sk#47, s_store_name#48, s_state#49, s_zip#50]
 
 (56) Scan parquet spark_catalog.default.item
-Output [6]: [i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
+Output [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/item]
 PushedFilters: [IsNotNull(i_item_sk)]
 ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_size:string,i_color:string,i_units:string,i_manager_id:int>
 
 (57) ColumnarToRow [codegen id : 6]
-Input [6]: [i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 
 (58) Filter [codegen id : 6]
-Input [6]: [i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
-Condition : isnotnull(i_item_sk#15)
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Condition : isnotnull(i_item_sk#51)
 
 (59) BroadcastExchange
-Input [6]: [i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
+Input [6]: [i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=9]
 
 (60) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#15]
+Left keys [1]: [ss_item_sk#40]
+Right keys [1]: [i_item_sk#51]
 Join type: Inner
 Join condition: None
 
 (61) Project [codegen id : 9]
-Output [10]: [ss_customer_sk#2, ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
-Input [12]: [ss_item_sk#1, ss_customer_sk#2, ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
+Output [10]: [ss_customer_sk#41, ss_net_paid#44, s_store_name#48, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
+Input [12]: [ss_item_sk#40, ss_customer_sk#41, ss_net_paid#44, s_store_name#48, s_state#49, s_zip#50, i_item_sk#51, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56]
 
 (62) ReusedExchange [Reuses operator id: 31]
-Output [4]: [c_customer_sk#21, c_first_name#22, c_last_name#23, c_birth_country#24]
+Output [4]: [c_customer_sk#57, c_first_name#58, c_last_name#59, c_birth_country#60]
 
 (63) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_customer_sk#2]
-Right keys [1]: [c_customer_sk#21]
+Left keys [1]: [ss_customer_sk#41]
+Right keys [1]: [c_customer_sk#57]
 Join type: Inner
 Join condition: None
 
 (64) Project [codegen id : 9]
-Output [12]: [ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_first_name#22, c_last_name#23, c_birth_country#24]
-Input [14]: [ss_customer_sk#2, ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_customer_sk#21, c_first_name#22, c_last_name#23, c_birth_country#24]
+Output [12]: [ss_net_paid#44, s_store_name#48, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60]
+Input [14]: [ss_customer_sk#41, ss_net_paid#44, s_store_name#48, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_customer_sk#57, c_first_name#58, c_last_name#59, c_birth_country#60]
 
 (65) ReusedExchange [Reuses operator id: 37]
-Output [3]: [ca_state#25, ca_zip#26, ca_country#27]
+Output [3]: [ca_state#61, ca_zip#62, ca_country#63]
 
 (66) BroadcastHashJoin [codegen id : 9]
-Left keys [2]: [c_birth_country#24, s_zip#14]
-Right keys [2]: [upper(ca_country#27), ca_zip#26]
+Left keys [2]: [c_birth_country#60, s_zip#50]
+Right keys [2]: [upper(ca_country#63), ca_zip#62]
 Join type: Inner
 Join condition: None
 
 (67) Project [codegen id : 9]
-Output [11]: [ss_net_paid#5, s_store_name#11, s_state#13, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_first_name#22, c_last_name#23, ca_state#25]
-Input [15]: [ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_first_name#22, c_last_name#23, c_birth_country#24, ca_state#25, ca_zip#26, ca_country#27]
+Output [11]: [ss_net_paid#44, s_store_name#48, s_state#49, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, ca_state#61]
+Input [15]: [ss_net_paid#44, s_store_name#48, s_state#49, s_zip#50, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, c_birth_country#60, ca_state#61, ca_zip#62, ca_country#63]
 
 (68) HashAggregate [codegen id : 9]
-Input [11]: [ss_net_paid#5, s_store_name#11, s_state#13, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_first_name#22, c_last_name#23, ca_state#25]
-Keys [10]: [c_last_name#23, c_first_name#22, s_store_name#11, ca_state#25, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17]
-Functions [1]: [partial_sum(UnscaledValue(ss_net_paid#5))]
-Aggregate Attributes [1]: [sum#40]
-Results [11]: [c_last_name#23, c_first_name#22, s_store_name#11, ca_state#25, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17, sum#41]
+Input [11]: [ss_net_paid#44, s_store_name#48, s_state#49, i_current_price#52, i_size#53, i_color#54, i_units#55, i_manager_id#56, c_first_name#58, c_last_name#59, ca_state#61]
+Keys [10]: [c_last_name#59, c_first_name#58, s_store_name#48, ca_state#61, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53]
+Functions [1]: [partial_sum(UnscaledValue(ss_net_paid#44))]
+Aggregate Attributes [1]: [sum#64]
+Results [11]: [c_last_name#59, c_first_name#58, s_store_name#48, ca_state#61, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, sum#65]
 
 (69) Exchange
-Input [11]: [c_last_name#23, c_first_name#22, s_store_name#11, ca_state#25, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17, sum#41]
-Arguments: hashpartitioning(c_last_name#23, c_first_name#22, s_store_name#11, ca_state#25, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17, 5), ENSURE_REQUIREMENTS, [plan_id=10]
+Input [11]: [c_last_name#59, c_first_name#58, s_store_name#48, ca_state#61, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, sum#65]
+Arguments: hashpartitioning(c_last_name#59, c_first_name#58, s_store_name#48, ca_state#61, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, 5), ENSURE_REQUIREMENTS, [plan_id=10]
 
 (70) HashAggregate [codegen id : 10]
-Input [11]: [c_last_name#23, c_first_name#22, s_store_name#11, ca_state#25, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17, sum#41]
-Keys [10]: [c_last_name#23, c_first_name#22, s_store_name#11, ca_state#25, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17]
-Functions [1]: [sum(UnscaledValue(ss_net_paid#5))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_paid#5))#30]
-Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_paid#5))#30,17,2) AS netpaid#31]
+Input [11]: [c_last_name#59, c_first_name#58, s_store_name#48, ca_state#61, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53, sum#65]
+Keys [10]: [c_last_name#59, c_first_name#58, s_store_name#48, ca_state#61, s_state#49, i_color#54, i_current_price#52, i_manager_id#56, i_units#55, i_size#53]
+Functions [1]: [sum(UnscaledValue(ss_net_paid#44))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_paid#44))#30]
+Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_paid#44))#30,17,2) AS netpaid#66]
 
 (71) HashAggregate [codegen id : 10]
-Input [1]: [netpaid#31]
+Input [1]: [netpaid#66]
 Keys: []
-Functions [1]: [partial_avg(netpaid#31)]
-Aggregate Attributes [2]: [sum#42, count#43]
-Results [2]: [sum#44, count#45]
+Functions [1]: [partial_avg(netpaid#66)]
+Aggregate Attributes [2]: [sum#67, count#68]
+Results [2]: [sum#69, count#70]
 
 (72) Exchange
-Input [2]: [sum#44, count#45]
+Input [2]: [sum#69, count#70]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=11]
 
 (73) HashAggregate [codegen id : 11]
-Input [2]: [sum#44, count#45]
+Input [2]: [sum#69, count#70]
 Keys: []
-Functions [1]: [avg(netpaid#31)]
-Aggregate Attributes [1]: [avg(netpaid#31)#46]
-Results [1]: [(0.05 * avg(netpaid#31)#46) AS (0.05 * avg(netpaid))#47]
+Functions [1]: [avg(netpaid#66)]
+Aggregate Attributes [1]: [avg(netpaid#66)#71]
+Results [1]: [(0.05 * avg(netpaid#66)#71) AS (0.05 * avg(netpaid))#72]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30.sf100/explain.txt
index a3e82c54413..126df3e7557 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30.sf100/explain.txt
@@ -207,111 +207,111 @@ Output [14]: [c_customer_id#2, c_salutation#4, c_first_name#5, c_last_name#6, c_
 Input [16]: [c_customer_sk#1, c_customer_id#2, c_salutation#4, c_first_name#5, c_last_name#6, c_preferred_cust_flag#7, c_birth_day#8, c_birth_month#9, c_birth_year#10, c_birth_country#11, c_login#12, c_email_address#13, c_last_review_date#14, ctr_customer_sk#28, ctr_state#29, ctr_total_return#30]
 
 (33) Scan parquet spark_catalog.default.web_returns
-Output [4]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19, wr_returned_date_sk#20]
+Output [4]: [wr_returning_customer_sk#31, wr_returning_addr_sk#32, wr_return_amt#33, wr_returned_date_sk#34]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(wr_returned_date_sk#20), dynamicpruningexpression(wr_returned_date_sk#20 IN dynamicpruning#21)]
+PartitionFilters: [isnotnull(wr_returned_date_sk#34), dynamicpruningexpression(wr_returned_date_sk#34 IN dynamicpruning#21)]
 PushedFilters: [IsNotNull(wr_returning_addr_sk)]
 ReadSchema: struct<wr_returning_customer_sk:int,wr_returning_addr_sk:int,wr_return_amt:decimal(7,2)>
 
 (34) ColumnarToRow [codegen id : 10]
-Input [4]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19, wr_returned_date_sk#20]
+Input [4]: [wr_returning_customer_sk#31, wr_returning_addr_sk#32, wr_return_amt#33, wr_returned_date_sk#34]
 
 (35) Filter [codegen id : 10]
-Input [4]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19, wr_returned_date_sk#20]
-Condition : isnotnull(wr_returning_addr_sk#18)
+Input [4]: [wr_returning_customer_sk#31, wr_returning_addr_sk#32, wr_return_amt#33, wr_returned_date_sk#34]
+Condition : isnotnull(wr_returning_addr_sk#32)
 
 (36) ReusedExchange [Reuses operator id: 60]
-Output [1]: [d_date_sk#22]
+Output [1]: [d_date_sk#35]
 
 (37) BroadcastHashJoin [codegen id : 10]
-Left keys [1]: [wr_returned_date_sk#20]
-Right keys [1]: [d_date_sk#22]
+Left keys [1]: [wr_returned_date_sk#34]
+Right keys [1]: [d_date_sk#35]
 Join type: Inner
 Join condition: None
 
 (38) Project [codegen id : 10]
-Output [3]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
-Input [5]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19, wr_returned_date_sk#20, d_date_sk#22]
+Output [3]: [wr_returning_customer_sk#31, wr_returning_addr_sk#32, wr_return_amt#33]
+Input [5]: [wr_returning_customer_sk#31, wr_returning_addr_sk#32, wr_return_amt#33, wr_returned_date_sk#34, d_date_sk#35]
 
 (39) Exchange
-Input [3]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
-Arguments: hashpartitioning(wr_returning_addr_sk#18, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [3]: [wr_returning_customer_sk#31, wr_returning_addr_sk#32, wr_return_amt#33]
+Arguments: hashpartitioning(wr_returning_addr_sk#32, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (40) Sort [codegen id : 11]
-Input [3]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
-Arguments: [wr_returning_addr_sk#18 ASC NULLS FIRST], false, 0
+Input [3]: [wr_returning_customer_sk#31, wr_returning_addr_sk#32, wr_return_amt#33]
+Arguments: [wr_returning_addr_sk#32 ASC NULLS FIRST], false, 0
 
 (41) ReusedExchange [Reuses operator id: 23]
-Output [2]: [ca_address_sk#23, ca_state#24]
+Output [2]: [ca_address_sk#36, ca_state#37]
 
 (42) Sort [codegen id : 13]
-Input [2]: [ca_address_sk#23, ca_state#24]
-Arguments: [ca_address_sk#23 ASC NULLS FIRST], false, 0
+Input [2]: [ca_address_sk#36, ca_state#37]
+Arguments: [ca_address_sk#36 ASC NULLS FIRST], false, 0
 
 (43) SortMergeJoin [codegen id : 14]
-Left keys [1]: [wr_returning_addr_sk#18]
-Right keys [1]: [ca_address_sk#23]
+Left keys [1]: [wr_returning_addr_sk#32]
+Right keys [1]: [ca_address_sk#36]
 Join type: Inner
 Join condition: None
 
 (44) Project [codegen id : 14]
-Output [3]: [wr_returning_customer_sk#17, wr_return_amt#19, ca_state#24]
-Input [5]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19, ca_address_sk#23, ca_state#24]
+Output [3]: [wr_returning_customer_sk#31, wr_return_amt#33, ca_state#37]
+Input [5]: [wr_returning_customer_sk#31, wr_returning_addr_sk#32, wr_return_amt#33, ca_address_sk#36, ca_state#37]
 
 (45) HashAggregate [codegen id : 14]
-Input [3]: [wr_returning_customer_sk#17, wr_return_amt#19, ca_state#24]
-Keys [2]: [wr_returning_customer_sk#17, ca_state#24]
-Functions [1]: [partial_sum(UnscaledValue(wr_return_amt#19))]
-Aggregate Attributes [1]: [sum#31]
-Results [3]: [wr_returning_customer_sk#17, ca_state#24, sum#32]
+Input [3]: [wr_returning_customer_sk#31, wr_return_amt#33, ca_state#37]
+Keys [2]: [wr_returning_customer_sk#31, ca_state#37]
+Functions [1]: [partial_sum(UnscaledValue(wr_return_amt#33))]
+Aggregate Attributes [1]: [sum#38]
+Results [3]: [wr_returning_customer_sk#31, ca_state#37, sum#39]
 
 (46) Exchange
-Input [3]: [wr_returning_customer_sk#17, ca_state#24, sum#32]
-Arguments: hashpartitioning(wr_returning_customer_sk#17, ca_state#24, 5), ENSURE_REQUIREMENTS, [plan_id=7]
+Input [3]: [wr_returning_customer_sk#31, ca_state#37, sum#39]
+Arguments: hashpartitioning(wr_returning_customer_sk#31, ca_state#37, 5), ENSURE_REQUIREMENTS, [plan_id=7]
 
 (47) HashAggregate [codegen id : 15]
-Input [3]: [wr_returning_customer_sk#17, ca_state#24, sum#32]
-Keys [2]: [wr_returning_customer_sk#17, ca_state#24]
-Functions [1]: [sum(UnscaledValue(wr_return_amt#19))]
-Aggregate Attributes [1]: [sum(UnscaledValue(wr_return_amt#19))#27]
-Results [2]: [ca_state#24 AS ctr_state#29, MakeDecimal(sum(UnscaledValue(wr_return_amt#19))#27,17,2) AS ctr_total_return#30]
+Input [3]: [wr_returning_customer_sk#31, ca_state#37, sum#39]
+Keys [2]: [wr_returning_customer_sk#31, ca_state#37]
+Functions [1]: [sum(UnscaledValue(wr_return_amt#33))]
+Aggregate Attributes [1]: [sum(UnscaledValue(wr_return_amt#33))#27]
+Results [2]: [ca_state#37 AS ctr_state#40, MakeDecimal(sum(UnscaledValue(wr_return_amt#33))#27,17,2) AS ctr_total_return#41]
 
 (48) HashAggregate [codegen id : 15]
-Input [2]: [ctr_state#29, ctr_total_return#30]
-Keys [1]: [ctr_state#29]
-Functions [1]: [partial_avg(ctr_total_return#30)]
-Aggregate Attributes [2]: [sum#33, count#34]
-Results [3]: [ctr_state#29, sum#35, count#36]
+Input [2]: [ctr_state#40, ctr_total_return#41]
+Keys [1]: [ctr_state#40]
+Functions [1]: [partial_avg(ctr_total_return#41)]
+Aggregate Attributes [2]: [sum#42, count#43]
+Results [3]: [ctr_state#40, sum#44, count#45]
 
 (49) Exchange
-Input [3]: [ctr_state#29, sum#35, count#36]
-Arguments: hashpartitioning(ctr_state#29, 5), ENSURE_REQUIREMENTS, [plan_id=8]
+Input [3]: [ctr_state#40, sum#44, count#45]
+Arguments: hashpartitioning(ctr_state#40, 5), ENSURE_REQUIREMENTS, [plan_id=8]
 
 (50) HashAggregate [codegen id : 16]
-Input [3]: [ctr_state#29, sum#35, count#36]
-Keys [1]: [ctr_state#29]
-Functions [1]: [avg(ctr_total_return#30)]
-Aggregate Attributes [1]: [avg(ctr_total_return#30)#37]
-Results [2]: [(avg(ctr_total_return#30)#37 * 1.2) AS (avg(ctr_total_return) * 1.2)#38, ctr_state#29 AS ctr_state#29#39]
+Input [3]: [ctr_state#40, sum#44, count#45]
+Keys [1]: [ctr_state#40]
+Functions [1]: [avg(ctr_total_return#41)]
+Aggregate Attributes [1]: [avg(ctr_total_return#41)#46]
+Results [2]: [(avg(ctr_total_return#41)#46 * 1.2) AS (avg(ctr_total_return) * 1.2)#47, ctr_state#40]
 
 (51) Filter [codegen id : 16]
-Input [2]: [(avg(ctr_total_return) * 1.2)#38, ctr_state#29#39]
-Condition : isnotnull((avg(ctr_total_return) * 1.2)#38)
+Input [2]: [(avg(ctr_total_return) * 1.2)#47, ctr_state#40]
+Condition : isnotnull((avg(ctr_total_return) * 1.2)#47)
 
 (52) BroadcastExchange
-Input [2]: [(avg(ctr_total_return) * 1.2)#38, ctr_state#29#39]
+Input [2]: [(avg(ctr_total_return) * 1.2)#47, ctr_state#40]
 Arguments: HashedRelationBroadcastMode(List(input[1, string, true]),false), [plan_id=9]
 
 (53) BroadcastHashJoin [codegen id : 17]
 Left keys [1]: [ctr_state#29]
-Right keys [1]: [ctr_state#29#39]
+Right keys [1]: [ctr_state#40]
 Join type: Inner
-Join condition: (cast(ctr_total_return#30 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#38)
+Join condition: (cast(ctr_total_return#30 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#47)
 
 (54) Project [codegen id : 17]
 Output [13]: [c_customer_id#2, c_salutation#4, c_first_name#5, c_last_name#6, c_preferred_cust_flag#7, c_birth_day#8, c_birth_month#9, c_birth_year#10, c_birth_country#11, c_login#12, c_email_address#13, c_last_review_date#14, ctr_total_return#30]
-Input [16]: [c_customer_id#2, c_salutation#4, c_first_name#5, c_last_name#6, c_preferred_cust_flag#7, c_birth_day#8, c_birth_month#9, c_birth_year#10, c_birth_country#11, c_login#12, c_email_address#13, c_last_review_date#14, ctr_state#29, ctr_total_return#30, (avg(ctr_total_return) * 1.2)#38, ctr_state#29#39]
+Input [16]: [c_customer_id#2, c_salutation#4, c_first_name#5, c_last_name#6, c_preferred_cust_flag#7, c_birth_day#8, c_birth_month#9, c_birth_year#10, c_birth_country#11, c_login#12, c_email_address#13, c_last_review_date#14, ctr_state#29, ctr_total_return#30, (avg(ctr_total_return) * 1.2)#47, ctr_state#40]
 
 (55) TakeOrderedAndProject
 Input [13]: [c_customer_id#2, c_salutation#4, c_first_name#5, c_last_name#6, c_preferred_cust_flag#7, c_birth_day#8, c_birth_month#9, c_birth_year#10, c_birth_country#11, c_login#12, c_email_address#13, c_last_review_date#14, ctr_total_return#30]
@@ -328,27 +328,27 @@ BroadcastExchange (60)
 
 
 (56) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#22, d_year#40]
+Output [2]: [d_date_sk#22, d_year#48]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (57) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#22, d_year#40]
+Input [2]: [d_date_sk#22, d_year#48]
 
 (58) Filter [codegen id : 1]
-Input [2]: [d_date_sk#22, d_year#40]
-Condition : ((isnotnull(d_year#40) AND (d_year#40 = 2002)) AND isnotnull(d_date_sk#22))
+Input [2]: [d_date_sk#22, d_year#48]
+Condition : ((isnotnull(d_year#48) AND (d_year#48 = 2002)) AND isnotnull(d_date_sk#22))
 
 (59) Project [codegen id : 1]
 Output [1]: [d_date_sk#22]
-Input [2]: [d_date_sk#22, d_year#40]
+Input [2]: [d_date_sk#22, d_year#48]
 
 (60) BroadcastExchange
 Input [1]: [d_date_sk#22]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=10]
 
-Subquery:2 Hosting operator id = 33 Hosting Expression = wr_returned_date_sk#20 IN dynamicpruning#21
+Subquery:2 Hosting operator id = 33 Hosting Expression = wr_returned_date_sk#34 IN dynamicpruning#21
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30.sf100/simplified.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30.sf100/simplified.txt
index f12d878e137..a5ffc61dc3d 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30.sf100/simplified.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30.sf100/simplified.txt
@@ -65,7 +65,7 @@ TakeOrderedAndProject [c_customer_id,c_salutation,c_first_name,c_last_name,c_pre
           BroadcastExchange #7
             WholeStageCodegen (16)
               Filter [(avg(ctr_total_return) * 1.2)]
-                HashAggregate [ctr_state,sum,count] [avg(ctr_total_return),(avg(ctr_total_return) * 1.2),ctr_state,sum,count]
+                HashAggregate [ctr_state,sum,count] [avg(ctr_total_return),(avg(ctr_total_return) * 1.2),sum,count]
                   InputAdapter
                     Exchange [ctr_state] #8
                       WholeStageCodegen (15)
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30/explain.txt
index 1b621252f66..a280cfd9156 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30/explain.txt
@@ -129,163 +129,163 @@ Input [3]: [ctr_customer_sk#12, ctr_state#13, ctr_total_return#14]
 Condition : isnotnull(ctr_total_return#14)
 
 (17) Scan parquet spark_catalog.default.web_returns
-Output [4]: [wr_returning_customer_sk#1, wr_returning_addr_sk#2, wr_return_amt#3, wr_returned_date_sk#4]
+Output [4]: [wr_returning_customer_sk#15, wr_returning_addr_sk#16, wr_return_amt#17, wr_returned_date_sk#18]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(wr_returned_date_sk#4), dynamicpruningexpression(wr_returned_date_sk#4 IN dynamicpruning#5)]
+PartitionFilters: [isnotnull(wr_returned_date_sk#18), dynamicpruningexpression(wr_returned_date_sk#18 IN dynamicpruning#5)]
 PushedFilters: [IsNotNull(wr_returning_addr_sk)]
 ReadSchema: struct<wr_returning_customer_sk:int,wr_returning_addr_sk:int,wr_return_amt:decimal(7,2)>
 
 (18) ColumnarToRow [codegen id : 6]
-Input [4]: [wr_returning_customer_sk#1, wr_returning_addr_sk#2, wr_return_amt#3, wr_returned_date_sk#4]
+Input [4]: [wr_returning_customer_sk#15, wr_returning_addr_sk#16, wr_return_amt#17, wr_returned_date_sk#18]
 
 (19) Filter [codegen id : 6]
-Input [4]: [wr_returning_customer_sk#1, wr_returning_addr_sk#2, wr_return_amt#3, wr_returned_date_sk#4]
-Condition : isnotnull(wr_returning_addr_sk#2)
+Input [4]: [wr_returning_customer_sk#15, wr_returning_addr_sk#16, wr_return_amt#17, wr_returned_date_sk#18]
+Condition : isnotnull(wr_returning_addr_sk#16)
 
 (20) ReusedExchange [Reuses operator id: 54]
-Output [1]: [d_date_sk#6]
+Output [1]: [d_date_sk#19]
 
 (21) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [wr_returned_date_sk#4]
-Right keys [1]: [d_date_sk#6]
+Left keys [1]: [wr_returned_date_sk#18]
+Right keys [1]: [d_date_sk#19]
 Join type: Inner
 Join condition: None
 
 (22) Project [codegen id : 6]
-Output [3]: [wr_returning_customer_sk#1, wr_returning_addr_sk#2, wr_return_amt#3]
-Input [5]: [wr_returning_customer_sk#1, wr_returning_addr_sk#2, wr_return_amt#3, wr_returned_date_sk#4, d_date_sk#6]
+Output [3]: [wr_returning_customer_sk#15, wr_returning_addr_sk#16, wr_return_amt#17]
+Input [5]: [wr_returning_customer_sk#15, wr_returning_addr_sk#16, wr_return_amt#17, wr_returned_date_sk#18, d_date_sk#19]
 
 (23) ReusedExchange [Reuses operator id: 10]
-Output [2]: [ca_address_sk#7, ca_state#8]
+Output [2]: [ca_address_sk#20, ca_state#21]
 
 (24) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [wr_returning_addr_sk#2]
-Right keys [1]: [ca_address_sk#7]
+Left keys [1]: [wr_returning_addr_sk#16]
+Right keys [1]: [ca_address_sk#20]
 Join type: Inner
 Join condition: None
 
 (25) Project [codegen id : 6]
-Output [3]: [wr_returning_customer_sk#1, wr_return_amt#3, ca_state#8]
-Input [5]: [wr_returning_customer_sk#1, wr_returning_addr_sk#2, wr_return_amt#3, ca_address_sk#7, ca_state#8]
+Output [3]: [wr_returning_customer_sk#15, wr_return_amt#17, ca_state#21]
+Input [5]: [wr_returning_customer_sk#15, wr_returning_addr_sk#16, wr_return_amt#17, ca_address_sk#20, ca_state#21]
 
 (26) HashAggregate [codegen id : 6]
-Input [3]: [wr_returning_customer_sk#1, wr_return_amt#3, ca_state#8]
-Keys [2]: [wr_returning_customer_sk#1, ca_state#8]
-Functions [1]: [partial_sum(UnscaledValue(wr_return_amt#3))]
-Aggregate Attributes [1]: [sum#15]
-Results [3]: [wr_returning_customer_sk#1, ca_state#8, sum#16]
+Input [3]: [wr_returning_customer_sk#15, wr_return_amt#17, ca_state#21]
+Keys [2]: [wr_returning_customer_sk#15, ca_state#21]
+Functions [1]: [partial_sum(UnscaledValue(wr_return_amt#17))]
+Aggregate Attributes [1]: [sum#22]
+Results [3]: [wr_returning_customer_sk#15, ca_state#21, sum#23]
 
 (27) Exchange
-Input [3]: [wr_returning_customer_sk#1, ca_state#8, sum#16]
-Arguments: hashpartitioning(wr_returning_customer_sk#1, ca_state#8, 5), ENSURE_REQUIREMENTS, [plan_id=3]
+Input [3]: [wr_returning_customer_sk#15, ca_state#21, sum#23]
+Arguments: hashpartitioning(wr_returning_customer_sk#15, ca_state#21, 5), ENSURE_REQUIREMENTS, [plan_id=3]
 
 (28) HashAggregate [codegen id : 7]
-Input [3]: [wr_returning_customer_sk#1, ca_state#8, sum#16]
-Keys [2]: [wr_returning_customer_sk#1, ca_state#8]
-Functions [1]: [sum(UnscaledValue(wr_return_amt#3))]
-Aggregate Attributes [1]: [sum(UnscaledValue(wr_return_amt#3))#11]
-Results [2]: [ca_state#8 AS ctr_state#13, MakeDecimal(sum(UnscaledValue(wr_return_amt#3))#11,17,2) AS ctr_total_return#14]
+Input [3]: [wr_returning_customer_sk#15, ca_state#21, sum#23]
+Keys [2]: [wr_returning_customer_sk#15, ca_state#21]
+Functions [1]: [sum(UnscaledValue(wr_return_amt#17))]
+Aggregate Attributes [1]: [sum(UnscaledValue(wr_return_amt#17))#11]
+Results [2]: [ca_state#21 AS ctr_state#24, MakeDecimal(sum(UnscaledValue(wr_return_amt#17))#11,17,2) AS ctr_total_return#25]
 
 (29) HashAggregate [codegen id : 7]
-Input [2]: [ctr_state#13, ctr_total_return#14]
-Keys [1]: [ctr_state#13]
-Functions [1]: [partial_avg(ctr_total_return#14)]
-Aggregate Attributes [2]: [sum#17, count#18]
-Results [3]: [ctr_state#13, sum#19, count#20]
+Input [2]: [ctr_state#24, ctr_total_return#25]
+Keys [1]: [ctr_state#24]
+Functions [1]: [partial_avg(ctr_total_return#25)]
+Aggregate Attributes [2]: [sum#26, count#27]
+Results [3]: [ctr_state#24, sum#28, count#29]
 
 (30) Exchange
-Input [3]: [ctr_state#13, sum#19, count#20]
-Arguments: hashpartitioning(ctr_state#13, 5), ENSURE_REQUIREMENTS, [plan_id=4]
+Input [3]: [ctr_state#24, sum#28, count#29]
+Arguments: hashpartitioning(ctr_state#24, 5), ENSURE_REQUIREMENTS, [plan_id=4]
 
 (31) HashAggregate [codegen id : 8]
-Input [3]: [ctr_state#13, sum#19, count#20]
-Keys [1]: [ctr_state#13]
-Functions [1]: [avg(ctr_total_return#14)]
-Aggregate Attributes [1]: [avg(ctr_total_return#14)#21]
-Results [2]: [(avg(ctr_total_return#14)#21 * 1.2) AS (avg(ctr_total_return) * 1.2)#22, ctr_state#13 AS ctr_state#13#23]
+Input [3]: [ctr_state#24, sum#28, count#29]
+Keys [1]: [ctr_state#24]
+Functions [1]: [avg(ctr_total_return#25)]
+Aggregate Attributes [1]: [avg(ctr_total_return#25)#30]
+Results [2]: [(avg(ctr_total_return#25)#30 * 1.2) AS (avg(ctr_total_return) * 1.2)#31, ctr_state#24]
 
 (32) Filter [codegen id : 8]
-Input [2]: [(avg(ctr_total_return) * 1.2)#22, ctr_state#13#23]
-Condition : isnotnull((avg(ctr_total_return) * 1.2)#22)
+Input [2]: [(avg(ctr_total_return) * 1.2)#31, ctr_state#24]
+Condition : isnotnull((avg(ctr_total_return) * 1.2)#31)
 
 (33) BroadcastExchange
-Input [2]: [(avg(ctr_total_return) * 1.2)#22, ctr_state#13#23]
+Input [2]: [(avg(ctr_total_return) * 1.2)#31, ctr_state#24]
 Arguments: HashedRelationBroadcastMode(List(input[1, string, true]),false), [plan_id=5]
 
 (34) BroadcastHashJoin [codegen id : 11]
 Left keys [1]: [ctr_state#13]
-Right keys [1]: [ctr_state#13#23]
+Right keys [1]: [ctr_state#24]
 Join type: Inner
-Join condition: (cast(ctr_total_return#14 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#22)
+Join condition: (cast(ctr_total_return#14 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#31)
 
 (35) Project [codegen id : 11]
 Output [2]: [ctr_customer_sk#12, ctr_total_return#14]
-Input [5]: [ctr_customer_sk#12, ctr_state#13, ctr_total_return#14, (avg(ctr_total_return) * 1.2)#22, ctr_state#13#23]
+Input [5]: [ctr_customer_sk#12, ctr_state#13, ctr_total_return#14, (avg(ctr_total_return) * 1.2)#31, ctr_state#24]
 
 (36) Scan parquet spark_catalog.default.customer
-Output [14]: [c_customer_sk#24, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29, c_preferred_cust_flag#30, c_birth_day#31, c_birth_month#32, c_birth_year#33, c_birth_country#34, c_login#35, c_email_address#36, c_last_review_date#37]
+Output [14]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date#45]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer]
 PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_current_addr_sk)]
 ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_current_addr_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_cust_flag:string,c_birth_day:int,c_birth_month:int,c_birth_year:int,c_birth_country:string,c_login:string,c_email_address:string,c_last_review_date:int>
 
 (37) ColumnarToRow [codegen id : 9]
-Input [14]: [c_customer_sk#24, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29, c_preferred_cust_flag#30, c_birth_day#31, c_birth_month#32, c_birth_year#33, c_birth_country#34, c_login#35, c_email_address#36, c_last_review_date#37]
+Input [14]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date#45]
 
 (38) Filter [codegen id : 9]
-Input [14]: [c_customer_sk#24, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29, c_preferred_cust_flag#30, c_birth_day#31, c_birth_month#32, c_birth_year#33, c_birth_country#34, c_login#35, c_email_address#36, c_last_review_date#37]
-Condition : (isnotnull(c_customer_sk#24) AND isnotnull(c_current_addr_sk#26))
+Input [14]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date#45]
+Condition : (isnotnull(c_customer_sk#32) AND isnotnull(c_current_addr_sk#34))
 
 (39) BroadcastExchange
-Input [14]: [c_customer_sk#24, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29, c_preferred_cust_flag#30, c_birth_day#31, c_birth_month#32, c_birth_year#33, c_birth_country#34, c_login#35, c_email_address#36, c_last_review_date#37]
+Input [14]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date#45]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=6]
 
 (40) BroadcastHashJoin [codegen id : 11]
 Left keys [1]: [ctr_customer_sk#12]
-Right keys [1]: [c_customer_sk#24]
+Right keys [1]: [c_customer_sk#32]
 Join type: Inner
 Join condition: None
 
 (41) Project [codegen id : 11]
-Output [14]: [ctr_total_return#14, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29, c_preferred_cust_flag#30, c_birth_day#31, c_birth_month#32, c_birth_year#33, c_birth_country#34, c_login#35, c_email_address#36, c_last_review_date#37]
-Input [16]: [ctr_customer_sk#12, ctr_total_return#14, c_customer_sk#24, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29, c_preferred_cust_flag#30, c_birth_day#31, c_birth_month#32, c_birth_year#33, c_birth_country#34, c_login#35, c_email_address#36, c_last_review_date#37]
+Output [14]: [ctr_total_return#14, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date#45]
+Input [16]: [ctr_customer_sk#12, ctr_total_return#14, c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date#45]
 
 (42) Scan parquet spark_catalog.default.customer_address
-Output [2]: [ca_address_sk#38, ca_state#39]
+Output [2]: [ca_address_sk#46, ca_state#47]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [IsNotNull(ca_state), EqualTo(ca_state,GA), IsNotNull(ca_address_sk)]
 ReadSchema: struct<ca_address_sk:int,ca_state:string>
 
 (43) ColumnarToRow [codegen id : 10]
-Input [2]: [ca_address_sk#38, ca_state#39]
+Input [2]: [ca_address_sk#46, ca_state#47]
 
 (44) Filter [codegen id : 10]
-Input [2]: [ca_address_sk#38, ca_state#39]
-Condition : ((isnotnull(ca_state#39) AND (ca_state#39 = GA)) AND isnotnull(ca_address_sk#38))
+Input [2]: [ca_address_sk#46, ca_state#47]
+Condition : ((isnotnull(ca_state#47) AND (ca_state#47 = GA)) AND isnotnull(ca_address_sk#46))
 
 (45) Project [codegen id : 10]
-Output [1]: [ca_address_sk#38]
-Input [2]: [ca_address_sk#38, ca_state#39]
+Output [1]: [ca_address_sk#46]
+Input [2]: [ca_address_sk#46, ca_state#47]
 
 (46) BroadcastExchange
-Input [1]: [ca_address_sk#38]
+Input [1]: [ca_address_sk#46]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=7]
 
 (47) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [c_current_addr_sk#26]
-Right keys [1]: [ca_address_sk#38]
+Left keys [1]: [c_current_addr_sk#34]
+Right keys [1]: [ca_address_sk#46]
 Join type: Inner
 Join condition: None
 
 (48) Project [codegen id : 11]
-Output [13]: [c_customer_id#25, c_salutation#27, c_first_name#28, c_last_name#29, c_preferred_cust_flag#30, c_birth_day#31, c_birth_month#32, c_birth_year#33, c_birth_country#34, c_login#35, c_email_address#36, c_last_review_date#37, ctr_total_return#14]
-Input [15]: [ctr_total_return#14, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29, c_preferred_cust_flag#30, c_birth_day#31, c_birth_month#32, c_birth_year#33, c_birth_country#34, c_login#35, c_email_address#36, c_last_review_date#37, ca_address_sk#38]
+Output [13]: [c_customer_id#33, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date#45, ctr_total_return#14]
+Input [15]: [ctr_total_return#14, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date#45, ca_address_sk#46]
 
 (49) TakeOrderedAndProject
-Input [13]: [c_customer_id#25, c_salutation#27, c_first_name#28, c_last_name#29, c_preferred_cust_flag#30, c_birth_day#31, c_birth_month#32, c_birth_year#33, c_birth_country#34, c_login#35, c_email_address#36, c_last_review_date#37, ctr_total_return#14]
-Arguments: 100, [c_customer_id#25 ASC NULLS FIRST, c_salutation#27 ASC NULLS FIRST, c_first_name#28 ASC NULLS FIRST, c_last_name#29 ASC NULLS FIRST, c_preferred_cust_flag#30 ASC NULLS FIRST, c_birth_day#31 ASC NULLS FIRST, c_birth_month#32 ASC NULLS FIRST, c_birth_year#33 ASC NULLS FIRST, c_birth_country#34 ASC NULLS FIRST, c_login#35 ASC NULLS FIRST, c_email_address#36 ASC NULLS FIRST, c_last_review_date#37 ASC NULLS FIRST, ctr_total_return#14 ASC NULLS FIRST], [c_customer_id#25, c_salutation#27, c_first_name#28, c_last_name#29, c_preferred_cust_flag#30, c_birth_day#31, c_birth_month#32, c_birth_year#33, c_birth_country#34, c_login#35, c_email_address#36, c_last_review_date#37, ctr_total_return#14]
+Input [13]: [c_customer_id#33, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date#45, ctr_total_return#14]
+Arguments: 100, [c_customer_id#33 ASC NULLS FIRST, c_salutation#35 ASC NULLS FIRST, c_first_name#36 ASC NULLS FIRST, c_last_name#37 ASC NULLS FIRST, c_preferred_cust_flag#38 ASC NULLS FIRST, c_birth_day#39 ASC NULLS FIRST, c_birth_month#40 ASC NULLS FIRST, c_birth_year#41 ASC NULLS FIRST, c_birth_country#42 ASC NULLS FIRST, c_login#43 ASC NULLS FIRST, c_email_address#44 ASC NULLS FIRST, c_last_review_date#45 ASC NULLS FIRST, ctr_total_return#14 ASC NULLS FIRST], [c_customer_id#33, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date#45, ctr_total_return#14]
 
 ===== Subqueries =====
 
@@ -298,27 +298,27 @@ BroadcastExchange (54)
 
 
 (50) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#6, d_year#40]
+Output [2]: [d_date_sk#6, d_year#48]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (51) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#6, d_year#40]
+Input [2]: [d_date_sk#6, d_year#48]
 
 (52) Filter [codegen id : 1]
-Input [2]: [d_date_sk#6, d_year#40]
-Condition : ((isnotnull(d_year#40) AND (d_year#40 = 2002)) AND isnotnull(d_date_sk#6))
+Input [2]: [d_date_sk#6, d_year#48]
+Condition : ((isnotnull(d_year#48) AND (d_year#48 = 2002)) AND isnotnull(d_date_sk#6))
 
 (53) Project [codegen id : 1]
 Output [1]: [d_date_sk#6]
-Input [2]: [d_date_sk#6, d_year#40]
+Input [2]: [d_date_sk#6, d_year#48]
 
 (54) BroadcastExchange
 Input [1]: [d_date_sk#6]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=8]
 
-Subquery:2 Hosting operator id = 17 Hosting Expression = wr_returned_date_sk#4 IN dynamicpruning#5
+Subquery:2 Hosting operator id = 17 Hosting Expression = wr_returned_date_sk#18 IN dynamicpruning#5
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30/simplified.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30/simplified.txt
index 3ed094cc894..6f65b8f5e82 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30/simplified.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q30/simplified.txt
@@ -41,7 +41,7 @@ TakeOrderedAndProject [c_customer_id,c_salutation,c_first_name,c_last_name,c_pre
                   BroadcastExchange #4
                     WholeStageCodegen (8)
                       Filter [(avg(ctr_total_return) * 1.2)]
-                        HashAggregate [ctr_state,sum,count] [avg(ctr_total_return),(avg(ctr_total_return) * 1.2),ctr_state,sum,count]
+                        HashAggregate [ctr_state,sum,count] [avg(ctr_total_return),(avg(ctr_total_return) * 1.2),sum,count]
                           InputAdapter
                             Exchange [ctr_state] #5
                               WholeStageCodegen (7)
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q59.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q59.sf100/explain.txt
index 1aa4410e295..2f020e12b3f 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q59.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q59.sf100/explain.txt
@@ -177,143 +177,143 @@ Output [10]: [s_store_name#39 AS s_store_name1#42, d_week_seq#5 AS d_week_seq1#4
 Input [11]: [d_week_seq#5, sun_sales#30, mon_sales#31, tue_sales#32, wed_sales#33, thu_sales#34, fri_sales#35, sat_sales#36, s_store_id#38, s_store_name#39, d_week_seq#41]
 
 (26) Scan parquet spark_catalog.default.store_sales
-Output [3]: [ss_store_sk#1, ss_sales_price#2, ss_sold_date_sk#3]
+Output [3]: [ss_store_sk#52, ss_sales_price#53, ss_sold_date_sk#54]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#3)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#54)]
 PushedFilters: [IsNotNull(ss_store_sk)]
 ReadSchema: struct<ss_store_sk:int,ss_sales_price:decimal(7,2)>
 
 (27) ColumnarToRow [codegen id : 6]
-Input [3]: [ss_store_sk#1, ss_sales_price#2, ss_sold_date_sk#3]
+Input [3]: [ss_store_sk#52, ss_sales_price#53, ss_sold_date_sk#54]
 
 (28) Filter [codegen id : 6]
-Input [3]: [ss_store_sk#1, ss_sales_price#2, ss_sold_date_sk#3]
-Condition : isnotnull(ss_store_sk#1)
+Input [3]: [ss_store_sk#52, ss_sales_price#53, ss_sold_date_sk#54]
+Condition : isnotnull(ss_store_sk#52)
 
 (29) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#4, d_week_seq#5, d_day_name#6]
+Output [3]: [d_date_sk#55, d_week_seq#56, d_day_name#57]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_date_sk), IsNotNull(d_week_seq)]
 ReadSchema: struct<d_date_sk:int,d_week_seq:int,d_day_name:string>
 
 (30) ColumnarToRow [codegen id : 5]
-Input [3]: [d_date_sk#4, d_week_seq#5, d_day_name#6]
+Input [3]: [d_date_sk#55, d_week_seq#56, d_day_name#57]
 
 (31) Filter [codegen id : 5]
-Input [3]: [d_date_sk#4, d_week_seq#5, d_day_name#6]
-Condition : ((isnotnull(d_date_sk#4) AND isnotnull(d_week_seq#5)) AND might_contain(Subquery scalar-subquery#52, [id=#53], xxhash64(d_week_seq#5, 42)))
+Input [3]: [d_date_sk#55, d_week_seq#56, d_day_name#57]
+Condition : ((isnotnull(d_date_sk#55) AND isnotnull(d_week_seq#56)) AND might_contain(Subquery scalar-subquery#58, [id=#59], xxhash64(d_week_seq#56, 42)))
 
 (32) BroadcastExchange
-Input [3]: [d_date_sk#4, d_week_seq#5, d_day_name#6]
+Input [3]: [d_date_sk#55, d_week_seq#56, d_day_name#57]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5]
 
 (33) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [ss_sold_date_sk#3]
-Right keys [1]: [d_date_sk#4]
+Left keys [1]: [ss_sold_date_sk#54]
+Right keys [1]: [d_date_sk#55]
 Join type: Inner
 Join condition: None
 
 (34) Project [codegen id : 6]
-Output [4]: [ss_store_sk#1, ss_sales_price#2, d_week_seq#5, d_day_name#6]
-Input [6]: [ss_store_sk#1, ss_sales_price#2, ss_sold_date_sk#3, d_date_sk#4, d_week_seq#5, d_day_name#6]
+Output [4]: [ss_store_sk#52, ss_sales_price#53, d_week_seq#56, d_day_name#57]
+Input [6]: [ss_store_sk#52, ss_sales_price#53, ss_sold_date_sk#54, d_date_sk#55, d_week_seq#56, d_day_name#57]
 
 (35) HashAggregate [codegen id : 6]
-Input [4]: [ss_store_sk#1, ss_sales_price#2, d_week_seq#5, d_day_name#6]
-Keys [2]: [d_week_seq#5, ss_store_sk#1]
-Functions [7]: [partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Tuesday  ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))]
-Aggregate Attributes [7]: [sum#54, sum#55, sum#56, sum#57, sum#58, sum#59, sum#60]
-Results [9]: [d_week_seq#5, ss_store_sk#1, sum#61, sum#62, sum#63, sum#64, sum#65, sum#66, sum#67]
+Input [4]: [ss_store_sk#52, ss_sales_price#53, d_week_seq#56, d_day_name#57]
+Keys [2]: [d_week_seq#56, ss_store_sk#52]
+Functions [7]: [partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Sunday   ) THEN ss_sales_price#53 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Monday   ) THEN ss_sales_price#53 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Tuesday  ) THEN ss_sales_price#53 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Wednesday) THEN ss_sales_price#53 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Thursday ) THEN ss_sales_price#53 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Friday   ) THEN ss_sales_price#53 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#57 = Saturday ) THEN ss_sales_price#53 END))]
+Aggregate Attributes [7]: [sum#60, sum#61, sum#62, sum#63, sum#64, sum#65, sum#66]
+Results [9]: [d_week_seq#56, ss_store_sk#52, sum#67, sum#68, sum#69, sum#70, sum#71, sum#72, sum#73]
 
 (36) Exchange
-Input [9]: [d_week_seq#5, ss_store_sk#1, sum#61, sum#62, sum#63, sum#64, sum#65, sum#66, sum#67]
-Arguments: hashpartitioning(d_week_seq#5, ss_store_sk#1, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [9]: [d_week_seq#56, ss_store_sk#52, sum#67, sum#68, sum#69, sum#70, sum#71, sum#72, sum#73]
+Arguments: hashpartitioning(d_week_seq#56, ss_store_sk#52, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (37) HashAggregate [codegen id : 9]
-Input [9]: [d_week_seq#5, ss_store_sk#1, sum#61, sum#62, sum#63, sum#64, sum#65, sum#66, sum#67]
-Keys [2]: [d_week_seq#5, ss_store_sk#1]
-Functions [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Tuesday  ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))]
-Aggregate Attributes [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END))#23, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END))#24, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Tuesday  ) THEN ss_sales_price#2 END))#25, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END))#26, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END))#27, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END))#28, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))#29]
-Results [9]: [d_week_seq#5, ss_store_sk#1, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END))#23,17,2) AS sun_sales#30, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END))#24,17,2) AS mon_sales#31, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Tuesday  ) THEN ss_sales_price#2 END))#25,17,2) AS tue_sales#32, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END))#26,17,2) AS wed_sales#33, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END))#27,17,2) AS thu_sales#34, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END))#28,17,2) AS fri_sales#35, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))#29,17,2) AS sat_sales#36]
+Input [9]: [d_week_seq#56, ss_store_sk#52, sum#67, sum#68, sum#69, sum#70, sum#71, sum#72, sum#73]
+Keys [2]: [d_week_seq#56, ss_store_sk#52]
+Functions [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#57 = Sunday   ) THEN ss_sales_price#53 END)), sum(UnscaledValue(CASE WHEN (d_day_name#57 = Monday   ) THEN ss_sales_price#53 END)), sum(UnscaledValue(CASE WHEN (d_day_name#57 = Tuesday  ) THEN ss_sales_price#53 END)), sum(UnscaledValue(CASE WHEN (d_day_name#57 = Wednesday) THEN ss_sales_price#53 END)), sum(UnscaledValue(CASE WHEN (d_day_name#57 = Thursday ) THEN ss_sales_price#53 END)), sum(UnscaledValue(CASE WHEN (d_day_name#57 = Friday   ) THEN ss_sales_price#53 END)), sum(UnscaledValue(CASE WHEN (d_day_name#57 = Saturday ) THEN ss_sales_price#53 END))]
+Aggregate Attributes [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#57 = Sunday   ) THEN ss_sales_price#53 END))#23, sum(UnscaledValue(CASE WHEN (d_day_name#57 = Monday   ) THEN ss_sales_price#53 END))#24, sum(UnscaledValue(CASE WHEN (d_day_name#57 = Tuesday  ) THEN ss_sales_price#53 END))#25, sum(UnscaledValue(CASE WHEN (d_day_name#57 = Wednesday) THEN ss_sales_price#53 END))#26, sum(UnscaledValue(CASE WHEN (d_day_name#57 = Thursday ) THEN ss_sales_price#53 END))#27, sum(UnscaledValue(CASE WHEN (d_day_name#57 = Friday   ) THEN ss_sales_price#53 END))#28, sum(UnscaledValue(CASE WHEN (d_day_name#57 = Saturday ) THEN ss_sales_price#53 END))#29]
+Results [9]: [d_week_seq#56, ss_store_sk#52, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Sunday   ) THEN ss_sales_price#53 END))#23,17,2) AS sun_sales#74, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Monday   ) THEN ss_sales_price#53 END))#24,17,2) AS mon_sales#75, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Tuesday  ) THEN ss_sales_price#53 END))#25,17,2) AS tue_sales#76, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Wednesday) THEN ss_sales_price#53 END))#26,17,2) AS wed_sales#77, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Thursday ) THEN ss_sales_price#53 END))#27,17,2) AS thu_sales#78, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Friday   ) THEN ss_sales_price#53 END))#28,17,2) AS fri_sales#79, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#57 = Saturday ) THEN ss_sales_price#53 END))#29,17,2) AS sat_sales#80]
 
 (38) Scan parquet spark_catalog.default.store
-Output [2]: [s_store_sk#68, s_store_id#69]
+Output [2]: [s_store_sk#81, s_store_id#82]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store]
 PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_id)]
 ReadSchema: struct<s_store_sk:int,s_store_id:string>
 
 (39) ColumnarToRow [codegen id : 7]
-Input [2]: [s_store_sk#68, s_store_id#69]
+Input [2]: [s_store_sk#81, s_store_id#82]
 
 (40) Filter [codegen id : 7]
-Input [2]: [s_store_sk#68, s_store_id#69]
-Condition : (isnotnull(s_store_sk#68) AND isnotnull(s_store_id#69))
+Input [2]: [s_store_sk#81, s_store_id#82]
+Condition : (isnotnull(s_store_sk#81) AND isnotnull(s_store_id#82))
 
 (41) BroadcastExchange
-Input [2]: [s_store_sk#68, s_store_id#69]
+Input [2]: [s_store_sk#81, s_store_id#82]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7]
 
 (42) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_store_sk#1]
-Right keys [1]: [s_store_sk#68]
+Left keys [1]: [ss_store_sk#52]
+Right keys [1]: [s_store_sk#81]
 Join type: Inner
 Join condition: None
 
 (43) Project [codegen id : 9]
-Output [9]: [d_week_seq#5, sun_sales#30, mon_sales#31, tue_sales#32, wed_sales#33, thu_sales#34, fri_sales#35, sat_sales#36, s_store_id#69]
-Input [11]: [d_week_seq#5, ss_store_sk#1, sun_sales#30, mon_sales#31, tue_sales#32, wed_sales#33, thu_sales#34, fri_sales#35, sat_sales#36, s_store_sk#68, s_store_id#69]
+Output [9]: [d_week_seq#56, sun_sales#74, mon_sales#75, tue_sales#76, wed_sales#77, thu_sales#78, fri_sales#79, sat_sales#80, s_store_id#82]
+Input [11]: [d_week_seq#56, ss_store_sk#52, sun_sales#74, mon_sales#75, tue_sales#76, wed_sales#77, thu_sales#78, fri_sales#79, sat_sales#80, s_store_sk#81, s_store_id#82]
 
 (44) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_month_seq#70, d_week_seq#71]
+Output [2]: [d_month_seq#83, d_week_seq#84]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1224), LessThanOrEqual(d_month_seq,1235), IsNotNull(d_week_seq)]
 ReadSchema: struct<d_month_seq:int,d_week_seq:int>
 
 (45) ColumnarToRow [codegen id : 8]
-Input [2]: [d_month_seq#70, d_week_seq#71]
+Input [2]: [d_month_seq#83, d_week_seq#84]
 
 (46) Filter [codegen id : 8]
-Input [2]: [d_month_seq#70, d_week_seq#71]
-Condition : (((isnotnull(d_month_seq#70) AND (d_month_seq#70 >= 1224)) AND (d_month_seq#70 <= 1235)) AND isnotnull(d_week_seq#71))
+Input [2]: [d_month_seq#83, d_week_seq#84]
+Condition : (((isnotnull(d_month_seq#83) AND (d_month_seq#83 >= 1224)) AND (d_month_seq#83 <= 1235)) AND isnotnull(d_week_seq#84))
 
 (47) Project [codegen id : 8]
-Output [1]: [d_week_seq#71]
-Input [2]: [d_month_seq#70, d_week_seq#71]
+Output [1]: [d_week_seq#84]
+Input [2]: [d_month_seq#83, d_week_seq#84]
 
 (48) BroadcastExchange
-Input [1]: [d_week_seq#71]
+Input [1]: [d_week_seq#84]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=8]
 
 (49) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [d_week_seq#5]
-Right keys [1]: [d_week_seq#71]
+Left keys [1]: [d_week_seq#56]
+Right keys [1]: [d_week_seq#84]
 Join type: Inner
 Join condition: None
 
 (50) Project [codegen id : 9]
-Output [9]: [d_week_seq#5 AS d_week_seq2#72, s_store_id#69 AS s_store_id2#73, sun_sales#30 AS sun_sales2#74, mon_sales#31 AS mon_sales2#75, tue_sales#32 AS tue_sales2#76, wed_sales#33 AS wed_sales2#77, thu_sales#34 AS thu_sales2#78, fri_sales#35 AS fri_sales2#79, sat_sales#36 AS sat_sales2#80]
-Input [10]: [d_week_seq#5, sun_sales#30, mon_sales#31, tue_sales#32, wed_sales#33, thu_sales#34, fri_sales#35, sat_sales#36, s_store_id#69, d_week_seq#71]
+Output [9]: [d_week_seq#56 AS d_week_seq2#85, s_store_id#82 AS s_store_id2#86, sun_sales#74 AS sun_sales2#87, mon_sales#75 AS mon_sales2#88, tue_sales#76 AS tue_sales2#89, wed_sales#77 AS wed_sales2#90, thu_sales#78 AS thu_sales2#91, fri_sales#79 AS fri_sales2#92, sat_sales#80 AS sat_sales2#93]
+Input [10]: [d_week_seq#56, sun_sales#74, mon_sales#75, tue_sales#76, wed_sales#77, thu_sales#78, fri_sales#79, sat_sales#80, s_store_id#82, d_week_seq#84]
 
 (51) BroadcastExchange
-Input [9]: [d_week_seq2#72, s_store_id2#73, sun_sales2#74, mon_sales2#75, tue_sales2#76, wed_sales2#77, thu_sales2#78, fri_sales2#79, sat_sales2#80]
+Input [9]: [d_week_seq2#85, s_store_id2#86, sun_sales2#87, mon_sales2#88, tue_sales2#89, wed_sales2#90, thu_sales2#91, fri_sales2#92, sat_sales2#93]
 Arguments: HashedRelationBroadcastMode(List(input[1, string, true], (input[0, int, true] - 52)),false), [plan_id=9]
 
 (52) BroadcastHashJoin [codegen id : 10]
 Left keys [2]: [s_store_id1#44, d_week_seq1#43]
-Right keys [2]: [s_store_id2#73, (d_week_seq2#72 - 52)]
+Right keys [2]: [s_store_id2#86, (d_week_seq2#85 - 52)]
 Join type: Inner
 Join condition: None
 
 (53) Project [codegen id : 10]
-Output [10]: [s_store_name1#42, s_store_id1#44, d_week_seq1#43, (sun_sales1#45 / sun_sales2#74) AS (sun_sales1 / sun_sales2)#81, (mon_sales1#46 / mon_sales2#75) AS (mon_sales1 / mon_sales2)#82, (tue_sales1#47 / tue_sales2#76) AS (tue_sales1 / tue_sales2)#83, (wed_sales1#48 / wed_sales2#77) AS (wed_sales1 / wed_sales2)#84, (thu_sales1#49 / thu_sales2#78) AS (thu_sales1 / thu_sales2)#85, (fri_sales1#50 / fri_sales2#79) AS (fri_sales1 / fri_sales2)#86, (sat_sales1#51 / sat_sales2#80) AS (sat_sales1 / sat_sales2)#87]
-Input [19]: [s_store_name1#42, d_week_seq1#43, s_store_id1#44, sun_sales1#45, mon_sales1#46, tue_sales1#47, wed_sales1#48, thu_sales1#49, fri_sales1#50, sat_sales1#51, d_week_seq2#72, s_store_id2#73, sun_sales2#74, mon_sales2#75, tue_sales2#76, wed_sales2#77, thu_sales2#78, fri_sales2#79, sat_sales2#80]
+Output [10]: [s_store_name1#42, s_store_id1#44, d_week_seq1#43, (sun_sales1#45 / sun_sales2#87) AS (sun_sales1 / sun_sales2)#94, (mon_sales1#46 / mon_sales2#88) AS (mon_sales1 / mon_sales2)#95, (tue_sales1#47 / tue_sales2#89) AS (tue_sales1 / tue_sales2)#96, (wed_sales1#48 / wed_sales2#90) AS (wed_sales1 / wed_sales2)#97, (thu_sales1#49 / thu_sales2#91) AS (thu_sales1 / thu_sales2)#98, (fri_sales1#50 / fri_sales2#92) AS (fri_sales1 / fri_sales2)#99, (sat_sales1#51 / sat_sales2#93) AS (sat_sales1 / sat_sales2)#100]
+Input [19]: [s_store_name1#42, d_week_seq1#43, s_store_id1#44, sun_sales1#45, mon_sales1#46, tue_sales1#47, wed_sales1#48, thu_sales1#49, fri_sales1#50, sat_sales1#51, d_week_seq2#85, s_store_id2#86, sun_sales2#87, mon_sales2#88, tue_sales2#89, wed_sales2#90, thu_sales2#91, fri_sales2#92, sat_sales2#93]
 
 (54) TakeOrderedAndProject
-Input [10]: [s_store_name1#42, s_store_id1#44, d_week_seq1#43, (sun_sales1 / sun_sales2)#81, (mon_sales1 / mon_sales2)#82, (tue_sales1 / tue_sales2)#83, (wed_sales1 / wed_sales2)#84, (thu_sales1 / thu_sales2)#85, (fri_sales1 / fri_sales2)#86, (sat_sales1 / sat_sales2)#87]
-Arguments: 100, [s_store_name1#42 ASC NULLS FIRST, s_store_id1#44 ASC NULLS FIRST, d_week_seq1#43 ASC NULLS FIRST], [s_store_name1#42, s_store_id1#44, d_week_seq1#43, (sun_sales1 / sun_sales2)#81, (mon_sales1 / mon_sales2)#82, (tue_sales1 / tue_sales2)#83, (wed_sales1 / wed_sales2)#84, (thu_sales1 / thu_sales2)#85, (fri_sales1 / fri_sales2)#86, (sat_sales1 / sat_sales2)#87]
+Input [10]: [s_store_name1#42, s_store_id1#44, d_week_seq1#43, (sun_sales1 / sun_sales2)#94, (mon_sales1 / mon_sales2)#95, (tue_sales1 / tue_sales2)#96, (wed_sales1 / wed_sales2)#97, (thu_sales1 / thu_sales2)#98, (fri_sales1 / fri_sales2)#99, (sat_sales1 / sat_sales2)#100]
+Arguments: 100, [s_store_name1#42 ASC NULLS FIRST, s_store_id1#44 ASC NULLS FIRST, d_week_seq1#43 ASC NULLS FIRST], [s_store_name1#42, s_store_id1#44, d_week_seq1#43, (sun_sales1 / sun_sales2)#94, (mon_sales1 / mon_sales2)#95, (tue_sales1 / tue_sales2)#96, (wed_sales1 / wed_sales2)#97, (thu_sales1 / thu_sales2)#98, (fri_sales1 / fri_sales2)#99, (sat_sales1 / sat_sales2)#100]
 
 ===== Subqueries =====
 
@@ -349,21 +349,21 @@ Input [2]: [d_month_seq#40, d_week_seq#41]
 Input [1]: [d_week_seq#41]
 Keys: []
 Functions [1]: [partial_bloom_filter_agg(xxhash64(d_week_seq#41, 42), 335, 8990, 0, 0)]
-Aggregate Attributes [1]: [buf#88]
-Results [1]: [buf#89]
+Aggregate Attributes [1]: [buf#101]
+Results [1]: [buf#102]
 
 (60) Exchange
-Input [1]: [buf#89]
+Input [1]: [buf#102]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=10]
 
 (61) ObjectHashAggregate
-Input [1]: [buf#89]
+Input [1]: [buf#102]
 Keys: []
 Functions [1]: [bloom_filter_agg(xxhash64(d_week_seq#41, 42), 335, 8990, 0, 0)]
-Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_week_seq#41, 42), 335, 8990, 0, 0)#90]
-Results [1]: [bloom_filter_agg(xxhash64(d_week_seq#41, 42), 335, 8990, 0, 0)#90 AS bloomFilter#91]
+Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_week_seq#41, 42), 335, 8990, 0, 0)#103]
+Results [1]: [bloom_filter_agg(xxhash64(d_week_seq#41, 42), 335, 8990, 0, 0)#103 AS bloomFilter#104]
 
-Subquery:2 Hosting operator id = 31 Hosting Expression = Subquery scalar-subquery#52, [id=#53]
+Subquery:2 Hosting operator id = 31 Hosting Expression = Subquery scalar-subquery#58, [id=#59]
 ObjectHashAggregate (68)
 +- Exchange (67)
    +- ObjectHashAggregate (66)
@@ -374,39 +374,39 @@ ObjectHashAggregate (68)
 
 
 (62) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_month_seq#70, d_week_seq#71]
+Output [2]: [d_month_seq#83, d_week_seq#84]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1224), LessThanOrEqual(d_month_seq,1235), IsNotNull(d_week_seq)]
 ReadSchema: struct<d_month_seq:int,d_week_seq:int>
 
 (63) ColumnarToRow [codegen id : 1]
-Input [2]: [d_month_seq#70, d_week_seq#71]
+Input [2]: [d_month_seq#83, d_week_seq#84]
 
 (64) Filter [codegen id : 1]
-Input [2]: [d_month_seq#70, d_week_seq#71]
-Condition : (((isnotnull(d_month_seq#70) AND (d_month_seq#70 >= 1224)) AND (d_month_seq#70 <= 1235)) AND isnotnull(d_week_seq#71))
+Input [2]: [d_month_seq#83, d_week_seq#84]
+Condition : (((isnotnull(d_month_seq#83) AND (d_month_seq#83 >= 1224)) AND (d_month_seq#83 <= 1235)) AND isnotnull(d_week_seq#84))
 
 (65) Project [codegen id : 1]
-Output [1]: [d_week_seq#71]
-Input [2]: [d_month_seq#70, d_week_seq#71]
+Output [1]: [d_week_seq#84]
+Input [2]: [d_month_seq#83, d_week_seq#84]
 
 (66) ObjectHashAggregate
-Input [1]: [d_week_seq#71]
+Input [1]: [d_week_seq#84]
 Keys: []
-Functions [1]: [partial_bloom_filter_agg(xxhash64(d_week_seq#71, 42), 335, 8990, 0, 0)]
-Aggregate Attributes [1]: [buf#92]
-Results [1]: [buf#93]
+Functions [1]: [partial_bloom_filter_agg(xxhash64(d_week_seq#84, 42), 335, 8990, 0, 0)]
+Aggregate Attributes [1]: [buf#105]
+Results [1]: [buf#106]
 
 (67) Exchange
-Input [1]: [buf#93]
+Input [1]: [buf#106]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=11]
 
 (68) ObjectHashAggregate
-Input [1]: [buf#93]
+Input [1]: [buf#106]
 Keys: []
-Functions [1]: [bloom_filter_agg(xxhash64(d_week_seq#71, 42), 335, 8990, 0, 0)]
-Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_week_seq#71, 42), 335, 8990, 0, 0)#94]
-Results [1]: [bloom_filter_agg(xxhash64(d_week_seq#71, 42), 335, 8990, 0, 0)#94 AS bloomFilter#95]
+Functions [1]: [bloom_filter_agg(xxhash64(d_week_seq#84, 42), 335, 8990, 0, 0)]
+Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_week_seq#84, 42), 335, 8990, 0, 0)#107]
+Results [1]: [bloom_filter_agg(xxhash64(d_week_seq#84, 42), 335, 8990, 0, 0)#107 AS bloomFilter#108]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q59/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q59/explain.txt
index ee3a0870f09..302d540a890 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q59/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q59/explain.txt
@@ -167,90 +167,90 @@ Output [10]: [s_store_name#37 AS s_store_name1#40, d_week_seq#5 AS d_week_seq1#4
 Input [11]: [d_week_seq#5, sun_sales#28, mon_sales#29, tue_sales#30, wed_sales#31, thu_sales#32, fri_sales#33, sat_sales#34, s_store_id#36, s_store_name#37, d_week_seq#39]
 
 (26) ReusedExchange [Reuses operator id: 11]
-Output [9]: [d_week_seq#5, ss_store_sk#1, sum#50, sum#51, sum#52, sum#53, sum#54, sum#55, sum#56]
+Output [9]: [d_week_seq#50, ss_store_sk#51, sum#52, sum#53, sum#54, sum#55, sum#56, sum#57, sum#58]
 
 (27) HashAggregate [codegen id : 9]
-Input [9]: [d_week_seq#5, ss_store_sk#1, sum#50, sum#51, sum#52, sum#53, sum#54, sum#55, sum#56]
-Keys [2]: [d_week_seq#5, ss_store_sk#1]
-Functions [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Tuesday  ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END)), sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))]
-Aggregate Attributes [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END))#21, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END))#22, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Tuesday  ) THEN ss_sales_price#2 END))#23, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END))#24, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END))#25, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END))#26, sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))#27]
-Results [9]: [d_week_seq#5, ss_store_sk#1, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Sunday   ) THEN ss_sales_price#2 END))#21,17,2) AS sun_sales#28, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Monday   ) THEN ss_sales_price#2 END))#22,17,2) AS mon_sales#29, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Tuesday  ) THEN ss_sales_price#2 END))#23,17,2) AS tue_sales#30, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Wednesday) THEN ss_sales_price#2 END))#24,17,2) AS wed_sales#31, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Thursday ) THEN ss_sales_price#2 END))#25,17,2) AS thu_sales#32, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Friday   ) THEN ss_sales_price#2 END))#26,17,2) AS fri_sales#33, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#6 = Saturday ) THEN ss_sales_price#2 END))#27,17,2) AS sat_sales#34]
+Input [9]: [d_week_seq#50, ss_store_sk#51, sum#52, sum#53, sum#54, sum#55, sum#56, sum#57, sum#58]
+Keys [2]: [d_week_seq#50, ss_store_sk#51]
+Functions [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#59 = Sunday   ) THEN ss_sales_price#60 END)), sum(UnscaledValue(CASE WHEN (d_day_name#59 = Monday   ) THEN ss_sales_price#60 END)), sum(UnscaledValue(CASE WHEN (d_day_name#59 = Tuesday  ) THEN ss_sales_price#60 END)), sum(UnscaledValue(CASE WHEN (d_day_name#59 = Wednesday) THEN ss_sales_price#60 END)), sum(UnscaledValue(CASE WHEN (d_day_name#59 = Thursday ) THEN ss_sales_price#60 END)), sum(UnscaledValue(CASE WHEN (d_day_name#59 = Friday   ) THEN ss_sales_price#60 END)), sum(UnscaledValue(CASE WHEN (d_day_name#59 = Saturday ) THEN ss_sales_price#60 END))]
+Aggregate Attributes [7]: [sum(UnscaledValue(CASE WHEN (d_day_name#59 = Sunday   ) THEN ss_sales_price#60 END))#21, sum(UnscaledValue(CASE WHEN (d_day_name#59 = Monday   ) THEN ss_sales_price#60 END))#22, sum(UnscaledValue(CASE WHEN (d_day_name#59 = Tuesday  ) THEN ss_sales_price#60 END))#23, sum(UnscaledValue(CASE WHEN (d_day_name#59 = Wednesday) THEN ss_sales_price#60 END))#24, sum(UnscaledValue(CASE WHEN (d_day_name#59 = Thursday ) THEN ss_sales_price#60 END))#25, sum(UnscaledValue(CASE WHEN (d_day_name#59 = Friday   ) THEN ss_sales_price#60 END))#26, sum(UnscaledValue(CASE WHEN (d_day_name#59 = Saturday ) THEN ss_sales_price#60 END))#27]
+Results [9]: [d_week_seq#50, ss_store_sk#51, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#59 = Sunday   ) THEN ss_sales_price#60 END))#21,17,2) AS sun_sales#61, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#59 = Monday   ) THEN ss_sales_price#60 END))#22,17,2) AS mon_sales#62, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#59 = Tuesday  ) THEN ss_sales_price#60 END))#23,17,2) AS tue_sales#63, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#59 = Wednesday) THEN ss_sales_price#60 END))#24,17,2) AS wed_sales#64, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#59 = Thursday ) THEN ss_sales_price#60 END))#25,17,2) AS thu_sales#65, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#59 = Friday   ) THEN ss_sales_price#60 END))#26,17,2) AS fri_sales#66, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#59 = Saturday ) THEN ss_sales_price#60 END))#27,17,2) AS sat_sales#67]
 
 (28) Scan parquet spark_catalog.default.store
-Output [2]: [s_store_sk#57, s_store_id#58]
+Output [2]: [s_store_sk#68, s_store_id#69]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store]
 PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_id)]
 ReadSchema: struct<s_store_sk:int,s_store_id:string>
 
 (29) ColumnarToRow [codegen id : 7]
-Input [2]: [s_store_sk#57, s_store_id#58]
+Input [2]: [s_store_sk#68, s_store_id#69]
 
 (30) Filter [codegen id : 7]
-Input [2]: [s_store_sk#57, s_store_id#58]
-Condition : (isnotnull(s_store_sk#57) AND isnotnull(s_store_id#58))
+Input [2]: [s_store_sk#68, s_store_id#69]
+Condition : (isnotnull(s_store_sk#68) AND isnotnull(s_store_id#69))
 
 (31) BroadcastExchange
-Input [2]: [s_store_sk#57, s_store_id#58]
+Input [2]: [s_store_sk#68, s_store_id#69]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5]
 
 (32) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_store_sk#1]
-Right keys [1]: [s_store_sk#57]
+Left keys [1]: [ss_store_sk#51]
+Right keys [1]: [s_store_sk#68]
 Join type: Inner
 Join condition: None
 
 (33) Project [codegen id : 9]
-Output [9]: [d_week_seq#5, sun_sales#28, mon_sales#29, tue_sales#30, wed_sales#31, thu_sales#32, fri_sales#33, sat_sales#34, s_store_id#58]
-Input [11]: [d_week_seq#5, ss_store_sk#1, sun_sales#28, mon_sales#29, tue_sales#30, wed_sales#31, thu_sales#32, fri_sales#33, sat_sales#34, s_store_sk#57, s_store_id#58]
+Output [9]: [d_week_seq#50, sun_sales#61, mon_sales#62, tue_sales#63, wed_sales#64, thu_sales#65, fri_sales#66, sat_sales#67, s_store_id#69]
+Input [11]: [d_week_seq#50, ss_store_sk#51, sun_sales#61, mon_sales#62, tue_sales#63, wed_sales#64, thu_sales#65, fri_sales#66, sat_sales#67, s_store_sk#68, s_store_id#69]
 
 (34) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_month_seq#59, d_week_seq#60]
+Output [2]: [d_month_seq#70, d_week_seq#71]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1224), LessThanOrEqual(d_month_seq,1235), IsNotNull(d_week_seq)]
 ReadSchema: struct<d_month_seq:int,d_week_seq:int>
 
 (35) ColumnarToRow [codegen id : 8]
-Input [2]: [d_month_seq#59, d_week_seq#60]
+Input [2]: [d_month_seq#70, d_week_seq#71]
 
 (36) Filter [codegen id : 8]
-Input [2]: [d_month_seq#59, d_week_seq#60]
-Condition : (((isnotnull(d_month_seq#59) AND (d_month_seq#59 >= 1224)) AND (d_month_seq#59 <= 1235)) AND isnotnull(d_week_seq#60))
+Input [2]: [d_month_seq#70, d_week_seq#71]
+Condition : (((isnotnull(d_month_seq#70) AND (d_month_seq#70 >= 1224)) AND (d_month_seq#70 <= 1235)) AND isnotnull(d_week_seq#71))
 
 (37) Project [codegen id : 8]
-Output [1]: [d_week_seq#60]
-Input [2]: [d_month_seq#59, d_week_seq#60]
+Output [1]: [d_week_seq#71]
+Input [2]: [d_month_seq#70, d_week_seq#71]
 
 (38) BroadcastExchange
-Input [1]: [d_week_seq#60]
+Input [1]: [d_week_seq#71]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6]
 
 (39) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [d_week_seq#5]
-Right keys [1]: [d_week_seq#60]
+Left keys [1]: [d_week_seq#50]
+Right keys [1]: [d_week_seq#71]
 Join type: Inner
 Join condition: None
 
 (40) Project [codegen id : 9]
-Output [9]: [d_week_seq#5 AS d_week_seq2#61, s_store_id#58 AS s_store_id2#62, sun_sales#28 AS sun_sales2#63, mon_sales#29 AS mon_sales2#64, tue_sales#30 AS tue_sales2#65, wed_sales#31 AS wed_sales2#66, thu_sales#32 AS thu_sales2#67, fri_sales#33 AS fri_sales2#68, sat_sales#34 AS sat_sales2#69]
-Input [10]: [d_week_seq#5, sun_sales#28, mon_sales#29, tue_sales#30, wed_sales#31, thu_sales#32, fri_sales#33, sat_sales#34, s_store_id#58, d_week_seq#60]
+Output [9]: [d_week_seq#50 AS d_week_seq2#72, s_store_id#69 AS s_store_id2#73, sun_sales#61 AS sun_sales2#74, mon_sales#62 AS mon_sales2#75, tue_sales#63 AS tue_sales2#76, wed_sales#64 AS wed_sales2#77, thu_sales#65 AS thu_sales2#78, fri_sales#66 AS fri_sales2#79, sat_sales#67 AS sat_sales2#80]
+Input [10]: [d_week_seq#50, sun_sales#61, mon_sales#62, tue_sales#63, wed_sales#64, thu_sales#65, fri_sales#66, sat_sales#67, s_store_id#69, d_week_seq#71]
 
 (41) BroadcastExchange
-Input [9]: [d_week_seq2#61, s_store_id2#62, sun_sales2#63, mon_sales2#64, tue_sales2#65, wed_sales2#66, thu_sales2#67, fri_sales2#68, sat_sales2#69]
+Input [9]: [d_week_seq2#72, s_store_id2#73, sun_sales2#74, mon_sales2#75, tue_sales2#76, wed_sales2#77, thu_sales2#78, fri_sales2#79, sat_sales2#80]
 Arguments: HashedRelationBroadcastMode(List(input[1, string, true], (input[0, int, true] - 52)),false), [plan_id=7]
 
 (42) BroadcastHashJoin [codegen id : 10]
 Left keys [2]: [s_store_id1#42, d_week_seq1#41]
-Right keys [2]: [s_store_id2#62, (d_week_seq2#61 - 52)]
+Right keys [2]: [s_store_id2#73, (d_week_seq2#72 - 52)]
 Join type: Inner
 Join condition: None
 
 (43) Project [codegen id : 10]
-Output [10]: [s_store_name1#40, s_store_id1#42, d_week_seq1#41, (sun_sales1#43 / sun_sales2#63) AS (sun_sales1 / sun_sales2)#70, (mon_sales1#44 / mon_sales2#64) AS (mon_sales1 / mon_sales2)#71, (tue_sales1#45 / tue_sales2#65) AS (tue_sales1 / tue_sales2)#72, (wed_sales1#46 / wed_sales2#66) AS (wed_sales1 / wed_sales2)#73, (thu_sales1#47 / thu_sales2#67) AS (thu_sales1 / thu_sales2)#74, (fri_sales1#48 / fri_sales2#68) AS (fri_sales1 / fri_sales2)#75, (sat_sales1#49 / sat_sales2#69) AS (sat_sales1 / sat_sales2)#76]
-Input [19]: [s_store_name1#40, d_week_seq1#41, s_store_id1#42, sun_sales1#43, mon_sales1#44, tue_sales1#45, wed_sales1#46, thu_sales1#47, fri_sales1#48, sat_sales1#49, d_week_seq2#61, s_store_id2#62, sun_sales2#63, mon_sales2#64, tue_sales2#65, wed_sales2#66, thu_sales2#67, fri_sales2#68, sat_sales2#69]
+Output [10]: [s_store_name1#40, s_store_id1#42, d_week_seq1#41, (sun_sales1#43 / sun_sales2#74) AS (sun_sales1 / sun_sales2)#81, (mon_sales1#44 / mon_sales2#75) AS (mon_sales1 / mon_sales2)#82, (tue_sales1#45 / tue_sales2#76) AS (tue_sales1 / tue_sales2)#83, (wed_sales1#46 / wed_sales2#77) AS (wed_sales1 / wed_sales2)#84, (thu_sales1#47 / thu_sales2#78) AS (thu_sales1 / thu_sales2)#85, (fri_sales1#48 / fri_sales2#79) AS (fri_sales1 / fri_sales2)#86, (sat_sales1#49 / sat_sales2#80) AS (sat_sales1 / sat_sales2)#87]
+Input [19]: [s_store_name1#40, d_week_seq1#41, s_store_id1#42, sun_sales1#43, mon_sales1#44, tue_sales1#45, wed_sales1#46, thu_sales1#47, fri_sales1#48, sat_sales1#49, d_week_seq2#72, s_store_id2#73, sun_sales2#74, mon_sales2#75, tue_sales2#76, wed_sales2#77, thu_sales2#78, fri_sales2#79, sat_sales2#80]
 
 (44) TakeOrderedAndProject
-Input [10]: [s_store_name1#40, s_store_id1#42, d_week_seq1#41, (sun_sales1 / sun_sales2)#70, (mon_sales1 / mon_sales2)#71, (tue_sales1 / tue_sales2)#72, (wed_sales1 / wed_sales2)#73, (thu_sales1 / thu_sales2)#74, (fri_sales1 / fri_sales2)#75, (sat_sales1 / sat_sales2)#76]
-Arguments: 100, [s_store_name1#40 ASC NULLS FIRST, s_store_id1#42 ASC NULLS FIRST, d_week_seq1#41 ASC NULLS FIRST], [s_store_name1#40, s_store_id1#42, d_week_seq1#41, (sun_sales1 / sun_sales2)#70, (mon_sales1 / mon_sales2)#71, (tue_sales1 / tue_sales2)#72, (wed_sales1 / wed_sales2)#73, (thu_sales1 / thu_sales2)#74, (fri_sales1 / fri_sales2)#75, (sat_sales1 / sat_sales2)#76]
+Input [10]: [s_store_name1#40, s_store_id1#42, d_week_seq1#41, (sun_sales1 / sun_sales2)#81, (mon_sales1 / mon_sales2)#82, (tue_sales1 / tue_sales2)#83, (wed_sales1 / wed_sales2)#84, (thu_sales1 / thu_sales2)#85, (fri_sales1 / fri_sales2)#86, (sat_sales1 / sat_sales2)#87]
+Arguments: 100, [s_store_name1#40 ASC NULLS FIRST, s_store_id1#42 ASC NULLS FIRST, d_week_seq1#41 ASC NULLS FIRST], [s_store_name1#40, s_store_id1#42, d_week_seq1#41, (sun_sales1 / sun_sales2)#81, (mon_sales1 / mon_sales2)#82, (tue_sales1 / tue_sales2)#83, (wed_sales1 / wed_sales2)#84, (thu_sales1 / thu_sales2)#85, (fri_sales1 / fri_sales2)#86, (sat_sales1 / sat_sales2)#87]
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81.sf100/explain.txt
index 6c717a713d5..28ea67208f6 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81.sf100/explain.txt
@@ -217,111 +217,111 @@ Output [17]: [c_customer_id#2, c_salutation#4, c_first_name#5, c_last_name#6, ca
 Input [19]: [c_customer_sk#1, c_customer_id#2, c_salutation#4, c_first_name#5, c_last_name#6, ca_street_number#8, ca_street_name#9, ca_street_type#10, ca_suite_number#11, ca_city#12, ca_county#13, ca_state#14, ca_zip#15, ca_country#16, ca_gmt_offset#17, ca_location_type#18, ctr_customer_sk#30, ctr_state#31, ctr_total_return#32]
 
 (35) Scan parquet spark_catalog.default.catalog_returns
-Output [4]: [cr_returning_customer_sk#19, cr_returning_addr_sk#20, cr_return_amt_inc_tax#21, cr_returned_date_sk#22]
+Output [4]: [cr_returning_customer_sk#33, cr_returning_addr_sk#34, cr_return_amt_inc_tax#35, cr_returned_date_sk#36]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cr_returned_date_sk#22), dynamicpruningexpression(cr_returned_date_sk#22 IN dynamicpruning#23)]
+PartitionFilters: [isnotnull(cr_returned_date_sk#36), dynamicpruningexpression(cr_returned_date_sk#36 IN dynamicpruning#23)]
 PushedFilters: [IsNotNull(cr_returning_addr_sk)]
 ReadSchema: struct<cr_returning_customer_sk:int,cr_returning_addr_sk:int,cr_return_amt_inc_tax:decimal(7,2)>
 
 (36) ColumnarToRow [codegen id : 13]
-Input [4]: [cr_returning_customer_sk#19, cr_returning_addr_sk#20, cr_return_amt_inc_tax#21, cr_returned_date_sk#22]
+Input [4]: [cr_returning_customer_sk#33, cr_returning_addr_sk#34, cr_return_amt_inc_tax#35, cr_returned_date_sk#36]
 
 (37) Filter [codegen id : 13]
-Input [4]: [cr_returning_customer_sk#19, cr_returning_addr_sk#20, cr_return_amt_inc_tax#21, cr_returned_date_sk#22]
-Condition : isnotnull(cr_returning_addr_sk#20)
+Input [4]: [cr_returning_customer_sk#33, cr_returning_addr_sk#34, cr_return_amt_inc_tax#35, cr_returned_date_sk#36]
+Condition : isnotnull(cr_returning_addr_sk#34)
 
 (38) ReusedExchange [Reuses operator id: 62]
-Output [1]: [d_date_sk#24]
+Output [1]: [d_date_sk#37]
 
 (39) BroadcastHashJoin [codegen id : 13]
-Left keys [1]: [cr_returned_date_sk#22]
-Right keys [1]: [d_date_sk#24]
+Left keys [1]: [cr_returned_date_sk#36]
+Right keys [1]: [d_date_sk#37]
 Join type: Inner
 Join condition: None
 
 (40) Project [codegen id : 13]
-Output [3]: [cr_returning_customer_sk#19, cr_returning_addr_sk#20, cr_return_amt_inc_tax#21]
-Input [5]: [cr_returning_customer_sk#19, cr_returning_addr_sk#20, cr_return_amt_inc_tax#21, cr_returned_date_sk#22, d_date_sk#24]
+Output [3]: [cr_returning_customer_sk#33, cr_returning_addr_sk#34, cr_return_amt_inc_tax#35]
+Input [5]: [cr_returning_customer_sk#33, cr_returning_addr_sk#34, cr_return_amt_inc_tax#35, cr_returned_date_sk#36, d_date_sk#37]
 
 (41) Exchange
-Input [3]: [cr_returning_customer_sk#19, cr_returning_addr_sk#20, cr_return_amt_inc_tax#21]
-Arguments: hashpartitioning(cr_returning_addr_sk#20, 5), ENSURE_REQUIREMENTS, [plan_id=7]
+Input [3]: [cr_returning_customer_sk#33, cr_returning_addr_sk#34, cr_return_amt_inc_tax#35]
+Arguments: hashpartitioning(cr_returning_addr_sk#34, 5), ENSURE_REQUIREMENTS, [plan_id=7]
 
 (42) Sort [codegen id : 14]
-Input [3]: [cr_returning_customer_sk#19, cr_returning_addr_sk#20, cr_return_amt_inc_tax#21]
-Arguments: [cr_returning_addr_sk#20 ASC NULLS FIRST], false, 0
+Input [3]: [cr_returning_customer_sk#33, cr_returning_addr_sk#34, cr_return_amt_inc_tax#35]
+Arguments: [cr_returning_addr_sk#34 ASC NULLS FIRST], false, 0
 
 (43) ReusedExchange [Reuses operator id: 23]
-Output [2]: [ca_address_sk#25, ca_state#26]
+Output [2]: [ca_address_sk#38, ca_state#39]
 
 (44) Sort [codegen id : 16]
-Input [2]: [ca_address_sk#25, ca_state#26]
-Arguments: [ca_address_sk#25 ASC NULLS FIRST], false, 0
+Input [2]: [ca_address_sk#38, ca_state#39]
+Arguments: [ca_address_sk#38 ASC NULLS FIRST], false, 0
 
 (45) SortMergeJoin [codegen id : 17]
-Left keys [1]: [cr_returning_addr_sk#20]
-Right keys [1]: [ca_address_sk#25]
+Left keys [1]: [cr_returning_addr_sk#34]
+Right keys [1]: [ca_address_sk#38]
 Join type: Inner
 Join condition: None
 
 (46) Project [codegen id : 17]
-Output [3]: [cr_returning_customer_sk#19, cr_return_amt_inc_tax#21, ca_state#26]
-Input [5]: [cr_returning_customer_sk#19, cr_returning_addr_sk#20, cr_return_amt_inc_tax#21, ca_address_sk#25, ca_state#26]
+Output [3]: [cr_returning_customer_sk#33, cr_return_amt_inc_tax#35, ca_state#39]
+Input [5]: [cr_returning_customer_sk#33, cr_returning_addr_sk#34, cr_return_amt_inc_tax#35, ca_address_sk#38, ca_state#39]
 
 (47) HashAggregate [codegen id : 17]
-Input [3]: [cr_returning_customer_sk#19, cr_return_amt_inc_tax#21, ca_state#26]
-Keys [2]: [cr_returning_customer_sk#19, ca_state#26]
-Functions [1]: [partial_sum(UnscaledValue(cr_return_amt_inc_tax#21))]
-Aggregate Attributes [1]: [sum#33]
-Results [3]: [cr_returning_customer_sk#19, ca_state#26, sum#34]
+Input [3]: [cr_returning_customer_sk#33, cr_return_amt_inc_tax#35, ca_state#39]
+Keys [2]: [cr_returning_customer_sk#33, ca_state#39]
+Functions [1]: [partial_sum(UnscaledValue(cr_return_amt_inc_tax#35))]
+Aggregate Attributes [1]: [sum#40]
+Results [3]: [cr_returning_customer_sk#33, ca_state#39, sum#41]
 
 (48) Exchange
-Input [3]: [cr_returning_customer_sk#19, ca_state#26, sum#34]
-Arguments: hashpartitioning(cr_returning_customer_sk#19, ca_state#26, 5), ENSURE_REQUIREMENTS, [plan_id=8]
+Input [3]: [cr_returning_customer_sk#33, ca_state#39, sum#41]
+Arguments: hashpartitioning(cr_returning_customer_sk#33, ca_state#39, 5), ENSURE_REQUIREMENTS, [plan_id=8]
 
 (49) HashAggregate [codegen id : 18]
-Input [3]: [cr_returning_customer_sk#19, ca_state#26, sum#34]
-Keys [2]: [cr_returning_customer_sk#19, ca_state#26]
-Functions [1]: [sum(UnscaledValue(cr_return_amt_inc_tax#21))]
-Aggregate Attributes [1]: [sum(UnscaledValue(cr_return_amt_inc_tax#21))#29]
-Results [2]: [ca_state#26 AS ctr_state#31, MakeDecimal(sum(UnscaledValue(cr_return_amt_inc_tax#21))#29,17,2) AS ctr_total_return#32]
+Input [3]: [cr_returning_customer_sk#33, ca_state#39, sum#41]
+Keys [2]: [cr_returning_customer_sk#33, ca_state#39]
+Functions [1]: [sum(UnscaledValue(cr_return_amt_inc_tax#35))]
+Aggregate Attributes [1]: [sum(UnscaledValue(cr_return_amt_inc_tax#35))#29]
+Results [2]: [ca_state#39 AS ctr_state#42, MakeDecimal(sum(UnscaledValue(cr_return_amt_inc_tax#35))#29,17,2) AS ctr_total_return#43]
 
 (50) HashAggregate [codegen id : 18]
-Input [2]: [ctr_state#31, ctr_total_return#32]
-Keys [1]: [ctr_state#31]
-Functions [1]: [partial_avg(ctr_total_return#32)]
-Aggregate Attributes [2]: [sum#35, count#36]
-Results [3]: [ctr_state#31, sum#37, count#38]
+Input [2]: [ctr_state#42, ctr_total_return#43]
+Keys [1]: [ctr_state#42]
+Functions [1]: [partial_avg(ctr_total_return#43)]
+Aggregate Attributes [2]: [sum#44, count#45]
+Results [3]: [ctr_state#42, sum#46, count#47]
 
 (51) Exchange
-Input [3]: [ctr_state#31, sum#37, count#38]
-Arguments: hashpartitioning(ctr_state#31, 5), ENSURE_REQUIREMENTS, [plan_id=9]
+Input [3]: [ctr_state#42, sum#46, count#47]
+Arguments: hashpartitioning(ctr_state#42, 5), ENSURE_REQUIREMENTS, [plan_id=9]
 
 (52) HashAggregate [codegen id : 19]
-Input [3]: [ctr_state#31, sum#37, count#38]
-Keys [1]: [ctr_state#31]
-Functions [1]: [avg(ctr_total_return#32)]
-Aggregate Attributes [1]: [avg(ctr_total_return#32)#39]
-Results [2]: [(avg(ctr_total_return#32)#39 * 1.2) AS (avg(ctr_total_return) * 1.2)#40, ctr_state#31 AS ctr_state#31#41]
+Input [3]: [ctr_state#42, sum#46, count#47]
+Keys [1]: [ctr_state#42]
+Functions [1]: [avg(ctr_total_return#43)]
+Aggregate Attributes [1]: [avg(ctr_total_return#43)#48]
+Results [2]: [(avg(ctr_total_return#43)#48 * 1.2) AS (avg(ctr_total_return) * 1.2)#49, ctr_state#42]
 
 (53) Filter [codegen id : 19]
-Input [2]: [(avg(ctr_total_return) * 1.2)#40, ctr_state#31#41]
-Condition : isnotnull((avg(ctr_total_return) * 1.2)#40)
+Input [2]: [(avg(ctr_total_return) * 1.2)#49, ctr_state#42]
+Condition : isnotnull((avg(ctr_total_return) * 1.2)#49)
 
 (54) BroadcastExchange
-Input [2]: [(avg(ctr_total_return) * 1.2)#40, ctr_state#31#41]
+Input [2]: [(avg(ctr_total_return) * 1.2)#49, ctr_state#42]
 Arguments: HashedRelationBroadcastMode(List(input[1, string, true]),false), [plan_id=10]
 
 (55) BroadcastHashJoin [codegen id : 20]
 Left keys [1]: [ctr_state#31]
-Right keys [1]: [ctr_state#31#41]
+Right keys [1]: [ctr_state#42]
 Join type: Inner
-Join condition: (cast(ctr_total_return#32 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#40)
+Join condition: (cast(ctr_total_return#32 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#49)
 
 (56) Project [codegen id : 20]
 Output [16]: [c_customer_id#2, c_salutation#4, c_first_name#5, c_last_name#6, ca_street_number#8, ca_street_name#9, ca_street_type#10, ca_suite_number#11, ca_city#12, ca_county#13, ca_state#14, ca_zip#15, ca_country#16, ca_gmt_offset#17, ca_location_type#18, ctr_total_return#32]
-Input [19]: [c_customer_id#2, c_salutation#4, c_first_name#5, c_last_name#6, ca_street_number#8, ca_street_name#9, ca_street_type#10, ca_suite_number#11, ca_city#12, ca_county#13, ca_state#14, ca_zip#15, ca_country#16, ca_gmt_offset#17, ca_location_type#18, ctr_state#31, ctr_total_return#32, (avg(ctr_total_return) * 1.2)#40, ctr_state#31#41]
+Input [19]: [c_customer_id#2, c_salutation#4, c_first_name#5, c_last_name#6, ca_street_number#8, ca_street_name#9, ca_street_type#10, ca_suite_number#11, ca_city#12, ca_county#13, ca_state#14, ca_zip#15, ca_country#16, ca_gmt_offset#17, ca_location_type#18, ctr_state#31, ctr_total_return#32, (avg(ctr_total_return) * 1.2)#49, ctr_state#42]
 
 (57) TakeOrderedAndProject
 Input [16]: [c_customer_id#2, c_salutation#4, c_first_name#5, c_last_name#6, ca_street_number#8, ca_street_name#9, ca_street_type#10, ca_suite_number#11, ca_city#12, ca_county#13, ca_state#14, ca_zip#15, ca_country#16, ca_gmt_offset#17, ca_location_type#18, ctr_total_return#32]
@@ -338,27 +338,27 @@ BroadcastExchange (62)
 
 
 (58) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#24, d_year#42]
+Output [2]: [d_date_sk#24, d_year#50]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (59) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#24, d_year#42]
+Input [2]: [d_date_sk#24, d_year#50]
 
 (60) Filter [codegen id : 1]
-Input [2]: [d_date_sk#24, d_year#42]
-Condition : ((isnotnull(d_year#42) AND (d_year#42 = 2000)) AND isnotnull(d_date_sk#24))
+Input [2]: [d_date_sk#24, d_year#50]
+Condition : ((isnotnull(d_year#50) AND (d_year#50 = 2000)) AND isnotnull(d_date_sk#24))
 
 (61) Project [codegen id : 1]
 Output [1]: [d_date_sk#24]
-Input [2]: [d_date_sk#24, d_year#42]
+Input [2]: [d_date_sk#24, d_year#50]
 
 (62) BroadcastExchange
 Input [1]: [d_date_sk#24]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=11]
 
-Subquery:2 Hosting operator id = 35 Hosting Expression = cr_returned_date_sk#22 IN dynamicpruning#23
+Subquery:2 Hosting operator id = 35 Hosting Expression = cr_returned_date_sk#36 IN dynamicpruning#23
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81.sf100/simplified.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81.sf100/simplified.txt
index 79263c95749..7c379077046 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81.sf100/simplified.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81.sf100/simplified.txt
@@ -73,7 +73,7 @@ TakeOrderedAndProject [c_customer_id,c_salutation,c_first_name,c_last_name,ca_st
           BroadcastExchange #8
             WholeStageCodegen (19)
               Filter [(avg(ctr_total_return) * 1.2)]
-                HashAggregate [ctr_state,sum,count] [avg(ctr_total_return),(avg(ctr_total_return) * 1.2),ctr_state,sum,count]
+                HashAggregate [ctr_state,sum,count] [avg(ctr_total_return),(avg(ctr_total_return) * 1.2),sum,count]
                   InputAdapter
                     Exchange [ctr_state] #9
                       WholeStageCodegen (18)
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81/explain.txt
index edcc1114908..3b22a72e873 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81/explain.txt
@@ -128,159 +128,159 @@ Input [3]: [ctr_customer_sk#12, ctr_state#13, ctr_total_return#14]
 Condition : isnotnull(ctr_total_return#14)
 
 (17) Scan parquet spark_catalog.default.catalog_returns
-Output [4]: [cr_returning_customer_sk#1, cr_returning_addr_sk#2, cr_return_amt_inc_tax#3, cr_returned_date_sk#4]
+Output [4]: [cr_returning_customer_sk#15, cr_returning_addr_sk#16, cr_return_amt_inc_tax#17, cr_returned_date_sk#18]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cr_returned_date_sk#4), dynamicpruningexpression(cr_returned_date_sk#4 IN dynamicpruning#5)]
+PartitionFilters: [isnotnull(cr_returned_date_sk#18), dynamicpruningexpression(cr_returned_date_sk#18 IN dynamicpruning#5)]
 PushedFilters: [IsNotNull(cr_returning_addr_sk)]
 ReadSchema: struct<cr_returning_customer_sk:int,cr_returning_addr_sk:int,cr_return_amt_inc_tax:decimal(7,2)>
 
 (18) ColumnarToRow [codegen id : 6]
-Input [4]: [cr_returning_customer_sk#1, cr_returning_addr_sk#2, cr_return_amt_inc_tax#3, cr_returned_date_sk#4]
+Input [4]: [cr_returning_customer_sk#15, cr_returning_addr_sk#16, cr_return_amt_inc_tax#17, cr_returned_date_sk#18]
 
 (19) Filter [codegen id : 6]
-Input [4]: [cr_returning_customer_sk#1, cr_returning_addr_sk#2, cr_return_amt_inc_tax#3, cr_returned_date_sk#4]
-Condition : isnotnull(cr_returning_addr_sk#2)
+Input [4]: [cr_returning_customer_sk#15, cr_returning_addr_sk#16, cr_return_amt_inc_tax#17, cr_returned_date_sk#18]
+Condition : isnotnull(cr_returning_addr_sk#16)
 
 (20) ReusedExchange [Reuses operator id: 53]
-Output [1]: [d_date_sk#6]
+Output [1]: [d_date_sk#19]
 
 (21) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [cr_returned_date_sk#4]
-Right keys [1]: [d_date_sk#6]
+Left keys [1]: [cr_returned_date_sk#18]
+Right keys [1]: [d_date_sk#19]
 Join type: Inner
 Join condition: None
 
 (22) Project [codegen id : 6]
-Output [3]: [cr_returning_customer_sk#1, cr_returning_addr_sk#2, cr_return_amt_inc_tax#3]
-Input [5]: [cr_returning_customer_sk#1, cr_returning_addr_sk#2, cr_return_amt_inc_tax#3, cr_returned_date_sk#4, d_date_sk#6]
+Output [3]: [cr_returning_customer_sk#15, cr_returning_addr_sk#16, cr_return_amt_inc_tax#17]
+Input [5]: [cr_returning_customer_sk#15, cr_returning_addr_sk#16, cr_return_amt_inc_tax#17, cr_returned_date_sk#18, d_date_sk#19]
 
 (23) ReusedExchange [Reuses operator id: 10]
-Output [2]: [ca_address_sk#7, ca_state#8]
+Output [2]: [ca_address_sk#20, ca_state#21]
 
 (24) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [cr_returning_addr_sk#2]
-Right keys [1]: [ca_address_sk#7]
+Left keys [1]: [cr_returning_addr_sk#16]
+Right keys [1]: [ca_address_sk#20]
 Join type: Inner
 Join condition: None
 
 (25) Project [codegen id : 6]
-Output [3]: [cr_returning_customer_sk#1, cr_return_amt_inc_tax#3, ca_state#8]
-Input [5]: [cr_returning_customer_sk#1, cr_returning_addr_sk#2, cr_return_amt_inc_tax#3, ca_address_sk#7, ca_state#8]
+Output [3]: [cr_returning_customer_sk#15, cr_return_amt_inc_tax#17, ca_state#21]
+Input [5]: [cr_returning_customer_sk#15, cr_returning_addr_sk#16, cr_return_amt_inc_tax#17, ca_address_sk#20, ca_state#21]
 
 (26) HashAggregate [codegen id : 6]
-Input [3]: [cr_returning_customer_sk#1, cr_return_amt_inc_tax#3, ca_state#8]
-Keys [2]: [cr_returning_customer_sk#1, ca_state#8]
-Functions [1]: [partial_sum(UnscaledValue(cr_return_amt_inc_tax#3))]
-Aggregate Attributes [1]: [sum#15]
-Results [3]: [cr_returning_customer_sk#1, ca_state#8, sum#16]
+Input [3]: [cr_returning_customer_sk#15, cr_return_amt_inc_tax#17, ca_state#21]
+Keys [2]: [cr_returning_customer_sk#15, ca_state#21]
+Functions [1]: [partial_sum(UnscaledValue(cr_return_amt_inc_tax#17))]
+Aggregate Attributes [1]: [sum#22]
+Results [3]: [cr_returning_customer_sk#15, ca_state#21, sum#23]
 
 (27) Exchange
-Input [3]: [cr_returning_customer_sk#1, ca_state#8, sum#16]
-Arguments: hashpartitioning(cr_returning_customer_sk#1, ca_state#8, 5), ENSURE_REQUIREMENTS, [plan_id=3]
+Input [3]: [cr_returning_customer_sk#15, ca_state#21, sum#23]
+Arguments: hashpartitioning(cr_returning_customer_sk#15, ca_state#21, 5), ENSURE_REQUIREMENTS, [plan_id=3]
 
 (28) HashAggregate [codegen id : 7]
-Input [3]: [cr_returning_customer_sk#1, ca_state#8, sum#16]
-Keys [2]: [cr_returning_customer_sk#1, ca_state#8]
-Functions [1]: [sum(UnscaledValue(cr_return_amt_inc_tax#3))]
-Aggregate Attributes [1]: [sum(UnscaledValue(cr_return_amt_inc_tax#3))#11]
-Results [2]: [ca_state#8 AS ctr_state#13, MakeDecimal(sum(UnscaledValue(cr_return_amt_inc_tax#3))#11,17,2) AS ctr_total_return#14]
+Input [3]: [cr_returning_customer_sk#15, ca_state#21, sum#23]
+Keys [2]: [cr_returning_customer_sk#15, ca_state#21]
+Functions [1]: [sum(UnscaledValue(cr_return_amt_inc_tax#17))]
+Aggregate Attributes [1]: [sum(UnscaledValue(cr_return_amt_inc_tax#17))#11]
+Results [2]: [ca_state#21 AS ctr_state#24, MakeDecimal(sum(UnscaledValue(cr_return_amt_inc_tax#17))#11,17,2) AS ctr_total_return#25]
 
 (29) HashAggregate [codegen id : 7]
-Input [2]: [ctr_state#13, ctr_total_return#14]
-Keys [1]: [ctr_state#13]
-Functions [1]: [partial_avg(ctr_total_return#14)]
-Aggregate Attributes [2]: [sum#17, count#18]
-Results [3]: [ctr_state#13, sum#19, count#20]
+Input [2]: [ctr_state#24, ctr_total_return#25]
+Keys [1]: [ctr_state#24]
+Functions [1]: [partial_avg(ctr_total_return#25)]
+Aggregate Attributes [2]: [sum#26, count#27]
+Results [3]: [ctr_state#24, sum#28, count#29]
 
 (30) Exchange
-Input [3]: [ctr_state#13, sum#19, count#20]
-Arguments: hashpartitioning(ctr_state#13, 5), ENSURE_REQUIREMENTS, [plan_id=4]
+Input [3]: [ctr_state#24, sum#28, count#29]
+Arguments: hashpartitioning(ctr_state#24, 5), ENSURE_REQUIREMENTS, [plan_id=4]
 
 (31) HashAggregate [codegen id : 8]
-Input [3]: [ctr_state#13, sum#19, count#20]
-Keys [1]: [ctr_state#13]
-Functions [1]: [avg(ctr_total_return#14)]
-Aggregate Attributes [1]: [avg(ctr_total_return#14)#21]
-Results [2]: [(avg(ctr_total_return#14)#21 * 1.2) AS (avg(ctr_total_return) * 1.2)#22, ctr_state#13 AS ctr_state#13#23]
+Input [3]: [ctr_state#24, sum#28, count#29]
+Keys [1]: [ctr_state#24]
+Functions [1]: [avg(ctr_total_return#25)]
+Aggregate Attributes [1]: [avg(ctr_total_return#25)#30]
+Results [2]: [(avg(ctr_total_return#25)#30 * 1.2) AS (avg(ctr_total_return) * 1.2)#31, ctr_state#24]
 
 (32) Filter [codegen id : 8]
-Input [2]: [(avg(ctr_total_return) * 1.2)#22, ctr_state#13#23]
-Condition : isnotnull((avg(ctr_total_return) * 1.2)#22)
+Input [2]: [(avg(ctr_total_return) * 1.2)#31, ctr_state#24]
+Condition : isnotnull((avg(ctr_total_return) * 1.2)#31)
 
 (33) BroadcastExchange
-Input [2]: [(avg(ctr_total_return) * 1.2)#22, ctr_state#13#23]
+Input [2]: [(avg(ctr_total_return) * 1.2)#31, ctr_state#24]
 Arguments: HashedRelationBroadcastMode(List(input[1, string, true]),false), [plan_id=5]
 
 (34) BroadcastHashJoin [codegen id : 11]
 Left keys [1]: [ctr_state#13]
-Right keys [1]: [ctr_state#13#23]
+Right keys [1]: [ctr_state#24]
 Join type: Inner
-Join condition: (cast(ctr_total_return#14 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#22)
+Join condition: (cast(ctr_total_return#14 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#31)
 
 (35) Project [codegen id : 11]
 Output [2]: [ctr_customer_sk#12, ctr_total_return#14]
-Input [5]: [ctr_customer_sk#12, ctr_state#13, ctr_total_return#14, (avg(ctr_total_return) * 1.2)#22, ctr_state#13#23]
+Input [5]: [ctr_customer_sk#12, ctr_state#13, ctr_total_return#14, (avg(ctr_total_return) * 1.2)#31, ctr_state#24]
 
 (36) Scan parquet spark_catalog.default.customer
-Output [6]: [c_customer_sk#24, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29]
+Output [6]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer]
 PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_current_addr_sk)]
 ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_current_addr_sk:int,c_salutation:string,c_first_name:string,c_last_name:string>
 
 (37) ColumnarToRow [codegen id : 9]
-Input [6]: [c_customer_sk#24, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29]
+Input [6]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37]
 
 (38) Filter [codegen id : 9]
-Input [6]: [c_customer_sk#24, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29]
-Condition : (isnotnull(c_customer_sk#24) AND isnotnull(c_current_addr_sk#26))
+Input [6]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37]
+Condition : (isnotnull(c_customer_sk#32) AND isnotnull(c_current_addr_sk#34))
 
 (39) BroadcastExchange
-Input [6]: [c_customer_sk#24, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29]
+Input [6]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=6]
 
 (40) BroadcastHashJoin [codegen id : 11]
 Left keys [1]: [ctr_customer_sk#12]
-Right keys [1]: [c_customer_sk#24]
+Right keys [1]: [c_customer_sk#32]
 Join type: Inner
 Join condition: None
 
 (41) Project [codegen id : 11]
-Output [6]: [ctr_total_return#14, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29]
-Input [8]: [ctr_customer_sk#12, ctr_total_return#14, c_customer_sk#24, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29]
+Output [6]: [ctr_total_return#14, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37]
+Input [8]: [ctr_customer_sk#12, ctr_total_return#14, c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37]
 
 (42) Scan parquet spark_catalog.default.customer_address
-Output [12]: [ca_address_sk#30, ca_street_number#31, ca_street_name#32, ca_street_type#33, ca_suite_number#34, ca_city#35, ca_county#36, ca_state#37, ca_zip#38, ca_country#39, ca_gmt_offset#40, ca_location_type#41]
+Output [12]: [ca_address_sk#38, ca_street_number#39, ca_street_name#40, ca_street_type#41, ca_suite_number#42, ca_city#43, ca_county#44, ca_state#45, ca_zip#46, ca_country#47, ca_gmt_offset#48, ca_location_type#49]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [IsNotNull(ca_state), EqualTo(ca_state,GA), IsNotNull(ca_address_sk)]
 ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_street_type:string,ca_suite_number:string,ca_city:string,ca_county:string,ca_state:string,ca_zip:string,ca_country:string,ca_gmt_offset:decimal(5,2),ca_location_type:string>
 
 (43) ColumnarToRow [codegen id : 10]
-Input [12]: [ca_address_sk#30, ca_street_number#31, ca_street_name#32, ca_street_type#33, ca_suite_number#34, ca_city#35, ca_county#36, ca_state#37, ca_zip#38, ca_country#39, ca_gmt_offset#40, ca_location_type#41]
+Input [12]: [ca_address_sk#38, ca_street_number#39, ca_street_name#40, ca_street_type#41, ca_suite_number#42, ca_city#43, ca_county#44, ca_state#45, ca_zip#46, ca_country#47, ca_gmt_offset#48, ca_location_type#49]
 
 (44) Filter [codegen id : 10]
-Input [12]: [ca_address_sk#30, ca_street_number#31, ca_street_name#32, ca_street_type#33, ca_suite_number#34, ca_city#35, ca_county#36, ca_state#37, ca_zip#38, ca_country#39, ca_gmt_offset#40, ca_location_type#41]
-Condition : ((isnotnull(ca_state#37) AND (ca_state#37 = GA)) AND isnotnull(ca_address_sk#30))
+Input [12]: [ca_address_sk#38, ca_street_number#39, ca_street_name#40, ca_street_type#41, ca_suite_number#42, ca_city#43, ca_county#44, ca_state#45, ca_zip#46, ca_country#47, ca_gmt_offset#48, ca_location_type#49]
+Condition : ((isnotnull(ca_state#45) AND (ca_state#45 = GA)) AND isnotnull(ca_address_sk#38))
 
 (45) BroadcastExchange
-Input [12]: [ca_address_sk#30, ca_street_number#31, ca_street_name#32, ca_street_type#33, ca_suite_number#34, ca_city#35, ca_county#36, ca_state#37, ca_zip#38, ca_country#39, ca_gmt_offset#40, ca_location_type#41]
+Input [12]: [ca_address_sk#38, ca_street_number#39, ca_street_name#40, ca_street_type#41, ca_suite_number#42, ca_city#43, ca_county#44, ca_state#45, ca_zip#46, ca_country#47, ca_gmt_offset#48, ca_location_type#49]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7]
 
 (46) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [c_current_addr_sk#26]
-Right keys [1]: [ca_address_sk#30]
+Left keys [1]: [c_current_addr_sk#34]
+Right keys [1]: [ca_address_sk#38]
 Join type: Inner
 Join condition: None
 
 (47) Project [codegen id : 11]
-Output [16]: [c_customer_id#25, c_salutation#27, c_first_name#28, c_last_name#29, ca_street_number#31, ca_street_name#32, ca_street_type#33, ca_suite_number#34, ca_city#35, ca_county#36, ca_state#37, ca_zip#38, ca_country#39, ca_gmt_offset#40, ca_location_type#41, ctr_total_return#14]
-Input [18]: [ctr_total_return#14, c_customer_id#25, c_current_addr_sk#26, c_salutation#27, c_first_name#28, c_last_name#29, ca_address_sk#30, ca_street_number#31, ca_street_name#32, ca_street_type#33, ca_suite_number#34, ca_city#35, ca_county#36, ca_state#37, ca_zip#38, ca_country#39, ca_gmt_offset#40, ca_location_type#41]
+Output [16]: [c_customer_id#33, c_salutation#35, c_first_name#36, c_last_name#37, ca_street_number#39, ca_street_name#40, ca_street_type#41, ca_suite_number#42, ca_city#43, ca_county#44, ca_state#45, ca_zip#46, ca_country#47, ca_gmt_offset#48, ca_location_type#49, ctr_total_return#14]
+Input [18]: [ctr_total_return#14, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, ca_address_sk#38, ca_street_number#39, ca_street_name#40, ca_street_type#41, ca_suite_number#42, ca_city#43, ca_county#44, ca_state#45, ca_zip#46, ca_country#47, ca_gmt_offset#48, ca_location_type#49]
 
 (48) TakeOrderedAndProject
-Input [16]: [c_customer_id#25, c_salutation#27, c_first_name#28, c_last_name#29, ca_street_number#31, ca_street_name#32, ca_street_type#33, ca_suite_number#34, ca_city#35, ca_county#36, ca_state#37, ca_zip#38, ca_country#39, ca_gmt_offset#40, ca_location_type#41, ctr_total_return#14]
-Arguments: 100, [c_customer_id#25 ASC NULLS FIRST, c_salutation#27 ASC NULLS FIRST, c_first_name#28 ASC NULLS FIRST, c_last_name#29 ASC NULLS FIRST, ca_street_number#31 ASC NULLS FIRST, ca_street_name#32 ASC NULLS FIRST, ca_street_type#33 ASC NULLS FIRST, ca_suite_number#34 ASC NULLS FIRST, ca_city#35 ASC NULLS FIRST, ca_county#36 ASC NULLS FIRST, ca_state#37 ASC NULLS FIRST, ca_zip#38 ASC NULLS FIRST, ca_country#39 ASC NULLS FIRST, ca_gmt_offset#40 ASC NULLS FIRST, ca_location_type#41 ASC NULLS FIRST, ctr_total_return#14 ASC NULLS FIRST], [c_customer_id#25, c_salutation#27, c_first_name#28, c_last_name#29, ca_street_number#31, ca_street_name#32, ca_street_type#33, ca_suite_number#34, ca_city#35, ca_county#36, ca_state#37, ca_zip#38, ca_country#39, ca_gmt_offset#40, ca_location_type#41, ctr_total_return#14]
+Input [16]: [c_customer_id#33, c_salutation#35, c_first_name#36, c_last_name#37, ca_street_number#39, ca_street_name#40, ca_street_type#41, ca_suite_number#42, ca_city#43, ca_county#44, ca_state#45, ca_zip#46, ca_country#47, ca_gmt_offset#48, ca_location_type#49, ctr_total_return#14]
+Arguments: 100, [c_customer_id#33 ASC NULLS FIRST, c_salutation#35 ASC NULLS FIRST, c_first_name#36 ASC NULLS FIRST, c_last_name#37 ASC NULLS FIRST, ca_street_number#39 ASC NULLS FIRST, ca_street_name#40 ASC NULLS FIRST, ca_street_type#41 ASC NULLS FIRST, ca_suite_number#42 ASC NULLS FIRST, ca_city#43 ASC NULLS FIRST, ca_county#44 ASC NULLS FIRST, ca_state#45 ASC NULLS FIRST, ca_zip#46 ASC NULLS FIRST, ca_country#47 ASC NULLS FIRST, ca_gmt_offset#48 ASC NULLS FIRST, ca_location_type#49 ASC NULLS FIRST, ctr_total_return#14 ASC NULLS FIRST], [c_customer_id#33, c_salutation#35, c_first_name#36, c_last_name#37, ca_street_number#39, ca_street_name#40, ca_street_type#41, ca_suite_number#42, ca_city#43, ca_county#44, ca_state#45, ca_zip#46, ca_country#47, ca_gmt_offset#48, ca_location_type#49, ctr_total_return#14]
 
 ===== Subqueries =====
 
@@ -293,27 +293,27 @@ BroadcastExchange (53)
 
 
 (49) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#6, d_year#42]
+Output [2]: [d_date_sk#6, d_year#50]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (50) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#6, d_year#42]
+Input [2]: [d_date_sk#6, d_year#50]
 
 (51) Filter [codegen id : 1]
-Input [2]: [d_date_sk#6, d_year#42]
-Condition : ((isnotnull(d_year#42) AND (d_year#42 = 2000)) AND isnotnull(d_date_sk#6))
+Input [2]: [d_date_sk#6, d_year#50]
+Condition : ((isnotnull(d_year#50) AND (d_year#50 = 2000)) AND isnotnull(d_date_sk#6))
 
 (52) Project [codegen id : 1]
 Output [1]: [d_date_sk#6]
-Input [2]: [d_date_sk#6, d_year#42]
+Input [2]: [d_date_sk#6, d_year#50]
 
 (53) BroadcastExchange
 Input [1]: [d_date_sk#6]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=8]
 
-Subquery:2 Hosting operator id = 17 Hosting Expression = cr_returned_date_sk#4 IN dynamicpruning#5
+Subquery:2 Hosting operator id = 17 Hosting Expression = cr_returned_date_sk#18 IN dynamicpruning#5
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81/simplified.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81/simplified.txt
index fad5dde428e..844831965b7 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81/simplified.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q81/simplified.txt
@@ -41,7 +41,7 @@ TakeOrderedAndProject [c_customer_id,c_salutation,c_first_name,c_last_name,ca_st
                   BroadcastExchange #4
                     WholeStageCodegen (8)
                       Filter [(avg(ctr_total_return) * 1.2)]
-                        HashAggregate [ctr_state,sum,count] [avg(ctr_total_return),(avg(ctr_total_return) * 1.2),ctr_state,sum,count]
+                        HashAggregate [ctr_state,sum,count] [avg(ctr_total_return),(avg(ctr_total_return) * 1.2),sum,count]
                           InputAdapter
                             Exchange [ctr_state] #5
                               WholeStageCodegen (7)
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q95.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q95.sf100/explain.txt
index d6cf257b8b5..ad3cbcf223b 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q95.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q95.sf100/explain.txt
@@ -160,34 +160,34 @@ Input [1]: [wr_order_number#19]
 Arguments: [wr_order_number#19 ASC NULLS FIRST], false, 0
 
 (24) ReusedExchange [Reuses operator id: 11]
-Output [2]: [ws_warehouse_sk#14, ws_order_number#15]
+Output [2]: [ws_warehouse_sk#21, ws_order_number#22]
 
 (25) Sort [codegen id : 12]
-Input [2]: [ws_warehouse_sk#14, ws_order_number#15]
-Arguments: [ws_order_number#15 ASC NULLS FIRST], false, 0
+Input [2]: [ws_warehouse_sk#21, ws_order_number#22]
+Arguments: [ws_order_number#22 ASC NULLS FIRST], false, 0
 
 (26) SortMergeJoin [codegen id : 13]
 Left keys [1]: [wr_order_number#19]
-Right keys [1]: [ws_order_number#15]
+Right keys [1]: [ws_order_number#22]
 Join type: Inner
 Join condition: None
 
 (27) ReusedExchange [Reuses operator id: 11]
-Output [2]: [ws_warehouse_sk#17, ws_order_number#18]
+Output [2]: [ws_warehouse_sk#23, ws_order_number#24]
 
 (28) Sort [codegen id : 15]
-Input [2]: [ws_warehouse_sk#17, ws_order_number#18]
-Arguments: [ws_order_number#18 ASC NULLS FIRST], false, 0
+Input [2]: [ws_warehouse_sk#23, ws_order_number#24]
+Arguments: [ws_order_number#24 ASC NULLS FIRST], false, 0
 
 (29) SortMergeJoin [codegen id : 16]
-Left keys [1]: [ws_order_number#15]
-Right keys [1]: [ws_order_number#18]
+Left keys [1]: [ws_order_number#22]
+Right keys [1]: [ws_order_number#24]
 Join type: Inner
-Join condition: NOT (ws_warehouse_sk#14 = ws_warehouse_sk#17)
+Join condition: NOT (ws_warehouse_sk#21 = ws_warehouse_sk#23)
 
 (30) Project [codegen id : 16]
 Output [1]: [wr_order_number#19]
-Input [5]: [wr_order_number#19, ws_warehouse_sk#14, ws_order_number#15, ws_warehouse_sk#17, ws_order_number#18]
+Input [5]: [wr_order_number#19, ws_warehouse_sk#21, ws_order_number#22, ws_warehouse_sk#23, ws_order_number#24]
 
 (31) SortMergeJoin [codegen id : 20]
 Left keys [1]: [ws_order_number#4]
@@ -196,132 +196,132 @@ Join type: LeftSemi
 Join condition: None
 
 (32) Scan parquet spark_catalog.default.customer_address
-Output [2]: [ca_address_sk#21, ca_state#22]
+Output [2]: [ca_address_sk#25, ca_state#26]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [IsNotNull(ca_state), EqualTo(ca_state,IL), IsNotNull(ca_address_sk)]
 ReadSchema: struct<ca_address_sk:int,ca_state:string>
 
 (33) ColumnarToRow [codegen id : 17]
-Input [2]: [ca_address_sk#21, ca_state#22]
+Input [2]: [ca_address_sk#25, ca_state#26]
 
 (34) Filter [codegen id : 17]
-Input [2]: [ca_address_sk#21, ca_state#22]
-Condition : ((isnotnull(ca_state#22) AND (ca_state#22 = IL)) AND isnotnull(ca_address_sk#21))
+Input [2]: [ca_address_sk#25, ca_state#26]
+Condition : ((isnotnull(ca_state#26) AND (ca_state#26 = IL)) AND isnotnull(ca_address_sk#25))
 
 (35) Project [codegen id : 17]
-Output [1]: [ca_address_sk#21]
-Input [2]: [ca_address_sk#21, ca_state#22]
+Output [1]: [ca_address_sk#25]
+Input [2]: [ca_address_sk#25, ca_state#26]
 
 (36) BroadcastExchange
-Input [1]: [ca_address_sk#21]
+Input [1]: [ca_address_sk#25]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4]
 
 (37) BroadcastHashJoin [codegen id : 20]
 Left keys [1]: [ws_ship_addr_sk#2]
-Right keys [1]: [ca_address_sk#21]
+Right keys [1]: [ca_address_sk#25]
 Join type: Inner
 Join condition: None
 
 (38) Project [codegen id : 20]
 Output [5]: [ws_ship_date_sk#1, ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6]
-Input [7]: [ws_ship_date_sk#1, ws_ship_addr_sk#2, ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6, ca_address_sk#21]
+Input [7]: [ws_ship_date_sk#1, ws_ship_addr_sk#2, ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6, ca_address_sk#25]
 
 (39) Scan parquet spark_catalog.default.web_site
-Output [2]: [web_site_sk#23, web_company_name#24]
+Output [2]: [web_site_sk#27, web_company_name#28]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/web_site]
 PushedFilters: [IsNotNull(web_company_name), EqualTo(web_company_name,pri                                               ), IsNotNull(web_site_sk)]
 ReadSchema: struct<web_site_sk:int,web_company_name:string>
 
 (40) ColumnarToRow [codegen id : 18]
-Input [2]: [web_site_sk#23, web_company_name#24]
+Input [2]: [web_site_sk#27, web_company_name#28]
 
 (41) Filter [codegen id : 18]
-Input [2]: [web_site_sk#23, web_company_name#24]
-Condition : ((isnotnull(web_company_name#24) AND (web_company_name#24 = pri                                               )) AND isnotnull(web_site_sk#23))
+Input [2]: [web_site_sk#27, web_company_name#28]
+Condition : ((isnotnull(web_company_name#28) AND (web_company_name#28 = pri                                               )) AND isnotnull(web_site_sk#27))
 
 (42) Project [codegen id : 18]
-Output [1]: [web_site_sk#23]
-Input [2]: [web_site_sk#23, web_company_name#24]
+Output [1]: [web_site_sk#27]
+Input [2]: [web_site_sk#27, web_company_name#28]
 
 (43) BroadcastExchange
-Input [1]: [web_site_sk#23]
+Input [1]: [web_site_sk#27]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5]
 
 (44) BroadcastHashJoin [codegen id : 20]
 Left keys [1]: [ws_web_site_sk#3]
-Right keys [1]: [web_site_sk#23]
+Right keys [1]: [web_site_sk#27]
 Join type: Inner
 Join condition: None
 
 (45) Project [codegen id : 20]
 Output [4]: [ws_ship_date_sk#1, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6]
-Input [6]: [ws_ship_date_sk#1, ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6, web_site_sk#23]
+Input [6]: [ws_ship_date_sk#1, ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6, web_site_sk#27]
 
 (46) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#25, d_date#26]
+Output [2]: [d_date_sk#29, d_date#30]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,1999-02-01), LessThanOrEqual(d_date,1999-04-02), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date>
 
 (47) ColumnarToRow [codegen id : 19]
-Input [2]: [d_date_sk#25, d_date#26]
+Input [2]: [d_date_sk#29, d_date#30]
 
 (48) Filter [codegen id : 19]
-Input [2]: [d_date_sk#25, d_date#26]
-Condition : (((isnotnull(d_date#26) AND (d_date#26 >= 1999-02-01)) AND (d_date#26 <= 1999-04-02)) AND isnotnull(d_date_sk#25))
+Input [2]: [d_date_sk#29, d_date#30]
+Condition : (((isnotnull(d_date#30) AND (d_date#30 >= 1999-02-01)) AND (d_date#30 <= 1999-04-02)) AND isnotnull(d_date_sk#29))
 
 (49) Project [codegen id : 19]
-Output [1]: [d_date_sk#25]
-Input [2]: [d_date_sk#25, d_date#26]
+Output [1]: [d_date_sk#29]
+Input [2]: [d_date_sk#29, d_date#30]
 
 (50) BroadcastExchange
-Input [1]: [d_date_sk#25]
+Input [1]: [d_date_sk#29]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6]
 
 (51) BroadcastHashJoin [codegen id : 20]
 Left keys [1]: [ws_ship_date_sk#1]
-Right keys [1]: [d_date_sk#25]
+Right keys [1]: [d_date_sk#29]
 Join type: Inner
 Join condition: None
 
 (52) Project [codegen id : 20]
 Output [3]: [ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6]
-Input [5]: [ws_ship_date_sk#1, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6, d_date_sk#25]
+Input [5]: [ws_ship_date_sk#1, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6, d_date_sk#29]
 
 (53) HashAggregate [codegen id : 20]
 Input [3]: [ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6]
 Keys [1]: [ws_order_number#4]
 Functions [2]: [partial_sum(UnscaledValue(ws_ext_ship_cost#5)), partial_sum(UnscaledValue(ws_net_profit#6))]
-Aggregate Attributes [2]: [sum(UnscaledValue(ws_ext_ship_cost#5))#27, sum(UnscaledValue(ws_net_profit#6))#28]
-Results [3]: [ws_order_number#4, sum#29, sum#30]
+Aggregate Attributes [2]: [sum(UnscaledValue(ws_ext_ship_cost#5))#31, sum(UnscaledValue(ws_net_profit#6))#32]
+Results [3]: [ws_order_number#4, sum#33, sum#34]
 
 (54) HashAggregate [codegen id : 20]
-Input [3]: [ws_order_number#4, sum#29, sum#30]
+Input [3]: [ws_order_number#4, sum#33, sum#34]
 Keys [1]: [ws_order_number#4]
 Functions [2]: [merge_sum(UnscaledValue(ws_ext_ship_cost#5)), merge_sum(UnscaledValue(ws_net_profit#6))]
-Aggregate Attributes [2]: [sum(UnscaledValue(ws_ext_ship_cost#5))#27, sum(UnscaledValue(ws_net_profit#6))#28]
-Results [3]: [ws_order_number#4, sum#29, sum#30]
+Aggregate Attributes [2]: [sum(UnscaledValue(ws_ext_ship_cost#5))#31, sum(UnscaledValue(ws_net_profit#6))#32]
+Results [3]: [ws_order_number#4, sum#33, sum#34]
 
 (55) HashAggregate [codegen id : 20]
-Input [3]: [ws_order_number#4, sum#29, sum#30]
+Input [3]: [ws_order_number#4, sum#33, sum#34]
 Keys: []
 Functions [3]: [merge_sum(UnscaledValue(ws_ext_ship_cost#5)), merge_sum(UnscaledValue(ws_net_profit#6)), partial_count(distinct ws_order_number#4)]
-Aggregate Attributes [3]: [sum(UnscaledValue(ws_ext_ship_cost#5))#27, sum(UnscaledValue(ws_net_profit#6))#28, count(ws_order_number#4)#31]
-Results [3]: [sum#29, sum#30, count#32]
+Aggregate Attributes [3]: [sum(UnscaledValue(ws_ext_ship_cost#5))#31, sum(UnscaledValue(ws_net_profit#6))#32, count(ws_order_number#4)#35]
+Results [3]: [sum#33, sum#34, count#36]
 
 (56) Exchange
-Input [3]: [sum#29, sum#30, count#32]
+Input [3]: [sum#33, sum#34, count#36]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=7]
 
 (57) HashAggregate [codegen id : 21]
-Input [3]: [sum#29, sum#30, count#32]
+Input [3]: [sum#33, sum#34, count#36]
 Keys: []
 Functions [3]: [sum(UnscaledValue(ws_ext_ship_cost#5)), sum(UnscaledValue(ws_net_profit#6)), count(distinct ws_order_number#4)]
-Aggregate Attributes [3]: [sum(UnscaledValue(ws_ext_ship_cost#5))#27, sum(UnscaledValue(ws_net_profit#6))#28, count(ws_order_number#4)#31]
-Results [3]: [count(ws_order_number#4)#31 AS order count #33, MakeDecimal(sum(UnscaledValue(ws_ext_ship_cost#5))#27,17,2) AS total shipping cost #34, MakeDecimal(sum(UnscaledValue(ws_net_profit#6))#28,17,2) AS total net profit #35]
+Aggregate Attributes [3]: [sum(UnscaledValue(ws_ext_ship_cost#5))#31, sum(UnscaledValue(ws_net_profit#6))#32, count(ws_order_number#4)#35]
+Results [3]: [count(ws_order_number#4)#35 AS order count #37, MakeDecimal(sum(UnscaledValue(ws_ext_ship_cost#5))#31,17,2) AS total shipping cost #38, MakeDecimal(sum(UnscaledValue(ws_net_profit#6))#32,17,2) AS total net profit #39]
 
 ===== Subqueries =====
 
@@ -336,40 +336,40 @@ ObjectHashAggregate (64)
 
 
 (58) Scan parquet spark_catalog.default.customer_address
-Output [2]: [ca_address_sk#21, ca_state#22]
+Output [2]: [ca_address_sk#25, ca_state#26]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [IsNotNull(ca_state), EqualTo(ca_state,IL), IsNotNull(ca_address_sk)]
 ReadSchema: struct<ca_address_sk:int,ca_state:string>
 
 (59) ColumnarToRow [codegen id : 1]
-Input [2]: [ca_address_sk#21, ca_state#22]
+Input [2]: [ca_address_sk#25, ca_state#26]
 
 (60) Filter [codegen id : 1]
-Input [2]: [ca_address_sk#21, ca_state#22]
-Condition : ((isnotnull(ca_state#22) AND (ca_state#22 = IL)) AND isnotnull(ca_address_sk#21))
+Input [2]: [ca_address_sk#25, ca_state#26]
+Condition : ((isnotnull(ca_state#26) AND (ca_state#26 = IL)) AND isnotnull(ca_address_sk#25))
 
 (61) Project [codegen id : 1]
-Output [1]: [ca_address_sk#21]
-Input [2]: [ca_address_sk#21, ca_state#22]
+Output [1]: [ca_address_sk#25]
+Input [2]: [ca_address_sk#25, ca_state#26]
 
 (62) ObjectHashAggregate
-Input [1]: [ca_address_sk#21]
+Input [1]: [ca_address_sk#25]
 Keys: []
-Functions [1]: [partial_bloom_filter_agg(xxhash64(ca_address_sk#21, 42), 17961, 333176, 0, 0)]
-Aggregate Attributes [1]: [buf#36]
-Results [1]: [buf#37]
+Functions [1]: [partial_bloom_filter_agg(xxhash64(ca_address_sk#25, 42), 17961, 333176, 0, 0)]
+Aggregate Attributes [1]: [buf#40]
+Results [1]: [buf#41]
 
 (63) Exchange
-Input [1]: [buf#37]
+Input [1]: [buf#41]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=8]
 
 (64) ObjectHashAggregate
-Input [1]: [buf#37]
+Input [1]: [buf#41]
 Keys: []
-Functions [1]: [bloom_filter_agg(xxhash64(ca_address_sk#21, 42), 17961, 333176, 0, 0)]
-Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(ca_address_sk#21, 42), 17961, 333176, 0, 0)#38]
-Results [1]: [bloom_filter_agg(xxhash64(ca_address_sk#21, 42), 17961, 333176, 0, 0)#38 AS bloomFilter#39]
+Functions [1]: [bloom_filter_agg(xxhash64(ca_address_sk#25, 42), 17961, 333176, 0, 0)]
+Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(ca_address_sk#25, 42), 17961, 333176, 0, 0)#42]
+Results [1]: [bloom_filter_agg(xxhash64(ca_address_sk#25, 42), 17961, 333176, 0, 0)#42 AS bloomFilter#43]
 
 Subquery:2 Hosting operator id = 3 Hosting Expression = Subquery scalar-subquery#10, [id=#11]
 ObjectHashAggregate (71)
@@ -382,40 +382,40 @@ ObjectHashAggregate (71)
 
 
 (65) Scan parquet spark_catalog.default.web_site
-Output [2]: [web_site_sk#23, web_company_name#24]
+Output [2]: [web_site_sk#27, web_company_name#28]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/web_site]
 PushedFilters: [IsNotNull(web_company_name), EqualTo(web_company_name,pri                                               ), IsNotNull(web_site_sk)]
 ReadSchema: struct<web_site_sk:int,web_company_name:string>
 
 (66) ColumnarToRow [codegen id : 1]
-Input [2]: [web_site_sk#23, web_company_name#24]
+Input [2]: [web_site_sk#27, web_company_name#28]
 
 (67) Filter [codegen id : 1]
-Input [2]: [web_site_sk#23, web_company_name#24]
-Condition : ((isnotnull(web_company_name#24) AND (web_company_name#24 = pri                                               )) AND isnotnull(web_site_sk#23))
+Input [2]: [web_site_sk#27, web_company_name#28]
+Condition : ((isnotnull(web_company_name#28) AND (web_company_name#28 = pri                                               )) AND isnotnull(web_site_sk#27))
 
 (68) Project [codegen id : 1]
-Output [1]: [web_site_sk#23]
-Input [2]: [web_site_sk#23, web_company_name#24]
+Output [1]: [web_site_sk#27]
+Input [2]: [web_site_sk#27, web_company_name#28]
 
 (69) ObjectHashAggregate
-Input [1]: [web_site_sk#23]
+Input [1]: [web_site_sk#27]
 Keys: []
-Functions [1]: [partial_bloom_filter_agg(xxhash64(web_site_sk#23, 42), 4, 144, 0, 0)]
-Aggregate Attributes [1]: [buf#40]
-Results [1]: [buf#41]
+Functions [1]: [partial_bloom_filter_agg(xxhash64(web_site_sk#27, 42), 4, 144, 0, 0)]
+Aggregate Attributes [1]: [buf#44]
+Results [1]: [buf#45]
 
 (70) Exchange
-Input [1]: [buf#41]
+Input [1]: [buf#45]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=9]
 
 (71) ObjectHashAggregate
-Input [1]: [buf#41]
+Input [1]: [buf#45]
 Keys: []
-Functions [1]: [bloom_filter_agg(xxhash64(web_site_sk#23, 42), 4, 144, 0, 0)]
-Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(web_site_sk#23, 42), 4, 144, 0, 0)#42]
-Results [1]: [bloom_filter_agg(xxhash64(web_site_sk#23, 42), 4, 144, 0, 0)#42 AS bloomFilter#43]
+Functions [1]: [bloom_filter_agg(xxhash64(web_site_sk#27, 42), 4, 144, 0, 0)]
+Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(web_site_sk#27, 42), 4, 144, 0, 0)#46]
+Results [1]: [bloom_filter_agg(xxhash64(web_site_sk#27, 42), 4, 144, 0, 0)#46 AS bloomFilter#47]
 
 Subquery:3 Hosting operator id = 3 Hosting Expression = Subquery scalar-subquery#12, [id=#13]
 ObjectHashAggregate (78)
@@ -428,39 +428,39 @@ ObjectHashAggregate (78)
 
 
 (72) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#25, d_date#26]
+Output [2]: [d_date_sk#29, d_date#30]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,1999-02-01), LessThanOrEqual(d_date,1999-04-02), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date>
 
 (73) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#25, d_date#26]
+Input [2]: [d_date_sk#29, d_date#30]
 
 (74) Filter [codegen id : 1]
-Input [2]: [d_date_sk#25, d_date#26]
-Condition : (((isnotnull(d_date#26) AND (d_date#26 >= 1999-02-01)) AND (d_date#26 <= 1999-04-02)) AND isnotnull(d_date_sk#25))
+Input [2]: [d_date_sk#29, d_date#30]
+Condition : (((isnotnull(d_date#30) AND (d_date#30 >= 1999-02-01)) AND (d_date#30 <= 1999-04-02)) AND isnotnull(d_date_sk#29))
 
 (75) Project [codegen id : 1]
-Output [1]: [d_date_sk#25]
-Input [2]: [d_date_sk#25, d_date#26]
+Output [1]: [d_date_sk#29]
+Input [2]: [d_date_sk#29, d_date#30]
 
 (76) ObjectHashAggregate
-Input [1]: [d_date_sk#25]
+Input [1]: [d_date_sk#29]
 Keys: []
-Functions [1]: [partial_bloom_filter_agg(xxhash64(d_date_sk#25, 42), 73049, 1141755, 0, 0)]
-Aggregate Attributes [1]: [buf#44]
-Results [1]: [buf#45]
+Functions [1]: [partial_bloom_filter_agg(xxhash64(d_date_sk#29, 42), 73049, 1141755, 0, 0)]
+Aggregate Attributes [1]: [buf#48]
+Results [1]: [buf#49]
 
 (77) Exchange
-Input [1]: [buf#45]
+Input [1]: [buf#49]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=10]
 
 (78) ObjectHashAggregate
-Input [1]: [buf#45]
+Input [1]: [buf#49]
 Keys: []
-Functions [1]: [bloom_filter_agg(xxhash64(d_date_sk#25, 42), 73049, 1141755, 0, 0)]
-Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_date_sk#25, 42), 73049, 1141755, 0, 0)#46]
-Results [1]: [bloom_filter_agg(xxhash64(d_date_sk#25, 42), 73049, 1141755, 0, 0)#46 AS bloomFilter#47]
+Functions [1]: [bloom_filter_agg(xxhash64(d_date_sk#29, 42), 73049, 1141755, 0, 0)]
+Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(d_date_sk#29, 42), 73049, 1141755, 0, 0)#50]
+Results [1]: [bloom_filter_agg(xxhash64(d_date_sk#29, 42), 73049, 1141755, 0, 0)#50 AS bloomFilter#51]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q95/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q95/explain.txt
index 194134249e6..84c24f0bff1 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q95/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v1_4/q95/explain.txt
@@ -161,38 +161,38 @@ Input [1]: [wr_order_number#13]
 Arguments: [wr_order_number#13 ASC NULLS FIRST], false, 0
 
 (24) ReusedExchange [Reuses operator id: 11]
-Output [2]: [ws_warehouse_sk#8, ws_order_number#9]
+Output [2]: [ws_warehouse_sk#15, ws_order_number#16]
 
 (25) Sort [codegen id : 12]
-Input [2]: [ws_warehouse_sk#8, ws_order_number#9]
-Arguments: [ws_order_number#9 ASC NULLS FIRST], false, 0
+Input [2]: [ws_warehouse_sk#15, ws_order_number#16]
+Arguments: [ws_order_number#16 ASC NULLS FIRST], false, 0
 
 (26) ReusedExchange [Reuses operator id: 11]
-Output [2]: [ws_warehouse_sk#11, ws_order_number#12]
+Output [2]: [ws_warehouse_sk#17, ws_order_number#18]
 
 (27) Sort [codegen id : 14]
-Input [2]: [ws_warehouse_sk#11, ws_order_number#12]
-Arguments: [ws_order_number#12 ASC NULLS FIRST], false, 0
+Input [2]: [ws_warehouse_sk#17, ws_order_number#18]
+Arguments: [ws_order_number#18 ASC NULLS FIRST], false, 0
 
 (28) SortMergeJoin [codegen id : 15]
-Left keys [1]: [ws_order_number#9]
-Right keys [1]: [ws_order_number#12]
+Left keys [1]: [ws_order_number#16]
+Right keys [1]: [ws_order_number#18]
 Join type: Inner
-Join condition: NOT (ws_warehouse_sk#8 = ws_warehouse_sk#11)
+Join condition: NOT (ws_warehouse_sk#15 = ws_warehouse_sk#17)
 
 (29) Project [codegen id : 15]
-Output [1]: [ws_order_number#9]
-Input [4]: [ws_warehouse_sk#8, ws_order_number#9, ws_warehouse_sk#11, ws_order_number#12]
+Output [1]: [ws_order_number#16]
+Input [4]: [ws_warehouse_sk#15, ws_order_number#16, ws_warehouse_sk#17, ws_order_number#18]
 
 (30) SortMergeJoin [codegen id : 16]
 Left keys [1]: [wr_order_number#13]
-Right keys [1]: [ws_order_number#9]
+Right keys [1]: [ws_order_number#16]
 Join type: Inner
 Join condition: None
 
 (31) Project [codegen id : 16]
 Output [1]: [wr_order_number#13]
-Input [2]: [wr_order_number#13, ws_order_number#9]
+Input [2]: [wr_order_number#13, ws_order_number#16]
 
 (32) SortMergeJoin [codegen id : 20]
 Left keys [1]: [ws_order_number#4]
@@ -201,130 +201,130 @@ Join type: LeftSemi
 Join condition: None
 
 (33) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#15, d_date#16]
+Output [2]: [d_date_sk#19, d_date#20]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,1999-02-01), LessThanOrEqual(d_date,1999-04-02), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date>
 
 (34) ColumnarToRow [codegen id : 17]
-Input [2]: [d_date_sk#15, d_date#16]
+Input [2]: [d_date_sk#19, d_date#20]
 
 (35) Filter [codegen id : 17]
-Input [2]: [d_date_sk#15, d_date#16]
-Condition : (((isnotnull(d_date#16) AND (d_date#16 >= 1999-02-01)) AND (d_date#16 <= 1999-04-02)) AND isnotnull(d_date_sk#15))
+Input [2]: [d_date_sk#19, d_date#20]
+Condition : (((isnotnull(d_date#20) AND (d_date#20 >= 1999-02-01)) AND (d_date#20 <= 1999-04-02)) AND isnotnull(d_date_sk#19))
 
 (36) Project [codegen id : 17]
-Output [1]: [d_date_sk#15]
-Input [2]: [d_date_sk#15, d_date#16]
+Output [1]: [d_date_sk#19]
+Input [2]: [d_date_sk#19, d_date#20]
 
 (37) BroadcastExchange
-Input [1]: [d_date_sk#15]
+Input [1]: [d_date_sk#19]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4]
 
 (38) BroadcastHashJoin [codegen id : 20]
 Left keys [1]: [ws_ship_date_sk#1]
-Right keys [1]: [d_date_sk#15]
+Right keys [1]: [d_date_sk#19]
 Join type: Inner
 Join condition: None
 
 (39) Project [codegen id : 20]
 Output [5]: [ws_ship_addr_sk#2, ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6]
-Input [7]: [ws_ship_date_sk#1, ws_ship_addr_sk#2, ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6, d_date_sk#15]
+Input [7]: [ws_ship_date_sk#1, ws_ship_addr_sk#2, ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6, d_date_sk#19]
 
 (40) Scan parquet spark_catalog.default.customer_address
-Output [2]: [ca_address_sk#17, ca_state#18]
+Output [2]: [ca_address_sk#21, ca_state#22]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [IsNotNull(ca_state), EqualTo(ca_state,IL), IsNotNull(ca_address_sk)]
 ReadSchema: struct<ca_address_sk:int,ca_state:string>
 
 (41) ColumnarToRow [codegen id : 18]
-Input [2]: [ca_address_sk#17, ca_state#18]
+Input [2]: [ca_address_sk#21, ca_state#22]
 
 (42) Filter [codegen id : 18]
-Input [2]: [ca_address_sk#17, ca_state#18]
-Condition : ((isnotnull(ca_state#18) AND (ca_state#18 = IL)) AND isnotnull(ca_address_sk#17))
+Input [2]: [ca_address_sk#21, ca_state#22]
+Condition : ((isnotnull(ca_state#22) AND (ca_state#22 = IL)) AND isnotnull(ca_address_sk#21))
 
 (43) Project [codegen id : 18]
-Output [1]: [ca_address_sk#17]
-Input [2]: [ca_address_sk#17, ca_state#18]
+Output [1]: [ca_address_sk#21]
+Input [2]: [ca_address_sk#21, ca_state#22]
 
 (44) BroadcastExchange
-Input [1]: [ca_address_sk#17]
+Input [1]: [ca_address_sk#21]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5]
 
 (45) BroadcastHashJoin [codegen id : 20]
 Left keys [1]: [ws_ship_addr_sk#2]
-Right keys [1]: [ca_address_sk#17]
+Right keys [1]: [ca_address_sk#21]
 Join type: Inner
 Join condition: None
 
 (46) Project [codegen id : 20]
 Output [4]: [ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6]
-Input [6]: [ws_ship_addr_sk#2, ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6, ca_address_sk#17]
+Input [6]: [ws_ship_addr_sk#2, ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6, ca_address_sk#21]
 
 (47) Scan parquet spark_catalog.default.web_site
-Output [2]: [web_site_sk#19, web_company_name#20]
+Output [2]: [web_site_sk#23, web_company_name#24]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/web_site]
 PushedFilters: [IsNotNull(web_company_name), EqualTo(web_company_name,pri                                               ), IsNotNull(web_site_sk)]
 ReadSchema: struct<web_site_sk:int,web_company_name:string>
 
 (48) ColumnarToRow [codegen id : 19]
-Input [2]: [web_site_sk#19, web_company_name#20]
+Input [2]: [web_site_sk#23, web_company_name#24]
 
 (49) Filter [codegen id : 19]
-Input [2]: [web_site_sk#19, web_company_name#20]
-Condition : ((isnotnull(web_company_name#20) AND (web_company_name#20 = pri                                               )) AND isnotnull(web_site_sk#19))
+Input [2]: [web_site_sk#23, web_company_name#24]
+Condition : ((isnotnull(web_company_name#24) AND (web_company_name#24 = pri                                               )) AND isnotnull(web_site_sk#23))
 
 (50) Project [codegen id : 19]
-Output [1]: [web_site_sk#19]
-Input [2]: [web_site_sk#19, web_company_name#20]
+Output [1]: [web_site_sk#23]
+Input [2]: [web_site_sk#23, web_company_name#24]
 
 (51) BroadcastExchange
-Input [1]: [web_site_sk#19]
+Input [1]: [web_site_sk#23]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6]
 
 (52) BroadcastHashJoin [codegen id : 20]
 Left keys [1]: [ws_web_site_sk#3]
-Right keys [1]: [web_site_sk#19]
+Right keys [1]: [web_site_sk#23]
 Join type: Inner
 Join condition: None
 
 (53) Project [codegen id : 20]
 Output [3]: [ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6]
-Input [5]: [ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6, web_site_sk#19]
+Input [5]: [ws_web_site_sk#3, ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6, web_site_sk#23]
 
 (54) HashAggregate [codegen id : 20]
 Input [3]: [ws_order_number#4, ws_ext_ship_cost#5, ws_net_profit#6]
 Keys [1]: [ws_order_number#4]
 Functions [2]: [partial_sum(UnscaledValue(ws_ext_ship_cost#5)), partial_sum(UnscaledValue(ws_net_profit#6))]
-Aggregate Attributes [2]: [sum(UnscaledValue(ws_ext_ship_cost#5))#21, sum(UnscaledValue(ws_net_profit#6))#22]
-Results [3]: [ws_order_number#4, sum#23, sum#24]
+Aggregate Attributes [2]: [sum(UnscaledValue(ws_ext_ship_cost#5))#25, sum(UnscaledValue(ws_net_profit#6))#26]
+Results [3]: [ws_order_number#4, sum#27, sum#28]
 
 (55) HashAggregate [codegen id : 20]
-Input [3]: [ws_order_number#4, sum#23, sum#24]
+Input [3]: [ws_order_number#4, sum#27, sum#28]
 Keys [1]: [ws_order_number#4]
 Functions [2]: [merge_sum(UnscaledValue(ws_ext_ship_cost#5)), merge_sum(UnscaledValue(ws_net_profit#6))]
-Aggregate Attributes [2]: [sum(UnscaledValue(ws_ext_ship_cost#5))#21, sum(UnscaledValue(ws_net_profit#6))#22]
-Results [3]: [ws_order_number#4, sum#23, sum#24]
+Aggregate Attributes [2]: [sum(UnscaledValue(ws_ext_ship_cost#5))#25, sum(UnscaledValue(ws_net_profit#6))#26]
+Results [3]: [ws_order_number#4, sum#27, sum#28]
 
 (56) HashAggregate [codegen id : 20]
-Input [3]: [ws_order_number#4, sum#23, sum#24]
+Input [3]: [ws_order_number#4, sum#27, sum#28]
 Keys: []
 Functions [3]: [merge_sum(UnscaledValue(ws_ext_ship_cost#5)), merge_sum(UnscaledValue(ws_net_profit#6)), partial_count(distinct ws_order_number#4)]
-Aggregate Attributes [3]: [sum(UnscaledValue(ws_ext_ship_cost#5))#21, sum(UnscaledValue(ws_net_profit#6))#22, count(ws_order_number#4)#25]
-Results [3]: [sum#23, sum#24, count#26]
+Aggregate Attributes [3]: [sum(UnscaledValue(ws_ext_ship_cost#5))#25, sum(UnscaledValue(ws_net_profit#6))#26, count(ws_order_number#4)#29]
+Results [3]: [sum#27, sum#28, count#30]
 
 (57) Exchange
-Input [3]: [sum#23, sum#24, count#26]
+Input [3]: [sum#27, sum#28, count#30]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=7]
 
 (58) HashAggregate [codegen id : 21]
-Input [3]: [sum#23, sum#24, count#26]
+Input [3]: [sum#27, sum#28, count#30]
 Keys: []
 Functions [3]: [sum(UnscaledValue(ws_ext_ship_cost#5)), sum(UnscaledValue(ws_net_profit#6)), count(distinct ws_order_number#4)]
-Aggregate Attributes [3]: [sum(UnscaledValue(ws_ext_ship_cost#5))#21, sum(UnscaledValue(ws_net_profit#6))#22, count(ws_order_number#4)#25]
-Results [3]: [count(ws_order_number#4)#25 AS order count #27, MakeDecimal(sum(UnscaledValue(ws_ext_ship_cost#5))#21,17,2) AS total shipping cost #28, MakeDecimal(sum(UnscaledValue(ws_net_profit#6))#22,17,2) AS total net profit #29]
+Aggregate Attributes [3]: [sum(UnscaledValue(ws_ext_ship_cost#5))#25, sum(UnscaledValue(ws_net_profit#6))#26, count(ws_order_number#4)#29]
+Results [3]: [count(ws_order_number#4)#29 AS order count #31, MakeDecimal(sum(UnscaledValue(ws_ext_ship_cost#5))#25,17,2) AS total shipping cost #32, MakeDecimal(sum(UnscaledValue(ws_net_profit#6))#26,17,2) AS total net profit #33]
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14.sf100/explain.txt
index d7f8bfd6a12..e8f37353b25 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14.sf100/explain.txt
@@ -447,75 +447,75 @@ Input [4]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57]
 Condition : isnotnull(ss_item_sk#54)
 
 (76) ReusedExchange [Reuses operator id: 56]
-Output [1]: [ss_item_sk#35]
+Output [1]: [ss_item_sk#59]
 
 (77) BroadcastHashJoin [codegen id : 74]
 Left keys [1]: [ss_item_sk#54]
-Right keys [1]: [ss_item_sk#35]
+Right keys [1]: [ss_item_sk#59]
 Join type: LeftSemi
 Join condition: None
 
 (78) ReusedExchange [Reuses operator id: 128]
-Output [1]: [d_date_sk#59]
+Output [1]: [d_date_sk#60]
 
 (79) BroadcastHashJoin [codegen id : 74]
 Left keys [1]: [ss_sold_date_sk#57]
-Right keys [1]: [d_date_sk#59]
+Right keys [1]: [d_date_sk#60]
 Join type: Inner
 Join condition: None
 
 (80) Project [codegen id : 74]
 Output [3]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56]
-Input [5]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, d_date_sk#59]
+Input [5]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, d_date_sk#60]
 
 (81) ReusedExchange [Reuses operator id: 66]
-Output [4]: [i_item_sk#60, i_brand_id#61, i_class_id#62, i_category_id#63]
+Output [4]: [i_item_sk#61, i_brand_id#62, i_class_id#63, i_category_id#64]
 
 (82) BroadcastHashJoin [codegen id : 74]
 Left keys [1]: [ss_item_sk#54]
-Right keys [1]: [i_item_sk#60]
+Right keys [1]: [i_item_sk#61]
 Join type: Inner
 Join condition: None
 
 (83) Project [codegen id : 74]
-Output [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#61, i_class_id#62, i_category_id#63]
-Input [7]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, i_item_sk#60, i_brand_id#61, i_class_id#62, i_category_id#63]
+Output [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#62, i_class_id#63, i_category_id#64]
+Input [7]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, i_item_sk#61, i_brand_id#62, i_class_id#63, i_category_id#64]
 
 (84) HashAggregate [codegen id : 74]
-Input [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#61, i_class_id#62, i_category_id#63]
-Keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
+Input [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#62, i_class_id#63, i_category_id#64]
+Keys [3]: [i_brand_id#62, i_class_id#63, i_category_id#64]
 Functions [2]: [partial_sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56)), partial_count(1)]
-Aggregate Attributes [3]: [sum#64, isEmpty#65, count#66]
-Results [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#67, isEmpty#68, count#69]
+Aggregate Attributes [3]: [sum#65, isEmpty#66, count#67]
+Results [6]: [i_brand_id#62, i_class_id#63, i_category_id#64, sum#68, isEmpty#69, count#70]
 
 (85) Exchange
-Input [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#67, isEmpty#68, count#69]
-Arguments: hashpartitioning(i_brand_id#61, i_class_id#62, i_category_id#63, 5), ENSURE_REQUIREMENTS, [plan_id=12]
+Input [6]: [i_brand_id#62, i_class_id#63, i_category_id#64, sum#68, isEmpty#69, count#70]
+Arguments: hashpartitioning(i_brand_id#62, i_class_id#63, i_category_id#64, 5), ENSURE_REQUIREMENTS, [plan_id=12]
 
 (86) HashAggregate [codegen id : 75]
-Input [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#67, isEmpty#68, count#69]
-Keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
+Input [6]: [i_brand_id#62, i_class_id#63, i_category_id#64, sum#68, isEmpty#69, count#70]
+Keys [3]: [i_brand_id#62, i_class_id#63, i_category_id#64]
 Functions [2]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56)), count(1)]
-Aggregate Attributes [2]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#70, count(1)#71]
-Results [6]: [store AS channel#72, i_brand_id#61, i_class_id#62, i_category_id#63, sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#70 AS sales#73, count(1)#71 AS number_sales#74]
+Aggregate Attributes [2]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#71, count(1)#72]
+Results [6]: [store AS channel#73, i_brand_id#62, i_class_id#63, i_category_id#64, sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#71 AS sales#74, count(1)#72 AS number_sales#75]
 
 (87) Filter [codegen id : 75]
-Input [6]: [channel#72, i_brand_id#61, i_class_id#62, i_category_id#63, sales#73, number_sales#74]
-Condition : (isnotnull(sales#73) AND (cast(sales#73 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
+Input [6]: [channel#73, i_brand_id#62, i_class_id#63, i_category_id#64, sales#74, number_sales#75]
+Condition : (isnotnull(sales#74) AND (cast(sales#74 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
 
 (88) BroadcastExchange
-Input [6]: [channel#72, i_brand_id#61, i_class_id#62, i_category_id#63, sales#73, number_sales#74]
+Input [6]: [channel#73, i_brand_id#62, i_class_id#63, i_category_id#64, sales#74, number_sales#75]
 Arguments: HashedRelationBroadcastMode(List(input[1, int, true], input[2, int, true], input[3, int, true]),false), [plan_id=13]
 
 (89) BroadcastHashJoin [codegen id : 76]
 Left keys [3]: [i_brand_id#38, i_class_id#39, i_category_id#40]
-Right keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
+Right keys [3]: [i_brand_id#62, i_class_id#63, i_category_id#64]
 Join type: Inner
 Join condition: None
 
 (90) TakeOrderedAndProject
-Input [12]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sales#50, number_sales#51, channel#72, i_brand_id#61, i_class_id#62, i_category_id#63, sales#73, number_sales#74]
-Arguments: 100, [i_brand_id#38 ASC NULLS FIRST, i_class_id#39 ASC NULLS FIRST, i_category_id#40 ASC NULLS FIRST], [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sales#50, number_sales#51, channel#72, i_brand_id#61, i_class_id#62, i_category_id#63, sales#73, number_sales#74]
+Input [12]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sales#50, number_sales#51, channel#73, i_brand_id#62, i_class_id#63, i_category_id#64, sales#74, number_sales#75]
+Arguments: 100, [i_brand_id#38 ASC NULLS FIRST, i_class_id#39 ASC NULLS FIRST, i_category_id#40 ASC NULLS FIRST], [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sales#50, number_sales#51, channel#73, i_brand_id#62, i_class_id#63, i_category_id#64, sales#74, number_sales#75]
 
 ===== Subqueries =====
 
@@ -542,99 +542,99 @@ Subquery:1 Hosting operator id = 72 Hosting Expression = Subquery scalar-subquer
 
 
 (91) Scan parquet spark_catalog.default.store_sales
-Output [3]: [ss_quantity#75, ss_list_price#76, ss_sold_date_sk#77]
+Output [3]: [ss_quantity#76, ss_list_price#77, ss_sold_date_sk#78]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#77), dynamicpruningexpression(ss_sold_date_sk#77 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#78), dynamicpruningexpression(ss_sold_date_sk#78 IN dynamicpruning#12)]
 ReadSchema: struct<ss_quantity:int,ss_list_price:decimal(7,2)>
 
 (92) ColumnarToRow [codegen id : 2]
-Input [3]: [ss_quantity#75, ss_list_price#76, ss_sold_date_sk#77]
+Input [3]: [ss_quantity#76, ss_list_price#77, ss_sold_date_sk#78]
 
 (93) ReusedExchange [Reuses operator id: 123]
-Output [1]: [d_date_sk#78]
+Output [1]: [d_date_sk#79]
 
 (94) BroadcastHashJoin [codegen id : 2]
-Left keys [1]: [ss_sold_date_sk#77]
-Right keys [1]: [d_date_sk#78]
+Left keys [1]: [ss_sold_date_sk#78]
+Right keys [1]: [d_date_sk#79]
 Join type: Inner
 Join condition: None
 
 (95) Project [codegen id : 2]
-Output [2]: [ss_quantity#75 AS quantity#79, ss_list_price#76 AS list_price#80]
-Input [4]: [ss_quantity#75, ss_list_price#76, ss_sold_date_sk#77, d_date_sk#78]
+Output [2]: [ss_quantity#76 AS quantity#80, ss_list_price#77 AS list_price#81]
+Input [4]: [ss_quantity#76, ss_list_price#77, ss_sold_date_sk#78, d_date_sk#79]
 
 (96) Scan parquet spark_catalog.default.catalog_sales
-Output [3]: [cs_quantity#81, cs_list_price#82, cs_sold_date_sk#83]
+Output [3]: [cs_quantity#82, cs_list_price#83, cs_sold_date_sk#84]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#83), dynamicpruningexpression(cs_sold_date_sk#83 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#84), dynamicpruningexpression(cs_sold_date_sk#84 IN dynamicpruning#12)]
 ReadSchema: struct<cs_quantity:int,cs_list_price:decimal(7,2)>
 
 (97) ColumnarToRow [codegen id : 4]
-Input [3]: [cs_quantity#81, cs_list_price#82, cs_sold_date_sk#83]
+Input [3]: [cs_quantity#82, cs_list_price#83, cs_sold_date_sk#84]
 
 (98) ReusedExchange [Reuses operator id: 123]
-Output [1]: [d_date_sk#84]
+Output [1]: [d_date_sk#85]
 
 (99) BroadcastHashJoin [codegen id : 4]
-Left keys [1]: [cs_sold_date_sk#83]
-Right keys [1]: [d_date_sk#84]
+Left keys [1]: [cs_sold_date_sk#84]
+Right keys [1]: [d_date_sk#85]
 Join type: Inner
 Join condition: None
 
 (100) Project [codegen id : 4]
-Output [2]: [cs_quantity#81 AS quantity#85, cs_list_price#82 AS list_price#86]
-Input [4]: [cs_quantity#81, cs_list_price#82, cs_sold_date_sk#83, d_date_sk#84]
+Output [2]: [cs_quantity#82 AS quantity#86, cs_list_price#83 AS list_price#87]
+Input [4]: [cs_quantity#82, cs_list_price#83, cs_sold_date_sk#84, d_date_sk#85]
 
 (101) Scan parquet spark_catalog.default.web_sales
-Output [3]: [ws_quantity#87, ws_list_price#88, ws_sold_date_sk#89]
+Output [3]: [ws_quantity#88, ws_list_price#89, ws_sold_date_sk#90]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#89), dynamicpruningexpression(ws_sold_date_sk#89 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#90), dynamicpruningexpression(ws_sold_date_sk#90 IN dynamicpruning#12)]
 ReadSchema: struct<ws_quantity:int,ws_list_price:decimal(7,2)>
 
 (102) ColumnarToRow [codegen id : 6]
-Input [3]: [ws_quantity#87, ws_list_price#88, ws_sold_date_sk#89]
+Input [3]: [ws_quantity#88, ws_list_price#89, ws_sold_date_sk#90]
 
 (103) ReusedExchange [Reuses operator id: 123]
-Output [1]: [d_date_sk#90]
+Output [1]: [d_date_sk#91]
 
 (104) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [ws_sold_date_sk#89]
-Right keys [1]: [d_date_sk#90]
+Left keys [1]: [ws_sold_date_sk#90]
+Right keys [1]: [d_date_sk#91]
 Join type: Inner
 Join condition: None
 
 (105) Project [codegen id : 6]
-Output [2]: [ws_quantity#87 AS quantity#91, ws_list_price#88 AS list_price#92]
-Input [4]: [ws_quantity#87, ws_list_price#88, ws_sold_date_sk#89, d_date_sk#90]
+Output [2]: [ws_quantity#88 AS quantity#92, ws_list_price#89 AS list_price#93]
+Input [4]: [ws_quantity#88, ws_list_price#89, ws_sold_date_sk#90, d_date_sk#91]
 
 (106) Union
 
 (107) HashAggregate [codegen id : 7]
-Input [2]: [quantity#79, list_price#80]
+Input [2]: [quantity#80, list_price#81]
 Keys: []
-Functions [1]: [partial_avg((cast(quantity#79 as decimal(10,0)) * list_price#80))]
-Aggregate Attributes [2]: [sum#93, count#94]
-Results [2]: [sum#95, count#96]
+Functions [1]: [partial_avg((cast(quantity#80 as decimal(10,0)) * list_price#81))]
+Aggregate Attributes [2]: [sum#94, count#95]
+Results [2]: [sum#96, count#97]
 
 (108) Exchange
-Input [2]: [sum#95, count#96]
+Input [2]: [sum#96, count#97]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=14]
 
 (109) HashAggregate [codegen id : 8]
-Input [2]: [sum#95, count#96]
+Input [2]: [sum#96, count#97]
 Keys: []
-Functions [1]: [avg((cast(quantity#79 as decimal(10,0)) * list_price#80))]
-Aggregate Attributes [1]: [avg((cast(quantity#79 as decimal(10,0)) * list_price#80))#97]
-Results [1]: [avg((cast(quantity#79 as decimal(10,0)) * list_price#80))#97 AS average_sales#98]
+Functions [1]: [avg((cast(quantity#80 as decimal(10,0)) * list_price#81))]
+Aggregate Attributes [1]: [avg((cast(quantity#80 as decimal(10,0)) * list_price#81))#98]
+Results [1]: [avg((cast(quantity#80 as decimal(10,0)) * list_price#81))#98 AS average_sales#99]
 
-Subquery:2 Hosting operator id = 91 Hosting Expression = ss_sold_date_sk#77 IN dynamicpruning#12
+Subquery:2 Hosting operator id = 91 Hosting Expression = ss_sold_date_sk#78 IN dynamicpruning#12
 
-Subquery:3 Hosting operator id = 96 Hosting Expression = cs_sold_date_sk#83 IN dynamicpruning#12
+Subquery:3 Hosting operator id = 96 Hosting Expression = cs_sold_date_sk#84 IN dynamicpruning#12
 
-Subquery:4 Hosting operator id = 101 Hosting Expression = ws_sold_date_sk#89 IN dynamicpruning#12
+Subquery:4 Hosting operator id = 101 Hosting Expression = ws_sold_date_sk#90 IN dynamicpruning#12
 
 Subquery:5 Hosting operator id = 1 Hosting Expression = ss_sold_date_sk#4 IN dynamicpruning#5
 BroadcastExchange (114)
@@ -645,28 +645,28 @@ BroadcastExchange (114)
 
 
 (110) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#36, d_week_seq#99]
+Output [2]: [d_date_sk#36, d_week_seq#100]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_week_seq:int>
 
 (111) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#36, d_week_seq#99]
+Input [2]: [d_date_sk#36, d_week_seq#100]
 
 (112) Filter [codegen id : 1]
-Input [2]: [d_date_sk#36, d_week_seq#99]
-Condition : ((isnotnull(d_week_seq#99) AND (d_week_seq#99 = Subquery scalar-subquery#100, [id=#101])) AND isnotnull(d_date_sk#36))
+Input [2]: [d_date_sk#36, d_week_seq#100]
+Condition : ((isnotnull(d_week_seq#100) AND (d_week_seq#100 = Subquery scalar-subquery#101, [id=#102])) AND isnotnull(d_date_sk#36))
 
 (113) Project [codegen id : 1]
 Output [1]: [d_date_sk#36]
-Input [2]: [d_date_sk#36, d_week_seq#99]
+Input [2]: [d_date_sk#36, d_week_seq#100]
 
 (114) BroadcastExchange
 Input [1]: [d_date_sk#36]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=15]
 
-Subquery:6 Hosting operator id = 112 Hosting Expression = Subquery scalar-subquery#100, [id=#101]
+Subquery:6 Hosting operator id = 112 Hosting Expression = Subquery scalar-subquery#101, [id=#102]
 * Project (118)
 +- * Filter (117)
    +- * ColumnarToRow (116)
@@ -674,22 +674,22 @@ Subquery:6 Hosting operator id = 112 Hosting Expression = Subquery scalar-subque
 
 
 (115) Scan parquet spark_catalog.default.date_dim
-Output [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
+Output [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), EqualTo(d_dom,16)]
 ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
 
 (116) ColumnarToRow [codegen id : 1]
-Input [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
+Input [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
 
 (117) Filter [codegen id : 1]
-Input [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
-Condition : (((((isnotnull(d_year#103) AND isnotnull(d_moy#104)) AND isnotnull(d_dom#105)) AND (d_year#103 = 1999)) AND (d_moy#104 = 12)) AND (d_dom#105 = 16))
+Input [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
+Condition : (((((isnotnull(d_year#104) AND isnotnull(d_moy#105)) AND isnotnull(d_dom#106)) AND (d_year#104 = 1999)) AND (d_moy#105 = 12)) AND (d_dom#106 = 16))
 
 (118) Project [codegen id : 1]
-Output [1]: [d_week_seq#102]
-Input [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
+Output [1]: [d_week_seq#103]
+Input [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
 
 Subquery:7 Hosting operator id = 7 Hosting Expression = ss_sold_date_sk#11 IN dynamicpruning#12
 BroadcastExchange (123)
@@ -700,22 +700,22 @@ BroadcastExchange (123)
 
 
 (119) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#13, d_year#106]
+Output [2]: [d_date_sk#13, d_year#107]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (120) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#13, d_year#106]
+Input [2]: [d_date_sk#13, d_year#107]
 
 (121) Filter [codegen id : 1]
-Input [2]: [d_date_sk#13, d_year#106]
-Condition : (((isnotnull(d_year#106) AND (d_year#106 >= 1998)) AND (d_year#106 <= 2000)) AND isnotnull(d_date_sk#13))
+Input [2]: [d_date_sk#13, d_year#107]
+Condition : (((isnotnull(d_year#107) AND (d_year#107 >= 1998)) AND (d_year#107 <= 2000)) AND isnotnull(d_date_sk#13))
 
 (122) Project [codegen id : 1]
 Output [1]: [d_date_sk#13]
-Input [2]: [d_date_sk#13, d_year#106]
+Input [2]: [d_date_sk#13, d_year#107]
 
 (123) BroadcastExchange
 Input [1]: [d_date_sk#13]
@@ -736,28 +736,28 @@ BroadcastExchange (128)
 
 
 (124) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#59, d_week_seq#107]
+Output [2]: [d_date_sk#60, d_week_seq#108]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_week_seq:int>
 
 (125) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#59, d_week_seq#107]
+Input [2]: [d_date_sk#60, d_week_seq#108]
 
 (126) Filter [codegen id : 1]
-Input [2]: [d_date_sk#59, d_week_seq#107]
-Condition : ((isnotnull(d_week_seq#107) AND (d_week_seq#107 = Subquery scalar-subquery#108, [id=#109])) AND isnotnull(d_date_sk#59))
+Input [2]: [d_date_sk#60, d_week_seq#108]
+Condition : ((isnotnull(d_week_seq#108) AND (d_week_seq#108 = Subquery scalar-subquery#109, [id=#110])) AND isnotnull(d_date_sk#60))
 
 (127) Project [codegen id : 1]
-Output [1]: [d_date_sk#59]
-Input [2]: [d_date_sk#59, d_week_seq#107]
+Output [1]: [d_date_sk#60]
+Input [2]: [d_date_sk#60, d_week_seq#108]
 
 (128) BroadcastExchange
-Input [1]: [d_date_sk#59]
+Input [1]: [d_date_sk#60]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=17]
 
-Subquery:12 Hosting operator id = 126 Hosting Expression = Subquery scalar-subquery#108, [id=#109]
+Subquery:12 Hosting operator id = 126 Hosting Expression = Subquery scalar-subquery#109, [id=#110]
 * Project (132)
 +- * Filter (131)
    +- * ColumnarToRow (130)
@@ -765,21 +765,21 @@ Subquery:12 Hosting operator id = 126 Hosting Expression = Subquery scalar-subqu
 
 
 (129) Scan parquet spark_catalog.default.date_dim
-Output [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
+Output [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1998), EqualTo(d_moy,12), EqualTo(d_dom,16)]
 ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
 
 (130) ColumnarToRow [codegen id : 1]
-Input [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
+Input [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
 
 (131) Filter [codegen id : 1]
-Input [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
-Condition : (((((isnotnull(d_year#111) AND isnotnull(d_moy#112)) AND isnotnull(d_dom#113)) AND (d_year#111 = 1998)) AND (d_moy#112 = 12)) AND (d_dom#113 = 16))
+Input [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
+Condition : (((((isnotnull(d_year#112) AND isnotnull(d_moy#113)) AND isnotnull(d_dom#114)) AND (d_year#112 = 1998)) AND (d_moy#113 = 12)) AND (d_dom#114 = 16))
 
 (132) Project [codegen id : 1]
-Output [1]: [d_week_seq#110]
-Input [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
+Output [1]: [d_week_seq#111]
+Input [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14/explain.txt
index 603119ba166..b33fb2ab421 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14/explain.txt
@@ -417,75 +417,75 @@ Input [4]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57]
 Condition : isnotnull(ss_item_sk#54)
 
 (70) ReusedExchange [Reuses operator id: 50]
-Output [1]: [ss_item_sk#35]
+Output [1]: [ss_item_sk#59]
 
 (71) BroadcastHashJoin [codegen id : 50]
 Left keys [1]: [ss_item_sk#54]
-Right keys [1]: [ss_item_sk#35]
+Right keys [1]: [ss_item_sk#59]
 Join type: LeftSemi
 Join condition: None
 
 (72) ReusedExchange [Reuses operator id: 57]
-Output [4]: [i_item_sk#59, i_brand_id#60, i_class_id#61, i_category_id#62]
+Output [4]: [i_item_sk#60, i_brand_id#61, i_class_id#62, i_category_id#63]
 
 (73) BroadcastHashJoin [codegen id : 50]
 Left keys [1]: [ss_item_sk#54]
-Right keys [1]: [i_item_sk#59]
+Right keys [1]: [i_item_sk#60]
 Join type: Inner
 Join condition: None
 
 (74) Project [codegen id : 50]
-Output [6]: [ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, i_brand_id#60, i_class_id#61, i_category_id#62]
-Input [8]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, i_item_sk#59, i_brand_id#60, i_class_id#61, i_category_id#62]
+Output [6]: [ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, i_brand_id#61, i_class_id#62, i_category_id#63]
+Input [8]: [ss_item_sk#54, ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, i_item_sk#60, i_brand_id#61, i_class_id#62, i_category_id#63]
 
 (75) ReusedExchange [Reuses operator id: 122]
-Output [1]: [d_date_sk#63]
+Output [1]: [d_date_sk#64]
 
 (76) BroadcastHashJoin [codegen id : 50]
 Left keys [1]: [ss_sold_date_sk#57]
-Right keys [1]: [d_date_sk#63]
+Right keys [1]: [d_date_sk#64]
 Join type: Inner
 Join condition: None
 
 (77) Project [codegen id : 50]
-Output [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#60, i_class_id#61, i_category_id#62]
-Input [7]: [ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, i_brand_id#60, i_class_id#61, i_category_id#62, d_date_sk#63]
+Output [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#61, i_class_id#62, i_category_id#63]
+Input [7]: [ss_quantity#55, ss_list_price#56, ss_sold_date_sk#57, i_brand_id#61, i_class_id#62, i_category_id#63, d_date_sk#64]
 
 (78) HashAggregate [codegen id : 50]
-Input [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#60, i_class_id#61, i_category_id#62]
-Keys [3]: [i_brand_id#60, i_class_id#61, i_category_id#62]
+Input [5]: [ss_quantity#55, ss_list_price#56, i_brand_id#61, i_class_id#62, i_category_id#63]
+Keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
 Functions [2]: [partial_sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56)), partial_count(1)]
-Aggregate Attributes [3]: [sum#64, isEmpty#65, count#66]
-Results [6]: [i_brand_id#60, i_class_id#61, i_category_id#62, sum#67, isEmpty#68, count#69]
+Aggregate Attributes [3]: [sum#65, isEmpty#66, count#67]
+Results [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#68, isEmpty#69, count#70]
 
 (79) Exchange
-Input [6]: [i_brand_id#60, i_class_id#61, i_category_id#62, sum#67, isEmpty#68, count#69]
-Arguments: hashpartitioning(i_brand_id#60, i_class_id#61, i_category_id#62, 5), ENSURE_REQUIREMENTS, [plan_id=10]
+Input [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#68, isEmpty#69, count#70]
+Arguments: hashpartitioning(i_brand_id#61, i_class_id#62, i_category_id#63, 5), ENSURE_REQUIREMENTS, [plan_id=10]
 
 (80) HashAggregate [codegen id : 51]
-Input [6]: [i_brand_id#60, i_class_id#61, i_category_id#62, sum#67, isEmpty#68, count#69]
-Keys [3]: [i_brand_id#60, i_class_id#61, i_category_id#62]
+Input [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#68, isEmpty#69, count#70]
+Keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
 Functions [2]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56)), count(1)]
-Aggregate Attributes [2]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#70, count(1)#71]
-Results [6]: [store AS channel#72, i_brand_id#60, i_class_id#61, i_category_id#62, sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#70 AS sales#73, count(1)#71 AS number_sales#74]
+Aggregate Attributes [2]: [sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#71, count(1)#72]
+Results [6]: [store AS channel#73, i_brand_id#61, i_class_id#62, i_category_id#63, sum((cast(ss_quantity#55 as decimal(10,0)) * ss_list_price#56))#71 AS sales#74, count(1)#72 AS number_sales#75]
 
 (81) Filter [codegen id : 51]
-Input [6]: [channel#72, i_brand_id#60, i_class_id#61, i_category_id#62, sales#73, number_sales#74]
-Condition : (isnotnull(sales#73) AND (cast(sales#73 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
+Input [6]: [channel#73, i_brand_id#61, i_class_id#62, i_category_id#63, sales#74, number_sales#75]
+Condition : (isnotnull(sales#74) AND (cast(sales#74 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
 
 (82) BroadcastExchange
-Input [6]: [channel#72, i_brand_id#60, i_class_id#61, i_category_id#62, sales#73, number_sales#74]
+Input [6]: [channel#73, i_brand_id#61, i_class_id#62, i_category_id#63, sales#74, number_sales#75]
 Arguments: HashedRelationBroadcastMode(List(input[1, int, true], input[2, int, true], input[3, int, true]),false), [plan_id=11]
 
 (83) BroadcastHashJoin [codegen id : 52]
 Left keys [3]: [i_brand_id#37, i_class_id#38, i_category_id#39]
-Right keys [3]: [i_brand_id#60, i_class_id#61, i_category_id#62]
+Right keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
 Join type: Inner
 Join condition: None
 
 (84) TakeOrderedAndProject
-Input [12]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sales#50, number_sales#51, channel#72, i_brand_id#60, i_class_id#61, i_category_id#62, sales#73, number_sales#74]
-Arguments: 100, [i_brand_id#37 ASC NULLS FIRST, i_class_id#38 ASC NULLS FIRST, i_category_id#39 ASC NULLS FIRST], [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sales#50, number_sales#51, channel#72, i_brand_id#60, i_class_id#61, i_category_id#62, sales#73, number_sales#74]
+Input [12]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sales#50, number_sales#51, channel#73, i_brand_id#61, i_class_id#62, i_category_id#63, sales#74, number_sales#75]
+Arguments: 100, [i_brand_id#37 ASC NULLS FIRST, i_class_id#38 ASC NULLS FIRST, i_category_id#39 ASC NULLS FIRST], [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sales#50, number_sales#51, channel#73, i_brand_id#61, i_class_id#62, i_category_id#63, sales#74, number_sales#75]
 
 ===== Subqueries =====
 
@@ -512,99 +512,99 @@ Subquery:1 Hosting operator id = 66 Hosting Expression = Subquery scalar-subquer
 
 
 (85) Scan parquet spark_catalog.default.store_sales
-Output [3]: [ss_quantity#75, ss_list_price#76, ss_sold_date_sk#77]
+Output [3]: [ss_quantity#76, ss_list_price#77, ss_sold_date_sk#78]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#77), dynamicpruningexpression(ss_sold_date_sk#77 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#78), dynamicpruningexpression(ss_sold_date_sk#78 IN dynamicpruning#12)]
 ReadSchema: struct<ss_quantity:int,ss_list_price:decimal(7,2)>
 
 (86) ColumnarToRow [codegen id : 2]
-Input [3]: [ss_quantity#75, ss_list_price#76, ss_sold_date_sk#77]
+Input [3]: [ss_quantity#76, ss_list_price#77, ss_sold_date_sk#78]
 
 (87) ReusedExchange [Reuses operator id: 117]
-Output [1]: [d_date_sk#78]
+Output [1]: [d_date_sk#79]
 
 (88) BroadcastHashJoin [codegen id : 2]
-Left keys [1]: [ss_sold_date_sk#77]
-Right keys [1]: [d_date_sk#78]
+Left keys [1]: [ss_sold_date_sk#78]
+Right keys [1]: [d_date_sk#79]
 Join type: Inner
 Join condition: None
 
 (89) Project [codegen id : 2]
-Output [2]: [ss_quantity#75 AS quantity#79, ss_list_price#76 AS list_price#80]
-Input [4]: [ss_quantity#75, ss_list_price#76, ss_sold_date_sk#77, d_date_sk#78]
+Output [2]: [ss_quantity#76 AS quantity#80, ss_list_price#77 AS list_price#81]
+Input [4]: [ss_quantity#76, ss_list_price#77, ss_sold_date_sk#78, d_date_sk#79]
 
 (90) Scan parquet spark_catalog.default.catalog_sales
-Output [3]: [cs_quantity#81, cs_list_price#82, cs_sold_date_sk#83]
+Output [3]: [cs_quantity#82, cs_list_price#83, cs_sold_date_sk#84]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#83), dynamicpruningexpression(cs_sold_date_sk#83 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#84), dynamicpruningexpression(cs_sold_date_sk#84 IN dynamicpruning#12)]
 ReadSchema: struct<cs_quantity:int,cs_list_price:decimal(7,2)>
 
 (91) ColumnarToRow [codegen id : 4]
-Input [3]: [cs_quantity#81, cs_list_price#82, cs_sold_date_sk#83]
+Input [3]: [cs_quantity#82, cs_list_price#83, cs_sold_date_sk#84]
 
 (92) ReusedExchange [Reuses operator id: 117]
-Output [1]: [d_date_sk#84]
+Output [1]: [d_date_sk#85]
 
 (93) BroadcastHashJoin [codegen id : 4]
-Left keys [1]: [cs_sold_date_sk#83]
-Right keys [1]: [d_date_sk#84]
+Left keys [1]: [cs_sold_date_sk#84]
+Right keys [1]: [d_date_sk#85]
 Join type: Inner
 Join condition: None
 
 (94) Project [codegen id : 4]
-Output [2]: [cs_quantity#81 AS quantity#85, cs_list_price#82 AS list_price#86]
-Input [4]: [cs_quantity#81, cs_list_price#82, cs_sold_date_sk#83, d_date_sk#84]
+Output [2]: [cs_quantity#82 AS quantity#86, cs_list_price#83 AS list_price#87]
+Input [4]: [cs_quantity#82, cs_list_price#83, cs_sold_date_sk#84, d_date_sk#85]
 
 (95) Scan parquet spark_catalog.default.web_sales
-Output [3]: [ws_quantity#87, ws_list_price#88, ws_sold_date_sk#89]
+Output [3]: [ws_quantity#88, ws_list_price#89, ws_sold_date_sk#90]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#89), dynamicpruningexpression(ws_sold_date_sk#89 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#90), dynamicpruningexpression(ws_sold_date_sk#90 IN dynamicpruning#12)]
 ReadSchema: struct<ws_quantity:int,ws_list_price:decimal(7,2)>
 
 (96) ColumnarToRow [codegen id : 6]
-Input [3]: [ws_quantity#87, ws_list_price#88, ws_sold_date_sk#89]
+Input [3]: [ws_quantity#88, ws_list_price#89, ws_sold_date_sk#90]
 
 (97) ReusedExchange [Reuses operator id: 117]
-Output [1]: [d_date_sk#90]
+Output [1]: [d_date_sk#91]
 
 (98) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [ws_sold_date_sk#89]
-Right keys [1]: [d_date_sk#90]
+Left keys [1]: [ws_sold_date_sk#90]
+Right keys [1]: [d_date_sk#91]
 Join type: Inner
 Join condition: None
 
 (99) Project [codegen id : 6]
-Output [2]: [ws_quantity#87 AS quantity#91, ws_list_price#88 AS list_price#92]
-Input [4]: [ws_quantity#87, ws_list_price#88, ws_sold_date_sk#89, d_date_sk#90]
+Output [2]: [ws_quantity#88 AS quantity#92, ws_list_price#89 AS list_price#93]
+Input [4]: [ws_quantity#88, ws_list_price#89, ws_sold_date_sk#90, d_date_sk#91]
 
 (100) Union
 
 (101) HashAggregate [codegen id : 7]
-Input [2]: [quantity#79, list_price#80]
+Input [2]: [quantity#80, list_price#81]
 Keys: []
-Functions [1]: [partial_avg((cast(quantity#79 as decimal(10,0)) * list_price#80))]
-Aggregate Attributes [2]: [sum#93, count#94]
-Results [2]: [sum#95, count#96]
+Functions [1]: [partial_avg((cast(quantity#80 as decimal(10,0)) * list_price#81))]
+Aggregate Attributes [2]: [sum#94, count#95]
+Results [2]: [sum#96, count#97]
 
 (102) Exchange
-Input [2]: [sum#95, count#96]
+Input [2]: [sum#96, count#97]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=12]
 
 (103) HashAggregate [codegen id : 8]
-Input [2]: [sum#95, count#96]
+Input [2]: [sum#96, count#97]
 Keys: []
-Functions [1]: [avg((cast(quantity#79 as decimal(10,0)) * list_price#80))]
-Aggregate Attributes [1]: [avg((cast(quantity#79 as decimal(10,0)) * list_price#80))#97]
-Results [1]: [avg((cast(quantity#79 as decimal(10,0)) * list_price#80))#97 AS average_sales#98]
+Functions [1]: [avg((cast(quantity#80 as decimal(10,0)) * list_price#81))]
+Aggregate Attributes [1]: [avg((cast(quantity#80 as decimal(10,0)) * list_price#81))#98]
+Results [1]: [avg((cast(quantity#80 as decimal(10,0)) * list_price#81))#98 AS average_sales#99]
 
-Subquery:2 Hosting operator id = 85 Hosting Expression = ss_sold_date_sk#77 IN dynamicpruning#12
+Subquery:2 Hosting operator id = 85 Hosting Expression = ss_sold_date_sk#78 IN dynamicpruning#12
 
-Subquery:3 Hosting operator id = 90 Hosting Expression = cs_sold_date_sk#83 IN dynamicpruning#12
+Subquery:3 Hosting operator id = 90 Hosting Expression = cs_sold_date_sk#84 IN dynamicpruning#12
 
-Subquery:4 Hosting operator id = 95 Hosting Expression = ws_sold_date_sk#89 IN dynamicpruning#12
+Subquery:4 Hosting operator id = 95 Hosting Expression = ws_sold_date_sk#90 IN dynamicpruning#12
 
 Subquery:5 Hosting operator id = 1 Hosting Expression = ss_sold_date_sk#4 IN dynamicpruning#5
 BroadcastExchange (108)
@@ -615,28 +615,28 @@ BroadcastExchange (108)
 
 
 (104) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#40, d_week_seq#99]
+Output [2]: [d_date_sk#40, d_week_seq#100]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_week_seq:int>
 
 (105) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#40, d_week_seq#99]
+Input [2]: [d_date_sk#40, d_week_seq#100]
 
 (106) Filter [codegen id : 1]
-Input [2]: [d_date_sk#40, d_week_seq#99]
-Condition : ((isnotnull(d_week_seq#99) AND (d_week_seq#99 = Subquery scalar-subquery#100, [id=#101])) AND isnotnull(d_date_sk#40))
+Input [2]: [d_date_sk#40, d_week_seq#100]
+Condition : ((isnotnull(d_week_seq#100) AND (d_week_seq#100 = Subquery scalar-subquery#101, [id=#102])) AND isnotnull(d_date_sk#40))
 
 (107) Project [codegen id : 1]
 Output [1]: [d_date_sk#40]
-Input [2]: [d_date_sk#40, d_week_seq#99]
+Input [2]: [d_date_sk#40, d_week_seq#100]
 
 (108) BroadcastExchange
 Input [1]: [d_date_sk#40]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=13]
 
-Subquery:6 Hosting operator id = 106 Hosting Expression = Subquery scalar-subquery#100, [id=#101]
+Subquery:6 Hosting operator id = 106 Hosting Expression = Subquery scalar-subquery#101, [id=#102]
 * Project (112)
 +- * Filter (111)
    +- * ColumnarToRow (110)
@@ -644,22 +644,22 @@ Subquery:6 Hosting operator id = 106 Hosting Expression = Subquery scalar-subque
 
 
 (109) Scan parquet spark_catalog.default.date_dim
-Output [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
+Output [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), EqualTo(d_dom,16)]
 ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
 
 (110) ColumnarToRow [codegen id : 1]
-Input [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
+Input [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
 
 (111) Filter [codegen id : 1]
-Input [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
-Condition : (((((isnotnull(d_year#103) AND isnotnull(d_moy#104)) AND isnotnull(d_dom#105)) AND (d_year#103 = 1999)) AND (d_moy#104 = 12)) AND (d_dom#105 = 16))
+Input [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
+Condition : (((((isnotnull(d_year#104) AND isnotnull(d_moy#105)) AND isnotnull(d_dom#106)) AND (d_year#104 = 1999)) AND (d_moy#105 = 12)) AND (d_dom#106 = 16))
 
 (112) Project [codegen id : 1]
-Output [1]: [d_week_seq#102]
-Input [4]: [d_week_seq#102, d_year#103, d_moy#104, d_dom#105]
+Output [1]: [d_week_seq#103]
+Input [4]: [d_week_seq#103, d_year#104, d_moy#105, d_dom#106]
 
 Subquery:7 Hosting operator id = 7 Hosting Expression = ss_sold_date_sk#11 IN dynamicpruning#12
 BroadcastExchange (117)
@@ -670,22 +670,22 @@ BroadcastExchange (117)
 
 
 (113) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#24, d_year#106]
+Output [2]: [d_date_sk#24, d_year#107]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (114) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#24, d_year#106]
+Input [2]: [d_date_sk#24, d_year#107]
 
 (115) Filter [codegen id : 1]
-Input [2]: [d_date_sk#24, d_year#106]
-Condition : (((isnotnull(d_year#106) AND (d_year#106 >= 1998)) AND (d_year#106 <= 2000)) AND isnotnull(d_date_sk#24))
+Input [2]: [d_date_sk#24, d_year#107]
+Condition : (((isnotnull(d_year#107) AND (d_year#107 >= 1998)) AND (d_year#107 <= 2000)) AND isnotnull(d_date_sk#24))
 
 (116) Project [codegen id : 1]
 Output [1]: [d_date_sk#24]
-Input [2]: [d_date_sk#24, d_year#106]
+Input [2]: [d_date_sk#24, d_year#107]
 
 (117) BroadcastExchange
 Input [1]: [d_date_sk#24]
@@ -706,28 +706,28 @@ BroadcastExchange (122)
 
 
 (118) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#63, d_week_seq#107]
+Output [2]: [d_date_sk#64, d_week_seq#108]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_week_seq:int>
 
 (119) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#63, d_week_seq#107]
+Input [2]: [d_date_sk#64, d_week_seq#108]
 
 (120) Filter [codegen id : 1]
-Input [2]: [d_date_sk#63, d_week_seq#107]
-Condition : ((isnotnull(d_week_seq#107) AND (d_week_seq#107 = Subquery scalar-subquery#108, [id=#109])) AND isnotnull(d_date_sk#63))
+Input [2]: [d_date_sk#64, d_week_seq#108]
+Condition : ((isnotnull(d_week_seq#108) AND (d_week_seq#108 = Subquery scalar-subquery#109, [id=#110])) AND isnotnull(d_date_sk#64))
 
 (121) Project [codegen id : 1]
-Output [1]: [d_date_sk#63]
-Input [2]: [d_date_sk#63, d_week_seq#107]
+Output [1]: [d_date_sk#64]
+Input [2]: [d_date_sk#64, d_week_seq#108]
 
 (122) BroadcastExchange
-Input [1]: [d_date_sk#63]
+Input [1]: [d_date_sk#64]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=15]
 
-Subquery:12 Hosting operator id = 120 Hosting Expression = Subquery scalar-subquery#108, [id=#109]
+Subquery:12 Hosting operator id = 120 Hosting Expression = Subquery scalar-subquery#109, [id=#110]
 * Project (126)
 +- * Filter (125)
    +- * ColumnarToRow (124)
@@ -735,21 +735,21 @@ Subquery:12 Hosting operator id = 120 Hosting Expression = Subquery scalar-subqu
 
 
 (123) Scan parquet spark_catalog.default.date_dim
-Output [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
+Output [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1998), EqualTo(d_moy,12), EqualTo(d_dom,16)]
 ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
 
 (124) ColumnarToRow [codegen id : 1]
-Input [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
+Input [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
 
 (125) Filter [codegen id : 1]
-Input [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
-Condition : (((((isnotnull(d_year#111) AND isnotnull(d_moy#112)) AND isnotnull(d_dom#113)) AND (d_year#111 = 1998)) AND (d_moy#112 = 12)) AND (d_dom#113 = 16))
+Input [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
+Condition : (((((isnotnull(d_year#112) AND isnotnull(d_moy#113)) AND isnotnull(d_dom#114)) AND (d_year#112 = 1998)) AND (d_moy#113 = 12)) AND (d_dom#114 = 16))
 
 (126) Project [codegen id : 1]
-Output [1]: [d_week_seq#110]
-Input [4]: [d_week_seq#110, d_year#111, d_moy#112, d_dom#113]
+Output [1]: [d_week_seq#111]
+Input [4]: [d_week_seq#111, d_year#112, d_moy#113, d_dom#114]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14a.sf100/explain.txt
index 9527bf6a061..0de177a1710 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14a.sf100/explain.txt
@@ -488,133 +488,133 @@ Input [4]: [cs_item_sk#54, cs_quantity#55, cs_list_price#56, cs_sold_date_sk#57]
 Condition : isnotnull(cs_item_sk#54)
 
 (76) ReusedExchange [Reuses operator id: 56]
-Output [1]: [ss_item_sk#35]
+Output [1]: [ss_item_sk#58]
 
 (77) BroadcastHashJoin [codegen id : 75]
 Left keys [1]: [cs_item_sk#54]
-Right keys [1]: [ss_item_sk#35]
+Right keys [1]: [ss_item_sk#58]
 Join type: LeftSemi
 Join condition: None
 
 (78) ReusedExchange [Reuses operator id: 160]
-Output [1]: [d_date_sk#58]
+Output [1]: [d_date_sk#59]
 
 (79) BroadcastHashJoin [codegen id : 75]
 Left keys [1]: [cs_sold_date_sk#57]
-Right keys [1]: [d_date_sk#58]
+Right keys [1]: [d_date_sk#59]
 Join type: Inner
 Join condition: None
 
 (80) Project [codegen id : 75]
 Output [3]: [cs_item_sk#54, cs_quantity#55, cs_list_price#56]
-Input [5]: [cs_item_sk#54, cs_quantity#55, cs_list_price#56, cs_sold_date_sk#57, d_date_sk#58]
+Input [5]: [cs_item_sk#54, cs_quantity#55, cs_list_price#56, cs_sold_date_sk#57, d_date_sk#59]
 
 (81) ReusedExchange [Reuses operator id: 66]
-Output [4]: [i_item_sk#59, i_brand_id#60, i_class_id#61, i_category_id#62]
+Output [4]: [i_item_sk#60, i_brand_id#61, i_class_id#62, i_category_id#63]
 
 (82) BroadcastHashJoin [codegen id : 75]
 Left keys [1]: [cs_item_sk#54]
-Right keys [1]: [i_item_sk#59]
+Right keys [1]: [i_item_sk#60]
 Join type: Inner
 Join condition: None
 
 (83) Project [codegen id : 75]
-Output [5]: [cs_quantity#55, cs_list_price#56, i_brand_id#60, i_class_id#61, i_category_id#62]
-Input [7]: [cs_item_sk#54, cs_quantity#55, cs_list_price#56, i_item_sk#59, i_brand_id#60, i_class_id#61, i_category_id#62]
+Output [5]: [cs_quantity#55, cs_list_price#56, i_brand_id#61, i_class_id#62, i_category_id#63]
+Input [7]: [cs_item_sk#54, cs_quantity#55, cs_list_price#56, i_item_sk#60, i_brand_id#61, i_class_id#62, i_category_id#63]
 
 (84) HashAggregate [codegen id : 75]
-Input [5]: [cs_quantity#55, cs_list_price#56, i_brand_id#60, i_class_id#61, i_category_id#62]
-Keys [3]: [i_brand_id#60, i_class_id#61, i_category_id#62]
+Input [5]: [cs_quantity#55, cs_list_price#56, i_brand_id#61, i_class_id#62, i_category_id#63]
+Keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
 Functions [2]: [partial_sum((cast(cs_quantity#55 as decimal(10,0)) * cs_list_price#56)), partial_count(1)]
-Aggregate Attributes [3]: [sum#63, isEmpty#64, count#65]
-Results [6]: [i_brand_id#60, i_class_id#61, i_category_id#62, sum#66, isEmpty#67, count#68]
+Aggregate Attributes [3]: [sum#64, isEmpty#65, count#66]
+Results [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#67, isEmpty#68, count#69]
 
 (85) Exchange
-Input [6]: [i_brand_id#60, i_class_id#61, i_category_id#62, sum#66, isEmpty#67, count#68]
-Arguments: hashpartitioning(i_brand_id#60, i_class_id#61, i_category_id#62, 5), ENSURE_REQUIREMENTS, [plan_id=12]
+Input [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#67, isEmpty#68, count#69]
+Arguments: hashpartitioning(i_brand_id#61, i_class_id#62, i_category_id#63, 5), ENSURE_REQUIREMENTS, [plan_id=12]
 
 (86) HashAggregate [codegen id : 76]
-Input [6]: [i_brand_id#60, i_class_id#61, i_category_id#62, sum#66, isEmpty#67, count#68]
-Keys [3]: [i_brand_id#60, i_class_id#61, i_category_id#62]
+Input [6]: [i_brand_id#61, i_class_id#62, i_category_id#63, sum#67, isEmpty#68, count#69]
+Keys [3]: [i_brand_id#61, i_class_id#62, i_category_id#63]
 Functions [2]: [sum((cast(cs_quantity#55 as decimal(10,0)) * cs_list_price#56)), count(1)]
-Aggregate Attributes [2]: [sum((cast(cs_quantity#55 as decimal(10,0)) * cs_list_price#56))#69, count(1)#70]
-Results [6]: [catalog AS channel#71, i_brand_id#60, i_class_id#61, i_category_id#62, sum((cast(cs_quantity#55 as decimal(10,0)) * cs_list_price#56))#69 AS sales#72, count(1)#70 AS number_sales#73]
+Aggregate Attributes [2]: [sum((cast(cs_quantity#55 as decimal(10,0)) * cs_list_price#56))#70, count(1)#71]
+Results [6]: [catalog AS channel#72, i_brand_id#61, i_class_id#62, i_category_id#63, sum((cast(cs_quantity#55 as decimal(10,0)) * cs_list_price#56))#70 AS sales#73, count(1)#71 AS number_sales#74]
 
 (87) Filter [codegen id : 76]
-Input [6]: [channel#71, i_brand_id#60, i_class_id#61, i_category_id#62, sales#72, number_sales#73]
-Condition : (isnotnull(sales#72) AND (cast(sales#72 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
+Input [6]: [channel#72, i_brand_id#61, i_class_id#62, i_category_id#63, sales#73, number_sales#74]
+Condition : (isnotnull(sales#73) AND (cast(sales#73 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
 
 (88) Scan parquet spark_catalog.default.web_sales
-Output [4]: [ws_item_sk#74, ws_quantity#75, ws_list_price#76, ws_sold_date_sk#77]
+Output [4]: [ws_item_sk#75, ws_quantity#76, ws_list_price#77, ws_sold_date_sk#78]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#77), dynamicpruningexpression(ws_sold_date_sk#77 IN dynamicpruning#5)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#78), dynamicpruningexpression(ws_sold_date_sk#78 IN dynamicpruning#5)]
 PushedFilters: [IsNotNull(ws_item_sk)]
 ReadSchema: struct<ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
 
 (89) ColumnarToRow [codegen id : 113]
-Input [4]: [ws_item_sk#74, ws_quantity#75, ws_list_price#76, ws_sold_date_sk#77]
+Input [4]: [ws_item_sk#75, ws_quantity#76, ws_list_price#77, ws_sold_date_sk#78]
 
 (90) Filter [codegen id : 113]
-Input [4]: [ws_item_sk#74, ws_quantity#75, ws_list_price#76, ws_sold_date_sk#77]
-Condition : isnotnull(ws_item_sk#74)
+Input [4]: [ws_item_sk#75, ws_quantity#76, ws_list_price#77, ws_sold_date_sk#78]
+Condition : isnotnull(ws_item_sk#75)
 
 (91) ReusedExchange [Reuses operator id: 56]
-Output [1]: [ss_item_sk#35]
+Output [1]: [ss_item_sk#79]
 
 (92) BroadcastHashJoin [codegen id : 113]
-Left keys [1]: [ws_item_sk#74]
-Right keys [1]: [ss_item_sk#35]
+Left keys [1]: [ws_item_sk#75]
+Right keys [1]: [ss_item_sk#79]
 Join type: LeftSemi
 Join condition: None
 
 (93) ReusedExchange [Reuses operator id: 160]
-Output [1]: [d_date_sk#78]
+Output [1]: [d_date_sk#80]
 
 (94) BroadcastHashJoin [codegen id : 113]
-Left keys [1]: [ws_sold_date_sk#77]
-Right keys [1]: [d_date_sk#78]
+Left keys [1]: [ws_sold_date_sk#78]
+Right keys [1]: [d_date_sk#80]
 Join type: Inner
 Join condition: None
 
 (95) Project [codegen id : 113]
-Output [3]: [ws_item_sk#74, ws_quantity#75, ws_list_price#76]
-Input [5]: [ws_item_sk#74, ws_quantity#75, ws_list_price#76, ws_sold_date_sk#77, d_date_sk#78]
+Output [3]: [ws_item_sk#75, ws_quantity#76, ws_list_price#77]
+Input [5]: [ws_item_sk#75, ws_quantity#76, ws_list_price#77, ws_sold_date_sk#78, d_date_sk#80]
 
 (96) ReusedExchange [Reuses operator id: 66]
-Output [4]: [i_item_sk#79, i_brand_id#80, i_class_id#81, i_category_id#82]
+Output [4]: [i_item_sk#81, i_brand_id#82, i_class_id#83, i_category_id#84]
 
 (97) BroadcastHashJoin [codegen id : 113]
-Left keys [1]: [ws_item_sk#74]
-Right keys [1]: [i_item_sk#79]
+Left keys [1]: [ws_item_sk#75]
+Right keys [1]: [i_item_sk#81]
 Join type: Inner
 Join condition: None
 
 (98) Project [codegen id : 113]
-Output [5]: [ws_quantity#75, ws_list_price#76, i_brand_id#80, i_class_id#81, i_category_id#82]
-Input [7]: [ws_item_sk#74, ws_quantity#75, ws_list_price#76, i_item_sk#79, i_brand_id#80, i_class_id#81, i_category_id#82]
+Output [5]: [ws_quantity#76, ws_list_price#77, i_brand_id#82, i_class_id#83, i_category_id#84]
+Input [7]: [ws_item_sk#75, ws_quantity#76, ws_list_price#77, i_item_sk#81, i_brand_id#82, i_class_id#83, i_category_id#84]
 
 (99) HashAggregate [codegen id : 113]
-Input [5]: [ws_quantity#75, ws_list_price#76, i_brand_id#80, i_class_id#81, i_category_id#82]
-Keys [3]: [i_brand_id#80, i_class_id#81, i_category_id#82]
-Functions [2]: [partial_sum((cast(ws_quantity#75 as decimal(10,0)) * ws_list_price#76)), partial_count(1)]
-Aggregate Attributes [3]: [sum#83, isEmpty#84, count#85]
-Results [6]: [i_brand_id#80, i_class_id#81, i_category_id#82, sum#86, isEmpty#87, count#88]
+Input [5]: [ws_quantity#76, ws_list_price#77, i_brand_id#82, i_class_id#83, i_category_id#84]
+Keys [3]: [i_brand_id#82, i_class_id#83, i_category_id#84]
+Functions [2]: [partial_sum((cast(ws_quantity#76 as decimal(10,0)) * ws_list_price#77)), partial_count(1)]
+Aggregate Attributes [3]: [sum#85, isEmpty#86, count#87]
+Results [6]: [i_brand_id#82, i_class_id#83, i_category_id#84, sum#88, isEmpty#89, count#90]
 
 (100) Exchange
-Input [6]: [i_brand_id#80, i_class_id#81, i_category_id#82, sum#86, isEmpty#87, count#88]
-Arguments: hashpartitioning(i_brand_id#80, i_class_id#81, i_category_id#82, 5), ENSURE_REQUIREMENTS, [plan_id=13]
+Input [6]: [i_brand_id#82, i_class_id#83, i_category_id#84, sum#88, isEmpty#89, count#90]
+Arguments: hashpartitioning(i_brand_id#82, i_class_id#83, i_category_id#84, 5), ENSURE_REQUIREMENTS, [plan_id=13]
 
 (101) HashAggregate [codegen id : 114]
-Input [6]: [i_brand_id#80, i_class_id#81, i_category_id#82, sum#86, isEmpty#87, count#88]
-Keys [3]: [i_brand_id#80, i_class_id#81, i_category_id#82]
-Functions [2]: [sum((cast(ws_quantity#75 as decimal(10,0)) * ws_list_price#76)), count(1)]
-Aggregate Attributes [2]: [sum((cast(ws_quantity#75 as decimal(10,0)) * ws_list_price#76))#89, count(1)#90]
-Results [6]: [web AS channel#91, i_brand_id#80, i_class_id#81, i_category_id#82, sum((cast(ws_quantity#75 as decimal(10,0)) * ws_list_price#76))#89 AS sales#92, count(1)#90 AS number_sales#93]
+Input [6]: [i_brand_id#82, i_class_id#83, i_category_id#84, sum#88, isEmpty#89, count#90]
+Keys [3]: [i_brand_id#82, i_class_id#83, i_category_id#84]
+Functions [2]: [sum((cast(ws_quantity#76 as decimal(10,0)) * ws_list_price#77)), count(1)]
+Aggregate Attributes [2]: [sum((cast(ws_quantity#76 as decimal(10,0)) * ws_list_price#77))#91, count(1)#92]
+Results [6]: [web AS channel#93, i_brand_id#82, i_class_id#83, i_category_id#84, sum((cast(ws_quantity#76 as decimal(10,0)) * ws_list_price#77))#91 AS sales#94, count(1)#92 AS number_sales#95]
 
 (102) Filter [codegen id : 114]
-Input [6]: [channel#91, i_brand_id#80, i_class_id#81, i_category_id#82, sales#92, number_sales#93]
-Condition : (isnotnull(sales#92) AND (cast(sales#92 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
+Input [6]: [channel#93, i_brand_id#82, i_class_id#83, i_category_id#84, sales#94, number_sales#95]
+Condition : (isnotnull(sales#94) AND (cast(sales#94 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
 
 (103) Union
 
@@ -622,155 +622,155 @@ Condition : (isnotnull(sales#92) AND (cast(sales#92 as decimal(32,6)) > cast(Reu
 Input [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sales#50, number_sales#51]
 Keys [4]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40]
 Functions [2]: [partial_sum(sales#50), partial_sum(number_sales#51)]
-Aggregate Attributes [3]: [sum#94, isEmpty#95, sum#96]
-Results [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#97, isEmpty#98, sum#99]
+Aggregate Attributes [3]: [sum#96, isEmpty#97, sum#98]
+Results [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#99, isEmpty#100, sum#101]
 
 (105) Exchange
-Input [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#97, isEmpty#98, sum#99]
+Input [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#99, isEmpty#100, sum#101]
 Arguments: hashpartitioning(channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, 5), ENSURE_REQUIREMENTS, [plan_id=14]
 
 (106) HashAggregate [codegen id : 116]
-Input [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#97, isEmpty#98, sum#99]
+Input [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#99, isEmpty#100, sum#101]
 Keys [4]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40]
 Functions [2]: [sum(sales#50), sum(number_sales#51)]
-Aggregate Attributes [2]: [sum(sales#50)#100, sum(number_sales#51)#101]
-Results [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum(sales#50)#100 AS sum_sales#102, sum(number_sales#51)#101 AS number_sales#103]
+Aggregate Attributes [2]: [sum(sales#50)#102, sum(number_sales#51)#103]
+Results [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum(sales#50)#102 AS sum_sales#104, sum(number_sales#51)#103 AS number_sales#105]
 
 (107) ReusedExchange [Reuses operator id: 105]
-Output [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#97, isEmpty#98, sum#99]
+Output [7]: [channel#49, i_brand_id#106, i_class_id#107, i_category_id#108, sum#99, isEmpty#100, sum#101]
 
 (108) HashAggregate [codegen id : 232]
-Input [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#97, isEmpty#98, sum#99]
-Keys [4]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40]
+Input [7]: [channel#49, i_brand_id#106, i_class_id#107, i_category_id#108, sum#99, isEmpty#100, sum#101]
+Keys [4]: [channel#49, i_brand_id#106, i_class_id#107, i_category_id#108]
 Functions [2]: [sum(sales#50), sum(number_sales#51)]
-Aggregate Attributes [2]: [sum(sales#50)#100, sum(number_sales#51)#101]
-Results [5]: [channel#49, i_brand_id#38, i_class_id#39, sum(sales#50)#100 AS sum_sales#102, sum(number_sales#51)#101 AS number_sales#103]
+Aggregate Attributes [2]: [sum(sales#50)#102, sum(number_sales#51)#103]
+Results [5]: [channel#49, i_brand_id#106, i_class_id#107, sum(sales#50)#102 AS sum_sales#109, sum(number_sales#51)#103 AS number_sales#110]
 
 (109) HashAggregate [codegen id : 232]
-Input [5]: [channel#49, i_brand_id#38, i_class_id#39, sum_sales#102, number_sales#103]
-Keys [3]: [channel#49, i_brand_id#38, i_class_id#39]
-Functions [2]: [partial_sum(sum_sales#102), partial_sum(number_sales#103)]
-Aggregate Attributes [3]: [sum#104, isEmpty#105, sum#106]
-Results [6]: [channel#49, i_brand_id#38, i_class_id#39, sum#107, isEmpty#108, sum#109]
+Input [5]: [channel#49, i_brand_id#106, i_class_id#107, sum_sales#109, number_sales#110]
+Keys [3]: [channel#49, i_brand_id#106, i_class_id#107]
+Functions [2]: [partial_sum(sum_sales#109), partial_sum(number_sales#110)]
+Aggregate Attributes [3]: [sum#111, isEmpty#112, sum#113]
+Results [6]: [channel#49, i_brand_id#106, i_class_id#107, sum#114, isEmpty#115, sum#116]
 
 (110) Exchange
-Input [6]: [channel#49, i_brand_id#38, i_class_id#39, sum#107, isEmpty#108, sum#109]
-Arguments: hashpartitioning(channel#49, i_brand_id#38, i_class_id#39, 5), ENSURE_REQUIREMENTS, [plan_id=15]
+Input [6]: [channel#49, i_brand_id#106, i_class_id#107, sum#114, isEmpty#115, sum#116]
+Arguments: hashpartitioning(channel#49, i_brand_id#106, i_class_id#107, 5), ENSURE_REQUIREMENTS, [plan_id=15]
 
 (111) HashAggregate [codegen id : 233]
-Input [6]: [channel#49, i_brand_id#38, i_class_id#39, sum#107, isEmpty#108, sum#109]
-Keys [3]: [channel#49, i_brand_id#38, i_class_id#39]
-Functions [2]: [sum(sum_sales#102), sum(number_sales#103)]
-Aggregate Attributes [2]: [sum(sum_sales#102)#110, sum(number_sales#103)#111]
-Results [6]: [channel#49, i_brand_id#38, i_class_id#39, null AS i_category_id#112, sum(sum_sales#102)#110 AS sum(sum_sales)#113, sum(number_sales#103)#111 AS sum(number_sales)#114]
+Input [6]: [channel#49, i_brand_id#106, i_class_id#107, sum#114, isEmpty#115, sum#116]
+Keys [3]: [channel#49, i_brand_id#106, i_class_id#107]
+Functions [2]: [sum(sum_sales#109), sum(number_sales#110)]
+Aggregate Attributes [2]: [sum(sum_sales#109)#117, sum(number_sales#110)#118]
+Results [6]: [channel#49, i_brand_id#106, i_class_id#107, null AS i_category_id#119, sum(sum_sales#109)#117 AS sum(sum_sales)#120, sum(number_sales#110)#118 AS sum(number_sales)#121]
 
 (112) ReusedExchange [Reuses operator id: 105]
-Output [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#97, isEmpty#98, sum#99]
+Output [7]: [channel#49, i_brand_id#122, i_class_id#123, i_category_id#124, sum#99, isEmpty#100, sum#101]
 
 (113) HashAggregate [codegen id : 349]
-Input [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#97, isEmpty#98, sum#99]
-Keys [4]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40]
+Input [7]: [channel#49, i_brand_id#122, i_class_id#123, i_category_id#124, sum#99, isEmpty#100, sum#101]
+Keys [4]: [channel#49, i_brand_id#122, i_class_id#123, i_category_id#124]
 Functions [2]: [sum(sales#50), sum(number_sales#51)]
-Aggregate Attributes [2]: [sum(sales#50)#100, sum(number_sales#51)#101]
-Results [4]: [channel#49, i_brand_id#38, sum(sales#50)#100 AS sum_sales#102, sum(number_sales#51)#101 AS number_sales#103]
+Aggregate Attributes [2]: [sum(sales#50)#102, sum(number_sales#51)#103]
+Results [4]: [channel#49, i_brand_id#122, sum(sales#50)#102 AS sum_sales#125, sum(number_sales#51)#103 AS number_sales#126]
 
 (114) HashAggregate [codegen id : 349]
-Input [4]: [channel#49, i_brand_id#38, sum_sales#102, number_sales#103]
-Keys [2]: [channel#49, i_brand_id#38]
-Functions [2]: [partial_sum(sum_sales#102), partial_sum(number_sales#103)]
-Aggregate Attributes [3]: [sum#115, isEmpty#116, sum#117]
-Results [5]: [channel#49, i_brand_id#38, sum#118, isEmpty#119, sum#120]
+Input [4]: [channel#49, i_brand_id#122, sum_sales#125, number_sales#126]
+Keys [2]: [channel#49, i_brand_id#122]
+Functions [2]: [partial_sum(sum_sales#125), partial_sum(number_sales#126)]
+Aggregate Attributes [3]: [sum#127, isEmpty#128, sum#129]
+Results [5]: [channel#49, i_brand_id#122, sum#130, isEmpty#131, sum#132]
 
 (115) Exchange
-Input [5]: [channel#49, i_brand_id#38, sum#118, isEmpty#119, sum#120]
-Arguments: hashpartitioning(channel#49, i_brand_id#38, 5), ENSURE_REQUIREMENTS, [plan_id=16]
+Input [5]: [channel#49, i_brand_id#122, sum#130, isEmpty#131, sum#132]
+Arguments: hashpartitioning(channel#49, i_brand_id#122, 5), ENSURE_REQUIREMENTS, [plan_id=16]
 
 (116) HashAggregate [codegen id : 350]
-Input [5]: [channel#49, i_brand_id#38, sum#118, isEmpty#119, sum#120]
-Keys [2]: [channel#49, i_brand_id#38]
-Functions [2]: [sum(sum_sales#102), sum(number_sales#103)]
-Aggregate Attributes [2]: [sum(sum_sales#102)#121, sum(number_sales#103)#122]
-Results [6]: [channel#49, i_brand_id#38, null AS i_class_id#123, null AS i_category_id#124, sum(sum_sales#102)#121 AS sum(sum_sales)#125, sum(number_sales#103)#122 AS sum(number_sales)#126]
+Input [5]: [channel#49, i_brand_id#122, sum#130, isEmpty#131, sum#132]
+Keys [2]: [channel#49, i_brand_id#122]
+Functions [2]: [sum(sum_sales#125), sum(number_sales#126)]
+Aggregate Attributes [2]: [sum(sum_sales#125)#133, sum(number_sales#126)#134]
+Results [6]: [channel#49, i_brand_id#122, null AS i_class_id#135, null AS i_category_id#136, sum(sum_sales#125)#133 AS sum(sum_sales)#137, sum(number_sales#126)#134 AS sum(number_sales)#138]
 
 (117) ReusedExchange [Reuses operator id: 105]
-Output [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#97, isEmpty#98, sum#99]
+Output [7]: [channel#49, i_brand_id#139, i_class_id#140, i_category_id#141, sum#99, isEmpty#100, sum#101]
 
 (118) HashAggregate [codegen id : 466]
-Input [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#97, isEmpty#98, sum#99]
-Keys [4]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40]
+Input [7]: [channel#49, i_brand_id#139, i_class_id#140, i_category_id#141, sum#99, isEmpty#100, sum#101]
+Keys [4]: [channel#49, i_brand_id#139, i_class_id#140, i_category_id#141]
 Functions [2]: [sum(sales#50), sum(number_sales#51)]
-Aggregate Attributes [2]: [sum(sales#50)#100, sum(number_sales#51)#101]
-Results [3]: [channel#49, sum(sales#50)#100 AS sum_sales#102, sum(number_sales#51)#101 AS number_sales#103]
+Aggregate Attributes [2]: [sum(sales#50)#102, sum(number_sales#51)#103]
+Results [3]: [channel#49, sum(sales#50)#102 AS sum_sales#142, sum(number_sales#51)#103 AS number_sales#143]
 
 (119) HashAggregate [codegen id : 466]
-Input [3]: [channel#49, sum_sales#102, number_sales#103]
+Input [3]: [channel#49, sum_sales#142, number_sales#143]
 Keys [1]: [channel#49]
-Functions [2]: [partial_sum(sum_sales#102), partial_sum(number_sales#103)]
-Aggregate Attributes [3]: [sum#127, isEmpty#128, sum#129]
-Results [4]: [channel#49, sum#130, isEmpty#131, sum#132]
+Functions [2]: [partial_sum(sum_sales#142), partial_sum(number_sales#143)]
+Aggregate Attributes [3]: [sum#144, isEmpty#145, sum#146]
+Results [4]: [channel#49, sum#147, isEmpty#148, sum#149]
 
 (120) Exchange
-Input [4]: [channel#49, sum#130, isEmpty#131, sum#132]
+Input [4]: [channel#49, sum#147, isEmpty#148, sum#149]
 Arguments: hashpartitioning(channel#49, 5), ENSURE_REQUIREMENTS, [plan_id=17]
 
 (121) HashAggregate [codegen id : 467]
-Input [4]: [channel#49, sum#130, isEmpty#131, sum#132]
+Input [4]: [channel#49, sum#147, isEmpty#148, sum#149]
 Keys [1]: [channel#49]
-Functions [2]: [sum(sum_sales#102), sum(number_sales#103)]
-Aggregate Attributes [2]: [sum(sum_sales#102)#133, sum(number_sales#103)#134]
-Results [6]: [channel#49, null AS i_brand_id#135, null AS i_class_id#136, null AS i_category_id#137, sum(sum_sales#102)#133 AS sum(sum_sales)#138, sum(number_sales#103)#134 AS sum(number_sales)#139]
+Functions [2]: [sum(sum_sales#142), sum(number_sales#143)]
+Aggregate Attributes [2]: [sum(sum_sales#142)#150, sum(number_sales#143)#151]
+Results [6]: [channel#49, null AS i_brand_id#152, null AS i_class_id#153, null AS i_category_id#154, sum(sum_sales#142)#150 AS sum(sum_sales)#155, sum(number_sales#143)#151 AS sum(number_sales)#156]
 
 (122) ReusedExchange [Reuses operator id: 105]
-Output [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#97, isEmpty#98, sum#99]
+Output [7]: [channel#49, i_brand_id#157, i_class_id#158, i_category_id#159, sum#99, isEmpty#100, sum#101]
 
 (123) HashAggregate [codegen id : 583]
-Input [7]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum#97, isEmpty#98, sum#99]
-Keys [4]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40]
+Input [7]: [channel#49, i_brand_id#157, i_class_id#158, i_category_id#159, sum#99, isEmpty#100, sum#101]
+Keys [4]: [channel#49, i_brand_id#157, i_class_id#158, i_category_id#159]
 Functions [2]: [sum(sales#50), sum(number_sales#51)]
-Aggregate Attributes [2]: [sum(sales#50)#100, sum(number_sales#51)#101]
-Results [2]: [sum(sales#50)#100 AS sum_sales#102, sum(number_sales#51)#101 AS number_sales#103]
+Aggregate Attributes [2]: [sum(sales#50)#102, sum(number_sales#51)#103]
+Results [2]: [sum(sales#50)#102 AS sum_sales#160, sum(number_sales#51)#103 AS number_sales#161]
 
 (124) HashAggregate [codegen id : 583]
-Input [2]: [sum_sales#102, number_sales#103]
+Input [2]: [sum_sales#160, number_sales#161]
 Keys: []
-Functions [2]: [partial_sum(sum_sales#102), partial_sum(number_sales#103)]
-Aggregate Attributes [3]: [sum#140, isEmpty#141, sum#142]
-Results [3]: [sum#143, isEmpty#144, sum#145]
+Functions [2]: [partial_sum(sum_sales#160), partial_sum(number_sales#161)]
+Aggregate Attributes [3]: [sum#162, isEmpty#163, sum#164]
+Results [3]: [sum#165, isEmpty#166, sum#167]
 
 (125) Exchange
-Input [3]: [sum#143, isEmpty#144, sum#145]
+Input [3]: [sum#165, isEmpty#166, sum#167]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=18]
 
 (126) HashAggregate [codegen id : 584]
-Input [3]: [sum#143, isEmpty#144, sum#145]
+Input [3]: [sum#165, isEmpty#166, sum#167]
 Keys: []
-Functions [2]: [sum(sum_sales#102), sum(number_sales#103)]
-Aggregate Attributes [2]: [sum(sum_sales#102)#146, sum(number_sales#103)#147]
-Results [6]: [null AS channel#148, null AS i_brand_id#149, null AS i_class_id#150, null AS i_category_id#151, sum(sum_sales#102)#146 AS sum(sum_sales)#152, sum(number_sales#103)#147 AS sum(number_sales)#153]
+Functions [2]: [sum(sum_sales#160), sum(number_sales#161)]
+Aggregate Attributes [2]: [sum(sum_sales#160)#168, sum(number_sales#161)#169]
+Results [6]: [null AS channel#170, null AS i_brand_id#171, null AS i_class_id#172, null AS i_category_id#173, sum(sum_sales#160)#168 AS sum(sum_sales)#174, sum(number_sales#161)#169 AS sum(number_sales)#175]
 
 (127) Union
 
 (128) HashAggregate [codegen id : 585]
-Input [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#102, number_sales#103]
-Keys [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#102, number_sales#103]
+Input [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#104, number_sales#105]
+Keys [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#104, number_sales#105]
 Functions: []
 Aggregate Attributes: []
-Results [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#102, number_sales#103]
+Results [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#104, number_sales#105]
 
 (129) Exchange
-Input [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#102, number_sales#103]
-Arguments: hashpartitioning(channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#102, number_sales#103, 5), ENSURE_REQUIREMENTS, [plan_id=19]
+Input [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#104, number_sales#105]
+Arguments: hashpartitioning(channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#104, number_sales#105, 5), ENSURE_REQUIREMENTS, [plan_id=19]
 
 (130) HashAggregate [codegen id : 586]
-Input [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#102, number_sales#103]
-Keys [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#102, number_sales#103]
+Input [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#104, number_sales#105]
+Keys [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#104, number_sales#105]
 Functions: []
 Aggregate Attributes: []
-Results [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#102, number_sales#103]
+Results [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#104, number_sales#105]
 
 (131) TakeOrderedAndProject
-Input [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#102, number_sales#103]
-Arguments: 100, [channel#49 ASC NULLS FIRST, i_brand_id#38 ASC NULLS FIRST, i_class_id#39 ASC NULLS FIRST, i_category_id#40 ASC NULLS FIRST], [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#102, number_sales#103]
+Input [6]: [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#104, number_sales#105]
+Arguments: 100, [channel#49 ASC NULLS FIRST, i_brand_id#38 ASC NULLS FIRST, i_class_id#39 ASC NULLS FIRST, i_category_id#40 ASC NULLS FIRST], [channel#49, i_brand_id#38, i_class_id#39, i_category_id#40, sum_sales#104, number_sales#105]
 
 ===== Subqueries =====
 
@@ -797,97 +797,97 @@ Subquery:1 Hosting operator id = 72 Hosting Expression = Subquery scalar-subquer
 
 
 (132) Scan parquet spark_catalog.default.store_sales
-Output [3]: [ss_quantity#154, ss_list_price#155, ss_sold_date_sk#156]
+Output [3]: [ss_quantity#176, ss_list_price#177, ss_sold_date_sk#178]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#156), dynamicpruningexpression(ss_sold_date_sk#156 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#178), dynamicpruningexpression(ss_sold_date_sk#178 IN dynamicpruning#12)]
 ReadSchema: struct<ss_quantity:int,ss_list_price:decimal(7,2)>
 
 (133) ColumnarToRow [codegen id : 2]
-Input [3]: [ss_quantity#154, ss_list_price#155, ss_sold_date_sk#156]
+Input [3]: [ss_quantity#176, ss_list_price#177, ss_sold_date_sk#178]
 
 (134) ReusedExchange [Reuses operator id: 165]
-Output [1]: [d_date_sk#157]
+Output [1]: [d_date_sk#179]
 
 (135) BroadcastHashJoin [codegen id : 2]
-Left keys [1]: [ss_sold_date_sk#156]
-Right keys [1]: [d_date_sk#157]
+Left keys [1]: [ss_sold_date_sk#178]
+Right keys [1]: [d_date_sk#179]
 Join type: Inner
 Join condition: None
 
 (136) Project [codegen id : 2]
-Output [2]: [ss_quantity#154 AS quantity#158, ss_list_price#155 AS list_price#159]
-Input [4]: [ss_quantity#154, ss_list_price#155, ss_sold_date_sk#156, d_date_sk#157]
+Output [2]: [ss_quantity#176 AS quantity#180, ss_list_price#177 AS list_price#181]
+Input [4]: [ss_quantity#176, ss_list_price#177, ss_sold_date_sk#178, d_date_sk#179]
 
 (137) Scan parquet spark_catalog.default.catalog_sales
-Output [3]: [cs_quantity#160, cs_list_price#161, cs_sold_date_sk#162]
+Output [3]: [cs_quantity#182, cs_list_price#183, cs_sold_date_sk#184]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#162), dynamicpruningexpression(cs_sold_date_sk#162 IN dynamicpruning#163)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#184), dynamicpruningexpression(cs_sold_date_sk#184 IN dynamicpruning#185)]
 ReadSchema: struct<cs_quantity:int,cs_list_price:decimal(7,2)>
 
 (138) ColumnarToRow [codegen id : 4]
-Input [3]: [cs_quantity#160, cs_list_price#161, cs_sold_date_sk#162]
+Input [3]: [cs_quantity#182, cs_list_price#183, cs_sold_date_sk#184]
 
 (139) ReusedExchange [Reuses operator id: 155]
-Output [1]: [d_date_sk#164]
+Output [1]: [d_date_sk#186]
 
 (140) BroadcastHashJoin [codegen id : 4]
-Left keys [1]: [cs_sold_date_sk#162]
-Right keys [1]: [d_date_sk#164]
+Left keys [1]: [cs_sold_date_sk#184]
+Right keys [1]: [d_date_sk#186]
 Join type: Inner
 Join condition: None
 
 (141) Project [codegen id : 4]
-Output [2]: [cs_quantity#160 AS quantity#165, cs_list_price#161 AS list_price#166]
-Input [4]: [cs_quantity#160, cs_list_price#161, cs_sold_date_sk#162, d_date_sk#164]
+Output [2]: [cs_quantity#182 AS quantity#187, cs_list_price#183 AS list_price#188]
+Input [4]: [cs_quantity#182, cs_list_price#183, cs_sold_date_sk#184, d_date_sk#186]
 
 (142) Scan parquet spark_catalog.default.web_sales
-Output [3]: [ws_quantity#167, ws_list_price#168, ws_sold_date_sk#169]
+Output [3]: [ws_quantity#189, ws_list_price#190, ws_sold_date_sk#191]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#169), dynamicpruningexpression(ws_sold_date_sk#169 IN dynamicpruning#163)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#191), dynamicpruningexpression(ws_sold_date_sk#191 IN dynamicpruning#185)]
 ReadSchema: struct<ws_quantity:int,ws_list_price:decimal(7,2)>
 
 (143) ColumnarToRow [codegen id : 6]
-Input [3]: [ws_quantity#167, ws_list_price#168, ws_sold_date_sk#169]
+Input [3]: [ws_quantity#189, ws_list_price#190, ws_sold_date_sk#191]
 
 (144) ReusedExchange [Reuses operator id: 155]
-Output [1]: [d_date_sk#170]
+Output [1]: [d_date_sk#192]
 
 (145) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [ws_sold_date_sk#169]
-Right keys [1]: [d_date_sk#170]
+Left keys [1]: [ws_sold_date_sk#191]
+Right keys [1]: [d_date_sk#192]
 Join type: Inner
 Join condition: None
 
 (146) Project [codegen id : 6]
-Output [2]: [ws_quantity#167 AS quantity#171, ws_list_price#168 AS list_price#172]
-Input [4]: [ws_quantity#167, ws_list_price#168, ws_sold_date_sk#169, d_date_sk#170]
+Output [2]: [ws_quantity#189 AS quantity#193, ws_list_price#190 AS list_price#194]
+Input [4]: [ws_quantity#189, ws_list_price#190, ws_sold_date_sk#191, d_date_sk#192]
 
 (147) Union
 
 (148) HashAggregate [codegen id : 7]
-Input [2]: [quantity#158, list_price#159]
+Input [2]: [quantity#180, list_price#181]
 Keys: []
-Functions [1]: [partial_avg((cast(quantity#158 as decimal(10,0)) * list_price#159))]
-Aggregate Attributes [2]: [sum#173, count#174]
-Results [2]: [sum#175, count#176]
+Functions [1]: [partial_avg((cast(quantity#180 as decimal(10,0)) * list_price#181))]
+Aggregate Attributes [2]: [sum#195, count#196]
+Results [2]: [sum#197, count#198]
 
 (149) Exchange
-Input [2]: [sum#175, count#176]
+Input [2]: [sum#197, count#198]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=20]
 
 (150) HashAggregate [codegen id : 8]
-Input [2]: [sum#175, count#176]
+Input [2]: [sum#197, count#198]
 Keys: []
-Functions [1]: [avg((cast(quantity#158 as decimal(10,0)) * list_price#159))]
-Aggregate Attributes [1]: [avg((cast(quantity#158 as decimal(10,0)) * list_price#159))#177]
-Results [1]: [avg((cast(quantity#158 as decimal(10,0)) * list_price#159))#177 AS average_sales#178]
+Functions [1]: [avg((cast(quantity#180 as decimal(10,0)) * list_price#181))]
+Aggregate Attributes [1]: [avg((cast(quantity#180 as decimal(10,0)) * list_price#181))#199]
+Results [1]: [avg((cast(quantity#180 as decimal(10,0)) * list_price#181))#199 AS average_sales#200]
 
-Subquery:2 Hosting operator id = 132 Hosting Expression = ss_sold_date_sk#156 IN dynamicpruning#12
+Subquery:2 Hosting operator id = 132 Hosting Expression = ss_sold_date_sk#178 IN dynamicpruning#12
 
-Subquery:3 Hosting operator id = 137 Hosting Expression = cs_sold_date_sk#162 IN dynamicpruning#163
+Subquery:3 Hosting operator id = 137 Hosting Expression = cs_sold_date_sk#184 IN dynamicpruning#185
 BroadcastExchange (155)
 +- * Project (154)
    +- * Filter (153)
@@ -896,28 +896,28 @@ BroadcastExchange (155)
 
 
 (151) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#164, d_year#179]
+Output [2]: [d_date_sk#186, d_year#201]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (152) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#164, d_year#179]
+Input [2]: [d_date_sk#186, d_year#201]
 
 (153) Filter [codegen id : 1]
-Input [2]: [d_date_sk#164, d_year#179]
-Condition : (((isnotnull(d_year#179) AND (d_year#179 >= 1998)) AND (d_year#179 <= 2000)) AND isnotnull(d_date_sk#164))
+Input [2]: [d_date_sk#186, d_year#201]
+Condition : (((isnotnull(d_year#201) AND (d_year#201 >= 1998)) AND (d_year#201 <= 2000)) AND isnotnull(d_date_sk#186))
 
 (154) Project [codegen id : 1]
-Output [1]: [d_date_sk#164]
-Input [2]: [d_date_sk#164, d_year#179]
+Output [1]: [d_date_sk#186]
+Input [2]: [d_date_sk#186, d_year#201]
 
 (155) BroadcastExchange
-Input [1]: [d_date_sk#164]
+Input [1]: [d_date_sk#186]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=21]
 
-Subquery:4 Hosting operator id = 142 Hosting Expression = ws_sold_date_sk#169 IN dynamicpruning#163
+Subquery:4 Hosting operator id = 142 Hosting Expression = ws_sold_date_sk#191 IN dynamicpruning#185
 
 Subquery:5 Hosting operator id = 1 Hosting Expression = ss_sold_date_sk#4 IN dynamicpruning#5
 BroadcastExchange (160)
@@ -928,22 +928,22 @@ BroadcastExchange (160)
 
 
 (156) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#36, d_year#180, d_moy#181]
+Output [3]: [d_date_sk#36, d_year#202, d_moy#203]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2000), EqualTo(d_moy,11), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
 
 (157) ColumnarToRow [codegen id : 1]
-Input [3]: [d_date_sk#36, d_year#180, d_moy#181]
+Input [3]: [d_date_sk#36, d_year#202, d_moy#203]
 
 (158) Filter [codegen id : 1]
-Input [3]: [d_date_sk#36, d_year#180, d_moy#181]
-Condition : ((((isnotnull(d_year#180) AND isnotnull(d_moy#181)) AND (d_year#180 = 2000)) AND (d_moy#181 = 11)) AND isnotnull(d_date_sk#36))
+Input [3]: [d_date_sk#36, d_year#202, d_moy#203]
+Condition : ((((isnotnull(d_year#202) AND isnotnull(d_moy#203)) AND (d_year#202 = 2000)) AND (d_moy#203 = 11)) AND isnotnull(d_date_sk#36))
 
 (159) Project [codegen id : 1]
 Output [1]: [d_date_sk#36]
-Input [3]: [d_date_sk#36, d_year#180, d_moy#181]
+Input [3]: [d_date_sk#36, d_year#202, d_moy#203]
 
 (160) BroadcastExchange
 Input [1]: [d_date_sk#36]
@@ -958,22 +958,22 @@ BroadcastExchange (165)
 
 
 (161) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#13, d_year#182]
+Output [2]: [d_date_sk#13, d_year#204]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (162) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#13, d_year#182]
+Input [2]: [d_date_sk#13, d_year#204]
 
 (163) Filter [codegen id : 1]
-Input [2]: [d_date_sk#13, d_year#182]
-Condition : (((isnotnull(d_year#182) AND (d_year#182 >= 1999)) AND (d_year#182 <= 2001)) AND isnotnull(d_date_sk#13))
+Input [2]: [d_date_sk#13, d_year#204]
+Condition : (((isnotnull(d_year#204) AND (d_year#204 >= 1999)) AND (d_year#204 <= 2001)) AND isnotnull(d_date_sk#13))
 
 (164) Project [codegen id : 1]
 Output [1]: [d_date_sk#13]
-Input [2]: [d_date_sk#13, d_year#182]
+Input [2]: [d_date_sk#13, d_year#204]
 
 (165) BroadcastExchange
 Input [1]: [d_date_sk#13]
@@ -989,6 +989,6 @@ Subquery:10 Hosting operator id = 73 Hosting Expression = cs_sold_date_sk#57 IN
 
 Subquery:11 Hosting operator id = 102 Hosting Expression = ReusedSubquery Subquery scalar-subquery#52, [id=#53]
 
-Subquery:12 Hosting operator id = 88 Hosting Expression = ws_sold_date_sk#77 IN dynamicpruning#5
+Subquery:12 Hosting operator id = 88 Hosting Expression = ws_sold_date_sk#78 IN dynamicpruning#5
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14a/explain.txt
index ac53b8f2312..898e56e6926 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q14a/explain.txt
@@ -458,133 +458,133 @@ Input [4]: [cs_item_sk#54, cs_quantity#55, cs_list_price#56, cs_sold_date_sk#57]
 Condition : isnotnull(cs_item_sk#54)
 
 (70) ReusedExchange [Reuses operator id: 50]
-Output [1]: [ss_item_sk#35]
+Output [1]: [ss_item_sk#58]
 
 (71) BroadcastHashJoin [codegen id : 51]
 Left keys [1]: [cs_item_sk#54]
-Right keys [1]: [ss_item_sk#35]
+Right keys [1]: [ss_item_sk#58]
 Join type: LeftSemi
 Join condition: None
 
 (72) ReusedExchange [Reuses operator id: 57]
-Output [4]: [i_item_sk#58, i_brand_id#59, i_class_id#60, i_category_id#61]
+Output [4]: [i_item_sk#59, i_brand_id#60, i_class_id#61, i_category_id#62]
 
 (73) BroadcastHashJoin [codegen id : 51]
 Left keys [1]: [cs_item_sk#54]
-Right keys [1]: [i_item_sk#58]
+Right keys [1]: [i_item_sk#59]
 Join type: Inner
 Join condition: None
 
 (74) Project [codegen id : 51]
-Output [6]: [cs_quantity#55, cs_list_price#56, cs_sold_date_sk#57, i_brand_id#59, i_class_id#60, i_category_id#61]
-Input [8]: [cs_item_sk#54, cs_quantity#55, cs_list_price#56, cs_sold_date_sk#57, i_item_sk#58, i_brand_id#59, i_class_id#60, i_category_id#61]
+Output [6]: [cs_quantity#55, cs_list_price#56, cs_sold_date_sk#57, i_brand_id#60, i_class_id#61, i_category_id#62]
+Input [8]: [cs_item_sk#54, cs_quantity#55, cs_list_price#56, cs_sold_date_sk#57, i_item_sk#59, i_brand_id#60, i_class_id#61, i_category_id#62]
 
 (75) ReusedExchange [Reuses operator id: 154]
-Output [1]: [d_date_sk#62]
+Output [1]: [d_date_sk#63]
 
 (76) BroadcastHashJoin [codegen id : 51]
 Left keys [1]: [cs_sold_date_sk#57]
-Right keys [1]: [d_date_sk#62]
+Right keys [1]: [d_date_sk#63]
 Join type: Inner
 Join condition: None
 
 (77) Project [codegen id : 51]
-Output [5]: [cs_quantity#55, cs_list_price#56, i_brand_id#59, i_class_id#60, i_category_id#61]
-Input [7]: [cs_quantity#55, cs_list_price#56, cs_sold_date_sk#57, i_brand_id#59, i_class_id#60, i_category_id#61, d_date_sk#62]
+Output [5]: [cs_quantity#55, cs_list_price#56, i_brand_id#60, i_class_id#61, i_category_id#62]
+Input [7]: [cs_quantity#55, cs_list_price#56, cs_sold_date_sk#57, i_brand_id#60, i_class_id#61, i_category_id#62, d_date_sk#63]
 
 (78) HashAggregate [codegen id : 51]
-Input [5]: [cs_quantity#55, cs_list_price#56, i_brand_id#59, i_class_id#60, i_category_id#61]
-Keys [3]: [i_brand_id#59, i_class_id#60, i_category_id#61]
+Input [5]: [cs_quantity#55, cs_list_price#56, i_brand_id#60, i_class_id#61, i_category_id#62]
+Keys [3]: [i_brand_id#60, i_class_id#61, i_category_id#62]
 Functions [2]: [partial_sum((cast(cs_quantity#55 as decimal(10,0)) * cs_list_price#56)), partial_count(1)]
-Aggregate Attributes [3]: [sum#63, isEmpty#64, count#65]
-Results [6]: [i_brand_id#59, i_class_id#60, i_category_id#61, sum#66, isEmpty#67, count#68]
+Aggregate Attributes [3]: [sum#64, isEmpty#65, count#66]
+Results [6]: [i_brand_id#60, i_class_id#61, i_category_id#62, sum#67, isEmpty#68, count#69]
 
 (79) Exchange
-Input [6]: [i_brand_id#59, i_class_id#60, i_category_id#61, sum#66, isEmpty#67, count#68]
-Arguments: hashpartitioning(i_brand_id#59, i_class_id#60, i_category_id#61, 5), ENSURE_REQUIREMENTS, [plan_id=10]
+Input [6]: [i_brand_id#60, i_class_id#61, i_category_id#62, sum#67, isEmpty#68, count#69]
+Arguments: hashpartitioning(i_brand_id#60, i_class_id#61, i_category_id#62, 5), ENSURE_REQUIREMENTS, [plan_id=10]
 
 (80) HashAggregate [codegen id : 52]
-Input [6]: [i_brand_id#59, i_class_id#60, i_category_id#61, sum#66, isEmpty#67, count#68]
-Keys [3]: [i_brand_id#59, i_class_id#60, i_category_id#61]
+Input [6]: [i_brand_id#60, i_class_id#61, i_category_id#62, sum#67, isEmpty#68, count#69]
+Keys [3]: [i_brand_id#60, i_class_id#61, i_category_id#62]
 Functions [2]: [sum((cast(cs_quantity#55 as decimal(10,0)) * cs_list_price#56)), count(1)]
-Aggregate Attributes [2]: [sum((cast(cs_quantity#55 as decimal(10,0)) * cs_list_price#56))#69, count(1)#70]
-Results [6]: [catalog AS channel#71, i_brand_id#59, i_class_id#60, i_category_id#61, sum((cast(cs_quantity#55 as decimal(10,0)) * cs_list_price#56))#69 AS sales#72, count(1)#70 AS number_sales#73]
+Aggregate Attributes [2]: [sum((cast(cs_quantity#55 as decimal(10,0)) * cs_list_price#56))#70, count(1)#71]
+Results [6]: [catalog AS channel#72, i_brand_id#60, i_class_id#61, i_category_id#62, sum((cast(cs_quantity#55 as decimal(10,0)) * cs_list_price#56))#70 AS sales#73, count(1)#71 AS number_sales#74]
 
 (81) Filter [codegen id : 52]
-Input [6]: [channel#71, i_brand_id#59, i_class_id#60, i_category_id#61, sales#72, number_sales#73]
-Condition : (isnotnull(sales#72) AND (cast(sales#72 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
+Input [6]: [channel#72, i_brand_id#60, i_class_id#61, i_category_id#62, sales#73, number_sales#74]
+Condition : (isnotnull(sales#73) AND (cast(sales#73 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
 
 (82) Scan parquet spark_catalog.default.web_sales
-Output [4]: [ws_item_sk#74, ws_quantity#75, ws_list_price#76, ws_sold_date_sk#77]
+Output [4]: [ws_item_sk#75, ws_quantity#76, ws_list_price#77, ws_sold_date_sk#78]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#77), dynamicpruningexpression(ws_sold_date_sk#77 IN dynamicpruning#5)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#78), dynamicpruningexpression(ws_sold_date_sk#78 IN dynamicpruning#5)]
 PushedFilters: [IsNotNull(ws_item_sk)]
 ReadSchema: struct<ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
 
 (83) ColumnarToRow [codegen id : 77]
-Input [4]: [ws_item_sk#74, ws_quantity#75, ws_list_price#76, ws_sold_date_sk#77]
+Input [4]: [ws_item_sk#75, ws_quantity#76, ws_list_price#77, ws_sold_date_sk#78]
 
 (84) Filter [codegen id : 77]
-Input [4]: [ws_item_sk#74, ws_quantity#75, ws_list_price#76, ws_sold_date_sk#77]
-Condition : isnotnull(ws_item_sk#74)
+Input [4]: [ws_item_sk#75, ws_quantity#76, ws_list_price#77, ws_sold_date_sk#78]
+Condition : isnotnull(ws_item_sk#75)
 
 (85) ReusedExchange [Reuses operator id: 50]
-Output [1]: [ss_item_sk#35]
+Output [1]: [ss_item_sk#79]
 
 (86) BroadcastHashJoin [codegen id : 77]
-Left keys [1]: [ws_item_sk#74]
-Right keys [1]: [ss_item_sk#35]
+Left keys [1]: [ws_item_sk#75]
+Right keys [1]: [ss_item_sk#79]
 Join type: LeftSemi
 Join condition: None
 
 (87) ReusedExchange [Reuses operator id: 57]
-Output [4]: [i_item_sk#78, i_brand_id#79, i_class_id#80, i_category_id#81]
+Output [4]: [i_item_sk#80, i_brand_id#81, i_class_id#82, i_category_id#83]
 
 (88) BroadcastHashJoin [codegen id : 77]
-Left keys [1]: [ws_item_sk#74]
-Right keys [1]: [i_item_sk#78]
+Left keys [1]: [ws_item_sk#75]
+Right keys [1]: [i_item_sk#80]
 Join type: Inner
 Join condition: None
 
 (89) Project [codegen id : 77]
-Output [6]: [ws_quantity#75, ws_list_price#76, ws_sold_date_sk#77, i_brand_id#79, i_class_id#80, i_category_id#81]
-Input [8]: [ws_item_sk#74, ws_quantity#75, ws_list_price#76, ws_sold_date_sk#77, i_item_sk#78, i_brand_id#79, i_class_id#80, i_category_id#81]
+Output [6]: [ws_quantity#76, ws_list_price#77, ws_sold_date_sk#78, i_brand_id#81, i_class_id#82, i_category_id#83]
+Input [8]: [ws_item_sk#75, ws_quantity#76, ws_list_price#77, ws_sold_date_sk#78, i_item_sk#80, i_brand_id#81, i_class_id#82, i_category_id#83]
 
 (90) ReusedExchange [Reuses operator id: 154]
-Output [1]: [d_date_sk#82]
+Output [1]: [d_date_sk#84]
 
 (91) BroadcastHashJoin [codegen id : 77]
-Left keys [1]: [ws_sold_date_sk#77]
-Right keys [1]: [d_date_sk#82]
+Left keys [1]: [ws_sold_date_sk#78]
+Right keys [1]: [d_date_sk#84]
 Join type: Inner
 Join condition: None
 
 (92) Project [codegen id : 77]
-Output [5]: [ws_quantity#75, ws_list_price#76, i_brand_id#79, i_class_id#80, i_category_id#81]
-Input [7]: [ws_quantity#75, ws_list_price#76, ws_sold_date_sk#77, i_brand_id#79, i_class_id#80, i_category_id#81, d_date_sk#82]
+Output [5]: [ws_quantity#76, ws_list_price#77, i_brand_id#81, i_class_id#82, i_category_id#83]
+Input [7]: [ws_quantity#76, ws_list_price#77, ws_sold_date_sk#78, i_brand_id#81, i_class_id#82, i_category_id#83, d_date_sk#84]
 
 (93) HashAggregate [codegen id : 77]
-Input [5]: [ws_quantity#75, ws_list_price#76, i_brand_id#79, i_class_id#80, i_category_id#81]
-Keys [3]: [i_brand_id#79, i_class_id#80, i_category_id#81]
-Functions [2]: [partial_sum((cast(ws_quantity#75 as decimal(10,0)) * ws_list_price#76)), partial_count(1)]
-Aggregate Attributes [3]: [sum#83, isEmpty#84, count#85]
-Results [6]: [i_brand_id#79, i_class_id#80, i_category_id#81, sum#86, isEmpty#87, count#88]
+Input [5]: [ws_quantity#76, ws_list_price#77, i_brand_id#81, i_class_id#82, i_category_id#83]
+Keys [3]: [i_brand_id#81, i_class_id#82, i_category_id#83]
+Functions [2]: [partial_sum((cast(ws_quantity#76 as decimal(10,0)) * ws_list_price#77)), partial_count(1)]
+Aggregate Attributes [3]: [sum#85, isEmpty#86, count#87]
+Results [6]: [i_brand_id#81, i_class_id#82, i_category_id#83, sum#88, isEmpty#89, count#90]
 
 (94) Exchange
-Input [6]: [i_brand_id#79, i_class_id#80, i_category_id#81, sum#86, isEmpty#87, count#88]
-Arguments: hashpartitioning(i_brand_id#79, i_class_id#80, i_category_id#81, 5), ENSURE_REQUIREMENTS, [plan_id=11]
+Input [6]: [i_brand_id#81, i_class_id#82, i_category_id#83, sum#88, isEmpty#89, count#90]
+Arguments: hashpartitioning(i_brand_id#81, i_class_id#82, i_category_id#83, 5), ENSURE_REQUIREMENTS, [plan_id=11]
 
 (95) HashAggregate [codegen id : 78]
-Input [6]: [i_brand_id#79, i_class_id#80, i_category_id#81, sum#86, isEmpty#87, count#88]
-Keys [3]: [i_brand_id#79, i_class_id#80, i_category_id#81]
-Functions [2]: [sum((cast(ws_quantity#75 as decimal(10,0)) * ws_list_price#76)), count(1)]
-Aggregate Attributes [2]: [sum((cast(ws_quantity#75 as decimal(10,0)) * ws_list_price#76))#89, count(1)#90]
-Results [6]: [web AS channel#91, i_brand_id#79, i_class_id#80, i_category_id#81, sum((cast(ws_quantity#75 as decimal(10,0)) * ws_list_price#76))#89 AS sales#92, count(1)#90 AS number_sales#93]
+Input [6]: [i_brand_id#81, i_class_id#82, i_category_id#83, sum#88, isEmpty#89, count#90]
+Keys [3]: [i_brand_id#81, i_class_id#82, i_category_id#83]
+Functions [2]: [sum((cast(ws_quantity#76 as decimal(10,0)) * ws_list_price#77)), count(1)]
+Aggregate Attributes [2]: [sum((cast(ws_quantity#76 as decimal(10,0)) * ws_list_price#77))#91, count(1)#92]
+Results [6]: [web AS channel#93, i_brand_id#81, i_class_id#82, i_category_id#83, sum((cast(ws_quantity#76 as decimal(10,0)) * ws_list_price#77))#91 AS sales#94, count(1)#92 AS number_sales#95]
 
 (96) Filter [codegen id : 78]
-Input [6]: [channel#91, i_brand_id#79, i_class_id#80, i_category_id#81, sales#92, number_sales#93]
-Condition : (isnotnull(sales#92) AND (cast(sales#92 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
+Input [6]: [channel#93, i_brand_id#81, i_class_id#82, i_category_id#83, sales#94, number_sales#95]
+Condition : (isnotnull(sales#94) AND (cast(sales#94 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#52, [id=#53] as decimal(32,6))))
 
 (97) Union
 
@@ -592,155 +592,155 @@ Condition : (isnotnull(sales#92) AND (cast(sales#92 as decimal(32,6)) > cast(Reu
 Input [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sales#50, number_sales#51]
 Keys [4]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39]
 Functions [2]: [partial_sum(sales#50), partial_sum(number_sales#51)]
-Aggregate Attributes [3]: [sum#94, isEmpty#95, sum#96]
-Results [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#97, isEmpty#98, sum#99]
+Aggregate Attributes [3]: [sum#96, isEmpty#97, sum#98]
+Results [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#99, isEmpty#100, sum#101]
 
 (99) Exchange
-Input [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#97, isEmpty#98, sum#99]
+Input [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#99, isEmpty#100, sum#101]
 Arguments: hashpartitioning(channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, 5), ENSURE_REQUIREMENTS, [plan_id=12]
 
 (100) HashAggregate [codegen id : 80]
-Input [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#97, isEmpty#98, sum#99]
+Input [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#99, isEmpty#100, sum#101]
 Keys [4]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39]
 Functions [2]: [sum(sales#50), sum(number_sales#51)]
-Aggregate Attributes [2]: [sum(sales#50)#100, sum(number_sales#51)#101]
-Results [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum(sales#50)#100 AS sum_sales#102, sum(number_sales#51)#101 AS number_sales#103]
+Aggregate Attributes [2]: [sum(sales#50)#102, sum(number_sales#51)#103]
+Results [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum(sales#50)#102 AS sum_sales#104, sum(number_sales#51)#103 AS number_sales#105]
 
 (101) ReusedExchange [Reuses operator id: 99]
-Output [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#97, isEmpty#98, sum#99]
+Output [7]: [channel#49, i_brand_id#106, i_class_id#107, i_category_id#108, sum#99, isEmpty#100, sum#101]
 
 (102) HashAggregate [codegen id : 160]
-Input [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#97, isEmpty#98, sum#99]
-Keys [4]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39]
+Input [7]: [channel#49, i_brand_id#106, i_class_id#107, i_category_id#108, sum#99, isEmpty#100, sum#101]
+Keys [4]: [channel#49, i_brand_id#106, i_class_id#107, i_category_id#108]
 Functions [2]: [sum(sales#50), sum(number_sales#51)]
-Aggregate Attributes [2]: [sum(sales#50)#100, sum(number_sales#51)#101]
-Results [5]: [channel#49, i_brand_id#37, i_class_id#38, sum(sales#50)#100 AS sum_sales#102, sum(number_sales#51)#101 AS number_sales#103]
+Aggregate Attributes [2]: [sum(sales#50)#102, sum(number_sales#51)#103]
+Results [5]: [channel#49, i_brand_id#106, i_class_id#107, sum(sales#50)#102 AS sum_sales#109, sum(number_sales#51)#103 AS number_sales#110]
 
 (103) HashAggregate [codegen id : 160]
-Input [5]: [channel#49, i_brand_id#37, i_class_id#38, sum_sales#102, number_sales#103]
-Keys [3]: [channel#49, i_brand_id#37, i_class_id#38]
-Functions [2]: [partial_sum(sum_sales#102), partial_sum(number_sales#103)]
-Aggregate Attributes [3]: [sum#104, isEmpty#105, sum#106]
-Results [6]: [channel#49, i_brand_id#37, i_class_id#38, sum#107, isEmpty#108, sum#109]
+Input [5]: [channel#49, i_brand_id#106, i_class_id#107, sum_sales#109, number_sales#110]
+Keys [3]: [channel#49, i_brand_id#106, i_class_id#107]
+Functions [2]: [partial_sum(sum_sales#109), partial_sum(number_sales#110)]
+Aggregate Attributes [3]: [sum#111, isEmpty#112, sum#113]
+Results [6]: [channel#49, i_brand_id#106, i_class_id#107, sum#114, isEmpty#115, sum#116]
 
 (104) Exchange
-Input [6]: [channel#49, i_brand_id#37, i_class_id#38, sum#107, isEmpty#108, sum#109]
-Arguments: hashpartitioning(channel#49, i_brand_id#37, i_class_id#38, 5), ENSURE_REQUIREMENTS, [plan_id=13]
+Input [6]: [channel#49, i_brand_id#106, i_class_id#107, sum#114, isEmpty#115, sum#116]
+Arguments: hashpartitioning(channel#49, i_brand_id#106, i_class_id#107, 5), ENSURE_REQUIREMENTS, [plan_id=13]
 
 (105) HashAggregate [codegen id : 161]
-Input [6]: [channel#49, i_brand_id#37, i_class_id#38, sum#107, isEmpty#108, sum#109]
-Keys [3]: [channel#49, i_brand_id#37, i_class_id#38]
-Functions [2]: [sum(sum_sales#102), sum(number_sales#103)]
-Aggregate Attributes [2]: [sum(sum_sales#102)#110, sum(number_sales#103)#111]
-Results [6]: [channel#49, i_brand_id#37, i_class_id#38, null AS i_category_id#112, sum(sum_sales#102)#110 AS sum(sum_sales)#113, sum(number_sales#103)#111 AS sum(number_sales)#114]
+Input [6]: [channel#49, i_brand_id#106, i_class_id#107, sum#114, isEmpty#115, sum#116]
+Keys [3]: [channel#49, i_brand_id#106, i_class_id#107]
+Functions [2]: [sum(sum_sales#109), sum(number_sales#110)]
+Aggregate Attributes [2]: [sum(sum_sales#109)#117, sum(number_sales#110)#118]
+Results [6]: [channel#49, i_brand_id#106, i_class_id#107, null AS i_category_id#119, sum(sum_sales#109)#117 AS sum(sum_sales)#120, sum(number_sales#110)#118 AS sum(number_sales)#121]
 
 (106) ReusedExchange [Reuses operator id: 99]
-Output [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#97, isEmpty#98, sum#99]
+Output [7]: [channel#49, i_brand_id#122, i_class_id#123, i_category_id#124, sum#99, isEmpty#100, sum#101]
 
 (107) HashAggregate [codegen id : 241]
-Input [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#97, isEmpty#98, sum#99]
-Keys [4]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39]
+Input [7]: [channel#49, i_brand_id#122, i_class_id#123, i_category_id#124, sum#99, isEmpty#100, sum#101]
+Keys [4]: [channel#49, i_brand_id#122, i_class_id#123, i_category_id#124]
 Functions [2]: [sum(sales#50), sum(number_sales#51)]
-Aggregate Attributes [2]: [sum(sales#50)#100, sum(number_sales#51)#101]
-Results [4]: [channel#49, i_brand_id#37, sum(sales#50)#100 AS sum_sales#102, sum(number_sales#51)#101 AS number_sales#103]
+Aggregate Attributes [2]: [sum(sales#50)#102, sum(number_sales#51)#103]
+Results [4]: [channel#49, i_brand_id#122, sum(sales#50)#102 AS sum_sales#125, sum(number_sales#51)#103 AS number_sales#126]
 
 (108) HashAggregate [codegen id : 241]
-Input [4]: [channel#49, i_brand_id#37, sum_sales#102, number_sales#103]
-Keys [2]: [channel#49, i_brand_id#37]
-Functions [2]: [partial_sum(sum_sales#102), partial_sum(number_sales#103)]
-Aggregate Attributes [3]: [sum#115, isEmpty#116, sum#117]
-Results [5]: [channel#49, i_brand_id#37, sum#118, isEmpty#119, sum#120]
+Input [4]: [channel#49, i_brand_id#122, sum_sales#125, number_sales#126]
+Keys [2]: [channel#49, i_brand_id#122]
+Functions [2]: [partial_sum(sum_sales#125), partial_sum(number_sales#126)]
+Aggregate Attributes [3]: [sum#127, isEmpty#128, sum#129]
+Results [5]: [channel#49, i_brand_id#122, sum#130, isEmpty#131, sum#132]
 
 (109) Exchange
-Input [5]: [channel#49, i_brand_id#37, sum#118, isEmpty#119, sum#120]
-Arguments: hashpartitioning(channel#49, i_brand_id#37, 5), ENSURE_REQUIREMENTS, [plan_id=14]
+Input [5]: [channel#49, i_brand_id#122, sum#130, isEmpty#131, sum#132]
+Arguments: hashpartitioning(channel#49, i_brand_id#122, 5), ENSURE_REQUIREMENTS, [plan_id=14]
 
 (110) HashAggregate [codegen id : 242]
-Input [5]: [channel#49, i_brand_id#37, sum#118, isEmpty#119, sum#120]
-Keys [2]: [channel#49, i_brand_id#37]
-Functions [2]: [sum(sum_sales#102), sum(number_sales#103)]
-Aggregate Attributes [2]: [sum(sum_sales#102)#121, sum(number_sales#103)#122]
-Results [6]: [channel#49, i_brand_id#37, null AS i_class_id#123, null AS i_category_id#124, sum(sum_sales#102)#121 AS sum(sum_sales)#125, sum(number_sales#103)#122 AS sum(number_sales)#126]
+Input [5]: [channel#49, i_brand_id#122, sum#130, isEmpty#131, sum#132]
+Keys [2]: [channel#49, i_brand_id#122]
+Functions [2]: [sum(sum_sales#125), sum(number_sales#126)]
+Aggregate Attributes [2]: [sum(sum_sales#125)#133, sum(number_sales#126)#134]
+Results [6]: [channel#49, i_brand_id#122, null AS i_class_id#135, null AS i_category_id#136, sum(sum_sales#125)#133 AS sum(sum_sales)#137, sum(number_sales#126)#134 AS sum(number_sales)#138]
 
 (111) ReusedExchange [Reuses operator id: 99]
-Output [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#97, isEmpty#98, sum#99]
+Output [7]: [channel#49, i_brand_id#139, i_class_id#140, i_category_id#141, sum#99, isEmpty#100, sum#101]
 
 (112) HashAggregate [codegen id : 322]
-Input [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#97, isEmpty#98, sum#99]
-Keys [4]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39]
+Input [7]: [channel#49, i_brand_id#139, i_class_id#140, i_category_id#141, sum#99, isEmpty#100, sum#101]
+Keys [4]: [channel#49, i_brand_id#139, i_class_id#140, i_category_id#141]
 Functions [2]: [sum(sales#50), sum(number_sales#51)]
-Aggregate Attributes [2]: [sum(sales#50)#100, sum(number_sales#51)#101]
-Results [3]: [channel#49, sum(sales#50)#100 AS sum_sales#102, sum(number_sales#51)#101 AS number_sales#103]
+Aggregate Attributes [2]: [sum(sales#50)#102, sum(number_sales#51)#103]
+Results [3]: [channel#49, sum(sales#50)#102 AS sum_sales#142, sum(number_sales#51)#103 AS number_sales#143]
 
 (113) HashAggregate [codegen id : 322]
-Input [3]: [channel#49, sum_sales#102, number_sales#103]
+Input [3]: [channel#49, sum_sales#142, number_sales#143]
 Keys [1]: [channel#49]
-Functions [2]: [partial_sum(sum_sales#102), partial_sum(number_sales#103)]
-Aggregate Attributes [3]: [sum#127, isEmpty#128, sum#129]
-Results [4]: [channel#49, sum#130, isEmpty#131, sum#132]
+Functions [2]: [partial_sum(sum_sales#142), partial_sum(number_sales#143)]
+Aggregate Attributes [3]: [sum#144, isEmpty#145, sum#146]
+Results [4]: [channel#49, sum#147, isEmpty#148, sum#149]
 
 (114) Exchange
-Input [4]: [channel#49, sum#130, isEmpty#131, sum#132]
+Input [4]: [channel#49, sum#147, isEmpty#148, sum#149]
 Arguments: hashpartitioning(channel#49, 5), ENSURE_REQUIREMENTS, [plan_id=15]
 
 (115) HashAggregate [codegen id : 323]
-Input [4]: [channel#49, sum#130, isEmpty#131, sum#132]
+Input [4]: [channel#49, sum#147, isEmpty#148, sum#149]
 Keys [1]: [channel#49]
-Functions [2]: [sum(sum_sales#102), sum(number_sales#103)]
-Aggregate Attributes [2]: [sum(sum_sales#102)#133, sum(number_sales#103)#134]
-Results [6]: [channel#49, null AS i_brand_id#135, null AS i_class_id#136, null AS i_category_id#137, sum(sum_sales#102)#133 AS sum(sum_sales)#138, sum(number_sales#103)#134 AS sum(number_sales)#139]
+Functions [2]: [sum(sum_sales#142), sum(number_sales#143)]
+Aggregate Attributes [2]: [sum(sum_sales#142)#150, sum(number_sales#143)#151]
+Results [6]: [channel#49, null AS i_brand_id#152, null AS i_class_id#153, null AS i_category_id#154, sum(sum_sales#142)#150 AS sum(sum_sales)#155, sum(number_sales#143)#151 AS sum(number_sales)#156]
 
 (116) ReusedExchange [Reuses operator id: 99]
-Output [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#97, isEmpty#98, sum#99]
+Output [7]: [channel#49, i_brand_id#157, i_class_id#158, i_category_id#159, sum#99, isEmpty#100, sum#101]
 
 (117) HashAggregate [codegen id : 403]
-Input [7]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum#97, isEmpty#98, sum#99]
-Keys [4]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39]
+Input [7]: [channel#49, i_brand_id#157, i_class_id#158, i_category_id#159, sum#99, isEmpty#100, sum#101]
+Keys [4]: [channel#49, i_brand_id#157, i_class_id#158, i_category_id#159]
 Functions [2]: [sum(sales#50), sum(number_sales#51)]
-Aggregate Attributes [2]: [sum(sales#50)#100, sum(number_sales#51)#101]
-Results [2]: [sum(sales#50)#100 AS sum_sales#102, sum(number_sales#51)#101 AS number_sales#103]
+Aggregate Attributes [2]: [sum(sales#50)#102, sum(number_sales#51)#103]
+Results [2]: [sum(sales#50)#102 AS sum_sales#160, sum(number_sales#51)#103 AS number_sales#161]
 
 (118) HashAggregate [codegen id : 403]
-Input [2]: [sum_sales#102, number_sales#103]
+Input [2]: [sum_sales#160, number_sales#161]
 Keys: []
-Functions [2]: [partial_sum(sum_sales#102), partial_sum(number_sales#103)]
-Aggregate Attributes [3]: [sum#140, isEmpty#141, sum#142]
-Results [3]: [sum#143, isEmpty#144, sum#145]
+Functions [2]: [partial_sum(sum_sales#160), partial_sum(number_sales#161)]
+Aggregate Attributes [3]: [sum#162, isEmpty#163, sum#164]
+Results [3]: [sum#165, isEmpty#166, sum#167]
 
 (119) Exchange
-Input [3]: [sum#143, isEmpty#144, sum#145]
+Input [3]: [sum#165, isEmpty#166, sum#167]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=16]
 
 (120) HashAggregate [codegen id : 404]
-Input [3]: [sum#143, isEmpty#144, sum#145]
+Input [3]: [sum#165, isEmpty#166, sum#167]
 Keys: []
-Functions [2]: [sum(sum_sales#102), sum(number_sales#103)]
-Aggregate Attributes [2]: [sum(sum_sales#102)#146, sum(number_sales#103)#147]
-Results [6]: [null AS channel#148, null AS i_brand_id#149, null AS i_class_id#150, null AS i_category_id#151, sum(sum_sales#102)#146 AS sum(sum_sales)#152, sum(number_sales#103)#147 AS sum(number_sales)#153]
+Functions [2]: [sum(sum_sales#160), sum(number_sales#161)]
+Aggregate Attributes [2]: [sum(sum_sales#160)#168, sum(number_sales#161)#169]
+Results [6]: [null AS channel#170, null AS i_brand_id#171, null AS i_class_id#172, null AS i_category_id#173, sum(sum_sales#160)#168 AS sum(sum_sales)#174, sum(number_sales#161)#169 AS sum(number_sales)#175]
 
 (121) Union
 
 (122) HashAggregate [codegen id : 405]
-Input [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#102, number_sales#103]
-Keys [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#102, number_sales#103]
+Input [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#104, number_sales#105]
+Keys [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#104, number_sales#105]
 Functions: []
 Aggregate Attributes: []
-Results [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#102, number_sales#103]
+Results [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#104, number_sales#105]
 
 (123) Exchange
-Input [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#102, number_sales#103]
-Arguments: hashpartitioning(channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#102, number_sales#103, 5), ENSURE_REQUIREMENTS, [plan_id=17]
+Input [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#104, number_sales#105]
+Arguments: hashpartitioning(channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#104, number_sales#105, 5), ENSURE_REQUIREMENTS, [plan_id=17]
 
 (124) HashAggregate [codegen id : 406]
-Input [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#102, number_sales#103]
-Keys [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#102, number_sales#103]
+Input [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#104, number_sales#105]
+Keys [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#104, number_sales#105]
 Functions: []
 Aggregate Attributes: []
-Results [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#102, number_sales#103]
+Results [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#104, number_sales#105]
 
 (125) TakeOrderedAndProject
-Input [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#102, number_sales#103]
-Arguments: 100, [channel#49 ASC NULLS FIRST, i_brand_id#37 ASC NULLS FIRST, i_class_id#38 ASC NULLS FIRST, i_category_id#39 ASC NULLS FIRST], [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#102, number_sales#103]
+Input [6]: [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#104, number_sales#105]
+Arguments: 100, [channel#49 ASC NULLS FIRST, i_brand_id#37 ASC NULLS FIRST, i_class_id#38 ASC NULLS FIRST, i_category_id#39 ASC NULLS FIRST], [channel#49, i_brand_id#37, i_class_id#38, i_category_id#39, sum_sales#104, number_sales#105]
 
 ===== Subqueries =====
 
@@ -767,97 +767,97 @@ Subquery:1 Hosting operator id = 66 Hosting Expression = Subquery scalar-subquer
 
 
 (126) Scan parquet spark_catalog.default.store_sales
-Output [3]: [ss_quantity#154, ss_list_price#155, ss_sold_date_sk#156]
+Output [3]: [ss_quantity#176, ss_list_price#177, ss_sold_date_sk#178]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#156), dynamicpruningexpression(ss_sold_date_sk#156 IN dynamicpruning#12)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#178), dynamicpruningexpression(ss_sold_date_sk#178 IN dynamicpruning#12)]
 ReadSchema: struct<ss_quantity:int,ss_list_price:decimal(7,2)>
 
 (127) ColumnarToRow [codegen id : 2]
-Input [3]: [ss_quantity#154, ss_list_price#155, ss_sold_date_sk#156]
+Input [3]: [ss_quantity#176, ss_list_price#177, ss_sold_date_sk#178]
 
 (128) ReusedExchange [Reuses operator id: 159]
-Output [1]: [d_date_sk#157]
+Output [1]: [d_date_sk#179]
 
 (129) BroadcastHashJoin [codegen id : 2]
-Left keys [1]: [ss_sold_date_sk#156]
-Right keys [1]: [d_date_sk#157]
+Left keys [1]: [ss_sold_date_sk#178]
+Right keys [1]: [d_date_sk#179]
 Join type: Inner
 Join condition: None
 
 (130) Project [codegen id : 2]
-Output [2]: [ss_quantity#154 AS quantity#158, ss_list_price#155 AS list_price#159]
-Input [4]: [ss_quantity#154, ss_list_price#155, ss_sold_date_sk#156, d_date_sk#157]
+Output [2]: [ss_quantity#176 AS quantity#180, ss_list_price#177 AS list_price#181]
+Input [4]: [ss_quantity#176, ss_list_price#177, ss_sold_date_sk#178, d_date_sk#179]
 
 (131) Scan parquet spark_catalog.default.catalog_sales
-Output [3]: [cs_quantity#160, cs_list_price#161, cs_sold_date_sk#162]
+Output [3]: [cs_quantity#182, cs_list_price#183, cs_sold_date_sk#184]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#162), dynamicpruningexpression(cs_sold_date_sk#162 IN dynamicpruning#163)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#184), dynamicpruningexpression(cs_sold_date_sk#184 IN dynamicpruning#185)]
 ReadSchema: struct<cs_quantity:int,cs_list_price:decimal(7,2)>
 
 (132) ColumnarToRow [codegen id : 4]
-Input [3]: [cs_quantity#160, cs_list_price#161, cs_sold_date_sk#162]
+Input [3]: [cs_quantity#182, cs_list_price#183, cs_sold_date_sk#184]
 
 (133) ReusedExchange [Reuses operator id: 149]
-Output [1]: [d_date_sk#164]
+Output [1]: [d_date_sk#186]
 
 (134) BroadcastHashJoin [codegen id : 4]
-Left keys [1]: [cs_sold_date_sk#162]
-Right keys [1]: [d_date_sk#164]
+Left keys [1]: [cs_sold_date_sk#184]
+Right keys [1]: [d_date_sk#186]
 Join type: Inner
 Join condition: None
 
 (135) Project [codegen id : 4]
-Output [2]: [cs_quantity#160 AS quantity#165, cs_list_price#161 AS list_price#166]
-Input [4]: [cs_quantity#160, cs_list_price#161, cs_sold_date_sk#162, d_date_sk#164]
+Output [2]: [cs_quantity#182 AS quantity#187, cs_list_price#183 AS list_price#188]
+Input [4]: [cs_quantity#182, cs_list_price#183, cs_sold_date_sk#184, d_date_sk#186]
 
 (136) Scan parquet spark_catalog.default.web_sales
-Output [3]: [ws_quantity#167, ws_list_price#168, ws_sold_date_sk#169]
+Output [3]: [ws_quantity#189, ws_list_price#190, ws_sold_date_sk#191]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#169), dynamicpruningexpression(ws_sold_date_sk#169 IN dynamicpruning#163)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#191), dynamicpruningexpression(ws_sold_date_sk#191 IN dynamicpruning#185)]
 ReadSchema: struct<ws_quantity:int,ws_list_price:decimal(7,2)>
 
 (137) ColumnarToRow [codegen id : 6]
-Input [3]: [ws_quantity#167, ws_list_price#168, ws_sold_date_sk#169]
+Input [3]: [ws_quantity#189, ws_list_price#190, ws_sold_date_sk#191]
 
 (138) ReusedExchange [Reuses operator id: 149]
-Output [1]: [d_date_sk#170]
+Output [1]: [d_date_sk#192]
 
 (139) BroadcastHashJoin [codegen id : 6]
-Left keys [1]: [ws_sold_date_sk#169]
-Right keys [1]: [d_date_sk#170]
+Left keys [1]: [ws_sold_date_sk#191]
+Right keys [1]: [d_date_sk#192]
 Join type: Inner
 Join condition: None
 
 (140) Project [codegen id : 6]
-Output [2]: [ws_quantity#167 AS quantity#171, ws_list_price#168 AS list_price#172]
-Input [4]: [ws_quantity#167, ws_list_price#168, ws_sold_date_sk#169, d_date_sk#170]
+Output [2]: [ws_quantity#189 AS quantity#193, ws_list_price#190 AS list_price#194]
+Input [4]: [ws_quantity#189, ws_list_price#190, ws_sold_date_sk#191, d_date_sk#192]
 
 (141) Union
 
 (142) HashAggregate [codegen id : 7]
-Input [2]: [quantity#158, list_price#159]
+Input [2]: [quantity#180, list_price#181]
 Keys: []
-Functions [1]: [partial_avg((cast(quantity#158 as decimal(10,0)) * list_price#159))]
-Aggregate Attributes [2]: [sum#173, count#174]
-Results [2]: [sum#175, count#176]
+Functions [1]: [partial_avg((cast(quantity#180 as decimal(10,0)) * list_price#181))]
+Aggregate Attributes [2]: [sum#195, count#196]
+Results [2]: [sum#197, count#198]
 
 (143) Exchange
-Input [2]: [sum#175, count#176]
+Input [2]: [sum#197, count#198]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=18]
 
 (144) HashAggregate [codegen id : 8]
-Input [2]: [sum#175, count#176]
+Input [2]: [sum#197, count#198]
 Keys: []
-Functions [1]: [avg((cast(quantity#158 as decimal(10,0)) * list_price#159))]
-Aggregate Attributes [1]: [avg((cast(quantity#158 as decimal(10,0)) * list_price#159))#177]
-Results [1]: [avg((cast(quantity#158 as decimal(10,0)) * list_price#159))#177 AS average_sales#178]
+Functions [1]: [avg((cast(quantity#180 as decimal(10,0)) * list_price#181))]
+Aggregate Attributes [1]: [avg((cast(quantity#180 as decimal(10,0)) * list_price#181))#199]
+Results [1]: [avg((cast(quantity#180 as decimal(10,0)) * list_price#181))#199 AS average_sales#200]
 
-Subquery:2 Hosting operator id = 126 Hosting Expression = ss_sold_date_sk#156 IN dynamicpruning#12
+Subquery:2 Hosting operator id = 126 Hosting Expression = ss_sold_date_sk#178 IN dynamicpruning#12
 
-Subquery:3 Hosting operator id = 131 Hosting Expression = cs_sold_date_sk#162 IN dynamicpruning#163
+Subquery:3 Hosting operator id = 131 Hosting Expression = cs_sold_date_sk#184 IN dynamicpruning#185
 BroadcastExchange (149)
 +- * Project (148)
    +- * Filter (147)
@@ -866,28 +866,28 @@ BroadcastExchange (149)
 
 
 (145) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#164, d_year#179]
+Output [2]: [d_date_sk#186, d_year#201]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (146) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#164, d_year#179]
+Input [2]: [d_date_sk#186, d_year#201]
 
 (147) Filter [codegen id : 1]
-Input [2]: [d_date_sk#164, d_year#179]
-Condition : (((isnotnull(d_year#179) AND (d_year#179 >= 1998)) AND (d_year#179 <= 2000)) AND isnotnull(d_date_sk#164))
+Input [2]: [d_date_sk#186, d_year#201]
+Condition : (((isnotnull(d_year#201) AND (d_year#201 >= 1998)) AND (d_year#201 <= 2000)) AND isnotnull(d_date_sk#186))
 
 (148) Project [codegen id : 1]
-Output [1]: [d_date_sk#164]
-Input [2]: [d_date_sk#164, d_year#179]
+Output [1]: [d_date_sk#186]
+Input [2]: [d_date_sk#186, d_year#201]
 
 (149) BroadcastExchange
-Input [1]: [d_date_sk#164]
+Input [1]: [d_date_sk#186]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=19]
 
-Subquery:4 Hosting operator id = 136 Hosting Expression = ws_sold_date_sk#169 IN dynamicpruning#163
+Subquery:4 Hosting operator id = 136 Hosting Expression = ws_sold_date_sk#191 IN dynamicpruning#185
 
 Subquery:5 Hosting operator id = 1 Hosting Expression = ss_sold_date_sk#4 IN dynamicpruning#5
 BroadcastExchange (154)
@@ -898,22 +898,22 @@ BroadcastExchange (154)
 
 
 (150) Scan parquet spark_catalog.default.date_dim
-Output [3]: [d_date_sk#40, d_year#180, d_moy#181]
+Output [3]: [d_date_sk#40, d_year#202, d_moy#203]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2000), EqualTo(d_moy,11), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
 
 (151) ColumnarToRow [codegen id : 1]
-Input [3]: [d_date_sk#40, d_year#180, d_moy#181]
+Input [3]: [d_date_sk#40, d_year#202, d_moy#203]
 
 (152) Filter [codegen id : 1]
-Input [3]: [d_date_sk#40, d_year#180, d_moy#181]
-Condition : ((((isnotnull(d_year#180) AND isnotnull(d_moy#181)) AND (d_year#180 = 2000)) AND (d_moy#181 = 11)) AND isnotnull(d_date_sk#40))
+Input [3]: [d_date_sk#40, d_year#202, d_moy#203]
+Condition : ((((isnotnull(d_year#202) AND isnotnull(d_moy#203)) AND (d_year#202 = 2000)) AND (d_moy#203 = 11)) AND isnotnull(d_date_sk#40))
 
 (153) Project [codegen id : 1]
 Output [1]: [d_date_sk#40]
-Input [3]: [d_date_sk#40, d_year#180, d_moy#181]
+Input [3]: [d_date_sk#40, d_year#202, d_moy#203]
 
 (154) BroadcastExchange
 Input [1]: [d_date_sk#40]
@@ -928,22 +928,22 @@ BroadcastExchange (159)
 
 
 (155) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#24, d_year#182]
+Output [2]: [d_date_sk#24, d_year#204]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (156) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#24, d_year#182]
+Input [2]: [d_date_sk#24, d_year#204]
 
 (157) Filter [codegen id : 1]
-Input [2]: [d_date_sk#24, d_year#182]
-Condition : (((isnotnull(d_year#182) AND (d_year#182 >= 1999)) AND (d_year#182 <= 2001)) AND isnotnull(d_date_sk#24))
+Input [2]: [d_date_sk#24, d_year#204]
+Condition : (((isnotnull(d_year#204) AND (d_year#204 >= 1999)) AND (d_year#204 <= 2001)) AND isnotnull(d_date_sk#24))
 
 (158) Project [codegen id : 1]
 Output [1]: [d_date_sk#24]
-Input [2]: [d_date_sk#24, d_year#182]
+Input [2]: [d_date_sk#24, d_year#204]
 
 (159) BroadcastExchange
 Input [1]: [d_date_sk#24]
@@ -959,6 +959,6 @@ Subquery:10 Hosting operator id = 67 Hosting Expression = cs_sold_date_sk#57 IN
 
 Subquery:11 Hosting operator id = 96 Hosting Expression = ReusedSubquery Subquery scalar-subquery#52, [id=#53]
 
-Subquery:12 Hosting operator id = 82 Hosting Expression = ws_sold_date_sk#77 IN dynamicpruning#5
+Subquery:12 Hosting operator id = 82 Hosting Expression = ws_sold_date_sk#78 IN dynamicpruning#5
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q18a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q18a.sf100/explain.txt
index 2671e37f4e1..78eeaa91a4f 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q18a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q18a.sf100/explain.txt
@@ -376,500 +376,500 @@ Aggregate Attributes [7]: [avg(agg1#28)#63, avg(agg2#29)#64, avg(agg3#30)#65, av
 Results [11]: [i_item_id#17, ca_country#26, ca_state#25, ca_county#24, avg(agg1#28)#63 AS agg1#70, avg(agg2#29)#64 AS agg2#71, avg(agg3#30)#65 AS agg3#72, avg(agg4#31)#66 AS agg4#73, avg(agg5#32)#67 AS agg5#74, avg(agg6#33)#68 AS agg6#75, avg(agg7#34)#69 AS agg7#76]
 
 (48) ReusedExchange [Reuses operator id: 20]
-Output [8]: [cs_bill_customer_sk#1, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, i_item_id#17]
+Output [8]: [cs_bill_customer_sk#77, cs_quantity#78, cs_list_price#79, cs_sales_price#80, cs_coupon_amt#81, cs_net_profit#82, cd_dep_count#83, i_item_id#84]
 
 (49) Sort [codegen id : 19]
-Input [8]: [cs_bill_customer_sk#1, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, i_item_id#17]
-Arguments: [cs_bill_customer_sk#1 ASC NULLS FIRST], false, 0
+Input [8]: [cs_bill_customer_sk#77, cs_quantity#78, cs_list_price#79, cs_sales_price#80, cs_coupon_amt#81, cs_net_profit#82, cd_dep_count#83, i_item_id#84]
+Arguments: [cs_bill_customer_sk#77 ASC NULLS FIRST], false, 0
 
 (50) Scan parquet spark_catalog.default.customer
-Output [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_month#21, c_birth_year#22]
+Output [5]: [c_customer_sk#85, c_current_cdemo_sk#86, c_current_addr_sk#87, c_birth_month#88, c_birth_year#89]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer]
 PushedFilters: [In(c_birth_month, [1,10,12,4,5,9]), IsNotNull(c_customer_sk), IsNotNull(c_current_cdemo_sk), IsNotNull(c_current_addr_sk)]
 ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int,c_birth_month:int,c_birth_year:int>
 
 (51) ColumnarToRow [codegen id : 21]
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_month#21, c_birth_year#22]
+Input [5]: [c_customer_sk#85, c_current_cdemo_sk#86, c_current_addr_sk#87, c_birth_month#88, c_birth_year#89]
 
 (52) Filter [codegen id : 21]
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_month#21, c_birth_year#22]
-Condition : (((c_birth_month#21 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#18)) AND isnotnull(c_current_cdemo_sk#19)) AND isnotnull(c_current_addr_sk#20))
+Input [5]: [c_customer_sk#85, c_current_cdemo_sk#86, c_current_addr_sk#87, c_birth_month#88, c_birth_year#89]
+Condition : (((c_birth_month#88 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#85)) AND isnotnull(c_current_cdemo_sk#86)) AND isnotnull(c_current_addr_sk#87))
 
 (53) Project [codegen id : 21]
-Output [4]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_year#22]
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_month#21, c_birth_year#22]
+Output [4]: [c_customer_sk#85, c_current_cdemo_sk#86, c_current_addr_sk#87, c_birth_year#89]
+Input [5]: [c_customer_sk#85, c_current_cdemo_sk#86, c_current_addr_sk#87, c_birth_month#88, c_birth_year#89]
 
 (54) Scan parquet spark_catalog.default.customer_address
-Output [3]: [ca_address_sk#23, ca_state#25, ca_country#26]
+Output [3]: [ca_address_sk#90, ca_state#91, ca_country#92]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [In(ca_state, [AL,MS,NC,ND,OK,TN,WI]), IsNotNull(ca_address_sk)]
 ReadSchema: struct<ca_address_sk:int,ca_state:string,ca_country:string>
 
 (55) ColumnarToRow [codegen id : 20]
-Input [3]: [ca_address_sk#23, ca_state#25, ca_country#26]
+Input [3]: [ca_address_sk#90, ca_state#91, ca_country#92]
 
 (56) Filter [codegen id : 20]
-Input [3]: [ca_address_sk#23, ca_state#25, ca_country#26]
-Condition : (ca_state#25 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#23))
+Input [3]: [ca_address_sk#90, ca_state#91, ca_country#92]
+Condition : (ca_state#91 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#90))
 
 (57) BroadcastExchange
-Input [3]: [ca_address_sk#23, ca_state#25, ca_country#26]
+Input [3]: [ca_address_sk#90, ca_state#91, ca_country#92]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=9]
 
 (58) BroadcastHashJoin [codegen id : 21]
-Left keys [1]: [c_current_addr_sk#20]
-Right keys [1]: [ca_address_sk#23]
+Left keys [1]: [c_current_addr_sk#87]
+Right keys [1]: [ca_address_sk#90]
 Join type: Inner
 Join condition: None
 
 (59) Project [codegen id : 21]
-Output [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_birth_year#22, ca_state#25, ca_country#26]
-Input [7]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_year#22, ca_address_sk#23, ca_state#25, ca_country#26]
+Output [5]: [c_customer_sk#85, c_current_cdemo_sk#86, c_birth_year#89, ca_state#91, ca_country#92]
+Input [7]: [c_customer_sk#85, c_current_cdemo_sk#86, c_current_addr_sk#87, c_birth_year#89, ca_address_sk#90, ca_state#91, ca_country#92]
 
 (60) Exchange
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_birth_year#22, ca_state#25, ca_country#26]
-Arguments: hashpartitioning(c_current_cdemo_sk#19, 5), ENSURE_REQUIREMENTS, [plan_id=10]
+Input [5]: [c_customer_sk#85, c_current_cdemo_sk#86, c_birth_year#89, ca_state#91, ca_country#92]
+Arguments: hashpartitioning(c_current_cdemo_sk#86, 5), ENSURE_REQUIREMENTS, [plan_id=10]
 
 (61) Sort [codegen id : 22]
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_birth_year#22, ca_state#25, ca_country#26]
-Arguments: [c_current_cdemo_sk#19 ASC NULLS FIRST], false, 0
+Input [5]: [c_customer_sk#85, c_current_cdemo_sk#86, c_birth_year#89, ca_state#91, ca_country#92]
+Arguments: [c_current_cdemo_sk#86 ASC NULLS FIRST], false, 0
 
 (62) ReusedExchange [Reuses operator id: 37]
-Output [1]: [cd_demo_sk#27]
+Output [1]: [cd_demo_sk#93]
 
 (63) Sort [codegen id : 24]
-Input [1]: [cd_demo_sk#27]
-Arguments: [cd_demo_sk#27 ASC NULLS FIRST], false, 0
+Input [1]: [cd_demo_sk#93]
+Arguments: [cd_demo_sk#93 ASC NULLS FIRST], false, 0
 
 (64) SortMergeJoin [codegen id : 25]
-Left keys [1]: [c_current_cdemo_sk#19]
-Right keys [1]: [cd_demo_sk#27]
+Left keys [1]: [c_current_cdemo_sk#86]
+Right keys [1]: [cd_demo_sk#93]
 Join type: Inner
 Join condition: None
 
 (65) Project [codegen id : 25]
-Output [4]: [c_customer_sk#18, c_birth_year#22, ca_state#25, ca_country#26]
-Input [6]: [c_customer_sk#18, c_current_cdemo_sk#19, c_birth_year#22, ca_state#25, ca_country#26, cd_demo_sk#27]
+Output [4]: [c_customer_sk#85, c_birth_year#89, ca_state#91, ca_country#92]
+Input [6]: [c_customer_sk#85, c_current_cdemo_sk#86, c_birth_year#89, ca_state#91, ca_country#92, cd_demo_sk#93]
 
 (66) Exchange
-Input [4]: [c_customer_sk#18, c_birth_year#22, ca_state#25, ca_country#26]
-Arguments: hashpartitioning(c_customer_sk#18, 5), ENSURE_REQUIREMENTS, [plan_id=11]
+Input [4]: [c_customer_sk#85, c_birth_year#89, ca_state#91, ca_country#92]
+Arguments: hashpartitioning(c_customer_sk#85, 5), ENSURE_REQUIREMENTS, [plan_id=11]
 
 (67) Sort [codegen id : 26]
-Input [4]: [c_customer_sk#18, c_birth_year#22, ca_state#25, ca_country#26]
-Arguments: [c_customer_sk#18 ASC NULLS FIRST], false, 0
+Input [4]: [c_customer_sk#85, c_birth_year#89, ca_state#91, ca_country#92]
+Arguments: [c_customer_sk#85 ASC NULLS FIRST], false, 0
 
 (68) SortMergeJoin [codegen id : 27]
-Left keys [1]: [cs_bill_customer_sk#1]
-Right keys [1]: [c_customer_sk#18]
+Left keys [1]: [cs_bill_customer_sk#77]
+Right keys [1]: [c_customer_sk#85]
 Join type: Inner
 Join condition: None
 
 (69) Project [codegen id : 27]
-Output [10]: [i_item_id#17, ca_country#26, ca_state#25, cast(cs_quantity#4 as decimal(12,2)) AS agg1#28, cast(cs_list_price#5 as decimal(12,2)) AS agg2#29, cast(cs_coupon_amt#7 as decimal(12,2)) AS agg3#30, cast(cs_sales_price#6 as decimal(12,2)) AS agg4#31, cast(cs_net_profit#8 as decimal(12,2)) AS agg5#32, cast(c_birth_year#22 as decimal(12,2)) AS agg6#33, cast(cd_dep_count#14 as decimal(12,2)) AS agg7#34]
-Input [12]: [cs_bill_customer_sk#1, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, i_item_id#17, c_customer_sk#18, c_birth_year#22, ca_state#25, ca_country#26]
+Output [10]: [i_item_id#84, ca_country#92, ca_state#91, cast(cs_quantity#78 as decimal(12,2)) AS agg1#94, cast(cs_list_price#79 as decimal(12,2)) AS agg2#95, cast(cs_coupon_amt#81 as decimal(12,2)) AS agg3#96, cast(cs_sales_price#80 as decimal(12,2)) AS agg4#97, cast(cs_net_profit#82 as decimal(12,2)) AS agg5#98, cast(c_birth_year#89 as decimal(12,2)) AS agg6#99, cast(cd_dep_count#83 as decimal(12,2)) AS agg7#100]
+Input [12]: [cs_bill_customer_sk#77, cs_quantity#78, cs_list_price#79, cs_sales_price#80, cs_coupon_amt#81, cs_net_profit#82, cd_dep_count#83, i_item_id#84, c_customer_sk#85, c_birth_year#89, ca_state#91, ca_country#92]
 
 (70) HashAggregate [codegen id : 27]
-Input [10]: [i_item_id#17, ca_country#26, ca_state#25, agg1#28, agg2#29, agg3#30, agg4#31, agg5#32, agg6#33, agg7#34]
-Keys [3]: [i_item_id#17, ca_country#26, ca_state#25]
-Functions [7]: [partial_avg(agg1#28), partial_avg(agg2#29), partial_avg(agg3#30), partial_avg(agg4#31), partial_avg(agg5#32), partial_avg(agg6#33), partial_avg(agg7#34)]
-Aggregate Attributes [14]: [sum#77, count#78, sum#79, count#80, sum#81, count#82, sum#83, count#84, sum#85, count#86, sum#87, count#88, sum#89, count#90]
-Results [17]: [i_item_id#17, ca_country#26, ca_state#25, sum#91, count#92, sum#93, count#94, sum#95, count#96, sum#97, count#98, sum#99, count#100, sum#101, count#102, sum#103, count#104]
+Input [10]: [i_item_id#84, ca_country#92, ca_state#91, agg1#94, agg2#95, agg3#96, agg4#97, agg5#98, agg6#99, agg7#100]
+Keys [3]: [i_item_id#84, ca_country#92, ca_state#91]
+Functions [7]: [partial_avg(agg1#94), partial_avg(agg2#95), partial_avg(agg3#96), partial_avg(agg4#97), partial_avg(agg5#98), partial_avg(agg6#99), partial_avg(agg7#100)]
+Aggregate Attributes [14]: [sum#101, count#102, sum#103, count#104, sum#105, count#106, sum#107, count#108, sum#109, count#110, sum#111, count#112, sum#113, count#114]
+Results [17]: [i_item_id#84, ca_country#92, ca_state#91, sum#115, count#116, sum#117, count#118, sum#119, count#120, sum#121, count#122, sum#123, count#124, sum#125, count#126, sum#127, count#128]
 
 (71) Exchange
-Input [17]: [i_item_id#17, ca_country#26, ca_state#25, sum#91, count#92, sum#93, count#94, sum#95, count#96, sum#97, count#98, sum#99, count#100, sum#101, count#102, sum#103, count#104]
-Arguments: hashpartitioning(i_item_id#17, ca_country#26, ca_state#25, 5), ENSURE_REQUIREMENTS, [plan_id=12]
+Input [17]: [i_item_id#84, ca_country#92, ca_state#91, sum#115, count#116, sum#117, count#118, sum#119, count#120, sum#121, count#122, sum#123, count#124, sum#125, count#126, sum#127, count#128]
+Arguments: hashpartitioning(i_item_id#84, ca_country#92, ca_state#91, 5), ENSURE_REQUIREMENTS, [plan_id=12]
 
 (72) HashAggregate [codegen id : 28]
-Input [17]: [i_item_id#17, ca_country#26, ca_state#25, sum#91, count#92, sum#93, count#94, sum#95, count#96, sum#97, count#98, sum#99, count#100, sum#101, count#102, sum#103, count#104]
-Keys [3]: [i_item_id#17, ca_country#26, ca_state#25]
-Functions [7]: [avg(agg1#28), avg(agg2#29), avg(agg3#30), avg(agg4#31), avg(agg5#32), avg(agg6#33), avg(agg7#34)]
-Aggregate Attributes [7]: [avg(agg1#28)#105, avg(agg2#29)#106, avg(agg3#30)#107, avg(agg4#31)#108, avg(agg5#32)#109, avg(agg6#33)#110, avg(agg7#34)#111]
-Results [11]: [i_item_id#17, ca_country#26, ca_state#25, null AS county#112, avg(agg1#28)#105 AS agg1#113, avg(agg2#29)#106 AS agg2#114, avg(agg3#30)#107 AS agg3#115, avg(agg4#31)#108 AS agg4#116, avg(agg5#32)#109 AS agg5#117, avg(agg6#33)#110 AS agg6#118, avg(agg7#34)#111 AS agg7#119]
+Input [17]: [i_item_id#84, ca_country#92, ca_state#91, sum#115, count#116, sum#117, count#118, sum#119, count#120, sum#121, count#122, sum#123, count#124, sum#125, count#126, sum#127, count#128]
+Keys [3]: [i_item_id#84, ca_country#92, ca_state#91]
+Functions [7]: [avg(agg1#94), avg(agg2#95), avg(agg3#96), avg(agg4#97), avg(agg5#98), avg(agg6#99), avg(agg7#100)]
+Aggregate Attributes [7]: [avg(agg1#94)#129, avg(agg2#95)#130, avg(agg3#96)#131, avg(agg4#97)#132, avg(agg5#98)#133, avg(agg6#99)#134, avg(agg7#100)#135]
+Results [11]: [i_item_id#84, ca_country#92, ca_state#91, null AS county#136, avg(agg1#94)#129 AS agg1#137, avg(agg2#95)#130 AS agg2#138, avg(agg3#96)#131 AS agg3#139, avg(agg4#97)#132 AS agg4#140, avg(agg5#98)#133 AS agg5#141, avg(agg6#99)#134 AS agg6#142, avg(agg7#100)#135 AS agg7#143]
 
 (73) ReusedExchange [Reuses operator id: 20]
-Output [8]: [cs_bill_customer_sk#1, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, i_item_id#17]
+Output [8]: [cs_bill_customer_sk#144, cs_quantity#145, cs_list_price#146, cs_sales_price#147, cs_coupon_amt#148, cs_net_profit#149, cd_dep_count#150, i_item_id#151]
 
 (74) Sort [codegen id : 33]
-Input [8]: [cs_bill_customer_sk#1, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, i_item_id#17]
-Arguments: [cs_bill_customer_sk#1 ASC NULLS FIRST], false, 0
+Input [8]: [cs_bill_customer_sk#144, cs_quantity#145, cs_list_price#146, cs_sales_price#147, cs_coupon_amt#148, cs_net_profit#149, cd_dep_count#150, i_item_id#151]
+Arguments: [cs_bill_customer_sk#144 ASC NULLS FIRST], false, 0
 
 (75) Scan parquet spark_catalog.default.customer
-Output [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_month#21, c_birth_year#22]
+Output [5]: [c_customer_sk#152, c_current_cdemo_sk#153, c_current_addr_sk#154, c_birth_month#155, c_birth_year#156]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer]
 PushedFilters: [In(c_birth_month, [1,10,12,4,5,9]), IsNotNull(c_customer_sk), IsNotNull(c_current_cdemo_sk), IsNotNull(c_current_addr_sk)]
 ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int,c_birth_month:int,c_birth_year:int>
 
 (76) ColumnarToRow [codegen id : 35]
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_month#21, c_birth_year#22]
+Input [5]: [c_customer_sk#152, c_current_cdemo_sk#153, c_current_addr_sk#154, c_birth_month#155, c_birth_year#156]
 
 (77) Filter [codegen id : 35]
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_month#21, c_birth_year#22]
-Condition : (((c_birth_month#21 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#18)) AND isnotnull(c_current_cdemo_sk#19)) AND isnotnull(c_current_addr_sk#20))
+Input [5]: [c_customer_sk#152, c_current_cdemo_sk#153, c_current_addr_sk#154, c_birth_month#155, c_birth_year#156]
+Condition : (((c_birth_month#155 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#152)) AND isnotnull(c_current_cdemo_sk#153)) AND isnotnull(c_current_addr_sk#154))
 
 (78) Project [codegen id : 35]
-Output [4]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_year#22]
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_month#21, c_birth_year#22]
+Output [4]: [c_customer_sk#152, c_current_cdemo_sk#153, c_current_addr_sk#154, c_birth_year#156]
+Input [5]: [c_customer_sk#152, c_current_cdemo_sk#153, c_current_addr_sk#154, c_birth_month#155, c_birth_year#156]
 
 (79) Scan parquet spark_catalog.default.customer_address
-Output [3]: [ca_address_sk#23, ca_state#25, ca_country#26]
+Output [3]: [ca_address_sk#157, ca_state#158, ca_country#159]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [In(ca_state, [AL,MS,NC,ND,OK,TN,WI]), IsNotNull(ca_address_sk)]
 ReadSchema: struct<ca_address_sk:int,ca_state:string,ca_country:string>
 
 (80) ColumnarToRow [codegen id : 34]
-Input [3]: [ca_address_sk#23, ca_state#25, ca_country#26]
+Input [3]: [ca_address_sk#157, ca_state#158, ca_country#159]
 
 (81) Filter [codegen id : 34]
-Input [3]: [ca_address_sk#23, ca_state#25, ca_country#26]
-Condition : (ca_state#25 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#23))
+Input [3]: [ca_address_sk#157, ca_state#158, ca_country#159]
+Condition : (ca_state#158 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#157))
 
 (82) Project [codegen id : 34]
-Output [2]: [ca_address_sk#23, ca_country#26]
-Input [3]: [ca_address_sk#23, ca_state#25, ca_country#26]
+Output [2]: [ca_address_sk#157, ca_country#159]
+Input [3]: [ca_address_sk#157, ca_state#158, ca_country#159]
 
 (83) BroadcastExchange
-Input [2]: [ca_address_sk#23, ca_country#26]
+Input [2]: [ca_address_sk#157, ca_country#159]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=13]
 
 (84) BroadcastHashJoin [codegen id : 35]
-Left keys [1]: [c_current_addr_sk#20]
-Right keys [1]: [ca_address_sk#23]
+Left keys [1]: [c_current_addr_sk#154]
+Right keys [1]: [ca_address_sk#157]
 Join type: Inner
 Join condition: None
 
 (85) Project [codegen id : 35]
-Output [4]: [c_customer_sk#18, c_current_cdemo_sk#19, c_birth_year#22, ca_country#26]
-Input [6]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_year#22, ca_address_sk#23, ca_country#26]
+Output [4]: [c_customer_sk#152, c_current_cdemo_sk#153, c_birth_year#156, ca_country#159]
+Input [6]: [c_customer_sk#152, c_current_cdemo_sk#153, c_current_addr_sk#154, c_birth_year#156, ca_address_sk#157, ca_country#159]
 
 (86) Exchange
-Input [4]: [c_customer_sk#18, c_current_cdemo_sk#19, c_birth_year#22, ca_country#26]
-Arguments: hashpartitioning(c_current_cdemo_sk#19, 5), ENSURE_REQUIREMENTS, [plan_id=14]
+Input [4]: [c_customer_sk#152, c_current_cdemo_sk#153, c_birth_year#156, ca_country#159]
+Arguments: hashpartitioning(c_current_cdemo_sk#153, 5), ENSURE_REQUIREMENTS, [plan_id=14]
 
 (87) Sort [codegen id : 36]
-Input [4]: [c_customer_sk#18, c_current_cdemo_sk#19, c_birth_year#22, ca_country#26]
-Arguments: [c_current_cdemo_sk#19 ASC NULLS FIRST], false, 0
+Input [4]: [c_customer_sk#152, c_current_cdemo_sk#153, c_birth_year#156, ca_country#159]
+Arguments: [c_current_cdemo_sk#153 ASC NULLS FIRST], false, 0
 
 (88) ReusedExchange [Reuses operator id: 37]
-Output [1]: [cd_demo_sk#27]
+Output [1]: [cd_demo_sk#160]
 
 (89) Sort [codegen id : 38]
-Input [1]: [cd_demo_sk#27]
-Arguments: [cd_demo_sk#27 ASC NULLS FIRST], false, 0
+Input [1]: [cd_demo_sk#160]
+Arguments: [cd_demo_sk#160 ASC NULLS FIRST], false, 0
 
 (90) SortMergeJoin [codegen id : 39]
-Left keys [1]: [c_current_cdemo_sk#19]
-Right keys [1]: [cd_demo_sk#27]
+Left keys [1]: [c_current_cdemo_sk#153]
+Right keys [1]: [cd_demo_sk#160]
 Join type: Inner
 Join condition: None
 
 (91) Project [codegen id : 39]
-Output [3]: [c_customer_sk#18, c_birth_year#22, ca_country#26]
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_birth_year#22, ca_country#26, cd_demo_sk#27]
+Output [3]: [c_customer_sk#152, c_birth_year#156, ca_country#159]
+Input [5]: [c_customer_sk#152, c_current_cdemo_sk#153, c_birth_year#156, ca_country#159, cd_demo_sk#160]
 
 (92) Exchange
-Input [3]: [c_customer_sk#18, c_birth_year#22, ca_country#26]
-Arguments: hashpartitioning(c_customer_sk#18, 5), ENSURE_REQUIREMENTS, [plan_id=15]
+Input [3]: [c_customer_sk#152, c_birth_year#156, ca_country#159]
+Arguments: hashpartitioning(c_customer_sk#152, 5), ENSURE_REQUIREMENTS, [plan_id=15]
 
 (93) Sort [codegen id : 40]
-Input [3]: [c_customer_sk#18, c_birth_year#22, ca_country#26]
-Arguments: [c_customer_sk#18 ASC NULLS FIRST], false, 0
+Input [3]: [c_customer_sk#152, c_birth_year#156, ca_country#159]
+Arguments: [c_customer_sk#152 ASC NULLS FIRST], false, 0
 
 (94) SortMergeJoin [codegen id : 41]
-Left keys [1]: [cs_bill_customer_sk#1]
-Right keys [1]: [c_customer_sk#18]
+Left keys [1]: [cs_bill_customer_sk#144]
+Right keys [1]: [c_customer_sk#152]
 Join type: Inner
 Join condition: None
 
 (95) Project [codegen id : 41]
-Output [9]: [i_item_id#17, ca_country#26, cast(cs_quantity#4 as decimal(12,2)) AS agg1#28, cast(cs_list_price#5 as decimal(12,2)) AS agg2#29, cast(cs_coupon_amt#7 as decimal(12,2)) AS agg3#30, cast(cs_sales_price#6 as decimal(12,2)) AS agg4#31, cast(cs_net_profit#8 as decimal(12,2)) AS agg5#32, cast(c_birth_year#22 as decimal(12,2)) AS agg6#33, cast(cd_dep_count#14 as decimal(12,2)) AS agg7#34]
-Input [11]: [cs_bill_customer_sk#1, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, i_item_id#17, c_customer_sk#18, c_birth_year#22, ca_country#26]
+Output [9]: [i_item_id#151, ca_country#159, cast(cs_quantity#145 as decimal(12,2)) AS agg1#161, cast(cs_list_price#146 as decimal(12,2)) AS agg2#162, cast(cs_coupon_amt#148 as decimal(12,2)) AS agg3#163, cast(cs_sales_price#147 as decimal(12,2)) AS agg4#164, cast(cs_net_profit#149 as decimal(12,2)) AS agg5#165, cast(c_birth_year#156 as decimal(12,2)) AS agg6#166, cast(cd_dep_count#150 as decimal(12,2)) AS agg7#167]
+Input [11]: [cs_bill_customer_sk#144, cs_quantity#145, cs_list_price#146, cs_sales_price#147, cs_coupon_amt#148, cs_net_profit#149, cd_dep_count#150, i_item_id#151, c_customer_sk#152, c_birth_year#156, ca_country#159]
 
 (96) HashAggregate [codegen id : 41]
-Input [9]: [i_item_id#17, ca_country#26, agg1#28, agg2#29, agg3#30, agg4#31, agg5#32, agg6#33, agg7#34]
-Keys [2]: [i_item_id#17, ca_country#26]
-Functions [7]: [partial_avg(agg1#28), partial_avg(agg2#29), partial_avg(agg3#30), partial_avg(agg4#31), partial_avg(agg5#32), partial_avg(agg6#33), partial_avg(agg7#34)]
-Aggregate Attributes [14]: [sum#120, count#121, sum#122, count#123, sum#124, count#125, sum#126, count#127, sum#128, count#129, sum#130, count#131, sum#132, count#133]
-Results [16]: [i_item_id#17, ca_country#26, sum#134, count#135, sum#136, count#137, sum#138, count#139, sum#140, count#141, sum#142, count#143, sum#144, count#145, sum#146, count#147]
+Input [9]: [i_item_id#151, ca_country#159, agg1#161, agg2#162, agg3#163, agg4#164, agg5#165, agg6#166, agg7#167]
+Keys [2]: [i_item_id#151, ca_country#159]
+Functions [7]: [partial_avg(agg1#161), partial_avg(agg2#162), partial_avg(agg3#163), partial_avg(agg4#164), partial_avg(agg5#165), partial_avg(agg6#166), partial_avg(agg7#167)]
+Aggregate Attributes [14]: [sum#168, count#169, sum#170, count#171, sum#172, count#173, sum#174, count#175, sum#176, count#177, sum#178, count#179, sum#180, count#181]
+Results [16]: [i_item_id#151, ca_country#159, sum#182, count#183, sum#184, count#185, sum#186, count#187, sum#188, count#189, sum#190, count#191, sum#192, count#193, sum#194, count#195]
 
 (97) Exchange
-Input [16]: [i_item_id#17, ca_country#26, sum#134, count#135, sum#136, count#137, sum#138, count#139, sum#140, count#141, sum#142, count#143, sum#144, count#145, sum#146, count#147]
-Arguments: hashpartitioning(i_item_id#17, ca_country#26, 5), ENSURE_REQUIREMENTS, [plan_id=16]
+Input [16]: [i_item_id#151, ca_country#159, sum#182, count#183, sum#184, count#185, sum#186, count#187, sum#188, count#189, sum#190, count#191, sum#192, count#193, sum#194, count#195]
+Arguments: hashpartitioning(i_item_id#151, ca_country#159, 5), ENSURE_REQUIREMENTS, [plan_id=16]
 
 (98) HashAggregate [codegen id : 42]
-Input [16]: [i_item_id#17, ca_country#26, sum#134, count#135, sum#136, count#137, sum#138, count#139, sum#140, count#141, sum#142, count#143, sum#144, count#145, sum#146, count#147]
-Keys [2]: [i_item_id#17, ca_country#26]
-Functions [7]: [avg(agg1#28), avg(agg2#29), avg(agg3#30), avg(agg4#31), avg(agg5#32), avg(agg6#33), avg(agg7#34)]
-Aggregate Attributes [7]: [avg(agg1#28)#148, avg(agg2#29)#149, avg(agg3#30)#150, avg(agg4#31)#151, avg(agg5#32)#152, avg(agg6#33)#153, avg(agg7#34)#154]
-Results [11]: [i_item_id#17, ca_country#26, null AS ca_state#155, null AS county#156, avg(agg1#28)#148 AS agg1#157, avg(agg2#29)#149 AS agg2#158, avg(agg3#30)#150 AS agg3#159, avg(agg4#31)#151 AS agg4#160, avg(agg5#32)#152 AS agg5#161, avg(agg6#33)#153 AS agg6#162, avg(agg7#34)#154 AS agg7#163]
+Input [16]: [i_item_id#151, ca_country#159, sum#182, count#183, sum#184, count#185, sum#186, count#187, sum#188, count#189, sum#190, count#191, sum#192, count#193, sum#194, count#195]
+Keys [2]: [i_item_id#151, ca_country#159]
+Functions [7]: [avg(agg1#161), avg(agg2#162), avg(agg3#163), avg(agg4#164), avg(agg5#165), avg(agg6#166), avg(agg7#167)]
+Aggregate Attributes [7]: [avg(agg1#161)#196, avg(agg2#162)#197, avg(agg3#163)#198, avg(agg4#164)#199, avg(agg5#165)#200, avg(agg6#166)#201, avg(agg7#167)#202]
+Results [11]: [i_item_id#151, ca_country#159, null AS ca_state#203, null AS county#204, avg(agg1#161)#196 AS agg1#205, avg(agg2#162)#197 AS agg2#206, avg(agg3#163)#198 AS agg3#207, avg(agg4#164)#199 AS agg4#208, avg(agg5#165)#200 AS agg5#209, avg(agg6#166)#201 AS agg6#210, avg(agg7#167)#202 AS agg7#211]
 
 (99) Scan parquet spark_catalog.default.catalog_sales
-Output [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
+Output [9]: [cs_bill_customer_sk#212, cs_bill_cdemo_sk#213, cs_item_sk#214, cs_quantity#215, cs_list_price#216, cs_sales_price#217, cs_coupon_amt#218, cs_net_profit#219, cs_sold_date_sk#220]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#9), dynamicpruningexpression(cs_sold_date_sk#9 IN dynamicpruning#10)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#220), dynamicpruningexpression(cs_sold_date_sk#220 IN dynamicpruning#10)]
 PushedFilters: [IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_customer_sk), IsNotNull(cs_item_sk)]
 ReadSchema: struct<cs_bill_customer_sk:int,cs_bill_cdemo_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2),cs_sales_price:decimal(7,2),cs_coupon_amt:decimal(7,2),cs_net_profit:decimal(7,2)>
 
 (100) ColumnarToRow [codegen id : 49]
-Input [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
+Input [9]: [cs_bill_customer_sk#212, cs_bill_cdemo_sk#213, cs_item_sk#214, cs_quantity#215, cs_list_price#216, cs_sales_price#217, cs_coupon_amt#218, cs_net_profit#219, cs_sold_date_sk#220]
 
 (101) Filter [codegen id : 49]
-Input [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
-Condition : ((isnotnull(cs_bill_cdemo_sk#2) AND isnotnull(cs_bill_customer_sk#1)) AND isnotnull(cs_item_sk#3))
+Input [9]: [cs_bill_customer_sk#212, cs_bill_cdemo_sk#213, cs_item_sk#214, cs_quantity#215, cs_list_price#216, cs_sales_price#217, cs_coupon_amt#218, cs_net_profit#219, cs_sold_date_sk#220]
+Condition : ((isnotnull(cs_bill_cdemo_sk#213) AND isnotnull(cs_bill_customer_sk#212)) AND isnotnull(cs_item_sk#214))
 
 (102) ReusedExchange [Reuses operator id: 8]
-Output [2]: [cd_demo_sk#11, cd_dep_count#14]
+Output [2]: [cd_demo_sk#221, cd_dep_count#222]
 
 (103) BroadcastHashJoin [codegen id : 49]
-Left keys [1]: [cs_bill_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#11]
+Left keys [1]: [cs_bill_cdemo_sk#213]
+Right keys [1]: [cd_demo_sk#221]
 Join type: Inner
 Join condition: None
 
 (104) Project [codegen id : 49]
-Output [9]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14]
-Input [11]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_demo_sk#11, cd_dep_count#14]
+Output [9]: [cs_bill_customer_sk#212, cs_item_sk#214, cs_quantity#215, cs_list_price#216, cs_sales_price#217, cs_coupon_amt#218, cs_net_profit#219, cs_sold_date_sk#220, cd_dep_count#222]
+Input [11]: [cs_bill_customer_sk#212, cs_bill_cdemo_sk#213, cs_item_sk#214, cs_quantity#215, cs_list_price#216, cs_sales_price#217, cs_coupon_amt#218, cs_net_profit#219, cs_sold_date_sk#220, cd_demo_sk#221, cd_dep_count#222]
 
 (105) ReusedExchange [Reuses operator id: 161]
-Output [1]: [d_date_sk#15]
+Output [1]: [d_date_sk#223]
 
 (106) BroadcastHashJoin [codegen id : 49]
-Left keys [1]: [cs_sold_date_sk#9]
-Right keys [1]: [d_date_sk#15]
+Left keys [1]: [cs_sold_date_sk#220]
+Right keys [1]: [d_date_sk#223]
 Join type: Inner
 Join condition: None
 
 (107) Project [codegen id : 49]
-Output [8]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14]
-Input [10]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, d_date_sk#15]
+Output [8]: [cs_bill_customer_sk#212, cs_item_sk#214, cs_quantity#215, cs_list_price#216, cs_sales_price#217, cs_coupon_amt#218, cs_net_profit#219, cd_dep_count#222]
+Input [10]: [cs_bill_customer_sk#212, cs_item_sk#214, cs_quantity#215, cs_list_price#216, cs_sales_price#217, cs_coupon_amt#218, cs_net_profit#219, cs_sold_date_sk#220, cd_dep_count#222, d_date_sk#223]
 
 (108) Scan parquet spark_catalog.default.customer
-Output [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_month#21, c_birth_year#22]
+Output [5]: [c_customer_sk#224, c_current_cdemo_sk#225, c_current_addr_sk#226, c_birth_month#227, c_birth_year#228]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer]
 PushedFilters: [In(c_birth_month, [1,10,12,4,5,9]), IsNotNull(c_customer_sk), IsNotNull(c_current_cdemo_sk), IsNotNull(c_current_addr_sk)]
 ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int,c_birth_month:int,c_birth_year:int>
 
 (109) ColumnarToRow [codegen id : 46]
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_month#21, c_birth_year#22]
+Input [5]: [c_customer_sk#224, c_current_cdemo_sk#225, c_current_addr_sk#226, c_birth_month#227, c_birth_year#228]
 
 (110) Filter [codegen id : 46]
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_month#21, c_birth_year#22]
-Condition : (((c_birth_month#21 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#18)) AND isnotnull(c_current_cdemo_sk#19)) AND isnotnull(c_current_addr_sk#20))
+Input [5]: [c_customer_sk#224, c_current_cdemo_sk#225, c_current_addr_sk#226, c_birth_month#227, c_birth_year#228]
+Condition : (((c_birth_month#227 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#224)) AND isnotnull(c_current_cdemo_sk#225)) AND isnotnull(c_current_addr_sk#226))
 
 (111) Project [codegen id : 46]
-Output [4]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_year#22]
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_month#21, c_birth_year#22]
+Output [4]: [c_customer_sk#224, c_current_cdemo_sk#225, c_current_addr_sk#226, c_birth_year#228]
+Input [5]: [c_customer_sk#224, c_current_cdemo_sk#225, c_current_addr_sk#226, c_birth_month#227, c_birth_year#228]
 
 (112) Scan parquet spark_catalog.default.customer_address
-Output [2]: [ca_address_sk#23, ca_state#25]
+Output [2]: [ca_address_sk#229, ca_state#230]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [In(ca_state, [AL,MS,NC,ND,OK,TN,WI]), IsNotNull(ca_address_sk)]
 ReadSchema: struct<ca_address_sk:int,ca_state:string>
 
 (113) ColumnarToRow [codegen id : 45]
-Input [2]: [ca_address_sk#23, ca_state#25]
+Input [2]: [ca_address_sk#229, ca_state#230]
 
 (114) Filter [codegen id : 45]
-Input [2]: [ca_address_sk#23, ca_state#25]
-Condition : (ca_state#25 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#23))
+Input [2]: [ca_address_sk#229, ca_state#230]
+Condition : (ca_state#230 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#229))
 
 (115) Project [codegen id : 45]
-Output [1]: [ca_address_sk#23]
-Input [2]: [ca_address_sk#23, ca_state#25]
+Output [1]: [ca_address_sk#229]
+Input [2]: [ca_address_sk#229, ca_state#230]
 
 (116) BroadcastExchange
-Input [1]: [ca_address_sk#23]
+Input [1]: [ca_address_sk#229]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=17]
 
 (117) BroadcastHashJoin [codegen id : 46]
-Left keys [1]: [c_current_addr_sk#20]
-Right keys [1]: [ca_address_sk#23]
+Left keys [1]: [c_current_addr_sk#226]
+Right keys [1]: [ca_address_sk#229]
 Join type: Inner
 Join condition: None
 
 (118) Project [codegen id : 46]
-Output [3]: [c_customer_sk#18, c_current_cdemo_sk#19, c_birth_year#22]
-Input [5]: [c_customer_sk#18, c_current_cdemo_sk#19, c_current_addr_sk#20, c_birth_year#22, ca_address_sk#23]
+Output [3]: [c_customer_sk#224, c_current_cdemo_sk#225, c_birth_year#228]
+Input [5]: [c_customer_sk#224, c_current_cdemo_sk#225, c_current_addr_sk#226, c_birth_year#228, ca_address_sk#229]
 
 (119) BroadcastExchange
-Input [3]: [c_customer_sk#18, c_current_cdemo_sk#19, c_birth_year#22]
+Input [3]: [c_customer_sk#224, c_current_cdemo_sk#225, c_birth_year#228]
 Arguments: HashedRelationBroadcastMode(List(cast(input[1, int, true] as bigint)),false), [plan_id=18]
 
 (120) Scan parquet spark_catalog.default.customer_demographics
-Output [1]: [cd_demo_sk#27]
+Output [1]: [cd_demo_sk#231]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_demographics]
 PushedFilters: [IsNotNull(cd_demo_sk)]
 ReadSchema: struct<cd_demo_sk:int>
 
 (121) ColumnarToRow
-Input [1]: [cd_demo_sk#27]
+Input [1]: [cd_demo_sk#231]
 
 (122) Filter
-Input [1]: [cd_demo_sk#27]
-Condition : isnotnull(cd_demo_sk#27)
+Input [1]: [cd_demo_sk#231]
+Condition : isnotnull(cd_demo_sk#231)
 
 (123) BroadcastHashJoin [codegen id : 47]
-Left keys [1]: [c_current_cdemo_sk#19]
-Right keys [1]: [cd_demo_sk#27]
+Left keys [1]: [c_current_cdemo_sk#225]
+Right keys [1]: [cd_demo_sk#231]
 Join type: Inner
 Join condition: None
 
 (124) Project [codegen id : 47]
-Output [2]: [c_customer_sk#18, c_birth_year#22]
-Input [4]: [c_customer_sk#18, c_current_cdemo_sk#19, c_birth_year#22, cd_demo_sk#27]
+Output [2]: [c_customer_sk#224, c_birth_year#228]
+Input [4]: [c_customer_sk#224, c_current_cdemo_sk#225, c_birth_year#228, cd_demo_sk#231]
 
 (125) BroadcastExchange
-Input [2]: [c_customer_sk#18, c_birth_year#22]
+Input [2]: [c_customer_sk#224, c_birth_year#228]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=19]
 
 (126) BroadcastHashJoin [codegen id : 49]
-Left keys [1]: [cs_bill_customer_sk#1]
-Right keys [1]: [c_customer_sk#18]
+Left keys [1]: [cs_bill_customer_sk#212]
+Right keys [1]: [c_customer_sk#224]
 Join type: Inner
 Join condition: None
 
 (127) Project [codegen id : 49]
-Output [8]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, c_birth_year#22]
-Input [10]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, c_customer_sk#18, c_birth_year#22]
+Output [8]: [cs_item_sk#214, cs_quantity#215, cs_list_price#216, cs_sales_price#217, cs_coupon_amt#218, cs_net_profit#219, cd_dep_count#222, c_birth_year#228]
+Input [10]: [cs_bill_customer_sk#212, cs_item_sk#214, cs_quantity#215, cs_list_price#216, cs_sales_price#217, cs_coupon_amt#218, cs_net_profit#219, cd_dep_count#222, c_customer_sk#224, c_birth_year#228]
 
 (128) ReusedExchange [Reuses operator id: 17]
-Output [2]: [i_item_sk#16, i_item_id#17]
+Output [2]: [i_item_sk#232, i_item_id#233]
 
 (129) BroadcastHashJoin [codegen id : 49]
-Left keys [1]: [cs_item_sk#3]
-Right keys [1]: [i_item_sk#16]
+Left keys [1]: [cs_item_sk#214]
+Right keys [1]: [i_item_sk#232]
 Join type: Inner
 Join condition: None
 
 (130) Project [codegen id : 49]
-Output [8]: [i_item_id#17, cast(cs_quantity#4 as decimal(12,2)) AS agg1#28, cast(cs_list_price#5 as decimal(12,2)) AS agg2#29, cast(cs_coupon_amt#7 as decimal(12,2)) AS agg3#30, cast(cs_sales_price#6 as decimal(12,2)) AS agg4#31, cast(cs_net_profit#8 as decimal(12,2)) AS agg5#32, cast(c_birth_year#22 as decimal(12,2)) AS agg6#33, cast(cd_dep_count#14 as decimal(12,2)) AS agg7#34]
-Input [10]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, c_birth_year#22, i_item_sk#16, i_item_id#17]
+Output [8]: [i_item_id#233, cast(cs_quantity#215 as decimal(12,2)) AS agg1#234, cast(cs_list_price#216 as decimal(12,2)) AS agg2#235, cast(cs_coupon_amt#218 as decimal(12,2)) AS agg3#236, cast(cs_sales_price#217 as decimal(12,2)) AS agg4#237, cast(cs_net_profit#219 as decimal(12,2)) AS agg5#238, cast(c_birth_year#228 as decimal(12,2)) AS agg6#239, cast(cd_dep_count#222 as decimal(12,2)) AS agg7#240]
+Input [10]: [cs_item_sk#214, cs_quantity#215, cs_list_price#216, cs_sales_price#217, cs_coupon_amt#218, cs_net_profit#219, cd_dep_count#222, c_birth_year#228, i_item_sk#232, i_item_id#233]
 
 (131) HashAggregate [codegen id : 49]
-Input [8]: [i_item_id#17, agg1#28, agg2#29, agg3#30, agg4#31, agg5#32, agg6#33, agg7#34]
-Keys [1]: [i_item_id#17]
-Functions [7]: [partial_avg(agg1#28), partial_avg(agg2#29), partial_avg(agg3#30), partial_avg(agg4#31), partial_avg(agg5#32), partial_avg(agg6#33), partial_avg(agg7#34)]
-Aggregate Attributes [14]: [sum#164, count#165, sum#166, count#167, sum#168, count#169, sum#170, count#171, sum#172, count#173, sum#174, count#175, sum#176, count#177]
-Results [15]: [i_item_id#17, sum#178, count#179, sum#180, count#181, sum#182, count#183, sum#184, count#185, sum#186, count#187, sum#188, count#189, sum#190, count#191]
+Input [8]: [i_item_id#233, agg1#234, agg2#235, agg3#236, agg4#237, agg5#238, agg6#239, agg7#240]
+Keys [1]: [i_item_id#233]
+Functions [7]: [partial_avg(agg1#234), partial_avg(agg2#235), partial_avg(agg3#236), partial_avg(agg4#237), partial_avg(agg5#238), partial_avg(agg6#239), partial_avg(agg7#240)]
+Aggregate Attributes [14]: [sum#241, count#242, sum#243, count#244, sum#245, count#246, sum#247, count#248, sum#249, count#250, sum#251, count#252, sum#253, count#254]
+Results [15]: [i_item_id#233, sum#255, count#256, sum#257, count#258, sum#259, count#260, sum#261, count#262, sum#263, count#264, sum#265, count#266, sum#267, count#268]
 
 (132) Exchange
-Input [15]: [i_item_id#17, sum#178, count#179, sum#180, count#181, sum#182, count#183, sum#184, count#185, sum#186, count#187, sum#188, count#189, sum#190, count#191]
-Arguments: hashpartitioning(i_item_id#17, 5), ENSURE_REQUIREMENTS, [plan_id=20]
+Input [15]: [i_item_id#233, sum#255, count#256, sum#257, count#258, sum#259, count#260, sum#261, count#262, sum#263, count#264, sum#265, count#266, sum#267, count#268]
+Arguments: hashpartitioning(i_item_id#233, 5), ENSURE_REQUIREMENTS, [plan_id=20]
 
 (133) HashAggregate [codegen id : 50]
-Input [15]: [i_item_id#17, sum#178, count#179, sum#180, count#181, sum#182, count#183, sum#184, count#185, sum#186, count#187, sum#188, count#189, sum#190, count#191]
-Keys [1]: [i_item_id#17]
-Functions [7]: [avg(agg1#28), avg(agg2#29), avg(agg3#30), avg(agg4#31), avg(agg5#32), avg(agg6#33), avg(agg7#34)]
-Aggregate Attributes [7]: [avg(agg1#28)#192, avg(agg2#29)#193, avg(agg3#30)#194, avg(agg4#31)#195, avg(agg5#32)#196, avg(agg6#33)#197, avg(agg7#34)#198]
-Results [11]: [i_item_id#17, null AS ca_country#199, null AS ca_state#200, null AS county#201, avg(agg1#28)#192 AS agg1#202, avg(agg2#29)#193 AS agg2#203, avg(agg3#30)#194 AS agg3#204, avg(agg4#31)#195 AS agg4#205, avg(agg5#32)#196 AS agg5#206, avg(agg6#33)#197 AS agg6#207, avg(agg7#34)#198 AS agg7#208]
+Input [15]: [i_item_id#233, sum#255, count#256, sum#257, count#258, sum#259, count#260, sum#261, count#262, sum#263, count#264, sum#265, count#266, sum#267, count#268]
+Keys [1]: [i_item_id#233]
+Functions [7]: [avg(agg1#234), avg(agg2#235), avg(agg3#236), avg(agg4#237), avg(agg5#238), avg(agg6#239), avg(agg7#240)]
+Aggregate Attributes [7]: [avg(agg1#234)#269, avg(agg2#235)#270, avg(agg3#236)#271, avg(agg4#237)#272, avg(agg5#238)#273, avg(agg6#239)#274, avg(agg7#240)#275]
+Results [11]: [i_item_id#233, null AS ca_country#276, null AS ca_state#277, null AS county#278, avg(agg1#234)#269 AS agg1#279, avg(agg2#235)#270 AS agg2#280, avg(agg3#236)#271 AS agg3#281, avg(agg4#237)#272 AS agg4#282, avg(agg5#238)#273 AS agg5#283, avg(agg6#239)#274 AS agg6#284, avg(agg7#240)#275 AS agg7#285]
 
 (134) Scan parquet spark_catalog.default.catalog_sales
-Output [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
+Output [9]: [cs_bill_customer_sk#286, cs_bill_cdemo_sk#287, cs_item_sk#288, cs_quantity#289, cs_list_price#290, cs_sales_price#291, cs_coupon_amt#292, cs_net_profit#293, cs_sold_date_sk#294]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#9), dynamicpruningexpression(cs_sold_date_sk#9 IN dynamicpruning#10)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#294), dynamicpruningexpression(cs_sold_date_sk#294 IN dynamicpruning#10)]
 PushedFilters: [IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_customer_sk), IsNotNull(cs_item_sk)]
 ReadSchema: struct<cs_bill_customer_sk:int,cs_bill_cdemo_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2),cs_sales_price:decimal(7,2),cs_coupon_amt:decimal(7,2),cs_net_profit:decimal(7,2)>
 
 (135) ColumnarToRow [codegen id : 57]
-Input [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
+Input [9]: [cs_bill_customer_sk#286, cs_bill_cdemo_sk#287, cs_item_sk#288, cs_quantity#289, cs_list_price#290, cs_sales_price#291, cs_coupon_amt#292, cs_net_profit#293, cs_sold_date_sk#294]
 
 (136) Filter [codegen id : 57]
-Input [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
-Condition : ((isnotnull(cs_bill_cdemo_sk#2) AND isnotnull(cs_bill_customer_sk#1)) AND isnotnull(cs_item_sk#3))
+Input [9]: [cs_bill_customer_sk#286, cs_bill_cdemo_sk#287, cs_item_sk#288, cs_quantity#289, cs_list_price#290, cs_sales_price#291, cs_coupon_amt#292, cs_net_profit#293, cs_sold_date_sk#294]
+Condition : ((isnotnull(cs_bill_cdemo_sk#287) AND isnotnull(cs_bill_customer_sk#286)) AND isnotnull(cs_item_sk#288))
 
 (137) ReusedExchange [Reuses operator id: 8]
-Output [2]: [cd_demo_sk#11, cd_dep_count#14]
+Output [2]: [cd_demo_sk#295, cd_dep_count#296]
 
 (138) BroadcastHashJoin [codegen id : 57]
-Left keys [1]: [cs_bill_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#11]
+Left keys [1]: [cs_bill_cdemo_sk#287]
+Right keys [1]: [cd_demo_sk#295]
 Join type: Inner
 Join condition: None
 
 (139) Project [codegen id : 57]
-Output [9]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14]
-Input [11]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_demo_sk#11, cd_dep_count#14]
+Output [9]: [cs_bill_customer_sk#286, cs_item_sk#288, cs_quantity#289, cs_list_price#290, cs_sales_price#291, cs_coupon_amt#292, cs_net_profit#293, cs_sold_date_sk#294, cd_dep_count#296]
+Input [11]: [cs_bill_customer_sk#286, cs_bill_cdemo_sk#287, cs_item_sk#288, cs_quantity#289, cs_list_price#290, cs_sales_price#291, cs_coupon_amt#292, cs_net_profit#293, cs_sold_date_sk#294, cd_demo_sk#295, cd_dep_count#296]
 
 (140) ReusedExchange [Reuses operator id: 161]
-Output [1]: [d_date_sk#15]
+Output [1]: [d_date_sk#297]
 
 (141) BroadcastHashJoin [codegen id : 57]
-Left keys [1]: [cs_sold_date_sk#9]
-Right keys [1]: [d_date_sk#15]
+Left keys [1]: [cs_sold_date_sk#294]
+Right keys [1]: [d_date_sk#297]
 Join type: Inner
 Join condition: None
 
 (142) Project [codegen id : 57]
-Output [8]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14]
-Input [10]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, d_date_sk#15]
+Output [8]: [cs_bill_customer_sk#286, cs_item_sk#288, cs_quantity#289, cs_list_price#290, cs_sales_price#291, cs_coupon_amt#292, cs_net_profit#293, cd_dep_count#296]
+Input [10]: [cs_bill_customer_sk#286, cs_item_sk#288, cs_quantity#289, cs_list_price#290, cs_sales_price#291, cs_coupon_amt#292, cs_net_profit#293, cs_sold_date_sk#294, cd_dep_count#296, d_date_sk#297]
 
 (143) Scan parquet spark_catalog.default.item
-Output [1]: [i_item_sk#16]
+Output [1]: [i_item_sk#298]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/item]
 PushedFilters: [IsNotNull(i_item_sk)]
 ReadSchema: struct<i_item_sk:int>
 
 (144) ColumnarToRow [codegen id : 53]
-Input [1]: [i_item_sk#16]
+Input [1]: [i_item_sk#298]
 
 (145) Filter [codegen id : 53]
-Input [1]: [i_item_sk#16]
-Condition : isnotnull(i_item_sk#16)
+Input [1]: [i_item_sk#298]
+Condition : isnotnull(i_item_sk#298)
 
 (146) BroadcastExchange
-Input [1]: [i_item_sk#16]
+Input [1]: [i_item_sk#298]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=21]
 
 (147) BroadcastHashJoin [codegen id : 57]
-Left keys [1]: [cs_item_sk#3]
-Right keys [1]: [i_item_sk#16]
+Left keys [1]: [cs_item_sk#288]
+Right keys [1]: [i_item_sk#298]
 Join type: Inner
 Join condition: None
 
 (148) Project [codegen id : 57]
-Output [7]: [cs_bill_customer_sk#1, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14]
-Input [9]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, i_item_sk#16]
+Output [7]: [cs_bill_customer_sk#286, cs_quantity#289, cs_list_price#290, cs_sales_price#291, cs_coupon_amt#292, cs_net_profit#293, cd_dep_count#296]
+Input [9]: [cs_bill_customer_sk#286, cs_item_sk#288, cs_quantity#289, cs_list_price#290, cs_sales_price#291, cs_coupon_amt#292, cs_net_profit#293, cd_dep_count#296, i_item_sk#298]
 
 (149) ReusedExchange [Reuses operator id: 125]
-Output [2]: [c_customer_sk#18, c_birth_year#22]
+Output [2]: [c_customer_sk#299, c_birth_year#300]
 
 (150) BroadcastHashJoin [codegen id : 57]
-Left keys [1]: [cs_bill_customer_sk#1]
-Right keys [1]: [c_customer_sk#18]
+Left keys [1]: [cs_bill_customer_sk#286]
+Right keys [1]: [c_customer_sk#299]
 Join type: Inner
 Join condition: None
 
 (151) Project [codegen id : 57]
-Output [7]: [cast(cs_quantity#4 as decimal(12,2)) AS agg1#28, cast(cs_list_price#5 as decimal(12,2)) AS agg2#29, cast(cs_coupon_amt#7 as decimal(12,2)) AS agg3#30, cast(cs_sales_price#6 as decimal(12,2)) AS agg4#31, cast(cs_net_profit#8 as decimal(12,2)) AS agg5#32, cast(c_birth_year#22 as decimal(12,2)) AS agg6#33, cast(cd_dep_count#14 as decimal(12,2)) AS agg7#34]
-Input [9]: [cs_bill_customer_sk#1, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, c_customer_sk#18, c_birth_year#22]
+Output [7]: [cast(cs_quantity#289 as decimal(12,2)) AS agg1#301, cast(cs_list_price#290 as decimal(12,2)) AS agg2#302, cast(cs_coupon_amt#292 as decimal(12,2)) AS agg3#303, cast(cs_sales_price#291 as decimal(12,2)) AS agg4#304, cast(cs_net_profit#293 as decimal(12,2)) AS agg5#305, cast(c_birth_year#300 as decimal(12,2)) AS agg6#306, cast(cd_dep_count#296 as decimal(12,2)) AS agg7#307]
+Input [9]: [cs_bill_customer_sk#286, cs_quantity#289, cs_list_price#290, cs_sales_price#291, cs_coupon_amt#292, cs_net_profit#293, cd_dep_count#296, c_customer_sk#299, c_birth_year#300]
 
 (152) HashAggregate [codegen id : 57]
-Input [7]: [agg1#28, agg2#29, agg3#30, agg4#31, agg5#32, agg6#33, agg7#34]
+Input [7]: [agg1#301, agg2#302, agg3#303, agg4#304, agg5#305, agg6#306, agg7#307]
 Keys: []
-Functions [7]: [partial_avg(agg1#28), partial_avg(agg2#29), partial_avg(agg3#30), partial_avg(agg4#31), partial_avg(agg5#32), partial_avg(agg6#33), partial_avg(agg7#34)]
-Aggregate Attributes [14]: [sum#209, count#210, sum#211, count#212, sum#213, count#214, sum#215, count#216, sum#217, count#218, sum#219, count#220, sum#221, count#222]
-Results [14]: [sum#223, count#224, sum#225, count#226, sum#227, count#228, sum#229, count#230, sum#231, count#232, sum#233, count#234, sum#235, count#236]
+Functions [7]: [partial_avg(agg1#301), partial_avg(agg2#302), partial_avg(agg3#303), partial_avg(agg4#304), partial_avg(agg5#305), partial_avg(agg6#306), partial_avg(agg7#307)]
+Aggregate Attributes [14]: [sum#308, count#309, sum#310, count#311, sum#312, count#313, sum#314, count#315, sum#316, count#317, sum#318, count#319, sum#320, count#321]
+Results [14]: [sum#322, count#323, sum#324, count#325, sum#326, count#327, sum#328, count#329, sum#330, count#331, sum#332, count#333, sum#334, count#335]
 
 (153) Exchange
-Input [14]: [sum#223, count#224, sum#225, count#226, sum#227, count#228, sum#229, count#230, sum#231, count#232, sum#233, count#234, sum#235, count#236]
+Input [14]: [sum#322, count#323, sum#324, count#325, sum#326, count#327, sum#328, count#329, sum#330, count#331, sum#332, count#333, sum#334, count#335]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=22]
 
 (154) HashAggregate [codegen id : 58]
-Input [14]: [sum#223, count#224, sum#225, count#226, sum#227, count#228, sum#229, count#230, sum#231, count#232, sum#233, count#234, sum#235, count#236]
+Input [14]: [sum#322, count#323, sum#324, count#325, sum#326, count#327, sum#328, count#329, sum#330, count#331, sum#332, count#333, sum#334, count#335]
 Keys: []
-Functions [7]: [avg(agg1#28), avg(agg2#29), avg(agg3#30), avg(agg4#31), avg(agg5#32), avg(agg6#33), avg(agg7#34)]
-Aggregate Attributes [7]: [avg(agg1#28)#237, avg(agg2#29)#238, avg(agg3#30)#239, avg(agg4#31)#240, avg(agg5#32)#241, avg(agg6#33)#242, avg(agg7#34)#243]
-Results [11]: [null AS i_item_id#244, null AS ca_country#245, null AS ca_state#246, null AS county#247, avg(agg1#28)#237 AS agg1#248, avg(agg2#29)#238 AS agg2#249, avg(agg3#30)#239 AS agg3#250, avg(agg4#31)#240 AS agg4#251, avg(agg5#32)#241 AS agg5#252, avg(agg6#33)#242 AS agg6#253, avg(agg7#34)#243 AS agg7#254]
+Functions [7]: [avg(agg1#301), avg(agg2#302), avg(agg3#303), avg(agg4#304), avg(agg5#305), avg(agg6#306), avg(agg7#307)]
+Aggregate Attributes [7]: [avg(agg1#301)#336, avg(agg2#302)#337, avg(agg3#303)#338, avg(agg4#304)#339, avg(agg5#305)#340, avg(agg6#306)#341, avg(agg7#307)#342]
+Results [11]: [null AS i_item_id#343, null AS ca_country#344, null AS ca_state#345, null AS county#346, avg(agg1#301)#336 AS agg1#347, avg(agg2#302)#337 AS agg2#348, avg(agg3#303)#338 AS agg3#349, avg(agg4#304)#339 AS agg4#350, avg(agg5#305)#340 AS agg5#351, avg(agg6#306)#341 AS agg6#352, avg(agg7#307)#342 AS agg7#353]
 
 (155) Union
 
@@ -888,29 +888,29 @@ BroadcastExchange (161)
 
 
 (157) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#15, d_year#255]
+Output [2]: [d_date_sk#15, d_year#354]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (158) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#15, d_year#255]
+Input [2]: [d_date_sk#15, d_year#354]
 
 (159) Filter [codegen id : 1]
-Input [2]: [d_date_sk#15, d_year#255]
-Condition : ((isnotnull(d_year#255) AND (d_year#255 = 2001)) AND isnotnull(d_date_sk#15))
+Input [2]: [d_date_sk#15, d_year#354]
+Condition : ((isnotnull(d_year#354) AND (d_year#354 = 2001)) AND isnotnull(d_date_sk#15))
 
 (160) Project [codegen id : 1]
 Output [1]: [d_date_sk#15]
-Input [2]: [d_date_sk#15, d_year#255]
+Input [2]: [d_date_sk#15, d_year#354]
 
 (161) BroadcastExchange
 Input [1]: [d_date_sk#15]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=23]
 
-Subquery:2 Hosting operator id = 99 Hosting Expression = cs_sold_date_sk#9 IN dynamicpruning#10
+Subquery:2 Hosting operator id = 99 Hosting Expression = cs_sold_date_sk#220 IN dynamicpruning#10
 
-Subquery:3 Hosting operator id = 134 Hosting Expression = cs_sold_date_sk#9 IN dynamicpruning#10
+Subquery:3 Hosting operator id = 134 Hosting Expression = cs_sold_date_sk#294 IN dynamicpruning#10
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q18a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q18a/explain.txt
index 15a07e3933c..33a0479b28f 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q18a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q18a/explain.txt
@@ -349,516 +349,516 @@ Aggregate Attributes [7]: [avg(agg1#28)#63, avg(agg2#29)#64, avg(agg3#30)#65, av
 Results [11]: [i_item_id#27, ca_country#24, ca_state#23, ca_county#22, avg(agg1#28)#63 AS agg1#70, avg(agg2#29)#64 AS agg2#71, avg(agg3#30)#65 AS agg3#72, avg(agg4#31)#66 AS agg4#73, avg(agg5#32)#67 AS agg5#74, avg(agg6#33)#68 AS agg6#75, avg(agg7#34)#69 AS agg7#76]
 
 (42) Scan parquet spark_catalog.default.catalog_sales
-Output [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
+Output [9]: [cs_bill_customer_sk#77, cs_bill_cdemo_sk#78, cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cs_sold_date_sk#85]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#9), dynamicpruningexpression(cs_sold_date_sk#9 IN dynamicpruning#10)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#85), dynamicpruningexpression(cs_sold_date_sk#85 IN dynamicpruning#10)]
 PushedFilters: [IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_customer_sk), IsNotNull(cs_item_sk)]
 ReadSchema: struct<cs_bill_customer_sk:int,cs_bill_cdemo_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2),cs_sales_price:decimal(7,2),cs_coupon_amt:decimal(7,2),cs_net_profit:decimal(7,2)>
 
 (43) ColumnarToRow [codegen id : 15]
-Input [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
+Input [9]: [cs_bill_customer_sk#77, cs_bill_cdemo_sk#78, cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cs_sold_date_sk#85]
 
 (44) Filter [codegen id : 15]
-Input [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
-Condition : ((isnotnull(cs_bill_cdemo_sk#2) AND isnotnull(cs_bill_customer_sk#1)) AND isnotnull(cs_item_sk#3))
+Input [9]: [cs_bill_customer_sk#77, cs_bill_cdemo_sk#78, cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cs_sold_date_sk#85]
+Condition : ((isnotnull(cs_bill_cdemo_sk#78) AND isnotnull(cs_bill_customer_sk#77)) AND isnotnull(cs_item_sk#79))
 
 (45) ReusedExchange [Reuses operator id: 8]
-Output [2]: [cd_demo_sk#11, cd_dep_count#14]
+Output [2]: [cd_demo_sk#86, cd_dep_count#87]
 
 (46) BroadcastHashJoin [codegen id : 15]
-Left keys [1]: [cs_bill_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#11]
+Left keys [1]: [cs_bill_cdemo_sk#78]
+Right keys [1]: [cd_demo_sk#86]
 Join type: Inner
 Join condition: None
 
 (47) Project [codegen id : 15]
-Output [9]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14]
-Input [11]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_demo_sk#11, cd_dep_count#14]
+Output [9]: [cs_bill_customer_sk#77, cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cs_sold_date_sk#85, cd_dep_count#87]
+Input [11]: [cs_bill_customer_sk#77, cs_bill_cdemo_sk#78, cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cs_sold_date_sk#85, cd_demo_sk#86, cd_dep_count#87]
 
 (48) ReusedExchange [Reuses operator id: 15]
-Output [4]: [c_customer_sk#15, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19]
+Output [4]: [c_customer_sk#88, c_current_cdemo_sk#89, c_current_addr_sk#90, c_birth_year#91]
 
 (49) BroadcastHashJoin [codegen id : 15]
-Left keys [1]: [cs_bill_customer_sk#1]
-Right keys [1]: [c_customer_sk#15]
+Left keys [1]: [cs_bill_customer_sk#77]
+Right keys [1]: [c_customer_sk#88]
 Join type: Inner
 Join condition: None
 
 (50) Project [codegen id : 15]
-Output [11]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19]
-Input [13]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_customer_sk#15, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19]
+Output [11]: [cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cs_sold_date_sk#85, cd_dep_count#87, c_current_cdemo_sk#89, c_current_addr_sk#90, c_birth_year#91]
+Input [13]: [cs_bill_customer_sk#77, cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cs_sold_date_sk#85, cd_dep_count#87, c_customer_sk#88, c_current_cdemo_sk#89, c_current_addr_sk#90, c_birth_year#91]
 
 (51) ReusedExchange [Reuses operator id: 21]
-Output [1]: [cd_demo_sk#20]
+Output [1]: [cd_demo_sk#92]
 
 (52) BroadcastHashJoin [codegen id : 15]
-Left keys [1]: [c_current_cdemo_sk#16]
-Right keys [1]: [cd_demo_sk#20]
+Left keys [1]: [c_current_cdemo_sk#89]
+Right keys [1]: [cd_demo_sk#92]
 Join type: Inner
 Join condition: None
 
 (53) Project [codegen id : 15]
-Output [10]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_addr_sk#17, c_birth_year#19]
-Input [12]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19, cd_demo_sk#20]
+Output [10]: [cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cs_sold_date_sk#85, cd_dep_count#87, c_current_addr_sk#90, c_birth_year#91]
+Input [12]: [cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cs_sold_date_sk#85, cd_dep_count#87, c_current_cdemo_sk#89, c_current_addr_sk#90, c_birth_year#91, cd_demo_sk#92]
 
 (54) Scan parquet spark_catalog.default.customer_address
-Output [3]: [ca_address_sk#21, ca_state#23, ca_country#24]
+Output [3]: [ca_address_sk#93, ca_state#94, ca_country#95]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [In(ca_state, [AL,MS,NC,ND,OK,TN,WI]), IsNotNull(ca_address_sk)]
 ReadSchema: struct<ca_address_sk:int,ca_state:string,ca_country:string>
 
 (55) ColumnarToRow [codegen id : 12]
-Input [3]: [ca_address_sk#21, ca_state#23, ca_country#24]
+Input [3]: [ca_address_sk#93, ca_state#94, ca_country#95]
 
 (56) Filter [codegen id : 12]
-Input [3]: [ca_address_sk#21, ca_state#23, ca_country#24]
-Condition : (ca_state#23 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#21))
+Input [3]: [ca_address_sk#93, ca_state#94, ca_country#95]
+Condition : (ca_state#94 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#93))
 
 (57) BroadcastExchange
-Input [3]: [ca_address_sk#21, ca_state#23, ca_country#24]
+Input [3]: [ca_address_sk#93, ca_state#94, ca_country#95]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7]
 
 (58) BroadcastHashJoin [codegen id : 15]
-Left keys [1]: [c_current_addr_sk#17]
-Right keys [1]: [ca_address_sk#21]
+Left keys [1]: [c_current_addr_sk#90]
+Right keys [1]: [ca_address_sk#93]
 Join type: Inner
 Join condition: None
 
 (59) Project [codegen id : 15]
-Output [11]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_birth_year#19, ca_state#23, ca_country#24]
-Input [13]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_addr_sk#17, c_birth_year#19, ca_address_sk#21, ca_state#23, ca_country#24]
+Output [11]: [cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cs_sold_date_sk#85, cd_dep_count#87, c_birth_year#91, ca_state#94, ca_country#95]
+Input [13]: [cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cs_sold_date_sk#85, cd_dep_count#87, c_current_addr_sk#90, c_birth_year#91, ca_address_sk#93, ca_state#94, ca_country#95]
 
 (60) ReusedExchange [Reuses operator id: 158]
-Output [1]: [d_date_sk#25]
+Output [1]: [d_date_sk#96]
 
 (61) BroadcastHashJoin [codegen id : 15]
-Left keys [1]: [cs_sold_date_sk#9]
-Right keys [1]: [d_date_sk#25]
+Left keys [1]: [cs_sold_date_sk#85]
+Right keys [1]: [d_date_sk#96]
 Join type: Inner
 Join condition: None
 
 (62) Project [codegen id : 15]
-Output [10]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, c_birth_year#19, ca_state#23, ca_country#24]
-Input [12]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_birth_year#19, ca_state#23, ca_country#24, d_date_sk#25]
+Output [10]: [cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cd_dep_count#87, c_birth_year#91, ca_state#94, ca_country#95]
+Input [12]: [cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cs_sold_date_sk#85, cd_dep_count#87, c_birth_year#91, ca_state#94, ca_country#95, d_date_sk#96]
 
 (63) ReusedExchange [Reuses operator id: 36]
-Output [2]: [i_item_sk#26, i_item_id#27]
+Output [2]: [i_item_sk#97, i_item_id#98]
 
 (64) BroadcastHashJoin [codegen id : 15]
-Left keys [1]: [cs_item_sk#3]
-Right keys [1]: [i_item_sk#26]
+Left keys [1]: [cs_item_sk#79]
+Right keys [1]: [i_item_sk#97]
 Join type: Inner
 Join condition: None
 
 (65) Project [codegen id : 15]
-Output [10]: [i_item_id#27, ca_country#24, ca_state#23, cast(cs_quantity#4 as decimal(12,2)) AS agg1#28, cast(cs_list_price#5 as decimal(12,2)) AS agg2#29, cast(cs_coupon_amt#7 as decimal(12,2)) AS agg3#30, cast(cs_sales_price#6 as decimal(12,2)) AS agg4#31, cast(cs_net_profit#8 as decimal(12,2)) AS agg5#32, cast(c_birth_year#19 as decimal(12,2)) AS agg6#33, cast(cd_dep_count#14 as decimal(12,2)) AS agg7#34]
-Input [12]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, c_birth_year#19, ca_state#23, ca_country#24, i_item_sk#26, i_item_id#27]
+Output [10]: [i_item_id#98, ca_country#95, ca_state#94, cast(cs_quantity#80 as decimal(12,2)) AS agg1#99, cast(cs_list_price#81 as decimal(12,2)) AS agg2#100, cast(cs_coupon_amt#83 as decimal(12,2)) AS agg3#101, cast(cs_sales_price#82 as decimal(12,2)) AS agg4#102, cast(cs_net_profit#84 as decimal(12,2)) AS agg5#103, cast(c_birth_year#91 as decimal(12,2)) AS agg6#104, cast(cd_dep_count#87 as decimal(12,2)) AS agg7#105]
+Input [12]: [cs_item_sk#79, cs_quantity#80, cs_list_price#81, cs_sales_price#82, cs_coupon_amt#83, cs_net_profit#84, cd_dep_count#87, c_birth_year#91, ca_state#94, ca_country#95, i_item_sk#97, i_item_id#98]
 
 (66) HashAggregate [codegen id : 15]
-Input [10]: [i_item_id#27, ca_country#24, ca_state#23, agg1#28, agg2#29, agg3#30, agg4#31, agg5#32, agg6#33, agg7#34]
-Keys [3]: [i_item_id#27, ca_country#24, ca_state#23]
-Functions [7]: [partial_avg(agg1#28), partial_avg(agg2#29), partial_avg(agg3#30), partial_avg(agg4#31), partial_avg(agg5#32), partial_avg(agg6#33), partial_avg(agg7#34)]
-Aggregate Attributes [14]: [sum#77, count#78, sum#79, count#80, sum#81, count#82, sum#83, count#84, sum#85, count#86, sum#87, count#88, sum#89, count#90]
-Results [17]: [i_item_id#27, ca_country#24, ca_state#23, sum#91, count#92, sum#93, count#94, sum#95, count#96, sum#97, count#98, sum#99, count#100, sum#101, count#102, sum#103, count#104]
+Input [10]: [i_item_id#98, ca_country#95, ca_state#94, agg1#99, agg2#100, agg3#101, agg4#102, agg5#103, agg6#104, agg7#105]
+Keys [3]: [i_item_id#98, ca_country#95, ca_state#94]
+Functions [7]: [partial_avg(agg1#99), partial_avg(agg2#100), partial_avg(agg3#101), partial_avg(agg4#102), partial_avg(agg5#103), partial_avg(agg6#104), partial_avg(agg7#105)]
+Aggregate Attributes [14]: [sum#106, count#107, sum#108, count#109, sum#110, count#111, sum#112, count#113, sum#114, count#115, sum#116, count#117, sum#118, count#119]
+Results [17]: [i_item_id#98, ca_country#95, ca_state#94, sum#120, count#121, sum#122, count#123, sum#124, count#125, sum#126, count#127, sum#128, count#129, sum#130, count#131, sum#132, count#133]
 
 (67) Exchange
-Input [17]: [i_item_id#27, ca_country#24, ca_state#23, sum#91, count#92, sum#93, count#94, sum#95, count#96, sum#97, count#98, sum#99, count#100, sum#101, count#102, sum#103, count#104]
-Arguments: hashpartitioning(i_item_id#27, ca_country#24, ca_state#23, 5), ENSURE_REQUIREMENTS, [plan_id=8]
+Input [17]: [i_item_id#98, ca_country#95, ca_state#94, sum#120, count#121, sum#122, count#123, sum#124, count#125, sum#126, count#127, sum#128, count#129, sum#130, count#131, sum#132, count#133]
+Arguments: hashpartitioning(i_item_id#98, ca_country#95, ca_state#94, 5), ENSURE_REQUIREMENTS, [plan_id=8]
 
 (68) HashAggregate [codegen id : 16]
-Input [17]: [i_item_id#27, ca_country#24, ca_state#23, sum#91, count#92, sum#93, count#94, sum#95, count#96, sum#97, count#98, sum#99, count#100, sum#101, count#102, sum#103, count#104]
-Keys [3]: [i_item_id#27, ca_country#24, ca_state#23]
-Functions [7]: [avg(agg1#28), avg(agg2#29), avg(agg3#30), avg(agg4#31), avg(agg5#32), avg(agg6#33), avg(agg7#34)]
-Aggregate Attributes [7]: [avg(agg1#28)#105, avg(agg2#29)#106, avg(agg3#30)#107, avg(agg4#31)#108, avg(agg5#32)#109, avg(agg6#33)#110, avg(agg7#34)#111]
-Results [11]: [i_item_id#27, ca_country#24, ca_state#23, null AS county#112, avg(agg1#28)#105 AS agg1#113, avg(agg2#29)#106 AS agg2#114, avg(agg3#30)#107 AS agg3#115, avg(agg4#31)#108 AS agg4#116, avg(agg5#32)#109 AS agg5#117, avg(agg6#33)#110 AS agg6#118, avg(agg7#34)#111 AS agg7#119]
+Input [17]: [i_item_id#98, ca_country#95, ca_state#94, sum#120, count#121, sum#122, count#123, sum#124, count#125, sum#126, count#127, sum#128, count#129, sum#130, count#131, sum#132, count#133]
+Keys [3]: [i_item_id#98, ca_country#95, ca_state#94]
+Functions [7]: [avg(agg1#99), avg(agg2#100), avg(agg3#101), avg(agg4#102), avg(agg5#103), avg(agg6#104), avg(agg7#105)]
+Aggregate Attributes [7]: [avg(agg1#99)#134, avg(agg2#100)#135, avg(agg3#101)#136, avg(agg4#102)#137, avg(agg5#103)#138, avg(agg6#104)#139, avg(agg7#105)#140]
+Results [11]: [i_item_id#98, ca_country#95, ca_state#94, null AS county#141, avg(agg1#99)#134 AS agg1#142, avg(agg2#100)#135 AS agg2#143, avg(agg3#101)#136 AS agg3#144, avg(agg4#102)#137 AS agg4#145, avg(agg5#103)#138 AS agg5#146, avg(agg6#104)#139 AS agg6#147, avg(agg7#105)#140 AS agg7#148]
 
 (69) Scan parquet spark_catalog.default.catalog_sales
-Output [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
+Output [9]: [cs_bill_customer_sk#149, cs_bill_cdemo_sk#150, cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cs_sold_date_sk#157]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#9), dynamicpruningexpression(cs_sold_date_sk#9 IN dynamicpruning#10)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#157), dynamicpruningexpression(cs_sold_date_sk#157 IN dynamicpruning#10)]
 PushedFilters: [IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_customer_sk), IsNotNull(cs_item_sk)]
 ReadSchema: struct<cs_bill_customer_sk:int,cs_bill_cdemo_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2),cs_sales_price:decimal(7,2),cs_coupon_amt:decimal(7,2),cs_net_profit:decimal(7,2)>
 
 (70) ColumnarToRow [codegen id : 23]
-Input [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
+Input [9]: [cs_bill_customer_sk#149, cs_bill_cdemo_sk#150, cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cs_sold_date_sk#157]
 
 (71) Filter [codegen id : 23]
-Input [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
-Condition : ((isnotnull(cs_bill_cdemo_sk#2) AND isnotnull(cs_bill_customer_sk#1)) AND isnotnull(cs_item_sk#3))
+Input [9]: [cs_bill_customer_sk#149, cs_bill_cdemo_sk#150, cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cs_sold_date_sk#157]
+Condition : ((isnotnull(cs_bill_cdemo_sk#150) AND isnotnull(cs_bill_customer_sk#149)) AND isnotnull(cs_item_sk#151))
 
 (72) ReusedExchange [Reuses operator id: 8]
-Output [2]: [cd_demo_sk#11, cd_dep_count#14]
+Output [2]: [cd_demo_sk#158, cd_dep_count#159]
 
 (73) BroadcastHashJoin [codegen id : 23]
-Left keys [1]: [cs_bill_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#11]
+Left keys [1]: [cs_bill_cdemo_sk#150]
+Right keys [1]: [cd_demo_sk#158]
 Join type: Inner
 Join condition: None
 
 (74) Project [codegen id : 23]
-Output [9]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14]
-Input [11]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_demo_sk#11, cd_dep_count#14]
+Output [9]: [cs_bill_customer_sk#149, cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cs_sold_date_sk#157, cd_dep_count#159]
+Input [11]: [cs_bill_customer_sk#149, cs_bill_cdemo_sk#150, cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cs_sold_date_sk#157, cd_demo_sk#158, cd_dep_count#159]
 
 (75) ReusedExchange [Reuses operator id: 15]
-Output [4]: [c_customer_sk#15, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19]
+Output [4]: [c_customer_sk#160, c_current_cdemo_sk#161, c_current_addr_sk#162, c_birth_year#163]
 
 (76) BroadcastHashJoin [codegen id : 23]
-Left keys [1]: [cs_bill_customer_sk#1]
-Right keys [1]: [c_customer_sk#15]
+Left keys [1]: [cs_bill_customer_sk#149]
+Right keys [1]: [c_customer_sk#160]
 Join type: Inner
 Join condition: None
 
 (77) Project [codegen id : 23]
-Output [11]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19]
-Input [13]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_customer_sk#15, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19]
+Output [11]: [cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cs_sold_date_sk#157, cd_dep_count#159, c_current_cdemo_sk#161, c_current_addr_sk#162, c_birth_year#163]
+Input [13]: [cs_bill_customer_sk#149, cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cs_sold_date_sk#157, cd_dep_count#159, c_customer_sk#160, c_current_cdemo_sk#161, c_current_addr_sk#162, c_birth_year#163]
 
 (78) ReusedExchange [Reuses operator id: 21]
-Output [1]: [cd_demo_sk#20]
+Output [1]: [cd_demo_sk#164]
 
 (79) BroadcastHashJoin [codegen id : 23]
-Left keys [1]: [c_current_cdemo_sk#16]
-Right keys [1]: [cd_demo_sk#20]
+Left keys [1]: [c_current_cdemo_sk#161]
+Right keys [1]: [cd_demo_sk#164]
 Join type: Inner
 Join condition: None
 
 (80) Project [codegen id : 23]
-Output [10]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_addr_sk#17, c_birth_year#19]
-Input [12]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19, cd_demo_sk#20]
+Output [10]: [cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cs_sold_date_sk#157, cd_dep_count#159, c_current_addr_sk#162, c_birth_year#163]
+Input [12]: [cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cs_sold_date_sk#157, cd_dep_count#159, c_current_cdemo_sk#161, c_current_addr_sk#162, c_birth_year#163, cd_demo_sk#164]
 
 (81) Scan parquet spark_catalog.default.customer_address
-Output [3]: [ca_address_sk#21, ca_state#23, ca_country#24]
+Output [3]: [ca_address_sk#165, ca_state#166, ca_country#167]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [In(ca_state, [AL,MS,NC,ND,OK,TN,WI]), IsNotNull(ca_address_sk)]
 ReadSchema: struct<ca_address_sk:int,ca_state:string,ca_country:string>
 
 (82) ColumnarToRow [codegen id : 20]
-Input [3]: [ca_address_sk#21, ca_state#23, ca_country#24]
+Input [3]: [ca_address_sk#165, ca_state#166, ca_country#167]
 
 (83) Filter [codegen id : 20]
-Input [3]: [ca_address_sk#21, ca_state#23, ca_country#24]
-Condition : (ca_state#23 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#21))
+Input [3]: [ca_address_sk#165, ca_state#166, ca_country#167]
+Condition : (ca_state#166 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#165))
 
 (84) Project [codegen id : 20]
-Output [2]: [ca_address_sk#21, ca_country#24]
-Input [3]: [ca_address_sk#21, ca_state#23, ca_country#24]
+Output [2]: [ca_address_sk#165, ca_country#167]
+Input [3]: [ca_address_sk#165, ca_state#166, ca_country#167]
 
 (85) BroadcastExchange
-Input [2]: [ca_address_sk#21, ca_country#24]
+Input [2]: [ca_address_sk#165, ca_country#167]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=9]
 
 (86) BroadcastHashJoin [codegen id : 23]
-Left keys [1]: [c_current_addr_sk#17]
-Right keys [1]: [ca_address_sk#21]
+Left keys [1]: [c_current_addr_sk#162]
+Right keys [1]: [ca_address_sk#165]
 Join type: Inner
 Join condition: None
 
 (87) Project [codegen id : 23]
-Output [10]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_birth_year#19, ca_country#24]
-Input [12]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_addr_sk#17, c_birth_year#19, ca_address_sk#21, ca_country#24]
+Output [10]: [cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cs_sold_date_sk#157, cd_dep_count#159, c_birth_year#163, ca_country#167]
+Input [12]: [cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cs_sold_date_sk#157, cd_dep_count#159, c_current_addr_sk#162, c_birth_year#163, ca_address_sk#165, ca_country#167]
 
 (88) ReusedExchange [Reuses operator id: 158]
-Output [1]: [d_date_sk#25]
+Output [1]: [d_date_sk#168]
 
 (89) BroadcastHashJoin [codegen id : 23]
-Left keys [1]: [cs_sold_date_sk#9]
-Right keys [1]: [d_date_sk#25]
+Left keys [1]: [cs_sold_date_sk#157]
+Right keys [1]: [d_date_sk#168]
 Join type: Inner
 Join condition: None
 
 (90) Project [codegen id : 23]
-Output [9]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, c_birth_year#19, ca_country#24]
-Input [11]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_birth_year#19, ca_country#24, d_date_sk#25]
+Output [9]: [cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cd_dep_count#159, c_birth_year#163, ca_country#167]
+Input [11]: [cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cs_sold_date_sk#157, cd_dep_count#159, c_birth_year#163, ca_country#167, d_date_sk#168]
 
 (91) ReusedExchange [Reuses operator id: 36]
-Output [2]: [i_item_sk#26, i_item_id#27]
+Output [2]: [i_item_sk#169, i_item_id#170]
 
 (92) BroadcastHashJoin [codegen id : 23]
-Left keys [1]: [cs_item_sk#3]
-Right keys [1]: [i_item_sk#26]
+Left keys [1]: [cs_item_sk#151]
+Right keys [1]: [i_item_sk#169]
 Join type: Inner
 Join condition: None
 
 (93) Project [codegen id : 23]
-Output [9]: [i_item_id#27, ca_country#24, cast(cs_quantity#4 as decimal(12,2)) AS agg1#28, cast(cs_list_price#5 as decimal(12,2)) AS agg2#29, cast(cs_coupon_amt#7 as decimal(12,2)) AS agg3#30, cast(cs_sales_price#6 as decimal(12,2)) AS agg4#31, cast(cs_net_profit#8 as decimal(12,2)) AS agg5#32, cast(c_birth_year#19 as decimal(12,2)) AS agg6#33, cast(cd_dep_count#14 as decimal(12,2)) AS agg7#34]
-Input [11]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, c_birth_year#19, ca_country#24, i_item_sk#26, i_item_id#27]
+Output [9]: [i_item_id#170, ca_country#167, cast(cs_quantity#152 as decimal(12,2)) AS agg1#171, cast(cs_list_price#153 as decimal(12,2)) AS agg2#172, cast(cs_coupon_amt#155 as decimal(12,2)) AS agg3#173, cast(cs_sales_price#154 as decimal(12,2)) AS agg4#174, cast(cs_net_profit#156 as decimal(12,2)) AS agg5#175, cast(c_birth_year#163 as decimal(12,2)) AS agg6#176, cast(cd_dep_count#159 as decimal(12,2)) AS agg7#177]
+Input [11]: [cs_item_sk#151, cs_quantity#152, cs_list_price#153, cs_sales_price#154, cs_coupon_amt#155, cs_net_profit#156, cd_dep_count#159, c_birth_year#163, ca_country#167, i_item_sk#169, i_item_id#170]
 
 (94) HashAggregate [codegen id : 23]
-Input [9]: [i_item_id#27, ca_country#24, agg1#28, agg2#29, agg3#30, agg4#31, agg5#32, agg6#33, agg7#34]
-Keys [2]: [i_item_id#27, ca_country#24]
-Functions [7]: [partial_avg(agg1#28), partial_avg(agg2#29), partial_avg(agg3#30), partial_avg(agg4#31), partial_avg(agg5#32), partial_avg(agg6#33), partial_avg(agg7#34)]
-Aggregate Attributes [14]: [sum#120, count#121, sum#122, count#123, sum#124, count#125, sum#126, count#127, sum#128, count#129, sum#130, count#131, sum#132, count#133]
-Results [16]: [i_item_id#27, ca_country#24, sum#134, count#135, sum#136, count#137, sum#138, count#139, sum#140, count#141, sum#142, count#143, sum#144, count#145, sum#146, count#147]
+Input [9]: [i_item_id#170, ca_country#167, agg1#171, agg2#172, agg3#173, agg4#174, agg5#175, agg6#176, agg7#177]
+Keys [2]: [i_item_id#170, ca_country#167]
+Functions [7]: [partial_avg(agg1#171), partial_avg(agg2#172), partial_avg(agg3#173), partial_avg(agg4#174), partial_avg(agg5#175), partial_avg(agg6#176), partial_avg(agg7#177)]
+Aggregate Attributes [14]: [sum#178, count#179, sum#180, count#181, sum#182, count#183, sum#184, count#185, sum#186, count#187, sum#188, count#189, sum#190, count#191]
+Results [16]: [i_item_id#170, ca_country#167, sum#192, count#193, sum#194, count#195, sum#196, count#197, sum#198, count#199, sum#200, count#201, sum#202, count#203, sum#204, count#205]
 
 (95) Exchange
-Input [16]: [i_item_id#27, ca_country#24, sum#134, count#135, sum#136, count#137, sum#138, count#139, sum#140, count#141, sum#142, count#143, sum#144, count#145, sum#146, count#147]
-Arguments: hashpartitioning(i_item_id#27, ca_country#24, 5), ENSURE_REQUIREMENTS, [plan_id=10]
+Input [16]: [i_item_id#170, ca_country#167, sum#192, count#193, sum#194, count#195, sum#196, count#197, sum#198, count#199, sum#200, count#201, sum#202, count#203, sum#204, count#205]
+Arguments: hashpartitioning(i_item_id#170, ca_country#167, 5), ENSURE_REQUIREMENTS, [plan_id=10]
 
 (96) HashAggregate [codegen id : 24]
-Input [16]: [i_item_id#27, ca_country#24, sum#134, count#135, sum#136, count#137, sum#138, count#139, sum#140, count#141, sum#142, count#143, sum#144, count#145, sum#146, count#147]
-Keys [2]: [i_item_id#27, ca_country#24]
-Functions [7]: [avg(agg1#28), avg(agg2#29), avg(agg3#30), avg(agg4#31), avg(agg5#32), avg(agg6#33), avg(agg7#34)]
-Aggregate Attributes [7]: [avg(agg1#28)#148, avg(agg2#29)#149, avg(agg3#30)#150, avg(agg4#31)#151, avg(agg5#32)#152, avg(agg6#33)#153, avg(agg7#34)#154]
-Results [11]: [i_item_id#27, ca_country#24, null AS ca_state#155, null AS county#156, avg(agg1#28)#148 AS agg1#157, avg(agg2#29)#149 AS agg2#158, avg(agg3#30)#150 AS agg3#159, avg(agg4#31)#151 AS agg4#160, avg(agg5#32)#152 AS agg5#161, avg(agg6#33)#153 AS agg6#162, avg(agg7#34)#154 AS agg7#163]
+Input [16]: [i_item_id#170, ca_country#167, sum#192, count#193, sum#194, count#195, sum#196, count#197, sum#198, count#199, sum#200, count#201, sum#202, count#203, sum#204, count#205]
+Keys [2]: [i_item_id#170, ca_country#167]
+Functions [7]: [avg(agg1#171), avg(agg2#172), avg(agg3#173), avg(agg4#174), avg(agg5#175), avg(agg6#176), avg(agg7#177)]
+Aggregate Attributes [7]: [avg(agg1#171)#206, avg(agg2#172)#207, avg(agg3#173)#208, avg(agg4#174)#209, avg(agg5#175)#210, avg(agg6#176)#211, avg(agg7#177)#212]
+Results [11]: [i_item_id#170, ca_country#167, null AS ca_state#213, null AS county#214, avg(agg1#171)#206 AS agg1#215, avg(agg2#172)#207 AS agg2#216, avg(agg3#173)#208 AS agg3#217, avg(agg4#174)#209 AS agg4#218, avg(agg5#175)#210 AS agg5#219, avg(agg6#176)#211 AS agg6#220, avg(agg7#177)#212 AS agg7#221]
 
 (97) Scan parquet spark_catalog.default.catalog_sales
-Output [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
+Output [9]: [cs_bill_customer_sk#222, cs_bill_cdemo_sk#223, cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cs_sold_date_sk#230]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#9), dynamicpruningexpression(cs_sold_date_sk#9 IN dynamicpruning#10)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#230), dynamicpruningexpression(cs_sold_date_sk#230 IN dynamicpruning#10)]
 PushedFilters: [IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_customer_sk), IsNotNull(cs_item_sk)]
 ReadSchema: struct<cs_bill_customer_sk:int,cs_bill_cdemo_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2),cs_sales_price:decimal(7,2),cs_coupon_amt:decimal(7,2),cs_net_profit:decimal(7,2)>
 
 (98) ColumnarToRow [codegen id : 31]
-Input [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
+Input [9]: [cs_bill_customer_sk#222, cs_bill_cdemo_sk#223, cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cs_sold_date_sk#230]
 
 (99) Filter [codegen id : 31]
-Input [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
-Condition : ((isnotnull(cs_bill_cdemo_sk#2) AND isnotnull(cs_bill_customer_sk#1)) AND isnotnull(cs_item_sk#3))
+Input [9]: [cs_bill_customer_sk#222, cs_bill_cdemo_sk#223, cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cs_sold_date_sk#230]
+Condition : ((isnotnull(cs_bill_cdemo_sk#223) AND isnotnull(cs_bill_customer_sk#222)) AND isnotnull(cs_item_sk#224))
 
 (100) ReusedExchange [Reuses operator id: 8]
-Output [2]: [cd_demo_sk#11, cd_dep_count#14]
+Output [2]: [cd_demo_sk#231, cd_dep_count#232]
 
 (101) BroadcastHashJoin [codegen id : 31]
-Left keys [1]: [cs_bill_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#11]
+Left keys [1]: [cs_bill_cdemo_sk#223]
+Right keys [1]: [cd_demo_sk#231]
 Join type: Inner
 Join condition: None
 
 (102) Project [codegen id : 31]
-Output [9]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14]
-Input [11]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_demo_sk#11, cd_dep_count#14]
+Output [9]: [cs_bill_customer_sk#222, cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cs_sold_date_sk#230, cd_dep_count#232]
+Input [11]: [cs_bill_customer_sk#222, cs_bill_cdemo_sk#223, cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cs_sold_date_sk#230, cd_demo_sk#231, cd_dep_count#232]
 
 (103) ReusedExchange [Reuses operator id: 15]
-Output [4]: [c_customer_sk#15, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19]
+Output [4]: [c_customer_sk#233, c_current_cdemo_sk#234, c_current_addr_sk#235, c_birth_year#236]
 
 (104) BroadcastHashJoin [codegen id : 31]
-Left keys [1]: [cs_bill_customer_sk#1]
-Right keys [1]: [c_customer_sk#15]
+Left keys [1]: [cs_bill_customer_sk#222]
+Right keys [1]: [c_customer_sk#233]
 Join type: Inner
 Join condition: None
 
 (105) Project [codegen id : 31]
-Output [11]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19]
-Input [13]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_customer_sk#15, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19]
+Output [11]: [cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cs_sold_date_sk#230, cd_dep_count#232, c_current_cdemo_sk#234, c_current_addr_sk#235, c_birth_year#236]
+Input [13]: [cs_bill_customer_sk#222, cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cs_sold_date_sk#230, cd_dep_count#232, c_customer_sk#233, c_current_cdemo_sk#234, c_current_addr_sk#235, c_birth_year#236]
 
 (106) ReusedExchange [Reuses operator id: 21]
-Output [1]: [cd_demo_sk#20]
+Output [1]: [cd_demo_sk#237]
 
 (107) BroadcastHashJoin [codegen id : 31]
-Left keys [1]: [c_current_cdemo_sk#16]
-Right keys [1]: [cd_demo_sk#20]
+Left keys [1]: [c_current_cdemo_sk#234]
+Right keys [1]: [cd_demo_sk#237]
 Join type: Inner
 Join condition: None
 
 (108) Project [codegen id : 31]
-Output [10]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_addr_sk#17, c_birth_year#19]
-Input [12]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19, cd_demo_sk#20]
+Output [10]: [cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cs_sold_date_sk#230, cd_dep_count#232, c_current_addr_sk#235, c_birth_year#236]
+Input [12]: [cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cs_sold_date_sk#230, cd_dep_count#232, c_current_cdemo_sk#234, c_current_addr_sk#235, c_birth_year#236, cd_demo_sk#237]
 
 (109) Scan parquet spark_catalog.default.customer_address
-Output [2]: [ca_address_sk#21, ca_state#23]
+Output [2]: [ca_address_sk#238, ca_state#239]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/customer_address]
 PushedFilters: [In(ca_state, [AL,MS,NC,ND,OK,TN,WI]), IsNotNull(ca_address_sk)]
 ReadSchema: struct<ca_address_sk:int,ca_state:string>
 
 (110) ColumnarToRow [codegen id : 28]
-Input [2]: [ca_address_sk#21, ca_state#23]
+Input [2]: [ca_address_sk#238, ca_state#239]
 
 (111) Filter [codegen id : 28]
-Input [2]: [ca_address_sk#21, ca_state#23]
-Condition : (ca_state#23 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#21))
+Input [2]: [ca_address_sk#238, ca_state#239]
+Condition : (ca_state#239 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#238))
 
 (112) Project [codegen id : 28]
-Output [1]: [ca_address_sk#21]
-Input [2]: [ca_address_sk#21, ca_state#23]
+Output [1]: [ca_address_sk#238]
+Input [2]: [ca_address_sk#238, ca_state#239]
 
 (113) BroadcastExchange
-Input [1]: [ca_address_sk#21]
+Input [1]: [ca_address_sk#238]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=11]
 
 (114) BroadcastHashJoin [codegen id : 31]
-Left keys [1]: [c_current_addr_sk#17]
-Right keys [1]: [ca_address_sk#21]
+Left keys [1]: [c_current_addr_sk#235]
+Right keys [1]: [ca_address_sk#238]
 Join type: Inner
 Join condition: None
 
 (115) Project [codegen id : 31]
-Output [9]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_birth_year#19]
-Input [11]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_addr_sk#17, c_birth_year#19, ca_address_sk#21]
+Output [9]: [cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cs_sold_date_sk#230, cd_dep_count#232, c_birth_year#236]
+Input [11]: [cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cs_sold_date_sk#230, cd_dep_count#232, c_current_addr_sk#235, c_birth_year#236, ca_address_sk#238]
 
 (116) ReusedExchange [Reuses operator id: 158]
-Output [1]: [d_date_sk#25]
+Output [1]: [d_date_sk#240]
 
 (117) BroadcastHashJoin [codegen id : 31]
-Left keys [1]: [cs_sold_date_sk#9]
-Right keys [1]: [d_date_sk#25]
+Left keys [1]: [cs_sold_date_sk#230]
+Right keys [1]: [d_date_sk#240]
 Join type: Inner
 Join condition: None
 
 (118) Project [codegen id : 31]
-Output [8]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, c_birth_year#19]
-Input [10]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_birth_year#19, d_date_sk#25]
+Output [8]: [cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cd_dep_count#232, c_birth_year#236]
+Input [10]: [cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cs_sold_date_sk#230, cd_dep_count#232, c_birth_year#236, d_date_sk#240]
 
 (119) ReusedExchange [Reuses operator id: 36]
-Output [2]: [i_item_sk#26, i_item_id#27]
+Output [2]: [i_item_sk#241, i_item_id#242]
 
 (120) BroadcastHashJoin [codegen id : 31]
-Left keys [1]: [cs_item_sk#3]
-Right keys [1]: [i_item_sk#26]
+Left keys [1]: [cs_item_sk#224]
+Right keys [1]: [i_item_sk#241]
 Join type: Inner
 Join condition: None
 
 (121) Project [codegen id : 31]
-Output [8]: [i_item_id#27, cast(cs_quantity#4 as decimal(12,2)) AS agg1#28, cast(cs_list_price#5 as decimal(12,2)) AS agg2#29, cast(cs_coupon_amt#7 as decimal(12,2)) AS agg3#30, cast(cs_sales_price#6 as decimal(12,2)) AS agg4#31, cast(cs_net_profit#8 as decimal(12,2)) AS agg5#32, cast(c_birth_year#19 as decimal(12,2)) AS agg6#33, cast(cd_dep_count#14 as decimal(12,2)) AS agg7#34]
-Input [10]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, c_birth_year#19, i_item_sk#26, i_item_id#27]
+Output [8]: [i_item_id#242, cast(cs_quantity#225 as decimal(12,2)) AS agg1#243, cast(cs_list_price#226 as decimal(12,2)) AS agg2#244, cast(cs_coupon_amt#228 as decimal(12,2)) AS agg3#245, cast(cs_sales_price#227 as decimal(12,2)) AS agg4#246, cast(cs_net_profit#229 as decimal(12,2)) AS agg5#247, cast(c_birth_year#236 as decimal(12,2)) AS agg6#248, cast(cd_dep_count#232 as decimal(12,2)) AS agg7#249]
+Input [10]: [cs_item_sk#224, cs_quantity#225, cs_list_price#226, cs_sales_price#227, cs_coupon_amt#228, cs_net_profit#229, cd_dep_count#232, c_birth_year#236, i_item_sk#241, i_item_id#242]
 
 (122) HashAggregate [codegen id : 31]
-Input [8]: [i_item_id#27, agg1#28, agg2#29, agg3#30, agg4#31, agg5#32, agg6#33, agg7#34]
-Keys [1]: [i_item_id#27]
-Functions [7]: [partial_avg(agg1#28), partial_avg(agg2#29), partial_avg(agg3#30), partial_avg(agg4#31), partial_avg(agg5#32), partial_avg(agg6#33), partial_avg(agg7#34)]
-Aggregate Attributes [14]: [sum#164, count#165, sum#166, count#167, sum#168, count#169, sum#170, count#171, sum#172, count#173, sum#174, count#175, sum#176, count#177]
-Results [15]: [i_item_id#27, sum#178, count#179, sum#180, count#181, sum#182, count#183, sum#184, count#185, sum#186, count#187, sum#188, count#189, sum#190, count#191]
+Input [8]: [i_item_id#242, agg1#243, agg2#244, agg3#245, agg4#246, agg5#247, agg6#248, agg7#249]
+Keys [1]: [i_item_id#242]
+Functions [7]: [partial_avg(agg1#243), partial_avg(agg2#244), partial_avg(agg3#245), partial_avg(agg4#246), partial_avg(agg5#247), partial_avg(agg6#248), partial_avg(agg7#249)]
+Aggregate Attributes [14]: [sum#250, count#251, sum#252, count#253, sum#254, count#255, sum#256, count#257, sum#258, count#259, sum#260, count#261, sum#262, count#263]
+Results [15]: [i_item_id#242, sum#264, count#265, sum#266, count#267, sum#268, count#269, sum#270, count#271, sum#272, count#273, sum#274, count#275, sum#276, count#277]
 
 (123) Exchange
-Input [15]: [i_item_id#27, sum#178, count#179, sum#180, count#181, sum#182, count#183, sum#184, count#185, sum#186, count#187, sum#188, count#189, sum#190, count#191]
-Arguments: hashpartitioning(i_item_id#27, 5), ENSURE_REQUIREMENTS, [plan_id=12]
+Input [15]: [i_item_id#242, sum#264, count#265, sum#266, count#267, sum#268, count#269, sum#270, count#271, sum#272, count#273, sum#274, count#275, sum#276, count#277]
+Arguments: hashpartitioning(i_item_id#242, 5), ENSURE_REQUIREMENTS, [plan_id=12]
 
 (124) HashAggregate [codegen id : 32]
-Input [15]: [i_item_id#27, sum#178, count#179, sum#180, count#181, sum#182, count#183, sum#184, count#185, sum#186, count#187, sum#188, count#189, sum#190, count#191]
-Keys [1]: [i_item_id#27]
-Functions [7]: [avg(agg1#28), avg(agg2#29), avg(agg3#30), avg(agg4#31), avg(agg5#32), avg(agg6#33), avg(agg7#34)]
-Aggregate Attributes [7]: [avg(agg1#28)#192, avg(agg2#29)#193, avg(agg3#30)#194, avg(agg4#31)#195, avg(agg5#32)#196, avg(agg6#33)#197, avg(agg7#34)#198]
-Results [11]: [i_item_id#27, null AS ca_country#199, null AS ca_state#200, null AS county#201, avg(agg1#28)#192 AS agg1#202, avg(agg2#29)#193 AS agg2#203, avg(agg3#30)#194 AS agg3#204, avg(agg4#31)#195 AS agg4#205, avg(agg5#32)#196 AS agg5#206, avg(agg6#33)#197 AS agg6#207, avg(agg7#34)#198 AS agg7#208]
+Input [15]: [i_item_id#242, sum#264, count#265, sum#266, count#267, sum#268, count#269, sum#270, count#271, sum#272, count#273, sum#274, count#275, sum#276, count#277]
+Keys [1]: [i_item_id#242]
+Functions [7]: [avg(agg1#243), avg(agg2#244), avg(agg3#245), avg(agg4#246), avg(agg5#247), avg(agg6#248), avg(agg7#249)]
+Aggregate Attributes [7]: [avg(agg1#243)#278, avg(agg2#244)#279, avg(agg3#245)#280, avg(agg4#246)#281, avg(agg5#247)#282, avg(agg6#248)#283, avg(agg7#249)#284]
+Results [11]: [i_item_id#242, null AS ca_country#285, null AS ca_state#286, null AS county#287, avg(agg1#243)#278 AS agg1#288, avg(agg2#244)#279 AS agg2#289, avg(agg3#245)#280 AS agg3#290, avg(agg4#246)#281 AS agg4#291, avg(agg5#247)#282 AS agg5#292, avg(agg6#248)#283 AS agg6#293, avg(agg7#249)#284 AS agg7#294]
 
 (125) Scan parquet spark_catalog.default.catalog_sales
-Output [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
+Output [9]: [cs_bill_customer_sk#295, cs_bill_cdemo_sk#296, cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cs_sold_date_sk#303]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#9), dynamicpruningexpression(cs_sold_date_sk#9 IN dynamicpruning#10)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#303), dynamicpruningexpression(cs_sold_date_sk#303 IN dynamicpruning#10)]
 PushedFilters: [IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_customer_sk), IsNotNull(cs_item_sk)]
 ReadSchema: struct<cs_bill_customer_sk:int,cs_bill_cdemo_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2),cs_sales_price:decimal(7,2),cs_coupon_amt:decimal(7,2),cs_net_profit:decimal(7,2)>
 
 (126) ColumnarToRow [codegen id : 39]
-Input [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
+Input [9]: [cs_bill_customer_sk#295, cs_bill_cdemo_sk#296, cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cs_sold_date_sk#303]
 
 (127) Filter [codegen id : 39]
-Input [9]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9]
-Condition : ((isnotnull(cs_bill_cdemo_sk#2) AND isnotnull(cs_bill_customer_sk#1)) AND isnotnull(cs_item_sk#3))
+Input [9]: [cs_bill_customer_sk#295, cs_bill_cdemo_sk#296, cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cs_sold_date_sk#303]
+Condition : ((isnotnull(cs_bill_cdemo_sk#296) AND isnotnull(cs_bill_customer_sk#295)) AND isnotnull(cs_item_sk#297))
 
 (128) ReusedExchange [Reuses operator id: 8]
-Output [2]: [cd_demo_sk#11, cd_dep_count#14]
+Output [2]: [cd_demo_sk#304, cd_dep_count#305]
 
 (129) BroadcastHashJoin [codegen id : 39]
-Left keys [1]: [cs_bill_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#11]
+Left keys [1]: [cs_bill_cdemo_sk#296]
+Right keys [1]: [cd_demo_sk#304]
 Join type: Inner
 Join condition: None
 
 (130) Project [codegen id : 39]
-Output [9]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14]
-Input [11]: [cs_bill_customer_sk#1, cs_bill_cdemo_sk#2, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_demo_sk#11, cd_dep_count#14]
+Output [9]: [cs_bill_customer_sk#295, cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cs_sold_date_sk#303, cd_dep_count#305]
+Input [11]: [cs_bill_customer_sk#295, cs_bill_cdemo_sk#296, cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cs_sold_date_sk#303, cd_demo_sk#304, cd_dep_count#305]
 
 (131) ReusedExchange [Reuses operator id: 15]
-Output [4]: [c_customer_sk#15, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19]
+Output [4]: [c_customer_sk#306, c_current_cdemo_sk#307, c_current_addr_sk#308, c_birth_year#309]
 
 (132) BroadcastHashJoin [codegen id : 39]
-Left keys [1]: [cs_bill_customer_sk#1]
-Right keys [1]: [c_customer_sk#15]
+Left keys [1]: [cs_bill_customer_sk#295]
+Right keys [1]: [c_customer_sk#306]
 Join type: Inner
 Join condition: None
 
 (133) Project [codegen id : 39]
-Output [11]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19]
-Input [13]: [cs_bill_customer_sk#1, cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_customer_sk#15, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19]
+Output [11]: [cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cs_sold_date_sk#303, cd_dep_count#305, c_current_cdemo_sk#307, c_current_addr_sk#308, c_birth_year#309]
+Input [13]: [cs_bill_customer_sk#295, cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cs_sold_date_sk#303, cd_dep_count#305, c_customer_sk#306, c_current_cdemo_sk#307, c_current_addr_sk#308, c_birth_year#309]
 
 (134) ReusedExchange [Reuses operator id: 21]
-Output [1]: [cd_demo_sk#20]
+Output [1]: [cd_demo_sk#310]
 
 (135) BroadcastHashJoin [codegen id : 39]
-Left keys [1]: [c_current_cdemo_sk#16]
-Right keys [1]: [cd_demo_sk#20]
+Left keys [1]: [c_current_cdemo_sk#307]
+Right keys [1]: [cd_demo_sk#310]
 Join type: Inner
 Join condition: None
 
 (136) Project [codegen id : 39]
-Output [10]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_addr_sk#17, c_birth_year#19]
-Input [12]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_cdemo_sk#16, c_current_addr_sk#17, c_birth_year#19, cd_demo_sk#20]
+Output [10]: [cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cs_sold_date_sk#303, cd_dep_count#305, c_current_addr_sk#308, c_birth_year#309]
+Input [12]: [cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cs_sold_date_sk#303, cd_dep_count#305, c_current_cdemo_sk#307, c_current_addr_sk#308, c_birth_year#309, cd_demo_sk#310]
 
 (137) ReusedExchange [Reuses operator id: 113]
-Output [1]: [ca_address_sk#21]
+Output [1]: [ca_address_sk#311]
 
 (138) BroadcastHashJoin [codegen id : 39]
-Left keys [1]: [c_current_addr_sk#17]
-Right keys [1]: [ca_address_sk#21]
+Left keys [1]: [c_current_addr_sk#308]
+Right keys [1]: [ca_address_sk#311]
 Join type: Inner
 Join condition: None
 
 (139) Project [codegen id : 39]
-Output [9]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_birth_year#19]
-Input [11]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_current_addr_sk#17, c_birth_year#19, ca_address_sk#21]
+Output [9]: [cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cs_sold_date_sk#303, cd_dep_count#305, c_birth_year#309]
+Input [11]: [cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cs_sold_date_sk#303, cd_dep_count#305, c_current_addr_sk#308, c_birth_year#309, ca_address_sk#311]
 
 (140) ReusedExchange [Reuses operator id: 158]
-Output [1]: [d_date_sk#25]
+Output [1]: [d_date_sk#312]
 
 (141) BroadcastHashJoin [codegen id : 39]
-Left keys [1]: [cs_sold_date_sk#9]
-Right keys [1]: [d_date_sk#25]
+Left keys [1]: [cs_sold_date_sk#303]
+Right keys [1]: [d_date_sk#312]
 Join type: Inner
 Join condition: None
 
 (142) Project [codegen id : 39]
-Output [8]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, c_birth_year#19]
-Input [10]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cs_sold_date_sk#9, cd_dep_count#14, c_birth_year#19, d_date_sk#25]
+Output [8]: [cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cd_dep_count#305, c_birth_year#309]
+Input [10]: [cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cs_sold_date_sk#303, cd_dep_count#305, c_birth_year#309, d_date_sk#312]
 
 (143) Scan parquet spark_catalog.default.item
-Output [1]: [i_item_sk#26]
+Output [1]: [i_item_sk#313]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/item]
 PushedFilters: [IsNotNull(i_item_sk)]
 ReadSchema: struct<i_item_sk:int>
 
 (144) ColumnarToRow [codegen id : 38]
-Input [1]: [i_item_sk#26]
+Input [1]: [i_item_sk#313]
 
 (145) Filter [codegen id : 38]
-Input [1]: [i_item_sk#26]
-Condition : isnotnull(i_item_sk#26)
+Input [1]: [i_item_sk#313]
+Condition : isnotnull(i_item_sk#313)
 
 (146) BroadcastExchange
-Input [1]: [i_item_sk#26]
+Input [1]: [i_item_sk#313]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=13]
 
 (147) BroadcastHashJoin [codegen id : 39]
-Left keys [1]: [cs_item_sk#3]
-Right keys [1]: [i_item_sk#26]
+Left keys [1]: [cs_item_sk#297]
+Right keys [1]: [i_item_sk#313]
 Join type: Inner
 Join condition: None
 
 (148) Project [codegen id : 39]
-Output [7]: [cast(cs_quantity#4 as decimal(12,2)) AS agg1#28, cast(cs_list_price#5 as decimal(12,2)) AS agg2#29, cast(cs_coupon_amt#7 as decimal(12,2)) AS agg3#30, cast(cs_sales_price#6 as decimal(12,2)) AS agg4#31, cast(cs_net_profit#8 as decimal(12,2)) AS agg5#32, cast(c_birth_year#19 as decimal(12,2)) AS agg6#33, cast(cd_dep_count#14 as decimal(12,2)) AS agg7#34]
-Input [9]: [cs_item_sk#3, cs_quantity#4, cs_list_price#5, cs_sales_price#6, cs_coupon_amt#7, cs_net_profit#8, cd_dep_count#14, c_birth_year#19, i_item_sk#26]
+Output [7]: [cast(cs_quantity#298 as decimal(12,2)) AS agg1#314, cast(cs_list_price#299 as decimal(12,2)) AS agg2#315, cast(cs_coupon_amt#301 as decimal(12,2)) AS agg3#316, cast(cs_sales_price#300 as decimal(12,2)) AS agg4#317, cast(cs_net_profit#302 as decimal(12,2)) AS agg5#318, cast(c_birth_year#309 as decimal(12,2)) AS agg6#319, cast(cd_dep_count#305 as decimal(12,2)) AS agg7#320]
+Input [9]: [cs_item_sk#297, cs_quantity#298, cs_list_price#299, cs_sales_price#300, cs_coupon_amt#301, cs_net_profit#302, cd_dep_count#305, c_birth_year#309, i_item_sk#313]
 
 (149) HashAggregate [codegen id : 39]
-Input [7]: [agg1#28, agg2#29, agg3#30, agg4#31, agg5#32, agg6#33, agg7#34]
+Input [7]: [agg1#314, agg2#315, agg3#316, agg4#317, agg5#318, agg6#319, agg7#320]
 Keys: []
-Functions [7]: [partial_avg(agg1#28), partial_avg(agg2#29), partial_avg(agg3#30), partial_avg(agg4#31), partial_avg(agg5#32), partial_avg(agg6#33), partial_avg(agg7#34)]
-Aggregate Attributes [14]: [sum#209, count#210, sum#211, count#212, sum#213, count#214, sum#215, count#216, sum#217, count#218, sum#219, count#220, sum#221, count#222]
-Results [14]: [sum#223, count#224, sum#225, count#226, sum#227, count#228, sum#229, count#230, sum#231, count#232, sum#233, count#234, sum#235, count#236]
+Functions [7]: [partial_avg(agg1#314), partial_avg(agg2#315), partial_avg(agg3#316), partial_avg(agg4#317), partial_avg(agg5#318), partial_avg(agg6#319), partial_avg(agg7#320)]
+Aggregate Attributes [14]: [sum#321, count#322, sum#323, count#324, sum#325, count#326, sum#327, count#328, sum#329, count#330, sum#331, count#332, sum#333, count#334]
+Results [14]: [sum#335, count#336, sum#337, count#338, sum#339, count#340, sum#341, count#342, sum#343, count#344, sum#345, count#346, sum#347, count#348]
 
 (150) Exchange
-Input [14]: [sum#223, count#224, sum#225, count#226, sum#227, count#228, sum#229, count#230, sum#231, count#232, sum#233, count#234, sum#235, count#236]
+Input [14]: [sum#335, count#336, sum#337, count#338, sum#339, count#340, sum#341, count#342, sum#343, count#344, sum#345, count#346, sum#347, count#348]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=14]
 
 (151) HashAggregate [codegen id : 40]
-Input [14]: [sum#223, count#224, sum#225, count#226, sum#227, count#228, sum#229, count#230, sum#231, count#232, sum#233, count#234, sum#235, count#236]
+Input [14]: [sum#335, count#336, sum#337, count#338, sum#339, count#340, sum#341, count#342, sum#343, count#344, sum#345, count#346, sum#347, count#348]
 Keys: []
-Functions [7]: [avg(agg1#28), avg(agg2#29), avg(agg3#30), avg(agg4#31), avg(agg5#32), avg(agg6#33), avg(agg7#34)]
-Aggregate Attributes [7]: [avg(agg1#28)#237, avg(agg2#29)#238, avg(agg3#30)#239, avg(agg4#31)#240, avg(agg5#32)#241, avg(agg6#33)#242, avg(agg7#34)#243]
-Results [11]: [null AS i_item_id#244, null AS ca_country#245, null AS ca_state#246, null AS county#247, avg(agg1#28)#237 AS agg1#248, avg(agg2#29)#238 AS agg2#249, avg(agg3#30)#239 AS agg3#250, avg(agg4#31)#240 AS agg4#251, avg(agg5#32)#241 AS agg5#252, avg(agg6#33)#242 AS agg6#253, avg(agg7#34)#243 AS agg7#254]
+Functions [7]: [avg(agg1#314), avg(agg2#315), avg(agg3#316), avg(agg4#317), avg(agg5#318), avg(agg6#319), avg(agg7#320)]
+Aggregate Attributes [7]: [avg(agg1#314)#349, avg(agg2#315)#350, avg(agg3#316)#351, avg(agg4#317)#352, avg(agg5#318)#353, avg(agg6#319)#354, avg(agg7#320)#355]
+Results [11]: [null AS i_item_id#356, null AS ca_country#357, null AS ca_state#358, null AS county#359, avg(agg1#314)#349 AS agg1#360, avg(agg2#315)#350 AS agg2#361, avg(agg3#316)#351 AS agg3#362, avg(agg4#317)#352 AS agg4#363, avg(agg5#318)#353 AS agg5#364, avg(agg6#319)#354 AS agg6#365, avg(agg7#320)#355 AS agg7#366]
 
 (152) Union
 
@@ -877,33 +877,33 @@ BroadcastExchange (158)
 
 
 (154) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#25, d_year#255]
+Output [2]: [d_date_sk#25, d_year#367]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (155) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#25, d_year#255]
+Input [2]: [d_date_sk#25, d_year#367]
 
 (156) Filter [codegen id : 1]
-Input [2]: [d_date_sk#25, d_year#255]
-Condition : ((isnotnull(d_year#255) AND (d_year#255 = 2001)) AND isnotnull(d_date_sk#25))
+Input [2]: [d_date_sk#25, d_year#367]
+Condition : ((isnotnull(d_year#367) AND (d_year#367 = 2001)) AND isnotnull(d_date_sk#25))
 
 (157) Project [codegen id : 1]
 Output [1]: [d_date_sk#25]
-Input [2]: [d_date_sk#25, d_year#255]
+Input [2]: [d_date_sk#25, d_year#367]
 
 (158) BroadcastExchange
 Input [1]: [d_date_sk#25]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=15]
 
-Subquery:2 Hosting operator id = 42 Hosting Expression = cs_sold_date_sk#9 IN dynamicpruning#10
+Subquery:2 Hosting operator id = 42 Hosting Expression = cs_sold_date_sk#85 IN dynamicpruning#10
 
-Subquery:3 Hosting operator id = 69 Hosting Expression = cs_sold_date_sk#9 IN dynamicpruning#10
+Subquery:3 Hosting operator id = 69 Hosting Expression = cs_sold_date_sk#157 IN dynamicpruning#10
 
-Subquery:4 Hosting operator id = 97 Hosting Expression = cs_sold_date_sk#9 IN dynamicpruning#10
+Subquery:4 Hosting operator id = 97 Hosting Expression = cs_sold_date_sk#230 IN dynamicpruning#10
 
-Subquery:5 Hosting operator id = 125 Hosting Expression = cs_sold_date_sk#9 IN dynamicpruning#10
+Subquery:5 Hosting operator id = 125 Hosting Expression = cs_sold_date_sk#303 IN dynamicpruning#10
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q22a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q22a.sf100/explain.txt
index 22090d6e362..96bed479d2e 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q22a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q22a.sf100/explain.txt
@@ -178,116 +178,116 @@ Aggregate Attributes [1]: [avg(qoh#18)#23]
 Results [5]: [i_product_name#12, i_brand#9, i_class#10, i_category#11, avg(qoh#18)#23 AS qoh#24]
 
 (27) ReusedExchange [Reuses operator id: 23]
-Output [6]: [i_product_name#12, i_brand#9, i_class#10, i_category#11, sum#15, count#16]
+Output [6]: [i_product_name#25, i_brand#26, i_class#27, i_category#28, sum#29, count#30]
 
 (28) HashAggregate [codegen id : 16]
-Input [6]: [i_product_name#12, i_brand#9, i_class#10, i_category#11, sum#15, count#16]
-Keys [4]: [i_product_name#12, i_brand#9, i_class#10, i_category#11]
-Functions [1]: [avg(inv_quantity_on_hand#3)]
-Aggregate Attributes [1]: [avg(inv_quantity_on_hand#3)#17]
-Results [4]: [i_product_name#12, i_brand#9, i_class#10, avg(inv_quantity_on_hand#3)#17 AS qoh#18]
+Input [6]: [i_product_name#25, i_brand#26, i_class#27, i_category#28, sum#29, count#30]
+Keys [4]: [i_product_name#25, i_brand#26, i_class#27, i_category#28]
+Functions [1]: [avg(inv_quantity_on_hand#31)]
+Aggregate Attributes [1]: [avg(inv_quantity_on_hand#31)#17]
+Results [4]: [i_product_name#25, i_brand#26, i_class#27, avg(inv_quantity_on_hand#31)#17 AS qoh#32]
 
 (29) HashAggregate [codegen id : 16]
-Input [4]: [i_product_name#12, i_brand#9, i_class#10, qoh#18]
-Keys [3]: [i_product_name#12, i_brand#9, i_class#10]
-Functions [1]: [partial_avg(qoh#18)]
-Aggregate Attributes [2]: [sum#25, count#26]
-Results [5]: [i_product_name#12, i_brand#9, i_class#10, sum#27, count#28]
+Input [4]: [i_product_name#25, i_brand#26, i_class#27, qoh#32]
+Keys [3]: [i_product_name#25, i_brand#26, i_class#27]
+Functions [1]: [partial_avg(qoh#32)]
+Aggregate Attributes [2]: [sum#33, count#34]
+Results [5]: [i_product_name#25, i_brand#26, i_class#27, sum#35, count#36]
 
 (30) Exchange
-Input [5]: [i_product_name#12, i_brand#9, i_class#10, sum#27, count#28]
-Arguments: hashpartitioning(i_product_name#12, i_brand#9, i_class#10, 5), ENSURE_REQUIREMENTS, [plan_id=5]
+Input [5]: [i_product_name#25, i_brand#26, i_class#27, sum#35, count#36]
+Arguments: hashpartitioning(i_product_name#25, i_brand#26, i_class#27, 5), ENSURE_REQUIREMENTS, [plan_id=5]
 
 (31) HashAggregate [codegen id : 17]
-Input [5]: [i_product_name#12, i_brand#9, i_class#10, sum#27, count#28]
-Keys [3]: [i_product_name#12, i_brand#9, i_class#10]
-Functions [1]: [avg(qoh#18)]
-Aggregate Attributes [1]: [avg(qoh#18)#29]
-Results [5]: [i_product_name#12, i_brand#9, i_class#10, null AS i_category#30, avg(qoh#18)#29 AS qoh#31]
+Input [5]: [i_product_name#25, i_brand#26, i_class#27, sum#35, count#36]
+Keys [3]: [i_product_name#25, i_brand#26, i_class#27]
+Functions [1]: [avg(qoh#32)]
+Aggregate Attributes [1]: [avg(qoh#32)#37]
+Results [5]: [i_product_name#25, i_brand#26, i_class#27, null AS i_category#38, avg(qoh#32)#37 AS qoh#39]
 
 (32) ReusedExchange [Reuses operator id: 23]
-Output [6]: [i_product_name#12, i_brand#9, i_class#10, i_category#11, sum#15, count#16]
+Output [6]: [i_product_name#40, i_brand#41, i_class#42, i_category#43, sum#44, count#45]
 
 (33) HashAggregate [codegen id : 25]
-Input [6]: [i_product_name#12, i_brand#9, i_class#10, i_category#11, sum#15, count#16]
-Keys [4]: [i_product_name#12, i_brand#9, i_class#10, i_category#11]
-Functions [1]: [avg(inv_quantity_on_hand#3)]
-Aggregate Attributes [1]: [avg(inv_quantity_on_hand#3)#17]
-Results [3]: [i_product_name#12, i_brand#9, avg(inv_quantity_on_hand#3)#17 AS qoh#18]
+Input [6]: [i_product_name#40, i_brand#41, i_class#42, i_category#43, sum#44, count#45]
+Keys [4]: [i_product_name#40, i_brand#41, i_class#42, i_category#43]
+Functions [1]: [avg(inv_quantity_on_hand#46)]
+Aggregate Attributes [1]: [avg(inv_quantity_on_hand#46)#17]
+Results [3]: [i_product_name#40, i_brand#41, avg(inv_quantity_on_hand#46)#17 AS qoh#47]
 
 (34) HashAggregate [codegen id : 25]
-Input [3]: [i_product_name#12, i_brand#9, qoh#18]
-Keys [2]: [i_product_name#12, i_brand#9]
-Functions [1]: [partial_avg(qoh#18)]
-Aggregate Attributes [2]: [sum#32, count#33]
-Results [4]: [i_product_name#12, i_brand#9, sum#34, count#35]
+Input [3]: [i_product_name#40, i_brand#41, qoh#47]
+Keys [2]: [i_product_name#40, i_brand#41]
+Functions [1]: [partial_avg(qoh#47)]
+Aggregate Attributes [2]: [sum#48, count#49]
+Results [4]: [i_product_name#40, i_brand#41, sum#50, count#51]
 
 (35) Exchange
-Input [4]: [i_product_name#12, i_brand#9, sum#34, count#35]
-Arguments: hashpartitioning(i_product_name#12, i_brand#9, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [4]: [i_product_name#40, i_brand#41, sum#50, count#51]
+Arguments: hashpartitioning(i_product_name#40, i_brand#41, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (36) HashAggregate [codegen id : 26]
-Input [4]: [i_product_name#12, i_brand#9, sum#34, count#35]
-Keys [2]: [i_product_name#12, i_brand#9]
-Functions [1]: [avg(qoh#18)]
-Aggregate Attributes [1]: [avg(qoh#18)#36]
-Results [5]: [i_product_name#12, i_brand#9, null AS i_class#37, null AS i_category#38, avg(qoh#18)#36 AS qoh#39]
+Input [4]: [i_product_name#40, i_brand#41, sum#50, count#51]
+Keys [2]: [i_product_name#40, i_brand#41]
+Functions [1]: [avg(qoh#47)]
+Aggregate Attributes [1]: [avg(qoh#47)#52]
+Results [5]: [i_product_name#40, i_brand#41, null AS i_class#53, null AS i_category#54, avg(qoh#47)#52 AS qoh#55]
 
 (37) ReusedExchange [Reuses operator id: 23]
-Output [6]: [i_product_name#12, i_brand#9, i_class#10, i_category#11, sum#15, count#16]
+Output [6]: [i_product_name#56, i_brand#57, i_class#58, i_category#59, sum#60, count#61]
 
 (38) HashAggregate [codegen id : 34]
-Input [6]: [i_product_name#12, i_brand#9, i_class#10, i_category#11, sum#15, count#16]
-Keys [4]: [i_product_name#12, i_brand#9, i_class#10, i_category#11]
-Functions [1]: [avg(inv_quantity_on_hand#3)]
-Aggregate Attributes [1]: [avg(inv_quantity_on_hand#3)#17]
-Results [2]: [i_product_name#12, avg(inv_quantity_on_hand#3)#17 AS qoh#18]
+Input [6]: [i_product_name#56, i_brand#57, i_class#58, i_category#59, sum#60, count#61]
+Keys [4]: [i_product_name#56, i_brand#57, i_class#58, i_category#59]
+Functions [1]: [avg(inv_quantity_on_hand#62)]
+Aggregate Attributes [1]: [avg(inv_quantity_on_hand#62)#17]
+Results [2]: [i_product_name#56, avg(inv_quantity_on_hand#62)#17 AS qoh#63]
 
 (39) HashAggregate [codegen id : 34]
-Input [2]: [i_product_name#12, qoh#18]
-Keys [1]: [i_product_name#12]
-Functions [1]: [partial_avg(qoh#18)]
-Aggregate Attributes [2]: [sum#40, count#41]
-Results [3]: [i_product_name#12, sum#42, count#43]
+Input [2]: [i_product_name#56, qoh#63]
+Keys [1]: [i_product_name#56]
+Functions [1]: [partial_avg(qoh#63)]
+Aggregate Attributes [2]: [sum#64, count#65]
+Results [3]: [i_product_name#56, sum#66, count#67]
 
 (40) Exchange
-Input [3]: [i_product_name#12, sum#42, count#43]
-Arguments: hashpartitioning(i_product_name#12, 5), ENSURE_REQUIREMENTS, [plan_id=7]
+Input [3]: [i_product_name#56, sum#66, count#67]
+Arguments: hashpartitioning(i_product_name#56, 5), ENSURE_REQUIREMENTS, [plan_id=7]
 
 (41) HashAggregate [codegen id : 35]
-Input [3]: [i_product_name#12, sum#42, count#43]
-Keys [1]: [i_product_name#12]
-Functions [1]: [avg(qoh#18)]
-Aggregate Attributes [1]: [avg(qoh#18)#44]
-Results [5]: [i_product_name#12, null AS i_brand#45, null AS i_class#46, null AS i_category#47, avg(qoh#18)#44 AS qoh#48]
+Input [3]: [i_product_name#56, sum#66, count#67]
+Keys [1]: [i_product_name#56]
+Functions [1]: [avg(qoh#63)]
+Aggregate Attributes [1]: [avg(qoh#63)#68]
+Results [5]: [i_product_name#56, null AS i_brand#69, null AS i_class#70, null AS i_category#71, avg(qoh#63)#68 AS qoh#72]
 
 (42) ReusedExchange [Reuses operator id: 23]
-Output [6]: [i_product_name#12, i_brand#9, i_class#10, i_category#11, sum#15, count#16]
+Output [6]: [i_product_name#73, i_brand#74, i_class#75, i_category#76, sum#77, count#78]
 
 (43) HashAggregate [codegen id : 43]
-Input [6]: [i_product_name#12, i_brand#9, i_class#10, i_category#11, sum#15, count#16]
-Keys [4]: [i_product_name#12, i_brand#9, i_class#10, i_category#11]
-Functions [1]: [avg(inv_quantity_on_hand#3)]
-Aggregate Attributes [1]: [avg(inv_quantity_on_hand#3)#17]
-Results [1]: [avg(inv_quantity_on_hand#3)#17 AS qoh#18]
+Input [6]: [i_product_name#73, i_brand#74, i_class#75, i_category#76, sum#77, count#78]
+Keys [4]: [i_product_name#73, i_brand#74, i_class#75, i_category#76]
+Functions [1]: [avg(inv_quantity_on_hand#79)]
+Aggregate Attributes [1]: [avg(inv_quantity_on_hand#79)#17]
+Results [1]: [avg(inv_quantity_on_hand#79)#17 AS qoh#80]
 
 (44) HashAggregate [codegen id : 43]
-Input [1]: [qoh#18]
+Input [1]: [qoh#80]
 Keys: []
-Functions [1]: [partial_avg(qoh#18)]
-Aggregate Attributes [2]: [sum#49, count#50]
-Results [2]: [sum#51, count#52]
+Functions [1]: [partial_avg(qoh#80)]
+Aggregate Attributes [2]: [sum#81, count#82]
+Results [2]: [sum#83, count#84]
 
 (45) Exchange
-Input [2]: [sum#51, count#52]
+Input [2]: [sum#83, count#84]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=8]
 
 (46) HashAggregate [codegen id : 44]
-Input [2]: [sum#51, count#52]
+Input [2]: [sum#83, count#84]
 Keys: []
-Functions [1]: [avg(qoh#18)]
-Aggregate Attributes [1]: [avg(qoh#18)#53]
-Results [5]: [null AS i_product_name#54, null AS i_brand#55, null AS i_class#56, null AS i_category#57, avg(qoh#18)#53 AS qoh#58]
+Functions [1]: [avg(qoh#80)]
+Aggregate Attributes [1]: [avg(qoh#80)#85]
+Results [5]: [null AS i_product_name#86, null AS i_brand#87, null AS i_class#88, null AS i_category#89, avg(qoh#80)#85 AS qoh#90]
 
 (47) Union
 
@@ -306,22 +306,22 @@ BroadcastExchange (53)
 
 
 (49) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#7, d_month_seq#59]
+Output [2]: [d_date_sk#7, d_month_seq#91]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1212), LessThanOrEqual(d_month_seq,1223), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_month_seq:int>
 
 (50) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#7, d_month_seq#59]
+Input [2]: [d_date_sk#7, d_month_seq#91]
 
 (51) Filter [codegen id : 1]
-Input [2]: [d_date_sk#7, d_month_seq#59]
-Condition : (((isnotnull(d_month_seq#59) AND (d_month_seq#59 >= 1212)) AND (d_month_seq#59 <= 1223)) AND isnotnull(d_date_sk#7))
+Input [2]: [d_date_sk#7, d_month_seq#91]
+Condition : (((isnotnull(d_month_seq#91) AND (d_month_seq#91 >= 1212)) AND (d_month_seq#91 <= 1223)) AND isnotnull(d_date_sk#7))
 
 (52) Project [codegen id : 1]
 Output [1]: [d_date_sk#7]
-Input [2]: [d_date_sk#7, d_month_seq#59]
+Input [2]: [d_date_sk#7, d_month_seq#91]
 
 (53) BroadcastExchange
 Input [1]: [d_date_sk#7]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q22a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q22a/explain.txt
index 448e89825f7..4b8993f370f 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q22a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q22a/explain.txt
@@ -163,116 +163,116 @@ Aggregate Attributes [1]: [avg(qoh#18)#23]
 Results [5]: [i_product_name#11, i_brand#8, i_class#9, i_category#10, avg(qoh#18)#23 AS qoh#24]
 
 (24) ReusedExchange [Reuses operator id: 20]
-Output [6]: [i_product_name#11, i_brand#8, i_class#9, i_category#10, sum#15, count#16]
+Output [6]: [i_product_name#25, i_brand#26, i_class#27, i_category#28, sum#29, count#30]
 
 (25) HashAggregate [codegen id : 10]
-Input [6]: [i_product_name#11, i_brand#8, i_class#9, i_category#10, sum#15, count#16]
-Keys [4]: [i_product_name#11, i_brand#8, i_class#9, i_category#10]
-Functions [1]: [avg(inv_quantity_on_hand#3)]
-Aggregate Attributes [1]: [avg(inv_quantity_on_hand#3)#17]
-Results [4]: [i_product_name#11, i_brand#8, i_class#9, avg(inv_quantity_on_hand#3)#17 AS qoh#18]
+Input [6]: [i_product_name#25, i_brand#26, i_class#27, i_category#28, sum#29, count#30]
+Keys [4]: [i_product_name#25, i_brand#26, i_class#27, i_category#28]
+Functions [1]: [avg(inv_quantity_on_hand#31)]
+Aggregate Attributes [1]: [avg(inv_quantity_on_hand#31)#17]
+Results [4]: [i_product_name#25, i_brand#26, i_class#27, avg(inv_quantity_on_hand#31)#17 AS qoh#32]
 
 (26) HashAggregate [codegen id : 10]
-Input [4]: [i_product_name#11, i_brand#8, i_class#9, qoh#18]
-Keys [3]: [i_product_name#11, i_brand#8, i_class#9]
-Functions [1]: [partial_avg(qoh#18)]
-Aggregate Attributes [2]: [sum#25, count#26]
-Results [5]: [i_product_name#11, i_brand#8, i_class#9, sum#27, count#28]
+Input [4]: [i_product_name#25, i_brand#26, i_class#27, qoh#32]
+Keys [3]: [i_product_name#25, i_brand#26, i_class#27]
+Functions [1]: [partial_avg(qoh#32)]
+Aggregate Attributes [2]: [sum#33, count#34]
+Results [5]: [i_product_name#25, i_brand#26, i_class#27, sum#35, count#36]
 
 (27) Exchange
-Input [5]: [i_product_name#11, i_brand#8, i_class#9, sum#27, count#28]
-Arguments: hashpartitioning(i_product_name#11, i_brand#8, i_class#9, 5), ENSURE_REQUIREMENTS, [plan_id=4]
+Input [5]: [i_product_name#25, i_brand#26, i_class#27, sum#35, count#36]
+Arguments: hashpartitioning(i_product_name#25, i_brand#26, i_class#27, 5), ENSURE_REQUIREMENTS, [plan_id=4]
 
 (28) HashAggregate [codegen id : 11]
-Input [5]: [i_product_name#11, i_brand#8, i_class#9, sum#27, count#28]
-Keys [3]: [i_product_name#11, i_brand#8, i_class#9]
-Functions [1]: [avg(qoh#18)]
-Aggregate Attributes [1]: [avg(qoh#18)#29]
-Results [5]: [i_product_name#11, i_brand#8, i_class#9, null AS i_category#30, avg(qoh#18)#29 AS qoh#31]
+Input [5]: [i_product_name#25, i_brand#26, i_class#27, sum#35, count#36]
+Keys [3]: [i_product_name#25, i_brand#26, i_class#27]
+Functions [1]: [avg(qoh#32)]
+Aggregate Attributes [1]: [avg(qoh#32)#37]
+Results [5]: [i_product_name#25, i_brand#26, i_class#27, null AS i_category#38, avg(qoh#32)#37 AS qoh#39]
 
 (29) ReusedExchange [Reuses operator id: 20]
-Output [6]: [i_product_name#11, i_brand#8, i_class#9, i_category#10, sum#15, count#16]
+Output [6]: [i_product_name#40, i_brand#41, i_class#42, i_category#43, sum#44, count#45]
 
 (30) HashAggregate [codegen id : 16]
-Input [6]: [i_product_name#11, i_brand#8, i_class#9, i_category#10, sum#15, count#16]
-Keys [4]: [i_product_name#11, i_brand#8, i_class#9, i_category#10]
-Functions [1]: [avg(inv_quantity_on_hand#3)]
-Aggregate Attributes [1]: [avg(inv_quantity_on_hand#3)#17]
-Results [3]: [i_product_name#11, i_brand#8, avg(inv_quantity_on_hand#3)#17 AS qoh#18]
+Input [6]: [i_product_name#40, i_brand#41, i_class#42, i_category#43, sum#44, count#45]
+Keys [4]: [i_product_name#40, i_brand#41, i_class#42, i_category#43]
+Functions [1]: [avg(inv_quantity_on_hand#46)]
+Aggregate Attributes [1]: [avg(inv_quantity_on_hand#46)#17]
+Results [3]: [i_product_name#40, i_brand#41, avg(inv_quantity_on_hand#46)#17 AS qoh#47]
 
 (31) HashAggregate [codegen id : 16]
-Input [3]: [i_product_name#11, i_brand#8, qoh#18]
-Keys [2]: [i_product_name#11, i_brand#8]
-Functions [1]: [partial_avg(qoh#18)]
-Aggregate Attributes [2]: [sum#32, count#33]
-Results [4]: [i_product_name#11, i_brand#8, sum#34, count#35]
+Input [3]: [i_product_name#40, i_brand#41, qoh#47]
+Keys [2]: [i_product_name#40, i_brand#41]
+Functions [1]: [partial_avg(qoh#47)]
+Aggregate Attributes [2]: [sum#48, count#49]
+Results [4]: [i_product_name#40, i_brand#41, sum#50, count#51]
 
 (32) Exchange
-Input [4]: [i_product_name#11, i_brand#8, sum#34, count#35]
-Arguments: hashpartitioning(i_product_name#11, i_brand#8, 5), ENSURE_REQUIREMENTS, [plan_id=5]
+Input [4]: [i_product_name#40, i_brand#41, sum#50, count#51]
+Arguments: hashpartitioning(i_product_name#40, i_brand#41, 5), ENSURE_REQUIREMENTS, [plan_id=5]
 
 (33) HashAggregate [codegen id : 17]
-Input [4]: [i_product_name#11, i_brand#8, sum#34, count#35]
-Keys [2]: [i_product_name#11, i_brand#8]
-Functions [1]: [avg(qoh#18)]
-Aggregate Attributes [1]: [avg(qoh#18)#36]
-Results [5]: [i_product_name#11, i_brand#8, null AS i_class#37, null AS i_category#38, avg(qoh#18)#36 AS qoh#39]
+Input [4]: [i_product_name#40, i_brand#41, sum#50, count#51]
+Keys [2]: [i_product_name#40, i_brand#41]
+Functions [1]: [avg(qoh#47)]
+Aggregate Attributes [1]: [avg(qoh#47)#52]
+Results [5]: [i_product_name#40, i_brand#41, null AS i_class#53, null AS i_category#54, avg(qoh#47)#52 AS qoh#55]
 
 (34) ReusedExchange [Reuses operator id: 20]
-Output [6]: [i_product_name#11, i_brand#8, i_class#9, i_category#10, sum#15, count#16]
+Output [6]: [i_product_name#56, i_brand#57, i_class#58, i_category#59, sum#60, count#61]
 
 (35) HashAggregate [codegen id : 22]
-Input [6]: [i_product_name#11, i_brand#8, i_class#9, i_category#10, sum#15, count#16]
-Keys [4]: [i_product_name#11, i_brand#8, i_class#9, i_category#10]
-Functions [1]: [avg(inv_quantity_on_hand#3)]
-Aggregate Attributes [1]: [avg(inv_quantity_on_hand#3)#17]
-Results [2]: [i_product_name#11, avg(inv_quantity_on_hand#3)#17 AS qoh#18]
+Input [6]: [i_product_name#56, i_brand#57, i_class#58, i_category#59, sum#60, count#61]
+Keys [4]: [i_product_name#56, i_brand#57, i_class#58, i_category#59]
+Functions [1]: [avg(inv_quantity_on_hand#62)]
+Aggregate Attributes [1]: [avg(inv_quantity_on_hand#62)#17]
+Results [2]: [i_product_name#56, avg(inv_quantity_on_hand#62)#17 AS qoh#63]
 
 (36) HashAggregate [codegen id : 22]
-Input [2]: [i_product_name#11, qoh#18]
-Keys [1]: [i_product_name#11]
-Functions [1]: [partial_avg(qoh#18)]
-Aggregate Attributes [2]: [sum#40, count#41]
-Results [3]: [i_product_name#11, sum#42, count#43]
+Input [2]: [i_product_name#56, qoh#63]
+Keys [1]: [i_product_name#56]
+Functions [1]: [partial_avg(qoh#63)]
+Aggregate Attributes [2]: [sum#64, count#65]
+Results [3]: [i_product_name#56, sum#66, count#67]
 
 (37) Exchange
-Input [3]: [i_product_name#11, sum#42, count#43]
-Arguments: hashpartitioning(i_product_name#11, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [3]: [i_product_name#56, sum#66, count#67]
+Arguments: hashpartitioning(i_product_name#56, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (38) HashAggregate [codegen id : 23]
-Input [3]: [i_product_name#11, sum#42, count#43]
-Keys [1]: [i_product_name#11]
-Functions [1]: [avg(qoh#18)]
-Aggregate Attributes [1]: [avg(qoh#18)#44]
-Results [5]: [i_product_name#11, null AS i_brand#45, null AS i_class#46, null AS i_category#47, avg(qoh#18)#44 AS qoh#48]
+Input [3]: [i_product_name#56, sum#66, count#67]
+Keys [1]: [i_product_name#56]
+Functions [1]: [avg(qoh#63)]
+Aggregate Attributes [1]: [avg(qoh#63)#68]
+Results [5]: [i_product_name#56, null AS i_brand#69, null AS i_class#70, null AS i_category#71, avg(qoh#63)#68 AS qoh#72]
 
 (39) ReusedExchange [Reuses operator id: 20]
-Output [6]: [i_product_name#11, i_brand#8, i_class#9, i_category#10, sum#15, count#16]
+Output [6]: [i_product_name#73, i_brand#74, i_class#75, i_category#76, sum#77, count#78]
 
 (40) HashAggregate [codegen id : 28]
-Input [6]: [i_product_name#11, i_brand#8, i_class#9, i_category#10, sum#15, count#16]
-Keys [4]: [i_product_name#11, i_brand#8, i_class#9, i_category#10]
-Functions [1]: [avg(inv_quantity_on_hand#3)]
-Aggregate Attributes [1]: [avg(inv_quantity_on_hand#3)#17]
-Results [1]: [avg(inv_quantity_on_hand#3)#17 AS qoh#18]
+Input [6]: [i_product_name#73, i_brand#74, i_class#75, i_category#76, sum#77, count#78]
+Keys [4]: [i_product_name#73, i_brand#74, i_class#75, i_category#76]
+Functions [1]: [avg(inv_quantity_on_hand#79)]
+Aggregate Attributes [1]: [avg(inv_quantity_on_hand#79)#17]
+Results [1]: [avg(inv_quantity_on_hand#79)#17 AS qoh#80]
 
 (41) HashAggregate [codegen id : 28]
-Input [1]: [qoh#18]
+Input [1]: [qoh#80]
 Keys: []
-Functions [1]: [partial_avg(qoh#18)]
-Aggregate Attributes [2]: [sum#49, count#50]
-Results [2]: [sum#51, count#52]
+Functions [1]: [partial_avg(qoh#80)]
+Aggregate Attributes [2]: [sum#81, count#82]
+Results [2]: [sum#83, count#84]
 
 (42) Exchange
-Input [2]: [sum#51, count#52]
+Input [2]: [sum#83, count#84]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=7]
 
 (43) HashAggregate [codegen id : 29]
-Input [2]: [sum#51, count#52]
+Input [2]: [sum#83, count#84]
 Keys: []
-Functions [1]: [avg(qoh#18)]
-Aggregate Attributes [1]: [avg(qoh#18)#53]
-Results [5]: [null AS i_product_name#54, null AS i_brand#55, null AS i_class#56, null AS i_category#57, avg(qoh#18)#53 AS qoh#58]
+Functions [1]: [avg(qoh#80)]
+Aggregate Attributes [1]: [avg(qoh#80)#85]
+Results [5]: [null AS i_product_name#86, null AS i_brand#87, null AS i_class#88, null AS i_category#89, avg(qoh#80)#85 AS qoh#90]
 
 (44) Union
 
@@ -291,22 +291,22 @@ BroadcastExchange (50)
 
 
 (46) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#6, d_month_seq#59]
+Output [2]: [d_date_sk#6, d_month_seq#91]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1212), LessThanOrEqual(d_month_seq,1223), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_month_seq:int>
 
 (47) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#6, d_month_seq#59]
+Input [2]: [d_date_sk#6, d_month_seq#91]
 
 (48) Filter [codegen id : 1]
-Input [2]: [d_date_sk#6, d_month_seq#59]
-Condition : (((isnotnull(d_month_seq#59) AND (d_month_seq#59 >= 1212)) AND (d_month_seq#59 <= 1223)) AND isnotnull(d_date_sk#6))
+Input [2]: [d_date_sk#6, d_month_seq#91]
+Condition : (((isnotnull(d_month_seq#91) AND (d_month_seq#91 >= 1212)) AND (d_month_seq#91 <= 1223)) AND isnotnull(d_date_sk#6))
 
 (49) Project [codegen id : 1]
 Output [1]: [d_date_sk#6]
-Input [2]: [d_date_sk#6, d_month_seq#59]
+Input [2]: [d_date_sk#6, d_month_seq#91]
 
 (50) BroadcastExchange
 Input [1]: [d_date_sk#6]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q24.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q24.sf100/explain.txt
index ddd544fdf3d..9d80077e993 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q24.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q24.sf100/explain.txt
@@ -309,135 +309,135 @@ Subquery:1 Hosting operator id = 46 Hosting Expression = Subquery scalar-subquer
 
 
 (49) ReusedExchange [Reuses operator id: 17]
-Output [7]: [s_store_sk#1, s_store_name#2, s_state#4, ca_state#7, c_customer_sk#10, c_first_name#12, c_last_name#13]
+Output [7]: [s_store_sk#42, s_store_name#43, s_state#44, ca_state#45, c_customer_sk#46, c_first_name#47, c_last_name#48]
 
 (50) Scan parquet spark_catalog.default.store_sales
-Output [6]: [ss_item_sk#15, ss_customer_sk#16, ss_store_sk#17, ss_ticket_number#18, ss_net_paid#19, ss_sold_date_sk#20]
+Output [6]: [ss_item_sk#49, ss_customer_sk#50, ss_store_sk#51, ss_ticket_number#52, ss_net_paid#53, ss_sold_date_sk#54]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store_sales]
 PushedFilters: [IsNotNull(ss_ticket_number), IsNotNull(ss_item_sk), IsNotNull(ss_store_sk), IsNotNull(ss_customer_sk)]
 ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_ticket_number:int,ss_net_paid:decimal(7,2)>
 
 (51) ColumnarToRow
-Input [6]: [ss_item_sk#15, ss_customer_sk#16, ss_store_sk#17, ss_ticket_number#18, ss_net_paid#19, ss_sold_date_sk#20]
+Input [6]: [ss_item_sk#49, ss_customer_sk#50, ss_store_sk#51, ss_ticket_number#52, ss_net_paid#53, ss_sold_date_sk#54]
 
 (52) Filter
-Input [6]: [ss_item_sk#15, ss_customer_sk#16, ss_store_sk#17, ss_ticket_number#18, ss_net_paid#19, ss_sold_date_sk#20]
-Condition : (((isnotnull(ss_ticket_number#18) AND isnotnull(ss_item_sk#15)) AND isnotnull(ss_store_sk#17)) AND isnotnull(ss_customer_sk#16))
+Input [6]: [ss_item_sk#49, ss_customer_sk#50, ss_store_sk#51, ss_ticket_number#52, ss_net_paid#53, ss_sold_date_sk#54]
+Condition : (((isnotnull(ss_ticket_number#52) AND isnotnull(ss_item_sk#49)) AND isnotnull(ss_store_sk#51)) AND isnotnull(ss_customer_sk#50))
 
 (53) Project
-Output [5]: [ss_item_sk#15, ss_customer_sk#16, ss_store_sk#17, ss_ticket_number#18, ss_net_paid#19]
-Input [6]: [ss_item_sk#15, ss_customer_sk#16, ss_store_sk#17, ss_ticket_number#18, ss_net_paid#19, ss_sold_date_sk#20]
+Output [5]: [ss_item_sk#49, ss_customer_sk#50, ss_store_sk#51, ss_ticket_number#52, ss_net_paid#53]
+Input [6]: [ss_item_sk#49, ss_customer_sk#50, ss_store_sk#51, ss_ticket_number#52, ss_net_paid#53, ss_sold_date_sk#54]
 
 (54) BroadcastHashJoin [codegen id : 4]
-Left keys [2]: [s_store_sk#1, c_customer_sk#10]
-Right keys [2]: [ss_store_sk#17, ss_customer_sk#16]
+Left keys [2]: [s_store_sk#42, c_customer_sk#46]
+Right keys [2]: [ss_store_sk#51, ss_customer_sk#50]
 Join type: Inner
 Join condition: None
 
 (55) Project [codegen id : 4]
-Output [8]: [s_store_name#2, s_state#4, ca_state#7, c_first_name#12, c_last_name#13, ss_item_sk#15, ss_ticket_number#18, ss_net_paid#19]
-Input [12]: [s_store_sk#1, s_store_name#2, s_state#4, ca_state#7, c_customer_sk#10, c_first_name#12, c_last_name#13, ss_item_sk#15, ss_customer_sk#16, ss_store_sk#17, ss_ticket_number#18, ss_net_paid#19]
+Output [8]: [s_store_name#43, s_state#44, ca_state#45, c_first_name#47, c_last_name#48, ss_item_sk#49, ss_ticket_number#52, ss_net_paid#53]
+Input [12]: [s_store_sk#42, s_store_name#43, s_state#44, ca_state#45, c_customer_sk#46, c_first_name#47, c_last_name#48, ss_item_sk#49, ss_customer_sk#50, ss_store_sk#51, ss_ticket_number#52, ss_net_paid#53]
 
 (56) Exchange
-Input [8]: [s_store_name#2, s_state#4, ca_state#7, c_first_name#12, c_last_name#13, ss_item_sk#15, ss_ticket_number#18, ss_net_paid#19]
-Arguments: hashpartitioning(ss_item_sk#15, 5), ENSURE_REQUIREMENTS, [plan_id=10]
+Input [8]: [s_store_name#43, s_state#44, ca_state#45, c_first_name#47, c_last_name#48, ss_item_sk#49, ss_ticket_number#52, ss_net_paid#53]
+Arguments: hashpartitioning(ss_item_sk#49, 5), ENSURE_REQUIREMENTS, [plan_id=10]
 
 (57) Sort [codegen id : 5]
-Input [8]: [s_store_name#2, s_state#4, ca_state#7, c_first_name#12, c_last_name#13, ss_item_sk#15, ss_ticket_number#18, ss_net_paid#19]
-Arguments: [ss_item_sk#15 ASC NULLS FIRST], false, 0
+Input [8]: [s_store_name#43, s_state#44, ca_state#45, c_first_name#47, c_last_name#48, ss_item_sk#49, ss_ticket_number#52, ss_net_paid#53]
+Arguments: [ss_item_sk#49 ASC NULLS FIRST], false, 0
 
 (58) Scan parquet spark_catalog.default.item
-Output [6]: [i_item_sk#21, i_current_price#22, i_size#23, i_color#24, i_units#25, i_manager_id#26]
+Output [6]: [i_item_sk#55, i_current_price#56, i_size#57, i_color#58, i_units#59, i_manager_id#60]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/item]
 PushedFilters: [IsNotNull(i_item_sk)]
 ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_size:string,i_color:string,i_units:string,i_manager_id:int>
 
 (59) ColumnarToRow [codegen id : 6]
-Input [6]: [i_item_sk#21, i_current_price#22, i_size#23, i_color#24, i_units#25, i_manager_id#26]
+Input [6]: [i_item_sk#55, i_current_price#56, i_size#57, i_color#58, i_units#59, i_manager_id#60]
 
 (60) Filter [codegen id : 6]
-Input [6]: [i_item_sk#21, i_current_price#22, i_size#23, i_color#24, i_units#25, i_manager_id#26]
-Condition : isnotnull(i_item_sk#21)
+Input [6]: [i_item_sk#55, i_current_price#56, i_size#57, i_color#58, i_units#59, i_manager_id#60]
+Condition : isnotnull(i_item_sk#55)
 
 (61) Exchange
-Input [6]: [i_item_sk#21, i_current_price#22, i_size#23, i_color#24, i_units#25, i_manager_id#26]
-Arguments: hashpartitioning(i_item_sk#21, 5), ENSURE_REQUIREMENTS, [plan_id=11]
+Input [6]: [i_item_sk#55, i_current_price#56, i_size#57, i_color#58, i_units#59, i_manager_id#60]
+Arguments: hashpartitioning(i_item_sk#55, 5), ENSURE_REQUIREMENTS, [plan_id=11]
 
 (62) Sort [codegen id : 7]
-Input [6]: [i_item_sk#21, i_current_price#22, i_size#23, i_color#24, i_units#25, i_manager_id#26]
-Arguments: [i_item_sk#21 ASC NULLS FIRST], false, 0
+Input [6]: [i_item_sk#55, i_current_price#56, i_size#57, i_color#58, i_units#59, i_manager_id#60]
+Arguments: [i_item_sk#55 ASC NULLS FIRST], false, 0
 
 (63) SortMergeJoin [codegen id : 8]
-Left keys [1]: [ss_item_sk#15]
-Right keys [1]: [i_item_sk#21]
+Left keys [1]: [ss_item_sk#49]
+Right keys [1]: [i_item_sk#55]
 Join type: Inner
 Join condition: None
 
 (64) Project [codegen id : 8]
-Output [13]: [s_store_name#2, s_state#4, ca_state#7, c_first_name#12, c_last_name#13, ss_item_sk#15, ss_ticket_number#18, ss_net_paid#19, i_current_price#22, i_size#23, i_color#24, i_units#25, i_manager_id#26]
-Input [14]: [s_store_name#2, s_state#4, ca_state#7, c_first_name#12, c_last_name#13, ss_item_sk#15, ss_ticket_number#18, ss_net_paid#19, i_item_sk#21, i_current_price#22, i_size#23, i_color#24, i_units#25, i_manager_id#26]
+Output [13]: [s_store_name#43, s_state#44, ca_state#45, c_first_name#47, c_last_name#48, ss_item_sk#49, ss_ticket_number#52, ss_net_paid#53, i_current_price#56, i_size#57, i_color#58, i_units#59, i_manager_id#60]
+Input [14]: [s_store_name#43, s_state#44, ca_state#45, c_first_name#47, c_last_name#48, ss_item_sk#49, ss_ticket_number#52, ss_net_paid#53, i_item_sk#55, i_current_price#56, i_size#57, i_color#58, i_units#59, i_manager_id#60]
 
 (65) Exchange
-Input [13]: [s_store_name#2, s_state#4, ca_state#7, c_first_name#12, c_last_name#13, ss_item_sk#15, ss_ticket_number#18, ss_net_paid#19, i_current_price#22, i_size#23, i_color#24, i_units#25, i_manager_id#26]
-Arguments: hashpartitioning(ss_ticket_number#18, ss_item_sk#15, 5), ENSURE_REQUIREMENTS, [plan_id=12]
+Input [13]: [s_store_name#43, s_state#44, ca_state#45, c_first_name#47, c_last_name#48, ss_item_sk#49, ss_ticket_number#52, ss_net_paid#53, i_current_price#56, i_size#57, i_color#58, i_units#59, i_manager_id#60]
+Arguments: hashpartitioning(ss_ticket_number#52, ss_item_sk#49, 5), ENSURE_REQUIREMENTS, [plan_id=12]
 
 (66) Sort [codegen id : 9]
-Input [13]: [s_store_name#2, s_state#4, ca_state#7, c_first_name#12, c_last_name#13, ss_item_sk#15, ss_ticket_number#18, ss_net_paid#19, i_current_price#22, i_size#23, i_color#24, i_units#25, i_manager_id#26]
-Arguments: [ss_ticket_number#18 ASC NULLS FIRST, ss_item_sk#15 ASC NULLS FIRST], false, 0
+Input [13]: [s_store_name#43, s_state#44, ca_state#45, c_first_name#47, c_last_name#48, ss_item_sk#49, ss_ticket_number#52, ss_net_paid#53, i_current_price#56, i_size#57, i_color#58, i_units#59, i_manager_id#60]
+Arguments: [ss_ticket_number#52 ASC NULLS FIRST, ss_item_sk#49 ASC NULLS FIRST], false, 0
 
 (67) ReusedExchange [Reuses operator id: 36]
-Output [2]: [sr_item_sk#27, sr_ticket_number#28]
+Output [2]: [sr_item_sk#61, sr_ticket_number#62]
 
 (68) Sort [codegen id : 11]
-Input [2]: [sr_item_sk#27, sr_ticket_number#28]
-Arguments: [sr_ticket_number#28 ASC NULLS FIRST, sr_item_sk#27 ASC NULLS FIRST], false, 0
+Input [2]: [sr_item_sk#61, sr_ticket_number#62]
+Arguments: [sr_ticket_number#62 ASC NULLS FIRST, sr_item_sk#61 ASC NULLS FIRST], false, 0
 
 (69) SortMergeJoin [codegen id : 12]
-Left keys [2]: [ss_ticket_number#18, ss_item_sk#15]
-Right keys [2]: [sr_ticket_number#28, sr_item_sk#27]
+Left keys [2]: [ss_ticket_number#52, ss_item_sk#49]
+Right keys [2]: [sr_ticket_number#62, sr_item_sk#61]
 Join type: Inner
 Join condition: None
 
 (70) Project [codegen id : 12]
-Output [11]: [ss_net_paid#19, s_store_name#2, s_state#4, i_current_price#22, i_size#23, i_color#24, i_units#25, i_manager_id#26, c_first_name#12, c_last_name#13, ca_state#7]
-Input [15]: [s_store_name#2, s_state#4, ca_state#7, c_first_name#12, c_last_name#13, ss_item_sk#15, ss_ticket_number#18, ss_net_paid#19, i_current_price#22, i_size#23, i_color#24, i_units#25, i_manager_id#26, sr_item_sk#27, sr_ticket_number#28]
+Output [11]: [ss_net_paid#53, s_store_name#43, s_state#44, i_current_price#56, i_size#57, i_color#58, i_units#59, i_manager_id#60, c_first_name#47, c_last_name#48, ca_state#45]
+Input [15]: [s_store_name#43, s_state#44, ca_state#45, c_first_name#47, c_last_name#48, ss_item_sk#49, ss_ticket_number#52, ss_net_paid#53, i_current_price#56, i_size#57, i_color#58, i_units#59, i_manager_id#60, sr_item_sk#61, sr_ticket_number#62]
 
 (71) HashAggregate [codegen id : 12]
-Input [11]: [ss_net_paid#19, s_store_name#2, s_state#4, i_current_price#22, i_size#23, i_color#24, i_units#25, i_manager_id#26, c_first_name#12, c_last_name#13, ca_state#7]
-Keys [10]: [c_last_name#13, c_first_name#12, s_store_name#2, ca_state#7, s_state#4, i_color#24, i_current_price#22, i_manager_id#26, i_units#25, i_size#23]
-Functions [1]: [partial_sum(UnscaledValue(ss_net_paid#19))]
-Aggregate Attributes [1]: [sum#42]
-Results [11]: [c_last_name#13, c_first_name#12, s_store_name#2, ca_state#7, s_state#4, i_color#24, i_current_price#22, i_manager_id#26, i_units#25, i_size#23, sum#43]
+Input [11]: [ss_net_paid#53, s_store_name#43, s_state#44, i_current_price#56, i_size#57, i_color#58, i_units#59, i_manager_id#60, c_first_name#47, c_last_name#48, ca_state#45]
+Keys [10]: [c_last_name#48, c_first_name#47, s_store_name#43, ca_state#45, s_state#44, i_color#58, i_current_price#56, i_manager_id#60, i_units#59, i_size#57]
+Functions [1]: [partial_sum(UnscaledValue(ss_net_paid#53))]
+Aggregate Attributes [1]: [sum#63]
+Results [11]: [c_last_name#48, c_first_name#47, s_store_name#43, ca_state#45, s_state#44, i_color#58, i_current_price#56, i_manager_id#60, i_units#59, i_size#57, sum#64]
 
 (72) Exchange
-Input [11]: [c_last_name#13, c_first_name#12, s_store_name#2, ca_state#7, s_state#4, i_color#24, i_current_price#22, i_manager_id#26, i_units#25, i_size#23, sum#43]
-Arguments: hashpartitioning(c_last_name#13, c_first_name#12, s_store_name#2, ca_state#7, s_state#4, i_color#24, i_current_price#22, i_manager_id#26, i_units#25, i_size#23, 5), ENSURE_REQUIREMENTS, [plan_id=13]
+Input [11]: [c_last_name#48, c_first_name#47, s_store_name#43, ca_state#45, s_state#44, i_color#58, i_current_price#56, i_manager_id#60, i_units#59, i_size#57, sum#64]
+Arguments: hashpartitioning(c_last_name#48, c_first_name#47, s_store_name#43, ca_state#45, s_state#44, i_color#58, i_current_price#56, i_manager_id#60, i_units#59, i_size#57, 5), ENSURE_REQUIREMENTS, [plan_id=13]
 
 (73) HashAggregate [codegen id : 13]
-Input [11]: [c_last_name#13, c_first_name#12, s_store_name#2, ca_state#7, s_state#4, i_color#24, i_current_price#22, i_manager_id#26, i_units#25, i_size#23, sum#43]
-Keys [10]: [c_last_name#13, c_first_name#12, s_store_name#2, ca_state#7, s_state#4, i_color#24, i_current_price#22, i_manager_id#26, i_units#25, i_size#23]
-Functions [1]: [sum(UnscaledValue(ss_net_paid#19))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_paid#19))#32]
-Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_paid#19))#32,17,2) AS netpaid#33]
+Input [11]: [c_last_name#48, c_first_name#47, s_store_name#43, ca_state#45, s_state#44, i_color#58, i_current_price#56, i_manager_id#60, i_units#59, i_size#57, sum#64]
+Keys [10]: [c_last_name#48, c_first_name#47, s_store_name#43, ca_state#45, s_state#44, i_color#58, i_current_price#56, i_manager_id#60, i_units#59, i_size#57]
+Functions [1]: [sum(UnscaledValue(ss_net_paid#53))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_paid#53))#32]
+Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_paid#53))#32,17,2) AS netpaid#65]
 
 (74) HashAggregate [codegen id : 13]
-Input [1]: [netpaid#33]
+Input [1]: [netpaid#65]
 Keys: []
-Functions [1]: [partial_avg(netpaid#33)]
-Aggregate Attributes [2]: [sum#44, count#45]
-Results [2]: [sum#46, count#47]
+Functions [1]: [partial_avg(netpaid#65)]
+Aggregate Attributes [2]: [sum#66, count#67]
+Results [2]: [sum#68, count#69]
 
 (75) Exchange
-Input [2]: [sum#46, count#47]
+Input [2]: [sum#68, count#69]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=14]
 
 (76) HashAggregate [codegen id : 14]
-Input [2]: [sum#46, count#47]
+Input [2]: [sum#68, count#69]
 Keys: []
-Functions [1]: [avg(netpaid#33)]
-Aggregate Attributes [1]: [avg(netpaid#33)#48]
-Results [1]: [(0.05 * avg(netpaid#33)#48) AS (0.05 * avg(netpaid))#49]
+Functions [1]: [avg(netpaid#65)]
+Aggregate Attributes [1]: [avg(netpaid#65)#70]
+Results [1]: [(0.05 * avg(netpaid#65)#70) AS (0.05 * avg(netpaid))#71]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q24/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q24/explain.txt
index a0e507ac1c6..99912f05b13 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q24/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q24/explain.txt
@@ -308,130 +308,130 @@ Subquery:1 Hosting operator id = 46 Hosting Expression = Subquery scalar-subquer
 
 
 (49) ReusedExchange [Reuses operator id: 5]
-Output [5]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5]
+Output [5]: [ss_item_sk#42, ss_customer_sk#43, ss_store_sk#44, ss_ticket_number#45, ss_net_paid#46]
 
 (50) Sort [codegen id : 2]
-Input [5]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5]
-Arguments: [ss_ticket_number#4 ASC NULLS FIRST, ss_item_sk#1 ASC NULLS FIRST], false, 0
+Input [5]: [ss_item_sk#42, ss_customer_sk#43, ss_store_sk#44, ss_ticket_number#45, ss_net_paid#46]
+Arguments: [ss_ticket_number#45 ASC NULLS FIRST, ss_item_sk#42 ASC NULLS FIRST], false, 0
 
 (51) ReusedExchange [Reuses operator id: 11]
-Output [2]: [sr_item_sk#7, sr_ticket_number#8]
+Output [2]: [sr_item_sk#47, sr_ticket_number#48]
 
 (52) Sort [codegen id : 4]
-Input [2]: [sr_item_sk#7, sr_ticket_number#8]
-Arguments: [sr_ticket_number#8 ASC NULLS FIRST, sr_item_sk#7 ASC NULLS FIRST], false, 0
+Input [2]: [sr_item_sk#47, sr_ticket_number#48]
+Arguments: [sr_ticket_number#48 ASC NULLS FIRST, sr_item_sk#47 ASC NULLS FIRST], false, 0
 
 (53) SortMergeJoin [codegen id : 9]
-Left keys [2]: [ss_ticket_number#4, ss_item_sk#1]
-Right keys [2]: [sr_ticket_number#8, sr_item_sk#7]
+Left keys [2]: [ss_ticket_number#45, ss_item_sk#42]
+Right keys [2]: [sr_ticket_number#48, sr_item_sk#47]
 Join type: Inner
 Join condition: None
 
 (54) Project [codegen id : 9]
-Output [4]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_net_paid#5]
-Input [7]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_ticket_number#4, ss_net_paid#5, sr_item_sk#7, sr_ticket_number#8]
+Output [4]: [ss_item_sk#42, ss_customer_sk#43, ss_store_sk#44, ss_net_paid#46]
+Input [7]: [ss_item_sk#42, ss_customer_sk#43, ss_store_sk#44, ss_ticket_number#45, ss_net_paid#46, sr_item_sk#47, sr_ticket_number#48]
 
 (55) ReusedExchange [Reuses operator id: 19]
-Output [4]: [s_store_sk#10, s_store_name#11, s_state#13, s_zip#14]
+Output [4]: [s_store_sk#49, s_store_name#50, s_state#51, s_zip#52]
 
 (56) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#10]
+Left keys [1]: [ss_store_sk#44]
+Right keys [1]: [s_store_sk#49]
 Join type: Inner
 Join condition: None
 
 (57) Project [codegen id : 9]
-Output [6]: [ss_item_sk#1, ss_customer_sk#2, ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14]
-Input [8]: [ss_item_sk#1, ss_customer_sk#2, ss_store_sk#3, ss_net_paid#5, s_store_sk#10, s_store_name#11, s_state#13, s_zip#14]
+Output [6]: [ss_item_sk#42, ss_customer_sk#43, ss_net_paid#46, s_store_name#50, s_state#51, s_zip#52]
+Input [8]: [ss_item_sk#42, ss_customer_sk#43, ss_store_sk#44, ss_net_paid#46, s_store_sk#49, s_store_name#50, s_state#51, s_zip#52]
 
 (58) Scan parquet spark_catalog.default.item
-Output [6]: [i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
+Output [6]: [i_item_sk#53, i_current_price#54, i_size#55, i_color#56, i_units#57, i_manager_id#58]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/item]
 PushedFilters: [IsNotNull(i_item_sk)]
 ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_size:string,i_color:string,i_units:string,i_manager_id:int>
 
 (59) ColumnarToRow [codegen id : 6]
-Input [6]: [i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
+Input [6]: [i_item_sk#53, i_current_price#54, i_size#55, i_color#56, i_units#57, i_manager_id#58]
 
 (60) Filter [codegen id : 6]
-Input [6]: [i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
-Condition : isnotnull(i_item_sk#15)
+Input [6]: [i_item_sk#53, i_current_price#54, i_size#55, i_color#56, i_units#57, i_manager_id#58]
+Condition : isnotnull(i_item_sk#53)
 
 (61) BroadcastExchange
-Input [6]: [i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
+Input [6]: [i_item_sk#53, i_current_price#54, i_size#55, i_color#56, i_units#57, i_manager_id#58]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=10]
 
 (62) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#15]
+Left keys [1]: [ss_item_sk#42]
+Right keys [1]: [i_item_sk#53]
 Join type: Inner
 Join condition: None
 
 (63) Project [codegen id : 9]
-Output [10]: [ss_customer_sk#2, ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
-Input [12]: [ss_item_sk#1, ss_customer_sk#2, ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_item_sk#15, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20]
+Output [10]: [ss_customer_sk#43, ss_net_paid#46, s_store_name#50, s_state#51, s_zip#52, i_current_price#54, i_size#55, i_color#56, i_units#57, i_manager_id#58]
+Input [12]: [ss_item_sk#42, ss_customer_sk#43, ss_net_paid#46, s_store_name#50, s_state#51, s_zip#52, i_item_sk#53, i_current_price#54, i_size#55, i_color#56, i_units#57, i_manager_id#58]
 
 (64) ReusedExchange [Reuses operator id: 31]
-Output [5]: [c_customer_sk#21, c_current_addr_sk#22, c_first_name#23, c_last_name#24, c_birth_country#25]
+Output [5]: [c_customer_sk#59, c_current_addr_sk#60, c_first_name#61, c_last_name#62, c_birth_country#63]
 
 (65) BroadcastHashJoin [codegen id : 9]
-Left keys [1]: [ss_customer_sk#2]
-Right keys [1]: [c_customer_sk#21]
+Left keys [1]: [ss_customer_sk#43]
+Right keys [1]: [c_customer_sk#59]
 Join type: Inner
 Join condition: None
 
 (66) Project [codegen id : 9]
-Output [13]: [ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_current_addr_sk#22, c_first_name#23, c_last_name#24, c_birth_country#25]
-Input [15]: [ss_customer_sk#2, ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_customer_sk#21, c_current_addr_sk#22, c_first_name#23, c_last_name#24, c_birth_country#25]
+Output [13]: [ss_net_paid#46, s_store_name#50, s_state#51, s_zip#52, i_current_price#54, i_size#55, i_color#56, i_units#57, i_manager_id#58, c_current_addr_sk#60, c_first_name#61, c_last_name#62, c_birth_country#63]
+Input [15]: [ss_customer_sk#43, ss_net_paid#46, s_store_name#50, s_state#51, s_zip#52, i_current_price#54, i_size#55, i_color#56, i_units#57, i_manager_id#58, c_customer_sk#59, c_current_addr_sk#60, c_first_name#61, c_last_name#62, c_birth_country#63]
 
 (67) ReusedExchange [Reuses operator id: 37]
-Output [4]: [ca_address_sk#26, ca_state#27, ca_zip#28, ca_country#29]
+Output [4]: [ca_address_sk#64, ca_state#65, ca_zip#66, ca_country#67]
 
 (68) BroadcastHashJoin [codegen id : 9]
-Left keys [3]: [c_current_addr_sk#22, c_birth_country#25, s_zip#14]
-Right keys [3]: [ca_address_sk#26, upper(ca_country#29), ca_zip#28]
+Left keys [3]: [c_current_addr_sk#60, c_birth_country#63, s_zip#52]
+Right keys [3]: [ca_address_sk#64, upper(ca_country#67), ca_zip#66]
 Join type: Inner
 Join condition: None
 
 (69) Project [codegen id : 9]
-Output [11]: [ss_net_paid#5, s_store_name#11, s_state#13, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_first_name#23, c_last_name#24, ca_state#27]
-Input [17]: [ss_net_paid#5, s_store_name#11, s_state#13, s_zip#14, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_current_addr_sk#22, c_first_name#23, c_last_name#24, c_birth_country#25, ca_address_sk#26, ca_state#27, ca_zip#28, ca_country#29]
+Output [11]: [ss_net_paid#46, s_store_name#50, s_state#51, i_current_price#54, i_size#55, i_color#56, i_units#57, i_manager_id#58, c_first_name#61, c_last_name#62, ca_state#65]
+Input [17]: [ss_net_paid#46, s_store_name#50, s_state#51, s_zip#52, i_current_price#54, i_size#55, i_color#56, i_units#57, i_manager_id#58, c_current_addr_sk#60, c_first_name#61, c_last_name#62, c_birth_country#63, ca_address_sk#64, ca_state#65, ca_zip#66, ca_country#67]
 
 (70) HashAggregate [codegen id : 9]
-Input [11]: [ss_net_paid#5, s_store_name#11, s_state#13, i_current_price#16, i_size#17, i_color#18, i_units#19, i_manager_id#20, c_first_name#23, c_last_name#24, ca_state#27]
-Keys [10]: [c_last_name#24, c_first_name#23, s_store_name#11, ca_state#27, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17]
-Functions [1]: [partial_sum(UnscaledValue(ss_net_paid#5))]
-Aggregate Attributes [1]: [sum#42]
-Results [11]: [c_last_name#24, c_first_name#23, s_store_name#11, ca_state#27, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17, sum#43]
+Input [11]: [ss_net_paid#46, s_store_name#50, s_state#51, i_current_price#54, i_size#55, i_color#56, i_units#57, i_manager_id#58, c_first_name#61, c_last_name#62, ca_state#65]
+Keys [10]: [c_last_name#62, c_first_name#61, s_store_name#50, ca_state#65, s_state#51, i_color#56, i_current_price#54, i_manager_id#58, i_units#57, i_size#55]
+Functions [1]: [partial_sum(UnscaledValue(ss_net_paid#46))]
+Aggregate Attributes [1]: [sum#68]
+Results [11]: [c_last_name#62, c_first_name#61, s_store_name#50, ca_state#65, s_state#51, i_color#56, i_current_price#54, i_manager_id#58, i_units#57, i_size#55, sum#69]
 
 (71) Exchange
-Input [11]: [c_last_name#24, c_first_name#23, s_store_name#11, ca_state#27, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17, sum#43]
-Arguments: hashpartitioning(c_last_name#24, c_first_name#23, s_store_name#11, ca_state#27, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17, 5), ENSURE_REQUIREMENTS, [plan_id=11]
+Input [11]: [c_last_name#62, c_first_name#61, s_store_name#50, ca_state#65, s_state#51, i_color#56, i_current_price#54, i_manager_id#58, i_units#57, i_size#55, sum#69]
+Arguments: hashpartitioning(c_last_name#62, c_first_name#61, s_store_name#50, ca_state#65, s_state#51, i_color#56, i_current_price#54, i_manager_id#58, i_units#57, i_size#55, 5), ENSURE_REQUIREMENTS, [plan_id=11]
 
 (72) HashAggregate [codegen id : 10]
-Input [11]: [c_last_name#24, c_first_name#23, s_store_name#11, ca_state#27, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17, sum#43]
-Keys [10]: [c_last_name#24, c_first_name#23, s_store_name#11, ca_state#27, s_state#13, i_color#18, i_current_price#16, i_manager_id#20, i_units#19, i_size#17]
-Functions [1]: [sum(UnscaledValue(ss_net_paid#5))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_paid#5))#32]
-Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_paid#5))#32,17,2) AS netpaid#33]
+Input [11]: [c_last_name#62, c_first_name#61, s_store_name#50, ca_state#65, s_state#51, i_color#56, i_current_price#54, i_manager_id#58, i_units#57, i_size#55, sum#69]
+Keys [10]: [c_last_name#62, c_first_name#61, s_store_name#50, ca_state#65, s_state#51, i_color#56, i_current_price#54, i_manager_id#58, i_units#57, i_size#55]
+Functions [1]: [sum(UnscaledValue(ss_net_paid#46))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_paid#46))#32]
+Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_paid#46))#32,17,2) AS netpaid#70]
 
 (73) HashAggregate [codegen id : 10]
-Input [1]: [netpaid#33]
+Input [1]: [netpaid#70]
 Keys: []
-Functions [1]: [partial_avg(netpaid#33)]
-Aggregate Attributes [2]: [sum#44, count#45]
-Results [2]: [sum#46, count#47]
+Functions [1]: [partial_avg(netpaid#70)]
+Aggregate Attributes [2]: [sum#71, count#72]
+Results [2]: [sum#73, count#74]
 
 (74) Exchange
-Input [2]: [sum#46, count#47]
+Input [2]: [sum#73, count#74]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=12]
 
 (75) HashAggregate [codegen id : 11]
-Input [2]: [sum#46, count#47]
+Input [2]: [sum#73, count#74]
 Keys: []
-Functions [1]: [avg(netpaid#33)]
-Aggregate Attributes [1]: [avg(netpaid#33)#48]
-Results [1]: [(0.05 * avg(netpaid#33)#48) AS (0.05 * avg(netpaid))#49]
+Functions [1]: [avg(netpaid#70)]
+Aggregate Attributes [1]: [avg(netpaid#70)#75]
+Results [1]: [(0.05 * avg(netpaid#70)#75) AS (0.05 * avg(netpaid))#76]
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q27a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q27a.sf100/explain.txt
index 641c5f8feaf..b845b5c8818 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q27a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q27a.sf100/explain.txt
@@ -209,208 +209,208 @@ Aggregate Attributes [4]: [avg(agg1#19)#39, avg(UnscaledValue(agg2#20))#40, avg(
 Results [7]: [i_item_id#18, s_state#16, 0 AS g_state#43, avg(agg1#19)#39 AS agg1#44, cast((avg(UnscaledValue(agg2#20))#40 / 100.0) as decimal(11,6)) AS agg2#45, cast((avg(UnscaledValue(agg3#21))#41 / 100.0) as decimal(11,6)) AS agg3#46, cast((avg(UnscaledValue(agg4#22))#42 / 100.0) as decimal(11,6)) AS agg4#47]
 
 (29) Scan parquet spark_catalog.default.store_sales
-Output [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Output [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#8), dynamicpruningexpression(ss_sold_date_sk#8 IN dynamicpruning#9)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#55), dynamicpruningexpression(ss_sold_date_sk#55 IN dynamicpruning#9)]
 PushedFilters: [IsNotNull(ss_cdemo_sk), IsNotNull(ss_store_sk), IsNotNull(ss_item_sk)]
 ReadSchema: struct<ss_item_sk:int,ss_cdemo_sk:int,ss_store_sk:int,ss_quantity:int,ss_list_price:decimal(7,2),ss_sales_price:decimal(7,2),ss_coupon_amt:decimal(7,2)>
 
 (30) ColumnarToRow [codegen id : 11]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Input [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
 
 (31) Filter [codegen id : 11]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Condition : ((isnotnull(ss_cdemo_sk#2) AND isnotnull(ss_store_sk#3)) AND isnotnull(ss_item_sk#1))
+Input [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
+Condition : ((isnotnull(ss_cdemo_sk#49) AND isnotnull(ss_store_sk#50)) AND isnotnull(ss_item_sk#48))
 
 (32) ReusedExchange [Reuses operator id: 8]
-Output [1]: [cd_demo_sk#10]
+Output [1]: [cd_demo_sk#56]
 
 (33) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#10]
+Left keys [1]: [ss_cdemo_sk#49]
+Right keys [1]: [cd_demo_sk#56]
 Join type: Inner
 Join condition: None
 
 (34) Project [codegen id : 11]
-Output [7]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Input [9]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, cd_demo_sk#10]
+Output [7]: [ss_item_sk#48, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
+Input [9]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55, cd_demo_sk#56]
 
 (35) Scan parquet spark_catalog.default.store
-Output [2]: [s_store_sk#15, s_state#16]
+Output [2]: [s_store_sk#57, s_state#58]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store]
 PushedFilters: [IsNotNull(s_state), EqualTo(s_state,TN), IsNotNull(s_store_sk)]
 ReadSchema: struct<s_store_sk:int,s_state:string>
 
 (36) ColumnarToRow [codegen id : 8]
-Input [2]: [s_store_sk#15, s_state#16]
+Input [2]: [s_store_sk#57, s_state#58]
 
 (37) Filter [codegen id : 8]
-Input [2]: [s_store_sk#15, s_state#16]
-Condition : ((isnotnull(s_state#16) AND (s_state#16 = TN)) AND isnotnull(s_store_sk#15))
+Input [2]: [s_store_sk#57, s_state#58]
+Condition : ((isnotnull(s_state#58) AND (s_state#58 = TN)) AND isnotnull(s_store_sk#57))
 
 (38) Project [codegen id : 8]
-Output [1]: [s_store_sk#15]
-Input [2]: [s_store_sk#15, s_state#16]
+Output [1]: [s_store_sk#57]
+Input [2]: [s_store_sk#57, s_state#58]
 
 (39) BroadcastExchange
-Input [1]: [s_store_sk#15]
+Input [1]: [s_store_sk#57]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5]
 
 (40) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#15]
+Left keys [1]: [ss_store_sk#50]
+Right keys [1]: [s_store_sk#57]
 Join type: Inner
 Join condition: None
 
 (41) Project [codegen id : 11]
-Output [6]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Input [8]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, s_store_sk#15]
+Output [6]: [ss_item_sk#48, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
+Input [8]: [ss_item_sk#48, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55, s_store_sk#57]
 
 (42) ReusedExchange [Reuses operator id: 78]
-Output [1]: [d_date_sk#14]
+Output [1]: [d_date_sk#59]
 
 (43) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_sold_date_sk#8]
-Right keys [1]: [d_date_sk#14]
+Left keys [1]: [ss_sold_date_sk#55]
+Right keys [1]: [d_date_sk#59]
 Join type: Inner
 Join condition: None
 
 (44) Project [codegen id : 11]
-Output [5]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [7]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, d_date_sk#14]
+Output [5]: [ss_item_sk#48, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54]
+Input [7]: [ss_item_sk#48, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55, d_date_sk#59]
 
 (45) ReusedExchange [Reuses operator id: 23]
-Output [2]: [i_item_sk#17, i_item_id#18]
+Output [2]: [i_item_sk#60, i_item_id#61]
 
 (46) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#17]
+Left keys [1]: [ss_item_sk#48]
+Right keys [1]: [i_item_sk#60]
 Join type: Inner
 Join condition: None
 
 (47) Project [codegen id : 11]
-Output [5]: [i_item_id#18, ss_quantity#4 AS agg1#19, ss_list_price#5 AS agg2#20, ss_coupon_amt#7 AS agg3#21, ss_sales_price#6 AS agg4#22]
-Input [7]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, i_item_sk#17, i_item_id#18]
+Output [5]: [i_item_id#61, ss_quantity#51 AS agg1#62, ss_list_price#52 AS agg2#63, ss_coupon_amt#54 AS agg3#64, ss_sales_price#53 AS agg4#65]
+Input [7]: [ss_item_sk#48, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, i_item_sk#60, i_item_id#61]
 
 (48) HashAggregate [codegen id : 11]
-Input [5]: [i_item_id#18, agg1#19, agg2#20, agg3#21, agg4#22]
-Keys [1]: [i_item_id#18]
-Functions [4]: [partial_avg(agg1#19), partial_avg(UnscaledValue(agg2#20)), partial_avg(UnscaledValue(agg3#21)), partial_avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [8]: [sum#48, count#49, sum#50, count#51, sum#52, count#53, sum#54, count#55]
-Results [9]: [i_item_id#18, sum#56, count#57, sum#58, count#59, sum#60, count#61, sum#62, count#63]
+Input [5]: [i_item_id#61, agg1#62, agg2#63, agg3#64, agg4#65]
+Keys [1]: [i_item_id#61]
+Functions [4]: [partial_avg(agg1#62), partial_avg(UnscaledValue(agg2#63)), partial_avg(UnscaledValue(agg3#64)), partial_avg(UnscaledValue(agg4#65))]
+Aggregate Attributes [8]: [sum#66, count#67, sum#68, count#69, sum#70, count#71, sum#72, count#73]
+Results [9]: [i_item_id#61, sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
 
 (49) Exchange
-Input [9]: [i_item_id#18, sum#56, count#57, sum#58, count#59, sum#60, count#61, sum#62, count#63]
-Arguments: hashpartitioning(i_item_id#18, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [9]: [i_item_id#61, sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
+Arguments: hashpartitioning(i_item_id#61, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (50) HashAggregate [codegen id : 12]
-Input [9]: [i_item_id#18, sum#56, count#57, sum#58, count#59, sum#60, count#61, sum#62, count#63]
-Keys [1]: [i_item_id#18]
-Functions [4]: [avg(agg1#19), avg(UnscaledValue(agg2#20)), avg(UnscaledValue(agg3#21)), avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [4]: [avg(agg1#19)#64, avg(UnscaledValue(agg2#20))#65, avg(UnscaledValue(agg3#21))#66, avg(UnscaledValue(agg4#22))#67]
-Results [7]: [i_item_id#18, null AS s_state#68, 1 AS g_state#69, avg(agg1#19)#64 AS agg1#70, cast((avg(UnscaledValue(agg2#20))#65 / 100.0) as decimal(11,6)) AS agg2#71, cast((avg(UnscaledValue(agg3#21))#66 / 100.0) as decimal(11,6)) AS agg3#72, cast((avg(UnscaledValue(agg4#22))#67 / 100.0) as decimal(11,6)) AS agg4#73]
+Input [9]: [i_item_id#61, sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
+Keys [1]: [i_item_id#61]
+Functions [4]: [avg(agg1#62), avg(UnscaledValue(agg2#63)), avg(UnscaledValue(agg3#64)), avg(UnscaledValue(agg4#65))]
+Aggregate Attributes [4]: [avg(agg1#62)#82, avg(UnscaledValue(agg2#63))#83, avg(UnscaledValue(agg3#64))#84, avg(UnscaledValue(agg4#65))#85]
+Results [7]: [i_item_id#61, null AS s_state#86, 1 AS g_state#87, avg(agg1#62)#82 AS agg1#88, cast((avg(UnscaledValue(agg2#63))#83 / 100.0) as decimal(11,6)) AS agg2#89, cast((avg(UnscaledValue(agg3#64))#84 / 100.0) as decimal(11,6)) AS agg3#90, cast((avg(UnscaledValue(agg4#65))#85 / 100.0) as decimal(11,6)) AS agg4#91]
 
 (51) Scan parquet spark_catalog.default.store_sales
-Output [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Output [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#8), dynamicpruningexpression(ss_sold_date_sk#8 IN dynamicpruning#9)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#99), dynamicpruningexpression(ss_sold_date_sk#99 IN dynamicpruning#9)]
 PushedFilters: [IsNotNull(ss_cdemo_sk), IsNotNull(ss_store_sk), IsNotNull(ss_item_sk)]
 ReadSchema: struct<ss_item_sk:int,ss_cdemo_sk:int,ss_store_sk:int,ss_quantity:int,ss_list_price:decimal(7,2),ss_sales_price:decimal(7,2),ss_coupon_amt:decimal(7,2)>
 
 (52) ColumnarToRow [codegen id : 17]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Input [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
 
 (53) Filter [codegen id : 17]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Condition : ((isnotnull(ss_cdemo_sk#2) AND isnotnull(ss_store_sk#3)) AND isnotnull(ss_item_sk#1))
+Input [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
+Condition : ((isnotnull(ss_cdemo_sk#93) AND isnotnull(ss_store_sk#94)) AND isnotnull(ss_item_sk#92))
 
 (54) ReusedExchange [Reuses operator id: 8]
-Output [1]: [cd_demo_sk#10]
+Output [1]: [cd_demo_sk#100]
 
 (55) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#10]
+Left keys [1]: [ss_cdemo_sk#93]
+Right keys [1]: [cd_demo_sk#100]
 Join type: Inner
 Join condition: None
 
 (56) Project [codegen id : 17]
-Output [7]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Input [9]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, cd_demo_sk#10]
+Output [7]: [ss_item_sk#92, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
+Input [9]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99, cd_demo_sk#100]
 
 (57) ReusedExchange [Reuses operator id: 39]
-Output [1]: [s_store_sk#15]
+Output [1]: [s_store_sk#101]
 
 (58) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#15]
+Left keys [1]: [ss_store_sk#94]
+Right keys [1]: [s_store_sk#101]
 Join type: Inner
 Join condition: None
 
 (59) Project [codegen id : 17]
-Output [6]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Input [8]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, s_store_sk#15]
+Output [6]: [ss_item_sk#92, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
+Input [8]: [ss_item_sk#92, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99, s_store_sk#101]
 
 (60) ReusedExchange [Reuses operator id: 78]
-Output [1]: [d_date_sk#14]
+Output [1]: [d_date_sk#102]
 
 (61) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_sold_date_sk#8]
-Right keys [1]: [d_date_sk#14]
+Left keys [1]: [ss_sold_date_sk#99]
+Right keys [1]: [d_date_sk#102]
 Join type: Inner
 Join condition: None
 
 (62) Project [codegen id : 17]
-Output [5]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [7]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, d_date_sk#14]
+Output [5]: [ss_item_sk#92, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98]
+Input [7]: [ss_item_sk#92, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99, d_date_sk#102]
 
 (63) Scan parquet spark_catalog.default.item
-Output [1]: [i_item_sk#17]
+Output [1]: [i_item_sk#103]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/item]
 PushedFilters: [IsNotNull(i_item_sk)]
 ReadSchema: struct<i_item_sk:int>
 
 (64) ColumnarToRow [codegen id : 16]
-Input [1]: [i_item_sk#17]
+Input [1]: [i_item_sk#103]
 
 (65) Filter [codegen id : 16]
-Input [1]: [i_item_sk#17]
-Condition : isnotnull(i_item_sk#17)
+Input [1]: [i_item_sk#103]
+Condition : isnotnull(i_item_sk#103)
 
 (66) BroadcastExchange
-Input [1]: [i_item_sk#17]
+Input [1]: [i_item_sk#103]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7]
 
 (67) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#17]
+Left keys [1]: [ss_item_sk#92]
+Right keys [1]: [i_item_sk#103]
 Join type: Inner
 Join condition: None
 
 (68) Project [codegen id : 17]
-Output [4]: [ss_quantity#4 AS agg1#19, ss_list_price#5 AS agg2#20, ss_coupon_amt#7 AS agg3#21, ss_sales_price#6 AS agg4#22]
-Input [6]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, i_item_sk#17]
+Output [4]: [ss_quantity#95 AS agg1#104, ss_list_price#96 AS agg2#105, ss_coupon_amt#98 AS agg3#106, ss_sales_price#97 AS agg4#107]
+Input [6]: [ss_item_sk#92, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, i_item_sk#103]
 
 (69) HashAggregate [codegen id : 17]
-Input [4]: [agg1#19, agg2#20, agg3#21, agg4#22]
+Input [4]: [agg1#104, agg2#105, agg3#106, agg4#107]
 Keys: []
-Functions [4]: [partial_avg(agg1#19), partial_avg(UnscaledValue(agg2#20)), partial_avg(UnscaledValue(agg3#21)), partial_avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [8]: [sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
-Results [8]: [sum#82, count#83, sum#84, count#85, sum#86, count#87, sum#88, count#89]
+Functions [4]: [partial_avg(agg1#104), partial_avg(UnscaledValue(agg2#105)), partial_avg(UnscaledValue(agg3#106)), partial_avg(UnscaledValue(agg4#107))]
+Aggregate Attributes [8]: [sum#108, count#109, sum#110, count#111, sum#112, count#113, sum#114, count#115]
+Results [8]: [sum#116, count#117, sum#118, count#119, sum#120, count#121, sum#122, count#123]
 
 (70) Exchange
-Input [8]: [sum#82, count#83, sum#84, count#85, sum#86, count#87, sum#88, count#89]
+Input [8]: [sum#116, count#117, sum#118, count#119, sum#120, count#121, sum#122, count#123]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=8]
 
 (71) HashAggregate [codegen id : 18]
-Input [8]: [sum#82, count#83, sum#84, count#85, sum#86, count#87, sum#88, count#89]
+Input [8]: [sum#116, count#117, sum#118, count#119, sum#120, count#121, sum#122, count#123]
 Keys: []
-Functions [4]: [avg(agg1#19), avg(UnscaledValue(agg2#20)), avg(UnscaledValue(agg3#21)), avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [4]: [avg(agg1#19)#90, avg(UnscaledValue(agg2#20))#91, avg(UnscaledValue(agg3#21))#92, avg(UnscaledValue(agg4#22))#93]
-Results [7]: [null AS i_item_id#94, null AS s_state#95, 1 AS g_state#96, avg(agg1#19)#90 AS agg1#97, cast((avg(UnscaledValue(agg2#20))#91 / 100.0) as decimal(11,6)) AS agg2#98, cast((avg(UnscaledValue(agg3#21))#92 / 100.0) as decimal(11,6)) AS agg3#99, cast((avg(UnscaledValue(agg4#22))#93 / 100.0) as decimal(11,6)) AS agg4#100]
+Functions [4]: [avg(agg1#104), avg(UnscaledValue(agg2#105)), avg(UnscaledValue(agg3#106)), avg(UnscaledValue(agg4#107))]
+Aggregate Attributes [4]: [avg(agg1#104)#124, avg(UnscaledValue(agg2#105))#125, avg(UnscaledValue(agg3#106))#126, avg(UnscaledValue(agg4#107))#127]
+Results [7]: [null AS i_item_id#128, null AS s_state#129, 1 AS g_state#130, avg(agg1#104)#124 AS agg1#131, cast((avg(UnscaledValue(agg2#105))#125 / 100.0) as decimal(11,6)) AS agg2#132, cast((avg(UnscaledValue(agg3#106))#126 / 100.0) as decimal(11,6)) AS agg3#133, cast((avg(UnscaledValue(agg4#107))#127 / 100.0) as decimal(11,6)) AS agg4#134]
 
 (72) Union
 
@@ -429,29 +429,29 @@ BroadcastExchange (78)
 
 
 (74) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#14, d_year#101]
+Output [2]: [d_date_sk#14, d_year#135]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1998), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (75) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#14, d_year#101]
+Input [2]: [d_date_sk#14, d_year#135]
 
 (76) Filter [codegen id : 1]
-Input [2]: [d_date_sk#14, d_year#101]
-Condition : ((isnotnull(d_year#101) AND (d_year#101 = 1998)) AND isnotnull(d_date_sk#14))
+Input [2]: [d_date_sk#14, d_year#135]
+Condition : ((isnotnull(d_year#135) AND (d_year#135 = 1998)) AND isnotnull(d_date_sk#14))
 
 (77) Project [codegen id : 1]
 Output [1]: [d_date_sk#14]
-Input [2]: [d_date_sk#14, d_year#101]
+Input [2]: [d_date_sk#14, d_year#135]
 
 (78) BroadcastExchange
 Input [1]: [d_date_sk#14]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=9]
 
-Subquery:2 Hosting operator id = 29 Hosting Expression = ss_sold_date_sk#8 IN dynamicpruning#9
+Subquery:2 Hosting operator id = 29 Hosting Expression = ss_sold_date_sk#55 IN dynamicpruning#9
 
-Subquery:3 Hosting operator id = 51 Hosting Expression = ss_sold_date_sk#8 IN dynamicpruning#9
+Subquery:3 Hosting operator id = 51 Hosting Expression = ss_sold_date_sk#99 IN dynamicpruning#9
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q27a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q27a/explain.txt
index cefd0ac0415..0e166e1cd35 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q27a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q27a/explain.txt
@@ -209,208 +209,208 @@ Aggregate Attributes [4]: [avg(agg1#19)#39, avg(UnscaledValue(agg2#20))#40, avg(
 Results [7]: [i_item_id#18, s_state#16, 0 AS g_state#43, avg(agg1#19)#39 AS agg1#44, cast((avg(UnscaledValue(agg2#20))#40 / 100.0) as decimal(11,6)) AS agg2#45, cast((avg(UnscaledValue(agg3#21))#41 / 100.0) as decimal(11,6)) AS agg3#46, cast((avg(UnscaledValue(agg4#22))#42 / 100.0) as decimal(11,6)) AS agg4#47]
 
 (29) Scan parquet spark_catalog.default.store_sales
-Output [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Output [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#8), dynamicpruningexpression(ss_sold_date_sk#8 IN dynamicpruning#9)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#55), dynamicpruningexpression(ss_sold_date_sk#55 IN dynamicpruning#9)]
 PushedFilters: [IsNotNull(ss_cdemo_sk), IsNotNull(ss_store_sk), IsNotNull(ss_item_sk)]
 ReadSchema: struct<ss_item_sk:int,ss_cdemo_sk:int,ss_store_sk:int,ss_quantity:int,ss_list_price:decimal(7,2),ss_sales_price:decimal(7,2),ss_coupon_amt:decimal(7,2)>
 
 (30) ColumnarToRow [codegen id : 11]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Input [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
 
 (31) Filter [codegen id : 11]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Condition : ((isnotnull(ss_cdemo_sk#2) AND isnotnull(ss_store_sk#3)) AND isnotnull(ss_item_sk#1))
+Input [8]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
+Condition : ((isnotnull(ss_cdemo_sk#49) AND isnotnull(ss_store_sk#50)) AND isnotnull(ss_item_sk#48))
 
 (32) ReusedExchange [Reuses operator id: 8]
-Output [1]: [cd_demo_sk#10]
+Output [1]: [cd_demo_sk#56]
 
 (33) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#10]
+Left keys [1]: [ss_cdemo_sk#49]
+Right keys [1]: [cd_demo_sk#56]
 Join type: Inner
 Join condition: None
 
 (34) Project [codegen id : 11]
-Output [7]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Input [9]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, cd_demo_sk#10]
+Output [7]: [ss_item_sk#48, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55]
+Input [9]: [ss_item_sk#48, ss_cdemo_sk#49, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55, cd_demo_sk#56]
 
 (35) ReusedExchange [Reuses operator id: 78]
-Output [1]: [d_date_sk#14]
+Output [1]: [d_date_sk#57]
 
 (36) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_sold_date_sk#8]
-Right keys [1]: [d_date_sk#14]
+Left keys [1]: [ss_sold_date_sk#55]
+Right keys [1]: [d_date_sk#57]
 Join type: Inner
 Join condition: None
 
 (37) Project [codegen id : 11]
-Output [6]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [8]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, d_date_sk#14]
+Output [6]: [ss_item_sk#48, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54]
+Input [8]: [ss_item_sk#48, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, ss_sold_date_sk#55, d_date_sk#57]
 
 (38) Scan parquet spark_catalog.default.store
-Output [2]: [s_store_sk#15, s_state#16]
+Output [2]: [s_store_sk#58, s_state#59]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/store]
 PushedFilters: [IsNotNull(s_state), EqualTo(s_state,TN), IsNotNull(s_store_sk)]
 ReadSchema: struct<s_store_sk:int,s_state:string>
 
 (39) ColumnarToRow [codegen id : 9]
-Input [2]: [s_store_sk#15, s_state#16]
+Input [2]: [s_store_sk#58, s_state#59]
 
 (40) Filter [codegen id : 9]
-Input [2]: [s_store_sk#15, s_state#16]
-Condition : ((isnotnull(s_state#16) AND (s_state#16 = TN)) AND isnotnull(s_store_sk#15))
+Input [2]: [s_store_sk#58, s_state#59]
+Condition : ((isnotnull(s_state#59) AND (s_state#59 = TN)) AND isnotnull(s_store_sk#58))
 
 (41) Project [codegen id : 9]
-Output [1]: [s_store_sk#15]
-Input [2]: [s_store_sk#15, s_state#16]
+Output [1]: [s_store_sk#58]
+Input [2]: [s_store_sk#58, s_state#59]
 
 (42) BroadcastExchange
-Input [1]: [s_store_sk#15]
+Input [1]: [s_store_sk#58]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5]
 
 (43) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#15]
+Left keys [1]: [ss_store_sk#50]
+Right keys [1]: [s_store_sk#58]
 Join type: Inner
 Join condition: None
 
 (44) Project [codegen id : 11]
-Output [5]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [7]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, s_store_sk#15]
+Output [5]: [ss_item_sk#48, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54]
+Input [7]: [ss_item_sk#48, ss_store_sk#50, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, s_store_sk#58]
 
 (45) ReusedExchange [Reuses operator id: 23]
-Output [2]: [i_item_sk#17, i_item_id#18]
+Output [2]: [i_item_sk#60, i_item_id#61]
 
 (46) BroadcastHashJoin [codegen id : 11]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#17]
+Left keys [1]: [ss_item_sk#48]
+Right keys [1]: [i_item_sk#60]
 Join type: Inner
 Join condition: None
 
 (47) Project [codegen id : 11]
-Output [5]: [i_item_id#18, ss_quantity#4 AS agg1#19, ss_list_price#5 AS agg2#20, ss_coupon_amt#7 AS agg3#21, ss_sales_price#6 AS agg4#22]
-Input [7]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, i_item_sk#17, i_item_id#18]
+Output [5]: [i_item_id#61, ss_quantity#51 AS agg1#62, ss_list_price#52 AS agg2#63, ss_coupon_amt#54 AS agg3#64, ss_sales_price#53 AS agg4#65]
+Input [7]: [ss_item_sk#48, ss_quantity#51, ss_list_price#52, ss_sales_price#53, ss_coupon_amt#54, i_item_sk#60, i_item_id#61]
 
 (48) HashAggregate [codegen id : 11]
-Input [5]: [i_item_id#18, agg1#19, agg2#20, agg3#21, agg4#22]
-Keys [1]: [i_item_id#18]
-Functions [4]: [partial_avg(agg1#19), partial_avg(UnscaledValue(agg2#20)), partial_avg(UnscaledValue(agg3#21)), partial_avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [8]: [sum#48, count#49, sum#50, count#51, sum#52, count#53, sum#54, count#55]
-Results [9]: [i_item_id#18, sum#56, count#57, sum#58, count#59, sum#60, count#61, sum#62, count#63]
+Input [5]: [i_item_id#61, agg1#62, agg2#63, agg3#64, agg4#65]
+Keys [1]: [i_item_id#61]
+Functions [4]: [partial_avg(agg1#62), partial_avg(UnscaledValue(agg2#63)), partial_avg(UnscaledValue(agg3#64)), partial_avg(UnscaledValue(agg4#65))]
+Aggregate Attributes [8]: [sum#66, count#67, sum#68, count#69, sum#70, count#71, sum#72, count#73]
+Results [9]: [i_item_id#61, sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
 
 (49) Exchange
-Input [9]: [i_item_id#18, sum#56, count#57, sum#58, count#59, sum#60, count#61, sum#62, count#63]
-Arguments: hashpartitioning(i_item_id#18, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [9]: [i_item_id#61, sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
+Arguments: hashpartitioning(i_item_id#61, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (50) HashAggregate [codegen id : 12]
-Input [9]: [i_item_id#18, sum#56, count#57, sum#58, count#59, sum#60, count#61, sum#62, count#63]
-Keys [1]: [i_item_id#18]
-Functions [4]: [avg(agg1#19), avg(UnscaledValue(agg2#20)), avg(UnscaledValue(agg3#21)), avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [4]: [avg(agg1#19)#64, avg(UnscaledValue(agg2#20))#65, avg(UnscaledValue(agg3#21))#66, avg(UnscaledValue(agg4#22))#67]
-Results [7]: [i_item_id#18, null AS s_state#68, 1 AS g_state#69, avg(agg1#19)#64 AS agg1#70, cast((avg(UnscaledValue(agg2#20))#65 / 100.0) as decimal(11,6)) AS agg2#71, cast((avg(UnscaledValue(agg3#21))#66 / 100.0) as decimal(11,6)) AS agg3#72, cast((avg(UnscaledValue(agg4#22))#67 / 100.0) as decimal(11,6)) AS agg4#73]
+Input [9]: [i_item_id#61, sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
+Keys [1]: [i_item_id#61]
+Functions [4]: [avg(agg1#62), avg(UnscaledValue(agg2#63)), avg(UnscaledValue(agg3#64)), avg(UnscaledValue(agg4#65))]
+Aggregate Attributes [4]: [avg(agg1#62)#82, avg(UnscaledValue(agg2#63))#83, avg(UnscaledValue(agg3#64))#84, avg(UnscaledValue(agg4#65))#85]
+Results [7]: [i_item_id#61, null AS s_state#86, 1 AS g_state#87, avg(agg1#62)#82 AS agg1#88, cast((avg(UnscaledValue(agg2#63))#83 / 100.0) as decimal(11,6)) AS agg2#89, cast((avg(UnscaledValue(agg3#64))#84 / 100.0) as decimal(11,6)) AS agg3#90, cast((avg(UnscaledValue(agg4#65))#85 / 100.0) as decimal(11,6)) AS agg4#91]
 
 (51) Scan parquet spark_catalog.default.store_sales
-Output [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Output [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#8), dynamicpruningexpression(ss_sold_date_sk#8 IN dynamicpruning#9)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#99), dynamicpruningexpression(ss_sold_date_sk#99 IN dynamicpruning#9)]
 PushedFilters: [IsNotNull(ss_cdemo_sk), IsNotNull(ss_store_sk), IsNotNull(ss_item_sk)]
 ReadSchema: struct<ss_item_sk:int,ss_cdemo_sk:int,ss_store_sk:int,ss_quantity:int,ss_list_price:decimal(7,2),ss_sales_price:decimal(7,2),ss_coupon_amt:decimal(7,2)>
 
 (52) ColumnarToRow [codegen id : 17]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
+Input [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
 
 (53) Filter [codegen id : 17]
-Input [8]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Condition : ((isnotnull(ss_cdemo_sk#2) AND isnotnull(ss_store_sk#3)) AND isnotnull(ss_item_sk#1))
+Input [8]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
+Condition : ((isnotnull(ss_cdemo_sk#93) AND isnotnull(ss_store_sk#94)) AND isnotnull(ss_item_sk#92))
 
 (54) ReusedExchange [Reuses operator id: 8]
-Output [1]: [cd_demo_sk#10]
+Output [1]: [cd_demo_sk#100]
 
 (55) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_cdemo_sk#2]
-Right keys [1]: [cd_demo_sk#10]
+Left keys [1]: [ss_cdemo_sk#93]
+Right keys [1]: [cd_demo_sk#100]
 Join type: Inner
 Join condition: None
 
 (56) Project [codegen id : 17]
-Output [7]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8]
-Input [9]: [ss_item_sk#1, ss_cdemo_sk#2, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, cd_demo_sk#10]
+Output [7]: [ss_item_sk#92, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99]
+Input [9]: [ss_item_sk#92, ss_cdemo_sk#93, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99, cd_demo_sk#100]
 
 (57) ReusedExchange [Reuses operator id: 78]
-Output [1]: [d_date_sk#14]
+Output [1]: [d_date_sk#101]
 
 (58) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_sold_date_sk#8]
-Right keys [1]: [d_date_sk#14]
+Left keys [1]: [ss_sold_date_sk#99]
+Right keys [1]: [d_date_sk#101]
 Join type: Inner
 Join condition: None
 
 (59) Project [codegen id : 17]
-Output [6]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [8]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, ss_sold_date_sk#8, d_date_sk#14]
+Output [6]: [ss_item_sk#92, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98]
+Input [8]: [ss_item_sk#92, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, ss_sold_date_sk#99, d_date_sk#101]
 
 (60) ReusedExchange [Reuses operator id: 42]
-Output [1]: [s_store_sk#15]
+Output [1]: [s_store_sk#102]
 
 (61) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_store_sk#3]
-Right keys [1]: [s_store_sk#15]
+Left keys [1]: [ss_store_sk#94]
+Right keys [1]: [s_store_sk#102]
 Join type: Inner
 Join condition: None
 
 (62) Project [codegen id : 17]
-Output [5]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7]
-Input [7]: [ss_item_sk#1, ss_store_sk#3, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, s_store_sk#15]
+Output [5]: [ss_item_sk#92, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98]
+Input [7]: [ss_item_sk#92, ss_store_sk#94, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, s_store_sk#102]
 
 (63) Scan parquet spark_catalog.default.item
-Output [1]: [i_item_sk#17]
+Output [1]: [i_item_sk#103]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/item]
 PushedFilters: [IsNotNull(i_item_sk)]
 ReadSchema: struct<i_item_sk:int>
 
 (64) ColumnarToRow [codegen id : 16]
-Input [1]: [i_item_sk#17]
+Input [1]: [i_item_sk#103]
 
 (65) Filter [codegen id : 16]
-Input [1]: [i_item_sk#17]
-Condition : isnotnull(i_item_sk#17)
+Input [1]: [i_item_sk#103]
+Condition : isnotnull(i_item_sk#103)
 
 (66) BroadcastExchange
-Input [1]: [i_item_sk#17]
+Input [1]: [i_item_sk#103]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7]
 
 (67) BroadcastHashJoin [codegen id : 17]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#17]
+Left keys [1]: [ss_item_sk#92]
+Right keys [1]: [i_item_sk#103]
 Join type: Inner
 Join condition: None
 
 (68) Project [codegen id : 17]
-Output [4]: [ss_quantity#4 AS agg1#19, ss_list_price#5 AS agg2#20, ss_coupon_amt#7 AS agg3#21, ss_sales_price#6 AS agg4#22]
-Input [6]: [ss_item_sk#1, ss_quantity#4, ss_list_price#5, ss_sales_price#6, ss_coupon_amt#7, i_item_sk#17]
+Output [4]: [ss_quantity#95 AS agg1#104, ss_list_price#96 AS agg2#105, ss_coupon_amt#98 AS agg3#106, ss_sales_price#97 AS agg4#107]
+Input [6]: [ss_item_sk#92, ss_quantity#95, ss_list_price#96, ss_sales_price#97, ss_coupon_amt#98, i_item_sk#103]
 
 (69) HashAggregate [codegen id : 17]
-Input [4]: [agg1#19, agg2#20, agg3#21, agg4#22]
+Input [4]: [agg1#104, agg2#105, agg3#106, agg4#107]
 Keys: []
-Functions [4]: [partial_avg(agg1#19), partial_avg(UnscaledValue(agg2#20)), partial_avg(UnscaledValue(agg3#21)), partial_avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [8]: [sum#74, count#75, sum#76, count#77, sum#78, count#79, sum#80, count#81]
-Results [8]: [sum#82, count#83, sum#84, count#85, sum#86, count#87, sum#88, count#89]
+Functions [4]: [partial_avg(agg1#104), partial_avg(UnscaledValue(agg2#105)), partial_avg(UnscaledValue(agg3#106)), partial_avg(UnscaledValue(agg4#107))]
+Aggregate Attributes [8]: [sum#108, count#109, sum#110, count#111, sum#112, count#113, sum#114, count#115]
+Results [8]: [sum#116, count#117, sum#118, count#119, sum#120, count#121, sum#122, count#123]
 
 (70) Exchange
-Input [8]: [sum#82, count#83, sum#84, count#85, sum#86, count#87, sum#88, count#89]
+Input [8]: [sum#116, count#117, sum#118, count#119, sum#120, count#121, sum#122, count#123]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=8]
 
 (71) HashAggregate [codegen id : 18]
-Input [8]: [sum#82, count#83, sum#84, count#85, sum#86, count#87, sum#88, count#89]
+Input [8]: [sum#116, count#117, sum#118, count#119, sum#120, count#121, sum#122, count#123]
 Keys: []
-Functions [4]: [avg(agg1#19), avg(UnscaledValue(agg2#20)), avg(UnscaledValue(agg3#21)), avg(UnscaledValue(agg4#22))]
-Aggregate Attributes [4]: [avg(agg1#19)#90, avg(UnscaledValue(agg2#20))#91, avg(UnscaledValue(agg3#21))#92, avg(UnscaledValue(agg4#22))#93]
-Results [7]: [null AS i_item_id#94, null AS s_state#95, 1 AS g_state#96, avg(agg1#19)#90 AS agg1#97, cast((avg(UnscaledValue(agg2#20))#91 / 100.0) as decimal(11,6)) AS agg2#98, cast((avg(UnscaledValue(agg3#21))#92 / 100.0) as decimal(11,6)) AS agg3#99, cast((avg(UnscaledValue(agg4#22))#93 / 100.0) as decimal(11,6)) AS agg4#100]
+Functions [4]: [avg(agg1#104), avg(UnscaledValue(agg2#105)), avg(UnscaledValue(agg3#106)), avg(UnscaledValue(agg4#107))]
+Aggregate Attributes [4]: [avg(agg1#104)#124, avg(UnscaledValue(agg2#105))#125, avg(UnscaledValue(agg3#106))#126, avg(UnscaledValue(agg4#107))#127]
+Results [7]: [null AS i_item_id#128, null AS s_state#129, 1 AS g_state#130, avg(agg1#104)#124 AS agg1#131, cast((avg(UnscaledValue(agg2#105))#125 / 100.0) as decimal(11,6)) AS agg2#132, cast((avg(UnscaledValue(agg3#106))#126 / 100.0) as decimal(11,6)) AS agg3#133, cast((avg(UnscaledValue(agg4#107))#127 / 100.0) as decimal(11,6)) AS agg4#134]
 
 (72) Union
 
@@ -429,29 +429,29 @@ BroadcastExchange (78)
 
 
 (74) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#14, d_year#101]
+Output [2]: [d_date_sk#14, d_year#135]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1998), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (75) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#14, d_year#101]
+Input [2]: [d_date_sk#14, d_year#135]
 
 (76) Filter [codegen id : 1]
-Input [2]: [d_date_sk#14, d_year#101]
-Condition : ((isnotnull(d_year#101) AND (d_year#101 = 1998)) AND isnotnull(d_date_sk#14))
+Input [2]: [d_date_sk#14, d_year#135]
+Condition : ((isnotnull(d_year#135) AND (d_year#135 = 1998)) AND isnotnull(d_date_sk#14))
 
 (77) Project [codegen id : 1]
 Output [1]: [d_date_sk#14]
-Input [2]: [d_date_sk#14, d_year#101]
+Input [2]: [d_date_sk#14, d_year#135]
 
 (78) BroadcastExchange
 Input [1]: [d_date_sk#14]
 Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=9]
 
-Subquery:2 Hosting operator id = 29 Hosting Expression = ss_sold_date_sk#8 IN dynamicpruning#9
+Subquery:2 Hosting operator id = 29 Hosting Expression = ss_sold_date_sk#55 IN dynamicpruning#9
 
-Subquery:3 Hosting operator id = 51 Hosting Expression = ss_sold_date_sk#8 IN dynamicpruning#9
+Subquery:3 Hosting operator id = 51 Hosting Expression = ss_sold_date_sk#99 IN dynamicpruning#9
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q36a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q36a.sf100/explain.txt
index 517318536bf..033ff1940d3 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q36a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q36a.sf100/explain.txt
@@ -149,60 +149,60 @@ Aggregate Attributes [2]: [sum(UnscaledValue(ss_net_profit#4))#17, sum(UnscaledV
 Results [6]: [cast((MakeDecimal(sum(UnscaledValue(ss_net_profit#4))#17,17,2) / MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#3))#18,17,2)) as decimal(38,20)) AS gross_margin#19, i_category#12, i_class#11, 0 AS t_category#20, 0 AS t_class#21, 0 AS lochierarchy#22]
 
 (23) ReusedExchange [Reuses operator id: 21]
-Output [4]: [i_category#12, i_class#11, sum#23, sum#24]
+Output [4]: [i_category#23, i_class#24, sum#25, sum#26]
 
 (24) HashAggregate [codegen id : 10]
-Input [4]: [i_category#12, i_class#11, sum#23, sum#24]
-Keys [2]: [i_category#12, i_class#11]
-Functions [2]: [sum(UnscaledValue(ss_net_profit#4)), sum(UnscaledValue(ss_ext_sales_price#3))]
-Aggregate Attributes [2]: [sum(UnscaledValue(ss_net_profit#4))#25, sum(UnscaledValue(ss_ext_sales_price#3))#26]
-Results [3]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#4))#25,17,2) AS ss_net_profit#27, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#3))#26,17,2) AS ss_ext_sales_price#28, i_category#12]
+Input [4]: [i_category#23, i_class#24, sum#25, sum#26]
+Keys [2]: [i_category#23, i_class#24]
+Functions [2]: [sum(UnscaledValue(ss_net_profit#27)), sum(UnscaledValue(ss_ext_sales_price#28))]
+Aggregate Attributes [2]: [sum(UnscaledValue(ss_net_profit#27))#29, sum(UnscaledValue(ss_ext_sales_price#28))#30]
+Results [3]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#27))#29,17,2) AS ss_net_profit#31, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#28))#30,17,2) AS ss_ext_sales_price#32, i_category#23]
 
 (25) HashAggregate [codegen id : 10]
-Input [3]: [ss_net_profit#27, ss_ext_sales_price#28, i_category#12]
-Keys [1]: [i_category#12]
-Functions [2]: [partial_sum(ss_net_profit#27), partial_sum(ss_ext_sales_price#28)]
-Aggregate Attributes [4]: [sum#29, isEmpty#30, sum#31, isEmpty#32]
-Results [5]: [i_category#12, sum#33, isEmpty#34, sum#35, isEmpty#36]
+Input [3]: [ss_net_profit#31, ss_ext_sales_price#32, i_category#23]
+Keys [1]: [i_category#23]
+Functions [2]: [partial_sum(ss_net_profit#31), partial_sum(ss_ext_sales_price#32)]
+Aggregate Attributes [4]: [sum#33, isEmpty#34, sum#35, isEmpty#36]
+Results [5]: [i_category#23, sum#37, isEmpty#38, sum#39, isEmpty#40]
 
 (26) Exchange
-Input [5]: [i_category#12, sum#33, isEmpty#34, sum#35, isEmpty#36]
-Arguments: hashpartitioning(i_category#12, 5), ENSURE_REQUIREMENTS, [plan_id=4]
+Input [5]: [i_category#23, sum#37, isEmpty#38, sum#39, isEmpty#40]
+Arguments: hashpartitioning(i_category#23, 5), ENSURE_REQUIREMENTS, [plan_id=4]
 
 (27) HashAggregate [codegen id : 11]
-Input [5]: [i_category#12, sum#33, isEmpty#34, sum#35, isEmpty#36]
-Keys [1]: [i_category#12]
-Functions [2]: [sum(ss_net_profit#27), sum(ss_ext_sales_price#28)]
-Aggregate Attributes [2]: [sum(ss_net_profit#27)#37, sum(ss_ext_sales_price#28)#38]
-Results [6]: [cast((sum(ss_net_profit#27)#37 / sum(ss_ext_sales_price#28)#38) as decimal(38,20)) AS gross_margin#39, i_category#12, null AS i_class#40, 0 AS t_category#41, 1 AS t_class#42, 1 AS lochierarchy#43]
+Input [5]: [i_category#23, sum#37, isEmpty#38, sum#39, isEmpty#40]
+Keys [1]: [i_category#23]
+Functions [2]: [sum(ss_net_profit#31), sum(ss_ext_sales_price#32)]
+Aggregate Attributes [2]: [sum(ss_net_profit#31)#41, sum(ss_ext_sales_price#32)#42]
+Results [6]: [cast((sum(ss_net_profit#31)#41 / sum(ss_ext_sales_price#32)#42) as decimal(38,20)) AS gross_margin#43, i_category#23, null AS i_class#44, 0 AS t_category#45, 1 AS t_class#46, 1 AS lochierarchy#47]
 
 (28) ReusedExchange [Reuses operator id: 21]
-Output [4]: [i_category#12, i_class#11, sum#44, sum#45]
+Output [4]: [i_category#48, i_class#49, sum#50, sum#51]
 
 (29) HashAggregate [codegen id : 16]
-Input [4]: [i_category#12, i_class#11, sum#44, sum#45]
-Keys [2]: [i_category#12, i_class#11]
-Functions [2]: [sum(UnscaledValue(ss_net_profit#4)), sum(UnscaledValue(ss_ext_sales_price#3))]
-Aggregate Attributes [2]: [sum(UnscaledValue(ss_net_profit#4))#25, sum(UnscaledValue(ss_ext_sales_price#3))#26]
-Results [2]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#4))#25,17,2) AS ss_net_profit#27, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#3))#26,17,2) AS ss_ext_sales_price#28]
+Input [4]: [i_category#48, i_class#49, sum#50, sum#51]
+Keys [2]: [i_category#48, i_class#49]
+Functions [2]: [sum(UnscaledValue(ss_net_profit#52)), sum(UnscaledValue(ss_ext_sales_price#53))]
+Aggregate Attributes [2]: [sum(UnscaledValue(ss_net_profit#52))#29, sum(UnscaledValue(ss_ext_sales_price#53))#30]
+Results [2]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#52))#29,17,2) AS ss_net_profit#54, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#53))#30,17,2) AS ss_ext_sales_price#55]
 
 (30) HashAggregate [codegen id : 16]
-Input [2]: [ss_net_profit#27, ss_ext_sales_price#28]
+Input [2]: [ss_net_profit#54, ss_ext_sales_price#55]
 Keys: []
-Functions [2]: [partial_sum(ss_net_profit#27), partial_sum(ss_ext_sales_price#28)]
-Aggregate Attributes [4]: [sum#46, isEmpty#47, sum#48, isEmpty#49]
-Results [4]: [sum#50, isEmpty#51, sum#52, isEmpty#53]
+Functions [2]: [partial_sum(ss_net_profit#54), partial_sum(ss_ext_sales_price#55)]
+Aggregate Attributes [4]: [sum#56, isEmpty#57, sum#58, isEmpty#59]
+Results [4]: [sum#60, isEmpty#61, sum#62, isEmpty#63]
 
 (31) Exchange
-Input [4]: [sum#50, isEmpty#51, sum#52, isEmpty#53]
+Input [4]: [sum#60, isEmpty#61, sum#62, isEmpty#63]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=5]
 
 (32) HashAggregate [codegen id : 17]
-Input [4]: [sum#50, isEmpty#51, sum#52, isEmpty#53]
+Input [4]: [sum#60, isEmpty#61, sum#62, isEmpty#63]
 Keys: []
-Functions [2]: [sum(ss_net_profit#27), sum(ss_ext_sales_price#28)]
-Aggregate Attributes [2]: [sum(ss_net_profit#27)#54, sum(ss_ext_sales_price#28)#55]
-Results [6]: [cast((sum(ss_net_profit#27)#54 / sum(ss_ext_sales_price#28)#55) as decimal(38,20)) AS gross_margin#56, null AS i_category#57, null AS i_class#58, 1 AS t_category#59, 1 AS t_class#60, 2 AS lochierarchy#61]
+Functions [2]: [sum(ss_net_profit#54), sum(ss_ext_sales_price#55)]
+Aggregate Attributes [2]: [sum(ss_net_profit#54)#64, sum(ss_ext_sales_price#55)#65]
+Results [6]: [cast((sum(ss_net_profit#54)#64 / sum(ss_ext_sales_price#55)#65) as decimal(38,20)) AS gross_margin#66, null AS i_category#67, null AS i_class#68, 1 AS t_category#69, 1 AS t_class#70, 2 AS lochierarchy#71]
 
 (33) Union
 
@@ -222,27 +222,27 @@ Input [6]: [gross_margin#19, i_category#12, i_class#11, t_category#20, t_class#2
 Keys [6]: [gross_margin#19, i_category#12, i_class#11, t_category#20, t_class#21, lochierarchy#22]
 Functions: []
 Aggregate Attributes: []
-Results [5]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, CASE WHEN (t_class#21 = 0) THEN i_category#12 END AS _w0#62]
+Results [5]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, CASE WHEN (t_class#21 = 0) THEN i_category#12 END AS _w0#72]
 
 (37) Exchange
-Input [5]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, _w0#62]
-Arguments: hashpartitioning(lochierarchy#22, _w0#62, 5), ENSURE_REQUIREMENTS, [plan_id=7]
+Input [5]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, _w0#72]
+Arguments: hashpartitioning(lochierarchy#22, _w0#72, 5), ENSURE_REQUIREMENTS, [plan_id=7]
 
 (38) Sort [codegen id : 20]
-Input [5]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, _w0#62]
-Arguments: [lochierarchy#22 ASC NULLS FIRST, _w0#62 ASC NULLS FIRST, gross_margin#19 ASC NULLS FIRST], false, 0
+Input [5]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, _w0#72]
+Arguments: [lochierarchy#22 ASC NULLS FIRST, _w0#72 ASC NULLS FIRST, gross_margin#19 ASC NULLS FIRST], false, 0
 
 (39) Window
-Input [5]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, _w0#62]
-Arguments: [rank(gross_margin#19) windowspecdefinition(lochierarchy#22, _w0#62, gross_margin#19 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#63], [lochierarchy#22, _w0#62], [gross_margin#19 ASC NULLS FIRST]
+Input [5]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, _w0#72]
+Arguments: [rank(gross_margin#19) windowspecdefinition(lochierarchy#22, _w0#72, gross_margin#19 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#73], [lochierarchy#22, _w0#72], [gross_margin#19 ASC NULLS FIRST]
 
 (40) Project [codegen id : 21]
-Output [5]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, rank_within_parent#63]
-Input [6]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, _w0#62, rank_within_parent#63]
+Output [5]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, rank_within_parent#73]
+Input [6]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, _w0#72, rank_within_parent#73]
 
 (41) TakeOrderedAndProject
-Input [5]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, rank_within_parent#63]
-Arguments: 100, [lochierarchy#22 DESC NULLS LAST, CASE WHEN (lochierarchy#22 = 0) THEN i_category#12 END ASC NULLS FIRST, rank_within_parent#63 ASC NULLS FIRST], [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, rank_within_parent#63]
+Input [5]: [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, rank_within_parent#73]
+Arguments: 100, [lochierarchy#22 DESC NULLS LAST, CASE WHEN (lochierarchy#22 = 0) THEN i_category#12 END ASC NULLS FIRST, rank_within_parent#73 ASC NULLS FIRST], [gross_margin#19, i_category#12, i_class#11, lochierarchy#22, rank_within_parent#73]
 
 ===== Subqueries =====
 
@@ -255,22 +255,22 @@ BroadcastExchange (46)
 
 
 (42) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#7, d_year#64]
+Output [2]: [d_date_sk#7, d_year#74]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (43) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#7, d_year#64]
+Input [2]: [d_date_sk#7, d_year#74]
 
 (44) Filter [codegen id : 1]
-Input [2]: [d_date_sk#7, d_year#64]
-Condition : ((isnotnull(d_year#64) AND (d_year#64 = 2001)) AND isnotnull(d_date_sk#7))
+Input [2]: [d_date_sk#7, d_year#74]
+Condition : ((isnotnull(d_year#74) AND (d_year#74 = 2001)) AND isnotnull(d_date_sk#7))
 
 (45) Project [codegen id : 1]
 Output [1]: [d_date_sk#7]
-Input [2]: [d_date_sk#7, d_year#64]
+Input [2]: [d_date_sk#7, d_year#74]
 
 (46) BroadcastExchange
 Input [1]: [d_date_sk#7]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q36a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q36a/explain.txt
index c5de0d9042e..7c2e7d17af2 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q36a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q36a/explain.txt
@@ -149,60 +149,60 @@ Aggregate Attributes [2]: [sum(UnscaledValue(ss_net_profit#4))#17, sum(UnscaledV
 Results [6]: [cast((MakeDecimal(sum(UnscaledValue(ss_net_profit#4))#17,17,2) / MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#3))#18,17,2)) as decimal(38,20)) AS gross_margin#19, i_category#10, i_class#9, 0 AS t_category#20, 0 AS t_class#21, 0 AS lochierarchy#22]
 
 (23) ReusedExchange [Reuses operator id: 21]
-Output [4]: [i_category#10, i_class#9, sum#23, sum#24]
+Output [4]: [i_category#23, i_class#24, sum#25, sum#26]
 
 (24) HashAggregate [codegen id : 10]
-Input [4]: [i_category#10, i_class#9, sum#23, sum#24]
-Keys [2]: [i_category#10, i_class#9]
-Functions [2]: [sum(UnscaledValue(ss_net_profit#4)), sum(UnscaledValue(ss_ext_sales_price#3))]
-Aggregate Attributes [2]: [sum(UnscaledValue(ss_net_profit#4))#25, sum(UnscaledValue(ss_ext_sales_price#3))#26]
-Results [3]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#4))#25,17,2) AS ss_net_profit#27, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#3))#26,17,2) AS ss_ext_sales_price#28, i_category#10]
+Input [4]: [i_category#23, i_class#24, sum#25, sum#26]
+Keys [2]: [i_category#23, i_class#24]
+Functions [2]: [sum(UnscaledValue(ss_net_profit#27)), sum(UnscaledValue(ss_ext_sales_price#28))]
+Aggregate Attributes [2]: [sum(UnscaledValue(ss_net_profit#27))#29, sum(UnscaledValue(ss_ext_sales_price#28))#30]
+Results [3]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#27))#29,17,2) AS ss_net_profit#31, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#28))#30,17,2) AS ss_ext_sales_price#32, i_category#23]
 
 (25) HashAggregate [codegen id : 10]
-Input [3]: [ss_net_profit#27, ss_ext_sales_price#28, i_category#10]
-Keys [1]: [i_category#10]
-Functions [2]: [partial_sum(ss_net_profit#27), partial_sum(ss_ext_sales_price#28)]
-Aggregate Attributes [4]: [sum#29, isEmpty#30, sum#31, isEmpty#32]
-Results [5]: [i_category#10, sum#33, isEmpty#34, sum#35, isEmpty#36]
+Input [3]: [ss_net_profit#31, ss_ext_sales_price#32, i_category#23]
+Keys [1]: [i_category#23]
+Functions [2]: [partial_sum(ss_net_profit#31), partial_sum(ss_ext_sales_price#32)]
+Aggregate Attributes [4]: [sum#33, isEmpty#34, sum#35, isEmpty#36]
+Results [5]: [i_category#23, sum#37, isEmpty#38, sum#39, isEmpty#40]
 
 (26) Exchange
-Input [5]: [i_category#10, sum#33, isEmpty#34, sum#35, isEmpty#36]
-Arguments: hashpartitioning(i_category#10, 5), ENSURE_REQUIREMENTS, [plan_id=4]
+Input [5]: [i_category#23, sum#37, isEmpty#38, sum#39, isEmpty#40]
+Arguments: hashpartitioning(i_category#23, 5), ENSURE_REQUIREMENTS, [plan_id=4]
 
 (27) HashAggregate [codegen id : 11]
-Input [5]: [i_category#10, sum#33, isEmpty#34, sum#35, isEmpty#36]
-Keys [1]: [i_category#10]
-Functions [2]: [sum(ss_net_profit#27), sum(ss_ext_sales_price#28)]
-Aggregate Attributes [2]: [sum(ss_net_profit#27)#37, sum(ss_ext_sales_price#28)#38]
-Results [6]: [cast((sum(ss_net_profit#27)#37 / sum(ss_ext_sales_price#28)#38) as decimal(38,20)) AS gross_margin#39, i_category#10, null AS i_class#40, 0 AS t_category#41, 1 AS t_class#42, 1 AS lochierarchy#43]
+Input [5]: [i_category#23, sum#37, isEmpty#38, sum#39, isEmpty#40]
+Keys [1]: [i_category#23]
+Functions [2]: [sum(ss_net_profit#31), sum(ss_ext_sales_price#32)]
+Aggregate Attributes [2]: [sum(ss_net_profit#31)#41, sum(ss_ext_sales_price#32)#42]
+Results [6]: [cast((sum(ss_net_profit#31)#41 / sum(ss_ext_sales_price#32)#42) as decimal(38,20)) AS gross_margin#43, i_category#23, null AS i_class#44, 0 AS t_category#45, 1 AS t_class#46, 1 AS lochierarchy#47]
 
 (28) ReusedExchange [Reuses operator id: 21]
-Output [4]: [i_category#10, i_class#9, sum#44, sum#45]
+Output [4]: [i_category#48, i_class#49, sum#50, sum#51]
 
 (29) HashAggregate [codegen id : 16]
-Input [4]: [i_category#10, i_class#9, sum#44, sum#45]
-Keys [2]: [i_category#10, i_class#9]
-Functions [2]: [sum(UnscaledValue(ss_net_profit#4)), sum(UnscaledValue(ss_ext_sales_price#3))]
-Aggregate Attributes [2]: [sum(UnscaledValue(ss_net_profit#4))#25, sum(UnscaledValue(ss_ext_sales_price#3))#26]
-Results [2]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#4))#25,17,2) AS ss_net_profit#27, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#3))#26,17,2) AS ss_ext_sales_price#28]
+Input [4]: [i_category#48, i_class#49, sum#50, sum#51]
+Keys [2]: [i_category#48, i_class#49]
+Functions [2]: [sum(UnscaledValue(ss_net_profit#52)), sum(UnscaledValue(ss_ext_sales_price#53))]
+Aggregate Attributes [2]: [sum(UnscaledValue(ss_net_profit#52))#29, sum(UnscaledValue(ss_ext_sales_price#53))#30]
+Results [2]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#52))#29,17,2) AS ss_net_profit#54, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#53))#30,17,2) AS ss_ext_sales_price#55]
 
 (30) HashAggregate [codegen id : 16]
-Input [2]: [ss_net_profit#27, ss_ext_sales_price#28]
+Input [2]: [ss_net_profit#54, ss_ext_sales_price#55]
 Keys: []
-Functions [2]: [partial_sum(ss_net_profit#27), partial_sum(ss_ext_sales_price#28)]
-Aggregate Attributes [4]: [sum#46, isEmpty#47, sum#48, isEmpty#49]
-Results [4]: [sum#50, isEmpty#51, sum#52, isEmpty#53]
+Functions [2]: [partial_sum(ss_net_profit#54), partial_sum(ss_ext_sales_price#55)]
+Aggregate Attributes [4]: [sum#56, isEmpty#57, sum#58, isEmpty#59]
+Results [4]: [sum#60, isEmpty#61, sum#62, isEmpty#63]
 
 (31) Exchange
-Input [4]: [sum#50, isEmpty#51, sum#52, isEmpty#53]
+Input [4]: [sum#60, isEmpty#61, sum#62, isEmpty#63]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=5]
 
 (32) HashAggregate [codegen id : 17]
-Input [4]: [sum#50, isEmpty#51, sum#52, isEmpty#53]
+Input [4]: [sum#60, isEmpty#61, sum#62, isEmpty#63]
 Keys: []
-Functions [2]: [sum(ss_net_profit#27), sum(ss_ext_sales_price#28)]
-Aggregate Attributes [2]: [sum(ss_net_profit#27)#54, sum(ss_ext_sales_price#28)#55]
-Results [6]: [cast((sum(ss_net_profit#27)#54 / sum(ss_ext_sales_price#28)#55) as decimal(38,20)) AS gross_margin#56, null AS i_category#57, null AS i_class#58, 1 AS t_category#59, 1 AS t_class#60, 2 AS lochierarchy#61]
+Functions [2]: [sum(ss_net_profit#54), sum(ss_ext_sales_price#55)]
+Aggregate Attributes [2]: [sum(ss_net_profit#54)#64, sum(ss_ext_sales_price#55)#65]
+Results [6]: [cast((sum(ss_net_profit#54)#64 / sum(ss_ext_sales_price#55)#65) as decimal(38,20)) AS gross_margin#66, null AS i_category#67, null AS i_class#68, 1 AS t_category#69, 1 AS t_class#70, 2 AS lochierarchy#71]
 
 (33) Union
 
@@ -222,27 +222,27 @@ Input [6]: [gross_margin#19, i_category#10, i_class#9, t_category#20, t_class#21
 Keys [6]: [gross_margin#19, i_category#10, i_class#9, t_category#20, t_class#21, lochierarchy#22]
 Functions: []
 Aggregate Attributes: []
-Results [5]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, CASE WHEN (t_class#21 = 0) THEN i_category#10 END AS _w0#62]
+Results [5]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, CASE WHEN (t_class#21 = 0) THEN i_category#10 END AS _w0#72]
 
 (37) Exchange
-Input [5]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, _w0#62]
-Arguments: hashpartitioning(lochierarchy#22, _w0#62, 5), ENSURE_REQUIREMENTS, [plan_id=7]
+Input [5]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, _w0#72]
+Arguments: hashpartitioning(lochierarchy#22, _w0#72, 5), ENSURE_REQUIREMENTS, [plan_id=7]
 
 (38) Sort [codegen id : 20]
-Input [5]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, _w0#62]
-Arguments: [lochierarchy#22 ASC NULLS FIRST, _w0#62 ASC NULLS FIRST, gross_margin#19 ASC NULLS FIRST], false, 0
+Input [5]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, _w0#72]
+Arguments: [lochierarchy#22 ASC NULLS FIRST, _w0#72 ASC NULLS FIRST, gross_margin#19 ASC NULLS FIRST], false, 0
 
 (39) Window
-Input [5]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, _w0#62]
-Arguments: [rank(gross_margin#19) windowspecdefinition(lochierarchy#22, _w0#62, gross_margin#19 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#63], [lochierarchy#22, _w0#62], [gross_margin#19 ASC NULLS FIRST]
+Input [5]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, _w0#72]
+Arguments: [rank(gross_margin#19) windowspecdefinition(lochierarchy#22, _w0#72, gross_margin#19 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#73], [lochierarchy#22, _w0#72], [gross_margin#19 ASC NULLS FIRST]
 
 (40) Project [codegen id : 21]
-Output [5]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, rank_within_parent#63]
-Input [6]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, _w0#62, rank_within_parent#63]
+Output [5]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, rank_within_parent#73]
+Input [6]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, _w0#72, rank_within_parent#73]
 
 (41) TakeOrderedAndProject
-Input [5]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, rank_within_parent#63]
-Arguments: 100, [lochierarchy#22 DESC NULLS LAST, CASE WHEN (lochierarchy#22 = 0) THEN i_category#10 END ASC NULLS FIRST, rank_within_parent#63 ASC NULLS FIRST], [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, rank_within_parent#63]
+Input [5]: [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, rank_within_parent#73]
+Arguments: 100, [lochierarchy#22 DESC NULLS LAST, CASE WHEN (lochierarchy#22 = 0) THEN i_category#10 END ASC NULLS FIRST, rank_within_parent#73 ASC NULLS FIRST], [gross_margin#19, i_category#10, i_class#9, lochierarchy#22, rank_within_parent#73]
 
 ===== Subqueries =====
 
@@ -255,22 +255,22 @@ BroadcastExchange (46)
 
 
 (42) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#7, d_year#64]
+Output [2]: [d_date_sk#7, d_year#74]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_year:int>
 
 (43) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#7, d_year#64]
+Input [2]: [d_date_sk#7, d_year#74]
 
 (44) Filter [codegen id : 1]
-Input [2]: [d_date_sk#7, d_year#64]
-Condition : ((isnotnull(d_year#64) AND (d_year#64 = 2001)) AND isnotnull(d_date_sk#7))
+Input [2]: [d_date_sk#7, d_year#74]
+Condition : ((isnotnull(d_year#74) AND (d_year#74 = 2001)) AND isnotnull(d_date_sk#7))
 
 (45) Project [codegen id : 1]
 Output [1]: [d_date_sk#7]
-Input [2]: [d_date_sk#7, d_year#64]
+Input [2]: [d_date_sk#7, d_year#74]
 
 (46) BroadcastExchange
 Input [1]: [d_date_sk#7]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q5a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q5a.sf100/explain.txt
index 497fe172c9b..1b9d5f3f807 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q5a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q5a.sf100/explain.txt
@@ -479,25 +479,25 @@ Input [8]: [channel#37, id#38, sum#133, isEmpty#134, sum#135, isEmpty#136, sum#1
 Keys [2]: [channel#37, id#38]
 Functions [3]: [sum(sales#39), sum(returns#40), sum(profit#41)]
 Aggregate Attributes [3]: [sum(sales#39)#139, sum(returns#40)#140, sum(profit#41)#141]
-Results [3]: [sum(sales#39)#139 AS sales#145, sum(returns#40)#140 AS returns#146, sum(profit#41)#141 AS profit#147]
+Results [3]: [sum(sales#39)#139 AS sales#167, sum(returns#40)#140 AS returns#168, sum(profit#41)#141 AS profit#169]
 
 (83) HashAggregate [codegen id : 73]
-Input [3]: [sales#145, returns#146, profit#147]
+Input [3]: [sales#167, returns#168, profit#169]
 Keys: []
-Functions [3]: [partial_sum(sales#145), partial_sum(returns#146), partial_sum(profit#147)]
-Aggregate Attributes [6]: [sum#167, isEmpty#168, sum#169, isEmpty#170, sum#171, isEmpty#172]
-Results [6]: [sum#173, isEmpty#174, sum#175, isEmpty#176, sum#177, isEmpty#178]
+Functions [3]: [partial_sum(sales#167), partial_sum(returns#168), partial_sum(profit#169)]
+Aggregate Attributes [6]: [sum#170, isEmpty#171, sum#172, isEmpty#173, sum#174, isEmpty#175]
+Results [6]: [sum#176, isEmpty#177, sum#178, isEmpty#179, sum#180, isEmpty#181]
 
 (84) Exchange
-Input [6]: [sum#173, isEmpty#174, sum#175, isEmpty#176, sum#177, isEmpty#178]
+Input [6]: [sum#176, isEmpty#177, sum#178, isEmpty#179, sum#180, isEmpty#181]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=11]
 
 (85) HashAggregate [codegen id : 74]
-Input [6]: [sum#173, isEmpty#174, sum#175, isEmpty#176, sum#177, isEmpty#178]
+Input [6]: [sum#176, isEmpty#177, sum#178, isEmpty#179, sum#180, isEmpty#181]
 Keys: []
-Functions [3]: [sum(sales#145), sum(returns#146), sum(profit#147)]
-Aggregate Attributes [3]: [sum(sales#145)#179, sum(returns#146)#180, sum(profit#147)#181]
-Results [5]: [null AS channel#182, null AS id#183, sum(sales#145)#179 AS sum(sales)#184, sum(returns#146)#180 AS sum(returns)#185, sum(profit#147)#181 AS sum(profit)#186]
+Functions [3]: [sum(sales#167), sum(returns#168), sum(profit#169)]
+Aggregate Attributes [3]: [sum(sales#167)#182, sum(returns#168)#183, sum(profit#169)#184]
+Results [5]: [null AS channel#185, null AS id#186, sum(sales#167)#182 AS sum(sales)#187, sum(returns#168)#183 AS sum(returns)#188, sum(profit#169)#184 AS sum(profit)#189]
 
 (86) Union
 
@@ -534,22 +534,22 @@ BroadcastExchange (95)
 
 
 (91) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#24, d_date#187]
+Output [2]: [d_date_sk#24, d_date#190]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,1998-08-04), LessThanOrEqual(d_date,1998-08-18), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date>
 
 (92) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#24, d_date#187]
+Input [2]: [d_date_sk#24, d_date#190]
 
 (93) Filter [codegen id : 1]
-Input [2]: [d_date_sk#24, d_date#187]
-Condition : (((isnotnull(d_date#187) AND (d_date#187 >= 1998-08-04)) AND (d_date#187 <= 1998-08-18)) AND isnotnull(d_date_sk#24))
+Input [2]: [d_date_sk#24, d_date#190]
+Condition : (((isnotnull(d_date#190) AND (d_date#190 >= 1998-08-04)) AND (d_date#190 <= 1998-08-18)) AND isnotnull(d_date_sk#24))
 
 (94) Project [codegen id : 1]
 Output [1]: [d_date_sk#24]
-Input [2]: [d_date_sk#24, d_date#187]
+Input [2]: [d_date_sk#24, d_date#190]
 
 (95) BroadcastExchange
 Input [1]: [d_date_sk#24]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q5a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q5a/explain.txt
index 04d9e50272b..8d58ec41365 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q5a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q5a/explain.txt
@@ -464,25 +464,25 @@ Input [8]: [channel#37, id#38, sum#133, isEmpty#134, sum#135, isEmpty#136, sum#1
 Keys [2]: [channel#37, id#38]
 Functions [3]: [sum(sales#39), sum(returns#40), sum(profit#41)]
 Aggregate Attributes [3]: [sum(sales#39)#139, sum(returns#40)#140, sum(profit#41)#141]
-Results [3]: [sum(sales#39)#139 AS sales#145, sum(returns#40)#140 AS returns#146, sum(profit#41)#141 AS profit#147]
+Results [3]: [sum(sales#39)#139 AS sales#167, sum(returns#40)#140 AS returns#168, sum(profit#41)#141 AS profit#169]
 
 (80) HashAggregate [codegen id : 64]
-Input [3]: [sales#145, returns#146, profit#147]
+Input [3]: [sales#167, returns#168, profit#169]
 Keys: []
-Functions [3]: [partial_sum(sales#145), partial_sum(returns#146), partial_sum(profit#147)]
-Aggregate Attributes [6]: [sum#167, isEmpty#168, sum#169, isEmpty#170, sum#171, isEmpty#172]
-Results [6]: [sum#173, isEmpty#174, sum#175, isEmpty#176, sum#177, isEmpty#178]
+Functions [3]: [partial_sum(sales#167), partial_sum(returns#168), partial_sum(profit#169)]
+Aggregate Attributes [6]: [sum#170, isEmpty#171, sum#172, isEmpty#173, sum#174, isEmpty#175]
+Results [6]: [sum#176, isEmpty#177, sum#178, isEmpty#179, sum#180, isEmpty#181]
 
 (81) Exchange
-Input [6]: [sum#173, isEmpty#174, sum#175, isEmpty#176, sum#177, isEmpty#178]
+Input [6]: [sum#176, isEmpty#177, sum#178, isEmpty#179, sum#180, isEmpty#181]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=10]
 
 (82) HashAggregate [codegen id : 65]
-Input [6]: [sum#173, isEmpty#174, sum#175, isEmpty#176, sum#177, isEmpty#178]
+Input [6]: [sum#176, isEmpty#177, sum#178, isEmpty#179, sum#180, isEmpty#181]
 Keys: []
-Functions [3]: [sum(sales#145), sum(returns#146), sum(profit#147)]
-Aggregate Attributes [3]: [sum(sales#145)#179, sum(returns#146)#180, sum(profit#147)#181]
-Results [5]: [null AS channel#182, null AS id#183, sum(sales#145)#179 AS sum(sales)#184, sum(returns#146)#180 AS sum(returns)#185, sum(profit#147)#181 AS sum(profit)#186]
+Functions [3]: [sum(sales#167), sum(returns#168), sum(profit#169)]
+Aggregate Attributes [3]: [sum(sales#167)#182, sum(returns#168)#183, sum(profit#169)#184]
+Results [5]: [null AS channel#185, null AS id#186, sum(sales#167)#182 AS sum(sales)#187, sum(returns#168)#183 AS sum(returns)#188, sum(profit#169)#184 AS sum(profit)#189]
 
 (83) Union
 
@@ -519,22 +519,22 @@ BroadcastExchange (92)
 
 
 (88) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#22, d_date#187]
+Output [2]: [d_date_sk#22, d_date#190]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,1998-08-04), LessThanOrEqual(d_date,1998-08-18), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date>
 
 (89) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#22, d_date#187]
+Input [2]: [d_date_sk#22, d_date#190]
 
 (90) Filter [codegen id : 1]
-Input [2]: [d_date_sk#22, d_date#187]
-Condition : (((isnotnull(d_date#187) AND (d_date#187 >= 1998-08-04)) AND (d_date#187 <= 1998-08-18)) AND isnotnull(d_date_sk#22))
+Input [2]: [d_date_sk#22, d_date#190]
+Condition : (((isnotnull(d_date#190) AND (d_date#190 >= 1998-08-04)) AND (d_date#190 <= 1998-08-18)) AND isnotnull(d_date_sk#22))
 
 (91) Project [codegen id : 1]
 Output [1]: [d_date_sk#22]
-Input [2]: [d_date_sk#22, d_date#187]
+Input [2]: [d_date_sk#22, d_date#190]
 
 (92) BroadcastExchange
 Input [1]: [d_date_sk#22]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q67a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q67a.sf100/explain.txt
index 11eb66f23fc..9c28ff9f351 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q67a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q67a.sf100/explain.txt
@@ -189,228 +189,228 @@ Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 a
 Results [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, cast(sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 as decimal(38,2)) AS sumsales#23]
 
 (25) ReusedExchange [Reuses operator id: 23]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#24, isEmpty#25]
+Output [10]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, s_store_id#31, sum#32, isEmpty#33]
 
 (26) HashAggregate [codegen id : 16]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#24, isEmpty#25]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, s_store_id#31, sum#32, isEmpty#33]
+Keys [8]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, s_store_id#31]
+Functions [1]: [sum(coalesce((ss_sales_price#34 * cast(ss_quantity#35 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#34 * cast(ss_quantity#35 as decimal(10,0))), 0.00))#22]
+Results [8]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, sum(coalesce((ss_sales_price#34 * cast(ss_quantity#35 as decimal(10,0))), 0.00))#22 AS sumsales#36]
 
 (27) HashAggregate [codegen id : 16]
-Input [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, sumsales#26]
-Keys [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#27, isEmpty#28]
-Results [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, sum#29, isEmpty#30]
+Input [8]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, sumsales#36]
+Keys [7]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30]
+Functions [1]: [partial_sum(sumsales#36)]
+Aggregate Attributes [2]: [sum#37, isEmpty#38]
+Results [9]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, sum#39, isEmpty#40]
 
 (28) Exchange
-Input [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, sum#29, isEmpty#30]
-Arguments: hashpartitioning(i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, 5), ENSURE_REQUIREMENTS, [plan_id=5]
+Input [9]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, sum#39, isEmpty#40]
+Arguments: hashpartitioning(i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, 5), ENSURE_REQUIREMENTS, [plan_id=5]
 
 (29) HashAggregate [codegen id : 17]
-Input [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, sum#29, isEmpty#30]
-Keys [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#31]
-Results [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, null AS s_store_id#32, sum(sumsales#26)#31 AS sumsales#33]
+Input [9]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, sum#39, isEmpty#40]
+Keys [7]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30]
+Functions [1]: [sum(sumsales#36)]
+Aggregate Attributes [1]: [sum(sumsales#36)#41]
+Results [9]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, null AS s_store_id#42, sum(sumsales#36)#41 AS sumsales#43]
 
 (30) ReusedExchange [Reuses operator id: 23]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#34, isEmpty#35]
+Output [10]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, d_moy#50, s_store_id#51, sum#52, isEmpty#53]
 
 (31) HashAggregate [codegen id : 25]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#34, isEmpty#35]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, d_moy#50, s_store_id#51, sum#52, isEmpty#53]
+Keys [8]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, d_moy#50, s_store_id#51]
+Functions [1]: [sum(coalesce((ss_sales_price#54 * cast(ss_quantity#55 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#54 * cast(ss_quantity#55 as decimal(10,0))), 0.00))#22]
+Results [7]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, sum(coalesce((ss_sales_price#54 * cast(ss_quantity#55 as decimal(10,0))), 0.00))#22 AS sumsales#56]
 
 (32) HashAggregate [codegen id : 25]
-Input [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, sumsales#26]
-Keys [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#36, isEmpty#37]
-Results [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, sum#38, isEmpty#39]
+Input [7]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, sumsales#56]
+Keys [6]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49]
+Functions [1]: [partial_sum(sumsales#56)]
+Aggregate Attributes [2]: [sum#57, isEmpty#58]
+Results [8]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, sum#59, isEmpty#60]
 
 (33) Exchange
-Input [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, sum#38, isEmpty#39]
-Arguments: hashpartitioning(i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [8]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, sum#59, isEmpty#60]
+Arguments: hashpartitioning(i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (34) HashAggregate [codegen id : 26]
-Input [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, sum#38, isEmpty#39]
-Keys [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#40]
-Results [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, null AS d_moy#41, null AS s_store_id#42, sum(sumsales#26)#40 AS sumsales#43]
+Input [8]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, sum#59, isEmpty#60]
+Keys [6]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49]
+Functions [1]: [sum(sumsales#56)]
+Aggregate Attributes [1]: [sum(sumsales#56)#61]
+Results [9]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, null AS d_moy#62, null AS s_store_id#63, sum(sumsales#56)#61 AS sumsales#64]
 
 (35) ReusedExchange [Reuses operator id: 23]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#44, isEmpty#45]
+Output [10]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, d_qoy#70, d_moy#71, s_store_id#72, sum#73, isEmpty#74]
 
 (36) HashAggregate [codegen id : 34]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#44, isEmpty#45]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, d_qoy#70, d_moy#71, s_store_id#72, sum#73, isEmpty#74]
+Keys [8]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, d_qoy#70, d_moy#71, s_store_id#72]
+Functions [1]: [sum(coalesce((ss_sales_price#75 * cast(ss_quantity#76 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#75 * cast(ss_quantity#76 as decimal(10,0))), 0.00))#22]
+Results [6]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, sum(coalesce((ss_sales_price#75 * cast(ss_quantity#76 as decimal(10,0))), 0.00))#22 AS sumsales#77]
 
 (37) HashAggregate [codegen id : 34]
-Input [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, sumsales#26]
-Keys [5]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#46, isEmpty#47]
-Results [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, sum#48, isEmpty#49]
+Input [6]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, sumsales#77]
+Keys [5]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69]
+Functions [1]: [partial_sum(sumsales#77)]
+Aggregate Attributes [2]: [sum#78, isEmpty#79]
+Results [7]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, sum#80, isEmpty#81]
 
 (38) Exchange
-Input [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, sum#48, isEmpty#49]
-Arguments: hashpartitioning(i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, 5), ENSURE_REQUIREMENTS, [plan_id=7]
+Input [7]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, sum#80, isEmpty#81]
+Arguments: hashpartitioning(i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, 5), ENSURE_REQUIREMENTS, [plan_id=7]
 
 (39) HashAggregate [codegen id : 35]
-Input [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, sum#48, isEmpty#49]
-Keys [5]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#50]
-Results [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, null AS d_qoy#51, null AS d_moy#52, null AS s_store_id#53, sum(sumsales#26)#50 AS sumsales#54]
+Input [7]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, sum#80, isEmpty#81]
+Keys [5]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69]
+Functions [1]: [sum(sumsales#77)]
+Aggregate Attributes [1]: [sum(sumsales#77)#82]
+Results [9]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, null AS d_qoy#83, null AS d_moy#84, null AS s_store_id#85, sum(sumsales#77)#82 AS sumsales#86]
 
 (40) ReusedExchange [Reuses operator id: 23]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#55, isEmpty#56]
+Output [10]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, d_year#91, d_qoy#92, d_moy#93, s_store_id#94, sum#95, isEmpty#96]
 
 (41) HashAggregate [codegen id : 43]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#55, isEmpty#56]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [5]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, d_year#91, d_qoy#92, d_moy#93, s_store_id#94, sum#95, isEmpty#96]
+Keys [8]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, d_year#91, d_qoy#92, d_moy#93, s_store_id#94]
+Functions [1]: [sum(coalesce((ss_sales_price#97 * cast(ss_quantity#98 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#97 * cast(ss_quantity#98 as decimal(10,0))), 0.00))#22]
+Results [5]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, sum(coalesce((ss_sales_price#97 * cast(ss_quantity#98 as decimal(10,0))), 0.00))#22 AS sumsales#99]
 
 (42) HashAggregate [codegen id : 43]
-Input [5]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, sumsales#26]
-Keys [4]: [i_category#16, i_class#15, i_brand#14, i_product_name#17]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#57, isEmpty#58]
-Results [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, sum#59, isEmpty#60]
+Input [5]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, sumsales#99]
+Keys [4]: [i_category#87, i_class#88, i_brand#89, i_product_name#90]
+Functions [1]: [partial_sum(sumsales#99)]
+Aggregate Attributes [2]: [sum#100, isEmpty#101]
+Results [6]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, sum#102, isEmpty#103]
 
 (43) Exchange
-Input [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, sum#59, isEmpty#60]
-Arguments: hashpartitioning(i_category#16, i_class#15, i_brand#14, i_product_name#17, 5), ENSURE_REQUIREMENTS, [plan_id=8]
+Input [6]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, sum#102, isEmpty#103]
+Arguments: hashpartitioning(i_category#87, i_class#88, i_brand#89, i_product_name#90, 5), ENSURE_REQUIREMENTS, [plan_id=8]
 
 (44) HashAggregate [codegen id : 44]
-Input [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, sum#59, isEmpty#60]
-Keys [4]: [i_category#16, i_class#15, i_brand#14, i_product_name#17]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#61]
-Results [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, null AS d_year#62, null AS d_qoy#63, null AS d_moy#64, null AS s_store_id#65, sum(sumsales#26)#61 AS sumsales#66]
+Input [6]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, sum#102, isEmpty#103]
+Keys [4]: [i_category#87, i_class#88, i_brand#89, i_product_name#90]
+Functions [1]: [sum(sumsales#99)]
+Aggregate Attributes [1]: [sum(sumsales#99)#104]
+Results [9]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, null AS d_year#105, null AS d_qoy#106, null AS d_moy#107, null AS s_store_id#108, sum(sumsales#99)#104 AS sumsales#109]
 
 (45) ReusedExchange [Reuses operator id: 23]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#67, isEmpty#68]
+Output [10]: [i_category#110, i_class#111, i_brand#112, i_product_name#113, d_year#114, d_qoy#115, d_moy#116, s_store_id#117, sum#118, isEmpty#119]
 
 (46) HashAggregate [codegen id : 52]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#67, isEmpty#68]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [4]: [i_category#16, i_class#15, i_brand#14, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#110, i_class#111, i_brand#112, i_product_name#113, d_year#114, d_qoy#115, d_moy#116, s_store_id#117, sum#118, isEmpty#119]
+Keys [8]: [i_category#110, i_class#111, i_brand#112, i_product_name#113, d_year#114, d_qoy#115, d_moy#116, s_store_id#117]
+Functions [1]: [sum(coalesce((ss_sales_price#120 * cast(ss_quantity#121 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#120 * cast(ss_quantity#121 as decimal(10,0))), 0.00))#22]
+Results [4]: [i_category#110, i_class#111, i_brand#112, sum(coalesce((ss_sales_price#120 * cast(ss_quantity#121 as decimal(10,0))), 0.00))#22 AS sumsales#122]
 
 (47) HashAggregate [codegen id : 52]
-Input [4]: [i_category#16, i_class#15, i_brand#14, sumsales#26]
-Keys [3]: [i_category#16, i_class#15, i_brand#14]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#69, isEmpty#70]
-Results [5]: [i_category#16, i_class#15, i_brand#14, sum#71, isEmpty#72]
+Input [4]: [i_category#110, i_class#111, i_brand#112, sumsales#122]
+Keys [3]: [i_category#110, i_class#111, i_brand#112]
+Functions [1]: [partial_sum(sumsales#122)]
+Aggregate Attributes [2]: [sum#123, isEmpty#124]
+Results [5]: [i_category#110, i_class#111, i_brand#112, sum#125, isEmpty#126]
 
 (48) Exchange
-Input [5]: [i_category#16, i_class#15, i_brand#14, sum#71, isEmpty#72]
-Arguments: hashpartitioning(i_category#16, i_class#15, i_brand#14, 5), ENSURE_REQUIREMENTS, [plan_id=9]
+Input [5]: [i_category#110, i_class#111, i_brand#112, sum#125, isEmpty#126]
+Arguments: hashpartitioning(i_category#110, i_class#111, i_brand#112, 5), ENSURE_REQUIREMENTS, [plan_id=9]
 
 (49) HashAggregate [codegen id : 53]
-Input [5]: [i_category#16, i_class#15, i_brand#14, sum#71, isEmpty#72]
-Keys [3]: [i_category#16, i_class#15, i_brand#14]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#73]
-Results [9]: [i_category#16, i_class#15, i_brand#14, null AS i_product_name#74, null AS d_year#75, null AS d_qoy#76, null AS d_moy#77, null AS s_store_id#78, sum(sumsales#26)#73 AS sumsales#79]
+Input [5]: [i_category#110, i_class#111, i_brand#112, sum#125, isEmpty#126]
+Keys [3]: [i_category#110, i_class#111, i_brand#112]
+Functions [1]: [sum(sumsales#122)]
+Aggregate Attributes [1]: [sum(sumsales#122)#127]
+Results [9]: [i_category#110, i_class#111, i_brand#112, null AS i_product_name#128, null AS d_year#129, null AS d_qoy#130, null AS d_moy#131, null AS s_store_id#132, sum(sumsales#122)#127 AS sumsales#133]
 
 (50) ReusedExchange [Reuses operator id: 23]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#80, isEmpty#81]
+Output [10]: [i_category#134, i_class#135, i_brand#136, i_product_name#137, d_year#138, d_qoy#139, d_moy#140, s_store_id#141, sum#142, isEmpty#143]
 
 (51) HashAggregate [codegen id : 61]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#80, isEmpty#81]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [3]: [i_category#16, i_class#15, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#134, i_class#135, i_brand#136, i_product_name#137, d_year#138, d_qoy#139, d_moy#140, s_store_id#141, sum#142, isEmpty#143]
+Keys [8]: [i_category#134, i_class#135, i_brand#136, i_product_name#137, d_year#138, d_qoy#139, d_moy#140, s_store_id#141]
+Functions [1]: [sum(coalesce((ss_sales_price#144 * cast(ss_quantity#145 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#144 * cast(ss_quantity#145 as decimal(10,0))), 0.00))#22]
+Results [3]: [i_category#134, i_class#135, sum(coalesce((ss_sales_price#144 * cast(ss_quantity#145 as decimal(10,0))), 0.00))#22 AS sumsales#146]
 
 (52) HashAggregate [codegen id : 61]
-Input [3]: [i_category#16, i_class#15, sumsales#26]
-Keys [2]: [i_category#16, i_class#15]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#82, isEmpty#83]
-Results [4]: [i_category#16, i_class#15, sum#84, isEmpty#85]
+Input [3]: [i_category#134, i_class#135, sumsales#146]
+Keys [2]: [i_category#134, i_class#135]
+Functions [1]: [partial_sum(sumsales#146)]
+Aggregate Attributes [2]: [sum#147, isEmpty#148]
+Results [4]: [i_category#134, i_class#135, sum#149, isEmpty#150]
 
 (53) Exchange
-Input [4]: [i_category#16, i_class#15, sum#84, isEmpty#85]
-Arguments: hashpartitioning(i_category#16, i_class#15, 5), ENSURE_REQUIREMENTS, [plan_id=10]
+Input [4]: [i_category#134, i_class#135, sum#149, isEmpty#150]
+Arguments: hashpartitioning(i_category#134, i_class#135, 5), ENSURE_REQUIREMENTS, [plan_id=10]
 
 (54) HashAggregate [codegen id : 62]
-Input [4]: [i_category#16, i_class#15, sum#84, isEmpty#85]
-Keys [2]: [i_category#16, i_class#15]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#86]
-Results [9]: [i_category#16, i_class#15, null AS i_brand#87, null AS i_product_name#88, null AS d_year#89, null AS d_qoy#90, null AS d_moy#91, null AS s_store_id#92, sum(sumsales#26)#86 AS sumsales#93]
+Input [4]: [i_category#134, i_class#135, sum#149, isEmpty#150]
+Keys [2]: [i_category#134, i_class#135]
+Functions [1]: [sum(sumsales#146)]
+Aggregate Attributes [1]: [sum(sumsales#146)#151]
+Results [9]: [i_category#134, i_class#135, null AS i_brand#152, null AS i_product_name#153, null AS d_year#154, null AS d_qoy#155, null AS d_moy#156, null AS s_store_id#157, sum(sumsales#146)#151 AS sumsales#158]
 
 (55) ReusedExchange [Reuses operator id: 23]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#94, isEmpty#95]
+Output [10]: [i_category#159, i_class#160, i_brand#161, i_product_name#162, d_year#163, d_qoy#164, d_moy#165, s_store_id#166, sum#167, isEmpty#168]
 
 (56) HashAggregate [codegen id : 70]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#94, isEmpty#95]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [2]: [i_category#16, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#159, i_class#160, i_brand#161, i_product_name#162, d_year#163, d_qoy#164, d_moy#165, s_store_id#166, sum#167, isEmpty#168]
+Keys [8]: [i_category#159, i_class#160, i_brand#161, i_product_name#162, d_year#163, d_qoy#164, d_moy#165, s_store_id#166]
+Functions [1]: [sum(coalesce((ss_sales_price#169 * cast(ss_quantity#170 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#169 * cast(ss_quantity#170 as decimal(10,0))), 0.00))#22]
+Results [2]: [i_category#159, sum(coalesce((ss_sales_price#169 * cast(ss_quantity#170 as decimal(10,0))), 0.00))#22 AS sumsales#171]
 
 (57) HashAggregate [codegen id : 70]
-Input [2]: [i_category#16, sumsales#26]
-Keys [1]: [i_category#16]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#96, isEmpty#97]
-Results [3]: [i_category#16, sum#98, isEmpty#99]
+Input [2]: [i_category#159, sumsales#171]
+Keys [1]: [i_category#159]
+Functions [1]: [partial_sum(sumsales#171)]
+Aggregate Attributes [2]: [sum#172, isEmpty#173]
+Results [3]: [i_category#159, sum#174, isEmpty#175]
 
 (58) Exchange
-Input [3]: [i_category#16, sum#98, isEmpty#99]
-Arguments: hashpartitioning(i_category#16, 5), ENSURE_REQUIREMENTS, [plan_id=11]
+Input [3]: [i_category#159, sum#174, isEmpty#175]
+Arguments: hashpartitioning(i_category#159, 5), ENSURE_REQUIREMENTS, [plan_id=11]
 
 (59) HashAggregate [codegen id : 71]
-Input [3]: [i_category#16, sum#98, isEmpty#99]
-Keys [1]: [i_category#16]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#100]
-Results [9]: [i_category#16, null AS i_class#101, null AS i_brand#102, null AS i_product_name#103, null AS d_year#104, null AS d_qoy#105, null AS d_moy#106, null AS s_store_id#107, sum(sumsales#26)#100 AS sumsales#108]
+Input [3]: [i_category#159, sum#174, isEmpty#175]
+Keys [1]: [i_category#159]
+Functions [1]: [sum(sumsales#171)]
+Aggregate Attributes [1]: [sum(sumsales#171)#176]
+Results [9]: [i_category#159, null AS i_class#177, null AS i_brand#178, null AS i_product_name#179, null AS d_year#180, null AS d_qoy#181, null AS d_moy#182, null AS s_store_id#183, sum(sumsales#171)#176 AS sumsales#184]
 
 (60) ReusedExchange [Reuses operator id: 23]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#109, isEmpty#110]
+Output [10]: [i_category#185, i_class#186, i_brand#187, i_product_name#188, d_year#189, d_qoy#190, d_moy#191, s_store_id#192, sum#193, isEmpty#194]
 
 (61) HashAggregate [codegen id : 79]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#109, isEmpty#110]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#185, i_class#186, i_brand#187, i_product_name#188, d_year#189, d_qoy#190, d_moy#191, s_store_id#192, sum#193, isEmpty#194]
+Keys [8]: [i_category#185, i_class#186, i_brand#187, i_product_name#188, d_year#189, d_qoy#190, d_moy#191, s_store_id#192]
+Functions [1]: [sum(coalesce((ss_sales_price#195 * cast(ss_quantity#196 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#195 * cast(ss_quantity#196 as decimal(10,0))), 0.00))#22]
+Results [1]: [sum(coalesce((ss_sales_price#195 * cast(ss_quantity#196 as decimal(10,0))), 0.00))#22 AS sumsales#197]
 
 (62) HashAggregate [codegen id : 79]
-Input [1]: [sumsales#26]
+Input [1]: [sumsales#197]
 Keys: []
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#111, isEmpty#112]
-Results [2]: [sum#113, isEmpty#114]
+Functions [1]: [partial_sum(sumsales#197)]
+Aggregate Attributes [2]: [sum#198, isEmpty#199]
+Results [2]: [sum#200, isEmpty#201]
 
 (63) Exchange
-Input [2]: [sum#113, isEmpty#114]
+Input [2]: [sum#200, isEmpty#201]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=12]
 
 (64) HashAggregate [codegen id : 80]
-Input [2]: [sum#113, isEmpty#114]
+Input [2]: [sum#200, isEmpty#201]
 Keys: []
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#115]
-Results [9]: [null AS i_category#116, null AS i_class#117, null AS i_brand#118, null AS i_product_name#119, null AS d_year#120, null AS d_qoy#121, null AS d_moy#122, null AS s_store_id#123, sum(sumsales#26)#115 AS sumsales#124]
+Functions [1]: [sum(sumsales#197)]
+Aggregate Attributes [1]: [sum(sumsales#197)#202]
+Results [9]: [null AS i_category#203, null AS i_class#204, null AS i_brand#205, null AS i_product_name#206, null AS d_year#207, null AS d_qoy#208, null AS d_moy#209, null AS s_store_id#210, sum(sumsales#197)#202 AS sumsales#211]
 
 (65) Union
 
@@ -436,15 +436,15 @@ Arguments: [i_category#16], [sumsales#23 DESC NULLS LAST], rank(sumsales#23), 10
 
 (71) Window
 Input [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23]
-Arguments: [rank(sumsales#23) windowspecdefinition(i_category#16, sumsales#23 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#125], [i_category#16], [sumsales#23 DESC NULLS LAST]
+Arguments: [rank(sumsales#23) windowspecdefinition(i_category#16, sumsales#23 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#212], [i_category#16], [sumsales#23 DESC NULLS LAST]
 
 (72) Filter [codegen id : 83]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23, rk#125]
-Condition : (rk#125 <= 100)
+Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23, rk#212]
+Condition : (rk#212 <= 100)
 
 (73) TakeOrderedAndProject
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23, rk#125]
-Arguments: 100, [i_category#16 ASC NULLS FIRST, i_class#15 ASC NULLS FIRST, i_brand#14 ASC NULLS FIRST, i_product_name#17 ASC NULLS FIRST, d_year#8 ASC NULLS FIRST, d_qoy#10 ASC NULLS FIRST, d_moy#9 ASC NULLS FIRST, s_store_id#12 ASC NULLS FIRST, sumsales#23 ASC NULLS FIRST, rk#125 ASC NULLS FIRST], [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23, rk#125]
+Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23, rk#212]
+Arguments: 100, [i_category#16 ASC NULLS FIRST, i_class#15 ASC NULLS FIRST, i_brand#14 ASC NULLS FIRST, i_product_name#17 ASC NULLS FIRST, d_year#8 ASC NULLS FIRST, d_qoy#10 ASC NULLS FIRST, d_moy#9 ASC NULLS FIRST, s_store_id#12 ASC NULLS FIRST, sumsales#23 ASC NULLS FIRST, rk#212 ASC NULLS FIRST], [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23, rk#212]
 
 ===== Subqueries =====
 
@@ -457,22 +457,22 @@ BroadcastExchange (78)
 
 
 (74) Scan parquet spark_catalog.default.date_dim
-Output [5]: [d_date_sk#7, d_month_seq#126, d_year#8, d_moy#9, d_qoy#10]
+Output [5]: [d_date_sk#7, d_month_seq#213, d_year#8, d_moy#9, d_qoy#10]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1212), LessThanOrEqual(d_month_seq,1223), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_month_seq:int,d_year:int,d_moy:int,d_qoy:int>
 
 (75) ColumnarToRow [codegen id : 1]
-Input [5]: [d_date_sk#7, d_month_seq#126, d_year#8, d_moy#9, d_qoy#10]
+Input [5]: [d_date_sk#7, d_month_seq#213, d_year#8, d_moy#9, d_qoy#10]
 
 (76) Filter [codegen id : 1]
-Input [5]: [d_date_sk#7, d_month_seq#126, d_year#8, d_moy#9, d_qoy#10]
-Condition : (((isnotnull(d_month_seq#126) AND (d_month_seq#126 >= 1212)) AND (d_month_seq#126 <= 1223)) AND isnotnull(d_date_sk#7))
+Input [5]: [d_date_sk#7, d_month_seq#213, d_year#8, d_moy#9, d_qoy#10]
+Condition : (((isnotnull(d_month_seq#213) AND (d_month_seq#213 >= 1212)) AND (d_month_seq#213 <= 1223)) AND isnotnull(d_date_sk#7))
 
 (77) Project [codegen id : 1]
 Output [4]: [d_date_sk#7, d_year#8, d_moy#9, d_qoy#10]
-Input [5]: [d_date_sk#7, d_month_seq#126, d_year#8, d_moy#9, d_qoy#10]
+Input [5]: [d_date_sk#7, d_month_seq#213, d_year#8, d_moy#9, d_qoy#10]
 
 (78) BroadcastExchange
 Input [4]: [d_date_sk#7, d_year#8, d_moy#9, d_qoy#10]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q67a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q67a/explain.txt
index 0c95b8405c1..75d526da4ba 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q67a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q67a/explain.txt
@@ -174,228 +174,228 @@ Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 a
 Results [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, cast(sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 as decimal(38,2)) AS sumsales#23]
 
 (22) ReusedExchange [Reuses operator id: 20]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#24, isEmpty#25]
+Output [10]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, s_store_id#31, sum#32, isEmpty#33]
 
 (23) HashAggregate [codegen id : 10]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#24, isEmpty#25]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, s_store_id#31, sum#32, isEmpty#33]
+Keys [8]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, s_store_id#31]
+Functions [1]: [sum(coalesce((ss_sales_price#34 * cast(ss_quantity#35 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#34 * cast(ss_quantity#35 as decimal(10,0))), 0.00))#22]
+Results [8]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, sum(coalesce((ss_sales_price#34 * cast(ss_quantity#35 as decimal(10,0))), 0.00))#22 AS sumsales#36]
 
 (24) HashAggregate [codegen id : 10]
-Input [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, sumsales#26]
-Keys [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#27, isEmpty#28]
-Results [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, sum#29, isEmpty#30]
+Input [8]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, sumsales#36]
+Keys [7]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30]
+Functions [1]: [partial_sum(sumsales#36)]
+Aggregate Attributes [2]: [sum#37, isEmpty#38]
+Results [9]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, sum#39, isEmpty#40]
 
 (25) Exchange
-Input [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, sum#29, isEmpty#30]
-Arguments: hashpartitioning(i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, 5), ENSURE_REQUIREMENTS, [plan_id=4]
+Input [9]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, sum#39, isEmpty#40]
+Arguments: hashpartitioning(i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, 5), ENSURE_REQUIREMENTS, [plan_id=4]
 
 (26) HashAggregate [codegen id : 11]
-Input [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, sum#29, isEmpty#30]
-Keys [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#31]
-Results [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, null AS s_store_id#32, sum(sumsales#26)#31 AS sumsales#33]
+Input [9]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, sum#39, isEmpty#40]
+Keys [7]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30]
+Functions [1]: [sum(sumsales#36)]
+Aggregate Attributes [1]: [sum(sumsales#36)#41]
+Results [9]: [i_category#24, i_class#25, i_brand#26, i_product_name#27, d_year#28, d_qoy#29, d_moy#30, null AS s_store_id#42, sum(sumsales#36)#41 AS sumsales#43]
 
 (27) ReusedExchange [Reuses operator id: 20]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#34, isEmpty#35]
+Output [10]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, d_moy#50, s_store_id#51, sum#52, isEmpty#53]
 
 (28) HashAggregate [codegen id : 16]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#34, isEmpty#35]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, d_moy#50, s_store_id#51, sum#52, isEmpty#53]
+Keys [8]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, d_moy#50, s_store_id#51]
+Functions [1]: [sum(coalesce((ss_sales_price#54 * cast(ss_quantity#55 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#54 * cast(ss_quantity#55 as decimal(10,0))), 0.00))#22]
+Results [7]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, sum(coalesce((ss_sales_price#54 * cast(ss_quantity#55 as decimal(10,0))), 0.00))#22 AS sumsales#56]
 
 (29) HashAggregate [codegen id : 16]
-Input [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, sumsales#26]
-Keys [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#36, isEmpty#37]
-Results [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, sum#38, isEmpty#39]
+Input [7]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, sumsales#56]
+Keys [6]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49]
+Functions [1]: [partial_sum(sumsales#56)]
+Aggregate Attributes [2]: [sum#57, isEmpty#58]
+Results [8]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, sum#59, isEmpty#60]
 
 (30) Exchange
-Input [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, sum#38, isEmpty#39]
-Arguments: hashpartitioning(i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, 5), ENSURE_REQUIREMENTS, [plan_id=5]
+Input [8]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, sum#59, isEmpty#60]
+Arguments: hashpartitioning(i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, 5), ENSURE_REQUIREMENTS, [plan_id=5]
 
 (31) HashAggregate [codegen id : 17]
-Input [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, sum#38, isEmpty#39]
-Keys [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#40]
-Results [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, null AS d_moy#41, null AS s_store_id#42, sum(sumsales#26)#40 AS sumsales#43]
+Input [8]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, sum#59, isEmpty#60]
+Keys [6]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49]
+Functions [1]: [sum(sumsales#56)]
+Aggregate Attributes [1]: [sum(sumsales#56)#61]
+Results [9]: [i_category#44, i_class#45, i_brand#46, i_product_name#47, d_year#48, d_qoy#49, null AS d_moy#62, null AS s_store_id#63, sum(sumsales#56)#61 AS sumsales#64]
 
 (32) ReusedExchange [Reuses operator id: 20]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#44, isEmpty#45]
+Output [10]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, d_qoy#70, d_moy#71, s_store_id#72, sum#73, isEmpty#74]
 
 (33) HashAggregate [codegen id : 22]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#44, isEmpty#45]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, d_qoy#70, d_moy#71, s_store_id#72, sum#73, isEmpty#74]
+Keys [8]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, d_qoy#70, d_moy#71, s_store_id#72]
+Functions [1]: [sum(coalesce((ss_sales_price#75 * cast(ss_quantity#76 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#75 * cast(ss_quantity#76 as decimal(10,0))), 0.00))#22]
+Results [6]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, sum(coalesce((ss_sales_price#75 * cast(ss_quantity#76 as decimal(10,0))), 0.00))#22 AS sumsales#77]
 
 (34) HashAggregate [codegen id : 22]
-Input [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, sumsales#26]
-Keys [5]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#46, isEmpty#47]
-Results [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, sum#48, isEmpty#49]
+Input [6]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, sumsales#77]
+Keys [5]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69]
+Functions [1]: [partial_sum(sumsales#77)]
+Aggregate Attributes [2]: [sum#78, isEmpty#79]
+Results [7]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, sum#80, isEmpty#81]
 
 (35) Exchange
-Input [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, sum#48, isEmpty#49]
-Arguments: hashpartitioning(i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [7]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, sum#80, isEmpty#81]
+Arguments: hashpartitioning(i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (36) HashAggregate [codegen id : 23]
-Input [7]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, sum#48, isEmpty#49]
-Keys [5]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#50]
-Results [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, null AS d_qoy#51, null AS d_moy#52, null AS s_store_id#53, sum(sumsales#26)#50 AS sumsales#54]
+Input [7]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, sum#80, isEmpty#81]
+Keys [5]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69]
+Functions [1]: [sum(sumsales#77)]
+Aggregate Attributes [1]: [sum(sumsales#77)#82]
+Results [9]: [i_category#65, i_class#66, i_brand#67, i_product_name#68, d_year#69, null AS d_qoy#83, null AS d_moy#84, null AS s_store_id#85, sum(sumsales#77)#82 AS sumsales#86]
 
 (37) ReusedExchange [Reuses operator id: 20]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#55, isEmpty#56]
+Output [10]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, d_year#91, d_qoy#92, d_moy#93, s_store_id#94, sum#95, isEmpty#96]
 
 (38) HashAggregate [codegen id : 28]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#55, isEmpty#56]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [5]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, d_year#91, d_qoy#92, d_moy#93, s_store_id#94, sum#95, isEmpty#96]
+Keys [8]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, d_year#91, d_qoy#92, d_moy#93, s_store_id#94]
+Functions [1]: [sum(coalesce((ss_sales_price#97 * cast(ss_quantity#98 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#97 * cast(ss_quantity#98 as decimal(10,0))), 0.00))#22]
+Results [5]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, sum(coalesce((ss_sales_price#97 * cast(ss_quantity#98 as decimal(10,0))), 0.00))#22 AS sumsales#99]
 
 (39) HashAggregate [codegen id : 28]
-Input [5]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, sumsales#26]
-Keys [4]: [i_category#16, i_class#15, i_brand#14, i_product_name#17]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#57, isEmpty#58]
-Results [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, sum#59, isEmpty#60]
+Input [5]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, sumsales#99]
+Keys [4]: [i_category#87, i_class#88, i_brand#89, i_product_name#90]
+Functions [1]: [partial_sum(sumsales#99)]
+Aggregate Attributes [2]: [sum#100, isEmpty#101]
+Results [6]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, sum#102, isEmpty#103]
 
 (40) Exchange
-Input [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, sum#59, isEmpty#60]
-Arguments: hashpartitioning(i_category#16, i_class#15, i_brand#14, i_product_name#17, 5), ENSURE_REQUIREMENTS, [plan_id=7]
+Input [6]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, sum#102, isEmpty#103]
+Arguments: hashpartitioning(i_category#87, i_class#88, i_brand#89, i_product_name#90, 5), ENSURE_REQUIREMENTS, [plan_id=7]
 
 (41) HashAggregate [codegen id : 29]
-Input [6]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, sum#59, isEmpty#60]
-Keys [4]: [i_category#16, i_class#15, i_brand#14, i_product_name#17]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#61]
-Results [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, null AS d_year#62, null AS d_qoy#63, null AS d_moy#64, null AS s_store_id#65, sum(sumsales#26)#61 AS sumsales#66]
+Input [6]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, sum#102, isEmpty#103]
+Keys [4]: [i_category#87, i_class#88, i_brand#89, i_product_name#90]
+Functions [1]: [sum(sumsales#99)]
+Aggregate Attributes [1]: [sum(sumsales#99)#104]
+Results [9]: [i_category#87, i_class#88, i_brand#89, i_product_name#90, null AS d_year#105, null AS d_qoy#106, null AS d_moy#107, null AS s_store_id#108, sum(sumsales#99)#104 AS sumsales#109]
 
 (42) ReusedExchange [Reuses operator id: 20]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#67, isEmpty#68]
+Output [10]: [i_category#110, i_class#111, i_brand#112, i_product_name#113, d_year#114, d_qoy#115, d_moy#116, s_store_id#117, sum#118, isEmpty#119]
 
 (43) HashAggregate [codegen id : 34]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#67, isEmpty#68]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [4]: [i_category#16, i_class#15, i_brand#14, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#110, i_class#111, i_brand#112, i_product_name#113, d_year#114, d_qoy#115, d_moy#116, s_store_id#117, sum#118, isEmpty#119]
+Keys [8]: [i_category#110, i_class#111, i_brand#112, i_product_name#113, d_year#114, d_qoy#115, d_moy#116, s_store_id#117]
+Functions [1]: [sum(coalesce((ss_sales_price#120 * cast(ss_quantity#121 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#120 * cast(ss_quantity#121 as decimal(10,0))), 0.00))#22]
+Results [4]: [i_category#110, i_class#111, i_brand#112, sum(coalesce((ss_sales_price#120 * cast(ss_quantity#121 as decimal(10,0))), 0.00))#22 AS sumsales#122]
 
 (44) HashAggregate [codegen id : 34]
-Input [4]: [i_category#16, i_class#15, i_brand#14, sumsales#26]
-Keys [3]: [i_category#16, i_class#15, i_brand#14]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#69, isEmpty#70]
-Results [5]: [i_category#16, i_class#15, i_brand#14, sum#71, isEmpty#72]
+Input [4]: [i_category#110, i_class#111, i_brand#112, sumsales#122]
+Keys [3]: [i_category#110, i_class#111, i_brand#112]
+Functions [1]: [partial_sum(sumsales#122)]
+Aggregate Attributes [2]: [sum#123, isEmpty#124]
+Results [5]: [i_category#110, i_class#111, i_brand#112, sum#125, isEmpty#126]
 
 (45) Exchange
-Input [5]: [i_category#16, i_class#15, i_brand#14, sum#71, isEmpty#72]
-Arguments: hashpartitioning(i_category#16, i_class#15, i_brand#14, 5), ENSURE_REQUIREMENTS, [plan_id=8]
+Input [5]: [i_category#110, i_class#111, i_brand#112, sum#125, isEmpty#126]
+Arguments: hashpartitioning(i_category#110, i_class#111, i_brand#112, 5), ENSURE_REQUIREMENTS, [plan_id=8]
 
 (46) HashAggregate [codegen id : 35]
-Input [5]: [i_category#16, i_class#15, i_brand#14, sum#71, isEmpty#72]
-Keys [3]: [i_category#16, i_class#15, i_brand#14]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#73]
-Results [9]: [i_category#16, i_class#15, i_brand#14, null AS i_product_name#74, null AS d_year#75, null AS d_qoy#76, null AS d_moy#77, null AS s_store_id#78, sum(sumsales#26)#73 AS sumsales#79]
+Input [5]: [i_category#110, i_class#111, i_brand#112, sum#125, isEmpty#126]
+Keys [3]: [i_category#110, i_class#111, i_brand#112]
+Functions [1]: [sum(sumsales#122)]
+Aggregate Attributes [1]: [sum(sumsales#122)#127]
+Results [9]: [i_category#110, i_class#111, i_brand#112, null AS i_product_name#128, null AS d_year#129, null AS d_qoy#130, null AS d_moy#131, null AS s_store_id#132, sum(sumsales#122)#127 AS sumsales#133]
 
 (47) ReusedExchange [Reuses operator id: 20]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#80, isEmpty#81]
+Output [10]: [i_category#134, i_class#135, i_brand#136, i_product_name#137, d_year#138, d_qoy#139, d_moy#140, s_store_id#141, sum#142, isEmpty#143]
 
 (48) HashAggregate [codegen id : 40]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#80, isEmpty#81]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [3]: [i_category#16, i_class#15, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#134, i_class#135, i_brand#136, i_product_name#137, d_year#138, d_qoy#139, d_moy#140, s_store_id#141, sum#142, isEmpty#143]
+Keys [8]: [i_category#134, i_class#135, i_brand#136, i_product_name#137, d_year#138, d_qoy#139, d_moy#140, s_store_id#141]
+Functions [1]: [sum(coalesce((ss_sales_price#144 * cast(ss_quantity#145 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#144 * cast(ss_quantity#145 as decimal(10,0))), 0.00))#22]
+Results [3]: [i_category#134, i_class#135, sum(coalesce((ss_sales_price#144 * cast(ss_quantity#145 as decimal(10,0))), 0.00))#22 AS sumsales#146]
 
 (49) HashAggregate [codegen id : 40]
-Input [3]: [i_category#16, i_class#15, sumsales#26]
-Keys [2]: [i_category#16, i_class#15]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#82, isEmpty#83]
-Results [4]: [i_category#16, i_class#15, sum#84, isEmpty#85]
+Input [3]: [i_category#134, i_class#135, sumsales#146]
+Keys [2]: [i_category#134, i_class#135]
+Functions [1]: [partial_sum(sumsales#146)]
+Aggregate Attributes [2]: [sum#147, isEmpty#148]
+Results [4]: [i_category#134, i_class#135, sum#149, isEmpty#150]
 
 (50) Exchange
-Input [4]: [i_category#16, i_class#15, sum#84, isEmpty#85]
-Arguments: hashpartitioning(i_category#16, i_class#15, 5), ENSURE_REQUIREMENTS, [plan_id=9]
+Input [4]: [i_category#134, i_class#135, sum#149, isEmpty#150]
+Arguments: hashpartitioning(i_category#134, i_class#135, 5), ENSURE_REQUIREMENTS, [plan_id=9]
 
 (51) HashAggregate [codegen id : 41]
-Input [4]: [i_category#16, i_class#15, sum#84, isEmpty#85]
-Keys [2]: [i_category#16, i_class#15]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#86]
-Results [9]: [i_category#16, i_class#15, null AS i_brand#87, null AS i_product_name#88, null AS d_year#89, null AS d_qoy#90, null AS d_moy#91, null AS s_store_id#92, sum(sumsales#26)#86 AS sumsales#93]
+Input [4]: [i_category#134, i_class#135, sum#149, isEmpty#150]
+Keys [2]: [i_category#134, i_class#135]
+Functions [1]: [sum(sumsales#146)]
+Aggregate Attributes [1]: [sum(sumsales#146)#151]
+Results [9]: [i_category#134, i_class#135, null AS i_brand#152, null AS i_product_name#153, null AS d_year#154, null AS d_qoy#155, null AS d_moy#156, null AS s_store_id#157, sum(sumsales#146)#151 AS sumsales#158]
 
 (52) ReusedExchange [Reuses operator id: 20]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#94, isEmpty#95]
+Output [10]: [i_category#159, i_class#160, i_brand#161, i_product_name#162, d_year#163, d_qoy#164, d_moy#165, s_store_id#166, sum#167, isEmpty#168]
 
 (53) HashAggregate [codegen id : 46]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#94, isEmpty#95]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [2]: [i_category#16, sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#159, i_class#160, i_brand#161, i_product_name#162, d_year#163, d_qoy#164, d_moy#165, s_store_id#166, sum#167, isEmpty#168]
+Keys [8]: [i_category#159, i_class#160, i_brand#161, i_product_name#162, d_year#163, d_qoy#164, d_moy#165, s_store_id#166]
+Functions [1]: [sum(coalesce((ss_sales_price#169 * cast(ss_quantity#170 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#169 * cast(ss_quantity#170 as decimal(10,0))), 0.00))#22]
+Results [2]: [i_category#159, sum(coalesce((ss_sales_price#169 * cast(ss_quantity#170 as decimal(10,0))), 0.00))#22 AS sumsales#171]
 
 (54) HashAggregate [codegen id : 46]
-Input [2]: [i_category#16, sumsales#26]
-Keys [1]: [i_category#16]
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#96, isEmpty#97]
-Results [3]: [i_category#16, sum#98, isEmpty#99]
+Input [2]: [i_category#159, sumsales#171]
+Keys [1]: [i_category#159]
+Functions [1]: [partial_sum(sumsales#171)]
+Aggregate Attributes [2]: [sum#172, isEmpty#173]
+Results [3]: [i_category#159, sum#174, isEmpty#175]
 
 (55) Exchange
-Input [3]: [i_category#16, sum#98, isEmpty#99]
-Arguments: hashpartitioning(i_category#16, 5), ENSURE_REQUIREMENTS, [plan_id=10]
+Input [3]: [i_category#159, sum#174, isEmpty#175]
+Arguments: hashpartitioning(i_category#159, 5), ENSURE_REQUIREMENTS, [plan_id=10]
 
 (56) HashAggregate [codegen id : 47]
-Input [3]: [i_category#16, sum#98, isEmpty#99]
-Keys [1]: [i_category#16]
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#100]
-Results [9]: [i_category#16, null AS i_class#101, null AS i_brand#102, null AS i_product_name#103, null AS d_year#104, null AS d_qoy#105, null AS d_moy#106, null AS s_store_id#107, sum(sumsales#26)#100 AS sumsales#108]
+Input [3]: [i_category#159, sum#174, isEmpty#175]
+Keys [1]: [i_category#159]
+Functions [1]: [sum(sumsales#171)]
+Aggregate Attributes [1]: [sum(sumsales#171)#176]
+Results [9]: [i_category#159, null AS i_class#177, null AS i_brand#178, null AS i_product_name#179, null AS d_year#180, null AS d_qoy#181, null AS d_moy#182, null AS s_store_id#183, sum(sumsales#171)#176 AS sumsales#184]
 
 (57) ReusedExchange [Reuses operator id: 20]
-Output [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#109, isEmpty#110]
+Output [10]: [i_category#185, i_class#186, i_brand#187, i_product_name#188, d_year#189, d_qoy#190, d_moy#191, s_store_id#192, sum#193, isEmpty#194]
 
 (58) HashAggregate [codegen id : 52]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sum#109, isEmpty#110]
-Keys [8]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12]
-Functions [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))]
-Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22]
-Results [1]: [sum(coalesce((ss_sales_price#4 * cast(ss_quantity#3 as decimal(10,0))), 0.00))#22 AS sumsales#26]
+Input [10]: [i_category#185, i_class#186, i_brand#187, i_product_name#188, d_year#189, d_qoy#190, d_moy#191, s_store_id#192, sum#193, isEmpty#194]
+Keys [8]: [i_category#185, i_class#186, i_brand#187, i_product_name#188, d_year#189, d_qoy#190, d_moy#191, s_store_id#192]
+Functions [1]: [sum(coalesce((ss_sales_price#195 * cast(ss_quantity#196 as decimal(10,0))), 0.00))]
+Aggregate Attributes [1]: [sum(coalesce((ss_sales_price#195 * cast(ss_quantity#196 as decimal(10,0))), 0.00))#22]
+Results [1]: [sum(coalesce((ss_sales_price#195 * cast(ss_quantity#196 as decimal(10,0))), 0.00))#22 AS sumsales#197]
 
 (59) HashAggregate [codegen id : 52]
-Input [1]: [sumsales#26]
+Input [1]: [sumsales#197]
 Keys: []
-Functions [1]: [partial_sum(sumsales#26)]
-Aggregate Attributes [2]: [sum#111, isEmpty#112]
-Results [2]: [sum#113, isEmpty#114]
+Functions [1]: [partial_sum(sumsales#197)]
+Aggregate Attributes [2]: [sum#198, isEmpty#199]
+Results [2]: [sum#200, isEmpty#201]
 
 (60) Exchange
-Input [2]: [sum#113, isEmpty#114]
+Input [2]: [sum#200, isEmpty#201]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=11]
 
 (61) HashAggregate [codegen id : 53]
-Input [2]: [sum#113, isEmpty#114]
+Input [2]: [sum#200, isEmpty#201]
 Keys: []
-Functions [1]: [sum(sumsales#26)]
-Aggregate Attributes [1]: [sum(sumsales#26)#115]
-Results [9]: [null AS i_category#116, null AS i_class#117, null AS i_brand#118, null AS i_product_name#119, null AS d_year#120, null AS d_qoy#121, null AS d_moy#122, null AS s_store_id#123, sum(sumsales#26)#115 AS sumsales#124]
+Functions [1]: [sum(sumsales#197)]
+Aggregate Attributes [1]: [sum(sumsales#197)#202]
+Results [9]: [null AS i_category#203, null AS i_class#204, null AS i_brand#205, null AS i_product_name#206, null AS d_year#207, null AS d_qoy#208, null AS d_moy#209, null AS s_store_id#210, sum(sumsales#197)#202 AS sumsales#211]
 
 (62) Union
 
@@ -421,15 +421,15 @@ Arguments: [i_category#16], [sumsales#23 DESC NULLS LAST], rank(sumsales#23), 10
 
 (68) Window
 Input [9]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23]
-Arguments: [rank(sumsales#23) windowspecdefinition(i_category#16, sumsales#23 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#125], [i_category#16], [sumsales#23 DESC NULLS LAST]
+Arguments: [rank(sumsales#23) windowspecdefinition(i_category#16, sumsales#23 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#212], [i_category#16], [sumsales#23 DESC NULLS LAST]
 
 (69) Filter [codegen id : 56]
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23, rk#125]
-Condition : (rk#125 <= 100)
+Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23, rk#212]
+Condition : (rk#212 <= 100)
 
 (70) TakeOrderedAndProject
-Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23, rk#125]
-Arguments: 100, [i_category#16 ASC NULLS FIRST, i_class#15 ASC NULLS FIRST, i_brand#14 ASC NULLS FIRST, i_product_name#17 ASC NULLS FIRST, d_year#8 ASC NULLS FIRST, d_qoy#10 ASC NULLS FIRST, d_moy#9 ASC NULLS FIRST, s_store_id#12 ASC NULLS FIRST, sumsales#23 ASC NULLS FIRST, rk#125 ASC NULLS FIRST], [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23, rk#125]
+Input [10]: [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23, rk#212]
+Arguments: 100, [i_category#16 ASC NULLS FIRST, i_class#15 ASC NULLS FIRST, i_brand#14 ASC NULLS FIRST, i_product_name#17 ASC NULLS FIRST, d_year#8 ASC NULLS FIRST, d_qoy#10 ASC NULLS FIRST, d_moy#9 ASC NULLS FIRST, s_store_id#12 ASC NULLS FIRST, sumsales#23 ASC NULLS FIRST, rk#212 ASC NULLS FIRST], [i_category#16, i_class#15, i_brand#14, i_product_name#17, d_year#8, d_qoy#10, d_moy#9, s_store_id#12, sumsales#23, rk#212]
 
 ===== Subqueries =====
 
@@ -442,22 +442,22 @@ BroadcastExchange (75)
 
 
 (71) Scan parquet spark_catalog.default.date_dim
-Output [5]: [d_date_sk#7, d_month_seq#126, d_year#8, d_moy#9, d_qoy#10]
+Output [5]: [d_date_sk#7, d_month_seq#213, d_year#8, d_moy#9, d_qoy#10]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1212), LessThanOrEqual(d_month_seq,1223), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_month_seq:int,d_year:int,d_moy:int,d_qoy:int>
 
 (72) ColumnarToRow [codegen id : 1]
-Input [5]: [d_date_sk#7, d_month_seq#126, d_year#8, d_moy#9, d_qoy#10]
+Input [5]: [d_date_sk#7, d_month_seq#213, d_year#8, d_moy#9, d_qoy#10]
 
 (73) Filter [codegen id : 1]
-Input [5]: [d_date_sk#7, d_month_seq#126, d_year#8, d_moy#9, d_qoy#10]
-Condition : (((isnotnull(d_month_seq#126) AND (d_month_seq#126 >= 1212)) AND (d_month_seq#126 <= 1223)) AND isnotnull(d_date_sk#7))
+Input [5]: [d_date_sk#7, d_month_seq#213, d_year#8, d_moy#9, d_qoy#10]
+Condition : (((isnotnull(d_month_seq#213) AND (d_month_seq#213 >= 1212)) AND (d_month_seq#213 <= 1223)) AND isnotnull(d_date_sk#7))
 
 (74) Project [codegen id : 1]
 Output [4]: [d_date_sk#7, d_year#8, d_moy#9, d_qoy#10]
-Input [5]: [d_date_sk#7, d_month_seq#126, d_year#8, d_moy#9, d_qoy#10]
+Input [5]: [d_date_sk#7, d_month_seq#213, d_year#8, d_moy#9, d_qoy#10]
 
 (75) BroadcastExchange
 Input [4]: [d_date_sk#7, d_year#8, d_moy#9, d_qoy#10]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q70a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q70a.sf100/explain.txt
index ec13bd91484..9d902367e73 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q70a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q70a.sf100/explain.txt
@@ -236,60 +236,60 @@ Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_profit#2))#22]
 Results [6]: [cast(MakeDecimal(sum(UnscaledValue(ss_net_profit#2))#22,17,2) as decimal(27,2)) AS total_sum#23, s_state#8, s_county#7, 0 AS g_state#24, 0 AS g_county#25, 0 AS lochierarchy#26]
 
 (38) ReusedExchange [Reuses operator id: 36]
-Output [3]: [s_state#8, s_county#7, sum#27]
+Output [3]: [s_state#27, s_county#28, sum#29]
 
 (39) HashAggregate [codegen id : 18]
-Input [3]: [s_state#8, s_county#7, sum#27]
-Keys [2]: [s_state#8, s_county#7]
-Functions [1]: [sum(UnscaledValue(ss_net_profit#2))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_profit#2))#22]
-Results [2]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#2))#22,17,2) AS total_sum#28, s_state#8]
+Input [3]: [s_state#27, s_county#28, sum#29]
+Keys [2]: [s_state#27, s_county#28]
+Functions [1]: [sum(UnscaledValue(ss_net_profit#30))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_profit#30))#22]
+Results [2]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#30))#22,17,2) AS total_sum#31, s_state#27]
 
 (40) HashAggregate [codegen id : 18]
-Input [2]: [total_sum#28, s_state#8]
-Keys [1]: [s_state#8]
-Functions [1]: [partial_sum(total_sum#28)]
-Aggregate Attributes [2]: [sum#29, isEmpty#30]
-Results [3]: [s_state#8, sum#31, isEmpty#32]
+Input [2]: [total_sum#31, s_state#27]
+Keys [1]: [s_state#27]
+Functions [1]: [partial_sum(total_sum#31)]
+Aggregate Attributes [2]: [sum#32, isEmpty#33]
+Results [3]: [s_state#27, sum#34, isEmpty#35]
 
 (41) Exchange
-Input [3]: [s_state#8, sum#31, isEmpty#32]
-Arguments: hashpartitioning(s_state#8, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [3]: [s_state#27, sum#34, isEmpty#35]
+Arguments: hashpartitioning(s_state#27, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (42) HashAggregate [codegen id : 19]
-Input [3]: [s_state#8, sum#31, isEmpty#32]
-Keys [1]: [s_state#8]
-Functions [1]: [sum(total_sum#28)]
-Aggregate Attributes [1]: [sum(total_sum#28)#33]
-Results [6]: [sum(total_sum#28)#33 AS total_sum#34, s_state#8, null AS s_county#35, 0 AS g_state#36, 1 AS g_county#37, 1 AS lochierarchy#38]
+Input [3]: [s_state#27, sum#34, isEmpty#35]
+Keys [1]: [s_state#27]
+Functions [1]: [sum(total_sum#31)]
+Aggregate Attributes [1]: [sum(total_sum#31)#36]
+Results [6]: [sum(total_sum#31)#36 AS total_sum#37, s_state#27, null AS s_county#38, 0 AS g_state#39, 1 AS g_county#40, 1 AS lochierarchy#41]
 
 (43) ReusedExchange [Reuses operator id: 36]
-Output [3]: [s_state#8, s_county#7, sum#39]
+Output [3]: [s_state#42, s_county#43, sum#44]
 
 (44) HashAggregate [codegen id : 28]
-Input [3]: [s_state#8, s_county#7, sum#39]
-Keys [2]: [s_state#8, s_county#7]
-Functions [1]: [sum(UnscaledValue(ss_net_profit#2))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_profit#2))#22]
-Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#2))#22,17,2) AS total_sum#28]
+Input [3]: [s_state#42, s_county#43, sum#44]
+Keys [2]: [s_state#42, s_county#43]
+Functions [1]: [sum(UnscaledValue(ss_net_profit#45))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_profit#45))#22]
+Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#45))#22,17,2) AS total_sum#46]
 
 (45) HashAggregate [codegen id : 28]
-Input [1]: [total_sum#28]
+Input [1]: [total_sum#46]
 Keys: []
-Functions [1]: [partial_sum(total_sum#28)]
-Aggregate Attributes [2]: [sum#40, isEmpty#41]
-Results [2]: [sum#42, isEmpty#43]
+Functions [1]: [partial_sum(total_sum#46)]
+Aggregate Attributes [2]: [sum#47, isEmpty#48]
+Results [2]: [sum#49, isEmpty#50]
 
 (46) Exchange
-Input [2]: [sum#42, isEmpty#43]
+Input [2]: [sum#49, isEmpty#50]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=7]
 
 (47) HashAggregate [codegen id : 29]
-Input [2]: [sum#42, isEmpty#43]
+Input [2]: [sum#49, isEmpty#50]
 Keys: []
-Functions [1]: [sum(total_sum#28)]
-Aggregate Attributes [1]: [sum(total_sum#28)#44]
-Results [6]: [sum(total_sum#28)#44 AS total_sum#45, null AS s_state#46, null AS s_county#47, 1 AS g_state#48, 1 AS g_county#49, 2 AS lochierarchy#50]
+Functions [1]: [sum(total_sum#46)]
+Aggregate Attributes [1]: [sum(total_sum#46)#51]
+Results [6]: [sum(total_sum#46)#51 AS total_sum#52, null AS s_state#53, null AS s_county#54, 1 AS g_state#55, 1 AS g_county#56, 2 AS lochierarchy#57]
 
 (48) Union
 
@@ -309,27 +309,27 @@ Input [6]: [total_sum#23, s_state#8, s_county#7, g_state#24, g_county#25, lochie
 Keys [6]: [total_sum#23, s_state#8, s_county#7, g_state#24, g_county#25, lochierarchy#26]
 Functions: []
 Aggregate Attributes: []
-Results [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, CASE WHEN (g_county#25 = 0) THEN s_state#8 END AS _w0#51]
+Results [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, CASE WHEN (g_county#25 = 0) THEN s_state#8 END AS _w0#58]
 
 (52) Exchange
-Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#51]
-Arguments: hashpartitioning(lochierarchy#26, _w0#51, 5), ENSURE_REQUIREMENTS, [plan_id=9]
+Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#58]
+Arguments: hashpartitioning(lochierarchy#26, _w0#58, 5), ENSURE_REQUIREMENTS, [plan_id=9]
 
 (53) Sort [codegen id : 32]
-Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#51]
-Arguments: [lochierarchy#26 ASC NULLS FIRST, _w0#51 ASC NULLS FIRST, total_sum#23 DESC NULLS LAST], false, 0
+Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#58]
+Arguments: [lochierarchy#26 ASC NULLS FIRST, _w0#58 ASC NULLS FIRST, total_sum#23 DESC NULLS LAST], false, 0
 
 (54) Window
-Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#51]
-Arguments: [rank(total_sum#23) windowspecdefinition(lochierarchy#26, _w0#51, total_sum#23 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#52], [lochierarchy#26, _w0#51], [total_sum#23 DESC NULLS LAST]
+Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#58]
+Arguments: [rank(total_sum#23) windowspecdefinition(lochierarchy#26, _w0#58, total_sum#23 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#59], [lochierarchy#26, _w0#58], [total_sum#23 DESC NULLS LAST]
 
 (55) Project [codegen id : 33]
-Output [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, rank_within_parent#52]
-Input [6]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#51, rank_within_parent#52]
+Output [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, rank_within_parent#59]
+Input [6]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#58, rank_within_parent#59]
 
 (56) TakeOrderedAndProject
-Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, rank_within_parent#52]
-Arguments: 100, [lochierarchy#26 DESC NULLS LAST, CASE WHEN (lochierarchy#26 = 0) THEN s_state#8 END ASC NULLS FIRST, rank_within_parent#52 ASC NULLS FIRST], [total_sum#23, s_state#8, s_county#7, lochierarchy#26, rank_within_parent#52]
+Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, rank_within_parent#59]
+Arguments: 100, [lochierarchy#26 DESC NULLS LAST, CASE WHEN (lochierarchy#26 = 0) THEN s_state#8 END ASC NULLS FIRST, rank_within_parent#59 ASC NULLS FIRST], [total_sum#23, s_state#8, s_county#7, lochierarchy#26, rank_within_parent#59]
 
 ===== Subqueries =====
 
@@ -342,22 +342,22 @@ BroadcastExchange (61)
 
 
 (57) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#5, d_month_seq#53]
+Output [2]: [d_date_sk#5, d_month_seq#60]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1212), LessThanOrEqual(d_month_seq,1223), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_month_seq:int>
 
 (58) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#5, d_month_seq#53]
+Input [2]: [d_date_sk#5, d_month_seq#60]
 
 (59) Filter [codegen id : 1]
-Input [2]: [d_date_sk#5, d_month_seq#53]
-Condition : (((isnotnull(d_month_seq#53) AND (d_month_seq#53 >= 1212)) AND (d_month_seq#53 <= 1223)) AND isnotnull(d_date_sk#5))
+Input [2]: [d_date_sk#5, d_month_seq#60]
+Condition : (((isnotnull(d_month_seq#60) AND (d_month_seq#60 >= 1212)) AND (d_month_seq#60 <= 1223)) AND isnotnull(d_date_sk#5))
 
 (60) Project [codegen id : 1]
 Output [1]: [d_date_sk#5]
-Input [2]: [d_date_sk#5, d_month_seq#53]
+Input [2]: [d_date_sk#5, d_month_seq#60]
 
 (61) BroadcastExchange
 Input [1]: [d_date_sk#5]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q70a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q70a/explain.txt
index 573d9fe01cc..9be53d4c6ab 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q70a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q70a/explain.txt
@@ -236,60 +236,60 @@ Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_profit#2))#22]
 Results [6]: [cast(MakeDecimal(sum(UnscaledValue(ss_net_profit#2))#22,17,2) as decimal(27,2)) AS total_sum#23, s_state#8, s_county#7, 0 AS g_state#24, 0 AS g_county#25, 0 AS lochierarchy#26]
 
 (38) ReusedExchange [Reuses operator id: 36]
-Output [3]: [s_state#8, s_county#7, sum#27]
+Output [3]: [s_state#27, s_county#28, sum#29]
 
 (39) HashAggregate [codegen id : 18]
-Input [3]: [s_state#8, s_county#7, sum#27]
-Keys [2]: [s_state#8, s_county#7]
-Functions [1]: [sum(UnscaledValue(ss_net_profit#2))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_profit#2))#22]
-Results [2]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#2))#22,17,2) AS total_sum#28, s_state#8]
+Input [3]: [s_state#27, s_county#28, sum#29]
+Keys [2]: [s_state#27, s_county#28]
+Functions [1]: [sum(UnscaledValue(ss_net_profit#30))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_profit#30))#22]
+Results [2]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#30))#22,17,2) AS total_sum#31, s_state#27]
 
 (40) HashAggregate [codegen id : 18]
-Input [2]: [total_sum#28, s_state#8]
-Keys [1]: [s_state#8]
-Functions [1]: [partial_sum(total_sum#28)]
-Aggregate Attributes [2]: [sum#29, isEmpty#30]
-Results [3]: [s_state#8, sum#31, isEmpty#32]
+Input [2]: [total_sum#31, s_state#27]
+Keys [1]: [s_state#27]
+Functions [1]: [partial_sum(total_sum#31)]
+Aggregate Attributes [2]: [sum#32, isEmpty#33]
+Results [3]: [s_state#27, sum#34, isEmpty#35]
 
 (41) Exchange
-Input [3]: [s_state#8, sum#31, isEmpty#32]
-Arguments: hashpartitioning(s_state#8, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [3]: [s_state#27, sum#34, isEmpty#35]
+Arguments: hashpartitioning(s_state#27, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (42) HashAggregate [codegen id : 19]
-Input [3]: [s_state#8, sum#31, isEmpty#32]
-Keys [1]: [s_state#8]
-Functions [1]: [sum(total_sum#28)]
-Aggregate Attributes [1]: [sum(total_sum#28)#33]
-Results [6]: [sum(total_sum#28)#33 AS total_sum#34, s_state#8, null AS s_county#35, 0 AS g_state#36, 1 AS g_county#37, 1 AS lochierarchy#38]
+Input [3]: [s_state#27, sum#34, isEmpty#35]
+Keys [1]: [s_state#27]
+Functions [1]: [sum(total_sum#31)]
+Aggregate Attributes [1]: [sum(total_sum#31)#36]
+Results [6]: [sum(total_sum#31)#36 AS total_sum#37, s_state#27, null AS s_county#38, 0 AS g_state#39, 1 AS g_county#40, 1 AS lochierarchy#41]
 
 (43) ReusedExchange [Reuses operator id: 36]
-Output [3]: [s_state#8, s_county#7, sum#39]
+Output [3]: [s_state#42, s_county#43, sum#44]
 
 (44) HashAggregate [codegen id : 28]
-Input [3]: [s_state#8, s_county#7, sum#39]
-Keys [2]: [s_state#8, s_county#7]
-Functions [1]: [sum(UnscaledValue(ss_net_profit#2))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_profit#2))#22]
-Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#2))#22,17,2) AS total_sum#28]
+Input [3]: [s_state#42, s_county#43, sum#44]
+Keys [2]: [s_state#42, s_county#43]
+Functions [1]: [sum(UnscaledValue(ss_net_profit#45))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ss_net_profit#45))#22]
+Results [1]: [MakeDecimal(sum(UnscaledValue(ss_net_profit#45))#22,17,2) AS total_sum#46]
 
 (45) HashAggregate [codegen id : 28]
-Input [1]: [total_sum#28]
+Input [1]: [total_sum#46]
 Keys: []
-Functions [1]: [partial_sum(total_sum#28)]
-Aggregate Attributes [2]: [sum#40, isEmpty#41]
-Results [2]: [sum#42, isEmpty#43]
+Functions [1]: [partial_sum(total_sum#46)]
+Aggregate Attributes [2]: [sum#47, isEmpty#48]
+Results [2]: [sum#49, isEmpty#50]
 
 (46) Exchange
-Input [2]: [sum#42, isEmpty#43]
+Input [2]: [sum#49, isEmpty#50]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=7]
 
 (47) HashAggregate [codegen id : 29]
-Input [2]: [sum#42, isEmpty#43]
+Input [2]: [sum#49, isEmpty#50]
 Keys: []
-Functions [1]: [sum(total_sum#28)]
-Aggregate Attributes [1]: [sum(total_sum#28)#44]
-Results [6]: [sum(total_sum#28)#44 AS total_sum#45, null AS s_state#46, null AS s_county#47, 1 AS g_state#48, 1 AS g_county#49, 2 AS lochierarchy#50]
+Functions [1]: [sum(total_sum#46)]
+Aggregate Attributes [1]: [sum(total_sum#46)#51]
+Results [6]: [sum(total_sum#46)#51 AS total_sum#52, null AS s_state#53, null AS s_county#54, 1 AS g_state#55, 1 AS g_county#56, 2 AS lochierarchy#57]
 
 (48) Union
 
@@ -309,27 +309,27 @@ Input [6]: [total_sum#23, s_state#8, s_county#7, g_state#24, g_county#25, lochie
 Keys [6]: [total_sum#23, s_state#8, s_county#7, g_state#24, g_county#25, lochierarchy#26]
 Functions: []
 Aggregate Attributes: []
-Results [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, CASE WHEN (g_county#25 = 0) THEN s_state#8 END AS _w0#51]
+Results [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, CASE WHEN (g_county#25 = 0) THEN s_state#8 END AS _w0#58]
 
 (52) Exchange
-Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#51]
-Arguments: hashpartitioning(lochierarchy#26, _w0#51, 5), ENSURE_REQUIREMENTS, [plan_id=9]
+Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#58]
+Arguments: hashpartitioning(lochierarchy#26, _w0#58, 5), ENSURE_REQUIREMENTS, [plan_id=9]
 
 (53) Sort [codegen id : 32]
-Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#51]
-Arguments: [lochierarchy#26 ASC NULLS FIRST, _w0#51 ASC NULLS FIRST, total_sum#23 DESC NULLS LAST], false, 0
+Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#58]
+Arguments: [lochierarchy#26 ASC NULLS FIRST, _w0#58 ASC NULLS FIRST, total_sum#23 DESC NULLS LAST], false, 0
 
 (54) Window
-Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#51]
-Arguments: [rank(total_sum#23) windowspecdefinition(lochierarchy#26, _w0#51, total_sum#23 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#52], [lochierarchy#26, _w0#51], [total_sum#23 DESC NULLS LAST]
+Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#58]
+Arguments: [rank(total_sum#23) windowspecdefinition(lochierarchy#26, _w0#58, total_sum#23 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#59], [lochierarchy#26, _w0#58], [total_sum#23 DESC NULLS LAST]
 
 (55) Project [codegen id : 33]
-Output [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, rank_within_parent#52]
-Input [6]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#51, rank_within_parent#52]
+Output [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, rank_within_parent#59]
+Input [6]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, _w0#58, rank_within_parent#59]
 
 (56) TakeOrderedAndProject
-Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, rank_within_parent#52]
-Arguments: 100, [lochierarchy#26 DESC NULLS LAST, CASE WHEN (lochierarchy#26 = 0) THEN s_state#8 END ASC NULLS FIRST, rank_within_parent#52 ASC NULLS FIRST], [total_sum#23, s_state#8, s_county#7, lochierarchy#26, rank_within_parent#52]
+Input [5]: [total_sum#23, s_state#8, s_county#7, lochierarchy#26, rank_within_parent#59]
+Arguments: 100, [lochierarchy#26 DESC NULLS LAST, CASE WHEN (lochierarchy#26 = 0) THEN s_state#8 END ASC NULLS FIRST, rank_within_parent#59 ASC NULLS FIRST], [total_sum#23, s_state#8, s_county#7, lochierarchy#26, rank_within_parent#59]
 
 ===== Subqueries =====
 
@@ -342,22 +342,22 @@ BroadcastExchange (61)
 
 
 (57) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#5, d_month_seq#53]
+Output [2]: [d_date_sk#5, d_month_seq#60]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1212), LessThanOrEqual(d_month_seq,1223), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_month_seq:int>
 
 (58) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#5, d_month_seq#53]
+Input [2]: [d_date_sk#5, d_month_seq#60]
 
 (59) Filter [codegen id : 1]
-Input [2]: [d_date_sk#5, d_month_seq#53]
-Condition : (((isnotnull(d_month_seq#53) AND (d_month_seq#53 >= 1212)) AND (d_month_seq#53 <= 1223)) AND isnotnull(d_date_sk#5))
+Input [2]: [d_date_sk#5, d_month_seq#60]
+Condition : (((isnotnull(d_month_seq#60) AND (d_month_seq#60 >= 1212)) AND (d_month_seq#60 <= 1223)) AND isnotnull(d_date_sk#5))
 
 (60) Project [codegen id : 1]
 Output [1]: [d_date_sk#5]
-Input [2]: [d_date_sk#5, d_month_seq#53]
+Input [2]: [d_date_sk#5, d_month_seq#60]
 
 (61) BroadcastExchange
 Input [1]: [d_date_sk#5]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q77a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q77a.sf100/explain.txt
index cd95e60d7e7..655581148e4 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q77a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q77a.sf100/explain.txt
@@ -543,25 +543,25 @@ Input [8]: [channel#30, id#31, sum#100, isEmpty#101, sum#102, isEmpty#103, sum#1
 Keys [2]: [channel#30, id#31]
 Functions [3]: [sum(sales#14), sum(returns#32), sum(profit#33)]
 Aggregate Attributes [3]: [sum(sales#14)#106, sum(returns#32)#107, sum(profit#33)#108]
-Results [3]: [sum(sales#14)#106 AS sales#112, sum(returns#32)#107 AS returns#113, sum(profit#33)#108 AS profit#114]
+Results [3]: [sum(sales#14)#106 AS sales#134, sum(returns#32)#107 AS returns#135, sum(profit#33)#108 AS profit#136]
 
 (91) HashAggregate [codegen id : 73]
-Input [3]: [sales#112, returns#113, profit#114]
+Input [3]: [sales#134, returns#135, profit#136]
 Keys: []
-Functions [3]: [partial_sum(sales#112), partial_sum(returns#113), partial_sum(profit#114)]
-Aggregate Attributes [6]: [sum#134, isEmpty#135, sum#136, isEmpty#137, sum#138, isEmpty#139]
-Results [6]: [sum#140, isEmpty#141, sum#142, isEmpty#143, sum#144, isEmpty#145]
+Functions [3]: [partial_sum(sales#134), partial_sum(returns#135), partial_sum(profit#136)]
+Aggregate Attributes [6]: [sum#137, isEmpty#138, sum#139, isEmpty#140, sum#141, isEmpty#142]
+Results [6]: [sum#143, isEmpty#144, sum#145, isEmpty#146, sum#147, isEmpty#148]
 
 (92) Exchange
-Input [6]: [sum#140, isEmpty#141, sum#142, isEmpty#143, sum#144, isEmpty#145]
+Input [6]: [sum#143, isEmpty#144, sum#145, isEmpty#146, sum#147, isEmpty#148]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=14]
 
 (93) HashAggregate [codegen id : 74]
-Input [6]: [sum#140, isEmpty#141, sum#142, isEmpty#143, sum#144, isEmpty#145]
+Input [6]: [sum#143, isEmpty#144, sum#145, isEmpty#146, sum#147, isEmpty#148]
 Keys: []
-Functions [3]: [sum(sales#112), sum(returns#113), sum(profit#114)]
-Aggregate Attributes [3]: [sum(sales#112)#146, sum(returns#113)#147, sum(profit#114)#148]
-Results [5]: [null AS channel#149, null AS id#150, sum(sales#112)#146 AS sales#151, sum(returns#113)#147 AS returns#152, sum(profit#114)#148 AS profit#153]
+Functions [3]: [sum(sales#134), sum(returns#135), sum(profit#136)]
+Aggregate Attributes [3]: [sum(sales#134)#149, sum(returns#135)#150, sum(profit#136)#151]
+Results [5]: [null AS channel#152, null AS id#153, sum(sales#134)#149 AS sales#154, sum(returns#135)#150 AS returns#155, sum(profit#136)#151 AS profit#156]
 
 (94) Union
 
@@ -598,22 +598,22 @@ BroadcastExchange (103)
 
 
 (99) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#6, d_date#154]
+Output [2]: [d_date_sk#6, d_date#157]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,1998-08-04), LessThanOrEqual(d_date,1998-09-03), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date>
 
 (100) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#6, d_date#154]
+Input [2]: [d_date_sk#6, d_date#157]
 
 (101) Filter [codegen id : 1]
-Input [2]: [d_date_sk#6, d_date#154]
-Condition : (((isnotnull(d_date#154) AND (d_date#154 >= 1998-08-04)) AND (d_date#154 <= 1998-09-03)) AND isnotnull(d_date_sk#6))
+Input [2]: [d_date_sk#6, d_date#157]
+Condition : (((isnotnull(d_date#157) AND (d_date#157 >= 1998-08-04)) AND (d_date#157 <= 1998-09-03)) AND isnotnull(d_date_sk#6))
 
 (102) Project [codegen id : 1]
 Output [1]: [d_date_sk#6]
-Input [2]: [d_date_sk#6, d_date#154]
+Input [2]: [d_date_sk#6, d_date#157]
 
 (103) BroadcastExchange
 Input [1]: [d_date_sk#6]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q77a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q77a/explain.txt
index b5a00016106..908ee7831ea 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q77a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q77a/explain.txt
@@ -543,25 +543,25 @@ Input [8]: [channel#30, id#31, sum#100, isEmpty#101, sum#102, isEmpty#103, sum#1
 Keys [2]: [channel#30, id#31]
 Functions [3]: [sum(sales#14), sum(returns#32), sum(profit#33)]
 Aggregate Attributes [3]: [sum(sales#14)#106, sum(returns#32)#107, sum(profit#33)#108]
-Results [3]: [sum(sales#14)#106 AS sales#112, sum(returns#32)#107 AS returns#113, sum(profit#33)#108 AS profit#114]
+Results [3]: [sum(sales#14)#106 AS sales#134, sum(returns#32)#107 AS returns#135, sum(profit#33)#108 AS profit#136]
 
 (91) HashAggregate [codegen id : 73]
-Input [3]: [sales#112, returns#113, profit#114]
+Input [3]: [sales#134, returns#135, profit#136]
 Keys: []
-Functions [3]: [partial_sum(sales#112), partial_sum(returns#113), partial_sum(profit#114)]
-Aggregate Attributes [6]: [sum#134, isEmpty#135, sum#136, isEmpty#137, sum#138, isEmpty#139]
-Results [6]: [sum#140, isEmpty#141, sum#142, isEmpty#143, sum#144, isEmpty#145]
+Functions [3]: [partial_sum(sales#134), partial_sum(returns#135), partial_sum(profit#136)]
+Aggregate Attributes [6]: [sum#137, isEmpty#138, sum#139, isEmpty#140, sum#141, isEmpty#142]
+Results [6]: [sum#143, isEmpty#144, sum#145, isEmpty#146, sum#147, isEmpty#148]
 
 (92) Exchange
-Input [6]: [sum#140, isEmpty#141, sum#142, isEmpty#143, sum#144, isEmpty#145]
+Input [6]: [sum#143, isEmpty#144, sum#145, isEmpty#146, sum#147, isEmpty#148]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=14]
 
 (93) HashAggregate [codegen id : 74]
-Input [6]: [sum#140, isEmpty#141, sum#142, isEmpty#143, sum#144, isEmpty#145]
+Input [6]: [sum#143, isEmpty#144, sum#145, isEmpty#146, sum#147, isEmpty#148]
 Keys: []
-Functions [3]: [sum(sales#112), sum(returns#113), sum(profit#114)]
-Aggregate Attributes [3]: [sum(sales#112)#146, sum(returns#113)#147, sum(profit#114)#148]
-Results [5]: [null AS channel#149, null AS id#150, sum(sales#112)#146 AS sales#151, sum(returns#113)#147 AS returns#152, sum(profit#114)#148 AS profit#153]
+Functions [3]: [sum(sales#134), sum(returns#135), sum(profit#136)]
+Aggregate Attributes [3]: [sum(sales#134)#149, sum(returns#135)#150, sum(profit#136)#151]
+Results [5]: [null AS channel#152, null AS id#153, sum(sales#134)#149 AS sales#154, sum(returns#135)#150 AS returns#155, sum(profit#136)#151 AS profit#156]
 
 (94) Union
 
@@ -598,22 +598,22 @@ BroadcastExchange (103)
 
 
 (99) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#6, d_date#154]
+Output [2]: [d_date_sk#6, d_date#157]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,1998-08-04), LessThanOrEqual(d_date,1998-09-03), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date>
 
 (100) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#6, d_date#154]
+Input [2]: [d_date_sk#6, d_date#157]
 
 (101) Filter [codegen id : 1]
-Input [2]: [d_date_sk#6, d_date#154]
-Condition : (((isnotnull(d_date#154) AND (d_date#154 >= 1998-08-04)) AND (d_date#154 <= 1998-09-03)) AND isnotnull(d_date_sk#6))
+Input [2]: [d_date_sk#6, d_date#157]
+Condition : (((isnotnull(d_date#157) AND (d_date#157 >= 1998-08-04)) AND (d_date#157 <= 1998-09-03)) AND isnotnull(d_date_sk#6))
 
 (102) Project [codegen id : 1]
 Output [1]: [d_date_sk#6]
-Input [2]: [d_date_sk#6, d_date#154]
+Input [2]: [d_date_sk#6, d_date#157]
 
 (103) BroadcastExchange
 Input [1]: [d_date_sk#6]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q80a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q80a.sf100/explain.txt
index 2c3bbda04d1..edb7e3f3de1 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q80a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q80a.sf100/explain.txt
@@ -694,134 +694,134 @@ Aggregate Attributes [3]: [sum(sales#40)#125, sum(returns#41)#126, sum(profit#42
 Results [5]: [channel#38, id#39, cast(sum(sales#40)#125 as decimal(37,2)) AS sales#128, cast(sum(returns#41)#126 as decimal(38,2)) AS returns#129, cast(sum(profit#42)#127 as decimal(38,2)) AS profit#130]
 
 (106) ReusedExchange [Reuses operator id: 38]
-Output [6]: [s_store_id#24, sum#131, sum#132, isEmpty#133, sum#134, isEmpty#135]
+Output [6]: [s_store_id#131, sum#132, sum#133, isEmpty#134, sum#135, isEmpty#136]
 
 (107) HashAggregate [codegen id : 42]
-Input [6]: [s_store_id#24, sum#131, sum#132, isEmpty#133, sum#134, isEmpty#135]
-Keys [1]: [s_store_id#24]
-Functions [3]: [sum(UnscaledValue(ss_ext_sales_price#5)), sum(coalesce(cast(sr_return_amt#15 as decimal(12,2)), 0.00)), sum((ss_net_profit#6 - coalesce(cast(sr_net_loss#16 as decimal(12,2)), 0.00)))]
-Aggregate Attributes [3]: [sum(UnscaledValue(ss_ext_sales_price#5))#35, sum(coalesce(cast(sr_return_amt#15 as decimal(12,2)), 0.00))#36, sum((ss_net_profit#6 - coalesce(cast(sr_net_loss#16 as decimal(12,2)), 0.00)))#37]
-Results [5]: [store channel AS channel#38, concat(store, s_store_id#24) AS id#39, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#5))#35,17,2) AS sales#40, sum(coalesce(cast(sr_return_amt#15 as decimal(12,2)), 0.00))#36 AS returns#41, sum((ss_net_profit#6 - coalesce(cast(sr_net_loss#16 as decimal(12,2)), 0.00)))#37 AS profit#42]
+Input [6]: [s_store_id#131, sum#132, sum#133, isEmpty#134, sum#135, isEmpty#136]
+Keys [1]: [s_store_id#131]
+Functions [3]: [sum(UnscaledValue(ss_ext_sales_price#137)), sum(coalesce(cast(sr_return_amt#138 as decimal(12,2)), 0.00)), sum((ss_net_profit#139 - coalesce(cast(sr_net_loss#140 as decimal(12,2)), 0.00)))]
+Aggregate Attributes [3]: [sum(UnscaledValue(ss_ext_sales_price#137))#35, sum(coalesce(cast(sr_return_amt#138 as decimal(12,2)), 0.00))#36, sum((ss_net_profit#139 - coalesce(cast(sr_net_loss#140 as decimal(12,2)), 0.00)))#37]
+Results [5]: [store channel AS channel#38, concat(store, s_store_id#131) AS id#39, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#137))#35,17,2) AS sales#40, sum(coalesce(cast(sr_return_amt#138 as decimal(12,2)), 0.00))#36 AS returns#41, sum((ss_net_profit#139 - coalesce(cast(sr_net_loss#140 as decimal(12,2)), 0.00)))#37 AS profit#42]
 
 (108) ReusedExchange [Reuses operator id: 69]
-Output [6]: [cp_catalog_page_id#59, sum#136, sum#137, isEmpty#138, sum#139, isEmpty#140]
+Output [6]: [cp_catalog_page_id#141, sum#142, sum#143, isEmpty#144, sum#145, isEmpty#146]
 
 (109) HashAggregate [codegen id : 52]
-Input [6]: [cp_catalog_page_id#59, sum#136, sum#137, isEmpty#138, sum#139, isEmpty#140]
-Keys [1]: [cp_catalog_page_id#59]
-Functions [3]: [sum(UnscaledValue(cs_ext_sales_price#47)), sum(coalesce(cast(cr_return_amount#52 as decimal(12,2)), 0.00)), sum((cs_net_profit#48 - coalesce(cast(cr_net_loss#53 as decimal(12,2)), 0.00)))]
-Aggregate Attributes [3]: [sum(UnscaledValue(cs_ext_sales_price#47))#70, sum(coalesce(cast(cr_return_amount#52 as decimal(12,2)), 0.00))#71, sum((cs_net_profit#48 - coalesce(cast(cr_net_loss#53 as decimal(12,2)), 0.00)))#72]
-Results [5]: [catalog channel AS channel#73, concat(catalog_page, cp_catalog_page_id#59) AS id#74, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#47))#70,17,2) AS sales#75, sum(coalesce(cast(cr_return_amount#52 as decimal(12,2)), 0.00))#71 AS returns#76, sum((cs_net_profit#48 - coalesce(cast(cr_net_loss#53 as decimal(12,2)), 0.00)))#72 AS profit#77]
+Input [6]: [cp_catalog_page_id#141, sum#142, sum#143, isEmpty#144, sum#145, isEmpty#146]
+Keys [1]: [cp_catalog_page_id#141]
+Functions [3]: [sum(UnscaledValue(cs_ext_sales_price#147)), sum(coalesce(cast(cr_return_amount#148 as decimal(12,2)), 0.00)), sum((cs_net_profit#149 - coalesce(cast(cr_net_loss#150 as decimal(12,2)), 0.00)))]
+Aggregate Attributes [3]: [sum(UnscaledValue(cs_ext_sales_price#147))#70, sum(coalesce(cast(cr_return_amount#148 as decimal(12,2)), 0.00))#71, sum((cs_net_profit#149 - coalesce(cast(cr_net_loss#150 as decimal(12,2)), 0.00)))#72]
+Results [5]: [catalog channel AS channel#73, concat(catalog_page, cp_catalog_page_id#141) AS id#74, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#147))#70,17,2) AS sales#75, sum(coalesce(cast(cr_return_amount#148 as decimal(12,2)), 0.00))#71 AS returns#76, sum((cs_net_profit#149 - coalesce(cast(cr_net_loss#150 as decimal(12,2)), 0.00)))#72 AS profit#77]
 
 (110) Scan parquet spark_catalog.default.web_sales
-Output [7]: [ws_item_sk#78, ws_web_site_sk#79, ws_promo_sk#80, ws_order_number#81, ws_ext_sales_price#82, ws_net_profit#83, ws_sold_date_sk#84]
+Output [7]: [ws_item_sk#151, ws_web_site_sk#152, ws_promo_sk#153, ws_order_number#154, ws_ext_sales_price#155, ws_net_profit#156, ws_sold_date_sk#157]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ws_sold_date_sk#84), dynamicpruningexpression(ws_sold_date_sk#84 IN dynamicpruning#8)]
+PartitionFilters: [isnotnull(ws_sold_date_sk#157), dynamicpruningexpression(ws_sold_date_sk#157 IN dynamicpruning#8)]
 PushedFilters: [IsNotNull(ws_web_site_sk), IsNotNull(ws_item_sk), IsNotNull(ws_promo_sk)]
 ReadSchema: struct<ws_item_sk:int,ws_web_site_sk:int,ws_promo_sk:int,ws_order_number:int,ws_ext_sales_price:decimal(7,2),ws_net_profit:decimal(7,2)>
 
 (111) ColumnarToRow [codegen id : 53]
-Input [7]: [ws_item_sk#78, ws_web_site_sk#79, ws_promo_sk#80, ws_order_number#81, ws_ext_sales_price#82, ws_net_profit#83, ws_sold_date_sk#84]
+Input [7]: [ws_item_sk#151, ws_web_site_sk#152, ws_promo_sk#153, ws_order_number#154, ws_ext_sales_price#155, ws_net_profit#156, ws_sold_date_sk#157]
 
 (112) Filter [codegen id : 53]
-Input [7]: [ws_item_sk#78, ws_web_site_sk#79, ws_promo_sk#80, ws_order_number#81, ws_ext_sales_price#82, ws_net_profit#83, ws_sold_date_sk#84]
-Condition : ((isnotnull(ws_web_site_sk#79) AND isnotnull(ws_item_sk#78)) AND isnotnull(ws_promo_sk#80))
+Input [7]: [ws_item_sk#151, ws_web_site_sk#152, ws_promo_sk#153, ws_order_number#154, ws_ext_sales_price#155, ws_net_profit#156, ws_sold_date_sk#157]
+Condition : ((isnotnull(ws_web_site_sk#152) AND isnotnull(ws_item_sk#151)) AND isnotnull(ws_promo_sk#153))
 
 (113) Exchange
-Input [7]: [ws_item_sk#78, ws_web_site_sk#79, ws_promo_sk#80, ws_order_number#81, ws_ext_sales_price#82, ws_net_profit#83, ws_sold_date_sk#84]
-Arguments: hashpartitioning(ws_item_sk#78, ws_order_number#81, 5), ENSURE_REQUIREMENTS, [plan_id=16]
+Input [7]: [ws_item_sk#151, ws_web_site_sk#152, ws_promo_sk#153, ws_order_number#154, ws_ext_sales_price#155, ws_net_profit#156, ws_sold_date_sk#157]
+Arguments: hashpartitioning(ws_item_sk#151, ws_order_number#154, 5), ENSURE_REQUIREMENTS, [plan_id=16]
 
 (114) Sort [codegen id : 54]
-Input [7]: [ws_item_sk#78, ws_web_site_sk#79, ws_promo_sk#80, ws_order_number#81, ws_ext_sales_price#82, ws_net_profit#83, ws_sold_date_sk#84]
-Arguments: [ws_item_sk#78 ASC NULLS FIRST, ws_order_number#81 ASC NULLS FIRST], false, 0
+Input [7]: [ws_item_sk#151, ws_web_site_sk#152, ws_promo_sk#153, ws_order_number#154, ws_ext_sales_price#155, ws_net_profit#156, ws_sold_date_sk#157]
+Arguments: [ws_item_sk#151 ASC NULLS FIRST, ws_order_number#154 ASC NULLS FIRST], false, 0
 
 (115) ReusedExchange [Reuses operator id: 80]
-Output [4]: [wr_item_sk#85, wr_order_number#86, wr_return_amt#87, wr_net_loss#88]
+Output [4]: [wr_item_sk#158, wr_order_number#159, wr_return_amt#160, wr_net_loss#161]
 
 (116) Sort [codegen id : 56]
-Input [4]: [wr_item_sk#85, wr_order_number#86, wr_return_amt#87, wr_net_loss#88]
-Arguments: [wr_item_sk#85 ASC NULLS FIRST, wr_order_number#86 ASC NULLS FIRST], false, 0
+Input [4]: [wr_item_sk#158, wr_order_number#159, wr_return_amt#160, wr_net_loss#161]
+Arguments: [wr_item_sk#158 ASC NULLS FIRST, wr_order_number#159 ASC NULLS FIRST], false, 0
 
 (117) SortMergeJoin [codegen id : 61]
-Left keys [2]: [ws_item_sk#78, ws_order_number#81]
-Right keys [2]: [wr_item_sk#85, wr_order_number#86]
+Left keys [2]: [ws_item_sk#151, ws_order_number#154]
+Right keys [2]: [wr_item_sk#158, wr_order_number#159]
 Join type: LeftOuter
 Join condition: None
 
 (118) Project [codegen id : 61]
-Output [8]: [ws_item_sk#78, ws_web_site_sk#79, ws_promo_sk#80, ws_ext_sales_price#82, ws_net_profit#83, ws_sold_date_sk#84, wr_return_amt#87, wr_net_loss#88]
-Input [11]: [ws_item_sk#78, ws_web_site_sk#79, ws_promo_sk#80, ws_order_number#81, ws_ext_sales_price#82, ws_net_profit#83, ws_sold_date_sk#84, wr_item_sk#85, wr_order_number#86, wr_return_amt#87, wr_net_loss#88]
+Output [8]: [ws_item_sk#151, ws_web_site_sk#152, ws_promo_sk#153, ws_ext_sales_price#155, ws_net_profit#156, ws_sold_date_sk#157, wr_return_amt#160, wr_net_loss#161]
+Input [11]: [ws_item_sk#151, ws_web_site_sk#152, ws_promo_sk#153, ws_order_number#154, ws_ext_sales_price#155, ws_net_profit#156, ws_sold_date_sk#157, wr_item_sk#158, wr_order_number#159, wr_return_amt#160, wr_net_loss#161]
 
 (119) ReusedExchange [Reuses operator id: 18]
-Output [1]: [i_item_sk#90]
+Output [1]: [i_item_sk#162]
 
 (120) BroadcastHashJoin [codegen id : 61]
-Left keys [1]: [ws_item_sk#78]
-Right keys [1]: [i_item_sk#90]
+Left keys [1]: [ws_item_sk#151]
+Right keys [1]: [i_item_sk#162]
 Join type: Inner
 Join condition: None
 
 (121) Project [codegen id : 61]
-Output [7]: [ws_web_site_sk#79, ws_promo_sk#80, ws_ext_sales_price#82, ws_net_profit#83, ws_sold_date_sk#84, wr_return_amt#87, wr_net_loss#88]
-Input [9]: [ws_item_sk#78, ws_web_site_sk#79, ws_promo_sk#80, ws_ext_sales_price#82, ws_net_profit#83, ws_sold_date_sk#84, wr_return_amt#87, wr_net_loss#88, i_item_sk#90]
+Output [7]: [ws_web_site_sk#152, ws_promo_sk#153, ws_ext_sales_price#155, ws_net_profit#156, ws_sold_date_sk#157, wr_return_amt#160, wr_net_loss#161]
+Input [9]: [ws_item_sk#151, ws_web_site_sk#152, ws_promo_sk#153, ws_ext_sales_price#155, ws_net_profit#156, ws_sold_date_sk#157, wr_return_amt#160, wr_net_loss#161, i_item_sk#162]
 
 (122) ReusedExchange [Reuses operator id: 25]
-Output [1]: [p_promo_sk#91]
+Output [1]: [p_promo_sk#163]
 
 (123) BroadcastHashJoin [codegen id : 61]
-Left keys [1]: [ws_promo_sk#80]
-Right keys [1]: [p_promo_sk#91]
+Left keys [1]: [ws_promo_sk#153]
+Right keys [1]: [p_promo_sk#163]
 Join type: Inner
 Join condition: None
 
 (124) Project [codegen id : 61]
-Output [6]: [ws_web_site_sk#79, ws_ext_sales_price#82, ws_net_profit#83, ws_sold_date_sk#84, wr_return_amt#87, wr_net_loss#88]
-Input [8]: [ws_web_site_sk#79, ws_promo_sk#80, ws_ext_sales_price#82, ws_net_profit#83, ws_sold_date_sk#84, wr_return_amt#87, wr_net_loss#88, p_promo_sk#91]
+Output [6]: [ws_web_site_sk#152, ws_ext_sales_price#155, ws_net_profit#156, ws_sold_date_sk#157, wr_return_amt#160, wr_net_loss#161]
+Input [8]: [ws_web_site_sk#152, ws_promo_sk#153, ws_ext_sales_price#155, ws_net_profit#156, ws_sold_date_sk#157, wr_return_amt#160, wr_net_loss#161, p_promo_sk#163]
 
 (125) ReusedExchange [Reuses operator id: 221]
-Output [1]: [d_date_sk#92]
+Output [1]: [d_date_sk#164]
 
 (126) BroadcastHashJoin [codegen id : 61]
-Left keys [1]: [ws_sold_date_sk#84]
-Right keys [1]: [d_date_sk#92]
+Left keys [1]: [ws_sold_date_sk#157]
+Right keys [1]: [d_date_sk#164]
 Join type: Inner
 Join condition: None
 
 (127) Project [codegen id : 61]
-Output [5]: [ws_web_site_sk#79, ws_ext_sales_price#82, ws_net_profit#83, wr_return_amt#87, wr_net_loss#88]
-Input [7]: [ws_web_site_sk#79, ws_ext_sales_price#82, ws_net_profit#83, ws_sold_date_sk#84, wr_return_amt#87, wr_net_loss#88, d_date_sk#92]
+Output [5]: [ws_web_site_sk#152, ws_ext_sales_price#155, ws_net_profit#156, wr_return_amt#160, wr_net_loss#161]
+Input [7]: [ws_web_site_sk#152, ws_ext_sales_price#155, ws_net_profit#156, ws_sold_date_sk#157, wr_return_amt#160, wr_net_loss#161, d_date_sk#164]
 
 (128) ReusedExchange [Reuses operator id: 96]
-Output [2]: [web_site_sk#93, web_site_id#94]
+Output [2]: [web_site_sk#165, web_site_id#166]
 
 (129) BroadcastHashJoin [codegen id : 61]
-Left keys [1]: [ws_web_site_sk#79]
-Right keys [1]: [web_site_sk#93]
+Left keys [1]: [ws_web_site_sk#152]
+Right keys [1]: [web_site_sk#165]
 Join type: Inner
 Join condition: None
 
 (130) Project [codegen id : 61]
-Output [5]: [ws_ext_sales_price#82, ws_net_profit#83, wr_return_amt#87, wr_net_loss#88, web_site_id#94]
-Input [7]: [ws_web_site_sk#79, ws_ext_sales_price#82, ws_net_profit#83, wr_return_amt#87, wr_net_loss#88, web_site_sk#93, web_site_id#94]
+Output [5]: [ws_ext_sales_price#155, ws_net_profit#156, wr_return_amt#160, wr_net_loss#161, web_site_id#166]
+Input [7]: [ws_web_site_sk#152, ws_ext_sales_price#155, ws_net_profit#156, wr_return_amt#160, wr_net_loss#161, web_site_sk#165, web_site_id#166]
 
 (131) HashAggregate [codegen id : 61]
-Input [5]: [ws_ext_sales_price#82, ws_net_profit#83, wr_return_amt#87, wr_net_loss#88, web_site_id#94]
-Keys [1]: [web_site_id#94]
-Functions [3]: [partial_sum(UnscaledValue(ws_ext_sales_price#82)), partial_sum(coalesce(cast(wr_return_amt#87 as decimal(12,2)), 0.00)), partial_sum((ws_net_profit#83 - coalesce(cast(wr_net_loss#88 as decimal(12,2)), 0.00)))]
-Aggregate Attributes [5]: [sum#141, sum#142, isEmpty#143, sum#144, isEmpty#145]
-Results [6]: [web_site_id#94, sum#146, sum#147, isEmpty#148, sum#149, isEmpty#150]
+Input [5]: [ws_ext_sales_price#155, ws_net_profit#156, wr_return_amt#160, wr_net_loss#161, web_site_id#166]
+Keys [1]: [web_site_id#166]
+Functions [3]: [partial_sum(UnscaledValue(ws_ext_sales_price#155)), partial_sum(coalesce(cast(wr_return_amt#160 as decimal(12,2)), 0.00)), partial_sum((ws_net_profit#156 - coalesce(cast(wr_net_loss#161 as decimal(12,2)), 0.00)))]
+Aggregate Attributes [5]: [sum#167, sum#168, isEmpty#169, sum#170, isEmpty#171]
+Results [6]: [web_site_id#166, sum#172, sum#173, isEmpty#174, sum#175, isEmpty#176]
 
 (132) Exchange
-Input [6]: [web_site_id#94, sum#146, sum#147, isEmpty#148, sum#149, isEmpty#150]
-Arguments: hashpartitioning(web_site_id#94, 5), ENSURE_REQUIREMENTS, [plan_id=17]
+Input [6]: [web_site_id#166, sum#172, sum#173, isEmpty#174, sum#175, isEmpty#176]
+Arguments: hashpartitioning(web_site_id#166, 5), ENSURE_REQUIREMENTS, [plan_id=17]
 
 (133) HashAggregate [codegen id : 62]
-Input [6]: [web_site_id#94, sum#146, sum#147, isEmpty#148, sum#149, isEmpty#150]
-Keys [1]: [web_site_id#94]
-Functions [3]: [sum(UnscaledValue(ws_ext_sales_price#82)), sum(coalesce(cast(wr_return_amt#87 as decimal(12,2)), 0.00)), sum((ws_net_profit#83 - coalesce(cast(wr_net_loss#88 as decimal(12,2)), 0.00)))]
-Aggregate Attributes [3]: [sum(UnscaledValue(ws_ext_sales_price#82))#105, sum(coalesce(cast(wr_return_amt#87 as decimal(12,2)), 0.00))#106, sum((ws_net_profit#83 - coalesce(cast(wr_net_loss#88 as decimal(12,2)), 0.00)))#107]
-Results [5]: [web channel AS channel#108, concat(web_site, web_site_id#94) AS id#109, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#82))#105,17,2) AS sales#110, sum(coalesce(cast(wr_return_amt#87 as decimal(12,2)), 0.00))#106 AS returns#111, sum((ws_net_profit#83 - coalesce(cast(wr_net_loss#88 as decimal(12,2)), 0.00)))#107 AS profit#112]
+Input [6]: [web_site_id#166, sum#172, sum#173, isEmpty#174, sum#175, isEmpty#176]
+Keys [1]: [web_site_id#166]
+Functions [3]: [sum(UnscaledValue(ws_ext_sales_price#155)), sum(coalesce(cast(wr_return_amt#160 as decimal(12,2)), 0.00)), sum((ws_net_profit#156 - coalesce(cast(wr_net_loss#161 as decimal(12,2)), 0.00)))]
+Aggregate Attributes [3]: [sum(UnscaledValue(ws_ext_sales_price#155))#105, sum(coalesce(cast(wr_return_amt#160 as decimal(12,2)), 0.00))#106, sum((ws_net_profit#156 - coalesce(cast(wr_net_loss#161 as decimal(12,2)), 0.00)))#107]
+Results [5]: [web channel AS channel#108, concat(web_site, web_site_id#166) AS id#109, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#155))#105,17,2) AS sales#110, sum(coalesce(cast(wr_return_amt#160 as decimal(12,2)), 0.00))#106 AS returns#111, sum((ws_net_profit#156 - coalesce(cast(wr_net_loss#161 as decimal(12,2)), 0.00)))#107 AS profit#112]
 
 (134) Union
 
@@ -841,255 +841,255 @@ Input [8]: [channel#38, id#39, sum#119, isEmpty#120, sum#121, isEmpty#122, sum#1
 Keys [2]: [channel#38, id#39]
 Functions [3]: [sum(sales#40), sum(returns#41), sum(profit#42)]
 Aggregate Attributes [3]: [sum(sales#40)#125, sum(returns#41)#126, sum(profit#42)#127]
-Results [4]: [channel#38, sum(sales#40)#125 AS sales#151, sum(returns#41)#126 AS returns#152, sum(profit#42)#127 AS profit#153]
+Results [4]: [channel#38, sum(sales#40)#125 AS sales#177, sum(returns#41)#126 AS returns#178, sum(profit#42)#127 AS profit#179]
 
 (138) HashAggregate [codegen id : 64]
-Input [4]: [channel#38, sales#151, returns#152, profit#153]
+Input [4]: [channel#38, sales#177, returns#178, profit#179]
 Keys [1]: [channel#38]
-Functions [3]: [partial_sum(sales#151), partial_sum(returns#152), partial_sum(profit#153)]
-Aggregate Attributes [6]: [sum#154, isEmpty#155, sum#156, isEmpty#157, sum#158, isEmpty#159]
-Results [7]: [channel#38, sum#160, isEmpty#161, sum#162, isEmpty#163, sum#164, isEmpty#165]
+Functions [3]: [partial_sum(sales#177), partial_sum(returns#178), partial_sum(profit#179)]
+Aggregate Attributes [6]: [sum#180, isEmpty#181, sum#182, isEmpty#183, sum#184, isEmpty#185]
+Results [7]: [channel#38, sum#186, isEmpty#187, sum#188, isEmpty#189, sum#190, isEmpty#191]
 
 (139) Exchange
-Input [7]: [channel#38, sum#160, isEmpty#161, sum#162, isEmpty#163, sum#164, isEmpty#165]
+Input [7]: [channel#38, sum#186, isEmpty#187, sum#188, isEmpty#189, sum#190, isEmpty#191]
 Arguments: hashpartitioning(channel#38, 5), ENSURE_REQUIREMENTS, [plan_id=19]
 
 (140) HashAggregate [codegen id : 65]
-Input [7]: [channel#38, sum#160, isEmpty#161, sum#162, isEmpty#163, sum#164, isEmpty#165]
+Input [7]: [channel#38, sum#186, isEmpty#187, sum#188, isEmpty#189, sum#190, isEmpty#191]
 Keys [1]: [channel#38]
-Functions [3]: [sum(sales#151), sum(returns#152), sum(profit#153)]
-Aggregate Attributes [3]: [sum(sales#151)#166, sum(returns#152)#167, sum(profit#153)#168]
-Results [5]: [channel#38, null AS id#169, sum(sales#151)#166 AS sales#170, sum(returns#152)#167 AS returns#171, sum(profit#153)#168 AS profit#172]
+Functions [3]: [sum(sales#177), sum(returns#178), sum(profit#179)]
+Aggregate Attributes [3]: [sum(sales#177)#192, sum(returns#178)#193, sum(profit#179)#194]
+Results [5]: [channel#38, null AS id#195, sum(sales#177)#192 AS sales#196, sum(returns#178)#193 AS returns#197, sum(profit#179)#194 AS profit#198]
 
 (141) Scan parquet spark_catalog.default.store_sales
-Output [7]: [ss_item_sk#1, ss_store_sk#2, ss_promo_sk#3, ss_ticket_number#4, ss_ext_sales_price#5, ss_net_profit#6, ss_sold_date_sk#7]
+Output [7]: [ss_item_sk#199, ss_store_sk#200, ss_promo_sk#201, ss_ticket_number#202, ss_ext_sales_price#203, ss_net_profit#204, ss_sold_date_sk#205]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(ss_sold_date_sk#7), dynamicpruningexpression(ss_sold_date_sk#7 IN dynamicpruning#8)]
+PartitionFilters: [isnotnull(ss_sold_date_sk#205), dynamicpruningexpression(ss_sold_date_sk#205 IN dynamicpruning#8)]
 PushedFilters: [IsNotNull(ss_store_sk), IsNotNull(ss_item_sk), IsNotNull(ss_promo_sk)]
 ReadSchema: struct<ss_item_sk:int,ss_store_sk:int,ss_promo_sk:int,ss_ticket_number:int,ss_ext_sales_price:decimal(7,2),ss_net_profit:decimal(7,2)>
 
 (142) ColumnarToRow [codegen id : 66]
-Input [7]: [ss_item_sk#1, ss_store_sk#2, ss_promo_sk#3, ss_ticket_number#4, ss_ext_sales_price#5, ss_net_profit#6, ss_sold_date_sk#7]
+Input [7]: [ss_item_sk#199, ss_store_sk#200, ss_promo_sk#201, ss_ticket_number#202, ss_ext_sales_price#203, ss_net_profit#204, ss_sold_date_sk#205]
 
 (143) Filter [codegen id : 66]
-Input [7]: [ss_item_sk#1, ss_store_sk#2, ss_promo_sk#3, ss_ticket_number#4, ss_ext_sales_price#5, ss_net_profit#6, ss_sold_date_sk#7]
-Condition : ((isnotnull(ss_store_sk#2) AND isnotnull(ss_item_sk#1)) AND isnotnull(ss_promo_sk#3))
+Input [7]: [ss_item_sk#199, ss_store_sk#200, ss_promo_sk#201, ss_ticket_number#202, ss_ext_sales_price#203, ss_net_profit#204, ss_sold_date_sk#205]
+Condition : ((isnotnull(ss_store_sk#200) AND isnotnull(ss_item_sk#199)) AND isnotnull(ss_promo_sk#201))
 
 (144) Exchange
-Input [7]: [ss_item_sk#1, ss_store_sk#2, ss_promo_sk#3, ss_ticket_number#4, ss_ext_sales_price#5, ss_net_profit#6, ss_sold_date_sk#7]
-Arguments: hashpartitioning(ss_item_sk#1, ss_ticket_number#4, 5), ENSURE_REQUIREMENTS, [plan_id=20]
+Input [7]: [ss_item_sk#199, ss_store_sk#200, ss_promo_sk#201, ss_ticket_number#202, ss_ext_sales_price#203, ss_net_profit#204, ss_sold_date_sk#205]
+Arguments: hashpartitioning(ss_item_sk#199, ss_ticket_number#202, 5), ENSURE_REQUIREMENTS, [plan_id=20]
 
 (145) Sort [codegen id : 67]
-Input [7]: [ss_item_sk#1, ss_store_sk#2, ss_promo_sk#3, ss_ticket_number#4, ss_ext_sales_price#5, ss_net_profit#6, ss_sold_date_sk#7]
-Arguments: [ss_item_sk#1 ASC NULLS FIRST, ss_ticket_number#4 ASC NULLS FIRST], false, 0
+Input [7]: [ss_item_sk#199, ss_store_sk#200, ss_promo_sk#201, ss_ticket_number#202, ss_ext_sales_price#203, ss_net_profit#204, ss_sold_date_sk#205]
+Arguments: [ss_item_sk#199 ASC NULLS FIRST, ss_ticket_number#202 ASC NULLS FIRST], false, 0
 
 (146) ReusedExchange [Reuses operator id: 10]
-Output [4]: [sr_item_sk#13, sr_ticket_number#14, sr_return_amt#15, sr_net_loss#16]
+Output [4]: [sr_item_sk#206, sr_ticket_number#207, sr_return_amt#208, sr_net_loss#209]
 
 (147) Sort [codegen id : 69]
-Input [4]: [sr_item_sk#13, sr_ticket_number#14, sr_return_amt#15, sr_net_loss#16]
-Arguments: [sr_item_sk#13 ASC NULLS FIRST, sr_ticket_number#14 ASC NULLS FIRST], false, 0
+Input [4]: [sr_item_sk#206, sr_ticket_number#207, sr_return_amt#208, sr_net_loss#209]
+Arguments: [sr_item_sk#206 ASC NULLS FIRST, sr_ticket_number#207 ASC NULLS FIRST], false, 0
 
 (148) SortMergeJoin [codegen id : 74]
-Left keys [2]: [ss_item_sk#1, ss_ticket_number#4]
-Right keys [2]: [sr_item_sk#13, sr_ticket_number#14]
+Left keys [2]: [ss_item_sk#199, ss_ticket_number#202]
+Right keys [2]: [sr_item_sk#206, sr_ticket_number#207]
 Join type: LeftOuter
 Join condition: None
 
 (149) Project [codegen id : 74]
-Output [8]: [ss_item_sk#1, ss_store_sk#2, ss_promo_sk#3, ss_ext_sales_price#5, ss_net_profit#6, ss_sold_date_sk#7, sr_return_amt#15, sr_net_loss#16]
-Input [11]: [ss_item_sk#1, ss_store_sk#2, ss_promo_sk#3, ss_ticket_number#4, ss_ext_sales_price#5, ss_net_profit#6, ss_sold_date_sk#7, sr_item_sk#13, sr_ticket_number#14, sr_return_amt#15, sr_net_loss#16]
+Output [8]: [ss_item_sk#199, ss_store_sk#200, ss_promo_sk#201, ss_ext_sales_price#203, ss_net_profit#204, ss_sold_date_sk#205, sr_return_amt#208, sr_net_loss#209]
+Input [11]: [ss_item_sk#199, ss_store_sk#200, ss_promo_sk#201, ss_ticket_number#202, ss_ext_sales_price#203, ss_net_profit#204, ss_sold_date_sk#205, sr_item_sk#206, sr_ticket_number#207, sr_return_amt#208, sr_net_loss#209]
 
 (150) ReusedExchange [Reuses operator id: 18]
-Output [1]: [i_item_sk#18]
+Output [1]: [i_item_sk#210]
 
 (151) BroadcastHashJoin [codegen id : 74]
-Left keys [1]: [ss_item_sk#1]
-Right keys [1]: [i_item_sk#18]
+Left keys [1]: [ss_item_sk#199]
+Right keys [1]: [i_item_sk#210]
 Join type: Inner
 Join condition: None
 
 (152) Project [codegen id : 74]
-Output [7]: [ss_store_sk#2, ss_promo_sk#3, ss_ext_sales_price#5, ss_net_profit#6, ss_sold_date_sk#7, sr_return_amt#15, sr_net_loss#16]
-Input [9]: [ss_item_sk#1, ss_store_sk#2, ss_promo_sk#3, ss_ext_sales_price#5, ss_net_profit#6, ss_sold_date_sk#7, sr_return_amt#15, sr_net_loss#16, i_item_sk#18]
+Output [7]: [ss_store_sk#200, ss_promo_sk#201, ss_ext_sales_price#203, ss_net_profit#204, ss_sold_date_sk#205, sr_return_amt#208, sr_net_loss#209]
+Input [9]: [ss_item_sk#199, ss_store_sk#200, ss_promo_sk#201, ss_ext_sales_price#203, ss_net_profit#204, ss_sold_date_sk#205, sr_return_amt#208, sr_net_loss#209, i_item_sk#210]
 
 (153) ReusedExchange [Reuses operator id: 25]
-Output [1]: [p_promo_sk#20]
+Output [1]: [p_promo_sk#211]
 
 (154) BroadcastHashJoin [codegen id : 74]
-Left keys [1]: [ss_promo_sk#3]
-Right keys [1]: [p_promo_sk#20]
+Left keys [1]: [ss_promo_sk#201]
+Right keys [1]: [p_promo_sk#211]
 Join type: Inner
 Join condition: None
 
 (155) Project [codegen id : 74]
-Output [6]: [ss_store_sk#2, ss_ext_sales_price#5, ss_net_profit#6, ss_sold_date_sk#7, sr_return_amt#15, sr_net_loss#16]
-Input [8]: [ss_store_sk#2, ss_promo_sk#3, ss_ext_sales_price#5, ss_net_profit#6, ss_sold_date_sk#7, sr_return_amt#15, sr_net_loss#16, p_promo_sk#20]
+Output [6]: [ss_store_sk#200, ss_ext_sales_price#203, ss_net_profit#204, ss_sold_date_sk#205, sr_return_amt#208, sr_net_loss#209]
+Input [8]: [ss_store_sk#200, ss_promo_sk#201, ss_ext_sales_price#203, ss_net_profit#204, ss_sold_date_sk#205, sr_return_amt#208, sr_net_loss#209, p_promo_sk#211]
 
 (156) ReusedExchange [Reuses operator id: 221]
-Output [1]: [d_date_sk#22]
+Output [1]: [d_date_sk#212]
 
 (157) BroadcastHashJoin [codegen id : 74]
-Left keys [1]: [ss_sold_date_sk#7]
-Right keys [1]: [d_date_sk#22]
+Left keys [1]: [ss_sold_date_sk#205]
+Right keys [1]: [d_date_sk#212]
 Join type: Inner
 Join condition: None
 
 (158) Project [codegen id : 74]
-Output [5]: [ss_store_sk#2, ss_ext_sales_price#5, ss_net_profit#6, sr_return_amt#15, sr_net_loss#16]
-Input [7]: [ss_store_sk#2, ss_ext_sales_price#5, ss_net_profit#6, ss_sold_date_sk#7, sr_return_amt#15, sr_net_loss#16, d_date_sk#22]
+Output [5]: [ss_store_sk#200, ss_ext_sales_price#203, ss_net_profit#204, sr_return_amt#208, sr_net_loss#209]
+Input [7]: [ss_store_sk#200, ss_ext_sales_price#203, ss_net_profit#204, ss_sold_date_sk#205, sr_return_amt#208, sr_net_loss#209, d_date_sk#212]
 
 (159) ReusedExchange [Reuses operator id: 34]
-Output [2]: [s_store_sk#23, s_store_id#24]
+Output [2]: [s_store_sk#213, s_store_id#214]
 
 (160) BroadcastHashJoin [codegen id : 74]
-Left keys [1]: [ss_store_sk#2]
-Right keys [1]: [s_store_sk#23]
+Left keys [1]: [ss_store_sk#200]
+Right keys [1]: [s_store_sk#213]
 Join type: Inner
 Join condition: None
 
 (161) Project [codegen id : 74]
-Output [5]: [ss_ext_sales_price#5, ss_net_profit#6, sr_return_amt#15, sr_net_loss#16, s_store_id#24]
-Input [7]: [ss_store_sk#2, ss_ext_sales_price#5, ss_net_profit#6, sr_return_amt#15, sr_net_loss#16, s_store_sk#23, s_store_id#24]
+Output [5]: [ss_ext_sales_price#203, ss_net_profit#204, sr_return_amt#208, sr_net_loss#209, s_store_id#214]
+Input [7]: [ss_store_sk#200, ss_ext_sales_price#203, ss_net_profit#204, sr_return_amt#208, sr_net_loss#209, s_store_sk#213, s_store_id#214]
 
 (162) HashAggregate [codegen id : 74]
-Input [5]: [ss_ext_sales_price#5, ss_net_profit#6, sr_return_amt#15, sr_net_loss#16, s_store_id#24]
-Keys [1]: [s_store_id#24]
-Functions [3]: [partial_sum(UnscaledValue(ss_ext_sales_price#5)), partial_sum(coalesce(cast(sr_return_amt#15 as decimal(12,2)), 0.00)), partial_sum((ss_net_profit#6 - coalesce(cast(sr_net_loss#16 as decimal(12,2)), 0.00)))]
-Aggregate Attributes [5]: [sum#173, sum#174, isEmpty#175, sum#176, isEmpty#177]
-Results [6]: [s_store_id#24, sum#178, sum#179, isEmpty#180, sum#181, isEmpty#182]
+Input [5]: [ss_ext_sales_price#203, ss_net_profit#204, sr_return_amt#208, sr_net_loss#209, s_store_id#214]
+Keys [1]: [s_store_id#214]
+Functions [3]: [partial_sum(UnscaledValue(ss_ext_sales_price#203)), partial_sum(coalesce(cast(sr_return_amt#208 as decimal(12,2)), 0.00)), partial_sum((ss_net_profit#204 - coalesce(cast(sr_net_loss#209 as decimal(12,2)), 0.00)))]
+Aggregate Attributes [5]: [sum#215, sum#216, isEmpty#217, sum#218, isEmpty#219]
+Results [6]: [s_store_id#214, sum#220, sum#221, isEmpty#222, sum#223, isEmpty#224]
 
 (163) Exchange
-Input [6]: [s_store_id#24, sum#178, sum#179, isEmpty#180, sum#181, isEmpty#182]
-Arguments: hashpartitioning(s_store_id#24, 5), ENSURE_REQUIREMENTS, [plan_id=21]
+Input [6]: [s_store_id#214, sum#220, sum#221, isEmpty#222, sum#223, isEmpty#224]
+Arguments: hashpartitioning(s_store_id#214, 5), ENSURE_REQUIREMENTS, [plan_id=21]
 
 (164) HashAggregate [codegen id : 75]
-Input [6]: [s_store_id#24, sum#178, sum#179, isEmpty#180, sum#181, isEmpty#182]
-Keys [1]: [s_store_id#24]
-Functions [3]: [sum(UnscaledValue(ss_ext_sales_price#5)), sum(coalesce(cast(sr_return_amt#15 as decimal(12,2)), 0.00)), sum((ss_net_profit#6 - coalesce(cast(sr_net_loss#16 as decimal(12,2)), 0.00)))]
-Aggregate Attributes [3]: [sum(UnscaledValue(ss_ext_sales_price#5))#35, sum(coalesce(cast(sr_return_amt#15 as decimal(12,2)), 0.00))#36, sum((ss_net_profit#6 - coalesce(cast(sr_net_loss#16 as decimal(12,2)), 0.00)))#37]
-Results [5]: [store channel AS channel#38, concat(store, s_store_id#24) AS id#39, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#5))#35,17,2) AS sales#40, sum(coalesce(cast(sr_return_amt#15 as decimal(12,2)), 0.00))#36 AS returns#41, sum((ss_net_profit#6 - coalesce(cast(sr_net_loss#16 as decimal(12,2)), 0.00)))#37 AS profit#42]
+Input [6]: [s_store_id#214, sum#220, sum#221, isEmpty#222, sum#223, isEmpty#224]
+Keys [1]: [s_store_id#214]
+Functions [3]: [sum(UnscaledValue(ss_ext_sales_price#203)), sum(coalesce(cast(sr_return_amt#208 as decimal(12,2)), 0.00)), sum((ss_net_profit#204 - coalesce(cast(sr_net_loss#209 as decimal(12,2)), 0.00)))]
+Aggregate Attributes [3]: [sum(UnscaledValue(ss_ext_sales_price#203))#35, sum(coalesce(cast(sr_return_amt#208 as decimal(12,2)), 0.00))#36, sum((ss_net_profit#204 - coalesce(cast(sr_net_loss#209 as decimal(12,2)), 0.00)))#37]
+Results [5]: [store channel AS channel#38, concat(store, s_store_id#214) AS id#39, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#203))#35,17,2) AS sales#40, sum(coalesce(cast(sr_return_amt#208 as decimal(12,2)), 0.00))#36 AS returns#41, sum((ss_net_profit#204 - coalesce(cast(sr_net_loss#209 as decimal(12,2)), 0.00)))#37 AS profit#42]
 
 (165) Scan parquet spark_catalog.default.catalog_sales
-Output [7]: [cs_catalog_page_sk#43, cs_item_sk#44, cs_promo_sk#45, cs_order_number#46, cs_ext_sales_price#47, cs_net_profit#48, cs_sold_date_sk#49]
+Output [7]: [cs_catalog_page_sk#225, cs_item_sk#226, cs_promo_sk#227, cs_order_number#228, cs_ext_sales_price#229, cs_net_profit#230, cs_sold_date_sk#231]
 Batched: true
 Location: InMemoryFileIndex []
-PartitionFilters: [isnotnull(cs_sold_date_sk#49), dynamicpruningexpression(cs_sold_date_sk#49 IN dynamicpruning#8)]
+PartitionFilters: [isnotnull(cs_sold_date_sk#231), dynamicpruningexpression(cs_sold_date_sk#231 IN dynamicpruning#8)]
 PushedFilters: [IsNotNull(cs_catalog_page_sk), IsNotNull(cs_item_sk), IsNotNull(cs_promo_sk)]
 ReadSchema: struct<cs_catalog_page_sk:int,cs_item_sk:int,cs_promo_sk:int,cs_order_number:int,cs_ext_sales_price:decimal(7,2),cs_net_profit:decimal(7,2)>
 
 (166) ColumnarToRow [codegen id : 76]
-Input [7]: [cs_catalog_page_sk#43, cs_item_sk#44, cs_promo_sk#45, cs_order_number#46, cs_ext_sales_price#47, cs_net_profit#48, cs_sold_date_sk#49]
+Input [7]: [cs_catalog_page_sk#225, cs_item_sk#226, cs_promo_sk#227, cs_order_number#228, cs_ext_sales_price#229, cs_net_profit#230, cs_sold_date_sk#231]
 
 (167) Filter [codegen id : 76]
-Input [7]: [cs_catalog_page_sk#43, cs_item_sk#44, cs_promo_sk#45, cs_order_number#46, cs_ext_sales_price#47, cs_net_profit#48, cs_sold_date_sk#49]
-Condition : ((isnotnull(cs_catalog_page_sk#43) AND isnotnull(cs_item_sk#44)) AND isnotnull(cs_promo_sk#45))
+Input [7]: [cs_catalog_page_sk#225, cs_item_sk#226, cs_promo_sk#227, cs_order_number#228, cs_ext_sales_price#229, cs_net_profit#230, cs_sold_date_sk#231]
+Condition : ((isnotnull(cs_catalog_page_sk#225) AND isnotnull(cs_item_sk#226)) AND isnotnull(cs_promo_sk#227))
 
 (168) Exchange
-Input [7]: [cs_catalog_page_sk#43, cs_item_sk#44, cs_promo_sk#45, cs_order_number#46, cs_ext_sales_price#47, cs_net_profit#48, cs_sold_date_sk#49]
-Arguments: hashpartitioning(cs_item_sk#44, cs_order_number#46, 5), ENSURE_REQUIREMENTS, [plan_id=22]
+Input [7]: [cs_catalog_page_sk#225, cs_item_sk#226, cs_promo_sk#227, cs_order_number#228, cs_ext_sales_price#229, cs_net_profit#230, cs_sold_date_sk#231]
+Arguments: hashpartitioning(cs_item_sk#226, cs_order_number#228, 5), ENSURE_REQUIREMENTS, [plan_id=22]
 
 (169) Sort [codegen id : 77]
-Input [7]: [cs_catalog_page_sk#43, cs_item_sk#44, cs_promo_sk#45, cs_order_number#46, cs_ext_sales_price#47, cs_net_profit#48, cs_sold_date_sk#49]
-Arguments: [cs_item_sk#44 ASC NULLS FIRST, cs_order_number#46 ASC NULLS FIRST], false, 0
+Input [7]: [cs_catalog_page_sk#225, cs_item_sk#226, cs_promo_sk#227, cs_order_number#228, cs_ext_sales_price#229, cs_net_profit#230, cs_sold_date_sk#231]
+Arguments: [cs_item_sk#226 ASC NULLS FIRST, cs_order_number#228 ASC NULLS FIRST], false, 0
 
 (170) ReusedExchange [Reuses operator id: 49]
-Output [4]: [cr_item_sk#50, cr_order_number#51, cr_return_amount#52, cr_net_loss#53]
+Output [4]: [cr_item_sk#232, cr_order_number#233, cr_return_amount#234, cr_net_loss#235]
 
 (171) Sort [codegen id : 79]
-Input [4]: [cr_item_sk#50, cr_order_number#51, cr_return_amount#52, cr_net_loss#53]
-Arguments: [cr_item_sk#50 ASC NULLS FIRST, cr_order_number#51 ASC NULLS FIRST], false, 0
+Input [4]: [cr_item_sk#232, cr_order_number#233, cr_return_amount#234, cr_net_loss#235]
+Arguments: [cr_item_sk#232 ASC NULLS FIRST, cr_order_number#233 ASC NULLS FIRST], false, 0
 
 (172) SortMergeJoin [codegen id : 84]
-Left keys [2]: [cs_item_sk#44, cs_order_number#46]
-Right keys [2]: [cr_item_sk#50, cr_order_number#51]
+Left keys [2]: [cs_item_sk#226, cs_order_number#228]
+Right keys [2]: [cr_item_sk#232, cr_order_number#233]
 Join type: LeftOuter
 Join condition: None
 
 (173) Project [codegen id : 84]
-Output [8]: [cs_catalog_page_sk#43, cs_item_sk#44, cs_promo_sk#45, cs_ext_sales_price#47, cs_net_profit#48, cs_sold_date_sk#49, cr_return_amount#52, cr_net_loss#53]
-Input [11]: [cs_catalog_page_sk#43, cs_item_sk#44, cs_promo_sk#45, cs_order_number#46, cs_ext_sales_price#47, cs_net_profit#48, cs_sold_date_sk#49, cr_item_sk#50, cr_order_number#51, cr_return_amount#52, cr_net_loss#53]
+Output [8]: [cs_catalog_page_sk#225, cs_item_sk#226, cs_promo_sk#227, cs_ext_sales_price#229, cs_net_profit#230, cs_sold_date_sk#231, cr_return_amount#234, cr_net_loss#235]
+Input [11]: [cs_catalog_page_sk#225, cs_item_sk#226, cs_promo_sk#227, cs_order_number#228, cs_ext_sales_price#229, cs_net_profit#230, cs_sold_date_sk#231, cr_item_sk#232, cr_order_number#233, cr_return_amount#234, cr_net_loss#235]
 
 (174) ReusedExchange [Reuses operator id: 18]
-Output [1]: [i_item_sk#55]
+Output [1]: [i_item_sk#236]
 
 (175) BroadcastHashJoin [codegen id : 84]
-Left keys [1]: [cs_item_sk#44]
-Right keys [1]: [i_item_sk#55]
+Left keys [1]: [cs_item_sk#226]
+Right keys [1]: [i_item_sk#236]
 Join type: Inner
 Join condition: None
 
 (176) Project [codegen id : 84]
-Output [7]: [cs_catalog_page_sk#43, cs_promo_sk#45, cs_ext_sales_price#47, cs_net_profit#48, cs_sold_date_sk#49, cr_return_amount#52, cr_net_loss#53]
-Input [9]: [cs_catalog_page_sk#43, cs_item_sk#44, cs_promo_sk#45, cs_ext_sales_price#47, cs_net_profit#48, cs_sold_date_sk#49, cr_return_amount#52, cr_net_loss#53, i_item_sk#55]
+Output [7]: [cs_catalog_page_sk#225, cs_promo_sk#227, cs_ext_sales_price#229, cs_net_profit#230, cs_sold_date_sk#231, cr_return_amount#234, cr_net_loss#235]
+Input [9]: [cs_catalog_page_sk#225, cs_item_sk#226, cs_promo_sk#227, cs_ext_sales_price#229, cs_net_profit#230, cs_sold_date_sk#231, cr_return_amount#234, cr_net_loss#235, i_item_sk#236]
 
 (177) ReusedExchange [Reuses operator id: 25]
-Output [1]: [p_promo_sk#56]
+Output [1]: [p_promo_sk#237]
 
 (178) BroadcastHashJoin [codegen id : 84]
-Left keys [1]: [cs_promo_sk#45]
-Right keys [1]: [p_promo_sk#56]
+Left keys [1]: [cs_promo_sk#227]
+Right keys [1]: [p_promo_sk#237]
 Join type: Inner
 Join condition: None
 
 (179) Project [codegen id : 84]
-Output [6]: [cs_catalog_page_sk#43, cs_ext_sales_price#47, cs_net_profit#48, cs_sold_date_sk#49, cr_return_amount#52, cr_net_loss#53]
-Input [8]: [cs_catalog_page_sk#43, cs_promo_sk#45, cs_ext_sales_price#47, cs_net_profit#48, cs_sold_date_sk#49, cr_return_amount#52, cr_net_loss#53, p_promo_sk#56]
+Output [6]: [cs_catalog_page_sk#225, cs_ext_sales_price#229, cs_net_profit#230, cs_sold_date_sk#231, cr_return_amount#234, cr_net_loss#235]
+Input [8]: [cs_catalog_page_sk#225, cs_promo_sk#227, cs_ext_sales_price#229, cs_net_profit#230, cs_sold_date_sk#231, cr_return_amount#234, cr_net_loss#235, p_promo_sk#237]
 
 (180) ReusedExchange [Reuses operator id: 221]
-Output [1]: [d_date_sk#57]
+Output [1]: [d_date_sk#238]
 
 (181) BroadcastHashJoin [codegen id : 84]
-Left keys [1]: [cs_sold_date_sk#49]
-Right keys [1]: [d_date_sk#57]
+Left keys [1]: [cs_sold_date_sk#231]
+Right keys [1]: [d_date_sk#238]
 Join type: Inner
 Join condition: None
 
 (182) Project [codegen id : 84]
-Output [5]: [cs_catalog_page_sk#43, cs_ext_sales_price#47, cs_net_profit#48, cr_return_amount#52, cr_net_loss#53]
-Input [7]: [cs_catalog_page_sk#43, cs_ext_sales_price#47, cs_net_profit#48, cs_sold_date_sk#49, cr_return_amount#52, cr_net_loss#53, d_date_sk#57]
+Output [5]: [cs_catalog_page_sk#225, cs_ext_sales_price#229, cs_net_profit#230, cr_return_amount#234, cr_net_loss#235]
+Input [7]: [cs_catalog_page_sk#225, cs_ext_sales_price#229, cs_net_profit#230, cs_sold_date_sk#231, cr_return_amount#234, cr_net_loss#235, d_date_sk#238]
 
 (183) ReusedExchange [Reuses operator id: 65]
-Output [2]: [cp_catalog_page_sk#58, cp_catalog_page_id#59]
+Output [2]: [cp_catalog_page_sk#239, cp_catalog_page_id#240]
 
 (184) BroadcastHashJoin [codegen id : 84]
-Left keys [1]: [cs_catalog_page_sk#43]
-Right keys [1]: [cp_catalog_page_sk#58]
+Left keys [1]: [cs_catalog_page_sk#225]
+Right keys [1]: [cp_catalog_page_sk#239]
 Join type: Inner
 Join condition: None
 
 (185) Project [codegen id : 84]
-Output [5]: [cs_ext_sales_price#47, cs_net_profit#48, cr_return_amount#52, cr_net_loss#53, cp_catalog_page_id#59]
-Input [7]: [cs_catalog_page_sk#43, cs_ext_sales_price#47, cs_net_profit#48, cr_return_amount#52, cr_net_loss#53, cp_catalog_page_sk#58, cp_catalog_page_id#59]
+Output [5]: [cs_ext_sales_price#229, cs_net_profit#230, cr_return_amount#234, cr_net_loss#235, cp_catalog_page_id#240]
+Input [7]: [cs_catalog_page_sk#225, cs_ext_sales_price#229, cs_net_profit#230, cr_return_amount#234, cr_net_loss#235, cp_catalog_page_sk#239, cp_catalog_page_id#240]
 
 (186) HashAggregate [codegen id : 84]
-Input [5]: [cs_ext_sales_price#47, cs_net_profit#48, cr_return_amount#52, cr_net_loss#53, cp_catalog_page_id#59]
-Keys [1]: [cp_catalog_page_id#59]
-Functions [3]: [partial_sum(UnscaledValue(cs_ext_sales_price#47)), partial_sum(coalesce(cast(cr_return_amount#52 as decimal(12,2)), 0.00)), partial_sum((cs_net_profit#48 - coalesce(cast(cr_net_loss#53 as decimal(12,2)), 0.00)))]
-Aggregate Attributes [5]: [sum#183, sum#184, isEmpty#185, sum#186, isEmpty#187]
-Results [6]: [cp_catalog_page_id#59, sum#188, sum#189, isEmpty#190, sum#191, isEmpty#192]
+Input [5]: [cs_ext_sales_price#229, cs_net_profit#230, cr_return_amount#234, cr_net_loss#235, cp_catalog_page_id#240]
+Keys [1]: [cp_catalog_page_id#240]
+Functions [3]: [partial_sum(UnscaledValue(cs_ext_sales_price#229)), partial_sum(coalesce(cast(cr_return_amount#234 as decimal(12,2)), 0.00)), partial_sum((cs_net_profit#230 - coalesce(cast(cr_net_loss#235 as decimal(12,2)), 0.00)))]
+Aggregate Attributes [5]: [sum#241, sum#242, isEmpty#243, sum#244, isEmpty#245]
+Results [6]: [cp_catalog_page_id#240, sum#246, sum#247, isEmpty#248, sum#249, isEmpty#250]
 
 (187) Exchange
-Input [6]: [cp_catalog_page_id#59, sum#188, sum#189, isEmpty#190, sum#191, isEmpty#192]
-Arguments: hashpartitioning(cp_catalog_page_id#59, 5), ENSURE_REQUIREMENTS, [plan_id=23]
+Input [6]: [cp_catalog_page_id#240, sum#246, sum#247, isEmpty#248, sum#249, isEmpty#250]
+Arguments: hashpartitioning(cp_catalog_page_id#240, 5), ENSURE_REQUIREMENTS, [plan_id=23]
 
 (188) HashAggregate [codegen id : 85]
-Input [6]: [cp_catalog_page_id#59, sum#188, sum#189, isEmpty#190, sum#191, isEmpty#192]
-Keys [1]: [cp_catalog_page_id#59]
-Functions [3]: [sum(UnscaledValue(cs_ext_sales_price#47)), sum(coalesce(cast(cr_return_amount#52 as decimal(12,2)), 0.00)), sum((cs_net_profit#48 - coalesce(cast(cr_net_loss#53 as decimal(12,2)), 0.00)))]
-Aggregate Attributes [3]: [sum(UnscaledValue(cs_ext_sales_price#47))#70, sum(coalesce(cast(cr_return_amount#52 as decimal(12,2)), 0.00))#71, sum((cs_net_profit#48 - coalesce(cast(cr_net_loss#53 as decimal(12,2)), 0.00)))#72]
-Results [5]: [catalog channel AS channel#73, concat(catalog_page, cp_catalog_page_id#59) AS id#74, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#47))#70,17,2) AS sales#75, sum(coalesce(cast(cr_return_amount#52 as decimal(12,2)), 0.00))#71 AS returns#76, sum((cs_net_profit#48 - coalesce(cast(cr_net_loss#53 as decimal(12,2)), 0.00)))#72 AS profit#77]
+Input [6]: [cp_catalog_page_id#240, sum#246, sum#247, isEmpty#248, sum#249, isEmpty#250]
+Keys [1]: [cp_catalog_page_id#240]
+Functions [3]: [sum(UnscaledValue(cs_ext_sales_price#229)), sum(coalesce(cast(cr_return_amount#234 as decimal(12,2)), 0.00)), sum((cs_net_profit#230 - coalesce(cast(cr_net_loss#235 as decimal(12,2)), 0.00)))]
+Aggregate Attributes [3]: [sum(UnscaledValue(cs_ext_sales_price#229))#70, sum(coalesce(cast(cr_return_amount#234 as decimal(12,2)), 0.00))#71, sum((cs_net_profit#230 - coalesce(cast(cr_net_loss#235 as decimal(12,2)), 0.00)))#72]
+Results [5]: [catalog channel AS channel#73, concat(catalog_page, cp_catalog_page_id#240) AS id#74, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#229))#70,17,2) AS sales#75, sum(coalesce(cast(cr_return_amount#234 as decimal(12,2)), 0.00))#71 AS returns#76, sum((cs_net_profit#230 - coalesce(cast(cr_net_loss#235 as decimal(12,2)), 0.00)))#72 AS profit#77]
 
 (189) ReusedExchange [Reuses operator id: 132]
-Output [6]: [web_site_id#94, sum#193, sum#194, isEmpty#195, sum#196, isEmpty#197]
+Output [6]: [web_site_id#251, sum#252, sum#253, isEmpty#254, sum#255, isEmpty#256]
 
 (190) HashAggregate [codegen id : 95]
-Input [6]: [web_site_id#94, sum#193, sum#194, isEmpty#195, sum#196, isEmpty#197]
-Keys [1]: [web_site_id#94]
-Functions [3]: [sum(UnscaledValue(ws_ext_sales_price#82)), sum(coalesce(cast(wr_return_amt#87 as decimal(12,2)), 0.00)), sum((ws_net_profit#83 - coalesce(cast(wr_net_loss#88 as decimal(12,2)), 0.00)))]
-Aggregate Attributes [3]: [sum(UnscaledValue(ws_ext_sales_price#82))#105, sum(coalesce(cast(wr_return_amt#87 as decimal(12,2)), 0.00))#106, sum((ws_net_profit#83 - coalesce(cast(wr_net_loss#88 as decimal(12,2)), 0.00)))#107]
-Results [5]: [web channel AS channel#108, concat(web_site, web_site_id#94) AS id#109, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#82))#105,17,2) AS sales#110, sum(coalesce(cast(wr_return_amt#87 as decimal(12,2)), 0.00))#106 AS returns#111, sum((ws_net_profit#83 - coalesce(cast(wr_net_loss#88 as decimal(12,2)), 0.00)))#107 AS profit#112]
+Input [6]: [web_site_id#251, sum#252, sum#253, isEmpty#254, sum#255, isEmpty#256]
+Keys [1]: [web_site_id#251]
+Functions [3]: [sum(UnscaledValue(ws_ext_sales_price#257)), sum(coalesce(cast(wr_return_amt#258 as decimal(12,2)), 0.00)), sum((ws_net_profit#259 - coalesce(cast(wr_net_loss#260 as decimal(12,2)), 0.00)))]
+Aggregate Attributes [3]: [sum(UnscaledValue(ws_ext_sales_price#257))#105, sum(coalesce(cast(wr_return_amt#258 as decimal(12,2)), 0.00))#106, sum((ws_net_profit#259 - coalesce(cast(wr_net_loss#260 as decimal(12,2)), 0.00)))#107]
+Results [5]: [web channel AS channel#108, concat(web_site, web_site_id#251) AS id#109, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#257))#105,17,2) AS sales#110, sum(coalesce(cast(wr_return_amt#258 as decimal(12,2)), 0.00))#106 AS returns#111, sum((ws_net_profit#259 - coalesce(cast(wr_net_loss#260 as decimal(12,2)), 0.00)))#107 AS profit#112]
 
 (191) Union
 
@@ -1109,25 +1109,25 @@ Input [8]: [channel#38, id#39, sum#119, isEmpty#120, sum#121, isEmpty#122, sum#1
 Keys [2]: [channel#38, id#39]
 Functions [3]: [sum(sales#40), sum(returns#41), sum(profit#42)]
 Aggregate Attributes [3]: [sum(sales#40)#125, sum(returns#41)#126, sum(profit#42)#127]
-Results [3]: [sum(sales#40)#125 AS sales#151, sum(returns#41)#126 AS returns#152, sum(profit#42)#127 AS profit#153]
+Results [3]: [sum(sales#40)#125 AS sales#261, sum(returns#41)#126 AS returns#262, sum(profit#42)#127 AS profit#263]
 
 (195) HashAggregate [codegen id : 97]
-Input [3]: [sales#151, returns#152, profit#153]
+Input [3]: [sales#261, returns#262, profit#263]
 Keys: []
-Functions [3]: [partial_sum(sales#151), partial_sum(returns#152), partial_sum(profit#153)]
-Aggregate Attributes [6]: [sum#198, isEmpty#199, sum#200, isEmpty#201, sum#202, isEmpty#203]
-Results [6]: [sum#204, isEmpty#205, sum#206, isEmpty#207, sum#208, isEmpty#209]
+Functions [3]: [partial_sum(sales#261), partial_sum(returns#262), partial_sum(profit#263)]
+Aggregate Attributes [6]: [sum#264, isEmpty#265, sum#266, isEmpty#267, sum#268, isEmpty#269]
+Results [6]: [sum#270, isEmpty#271, sum#272, isEmpty#273, sum#274, isEmpty#275]
 
 (196) Exchange
-Input [6]: [sum#204, isEmpty#205, sum#206, isEmpty#207, sum#208, isEmpty#209]
+Input [6]: [sum#270, isEmpty#271, sum#272, isEmpty#273, sum#274, isEmpty#275]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=25]
 
 (197) HashAggregate [codegen id : 98]
-Input [6]: [sum#204, isEmpty#205, sum#206, isEmpty#207, sum#208, isEmpty#209]
+Input [6]: [sum#270, isEmpty#271, sum#272, isEmpty#273, sum#274, isEmpty#275]
 Keys: []
-Functions [3]: [sum(sales#151), sum(returns#152), sum(profit#153)]
-Aggregate Attributes [3]: [sum(sales#151)#210, sum(returns#152)#211, sum(profit#153)#212]
-Results [5]: [null AS channel#213, null AS id#214, sum(sales#151)#210 AS sales#215, sum(returns#152)#211 AS returns#216, sum(profit#153)#212 AS profit#217]
+Functions [3]: [sum(sales#261), sum(returns#262), sum(profit#263)]
+Aggregate Attributes [3]: [sum(sales#261)#276, sum(returns#262)#277, sum(profit#263)#278]
+Results [5]: [null AS channel#279, null AS id#280, sum(sales#261)#276 AS sales#281, sum(returns#262)#277 AS returns#282, sum(profit#263)#278 AS profit#283]
 
 (198) Union
 
@@ -1187,19 +1187,19 @@ Input [2]: [i_item_sk#18, i_current_price#19]
 Input [1]: [i_item_sk#18]
 Keys: []
 Functions [1]: [partial_bloom_filter_agg(xxhash64(i_item_sk#18, 42), 101823, 1521109, 0, 0)]
-Aggregate Attributes [1]: [buf#218]
-Results [1]: [buf#219]
+Aggregate Attributes [1]: [buf#284]
+Results [1]: [buf#285]
 
 (208) Exchange
-Input [1]: [buf#219]
+Input [1]: [buf#285]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=27]
 
 (209) ObjectHashAggregate
-Input [1]: [buf#219]
+Input [1]: [buf#285]
 Keys: []
 Functions [1]: [bloom_filter_agg(xxhash64(i_item_sk#18, 42), 101823, 1521109, 0, 0)]
-Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(i_item_sk#18, 42), 101823, 1521109, 0, 0)#220]
-Results [1]: [bloom_filter_agg(xxhash64(i_item_sk#18, 42), 101823, 1521109, 0, 0)#220 AS bloomFilter#221]
+Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(i_item_sk#18, 42), 101823, 1521109, 0, 0)#286]
+Results [1]: [bloom_filter_agg(xxhash64(i_item_sk#18, 42), 101823, 1521109, 0, 0)#286 AS bloomFilter#287]
 
 Subquery:2 Hosting operator id = 3 Hosting Expression = Subquery scalar-subquery#11, [id=#12]
 ObjectHashAggregate (216)
@@ -1233,19 +1233,19 @@ Input [2]: [p_promo_sk#20, p_channel_tv#21]
 Input [1]: [p_promo_sk#20]
 Keys: []
 Functions [1]: [partial_bloom_filter_agg(xxhash64(p_promo_sk#20, 42), 986, 24246, 0, 0)]
-Aggregate Attributes [1]: [buf#222]
-Results [1]: [buf#223]
+Aggregate Attributes [1]: [buf#288]
+Results [1]: [buf#289]
 
 (215) Exchange
-Input [1]: [buf#223]
+Input [1]: [buf#289]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=28]
 
 (216) ObjectHashAggregate
-Input [1]: [buf#223]
+Input [1]: [buf#289]
 Keys: []
 Functions [1]: [bloom_filter_agg(xxhash64(p_promo_sk#20, 42), 986, 24246, 0, 0)]
-Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(p_promo_sk#20, 42), 986, 24246, 0, 0)#224]
-Results [1]: [bloom_filter_agg(xxhash64(p_promo_sk#20, 42), 986, 24246, 0, 0)#224 AS bloomFilter#225]
+Aggregate Attributes [1]: [bloom_filter_agg(xxhash64(p_promo_sk#20, 42), 986, 24246, 0, 0)#290]
+Results [1]: [bloom_filter_agg(xxhash64(p_promo_sk#20, 42), 986, 24246, 0, 0)#290 AS bloomFilter#291]
 
 Subquery:3 Hosting operator id = 1 Hosting Expression = ss_sold_date_sk#7 IN dynamicpruning#8
 BroadcastExchange (221)
@@ -1256,22 +1256,22 @@ BroadcastExchange (221)
 
 
 (217) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#22, d_date#226]
+Output [2]: [d_date_sk#22, d_date#292]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,1998-08-04), LessThanOrEqual(d_date,1998-09-03), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date>
 
 (218) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#22, d_date#226]
+Input [2]: [d_date_sk#22, d_date#292]
 
 (219) Filter [codegen id : 1]
-Input [2]: [d_date_sk#22, d_date#226]
-Condition : (((isnotnull(d_date#226) AND (d_date#226 >= 1998-08-04)) AND (d_date#226 <= 1998-09-03)) AND isnotnull(d_date_sk#22))
+Input [2]: [d_date_sk#22, d_date#292]
+Condition : (((isnotnull(d_date#292) AND (d_date#292 >= 1998-08-04)) AND (d_date#292 <= 1998-09-03)) AND isnotnull(d_date_sk#22))
 
 (220) Project [codegen id : 1]
 Output [1]: [d_date_sk#22]
-Input [2]: [d_date_sk#22, d_date#226]
+Input [2]: [d_date_sk#22, d_date#292]
 
 (221) BroadcastExchange
 Input [1]: [d_date_sk#22]
@@ -1289,10 +1289,10 @@ Subquery:8 Hosting operator id = 73 Hosting Expression = ReusedSubquery Subquery
 
 Subquery:9 Hosting operator id = 71 Hosting Expression = ws_sold_date_sk#84 IN dynamicpruning#8
 
-Subquery:10 Hosting operator id = 110 Hosting Expression = ws_sold_date_sk#84 IN dynamicpruning#8
+Subquery:10 Hosting operator id = 110 Hosting Expression = ws_sold_date_sk#157 IN dynamicpruning#8
 
-Subquery:11 Hosting operator id = 141 Hosting Expression = ss_sold_date_sk#7 IN dynamicpruning#8
+Subquery:11 Hosting operator id = 141 Hosting Expression = ss_sold_date_sk#205 IN dynamicpruning#8
 
-Subquery:12 Hosting operator id = 165 Hosting Expression = cs_sold_date_sk#49 IN dynamicpruning#8
+Subquery:12 Hosting operator id = 165 Hosting Expression = cs_sold_date_sk#231 IN dynamicpruning#8
 
 
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q80a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q80a/explain.txt
index dc593bfb25c..a0881e1685e 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q80a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q80a/explain.txt
@@ -647,25 +647,25 @@ Input [8]: [channel#34, id#35, sum#115, isEmpty#116, sum#117, isEmpty#118, sum#1
 Keys [2]: [channel#34, id#35]
 Functions [3]: [sum(sales#36), sum(returns#37), sum(profit#38)]
 Aggregate Attributes [3]: [sum(sales#36)#121, sum(returns#37)#122, sum(profit#38)#123]
-Results [3]: [sum(sales#36)#121 AS sales#127, sum(returns#37)#122 AS returns#128, sum(profit#38)#123 AS profit#129]
+Results [3]: [sum(sales#36)#121 AS sales#149, sum(returns#37)#122 AS returns#150, sum(profit#38)#123 AS profit#151]
 
 (113) HashAggregate [codegen id : 97]
-Input [3]: [sales#127, returns#128, profit#129]
+Input [3]: [sales#149, returns#150, profit#151]
 Keys: []
-Functions [3]: [partial_sum(sales#127), partial_sum(returns#128), partial_sum(profit#129)]
-Aggregate Attributes [6]: [sum#149, isEmpty#150, sum#151, isEmpty#152, sum#153, isEmpty#154]
-Results [6]: [sum#155, isEmpty#156, sum#157, isEmpty#158, sum#159, isEmpty#160]
+Functions [3]: [partial_sum(sales#149), partial_sum(returns#150), partial_sum(profit#151)]
+Aggregate Attributes [6]: [sum#152, isEmpty#153, sum#154, isEmpty#155, sum#156, isEmpty#157]
+Results [6]: [sum#158, isEmpty#159, sum#160, isEmpty#161, sum#162, isEmpty#163]
 
 (114) Exchange
-Input [6]: [sum#155, isEmpty#156, sum#157, isEmpty#158, sum#159, isEmpty#160]
+Input [6]: [sum#158, isEmpty#159, sum#160, isEmpty#161, sum#162, isEmpty#163]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=17]
 
 (115) HashAggregate [codegen id : 98]
-Input [6]: [sum#155, isEmpty#156, sum#157, isEmpty#158, sum#159, isEmpty#160]
+Input [6]: [sum#158, isEmpty#159, sum#160, isEmpty#161, sum#162, isEmpty#163]
 Keys: []
-Functions [3]: [sum(sales#127), sum(returns#128), sum(profit#129)]
-Aggregate Attributes [3]: [sum(sales#127)#161, sum(returns#128)#162, sum(profit#129)#163]
-Results [5]: [null AS channel#164, null AS id#165, sum(sales#127)#161 AS sales#166, sum(returns#128)#162 AS returns#167, sum(profit#129)#163 AS profit#168]
+Functions [3]: [sum(sales#149), sum(returns#150), sum(profit#151)]
+Aggregate Attributes [3]: [sum(sales#149)#164, sum(returns#150)#165, sum(profit#151)#166]
+Results [5]: [null AS channel#167, null AS id#168, sum(sales#149)#164 AS sales#169, sum(returns#150)#165 AS returns#170, sum(profit#151)#166 AS profit#171]
 
 (116) Union
 
@@ -702,22 +702,22 @@ BroadcastExchange (125)
 
 
 (121) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#14, d_date#169]
+Output [2]: [d_date_sk#14, d_date#172]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,1998-08-04), LessThanOrEqual(d_date,1998-09-03), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_date:date>
 
 (122) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#14, d_date#169]
+Input [2]: [d_date_sk#14, d_date#172]
 
 (123) Filter [codegen id : 1]
-Input [2]: [d_date_sk#14, d_date#169]
-Condition : (((isnotnull(d_date#169) AND (d_date#169 >= 1998-08-04)) AND (d_date#169 <= 1998-09-03)) AND isnotnull(d_date_sk#14))
+Input [2]: [d_date_sk#14, d_date#172]
+Condition : (((isnotnull(d_date#172) AND (d_date#172 >= 1998-08-04)) AND (d_date#172 <= 1998-09-03)) AND isnotnull(d_date_sk#14))
 
 (124) Project [codegen id : 1]
 Output [1]: [d_date_sk#14]
-Input [2]: [d_date_sk#14, d_date#169]
+Input [2]: [d_date_sk#14, d_date#172]
 
 (125) BroadcastExchange
 Input [1]: [d_date_sk#14]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q86a.sf100/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q86a.sf100/explain.txt
index db3d6917f93..92caf540093 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q86a.sf100/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q86a.sf100/explain.txt
@@ -110,60 +110,60 @@ Aggregate Attributes [1]: [sum(UnscaledValue(ws_net_paid#2))#11]
 Results [6]: [cast(MakeDecimal(sum(UnscaledValue(ws_net_paid#2))#11,17,2) as decimal(27,2)) AS total_sum#12, i_category#8, i_class#7, 0 AS g_category#13, 0 AS g_class#14, 0 AS lochierarchy#15]
 
 (16) ReusedExchange [Reuses operator id: 14]
-Output [3]: [i_category#8, i_class#7, sum#16]
+Output [3]: [i_category#16, i_class#17, sum#18]
 
 (17) HashAggregate [codegen id : 8]
-Input [3]: [i_category#8, i_class#7, sum#16]
-Keys [2]: [i_category#8, i_class#7]
-Functions [1]: [sum(UnscaledValue(ws_net_paid#2))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ws_net_paid#2))#11]
-Results [2]: [MakeDecimal(sum(UnscaledValue(ws_net_paid#2))#11,17,2) AS total_sum#17, i_category#8]
+Input [3]: [i_category#16, i_class#17, sum#18]
+Keys [2]: [i_category#16, i_class#17]
+Functions [1]: [sum(UnscaledValue(ws_net_paid#19))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ws_net_paid#19))#11]
+Results [2]: [MakeDecimal(sum(UnscaledValue(ws_net_paid#19))#11,17,2) AS total_sum#20, i_category#16]
 
 (18) HashAggregate [codegen id : 8]
-Input [2]: [total_sum#17, i_category#8]
-Keys [1]: [i_category#8]
-Functions [1]: [partial_sum(total_sum#17)]
-Aggregate Attributes [2]: [sum#18, isEmpty#19]
-Results [3]: [i_category#8, sum#20, isEmpty#21]
+Input [2]: [total_sum#20, i_category#16]
+Keys [1]: [i_category#16]
+Functions [1]: [partial_sum(total_sum#20)]
+Aggregate Attributes [2]: [sum#21, isEmpty#22]
+Results [3]: [i_category#16, sum#23, isEmpty#24]
 
 (19) Exchange
-Input [3]: [i_category#8, sum#20, isEmpty#21]
-Arguments: hashpartitioning(i_category#8, 5), ENSURE_REQUIREMENTS, [plan_id=3]
+Input [3]: [i_category#16, sum#23, isEmpty#24]
+Arguments: hashpartitioning(i_category#16, 5), ENSURE_REQUIREMENTS, [plan_id=3]
 
 (20) HashAggregate [codegen id : 9]
-Input [3]: [i_category#8, sum#20, isEmpty#21]
-Keys [1]: [i_category#8]
-Functions [1]: [sum(total_sum#17)]
-Aggregate Attributes [1]: [sum(total_sum#17)#22]
-Results [6]: [sum(total_sum#17)#22 AS total_sum#23, i_category#8, null AS i_class#24, 0 AS g_category#25, 1 AS g_class#26, 1 AS lochierarchy#27]
+Input [3]: [i_category#16, sum#23, isEmpty#24]
+Keys [1]: [i_category#16]
+Functions [1]: [sum(total_sum#20)]
+Aggregate Attributes [1]: [sum(total_sum#20)#25]
+Results [6]: [sum(total_sum#20)#25 AS total_sum#26, i_category#16, null AS i_class#27, 0 AS g_category#28, 1 AS g_class#29, 1 AS lochierarchy#30]
 
 (21) ReusedExchange [Reuses operator id: 14]
-Output [3]: [i_category#8, i_class#7, sum#28]
+Output [3]: [i_category#31, i_class#32, sum#33]
 
 (22) HashAggregate [codegen id : 13]
-Input [3]: [i_category#8, i_class#7, sum#28]
-Keys [2]: [i_category#8, i_class#7]
-Functions [1]: [sum(UnscaledValue(ws_net_paid#2))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ws_net_paid#2))#11]
-Results [1]: [MakeDecimal(sum(UnscaledValue(ws_net_paid#2))#11,17,2) AS total_sum#17]
+Input [3]: [i_category#31, i_class#32, sum#33]
+Keys [2]: [i_category#31, i_class#32]
+Functions [1]: [sum(UnscaledValue(ws_net_paid#34))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ws_net_paid#34))#11]
+Results [1]: [MakeDecimal(sum(UnscaledValue(ws_net_paid#34))#11,17,2) AS total_sum#35]
 
 (23) HashAggregate [codegen id : 13]
-Input [1]: [total_sum#17]
+Input [1]: [total_sum#35]
 Keys: []
-Functions [1]: [partial_sum(total_sum#17)]
-Aggregate Attributes [2]: [sum#29, isEmpty#30]
-Results [2]: [sum#31, isEmpty#32]
+Functions [1]: [partial_sum(total_sum#35)]
+Aggregate Attributes [2]: [sum#36, isEmpty#37]
+Results [2]: [sum#38, isEmpty#39]
 
 (24) Exchange
-Input [2]: [sum#31, isEmpty#32]
+Input [2]: [sum#38, isEmpty#39]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=4]
 
 (25) HashAggregate [codegen id : 14]
-Input [2]: [sum#31, isEmpty#32]
+Input [2]: [sum#38, isEmpty#39]
 Keys: []
-Functions [1]: [sum(total_sum#17)]
-Aggregate Attributes [1]: [sum(total_sum#17)#33]
-Results [6]: [sum(total_sum#17)#33 AS total_sum#34, null AS i_category#35, null AS i_class#36, 1 AS g_category#37, 1 AS g_class#38, 2 AS lochierarchy#39]
+Functions [1]: [sum(total_sum#35)]
+Aggregate Attributes [1]: [sum(total_sum#35)#40]
+Results [6]: [sum(total_sum#35)#40 AS total_sum#41, null AS i_category#42, null AS i_class#43, 1 AS g_category#44, 1 AS g_class#45, 2 AS lochierarchy#46]
 
 (26) Union
 
@@ -183,27 +183,27 @@ Input [6]: [total_sum#12, i_category#8, i_class#7, g_category#13, g_class#14, lo
 Keys [6]: [total_sum#12, i_category#8, i_class#7, g_category#13, g_class#14, lochierarchy#15]
 Functions: []
 Aggregate Attributes: []
-Results [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, CASE WHEN (g_class#14 = 0) THEN i_category#8 END AS _w0#40]
+Results [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, CASE WHEN (g_class#14 = 0) THEN i_category#8 END AS _w0#47]
 
 (30) Exchange
-Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#40]
-Arguments: hashpartitioning(lochierarchy#15, _w0#40, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#47]
+Arguments: hashpartitioning(lochierarchy#15, _w0#47, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (31) Sort [codegen id : 17]
-Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#40]
-Arguments: [lochierarchy#15 ASC NULLS FIRST, _w0#40 ASC NULLS FIRST, total_sum#12 DESC NULLS LAST], false, 0
+Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#47]
+Arguments: [lochierarchy#15 ASC NULLS FIRST, _w0#47 ASC NULLS FIRST, total_sum#12 DESC NULLS LAST], false, 0
 
 (32) Window
-Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#40]
-Arguments: [rank(total_sum#12) windowspecdefinition(lochierarchy#15, _w0#40, total_sum#12 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#41], [lochierarchy#15, _w0#40], [total_sum#12 DESC NULLS LAST]
+Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#47]
+Arguments: [rank(total_sum#12) windowspecdefinition(lochierarchy#15, _w0#47, total_sum#12 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#48], [lochierarchy#15, _w0#47], [total_sum#12 DESC NULLS LAST]
 
 (33) Project [codegen id : 18]
-Output [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, rank_within_parent#41]
-Input [6]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#40, rank_within_parent#41]
+Output [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, rank_within_parent#48]
+Input [6]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#47, rank_within_parent#48]
 
 (34) TakeOrderedAndProject
-Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, rank_within_parent#41]
-Arguments: 100, [lochierarchy#15 DESC NULLS LAST, CASE WHEN (lochierarchy#15 = 0) THEN i_category#8 END ASC NULLS FIRST, rank_within_parent#41 ASC NULLS FIRST], [total_sum#12, i_category#8, i_class#7, lochierarchy#15, rank_within_parent#41]
+Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, rank_within_parent#48]
+Arguments: 100, [lochierarchy#15 DESC NULLS LAST, CASE WHEN (lochierarchy#15 = 0) THEN i_category#8 END ASC NULLS FIRST, rank_within_parent#48 ASC NULLS FIRST], [total_sum#12, i_category#8, i_class#7, lochierarchy#15, rank_within_parent#48]
 
 ===== Subqueries =====
 
@@ -216,22 +216,22 @@ BroadcastExchange (39)
 
 
 (35) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#5, d_month_seq#42]
+Output [2]: [d_date_sk#5, d_month_seq#49]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1212), LessThanOrEqual(d_month_seq,1223), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_month_seq:int>
 
 (36) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#5, d_month_seq#42]
+Input [2]: [d_date_sk#5, d_month_seq#49]
 
 (37) Filter [codegen id : 1]
-Input [2]: [d_date_sk#5, d_month_seq#42]
-Condition : (((isnotnull(d_month_seq#42) AND (d_month_seq#42 >= 1212)) AND (d_month_seq#42 <= 1223)) AND isnotnull(d_date_sk#5))
+Input [2]: [d_date_sk#5, d_month_seq#49]
+Condition : (((isnotnull(d_month_seq#49) AND (d_month_seq#49 >= 1212)) AND (d_month_seq#49 <= 1223)) AND isnotnull(d_date_sk#5))
 
 (38) Project [codegen id : 1]
 Output [1]: [d_date_sk#5]
-Input [2]: [d_date_sk#5, d_month_seq#42]
+Input [2]: [d_date_sk#5, d_month_seq#49]
 
 (39) BroadcastExchange
 Input [1]: [d_date_sk#5]
diff --git a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q86a/explain.txt b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q86a/explain.txt
index db3d6917f93..92caf540093 100644
--- a/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q86a/explain.txt
+++ b/sql/core/src/test/resources/tpcds-plan-stability/approved-plans-v2_7/q86a/explain.txt
@@ -110,60 +110,60 @@ Aggregate Attributes [1]: [sum(UnscaledValue(ws_net_paid#2))#11]
 Results [6]: [cast(MakeDecimal(sum(UnscaledValue(ws_net_paid#2))#11,17,2) as decimal(27,2)) AS total_sum#12, i_category#8, i_class#7, 0 AS g_category#13, 0 AS g_class#14, 0 AS lochierarchy#15]
 
 (16) ReusedExchange [Reuses operator id: 14]
-Output [3]: [i_category#8, i_class#7, sum#16]
+Output [3]: [i_category#16, i_class#17, sum#18]
 
 (17) HashAggregate [codegen id : 8]
-Input [3]: [i_category#8, i_class#7, sum#16]
-Keys [2]: [i_category#8, i_class#7]
-Functions [1]: [sum(UnscaledValue(ws_net_paid#2))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ws_net_paid#2))#11]
-Results [2]: [MakeDecimal(sum(UnscaledValue(ws_net_paid#2))#11,17,2) AS total_sum#17, i_category#8]
+Input [3]: [i_category#16, i_class#17, sum#18]
+Keys [2]: [i_category#16, i_class#17]
+Functions [1]: [sum(UnscaledValue(ws_net_paid#19))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ws_net_paid#19))#11]
+Results [2]: [MakeDecimal(sum(UnscaledValue(ws_net_paid#19))#11,17,2) AS total_sum#20, i_category#16]
 
 (18) HashAggregate [codegen id : 8]
-Input [2]: [total_sum#17, i_category#8]
-Keys [1]: [i_category#8]
-Functions [1]: [partial_sum(total_sum#17)]
-Aggregate Attributes [2]: [sum#18, isEmpty#19]
-Results [3]: [i_category#8, sum#20, isEmpty#21]
+Input [2]: [total_sum#20, i_category#16]
+Keys [1]: [i_category#16]
+Functions [1]: [partial_sum(total_sum#20)]
+Aggregate Attributes [2]: [sum#21, isEmpty#22]
+Results [3]: [i_category#16, sum#23, isEmpty#24]
 
 (19) Exchange
-Input [3]: [i_category#8, sum#20, isEmpty#21]
-Arguments: hashpartitioning(i_category#8, 5), ENSURE_REQUIREMENTS, [plan_id=3]
+Input [3]: [i_category#16, sum#23, isEmpty#24]
+Arguments: hashpartitioning(i_category#16, 5), ENSURE_REQUIREMENTS, [plan_id=3]
 
 (20) HashAggregate [codegen id : 9]
-Input [3]: [i_category#8, sum#20, isEmpty#21]
-Keys [1]: [i_category#8]
-Functions [1]: [sum(total_sum#17)]
-Aggregate Attributes [1]: [sum(total_sum#17)#22]
-Results [6]: [sum(total_sum#17)#22 AS total_sum#23, i_category#8, null AS i_class#24, 0 AS g_category#25, 1 AS g_class#26, 1 AS lochierarchy#27]
+Input [3]: [i_category#16, sum#23, isEmpty#24]
+Keys [1]: [i_category#16]
+Functions [1]: [sum(total_sum#20)]
+Aggregate Attributes [1]: [sum(total_sum#20)#25]
+Results [6]: [sum(total_sum#20)#25 AS total_sum#26, i_category#16, null AS i_class#27, 0 AS g_category#28, 1 AS g_class#29, 1 AS lochierarchy#30]
 
 (21) ReusedExchange [Reuses operator id: 14]
-Output [3]: [i_category#8, i_class#7, sum#28]
+Output [3]: [i_category#31, i_class#32, sum#33]
 
 (22) HashAggregate [codegen id : 13]
-Input [3]: [i_category#8, i_class#7, sum#28]
-Keys [2]: [i_category#8, i_class#7]
-Functions [1]: [sum(UnscaledValue(ws_net_paid#2))]
-Aggregate Attributes [1]: [sum(UnscaledValue(ws_net_paid#2))#11]
-Results [1]: [MakeDecimal(sum(UnscaledValue(ws_net_paid#2))#11,17,2) AS total_sum#17]
+Input [3]: [i_category#31, i_class#32, sum#33]
+Keys [2]: [i_category#31, i_class#32]
+Functions [1]: [sum(UnscaledValue(ws_net_paid#34))]
+Aggregate Attributes [1]: [sum(UnscaledValue(ws_net_paid#34))#11]
+Results [1]: [MakeDecimal(sum(UnscaledValue(ws_net_paid#34))#11,17,2) AS total_sum#35]
 
 (23) HashAggregate [codegen id : 13]
-Input [1]: [total_sum#17]
+Input [1]: [total_sum#35]
 Keys: []
-Functions [1]: [partial_sum(total_sum#17)]
-Aggregate Attributes [2]: [sum#29, isEmpty#30]
-Results [2]: [sum#31, isEmpty#32]
+Functions [1]: [partial_sum(total_sum#35)]
+Aggregate Attributes [2]: [sum#36, isEmpty#37]
+Results [2]: [sum#38, isEmpty#39]
 
 (24) Exchange
-Input [2]: [sum#31, isEmpty#32]
+Input [2]: [sum#38, isEmpty#39]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=4]
 
 (25) HashAggregate [codegen id : 14]
-Input [2]: [sum#31, isEmpty#32]
+Input [2]: [sum#38, isEmpty#39]
 Keys: []
-Functions [1]: [sum(total_sum#17)]
-Aggregate Attributes [1]: [sum(total_sum#17)#33]
-Results [6]: [sum(total_sum#17)#33 AS total_sum#34, null AS i_category#35, null AS i_class#36, 1 AS g_category#37, 1 AS g_class#38, 2 AS lochierarchy#39]
+Functions [1]: [sum(total_sum#35)]
+Aggregate Attributes [1]: [sum(total_sum#35)#40]
+Results [6]: [sum(total_sum#35)#40 AS total_sum#41, null AS i_category#42, null AS i_class#43, 1 AS g_category#44, 1 AS g_class#45, 2 AS lochierarchy#46]
 
 (26) Union
 
@@ -183,27 +183,27 @@ Input [6]: [total_sum#12, i_category#8, i_class#7, g_category#13, g_class#14, lo
 Keys [6]: [total_sum#12, i_category#8, i_class#7, g_category#13, g_class#14, lochierarchy#15]
 Functions: []
 Aggregate Attributes: []
-Results [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, CASE WHEN (g_class#14 = 0) THEN i_category#8 END AS _w0#40]
+Results [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, CASE WHEN (g_class#14 = 0) THEN i_category#8 END AS _w0#47]
 
 (30) Exchange
-Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#40]
-Arguments: hashpartitioning(lochierarchy#15, _w0#40, 5), ENSURE_REQUIREMENTS, [plan_id=6]
+Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#47]
+Arguments: hashpartitioning(lochierarchy#15, _w0#47, 5), ENSURE_REQUIREMENTS, [plan_id=6]
 
 (31) Sort [codegen id : 17]
-Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#40]
-Arguments: [lochierarchy#15 ASC NULLS FIRST, _w0#40 ASC NULLS FIRST, total_sum#12 DESC NULLS LAST], false, 0
+Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#47]
+Arguments: [lochierarchy#15 ASC NULLS FIRST, _w0#47 ASC NULLS FIRST, total_sum#12 DESC NULLS LAST], false, 0
 
 (32) Window
-Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#40]
-Arguments: [rank(total_sum#12) windowspecdefinition(lochierarchy#15, _w0#40, total_sum#12 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#41], [lochierarchy#15, _w0#40], [total_sum#12 DESC NULLS LAST]
+Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#47]
+Arguments: [rank(total_sum#12) windowspecdefinition(lochierarchy#15, _w0#47, total_sum#12 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#48], [lochierarchy#15, _w0#47], [total_sum#12 DESC NULLS LAST]
 
 (33) Project [codegen id : 18]
-Output [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, rank_within_parent#41]
-Input [6]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#40, rank_within_parent#41]
+Output [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, rank_within_parent#48]
+Input [6]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, _w0#47, rank_within_parent#48]
 
 (34) TakeOrderedAndProject
-Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, rank_within_parent#41]
-Arguments: 100, [lochierarchy#15 DESC NULLS LAST, CASE WHEN (lochierarchy#15 = 0) THEN i_category#8 END ASC NULLS FIRST, rank_within_parent#41 ASC NULLS FIRST], [total_sum#12, i_category#8, i_class#7, lochierarchy#15, rank_within_parent#41]
+Input [5]: [total_sum#12, i_category#8, i_class#7, lochierarchy#15, rank_within_parent#48]
+Arguments: 100, [lochierarchy#15 DESC NULLS LAST, CASE WHEN (lochierarchy#15 = 0) THEN i_category#8 END ASC NULLS FIRST, rank_within_parent#48 ASC NULLS FIRST], [total_sum#12, i_category#8, i_class#7, lochierarchy#15, rank_within_parent#48]
 
 ===== Subqueries =====
 
@@ -216,22 +216,22 @@ BroadcastExchange (39)
 
 
 (35) Scan parquet spark_catalog.default.date_dim
-Output [2]: [d_date_sk#5, d_month_seq#42]
+Output [2]: [d_date_sk#5, d_month_seq#49]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/date_dim]
 PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1212), LessThanOrEqual(d_month_seq,1223), IsNotNull(d_date_sk)]
 ReadSchema: struct<d_date_sk:int,d_month_seq:int>
 
 (36) ColumnarToRow [codegen id : 1]
-Input [2]: [d_date_sk#5, d_month_seq#42]
+Input [2]: [d_date_sk#5, d_month_seq#49]
 
 (37) Filter [codegen id : 1]
-Input [2]: [d_date_sk#5, d_month_seq#42]
-Condition : (((isnotnull(d_month_seq#42) AND (d_month_seq#42 >= 1212)) AND (d_month_seq#42 <= 1223)) AND isnotnull(d_date_sk#5))
+Input [2]: [d_date_sk#5, d_month_seq#49]
+Condition : (((isnotnull(d_month_seq#49) AND (d_month_seq#49 >= 1212)) AND (d_month_seq#49 <= 1223)) AND isnotnull(d_date_sk#5))
 
 (38) Project [codegen id : 1]
 Output [1]: [d_date_sk#5]
-Input [2]: [d_date_sk#5, d_month_seq#42]
+Input [2]: [d_date_sk#5, d_month_seq#49]
 
 (39) BroadcastExchange
 Input [1]: [d_date_sk#5]
diff --git a/sql/core/src/test/resources/tpch-plan-stability/q15/explain.txt b/sql/core/src/test/resources/tpch-plan-stability/q15/explain.txt
index 5ca7f9d1d49..d3489acaa3d 100644
--- a/sql/core/src/test/resources/tpch-plan-stability/q15/explain.txt
+++ b/sql/core/src/test/resources/tpch-plan-stability/q15/explain.txt
@@ -109,57 +109,57 @@ Subquery:1 Hosting operator id = 11 Hosting Expression = Subquery scalar-subquer
 
 
 (17) Scan parquet spark_catalog.default.lineitem
-Output [4]: [l_suppkey#5, l_extendedprice#6, l_discount#7, l_shipdate#8]
+Output [4]: [l_suppkey#18, l_extendedprice#19, l_discount#20, l_shipdate#21]
 Batched: true
 Location [not included in comparison]/{warehouse_dir}/lineitem]
 PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01)]
 ReadSchema: struct<l_suppkey:bigint,l_extendedprice:decimal(10,0),l_discount:decimal(10,0),l_shipdate:date>
 
 (18) ColumnarToRow [codegen id : 1]
-Input [4]: [l_suppkey#5, l_extendedprice#6, l_discount#7, l_shipdate#8]
+Input [4]: [l_suppkey#18, l_extendedprice#19, l_discount#20, l_shipdate#21]
 
 (19) Filter [codegen id : 1]
-Input [4]: [l_suppkey#5, l_extendedprice#6, l_discount#7, l_shipdate#8]
-Condition : ((isnotnull(l_shipdate#8) AND (l_shipdate#8 >= 1996-01-01)) AND (l_shipdate#8 < 1996-04-01))
+Input [4]: [l_suppkey#18, l_extendedprice#19, l_discount#20, l_shipdate#21]
+Condition : ((isnotnull(l_shipdate#21) AND (l_shipdate#21 >= 1996-01-01)) AND (l_shipdate#21 < 1996-04-01))
 
 (20) Project [codegen id : 1]
-Output [3]: [l_suppkey#5, l_extendedprice#6, l_discount#7]
-Input [4]: [l_suppkey#5, l_extendedprice#6, l_discount#7, l_shipdate#8]
+Output [3]: [l_suppkey#18, l_extendedprice#19, l_discount#20]
+Input [4]: [l_suppkey#18, l_extendedprice#19, l_discount#20, l_shipdate#21]
 
 (21) HashAggregate [codegen id : 1]
-Input [3]: [l_suppkey#5, l_extendedprice#6, l_discount#7]
-Keys [1]: [l_suppkey#5]
-Functions [1]: [partial_sum((l_extendedprice#6 * (1 - l_discount#7)))]
-Aggregate Attributes [2]: [sum#18, isEmpty#19]
-Results [3]: [l_suppkey#5, sum#20, isEmpty#21]
+Input [3]: [l_suppkey#18, l_extendedprice#19, l_discount#20]
+Keys [1]: [l_suppkey#18]
+Functions [1]: [partial_sum((l_extendedprice#19 * (1 - l_discount#20)))]
+Aggregate Attributes [2]: [sum#22, isEmpty#23]
+Results [3]: [l_suppkey#18, sum#24, isEmpty#25]
 
 (22) Exchange
-Input [3]: [l_suppkey#5, sum#20, isEmpty#21]
-Arguments: hashpartitioning(l_suppkey#5, 5), ENSURE_REQUIREMENTS, [plan_id=4]
+Input [3]: [l_suppkey#18, sum#24, isEmpty#25]
+Arguments: hashpartitioning(l_suppkey#18, 5), ENSURE_REQUIREMENTS, [plan_id=4]
 
 (23) HashAggregate [codegen id : 2]
-Input [3]: [l_suppkey#5, sum#20, isEmpty#21]
-Keys [1]: [l_suppkey#5]
-Functions [1]: [sum((l_extendedprice#6 * (1 - l_discount#7)))]
-Aggregate Attributes [1]: [sum((l_extendedprice#6 * (1 - l_discount#7)))#13]
-Results [1]: [sum((l_extendedprice#6 * (1 - l_discount#7)))#13 AS total_revenue#15]
+Input [3]: [l_suppkey#18, sum#24, isEmpty#25]
+Keys [1]: [l_suppkey#18]
+Functions [1]: [sum((l_extendedprice#19 * (1 - l_discount#20)))]
+Aggregate Attributes [1]: [sum((l_extendedprice#19 * (1 - l_discount#20)))#13]
+Results [1]: [sum((l_extendedprice#19 * (1 - l_discount#20)))#13 AS total_revenue#26]
 
 (24) HashAggregate [codegen id : 2]
-Input [1]: [total_revenue#15]
+Input [1]: [total_revenue#26]
 Keys: []
-Functions [1]: [partial_max(total_revenue#15)]
-Aggregate Attributes [1]: [max#22]
-Results [1]: [max#23]
+Functions [1]: [partial_max(total_revenue#26)]
+Aggregate Attributes [1]: [max#27]
+Results [1]: [max#28]
 
 (25) Exchange
-Input [1]: [max#23]
+Input [1]: [max#28]
 Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=5]
 
 (26) HashAggregate [codegen id : 3]
-Input [1]: [max#23]
+Input [1]: [max#28]
 Keys: []
-Functions [1]: [max(total_revenue#15)]
-Aggregate Attributes [1]: [max(total_revenue#15)#24]
-Results [1]: [max(total_revenue#15)#24 AS max(total_revenue)#25]
+Functions [1]: [max(total_revenue#26)]
+Aggregate Attributes [1]: [max(total_revenue#26)#29]
+Results [1]: [max(total_revenue#26)#29 AS max(total_revenue)#30]
 
 
diff --git a/sql/core/src/test/scala/org/apache/spark/sql/connector/MetadataColumnSuite.scala b/sql/core/src/test/scala/org/apache/spark/sql/connector/MetadataColumnSuite.scala
index 130f79e7ae2..d03bf402170 100644
--- a/sql/core/src/test/scala/org/apache/spark/sql/connector/MetadataColumnSuite.scala
+++ b/sql/core/src/test/scala/org/apache/spark/sql/connector/MetadataColumnSuite.scala
@@ -325,4 +325,19 @@ class MetadataColumnSuite extends DatasourceV2SQLBase {
         Seq(Row("a", 0), Row("b", 0), Row("c", 0)))
     }
   }
+
+  test("SPARK-43030: deduplicate relations with metadata columns") {
+    withTable(tbl) {
+      prepareTable()
+      val df = spark.table(tbl)
+      val unioned = df.filter($"id" > 2).select("id", "index").union(
+        df.select("id", "index"))
+      checkAnswer(unioned, Seq(Row(3, 0), Row(1, 0), Row(2, 0), Row(3, 0)))
+      val relations = unioned.logicalPlan.collect {
+        case r: DataSourceV2Relation => r
+      }
+      assert(relations.length == 2)
+      assert(relations(0).output != relations(1).output)
+    }
+  }
 }
