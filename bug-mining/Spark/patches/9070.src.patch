diff --git a/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/util/StringUtils.scala b/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/util/StringUtils.scala
index f46b30dde66..e8280fb4430 100644
--- a/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/util/StringUtils.scala
+++ b/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/util/StringUtils.scala
@@ -109,7 +109,7 @@ object StringUtils extends Logging {
         sorted.map(_._2)
       } else {
         // More than one relation
-        sorted.map(x => s"${x._1}.${x._2}")
+        sorted.map(x => if (x._1.isEmpty) s"${x._2}" else s"${x._1}.${x._2}")
       }
     }
   }
diff --git a/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/util/StringUtilsSuite.scala b/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/util/StringUtilsSuite.scala
index 7ef08fe215c..8f26bd19a64 100644
--- a/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/util/StringUtilsSuite.scala
+++ b/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/util/StringUtilsSuite.scala
@@ -138,4 +138,11 @@ class StringUtilsSuite extends SparkFunSuite with SQLHelper {
     assert(quoteIfNeeded("_") === "_")
     assert(quoteIfNeeded("") === "``")
   }
+
+  test("SPARK-43841: mix of multipart and single-part identifiers") {
+    val baseString = "b"
+    val testStrings = Seq("c1", "v1.c2", "v2.c2") // mix of multipart and single-part
+    val expectedOutput = Seq("c1", "v1.c2", "v2.c2")
+    assert(orderSuggestedIdentifiersBySimilarity(baseString, testStrings) === expectedOutput)
+  }
 }
diff --git a/sql/core/src/test/scala/org/apache/spark/sql/errors/QueryCompilationErrorsSuite.scala b/sql/core/src/test/scala/org/apache/spark/sql/errors/QueryCompilationErrorsSuite.scala
index 3a499ea61b3..4973f6e93b6 100644
--- a/sql/core/src/test/scala/org/apache/spark/sql/errors/QueryCompilationErrorsSuite.scala
+++ b/sql/core/src/test/scala/org/apache/spark/sql/errors/QueryCompilationErrorsSuite.scala
@@ -884,6 +884,33 @@ class QueryCompilationErrorsSuite
       )
     }
   }
+
+  test("SPARK-43841: Unresolved attribute in select of full outer join with USING") {
+    withTempView("v1", "v2") {
+      sql("create or replace temp view v1 as values (1, 2) as (c1, c2)")
+      sql("create or replace temp view v2 as values (2, 3) as (c1, c2)")
+
+      val query =
+        """select b
+          |from v1
+          |full outer join v2
+          |using (c1)
+          |""".stripMargin
+
+      checkError(
+        exception = intercept[AnalysisException] {
+          sql(query)
+        },
+        errorClass = "UNRESOLVED_COLUMN.WITH_SUGGESTION",
+        parameters = Map(
+          "proposal" -> "`c1`, `v1`.`c2`, `v2`.`c2`",
+          "objectName" -> "`b`"),
+        context = ExpectedContext(
+          fragment = "b",
+          start = 7, stop = 7)
+      )
+    }
+  }
 }
 
 class MyCastToString extends SparkUserDefinedFunction(
