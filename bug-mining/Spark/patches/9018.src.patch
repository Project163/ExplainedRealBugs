diff --git a/core/src/main/scala/org/apache/spark/util/JsonProtocol.scala b/core/src/main/scala/org/apache/spark/util/JsonProtocol.scala
index 6b75971fc25..eefc68bf91d 100644
--- a/core/src/main/scala/org/apache/spark/util/JsonProtocol.scala
+++ b/core/src/main/scala/org/apache/spark/util/JsonProtocol.scala
@@ -1558,7 +1558,7 @@ private[spark] object JsonProtocol {
     json.extractElements.map { line =>
       val declaringClass = line.get("Declaring Class").extractString
       val methodName = line.get("Method Name").extractString
-      val fileName = line.get("File Name").extractString
+      val fileName = jsonOption(line.get("File Name")).map(_.extractString).orNull
       val lineNumber = line.get("Line Number").extractInt
       new StackTraceElement(declaringClass, methodName, fileName, lineNumber)
     }.toArray
diff --git a/core/src/test/scala/org/apache/spark/util/JsonProtocolSuite.scala b/core/src/test/scala/org/apache/spark/util/JsonProtocolSuite.scala
index 3eb0d1378e0..cea6061c07c 100644
--- a/core/src/test/scala/org/apache/spark/util/JsonProtocolSuite.scala
+++ b/core/src/test/scala/org/apache/spark/util/JsonProtocolSuite.scala
@@ -809,6 +809,11 @@ class JsonProtocolSuite extends SparkFunSuite {
       JsonProtocol.taskEndReasonFromJson(exceptionFailureJson).asInstanceOf[ExceptionFailure]
     assert(exceptionFailure.description == null)
   }
+
+  test("SPARK-43052: Handle stackTrace with null file name") {
+    val stackTrace = Seq(new StackTraceElement("class", "method", null, -1)).toArray
+    testStackTrace(stackTrace)
+  }
 }
 
 
@@ -904,6 +909,12 @@ private[spark] object JsonProtocolSuite extends Assertions {
     assertEquals(reason, newReason)
   }
 
+  private def testStackTrace(stackTrace: Array[StackTraceElement]): Unit = {
+    val newStackTrace = JsonProtocol.stackTraceFromJson(
+      toJsonString(JsonProtocol.stackTraceToJson(stackTrace, _)))
+    assertSeqEquals(stackTrace, newStackTrace, assertStackTraceElementEquals)
+  }
+
   private def testBlockId(blockId: BlockId): Unit = {
     val newBlockId = BlockId(blockId.toString)
     assert(blockId === newBlockId)
