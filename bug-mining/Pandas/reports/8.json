{"url":"https://api.github.com/repos/pandas-dev/pandas/issues/54134","repository_url":"https://api.github.com/repos/pandas-dev/pandas","labels_url":"https://api.github.com/repos/pandas-dev/pandas/issues/54134/labels{/name}","comments_url":"https://api.github.com/repos/pandas-dev/pandas/issues/54134/comments","events_url":"https://api.github.com/repos/pandas-dev/pandas/issues/54134/events","html_url":"https://github.com/pandas-dev/pandas/issues/54134","id":1806127634,"node_id":"I_kwDOAA0YD85rp1IS","number":54134,"title":"BUG: `copy.deepcopy()` doesn't deepcopy the metadata in `.attrs`","user":{"login":"LucaMarconato","id":2664412,"node_id":"MDQ6VXNlcjI2NjQ0MTI=","avatar_url":"https://avatars.githubusercontent.com/u/2664412?v=4","gravatar_id":"","url":"https://api.github.com/users/LucaMarconato","html_url":"https://github.com/LucaMarconato","followers_url":"https://api.github.com/users/LucaMarconato/followers","following_url":"https://api.github.com/users/LucaMarconato/following{/other_user}","gists_url":"https://api.github.com/users/LucaMarconato/gists{/gist_id}","starred_url":"https://api.github.com/users/LucaMarconato/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LucaMarconato/subscriptions","organizations_url":"https://api.github.com/users/LucaMarconato/orgs","repos_url":"https://api.github.com/users/LucaMarconato/repos","events_url":"https://api.github.com/users/LucaMarconato/events{/privacy}","received_events_url":"https://api.github.com/users/LucaMarconato/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":76811,"node_id":"MDU6TGFiZWw3NjgxMQ==","url":"https://api.github.com/repos/pandas-dev/pandas/labels/Bug","name":"Bug","color":"e10c02","default":false,"description":null},{"id":1539579994,"node_id":"MDU6TGFiZWwxNTM5NTc5OTk0","url":"https://api.github.com/repos/pandas-dev/pandas/labels/metadata","name":"metadata","color":"56efc9","default":false,"description":"_metadata, .attrs"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-07-15T14:23:25Z","updated_at":"2024-03-15T20:29:51Z","closed_at":"2023-10-04T16:38:18Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Pandas version checks\n\n- [X] I have checked that this issue has not already been reported.\n\n- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.\n\n- [ ] I have confirmed this bug exists on the [main branch](https://pandas.pydata.org/docs/dev/getting_started/install.html#installing-the-development-version-of-pandas) of pandas.\n\n\n### Reproducible Example\n\n```python\nimport pandas as pd\r\nimport copy\r\n\r\n# Create a GeoDataFrame\r\ndf = pd.DataFrame({\r\n    'value': [1, 2]\r\n})\r\n\r\n# Add an attribute to the DataFrame\r\ndf.attrs['transform'] = {}\r\n\r\n# Copy the DataFrame\r\ndf2 = copy.deepcopy(df)\r\n# gdf2 = gdf.copy(deep=True)\r\n\r\n# Print the IDs\r\nprint(id(df.attrs['transform']))  # ID of copied attribute\r\nprint(id(df2.attrs['transform']))  # ID of original attribute\r\n\r\n# Assertion\r\nassert df.attrs['transform'] is not df2.attrs['transform']\n```\n\n\n### Issue Description\n\nI would expect the dict in .attrs to be a copy since I performed a deep copy, but it is still the same object. Originally I though it was a bug of `geopandas`, but it is a bug of `pandas`. For cross-ref, this is my original issue: https://github.com/geopandas/geopandas/issues/2920#issuecomment-1594477028\n\n### Expected Behavior\n\nThe assertion should not fail.\n\n### Installed Versions\n\n<details>\r\n\r\n>>> pd.show_versions()\r\n/Users/macbook/miniconda3/envs/ome/lib/python3.10/site-packages/_distutils_hack/__init__.py:33: UserWarning: Setuptools is replacing distutils.\r\n  warnings.warn(\"Setuptools is replacing distutils.\")\r\n\r\nINSTALLED VERSIONS\r\n------------------\r\ncommit           : 2e218d10984e9919f0296931d92ea851c6a6faf5\r\npython           : 3.10.12.final.0\r\npython-bits      : 64\r\nOS               : Darwin\r\nOS-release       : 22.5.0\r\nVersion          : Darwin Kernel Version 22.5.0: Thu Jun  8 22:22:20 PDT 2023; root:xnu-8796.121.3~7/RELEASE_ARM64_T6000\r\nmachine          : arm64\r\nprocessor        : arm\r\nbyteorder        : little\r\nLC_ALL           : en_US.UTF-8\r\nLANG             : en_US.UTF-8\r\nLOCALE           : en_US.UTF-8\r\n\r\npandas           : 1.5.3\r\nnumpy            : 1.23.4\r\npytz             : 2023.3\r\ndateutil         : 2.8.2\r\nsetuptools       : 67.8.0\r\npip              : 23.1.2\r\nCython           : None\r\npytest           : 7.4.0\r\nhypothesis       : None\r\nsphinx           : 4.5.0\r\nblosc            : None\r\nfeather          : None\r\nxlsxwriter       : None\r\nlxml.etree       : None\r\nhtml5lib         : None\r\npymysql          : None\r\npsycopg2         : None\r\njinja2           : 3.1.2\r\nIPython          : 8.14.0\r\npandas_datareader: None\r\nbs4              : 4.12.2\r\nbottleneck       : None\r\nbrotli           : 1.0.9\r\nfastparquet      : None\r\nfsspec           : 2023.6.0\r\ngcsfs            : None\r\nmatplotlib       : 3.7.2\r\nnumba            : 0.57.1\r\nnumexpr          : None\r\nodfpy            : None\r\nopenpyxl         : None\r\npandas_gbq       : None\r\npyarrow          : 12.0.1\r\npyreadstat       : None\r\npyxlsb           : None\r\ns3fs             : 2023.6.0\r\nscipy            : 1.11.1\r\nsnappy           : None\r\nsqlalchemy       : 2.0.18\r\ntables           : None\r\ntabulate         : 0.9.0\r\nxarray           : 2022.12.0\r\nxlrd             : None\r\nxlwt             : None\r\nzstandard        : None\r\ntzdata           : 2023.3\r\n\r\n</details>\r\n","closed_by":{"login":"mroeschke","id":10647082,"node_id":"MDQ6VXNlcjEwNjQ3MDgy","avatar_url":"https://avatars.githubusercontent.com/u/10647082?v=4","gravatar_id":"","url":"https://api.github.com/users/mroeschke","html_url":"https://github.com/mroeschke","followers_url":"https://api.github.com/users/mroeschke/followers","following_url":"https://api.github.com/users/mroeschke/following{/other_user}","gists_url":"https://api.github.com/users/mroeschke/gists{/gist_id}","starred_url":"https://api.github.com/users/mroeschke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mroeschke/subscriptions","organizations_url":"https://api.github.com/users/mroeschke/orgs","repos_url":"https://api.github.com/users/mroeschke/repos","events_url":"https://api.github.com/users/mroeschke/events{/privacy}","received_events_url":"https://api.github.com/users/mroeschke/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pandas-dev/pandas/issues/54134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pandas-dev/pandas/issues/54134/timeline","performed_via_github_app":null,"state_reason":"completed"}