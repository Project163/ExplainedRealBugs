{"url":"https://api.github.com/repos/pandas-dev/pandas/issues/54391","repository_url":"https://api.github.com/repos/pandas-dev/pandas","labels_url":"https://api.github.com/repos/pandas-dev/pandas/issues/54391/labels{/name}","comments_url":"https://api.github.com/repos/pandas-dev/pandas/issues/54391/comments","events_url":"https://api.github.com/repos/pandas-dev/pandas/issues/54391/events","html_url":"https://github.com/pandas-dev/pandas/issues/54391","id":1835720138,"node_id":"I_kwDOAA0YD85tat3K","number":54391,"title":"BUG: SIGBUS in test_float_byteswap test on arm","user":{"login":"thesamesam","id":11667869,"node_id":"MDQ6VXNlcjExNjY3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/11667869?v=4","gravatar_id":"","url":"https://api.github.com/users/thesamesam","html_url":"https://github.com/thesamesam","followers_url":"https://api.github.com/users/thesamesam/followers","following_url":"https://api.github.com/users/thesamesam/following{/other_user}","gists_url":"https://api.github.com/users/thesamesam/gists{/gist_id}","starred_url":"https://api.github.com/users/thesamesam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thesamesam/subscriptions","organizations_url":"https://api.github.com/users/thesamesam/orgs","repos_url":"https://api.github.com/users/thesamesam/repos","events_url":"https://api.github.com/users/thesamesam/events{/privacy}","received_events_url":"https://api.github.com/users/thesamesam/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":76811,"node_id":"MDU6TGFiZWw3NjgxMQ==","url":"https://api.github.com/repos/pandas-dev/pandas/labels/Bug","name":"Bug","color":"e10c02","default":false,"description":null},{"id":258745163,"node_id":"MDU6TGFiZWwyNTg3NDUxNjM=","url":"https://api.github.com/repos/pandas-dev/pandas/labels/IO%20SAS","name":"IO SAS","color":"5319e7","default":false,"description":"SAS: read_sas"},{"id":1121248195,"node_id":"MDU6TGFiZWwxMTIxMjQ4MTk1","url":"https://api.github.com/repos/pandas-dev/pandas/labels/Segfault","name":"Segfault","color":"36ede0","default":false,"description":"Non-Recoverable Error"},{"id":2628846204,"node_id":"MDU6TGFiZWwyNjI4ODQ2MjA0","url":"https://api.github.com/repos/pandas-dev/pandas/labels/ARM","name":"ARM","color":"c2e0c6","default":false,"description":"aarch64 architecture"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-08-03T20:51:52Z","updated_at":"2023-08-04T21:24:00Z","closed_at":"2023-08-04T21:24:00Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Pandas version checks\n\n- [X] I have checked that this issue has not already been reported.\n\n- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.\n\n- [X] I have confirmed this bug exists on the [main branch](https://pandas.pydata.org/docs/dev/getting_started/install.html#installing-the-development-version-of-pandas) of pandas.\n\n\n### Reproducible Example\n\n```python\nRun the pandas-2.0.3 testsuite on armv7.\n```\n\n\n### Issue Description\n\nThe `pandas/tests/io/sas/test_byteswap.py::test_float_byteswap` tests SIGBUS for me on arm (arm64 host, armv7 chroot).\r\n\r\nWhen building with UBSAN (`-fsanitize=undefined`), I get the following:\r\n```\r\npandas/tests/io/sas/test_byteswap.py::test_float_byteswap[False-float32] pandas/io/sas/byteswap.c:2293:15: runtime error: load of misaligned address 0xcc9025db for type 'float', which requires 4 byte alignment\r\n0xcc9025db: note: pointer points here\r\n 26  45 c1 18 00 00 00 00 70  a3 aa 09 40 00 00 00 00  38 21 90 cc 80 d5 90 cc  01 00 00 00 4c 5a c8\r\n              ^\r\n\r\n[gw8] PASSED pandas/tests/io/sas/test_byteswap.py::test_float_byteswap[False-float32]\r\npandas/tests/io/sas/test_byteswap.py::test_float_byteswap[False-float64] pandas/io/sas/byteswap.c:2524:15: runtime error: load of misaligned address 0xbecce23c for type 'double', which requires 8 byte alignment\r\n0xbecce23c: note: pointer points here\r\n  1a e5 23 62 00 00 00 00  00 00 00 00 ec b4 43 2a  c4 10 09 93 00 00 00 00  00 e2 cc be 00 00 00 00\r\n              ^\r\nFatal Python error: Bus error\r\n\r\nThread 0xf6f5b420 (most recent call first):\r\n  File \"/usr/lib/python3.11/site-packages/execnet/gateway_base.py\", line 474 in read\r\n  File \"/usr/lib/python3.11/site-packages/execnet/gateway_base.py\", line 507 in from_io\r\n  File \"/usr/lib/python3.11/site-packages/execnet/gateway_base.py\", line 1049 in _thread_receiver\r\n  File \"/usr/lib/python3.11/site-packages/execnet/gateway_base.py\", line 296 in run\r\n  File \"/usr/lib/python3.11/site-packages/execnet/gateway_base.py\", line 361 in _perform_spawn\r\n\r\nCurrent thread 0xf7d60020 (most recent call first):\r\n  File \"/var/tmp/portage/dev-python/pandas-2.0.3/work/pandas-2.0.3-python3_11/install/usr/lib/python3.11/site-packages/pandas/tests/io/sas/test_byteswap.py\", line 51 in _test\r\n  File \"/var/tmp/portage/dev-python/pandas-2.0.3/work/pandas-2.0.3-python3_11/install/usr/lib/python3.11/site-packages/pandas/tests/io/sas/test_byteswap.py\", line 37 in test_float_byteswap\r\n  File \"/usr/lib/python3.11/site-packages/hypothesis/core.py\", line 785 in run\r\n  File \"/usr/lib/python3.11/site-packages/hypothesis/executors.py\", line 47 in default_new_style_executor\r\n  File \"/usr/lib/python3.11/site-packages/hypothesis/core.py\", line 789 in execute_once\r\n  File \"/usr/lib/python3.11/site-packages/hypothesis/core.py\", line 850 in _execute_once_for_engine\r\n  File \"/usr/lib/python3.11/site-packages/hypothesis/internal/conjecture/engine.py\", line 173 in __stoppable_test_function\r\n  File \"/usr/lib/python3.11/site-packages/hypothesis/internal/conjecture/engine.py\", line 195 in test_function\r\n  File \"/usr/lib/python3.11/site-packages/hypothesis/internal/conjecture/engine.py\", line 1051 in cached_test_function\r\n  File \"/usr/lib/python3.11/site-packages/hypothesis/internal/conjecture/engine.py\", line 670 in generate_new_examples\r\n  File \"/usr/lib/python3.11/site-packages/hypothesis/internal/conjecture/engine.py\", line 866 in _run\r\n  File \"/usr/lib/python3.11/site-packages/hypothesis/internal/conjecture/engine.py\", line 460 in run\r\n  File \"/usr/lib/python3.11/site-packages/hypothesis/core.py\", line 927 in run_engine\r\n  File \"/usr/lib/python3.11/site-packages/hypothesis/core.py\", line 1341 in wrapped_test\r\n  File \"/var/tmp/portage/dev-python/pandas-2.0.3/work/pandas-2.0.3-python3_11/install/usr/lib/python3.11/site-packages/pandas/tests/io/sas/test_byteswap.py\", line 33 in test_float_byteswap\r\n  File \"/usr/lib/python3.11/site-packages/_pytest/python.py\", line 194 in pytest_pyfunc_call\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_callers.py\", line 80 in _multicall\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_manager.py\", line 112 in _hookexec\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_hooks.py\", line 433 in __call__\r\n  File \"/usr/lib/python3.11/site-packages/_pytest/python.py\", line 1788 in runtest\r\n  File \"/usr/lib/python3.11/site-packages/_pytest/runner.py\", line 169 in pytest_runtest_call\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_callers.py\", line 80 in _multicall\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_manager.py\", line 112 in _hookexec\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_hooks.py\", line 433 in __call__\r\n  File \"/usr/lib/python3.11/site-packages/_pytest/runner.py\", line 262 in <lambda>\r\n  File \"/usr/lib/python3.11/site-packages/_pytest/runner.py\", line 341 in from_call\r\n  File \"/usr/lib/python3.11/site-packages/_pytest/runner.py\", line 261 in call_runtest_hook\r\n  File \"/usr/lib/python3.11/site-packages/_pytest/runner.py\", line 222 in call_and_report\r\n  File \"/usr/lib/python3.11/site-packages/_pytest/runner.py\", line 133 in runtestprotocol\r\n  File \"/usr/lib/python3.11/site-packages/_pytest/runner.py\", line 114 in pytest_runtest_protocol\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_callers.py\", line 80 in _multicall\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_manager.py\", line 112 in _hookexec\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_hooks.py\", line 433 in __call__\r\n  File \"/usr/lib/python3.11/site-packages/xdist/remote.py\", line 174 in run_one_test\r\n  File \"/usr/lib/python3.11/site-packages/xdist/remote.py\", line 157 in pytest_runtestloop\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_callers.py\", line 80 in _multicall\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_manager.py\", line 112 in _hookexec\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_hooks.py\", line 433 in __call__\r\n  File \"/usr/lib/python3.11/site-packages/_pytest/main.py\", line 324 in _main\r\n  File \"/usr/lib/python3.11/site-packages/_pytest/main.py\", line 270 in wrap_session\r\n  File \"/usr/lib/python3.11/site-packages/_pytest/main.py\", line 317 in pytest_cmdline_main\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_callers.py\", line 80 in _multicall\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_manager.py\", line 112 in _hookexec\r\n  File \"/usr/lib/python3.11/site-packages/pluggy/_hooks.py\", line 433 in __call__\r\n  File \"/usr/lib/python3.11/site-packages/xdist/remote.py\", line 355 in <module>\r\n  File \"/usr/lib/python3.11/site-packages/execnet/gateway_base.py\", line 1157 in executetask\r\n  File \"/usr/lib/python3.11/site-packages/execnet/gateway_base.py\", line 296 in run\r\n  File \"/usr/lib/python3.11/site-packages/execnet/gateway_base.py\", line 361 in _perform_spawn\r\n  File \"/usr/lib/python3.11/site-packages/execnet/gateway_base.py\", line 343 in integrate_as_primary_thread\r\n  File \"/usr/lib/python3.11/site-packages/execnet/gateway_base.py\", line 1142 in serve\r\n  File \"/usr/lib/python3.11/site-packages/execnet/gateway_base.py\", line 1640 in serve\r\n  File \"<string>\", line 8 in <module>\r\n  File \"<string>\", line 1 in <module>\r\n\r\nExtension modules: numpy.core._multiarray_umath, numpy.core._multiarray_tests, numpy.linalg._umath_linalg, numpy.fft._pocketfft_internal, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._mt19937, numpy.random.mtrand, numpy.random._philox, numpy.random._pcg64, numpy.random._sfc64, numpy.random._generator, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pandas._libs.hashing, pandas._libs.tslib, pandas._libs.ops, numexpr.interpreter, bottleneck.move, bottleneck.nonreduce, bottleneck.nonreduce_axis, bottleneck.reduce, pandas._libs.arrays, pandas._libs.sparse, pandas._libs.reduction, pandas._libs.indexing, pandas._libs.index, pandas._libs.internals, pandas._libs.join, pandas._libs.writers, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.testing, pandas._libs.parsers, pandas._libs.json, matplotlib._c_internal_utils, PIL._imaging, matplotlib._path, kiwisolver._cext, scipy._lib._ccallback_c, numpy.linalg.lapack_lite, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._isolve._iterative, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_sqrtm_triu, scipy.linalg.cython_blas, scipy.linalg._matfuncs_expm, scipy.linalg._decomp_update, scipy.linalg._flinalg, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpack, scipy.sparse.csgraph._tools, scipy.sparse.csgraph._shortest_path, scipy.sparse.csgraph._traversal, scipy.sparse.csgraph._min_spanning_tree, scipy.sparse.csgraph._flow, scipy.sparse.csgraph._matching, scipy.sparse.csgraph._reordering, scipy.spatial._ckdtree, scipy._lib.messagestream, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._distance_wrap, scipy.spatial._hausdorff, scipy.special._ufuncs_cxx, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.special._ellip_harm_2, scipy.spatial.transform._rotation, scipy.ndimage._nd_image, _ni_label, scipy.ndimage._ni_label, scipy.optimize._minpack2, scipy.optimize._group_columns, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._cobyla, scipy.optimize._slsqp, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy.optimize.__nnls, scipy.optimize._highs.cython.src._highs_wrapper, scipy.optimize._highs._highs_wrapper, scipy.optimize._highs.cython.src._highs_constants, scipy.optimize._highs._highs_constants, scipy.linalg._interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.optimize._direct, scipy.integrate._odepack, scipy.integrate._quadpack, scipy.integrate._vode, scipy.integrate._dop, scipy.integrate._lsoda, scipy.special.cython_special, scipy.stats._stats, scipy.stats.beta_ufunc, scipy.stats._boost.beta_ufunc, scipy.stats.binom_ufunc, scipy.stats._boost.binom_ufunc, scipy.stats.nbinom_ufunc, scipy.stats._boost.nbinom_ufunc, scipy.stats.hypergeom_ufunc, scipy.stats._boost.hypergeom_ufunc, scipy.stats.ncf_ufunc, scipy.stats._boost.ncf_ufunc, scipy.stats.ncx2_ufunc, scipy.stats._boost.ncx2_ufunc, scipy.stats.nct_ufunc, scipy.stats._boost.nct_ufunc, scipy.stats.skewnorm_ufunc, scipy.stats._boost.skewnorm_ufunc, scipy.stats.invgauss_ufunc, scipy.stats._boost.invgauss_ufunc, scipy.interpolate._fitpack, scipy.interpolate.dfitpack, scipy.interpolate._bspl, scipy.interpolate._ppoly, scipy.interpolate.interpnd, scipy.interpolate._rbfinterp_pythran, scipy.interpolate._rgi_cython, scipy.stats._biasedurn, scipy.stats._levy_stable.levyst, scipy.stats._stats_pythran, scipy._lib._uarray._uarray, scipy.stats._statlib, scipy.stats._sobol, scipy.stats._qmc_cy, scipy.stats._mvn, scipy.stats._rcont.rcont, scipy.signal._sigtools, scipy.signal._max_len_seq_inner, scipy.signal._upfirdn_apply, scipy.signal._spline, scipy.signal._sosfilt, scipy.signal._spectral, scipy.signal._peak_finding_utils, markupsafe._speedups, lxml._elementpath, lxml.etree, sqlalchemy.cyextension.collections, sqlalchemy.cyextension.immutabledict, sqlalchemy.cyextension.processors, sqlalchemy.cyextension.resultproxy, sqlalchemy.cyextension.util, matplotlib._image, tables._comp_lzo, tables._comp_bzip2, tables.utilsextension, tables.hdf5extension, tables.linkextension, tables.lrucacheextension, tables.tableextension, tables.indexesextension, pandas.io.sas._byteswap, psycopg2._psycopg (total: 191)\r\n```\r\n\r\nBoth these tests and this functionality were introduced in https://github.com/pandas-dev/pandas/commit/c855be85bdb08dfb8d503f9f1ce5daf6e037a59d (cc @jonashaag).\n\n### Expected Behavior\n\nAll tests pass.\n\n### Installed Versions\n\n<details>\r\n# python3 -c 'import pandas as pd;  pd.show_versions()'\r\n/usr/lib/python3.11/site-packages/_distutils_hack/__init__.py:33: UserWarning: Setuptools is replacing distutils.\r\n  warnings.warn(\"Setuptools is replacing distutils.\")\r\n\r\nINSTALLED VERSIONS\r\n------------------\r\ncommit           : 0f437949513225922d851e9581723d82120684a6\r\npython           : 3.11.4.final.0\r\npython-bits      : 32\r\nOS               : Linux\r\nOS-release       : 5.15.117-gentoo-dist\r\nVersion          : #1 SMP Wed Jun 14 13:14:49 -00 2023\r\nmachine          : armv8l\r\nprocessor        : ARMv8 Processor rev 1 (v8l)\r\nbyteorder        : little\r\nLC_ALL           : None\r\nLANG             : C.UTF8\r\nLOCALE           : en_US.UTF-8\r\n\r\npandas           : 2.0.3\r\nnumpy            : 1.25.2\r\npytz             : 2023.3\r\ndateutil         : 2.8.2\r\nsetuptools       : 68.0.0\r\npip              : None\r\nCython           : 3.0.0\r\npytest           : 7.4.0\r\nhypothesis       : 6.82.0\r\nsphinx           : None\r\nblosc            : 1.11.1\r\nfeather          : None\r\nxlsxwriter       : 3.1.2\r\nlxml.etree       : 4.9.3\r\nhtml5lib         : 1.1\r\npymysql          : 1.4.6\r\npsycopg2         : 2.9.4\r\njinja2           : 3.1.2\r\nIPython          : None\r\npandas_datareader: None\r\nbs4              : 4.12.2\r\nbottleneck       : 1.3.7\r\nbrotli           : None\r\nfastparquet      : None\r\nfsspec           : None\r\ngcsfs            : None\r\nmatplotlib       : 3.7.2\r\nnumba            : None\r\nnumexpr          : 2.8.4\r\nodfpy            : None\r\nopenpyxl         : 3.1.2\r\npandas_gbq       : None\r\npyarrow          : None\r\npyreadstat       : None\r\npyxlsb           : None\r\ns3fs             : None\r\nscipy            : 1.11.1\r\nsnappy           : None\r\nsqlalchemy       : 2.0.19\r\ntables           : 3.8.0\r\ntabulate         : 0.9.0\r\nxarray           : 2023.7.0\r\nxlrd             : 2.0.1\r\nzstandard        : None\r\ntzdata           : None\r\nqtpy             : None\r\npyqt5            : None\r\n</details>","closed_by":{"login":"mroeschke","id":10647082,"node_id":"MDQ6VXNlcjEwNjQ3MDgy","avatar_url":"https://avatars.githubusercontent.com/u/10647082?v=4","gravatar_id":"","url":"https://api.github.com/users/mroeschke","html_url":"https://github.com/mroeschke","followers_url":"https://api.github.com/users/mroeschke/followers","following_url":"https://api.github.com/users/mroeschke/following{/other_user}","gists_url":"https://api.github.com/users/mroeschke/gists{/gist_id}","starred_url":"https://api.github.com/users/mroeschke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mroeschke/subscriptions","organizations_url":"https://api.github.com/users/mroeschke/orgs","repos_url":"https://api.github.com/users/mroeschke/repos","events_url":"https://api.github.com/users/mroeschke/events{/privacy}","received_events_url":"https://api.github.com/users/mroeschke/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pandas-dev/pandas/issues/54391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pandas-dev/pandas/issues/54391/timeline","performed_via_github_app":null,"state_reason":"completed"}