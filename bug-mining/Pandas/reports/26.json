{"url":"https://api.github.com/repos/pandas-dev/pandas/issues/61222","repository_url":"https://api.github.com/repos/pandas-dev/pandas","labels_url":"https://api.github.com/repos/pandas-dev/pandas/issues/61222/labels{/name}","comments_url":"https://api.github.com/repos/pandas-dev/pandas/issues/61222/comments","events_url":"https://api.github.com/repos/pandas-dev/pandas/issues/61222/events","html_url":"https://github.com/pandas-dev/pandas/issues/61222","id":2969126559,"node_id":"I_kwDOAA0YD86w-Uaf","number":61222,"title":"BUG: Index name lost when using \"resample\" with pyarrow dtypes","user":{"login":"mthiboust","id":14574229,"node_id":"MDQ6VXNlcjE0NTc0MjI5","avatar_url":"https://avatars.githubusercontent.com/u/14574229?v=4","gravatar_id":"","url":"https://api.github.com/users/mthiboust","html_url":"https://github.com/mthiboust","followers_url":"https://api.github.com/users/mthiboust/followers","following_url":"https://api.github.com/users/mthiboust/following{/other_user}","gists_url":"https://api.github.com/users/mthiboust/gists{/gist_id}","starred_url":"https://api.github.com/users/mthiboust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mthiboust/subscriptions","organizations_url":"https://api.github.com/users/mthiboust/orgs","repos_url":"https://api.github.com/users/mthiboust/repos","events_url":"https://api.github.com/users/mthiboust/events{/privacy}","received_events_url":"https://api.github.com/users/mthiboust/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":76811,"node_id":"MDU6TGFiZWw3NjgxMQ==","url":"https://api.github.com/repos/pandas-dev/pandas/labels/Bug","name":"Bug","color":"e10c02","default":false,"description":null},{"id":74975453,"node_id":"MDU6TGFiZWw3NDk3NTQ1Mw==","url":"https://api.github.com/repos/pandas-dev/pandas/labels/Resample","name":"Resample","color":"207de5","default":false,"description":"resample method"},{"id":3303158446,"node_id":"MDU6TGFiZWwzMzAzMTU4NDQ2","url":"https://api.github.com/repos/pandas-dev/pandas/labels/Arrow","name":"Arrow","color":"f9d0c4","default":false,"description":"pyarrow functionality"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2025-04-03T10:37:17Z","updated_at":"2025-04-07T16:55:10Z","closed_at":"2025-04-07T16:55:10Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Pandas version checks\n\n- [x] I have checked that this issue has not already been reported.\n\n- [x] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.\n\n- [ ] I have confirmed this bug exists on the [main branch](https://pandas.pydata.org/docs/dev/getting_started/install.html#installing-the-development-version-of-pandas) of pandas.\n\n\n### Reproducible Example\n\n```python\nimport pandas as pd\n\n# Create a df with DatetimeIndex called \"timestamp\" and native pandas dtype\nnative_df = pd.DataFrame(\n    {'value': [23.5, 24.1, 22.8, 25.3, 23.9]},\n    index=pd.date_range(start='2025-01-01 00:00:00', end='2025-01-01 04:00:00', freq='h'),\n)\nnative_df.index.name = \"timestamp\"\n\n# Create a similar df with pyarrow dtypes\npyarrow_df = native_df.copy()\npyarrow_df.index = pyarrow_df.index.astype('timestamp[ns][pyarrow]')\npyarrow_df[\"value\"] = pyarrow_df[\"value\"].astype('float64[pyarrow]')\n\nnative_df.resample(\"2h\").mean().reset_index()[\"timestamp\"] # OK\npyarrow_df.resample(\"2h\").mean().reset_index()[\"timestamp\"] # KeyError: 'timestamp'\n```\n\n### Issue Description\n\nThe `resample` forget the name of the index when using `pyarrow` dtypes. \n\nBy the way, I notice that `DatetimeIndex` are converted to `Index` when using `pyarrow` dtypes. Maybe it is related?\n\nSee concrete example in screenshot\n![Image](https://github.com/user-attachments/assets/a9b1b5f7-907d-4910-abb4-5be186bcb2d9)\n\n\n\n### Expected Behavior\n\nThe `resample` methods is expected to behave in the same way for `pyarrow` and `native` dtypes.\n\n### Installed Versions\n\n<details>\n\nINSTALLED VERSIONS\n------------------\npython                : 3.12.8\npython-bits           : 64\nOS                    : Linux\nOS-release            : 5.10.234-225.910.amzn2.x86_64\nVersion               : #1 SMP Fri Feb 14 16:52:40 UTC 2025\nmachine               : x86_64\nprocessor             : x86_64\nbyteorder             : little\nLC_ALL                : C.UTF-8\nLANG                  : C.UTF-8\nLOCALE                : C.UTF-8\n\npandas                : 2.2.3\nnumpy                 : 1.26.4\npytz                  : 2025.1\ndateutil              : 2.9.0.post0\npip                   : 25.0.1\nCython                : None\nsphinx                : None\nIPython               : 8.32.0\nadbc-driver-postgresql: None\nadbc-driver-sqlite    : None\nbs4                   : 4.13.3\nblosc                 : None\nbottleneck            : None\ndataframe-api-compat  : None\nfastparquet           : None\nfsspec                : 2025.3.2\nhtml5lib              : None\nhypothesis            : None\ngcsfs                 : None\njinja2                : 3.1.5\nlxml.etree            : None\nmatplotlib            : 3.10.1\nnumba                 : None\nnumexpr               : None\nodfpy                 : None\nopenpyxl              : None\npandas_gbq            : None\npsycopg2              : None\npymysql               : None\npyarrow               : 19.0.1\npyreadstat            : None\npytest                : None\npython-calamine       : None\npyxlsb                : None\ns3fs                  : 2025.3.2\nscipy                 : 1.15.2\nsqlalchemy            : 2.0.38\ntables                : None\ntabulate              : None\nxarray                : None\nxlrd                  : None\nxlsxwriter            : None\nzstandard             : 0.23.0\ntzdata                : 2025.2\nqtpy                  : None\npyqt5                 : None\n</details>\n","closed_by":{"login":"mroeschke","id":10647082,"node_id":"MDQ6VXNlcjEwNjQ3MDgy","avatar_url":"https://avatars.githubusercontent.com/u/10647082?v=4","gravatar_id":"","url":"https://api.github.com/users/mroeschke","html_url":"https://github.com/mroeschke","followers_url":"https://api.github.com/users/mroeschke/followers","following_url":"https://api.github.com/users/mroeschke/following{/other_user}","gists_url":"https://api.github.com/users/mroeschke/gists{/gist_id}","starred_url":"https://api.github.com/users/mroeschke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mroeschke/subscriptions","organizations_url":"https://api.github.com/users/mroeschke/orgs","repos_url":"https://api.github.com/users/mroeschke/repos","events_url":"https://api.github.com/users/mroeschke/events{/privacy}","received_events_url":"https://api.github.com/users/mroeschke/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pandas-dev/pandas/issues/61222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pandas-dev/pandas/issues/61222/timeline","performed_via_github_app":null,"state_reason":"completed"}