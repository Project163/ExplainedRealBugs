{"url":"https://api.github.com/repos/pandas-dev/pandas/issues/61123","repository_url":"https://api.github.com/repos/pandas-dev/pandas","labels_url":"https://api.github.com/repos/pandas-dev/pandas/issues/61123/labels{/name}","comments_url":"https://api.github.com/repos/pandas-dev/pandas/issues/61123/comments","events_url":"https://api.github.com/repos/pandas-dev/pandas/issues/61123/events","html_url":"https://github.com/pandas-dev/pandas/issues/61123","id":2921326125,"node_id":"I_kwDOAA0YD86uH-Yt","number":61123,"title":"DOC: `read_excel` `nrows` parameter reads extra rows when tables are adjacent (no blank row)","user":{"login":"robertutterback","id":2722476,"node_id":"MDQ6VXNlcjI3MjI0NzY=","avatar_url":"https://avatars.githubusercontent.com/u/2722476?v=4","gravatar_id":"","url":"https://api.github.com/users/robertutterback","html_url":"https://github.com/robertutterback","followers_url":"https://api.github.com/users/robertutterback/followers","following_url":"https://api.github.com/users/robertutterback/following{/other_user}","gists_url":"https://api.github.com/users/robertutterback/gists{/gist_id}","starred_url":"https://api.github.com/users/robertutterback/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robertutterback/subscriptions","organizations_url":"https://api.github.com/users/robertutterback/orgs","repos_url":"https://api.github.com/users/robertutterback/repos","events_url":"https://api.github.com/users/robertutterback/events{/privacy}","received_events_url":"https://api.github.com/users/robertutterback/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":134699,"node_id":"MDU6TGFiZWwxMzQ2OTk=","url":"https://api.github.com/repos/pandas-dev/pandas/labels/Docs","name":"Docs","color":"3465A4","default":false,"description":null},{"id":49254273,"node_id":"MDU6TGFiZWw0OTI1NDI3Mw==","url":"https://api.github.com/repos/pandas-dev/pandas/labels/IO%20Excel","name":"IO Excel","color":"bfe5bf","default":false,"description":"read_excel, to_excel"},{"id":717120670,"node_id":"MDU6TGFiZWw3MTcxMjA2NzA=","url":"https://api.github.com/repos/pandas-dev/pandas/labels/good%20first%20issue","name":"good first issue","color":"0e8a16","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-03-14T21:30:43Z","updated_at":"2025-03-19T20:37:24Z","closed_at":"2025-03-19T20:37:24Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Pandas version checks\n\n- [x] I have checked that this issue has not already been reported.\n\n- [x] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.\n\n- [x] I have confirmed this bug exists on the [main branch](https://pandas.pydata.org/docs/dev/getting_started/install.html#installing-the-development-version-of-pandas) of pandas.\n\n\n### Reproducible Example\n\n```python\nimport pandas as pd\n\n# Two tables, each header row + 3 data rows\nfile1 = \"test1.xlsx\" # blank row between the tables\nfile2 = \"test2.xlsx\" # no blank row between the tables\ndf1 = pd.read_excel(file1, header=0, nrows=4)\ndf2 = pd.read_excel(file2, header=0, nrows=4)\n\nprint(df1)\nprint(df2)\nassert df1.shape == df2.shape\n\n# df2 includes the header row of the following table\n```\n\n### Issue Description\n\nConsider two Excel files with nearly identical data: two tables, each with a header row and 3 data rows. The only difference is that the first has a blank row between the tables and the second does not.\n\nIt seems that the blank line makes a difference, even when `nrows` is specified. I expect `nrows=4` to always parse 4 rows, yielding a data frame with a header and 3 data rows. Yet without a blank line, `read_excel` also includes the next row, which is the header for the next table.\n\n[test1.xlsx](https://github.com/user-attachments/files/19254818/test1.xlsx)\n[test2.xlsx](https://github.com/user-attachments/files/19254817/test2.xlsx)\n\n### Expected Behavior\n\nI expect `nrows=4` to always parse 4 rows regardless of context: a header and 3 data rows.\n\n### Installed Versions\n\n<details>\n\nINSTALLED VERSIONS\n------------------\ncommit                : 0691c5cf90477d3503834d983f69350f250a6ff7\npython                : 3.11.0rc1\npython-bits           : 64\nOS                    : Linux\nOS-release            : 5.15.167.4-microsoft-standard-WSL2\nVersion               : #1 SMP Tue Nov 5 00:21:55 UTC 2024\nmachine               : x86_64\nprocessor             : x86_64\nbyteorder             : little\nLC_ALL                : None\nLANG                  : C.UTF-8\nLOCALE                : en_US.UTF-8\n\npandas                : 2.2.3\nnumpy                 : 1.26.4\npytz                  : 2024.1\ndateutil              : 2.9.0.post0\npip                   : 25.0.1\nCython                : None\nsphinx                : None\nIPython               : 8.12.3\nadbc-driver-postgresql: None\nadbc-driver-sqlite    : None\nbs4                   : 4.12.3\nblosc                 : None\nbottleneck            : None\ndataframe-api-compat  : None\nfastparquet           : None\nfsspec                : None\nhtml5lib              : None\nhypothesis            : None\ngcsfs                 : None\njinja2                : 3.1.3\nlxml.etree            : None\nmatplotlib            : 3.8.4\nnumba                 : None\nnumexpr               : None\nodfpy                 : None\nopenpyxl              : 3.1.2\npandas_gbq            : None\npsycopg2              : None\npymysql               : None\npyarrow               : None\npyreadstat            : None\npytest                : 8.2.0\npython-calamine       : None\npyxlsb                : None\ns3fs                  : None\nscipy                 : 1.15.2\nsqlalchemy            : None\ntables                : None\ntabulate              : None\nxarray                : None\nxlrd                  : 2.0.1\nxlsxwriter            : 3.2.0\nzstandard             : None\ntzdata                : 2024.1\nqtpy                  : None\npyqt5                 : None\n\n</details>\n","closed_by":{"login":"mroeschke","id":10647082,"node_id":"MDQ6VXNlcjEwNjQ3MDgy","avatar_url":"https://avatars.githubusercontent.com/u/10647082?v=4","gravatar_id":"","url":"https://api.github.com/users/mroeschke","html_url":"https://github.com/mroeschke","followers_url":"https://api.github.com/users/mroeschke/followers","following_url":"https://api.github.com/users/mroeschke/following{/other_user}","gists_url":"https://api.github.com/users/mroeschke/gists{/gist_id}","starred_url":"https://api.github.com/users/mroeschke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mroeschke/subscriptions","organizations_url":"https://api.github.com/users/mroeschke/orgs","repos_url":"https://api.github.com/users/mroeschke/repos","events_url":"https://api.github.com/users/mroeschke/events{/privacy}","received_events_url":"https://api.github.com/users/mroeschke/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pandas-dev/pandas/issues/61123/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pandas-dev/pandas/issues/61123/timeline","performed_via_github_app":null,"state_reason":"completed"}