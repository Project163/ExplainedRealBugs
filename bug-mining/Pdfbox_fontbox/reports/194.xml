<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:49:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3344] Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont can not be cast to org.apache.fontbox.cff.CFFFont</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3344</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;I&apos;m getting this error opening a specific pdf&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont can not be cast to org.apache.fontbox.cff.CFFFont
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</description>
                <environment></environment>
        <key id="12966011">PDFBOX-3344</key>
            <summary>Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont can not be cast to org.apache.fontbox.cff.CFFFont</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jahewson">John Hewson</assignee>
                                    <reporter username="373mich">373 mch</reporter>
                        <labels>
                    </labels>
                <created>Mon, 9 May 2016 09:38:00 +0000</created>
                <updated>Sat, 25 Mar 2017 18:12:35 +0000</updated>
                            <resolved>Sun, 7 Aug 2016 12:11:15 +0000</resolved>
                                    <version>2.0.1</version>
                                    <fixVersion>2.0.3</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>FontBox</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15276219" author="tilman" created="Mon, 9 May 2016 11:00:17 +0000"  >&lt;p&gt;I&apos;m on W7 with JDK7 and I get&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;WARNUNG: Could not read embedded TTF &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; font AAAAAC+FedraSansCondStd-Demi
java.io.IOException: loca is mandatory
(...)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and then&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Mai 09, 2016 12:57:45 PM org.apache.pdfbox.pdmodel.font.PDCIDFontType2 &amp;lt;init&amp;gt;
WARNUNG: Using fallback font LiberationSans &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; CID-keyed TrueType font AAAAAC+FedraSansCondStd-Demi
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and the file is displayed properly. What do you get? Please post the full output, and mention what JDK and what OS you are using.&lt;/p&gt;</comment>
                            <comment id="15276244" author="373mich" created="Mon, 9 May 2016 11:37:16 +0000"  >&lt;p&gt;Hi, &lt;br/&gt;
thank you for your reply.&lt;br/&gt;
I&apos;m on Windows 7, JRE 8.60.&lt;/p&gt;

&lt;p&gt;This PDF is generated on the fly by TCPDF library.&lt;/p&gt;

&lt;p&gt;Displayed correctly with the correct font &quot;FedraSans&quot; on Adobe Reader, Chrome PDF preview.&lt;/p&gt;

&lt;p&gt;I&apos;m using QZTray plugin to print PDF directly from the browser.&lt;br/&gt;
This is the error output&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[DEBUG] 2016-05-09 13:32:47,704 @ qz.ws.PrintSocketClient:?
        Using qz.printer.action.PrintPDF to print
[DEBUG] 2016-05-09 13:32:47,705 @ qz.printer.PrintServiceMatcher:?
        Searching for PrintService matching OKI MC362(PCL)
[DEBUG] 2016-05-09 13:32:47,706 @ qz.printer.PrintServiceMatcher:?
        Found 9 printers
[DEBUG] 2016-05-09 13:32:47,706 @ qz.printer.PrintServiceMatcher:?
        Found match: OKI MC362(PCL)
[DEBUG] 2016-05-09 13:32:47,779 @ qz.utils.PrintingUtilities:?
        Found Resolution: null
[DEBUG] 2016-05-09 13:32:47,949 @ qz.printer.action.PrintPDF:?
        Parsed 1 files for printing
[TRACE] 2016-05-09 13:32:47,975 @ qz.printer.action.PrintPixel:?
        DPI: 0.0        CNV: 2.83464
[TRACE] 2016-05-09 13:32:47,975 @ qz.printer.action.PrintPixel:?
        Drawable area: 0.0,0.0:210.0,297.0
[TRACE] 2016-05-09 13:32:47,976 @ qz.printer.action.PrintPixel:?
        [(0.0,0.0)-&amp;gt;(210.0,297.0)mm, color]
[INFO] 2016-05-09 13:32:47,988 @ qz.printer.action.PrintPixel:?
        Starting printing (1 copies)
[ERROR] 2016-05-09 13:32:49,539 @ qz.ws.PrintSocketClient:?
        Connection error
java.lang.RuntimeException: Cannot call method public void qz.ws.PrintSocketClie
nt#onMessage(org.eclipse.jetty.websocket.api.Session, java.io.Reader) with args:
 [org.eclipse.jetty.websocket.common.WebSocketSession, org.eclipse.jetty.websock
et.common.message.MessageReader]
        at org.eclipse.jetty.websocket.common.events.annotated.CallableMethod.un
wrapRuntimeException(CallableMethod.java:93)
        at org.eclipse.jetty.websocket.common.events.annotated.CallableMethod.ca
ll(CallableMethod.java:75)
        at org.eclipse.jetty.websocket.common.events.annotated.OptionalSessionCa
llableMethod.call(OptionalSessionCallableMethod.java:68)
        at org.eclipse.jetty.websocket.common.events.JettyAnnotatedEventDriver$2
.run(JettyAnnotatedEventDriver.java:210)
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPoo
l.java:635)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool
.java:555)
        at java.lang.Thread.run(Unknown Source)
Caused by: java.lang.ExceptionInInitializerError
        at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory
.java:62)
        at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:123)
        at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(
SetFontAndSize.java:60)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFSt
reamEngine.java:815)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperator
s(PDFStreamEngine.java:472)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStre
amEngine.java:446)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStream
Engine.java:149)
        at org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:189)
        at org.apache.pdfbox.rendering.PDFRenderer.renderPage(PDFRenderer.java:2
08)
        at org.apache.pdfbox.rendering.PDFRenderer.renderPageToGraphics(PDFRende
rer.java:169)
        at org.apache.pdfbox.printing.PDFPrintable.print(PDFPrintable.java:184)
        at sun.print.RasterPrinterJob.printPage(Unknown Source)
        at sun.print.RasterPrinterJob.print(Unknown Source)
        at qz.printer.action.PrintPixel.printCopies(Unknown Source)
        at qz.printer.action.PrintPDF.print(Unknown Source)
        at qz.ws.PrintSocketClient.processPrintRequest(Unknown Source)
        at qz.ws.PrintSocketClient.processMessage(Unknown Source)
        at qz.ws.PrintSocketClient.onMessage(Unknown Source)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.eclipse.jetty.websocket.common.events.annotated.CallableMethod.ca
ll(CallableMethod.java:70)
        ... 5 more
Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont can
not be cast to org.apache.fontbox.cff.CFFFont
        at org.apache.pdfbox.pdmodel.font.FontMapperImpl.findFontBoxFont(FontMap
perImpl.java:384)
        at org.apache.pdfbox.pdmodel.font.FontMapperImpl.getFontBoxFont(FontMapp
erImpl.java:352)
        at org.apache.pdfbox.pdmodel.font.PDType1Font.&amp;lt;init&amp;gt;(PDType1Font.java:11
5)
        at org.apache.pdfbox.pdmodel.font.PDType1Font.&amp;lt;clinit&amp;gt;(PDType1Font.java:
80)
        ... 28 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                            <comment id="15276283" author="tilman" created="Mon, 9 May 2016 12:11:54 +0000"  >&lt;p&gt;Can you display / print the attached file helvetica.pdf with pdfbox (e.g. with the PDFDebugger app)?&lt;/p&gt;

&lt;p&gt;If not, go to your user directory (%HOMEPATH%), and upload the file &quot;.pdfbox.cache&quot;.&lt;/p&gt;</comment>
                            <comment id="15276298" author="373mich" created="Mon, 9 May 2016 12:28:27 +0000"  >&lt;p&gt;PDFDebugger of helvetica.pdf&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.lang.ExceptionInInitializerError
    org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.done(PagePane.java:176)
    sun.swing.AccumulativeRunnable.run(Unknown Source)
    java.security.AccessController.doPrivileged(Native Method)
    java.security.ProtectionDomain$JavaSecurityAccessImpl.doIntersectionPrivilege(Unknown Source)
Caused by: java.util.concurrent.ExecutionException: java.lang.ExceptionInInitializerError
    org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.done(PagePane.java:165)
    sun.swing.AccumulativeRunnable.run(Unknown Source)
    java.security.AccessController.doPrivileged(Native Method)
    java.security.ProtectionDomain$JavaSecurityAccessImpl.doIntersectionPrivilege(Unknown Source)
Caused by: java.lang.ExceptionInInitializerError: null
    org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:62)
    org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:123)
    org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:60)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:815)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:472)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:446)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:149)
    org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:189)
    org.apache.pdfbox.rendering.PDFRenderer.renderPage(PDFRenderer.java:208)
    org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:139)
    org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:68)
    org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackground(PagePane.java:156)
    org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackground(PagePane.java:139)
    java.lang.Thread.run(Unknown Source)
Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont cannot be cast to org.apache.fontbox.cff.CFFFont
    org.apache.pdfbox.pdmodel.font.FontMapperImpl.findFontBoxFont(FontMapperImpl.java:384)
    org.apache.pdfbox.pdmodel.font.FontMapperImpl.getFontBoxFont(FontMapperImpl.java:352)
    org.apache.pdfbox.pdmodel.font.PDType1Font.&amp;lt;init&amp;gt;(PDType1Font.java:115)
    org.apache.pdfbox.pdmodel.font.PDType1Font.&amp;lt;clinit&amp;gt;(PDType1Font.java:80)
    org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:62)
    org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:123)
    org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:60)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:815)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:472)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:446)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:149)
    org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:189)
    org.apache.pdfbox.rendering.PDFRenderer.renderPage(PDFRenderer.java:208)
    org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:139)
    org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:68)
    org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackground(PagePane.java:156)
    org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackground(PagePane.java:139)
    java.lang.Thread.run(Unknown Source)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;PDFDebugger of etichette.pdf&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.lang.ExceptionInInitializerError
    org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.done(PagePane.java:176)
    sun.swing.AccumulativeRunnable.run(Unknown Source)
    java.security.AccessController.doPrivileged(Native Method)
    java.security.ProtectionDomain$JavaSecurityAccessImpl.doIntersectionPrivilege(Unknown Source)
Caused by: java.util.concurrent.ExecutionException: java.lang.ExceptionInInitializerError
    org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.done(PagePane.java:165)
    sun.swing.AccumulativeRunnable.run(Unknown Source)
    java.security.AccessController.doPrivileged(Native Method)
    java.security.ProtectionDomain$JavaSecurityAccessImpl.doIntersectionPrivilege(Unknown Source)
Caused by: java.lang.ExceptionInInitializerError: null
    org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:62)
    org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:123)
    org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:60)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:815)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:472)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:446)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:149)
    org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:189)
    org.apache.pdfbox.rendering.PDFRenderer.renderPage(PDFRenderer.java:208)
    org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:139)
    org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:68)
    org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackground(PagePane.java:156)
    org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackground(PagePane.java:139)
    java.lang.Thread.run(Unknown Source)
Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont cannot be cast to org.apache.fontbox.cff.CFFFont
    org.apache.pdfbox.pdmodel.font.FontMapperImpl.findFontBoxFont(FontMapperImpl.java:384)
    org.apache.pdfbox.pdmodel.font.FontMapperImpl.getFontBoxFont(FontMapperImpl.java:352)
    org.apache.pdfbox.pdmodel.font.PDType1Font.&amp;lt;init&amp;gt;(PDType1Font.java:115)
    org.apache.pdfbox.pdmodel.font.PDType1Font.&amp;lt;clinit&amp;gt;(PDType1Font.java:80)
    org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:62)
    org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:123)
    org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:60)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:815)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:472)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:446)
    org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:149)
    org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:189)
    org.apache.pdfbox.rendering.PDFRenderer.renderPage(PDFRenderer.java:208)
    org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:139)
    org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:68)
    org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackground(PagePane.java:156)
    org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackground(PagePane.java:139)
    java.lang.Thread.run(Unknown Source)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15276314" author="tilman" created="Mon, 9 May 2016 12:45:45 +0000"  >&lt;p&gt;So this is the cause:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Helvetica|OTF||190|0|1|0|0|020b0500000000000000|C:\Windows\FONTS\Helvetica.otf
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This code in FileSystemFontProvider&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; OTF: font = parent.getOTFFont(postScriptName, file); &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;will always return an OpenTypeFont object. Thus this code in FontMapperImpl.findFontBoxFont&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CFFFont cff = (CFFFont)findFont(FontFormat.OTF, postScriptName);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;would never work. The obvious solution would be&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;OpenTypeFont otf = (OpenTypeFont) findFont(FontFormat.OTF, postScriptName);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I&apos;ll test this and see what happens, LOL.&lt;/p&gt;</comment>
                            <comment id="15276336" author="373mich" created="Mon, 9 May 2016 13:08:56 +0000"  >&lt;p&gt;Great!&lt;br/&gt;
Thank you... will look forward for your tests.&lt;/p&gt;</comment>
                            <comment id="15276354" author="jira-bot" created="Mon, 9 May 2016 13:26:45 +0000"  >&lt;p&gt;Commit 1742945 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1742945&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1742945&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3344&quot; title=&quot;Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont can not be cast to org.apache.fontbox.cff.CFFFont&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3344&quot;&gt;&lt;del&gt;PDFBOX-3344&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException&lt;/p&gt;</comment>
                            <comment id="15276355" author="jira-bot" created="Mon, 9 May 2016 13:27:14 +0000"  >&lt;p&gt;Commit 1742946 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1742946&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1742946&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3344&quot; title=&quot;Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont can not be cast to org.apache.fontbox.cff.CFFFont&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3344&quot;&gt;&lt;del&gt;PDFBOX-3344&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException&lt;/p&gt;</comment>
                            <comment id="15276358" author="tilman" created="Mon, 9 May 2016 13:30:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=373mich&quot; class=&quot;user-hover&quot; rel=&quot;373mich&quot;&gt;373mich&lt;/a&gt; the tests worked. A snapshot version will be available within a few hours&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.2-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.2-SNAPSHOT/&lt;/a&gt;&lt;br/&gt;
please test whether your software works now.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; please review this change. I suspect it never happened before because this is the first time that somebody has one of the standard 14 fonts as OTF, and nobody came with a PDF with non-embedded fonts that are available as OTF.&lt;/p&gt;</comment>
                            <comment id="15276906" author="373mich" created="Mon, 9 May 2016 19:56:05 +0000"  >&lt;p&gt;Many many thanks to you.&lt;/p&gt;

&lt;p&gt;Just rencompiled and run...&lt;/p&gt;

&lt;p&gt;No errors on opening file now.&lt;/p&gt;

&lt;p&gt;helvetica.pdf worked... but if I open etichette.pdf with i get this&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;mag 09, 2016 9:51:20 PM org.apache.pdfbox.pdmodel.font.PDCIDFontType2 &amp;lt;init&amp;gt;
AVVERTENZA: Could not read embedded TTF for font AAAAAC+FedraSansCondStd-Demi
java.io.IOException: loca is mandatory
        at org.apache.fontbox.ttf.TTFParser.parseTables(TTFParser.java:206)
        at org.apache.fontbox.ttf.TTFParser.parse(TTFParser.java:150)
        at org.apache.fontbox.ttf.TTFParser.parse(TTFParser.java:106)
        at org.apache.pdfbox.pdmodel.font.PDCIDFontType2.&amp;lt;init&amp;gt;(PDCIDFontType2.j
ava:111)
        at org.apache.pdfbox.pdmodel.font.PDCIDFontType2.&amp;lt;init&amp;gt;(PDCIDFontType2.j
ava:70)
        at org.apache.pdfbox.pdmodel.font.PDFontFactory.createDescendantFont(PDF
ontFactory.java:125)
        at org.apache.pdfbox.pdmodel.font.PDType0Font.&amp;lt;init&amp;gt;(PDType0Font.java:12
8)
        at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory
.java:83)
        at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:123)
        at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(
SetFontAndSize.java:60)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFSt
reamEngine.java:815)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperator
s(PDFStreamEngine.java:472)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStre
amEngine.java:446)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStream
Engine.java:149)
        at org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:189)
        at org.apache.pdfbox.rendering.PDFRenderer.renderPage(PDFRenderer.java:2
08)
        at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:
139)
        at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:
68)
        at org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackgro
und(PagePane.java:156)
        at org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackgro
und(PagePane.java:139)
        at javax.swing.SwingWorker$1.call(Unknown Source)
        at java.util.concurrent.FutureTask.run(Unknown Source)
        at javax.swing.SwingWorker.run(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and the result is as the attached screenshot.&lt;/p&gt;</comment>
                            <comment id="15276935" author="tilman" created="Mon, 9 May 2016 20:11:19 +0000"  >&lt;p&gt;I do also get that exception, this is because the embedded font is missing a table. However after that I get this output:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Mai 09, 2016 10:00:29 PM org.apache.pdfbox.pdmodel.font.PDCIDFontType2 &amp;lt;init&amp;gt;
WARNUNG: Using fallback font LiberationSans &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; CID-keyed TrueType font AAAAAC+FedraSansCondStd-Demi
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;You get nothing, so for you PDFBox is using this font&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;FedraSansCondStd-Demi|OTF||190|0|20000093|0|0|02000506040000020004|C:\Windows\FONTS\FedraSansCondStd-Demi.otf
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is one for John... I&apos;m wondering how the CID =&amp;gt; GlhyphID is kept when a different font is used.&lt;/p&gt;

&lt;p&gt;Can you use a different font? Or ask TCPDF why the &quot;loca&quot; table is missing in the embedded font?&lt;/p&gt;</comment>
                            <comment id="15277095" author="373mich" created="Mon, 9 May 2016 21:38:02 +0000"  >&lt;p&gt;Yes,&lt;br/&gt;
but on other PDF readers such as Adobe Reader and Chrome PDF viewer fonts are displaying correctly.&lt;br/&gt;
Is there any way to check if the loca table is really missing or if fontbox is not reading it?&lt;/p&gt;</comment>
                            <comment id="15277121" author="tilman" created="Mon, 9 May 2016 21:53:35 +0000"  >&lt;p&gt;The message shows that it doesn&apos;t exist.&lt;br/&gt;
You could extract the font subset file with PDF Debugger and analyse the font with a font tool.&lt;/p&gt;

&lt;p&gt;That other readers are displaying it properly is probably because they do a successful substitution. (It also works on my system). I&apos;d suspect that there&apos;s a bug in fontbox, maybe that the font can&apos;t be replaced with an OTF font.&lt;/p&gt;</comment>
                            <comment id="15277171" author="373mich" created="Mon, 9 May 2016 22:14:05 +0000"  >&lt;p&gt;I&apos;ve just made a try, I&apos;ve uninstalled the font FedraSans from Windows Font Library.&lt;/p&gt;

&lt;p&gt;PDFDebugger shows me the error and substitute it with LiberationSans (screenshot_2_pdfdebugger attachment)&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;mag 10, 2016 12:03:47 AM org.apache.pdfbox.pdmodel.font.PDCIDFontType2 &amp;lt;init&amp;gt;
AVVERTENZA: Could not read embedded TTF for font AAAAAC+FedraSansCondStd-Demi
java.io.IOException: loca is mandatory
        at org.apache.fontbox.ttf.TTFParser.parseTables(TTFParser.java:206)
        at org.apache.fontbox.ttf.TTFParser.parse(TTFParser.java:150)
        at org.apache.fontbox.ttf.TTFParser.parse(TTFParser.java:106)
        at org.apache.pdfbox.pdmodel.font.PDCIDFontType2.&amp;lt;init&amp;gt;(PDCIDFontType2.j
ava:111)
        at org.apache.pdfbox.pdmodel.font.PDCIDFontType2.&amp;lt;init&amp;gt;(PDCIDFontType2.j
ava:70)
        at org.apache.pdfbox.pdmodel.font.PDFontFactory.createDescendantFont(PDF
ontFactory.java:125)
        at org.apache.pdfbox.pdmodel.font.PDType0Font.&amp;lt;init&amp;gt;(PDType0Font.java:12
8)
        at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory
.java:83)
        at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:123)
        at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(
SetFontAndSize.java:60)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFSt
reamEngine.java:815)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperator
s(PDFStreamEngine.java:472)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStre
amEngine.java:446)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStream
Engine.java:149)
        at org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:189)
        at org.apache.pdfbox.rendering.PDFRenderer.renderPage(PDFRenderer.java:2
08)
        at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:
139)
        at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:
68)
        at org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackgro
und(PagePane.java:156)
        at org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackgro
und(PagePane.java:139)
        at javax.swing.SwingWorker$1.call(Unknown Source)
        at java.util.concurrent.FutureTask.run(Unknown Source)
        at javax.swing.SwingWorker.run(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)

mag 10, 2016 12:03:47 AM org.apache.pdfbox.pdmodel.font.FileSystemFontProvider g
etOTFFont
GRAVE: Could not load font file: C:\Windows\FONTS\FedraSansCondStd-Demi.otf
java.io.FileNotFoundException: C:\Windows\FONTS\FedraSansCondStd-Demi.otf (Impos
sibile trovare il file specificato)
        at java.io.RandomAccessFile.open0(Native Method)
        at java.io.RandomAccessFile.open(Unknown Source)
        at java.io.RandomAccessFile.&amp;lt;init&amp;gt;(Unknown Source)
        at org.apache.fontbox.ttf.BufferedRandomAccessFile.&amp;lt;init&amp;gt;(BufferedRandom
AccessFile.java:88)
        at org.apache.fontbox.ttf.RAFDataStream.&amp;lt;init&amp;gt;(RAFDataStream.java:63)
        at org.apache.fontbox.ttf.TTFParser.parse(TTFParser.java:84)
        at org.apache.fontbox.ttf.OTFParser.parse(OTFParser.java:67)
        at org.apache.pdfbox.pdmodel.font.FileSystemFontProvider.getOTFFont(File
SystemFontProvider.java:696)
        at org.apache.pdfbox.pdmodel.font.FileSystemFontProvider.access$300(File
SystemFontProvider.java:55)
        at org.apache.pdfbox.pdmodel.font.FileSystemFontProvider$FSFontInfo.getF
ont(FileSystemFontProvider.java:127)
        at org.apache.pdfbox.pdmodel.font.FontMapperImpl.findFont(FontMapperImpl
.java:420)
        at org.apache.pdfbox.pdmodel.font.FontMapperImpl.getCIDFont(FontMapperIm
pl.java:483)
        at org.apache.pdfbox.pdmodel.font.PDCIDFontType2.&amp;lt;init&amp;gt;(PDCIDFontType2.j
ava:164)
        at org.apache.pdfbox.pdmodel.font.PDCIDFontType2.&amp;lt;init&amp;gt;(PDCIDFontType2.j
ava:70)
        at org.apache.pdfbox.pdmodel.font.PDFontFactory.createDescendantFont(PDF
ontFactory.java:125)
        at org.apache.pdfbox.pdmodel.font.PDType0Font.&amp;lt;init&amp;gt;(PDType0Font.java:12
8)
        at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory
.java:83)
        at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:123)
        at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(
SetFontAndSize.java:60)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFSt
reamEngine.java:815)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperator
s(PDFStreamEngine.java:472)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStre
amEngine.java:446)
        at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStream
Engine.java:149)
        at org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:189)
        at org.apache.pdfbox.rendering.PDFRenderer.renderPage(PDFRenderer.java:2
08)
        at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:
139)
        at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:
68)
        at org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackgro
und(PagePane.java:156)
        at org.apache.pdfbox.debugger.pagepane.PagePane$RenderWorker.doInBackgro
und(PagePane.java:139)
        at javax.swing.SwingWorker$1.call(Unknown Source)
        at java.util.concurrent.FutureTask.run(Unknown Source)
        at javax.swing.SwingWorker.run(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)

mag 10, 2016 12:03:47 AM org.apache.pdfbox.pdmodel.font.PDCIDFontType2 &amp;lt;init&amp;gt;
AVVERTENZA: Using fallback font LiberationSans for CID-keyed TrueType font AAAAA
C+FedraSansCondStd-Demi

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Chrome instead opened it normally with embedded FedraSans (screenshot_3_chrome attachment)&lt;br/&gt;
Also Acrobat opened it with embedded FedraSans (screenshot_4_acrobat attachment)&lt;/p&gt;</comment>
                            <comment id="15277219" author="tilman" created="Mon, 9 May 2016 22:41:11 +0000"  >&lt;p&gt;According to windows, this file (fontfile2.ttf, from &lt;tt&gt;Root/Pages/Kids/[0]/Resources/Font/F2/DescendantFonts/[0]/FontDescriptor/FontFile2&lt;/tt&gt;) is an opentype font with postscript layout (i.e. not truetype). A look in the hex viewer shows &quot;CFF&quot;.&lt;/p&gt;

&lt;p&gt;However per the PDF spec, /Fontfile2 is to be used like this: &quot;TrueType font program, as described in the TrueType Reference Manual. This entry may appear in the font descriptor for a TrueType font dictionary or (PDF 1.3) for a CIDFontType2CIDFont dictionary.&quot;&lt;/p&gt;</comment>
                            <comment id="15277298" author="tilman" created="Mon, 9 May 2016 23:20:10 +0000"  >&lt;p&gt;I just tried a &quot;desperate late night attempt&quot;, to assign /Fontfile2 to /FontFile3 in PDCIDFontType2&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ff2Stream != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; ff3Stream == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
            {
                InputStream is = ff2Stream.createInputStream();
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (is.read() == &lt;span class=&quot;code-quote&quot;&gt;&apos;O&apos;&lt;/span&gt; &amp;amp;&amp;amp; is.read() == &lt;span class=&quot;code-quote&quot;&gt;&apos;T&apos;&lt;/span&gt; &amp;amp;&amp;amp; is.read() == &lt;span class=&quot;code-quote&quot;&gt;&apos;T&apos;&lt;/span&gt; &amp;amp;&amp;amp; is.read() == &lt;span class=&quot;code-quote&quot;&gt;&apos;O&apos;&lt;/span&gt;)
                {
                    LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;/FontFile2 contains openType font, treating as /FontFile3&quot;&lt;/span&gt;);
                    ff3Stream = ff2Stream;
                    ff2Stream = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
                }
                is.close();                
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but this didn&apos;t help either, because the otf parser is really just a ttf parser, and brings the same &apos;loca&apos; error.&lt;/p&gt;</comment>
                            <comment id="15277305" author="373mich" created="Mon, 9 May 2016 23:24:02 +0000"  >&lt;p&gt;I&apos;ve noticed that TTF encoding is Identity-H. I think that fontbox does not support this format at all.&lt;/p&gt;

&lt;p&gt;Many many thanks to you for your support.&lt;/p&gt;

&lt;p&gt;Tomorrow I will try to convert the font to output as TrueType Ansi encoded from TCPDF.&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;

&lt;p&gt;Michele&lt;/p&gt;</comment>
                            <comment id="15277811" author="373mich" created="Tue, 10 May 2016 08:43:47 +0000"  >&lt;p&gt;Ok,&lt;br/&gt;
as I expected, converted font to TrueType Ansi worked like a charm, with no errors on PDFDebugger.&lt;br/&gt;
Results in screenshot_5_ansi attached.&lt;br/&gt;
So definitively pdfbox does not handle Identity-H encoding.&lt;/p&gt;

&lt;p&gt;I would thank you a lot for your support.&lt;/p&gt;

&lt;p&gt;Michele&lt;/p&gt;</comment>
                            <comment id="15277845" author="tilman" created="Tue, 10 May 2016 09:15:58 +0000"  >&lt;p&gt;We do support Identity-H, look in the source code. What we know at this time is this:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;your font has a /FontFile2 entry&lt;/li&gt;
	&lt;li&gt;that entry expects a TT font&lt;/li&gt;
	&lt;li&gt;the font is not a TT font, but an OTF font with CFF embedded&lt;/li&gt;
	&lt;li&gt;so fontbox tries to use a replacement from the OS&lt;/li&gt;
	&lt;li&gt;on my computer, it uses Liberation Sans&lt;/li&gt;
	&lt;li&gt;on your computer, it uses FedraSans OTF but something goes wrong&lt;/li&gt;
	&lt;li&gt;what you did this morning, is that you used a TT font, i.e. did what the specification expects, and of course, it works &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I just tried two trial versions of commercial java products that I don&apos;t want to name fully&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ic*PDF doesn&apos;t display any glyphs (but my trial version is a year old)&lt;/li&gt;
	&lt;li&gt;JP*dal brings an error message, and then shows a replacement font that has bad sizes.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Btw your choice of font is a weird one for a mailing - the numbers have different sizes.&lt;/p&gt;</comment>
                            <comment id="15277894" author="lehmi" created="Tue, 10 May 2016 10:07:35 +0000"  >&lt;p&gt;I&apos;ve reviewed the FontMapperImpl class and come up with two possible changes:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;replace the instanceof with a not null clause (would make the intention clearer)&lt;/li&gt;
	&lt;li&gt;how about changing the order of the font search? As our otf support is still limited we might search for ttf as second try: type1 -&amp;gt; ttf -&amp;gt; otf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15277903" author="jira-bot" created="Tue, 10 May 2016 10:16:28 +0000"  >&lt;p&gt;Commit 1743147 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1743147&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1743147&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3344&quot; title=&quot;Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont can not be cast to org.apache.fontbox.cff.CFFFont&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3344&quot;&gt;&lt;del&gt;PDFBOX-3344&lt;/del&gt;&lt;/a&gt;: replace the instanceof with a not null clause, optimize sort order, as suggested by Andreas Lehmk&#252;hler&lt;/p&gt;</comment>
                            <comment id="15277904" author="jira-bot" created="Tue, 10 May 2016 10:16:50 +0000"  >&lt;p&gt;Commit 1743148 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1743148&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1743148&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3344&quot; title=&quot;Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont can not be cast to org.apache.fontbox.cff.CFFFont&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3344&quot;&gt;&lt;del&gt;PDFBOX-3344&lt;/del&gt;&lt;/a&gt;: replace the instanceof with a not null clause, optimize sort order, as suggested by Andreas Lehmk&#252;hler&lt;/p&gt;</comment>
                            <comment id="15278726" author="jahewson" created="Tue, 10 May 2016 19:36:03 +0000"  >&lt;p&gt;This will fix the exception, but the code which calls this method isn&apos;t equipped to handle an OpenTypeFont, so problems will persist.&lt;/p&gt;</comment>
                            <comment id="15278727" author="jahewson" created="Tue, 10 May 2016 19:36:16 +0000"  >&lt;p&gt;Looks good.&lt;/p&gt;</comment>
                            <comment id="15278728" author="jahewson" created="Tue, 10 May 2016 19:36:32 +0000"  >&lt;p&gt;Hmm. This isn&apos;t really solving the problem, is it?&lt;/p&gt;</comment>
                            <comment id="15278732" author="tilman" created="Tue, 10 May 2016 19:38:32 +0000"  >&lt;p&gt;That one was just an optimization + code cleanup. The second problem (OTF font in /FontFile2) is still there.&lt;/p&gt;</comment>
                            <comment id="15278830" author="jahewson" created="Tue, 10 May 2016 20:33:21 +0000"  >&lt;p&gt;As Tilman noted, the problem with the etichette.pdf file is that it contains a CIDFontType2 with a FontFile2 which contains an OTF instead of a TTF. We&apos;ve seen these kinds of mix-ups before, and Acrobat tends to resolve them.&lt;/p&gt;

&lt;p&gt;OpenType fonts are special, because OTFs technically come in two flavours, PostScript and TrueType. The PostScript flavour begins with the ASCII sequence OTTO and is generally referred to as an &quot;OTF&quot; and given the extension .otf, while the TrueType flavour begins with a fixed-point version number and is given the extension .ttf. In PDFBox the OpenTypeFont class reflects this dual purpose, behaving as both a TrueTypeFont, and providing the ability to access the embedded CFF. If you try to parse TTF outlines from a CFF-flavoured font, you&apos;re going to get errors about the local and glyf tables being missing, likewise if you try to extract the CFF table form a TTF-flavored font.&lt;/p&gt;

&lt;p&gt;Most of PDFBox was built around CFFFont and TrueTypeFont, with OpenTypeFont being added more recently to accommodate exactly this kind of &quot;wrong FontFile&quot; problem, where we have to second-guess the PDF file. Note that it&apos;s sometimes necessary to treat fonts as both - to using the cmap table for encoding, but the CFF for rendering glyphs.&lt;/p&gt;</comment>
                            <comment id="15278836" author="jira-bot" created="Tue, 10 May 2016 20:35:34 +0000"  >&lt;p&gt;Commit 1743256 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1743256&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1743256&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3344&quot; title=&quot;Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont can not be cast to org.apache.fontbox.cff.CFFFont&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3344&quot;&gt;&lt;del&gt;PDFBOX-3344&lt;/del&gt;&lt;/a&gt;: Handle the case where CFF/OTF fonts are embedded where TTF is expected&lt;/p&gt;</comment>
                            <comment id="15278843" author="jahewson" created="Tue, 10 May 2016 20:38:10 +0000"  >&lt;p&gt;I&apos;ve prevented the OTFParser from complaining about missing &apos;loca&apos; tables when it&apos;s dealing with a CFF flavoured OTF and allowed both FontFile2 and FontFile3 to accept OTF. Then I fixed a small encoding issue in some untested fallback code in getPath(). Now it works.&lt;/p&gt;</comment>
                            <comment id="15278890" author="tilman" created="Tue, 10 May 2016 21:04:49 +0000"  >&lt;p&gt;Rendering of &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2526&quot; title=&quot;Arial black not black&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2526&quot;&gt;&lt;del&gt;PDFBOX-2526&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3267&quot; title=&quot;Using threads results in different images&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3267&quot;&gt;&lt;del&gt;PDFBOX-3267&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1436&quot; title=&quot;Embedded font can&amp;#39;t be read&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1436&quot;&gt;&lt;del&gt;PDFBOX-1436&lt;/del&gt;&lt;/a&gt; fail with &quot;OTF fonts do not have a glyf table&quot;.&lt;/p&gt;

&lt;p&gt;TextStripper test fails with the file pdfbox/src/test/resources/input/sample_fonts_solidconvertor.pdf&lt;/p&gt;</comment>
                            <comment id="15279494" author="jahewson" created="Wed, 11 May 2016 04:08:47 +0000"  >&lt;p&gt;Ah, yes. Looks like the problem is with detecting the OTTO header for OTFs. Should be easy to fix.&lt;/p&gt;</comment>
                            <comment id="15279503" author="jira-bot" created="Wed, 11 May 2016 04:14:22 +0000"  >&lt;p&gt;Commit 1743296 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1743296&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1743296&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3344&quot; title=&quot;Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont can not be cast to org.apache.fontbox.cff.CFFFont&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3344&quot;&gt;&lt;del&gt;PDFBOX-3344&lt;/del&gt;&lt;/a&gt;: Correct detection of OTF fonts via OTTO header&lt;/p&gt;</comment>
                            <comment id="15279724" author="tilman" created="Wed, 11 May 2016 07:42:01 +0000"  >&lt;p&gt;Thanks, all OK now.&lt;/p&gt;</comment>
                            <comment id="15345199" author="mhilpert" created="Wed, 22 Jun 2016 21:26:55 +0000"  >&lt;p&gt;We also have this &quot;loca is mandatory&quot; error with an *.otf font. So is this commit 1743296 fixing the issue? And when will the next PDFBox rlease be available so that we can use OpenType fonts?&lt;/p&gt;</comment>
                            <comment id="15345876" author="tilman" created="Thu, 23 Jun 2016 06:25:54 +0000"  >&lt;p&gt;All I see is that it was forgotten to make the last 2 commits to the 2.x version. So the just released version won&apos;t solve all.&lt;/p&gt;</comment>
                            <comment id="15353662" author="jira-bot" created="Tue, 28 Jun 2016 20:29:58 +0000"  >&lt;p&gt;Commit 1750580 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1750580&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1750580&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3344&quot; title=&quot;Caused by: java.lang.ClassCastException: org.apache.fontbox.ttf.OpenTypeFont can not be cast to org.apache.fontbox.cff.CFFFont&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3344&quot;&gt;&lt;del&gt;PDFBOX-3344&lt;/del&gt;&lt;/a&gt;: Handle the case where CFF/OTF fonts are embedded where TTF is expected + correct detection of OTF fonts via OTTO header, as done by John Hewson in the trunk&lt;/p&gt;</comment>
                            <comment id="15353681" author="tilman" created="Tue, 28 Jun 2016 20:45:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mhilpert&quot; class=&quot;user-hover&quot; rel=&quot;mhilpert&quot;&gt;mhilpert&lt;/a&gt; a snapshot for 2.0.3 should be available within a few hours.&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.3-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.3-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15410931" author="tilman" created="Sun, 7 Aug 2016 12:11:15 +0000"  >&lt;p&gt;Setting to resolved, this one was fixed weeks ago.&lt;/p&gt;</comment>
                            <comment id="15514278" author="eruiz0" created="Thu, 22 Sep 2016 19:36:14 +0000"  >&lt;p&gt;I&apos;m a newbie with font types and I have the same issue with a PDCIDFontType0 (this bug fix is for PDCIDFontType2). Should I open a new issue?. I have locally changed the code for PDCIDFontType0 and now it seems to be working (I&apos;m not really sure if this is a PDFBox issue or a problem with my pdf/fonts).&lt;/p&gt;</comment>
                            <comment id="15514285" author="tilman" created="Thu, 22 Sep 2016 19:40:20 +0000"  >&lt;p&gt;Make sure you&apos;re using the latest version (2.0.3). If it still happens, please open a new issue, attach your file and a minimal code segment, unless it can be reproduced with PDFDebugger. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12802977" name=".pdfbox.cache" size="85113" author="373mich" created="Mon, 9 May 2016 12:28:42 +0000"/>
                            <attachment id="12802952" name="etichette.pdf" size="109102" author="373mich" created="Mon, 9 May 2016 09:38:46 +0000"/>
                            <attachment id="12803106" name="fontfile2.ttf" size="169124" author="tilman" created="Mon, 9 May 2016 22:41:11 +0000"/>
                            <attachment id="12802975" name="helvetica.pdf" size="827" author="tilman" created="Mon, 9 May 2016 12:11:54 +0000"/>
                            <attachment id="12803073" name="screenshot_1.png" size="195507" author="373mich" created="Mon, 9 May 2016 19:56:23 +0000"/>
                            <attachment id="12803098" name="screenshot_2_pdfdebugger.png" size="162377" author="373mich" created="Mon, 9 May 2016 22:14:27 +0000"/>
                            <attachment id="12803099" name="screenshot_3_chrome.png" size="164893" author="373mich" created="Mon, 9 May 2016 22:14:27 +0000"/>
                            <attachment id="12803100" name="screenshot_4_acrobat.png" size="254371" author="373mich" created="Mon, 9 May 2016 22:14:27 +0000"/>
                            <attachment id="12803194" name="screenshot_5_ansi.png" size="191470" author="373mich" created="Tue, 10 May 2016 08:44:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 8 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2xc2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>