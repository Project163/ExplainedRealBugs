<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:48:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1749] Out of memory exception when parsing TTF file</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1749</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When parsing the attached TTF file with fontbox, I get an OutOfMemoryError (heap space) when parsing via an input stream. If I parse via a File, fontbox seems to never return.&lt;/p&gt;</description>
                <environment>ubuntu&lt;br/&gt;
java version &amp;quot;1.7.0_40&amp;quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.7.0_40-b43)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 24.0-b56, mixed mode)&lt;br/&gt;
&lt;br/&gt;
</environment>
        <key id="12673793">PDFBOX-1749</key>
            <summary>Out of memory exception when parsing TTF file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="egh">Erik Hetzner</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 Oct 2013 23:49:21 +0000</created>
                <updated>Sat, 30 Nov 2013 17:02:17 +0000</updated>
                            <resolved>Sat, 26 Oct 2013 09:32:21 +0000</resolved>
                                    <version>1.8.2</version>
                                    <fixVersion>1.8.3</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>FontBox</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13794664" author="egh" created="Mon, 14 Oct 2013 23:58:20 +0000"  >&lt;p&gt;For compiling testcase:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ javac -classpath fontbox-1.8.3-20130916.151050-5.jar PDFBOX_1749.java 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Running using FileInputStream:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ java -Xmx8000m -cp fontbox-1.8.3-20130916.151050-5.jar:. PDFBOX_1749 16A4FF_8.ttf X
Using FileInputStream
error: array index out of bounds
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.OutOfMemoryError: Java heap space
	at java.util.ArrayList.newElementArray(ArrayList.java:94)
	at java.util.ArrayList.growAtEnd(ArrayList.java:375)
	at java.util.ArrayList.add(ArrayList.java:158)
	at org.apache.fontbox.ttf.GlyfCompositeDescript.&amp;lt;init&amp;gt;(GlyfCompositeDescript.java:60)
	at org.apache.fontbox.ttf.GlyphData.initData(GlyphData.java:63)
	at org.apache.fontbox.ttf.GlyphTable.initData(GlyphTable.java:71)
	at org.apache.fontbox.ttf.AbstractTTFParser.parseTables(AbstractTTFParser.java:163)
	at org.apache.fontbox.ttf.TTFParser.parseTables(TTFParser.java:61)
	at org.apache.fontbox.ttf.AbstractTTFParser.parseTTF(AbstractTTFParser.java:90)
	at org.apache.fontbox.ttf.AbstractTTFParser.parseTTF(AbstractTTFParser.java:66)
	at PDFBOX_1749.main(PDFBOX_1749.java:13)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Running as File:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ java -Xmx8000m -cp fontbox-1.8.3-20130916.151050-5.jar:. PDFBOX_1749 16A4FF_8.ttf
Using File
[...]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13795075" author="tilman" created="Tue, 15 Oct 2013 11:04:42 +0000"  >&lt;p&gt;Your font is broken. Even sun can&apos;t open it with createFont(). It brings an exception:&lt;br/&gt;
java.awt.FontFormatException: bad table, tag=1195656518&lt;/p&gt;

&lt;p&gt;I only had an endless loop in 2.0, the cause is that GlyfSimpleDescript.readFlags() does not handle the case that bais.read() returns -1.&lt;/p&gt;</comment>
                            <comment id="13795226" author="egh" created="Tue, 15 Oct 2013 14:19:32 +0000"  >&lt;p&gt;Hi Tilman,&lt;/p&gt;

&lt;p&gt;Yes, I know. I work in web archiving; this is a font that has been downloaded from the web, and as part of our full text indexing process we pass everything to tika. I have filed a bug with the tika project (&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1182&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-1182&lt;/a&gt;), but since the underlying issue was in fontbox I reported it here.&lt;/p&gt;

&lt;p&gt;Is there anything that can be done to avoid an endless loop?&lt;/p&gt;</comment>
                            <comment id="13795232" author="tilman" created="Tue, 15 Oct 2013 14:27:46 +0000"  >&lt;p&gt;About &quot;Is there anything that can be done to avoid an endless loop?&quot;&lt;/p&gt;

&lt;p&gt;1) try to open the font with createFont() first and catch the exception&lt;br/&gt;
or&lt;br/&gt;
2) make a change in &quot;your own&quot; PDFBOX installation at the place mentioned (GlyfSimpleDescript.java), e.g. add this&lt;br/&gt;
if (repeats == -1)&lt;br/&gt;
  throw new IOException(&quot;premature EOF&quot;);&lt;/p&gt;</comment>
                            <comment id="13795398" author="egh" created="Tue, 15 Oct 2013 17:25:14 +0000"  >&lt;p&gt;Thanks, Tilman. I think that trying to open with createFont first is the best solution. I&apos;ll see if that can be incorporated in tika.&lt;/p&gt;</comment>
                            <comment id="13802314" author="gagravarr" created="Tue, 22 Oct 2013 21:46:48 +0000"  >&lt;p&gt;Is there any chance that the EOF check could be added in FontBox? We can add a createFont call in Tika for now, but it doesn&apos;t feel quite right for a long term fix&lt;/p&gt;</comment>
                            <comment id="13806042" author="lehmi" created="Sat, 26 Oct 2013 09:32:21 +0000"  >&lt;p&gt;I&apos;ve fixed the issue in revision 1535953. The parser now detects a premature end of file based on Tilmans comment. I introduced an additional method TTFDataStream#readUnsignedByte to avoid boilerplate code. It throws an exception if it detects a premature EOF.&lt;/p&gt;

&lt;p&gt;Thanks for the report and the proposed fix!&lt;/p&gt;</comment>
                            <comment id="13824878" author="lehmi" created="Sun, 17 Nov 2013 15:30:18 +0000"  >&lt;p&gt;Merged into 1.8-branch in revision 1542748&lt;/p&gt;</comment>
                            <comment id="13835824" author="lehmi" created="Sat, 30 Nov 2013 17:02:17 +0000"  >&lt;p&gt;Closed after releasing 1.8.3&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12608385" name="16A4FF_8.ttf" size="19872" author="egh" created="Mon, 14 Oct 2013 23:50:22 +0000"/>
                            <attachment id="12608386" name="PDFBOX_1749.java" size="643" author="egh" created="Mon, 14 Oct 2013 23:54:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>353416</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 51 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1oxkn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>353708</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>