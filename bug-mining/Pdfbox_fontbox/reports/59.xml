<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:48:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1689] Partial failure to render PDF</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1689</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;The attached file has several issues when rendering:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The long &quot;-&quot; symbol replaced (top right, after &quot;Reiseart: g&#252;ltig f&#252;r alle Reisearten&quot;)&lt;/li&gt;
	&lt;li&gt;The &#8364; (euro) symbol replaced (top right, after &quot;maximaler Reisepreis: &quot;)&lt;/li&gt;
	&lt;li&gt;The square (on win7) or bullet (on XP) symbol is replaced with a sum symbol&lt;/li&gt;
	&lt;li&gt;The whole text is not rendered in the same font than in acrobat reader&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12663031">PDFBOX-1689</key>
            <summary>Partial failure to render PDF</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="tilman">Tilman Hausherr</reporter>
                        <labels>
                    </labels>
                <created>Sat, 10 Aug 2013 10:10:10 +0000</created>
                <updated>Sun, 22 Jun 2014 14:34:49 +0000</updated>
                            <resolved>Tue, 27 May 2014 19:15:18 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>1.8.6</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13745802" author="lehmi" created="Wed, 21 Aug 2013 05:48:27 +0000"  >&lt;p&gt;I found a solution for the encoding issue, but it will take some time as I have to rearrange some of the code. PDFBox uses the embedded font but and it looks odd. Evince seems to use the embedded fonts too, but it looks like adobe replaces all fonts.&lt;/p&gt;</comment>
                            <comment id="13745847" author="tilman" created="Wed, 21 Aug 2013 07:36:41 +0000"  >&lt;p&gt;Is the font embedded at all? I changed the JIRA title yesterday and removed the word &quot;embedded&quot; after looking again at the properties in the Acrobat Reader (does not have the word &quot;embedded&quot; in the font segment) and at the PDF binary (does not have Fontfile1, Fontfile2 or Fontfile3).&lt;/p&gt;

&lt;p&gt;To me it seems that PDFBOX does not use the mentioned font (Arial Narrow) but another sans serif font.&lt;/p&gt;</comment>
                            <comment id="13745854" author="lehmi" created="Wed, 21 Aug 2013 07:55:09 +0000"  >&lt;p&gt;Ups, you&apos;re right, there is no embedded font. Maybe it was already to late yesterday when I had a look at the pdf. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13779789" author="tilman" created="Fri, 27 Sep 2013 09:28:52 +0000"  >&lt;p&gt;I&apos;ve had a long look at why the Elvia file (which uses TT fonts but doesn&apos;t have them embedded) isn&apos;t rendered correctly. The problem is that OS built-in TT fonts aren&apos;t used in PDTrueTypeFont.java. This is likely because the location of the OS TT files are OS dependent. PDTrueTypeFont.getExternalFontFile2() only takes the three fonts that are in the file PDFBox_External_Fonts.properties and in the location org/apache/pdfbox/resources/ttf. Any font that isn&apos;t found, including Symbol &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/warning.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, is mapped to ArialMT.&lt;/p&gt;

&lt;p&gt;So one solution that works is to tell getExternalFontFile2() where to find my fonts. Adding three lines to PDFBox_External_Fonts.properties&lt;br/&gt;
ArialNarrow=C:/Windows/Fonts/ARIALN.TTF&lt;br/&gt;
ArialNarrow,Bold=C:/Windows/Fonts/ARIALNB.TTF&lt;br/&gt;
Symbol=C:/Windows/Fonts/SYMBOL.TTF&lt;br/&gt;
brought a nicely rendered image. It also improved other files I use for testing, e.g. the cloud.pdf file.&lt;/p&gt;

&lt;p&gt;Alternatively, I tried forcing rendering with awt by altering getExternalFontFile2() so that it returns null when it didn&apos;t find a TT font. This didn&apos;t work properly for the symbol font.&lt;/p&gt;

&lt;p&gt;So a workable solution would be either to include more TT fonts (license????), or to find out the location the of OS TT files. This is tricky, it involves undocumented functions, it is OS and JDK dependent, and it also requires some mapping of the font names, similar to what is done in FontManager.java. It might fail in secure environments. The method is explained here:&lt;br/&gt;
&lt;a href=&quot;http://stackoverflow.com/questions/2019249/get-font-file-as-a-file-object-or-get-its-path&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/2019249/get-font-file-as-a-file-object-or-get-its-path&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://stackoverflow.com/questions/13684342/jdk7-sun-font-fontmanager-replacement-how-to-get-filename-information-from-font&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/13684342/jdk7-sun-font-fontmanager-replacement-how-to-get-filename-information-from-font&lt;/a&gt;&lt;br/&gt;
Alternatively, one might think about creating a tool that makes a setup, i.e. fills the file PDFBox_External_Fonts.properties&lt;/p&gt;

&lt;p&gt;Or one might include TT fonts that have a &quot;compatible&quot; license.&lt;/p&gt;


&lt;p&gt;What do you think? What should be done? &lt;/p&gt;


&lt;p&gt;I could try to create such a tool. The following code gives the location of a font on JDK7, don&apos;t know if it works on JDK6:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; FontManager fontManager = FontManagerFactory.getInstance();
    
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getFontPath(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fontName, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; fontStyle)
    {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;
        {
            Font2D f2d = fontManager.findFont2D(fontName, fontStyle, FontManager.LOGICAL_FALLBACK).handle.font2D;
            Field platName = PhysicalFont.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;getDeclaredField(&lt;span class=&quot;code-quote&quot;&gt;&quot;platName&quot;&lt;/span&gt;);
            platName.setAccessible(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fontPath = (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) platName.get(f2d);
            platName.setAccessible(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; fontPath;
        }
        &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception ex)
        {
            &lt;span class=&quot;code-comment&quot;&gt;//ex.printStackTrace();
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &quot;&quot;;
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I also suggest to add this to getExternalFontFile2():&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((baseFont != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &amp;amp;&amp;amp; (externalFonts.containsKey(baseFont)))
        {
            fontResource = externalFonts.getProperty(baseFont);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
        {
            LOG.warn (&lt;span class=&quot;code-quote&quot;&gt;&quot;TTF font not found: &quot;&lt;/span&gt; + baseFont + &lt;span class=&quot;code-quote&quot;&gt;&quot;, &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; will be used&quot;&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;//TH &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; line &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;
&lt;/span&gt;        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;so that people know when something isn&apos;t perfect.&lt;/p&gt;</comment>
                            <comment id="13779798" author="tilman" created="Fri, 27 Sep 2013 09:48:09 +0000"  >&lt;p&gt;Rendered by adding three lines to PDFBox_External_Fonts.properties indicating where to find TT fonts&lt;/p&gt;</comment>
                            <comment id="13779810" author="lehmi" created="Fri, 27 Sep 2013 10:46:04 +0000"  >&lt;p&gt;I&apos;m already thinking about bundling a set of fonts to be able to replace problematic/missing fonts. This would also include &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1701&quot; title=&quot;Better font than the standard font&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1701&quot;&gt;&lt;del&gt;PDFBOX-1701&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The Bitstream &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; or DejaVu-fonts &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; maybe possible candidates, but we have to check the license first (shouldn&apos;t be a problem) and I&apos;m not sure if those packages contain a symbol font.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://en.wikipedia.org/wiki/Bitstream_Vera&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://en.wikipedia.org/wiki/Bitstream_Vera&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://en.wikipedia.org/wiki/DejaVu_fonts&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://en.wikipedia.org/wiki/DejaVu_fonts&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13816461" author="tilman" created="Thu, 7 Nov 2013 21:40:49 +0000"  >&lt;p&gt;After trying to render the file&lt;br/&gt;
&lt;a href=&quot;http://digitalcorpora.org/corp/nps/files/govdocs1/659/659756.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://digitalcorpora.org/corp/nps/files/govdocs1/659/659756.pdf&lt;/a&gt; of &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1774&quot; title=&quot;StackOverflowError; Preflight-&amp;gt;Font&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1774&quot;&gt;&lt;del&gt;PDFBOX-1774&lt;/del&gt;&lt;/a&gt;, I have added this to getExternalFontFile2() after getBaseFont();&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (baseFont.contains(&lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt;))
            baseFont = baseFont.replace(&lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt;, &quot;&quot;);
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (baseFont.endsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;))
            baseFont = baseFont.substring(0,baseFont.length()-1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because they have fonts with spaces and that end with &quot;,&quot;.&lt;/p&gt;</comment>
                            <comment id="14001148" author="lehmi" created="Sun, 18 May 2014 18:15:22 +0000"  >&lt;p&gt;I added some convenience methods to get the following values from the NamingTable in revsision 1595649:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;font- family&lt;/li&gt;
	&lt;li&gt;font-subfamily&lt;/li&gt;
	&lt;li&gt;postscript-name&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14002194" author="lehmi" created="Mon, 19 May 2014 19:12:46 +0000"  >&lt;p&gt;I&apos;ve followed Maruans suggestion and added a font manager to find and deal with local fonts in revision 1595992.&lt;/p&gt;

&lt;p&gt;The code is based on the &lt;a href=&quot;http://svn.apache.org/viewvc/xmlgraphics/fop/trunk/src/java/org/apache/fop/fonts/FontManager.java?view=log&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;FontManager&lt;/a&gt; provide by Apache FOP.  It works for true type fonts in an unix environment.&lt;/p&gt;

&lt;p&gt;TODOs:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;add some mappings for a windows and macos environment&lt;/li&gt;
	&lt;li&gt;add support for other font types like type1&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14003490" author="tilman" created="Tue, 20 May 2014 15:44:33 +0000"  >&lt;p&gt;I like it!&lt;/p&gt;

&lt;p&gt;Result of diff tests:&lt;/p&gt;

&lt;p&gt;The file from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1435&quot; title=&quot;text is obscured by the Images&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1435&quot;&gt;&lt;del&gt;PDFBOX-1435&lt;/del&gt;&lt;/a&gt; isn&apos;t rendered properly, the &quot;2011&quot; is missing.&lt;/p&gt;

&lt;p&gt;I get a few NPEs on windows, related to the failure of doing certain null checks:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;namingTable.getPSName() can be null for some barcode fonts I can&apos;t share&lt;/li&gt;
	&lt;li&gt;fontfinder.getCommonTTFMapping() is null for me (the windows method does return null)&lt;br/&gt;
doing null checks solves the problem with the file from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1435&quot; title=&quot;text is obscured by the Images&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1435&quot;&gt;&lt;del&gt;PDFBOX-1435&lt;/del&gt;&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Several images have some very slight differences in glyph rendering.&lt;/p&gt;

&lt;p&gt;Also weird: some font files have unicodes names, which look like this:&lt;/p&gt;

&lt;p&gt; namingTable.getPSName(): *A*r*i*a*l*-*I*t*a*l*i*c*M*T* (the star is zero)&lt;br/&gt;
and the normalized name is the same in lowercase.&lt;/p&gt;

&lt;p&gt;Solution:&lt;br/&gt;
Adding a check for (platform == 0) in NamingTable.java and assigning charset UTF-16 solves this, see also &lt;br/&gt;
&lt;a href=&quot;https://www.microsoft.com/typography/otspec/name.htm&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.microsoft.com/typography/otspec/name.htm&lt;/a&gt;&lt;br/&gt;
Same for (platform == 3 &amp;amp;&amp;amp; encoding == 0), also assigning charset UTF-16 solves this.&lt;/p&gt;

&lt;p&gt;Re: mappings: you&apos;re using the normalized font name when storing what you found, but not when searching for a font name. Because of that, I get &quot;Font not found: TimesNewRomanPSMT&quot; although the font is there as &quot;timesnewromanpsmt&quot;.&lt;/p&gt;

&lt;p&gt;More mappings are needed on Windows. Here are mine:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;arial&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;arialmt&quot;&lt;/span&gt;, fontMappingTTF);
  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;arialbold&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;arialmtbold&quot;&lt;/span&gt;, fontMappingTTF);
  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;arialitalic&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;arialmtitalic&quot;&lt;/span&gt;, fontMappingTTF);
  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;arialbolditalic&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;arialmtbolditalic&quot;&lt;/span&gt;, fontMappingTTF);

  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;timesnewroman&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;timesnewromanpsmt&quot;&lt;/span&gt;, fontMappingTTF);
  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;timesnewromanbold&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;timesnewromanpsmtbold&quot;&lt;/span&gt;, fontMappingTTF);
  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;timesnewromanbolditalic&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;timesnewromanpsmtbolditalic&quot;&lt;/span&gt;, fontMappingTTF);
  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;timesnewromanitalic&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;timesnewromanpsmtitalic&quot;&lt;/span&gt;, fontMappingTTF);
  
  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;couriernew&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;couriernewpsmt&quot;&lt;/span&gt;, fontMappingTTF);
  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;couriernewbold&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;couriernewpsmtbold&quot;&lt;/span&gt;, fontMappingTTF);
  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;couriernewitalic&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;couriernewpsmtitalic&quot;&lt;/span&gt;, fontMappingTTF);
  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;couriernewbolditalic&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;couriernewpsmtbolditalic&quot;&lt;/span&gt;, fontMappingTTF);

  addFontMapping(&lt;span class=&quot;code-quote&quot;&gt;&quot;symbol&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;symbolmt&quot;&lt;/span&gt;, fontMappingTTF);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After activating this, the slight differences in glyph rendering go away. I guess the cause was that they were rendered with awt prior to the added mapping.&lt;/p&gt;</comment>
                            <comment id="14004401" author="lehmi" created="Wed, 21 May 2014 06:01:34 +0000"  >&lt;p&gt;I&apos;ve readded ArialMT.ttf in revision 1596480. It&apos;s now part of the resources within the test path. This should heal the build issue.&lt;/p&gt;</comment>
                            <comment id="14005224" author="tilman" created="Wed, 21 May 2014 20:56:21 +0000"  >&lt;p&gt;One thing that can possibly be optimized: some fonts (e.g. ArialUni) take extremely long to be read. This is because a full parse is done, although only the PSName and the filename is needed. On my non-very-fast system, reading all fonts takes several minutes.&lt;/p&gt;</comment>
                            <comment id="14008171" author="lehmi" created="Sat, 24 May 2014 17:36:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; Thanks for the detailed feedback. I fixed all (I hope) mentioned issues for the windows platform in revision 1597330.&lt;/p&gt;

&lt;p&gt;TODOs&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MacOS platform mappings&lt;/li&gt;
	&lt;li&gt;optimize ttf parsing&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14008185" author="tilman" created="Sat, 24 May 2014 18:38:54 +0000"  >&lt;p&gt;Diff tests are ok, thanks!&lt;/p&gt;</comment>
                            <comment id="14008293" author="tilman" created="Sun, 25 May 2014 07:45:37 +0000"  >&lt;p&gt;On my computer, I replaced analyzeTTF with this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void analyzeTTF(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; ttfFilename) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
    {
        LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;analyzeTTF: &quot;&lt;/span&gt; + ttfFilename);
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;
        {
            Font font = Font.createFont(Font.TRUETYPE_FONT, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(ttfFilename));
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fontPSName = font.getPSName();
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fontName = font.getFontName(Locale.US);
            LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;getPSName: &quot;&lt;/span&gt; + font.getPSName());
            LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;getFontName: &quot;&lt;/span&gt; + font.getFontName(Locale.US));
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fontPSName != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !fontPSName.isEmpty())
            {
                ttfFontfiles.put(normalizeFontname(fontPSName), ttfFilename);
            }
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fontName != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !fontName.isEmpty())
            {
                ttfFontfiles.put(normalizeFontname(font.getFontName(Locale.US)), ttfFilename);
            }
        }
        &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (FontFormatException ex)
        {
            LOG.debug (&lt;span class=&quot;code-quote&quot;&gt;&quot;FontFormatException: &quot;&lt;/span&gt; + ex.getMessage());
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It uses java font parsing only, because one can assume that the standard fonts will be parsed properly by java. And we need only the name. Instead of 10 minutes, loadFonts() now takes a few seconds. And there&apos;s more:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;font.getFontName(Locale.US)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;returns the font name without &quot;MT&quot; or &quot;PSMT&quot; or whatever, so I was able to remove the mappings I mentioned myself a few days ago from WindowsFontDirFinder (I kept the last one which you introduced, although I don&apos;t have an example to test). &quot;US&quot; is important because without that parameter, I get &quot;fett&quot; instead of &quot;bold&quot; in the font name.&lt;/p&gt;</comment>
                            <comment id="14008316" author="lehmi" created="Sun, 25 May 2014 11:33:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; Good idea, but I don&apos;t want to involve again the JDK to handle fonts. I&apos;m already working on a on demand feature for the TTFParser.&lt;/p&gt;</comment>
                            <comment id="14008342" author="lehmi" created="Sun, 25 May 2014 13:57:01 +0000"  >&lt;p&gt;I&apos;ve added an optional parse on demand feature for the true type font parser in revision 1597425. This increases the parser speed significantly when analyzing the installed fonts&lt;/p&gt;</comment>
                            <comment id="14008367" author="tilman" created="Sun, 25 May 2014 16:03:49 +0000"  >&lt;p&gt;Indeed, it does. Thanks! So the only &quot;todo&quot; left are the MacOS platform mappings.&lt;/p&gt;</comment>
                            <comment id="14009033" author="lehmi" created="Mon, 26 May 2014 19:03:04 +0000"  >&lt;p&gt;I&apos;ve added some slight changes to support MacOS in revisions 1597626, 1597628 and 1597629&lt;/p&gt;

&lt;p&gt;I&apos;m going to check if these changes can be ported to the 1.8 branch.&lt;/p&gt;</comment>
                            <comment id="14010049" author="lehmi" created="Tue, 27 May 2014 18:23:55 +0000"  >&lt;p&gt;I&apos;ve removed the recently added commons-io dependency in revision 1597842 so that I should be able to port the changes to the 1.8 branch&lt;/p&gt;</comment>
                            <comment id="14010152" author="lehmi" created="Tue, 27 May 2014 19:15:18 +0000"  >&lt;p&gt;I&apos;ve added more or less all changes to the 1.8 branch in revisions 1597849 and 1597852. &lt;br/&gt;
IMHO we are done here. We can open a new issue if anything like a missing mapping or a totally unsupported OS comes up.&lt;/p&gt;

&lt;p&gt;Thanks to all for the help!&lt;/p&gt;</comment>
                            <comment id="14014705" author="lehmi" created="Sat, 31 May 2014 16:26:47 +0000"  >&lt;p&gt;I&apos;ve added another common font mapping (ArialMT -&amp;gt; Arial) in revisions 1598885 (trunk) and 1598887 (1.8 branch)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12698502">PDFBOX-1959</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12696348">PDFBOX-1930</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12712561">PDFBOX-2060</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12391096">PDFBOX-62</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12605423" name="ELVIA-Reiserucktritt-Vollschutz-01.png" size="711434" author="tilman" created="Fri, 27 Sep 2013 09:48:09 +0000"/>
                            <attachment id="12597271" name="ELVIA-Reiserucktritt-Vollschutz-01.png" size="291377" author="tilman" created="Sat, 10 Aug 2013 10:11:46 +0000"/>
                            <attachment id="12597272" name="ELVIA-Reiserucktritt-Vollschutz.pdf" size="104450" author="tilman" created="Sat, 10 Aug 2013 10:11:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343032</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 25 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n5p3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343336</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>