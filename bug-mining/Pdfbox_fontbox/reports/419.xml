<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:51:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-5915] false &quot;Unknown charstring command in glyph&quot; messages</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-5915</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;I&apos;m often getting &quot;Unknown charstring command in glyph&quot; messages. I took the time to find whether these are real, and they&apos;re not. They happen because of type2 charstrings that start with 19 or 20. These are passed to &lt;tt&gt;CharStringCommand.getInstance(value)&lt;/tt&gt; where they are classified as UNKNOWN either because the value array is more than 2 or because a 2 byte command doesn&apos;t result in a known value. However 19 and 20 are 1 byte commands (hintmask and cntrmask, which we ignore) so this must be changed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13600486">PDFBOX-5915</key>
            <summary>false &quot;Unknown charstring command in glyph&quot; messages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="tilman">Tilman Hausherr</reporter>
                        <labels>
                    </labels>
                <created>Sun, 1 Dec 2024 10:24:26 +0000</created>
                <updated>Thu, 23 Jan 2025 19:00:07 +0000</updated>
                            <resolved>Sun, 1 Dec 2024 10:30:35 +0000</resolved>
                                    <version>3.0.3 PDFBox</version>
                                    <fixVersion>3.0.4 PDFBox</fixVersion>
                    <fixVersion>4.0.0</fixVersion>
                                    <component>FontBox</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17902088" author="jira-bot" created="Sun, 1 Dec 2024 10:29:31 +0000"  >&lt;p&gt;Commit 1922244 from Tilman Hausherr in branch &apos;pdfbox/branches/3.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922244&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922244&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5915&quot; title=&quot;false &amp;quot;Unknown charstring command in glyph&amp;quot; messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5915&quot;&gt;&lt;del&gt;PDFBOX-5915&lt;/del&gt;&lt;/a&gt;: 19 and 20 are one byte commands&lt;/p&gt;</comment>
                            <comment id="17902089" author="jira-bot" created="Sun, 1 Dec 2024 10:29:52 +0000"  >&lt;p&gt;Commit 1922245 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922245&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922245&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5915&quot; title=&quot;false &amp;quot;Unknown charstring command in glyph&amp;quot; messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5915&quot;&gt;&lt;del&gt;PDFBOX-5915&lt;/del&gt;&lt;/a&gt;: 19 and 20 are one byte commands&lt;/p&gt;</comment>
                            <comment id="17902114" author="lehmi" created="Sun, 1 Dec 2024 16:51:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; It looks like your fix just masks the underlying issue. &lt;/p&gt;

&lt;p&gt;The calculation at the end of &quot;org.apache.fontbox.cff.Type2CharStringParser.readCommand(int, DataInput, GlyphData)&quot; looks suspicious to me&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 19:
        &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 20:
            glyphData.vstemCount += countNumbers(glyphData.sequence) / 2;
            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[] value = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[1 + getMaskLength(glyphData.hstemCount, glyphData.vstemCount)];
            value[0] = b0;

            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 1; i &amp;lt; value.length; i++)
            {
                value[i] = input.readUnsignedByte();
            }

            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; CharStringCommand.getInstance(value);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Why do we read those additional values? Answer to myself: to read the whole sequence&lt;br/&gt;
Why to add them to the command byte sequence?&lt;/p&gt;

&lt;p&gt;UPDATE:&lt;br/&gt;
As long as we don&apos;t support those commands IMHO we can simply drop the value array and return &lt;tt&gt;CharStringCommand.getInstance(b0)&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17902117" author="tilman" created="Sun, 1 Dec 2024 17:36:21 +0000"  >&lt;p&gt;In 2.0 the whole byte array is kept in the charstring object, in &lt;tt&gt;Key.keyValues&lt;/tt&gt;, in 3.0 it is lost. If we ever implement the missing commands, then the data would &quot;almost&quot; be there, only the TODO would have to be implemented to have the mask data. Coincidentally, my first idea was to implement what you mentioned in the last line of your comment. I dropped that because I thought that it would be better to have everything except the part that needs to be implemented, i.e. storing the extra mask data in the charstring object. I didn&apos;t do that because I thought that until somebody implements the actual handling of hintmask and cntrmask, there is no need to have an extra field that takes memory space.&lt;/p&gt;</comment>
                            <comment id="17902118" author="lehmi" created="Sun, 1 Dec 2024 18:27:51 +0000"  >&lt;p&gt;I&apos;ve have another idea in my mind, but I&apos;d like to verify it first. Do have a sample pdf?&lt;/p&gt;</comment>
                            <comment id="17902167" author="lehmi" created="Mon, 2 Dec 2024 05:40:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; I&apos;ve attached an alternative patch. I&apos;ve added another if clause so that the commands in question are handled separately. IMHO the code is more clear. CharStringCommand shouldn&apos;t know anything about commands to be skipped&lt;/p&gt;</comment>
                            <comment id="17902208" author="jira-bot" created="Mon, 2 Dec 2024 09:12:22 +0000"  >&lt;p&gt;Commit 1922253 from Tilman Hausherr in branch &apos;pdfbox/branches/3.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922253&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922253&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5915&quot; title=&quot;false &amp;quot;Unknown charstring command in glyph&amp;quot; messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5915&quot;&gt;&lt;del&gt;PDFBOX-5915&lt;/del&gt;&lt;/a&gt;: hintmask and cntrmask should handled separately, by Andreas Lehmk&#195;&#188;hler&lt;/p&gt;</comment>
                            <comment id="17902209" author="jira-bot" created="Mon, 2 Dec 2024 09:12:26 +0000"  >&lt;p&gt;Commit 1922254 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922254&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922254&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5915&quot; title=&quot;false &amp;quot;Unknown charstring command in glyph&amp;quot; messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5915&quot;&gt;&lt;del&gt;PDFBOX-5915&lt;/del&gt;&lt;/a&gt;: hintmask and cntrmask should handled separately, by Andreas Lehmk&#195;&#188;hler&lt;/p&gt;</comment>
                            <comment id="17902213" author="tilman" created="Mon, 2 Dec 2024 09:25:07 +0000"  >&lt;p&gt;Something went wrong... (rendering difference) it could be my fault, netbeans didn&apos;t accept the patch and I made the changes manually. I had looked at the code but hadn&apos;t done a test before committing. I&apos;ll investigate that...&lt;/p&gt;</comment>
                            <comment id="17902214" author="tilman" created="Mon, 2 Dec 2024 09:37:50 +0000"  >&lt;p&gt;I found it (glyphData.vstemCount line missing in the patch), will do rendering tests first.&lt;/p&gt;</comment>
                            <comment id="17902216" author="jira-bot" created="Mon, 2 Dec 2024 09:44:38 +0000"  >&lt;p&gt;Commit 1922255 from Tilman Hausherr in branch &apos;pdfbox/branches/3.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922255&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922255&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5915&quot; title=&quot;false &amp;quot;Unknown charstring command in glyph&amp;quot; messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5915&quot;&gt;&lt;del&gt;PDFBOX-5915&lt;/del&gt;&lt;/a&gt;: restore line lost in refactoring&lt;/p&gt;</comment>
                            <comment id="17902217" author="jira-bot" created="Mon, 2 Dec 2024 09:44:52 +0000"  >&lt;p&gt;Commit 1922256 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922256&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922256&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5915&quot; title=&quot;false &amp;quot;Unknown charstring command in glyph&amp;quot; messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5915&quot;&gt;&lt;del&gt;PDFBOX-5915&lt;/del&gt;&lt;/a&gt;: restore line lost in refactoring&lt;/p&gt;</comment>
                            <comment id="17902228" author="jira-bot" created="Mon, 2 Dec 2024 10:14:05 +0000"  >&lt;p&gt;Commit 1922257 from Tilman Hausherr in branch &apos;pdfbox/branches/3.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922257&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922257&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5915&quot; title=&quot;false &amp;quot;Unknown charstring command in glyph&amp;quot; messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5915&quot;&gt;&lt;del&gt;PDFBOX-5915&lt;/del&gt;&lt;/a&gt;: use hashValue&lt;/p&gt;</comment>
                            <comment id="17902243" author="tilman" created="Mon, 2 Dec 2024 11:12:52 +0000"  >&lt;p&gt;Yes, it is indeed more clear, thanks.&lt;/p&gt;</comment>
                            <comment id="17902439" author="lehmi" created="Mon, 2 Dec 2024 21:02:06 +0000"  >&lt;p&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; thanks for replacing your changes with mine and sorry for the missing line. It got lost when rearranging the code pieces.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13568143">PDFBOX-5766</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13073136" name="PDFBOX-5915_patch.txt" size="3320" author="lehmi" created="Mon, 2 Dec 2024 05:36:16 +0000"/>
                            <attachment id="13073134" name="bugzilla867751.pdf" size="7259642" author="tilman" created="Sun, 1 Dec 2024 18:39:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            48 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1suko:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>