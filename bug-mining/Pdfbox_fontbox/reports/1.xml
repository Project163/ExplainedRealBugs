<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:48:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-624] Misplaced text</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-624</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Thomas Fischer reported to users@pdfbox.apache.org that org.apache.pdfbox.ExtractText interchanges typographic ligatures &quot;fi&quot; and &quot;fl&quot;. The sample document &quot;documenta_math.pdf&quot; was created using TeX and AFPL Ghostscript 6.50.&lt;/p&gt;

&lt;p&gt;I used PDFBox 1.0.1-SNAPSHOT to verify this problem. The &quot;fi&quot; ligature behaves correctly (ie. text extraction yields &quot;finite&quot; and &quot;infinite&quot;, not &quot;flnite&quot; and &quot;inflnite&quot;), but the overall text layout is a complete mess. Please see the PDF text extraction result &quot;documenta_math.txt&quot; and PDF rendering result &quot;documenta_math_page4.png&quot;.&lt;/p&gt;

&lt;p&gt;The cause of the horizontal text misplacement is not yet known. This could affect all PDF documents which have been created using TeX.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12456468">PDFBOX-624</key>
            <summary>Misplaced text</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vfed">Villu Ruusmann</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Feb 2010 19:25:16 +0000</created>
                <updated>Tue, 30 Mar 2010 08:23:21 +0000</updated>
                            <resolved>Fri, 19 Mar 2010 17:45:28 +0000</resolved>
                                    <version>1.0.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>FontBox</component>
                    <component>Text extraction</component>
                    <component>Utilities</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12836416" author="vfed" created="Sun, 21 Feb 2010 18:25:34 +0000"  >&lt;p&gt;This is a Type1C font issue. Namely, TeX has generated font programs which encode the &quot;width&quot; operand of &quot;hsbw&quot; and &quot;sbw&quot; operations as a 5-byte number (the value is typically in range from 300 to 1000, and other software packages encode it as a 2- or 3-byte number). To make things even more complicated, TeX has stored the value in the highest 2 bytes (ie. bitmask 0xffff0000), not in the lowest 2 bytes (ie. bitmask 0x0000ffff).&lt;/p&gt;

&lt;p&gt;I have prepared a small patch that makes TeX generated PDF documents usable. However, this is a hack and may cause problems elsewhere (my own text extraction tests pass successfully).&lt;/p&gt;</comment>
                            <comment id="12845202" author="lehmi" created="Mon, 15 Mar 2010 06:45:51 +0000"  >&lt;p&gt;Sounds curious. An int of 4 bytes will be read and be casted to a short value. Whether your are using the lowest or the highest bytes, the half of the value is lost at all times. Is there any specification for that font type available?&lt;/p&gt;</comment>
                            <comment id="12845235" author="vfed" created="Mon, 15 Mar 2010 08:39:43 +0000"  >&lt;p&gt;It&apos;s in the &quot;The Type 2 Charstring Format&quot; specification (Technical Note #5177), which can be retrieved from the Adobe site:&lt;br/&gt;
&lt;a href=&quot;http://www.adobe.com/devnet/font/pdfs/5177.Type2.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.adobe.com/devnet/font/pdfs/5177.Type2.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The chapter 3.2 &quot;Charstring Number Encoding&quot; contains the following statement:&lt;br/&gt;
&quot;If the charstring byte contains the value 255, the next four bytes&lt;br/&gt;
indicate a two&apos;s complement signed number. The first of these&lt;br/&gt;
four bytes contains the highest order bits, the second byte&lt;br/&gt;
contains the next higher order bits and the fourth byte contains&lt;br/&gt;
the lowest order bits. This number is interpreted as a Fixed; that&lt;br/&gt;
is, a signed number with 16 bits of fraction.&quot;&lt;/p&gt;

&lt;p&gt;The problem with this 5-byte number encoding is that is extremely rarely used (this TeX generated document is the only one where I&apos;ve seen it). Most numbers are capped at around 2000, and they are represented using 2- (value range -1131 .. +1131) or 3-byte (value range -32768 .. +32768) number encodings.&lt;/p&gt;</comment>
                            <comment id="12845246" author="lehmi" created="Mon, 15 Mar 2010 09:01:46 +0000"  >&lt;p&gt;Thanks for the link. Correct me if I&apos;m wrong. The value is a two&apos;s complement so that we have to use another algo to calculate a short value, than just shifting the bits. We have to invert all bits and add &quot;1&quot; if the msb is set. See &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; for further details.&lt;/p&gt;

&lt;p&gt;BTW: pdf620-fails.pdf attached to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-620&quot; title=&quot;Text extract fails on some PDF files but not others...&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-620&quot;&gt;&lt;del&gt;PDFBOX-620&lt;/del&gt;&lt;/a&gt; uses that encoding somewhere on page 4 or 5.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://en.wikipedia.org/wiki/Two%27s_complement&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://en.wikipedia.org/wiki/Two%27s_complement&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12847466" author="lehmi" created="Fri, 19 Mar 2010 17:45:28 +0000"  >&lt;p&gt;I&apos;ve applied the patch with version 925352.&lt;/p&gt;

&lt;p&gt;Thanks to Villu for his contributiuon and sorry for the confusion.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12436513" name="FontBox.patch" size="1291" author="vfed" created="Sun, 21 Feb 2010 18:28:04 +0000"/>
                            <attachment id="12436514" name="documenta_math-fixed.txt" size="11015" author="vfed" created="Sun, 21 Feb 2010 18:29:45 +0000"/>
                            <attachment id="12436011" name="documenta_math.pdf" size="106638" author="vfed" created="Tue, 16 Feb 2010 19:26:04 +0000"/>
                            <attachment id="12436012" name="documenta_math.txt" size="8808" author="vfed" created="Tue, 16 Feb 2010 19:26:04 +0000"/>
                            <attachment id="12436515" name="documenta_math_page4-fixed.png" size="178193" author="vfed" created="Sun, 21 Feb 2010 18:29:45 +0000"/>
                            <attachment id="12436013" name="documenta_math_page4.png" size="172263" author="vfed" created="Tue, 16 Feb 2010 19:26:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>163377</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zfp3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204845</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>