diff --git a/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java b/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java
index 1fdea0ceab..d56d1ea7cc 100644
--- a/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java
+++ b/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java
@@ -356,69 +356,58 @@ public class CMapParser
             }
             byte[] startCode = (byte[]) nextToken;
             byte[] endCode = (byte[]) parseNextToken(cmapStream);
-            if (!checkBoundaries(startCode, endCode))
+            int start = CMap.toInt(startCode, startCode.length);
+            int end = CMap.toInt(endCode, endCode.length);
+            // end has to be bigger than start or equal
+            // the range can not represent more that 255 values
+            if (end < start || (end - start) > 255)
             {
                 // PDFBOX-4550: likely corrupt stream
                 break;
             }
             nextToken = parseNextToken(cmapStream);
-            List<byte[]> array = null;
-            byte[] tokenBytes;
             if (nextToken instanceof List<?>)
             {
-                array = (List<byte[]>) nextToken;
-                if (array.isEmpty())
+                List<byte[]> array = (List<byte[]>) nextToken;
+                // ignore empty and malformed arrays
+                if (!array.isEmpty() && array.size() >= end - start)
                 {
-                    continue;
+                    addMappingFrombfrange(result, startCode, array);
                 }
-                tokenBytes = array.get(0);
             }
-            else
-            {
-                tokenBytes = (byte[]) nextToken;
-            }
-            if (tokenBytes == null || tokenBytes.length == 0)
+            // PDFBOX-3807: ignore null
+            else if (nextToken instanceof byte[])
             {
+                byte[] tokenBytes = (byte[]) nextToken;
                 // PDFBOX-3450: ignore <>
-                // PDFBOX-3807: ignore null
-                continue;
-            }
-            boolean done = false;
-
-            int arrayIndex = 0;
-            while (!done)
-            {
-                if (compare(startCode, endCode) >= 0)
-                {
-                    done = true;
-                }
-                String value = createStringFromBytes(tokenBytes);
-                result.addCharMapping(startCode, value);
-                increment(startCode);
-
-                if (array == null)
+                if (tokenBytes.length > 0)
                 {
-                    increment(tokenBytes);
-                }
-                else
-                {
-                    arrayIndex++;
-                    if (arrayIndex < array.size())
-                    {
-                        tokenBytes = array.get(arrayIndex);
-                    }
+                    addMappingFrombfrange(result, startCode, end - start + 1, tokenBytes);
                 }
             }
         }
     }
 
-    private boolean checkBoundaries(byte[] startCode, byte[] endCode)
+    private void addMappingFrombfrange(CMap cmap, byte[] startCode, List<byte[]> tokenBytesList)
+    {
+        for (byte[] tokenBytes : tokenBytesList)
+        {
+            String value = createStringFromBytes(tokenBytes);
+            cmap.addCharMapping(startCode, value);
+            increment(startCode);
+        }
+    }
+
+    private void addMappingFrombfrange(CMap cmap, byte[] startCode, int values,
+            byte[] tokenBytes)
     {
-        int start = CMap.toInt(startCode, startCode.length);
-        int end = CMap.toInt(endCode, endCode.length);
-        // end has to be bigger than start or equal
-        // the range can not represent more that 255 values
-        return end >= start && (end - start) < 256;
+        for (int i = 0; i < values; i++)
+        {
+            String value = createStringFromBytes(tokenBytes);
+            cmap.addCharMapping(startCode, value);
+            increment(startCode);
+            increment(tokenBytes);
+        }
     }
 
     /**
@@ -722,27 +711,6 @@ public class CMapParser
         return new String(bytes, bytes.length == 1 ? Charsets.ISO_8859_1 : Charsets.UTF_16BE);
     }
 
-    private int compare(byte[] first, byte[] second)
-    {
-        for (int i = 0; i < first.length; i++)
-        {
-            if (first[i] == second[i])
-            {
-                continue;
-            }
-
-            if ((first[i] & 0xFF) < (second[i] & 0xFF))
-            {
-                return -1;
-            }
-            else
-            {
-                return 1;
-            }
-        }
-        return 0;
-    }
-
     /**
      * Internal class.
      */
diff --git a/fontbox/src/test/java/org/apache/fontbox/cmap/TestCMapParser.java b/fontbox/src/test/java/org/apache/fontbox/cmap/TestCMapParser.java
index 2c783b0091..d46adb5aa0 100644
--- a/fontbox/src/test/java/org/apache/fontbox/cmap/TestCMapParser.java
+++ b/fontbox/src/test/java/org/apache/fontbox/cmap/TestCMapParser.java
@@ -45,19 +45,31 @@ public class TestCMapParser extends TestCase
 
         // char mappings
         byte[] bytes1 = {0, 1};
-        assertEquals("bytes 00 01 from bfrange <0001> <0009> <0041>", "A", cMap.toUnicode(toInt(bytes1,bytes1.length)));
+        assertEquals("bytes 00 01 from bfrange <0001> <0005> <0041>", "A",
+                cMap.toUnicode(toInt(bytes1, bytes1.length)));
 
         byte[] bytes2 = {1, 00};
         String str2 = "0";
-        assertEquals("bytes 01 00 from bfrange <0100> <0109> <0030>", str2, cMap.toUnicode(toInt(bytes2,bytes2.length)));
-
-        byte[] bytes3 = {0, 10};
-        String str3 = "*";
-        assertEquals("bytes 00 0A from bfchar <000A> <002A>", str3, cMap.toUnicode(toInt(bytes3,bytes3.length)));
-
-        byte[] bytes4 = {1, 10};
-        String str4 = "+";
-        assertEquals("bytes 01 0A from bfchar <010A> <002B>", str4, cMap.toUnicode(toInt(bytes4,bytes4.length)));
+        assertEquals("bytes 01 00 from bfrange <0100> <0109> <0030>", str2,
+                cMap.toUnicode(toInt(bytes2, bytes2.length)));
+
+        byte[] bytes3 = { 1, 32 };
+        assertEquals("bytes 01 00 from bfrange <0100> <0109> <0030>", "P",
+                cMap.toUnicode(toInt(bytes3, bytes3.length)));
+
+        byte[] bytes4 = { 1, 33 };
+        assertEquals("bytes 01 00 from bfrange <0100> <0109> <0030>", "R",
+                cMap.toUnicode(toInt(bytes4, bytes4.length)));
+
+        byte[] bytes5 = { 0, 10 };
+        String str5 = "*";
+        assertEquals("bytes 00 0A from bfchar <000A> <002A>", str5,
+                cMap.toUnicode(toInt(bytes5, bytes5.length)));
+
+        byte[] bytes6 = { 1, 10 };
+        String str6 = "+";
+        assertEquals("bytes 01 0A from bfchar <010A> <002B>", str6,
+                cMap.toUnicode(toInt(bytes6, bytes6.length)));
 
         // CID mappings
         int cid1 = 65;
diff --git a/fontbox/src/test/resources/cmap/CMapTest b/fontbox/src/test/resources/cmap/CMapTest
index f56e33b6c1..a6ff864219 100644
--- a/fontbox/src/test/resources/cmap/CMapTest
+++ b/fontbox/src/test/resources/cmap/CMapTest
@@ -26,9 +26,10 @@ endcodespacerange
 <010A> <002B>
 endbfchar
 
-2 beginbfrange
-<0001> <0009> <0041>
+3 beginbfrange
+<0001> <0005> <0041>
 <0100> <0109> <0030>
+<0120> <0122> [<0050> <0052> <0054>]
 endbfrange
 
 3 begincidchar
