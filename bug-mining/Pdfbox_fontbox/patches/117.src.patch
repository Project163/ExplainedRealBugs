diff --git a/fontbox/src/main/java/org/apache/fontbox/ttf/CmapSubtable.java b/fontbox/src/main/java/org/apache/fontbox/ttf/CmapSubtable.java
index 8f06d539ca..d003b389f0 100644
--- a/fontbox/src/main/java/org/apache/fontbox/ttf/CmapSubtable.java
+++ b/fontbox/src/main/java/org/apache/fontbox/ttf/CmapSubtable.java
@@ -496,22 +496,6 @@ public class CmapSubtable
         }
     }
 
-    /**
-     * @return Returns the glyphIdToCharacterCode.
-     */
-    public int[] getGlyphIdToCharacterCode()
-    {
-        return glyphIdToCharacterCode;
-    }
-
-    /**
-     * @param glyphIdToCharacterCodeValue The glyphIdToCharacterCode to set.
-     */
-    public void setGlyphIdToCharacterCode(int[] glyphIdToCharacterCodeValue)
-    {
-        glyphIdToCharacterCode = glyphIdToCharacterCodeValue;
-    }
-
     /**
      * @return Returns the platformEncodingId.
      */
@@ -556,6 +540,21 @@ public class CmapSubtable
         return glyphId == null ? 0 : glyphId;
     }
 
+    /**
+     * Returns the character code for the given GID.
+     *
+     * @param gid glyph id
+     * @return character code
+     */
+    public int getCharacterCode(int gid)
+    {
+        if (gid < 0 || gid >= glyphIdToCharacterCode.length)
+        {
+            return 0;
+        }
+        return glyphIdToCharacterCode[gid];
+    }
+
     @Override
     public String toString()
     {
diff --git a/fontbox/src/main/java/org/apache/fontbox/ttf/TTFSubsetter.java b/fontbox/src/main/java/org/apache/fontbox/ttf/TTFSubsetter.java
index 278e67939e..a2e946ff09 100755
--- a/fontbox/src/main/java/org/apache/fontbox/ttf/TTFSubsetter.java
+++ b/fontbox/src/main/java/org/apache/fontbox/ttf/TTFSubsetter.java
@@ -28,7 +28,6 @@ import java.util.GregorianCalendar;
 import java.util.HashMap;
 import java.util.Iterator;
 import java.util.List;
-import java.util.Locale;
 import java.util.Map;
 import java.util.Map.Entry;
 import java.util.Set;
@@ -37,9 +36,6 @@ import java.util.SortedSet;
 import java.util.TreeMap;
 import java.util.TreeSet;
 
-import org.apache.fontbox.encoding.Encoding;
-import org.apache.fontbox.encoding.MacRomanEncoding;
-
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 
@@ -959,57 +955,17 @@ public class TTFSubsetter
         List<String> additionalNames = new ArrayList<String>();
         Map<String,Integer> additionalNamesIndices = new HashMap<String,Integer>();
         
-        if (glyphNames == null) 
+        if (glyphNames != null)
         {
-            Encoding enc = MacRomanEncoding.INSTANCE;
-            int[] gidToUC = this.baseCmap.getGlyphIdToCharacterCode();
-            for (Integer glyphId : this.glyphIds) 
-            {
-                int uc = gidToUC[glyphId];
-                String name = null;
-                if (uc < 0x8000) 
-                {
-                    try 
-                    {
-                        name = enc.getNameFromCharacter((char)uc);
-                    }
-                    catch (IOException e) 
-                    {
-                        // TODO
-                    }
-                }
-                if (name == null) 
-                {
-                    name = String.format(Locale.ENGLISH,"uni%04X",uc);
-                }
-                Integer macId = WGL4Names.MAC_GLYPH_NAMES_INDICES.get(name);
-                if (macId == null) 
-                {
-                    Integer idx = additionalNamesIndices.get(name);
-                    if (idx == null) 
-                    {
-                        idx = additionalNames.size();
-                        additionalNames.add(name);
-                        additionalNamesIndices.put(name,idx);
-                    }
-                    writeUint16(dos,idx+258);
-                }
-                else 
-                {
-                    writeUint16(dos, macId);
-                }
-            }
-        }
-        else 
-        { 
-            for (Integer glyphId : this.glyphIds) 
+            for (Integer glyphId : this.glyphIds)
             {
                 String name = glyphNames[glyphId];
+
                 Integer macId = WGL4Names.MAC_GLYPH_NAMES_INDICES.get(name);
-                if (macId == null) 
+                if (macId == null)
                 {
                     Integer idx = additionalNamesIndices.get(name);
-                    if (idx == null) 
+                    if (idx == null)
                     {
                         idx = additionalNames.size();
                         additionalNames.add(name);
@@ -1017,7 +973,7 @@ public class TTFSubsetter
                     }
                     writeUint16(dos,idx+258);
                 }
-                else 
+                else
                 {
                     writeUint16(dos, macId);
                 }
