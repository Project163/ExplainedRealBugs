diff --git a/fontbox/src/main/java/org/apache/fontbox/ttf/GlyphSubstitutionTable.java b/fontbox/src/main/java/org/apache/fontbox/ttf/GlyphSubstitutionTable.java
index 18f5b04a38..bade242006 100644
--- a/fontbox/src/main/java/org/apache/fontbox/ttf/GlyphSubstitutionTable.java
+++ b/fontbox/src/main/java/org/apache/fontbox/ttf/GlyphSubstitutionTable.java
@@ -412,7 +412,10 @@ public class GlyphSubstitutionTable extends TTFTable
 
         int[] componentGlyphIDs = new int[componentCount];
 
-        componentGlyphIDs[0] = coverageGlyphId;
+        if (componentCount > 0)
+        {
+            componentGlyphIDs[0] = coverageGlyphId;
+        }
 
         for (int i = 1; i <= componentCount - 1; i++)
         {
diff --git a/fontbox/src/main/java/org/apache/fontbox/ttf/gsub/GlyphSubstitutionDataExtractor.java b/fontbox/src/main/java/org/apache/fontbox/ttf/gsub/GlyphSubstitutionDataExtractor.java
index 28f1cfc051..808ca400c5 100644
--- a/fontbox/src/main/java/org/apache/fontbox/ttf/gsub/GlyphSubstitutionDataExtractor.java
+++ b/fontbox/src/main/java/org/apache/fontbox/ttf/gsub/GlyphSubstitutionDataExtractor.java
@@ -103,22 +103,27 @@ public class GlyphSubstitutionDataExtractor
             LangSysTable langSysTable, FeatureListTable featureListTable,
             LookupListTable lookupListTable)
     {
+        FeatureRecord[] featureRecords = featureListTable.getFeatureRecords();
         for (int featureIndex : langSysTable.getFeatureIndices())
         {
-            FeatureRecord featureRecord = featureListTable.getFeatureRecords()[featureIndex];
-            populateGsubData(gsubData, featureRecord, lookupListTable);
+            if (featureIndex < featureRecords.length)
+            {
+                populateGsubData(gsubData, featureRecords[featureIndex], lookupListTable);
+            }
         }
     }
 
     private void populateGsubData(Map<String, Map<List<Integer>, Integer>> gsubData,
             FeatureRecord featureRecord, LookupListTable lookupListTable)
     {
-
+        LookupTable[] lookups = lookupListTable.getLookups();
         Map<List<Integer>, Integer> glyphSubstitutionMap = new LinkedHashMap<>();
         for (int lookupIndex : featureRecord.getFeatureTable().getLookupListIndices())
         {
-            LookupTable lookupTable = lookupListTable.getLookups()[lookupIndex];
-            extractData(glyphSubstitutionMap, lookupTable);
+            if (lookupIndex < lookups.length)
+            {
+                extractData(glyphSubstitutionMap, lookups[lookupIndex]);
+            }
         }
 
         LOG.debug("*********** extracting GSUB data for the feature: "
