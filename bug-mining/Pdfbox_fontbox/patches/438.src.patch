diff --git a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java b/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java
index f6cc3445b0..3f57b634a8 100644
--- a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java
+++ b/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java
@@ -154,6 +154,11 @@ public class PfbParser
             size += in.read() << 16;
             size += in.read() << 24;
             LOG.debug("record type: {}, segment size: {}", recordType, size);
+            if (size > pfb.length)
+            {
+                // PDFBOX-6044: avoid potential OOM
+                throw new IOException("record size " + size + "would be larger than the input");
+            }
             byte[] ar = new byte[size];
             int got = in.read(ar);
             if (got != size)
