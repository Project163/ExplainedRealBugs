diff --git a/fontbox/src/main/java/org/apache/fontbox/cff/CFFParser.java b/fontbox/src/main/java/org/apache/fontbox/cff/CFFParser.java
index 7a8534b66a..7c1eb0d15b 100644
--- a/fontbox/src/main/java/org/apache/fontbox/cff/CFFParser.java
+++ b/fontbox/src/main/java/org/apache/fontbox/cff/CFFParser.java
@@ -40,7 +40,9 @@ public class CFFParser
     private IndexData nameIndex = null;
     private IndexData topDictIndex = null;
     private IndexData stringIndex = null;
-    private String debugFontName; // for debugging only
+    
+    // for debugging only
+    private String debugFontName; 
 
     /**
      * Parsing CFF Font using a byte array as input.
@@ -145,7 +147,12 @@ public class CFFParser
         int offSize = input.readOffSize();
         for (int i = 0; i <= count; i++)
         {
-            index.setOffset(i, input.readOffset(offSize));
+            int offset = input.readOffset(offSize);
+            if (offset > input.length())
+            {
+                throw new IOException("illegal offset value " + offset + " in CFF font");
+            }
+            index.setOffset(i, offset);
         }
         int dataSize = index.getOffset(count) - index.getOffset(0);
         index.initData(dataSize);
diff --git a/fontbox/src/main/java/org/apache/fontbox/cff/DataInput.java b/fontbox/src/main/java/org/apache/fontbox/cff/DataInput.java
index 65ad6a9c6f..5bdac62270 100644
--- a/fontbox/src/main/java/org/apache/fontbox/cff/DataInput.java
+++ b/fontbox/src/main/java/org/apache/fontbox/cff/DataInput.java
@@ -23,7 +23,6 @@ import java.io.IOException;
  * This class contains some functionality to read a byte buffer.
  * 
  * @author Villu Ruusmann
- * @version $Revision$
  */
 public class DataInput
 {
@@ -203,4 +202,9 @@ public class DataInput
             return -1;
         }
     }
+    
+    public int length()
+    {
+        return inputBuffer.length;
+    }
 }
\ No newline at end of file
