diff --git a/fontbox/src/main/java/org/apache/fontbox/cmap/CMap.java b/fontbox/src/main/java/org/apache/fontbox/cmap/CMap.java
index 0ebcdd00ea..6fed95abed 100644
--- a/fontbox/src/main/java/org/apache/fontbox/cmap/CMap.java
+++ b/fontbox/src/main/java/org/apache/fontbox/cmap/CMap.java
@@ -38,6 +38,9 @@ public class CMap
     private String registry = null;
     private String ordering = null;
     private int supplement = 0;
+    
+    private int minCodeLength = 4;
+    private int maxCodeLength;
 
     // code lengths
     private final List<CodespaceRange> codespaceRanges = new ArrayList<CodespaceRange>();
@@ -101,13 +104,13 @@ public class CMap
     public int readCode(InputStream in) throws IOException
     {
         // save the position in the string
-        in.mark(4);
+        in.mark(maxCodeLength);
 
         // mapping algorithm
-        byte[] bytes = new byte[4];
-        for (int i = 0; i < 4; i++)
+        byte[] bytes = new byte[maxCodeLength];
+        in.read(bytes,0,minCodeLength);
+        for (int i = minCodeLength-1; i < maxCodeLength; i++)
         {
-            bytes[i] = (byte)in.read();
             final int byteCount = i+1;
             for (CodespaceRange range : codespaceRanges)
             {
@@ -116,13 +119,17 @@ public class CMap
                     return toInt(bytes, byteCount);
                 }
             }
+            if (i+1 < maxCodeLength)
+            {
+                bytes[i+1] = (byte)in.read();
+            }
         }
 
         // reset to the original position in the string
         in.reset();
 
         // modified mapping algorithm
-        for (int i = 0; i < 4; i++)
+        for (int i = 0; i < maxCodeLength; i++)
         {
             final byte curByte = (byte)in.read(); 
             bytes[i] = curByte;
@@ -273,6 +280,8 @@ public class CMap
     void addCodespaceRange( CodespaceRange range )
     {
         codespaceRanges.add(range);
+        maxCodeLength = Math.max(maxCodeLength, range.getCodeLength());
+        minCodeLength = Math.min(minCodeLength, range.getCodeLength());
     }
     
     /**
@@ -283,10 +292,11 @@ public class CMap
      */
     void useCmap( CMap cmap )
     {
-        this.codespaceRanges.addAll(cmap.codespaceRanges);
-        this.charToUnicode.putAll(cmap.charToUnicode);
-        this.codeToCid.putAll(cmap.codeToCid);
-        this.codeToCidRanges.addAll(cmap.codeToCidRanges);
+        for (CodespaceRange codespaceRange : cmap.codespaceRanges)
+            addCodespaceRange(codespaceRange);
+        charToUnicode.putAll(cmap.charToUnicode);
+        codeToCid.putAll(cmap.codeToCid);
+        codeToCidRanges.addAll(cmap.codeToCidRanges);
     }
     
     /**
diff --git a/fontbox/src/main/java/org/apache/fontbox/cmap/CodespaceRange.java b/fontbox/src/main/java/org/apache/fontbox/cmap/CodespaceRange.java
index 369cce3339..687965ccaa 100644
--- a/fontbox/src/main/java/org/apache/fontbox/cmap/CodespaceRange.java
+++ b/fontbox/src/main/java/org/apache/fontbox/cmap/CodespaceRange.java
@@ -26,7 +26,8 @@ public class CodespaceRange
 {
     private byte[] start;
     private byte[] end;
-
+    private int codeLength = 0;
+    
     /**
      * Creates a new instance of CodespaceRange.
      */
@@ -34,13 +35,23 @@ public class CodespaceRange
     {
     }
 
+    /**
+     * Returns the length of the codes of the codespace.
+     * 
+     * @return the code length
+     */
+    public int getCodeLength()
+    {
+        return codeLength;
+    }
+
     /** Getter for property end.
      * @return Value of property end.
      *
      */
     public byte[] getEnd()
     {
-        return this.end;
+        return end;
     }
 
     /** Setter for property end.
@@ -58,7 +69,7 @@ public class CodespaceRange
      */
     public byte[] getStart()
     {
-        return this.start;
+        return start;
     }
 
     /** Setter for property start.
@@ -68,6 +79,7 @@ public class CodespaceRange
     void setStart(byte[] startBytes)
     {
         start = startBytes;
+        codeLength = start.length;
     }
 
     /**
@@ -75,24 +87,7 @@ public class CodespaceRange
      */
     public boolean matches(byte[] code)
     {
-        // code must be the same length as the bounding codes
-        if (code.length >= start.length && code.length <= end.length)
-        {
-            // each of it bytes must lie between the corresponding bytes of the upper & lower bounds
-            for (int i = 0; i < code.length; i++)
-            {
-                int startNum = start[i] & 0xff;
-                int endNum = end[i] & 0xff;
-                int codeNum = code[i] & 0xff;
-
-                if (codeNum > endNum || codeNum < startNum)
-                {
-                    return false;
-                }
-            }
-            return true;
-        }
-        return false;
+        return isFullMatch(code, code.length);
     }
 
     /**
@@ -101,7 +96,7 @@ public class CodespaceRange
     public boolean isFullMatch(byte[] code, int codeLen)
     {
         // code must be the same length as the bounding codes
-        if (codeLen >= start.length && codeLen <= end.length)
+        if (codeLen == codeLength)
         {
             // each of it bytes must lie between the corresponding bytes of the upper & lower bounds
             for (int i = 0; i < codeLen; i++)
@@ -125,7 +120,7 @@ public class CodespaceRange
      */
     public boolean isPartialMatch(byte b, int index)
     {
-        if (index >= start.length || index >= end.length)
+        if (index == codeLength)
         {
             return false;
         }
