diff --git a/fontbox/src/main/java/org/apache/fontbox/ttf/RandomAccessReadDataStream.java b/fontbox/src/main/java/org/apache/fontbox/ttf/RandomAccessReadDataStream.java
index 8743bdd2f8..a05e75fbcb 100644
--- a/fontbox/src/main/java/org/apache/fontbox/ttf/RandomAccessReadDataStream.java
+++ b/fontbox/src/main/java/org/apache/fontbox/ttf/RandomAccessReadDataStream.java
@@ -49,6 +49,11 @@ class RandomAccessReadDataStream extends TTFDataStream
     RandomAccessReadDataStream(RandomAccessRead randomAccessRead) throws IOException
     {
         length = randomAccessRead.length();
+        if (length > Integer.MAX_VALUE - 8) // https://www.baeldung.com/java-arrays-max-size
+        {
+            // PDFBOX-5991
+            throw new IOException("Stream is too long, size: " + length);
+        }
         data = new byte[(int) length];
         int remainingBytes = data.length;
         int amountRead;
