diff --git a/fontbox/src/main/java/org/apache/fontbox/ttf/GlyfSimpleDescript.java b/fontbox/src/main/java/org/apache/fontbox/ttf/GlyfSimpleDescript.java
index 5ee633e296..d30bd8224a 100644
--- a/fontbox/src/main/java/org/apache/fontbox/ttf/GlyfSimpleDescript.java
+++ b/fontbox/src/main/java/org/apache/fontbox/ttf/GlyfSimpleDescript.java
@@ -216,8 +216,13 @@ public class GlyfSimpleDescript extends GlyfDescript
             if ((flags[index] & REPEAT) != 0)
             {
                 int repeats = bais.readUnsignedByte();
-                for (int i = 1; i <= repeats && index + i < flags.length; i++)
+                for (int i = 1; i <= repeats; i++)
                 {
+                    if (index + i >= flags.length)
+                    {
+                        throw new IOException(
+                                "repeat count (" + repeats + ") higher than remaining space");
+                    }
                     flags[index + i] = flags[index];
                 }
                 index += repeats;
