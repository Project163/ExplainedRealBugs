diff --git a/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java b/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java
index d81ac55c2e..a1439cd071 100644
--- a/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java
+++ b/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java
@@ -377,18 +377,14 @@ public class CMapParser
             // PDFBOX-3807: ignore null
             else if (nextToken instanceof byte[])
             {
-                // the range can not represent more that 255 values
-                // PDFBOX-4661: be more lenient and support 256 values as well
-                if ((end - start) > 256)
-                {
-                    // PDFBOX-4550: likely corrupt stream
-                    break;
-                }
                 byte[] tokenBytes = (byte[]) nextToken;
                 // PDFBOX-3450: ignore <>
                 if (tokenBytes.length > 0)
                 {
-                    addMappingFrombfrange(result, startCode, end - start + 1, tokenBytes);
+                    // PDFBOX-4661: avoid overflow of the last byte, all following values are undefined
+                    int values = Math.min(end - start + 1,
+                            255 - (tokenBytes[tokenBytes.length - 1] & 0xFF));
+                    addMappingFrombfrange(result, startCode, values, tokenBytes);
                 }
             }
         }
diff --git a/fontbox/src/test/java/org/apache/fontbox/cmap/TestCMapParser.java b/fontbox/src/test/java/org/apache/fontbox/cmap/TestCMapParser.java
index d46adb5aa0..e58f5e9f29 100644
--- a/fontbox/src/test/java/org/apache/fontbox/cmap/TestCMapParser.java
+++ b/fontbox/src/test/java/org/apache/fontbox/cmap/TestCMapParser.java
@@ -146,12 +146,13 @@ public class TestCMapParser extends TestCase
 
         assertNotNull("Failed to parse malformed CMap file", cMap);
 
-        byte[] bytes1 = { 0, 1 };
-        assertEquals("bytes 00 01 from bfrange <0001> <0009> <0041>", "A",
-                cMap.toUnicode(toInt(bytes1, bytes1.length)));
+        assertEquals("bytes 00 01 from bfrange <0001> <0009> <0030>", "0", cMap.toUnicode(0x001));
 
-        byte[] bytes2 = { 2, 00 };
-        assertNull(cMap.toUnicode(toInt(bytes2, bytes2.length)));
+        assertEquals("bytes 02 32 from bfrange <0232> <0432> <0041>", "A", cMap.toUnicode(0x232));
+
+        // check border values
+        assertNotNull(cMap.toUnicode(0x2EF));
+        assertNull(cMap.toUnicode(0x2F0));
 
     }
 
diff --git a/fontbox/src/test/resources/cmap/CMapMalformedbfrange2 b/fontbox/src/test/resources/cmap/CMapMalformedbfrange2
index f80cde31c6..0804e25cf3 100644
--- a/fontbox/src/test/resources/cmap/CMapMalformedbfrange2
+++ b/fontbox/src/test/resources/cmap/CMapMalformedbfrange2
@@ -18,12 +18,12 @@
 %%
 %%EndComments
 
-1 begincodespacerange<0000> <02FF>
+1 begincodespacerange<0000> <04FF>
 endcodespacerange
 
 2 beginbfrange
-<0001> <0009> <0041>
-<0200> <0400> <0030>
+<0001> <0009> <0030>
+<0232> <0432> <0041>
 endbfrange
 
 endcmap
