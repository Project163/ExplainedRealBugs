diff --git a/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java b/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java
index a1439cd071..d63c8c0440 100644
--- a/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java
+++ b/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java
@@ -382,8 +382,8 @@ public class CMapParser
                 if (tokenBytes.length > 0)
                 {
                     // PDFBOX-4661: avoid overflow of the last byte, all following values are undefined
-                    int values = Math.min(end - start + 1,
-                            255 - (tokenBytes[tokenBytes.length - 1] & 0xFF));
+                    int values = Math.min(end - start,
+                            255 - (tokenBytes[tokenBytes.length - 1] & 0xFF)) + 1;
                     addMappingFrombfrange(result, startCode, values, tokenBytes);
                 }
             }
diff --git a/fontbox/src/test/java/org/apache/fontbox/cmap/TestCMapParser.java b/fontbox/src/test/java/org/apache/fontbox/cmap/TestCMapParser.java
index e58f5e9f29..d03f8e0112 100644
--- a/fontbox/src/test/java/org/apache/fontbox/cmap/TestCMapParser.java
+++ b/fontbox/src/test/java/org/apache/fontbox/cmap/TestCMapParser.java
@@ -151,8 +151,8 @@ public class TestCMapParser extends TestCase
         assertEquals("bytes 02 32 from bfrange <0232> <0432> <0041>", "A", cMap.toUnicode(0x232));
 
         // check border values
-        assertNotNull(cMap.toUnicode(0x2EF));
-        assertNull(cMap.toUnicode(0x2F0));
+        assertNotNull(cMap.toUnicode(0x2F0));
+        assertNull(cMap.toUnicode(0x2F1));
 
     }
 
