diff --git a/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java b/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java
index 175f5239c0..00362c6f89 100644
--- a/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java
+++ b/fontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.java
@@ -42,6 +42,8 @@ public class CMapParser
 
     private final byte[] tokenParserByteBuffer = new byte[512];
 
+    private boolean strictMode = false;
+
     /**
      * Creates a new instance of CMapParser.
      */
@@ -49,6 +51,16 @@ public class CMapParser
     {
     }
 
+    /**
+     * Creates a new instance of CMapParser.
+     * 
+     * @param strictMode activates the strict mode used for inline CMaps
+     */
+    public CMapParser(boolean strictMode)
+    {
+        this.strictMode = strictMode;
+    }
+
     /**
      * Parse a CMAP file on the file system.
      * 
@@ -75,6 +87,8 @@ public class CMapParser
     {
         try (InputStream input = new BufferedInputStream(getExternalCMap(name)))
         {
+            // deactivate strict mode
+            strictMode = false;
             return parse(input);
         }
     }
@@ -401,10 +415,7 @@ public class CMapParser
                     }
                     else
                     {
-                        // PDFBOX-4661: avoid overflow of the last byte, all following values are undefined
-                        int values = Math.min(end - start,
-                                255 - (tokenBytes[tokenBytes.length - 1] & 0xFF)) + 1;
-                        addMappingFrombfrange(result, startCode, values, tokenBytes);
+                        addMappingFrombfrange(result, startCode, end - start + 1, tokenBytes);
                     }
                 }
             }
@@ -417,7 +428,7 @@ public class CMapParser
         {
             String value = createStringFromBytes(tokenBytes);
             cmap.addCharMapping(startCode, value);
-            increment(startCode);
+            increment(startCode, startCode.length - 1, false);
         }
     }
 
@@ -428,8 +439,12 @@ public class CMapParser
         {
             String value = createStringFromBytes(tokenBytes);
             cmap.addCharMapping(startCode, value);
-            increment(startCode);
-            increment(tokenBytes);
+            increment(startCode, startCode.length - 1, false);
+            if (!increment(tokenBytes, tokenBytes.length - 1, strictMode))
+            {
+                // overflow detected -> stop adding further mappings
+                break;
+            }
         }
     }
 
@@ -705,22 +720,24 @@ public class CMapParser
         }
     }
 
-    private void increment(byte[] data)
-    {
-        increment(data, data.length - 1);
-    }
-
-    private void increment(byte[] data, int position)
+    private boolean increment(byte[] data, int position, boolean useStrictMode)
     {
         if (position > 0 && (data[position] & 0xFF) == 255)
         {
+            // PDFBOX-4661: avoid overflow of the last byte, all following values are undefined
+            // PDFBOX-5090: strict mode has to be used for CMaps within pdfs
+            if (useStrictMode)
+            {
+                return false;
+            }
             data[position] = 0;
-            increment(data, position - 1);
+            increment(data, position - 1, useStrictMode);
         }
         else
         {
             data[position] = (byte) (data[position] + 1);
         }
+        return true;
     }
 
     private String createStringFromBytes(byte[] bytes)
