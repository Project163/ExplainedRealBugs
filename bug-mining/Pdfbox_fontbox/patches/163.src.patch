diff --git a/fontbox/src/main/java/org/apache/fontbox/ttf/CmapSubtable.java b/fontbox/src/main/java/org/apache/fontbox/ttf/CmapSubtable.java
index c480aecb1d..9df153968c 100644
--- a/fontbox/src/main/java/org/apache/fontbox/ttf/CmapSubtable.java
+++ b/fontbox/src/main/java/org/apache/fontbox/ttf/CmapSubtable.java
@@ -488,6 +488,13 @@ public class CmapSubtable
                 {
                     p = (p + idDelta) % 65536;
                 }
+                
+                if (p >= numGlyphs)
+                {
+                    LOG.warn("glyphId " + p + " for charcode " + charCode + " ignored, numGlyphs is " + numGlyphs);
+                    continue;
+                }
+                
                 glyphIdToCharacterCode[p] = charCode;
                 characterCodeToGlyphId.put(charCode, p);
             }
