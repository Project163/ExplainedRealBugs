diff --git a/core/src/main/java/org/apache/metamodel/query/AverageAggregateBuilder.java b/core/src/main/java/org/apache/metamodel/query/AverageAggregateBuilder.java
index 44a2341b..f8b0a957 100644
--- a/core/src/main/java/org/apache/metamodel/query/AverageAggregateBuilder.java
+++ b/core/src/main/java/org/apache/metamodel/query/AverageAggregateBuilder.java
@@ -18,24 +18,18 @@
  */
 package org.apache.metamodel.query;
 
-import org.apache.metamodel.util.AggregateBuilder;
-import org.apache.metamodel.util.NumberComparator;
+import org.apache.metamodel.util.AbstractNumberAggregateBuilder;
 
-final class AverageAggregateBuilder implements AggregateBuilder<Double> {
+/**
+ * Aggregate builder for the {@link FunctionType#AVG} function
+ */
+final class AverageAggregateBuilder extends AbstractNumberAggregateBuilder<Double> {
 
 	public double _average;
 	public int _numValues;
-
+	
 	@Override
-	public void add(Object o) {
-		if (o == null) {
-			return;
-		}
-		Number number = NumberComparator.toNumber(o);
-		if (number == null) {
-			throw new IllegalArgumentException("Could not convert to number: "
-					+ o);
-		}
+	protected void add(Number number) {
 		double total = _average * _numValues + number.doubleValue();
 		_numValues++;
 		_average = total / _numValues;
diff --git a/core/src/main/java/org/apache/metamodel/query/SumAggregateBuilder.java b/core/src/main/java/org/apache/metamodel/query/SumAggregateBuilder.java
index 93b26769..6f262c79 100644
--- a/core/src/main/java/org/apache/metamodel/query/SumAggregateBuilder.java
+++ b/core/src/main/java/org/apache/metamodel/query/SumAggregateBuilder.java
@@ -18,28 +18,23 @@
  */
 package org.apache.metamodel.query;
 
-import org.apache.metamodel.util.AggregateBuilder;
-import org.apache.metamodel.util.NumberComparator;
+import org.apache.metamodel.util.AbstractNumberAggregateBuilder;
 
-final class SumAggregateBuilder implements AggregateBuilder<Double> {
+/**
+ * Aggregate builder for the {@link FunctionType#SUM} function
+ */
+final class SumAggregateBuilder extends AbstractNumberAggregateBuilder<Double> {
 
-	private double sum;
+    private double sum;
 
-	@Override
-	public void add(Object o) {
-		if (o == null) {
-			return;
-		}
-		Number number = NumberComparator.toNumber(o);
-		if (number == null) {
-			throw new IllegalArgumentException("Could not convert to number: " + o);
-		}
-		sum += number.doubleValue();
-	}
+    @Override
+    protected void add(Number number) {
+        sum += number.doubleValue();
+    }
 
-	@Override
-	public Double getAggregate() {
-		return sum;
-	}
+    @Override
+    public Double getAggregate() {
+        return sum;
+    }
 
 }
diff --git a/core/src/main/java/org/apache/metamodel/util/AbstractNumberAggregateBuilder.java b/core/src/main/java/org/apache/metamodel/util/AbstractNumberAggregateBuilder.java
new file mode 100644
index 00000000..0df1fa75
--- /dev/null
+++ b/core/src/main/java/org/apache/metamodel/util/AbstractNumberAggregateBuilder.java
@@ -0,0 +1,56 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+package org.apache.metamodel.util;
+
+/**
+ * Abstract {@link AggregateBuilder} that works on numbers.
+ * 
+ * This will skip nulls and empty strings, but otherwise try to convert to
+ * numbers.
+ *
+ * @param <N>
+ */
+public abstract class AbstractNumberAggregateBuilder<N extends Number> implements AggregateBuilder<N> {
+
+    @Override
+    public final void add(Object o) {
+        if (o == null) {
+            return;
+        }
+        if (o instanceof String) {
+            if ("".equals(((String) o).trim())) {
+                return;
+            }
+        }
+
+        final Number number = NumberComparator.toNumber(o);
+        if (number == null) {
+            throw new IllegalArgumentException("Could not convert to number: " + o);
+        }
+        add(number);
+    }
+
+    /**
+     * Adds a non-null number to the aggregate calculation.
+     * 
+     * @param number
+     */
+    protected abstract void add(Number number);
+
+}
diff --git a/core/src/main/java/org/apache/metamodel/util/AggregateBuilder.java b/core/src/main/java/org/apache/metamodel/util/AggregateBuilder.java
index 477c2d48..bb46eb13 100644
--- a/core/src/main/java/org/apache/metamodel/util/AggregateBuilder.java
+++ b/core/src/main/java/org/apache/metamodel/util/AggregateBuilder.java
@@ -22,8 +22,6 @@ package org.apache.metamodel.util;
  * Interface for aggregate builders which allows for an iterative approach to
  * evaluating aggregates.
  * 
- * @author Kasper SÃ¸rensen
- * 
  * @param <E>
  *            the aggregate result type
  */
diff --git a/core/src/test/java/org/apache/metamodel/QueryPostprocessDataContextTest.java b/core/src/test/java/org/apache/metamodel/QueryPostprocessDataContextTest.java
index 72cd8c28..0949e1e8 100644
--- a/core/src/test/java/org/apache/metamodel/QueryPostprocessDataContextTest.java
+++ b/core/src/test/java/org/apache/metamodel/QueryPostprocessDataContextTest.java
@@ -84,7 +84,9 @@ public class QueryPostprocessDataContextTest extends MetaModelTestCase {
                     data.add(new Object[] { 1, "no nulls", 1 });
                     data.add(new Object[] { 2, "onlynull", null });
                     data.add(new Object[] { 3, "mixed", null });
-                    data.add(new Object[] { 4, "mixed", 2 });
+                    data.add(new Object[] { 4, "mixed", "" });
+                    data.add(new Object[] { 5, "mixed", 2 });
+                    data.add(new Object[] { 6, "mixed", " \n \t " });
                     if (maxRows != -1) {
                         for (int i = data.size() - 1; i >= maxRows; i--) {
                             data.remove(i);
@@ -108,12 +110,12 @@ public class QueryPostprocessDataContextTest extends MetaModelTestCase {
 
         DataSet dataSet = dataContext.query().from(TABLE_CONTRIBUTOR)
                 .select(FunctionType.SUM, COLUMN_CONTRIBUTOR_COUNTRY).select(COLUMN_CONTRIBUTOR_NAME)
-                .groupBy(COLUMN_CONTRIBUTOR_NAME).execute();
-        assertTrue(dataSet.next());
-        assertEquals("Row[values=[1.0, no nulls]]", dataSet.getRow().toString());
+                .groupBy(COLUMN_CONTRIBUTOR_NAME).orderBy(COLUMN_CONTRIBUTOR_NAME).execute();
         assertTrue(dataSet.next());
         assertEquals("Row[values=[2.0, mixed]]", dataSet.getRow().toString());
         assertTrue(dataSet.next());
+        assertEquals("Row[values=[1.0, no nulls]]", dataSet.getRow().toString());
+        assertTrue(dataSet.next());
         assertEquals("Row[values=[0.0, onlynull]]", dataSet.getRow().toString());
         assertFalse(dataSet.next());
         dataSet.close();
