<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:31:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[METAMODEL-1173] unable to select all columns with map used as predicate in where clause</title>
                <link>https://issues.apache.org/jira/browse/METAMODEL-1173</link>
                <project id="12314523" key="METAMODEL">Apache MetaModel (Retired)</project>
                    <description>&lt;p&gt;Given table with column name address of type map with key &lt;/p&gt;
{Building,street, zipcode}
&lt;p&gt;Now if I search through this table like &lt;br/&gt;
select * from restaurants where address.building=&apos;49&apos;&lt;br/&gt;
it gives no result&lt;/p&gt;

&lt;p&gt;however if I use query&lt;br/&gt;
select _id,borough,address.building from restaurants where address.building=&apos;49&apos;&lt;br/&gt;
it produces result.&lt;/p&gt;

&lt;p&gt;Seems like it works only if item in where clause(address.building) is present in select item list.&lt;/p&gt;</description>
                <environment>linux</environment>
        <key id="13121822">METAMODEL-1173</key>
            <summary>unable to select all columns with map used as predicate in where clause</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="AnandRai">AnandRai</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Nov 2017 05:04:38 +0000</created>
                <updated>Tue, 12 Dec 2017 17:17:21 +0000</updated>
                            <resolved>Sun, 10 Dec 2017 06:34:10 +0000</resolved>
                                    <version>5.0.0</version>
                                    <fixVersion>5.0.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16272222" author="githubbot" created="Thu, 30 Nov 2017 06:31:09 +0000"  >&lt;p&gt;GitHub user kaspersorensen opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/METAMODEL-1173&quot; title=&quot;unable to select all columns with map used as predicate in where clause&quot; class=&quot;issue-link&quot; data-issue-key=&quot;METAMODEL-1173&quot;&gt;&lt;del&gt;METAMODEL-1173&lt;/del&gt;&lt;/a&gt;: Fixed issue with evaluating ScalarFunctions in WHERE.&lt;/p&gt;

&lt;p&gt;    This is a fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/METAMODEL-1173&quot; title=&quot;unable to select all columns with map used as predicate in where clause&quot; class=&quot;issue-link&quot; data-issue-key=&quot;METAMODEL-1173&quot;&gt;&lt;del&gt;METAMODEL-1173&lt;/del&gt;&lt;/a&gt;. It may seem a quite indirect fix in the sense that it uses a (new) SUBSTRING function to reproduce the issue, but from a testing perspective I needed a scalar function that was easier to work with on test data, and that took function parameters. Since we didn&apos;t have that, I found that the easiest way to test it was actually to introduce a new scalar function. It may be somewhat of a side-effect, but hopefully an agreeable/good one?&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/kaspersorensen/metamodel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/kaspersorensen/metamodel&lt;/a&gt; map-value-resolution-in-where&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #171&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 1bac17863a2a7c49ba8686fb4dc47d67a1a71773&lt;br/&gt;
Author: Kasper S&#248;rensen &amp;lt;i.am.kasper.sorensen@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-11-30T06:27:05Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/METAMODEL-1173&quot; title=&quot;unable to select all columns with map used as predicate in where clause&quot; class=&quot;issue-link&quot; data-issue-key=&quot;METAMODEL-1173&quot;&gt;&lt;del&gt;METAMODEL-1173&lt;/del&gt;&lt;/a&gt;: Fixed issue with evaluating ScalarFunctions in WHERE.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16272391" author="anandrai" created="Thu, 30 Nov 2017 08:55:37 +0000"  >&lt;p&gt;Travis CI build is failing for this fix. Please check.&lt;/p&gt;</comment>
                            <comment id="16272907" author="githubbot" created="Thu, 30 Nov 2017 16:41:01 +0000"  >&lt;p&gt;Github user kaspersorensen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Fixed build issue.&lt;/p&gt;</comment>
                            <comment id="16274237" author="githubbot" created="Fri, 1 Dec 2017 10:47:34 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Code LGTM, but not tested (at least by me, @Anand49 did you test). &lt;/p&gt;

&lt;p&gt;    I won&apos;t have a chance to test or merge until tomorrow at the earliest, so someone else might want to do that. &lt;/p&gt;</comment>
                            <comment id="16277934" author="githubbot" created="Tue, 5 Dec 2017 02:59:33 +0000"  >&lt;p&gt;Github user kaspersorensen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The code does include an additional test, `QueryPostprocessDataContextTest.testColumnOnlyUsedInScalarFunctionInWhereClause()`&lt;/p&gt;</comment>
                            <comment id="16278170" author="githubbot" created="Tue, 5 Dec 2017 08:02:24 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Oh damn, forgot about this. Will check tonight.&lt;/p&gt;

&lt;p&gt;    I meant &quot;not tested&quot; as in &quot;I didn&apos;t do a manual test&quot; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16279223" author="githubbot" created="Tue, 5 Dec 2017 21:34:17 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Played around with it a bit in a scratch file and a Dockerized Mongo. WHEREs with map keys seems to work quite nicely (though I was quite hampered from my limited knowledge of Mongo), also without the explicit selection.&lt;/p&gt;

&lt;p&gt;    However, A SELECT with a SUBSTRING seems broken, or I&apos;m using it wrong,&lt;/p&gt;

&lt;p&gt;    A `SELECT SUBSTRING(item, 1, 4) from inventory` with the values &quot;journal&quot; &quot;mat&quot; and &quot;mousepad&quot; should have yielded &quot;jour&quot;, &quot;mat&quot; and &quot;mous&quot; (or &quot;ourn&quot;, &quot;at&quot; and &quot;ouse&quot; if it&apos;s supposed to be 0-indexed... Which it looks like in code and tests, but seems quite odd in an SQL-like query), but instead yielded &quot;ournal, &quot;at&quot; and &quot;ousepad&quot;, seemingly ignoring the second limit. I saw something similar when trying to use it in there WHERE clause.&lt;/p&gt;

&lt;p&gt;    Here&apos;s the quite simple code snippet:&lt;br/&gt;
    ``` Java&lt;br/&gt;
    import org.apache.metamodel.DataContext;&lt;br/&gt;
    import org.apache.metamodel.data.DataSet;&lt;br/&gt;
    import org.apache.metamodel.mongodb.mongo3.MongoDbDataContext;&lt;br/&gt;
    import org.apache.metamodel.util.SimpleTableDef;&lt;/p&gt;

&lt;p&gt;    import com.mongodb.MongoClient;&lt;/p&gt;

&lt;p&gt;    class Test {&lt;br/&gt;
        public static void main(String[] args) {&lt;br/&gt;
            final DataContext mongoDbDataContext =&lt;br/&gt;
                    new MongoDbDataContext(new MongoClient(&quot;192.168.99.100&quot;).getDatabase(&quot;test&quot;),&lt;br/&gt;
                            new SimpleTableDef(&quot;inventory&quot;,&lt;br/&gt;
                                    new String[] &lt;/p&gt;
{ &quot;item&quot;, &quot;qty&quot;, &quot;tags&quot;, &quot;size.h&quot;, &quot;size.w&quot;, &quot;size.uom&quot; }
&lt;p&gt;));&lt;/p&gt;

&lt;p&gt;            final DataSet ds = mongoDbDataContext.executeQuery(&quot;SELECT SUBSTRING(item, 1, 4) from inventory&quot;);&lt;br/&gt;
            ds.forEach(System.out::println);&lt;br/&gt;
        }&lt;br/&gt;
    }&lt;br/&gt;
    ```&lt;br/&gt;
    Values are those inserted here: &lt;a href=&quot;https://docs.mongodb.com/manual/tutorial/insert-documents/#insert-multiple-documents&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.mongodb.com/manual/tutorial/insert-documents/#insert-multiple-documents&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;    BTW, for Mongo3, the integration test is a single line from working, so maybe add a few tests around it to that one.&lt;/p&gt;</comment>
                            <comment id="16279590" author="githubbot" created="Wed, 6 Dec 2017 03:19:21 +0000"  >&lt;p&gt;Github user kaspersorensen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Oh, I&apos;ll look at ensuring that substring actually works. &lt;/p&gt;

&lt;p&gt;    What do you mean by &quot;for Mongo3 the integration test is a single line from working&quot; ?&lt;/p&gt;</comment>
                            <comment id="16279611" author="githubbot" created="Wed, 6 Dec 2017 03:45:33 +0000"  >&lt;p&gt;Github user kaspersorensen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hmm I &quot;fixed&quot; substring, at least ensured that it&apos;s returning the right results, similar to Java&apos;s `String.substring` method. But it looks like you&apos;re right with regards to the interpretation of SUBSTRING parameters in SQL. At least I looked at PostgreSQL, SQL Server and MySQL, and they all have variances of parameters, but one syntax in common: `SUBSTRING(str, start, count)` where `start` is 1 based start index and `count` is &quot;number of characters&quot;, not end index. I guess we should comply with that?&lt;/p&gt;</comment>
                            <comment id="16279722" author="githubbot" created="Wed, 6 Dec 2017 06:32:49 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    With &quot;for Mongo3 the integration test is a single line from working&quot;, I meant that the MongoDB integration test aaaaaaalmost works when enabled, except for a single assert (`org.apache.metamodel.mongodb.mongo3.MongoDbDataContextTest` line 262), so it might be a good idea to keep it up to date, and add a test for the map issue, since that&apos;s one of the DBs where it matters.&lt;/p&gt;

&lt;p&gt;    Yeah, at least to me it would make most sense to use the behavior of the language we&apos;re emulating. We &lt;em&gt;could&lt;/em&gt; do it different when using the Java interface, but that would also somehow be weird, consistency-wise. Anyway, none of it is really a blocker, there&apos;s arguments for all approaches.&lt;/p&gt;</comment>
                            <comment id="16281344" author="githubbot" created="Thu, 7 Dec 2017 05:23:01 +0000"  >&lt;p&gt;Github user kaspersorensen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/172&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/172&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Ok that seemed to work - closing this in order to just have #171 &lt;/p&gt;</comment>
                            <comment id="16281345" author="githubbot" created="Thu, 7 Dec 2017 05:23:02 +0000"  >&lt;p&gt;Github user kaspersorensen closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/172&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/172&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16281400" author="githubbot" created="Thu, 7 Dec 2017 06:51:50 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Changes looks really good, but Travis is angry. Will look into it when I have a chance (might not be today)&lt;/p&gt;</comment>
                            <comment id="16281408" author="githubbot" created="Thu, 7 Dec 2017 07:01:08 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    A bit irrelevant to this PR, but I &lt;em&gt;love&lt;/em&gt; getting integration tests into the Travis build. If we can stagger them a bit, I guess we can do all database engines that are available on Docker? Which even includes SQL Server these days.&lt;/p&gt;</comment>
                            <comment id="16281464" author="githubbot" created="Thu, 7 Dec 2017 07:52:55 +0000"  >&lt;p&gt;Github user kaspersorensen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Darn it ... Seems we have something rotten in our handling of scalar functions. Have been trying to sort out that issue all night now, and still not fixed it. In short, we evaluate scalar functions in two different ways, (1) via `ScalarFunctionDataSet` and (2) via `FilteredItem`. I&apos;ve been trying to consolidate it to &lt;em&gt;only&lt;/em&gt; be via (1), but there are still failing tests and stuff. Putting this PR on hold...&lt;/p&gt;</comment>
                            <comment id="16281469" author="githubbot" created="Thu, 7 Dec 2017 07:58:32 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Oh man&lt;/p&gt;</comment>
                            <comment id="16283099" author="githubbot" created="Fri, 8 Dec 2017 06:11:21 +0000"  >&lt;p&gt;Github user kaspersorensen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    There! I believe it&apos;s all fixed now. Took me some real digging around and eventually found that due to a bad `SelectItem.equals(Object)` method, the two scalar function SelectItems was reduced to one. Ended up adding a whole slew of unit tests to finally identify that this (and probably a few other tweaks) was the root cause.&lt;/p&gt;

&lt;p&gt;    If you&apos;d like, I can change the PR to be more minimalistic. But I kind of like every little tweak that was done TBH, so this here is my suggested patch.&lt;/p&gt;</comment>
                            <comment id="16283104" author="githubbot" created="Fri, 8 Dec 2017 06:13:23 +0000"  >&lt;p&gt;Github user kaspersorensen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171#discussion_r155709625&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171#discussion_r155709625&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: core/src/main/java/org/apache/metamodel/QueryPostprocessDataContext.java &amp;#8212;&lt;br/&gt;
    @@ -406,18 +409,15 @@ protected DataSet materializeTable(final Table table, final List&amp;lt;SelectItem&amp;gt; sel&lt;br/&gt;
         }&lt;/p&gt;

&lt;p&gt;         private List&amp;lt;SelectItem&amp;gt; buildWorkingSelectItems(List&amp;lt;SelectItem&amp;gt; selectItems, List&amp;lt;FilterItem&amp;gt; whereItems) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final List&amp;lt;SelectItem&amp;gt; primarySelectItems = new ArrayList&amp;lt;&amp;gt;(selectItems.size());&lt;/li&gt;
	&lt;li&gt;for (SelectItem selectItem : selectItems) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Just to say it ... This is one of the things that I am really pleased to get rid of. Because the `MetaModelHelper.getFiltered` and `MetaModelHelper.getSelection` methods are now taking care of scalar functions, stuff like this for-loop is no longer needed.&lt;/p&gt;</comment>
                            <comment id="16283105" author="githubbot" created="Fri, 8 Dec 2017 06:15:19 +0000"  >&lt;p&gt;Github user kaspersorensen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171#discussion_r155709789&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171#discussion_r155709789&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: core/src/main/java/org/apache/metamodel/data/SimpleDataSetHeader.java &amp;#8212;&lt;br/&gt;
    @@ -104,12 +104,6 @@ public int indexOf(SelectItem item) {&lt;br/&gt;
                 }&lt;br/&gt;
                 i++;&lt;br/&gt;
             }&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;/li&gt;
	&lt;li&gt;final boolean scalarFunctionQueried = item.getScalarFunction() != null;&lt;/li&gt;
	&lt;li&gt;if (scalarFunctionQueried) {&lt;/li&gt;
	&lt;li&gt;final SelectItem itemWithoutFunction = item.replaceFunction(null);&lt;/li&gt;
	&lt;li&gt;return indexOf(itemWithoutFunction);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Similarly, this special if-block for scalar functions was kind of a bad code smell that&apos;s now gone &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16283138" author="githubbot" created="Fri, 8 Dec 2017 07:04:53 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hasn&apos;t looked super thoroughly at it, but mostly LGTM.&lt;/p&gt;

&lt;p&gt;    A few thoughts: Not really a fan of MM helper getting bigger, when I think it should basically die in a fire, replaced with more specialised classes, but oh well. If it helps here, we can always refactor into a sensible model later if so decided.&lt;/p&gt;

&lt;p&gt;    There&apos;s a lot of changes to Mongo. Could it be that we need to do similar things to other databases that supports map-like queries? &lt;/p&gt;</comment>
                            <comment id="16284269" author="githubbot" created="Fri, 8 Dec 2017 21:42:36 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Okay, saw that wrong. Beyond the tests, there&apos;s actually NO changes in Mongo. Just you and your annoying formatter fingers &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16284277" author="githubbot" created="Fri, 8 Dec 2017 21:45:52 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    LGTM&lt;/p&gt;</comment>
                            <comment id="16284284" author="githubbot" created="Fri, 8 Dec 2017 21:49:48 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Works!&lt;/p&gt;</comment>
                            <comment id="16284307" author="githubbot" created="Fri, 8 Dec 2017 22:07:13 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16284308" author="githubbot" created="Fri, 8 Dec 2017 22:07:36 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/171&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Merged&lt;/p&gt;</comment>
                            <comment id="16287146" author="githubbot" created="Tue, 12 Dec 2017 05:35:29 +0000"  >&lt;p&gt;GitHub user kaspersorensen opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/174&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/174&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/METAMODEL-1173&quot; title=&quot;unable to select all columns with map used as predicate in where clause&quot; class=&quot;issue-link&quot; data-issue-key=&quot;METAMODEL-1173&quot;&gt;&lt;del&gt;METAMODEL-1173&lt;/del&gt;&lt;/a&gt;: Added CouchDB integration test in add. to MongoDB&lt;/p&gt;

&lt;p&gt;    Here you go @LosD &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; It&apos;s in deed a good idea to add test coverage for +1 database when it comes to &lt;a href=&quot;https://issues.apache.org/jira/browse/METAMODEL-1173&quot; title=&quot;unable to select all columns with map used as predicate in where clause&quot; class=&quot;issue-link&quot; data-issue-key=&quot;METAMODEL-1173&quot;&gt;&lt;del&gt;METAMODEL-1173&lt;/del&gt;&lt;/a&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/kaspersorensen/metamodel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/kaspersorensen/metamodel&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/METAMODEL-1173&quot; title=&quot;unable to select all columns with map used as predicate in where clause&quot; class=&quot;issue-link&quot; data-issue-key=&quot;METAMODEL-1173&quot;&gt;&lt;del&gt;METAMODEL-1173&lt;/del&gt;&lt;/a&gt;-integration-test-for-couchdb&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/174.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/174.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #174&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 8013a1e263577360456eeecb3be8a6a93688eb7f&lt;br/&gt;
Author: Kasper S&#248;rensen &amp;lt;i.am.kasper.sorensen@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-12-12T05:33:52Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/METAMODEL-1173&quot; title=&quot;unable to select all columns with map used as predicate in where clause&quot; class=&quot;issue-link&quot; data-issue-key=&quot;METAMODEL-1173&quot;&gt;&lt;del&gt;METAMODEL-1173&lt;/del&gt;&lt;/a&gt;: Added CouchDB integration test in add. to MongoDB&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16287922" author="githubbot" created="Tue, 12 Dec 2017 17:06:37 +0000"  >&lt;p&gt;Github user LosD commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/174&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/174&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Beautiful! Merging&lt;/p&gt;</comment>
                            <comment id="16287939" author="githubbot" created="Tue, 12 Dec 2017 17:17:21 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/174&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/174&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 48 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3nddr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>