<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:31:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[METAMODEL-187] ExcelDataContext uses more memory than it needs to for File-based resources.</title>
                <link>https://issues.apache.org/jira/browse/METAMODEL-187</link>
                <project id="12314523" key="METAMODEL">Apache MetaModel (Retired)</project>
                    <description>&lt;p&gt;ExcelDataContext uses the input stream from resources, even if it is a FileResource. This is pretty wasteful memory-wise, both according to &lt;a href=&quot;http://poi.apache.org/spreadsheet/quick-guide.html#FileInputStream&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://poi.apache.org/spreadsheet/quick-guide.html#FileInputStream&lt;/a&gt; and to own tests; I made a na&#239;ve change that uses the internal File of FileResources on a huge file. With InputStream, getting the defaultSchema used around 950 MB in average, while it used around 650 in average with the File based version (nothing scientific, just eyeballed in JVisualVM).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12862416">METAMODEL-187</key>
            <summary>ExcelDataContext uses more memory than it needs to for File-based resources.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kaspersor">Kasper S&#248;rensen</assignee>
                                    <reporter username="losd">Dennis Du Kr&#248;ger</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Sep 2015 13:49:48 +0000</created>
                <updated>Tue, 6 Oct 2015 21:05:53 +0000</updated>
                            <resolved>Tue, 6 Oct 2015 15:43:05 +0000</resolved>
                                                    <fixVersion>4.4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14734819" author="losd" created="Tue, 8 Sep 2015 13:51:36 +0000"  >&lt;p&gt;Attached JVisualVM screenshots.&lt;/p&gt;</comment>
                            <comment id="14942826" author="githubbot" created="Sun, 4 Oct 2015 22:03:35 +0000"  >&lt;p&gt;GitHub user kaspersorensen opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/56&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/56&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Metamodel 187/excel file another attempt&lt;/p&gt;

&lt;p&gt;    Here&apos;s my attempt at solving &lt;a href=&quot;https://issues.apache.org/jira/browse/METAMODEL-187&quot; title=&quot;ExcelDataContext uses more memory than it needs to for File-based resources.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;METAMODEL-187&quot;&gt;&lt;del&gt;METAMODEL-187&lt;/del&gt;&lt;/a&gt;. Heavily inspired by #49 but to get my head around it I had to start over and track resource usage/closing very closely.&lt;/p&gt;

&lt;p&gt;    I finally found the culprit (maybe one of more) and it was to close the workbook in ExcelUtils.writeWorkbook(...) before flushing the new contents to the resource.&lt;/p&gt;

&lt;p&gt;    I also updated POI since the errors given in the later version was giving a tiny bit more sense.&lt;/p&gt;

&lt;p&gt;    I also used an InMemoryResource instead of a temp file resource. I am working on the assumption that this can fit into memory easily in it&apos;s persisted form, but that the memory improvement we need to do is only on the unpacked form.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/kaspersorensen/metamodel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/kaspersorensen/metamodel&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/METAMODEL-187&quot; title=&quot;ExcelDataContext uses more memory than it needs to for File-based resources.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;METAMODEL-187&quot;&gt;&lt;del&gt;METAMODEL-187&lt;/del&gt;&lt;/a&gt;/excel-file-another-attempt&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/56.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/56.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #56&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit e6dca2049e9eb37a52b47f6e1cd257427e7dac1a&lt;br/&gt;
Author: Kasper S&#248;rensen &amp;lt;i.am.kasper.sorensen@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-10-04T21:43:46Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/METAMODEL-187&quot; title=&quot;ExcelDataContext uses more memory than it needs to for File-based resources.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;METAMODEL-187&quot;&gt;&lt;del&gt;METAMODEL-187&lt;/del&gt;&lt;/a&gt;: First attempt at solving this issue. Now I get a more&lt;br/&gt;
    regular JUnit error regarding a MALFORMED file instead of a JVM crash!&lt;/p&gt;

&lt;p&gt;commit cd41e173ad5f8861050862e07e69d10bac9be3d6&lt;br/&gt;
Author: Kasper S&#248;rensen &amp;lt;i.am.kasper.sorensen@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-10-04T21:59:47Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/METAMODEL-187&quot; title=&quot;ExcelDataContext uses more memory than it needs to for File-based resources.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;METAMODEL-187&quot;&gt;&lt;del&gt;METAMODEL-187&lt;/del&gt;&lt;/a&gt;: Fixed it! :-D&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14945018" author="githubbot" created="Tue, 6 Oct 2015 13:27:55 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/56&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/56&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14945801" author="githubbot" created="Tue, 6 Oct 2015 21:05:53 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/49&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/49&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12754633" name="Memory use File-based.png" size="57418" author="losd" created="Tue, 8 Sep 2015 13:51:36 +0000"/>
                            <attachment id="12754632" name="Memory use InputStream-based.png" size="57464" author="losd" created="Tue, 8 Sep 2015 13:51:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 6 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jw0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>