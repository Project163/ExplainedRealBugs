{"url":"https://api.github.com/repos/rollup/rollup/issues/430","repository_url":"https://api.github.com/repos/rollup/rollup","labels_url":"https://api.github.com/repos/rollup/rollup/issues/430/labels{/name}","comments_url":"https://api.github.com/repos/rollup/rollup/issues/430/comments","events_url":"https://api.github.com/repos/rollup/rollup/issues/430/events","html_url":"https://github.com/rollup/rollup/issues/430","id":125220536,"node_id":"MDU6SXNzdWUxMjUyMjA1MzY=","number":430,"title":"Failure exporting imported sub-modules","user":{"login":"brianmhunt","id":135528,"node_id":"MDQ6VXNlcjEzNTUyOA==","avatar_url":"https://avatars.githubusercontent.com/u/135528?v=4","gravatar_id":"","url":"https://api.github.com/users/brianmhunt","html_url":"https://github.com/brianmhunt","followers_url":"https://api.github.com/users/brianmhunt/followers","following_url":"https://api.github.com/users/brianmhunt/following{/other_user}","gists_url":"https://api.github.com/users/brianmhunt/gists{/gist_id}","starred_url":"https://api.github.com/users/brianmhunt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianmhunt/subscriptions","organizations_url":"https://api.github.com/users/brianmhunt/orgs","repos_url":"https://api.github.com/users/brianmhunt/repos","events_url":"https://api.github.com/users/brianmhunt/events{/privacy}","received_events_url":"https://api.github.com/users/brianmhunt/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":211689302,"node_id":"MDU6TGFiZWwyMTE2ODkzMDI=","url":"https://api.github.com/repos/rollup/rollup/labels/t%C2%B9%20%F0%9F%90%9E%20bug","name":"tÂ¹ ðŸž bug","color":"F44336","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2016-01-06T17:11:54Z","updated_at":"2016-12-20T21:42:36Z","closed_at":"2016-12-20T21:42:36Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Minimal Working Example\n\n_tl;dr_ [A minimal example exhibiting the problem is](http://rollupjs.org/#%7B%22options%22%3A%7B%22format%22%3A%22umd%22%2C%22moduleName%22%3A%22myBundle%22%2C%22globals%22%3A%7B%7D%2C%22moduleId%22%3A%22%22%7D%2C%22modules%22%3A%5B%7B%22name%22%3A%22main.js%22%2C%22code%22%3A%22import%20*%20as%20maths%20from%20'.%2Fmaths.js'%3B%5Cnexport%20%7Bmaths%7D%22%7D%2C%7B%22name%22%3A%22maths.js%22%2C%22code%22%3A%22import%20*%20as%20algebra%20from%20'.%2Falgebra.js'%5Cnexport%20%7Balgebra%7D%22%7D%2C%7B%22name%22%3A%22algebra.js%22%2C%22code%22%3A%22export%20var%20wink%20%3D%2012%22%7D%5D%7D):\n### entry.js\n\n``` javascript\nimport * as pkg from './package.js'\nexport {pkg}\n```\n### package.js\n\n``` javascript\nimport * as sub from './sub.js'\nexport {sub}\n```\n### sub.js\n\n``` javascript\nexport var wink = 10\n```\n\nRunning `rollup entry.js` gives:\n\n```\nvar wink = 10\n\nvar pkg = Object.freeze({\n    sub: null\n});\n\nexport { pkg };âŽ\n```\n\nWhere `pkg.sub` should be `Object.freeze({wink: wink})`\n\nRunning `rollup package.js` works as expected.\n\nFor some more context, see below.\n\n---\n\nIn the package [tko.utils](https://github.com/knockout/tko.utils), I have the following code:\n### spec/utilsDomBehaviors.js\n\n``` javascript\nimport * as utils from '../index.js'\n// ...\n```\n### index.js\n\n``` javascript\nimport './src/bind-shim.js'\nexport * from './src/array.js'\n// ...\nimport * as virtualElements from './src/dom/virtualElements.js'\nimport * as domData from './src/dom/data.js'\n\nexport {virtualElements, domData}\n```\n\nThis compiles as-expected when running `rollup index.js` (or the equivalent gulp task, `gulp make`).\n\nHowever, a problem exhibits when I run, from the project root (or from the `spec` directory, with the `entry` changed accordingly):\n\n``` javascript\n> rollup({ entry: 'spec/utilsDomBehaviors.js' }).then((b) => global.bundle = b)\n> console.log(bundle.generate({ format: 'es6' }).code)\n// ... Code!\n```\n\nThe `shim` imports fine, and the the `array` imports/exports as expected.\n\nHowever, resulting code does not contain either `virtualElements` or `domData`.   One would expect it to be an `Object.freeze...`.\n\nThe objects are referenced in the export part as:\n\n``` javascript\nvar utils = Object.freeze({\n  virtualElements: null,\n  domData: null$1,\n  // ...\n  }\n```\n\nThe problem also occurs when using `bundle.write`, and regardless of the output format.\n\nThis issue prevents the easy use of the `karma-rollup-preprocessor` plugin.\n","closed_by":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rollup/rollup/issues/430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rollup/rollup/issues/430/timeline","performed_via_github_app":null,"state_reason":"completed"}