[{"url":"https://api.github.com/repos/rollup/rollup/issues/comments/528915151","html_url":"https://github.com/rollup/rollup/issues/3092#issuecomment-528915151","issue_url":"https://api.github.com/repos/rollup/rollup/issues/3092","id":528915151,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODkxNTE1MQ==","user":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-06T16:06:19Z","updated_at":"2019-09-06T16:06:19Z","body":"Thanks for this issue. Yes the arrow function would be the easiest solution. At the moment, we try to maintain at least some ES5 compatibility, but I think an ES5 approach (which would probably introduce a new variable) would have its own problems. A compromise could be for now to check if the expression inside a dynamic import uses an unchecked `this` and only add an arrow function in these cases. This would still generate ES6 code, but only in the edge case scenario.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rollup/rollup/issues/comments/528915151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rollup/rollup/issues/comments/528926681","html_url":"https://github.com/rollup/rollup/issues/3092#issuecomment-528926681","issue_url":"https://api.github.com/repos/rollup/rollup/issues/3092","id":528926681,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODkyNjY4MQ==","user":{"login":"dnalborczyk","id":2903325,"node_id":"MDQ6VXNlcjI5MDMzMjU=","avatar_url":"https://avatars.githubusercontent.com/u/2903325?v=4","gravatar_id":"","url":"https://api.github.com/users/dnalborczyk","html_url":"https://github.com/dnalborczyk","followers_url":"https://api.github.com/users/dnalborczyk/followers","following_url":"https://api.github.com/users/dnalborczyk/following{/other_user}","gists_url":"https://api.github.com/users/dnalborczyk/gists{/gist_id}","starred_url":"https://api.github.com/users/dnalborczyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnalborczyk/subscriptions","organizations_url":"https://api.github.com/users/dnalborczyk/orgs","repos_url":"https://api.github.com/users/dnalborczyk/repos","events_url":"https://api.github.com/users/dnalborczyk/events{/privacy}","received_events_url":"https://api.github.com/users/dnalborczyk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-06T16:40:57Z","updated_at":"2019-09-06T16:52:26Z","body":"thank you @lukastaegert ! \r\n\r\nout of curiosity, why is `ES5` compatibility desired? `modules` itself (when bundled to esm) are part of `ES6` as well as `Promises`. For older browser support? I would think that it makes everything harder to implement and to maintain.\r\n\r\njust some food for thought if ES5 is desired rollup could possibly wrap the import expression in a function scope, and call it, roughly like this:\r\n```js\r\nconst dynImpExpr = function() {\r\n  return this.val\r\n}.bind(this)\r\n    \r\nreturn new Promise(function (res)  {\r\n  res(require(dynImpExpr()))\r\n})\r\n```\r\nbut like you mentioned, it might introduce its own problems.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rollup/rollup/issues/comments/528926681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dnalborczyk","id":2903325,"node_id":"MDQ6VXNlcjI5MDMzMjU=","avatar_url":"https://avatars.githubusercontent.com/u/2903325?v=4","gravatar_id":"","url":"https://api.github.com/users/dnalborczyk","html_url":"https://github.com/dnalborczyk","followers_url":"https://api.github.com/users/dnalborczyk/followers","following_url":"https://api.github.com/users/dnalborczyk/following{/other_user}","gists_url":"https://api.github.com/users/dnalborczyk/gists{/gist_id}","starred_url":"https://api.github.com/users/dnalborczyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnalborczyk/subscriptions","organizations_url":"https://api.github.com/users/dnalborczyk/orgs","repos_url":"https://api.github.com/users/dnalborczyk/repos","events_url":"https://api.github.com/users/dnalborczyk/events{/privacy}","received_events_url":"https://api.github.com/users/dnalborczyk/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2614950423,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjYxNDk1MDQyMw==","url":"https://api.github.com/repos/rollup/rollup/issues/events/2614950423","actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-09-06T16:40:58Z","performed_via_github_app":null},{"id":2614950424,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI2MTQ5NTA0MjQ=","url":"https://api.github.com/repos/rollup/rollup/issues/events/2614950424","actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-09-06T16:40:58Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rollup/rollup/issues/comments/528927321","html_url":"https://github.com/rollup/rollup/issues/3092#issuecomment-528927321","issue_url":"https://api.github.com/repos/rollup/rollup/issues/3092","id":528927321,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODkyNzMyMQ==","user":{"login":"dnalborczyk","id":2903325,"node_id":"MDQ6VXNlcjI5MDMzMjU=","avatar_url":"https://avatars.githubusercontent.com/u/2903325?v=4","gravatar_id":"","url":"https://api.github.com/users/dnalborczyk","html_url":"https://github.com/dnalborczyk","followers_url":"https://api.github.com/users/dnalborczyk/followers","following_url":"https://api.github.com/users/dnalborczyk/following{/other_user}","gists_url":"https://api.github.com/users/dnalborczyk/gists{/gist_id}","starred_url":"https://api.github.com/users/dnalborczyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnalborczyk/subscriptions","organizations_url":"https://api.github.com/users/dnalborczyk/orgs","repos_url":"https://api.github.com/users/dnalborczyk/repos","events_url":"https://api.github.com/users/dnalborczyk/events{/privacy}","received_events_url":"https://api.github.com/users/dnalborczyk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-06T16:42:37Z","updated_at":"2019-09-06T16:42:37Z","body":"quick workaround for anyone experiencing this issue until fixed:\r\n```js\r\nasync bar() {\r\n  const filename = this._filename\r\n  await import(filename)\r\n}\r\n```","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rollup/rollup/issues/comments/528927321/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dnalborczyk","id":2903325,"node_id":"MDQ6VXNlcjI5MDMzMjU=","avatar_url":"https://avatars.githubusercontent.com/u/2903325?v=4","gravatar_id":"","url":"https://api.github.com/users/dnalborczyk","html_url":"https://github.com/dnalborczyk","followers_url":"https://api.github.com/users/dnalborczyk/followers","following_url":"https://api.github.com/users/dnalborczyk/following{/other_user}","gists_url":"https://api.github.com/users/dnalborczyk/gists{/gist_id}","starred_url":"https://api.github.com/users/dnalborczyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnalborczyk/subscriptions","organizations_url":"https://api.github.com/users/dnalborczyk/orgs","repos_url":"https://api.github.com/users/dnalborczyk/repos","events_url":"https://api.github.com/users/dnalborczyk/events{/privacy}","received_events_url":"https://api.github.com/users/dnalborczyk/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3645929204,"node_id":"MDEyOkxhYmVsZWRFdmVudDM2NDU5MjkyMDQ=","url":"https://api.github.com/repos/rollup/rollup/issues/events/3645929204","actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-08-12T04:32:39Z","label":{"name":"t¬π üêû bug","color":"F44336"},"performed_via_github_app":null},{"id":5221325669,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDUyMjEzMjU2Njk=","url":"https://api.github.com/repos/rollup/rollup/issues/events/5221325669","actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"bb512170e05c2d1befe0fe45e66fad5f7cb248bc","commit_url":"https://api.github.com/repos/rollup/rollup/commits/bb512170e05c2d1befe0fe45e66fad5f7cb248bc","created_at":"2021-08-28T05:14:18Z","performed_via_github_app":null},{"id":5223997257,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDUyMjM5OTcyNTc=","url":"https://api.github.com/repos/rollup/rollup/issues/events/5223997257","actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ef537e1bb7bc89c88f013fad7569d0aaba0090ca","commit_url":"https://api.github.com/repos/rollup/rollup/commits/ef537e1bb7bc89c88f013fad7569d0aaba0090ca","created_at":"2021-08-30T05:08:48Z","performed_via_github_app":null},{"actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-31T04:31:09Z","updated_at":"2021-08-31T04:31:09Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rollup/rollup/issues/4215","repository_url":"https://api.github.com/repos/rollup/rollup","labels_url":"https://api.github.com/repos/rollup/rollup/issues/4215/labels{/name}","comments_url":"https://api.github.com/repos/rollup/rollup/issues/4215/comments","events_url":"https://api.github.com/repos/rollup/rollup/issues/4215/events","html_url":"https://github.com/rollup/rollup/pull/4215","id":982186114,"node_id":"MDExOlB1bGxSZXF1ZXN0NzIyMDA4MjY0","number":4215,"title":"Use ES2015 features in generated code snippets","user":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2021-08-29T19:42:09Z","updated_at":"2021-09-22T04:23:45Z","closed_at":"2021-09-22T04:23:44Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":35640229,"node_id":"MDEwOlJlcG9zaXRvcnkzNTY0MDIyOQ==","name":"rollup","full_name":"rollup/rollup","private":false,"owner":{"login":"rollup","id":12554859,"node_id":"MDEyOk9yZ2FuaXphdGlvbjEyNTU0ODU5","avatar_url":"https://avatars.githubusercontent.com/u/12554859?v=4","gravatar_id":"","url":"https://api.github.com/users/rollup","html_url":"https://github.com/rollup","followers_url":"https://api.github.com/users/rollup/followers","following_url":"https://api.github.com/users/rollup/following{/other_user}","gists_url":"https://api.github.com/users/rollup/gists{/gist_id}","starred_url":"https://api.github.com/users/rollup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rollup/subscriptions","organizations_url":"https://api.github.com/users/rollup/orgs","repos_url":"https://api.github.com/users/rollup/repos","events_url":"https://api.github.com/users/rollup/events{/privacy}","received_events_url":"https://api.github.com/users/rollup/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rollup/rollup","description":"Next-generation ES module bundler","fork":false,"url":"https://api.github.com/repos/rollup/rollup","forks_url":"https://api.github.com/repos/rollup/rollup/forks","keys_url":"https://api.github.com/repos/rollup/rollup/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rollup/rollup/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rollup/rollup/teams","hooks_url":"https://api.github.com/repos/rollup/rollup/hooks","issue_events_url":"https://api.github.com/repos/rollup/rollup/issues/events{/number}","events_url":"https://api.github.com/repos/rollup/rollup/events","assignees_url":"https://api.github.com/repos/rollup/rollup/assignees{/user}","branches_url":"https://api.github.com/repos/rollup/rollup/branches{/branch}","tags_url":"https://api.github.com/repos/rollup/rollup/tags","blobs_url":"https://api.github.com/repos/rollup/rollup/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rollup/rollup/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rollup/rollup/git/refs{/sha}","trees_url":"https://api.github.com/repos/rollup/rollup/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rollup/rollup/statuses/{sha}","languages_url":"https://api.github.com/repos/rollup/rollup/languages","stargazers_url":"https://api.github.com/repos/rollup/rollup/stargazers","contributors_url":"https://api.github.com/repos/rollup/rollup/contributors","subscribers_url":"https://api.github.com/repos/rollup/rollup/subscribers","subscription_url":"https://api.github.com/repos/rollup/rollup/subscription","commits_url":"https://api.github.com/repos/rollup/rollup/commits{/sha}","git_commits_url":"https://api.github.com/repos/rollup/rollup/git/commits{/sha}","comments_url":"https://api.github.com/repos/rollup/rollup/comments{/number}","issue_comment_url":"https://api.github.com/repos/rollup/rollup/issues/comments{/number}","contents_url":"https://api.github.com/repos/rollup/rollup/contents/{+path}","compare_url":"https://api.github.com/repos/rollup/rollup/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rollup/rollup/merges","archive_url":"https://api.github.com/repos/rollup/rollup/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rollup/rollup/downloads","issues_url":"https://api.github.com/repos/rollup/rollup/issues{/number}","pulls_url":"https://api.github.com/repos/rollup/rollup/pulls{/number}","milestones_url":"https://api.github.com/repos/rollup/rollup/milestones{/number}","notifications_url":"https://api.github.com/repos/rollup/rollup/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rollup/rollup/labels{/name}","releases_url":"https://api.github.com/repos/rollup/rollup/releases{/id}","deployments_url":"https://api.github.com/repos/rollup/rollup/deployments","created_at":"2015-05-14T22:26:28Z","updated_at":"2025-11-09T07:58:19Z","pushed_at":"2025-11-08T17:11:17Z","git_url":"git://github.com/rollup/rollup.git","ssh_url":"git@github.com:rollup/rollup.git","clone_url":"https://github.com/rollup/rollup.git","svn_url":"https://github.com/rollup/rollup","homepage":"https://rollupjs.org","size":32539,"stargazers_count":26104,"watchers_count":26104,"language":"JavaScript","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":1649,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":602,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1649,"open_issues":602,"watchers":26104,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/rollup/rollup/pulls/4215","html_url":"https://github.com/rollup/rollup/pull/4215","diff_url":"https://github.com/rollup/rollup/pull/4215.diff","patch_url":"https://github.com/rollup/rollup/pull/4215.patch","merged_at":"2021-09-22T04:23:43Z"},"body":"<!--\r\n  ‚ö°Ô∏è katchow! We ‚ù§Ô∏è Pull Requests!\r\n\r\n  If you remove or skip this template, you'll make the üêº sad and the mighty god\r\n  of Github will appear and pile-drive the close button from a great height\r\n  while making animal noises.\r\n\r\n  Pull Request Requirements:\r\n  * Please include tests to illustrate the problem this PR resolves.\r\n  * Please lint your changes by running `npm run lint` before creating a PR.\r\n  * Please update the documentation in `/docs` where necessary\r\n\r\n  Please place an x (no spaces - [x]) in all [ ] that apply.\r\n-->\r\n\r\nThis PR contains:\r\n\r\n- [x] bugfix\r\n- [x] feature\r\n- [ ] refactor\r\n- [x] documentation\r\n- [ ] other\r\n\r\nAre tests included?\r\n\r\n- [x] yes (_bugfixes and features will not be merged without tests_)\r\n- [ ] no\r\n\r\nBreaking Changes?\r\n\r\n- [ ] yes (_breaking changes will not be merged unless absolutely necessary_)\r\n- [x] no\r\n\r\nList any relevant issue numbers:\r\nResolves #3784 \r\nResolves #3092 \r\nResolves #2591\r\n\r\n<!--\r\nIf this PR resolves any issues, list them as\r\n\r\n  resolves #1234\r\n\r\nwhere 1234 is the issue number. This will help us with house-keeping as Github will automatically add a note to those issues stating that a potential fix exists. Once the PR is merged, Github will automatically close those issues.\r\n\r\nIf an issue is only solved partially or is relevant in some other way, just list the number without \"resolves\".\r\n-->\r\n\r\n### Description\r\nThis will finally support ES6 features like arrow functions in generated Rollup code. For now, this is completely opt-in, see below. Furthermore, this fixes some long-standing bugs and adds a new internal concepts of \"code-snippets\", small functions to generate parts of the code respecting the new options.\r\n\r\nAs it turns out, blindly switching to ES6 features is not always good idea, which is why most specifically, the `output.generatedCode.arrowFunctions` option will leave larger IIFE functions in place to avoid double parsing in Chrome (see the link in the documentation below for the reasoning). This is also linked to a hidden feature in this PR\r\n\r\n#### Improved AMD and SystemJS wrapper performance\r\nFollowing https://v8.dev/blog/preparser#pife, immediately (directly or indirectly) invoked functions in AMD and SystemJS wrappers now receive the same treatment as their counterparts in UMD wrappers in that they are wrapped in parentheses. They are also never written as arrow functions as I could confirm that the same optimization does not apply to those.\r\n\r\n#### Improved ES3 compatibility\r\nWhile ES3 compatibility is generally not a goal of Rollup, we were already spending quite a bit of effort in quoting reserved words that are used as properties. This PR aims to complete this effort by quoting them in many more (all?) places that are controlled by Rollup. Props quoting can now be turned off via the `output.generatedCode. reservedNamesAsProps` option.\r\n\r\nFor the next major version, I would consider defaulting this option to `true`.\r\n\r\n#### Improved ES5 compatibility + live-bindings for merged namespaces\r\n`Object.assign` is no longer used to merge namespaces. Instead, a custom helper function is injected, which not only improves compatibility but also retains live-bindings when internal and external or synthetic namespaces are reexported from the same file.\r\n\r\n#### Preserve \"this\"-context for AMD/CommonJS dynamic imports\r\nPreviously, dynamic imports containing a \"this\" in their argument would [not preserve the context](https://rollupjs.org/repl/?version=2.56.3&shareable=JTdCJTIybW9kdWxlcyUyMiUzQSU1QiU3QiUyMm5hbWUlMjIlM0ElMjJtYWluLmpzJTIyJTJDJTIyY29kZSUyMiUzQSUyMmZ1bmN0aW9uJTIwaW1wb3J0V2l0aENvbnRleHQoKSUyMCU3QiU1Q24lNUN0aW1wb3J0KHRoaXMpLnRoZW4oY29uc29sZS5sb2cpJTNCJTVDbiU3RCU1Q24lNUNuaW1wb3J0V2l0aENvbnRleHQuY2FsbCgnZXh0ZXJuYWwnKSUzQiUyMiUyQyUyMmlzRW50cnklMjIlM0F0cnVlJTdEJTVEJTJDJTIyb3B0aW9ucyUyMiUzQSU3QiUyMmZvcm1hdCUyMiUzQSUyMmNqcyUyMiUyQyUyMm5hbWUlMjIlM0ElMjJteUJ1bmRsZSUyMiUyQyUyMmFtZCUyMiUzQSU3QiUyMmlkJTIyJTNBJTIyJTIyJTdEJTJDJTIyZ2xvYmFscyUyMiUzQSU3QiU3RCU3RCUyQyUyMmV4YW1wbGUlMjIlM0FudWxsJTdE). This is fixed now in two ways:\r\n* If arrow functions are allowed, we use an arrow function in the corresponding place (this was one of the drivers to add arrow functions)\r\n* Otherwise we [use an IIFE](https://rollupjs.org/repl/?pr=4215&shareable=JTdCJTIybW9kdWxlcyUyMiUzQSU1QiU3QiUyMm5hbWUlMjIlM0ElMjJtYWluLmpzJTIyJTJDJTIyY29kZSUyMiUzQSUyMmZ1bmN0aW9uJTIwaW1wb3J0V2l0aENvbnRleHQoKSUyMCU3QiU1Q24lNUN0aW1wb3J0KHRoaXMpLnRoZW4oY29uc29sZS5sb2cpJTNCJTVDbiU3RCU1Q24lNUNuaW1wb3J0V2l0aENvbnRleHQuY2FsbCgnZXh0ZXJuYWwnKSUzQiUyMiUyQyUyMmlzRW50cnklMjIlM0F0cnVlJTdEJTVEJTJDJTIyb3B0aW9ucyUyMiUzQSU3QiUyMmZvcm1hdCUyMiUzQSUyMmNqcyUyMiUyQyUyMm5hbWUlMjIlM0ElMjJteUJ1bmRsZSUyMiUyQyUyMmFtZCUyMiUzQSU3QiUyMmlkJTIyJTNBJTIyJTIyJTdEJTJDJTIyZ2xvYmFscyUyMiUzQSU3QiU3RCU3RCUyQyUyMmV4YW1wbGUlMjIlM0FudWxsJTdE) to retain context for fully dynamic imports (no checking is done if a \"this\" is used, though):\r\n  ```js\r\n  (function (t) { return Promise.resolve().then(function () { return /*#__PURE__*/_interopNamespace(require(t)); }); })(this);\r\n  ```\r\n\r\n#### Fix shimMissingExports for internally used exports\r\n\r\nAs it turns out, shimMissingExports would fail to add the definition for the shim variable even though it is referenced for internally used imports.\r\n\r\n#### New feature (copied from documentation): output.generatedCode\r\nTo get a feeling for what has changed, take a look at the expected test output here: https://github.com/rollup/rollup/tree/output-generated-code/test/form/samples/generated-code\r\n\r\nType: `\"es5\" | \"es2015\" | { arrowFunctions?: boolean, constBindings?: boolean, objectShorthand?: boolean, preset?: \"es5\" | \"es2015\", reservedNamesAsProps?: boolean }`<br> CLI: `--generatedCode <preset>`<br> Default: `\"es5\"`\r\n\r\nWhich language features Rollup can safely use in generated code. This will not transpile any user code but only change the code Rollup uses in wrappers and helpers. You may choose one of several presets:\r\n\r\n- `\"es5\"`: Do not use ES2015+ features like arrow functions, but do not quote reserved names used as props.\r\n- `\"es2015\"`: Use any JavaScript features up to ES2015.\r\n\r\n**output.generatedCode.arrowFunctions**<br> Type: `boolean`<br> CLI: `--generatedCode.arrowFunctions`/`--no-generatedCode.arrowFunctions`<br> Default: `false`\r\n\r\nWhether to use arrow functions for auto-generated code snippets. Note that in certain places like module wrappers, Rollup will keep using regular functions wrapped in parentheses as in some JavaScript engines, these will provide [noticeably better performance](https://v8.dev/blog/preparser#pife).\r\n\r\n  **output.generatedCode.constBindings**<br> Type: `boolean`<br> CLI: `--generatedCode.constBindings`/`--no-generatedCode.constBindings`<br> Default: `false`\r\n\r\nThis will use `const` instead of `var` in certain places and helper functions. Depending on the engine, this can provide [marginally better performance](https://benediktmeurer.de/2017/06/29/javascript-optimization-patterns-part2) in optimized machine code. It will also allow Rollup to generate more efficient helpers due to block scoping.\r\n\r\n```js\r\n// input\r\nexport * from 'external';\r\n\r\n// cjs output with constBindings: false\r\nvar external = require('external');\r\n\r\nObject.keys(external).forEach(function (k) {\r\n  if (k !== 'default' && !exports.hasOwnProperty(k))\r\n    Object.defineProperty(exports, k, {\r\n      enumerable: true,\r\n      get: function () {\r\n        return external[k];\r\n      }\r\n    });\r\n});\r\n\r\n// cjs output with constBindings: true\r\nconst external = require('external');\r\n\r\nfor (const k in external) {\r\n  if (k !== 'default' && !exports.hasOwnProperty(k))\r\n    Object.defineProperty(exports, k, {\r\n      enumerable: true,\r\n      get: function () {\r\n        return external[k];\r\n      }\r\n    });\r\n}\r\n```\r\n\r\n**output.generatedCode.objectShorthand**<br> Type: `boolean`<br> CLI: `--generatedCode.objectShorthand`/`--no-generatedCode.objectShorthand`<br> Default: `false`\r\n\r\nAllows the use of shorthand notation in objects when the property name matches the value.\r\n\r\n```javascript\r\n// input\r\nconst foo = 1;\r\nexport { foo, foo as bar };\r\n\r\n// system output with objectShorthand: false\r\nSystem.register('bundle', [], function (exports) {\r\n  'use strict';\r\n  return {\r\n    execute: function () {\r\n      const foo = 1;\r\n      exports({ foo: foo, bar: foo });\r\n    }\r\n  };\r\n});\r\n\r\n// system output with objectShorthand: true\r\nSystem.register('bundle', [], function (exports) {\r\n  'use strict';\r\n  return {\r\n    execute: function () {\r\n      const foo = 1;\r\n      exports({ foo, bar: foo });\r\n    }\r\n  };\r\n});\r\n```\r\n\r\n**output.generatedCode.preset**<br> Type: `\"es5\" | \"es2015\"`<br> CLI: `--generatedCode <value>`\r\n\r\nAllows choosing one of the presets listed above while overriding some options.\r\n\r\n```js\r\nexport default {\r\n  // ...\r\n  output: {\r\n    generatedCode: {\r\n      preset: 'es2015',\r\n      arrowFunctions: false\r\n    }\r\n    // ...\r\n  }\r\n};\r\n```\r\n\r\n**output.generatedCode.reservedNamesAsProps**<br> Type: `boolean`<br> CLI: `--generatedCode.reservedNamesAsProps`/`--no-generatedCode.reservedNamesAsProps`<br> Default: `false`\r\n\r\nDetermine whether reserved words like \"default\" can be used as prop names without using quotes.\r\n\r\n```javascript\r\n// input\r\nconst foo = null;\r\nexport { foo as void };\r\n\r\n// cjs output with reservedNamesAsProps: false\r\nObject.defineProperty(exports, '__esModule', { value: true });\r\n\r\nconst foo = null;\r\n\r\nexports['void'] = foo;\r\n\r\n// cjs output with reservedNamesAsProps: true\r\nObject.defineProperty(exports, '__esModule', { value: true });\r\n\r\nconst foo = null;\r\n\r\nexports.void = foo;\r\n```\r\n\r\n#### (Soft-) deprecation of preferConst\r\n`output.generatedCode.constBIndings` should be used instead.\r\n\r\n#### Use common helper for more invalid option errors\r\nAn effect of this is that all invalid option errors now contain a link to the corresponding documentation.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/rollup/rollup/issues/4215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rollup/rollup/issues/4215/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":5263489597,"node_id":"REFE_lADOAh_Tpc4dJ9SuzwAAAAE5uno9","url":"https://api.github.com/repos/rollup/rollup/issues/events/5263489597","actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"431bd289c49fe61f16e980dd101baff348e68226","commit_url":"https://api.github.com/repos/rollup/rollup/commits/431bd289c49fe61f16e980dd101baff348e68226","created_at":"2021-09-07T05:39:04Z","performed_via_github_app":null},{"id":5322659993,"node_id":"REFE_lADOAh_Tpc4dJ9SuzwAAAAE9QViZ","url":"https://api.github.com/repos/rollup/rollup/issues/events/5322659993","actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"1bd680ccd3c885fe5c4ff003066073348598e8ef","commit_url":"https://api.github.com/repos/rollup/rollup/commits/1bd680ccd3c885fe5c4ff003066073348598e8ef","created_at":"2021-09-18T07:58:12Z","performed_via_github_app":null},{"id":5324179776,"node_id":"REFE_lADOAh_Tpc4dJ9SuzwAAAAE9WIlA","url":"https://api.github.com/repos/rollup/rollup/issues/events/5324179776","actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"051ed0b321c81e854a2fed07d3e2741a5c321aa8","commit_url":"https://api.github.com/repos/rollup/rollup/commits/051ed0b321c81e854a2fed07d3e2741a5c321aa8","created_at":"2021-09-19T05:00:30Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rollup/rollup/issues/comments/922416983","html_url":"https://github.com/rollup/rollup/issues/3092#issuecomment-922416983","issue_url":"https://api.github.com/repos/rollup/rollup/issues/3092","id":922416983,"node_id":"IC_kwDOAh_Tpc42-vdX","user":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-19T05:16:49Z","updated_at":"2021-09-19T05:16:49Z","body":"This will be resolved in #4215 at last","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rollup/rollup/issues/comments/922416983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5340329561,"node_id":"CE_lADOAh_Tpc4dJ9SuzwAAAAE-TvZZ","url":"https://api.github.com/repos/rollup/rollup/issues/events/5340329561","actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-09-22T04:23:44Z","state_reason":null,"performed_via_github_app":null},{"id":5340329668,"node_id":"REFE_lADOAh_Tpc4dJ9SuzwAAAAE-TvbE","url":"https://api.github.com/repos/rollup/rollup/issues/events/5340329668","actor":{"login":"lukastaegert","id":12949268,"node_id":"MDQ6VXNlcjEyOTQ5MjY4","avatar_url":"https://avatars.githubusercontent.com/u/12949268?v=4","gravatar_id":"","url":"https://api.github.com/users/lukastaegert","html_url":"https://github.com/lukastaegert","followers_url":"https://api.github.com/users/lukastaegert/followers","following_url":"https://api.github.com/users/lukastaegert/following{/other_user}","gists_url":"https://api.github.com/users/lukastaegert/gists{/gist_id}","starred_url":"https://api.github.com/users/lukastaegert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukastaegert/subscriptions","organizations_url":"https://api.github.com/users/lukastaegert/orgs","repos_url":"https://api.github.com/users/lukastaegert/repos","events_url":"https://api.github.com/users/lukastaegert/events{/privacy}","received_events_url":"https://api.github.com/users/lukastaegert/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ca86df280288656c66a948e122c36ccee7e06aca","commit_url":"https://api.github.com/repos/rollup/rollup/commits/ca86df280288656c66a948e122c36ccee7e06aca","created_at":"2021-09-22T04:23:46Z","performed_via_github_app":null}]