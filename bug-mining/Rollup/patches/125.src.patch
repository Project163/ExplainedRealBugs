diff --git a/src/ast/scopes/ModuleScope.ts b/src/ast/scopes/ModuleScope.ts
index 3cbb8f2a0..8427d0765 100644
--- a/src/ast/scopes/ModuleScope.ts
+++ b/src/ast/scopes/ModuleScope.ts
@@ -40,7 +40,7 @@ export default class ModuleScope extends Scope {
 				localNames.add(declaration.getName());
 			};
 
-			(<Module>specifier.module).getExports().forEach(name => {
+			(<Module>specifier.module).getAllExports().forEach(name => {
 				addDeclaration(specifier.module.traceExport(name));
 			});
 
diff --git a/src/ast/scopes/Scope.ts b/src/ast/scopes/Scope.ts
index 6a13cee44..fd0d5948e 100644
--- a/src/ast/scopes/Scope.ts
+++ b/src/ast/scopes/Scope.ts
@@ -86,7 +86,8 @@ export default class Scope {
 			const declaration = this.variables[key];
 
 			// we can disregard exports.foo etc
-			if (declaration.exportName && declaration.isReassigned) return;
+			if (declaration.exportName && declaration.isReassigned)
+				return;
 
 			let name = declaration.getName(true);
 
diff --git a/test/form/samples/reexport-star-deshadow/_config.js b/test/form/samples/reexport-star-deshadow/_config.js
index 565866d8d..b53b44402 100644
--- a/test/form/samples/reexport-star-deshadow/_config.js
+++ b/test/form/samples/reexport-star-deshadow/_config.js
@@ -3,6 +3,8 @@ const assert = require( 'assert' );
 module.exports = {
 	description: 'Star reexports scope deshadowing',
 	options: {
-		name: 'myBundle'
+		output: {
+			name: 'myBundle'
+		}
 	}
 };
diff --git a/test/form/samples/reexport-star-deshadow/_expected/es.js b/test/form/samples/reexport-star-deshadow/_expected/es.js
index 4953eb6e3..6193e1968 100644
--- a/test/form/samples/reexport-star-deshadow/_expected/es.js
+++ b/test/form/samples/reexport-star-deshadow/_expected/es.js
@@ -1 +1,7 @@
-export * from 'external';
+function foo() { return true; }
+
+var baz = function foo$$1() {
+	return foo();
+};
+
+console.log(baz());
diff --git a/test/form/samples/reexport-star-deshadow/_expected/iife.js b/test/form/samples/reexport-star-deshadow/_expected/iife.js
index 698ec93c6..7fa5b1711 100644
--- a/test/form/samples/reexport-star-deshadow/_expected/iife.js
+++ b/test/form/samples/reexport-star-deshadow/_expected/iife.js
@@ -1,10 +1,12 @@
-var myBundle = (function (exports,external) {
+(function () {
 	'use strict';
 
+	function foo() { return true; }
 
+	var baz = function foo$$1() {
+		return foo();
+	};
 
-	Object.keys(external).forEach(function (key) { exports[key] = external[key]; });
+	console.log(baz());
 
-	return exports;
-
-}({},external));
+}());
diff --git a/test/form/samples/reexport-star-deshadow/_expected/umd.js b/test/form/samples/reexport-star-deshadow/_expected/umd.js
index c47371668..d2c444920 100644
--- a/test/form/samples/reexport-star-deshadow/_expected/umd.js
+++ b/test/form/samples/reexport-star-deshadow/_expected/umd.js
@@ -1,11 +1,15 @@
 (function (global, factory) {
-	typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('external')) :
-	typeof define === 'function' && define.amd ? define(['exports', 'external'], factory) :
-	(factory((global.myBundle = {}),global.external));
-}(this, (function (exports,external) { 'use strict';
+	typeof exports === 'object' && typeof module !== 'undefined' ? factory() :
+	typeof define === 'function' && define.amd ? define(factory) :
+	(factory());
+}(this, (function () { 'use strict';
 
-	Object.keys(external).forEach(function (key) { exports[key] = external[key]; });
+	function foo() { return true; }
 
-	Object.defineProperty(exports, '__esModule', { value: true });
+	var baz = function foo$$1() {
+		return foo();
+	};
+
+	console.log(baz());
 
 })));
