diff --git a/bin/src/run/deprecateOptions.js b/bin/src/run/deprecateOptions.js
new file mode 100644
index 000000000..7ff5b4fe0
--- /dev/null
+++ b/bin/src/run/deprecateOptions.js
@@ -0,0 +1,76 @@
+export default function deprecateOptions ( options ) {
+	const deprecations = [];
+
+	if ( options.entry ) {
+		deprecations.push( { old: 'options.entry', new: 'options.input' } );
+		options.input = options.entry; // don't delete, as plugins sometimes depend on this...
+	}
+
+	if ( options.moduleName ) {
+		deprecations.push( { old: 'options.moduleName', new: 'options.name' } );
+		options.name = options.moduleName;
+		delete options.moduleName;
+	}
+
+	if ( options.sourceMap ) {
+		deprecations.push( { old: 'options.sourceMap', new: 'options.sourcemap' } );
+		options.sourcemap = options.sourceMap;
+		delete options.sourceMap;
+	}
+
+	if ( options.sourceMapFile ) {
+		deprecations.push( { old: 'options.sourceMapFile', new: 'options.sourcemapFile' } );
+		options.sourcemapFile = options.sourceMapFile;
+		delete options.sourceMapFile;
+	}
+
+	if ( options.useStrict ) {
+		deprecations.push( { old: 'options.useStrict', new: 'options.strict' } );
+		options.strict = options.useStrict;
+		delete options.useStrict;
+	}
+
+	if ( options.targets ) {
+		deprecations.push( { old: 'options.targets', new: 'options.output' } );
+		options.output = options.targets;
+		delete options.targets;
+
+		let deprecatedDest = false;
+		options.output.forEach( output => {
+			if ( output.dest ) {
+				if ( !deprecatedDest ) {
+					deprecations.push( { old: 'output.dest', new: 'output.file' } );
+					deprecatedDest = true;
+				}
+				output.file = output.dest;
+				delete output.dest;
+			}
+		} );
+	} else if ( options.dest ) {
+		deprecations.push( { old: 'options.dest', new: 'options.output.file' } );
+		options.output = {
+			file: options.dest,
+			format: options.format
+		};
+		delete options.dest;
+	}
+
+	if ( options.format ) {
+		if ( !options.output ) options.output = { format: options.format };
+		deprecations.push( { old: 'options.format', new: 'options.output.format' } );
+		delete options.format;
+	}
+
+	if ( options.pureExternalModules ) {
+		deprecations.push( { old: 'options.pureExternalModules', new: 'options.treeshake.pureExternalModules' } );
+		if ( options.treeshake === undefined ) {
+			options.treeshake = {};
+		}
+		if ( options.treeshake ) {
+			options.treeshake.pureExternalModules = options.pureExternalModules;
+		}
+		delete options.pureExternalModules;
+	}
+
+	return deprecations;
+}
diff --git a/bin/src/run/mergeOptions.js b/bin/src/run/mergeOptions.js
index a9ac8b49a..881c8bf2f 100644
--- a/bin/src/run/mergeOptions.js
+++ b/bin/src/run/mergeOptions.js
@@ -1,18 +1,38 @@
 import ensureArray from '../../../src/utils/ensureArray.js';
-import deprecateOptions from '../../../src/utils/deprecateOptions.js';
+import deprecateOptions from './deprecateOptions.js';
+
+function normalizeObjectOptionValue ( optionValue ) {
+	if ( !optionValue ) {
+		return optionValue;
+	}
+	if ( typeof optionValue !== 'object' ) {
+		return {};
+	}
+	return optionValue;
+}
 
 export default function mergeOptions ( config, command ) {
-	// deprecations... TODO
 	const deprecations = deprecate( config, command );
 
-	function getOption(name) {
-		return command[name] !== undefined ? command[name] : config[name];
+	function getOption ( name ) {
+		return command[ name ] !== undefined ? command[ name ] : config[ name ];
+	}
+
+	function getObjectOption ( name ) {
+		const commandOption = normalizeObjectOptionValue( command[ name ] );
+		const configOption = normalizeObjectOptionValue( config[ name ] );
+		if ( commandOption !== undefined ) {
+			return commandOption && configOption
+				? Object.assign( {}, configOption, commandOption )
+				: commandOption;
+		}
+		return configOption;
 	}
 
 	const inputOptions = {
-		input: getOption('input'),
-		legacy: getOption('legacy'),
-		treeshake: getOption('treeshake'),
+		input: getOption( 'input' ),
+		legacy: getOption( 'legacy' ),
+		treeshake: getObjectOption( 'treeshake' ),
 		acorn: config.acorn,
 		context: config.context,
 		moduleContext: config.moduleContext,
@@ -32,13 +52,13 @@ export default function mergeOptions ( config, command ) {
 
 		command.globals.split( ',' ).forEach( str => {
 			const names = str.split( ':' );
-			globals[ names[0] ] = names[1];
+			globals[ names[ 0 ] ] = names[ 1 ];
 
 			// Add missing Module IDs to external.
-			if ( commandExternal.indexOf( names[0] ) === -1 ) {
-				commandExternal.push( names[0] );
+			if ( commandExternal.indexOf( names[ 0 ] ) === -1 ) {
+				commandExternal.push( names[ 0 ] );
 			}
-		});
+		} );
 
 		command.globals = globals;
 	}
@@ -51,79 +71,79 @@ export default function mergeOptions ( config, command ) {
 		inputOptions.external = ( configExternal || [] ).concat( commandExternal );
 	}
 
-	if (command.silent) {
+	if ( command.silent ) {
 		inputOptions.onwarn = () => {};
 	}
 
 	const baseOutputOptions = {
-		extend: getOption('extend'),
-		amd: Object.assign({}, config.amd, command.amd),
-		banner: getOption('banner'),
-		footer: getOption('footer'),
-		intro: getOption('intro'),
-		outro: getOption('outro'),
-		sourcemap: getOption('sourcemap'),
-		name: getOption('name'),
-		globals: getOption('globals'),
-		interop: getOption('interop'),
-		legacy: getOption('legacy'),
-		freeze: getOption('freeze'),
-		indent: getOption('indent'),
-		strict: getOption('strict'),
-		noConflict: getOption('noConflict'),
-		paths: getOption('paths')
+		extend: getOption( 'extend' ),
+		amd: Object.assign( {}, config.amd, command.amd ),
+		banner: getOption( 'banner' ),
+		footer: getOption( 'footer' ),
+		intro: getOption( 'intro' ),
+		outro: getOption( 'outro' ),
+		sourcemap: getOption( 'sourcemap' ),
+		name: getOption( 'name' ),
+		globals: getOption( 'globals' ),
+		interop: getOption( 'interop' ),
+		legacy: getOption( 'legacy' ),
+		freeze: getOption( 'freeze' ),
+		indent: getOption( 'indent' ),
+		strict: getOption( 'strict' ),
+		noConflict: getOption( 'noConflict' ),
+		paths: getOption( 'paths' )
 	};
 
 	let mergedOutputOptions;
-	if (Array.isArray(config.output)) {
-		mergedOutputOptions = config.output.map((output) => Object.assign({}, output, command.output));
-	} else if (config.output && command.output) {
-		mergedOutputOptions = [Object.assign({}, config.output, command.output)];
+	if ( Array.isArray( config.output ) ) {
+		mergedOutputOptions = config.output.map( ( output ) => Object.assign( {}, output, command.output ) );
+	} else if ( config.output && command.output ) {
+		mergedOutputOptions = [ Object.assign( {}, config.output, command.output ) ];
 	} else {
 		mergedOutputOptions = (command.output || config.output) ?
-			ensureArray(command.output || config.output) :
-			[{
+			ensureArray( command.output || config.output ) :
+			[ {
 				file: command.output ? command.output.file : null,
 				format: command.output ? command.output.format : null
-			}];
+			} ];
 	}
 
-	const outputOptions = mergedOutputOptions.map(output => {
-		return Object.assign({}, baseOutputOptions, output);
-	});
+	const outputOptions = mergedOutputOptions.map( output => {
+		return Object.assign( {}, baseOutputOptions, output );
+	} );
 
 	return { inputOptions, outputOptions, deprecations };
 }
 
-function deprecate( config, command ) {
+function deprecate ( config, command ) {
 	const deprecations = [];
 
 	// CLI
 	if ( command.id ) {
-		deprecations.push({
+		deprecations.push( {
 			old: '-u/--id',
 			new: '--amd.id'
-		});
+		} );
 		(command.amd || (command.amd = {})).id = command.id;
 	}
 
 	if ( typeof command.output === 'string' ) {
-		deprecations.push({
+		deprecations.push( {
 			old: '--output',
 			new: '--output.file'
-		});
+		} );
 		command.output = { file: command.output };
 	}
 
 	if ( command.format ) {
-		deprecations.push({
+		deprecations.push( {
 			old: '--format',
 			new: '--output.format'
-		});
+		} );
 		(command.output || (command.output = {})).format = command.format;
 	}
 
 	// config file
-	deprecations.push(...deprecateOptions(config));
+	deprecations.push( ...deprecateOptions( config ) );
 	return deprecations;
 }
diff --git a/src/Bundle.js b/src/Bundle.js
index 467915488..0e186012f 100644
--- a/src/Bundle.js
+++ b/src/Bundle.js
@@ -45,25 +45,26 @@ export default class Bundle {
 		this.entryId = null;
 		this.entryModule = null;
 
-		// TODO Lukas make sure no-treeshake is mutually exclusive with nested treeshaking options
-		// TODO Lukas move pureExternalModules into treeshaking options and deprecate in other place
-		// TODO Lukas create CLI tests
 		this.treeshake = options.treeshake !== false;
 		if ( this.treeshake ) {
 			this.treeshakingOptions = {
 				propertyReadSideEffects: options.treeshake
 					? options.treeshake.propertyReadSideEffects !== false
-					: true
+					: true,
+				pureExternalModules: options.treeshake
+					? options.treeshake.pureExternalModules
+					: false
 			};
-		}
-
-		if ( options.pureExternalModules === true ) {
-			this.isPureExternalModule = () => true;
-		} else if ( typeof options.pureExternalModules === 'function' ) {
-			this.isPureExternalModule = options.pureExternalModules;
-		} else if ( Array.isArray( options.pureExternalModules ) ) {
-			const pureExternalModules = new Set( options.pureExternalModules );
-			this.isPureExternalModule = id => pureExternalModules.has( id );
+			if ( this.treeshakingOptions.pureExternalModules === true ) {
+				this.isPureExternalModule = () => true;
+			} else if ( typeof this.treeshakingOptions.pureExternalModules === 'function' ) {
+				this.isPureExternalModule = this.treeshakingOptions.pureExternalModules;
+			} else if ( Array.isArray( this.treeshakingOptions.pureExternalModules ) ) {
+				const pureExternalModules = new Set( this.treeshakingOptions.pureExternalModules );
+				this.isPureExternalModule = id => pureExternalModules.has( id );
+			} else {
+				this.isPureExternalModule = () => false;
+			}
 		} else {
 			this.isPureExternalModule = () => false;
 		}
diff --git a/src/rollup/index.js b/src/rollup/index.js
index b51b9aaec..bc0608ffa 100644
--- a/src/rollup/index.js
+++ b/src/rollup/index.js
@@ -57,7 +57,7 @@ function checkAmd ( options ) {
 
 		const message = `options.moduleId is deprecated in favour of options.amd = { id: moduleId }`;
 		if ( options.onwarn ) {
-			options.onwarn({ message });
+			options.onwarn( { message } );
 		} else {
 			console.warn( message ); // eslint-disable-line no-console
 		}
@@ -66,17 +66,31 @@ function checkAmd ( options ) {
 
 function checkInputOptions ( options, warn ) {
 	if ( options.transform || options.load || options.resolveId || options.resolveExternal ) {
-		throw new Error( 'The `transform`, `load`, `resolveId` and `resolveExternal` options are deprecated in favour of a unified plugin API. See https://github.com/rollup/rollup/wiki/Plugins for details' );
+		throw new Error(
+			'The `transform`, `load`, `resolveId` and `resolveExternal` options are deprecated in favour of a unified plugin API. See https://github.com/rollup/rollup/wiki/Plugins for details' );
+	}
+
+	if ( options.pureExternalModules ) {
+		if ( options.treeshake === undefined ) {
+			options.treeshake = {};
+		}
+		if ( options.treeshake ) {
+			options.treeshake.pureExternalModules = options.pureExternalModules;
+		}
+		delete options.pureExternalModules;
+		warn( {
+			message: `options.pureExternalModules is deprecated, use options.treeshake.pureExternalModules`
+		} );
 	}
 
 	if ( options.entry && !options.input ) {
 		options.input = options.entry;
-		warn({
+		warn( {
 			message: `options.entry is deprecated, use options.input`
-		});
+		} );
 	}
 
-	const err = validateKeys( keys(options), ALLOWED_KEYS );
+	const err = validateKeys( keys( options ), ALLOWED_KEYS );
 	if ( err ) throw err;
 }
 
@@ -90,17 +104,17 @@ const deprecated = {
 
 function checkOutputOptions ( options, warn ) {
 	if ( options.format === 'es6' ) {
-		error({
+		error( {
 			message: 'The `es6` output format is deprecated – use `es` instead',
 			url: `https://github.com/rollup/rollup/wiki/JavaScript-API#format`
-		});
+		} );
 	}
 
 	if ( !options.format ) {
-		error({
+		error( {
 			message: `You must specify options.format, which can be one of 'amd', 'cjs', 'es', 'iife' or 'umd'`,
 			url: `https://github.com/rollup/rollup/wiki/JavaScript-API#format`
-		});
+		} );
 	}
 
 	if ( options.moduleId ) {
@@ -109,27 +123,28 @@ function checkOutputOptions ( options, warn ) {
 		options.amd = { id: options.moduleId };
 		delete options.moduleId;
 
-		warn({
+		warn( {
 			message: `options.moduleId is deprecated in favour of options.amd = { id: moduleId }`
-		});
+		} );
 	}
 
 	const deprecations = [];
 	Object.keys( deprecated ).forEach( old => {
 		if ( old in options ) {
-			deprecations.push({ old, new: deprecated[ old ] });
+			deprecations.push( { old, new: deprecated[ old ] } );
 			options[ deprecated[ old ] ] = options[ old ];
 			delete options[ old ];
 		}
-	});
+	} );
 
 	if ( deprecations.length ) {
-		const message = `The following options have been renamed — please update your config: ${deprecations.map(option => `${option.old} -> ${option.new}`).join(', ')}`;
-		warn({
+		const message = `The following options have been renamed — please update your config: ${deprecations.map(
+			option => `${option.old} -> ${option.new}` ).join( ', ' )}`;
+		warn( {
 			code: 'DEPRECATED_OPTIONS',
 			message,
 			deprecations
-		});
+		} );
 	}
 }
 
@@ -171,16 +186,16 @@ export default function rollup ( options ) {
 
 						bundle.plugins.forEach( plugin => {
 							if ( plugin.ongenerate ) {
-								plugin.ongenerate( assign({
+								plugin.ongenerate( assign( {
 									bundle: result
-								}, options ), rendered);
+								}, options ), rendered );
 							}
-						});
+						} );
 
 						flushTime();
 
 						return rendered;
-					});
+					} );
 
 				Object.defineProperty( promise, 'code', throwAsyncGenerateError );
 				Object.defineProperty( promise, 'map', throwAsyncGenerateError );
@@ -196,10 +211,10 @@ export default function rollup ( options ) {
 				generate,
 				write: options => {
 					if ( !options || (!options.file && !options.dest) ) {
-						error({
+						error( {
 							code: 'MISSING_OPTION',
 							message: 'You must specify options.file'
-						});
+						} );
 					}
 
 					return generate( options ).then( result => {
@@ -224,17 +239,17 @@ export default function rollup ( options ) {
 						promises.push( writeFile( file, code ) );
 						return Promise.all( promises ).then( () => {
 							return mapSequence( bundle.plugins.filter( plugin => plugin.onwrite ), plugin => {
-								return Promise.resolve( plugin.onwrite( assign({
+								return Promise.resolve( plugin.onwrite( assign( {
 									bundle: result
-								}, options ), result));
-							});
-						});
-					});
+								}, options ), result ) );
+							} );
+						} );
+					} );
 				}
 			};
 
 			return result;
-		});
+		} );
 	} catch ( err ) {
 		return Promise.reject( err );
 	}
diff --git a/src/utils/deprecateOptions.js b/src/utils/deprecateOptions.js
deleted file mode 100644
index 50726d64e..000000000
--- a/src/utils/deprecateOptions.js
+++ /dev/null
@@ -1,65 +0,0 @@
-export default function deprecateOptions(options) {
-	const deprecations = [];
-
-	if ( options.entry ) {
-		deprecations.push({ old: 'options.entry', new: 'options.input' });
-		options.input = options.entry; // don't delete, as plugins sometimes depend on this...
-	}
-
-	if ( options.moduleName ) {
-		deprecations.push({ old: 'options.moduleName', new: 'options.name' });
-		options.name = options.moduleName;
-		delete options.moduleName;
-	}
-
-	if ( options.sourceMap ) {
-		deprecations.push({ old: 'options.sourceMap', new: 'options.sourcemap' });
-		options.sourcemap = options.sourceMap;
-		delete options.sourceMap;
-	}
-
-	if ( options.sourceMapFile ) {
-		deprecations.push({ old: 'options.sourceMapFile', new: 'options.sourcemapFile' });
-		options.sourcemapFile = options.sourceMapFile;
-		delete options.sourceMapFile;
-	}
-
-	if ( options.useStrict ) {
-		deprecations.push({ old: 'options.useStrict', new: 'options.strict' });
-		options.strict = options.useStrict;
-		delete options.useStrict;
-	}
-
-	if ( options.targets ) {
-		deprecations.push({ old: 'options.targets', new: 'options.output' });
-		options.output = options.targets;
-		delete options.targets;
-
-		let deprecatedDest = false;
-		options.output.forEach(output => {
-			if (output.dest) {
-				if (!deprecatedDest) {
-					deprecations.push({ old: 'output.dest', new: 'output.file' });
-					deprecatedDest = true;
-				}
-				output.file = output.dest;
-				delete output.dest;
-			}
-		});
-	} else if ( options.dest ) {
-		deprecations.push({ old: 'options.dest', new: 'options.output.file' });
-		options.output = {
-			file: options.dest,
-			format: options.format
-		};
-		delete options.dest;
-	}
-
-	if ( options.format ) {
-		if ( !options.output ) options.output = { format: options.format };
-		deprecations.push({ old: 'options.format', new: 'options.output.format' });
-		delete options.format;
-	}
-
-	return deprecations;
-}
\ No newline at end of file
diff --git a/test/cli/samples/no-treeshake/_config.js b/test/cli/samples/no-treeshake/_config.js
index 920222564..9cd57bca6 100644
--- a/test/cli/samples/no-treeshake/_config.js
+++ b/test/cli/samples/no-treeshake/_config.js
@@ -1,4 +1,4 @@
 module.exports = {
-	description: 'generates IIFE export with all code',
-	command: 'rollup main.js --output.format iife --name shakeless --no-treeshake --indent'
+	description: 'generates IIFE export with all code and overrides config',
+	command: 'rollup -c --no-treeshake'
 };
diff --git a/test/cli/samples/no-treeshake/rollup.config.js b/test/cli/samples/no-treeshake/rollup.config.js
new file mode 100644
index 000000000..2fb807111
--- /dev/null
+++ b/test/cli/samples/no-treeshake/rollup.config.js
@@ -0,0 +1,11 @@
+module.exports = {
+	input: 'main.js',
+	indent: true,
+	treeshake: {
+		propertyReadSideEffects: false
+	},
+	output: {
+		format: 'iife',
+		name: 'shakeless'
+	}
+};
diff --git a/test/cli/samples/property-read-side-effects/_config.js b/test/cli/samples/property-read-side-effects/_config.js
new file mode 100644
index 000000000..78746e7bd
--- /dev/null
+++ b/test/cli/samples/property-read-side-effects/_config.js
@@ -0,0 +1,4 @@
+module.exports = {
+	description: 'allows disabling side-effects when accessing properties',
+	command: 'rollup main.js --output.format es --no-treeshake.propertyReadSideEffects'
+};
diff --git a/test/cli/samples/property-read-side-effects/_expected.js b/test/cli/samples/property-read-side-effects/_expected.js
new file mode 100644
index 000000000..5c72ff351
--- /dev/null
+++ b/test/cli/samples/property-read-side-effects/_expected.js
@@ -0,0 +1 @@
+console.log( 42 );
diff --git a/test/cli/samples/property-read-side-effects/main.js b/test/cli/samples/property-read-side-effects/main.js
new file mode 100644
index 000000000..fd0c9bb2e
--- /dev/null
+++ b/test/cli/samples/property-read-side-effects/main.js
@@ -0,0 +1,7 @@
+function deepAccess ( foo ) {
+	const x = foo.bar.baz;
+}
+
+deepAccess( null );
+
+console.log( 42 );
diff --git a/test/cli/samples/pure-external-modules/_config.js b/test/cli/samples/pure-external-modules/_config.js
new file mode 100644
index 000000000..f57f070d1
--- /dev/null
+++ b/test/cli/samples/pure-external-modules/_config.js
@@ -0,0 +1,4 @@
+module.exports = {
+	description: 'prunes pure unused external imports',
+	command: 'rollup main.js --output.format es --external external --treeshake.pureExternalModules'
+};
diff --git a/test/cli/samples/pure-external-modules/_expected.js b/test/cli/samples/pure-external-modules/_expected.js
new file mode 100644
index 000000000..5c72ff351
--- /dev/null
+++ b/test/cli/samples/pure-external-modules/_expected.js
@@ -0,0 +1 @@
+console.log( 42 );
diff --git a/test/cli/samples/pure-external-modules/main.js b/test/cli/samples/pure-external-modules/main.js
new file mode 100644
index 000000000..b3a88b7c9
--- /dev/null
+++ b/test/cli/samples/pure-external-modules/main.js
@@ -0,0 +1,7 @@
+import { unused } from 'external';
+
+function alsoUnused () {
+	unused();
+}
+
+console.log( 42 );
diff --git a/test/form/samples/prune-pure-unused-import/_config.js b/test/form/samples/prune-pure-unused-import/_config.js
index 9da04fa29..fe23f0dd9 100644
--- a/test/form/samples/prune-pure-unused-import/_config.js
+++ b/test/form/samples/prune-pure-unused-import/_config.js
@@ -1,9 +1,11 @@
-const assert = require('assert');
+const assert = require( 'assert' );
 
 module.exports = {
 	options: {
-		external: ['external', 'other'],
-		pureExternalModules: true
+		external: [ 'external', 'other' ],
+		treeshake: {
+			pureExternalModules: true
+		}
 	},
 	description: 'prunes pure unused external imports ([#1352])'
 };
diff --git a/test/function/index.js b/test/function/index.js
index 955528906..0f528ae23 100644
--- a/test/function/index.js
+++ b/test/function/index.js
@@ -127,7 +127,7 @@ describe('function', () => {
 								}
 							} else if (warnings.length) {
 								throw new Error(
-									`Got unexpected warnings:\n${warnings.join('\n')}`
+									`Got unexpected warnings:\n${warnings.map(warning => warning.message).join('\n')}`
 								);
 							}
 
diff --git a/test/function/samples/keep-used-imports-from-pure-external-modules/_config.js b/test/function/samples/keep-used-imports-from-pure-external-modules/_config.js
index 97676f563..10b6e6366 100644
--- a/test/function/samples/keep-used-imports-from-pure-external-modules/_config.js
+++ b/test/function/samples/keep-used-imports-from-pure-external-modules/_config.js
@@ -2,7 +2,9 @@ module.exports = {
 	description: 'imports from pure external modules that are used should not be omitted',
 	options: {
 		external: [ 'warning' ],
-		pureExternalModules: [ 'warning' ]
+		treeshake: {
+			pureExternalModules: [ 'warning' ]
+		}
 	},
 	context: {
 		require: id => {
