{"url":"https://api.github.com/repos/prettier/prettier/issues/17489","repository_url":"https://api.github.com/repos/prettier/prettier","labels_url":"https://api.github.com/repos/prettier/prettier/issues/17489/labels{/name}","comments_url":"https://api.github.com/repos/prettier/prettier/issues/17489/comments","events_url":"https://api.github.com/repos/prettier/prettier/issues/17489/events","html_url":"https://github.com/prettier/prettier/issues/17489","id":3069292919,"node_id":"I_kwDOBHn_e8628bF3","number":17489,"title":"Inconsistent (missing) parentheses in concise-body callback inside optional chaining in `typescript` vs `babel` and `babel-ts`","user":{"login":"karlhorky","id":1935696,"node_id":"MDQ6VXNlcjE5MzU2OTY=","avatar_url":"https://avatars.githubusercontent.com/u/1935696?v=4","gravatar_id":"","url":"https://api.github.com/users/karlhorky","html_url":"https://github.com/karlhorky","followers_url":"https://api.github.com/users/karlhorky/followers","following_url":"https://api.github.com/users/karlhorky/following{/other_user}","gists_url":"https://api.github.com/users/karlhorky/gists{/gist_id}","starred_url":"https://api.github.com/users/karlhorky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlhorky/subscriptions","organizations_url":"https://api.github.com/users/karlhorky/orgs","repos_url":"https://api.github.com/users/karlhorky/repos","events_url":"https://api.github.com/users/karlhorky/events{/privacy}","received_events_url":"https://api.github.com/users/karlhorky/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":985033474,"node_id":"MDU6TGFiZWw5ODUwMzM0NzQ=","url":"https://api.github.com/repos/prettier/prettier/labels/locked-due-to-inactivity","name":"locked-due-to-inactivity","color":"000000","default":false,"description":"Please open a new issue and fill out the template instead of commenting."}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2025-05-16T15:19:01Z","updated_at":"2025-09-20T00:03:25Z","closed_at":"2025-06-21T15:51:14Z","author_association":"CONTRIBUTOR","type":{"id":5763486,"node_id":"IT_kwDOAYoGC84AV_Ge","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-30T10:19:56Z","updated_at":"2024-07-26T11:33:03Z","is_enabled":true},"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Inside a long optional chaining expression, the concise-body return value is formatted on the same line as the arrow with the `typescript` parser (without parentheses) - instead of on multiple lines with parentheses like `babel` and `babel-ts`.\n\n**Prettier 3.5.3**\n[Playground link](https://prettier.io/playground#N4Igxg9gdgLgprEAuc0DOMAEBDXf8GFH6YC8mwAOlJpgEYONPMtNKYDa1ttA5ACoALAJZpMonJngZMAB2wAnbAHMlswQDpeAGm48BIsROxQIMQXAVS4M+UtXZ1W3TUwBdFwF8A3NWoAzAFcoMBhhaEwAYQgAW1loBBgACgBKCj0FOBhAhRokvVoAHgATYQA3AD4CnmBiOvqCAH4NVla2ug0Yx3zXHh4k2W1xNNIKzELZTABrOABPUmBhTwrgWU9CgHpZKt6eFM9qzdLKvRTfKAOoEG0QCFkw9GRQRQUIAHcABUUENGQQbAANm9sLNfjc6EowDMYABlbAxOAAGWEUDgyH8gLQcBuEDoACs4KEAOpqP6yTJYhRlNHgyHQmHyMAo5TIGAKQLYkBYmLCVnszlwAAeskswgRsEBAHkRUoYBAFB8IGhhA8rigEMVriAhTKxYlAfxLFBFMIbOjMZzlVBlAC4ABFQJmNFIDEArE3PFoQUw5m2h1O81uzkAR0d8A+r1kvxQ2DQAFpUXBikmtWzsMIAczojEun9AQCtVabXAAIIwNnCOiBcOWZGowPukCCGAxAFEkTSRlwGE-FXlFWzP5gNBgkBlDkASSgydgMLACmE9xL05hMFmtobnPJSrgJMcZIplmpWpRlJgEZUuZdFpudkpfzXIrQ88XMC15JRMCJwmK5mQAA4AAYbkyUNhEyC9lCvV1GxgbA6G-X9BGQAAmG5Aixfh4OjGCBRiOgk2TYpERMZRAhUOAADF5S6ctmTzasIBATxPCAA)\n<!-- prettier-ignore -->\n```sh\n--parser typescript\n```\n\n**Input:**\n<!-- prettier-ignore -->\n```tsx\nconst aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa = {\n  bbbbbbbbbbbbbbbbbbbbbbbbb: [\n    'This is a test paragraph.',\n    'This is another test paragraph.',\n  ],\n};\n\nfunction Component() {\n  return (\n    <div>\n      {aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa?.bbbbbbbbbbbbbbbbbbbbbbbbb.map(\n        (p, i) => <p key={i}>{p}</p>\n      )}\n    </div>\n  );\n}\n\n```\n\n**Output:**\n<!-- prettier-ignore -->\n```tsx\nconst aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa = {\n  bbbbbbbbbbbbbbbbbbbbbbbbb: [\n    \"This is a test paragraph.\",\n    \"This is another test paragraph.\",\n  ],\n};\n\nfunction Component() {\n  return (\n    <div>\n      {aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa?.bbbbbbbbbbbbbbbbbbbbbbbbb.map(\n        (p, i) => <p key={i}>{p}</p>,\n      )}\n    </div>\n  );\n}\n\n```\n\n**Expected output:**\n<!-- prettier-ignore -->\n```tsx\nconst aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa = {\n  bbbbbbbbbbbbbbbbbbbbbbbbb: [\n    \"This is a test paragraph.\",\n    \"This is another test paragraph.\",\n  ],\n};\n\nfunction Component() {\n  return (\n    <div>\n      {aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa?.bbbbbbbbbbbbbbbbbbbbbbbbb.map(\n        (p, i) => (\n          <p key={i}>{p}</p>\n        ),\n      )}\n    </div>\n  );\n}\n```\n\n**Why?**\n\nThis is the expected output of:\n\n- [the `babel` parser](https://prettier.io/playground#N4Igxg9gdgLgprEAuc0DOMAEBDXf8GFH6YC8mwAOlJpgEYONPMtNKYDa1ttA5ACoALAJZpMonJngZMAB2wAnbAHMlswQDpeAGm48BIsROxQIMQXAVS4M+UtXZ1W3TUwBdFwF8A3NWoAzAFcoMBhhaEwAYQgAW1loBBgACgBKCj0FOBhAhRokvVoAHgATYQA3AD4CnmBiOvqCAH4NVla2ug0Yx3zXHh4k2W1xNNIKzELZTABrOABPUmBhTwrgWU9CgHpZKt6eFM9qzdLKvRTfKAOoEG0QCFkw9GRQRQUIAHcABUUENGQQbAANm9sLNfjc6EowDMYABlbAxOAAGWEUDgyH8gLQcBuEDoACs4KEAOpqP6yTJYhRlNHgyHQmHyMAo5TIGAKQLYkBYmLCVnszlwAAeskswgRsEBAHkRUoYBAFB8IGhhA8rigEMVriAhTKxYlAfxLFBFMIbOjMZzlVBlAC4ABFQJmNFIDEArE3PFoQUw5m2h1O81uzkAR0d8A+r1kvxQ2DQAFpUXBikmtWzsMIAczojEun9AQCtVabXAAIIwNnCOiBcOWZGowPukCCGAxAFEkTSRlwGE-FXlFWzP5gNBgkBlDkASSgydgMLACmE9xL05hMFmtobnPJSrgJMcZIplmpWpRlJgEZUuZdFpudkpfzo2DocALt4XsCJwmK5mQAA4AAw3JkobCJkF7KFerqNjAT6ft+gjIAATDcgRYvwT7RlBAoxM+xTJsUiImMogQqHAABi8pdOWzJ5tWEAgJ4nhAA)\n- [the `babel-ts` parser](https://prettier.io/playground#N4Igxg9gdgLgprEAuc0DOMAEBDXf8GFH6YC8mwAOlJpgEYONPMtNKYDa1ttA5ACoALAJZpMonJngZMAB2wAnbAHMlswQDpeAGm48BIsROxQIMQXAVS4M+UtXZ1W3TUwBdFwF8A3NWoAzAFcoMBhhaEwAYQgAW1loBBgACgBKCj0FOBhAhRokvVoAHgATYQA3AD4CnmBiOvqCAH4NVla2ug0Yx3zXHh4k2W1xNNIKzELZTABrOABPUmBhTwrgWU9CgHpZKt6eFM9qzdLKvRTfKAOoEG0QCFkw9GRQRQUIAHcABUUENGQQbAANm9sLNfjc6EowDMYABlbAxOAAGWEUDgyH8gLQcBuEDoACs4KEAOpqP6yTJYhRlNHgyHQmHyMAo5TIGAKQLYkBYmLCVnszlwAAeskswgRsEBAHkRUoYBAFB8IGhhA8rigEMVriAhTKxYlAfxLFBFMIbOjMZzlVBlAC4ABFQJmNFIDEArE3PFoQUw5m2h1O81uzkAR0d8A+r1kvxQ2DQAFpUXBikmtWzsMIAczojEun9AQCtVabXAAIIwNnCOiBcOWZGowPukCCGAxAFEkTSRlwGE-FXlFWzP5gNBgkBlDkASSgydgMLACmE9xL05hMFmtobnPJSrgJMcZIplmpWpRlJgEZUuZdFpudkpfzo2DocABcZgo-JKJgROExXMyAADgABhuTJQ2ETIL2UK9XUbGAnx-P9BGQAAmG5Aixfgn2jWCBRiZ9imTYpERMZRAhUOAADF5S6ctmTzasIBATxPCAA)\n\nWeirdly enough, it's also the output of [the `typescript` parser when the optional chaining is removed from the `.map` expression](https://prettier.io/playground#N4Igxg9gdgLgprEAuc0DOMAEBDXf8GFH6YC8mwAOlJpgEYONPMtNKYDa1ttA5ACoALAJZpMonJngZMAB2wAnbAHMlswQDpeAGm48BIsROxQIMQXAVS4M+UtXZ1W3TUwBdFwF8A3NWoAzAFcoMBhhaEwAYQgAW1loBBgACgBKCj0FOBhAhRokvVoAHgATYQA3AD4CnmBiOvqCDVZmlroNGMd81x4eJNltcTTSCsxC2UwAazgAT1JgYU8K4FlPQoB6WSrunhTPavXSyr0U3yg9qBBtEAhZMPRkUEUFCAB3AAVFBDRkEGwAGxe2Gm3yudCUYCmMAAytgYnAADLCKBwZD+f5oOBXCB0ABWcFCAHU1D9ZJkMQoyijQeDIVD5GAkcpkDAFIFMSAMTFhMzWey4AAPWSWYRw2D-ADyQqUMAgCjeEDQwjuFxQCGKlxAAqlIsS-34ligimENlR6PZiqgyj+cAAioEzCikGi-hirji0PyoYzrXaHaaXeyAI72+BvZ6yb4obBoAC0yLgxQTGpZ2GEf0Z0RiHR+-z+GotVrgAEEYCzhHRAqHLIjkf7XSBBDAYn8CSJpPS4FCvkrykrpj8wGgQSAymyAJJQROwKFgBTCW5FydQmDTa119mkhVwImOElkyyUjVI8kwMMqbNOs1XOzkn4roVoWfzmAa0lImAE4TFczIAAcAAYrkyYNhEyM9lAvZ16xgbA6E-b9BGQAAmK5AgxfhYMjKC+RiOgE0TYp4RMZRAhUOAADFZQ6UtGRzSsIBATxPCAA):\n\n**Input:**\n\n```tsx\nconst aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa = {\n  bbbbbbbbbbbbbbbbbbbbbbbbb: [\n    'This is a test paragraph.',\n    'This is another test paragraph.',\n  ],\n};\n\nfunction Component() {\n  return (\n    <div>\n      {aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.bbbbbbbbbbbbbbbbbbbbbbbbb.map(\n        (p, i) => <p key={i}>{p}</p>\n      )}\n    </div>\n  );\n}\n```\n\n**Output:**\n\n```tsx\nconst aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa = {\n  bbbbbbbbbbbbbbbbbbbbbbbbb: [\n    \"This is a test paragraph.\",\n    \"This is another test paragraph.\",\n  ],\n};\n\nfunction Component() {\n  return (\n    <div>\n      {aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.bbbbbbbbbbbbbbbbbbbbbbbbb.map(\n        (p, i) => (\n          <p key={i}>{p}</p>\n        ),\n      )}\n    </div>\n  );\n}\n```","closed_by":{"login":"sosukesuzuki","id":14838850,"node_id":"MDQ6VXNlcjE0ODM4ODUw","avatar_url":"https://avatars.githubusercontent.com/u/14838850?v=4","gravatar_id":"","url":"https://api.github.com/users/sosukesuzuki","html_url":"https://github.com/sosukesuzuki","followers_url":"https://api.github.com/users/sosukesuzuki/followers","following_url":"https://api.github.com/users/sosukesuzuki/following{/other_user}","gists_url":"https://api.github.com/users/sosukesuzuki/gists{/gist_id}","starred_url":"https://api.github.com/users/sosukesuzuki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sosukesuzuki/subscriptions","organizations_url":"https://api.github.com/users/sosukesuzuki/orgs","repos_url":"https://api.github.com/users/sosukesuzuki/repos","events_url":"https://api.github.com/users/sosukesuzuki/events{/privacy}","received_events_url":"https://api.github.com/users/sosukesuzuki/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/prettier/prettier/issues/17489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/prettier/prettier/issues/17489/timeline","performed_via_github_app":null,"state_reason":"completed"}