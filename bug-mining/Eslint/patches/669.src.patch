diff --git a/lib/rules/consistent-this.js b/lib/rules/consistent-this.js
index ad5ea3e3c..732de7b40 100644
--- a/lib/rules/consistent-this.js
+++ b/lib/rules/consistent-this.js
@@ -119,8 +119,17 @@ module.exports = {
         function ensureWasAssigned(node) {
             const scope = sourceCode.getScope(node);
 
+            // if this is program scope we also need to check module scope
+            const extraScope = node.type === "Program" && node.sourceType === "module"
+                ? scope.childScopes[0]
+                : null;
+
             aliases.forEach(alias => {
                 checkWasAssigned(alias, scope);
+
+                if (extraScope) {
+                    checkWasAssigned(alias, extraScope);
+                }
             });
         }
 
diff --git a/tests/lib/rules/consistent-this.js b/tests/lib/rules/consistent-this.js
index 6ba5ac361..589a9fa97 100644
--- a/tests/lib/rules/consistent-this.js
+++ b/tests/lib/rules/consistent-this.js
@@ -68,6 +68,7 @@ ruleTester.run("consistent-this", rule, {
         { code: "that = this", options: ["self"], errors: [{ messageId: "unexpectedAlias", data: { name: "that" }, type: "AssignmentExpression" }] },
         { code: "self = this", options: ["that"], errors: [{ messageId: "unexpectedAlias", data: { name: "self" }, type: "AssignmentExpression" }] },
         { code: "self += this", options: ["self"], errors: [{ messageId: "aliasNotAssignedToThis", data: { name: "self" }, type: "AssignmentExpression" }] },
-        { code: "var self; (function() { self = this; }())", options: ["self"], errors: [{ messageId: "aliasNotAssignedToThis", data: { name: "self" }, type: "VariableDeclarator" }] }
+        { code: "var self; (function() { self = this; }())", options: ["self"], errors: [{ messageId: "aliasNotAssignedToThis", data: { name: "self" }, type: "VariableDeclarator" }] },
+        { code: "var self; (function() { self = this; }())", options: ["self"], languageOptions: { ecmaVersion: 6, sourceType: "module" }, errors: [{ messageId: "aliasNotAssignedToThis", data: { name: "self" }, type: "VariableDeclarator" }] }
     ]
 });
