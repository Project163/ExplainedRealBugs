{"url":"https://api.github.com/repos/eslint/eslint/issues/19244","repository_url":"https://api.github.com/repos/eslint/eslint","labels_url":"https://api.github.com/repos/eslint/eslint/issues/19244/labels{/name}","comments_url":"https://api.github.com/repos/eslint/eslint/issues/19244/comments","events_url":"https://api.github.com/repos/eslint/eslint/issues/19244/events","html_url":"https://github.com/eslint/eslint/issues/19244","id":2740097103,"node_id":"I_kwDOAKjKDc6jUpBP","number":19244,"title":"Bug: Violation of `consistent-this` rule due to global and function scope mismatch in variable assignment","user":{"login":"amareshsm","id":30730124,"node_id":"MDQ6VXNlcjMwNzMwMTI0","avatar_url":"https://avatars.githubusercontent.com/u/30730124?v=4","gravatar_id":"","url":"https://api.github.com/users/amareshsm","html_url":"https://github.com/amareshsm","followers_url":"https://api.github.com/users/amareshsm/followers","following_url":"https://api.github.com/users/amareshsm/following{/other_user}","gists_url":"https://api.github.com/users/amareshsm/gists{/gist_id}","starred_url":"https://api.github.com/users/amareshsm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amareshsm/subscriptions","organizations_url":"https://api.github.com/users/amareshsm/orgs","repos_url":"https://api.github.com/users/amareshsm/repos","events_url":"https://api.github.com/users/amareshsm/events{/privacy}","received_events_url":"https://api.github.com/users/amareshsm/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":45711350,"node_id":"MDU6TGFiZWw0NTcxMTM1MA==","url":"https://api.github.com/repos/eslint/eslint/labels/bug","name":"bug","color":"fc2929","default":true,"description":"ESLint is working incorrectly"},{"id":45798639,"node_id":"MDU6TGFiZWw0NTc5ODYzOQ==","url":"https://api.github.com/repos/eslint/eslint/labels/rule","name":"rule","color":"fbca04","default":false,"description":"Relates to ESLint's core rules"},{"id":131106229,"node_id":"MDU6TGFiZWwxMzExMDYyMjk=","url":"https://api.github.com/repos/eslint/eslint/labels/accepted","name":"accepted","color":"0052cc","default":false,"description":"There is consensus among the team that this change meets the criteria for inclusion"},{"id":2786823532,"node_id":"MDU6TGFiZWwyNzg2ODIzNTMy","url":"https://api.github.com/repos/eslint/eslint/labels/repro:yes","name":"repro:yes","color":"7A14E9","default":false,"description":"Issues with a reproducible example"}],"state":"closed","locked":false,"assignee":{"login":"nzakas","id":38546,"node_id":"MDQ6VXNlcjM4NTQ2","avatar_url":"https://avatars.githubusercontent.com/u/38546?v=4","gravatar_id":"","url":"https://api.github.com/users/nzakas","html_url":"https://github.com/nzakas","followers_url":"https://api.github.com/users/nzakas/followers","following_url":"https://api.github.com/users/nzakas/following{/other_user}","gists_url":"https://api.github.com/users/nzakas/gists{/gist_id}","starred_url":"https://api.github.com/users/nzakas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nzakas/subscriptions","organizations_url":"https://api.github.com/users/nzakas/orgs","repos_url":"https://api.github.com/users/nzakas/repos","events_url":"https://api.github.com/users/nzakas/events{/privacy}","received_events_url":"https://api.github.com/users/nzakas/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"nzakas","id":38546,"node_id":"MDQ6VXNlcjM4NTQ2","avatar_url":"https://avatars.githubusercontent.com/u/38546?v=4","gravatar_id":"","url":"https://api.github.com/users/nzakas","html_url":"https://github.com/nzakas","followers_url":"https://api.github.com/users/nzakas/followers","following_url":"https://api.github.com/users/nzakas/following{/other_user}","gists_url":"https://api.github.com/users/nzakas/gists{/gist_id}","starred_url":"https://api.github.com/users/nzakas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nzakas/subscriptions","organizations_url":"https://api.github.com/users/nzakas/orgs","repos_url":"https://api.github.com/users/nzakas/repos","events_url":"https://api.github.com/users/nzakas/events{/privacy}","received_events_url":"https://api.github.com/users/nzakas/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":2,"created_at":"2024-12-14T18:52:26Z","updated_at":"2025-01-30T12:09:43Z","closed_at":"2025-01-30T12:09:43Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Environment\n\nNode version: 20.16.0\nnpm version: 9.8.1\nLocal ESLint version: 9.10\nGlobal ESLint version: 9.10\nOperating System: Mac OS\n\n\n### What parser are you using?\n\nDefault (Espree)\n\n### What did you do?\n\nI wrote the following code, which declares a variable (that) without initializing it immediately and then assigns this to it inside a function:\n\n```\nvar that;  // Declaration of 'that' (but no initialization)\nfunction f() {\n    that = this;  // Assignment of 'this' to 'that'\n}\n```\nThe above code is the same example mentioned in the docs as incorrect.\n![Image](https://github.com/user-attachments/assets/3384b759-07d1-489c-8d50-1f5befc933b1)\n\n\n### What did you expect to happen?\n\nI expected ESLint to show an error for the consistent-this rule because the rule mandates that:\n\nAccording to the [docs](https://eslint.org/docs/latest/rules/consistent-this#rule-details):\nIf a variable (like that) is declared to capture this, it must be either initialized with this immediately in the same scope or assigned this within the same scope.\nThe variable is declared globally but assigned inside a function, which should violate the rule.\n\n### What actually happened?\n\nESLint did not show an error. The rule appears to be not enforcing the condition that requires the assignment of this to occur in the same scope as the declaration. The code is allowed to pass without any warnings or errors, even though it seems to violate the intended behavior of the consistent-this rule.\n\n### Link to Minimal Reproducible Example\n\nhttps://eslint.org/play/#eyJ0ZXh0IjoiLyplc2xpbnQgY29uc2lzdGVudC10aGlzOiBbXCJlcnJvclwiLCBcInRoYXRcIl0qL1xuXG52YXIgdGhhdDtcbmZ1bmN0aW9uIGYoKSB7XG4gICAgdGhhdCA9IHRoaXM7XG59Iiwib3B0aW9ucyI6eyJydWxlcyI6eyJjb25zaXN0ZW50LXRoaXMiOlsiZXJyb3IiXX0sImxhbmd1YWdlT3B0aW9ucyI6eyJzb3VyY2VUeXBlIjoibW9kdWxlIiwicGFyc2VyT3B0aW9ucyI6eyJlY21hRmVhdHVyZXMiOnt9fX19fQ==\n\n### Participation\n\n- [x] I am willing to submit a pull request for this issue.\n\n### Additional comments\n\n_No response_","closed_by":{"login":"mdjermanovic","id":44349756,"node_id":"MDQ6VXNlcjQ0MzQ5NzU2","avatar_url":"https://avatars.githubusercontent.com/u/44349756?v=4","gravatar_id":"","url":"https://api.github.com/users/mdjermanovic","html_url":"https://github.com/mdjermanovic","followers_url":"https://api.github.com/users/mdjermanovic/followers","following_url":"https://api.github.com/users/mdjermanovic/following{/other_user}","gists_url":"https://api.github.com/users/mdjermanovic/gists{/gist_id}","starred_url":"https://api.github.com/users/mdjermanovic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdjermanovic/subscriptions","organizations_url":"https://api.github.com/users/mdjermanovic/orgs","repos_url":"https://api.github.com/users/mdjermanovic/repos","events_url":"https://api.github.com/users/mdjermanovic/events{/privacy}","received_events_url":"https://api.github.com/users/mdjermanovic/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/eslint/eslint/issues/19244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/eslint/eslint/issues/19244/timeline","performed_via_github_app":null,"state_reason":"completed"}