{"url":"https://api.github.com/repos/eslint/eslint/issues/19322","repository_url":"https://api.github.com/repos/eslint/eslint","labels_url":"https://api.github.com/repos/eslint/eslint/issues/19322/labels{/name}","comments_url":"https://api.github.com/repos/eslint/eslint/issues/19322/comments","events_url":"https://api.github.com/repos/eslint/eslint/issues/19322/events","html_url":"https://github.com/eslint/eslint/issues/19322","id":2774620872,"node_id":"I_kwDOAKjKDc6lYVrI","number":19322,"title":"Bug: Cannot serialize key \"parse\" in parser: Function values are not supported.","user":{"login":"sayakpan","id":98030872,"node_id":"U_kgDOBdfVGA","avatar_url":"https://avatars.githubusercontent.com/u/98030872?v=4","gravatar_id":"","url":"https://api.github.com/users/sayakpan","html_url":"https://github.com/sayakpan","followers_url":"https://api.github.com/users/sayakpan/followers","following_url":"https://api.github.com/users/sayakpan/following{/other_user}","gists_url":"https://api.github.com/users/sayakpan/gists{/gist_id}","starred_url":"https://api.github.com/users/sayakpan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sayakpan/subscriptions","organizations_url":"https://api.github.com/users/sayakpan/orgs","repos_url":"https://api.github.com/users/sayakpan/repos","events_url":"https://api.github.com/users/sayakpan/events{/privacy}","received_events_url":"https://api.github.com/users/sayakpan/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":45711350,"node_id":"MDU6TGFiZWw0NTcxMTM1MA==","url":"https://api.github.com/repos/eslint/eslint/labels/bug","name":"bug","color":"fc2929","default":true,"description":"ESLint is working incorrectly"},{"id":131106229,"node_id":"MDU6TGFiZWwxMzExMDYyMjk=","url":"https://api.github.com/repos/eslint/eslint/labels/accepted","name":"accepted","color":"0052cc","default":false,"description":"There is consensus among the team that this change meets the criteria for inclusion"},{"id":2786804245,"node_id":"MDU6TGFiZWwyNzg2ODA0MjQ1","url":"https://api.github.com/repos/eslint/eslint/labels/repro:needed","name":"repro:needed","color":"136971","default":false,"description":"This issue should include a reproducible example"},{"id":2786823532,"node_id":"MDU6TGFiZWwyNzg2ODIzNTMy","url":"https://api.github.com/repos/eslint/eslint/labels/repro:yes","name":"repro:yes","color":"7A14E9","default":false,"description":"Issues with a reproducible example"}],"state":"closed","locked":false,"assignee":{"login":"nzakas","id":38546,"node_id":"MDQ6VXNlcjM4NTQ2","avatar_url":"https://avatars.githubusercontent.com/u/38546?v=4","gravatar_id":"","url":"https://api.github.com/users/nzakas","html_url":"https://github.com/nzakas","followers_url":"https://api.github.com/users/nzakas/followers","following_url":"https://api.github.com/users/nzakas/following{/other_user}","gists_url":"https://api.github.com/users/nzakas/gists{/gist_id}","starred_url":"https://api.github.com/users/nzakas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nzakas/subscriptions","organizations_url":"https://api.github.com/users/nzakas/orgs","repos_url":"https://api.github.com/users/nzakas/repos","events_url":"https://api.github.com/users/nzakas/events{/privacy}","received_events_url":"https://api.github.com/users/nzakas/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"nzakas","id":38546,"node_id":"MDQ6VXNlcjM4NTQ2","avatar_url":"https://avatars.githubusercontent.com/u/38546?v=4","gravatar_id":"","url":"https://api.github.com/users/nzakas","html_url":"https://github.com/nzakas","followers_url":"https://api.github.com/users/nzakas/followers","following_url":"https://api.github.com/users/nzakas/following{/other_user}","gists_url":"https://api.github.com/users/nzakas/gists{/gist_id}","starred_url":"https://api.github.com/users/nzakas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nzakas/subscriptions","organizations_url":"https://api.github.com/users/nzakas/orgs","repos_url":"https://api.github.com/users/nzakas/repos","events_url":"https://api.github.com/users/nzakas/events{/privacy}","received_events_url":"https://api.github.com/users/nzakas/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":14,"created_at":"2025-01-08T08:14:56Z","updated_at":"2025-02-25T09:51:15Z","closed_at":"2025-02-01T11:23:13Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Environment\n\nDescription\n\nI’m encountering an issue with ESLint when using the FlatCompat utility and Next.js. The error occurs both during npm run lint and npm run build. It seems related to the serialization of the parse function in the ESLint parser.\n\nEnvironment Details\n\t•\tNode.js Version: v22.12.0\n\t•\tnpm Version: 10.9.0\n\t•\tESLint Local Version: 9.17.0\n\t•\tESLint Global Version: 9.17.0\n\t•\tNext.js Version: 15.1.4\n\t•\tOperating System: Mac OS Sequoia\n\n\n### What parser are you using?\n\nDefault (Espree)\n\n### What did you do?\n\nSteps to Reproduce\n1.\tInstall ESLint and Next.js in a project.\n2.\tUse the following eslint.config.mjs configuration:\n\n```\nimport { FlatCompat } from '@eslint/eslintrc'\n\nconst compat = new FlatCompat({\n  baseDirectory: import.meta.dirname,\n})\n\nconst eslintConfig = [\n  ...compat.config({\n    extends: ['next'],\n    rules: {\n      'react/no-unescaped-entities': 'off',\n      '@next/next/no-page-custom-font': 'off',\n    },\n  }),\n]\n\nexport default eslintConfig\n```\n\n3.\tRun npm run lint:\n\n```\nnpm run lint\n```\nOutput:\nCannot serialize key \"parse\" in parser: Function values are not supported.\n\n\n4.\tRun npm run lint -- --no-cache:\n```\nnpm run lint -- --no-cache\n```\nThis works without errors.\n\n5.\tDelete the .next/cache directory and run npm run lint again:\n\n```\nrm -rf .next/cache\nnpm run lint\n```\nOutput:\nCannot serialize key \"parse\" in parser: Function values are not supported.\n\n\n6.\tRun npm run build:\n\n```\nnpm run build\n```\nOutput:\nLinting and checking validity of types  . ⨯ ESLint: Cannot serialize key \"parse\" in parser: Function values are not supported.\n\n### What did you expect to happen?\n\n- \tThe npm run lint command should work without requiring --no-cache.\n- \tThe npm run build command should complete without errors.\n\n### What actually happened?\n\n- Running npm run lint without --no-cache results in the error: Cannot serialize key \"parse\" in parser: Function values are not supported.\n- Running npm run build also fails with the same error during the linting phase.\n\n### Link to Minimal Reproducible Example\n\n[Stackblitz Demo](https://stackblitz.com/edit/stackblitz-starters-8rcrwybu?file=demo-app%2Fpackage.json)\nJust go to the project and run ```npm run build``` or ```next lint```\n\n### Participation\n\n- [x] I am willing to submit a pull request for this issue.\n\n### Additional comments\n\n- \tClearing the .next/cache directory does not resolve the issue.\n- \tUsing --no-cache allows npm run lint to pass, but this is not ideal for builds.\n\n### Request for Help\n\n1. Is this issue caused by the FlatCompat utility or an incompatibility between FlatCompat and the Next.js ESLint configuration (next/core-web-vitals)?\n2. Is there a workaround or fix for this issue?\n\nThank you for looking into this! Let me know if additional information or debugging steps are required.","closed_by":{"login":"mdjermanovic","id":44349756,"node_id":"MDQ6VXNlcjQ0MzQ5NzU2","avatar_url":"https://avatars.githubusercontent.com/u/44349756?v=4","gravatar_id":"","url":"https://api.github.com/users/mdjermanovic","html_url":"https://github.com/mdjermanovic","followers_url":"https://api.github.com/users/mdjermanovic/followers","following_url":"https://api.github.com/users/mdjermanovic/following{/other_user}","gists_url":"https://api.github.com/users/mdjermanovic/gists{/gist_id}","starred_url":"https://api.github.com/users/mdjermanovic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdjermanovic/subscriptions","organizations_url":"https://api.github.com/users/mdjermanovic/orgs","repos_url":"https://api.github.com/users/mdjermanovic/repos","events_url":"https://api.github.com/users/mdjermanovic/events{/privacy}","received_events_url":"https://api.github.com/users/mdjermanovic/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/eslint/eslint/issues/19322/reactions","total_count":5,"+1":5,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/eslint/eslint/issues/19322/timeline","performed_via_github_app":null,"state_reason":"completed"}