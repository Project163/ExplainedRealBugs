{"url":"https://api.github.com/repos/eslint/eslint/issues/13634","repository_url":"https://api.github.com/repos/eslint/eslint","labels_url":"https://api.github.com/repos/eslint/eslint/issues/13634/labels{/name}","comments_url":"https://api.github.com/repos/eslint/eslint/issues/13634/comments","events_url":"https://api.github.com/repos/eslint/eslint/issues/13634/events","html_url":"https://github.com/eslint/eslint/issues/13634","id":688752864,"node_id":"MDU6SXNzdWU2ODg3NTI4NjQ=","number":13634,"title":"False negatives in 3 rules when right side of && expression is a literal","user":{"login":"btmills","id":1709537,"node_id":"MDQ6VXNlcjE3MDk1Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/1709537?v=4","gravatar_id":"","url":"https://api.github.com/users/btmills","html_url":"https://github.com/btmills","followers_url":"https://api.github.com/users/btmills/followers","following_url":"https://api.github.com/users/btmills/following{/other_user}","gists_url":"https://api.github.com/users/btmills/gists{/gist_id}","starred_url":"https://api.github.com/users/btmills/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/btmills/subscriptions","organizations_url":"https://api.github.com/users/btmills/orgs","repos_url":"https://api.github.com/users/btmills/repos","events_url":"https://api.github.com/users/btmills/events{/privacy}","received_events_url":"https://api.github.com/users/btmills/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":45711350,"node_id":"MDU6TGFiZWw0NTcxMTM1MA==","url":"https://api.github.com/repos/eslint/eslint/labels/bug","name":"bug","color":"fc2929","default":true,"description":"ESLint is working incorrectly"},{"id":45798639,"node_id":"MDU6TGFiZWw0NTc5ODYzOQ==","url":"https://api.github.com/repos/eslint/eslint/labels/rule","name":"rule","color":"fbca04","default":false,"description":"Relates to ESLint's core rules"},{"id":82922548,"node_id":"MDU6TGFiZWw4MjkyMjU0OA==","url":"https://api.github.com/repos/eslint/eslint/labels/core","name":"core","color":"c7def8","default":false,"description":"Relates to ESLint's core APIs and features"},{"id":255319420,"node_id":"MDU6TGFiZWwyNTUzMTk0MjA=","url":"https://api.github.com/repos/eslint/eslint/labels/evaluating","name":"evaluating","color":"fef2c0","default":false,"description":"The team will evaluate this issue to decide whether it meets the criteria for inclusion"},{"id":829215248,"node_id":"MDU6TGFiZWw4MjkyMTUyNDg=","url":"https://api.github.com/repos/eslint/eslint/labels/archived%20due%20to%20age","name":"archived due to age","color":"eeeeee","default":false,"description":"This issue has been archived; please open a new issue for any further discussion"}],"state":"closed","locked":true,"assignee":{"login":"btmills","id":1709537,"node_id":"MDQ6VXNlcjE3MDk1Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/1709537?v=4","gravatar_id":"","url":"https://api.github.com/users/btmills","html_url":"https://github.com/btmills","followers_url":"https://api.github.com/users/btmills/followers","following_url":"https://api.github.com/users/btmills/following{/other_user}","gists_url":"https://api.github.com/users/btmills/gists{/gist_id}","starred_url":"https://api.github.com/users/btmills/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/btmills/subscriptions","organizations_url":"https://api.github.com/users/btmills/orgs","repos_url":"https://api.github.com/users/btmills/repos","events_url":"https://api.github.com/users/btmills/events{/privacy}","received_events_url":"https://api.github.com/users/btmills/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"btmills","id":1709537,"node_id":"MDQ6VXNlcjE3MDk1Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/1709537?v=4","gravatar_id":"","url":"https://api.github.com/users/btmills","html_url":"https://github.com/btmills","followers_url":"https://api.github.com/users/btmills/followers","following_url":"https://api.github.com/users/btmills/following{/other_user}","gists_url":"https://api.github.com/users/btmills/gists{/gist_id}","starred_url":"https://api.github.com/users/btmills/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/btmills/subscriptions","organizations_url":"https://api.github.com/users/btmills/orgs","repos_url":"https://api.github.com/users/btmills/repos","events_url":"https://api.github.com/users/btmills/events{/privacy}","received_events_url":"https://api.github.com/users/btmills/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2020-08-30T16:54:44Z","updated_at":"2021-04-21T00:44:37Z","closed_at":"2020-10-22T09:18:16Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n    ESLint adheres to the Open JS Foundation Code of Conduct:\r\n    https://eslint.org/conduct\r\n\r\n    This template is for bug reports. If you are here for another reason, please see below:\r\n\r\n    1. To propose a new rule: https://eslint.org/docs/developer-guide/contributing/new-rules\r\n    2. To request a rule change: https://eslint.org/docs/developer-guide/contributing/rule-changes\r\n    3. To request a change that is not a bug fix, rule change, or new rule: https://eslint.org/docs/developer-guide/contributing/changes\r\n    4. If you have any questions, please stop by our chatroom: https://eslint.org/chat\r\n\r\n    Note that leaving sections blank will make it difficult for us to troubleshoot and we may have to close the issue.\r\n-->\r\n\r\n**Tell us about your environment**\r\n\r\n<!--\r\n    If you are using ESLint v6.5.0 or later, you can run ESLint with the `--env-info` flag and paste the output here.\r\n-->\r\n\r\n* **ESLint Version:** 7.7.0\r\n* **Node Version:** 14.9.0\r\n* **npm Version:** 6.14.7\r\n\r\n**What parser (default, `@babel/eslint-parser`, `@typescript-eslint/parser`, etc.) are you using?**\r\n\r\ndefault\r\n\r\n**Please show your full configuration:**\r\n\r\n<details>\r\n<summary>Configuration</summary>\r\n\r\n<!-- Paste your configuration below: -->\r\n```js\r\nmodule.exports = {\r\n    parserOptions: {\r\n        ecmaVersion: 2020\r\n    }\r\n};\r\n```\r\n\r\n</details>\r\n\r\n**What did you do? Please include the actual source code causing the issue, as well as the command that you used to run ESLint.**\r\n\r\n<!-- Paste the source code below: -->\r\n```js\r\n/* eslint constructor-super: \"error\",\r\n   no-throw-literal: \"error\",\r\n   prefer-promise-reject-errors: \"error\"\r\n */\r\nlet anything;\r\n\r\n// If anything is a constructor, it'll be truthy, we'll evaluate the\r\n// right side of the &&, and we'll extend 42.\r\nclass Subclass extends (anything && 42) {\r\n    constructor() {\r\n        super();\r\n    }\r\n}\r\n\r\n// If anything is an Error instance, it'll be truthy, we'll evaluate\r\n// the right side of the &&, and we'll throw 42.\r\nthrow anything && 42;\r\n\r\n// If anything is an Error instance, it'll be truthy, we'll evaluate\r\n// the right side of the &&, and we'll reject with 42.\r\nPromise.reject(anything && 5);\r\n```\r\n\r\n<!-- Paste the command you used to run ESLint: -->\r\n[Demo](https://eslint.org/demo#eyJ0ZXh0IjoiLyogZXNsaW50IGNvbnN0cnVjdG9yLXN1cGVyOiBcImVycm9yXCIsXG4gICBuby10aHJvdy1saXRlcmFsOiBcImVycm9yXCIsXG4gICBwcmVmZXItcHJvbWlzZS1yZWplY3QtZXJyb3JzOiBcImVycm9yXCJcbiAqL1xubGV0IGFueXRoaW5nO1xuXG4vLyBJZiBhbnl0aGluZyBpcyBhIGNvbnN0cnVjdG9yLCBpdCdsbCBiZSB0cnV0aHksIHdlJ2xsIGV2YWx1YXRlIHRoZVxuLy8gcmlnaHQgc2lkZSBvZiB0aGUgJiYsIGFuZCB3ZSdsbCBleHRlbmQgNDIuXG5jbGFzcyBTdWJjbGFzcyBleHRlbmRzIChhbnl0aGluZyAmJiA0Mikge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgIH1cbn1cblxuLy8gSWYgYW55dGhpbmcgaXMgYW4gRXJyb3IgaW5zdGFuY2UsIGl0J2xsIGJlIHRydXRoeSwgd2UnbGwgZXZhbHVhdGVcbi8vIHRoZSByaWdodCBzaWRlIG9mIHRoZSAmJiwgYW5kIHdlJ2xsIHRocm93IDQyLlxudGhyb3cgYW55dGhpbmcgJiYgNDI7XG5cbi8vIElmIGFueXRoaW5nIGlzIGFuIEVycm9yIGluc3RhbmNlLCBpdCdsbCBiZSB0cnV0aHksIHdlJ2xsIGV2YWx1YXRlXG4vLyB0aGUgcmlnaHQgc2lkZSBvZiB0aGUgJiYsIGFuZCB3ZSdsbCByZWplY3Qgd2l0aCA0Mi5cblByb21pc2UucmVqZWN0KGFueXRoaW5nICYmIDUpOyIsIm9wdGlvbnMiOnsicGFyc2VyT3B0aW9ucyI6eyJlY21hVmVyc2lvbiI6MTEsInNvdXJjZVR5cGUiOiJzY3JpcHQiLCJlY21hRmVhdHVyZXMiOnt9fSwicnVsZXMiOnt9LCJlbnYiOnt9fX0=)\r\n\r\n**What did you expect to happen?**\r\n\r\nWe should report errors in each of the above cases. All three are looking for a specific type of truthy value from the expression. Because the expression uses `&&`, any possibly-valid value would evaluate to the right side of the expression, which would not be a valid value in these examples.\r\n\r\nThis was originally discovered in https://github.com/eslint/eslint/pull/13618#discussion_r479584827. Because it relates to existing behavior that existed prior to that pull request, we decided to split it into its own issue that can be fixed after the pull request is merged. This bug is a false negative in the 3 rules above, and fixing it would cause them to report more errors. Does anyone object to fixing this in a semver-minor change as allowed by our semver policy?\r\n\r\nThe fix would update both [`astUtils.couldBeError()`](https://github.com/eslint/eslint/blob/a32032430a0779a4e3b2d137d4d0682844084b82/lib/rules/utils/ast-utils.js#L1587-L1588) and [`constructor-super`'s `isPossibleConstructor()`](https://github.com/eslint/eslint/blob/a32032430a0779a4e3b2d137d4d0682844084b82/lib/rules/constructor-super.js#L65-L69) to only check the right side of `&&` `LogicalExpression`s.\r\n\r\n**What actually happened? Please include the actual, raw output from ESLint.**\r\n\r\nNo errors are reported.\r\n\r\n**Are you willing to submit a pull request to fix this bug?**\r\n\r\nYes, if @mdjermanovic doesn't get to it first.","closed_by":{"login":"mdjermanovic","id":44349756,"node_id":"MDQ6VXNlcjQ0MzQ5NzU2","avatar_url":"https://avatars.githubusercontent.com/u/44349756?v=4","gravatar_id":"","url":"https://api.github.com/users/mdjermanovic","html_url":"https://github.com/mdjermanovic","followers_url":"https://api.github.com/users/mdjermanovic/followers","following_url":"https://api.github.com/users/mdjermanovic/following{/other_user}","gists_url":"https://api.github.com/users/mdjermanovic/gists{/gist_id}","starred_url":"https://api.github.com/users/mdjermanovic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdjermanovic/subscriptions","organizations_url":"https://api.github.com/users/mdjermanovic/orgs","repos_url":"https://api.github.com/users/mdjermanovic/repos","events_url":"https://api.github.com/users/mdjermanovic/events{/privacy}","received_events_url":"https://api.github.com/users/mdjermanovic/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/eslint/eslint/issues/13634/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/eslint/eslint/issues/13634/timeline","performed_via_github_app":null,"state_reason":"completed"}