{"url":"https://api.github.com/repos/eslint/eslint/issues/15036","repository_url":"https://api.github.com/repos/eslint/eslint","labels_url":"https://api.github.com/repos/eslint/eslint/issues/15036/labels{/name}","comments_url":"https://api.github.com/repos/eslint/eslint/issues/15036/comments","events_url":"https://api.github.com/repos/eslint/eslint/issues/15036/events","html_url":"https://github.com/eslint/eslint/issues/15036","id":990959887,"node_id":"MDU6SXNzdWU5OTA5NTk4ODc=","number":15036,"title":"Change Request: Allow to patch ModuleResolver in ESLint 8","user":{"login":"onigoetz","id":309594,"node_id":"MDQ6VXNlcjMwOTU5NA==","avatar_url":"https://avatars.githubusercontent.com/u/309594?v=4","gravatar_id":"","url":"https://api.github.com/users/onigoetz","html_url":"https://github.com/onigoetz","followers_url":"https://api.github.com/users/onigoetz/followers","following_url":"https://api.github.com/users/onigoetz/following{/other_user}","gists_url":"https://api.github.com/users/onigoetz/gists{/gist_id}","starred_url":"https://api.github.com/users/onigoetz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/onigoetz/subscriptions","organizations_url":"https://api.github.com/users/onigoetz/orgs","repos_url":"https://api.github.com/users/onigoetz/repos","events_url":"https://api.github.com/users/onigoetz/events{/privacy}","received_events_url":"https://api.github.com/users/onigoetz/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":45711352,"node_id":"MDU6TGFiZWw0NTcxMTM1Mg==","url":"https://api.github.com/repos/eslint/eslint/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":"This change enhances an existing feature of ESLint"},{"id":82922548,"node_id":"MDU6TGFiZWw4MjkyMjU0OA==","url":"https://api.github.com/repos/eslint/eslint/labels/core","name":"core","color":"c7def8","default":false,"description":"Relates to ESLint's core APIs and features"},{"id":131106229,"node_id":"MDU6TGFiZWwxMzExMDYyMjk=","url":"https://api.github.com/repos/eslint/eslint/labels/accepted","name":"accepted","color":"0052cc","default":false,"description":"There is consensus among the team that this change meets the criteria for inclusion"},{"id":829215248,"node_id":"MDU6TGFiZWw4MjkyMTUyNDg=","url":"https://api.github.com/repos/eslint/eslint/labels/archived%20due%20to%20age","name":"archived due to age","color":"eeeeee","default":false,"description":"This issue has been archived; please open a new issue for any further discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":19,"created_at":"2021-09-08T10:01:30Z","updated_at":"2022-04-08T16:51:22Z","closed_at":"2021-10-09T20:30:17Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### ESLint version\n\n8.0.0-beta.1\n\n### What problem do you want to solve?\n\nIn the current version of ESLint, it's currently not possible to have plugins as dependencies in shared configs (as detailed in #3458)\r\nIt is however possible to patch `ModuleResolver` to make this work : \r\n* https://github.com/microsoft/rushstack/tree/master/stack/eslint-patch\r\n* https://github.com/swissquote/crafty/blob/master/packages/crafty-preset-eslint/src/patchModuleResolver.js\r\n\r\nThe patch isn't anything fancy: \r\nhttps://github.com/swissquote/crafty/blob/master/packages/crafty-preset-eslint/src/patchModuleResolver.js#L78-L95\r\n\r\nBut it works better than `--resolve-plugins-relative-to` since it allows to have logic for more than one directory and doesn't require the end-user to add it to each of his calls to `eslint`\r\n\r\nNow since this patching accesses the modules directly at their location inside the `eslint` or `@eslint/eslintrc` package it won't be possible anymore as \r\n* they will be using `exports` in `package.json`\r\n* `@eslint/eslintrc` is bundled so we can't refer to a module directly\r\n* Rollup automatically wraps exports in `Object.freeze` thus effectively blocking `require(\"@eslint/eslintrc\").Legacy.ModuleResolver.resolve = someNewResolver`\r\n* Even if patching worked, Rollup simplifies module references to directly refer to the `resolve` function so it wouldn't take the patch into consideration anyway. ( https://github.com/eslint/eslintrc/pull/53#issuecomment-914387028 )\r\n\r\n\n\n### What do you think is the correct solution?\n\nThe easiest solution I would see and was proposed by @mdjermanovic : disable the freezing of objects by Rollup : https://github.com/eslint/eslintrc/pull/53#issuecomment-914354947\r\n\r\nThat would need to be combined with something that makes sure to not refer to the function directly but to refer to the `ModuleResolver` object so that the patching works.\r\n\r\nThis summary is a follow up of the discussion in https://github.com/eslint/eslintrc/pull/53\n\n### Participation\n\n- [X] I am willing to submit a pull request for this change.","closed_by":{"login":"btmills","id":1709537,"node_id":"MDQ6VXNlcjE3MDk1Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/1709537?v=4","gravatar_id":"","url":"https://api.github.com/users/btmills","html_url":"https://github.com/btmills","followers_url":"https://api.github.com/users/btmills/followers","following_url":"https://api.github.com/users/btmills/following{/other_user}","gists_url":"https://api.github.com/users/btmills/gists{/gist_id}","starred_url":"https://api.github.com/users/btmills/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/btmills/subscriptions","organizations_url":"https://api.github.com/users/btmills/orgs","repos_url":"https://api.github.com/users/btmills/repos","events_url":"https://api.github.com/users/btmills/events{/privacy}","received_events_url":"https://api.github.com/users/btmills/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/eslint/eslint/issues/15036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/eslint/eslint/issues/15036/timeline","performed_via_github_app":null,"state_reason":"completed"}