{"url":"https://api.github.com/repos/eslint/eslint/issues/12874","repository_url":"https://api.github.com/repos/eslint/eslint","labels_url":"https://api.github.com/repos/eslint/eslint/issues/12874/labels{/name}","comments_url":"https://api.github.com/repos/eslint/eslint/issues/12874/comments","events_url":"https://api.github.com/repos/eslint/eslint/issues/12874/events","html_url":"https://github.com/eslint/eslint/issues/12874","id":560289940,"node_id":"MDU6SXNzdWU1NjAyODk5NDA=","number":12874,"title":"new cap: option capIsNewExceptionPattern is not behaving as documented","user":{"login":"l1bbcsg","id":1044684,"node_id":"MDQ6VXNlcjEwNDQ2ODQ=","avatar_url":"https://avatars.githubusercontent.com/u/1044684?v=4","gravatar_id":"","url":"https://api.github.com/users/l1bbcsg","html_url":"https://github.com/l1bbcsg","followers_url":"https://api.github.com/users/l1bbcsg/followers","following_url":"https://api.github.com/users/l1bbcsg/following{/other_user}","gists_url":"https://api.github.com/users/l1bbcsg/gists{/gist_id}","starred_url":"https://api.github.com/users/l1bbcsg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l1bbcsg/subscriptions","organizations_url":"https://api.github.com/users/l1bbcsg/orgs","repos_url":"https://api.github.com/users/l1bbcsg/repos","events_url":"https://api.github.com/users/l1bbcsg/events{/privacy}","received_events_url":"https://api.github.com/users/l1bbcsg/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":45798639,"node_id":"MDU6TGFiZWw0NTc5ODYzOQ==","url":"https://api.github.com/repos/eslint/eslint/labels/rule","name":"rule","color":"fbca04","default":false,"description":"Relates to ESLint's core rules"},{"id":64004798,"node_id":"MDU6TGFiZWw2NDAwNDc5OA==","url":"https://api.github.com/repos/eslint/eslint/labels/documentation","name":"documentation","color":"5319e7","default":true,"description":"Relates to ESLint's documentation"},{"id":131106229,"node_id":"MDU6TGFiZWwxMzExMDYyMjk=","url":"https://api.github.com/repos/eslint/eslint/labels/accepted","name":"accepted","color":"0052cc","default":false,"description":"There is consensus among the team that this change meets the criteria for inclusion"},{"id":829215248,"node_id":"MDU6TGFiZWw4MjkyMTUyNDg=","url":"https://api.github.com/repos/eslint/eslint/labels/archived%20due%20to%20age","name":"archived due to age","color":"eeeeee","default":false,"description":"This issue has been archived; please open a new issue for any further discussion"}],"state":"closed","locked":true,"assignee":{"login":"mdjermanovic","id":44349756,"node_id":"MDQ6VXNlcjQ0MzQ5NzU2","avatar_url":"https://avatars.githubusercontent.com/u/44349756?v=4","gravatar_id":"","url":"https://api.github.com/users/mdjermanovic","html_url":"https://github.com/mdjermanovic","followers_url":"https://api.github.com/users/mdjermanovic/followers","following_url":"https://api.github.com/users/mdjermanovic/following{/other_user}","gists_url":"https://api.github.com/users/mdjermanovic/gists{/gist_id}","starred_url":"https://api.github.com/users/mdjermanovic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdjermanovic/subscriptions","organizations_url":"https://api.github.com/users/mdjermanovic/orgs","repos_url":"https://api.github.com/users/mdjermanovic/repos","events_url":"https://api.github.com/users/mdjermanovic/events{/privacy}","received_events_url":"https://api.github.com/users/mdjermanovic/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"mdjermanovic","id":44349756,"node_id":"MDQ6VXNlcjQ0MzQ5NzU2","avatar_url":"https://avatars.githubusercontent.com/u/44349756?v=4","gravatar_id":"","url":"https://api.github.com/users/mdjermanovic","html_url":"https://github.com/mdjermanovic","followers_url":"https://api.github.com/users/mdjermanovic/followers","following_url":"https://api.github.com/users/mdjermanovic/following{/other_user}","gists_url":"https://api.github.com/users/mdjermanovic/gists{/gist_id}","starred_url":"https://api.github.com/users/mdjermanovic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdjermanovic/subscriptions","organizations_url":"https://api.github.com/users/mdjermanovic/orgs","repos_url":"https://api.github.com/users/mdjermanovic/repos","events_url":"https://api.github.com/users/mdjermanovic/events{/privacy}","received_events_url":"https://api.github.com/users/mdjermanovic/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":8,"created_at":"2020-02-05T10:50:35Z","updated_at":"2021-12-24T01:09:54Z","closed_at":"2021-06-26T19:01:46Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Documentation for `capIsNewExceptionPattern` says the following:\r\n> allows any uppercase-started **function names that match** the specified regex pattern to be called without the new operator.\r\n\r\nHowever, the actual behaviour seems to be that entire [call expression is matched](https://github.com/eslint/eslint/blob/439c83342c364ba3ce5168d54e165b1fe3e35630/lib/rules/new-cap.js#L211) against the pattern, not just the function name.\r\n\r\nEither `capIsNewExceptionPattern` should match only function name, or the documentation should reflect the actual behaviour.\r\n\r\nI believe matching code with regex is fundamentally wrong and the first option is more sane solution. So, the documentation should stay as is, behaviour corrected and example updated, but that might be a breaking change.\r\n\r\nAdditionally, [the example](https://eslint.org/docs/rules/new-cap#capisnewexceptionpattern) given as \"correct code for this rule\" is actually producing warnings (see demo), the reason being the regex configured does not match anything in the code at all.\r\n\r\nAlso other options of this rule may be poorly documented as well, for example `capIsNewExceptions` also states that it matches names, while actually it can match either name or full expression.\r\n\r\n**Tell us about your environment**\r\n\r\nNode version: v12.10.0\r\nnpm version: v6.10.3\r\nLocal ESLint version: v6.8.0 (Currently used)\r\nGlobal ESLint version: Not found\r\n\r\nAlso same result on whatever version is currently deployed as demo.\r\n\r\n**Please show your full configuration:**\r\n\r\n<details>\r\n<summary>Demo links</summary>\r\n\r\nExpected no warnings: https://eslint.org/demo#eyJ0ZXh0IjoiLyplc2xpbnQgbmV3LWNhcDogW1wiZXJyb3JcIiwgeyBcImNhcElzTmV3RXhjZXB0aW9uUGF0dGVyblwiOiBcIl5CYXIkXCIgfV0qL1xuXG5mb28uQmFyKCk7Iiwib3B0aW9ucyI6eyJwYXJzZXJPcHRpb25zIjp7ImVjbWFWZXJzaW9uIjoxMCwic291cmNlVHlwZSI6Im1vZHVsZSIsImVjbWFGZWF0dXJlcyI6e319LCJydWxlcyI6e30sImVudiI6e319fQ==\r\n\r\nNot expected to ignore:\r\nhttps://eslint.org/demo#eyJ0ZXh0IjoiLyplc2xpbnQgbmV3LWNhcDogW1wiZXJyb3JcIiwgeyBcImNhcElzTmV3RXhjZXB0aW9uUGF0dGVyblwiOiBcIl5mb29cXC5CYXIkXCIgfV0qL1xuXG5mb28uQmFyKCk7Iiwib3B0aW9ucyI6eyJwYXJzZXJPcHRpb25zIjp7ImVjbWFWZXJzaW9uIjoxMCwic291cmNlVHlwZSI6Im1vZHVsZSIsImVjbWFGZWF0dXJlcyI6e319LCJydWxlcyI6e30sImVudiI6e319fQ==\r\n\r\nDocumentation example, wrong on several accounts: https://eslint.org/demo#eyJ0ZXh0IjoiLyplc2xpbnQgbmV3LWNhcDogW1wiZXJyb3JcIiwgeyBcImNhcElzTmV3RXhjZXB0aW9uUGF0dGVyblwiOiBcIl5QZXJzb25cXC4uXCIgfV0qL1xuXG52YXIgZnJpZW5kID0gcGVyc29uLkFjcXVhaW50YW5jZSgpO1xudmFyIGJlc3RGcmllbmQgPSBwZXJzb24uRnJpZW5kKCk7Iiwib3B0aW9ucyI6eyJwYXJzZXJPcHRpb25zIjp7ImVjbWFWZXJzaW9uIjoxMCwic291cmNlVHlwZSI6Im1vZHVsZSIsImVjbWFGZWF0dXJlcyI6e319LCJydWxlcyI6e30sImVudiI6e319fQ==\r\n</details>\r\n\r\n\r\n**What did you do?**\r\n\r\nConfiguration:\r\n```\r\neslint new-cap: [\"error\", { \"capIsNewExceptionPattern\": \"^Bar$\" }]\r\n```\r\n\r\nCode:\r\n```js\r\nfoo.Bar();\r\n```\r\n\r\n**What did you expect to happen?**\r\n\r\nNo warnings as function named `Bar` should be ignored.\r\n\r\n**What actually happened? Please include the actual, raw output from ESLint.**\r\n\r\nA warning against function `Bar`.\r\n\r\n**Are you willing to submit a pull request to fix this bug?**\r\n\r\nOnly if it's as trivial as `pattern.test(calleeName)`, but then it's probably trivial for anyone else as well.\r\n","closed_by":{"login":"mdjermanovic","id":44349756,"node_id":"MDQ6VXNlcjQ0MzQ5NzU2","avatar_url":"https://avatars.githubusercontent.com/u/44349756?v=4","gravatar_id":"","url":"https://api.github.com/users/mdjermanovic","html_url":"https://github.com/mdjermanovic","followers_url":"https://api.github.com/users/mdjermanovic/followers","following_url":"https://api.github.com/users/mdjermanovic/following{/other_user}","gists_url":"https://api.github.com/users/mdjermanovic/gists{/gist_id}","starred_url":"https://api.github.com/users/mdjermanovic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdjermanovic/subscriptions","organizations_url":"https://api.github.com/users/mdjermanovic/orgs","repos_url":"https://api.github.com/users/mdjermanovic/repos","events_url":"https://api.github.com/users/mdjermanovic/events{/privacy}","received_events_url":"https://api.github.com/users/mdjermanovic/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/eslint/eslint/issues/12874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/eslint/eslint/issues/12874/timeline","performed_via_github_app":null,"state_reason":"completed"}