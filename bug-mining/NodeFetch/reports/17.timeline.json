[{"id":5636433895,"node_id":"LE_lADOAcd5ZM4_AAW0zwAAAAFP9Sfn","url":"https://api.github.com/repos/node-fetch/node-fetch/issues/events/5636433895","actor":{"login":"tasinet","id":1698456,"node_id":"MDQ6VXNlcjE2OTg0NTY=","avatar_url":"https://avatars.githubusercontent.com/u/1698456?v=4","gravatar_id":"","url":"https://api.github.com/users/tasinet","html_url":"https://github.com/tasinet","followers_url":"https://api.github.com/users/tasinet/followers","following_url":"https://api.github.com/users/tasinet/following{/other_user}","gists_url":"https://api.github.com/users/tasinet/gists{/gist_id}","starred_url":"https://api.github.com/users/tasinet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tasinet/subscriptions","organizations_url":"https://api.github.com/users/tasinet/orgs","repos_url":"https://api.github.com/users/tasinet/repos","events_url":"https://api.github.com/users/tasinet/events{/privacy}","received_events_url":"https://api.github.com/users/tasinet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-11-18T05:49:00Z","label":{"name":"bug","color":"fc2929"},"performed_via_github_app":null},{"id":5636444285,"node_id":"REFE_lADOAcd5ZM4_AAW0zwAAAAFP9VB9","url":"https://api.github.com/repos/node-fetch/node-fetch/issues/events/5636444285","actor":{"login":"tasinet","id":1698456,"node_id":"MDQ6VXNlcjE2OTg0NTY=","avatar_url":"https://avatars.githubusercontent.com/u/1698456?v=4","gravatar_id":"","url":"https://api.github.com/users/tasinet","html_url":"https://github.com/tasinet","followers_url":"https://api.github.com/users/tasinet/followers","following_url":"https://api.github.com/users/tasinet/following{/other_user}","gists_url":"https://api.github.com/users/tasinet/gists{/gist_id}","starred_url":"https://api.github.com/users/tasinet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tasinet/subscriptions","organizations_url":"https://api.github.com/users/tasinet/orgs","repos_url":"https://api.github.com/users/tasinet/repos","events_url":"https://api.github.com/users/tasinet/events{/privacy}","received_events_url":"https://api.github.com/users/tasinet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"b79fb8c601ee6656472db5116b395c8221e36650","commit_url":"https://api.github.com/repos/tasinet/node-fetch/commits/b79fb8c601ee6656472db5116b395c8221e36650","created_at":"2021-11-18T05:52:46Z","performed_via_github_app":null},{"actor":{"login":"tasinet","id":1698456,"node_id":"MDQ6VXNlcjE2OTg0NTY=","avatar_url":"https://avatars.githubusercontent.com/u/1698456?v=4","gravatar_id":"","url":"https://api.github.com/users/tasinet","html_url":"https://github.com/tasinet","followers_url":"https://api.github.com/users/tasinet/followers","following_url":"https://api.github.com/users/tasinet/following{/other_user}","gists_url":"https://api.github.com/users/tasinet/gists{/gist_id}","starred_url":"https://api.github.com/users/tasinet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tasinet/subscriptions","organizations_url":"https://api.github.com/users/tasinet/orgs","repos_url":"https://api.github.com/users/tasinet/repos","events_url":"https://api.github.com/users/tasinet/events{/privacy}","received_events_url":"https://api.github.com/users/tasinet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T05:54:30Z","updated_at":"2021-11-18T05:54:30Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/node-fetch/node-fetch/issues/1387","repository_url":"https://api.github.com/repos/node-fetch/node-fetch","labels_url":"https://api.github.com/repos/node-fetch/node-fetch/issues/1387/labels{/name}","comments_url":"https://api.github.com/repos/node-fetch/node-fetch/issues/1387/comments","events_url":"https://api.github.com/repos/node-fetch/node-fetch/issues/1387/events","html_url":"https://github.com/node-fetch/node-fetch/pull/1387","id":1056968651,"node_id":"PR_kwDOAcd5ZM4usds-","number":1387,"title":"fix(Redirect): Better handle wrong redirect header in a response","user":{"login":"tasinet","id":1698456,"node_id":"MDQ6VXNlcjE2OTg0NTY=","avatar_url":"https://avatars.githubusercontent.com/u/1698456?v=4","gravatar_id":"","url":"https://api.github.com/users/tasinet","html_url":"https://github.com/tasinet","followers_url":"https://api.github.com/users/tasinet/followers","following_url":"https://api.github.com/users/tasinet/following{/other_user}","gists_url":"https://api.github.com/users/tasinet/gists{/gist_id}","starred_url":"https://api.github.com/users/tasinet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tasinet/subscriptions","organizations_url":"https://api.github.com/users/tasinet/orgs","repos_url":"https://api.github.com/users/tasinet/repos","events_url":"https://api.github.com/users/tasinet/events{/privacy}","received_events_url":"https://api.github.com/users/tasinet/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2021-11-18T05:54:30Z","updated_at":"2021-11-26T10:19:25Z","closed_at":"2021-11-26T10:19:25Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":29849956,"node_id":"MDEwOlJlcG9zaXRvcnkyOTg0OTk1Ng==","name":"node-fetch","full_name":"node-fetch/node-fetch","private":false,"owner":{"login":"node-fetch","id":59502381,"node_id":"MDEyOk9yZ2FuaXphdGlvbjU5NTAyMzgx","avatar_url":"https://avatars.githubusercontent.com/u/59502381?v=4","gravatar_id":"","url":"https://api.github.com/users/node-fetch","html_url":"https://github.com/node-fetch","followers_url":"https://api.github.com/users/node-fetch/followers","following_url":"https://api.github.com/users/node-fetch/following{/other_user}","gists_url":"https://api.github.com/users/node-fetch/gists{/gist_id}","starred_url":"https://api.github.com/users/node-fetch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/node-fetch/subscriptions","organizations_url":"https://api.github.com/users/node-fetch/orgs","repos_url":"https://api.github.com/users/node-fetch/repos","events_url":"https://api.github.com/users/node-fetch/events{/privacy}","received_events_url":"https://api.github.com/users/node-fetch/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/node-fetch/node-fetch","description":"A light-weight module that brings the Fetch API to Node.js","fork":false,"url":"https://api.github.com/repos/node-fetch/node-fetch","forks_url":"https://api.github.com/repos/node-fetch/node-fetch/forks","keys_url":"https://api.github.com/repos/node-fetch/node-fetch/keys{/key_id}","collaborators_url":"https://api.github.com/repos/node-fetch/node-fetch/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/node-fetch/node-fetch/teams","hooks_url":"https://api.github.com/repos/node-fetch/node-fetch/hooks","issue_events_url":"https://api.github.com/repos/node-fetch/node-fetch/issues/events{/number}","events_url":"https://api.github.com/repos/node-fetch/node-fetch/events","assignees_url":"https://api.github.com/repos/node-fetch/node-fetch/assignees{/user}","branches_url":"https://api.github.com/repos/node-fetch/node-fetch/branches{/branch}","tags_url":"https://api.github.com/repos/node-fetch/node-fetch/tags","blobs_url":"https://api.github.com/repos/node-fetch/node-fetch/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/node-fetch/node-fetch/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/node-fetch/node-fetch/git/refs{/sha}","trees_url":"https://api.github.com/repos/node-fetch/node-fetch/git/trees{/sha}","statuses_url":"https://api.github.com/repos/node-fetch/node-fetch/statuses/{sha}","languages_url":"https://api.github.com/repos/node-fetch/node-fetch/languages","stargazers_url":"https://api.github.com/repos/node-fetch/node-fetch/stargazers","contributors_url":"https://api.github.com/repos/node-fetch/node-fetch/contributors","subscribers_url":"https://api.github.com/repos/node-fetch/node-fetch/subscribers","subscription_url":"https://api.github.com/repos/node-fetch/node-fetch/subscription","commits_url":"https://api.github.com/repos/node-fetch/node-fetch/commits{/sha}","git_commits_url":"https://api.github.com/repos/node-fetch/node-fetch/git/commits{/sha}","comments_url":"https://api.github.com/repos/node-fetch/node-fetch/comments{/number}","issue_comment_url":"https://api.github.com/repos/node-fetch/node-fetch/issues/comments{/number}","contents_url":"https://api.github.com/repos/node-fetch/node-fetch/contents/{+path}","compare_url":"https://api.github.com/repos/node-fetch/node-fetch/compare/{base}...{head}","merges_url":"https://api.github.com/repos/node-fetch/node-fetch/merges","archive_url":"https://api.github.com/repos/node-fetch/node-fetch/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/node-fetch/node-fetch/downloads","issues_url":"https://api.github.com/repos/node-fetch/node-fetch/issues{/number}","pulls_url":"https://api.github.com/repos/node-fetch/node-fetch/pulls{/number}","milestones_url":"https://api.github.com/repos/node-fetch/node-fetch/milestones{/number}","notifications_url":"https://api.github.com/repos/node-fetch/node-fetch/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/node-fetch/node-fetch/labels{/name}","releases_url":"https://api.github.com/repos/node-fetch/node-fetch/releases{/id}","deployments_url":"https://api.github.com/repos/node-fetch/node-fetch/deployments","created_at":"2015-01-26T07:29:26Z","updated_at":"2025-11-09T01:26:52Z","pushed_at":"2024-08-13T22:17:04Z","git_url":"git://github.com/node-fetch/node-fetch.git","ssh_url":"git@github.com:node-fetch/node-fetch.git","clone_url":"https://github.com/node-fetch/node-fetch.git","svn_url":"https://github.com/node-fetch/node-fetch","homepage":"","size":1268,"stargazers_count":8845,"watchers_count":8845,"language":"JavaScript","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":1052,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":224,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["fetch","fetch-api","hacktoberfest","http","http-client","node-fetch","promise","spec-compliant","stream","whatwg","whatwg-fetch"],"visibility":"public","forks":1052,"open_issues":224,"watchers":8845,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/node-fetch/node-fetch/pulls/1387","html_url":"https://github.com/node-fetch/node-fetch/pull/1387","diff_url":"https://github.com/node-fetch/node-fetch/pull/1387.diff","patch_url":"https://github.com/node-fetch/node-fetch/pull/1387.patch","merged_at":"2021-11-26T10:19:25Z"},"body":"## Purpose\r\nFixes crash when a Location header point to an invalid URL\r\n\r\n## Changes\r\nJust wrapping `new URL()` in a try/catch and returning a sensible (?) error message\r\n\r\n## Additional information\r\nTest included\r\n\r\n___\r\n\r\n<!-- Mark the ones you have done and remove unnecessary ones. Add new tasks that fit (like TODOs). -->\r\n- [x] I updated ./docs/CHANGELOG.md with a link to this PR or Issue\r\n- [x] I added unit test(s)\r\n\r\n___\r\n\r\n<!-- Add `- Fixes #_NUMBER_` line for every PR/Issue this PR solves. Do not comma separate them. -->\r\n- Fixes #1386\r\n","reactions":{"url":"https://api.github.com/repos/node-fetch/node-fetch/issues/1387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/node-fetch/node-fetch/issues/1387/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"Abromeit","id":537920,"node_id":"MDQ6VXNlcjUzNzkyMA==","avatar_url":"https://avatars.githubusercontent.com/u/537920?v=4","gravatar_id":"","url":"https://api.github.com/users/Abromeit","html_url":"https://github.com/Abromeit","followers_url":"https://api.github.com/users/Abromeit/followers","following_url":"https://api.github.com/users/Abromeit/following{/other_user}","gists_url":"https://api.github.com/users/Abromeit/gists{/gist_id}","starred_url":"https://api.github.com/users/Abromeit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Abromeit/subscriptions","organizations_url":"https://api.github.com/users/Abromeit/orgs","repos_url":"https://api.github.com/users/Abromeit/repos","events_url":"https://api.github.com/users/Abromeit/events{/privacy}","received_events_url":"https://api.github.com/users/Abromeit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-20T10:15:05Z","updated_at":"2021-11-20T10:15:05Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/node-fetch/node-fetch/issues/1395","repository_url":"https://api.github.com/repos/node-fetch/node-fetch","labels_url":"https://api.github.com/repos/node-fetch/node-fetch/issues/1395/labels{/name}","comments_url":"https://api.github.com/repos/node-fetch/node-fetch/issues/1395/comments","events_url":"https://api.github.com/repos/node-fetch/node-fetch/issues/1395/events","html_url":"https://github.com/node-fetch/node-fetch/pull/1395","id":1059111826,"node_id":"PR_kwDOAcd5ZM4uzQOK","number":1395,"title":"fix: Add catch/reject for invalid redirect URLs","user":{"login":"Abromeit","id":537920,"node_id":"MDQ6VXNlcjUzNzkyMA==","avatar_url":"https://avatars.githubusercontent.com/u/537920?v=4","gravatar_id":"","url":"https://api.github.com/users/Abromeit","html_url":"https://github.com/Abromeit","followers_url":"https://api.github.com/users/Abromeit/followers","following_url":"https://api.github.com/users/Abromeit/following{/other_user}","gists_url":"https://api.github.com/users/Abromeit/gists{/gist_id}","starred_url":"https://api.github.com/users/Abromeit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Abromeit/subscriptions","organizations_url":"https://api.github.com/users/Abromeit/orgs","repos_url":"https://api.github.com/users/Abromeit/repos","events_url":"https://api.github.com/users/Abromeit/events{/privacy}","received_events_url":"https://api.github.com/users/Abromeit/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-11-20T10:15:05Z","updated_at":"2022-01-22T23:15:51Z","closed_at":"2021-11-20T14:39:56Z","author_association":"NONE","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":29849956,"node_id":"MDEwOlJlcG9zaXRvcnkyOTg0OTk1Ng==","name":"node-fetch","full_name":"node-fetch/node-fetch","private":false,"owner":{"login":"node-fetch","id":59502381,"node_id":"MDEyOk9yZ2FuaXphdGlvbjU5NTAyMzgx","avatar_url":"https://avatars.githubusercontent.com/u/59502381?v=4","gravatar_id":"","url":"https://api.github.com/users/node-fetch","html_url":"https://github.com/node-fetch","followers_url":"https://api.github.com/users/node-fetch/followers","following_url":"https://api.github.com/users/node-fetch/following{/other_user}","gists_url":"https://api.github.com/users/node-fetch/gists{/gist_id}","starred_url":"https://api.github.com/users/node-fetch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/node-fetch/subscriptions","organizations_url":"https://api.github.com/users/node-fetch/orgs","repos_url":"https://api.github.com/users/node-fetch/repos","events_url":"https://api.github.com/users/node-fetch/events{/privacy}","received_events_url":"https://api.github.com/users/node-fetch/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/node-fetch/node-fetch","description":"A light-weight module that brings the Fetch API to Node.js","fork":false,"url":"https://api.github.com/repos/node-fetch/node-fetch","forks_url":"https://api.github.com/repos/node-fetch/node-fetch/forks","keys_url":"https://api.github.com/repos/node-fetch/node-fetch/keys{/key_id}","collaborators_url":"https://api.github.com/repos/node-fetch/node-fetch/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/node-fetch/node-fetch/teams","hooks_url":"https://api.github.com/repos/node-fetch/node-fetch/hooks","issue_events_url":"https://api.github.com/repos/node-fetch/node-fetch/issues/events{/number}","events_url":"https://api.github.com/repos/node-fetch/node-fetch/events","assignees_url":"https://api.github.com/repos/node-fetch/node-fetch/assignees{/user}","branches_url":"https://api.github.com/repos/node-fetch/node-fetch/branches{/branch}","tags_url":"https://api.github.com/repos/node-fetch/node-fetch/tags","blobs_url":"https://api.github.com/repos/node-fetch/node-fetch/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/node-fetch/node-fetch/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/node-fetch/node-fetch/git/refs{/sha}","trees_url":"https://api.github.com/repos/node-fetch/node-fetch/git/trees{/sha}","statuses_url":"https://api.github.com/repos/node-fetch/node-fetch/statuses/{sha}","languages_url":"https://api.github.com/repos/node-fetch/node-fetch/languages","stargazers_url":"https://api.github.com/repos/node-fetch/node-fetch/stargazers","contributors_url":"https://api.github.com/repos/node-fetch/node-fetch/contributors","subscribers_url":"https://api.github.com/repos/node-fetch/node-fetch/subscribers","subscription_url":"https://api.github.com/repos/node-fetch/node-fetch/subscription","commits_url":"https://api.github.com/repos/node-fetch/node-fetch/commits{/sha}","git_commits_url":"https://api.github.com/repos/node-fetch/node-fetch/git/commits{/sha}","comments_url":"https://api.github.com/repos/node-fetch/node-fetch/comments{/number}","issue_comment_url":"https://api.github.com/repos/node-fetch/node-fetch/issues/comments{/number}","contents_url":"https://api.github.com/repos/node-fetch/node-fetch/contents/{+path}","compare_url":"https://api.github.com/repos/node-fetch/node-fetch/compare/{base}...{head}","merges_url":"https://api.github.com/repos/node-fetch/node-fetch/merges","archive_url":"https://api.github.com/repos/node-fetch/node-fetch/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/node-fetch/node-fetch/downloads","issues_url":"https://api.github.com/repos/node-fetch/node-fetch/issues{/number}","pulls_url":"https://api.github.com/repos/node-fetch/node-fetch/pulls{/number}","milestones_url":"https://api.github.com/repos/node-fetch/node-fetch/milestones{/number}","notifications_url":"https://api.github.com/repos/node-fetch/node-fetch/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/node-fetch/node-fetch/labels{/name}","releases_url":"https://api.github.com/repos/node-fetch/node-fetch/releases{/id}","deployments_url":"https://api.github.com/repos/node-fetch/node-fetch/deployments","created_at":"2015-01-26T07:29:26Z","updated_at":"2025-11-09T01:26:52Z","pushed_at":"2024-08-13T22:17:04Z","git_url":"git://github.com/node-fetch/node-fetch.git","ssh_url":"git@github.com:node-fetch/node-fetch.git","clone_url":"https://github.com/node-fetch/node-fetch.git","svn_url":"https://github.com/node-fetch/node-fetch","homepage":"","size":1268,"stargazers_count":8845,"watchers_count":8845,"language":"JavaScript","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":1052,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":224,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["fetch","fetch-api","hacktoberfest","http","http-client","node-fetch","promise","spec-compliant","stream","whatwg","whatwg-fetch"],"visibility":"public","forks":1052,"open_issues":224,"watchers":8845,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/node-fetch/node-fetch/pulls/1395","html_url":"https://github.com/node-fetch/node-fetch/pull/1395","diff_url":"https://github.com/node-fetch/node-fetch/pull/1395.diff","patch_url":"https://github.com/node-fetch/node-fetch/pull/1395.patch","merged_at":null},"body":"<!-- Thanks for contributing! -->\r\n\r\n## Purpose\r\n\r\nHTTP responses with invalid URLs in the location header field resulted in an uncatchable exception (`TypeError [ERR_INVALID_URL]: Invalid URL`), even in \"manual\" redirect-handling mode.\r\n\r\nThis patch fixes the issue, invalid redirect targets are now rejected gracefully.\r\n\r\n\r\n## Changes\r\n\r\n- Add missing try/catch block around `new URL(…)` in `request_.on('response', …)` of src/index.js\r\n- Introduce new FetchError type \"invalid-redirect\"\r\n\r\n## Additional information\r\n\r\nReal-world example to reproduce the problem: `Location: http://`\r\n\r\n___\r\n\r\n<!-- Mark the ones you have done and remove unnecessary ones. Add new tasks that fit (like TODOs). -->\r\n- [ ] I updated ./docs/CHANGELOG.md with a link to this PR or Issue\r\n- [ ] I updated ./docs/v3-UPGRADE-GUIDE\r\n- [ ] I updated readme\r\n- [ ] I added unit test(s)\r\n\r\n___\r\n\r\n<!-- Add `- Fixes #_NUMBER_` line for every PR/Issue this PR solves. Do not comma separate them. -->\r\n- fix #889\r\n- fix #1386\r\n\r\n","reactions":{"url":"https://api.github.com/repos/node-fetch/node-fetch/issues/1395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/node-fetch/node-fetch/issues/1395/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":5676806849,"node_id":"CE_lADOAcd5ZM4_AAW0zwAAAAFSXTLB","url":"https://api.github.com/repos/node-fetch/node-fetch/issues/events/5676806849","actor":{"login":"jimmywarting","id":1148376,"node_id":"MDQ6VXNlcjExNDgzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/1148376?v=4","gravatar_id":"","url":"https://api.github.com/users/jimmywarting","html_url":"https://github.com/jimmywarting","followers_url":"https://api.github.com/users/jimmywarting/followers","following_url":"https://api.github.com/users/jimmywarting/following{/other_user}","gists_url":"https://api.github.com/users/jimmywarting/gists{/gist_id}","starred_url":"https://api.github.com/users/jimmywarting/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimmywarting/subscriptions","organizations_url":"https://api.github.com/users/jimmywarting/orgs","repos_url":"https://api.github.com/users/jimmywarting/repos","events_url":"https://api.github.com/users/jimmywarting/events{/privacy}","received_events_url":"https://api.github.com/users/jimmywarting/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-11-26T10:19:25Z","state_reason":null,"performed_via_github_app":null},{"id":5676807016,"node_id":"REFE_lADOAcd5ZM4_AAW0zwAAAAFSXTNo","url":"https://api.github.com/repos/node-fetch/node-fetch/issues/events/5676807016","actor":{"login":"jimmywarting","id":1148376,"node_id":"MDQ6VXNlcjExNDgzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/1148376?v=4","gravatar_id":"","url":"https://api.github.com/users/jimmywarting","html_url":"https://github.com/jimmywarting","followers_url":"https://api.github.com/users/jimmywarting/followers","following_url":"https://api.github.com/users/jimmywarting/following{/other_user}","gists_url":"https://api.github.com/users/jimmywarting/gists{/gist_id}","starred_url":"https://api.github.com/users/jimmywarting/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimmywarting/subscriptions","organizations_url":"https://api.github.com/users/jimmywarting/orgs","repos_url":"https://api.github.com/users/jimmywarting/repos","events_url":"https://api.github.com/users/jimmywarting/events{/privacy}","received_events_url":"https://api.github.com/users/jimmywarting/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"6e4c1e4f67b7b6b8de13bbbf88991894dc003245","commit_url":"https://api.github.com/repos/node-fetch/node-fetch/commits/6e4c1e4f67b7b6b8de13bbbf88991894dc003245","created_at":"2021-11-26T10:19:27Z","performed_via_github_app":null},{"actor":{"login":"MohGanji","id":23494593,"node_id":"MDQ6VXNlcjIzNDk0NTkz","avatar_url":"https://avatars.githubusercontent.com/u/23494593?v=4","gravatar_id":"","url":"https://api.github.com/users/MohGanji","html_url":"https://github.com/MohGanji","followers_url":"https://api.github.com/users/MohGanji/followers","following_url":"https://api.github.com/users/MohGanji/following{/other_user}","gists_url":"https://api.github.com/users/MohGanji/gists{/gist_id}","starred_url":"https://api.github.com/users/MohGanji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MohGanji/subscriptions","organizations_url":"https://api.github.com/users/MohGanji/orgs","repos_url":"https://api.github.com/users/MohGanji/repos","events_url":"https://api.github.com/users/MohGanji/events{/privacy}","received_events_url":"https://api.github.com/users/MohGanji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-27T02:46:22Z","updated_at":"2022-04-27T02:46:22Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/npm/minipass-fetch/issues/59","repository_url":"https://api.github.com/repos/npm/minipass-fetch","labels_url":"https://api.github.com/repos/npm/minipass-fetch/issues/59/labels{/name}","comments_url":"https://api.github.com/repos/npm/minipass-fetch/issues/59/comments","events_url":"https://api.github.com/repos/npm/minipass-fetch/issues/59/events","html_url":"https://github.com/npm/minipass-fetch/pull/59","id":1216707909,"node_id":"PR_kwDODItR-c42104H","number":59,"title":"fix: TypeError crashes program in case of invalid url in redirect","user":{"login":"MohGanji","id":23494593,"node_id":"MDQ6VXNlcjIzNDk0NTkz","avatar_url":"https://avatars.githubusercontent.com/u/23494593?v=4","gravatar_id":"","url":"https://api.github.com/users/MohGanji","html_url":"https://github.com/MohGanji","followers_url":"https://api.github.com/users/MohGanji/followers","following_url":"https://api.github.com/users/MohGanji/following{/other_user}","gists_url":"https://api.github.com/users/MohGanji/gists{/gist_id}","starred_url":"https://api.github.com/users/MohGanji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MohGanji/subscriptions","organizations_url":"https://api.github.com/users/MohGanji/orgs","repos_url":"https://api.github.com/users/MohGanji/repos","events_url":"https://api.github.com/users/MohGanji/events{/privacy}","received_events_url":"https://api.github.com/users/MohGanji/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-04-27T02:46:22Z","updated_at":"2023-04-13T19:58:21Z","closed_at":"2023-04-13T19:58:22Z","author_association":"NONE","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":210457081,"node_id":"MDEwOlJlcG9zaXRvcnkyMTA0NTcwODE=","name":"minipass-fetch","full_name":"npm/minipass-fetch","private":false,"owner":{"login":"npm","id":6078720,"node_id":"MDEyOk9yZ2FuaXphdGlvbjYwNzg3MjA=","avatar_url":"https://avatars.githubusercontent.com/u/6078720?v=4","gravatar_id":"","url":"https://api.github.com/users/npm","html_url":"https://github.com/npm","followers_url":"https://api.github.com/users/npm/followers","following_url":"https://api.github.com/users/npm/following{/other_user}","gists_url":"https://api.github.com/users/npm/gists{/gist_id}","starred_url":"https://api.github.com/users/npm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/npm/subscriptions","organizations_url":"https://api.github.com/users/npm/orgs","repos_url":"https://api.github.com/users/npm/repos","events_url":"https://api.github.com/users/npm/events{/privacy}","received_events_url":"https://api.github.com/users/npm/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/npm/minipass-fetch","description":"An implementation of window.fetch in Node.js using Minipass streams","fork":false,"url":"https://api.github.com/repos/npm/minipass-fetch","forks_url":"https://api.github.com/repos/npm/minipass-fetch/forks","keys_url":"https://api.github.com/repos/npm/minipass-fetch/keys{/key_id}","collaborators_url":"https://api.github.com/repos/npm/minipass-fetch/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/npm/minipass-fetch/teams","hooks_url":"https://api.github.com/repos/npm/minipass-fetch/hooks","issue_events_url":"https://api.github.com/repos/npm/minipass-fetch/issues/events{/number}","events_url":"https://api.github.com/repos/npm/minipass-fetch/events","assignees_url":"https://api.github.com/repos/npm/minipass-fetch/assignees{/user}","branches_url":"https://api.github.com/repos/npm/minipass-fetch/branches{/branch}","tags_url":"https://api.github.com/repos/npm/minipass-fetch/tags","blobs_url":"https://api.github.com/repos/npm/minipass-fetch/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/npm/minipass-fetch/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/npm/minipass-fetch/git/refs{/sha}","trees_url":"https://api.github.com/repos/npm/minipass-fetch/git/trees{/sha}","statuses_url":"https://api.github.com/repos/npm/minipass-fetch/statuses/{sha}","languages_url":"https://api.github.com/repos/npm/minipass-fetch/languages","stargazers_url":"https://api.github.com/repos/npm/minipass-fetch/stargazers","contributors_url":"https://api.github.com/repos/npm/minipass-fetch/contributors","subscribers_url":"https://api.github.com/repos/npm/minipass-fetch/subscribers","subscription_url":"https://api.github.com/repos/npm/minipass-fetch/subscription","commits_url":"https://api.github.com/repos/npm/minipass-fetch/commits{/sha}","git_commits_url":"https://api.github.com/repos/npm/minipass-fetch/git/commits{/sha}","comments_url":"https://api.github.com/repos/npm/minipass-fetch/comments{/number}","issue_comment_url":"https://api.github.com/repos/npm/minipass-fetch/issues/comments{/number}","contents_url":"https://api.github.com/repos/npm/minipass-fetch/contents/{+path}","compare_url":"https://api.github.com/repos/npm/minipass-fetch/compare/{base}...{head}","merges_url":"https://api.github.com/repos/npm/minipass-fetch/merges","archive_url":"https://api.github.com/repos/npm/minipass-fetch/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/npm/minipass-fetch/downloads","issues_url":"https://api.github.com/repos/npm/minipass-fetch/issues{/number}","pulls_url":"https://api.github.com/repos/npm/minipass-fetch/pulls{/number}","milestones_url":"https://api.github.com/repos/npm/minipass-fetch/milestones{/number}","notifications_url":"https://api.github.com/repos/npm/minipass-fetch/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/npm/minipass-fetch/labels{/name}","releases_url":"https://api.github.com/repos/npm/minipass-fetch/releases{/id}","deployments_url":"https://api.github.com/repos/npm/minipass-fetch/deployments","created_at":"2019-09-23T21:36:10Z","updated_at":"2025-10-22T18:01:17Z","pushed_at":"2025-10-22T18:03:09Z","git_url":"git://github.com/npm/minipass-fetch.git","ssh_url":"git@github.com:npm/minipass-fetch.git","clone_url":"https://github.com/npm/minipass-fetch.git","svn_url":"https://github.com/npm/minipass-fetch","homepage":"","size":424,"stargazers_count":56,"watchers_count":56,"language":"JavaScript","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":10,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["npm-cli"],"visibility":"public","forks":10,"open_issues":1,"watchers":56,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/npm/minipass-fetch/pulls/59","html_url":"https://github.com/npm/minipass-fetch/pull/59","diff_url":"https://github.com/npm/minipass-fetch/pull/59.diff","patch_url":"https://github.com/npm/minipass-fetch/pull/59.patch","merged_at":null},"body":"## Description\r\n\r\nCalling `fetch()` on a server that responds with an invalid URL breaks the execution of the program with the following unhandled error:\r\n```python\r\ninternal/url.js:259\r\n  throw new ERR_INVALID_URL(input);\r\n  ^\r\n\r\nTypeError [ERR_INVALID_URL]: Invalid URL: :some:weird%invalid%url%\r\n```\r\n\r\n## Steps to reproduce:\r\n\r\n1. To simulate the environment that the bug appears in, set up a local server redirecting to an invalid URL\r\n\r\n```js\r\nconst http = require('http');\r\nconst server = http.createServer((req, res, next) => {\r\n\tres.writeHead(301, {'Location' : 'http://www.stackoverflow.com%'});\r\n\tres.end();\r\n});\r\nserver.listen(process.env.PORT || 3000);\r\n```\r\n\r\n2. Then running this code throws error and crashes the program despite `fetch()` being wrapped in a try/catch block.\r\n\r\n```js\r\nlet fetch = require('minipass-fetch')\r\n\r\n(async function {\r\n\ttry{\r\n\t\tvar res = await fetch(\r\n\t\t\t'http://localhost:3000',\r\n\t\t//\t{redirect: 'manual'}\r\n\t\t)\r\n\t\tconsole.log('val: ', res)\r\n\t} catch (err) {\r\n\t\tconsole.log('err: ', err)\r\n\t}\r\n})()\r\n```\r\n\r\n## References\r\nThis behavior is inconsistent with current node-fetch. Similar issue reported [#1386](https://github.com/node-fetch/node-fetch/issues/1386) and fixed [#1387](https://github.com/node-fetch/node-fetch/pull/1387) in node-fetch.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/npm/minipass-fetch/issues/59/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/npm/minipass-fetch/issues/59/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]