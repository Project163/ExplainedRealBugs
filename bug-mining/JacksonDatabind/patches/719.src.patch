diff --git a/release-notes/VERSION-2.x b/release-notes/VERSION-2.x
index 02ba470c9..2ac576297 100644
--- a/release-notes/VERSION-2.x
+++ b/release-notes/VERSION-2.x
@@ -24,6 +24,7 @@ Project: jackson-databind
 #4356: `BeanDeserializerModifier::updateBuilder()` doesn't work for
   beans with Creator methods
  (reported by Mark H)
+#4407: `null` type id handling does not work with `writeTypePrefix()`
 #4452: `@JsonProperty` not serializing field names properly
   on `@JsonCreator` in Record
  (reported by @Incara)
diff --git a/src/main/java/com/fasterxml/jackson/databind/jsontype/impl/AsArrayTypeDeserializer.java b/src/main/java/com/fasterxml/jackson/databind/jsontype/impl/AsArrayTypeDeserializer.java
index 94e7b732c..af2af513a 100644
--- a/src/main/java/com/fasterxml/jackson/databind/jsontype/impl/AsArrayTypeDeserializer.java
+++ b/src/main/java/com/fasterxml/jackson/databind/jsontype/impl/AsArrayTypeDeserializer.java
@@ -3,11 +3,14 @@ package com.fasterxml.jackson.databind.jsontype.impl;
 import java.io.IOException;
 
 import com.fasterxml.jackson.annotation.JsonTypeInfo.As;
+
 import com.fasterxml.jackson.core.*;
 import com.fasterxml.jackson.core.util.JsonParserSequence;
+
 import com.fasterxml.jackson.databind.*;
 import com.fasterxml.jackson.databind.jsontype.TypeDeserializer;
 import com.fasterxml.jackson.databind.jsontype.TypeIdResolver;
+import com.fasterxml.jackson.databind.util.ClassUtil;
 import com.fasterxml.jackson.databind.util.TokenBuffer;
 
 /**
@@ -136,7 +139,13 @@ public class AsArrayTypeDeserializer
             // Need to allow even more customized handling, if something unexpected seen...
             // but should there be a way to limit this to likely success cases?
             if (_defaultImpl != null) {
-                return _idResolver.idFromBaseType();
+                String id = _idResolver.idFromBaseType();
+                if (id == null) {
+                    ctxt.reportBadDefinition(_idResolver.getClass(),
+                            "`idFromBaseType()` (of "
+                            +ClassUtil.classNameOf(_idResolver)+") returned `null`");
+                }
+                return id;
             }
              ctxt.reportWrongTokenException(baseType(), JsonToken.START_ARRAY,
                      "need Array value to contain `As.WRAPPER_ARRAY` type information for class "+baseTypeName());
diff --git a/src/main/java/com/fasterxml/jackson/databind/jsontype/impl/TypeSerializerBase.java b/src/main/java/com/fasterxml/jackson/databind/jsontype/impl/TypeSerializerBase.java
index 6db57d640..40e8ddf10 100644
--- a/src/main/java/com/fasterxml/jackson/databind/jsontype/impl/TypeSerializerBase.java
+++ b/src/main/java/com/fasterxml/jackson/databind/jsontype/impl/TypeSerializerBase.java
@@ -5,7 +5,7 @@ import java.io.IOException;
 import com.fasterxml.jackson.annotation.JsonTypeInfo;
 
 import com.fasterxml.jackson.core.JsonGenerator;
-
+import com.fasterxml.jackson.core.JsonToken;
 import com.fasterxml.jackson.core.type.WritableTypeId;
 import com.fasterxml.jackson.databind.BeanProperty;
 import com.fasterxml.jackson.databind.jsontype.TypeIdResolver;
@@ -44,10 +44,10 @@ public abstract class TypeSerializerBase extends TypeSerializer
     {
         _generateTypeId(idMetadata);
         // 16-Jan-2022, tatu: As per [databind#3373], skip for null typeId.
-        //    And return "null" so that matching "writeTypeSuffix" call should
-        //    be avoided as well.
+        //    And return "null" to avoid matching "writeTypeSuffix" as well.
+        // 15-Jun-2024, tatu: [databind#4407] Not so fast! Output wrappers
         if (idMetadata.id == null) {
-            return null;
+            return _writeTypePrefixForNull(g, idMetadata);
         }
         return g.writeTypePrefix(idMetadata);
     }
@@ -57,12 +57,43 @@ public abstract class TypeSerializerBase extends TypeSerializer
             WritableTypeId idMetadata) throws IOException
     {
         // 16-Jan-2022, tatu: As per [databind#3373], skip for null:
+        // 15-Jun-2024, tatu: [databind#4407] except no, write closing wrapper
         if (idMetadata == null) {
-            return null;
+            return _writeTypeSuffixfixForNull(g, idMetadata);
         }
         return g.writeTypeSuffix(idMetadata);
     }
 
+    private WritableTypeId _writeTypePrefixForNull(JsonGenerator g,
+            WritableTypeId typeIdDef) throws IOException
+    {
+        // copied from `jackson-core`, `JsonGenerator.writeTypePrefix()`
+        final JsonToken valueShape = typeIdDef.valueShape;
+        typeIdDef.wrapperWritten = false;
+        if (valueShape == JsonToken.START_OBJECT) {
+            g.writeStartObject(typeIdDef.forValue);
+        } else if (valueShape == JsonToken.START_ARRAY) {
+            // should we now set the current object?
+            g.writeStartArray(typeIdDef.forValue);
+        }
+
+        return typeIdDef;
+    }
+
+    private WritableTypeId _writeTypeSuffixfixForNull(JsonGenerator g,
+            WritableTypeId typeIdDef) throws IOException
+    {
+        // copied from `jackson-core`, `JsonGenerator.writeTypeSuffix()`
+        final JsonToken valueShape = typeIdDef.valueShape;
+        // First: does value need closing?
+        if (valueShape == JsonToken.START_OBJECT) {
+            g.writeEndObject();
+        } else if (valueShape == JsonToken.START_ARRAY) {
+            g.writeEndArray();
+        }
+        return typeIdDef;
+    }
+
     /**
      * Helper method that will generate type id to use, if not already passed.
      *
diff --git a/src/test/java/com/fasterxml/jackson/databind/jsontype/CustomTypeIdResolver4407Test.java b/src/test/java/com/fasterxml/jackson/databind/jsontype/CustomTypeIdResolver4407Test.java
new file mode 100644
index 000000000..8699ce8ad
--- /dev/null
+++ b/src/test/java/com/fasterxml/jackson/databind/jsontype/CustomTypeIdResolver4407Test.java
@@ -0,0 +1,256 @@
+package com.fasterxml.jackson.databind.jsontype;
+
+import org.junit.jupiter.api.Test;
+
+import com.fasterxml.jackson.annotation.*;
+
+import com.fasterxml.jackson.databind.*;
+import com.fasterxml.jackson.databind.annotation.JsonTypeIdResolver;
+import com.fasterxml.jackson.databind.testutil.DatabindTestUtil;
+
+import static org.junit.jupiter.api.Assertions.assertEquals;
+import static org.junit.jupiter.api.Assertions.assertNotNull;
+
+// for [databind#4407]
+public class CustomTypeIdResolver4407Test extends DatabindTestUtil
+{
+    static class Wrapper4407Prop {
+        @JsonTypeInfo(use = JsonTypeInfo.Id.NAME,
+                include = JsonTypeInfo.As.PROPERTY,
+                defaultImpl = Default4407.class,
+                property = "type")
+        @JsonTypeIdResolver(Resolver4407_typex.class)
+        public Base4407 wrapped;
+
+        Wrapper4407Prop() { }
+        public Wrapper4407Prop(String v) {
+            wrapped = new Impl4407(v);
+        }
+    }
+
+    static class Wrapper4407PropNull {
+        @JsonTypeInfo(use = JsonTypeInfo.Id.NAME,
+                include = JsonTypeInfo.As.PROPERTY,
+                defaultImpl = Default4407.class,
+                property = "type")
+        @JsonTypeIdResolver(Resolver4407_null.class)
+        public Base4407 wrapped;
+
+        Wrapper4407PropNull() { }
+        public Wrapper4407PropNull(String v) {
+            wrapped = new Impl4407(v);
+        }
+    }
+
+    static class Wrapper4407WrapperArray {
+        @JsonTypeInfo(use = JsonTypeInfo.Id.NAME,
+                include = JsonTypeInfo.As.WRAPPER_ARRAY,
+                defaultImpl = Default4407.class)
+        @JsonTypeIdResolver(Resolver4407_typex.class)
+        public Base4407 wrapped;
+
+        Wrapper4407WrapperArray() { }
+        public Wrapper4407WrapperArray(String v) {
+            wrapped = new Impl4407(v);
+        }
+    }
+
+    static class Wrapper4407WrapperArrayNull {
+        @JsonTypeInfo(use = JsonTypeInfo.Id.NAME,
+                include = JsonTypeInfo.As.WRAPPER_ARRAY,
+                defaultImpl = Default4407.class)
+        @JsonTypeIdResolver(Resolver4407_null.class)
+        public Base4407 wrapped;
+
+        Wrapper4407WrapperArrayNull() { }
+        public Wrapper4407WrapperArrayNull(String v) {
+            wrapped = new Impl4407(v);
+        }
+    }
+
+    static class Wrapper4407WrapperObject {
+        @JsonTypeInfo(use = JsonTypeInfo.Id.NAME,
+                include = JsonTypeInfo.As.WRAPPER_OBJECT,
+                defaultImpl = Default4407.class)
+        @JsonTypeIdResolver(Resolver4407_typex.class)
+        public Base4407 wrapped;
+
+        Wrapper4407WrapperObject() { }
+        public Wrapper4407WrapperObject(String v) {
+            wrapped = new Impl4407(v);
+        }
+    }
+
+    static class Wrapper4407WrapperObjectNull {
+        @JsonTypeInfo(use = JsonTypeInfo.Id.NAME,
+                include = JsonTypeInfo.As.WRAPPER_OBJECT,
+                defaultImpl = Default4407.class)
+        @JsonTypeIdResolver(Resolver4407_null.class)
+        public Base4407 wrapped;
+
+        Wrapper4407WrapperObjectNull() { }
+        public Wrapper4407WrapperObjectNull(String v) {
+            wrapped = new Impl4407(v);
+        }
+    }
+
+    @JsonSubTypes({ @JsonSubTypes.Type(value = Impl4407.class) })
+    static class Base4407 { }
+
+    static class Impl4407 extends Base4407 {
+        public String value;
+
+        Impl4407() { }
+        public Impl4407(String v) { value = v; }
+    }
+
+    static class Default4407 extends Base4407 {
+        public String value;
+
+        Default4407() { }
+        public Default4407(String v) { value = v; }
+    }
+    
+    static class Resolver4407_typex extends Resolver4407Base {
+        public Resolver4407_typex() { super("typeX"); }
+    }
+
+    static class Resolver4407_null extends Resolver4407Base {
+        public Resolver4407_null() { super(null); }
+    }
+
+    static abstract class Resolver4407Base implements TypeIdResolver {
+        private final String _typeId;
+
+        Resolver4407Base(String typeId) {
+            _typeId = typeId;
+        }
+
+        @Override
+        public void init(JavaType baseType) { }
+
+        @Override
+        public String idFromValue(Object value) {
+            return _typeId;
+        }
+
+        @Override
+        public String idFromValueAndType(Object value, Class<?> suggestedType) {
+            return idFromValue(value);
+        }
+
+        @Override
+        public String idFromBaseType() {
+            // NOTE: needed for trying to deserialize without type id
+            return "default";
+        }
+
+        @Override
+        public JavaType typeFromId(DatabindContext ctxt, String id) {
+            if (id.equals(_typeId)) {
+                return ctxt.constructType(Impl4407.class);
+            }
+            return null;
+        }
+
+        @Override
+        public String getDescForKnownTypeIds() {
+            return null;
+        }
+
+        @Override
+        public JsonTypeInfo.Id getMechanism() {
+            return JsonTypeInfo.Id.CUSTOM;
+        }
+    }
+
+    /*
+    /**********************************************************
+    /* Unit tests
+    /**********************************************************
+     */
+
+    private final ObjectMapper MAPPER = newJsonMapper();
+
+    // [databind#4407]: with "as-property" type id
+    @Test
+    public void testTypeIdProp4407NonNull() throws Exception
+    {
+        // First, check out "normal" case of non-null type id
+        final String EXP = a2q("{'wrapped':{'type':'typeX','value':'xyz'}}");
+        assertEquals(EXP,
+                MAPPER.writeValueAsString(new Wrapper4407Prop("xyz")));
+        Wrapper4407Prop result = MAPPER.readValue(EXP, Wrapper4407Prop.class);
+        assertNotNull(result);
+        assertNotNull(result.wrapped);
+        assertEquals(Impl4407.class, result.wrapped.getClass());
+    }
+
+    @Test
+    public void testTypeIdProp4407Null() throws Exception
+    {
+        // And then null one
+        final String EXP = a2q("{'wrapped':{'value':'xyz'}}");
+        assertEquals(EXP,
+                MAPPER.writeValueAsString(new Wrapper4407PropNull("xyz")));
+        assertNotNull(MAPPER.readValue(EXP, Wrapper4407PropNull.class));
+        Wrapper4407Prop result = MAPPER.readValue(EXP, Wrapper4407Prop.class);
+        assertNotNull(result);
+        assertNotNull(result.wrapped);
+        assertEquals(Default4407.class, result.wrapped.getClass());
+    }
+
+    // [databind#4407]: with "as-wrapper-array" type id
+    @Test
+    public void testTypeIdWrapperArray4407NonNull() throws Exception
+    {
+        // First, check out "normal" case of non-null type id
+        final String EXP = a2q("{'wrapped':['typeX',{'value':'xyz'}]}");
+        assertEquals(EXP,
+                MAPPER.writeValueAsString(new Wrapper4407WrapperArray("xyz")));
+        Wrapper4407WrapperArray result = MAPPER.readValue(EXP, Wrapper4407WrapperArray.class);
+        assertNotNull(result);
+        assertNotNull(result.wrapped);
+        assertEquals(Impl4407.class, result.wrapped.getClass());
+    }
+
+    @Test
+    public void testTypeIdWrapperArray4407Null() throws Exception
+    {
+        // And then null one
+        final String EXP = a2q("{'wrapped':{'value':'xyz'}}");
+        assertEquals(EXP,
+                MAPPER.writeValueAsString(new Wrapper4407WrapperArrayNull("xyz")));
+        Wrapper4407WrapperArray result = MAPPER.readValue(EXP, Wrapper4407WrapperArray.class);
+        assertNotNull(result);
+        assertNotNull(result.wrapped);
+        assertEquals(Default4407.class, result.wrapped.getClass());
+    }
+
+    // [databind#4407]: with "as-wrapper-object" type id
+    @Test
+    public void testTypeIdWrapperObject4407NonNull() throws Exception
+    {
+        // First, check out "normal" case of non-null type id
+        final String EXP = a2q("{'wrapped':{'typeX':{'value':'xyz'}}}");
+        assertEquals(EXP,
+                MAPPER.writeValueAsString(new Wrapper4407WrapperObject("xyz")));
+        Wrapper4407WrapperObject result = MAPPER.readValue(EXP, Wrapper4407WrapperObject.class);
+        assertNotNull(result);
+        assertNotNull(result.wrapped);
+        assertEquals(Impl4407.class, result.wrapped.getClass());
+    }
+
+    @Test
+    public void testTypeIdWrapperObject4407Null() throws Exception
+    {
+        // And then null one
+        final String EXP = a2q("{'wrapped':{'value':'xyz'}}");
+        assertEquals(EXP,
+                MAPPER.writeValueAsString(new Wrapper4407WrapperObjectNull("xyz")));
+        Wrapper4407WrapperObject result = MAPPER.readValue(EXP, Wrapper4407WrapperObject.class);
+        assertNotNull(result);
+        assertNotNull(result.wrapped);
+        assertEquals(Default4407.class, result.wrapped.getClass());
+    }
+}
