{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/660","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/660/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/660/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/660/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/660","id":52553499,"node_id":"MDU6SXNzdWU1MjU1MzQ5OQ==","number":660,"title":"JsonCreator factory method is ignored ","user":{"login":"iovesnov","id":6526563,"node_id":"MDQ6VXNlcjY1MjY1NjM=","avatar_url":"https://avatars.githubusercontent.com/u/6526563?v=4","gravatar_id":"","url":"https://api.github.com/users/iovesnov","html_url":"https://github.com/iovesnov","followers_url":"https://api.github.com/users/iovesnov/followers","following_url":"https://api.github.com/users/iovesnov/following{/other_user}","gists_url":"https://api.github.com/users/iovesnov/gists{/gist_id}","starred_url":"https://api.github.com/users/iovesnov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iovesnov/subscriptions","organizations_url":"https://api.github.com/users/iovesnov/orgs","repos_url":"https://api.github.com/users/iovesnov/repos","events_url":"https://api.github.com/users/iovesnov/events{/privacy}","received_events_url":"https://api.github.com/users/iovesnov/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/22","html_url":"https://github.com/FasterXML/jackson-databind/milestone/22","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/22/labels","id":762178,"node_id":"MDk6TWlsZXN0b25lNzYyMTc4","number":22,"title":"2.5.0","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":45,"state":"closed","created_at":"2014-08-22T05:18:11Z","updated_at":"2021-03-04T04:03:36Z","due_on":null,"closed_at":"2021-03-04T04:03:36Z"},"comments":3,"created_at":"2014-12-20T06:03:50Z","updated_at":"2014-12-24T01:20:26Z","closed_at":"2014-12-24T01:20:26Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I am using Jackson version 2.4.4\n\nBelow two classes  Test1 and Test2. Both classes has private constructor and JsonCreator method which accepts the single parameter. In case of Test1 class that parameter has 'double' type and Object in Test2 class. \nI've added the code which converts JSON string into the Test1 and Test2 classes and as the result different methods are invoked. For the Test1 class invoked only constructor but for the Test2 factory method is invoked.\n\nCode:\n\n```\npublic static void main(String []args) throws IOException {\n    ObjectMapper objectMapper = new ObjectMapper();\n    String json = objectMapper.writeValueAsString(-0.5);\n    objectMapper.readValue(json, Test1.class);\n    System.out.println(\"-----------------\");\n    objectMapper.readValue(json, Test2.class);\n}\n\nclass Test1 {\n    private final double n;\n\n    private Test1(double n) {\n        this.n = n;\n    }\n\n    @JsonCreator\n    public static Test1 factory(double n) {\n        return new Test1(n);\n    }\n}\n\nclass Test2 {\n    private final Data n;\n\n    private Test2(Data n) {\n        this.n = n;\n    }\n\n    @JsonCreator\n    public static Test2 checked(Data n) {\n        return new Test2(n);\n    }\n}\n```\n\nOutput:\n\n```\nTest 1. Constructor.\n-----------------\nTest 2. JsonCreator.\nTest 2. Constructor.\n```\n\nI debugged the Jackson a little bit and found that different types are treated differently: BasicDeserializerFactory#_handleSingleArgumentConstructor:\n\n```\n    if (type == String.class) {\n        if (isCreator || isVisible) {\n            creators.addStringCreator(ctor);\n        }\n        return true;\n    }\n    if (type == int.class || type == Integer.class) {\n        if (isCreator || isVisible) {\n            creators.addIntCreator(ctor);\n        }\n        return true;\n    }\n    if (type == long.class || type == Long.class) {\n        if (isCreator || isVisible) {\n            creators.addLongCreator(ctor);\n        }\n        return true;\n    }\n    if (type == double.class || type == Double.class) {\n        if (isCreator || isVisible) {\n            creators.addDoubleCreator(ctor);\n        }\n        return true;\n    }\n    if (type == boolean.class || type == Boolean.class) {\n        if (isCreator || isVisible) {\n            creators.addBooleanCreator(ctor);\n        }\n        return true;\n    }\n    // Delegating Creator ok iff it has @JsonCreator (etc)\n    if (isCreator) {\n        creators.addDelegatingCreator(ctor, null);\n        return true;\n    }\n    return false;\n```\n\nAs you can see all Java types has a check isCreator || isVisible but not for the Object or custom class. This is really makes the difference because of the constructor with some Java types (like double or String) will override the factory method...\n\nI personally think that Jackson should work the same independently to the object type. \nIt is you call but I would also say that factory method annotated with JsonCreator annotation should has higher priority then constructor.\n","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/660/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/660/timeline","performed_via_github_app":null,"state_reason":"completed"}