{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/3419","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/3419/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/3419/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/3419/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/3419","id":1173753196,"node_id":"I_kwDOAC5e2c5F9g1s","number":3419,"title":"Improve performance of `UnresolvedForwardReference` for forward reference resolution","user":{"login":"morganga","id":20705565,"node_id":"MDQ6VXNlcjIwNzA1NTY1","avatar_url":"https://avatars.githubusercontent.com/u/20705565?v=4","gravatar_id":"","url":"https://api.github.com/users/morganga","html_url":"https://github.com/morganga","followers_url":"https://api.github.com/users/morganga/followers","following_url":"https://api.github.com/users/morganga/following{/other_user}","gists_url":"https://api.github.com/users/morganga/gists{/gist_id}","starred_url":"https://api.github.com/users/morganga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/morganga/subscriptions","organizations_url":"https://api.github.com/users/morganga/orgs","repos_url":"https://api.github.com/users/morganga/repos","events_url":"https://api.github.com/users/morganga/events{/privacy}","received_events_url":"https://api.github.com/users/morganga/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/138","html_url":"https://github.com/FasterXML/jackson-databind/milestone/138","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/138/labels","id":7752379,"node_id":"MI_kwDOAC5e2c4Adkq7","number":138,"title":"2.13.3","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":7,"state":"open","created_at":"2022-03-09T22:41:12Z","updated_at":"2022-11-15T17:43:51Z","due_on":null,"closed_at":null},"comments":2,"created_at":"2022-03-18T15:59:49Z","updated_at":"2022-05-14T14:33:39Z","closed_at":"2022-03-22T02:56:44Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"JsonMappingException is a checked exception used to signal **fatal** problems with mapping of content.\r\n\r\nUnresolvedForwardReference, which extends JsonMappingException is thrown and caught internally for completely **VALID** json to resolve forward references.\r\n\r\nThrowable.fillInStackTrace() is an expensive operation, it's the main cost of throwing most Exceptions, and it's called for all UnresolvedForwardReference thrown and caught internally.  The stackTrace is irrelevant for these internal exceptions, it is wasted computation.\r\n\r\nThe json documents we process are full of object references, so I took the liberty of locally redefining UnresolvedForwardReference to extend RuntimeException, and using the RuntimeException constructor to set writableStackTrace to false, bypassing the Throwable.fillInStackTrace() call.\r\nI noticed speed improvements of 50%, deserialization takes half the time when Throwable.fillInStackTrace() is turned off for our typical json payloads.\r\n\r\nDeserializationContext does have a method checkUnresolvedObjectId(), which throws the genuine **fatal** unresolved forward references.\r\n\r\nAll I'm asking is that UnresolvedForwardReference thrown and caught internally are created with writableStackTrace = false, whether that's achieved by supplying new parent constructors to pass the flag up the hierarchy, or creating a new exception type that's only used internally to report a forward reference to be resolved later, It need not be a breaking change, only an internal performance improvement.","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/3419/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/3419/timeline","performed_via_github_app":null,"state_reason":"completed"}