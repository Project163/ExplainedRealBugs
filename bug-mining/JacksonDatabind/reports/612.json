{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1850","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1850/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1850/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1850/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/1850","id":279507411,"node_id":"MDU6SXNzdWUyNzk1MDc0MTE=","number":1850,"title":"`@JsonValue` with integer for enum does not deserialize correctly","user":{"login":"tgolden-andplus","id":13981275,"node_id":"MDQ6VXNlcjEzOTgxMjc1","avatar_url":"https://avatars.githubusercontent.com/u/13981275?v=4","gravatar_id":"","url":"https://api.github.com/users/tgolden-andplus","html_url":"https://github.com/tgolden-andplus","followers_url":"https://api.github.com/users/tgolden-andplus/followers","following_url":"https://api.github.com/users/tgolden-andplus/following{/other_user}","gists_url":"https://api.github.com/users/tgolden-andplus/gists{/gist_id}","starred_url":"https://api.github.com/users/tgolden-andplus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tgolden-andplus/subscriptions","organizations_url":"https://api.github.com/users/tgolden-andplus/orgs","repos_url":"https://api.github.com/users/tgolden-andplus/repos","events_url":"https://api.github.com/users/tgolden-andplus/events{/privacy}","received_events_url":"https://api.github.com/users/tgolden-andplus/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1955308541,"node_id":"MDU6TGFiZWwxOTU1MzA4NTQx","url":"https://api.github.com/repos/FasterXML/jackson-databind/labels/most-wanted","name":"most-wanted","color":"71db51","default":false,"description":"Tag to indicate that there is heavy user +1'ing action"},{"id":2457821256,"node_id":"MDU6TGFiZWwyNDU3ODIxMjU2","url":"https://api.github.com/repos/FasterXML/jackson-databind/labels/has-failing-test","name":"has-failing-test","color":"4e8a16","default":false,"description":"Indicates that there exists a test case (under `failing/`) to reproduce the issue"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/126","html_url":"https://github.com/FasterXML/jackson-databind/milestone/126","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/126/labels","id":6339120,"node_id":"MDk6TWlsZXN0b25lNjMzOTEyMA==","number":126,"title":"2.13.0","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":43,"state":"open","created_at":"2021-01-22T02:20:01Z","updated_at":"2025-10-16T01:27:23Z","due_on":null,"closed_at":null},"comments":25,"created_at":"2017-12-05T19:50:38Z","updated_at":"2021-09-27T00:42:05Z","closed_at":"2021-09-27T00:42:05Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"The Javadoc for `@JsonValue` states that it is the only required annotation to both serialize and deserialize enums as something other than their name or ordinal:\r\n\r\n> when use for Java enums, one additional feature is that value returned by annotated method is also considered to be the value to deserialize from, not just JSON String to serialize as. This is possible since set of Enum values is constant and it is possible to define mapping, but can not be done in general for POJO types; as such, this is not used for POJO deserialization.\r\n\r\nThe Javadoc also states that it can be applied to any scalar type:\r\n\r\n> Usually value will be of a simple scalar type (String or Number), but it can be any serializable type (Collection, Map or Bean).\r\n\r\nHowever, annotating an enum like below will fail to deserialize -- Jackson appears to interpret the integer as the ordinal of the enum.\r\n\r\n    public enum Type {\r\n        A(2),\r\n        B(3);\r\n        private final int value;\r\n        Type(final int value) { this.value = value; }\r\n        @JsonValue public int value() { return this.value; }\r\n    }\r\n\r\nWhen attempting to deserialize an enum like the above example, on Jackson 2.9.2, I receive the following stack trace: (slightly anonymized)\r\n\r\n```\r\ncom.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `com.example.Type` from number 3: index value outside legal index range [0..1]\r\n                                                                                 at [Source: (InputStreamReader); line: 1, column: 60] (through reference chain: java.util.ArrayList[0]->com.example.Pojo[\"type\"])\r\n                                                                                 at com.fasterxml.jackson.databind.DeserializationContext.weirdNumberException(DeserializationContext.java:1563)\r\n                                                                                 at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdNumberValue(DeserializationContext.java:953)\r\n                                                                                 at com.fasterxml.jackson.databind.deser.std.EnumDeserializer.deserialize(EnumDeserializer.java:200)\r\n                                                                                 at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeSetAndReturn(MethodProperty.java:149)\r\n```\r\n\r\nIf I add a `@JsonCreator` to a static method that matches the value to the internal field, the enum can be deserialized correctly. However that is more code I would rather not maintain if possible. ","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1850/reactions","total_count":35,"+1":35,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1850/timeline","performed_via_github_app":null,"state_reason":"completed"}