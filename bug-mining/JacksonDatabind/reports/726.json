{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4613","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4613/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4613/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4613/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/4613","id":2390870497,"node_id":"I_kwDOAC5e2c6Ogcnh","number":4613,"title":"`nonPublicPartOfAPI` for `MyTokenizer` reported by revapi ","user":{"login":"sbernard31","id":840294,"node_id":"MDQ6VXNlcjg0MDI5NA==","avatar_url":"https://avatars.githubusercontent.com/u/840294?v=4","gravatar_id":"","url":"https://api.github.com/users/sbernard31","html_url":"https://github.com/sbernard31","followers_url":"https://api.github.com/users/sbernard31/followers","following_url":"https://api.github.com/users/sbernard31/following{/other_user}","gists_url":"https://api.github.com/users/sbernard31/gists{/gist_id}","starred_url":"https://api.github.com/users/sbernard31/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sbernard31/subscriptions","organizations_url":"https://api.github.com/users/sbernard31/orgs","repos_url":"https://api.github.com/users/sbernard31/repos","events_url":"https://api.github.com/users/sbernard31/events{/privacy}","received_events_url":"https://api.github.com/users/sbernard31/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2024-07-04T13:24:38Z","updated_at":"2024-07-25T02:20:30Z","closed_at":"2024-07-25T02:20:13Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'm using [revapi](https://revapi.org), to check I respect semantic versioning in my project.\r\n\r\nBut it also checks some code smell about API.\r\nWhen building my project,  it report something wrong with jackson (which is one of my dependencies)\r\n\r\nReport : \r\n```javascript\r\n{\r\n  \"ignore\": true,\r\n  \"code\": \"java.class.nonPublicPartOfAPI\",\r\n  \"new\": \"class com.fasterxml.jackson.databind.type.TypeParser.MyTokenizer\",\r\n  \"justification\": \"ADD YOUR EXPLANATION FOR THE NECESSITY OF THIS CHANGE\"\r\n   \"classSimpleName\": \"MyTokenizer\",\r\n  \"exampleUseChainInNewApi\": \"com.fasterxml.jackson.databind.type.TypeParser.MyTokenizer is used as parameter in method java.lang.IllegalArgumentException com.fasterxml.jackson.databind.type.TypeParser::_problem(com.fasterxml.jackson.databind.type.TypeParser.MyTokenizer, java.lang.String) <- field com.fasterxml.jackson.databind.type.TypeFactory._parser has the type com.fasterxml.jackson.databind.type.TypeParser <- com.fasterxml.jackson.databind.type.TypeFactory is used as parameter in method com.fasterxml.jackson.databind.JavaType com.fasterxml.jackson.databind.util.Converter<IN, OUT>::getInputType(com.fasterxml.jackson.databind.type.TypeFactory) <- com.fasterxml.jackson.databind.util.Converter<IN, OUT> is returned from method com.fasterxml.jackson.databind.util.Converter<java.lang.Object, java.lang.Object> com.fasterxml.jackson.databind.DatabindContext::converterInstance(com.fasterxml.jackson.databind.introspect.Annotated, java.lang.Object) throws com.fasterxml.jackson.databind.JsonMappingException @ com.fasterxml.jackson.databind.SerializerProvider <- com.fasterxml.jackson.databind.SerializerProvider is used as parameter in method com.fasterxml.jackson.annotation.JsonFormat.Value com.fasterxml.jackson.databind.ser.std.StdSerializer<T>::findFormatOverrides(com.fasterxml.jackson.databind.SerializerProvider, com.fasterxml.jackson.databind.BeanProperty, java.lang.Class<?>) @ com.fasterxml.jackson.databind.ser.ContainerSerializer<T> <- com.fasterxml.jackson.databind.ser.ContainerSerializer<T> is returned from method com.fasterxml.jackson.databind.ser.ContainerSerializer<?> com.fasterxml.jackson.databind.ser.ContainerSerializer<T>::withValueTypeSerializer(com.fasterxml.jackson.databind.jsontype.TypeSerializer) @ com.fasterxml.jackson.databind.ser.std.MapSerializer <- field com.fasterxml.jackson.databind.ser.AnyGetterWriter._mapSerializer has the type com.fasterxml.jackson.databind.ser.std.MapSerializer <- com.fasterxml.jackson.databind.ser.AnyGetterWriter is used as parameter in method void com.fasterxml.jackson.databind.ser.BeanSerializerBuilder::setAnyGetter(com.fasterxml.jackson.databind.ser.AnyGetterWriter) <- com.fasterxml.jackson.databind.ser.BeanSerializerBuilder is used as parameter in method com.fasterxml.jackson.databind.ser.BeanSerializerBuilder com.fasterxml.jackson.databind.ser.BeanSerializerModifier::updateBuilder(com.fasterxml.jackson.databind.SerializationConfig, com.fasterxml.jackson.databind.BeanDescription, com.fasterxml.jackson.databind.ser.BeanSerializerBuilder) <- com.fasterxml.jackson.databind.ser.BeanSerializerModifier is used as parameter in method com.fasterxml.jackson.databind.ser.SerializerFactory com.fasterxml.jackson.databind.ser.SerializerFactory::withSerializerModifier(com.fasterxml.jackson.databind.ser.BeanSerializerModifier) <- field com.fasterxml.jackson.databind.ObjectWriter._serializerFactory has the type com.fasterxml.jackson.databind.ser.SerializerFactory <- com.fasterxml.jackson.databind.ObjectWriter is returned from method com.fasterxml.jackson.databind.ObjectWriter com.fasterxml.jackson.databind.ObjectMapper::writerWithType(com.fasterxml.jackson.databind.JavaType) <- com.fasterxml.jackson.databind.ObjectMapper is used as parameter in method void org.eclipse.leshan.senml.json.jackson.SenMLJsonJacksonEncoderDecoder::<init>(org.eclipse.leshan.core.util.json.JacksonJsonSerDes<org.eclipse.leshan.senml.SenMLRecord>, com.fasterxml.jackson.databind.ObjectMapper) (method void org.eclipse.leshan.senml.json.jackson.SenMLJsonJacksonEncoderDecoder::<init>(org.eclipse.leshan.core.util.json.JacksonJsonSerDes<org.eclipse.leshan.senml.SenMLRecord>, com.fasterxml.jackson.databind.ObjectMapper) is part of the API)\",\r\n  \"package\": \"com.fasterxml.jackson.databind.type\",\r\n  \"classQualifiedName\": \"com.fasterxml.jackson.databind.type.TypeParser.MyTokenizer\",\r\n  \"elementKind\": \"class\",\r\n  \"newArchive\": \"com.fasterxml.jackson.core:jackson-databind:jar:2.17.1\",\r\n  \"newArchiveRole\": \"supplementary\",\r\n},\r\n```\r\n\r\n`nonPublicPartOfAPI` is described [here](https://revapi.org/revapi-java/0.28.1/differences.html#java.class.nonPublicPartOfAPI).\r\n\r\nI copy/paste the `exampleUseChainInNewApi` here because this is the most important part to understand the issue : \r\n>  \"com.fasterxml.jackson.databind.type.TypeParser.MyTokenizer is used as parameter in method java.lang.IllegalArgumentException com.fasterxml.jackson.databind.type.TypeParser::_problem(com.fasterxml.jackson.databind.type.TypeParser.MyTokenizer, java.lang.String) <- field com.fasterxml.jackson.databind.type.TypeFactory._parser has the type com.fasterxml.jackson.databind.type.TypeParser <- com.fasterxml.jackson.databind.type.TypeFactory is used as parameter in method com.fasterxml.jackson.databind.JavaType com.fasterxml.jackson.databind.util.Converter<IN, OUT>::getInputType(com.fasterxml.jackson.databind.type.TypeFactory) <- com.fasterxml.jackson.databind.util.Converter<IN, OUT> is returned from method com.fasterxml.jackson.databind.util.Converter<java.lang.Object, java.lang.Object> com.fasterxml.jackson.databind.DatabindContext::converterInstance(com.fasterxml.jackson.databind.introspect.Annotated, java.lang.Object) throws com.fasterxml.jackson.databind.JsonMappingException @ com.fasterxml.jackson.databind.SerializerProvider <- com.fasterxml.jackson.databind.SerializerProvider is used as parameter in method com.fasterxml.jackson.annotation.JsonFormat.Value com.fasterxml.jackson.databind.ser.std.StdSerializer<T>::findFormatOverrides(com.fasterxml.jackson.databind.SerializerProvider, com.fasterxml.jackson.databind.BeanProperty, java.lang.Class<?>) @ com.fasterxml.jackson.databind.ser.ContainerSerializer<T> <- com.fasterxml.jackson.databind.ser.ContainerSerializer<T> is returned from method com.fasterxml.jackson.databind.ser.ContainerSerializer<?> com.fasterxml.jackson.databind.ser.ContainerSerializer<T>::withValueTypeSerializer(com.fasterxml.jackson.databind.jsontype.TypeSerializer) @ com.fasterxml.jackson.databind.ser.std.MapSerializer <- field com.fasterxml.jackson.databind.ser.AnyGetterWriter._mapSerializer has the type com.fasterxml.jackson.databind.ser.std.MapSerializer <- com.fasterxml.jackson.databind.ser.AnyGetterWriter is used as parameter in method void com.fasterxml.jackson.databind.ser.BeanSerializerBuilder::setAnyGetter(com.fasterxml.jackson.databind.ser.AnyGetterWriter) <- com.fasterxml.jackson.databind.ser.BeanSerializerBuilder is used as parameter in method com.fasterxml.jackson.databind.ser.BeanSerializerBuilder com.fasterxml.jackson.databind.ser.BeanSerializerModifier::updateBuilder(com.fasterxml.jackson.databind.SerializationConfig, com.fasterxml.jackson.databind.BeanDescription, com.fasterxml.jackson.databind.ser.BeanSerializerBuilder) <- com.fasterxml.jackson.databind.ser.BeanSerializerModifier is used as parameter in method com.fasterxml.jackson.databind.ser.SerializerFactory com.fasterxml.jackson.databind.ser.SerializerFactory::withSerializerModifier(com.fasterxml.jackson.databind.ser.BeanSerializerModifier) <- field com.fasterxml.jackson.databind.ObjectWriter._serializerFactory has the type com.fasterxml.jackson.databind.ser.SerializerFactory <- com.fasterxml.jackson.databind.ObjectWriter is returned from method com.fasterxml.jackson.databind.ObjectWriter com.fasterxml.jackson.databind.ObjectMapper::writerWithType(com.fasterxml.jackson.databind.JavaType) <- com.fasterxml.jackson.databind.ObjectMapper is used as parameter in method void org.eclipse.leshan.senml.json.jackson.SenMLJsonJacksonEncoderDecoder::<init>(org.eclipse.leshan.core.util.json.JacksonJsonSerDes<org.eclipse.leshan.senml.SenMLRecord>, com.fasterxml.jackson.databind.ObjectMapper) (method void org.eclipse.leshan.senml.json.jackson.SenMLJsonJacksonEncoderDecoder::<init>(org.eclipse.leshan.core.util.json.JacksonJsonSerDes<org.eclipse.leshan.senml.SenMLRecord>, com.fasterxml.jackson.databind.ObjectMapper) is part of the API)\"\r\n\r\n**Solution ?** \r\n\r\nI think   `MyTokenizer` should be **protected** instead of **package** ? \r\n\r\n(issue found with 2.15.3 and also tested with 2.17.1)\r\n","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4613/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4613/timeline","performed_via_github_app":null,"state_reason":"completed"}