[{"id":11986533647,"node_id":"LE_lADOAC5e2c6BBTezzwAAAALKc_0P","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/11986533647","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-03-02T05:45:49Z","label":{"name":"to-evaluate","color":"fbca04"},"performed_via_github_app":null},{"id":11986534428,"node_id":"UNLE_lADOAC5e2c6BBTezzwAAAALKdAAc","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/11986534428","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2024-03-02T05:45:54Z","label":{"name":"to-evaluate","color":"fbca04"},"performed_via_github_app":null},{"id":11986536142,"node_id":"LE_lADOAC5e2c6BBTezzwAAAALKdAbO","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/11986536142","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-03-02T05:46:33Z","label":{"name":"2.18","color":"1D76DB"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/2169079215","html_url":"https://github.com/FasterXML/jackson-databind/issues/4407#issuecomment-2169079215","issue_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4407","id":2169079215,"node_id":"IC_kwDOAC5e2c6BSYWv","user":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-15T03:27:05Z","updated_at":"2024-06-15T03:27:05Z","body":"Thinking this through again, I realized that what can and should be done depends on mechanism:\r\n\r\n1. With `As.PROPERTY` (and `As.EXISTING_PROPERTY`), we CAN omit type id but if so, MUST add starting `{` (and closing `}`). This is the case I was mostly thinking\r\n2. With `As.WRAPPER_ARRAY`, we CANNOT just omit entry, something must be written as first-element of array (`null`?) OR fail with exception.\r\n3. With `As.WRAPPER_OBJECT`, we also CANNOT just omit entry, but we also cannot write `null` as property name. I guess we could write \"\" as key?\r\n\r\nSo (1) is fine, (2) somewhat and (3) less good.\r\n\r\nChoice then is between failing on (2) and (3), or using placeholder.\r\n\r\nMy thinking is to go with placeholder; it is up to implementor of `TypeIdResolver` to either return `null` and get whatever we give, or avoid returning `null`.\r\n\r\n ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/2169079215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13170979548,"node_id":"REFE_lADOAC5e2c6BBTezzwAAAAMRDTLc","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/13170979548","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a8a52d4f1da5e2d524dc60c7abdbb8757252f131","commit_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits/a8a52d4f1da5e2d524dc60c7abdbb8757252f131","created_at":"2024-06-15T18:48:08Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/2170946248","html_url":"https://github.com/FasterXML/jackson-databind/issues/4407#issuecomment-2170946248","issue_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4407","id":2170946248,"node_id":"IC_kwDOAC5e2c6BZgLI","user":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-15T22:24:38Z","updated_at":"2024-06-15T22:26:19Z","body":"Hmmh. Ok, actually, come to think of this... no, it should be possible to just omit Type Id write and make things work as if value was not polymorphic at all. That should work for all cases; but it cannot be done by simply avoiding calls to `JsonGenerator.writeTypePrefix()`.\r\n\r\nBut there are two approaches, still:\r\n\r\n1. Do it all in databind (`TypeSerializerBase`)\r\n2. Use delegating, do it (mostly) in `JsonGenerator`\r\n\r\nboth approaches have their benefits.... need to think a bit more.\r\n\r\nI think I will first try approach (1) and see how far that gets us.\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/2170946248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13172731693,"node_id":"MIE_lADOAC5e2c6BBTezzwAAAAMRJ-8t","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/13172731693","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2024-06-15T23:08:41Z","milestone":{"title":"2.18.0"},"performed_via_github_app":null},{"id":13172753417,"node_id":"CE_lADOAC5e2c6BBTezzwAAAAMRKEQJ","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/13172753417","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"7c18a74cfb6522c3fa56e7d666628fc2cc699d96","commit_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits/7c18a74cfb6522c3fa56e7d666628fc2cc699d96","created_at":"2024-06-15T23:14:37Z","state_reason":null,"performed_via_github_app":null},{"id":13172774494,"node_id":"REFE_lADOAC5e2c6BBTezzwAAAAMRKJZe","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/13172774494","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"7c18a74cfb6522c3fa56e7d666628fc2cc699d96","commit_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits/7c18a74cfb6522c3fa56e7d666628fc2cc699d96","created_at":"2024-06-15T23:19:59Z","performed_via_github_app":null},{"actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-15T23:25:48Z","updated_at":"2024-06-15T23:25:48Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4354","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4354/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4354/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4354/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/4354","id":2110055422,"node_id":"I_kwDOAC5e2c59xOP-","number":4354,"title":"Jackson Upgrade 2.11.4 to 2.16.1: Base class field serialization/deserialization not working properly","user":{"login":"arpithnayak","id":4560223,"node_id":"MDQ6VXNlcjQ1NjAyMjM=","avatar_url":"https://avatars.githubusercontent.com/u/4560223?v=4","gravatar_id":"","url":"https://api.github.com/users/arpithnayak","html_url":"https://github.com/arpithnayak","followers_url":"https://api.github.com/users/arpithnayak/followers","following_url":"https://api.github.com/users/arpithnayak/following{/other_user}","gists_url":"https://api.github.com/users/arpithnayak/gists{/gist_id}","starred_url":"https://api.github.com/users/arpithnayak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arpithnayak/subscriptions","organizations_url":"https://api.github.com/users/arpithnayak/orgs","repos_url":"https://api.github.com/users/arpithnayak/repos","events_url":"https://api.github.com/users/arpithnayak/events{/privacy}","received_events_url":"https://api.github.com/users/arpithnayak/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2024-01-31T13:05:57Z","updated_at":"2024-06-15T23:25:49Z","closed_at":"2024-03-02T05:16:23Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":3038937,"node_id":"MDEwOlJlcG9zaXRvcnkzMDM4OTM3","name":"jackson-databind","full_name":"FasterXML/jackson-databind","private":false,"owner":{"login":"FasterXML","id":382692,"node_id":"MDEyOk9yZ2FuaXphdGlvbjM4MjY5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/382692?v=4","gravatar_id":"","url":"https://api.github.com/users/FasterXML","html_url":"https://github.com/FasterXML","followers_url":"https://api.github.com/users/FasterXML/followers","following_url":"https://api.github.com/users/FasterXML/following{/other_user}","gists_url":"https://api.github.com/users/FasterXML/gists{/gist_id}","starred_url":"https://api.github.com/users/FasterXML/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FasterXML/subscriptions","organizations_url":"https://api.github.com/users/FasterXML/orgs","repos_url":"https://api.github.com/users/FasterXML/repos","events_url":"https://api.github.com/users/FasterXML/events{/privacy}","received_events_url":"https://api.github.com/users/FasterXML/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/FasterXML/jackson-databind","description":"General data-binding package for Jackson (2.x): works on streaming API (core) implementation(s)","fork":false,"url":"https://api.github.com/repos/FasterXML/jackson-databind","forks_url":"https://api.github.com/repos/FasterXML/jackson-databind/forks","keys_url":"https://api.github.com/repos/FasterXML/jackson-databind/keys{/key_id}","collaborators_url":"https://api.github.com/repos/FasterXML/jackson-databind/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/FasterXML/jackson-databind/teams","hooks_url":"https://api.github.com/repos/FasterXML/jackson-databind/hooks","issue_events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events{/number}","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/events","assignees_url":"https://api.github.com/repos/FasterXML/jackson-databind/assignees{/user}","branches_url":"https://api.github.com/repos/FasterXML/jackson-databind/branches{/branch}","tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/tags","blobs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/refs{/sha}","trees_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/trees{/sha}","statuses_url":"https://api.github.com/repos/FasterXML/jackson-databind/statuses/{sha}","languages_url":"https://api.github.com/repos/FasterXML/jackson-databind/languages","stargazers_url":"https://api.github.com/repos/FasterXML/jackson-databind/stargazers","contributors_url":"https://api.github.com/repos/FasterXML/jackson-databind/contributors","subscribers_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscribers","subscription_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscription","commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits{/sha}","git_commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/commits{/sha}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/comments{/number}","issue_comment_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments{/number}","contents_url":"https://api.github.com/repos/FasterXML/jackson-databind/contents/{+path}","compare_url":"https://api.github.com/repos/FasterXML/jackson-databind/compare/{base}...{head}","merges_url":"https://api.github.com/repos/FasterXML/jackson-databind/merges","archive_url":"https://api.github.com/repos/FasterXML/jackson-databind/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/FasterXML/jackson-databind/downloads","issues_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues{/number}","pulls_url":"https://api.github.com/repos/FasterXML/jackson-databind/pulls{/number}","milestones_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones{/number}","notifications_url":"https://api.github.com/repos/FasterXML/jackson-databind/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/labels{/name}","releases_url":"https://api.github.com/repos/FasterXML/jackson-databind/releases{/id}","deployments_url":"https://api.github.com/repos/FasterXML/jackson-databind/deployments","created_at":"2011-12-23T07:17:41Z","updated_at":"2025-11-10T02:17:47Z","pushed_at":"2025-11-10T02:17:44Z","git_url":"git://github.com/FasterXML/jackson-databind.git","ssh_url":"git@github.com:FasterXML/jackson-databind.git","clone_url":"https://github.com/FasterXML/jackson-databind.git","svn_url":"https://github.com/FasterXML/jackson-databind","homepage":"","size":83236,"stargazers_count":3644,"watchers_count":3644,"language":"Java","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":1446,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":383,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","jackson","jackson-databind","json"],"visibility":"public","forks":1446,"open_issues":383,"watchers":3644,"default_branch":"3.x","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### Search before asking\n\n- [X] I searched in the [issues](https://github.com/FasterXML/jackson-databind/issues) and found nothing similar.\n\n### Describe the bug\n\nI upgraded jackson library in my codebase from 2.11.4 to 2.16.1 and the below test case that was working fine before is now failing. In one run I retained the JsonTypeInfo annotation and I get the following exception:\r\n```\r\njava.lang.IllegalStateException: com.fasterxml.jackson.databind.JsonMappingException: Can not write a field name, expecting a value (through reference chain: SendEmailAction[\"type\"])\r\n``` \r\n\r\nIf I remove the @JsonTypeInfo annotation, the assert statement fails complaining that the deserilized MyAction object is not an instance of SendEmailAction class.\r\n\r\nAny idea why this change in jackson behaviour?\n\n### Version Information\n\n2.16.1 on Macbook Intel Ventura.\n\n### Reproduction\n\nCode attached for reference:\r\n\r\nThis is the existing base class.\r\n```\r\n/**\r\n  * Defines an action.\r\n  */\r\n @JsonIgnoreProperties(ignoreUnknown = true)\r\n @JsonTypeInfo(use = JsonTypeInfo.Id.CUSTOM,\r\n         include = JsonTypeInfo.As.EXISTING_PROPERTY,\r\n         property = \"type\",\r\n         visible = true)\r\n @JsonTypeIdResolver(MyActionIdResolver.class)\r\n public class MyAction implements Serializable {\r\n\r\n     private static final long serialVersionUID = 1L;\r\n\r\n     @NotNull\r\n     @JsonProperty(\"type\")\r\n     private MyType type;\r\n\r\n     MyAction() {\r\n    }\r\n    \r\n    public MyAction(final MyType type) {\r\n        this.type = type;\r\n    }\r\n    public MyType getType() {\r\n        return this.type;\r\n    }\r\n    public void setType(final MyType type) {\r\n        this.type = type;\r\n    }\r\n    public boolean isCompliant() {\r\n        return false;\r\n    }\r\n    public boolean isTemplate() {\r\n        return false;\r\n    }\r\n    @Override\r\n    public boolean equals(final Object other) {\r\n        if (other == null) {\r\n            return false;\r\n        }\r\n        if (getClass() != other.getClass()) {\r\n            return false;\r\n        }\r\n        final MyAction rhs = (MyAction)other;\r\n        return new EqualsBuilder()\r\n                .append(this.type, rhs.type)\r\n                .isEquals();\r\n    }\r\n    @Override\r\n    public int hashCode() {\r\n        return new HashCodeBuilder()\r\n                .append(this.type)\r\n                .toHashCode();\r\n    }\r\n}\r\n```\r\n\r\nAnd this is the derived class that extends the MyAction class.\r\n```\r\n/**\r\n * Defines send email action.\r\n */\r\npublic class SendEmailAction extends MyAction {\r\n\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    @NotBlank\r\n    @JsonProperty(\"subject\")\r\n    private String subject;\r\n\r\n    @JsonProperty(\"compliant\")\r\n    private boolean compliant;\r\n\r\n    @JsonProperty(\"template\")\r\n    private boolean template;\r\n\r\n    SendEmailAction() {\r\n        super(MyType.SEND_EMAIL);\r\n    }\r\n\r\n    public SendEmailAction(final String subject, final boolean compliant, final boolean template) {\r\n        this();\r\n        this.subject = subject;\r\n        this.compliant = compliant;\r\n        this.template = template;\r\n    }\r\n\r\n    public String getSubject() {\r\n        return this.subject;\r\n    }\r\n\r\n    public void setSubject(final String subject) {\r\n        this.subject = subject;\r\n    }\r\n\r\n    @Override\r\n    public boolean isCompliant() {\r\n        return this.compliant;\r\n    }\r\n\r\n    public void setCompliant(final boolean compliant) {\r\n        this.compliant = compliant;\r\n    }\r\n\r\n    @Override\r\n    public boolean isTemplate() {\r\n        return this.template;\r\n    }\r\n\r\n    public void setTemplate(final boolean template) {\r\n        this.template = template;\r\n    }\r\n\r\n    @Override\r\n    public boolean equals(final Object other) {\r\n        if (other == null) {\r\n            return false;\r\n        }\r\n        if (getClass() != other.getClass()) {\r\n            return false;\r\n        }\r\n        final SendEmailAction rhs = (SendEmailAction)other;\r\n        return new EqualsBuilder()\r\n                .appendSuper(super.equals(other))\r\n                .append(this.subject, rhs.subject)\r\n                .append(this.compliant, rhs.compliant)\r\n                .append(this.template, rhs.template)\r\n                .isEquals();\r\n    }\r\n\r\n    @Override\r\n    public int hashCode() {\r\n        return new HashCodeBuilder()\r\n                .appendSuper(super.hashCode())\r\n                .append(this.emailSubject)\r\n                .append(this.emailBody)\r\n                .append(this.compliant)\r\n                .append(this.useTemplate)\r\n                .toHashCode();\r\n    }\r\n}\r\n```\r\nThis is the ENUM class.\r\n```\r\npublic enum MyType {\r\n    SEND_EMAIL,\r\n    DO_NOTHING\r\n}\r\n```\r\nThis is the resolver class.\r\n```\r\npublic class MyActionIdResolver extends TypeIdResolverBase {\r\n\r\n    private JavaType superType;\r\n\r\n    public MyActionIdResolver() {\r\n\r\n    }\r\n\r\n    @Override\r\n    public void init(final JavaType baseType) {\r\n        this.superType = baseType;\r\n    }\r\n\r\n    @Override\r\n    public JavaType typeFromId(final DatabindContext context, final String id) {\r\n        Class<?> subType = null;\r\n        switch (MyType.valueOf(id)) {\r\n        case SEND_EMAIL:\r\n            subType = SendEmailAction.class;\r\n            break;\r\n        case DO_NOTHING:\r\n        default:\r\n            subType = MyAction.class;\r\n        }\r\n\r\n        return context.constructSpecializedType(this.superType, subType);\r\n    }\r\n\r\n    @Override\r\n    public Id getMechanism() {\r\n        return Id.CUSTOM;\r\n    }\r\n\r\n    @Override\r\n    public String idFromValue(final Object value) {\r\n       return null;\r\n    }\r\n\r\n    @Override\r\n    public String idFromValueAndType(final Object value, final Class<?> suggestedType) {\r\n        return null;\r\n    }\r\n\r\n}\r\n```\r\n\r\nAnd the test class that fails post the upgrade.\r\n```\r\n    public void test() throws JsonProcessingException {\r\n\r\n            final StringWriter w = new StringWriter();\r\n\r\n        final JsonMapper m = new JsonMapper()\r\n                .configure(DeserializationFeature.USE_BIG_INTEGER_FOR_INTS, false)\r\n                .configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false);\r\n        m.getMapper().configOverride(Map.class).setInclude(JsonInclude.Value.construct(JsonInclude.Include.NON_EMPTY, JsonInclude.Include.NON_NULL));\r\n        m.getMapper().writeValue(w, MyAction.class); // <- failing here if JsonTypeInfo annotation is used\r\n        String toJson = w.toString();      \r\n\r\n        MyAction fromJson = m.getMapper().writeValue(toJson, MyAction.class);\r\n\r\n        assertThat(fromJson, notNullValue());\r\n        assertThat(fromJson, is(instanceOf(SendEmailAction.class))); // <- fails here due to type erasure\r\n    }\r\n```\n\n### Expected behavior\n\nThere should be no problem in serializing just as before.\r\n\r\nObject deserilized using MyAction.class is and should be an instance of SendEmailAction.class.\n\n### Additional context\n\n_No response_","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4354/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]