[{"actor":{"login":"renzihui","id":1209700,"node_id":"MDQ6VXNlcjEyMDk3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/1209700?v=4","gravatar_id":"","url":"https://api.github.com/users/renzihui","html_url":"https://github.com/renzihui","followers_url":"https://api.github.com/users/renzihui/followers","following_url":"https://api.github.com/users/renzihui/following{/other_user}","gists_url":"https://api.github.com/users/renzihui/gists{/gist_id}","starred_url":"https://api.github.com/users/renzihui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/renzihui/subscriptions","organizations_url":"https://api.github.com/users/renzihui/orgs","repos_url":"https://api.github.com/users/renzihui/repos","events_url":"https://api.github.com/users/renzihui/events{/privacy}","received_events_url":"https://api.github.com/users/renzihui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-06T07:47:50Z","updated_at":"2018-09-06T07:47:50Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1877","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1877/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1877/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1877/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/1877","id":287115020,"node_id":"MDU6SXNzdWUyODcxMTUwMjA=","number":1877,"title":"Deserialize Enums using ordinal does not work for map keys","user":{"login":"mawifu","id":35260550,"node_id":"MDQ6VXNlcjM1MjYwNTUw","avatar_url":"https://avatars.githubusercontent.com/u/35260550?v=4","gravatar_id":"","url":"https://api.github.com/users/mawifu","html_url":"https://github.com/mawifu","followers_url":"https://api.github.com/users/mawifu/followers","following_url":"https://api.github.com/users/mawifu/following{/other_user}","gists_url":"https://api.github.com/users/mawifu/gists{/gist_id}","starred_url":"https://api.github.com/users/mawifu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mawifu/subscriptions","organizations_url":"https://api.github.com/users/mawifu/orgs","repos_url":"https://api.github.com/users/mawifu/repos","events_url":"https://api.github.com/users/mawifu/events{/privacy}","received_events_url":"https://api.github.com/users/mawifu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2018-01-09T14:51:34Z","updated_at":"2019-09-12T00:08:41Z","closed_at":"2019-09-12T00:08:41Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":3038937,"node_id":"MDEwOlJlcG9zaXRvcnkzMDM4OTM3","name":"jackson-databind","full_name":"FasterXML/jackson-databind","private":false,"owner":{"login":"FasterXML","id":382692,"node_id":"MDEyOk9yZ2FuaXphdGlvbjM4MjY5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/382692?v=4","gravatar_id":"","url":"https://api.github.com/users/FasterXML","html_url":"https://github.com/FasterXML","followers_url":"https://api.github.com/users/FasterXML/followers","following_url":"https://api.github.com/users/FasterXML/following{/other_user}","gists_url":"https://api.github.com/users/FasterXML/gists{/gist_id}","starred_url":"https://api.github.com/users/FasterXML/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FasterXML/subscriptions","organizations_url":"https://api.github.com/users/FasterXML/orgs","repos_url":"https://api.github.com/users/FasterXML/repos","events_url":"https://api.github.com/users/FasterXML/events{/privacy}","received_events_url":"https://api.github.com/users/FasterXML/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/FasterXML/jackson-databind","description":"General data-binding package for Jackson (2.x): works on streaming API (core) implementation(s)","fork":false,"url":"https://api.github.com/repos/FasterXML/jackson-databind","forks_url":"https://api.github.com/repos/FasterXML/jackson-databind/forks","keys_url":"https://api.github.com/repos/FasterXML/jackson-databind/keys{/key_id}","collaborators_url":"https://api.github.com/repos/FasterXML/jackson-databind/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/FasterXML/jackson-databind/teams","hooks_url":"https://api.github.com/repos/FasterXML/jackson-databind/hooks","issue_events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events{/number}","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/events","assignees_url":"https://api.github.com/repos/FasterXML/jackson-databind/assignees{/user}","branches_url":"https://api.github.com/repos/FasterXML/jackson-databind/branches{/branch}","tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/tags","blobs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/refs{/sha}","trees_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/trees{/sha}","statuses_url":"https://api.github.com/repos/FasterXML/jackson-databind/statuses/{sha}","languages_url":"https://api.github.com/repos/FasterXML/jackson-databind/languages","stargazers_url":"https://api.github.com/repos/FasterXML/jackson-databind/stargazers","contributors_url":"https://api.github.com/repos/FasterXML/jackson-databind/contributors","subscribers_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscribers","subscription_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscription","commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits{/sha}","git_commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/commits{/sha}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/comments{/number}","issue_comment_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments{/number}","contents_url":"https://api.github.com/repos/FasterXML/jackson-databind/contents/{+path}","compare_url":"https://api.github.com/repos/FasterXML/jackson-databind/compare/{base}...{head}","merges_url":"https://api.github.com/repos/FasterXML/jackson-databind/merges","archive_url":"https://api.github.com/repos/FasterXML/jackson-databind/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/FasterXML/jackson-databind/downloads","issues_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues{/number}","pulls_url":"https://api.github.com/repos/FasterXML/jackson-databind/pulls{/number}","milestones_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones{/number}","notifications_url":"https://api.github.com/repos/FasterXML/jackson-databind/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/labels{/name}","releases_url":"https://api.github.com/repos/FasterXML/jackson-databind/releases{/id}","deployments_url":"https://api.github.com/repos/FasterXML/jackson-databind/deployments","created_at":"2011-12-23T07:17:41Z","updated_at":"2025-11-08T13:34:42Z","pushed_at":"2025-11-07T22:16:42Z","git_url":"git://github.com/FasterXML/jackson-databind.git","ssh_url":"git@github.com:FasterXML/jackson-databind.git","clone_url":"https://github.com/FasterXML/jackson-databind.git","svn_url":"https://github.com/FasterXML/jackson-databind","homepage":"","size":83232,"stargazers_count":3644,"watchers_count":3644,"language":"Java","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":1446,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":382,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","jackson","jackson-databind","json"],"visibility":"public","forks":1446,"open_issues":382,"watchers":3644,"default_branch":"3.x","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"We are using java enums to communicate between java and c. So we decided to serialize enums using the java ordinal. The SerializationFeature.WRITE_ENUMS_USING_INDEX works fine for that. Thank you for that feature!\r\nBy the way, we are using java 1.8.0_151 and jackson-databind 2.9.2\r\n\r\nConcerning deserialization we hit an unbalance concerning enums as map key:\r\nWithin the serialization step the enum is written as ordinal.\r\nWithin the deserialization the interpretation of the ordinal as enum failes only for map keys.\r\nFor common properties the deserialization from ordinal number works fine.\r\n\r\nThe following sample code describes this more precise:\r\n\r\n```\r\npackage jackson_enum_as_key;\r\n\r\nimport com.fasterxml.jackson.databind.*;\r\n\r\nimport java.io.IOException;\r\nimport java.util.*;\r\n\r\npublic class Main {\r\n\r\n    public enum Type {\r\n        ANY,\r\n        OTHER\r\n    }\r\n\r\n    public static class Container {\r\n        private Type simpleType;\r\n        private Map<Type, String> map;\r\n\r\n        public Type getSimpleType() {\r\n            return simpleType;\r\n        }\r\n\r\n        public void setSimpleType(Type simpleType) {\r\n            this.simpleType= simpleType;\r\n        }\r\n\r\n        public Map<Type, String> getMap() {\r\n            return map;\r\n        }\r\n\r\n        public void setMap(Map<Type, String> map) {\r\n            this.map = map;\r\n        }\r\n    }\r\n\r\n    public static void main(String[] args) throws IOException {\r\n        ObjectMapper objectMapper = new ObjectMapper();\r\n        objectMapper.configure(SerializationFeature.WRITE_ENUMS_USING_INDEX, true);\r\n\r\n        Map<Type, String> map = new HashMap<>();\r\n        map.put(Type.OTHER, \"hello world\");\r\n        Container container = new Container();\r\n        container.setSimpleType(Type.ANY);\r\n        container.setMap(map);\r\n\r\n        String json = objectMapper.writeValueAsString(container);\r\n\r\n        System.out.println(json);\r\n\r\n        objectMapper.readValue(json, Container.class);\r\n    }\r\n}\r\n```\r\nThis code produces the following output. Serialization works fine, deserialization fails on the map key:\r\n\r\n```\r\n{\"simpleType\":0,\"map\":{\"1\":\"hello world\"}}\r\nException in thread \"main\" com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize Map key of type `jackson_enum_as_key.Main$Type` from String \"1\": not a valid representation, problem: (com.fasterxml.jackson.databind.exc.InvalidFormatException) Cannot deserialize Map key of type `jackson_enum_as_key.Main$Type` from String \"1\": not one of values excepted for Enum class: [OTHER, ANY]\r\n at [Source: (String)\"{\"simpleType\":0,\"map\":{\"1\":\"hello world\"}}\"; line: 1, column: 24]\r\n at [Source: (String)\"{\"simpleType\":0,\"map\":{\"1\":\"hello world\"}}\"; line: 1, column: 24] (through reference chain: jackson_enum_as_key.Main$Container[\"map\"])\r\n\tat com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)\r\n\tat com.fasterxml.jackson.databind.DeserializationContext.weirdKeyException(DeserializationContext.java:1527)\r\n\tat com.fasterxml.jackson.databind.DeserializationContext.handleWeirdKey(DeserializationContext.java:866)\r\n\tat com.fasterxml.jackson.databind.deser.std.StdKeyDeserializer.deserializeKey(StdKeyDeserializer.java:133)\r\n\tat com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBind(MapDeserializer.java:449)\r\n\tat com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:367)\r\n\tat com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:29)\r\n\tat com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:127)\r\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:287)\r\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:151)\r\n\tat com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4001)\r\n\tat com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:2992)\r\n\tat jackson_enum_as_key.Main.main(Main.java:50)\r\n\r\nProcess finished with exit code 1\r\n```\r\n\r\nRunning the code above without `SerializationFeature.WRITE_ENUMS_USING_INDEX` set to true, everything works fine with following output:\r\n`{\"simpleType\":\"ANY\",\"map\":{\"OTHER\":\"hello world\"}}`\r\n\r\nSo deserialization fails only for enums repesented as ordinal used as map keys!\r\n\r\n\r\nRegarding the code in jackson-databind we found an unbalance in the Deserialization-Classes:\r\nThe usual `com.fasterxml.jackson.databind.deser.std.EnumDeserializer` used for simple properties checks for `JsonToken#VALUE_NUMBER_INT` and has code path for enums as ordinal. Source code is commented by `But let's consider int acceptable as well (if within ordinal range)`\r\n\r\nUnlike the `com.fasterxml.jackson.databind.deser.std.StdKeyDeserializer.EnumKD` used for map keys uses only a `_byNameResolver` and has no code path for resolving by ordinal. This explains why resolving by ordinal does not work for map keys.\r\n\r\nThis unbalanced situation seems like a missing feature or bug.\r\n\r\n\r\nOur workaround: We use a custom deserializer for our enum.\r\n\r\nSo in `com.fasterxml.jackson.databind.deser.BasicDeserializerFactory#_createEnumKeyDeserializer` for the map key a different code path is used, triggering a `com.fasterxml.jackson.databind.deser.std.StdKeyDeserializer.DelegatingKD` which delegates to our custom deserializer which is able to resolves enum by ordinal.\r\n\r\nNot a very elegant workaround, because we have to register a concrete deserializer only for those enums which are used as map keys. Enums only used as normal properties are fine with the standard EnumDeserializer.\r\n\r\n```\r\npublic class EnumKeyDeserializer<E extends Enum<E>> extends StdDeserializer<E> {\r\n\r\n    private final Class<E> enumType;\r\n\r\n    public EnumKeyDeserializer(Class<E> enumType) {\r\n        super(enumType);\r\n        this.enumType = enumType;\r\n    }\r\n\r\n    @Override\r\n    public E deserialize(JsonParser p, DeserializationContext ctxt) throws IOException {\r\n\r\n        String str = p.getText().trim();\r\n\r\n        try {\r\n            int index = Integer.parseInt(str);\r\n\r\n            final E[] enumValues = enumType.getEnumConstants();\r\n            if (index >= 0 && index < enumValues.length) {\r\n                return enumValues[index];\r\n            } else {\r\n                throw ctxt.weirdNumberException(index, enumType,\r\n                        \"index value outside legal index range [0..\" + (enumValues.length - 1) + \"]\"\r\n                );\r\n            }\r\n\r\n        } catch (NumberFormatException nfe) {\r\n            return Enum.valueOf(enumType, str);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nThe most relevant issue we found here is #1674 - this issue mentions the unbalance between deserializer for normal properties versus deserializier for map keys. But this issue does not mention the enum ordinal in any way. May be relating to #1859 but this issue regards unknown enum values, not ordinals.\r\n  \r\nRegarding issue #1882 I tried a EnumMap instead of a HashMap. But this didn't change anything. Same Exception.\r\n  ","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1877/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1877/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":2634247421,"node_id":"MDEyOkxhYmVsZWRFdmVudDI2MzQyNDc0MjE=","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2634247421","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-09-14T17:32:43Z","label":{"name":"2.10","color":"006b75"},"performed_via_github_app":null},{"id":2634247422,"node_id":"MDEyOkxhYmVsZWRFdmVudDI2MzQyNDc0MjI=","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2634247422","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-09-14T17:32:43Z","label":{"name":"ACTIVE","color":"f9de7a"},"performed_via_github_app":null},{"id":2634361024,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjYzNDM2MTAyNA==","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2634361024","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2019-09-14T22:19:16Z","rename":{"from":"SerializationFeature: Write enum using index should be able to ignore `Enum` key for `Map` ","to":"Add `SerializationFeature.WRITE_ENUM_KEYS_"},"performed_via_github_app":null},{"id":2634361081,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjYzNDM2MTA4MQ==","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2634361081","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2019-09-14T22:19:29Z","rename":{"from":"Add `SerializationFeature.WRITE_ENUM_KEYS_","to":"Add `SerializationFeature.WRITE_ENUM_KEYS_USING_INDEX`, separate from value setting"},"performed_via_github_app":null},{"id":2634362039,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDI2MzQzNjIwMzk=","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2634362039","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2019-09-14T22:22:45Z","milestone":{"title":"2.10.0"},"performed_via_github_app":null},{"id":2634421592,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI2MzQ0MjE1OTI=","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2634421592","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"c4ecc0128819ebaaf2d3dda4726117e0e8fa9969","commit_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits/c4ecc0128819ebaaf2d3dda4726117e0e8fa9969","created_at":"2019-09-15T02:06:51Z","performed_via_github_app":null},{"id":2634421808,"node_id":"MDExOkNsb3NlZEV2ZW50MjYzNDQyMTgwOA==","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2634421808","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"c4ecc0128819ebaaf2d3dda4726117e0e8fa9969","commit_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits/c4ecc0128819ebaaf2d3dda4726117e0e8fa9969","created_at":"2019-09-15T02:07:42Z","state_reason":null,"performed_via_github_app":null},{"actor":{"login":"mawifu","id":35260550,"node_id":"MDQ6VXNlcjM1MjYwNTUw","avatar_url":"https://avatars.githubusercontent.com/u/35260550?v=4","gravatar_id":"","url":"https://api.github.com/users/mawifu","html_url":"https://github.com/mawifu","followers_url":"https://api.github.com/users/mawifu/followers","following_url":"https://api.github.com/users/mawifu/following{/other_user}","gists_url":"https://api.github.com/users/mawifu/gists{/gist_id}","starred_url":"https://api.github.com/users/mawifu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mawifu/subscriptions","organizations_url":"https://api.github.com/users/mawifu/orgs","repos_url":"https://api.github.com/users/mawifu/repos","events_url":"https://api.github.com/users/mawifu/events{/privacy}","received_events_url":"https://api.github.com/users/mawifu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-08T12:44:57Z","updated_at":"2019-11-08T12:44:57Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2536","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2536/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2536/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2536/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/2536","id":519995604,"node_id":"MDU6SXNzdWU1MTk5OTU2MDQ=","number":2536,"title":"Add `EnumFeature.READ_ENUM_KEYS_USING_INDEX` to work with existing \"WRITE_ENUM_KEYS_USING_INDEX\"","user":{"login":"mawifu","id":35260550,"node_id":"MDQ6VXNlcjM1MjYwNTUw","avatar_url":"https://avatars.githubusercontent.com/u/35260550?v=4","gravatar_id":"","url":"https://api.github.com/users/mawifu","html_url":"https://github.com/mawifu","followers_url":"https://api.github.com/users/mawifu/followers","following_url":"https://api.github.com/users/mawifu/following{/other_user}","gists_url":"https://api.github.com/users/mawifu/gists{/gist_id}","starred_url":"https://api.github.com/users/mawifu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mawifu/subscriptions","organizations_url":"https://api.github.com/users/mawifu/orgs","repos_url":"https://api.github.com/users/mawifu/repos","events_url":"https://api.github.com/users/mawifu/events{/privacy}","received_events_url":"https://api.github.com/users/mawifu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3895061927,"node_id":"LA_kwDOAC5e2c7oKe2n","url":"https://api.github.com/repos/FasterXML/jackson-databind/labels/enum","name":"enum","color":"A596C8","default":false,"description":"Related to handling of Enum values"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/147","html_url":"https://github.com/FasterXML/jackson-databind/milestone/147","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/147/labels","id":8674405,"node_id":"MI_kwDOAC5e2c4AhFxl","number":147,"title":"2.15.0","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":37,"state":"closed","created_at":"2022-11-21T02:41:45Z","updated_at":"2025-10-30T23:29:18Z","due_on":null,"closed_at":"2025-10-30T23:29:18Z"},"comments":4,"created_at":"2019-11-08T12:44:57Z","updated_at":"2023-02-09T05:00:55Z","closed_at":"2023-02-09T05:00:55Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":3038937,"node_id":"MDEwOlJlcG9zaXRvcnkzMDM4OTM3","name":"jackson-databind","full_name":"FasterXML/jackson-databind","private":false,"owner":{"login":"FasterXML","id":382692,"node_id":"MDEyOk9yZ2FuaXphdGlvbjM4MjY5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/382692?v=4","gravatar_id":"","url":"https://api.github.com/users/FasterXML","html_url":"https://github.com/FasterXML","followers_url":"https://api.github.com/users/FasterXML/followers","following_url":"https://api.github.com/users/FasterXML/following{/other_user}","gists_url":"https://api.github.com/users/FasterXML/gists{/gist_id}","starred_url":"https://api.github.com/users/FasterXML/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FasterXML/subscriptions","organizations_url":"https://api.github.com/users/FasterXML/orgs","repos_url":"https://api.github.com/users/FasterXML/repos","events_url":"https://api.github.com/users/FasterXML/events{/privacy}","received_events_url":"https://api.github.com/users/FasterXML/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/FasterXML/jackson-databind","description":"General data-binding package for Jackson (2.x): works on streaming API (core) implementation(s)","fork":false,"url":"https://api.github.com/repos/FasterXML/jackson-databind","forks_url":"https://api.github.com/repos/FasterXML/jackson-databind/forks","keys_url":"https://api.github.com/repos/FasterXML/jackson-databind/keys{/key_id}","collaborators_url":"https://api.github.com/repos/FasterXML/jackson-databind/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/FasterXML/jackson-databind/teams","hooks_url":"https://api.github.com/repos/FasterXML/jackson-databind/hooks","issue_events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events{/number}","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/events","assignees_url":"https://api.github.com/repos/FasterXML/jackson-databind/assignees{/user}","branches_url":"https://api.github.com/repos/FasterXML/jackson-databind/branches{/branch}","tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/tags","blobs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/refs{/sha}","trees_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/trees{/sha}","statuses_url":"https://api.github.com/repos/FasterXML/jackson-databind/statuses/{sha}","languages_url":"https://api.github.com/repos/FasterXML/jackson-databind/languages","stargazers_url":"https://api.github.com/repos/FasterXML/jackson-databind/stargazers","contributors_url":"https://api.github.com/repos/FasterXML/jackson-databind/contributors","subscribers_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscribers","subscription_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscription","commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits{/sha}","git_commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/commits{/sha}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/comments{/number}","issue_comment_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments{/number}","contents_url":"https://api.github.com/repos/FasterXML/jackson-databind/contents/{+path}","compare_url":"https://api.github.com/repos/FasterXML/jackson-databind/compare/{base}...{head}","merges_url":"https://api.github.com/repos/FasterXML/jackson-databind/merges","archive_url":"https://api.github.com/repos/FasterXML/jackson-databind/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/FasterXML/jackson-databind/downloads","issues_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues{/number}","pulls_url":"https://api.github.com/repos/FasterXML/jackson-databind/pulls{/number}","milestones_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones{/number}","notifications_url":"https://api.github.com/repos/FasterXML/jackson-databind/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/labels{/name}","releases_url":"https://api.github.com/repos/FasterXML/jackson-databind/releases{/id}","deployments_url":"https://api.github.com/repos/FasterXML/jackson-databind/deployments","created_at":"2011-12-23T07:17:41Z","updated_at":"2025-11-08T13:34:42Z","pushed_at":"2025-11-07T22:16:42Z","git_url":"git://github.com/FasterXML/jackson-databind.git","ssh_url":"git@github.com:FasterXML/jackson-databind.git","clone_url":"https://github.com/FasterXML/jackson-databind.git","svn_url":"https://github.com/FasterXML/jackson-databind","homepage":"","size":83232,"stargazers_count":3644,"watchers_count":3644,"language":"Java","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":1446,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":382,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","jackson","jackson-databind","json"],"visibility":"public","forks":1446,"open_issues":382,"watchers":3644,"default_branch":"3.x","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"With #2129 and jackson 2.10.0 a new Feature WRITE_ENUM_KEYS_USING_INDEX was introduced.\r\n\r\nSo we now can write an enum used in a map as key as number/enum index.\r\n(This is usefull as the other side is written in C and works indexed based, ...)\r\nThat works fine. See Example below.\r\n\r\nProblem: the json generated by jackson this way cannot be deserialized.\r\n\r\nThis unbalanced situation - jackson cannot read his own json - was described in #1877 \r\n\r\nSeems jackson needs a feature like \"READ_ENUM_KEYS_USING_INDEX\" (suggestion regarding #2129 ) \r\n\r\nSample Code explaining the situation:\r\n\r\n\r\n```\r\npackage jackson_enum_as_key;\r\n\r\nimport com.fasterxml.jackson.databind.*;\r\n\r\nimport java.io.IOException;\r\nimport java.util.*;\r\n\r\npublic class Main {\r\n\r\n    public enum Type {\r\n        ANY,\r\n        OTHER\r\n    }\r\n\r\n    public static class Container {\r\n        private Type simpleType;\r\n        private Map<Type, String> map;\r\n\r\n        public Type getSimpleType() {\r\n            return simpleType;\r\n        }\r\n\r\n        public void setSimpleType(Type simpleType) {\r\n            this.simpleType= simpleType;\r\n        }\r\n\r\n        public Map<Type, String> getMap() {\r\n            return map;\r\n        }\r\n\r\n        public void setMap(Map<Type, String> map) {\r\n            this.map = map;\r\n        }\r\n    }\r\n\r\n    public static void main(String[] args) throws IOException {\r\n        ObjectMapper objectMapper = new ObjectMapper();\r\n        objectMapper.configure(SerializationFeature.WRITE_ENUMS_USING_INDEX, true);\r\n        objectMapper.configure(SerializationFeature.WRITE_ENUM_KEYS_USING_INDEX, true);\r\n\r\n        Map<Type, String> map = new HashMap<>();\r\n        map.put(Type.OTHER, \"hello world\");\r\n        Container container = new Container();\r\n        container.setSimpleType(Type.ANY);\r\n        container.setMap(map);\r\n\r\n        String json = objectMapper.writeValueAsString(container);\r\n\r\n        System.out.println(json);\r\n\r\n        objectMapper.readValue(json, Container.class);\r\n    }\r\n}\r\n```\r\n\r\nProblem:\r\n\r\n\r\n```\r\n/opt/java/jdk1.8.0_151/bin/java jackson_enum_as_key.Main\r\n\r\n{\"simpleType\":0,\"map\":{\"1\":\"hello world\"}}\r\nException in thread \"main\" com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize Map key of type `jackson_enum_as_key.Main$Type` from String \"1\": not a valid representation, problem: (com.fasterxml.jackson.databind.exc.InvalidFormatException) Cannot deserialize Map key of type `jackson_enum_as_key.Main$Type` from String \"1\": not one of the values accepted for Enum class: [OTHER, ANY]\r\n at [Source: (String)\"{\"simpleType\":0,\"map\":{\"1\":\"hello world\"}}\"; line: 1, column: 24] (through reference chain: jackson_enum_as_key.Main$Container[\"map\"])\r\n\tat com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)\r\n\tat com.fasterxml.jackson.databind.DeserializationContext.weirdKeyException(DeserializationContext.java:1653)\r\n\tat com.fasterxml.jackson.databind.DeserializationContext.handleWeirdKey(DeserializationContext.java:886)\r\n\tat com.fasterxml.jackson.databind.deser.std.StdKeyDeserializer.deserializeKey(StdKeyDeserializer.java:138)\r\n\tat com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBind(MapDeserializer.java:449)\r\n\tat com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:367)\r\n\tat com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:29)\r\n\tat com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)\r\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:288)\r\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:151)\r\n\tat com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4202)\r\n\tat com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3205)\r\n\tat com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3173)\r\n\tat jackson_enum_as_key.Main.main(Main.java:51)\r\n\r\nProcess finished with exit code 1\r\n\r\n\r\n\r\n\r\n\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2536/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":3225326303,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MzIyNTMyNjMwMw==","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/3225326303","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2020-04-12T18:11:56Z","label":{"name":"2.10","color":"006b75"},"performed_via_github_app":null},{"id":3225326304,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MzIyNTMyNjMwNA==","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/3225326304","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2020-04-12T18:11:56Z","label":{"name":"ACTIVE","color":"f9de7a"},"performed_via_github_app":null}]