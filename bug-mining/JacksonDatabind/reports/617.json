{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/3369","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/3369/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/3369/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/3369/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/3369","id":1099738592,"node_id":"I_kwDOAC5e2c5BjK3g","number":3369,"title":"Deserialization ignores other Object fields when Object or Array value used for enum","user":{"login":"Krishnaghimire","id":31277784,"node_id":"MDQ6VXNlcjMxMjc3Nzg0","avatar_url":"https://avatars.githubusercontent.com/u/31277784?v=4","gravatar_id":"","url":"https://api.github.com/users/Krishnaghimire","html_url":"https://github.com/Krishnaghimire","followers_url":"https://api.github.com/users/Krishnaghimire/followers","following_url":"https://api.github.com/users/Krishnaghimire/following{/other_user}","gists_url":"https://api.github.com/users/Krishnaghimire/gists{/gist_id}","starred_url":"https://api.github.com/users/Krishnaghimire/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Krishnaghimire/subscriptions","organizations_url":"https://api.github.com/users/Krishnaghimire/orgs","repos_url":"https://api.github.com/users/Krishnaghimire/repos","events_url":"https://api.github.com/users/Krishnaghimire/events{/privacy}","received_events_url":"https://api.github.com/users/Krishnaghimire/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-01-12T00:12:55Z","updated_at":"2022-01-15T01:27:02Z","closed_at":"2022-01-15T01:27:02Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Describe the bug**\r\nObjectmapper deserialization ignore other field when Object or Array field used for enum\r\n\r\n**Version information**\r\n2.13.1\r\n\r\n**To Reproduce**\r\n\r\n```\r\nimport com.fasterxml.jackson.annotation.JsonCreator;\r\nimport com.fasterxml.jackson.annotation.JsonIgnoreProperties;\r\nimport com.fasterxml.jackson.core.JsonProcessingException;\r\nimport com.fasterxml.jackson.databind.ObjectMapper;\r\n\r\npublic class JacksonIssue {\r\n  public static void main(String[] args) throws JsonProcessingException {\r\n\r\n    ObjectMapper objectMapper = new ObjectMapper();\r\n    String validData = \"{\\\"value\\\" : \\\"a\\\", \\\"person\\\" : \\\"Jeff\\\", \\\"age\\\" : 30}\";\r\n\r\n    Data data = objectMapper.readValue(validData, Data.class);\r\n    System.out.println(data);\r\n\r\n    String invalidEnum = \"{\\\"value\\\" : \\\"e\\\", \\\"person\\\" : \\\"Jeff\\\", \\\"age\\\" : 30}\";\r\n\r\n    data = objectMapper.readValue(invalidEnum, Data.class);\r\n    System.out.println(data);\r\n\r\n    String enumAsArray = \"{\\\"value\\\" : [\\\"a\\\"], \\\"person\\\" : \\\"Jeff\\\", \\\"age\\\" : 30}\";\r\n\r\n    data = objectMapper.readValue(enumAsArray, Data.class);\r\n    System.out.println(data);\r\n\r\n    String enumAsObjecty = \"{\\\"value\\\" : {\\\"a\\\":{}}, \\\"person\\\" : \\\"Jeff\\\", \\\"age\\\": 30}\";\r\n\r\n    data = objectMapper.readValue(enumAsObjecty, Data.class);\r\n    System.out.println(data);\r\n  }\r\n\r\n  @JsonIgnoreProperties(ignoreUnknown = true)\r\n  static class Data {\r\n    Enum value;\r\n    String person;\r\n    Integer age;\r\n\r\n    public Enum getValue() {\r\n      return this.value;\r\n    }\r\n\r\n    public String getPerson() {\r\n      return this.person;\r\n    }\r\n\r\n    public Integer getAge() {\r\n      return this.age;\r\n    }\r\n\r\n    public void setValue(Enum value) {\r\n      this.value = value;\r\n    }\r\n\r\n    public void setPerson(String person) {\r\n      this.person = person;\r\n    }\r\n\r\n    public void setAge(Integer age) {\r\n      this.age = age;\r\n    }\r\n\r\n    public String toString() {\r\n      return \"JacksonIssue.Data(value=\" + this.getValue() + \", person=\" + this.getPerson() + \", age=\" + this.getAge()\r\n          + \")\";\r\n    }\r\n  }\r\n\r\n  enum Enum {\r\n    A(\"ENUM_A\"), B(\"ENUM_B\"), C(\"ENUM_C\"), D(\"ENUM_D\");\r\n    private String name;\r\n\r\n    Enum(String name) {\r\n      this.name = name;\r\n    }\r\n\r\n    @JsonCreator\r\n    public static Enum fromName(String name) {\r\n      if (name != null) {\r\n        switch (name) {\r\n          case \"a\":\r\n            return A;\r\n          case \"b\":\r\n            return B;\r\n          case \"c\":\r\n            return C;\r\n          case \"d\":\r\n            return D;\r\n        }\r\n      }\r\n      return null;\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n**Expected behavior**\r\n\r\n3rd and 4th conversion should either fail or should de-serialize person and age. \r\nExpected output:\r\n\r\n```\r\nJacksonIssue.Data(value=A, person=Jeff, age=30)\r\nJacksonIssue.Data(value=null, person=Jeff, age=30)\r\nJacksonIssue.Data(value=null, person=Jeff, age=30)\r\nJacksonIssue.Data(value=null, person=Jeff, age=30)\r\n```\r\n\r\nActual output:\r\n\r\n```\r\nJacksonIssue.Data(value=A, person=Jeff, age=30)\r\nJacksonIssue.Data(value=null, person=Jeff, age=30)\r\nJacksonIssue.Data(value=null, person=null, age=null)\r\nJacksonIssue.Data(value=null, person=null, age=null)\r\n```\r\n\r\n**Additional context**\r\nIts similar to https://github.com/FasterXML/jackson-databind/issues/1859 one.\r\nI could fix the issue by adding,   p.skipChildren();\r\nin FactoryBasedEnumDeserializer after line 151.\r\n            // 12-Oct-2021, tatu: We really should only get here if and when String\r\n            //    value is expected; otherwise Deserializer should have been used earlier\r\n            value = p.getValueAsString();\r\n           p.skipChildren();\r\n","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/3369/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/3369/timeline","performed_via_github_app":null,"state_reason":"completed"}