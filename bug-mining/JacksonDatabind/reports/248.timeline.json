[{"id":850894460,"node_id":"MDExOkNsb3NlZEV2ZW50ODUwODk0NDYw","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/850894460","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"bd36ce49411847a6e41af1f5228f77340c3f003d","commit_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits/bd36ce49411847a6e41af1f5228f77340c3f003d","created_at":"2016-11-08T02:31:25Z","state_reason":null,"performed_via_github_app":null},{"id":850894461,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDg1MDg5NDQ2MQ==","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/850894461","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2016-11-08T02:31:25Z","milestone":{"title":"2.9.0"},"performed_via_github_app":null},{"actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-11-08T02:32:53Z","updated_at":"2016-11-08T02:32:53Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1442","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1442/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1442/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1442/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/1442","id":187004981,"node_id":"MDU6SXNzdWUxODcwMDQ5ODE=","number":1442,"title":"JsonInclude.Include.NON_NULL not honoured for Map","user":{"login":"axelfontaine","id":684824,"node_id":"MDQ6VXNlcjY4NDgyNA==","avatar_url":"https://avatars.githubusercontent.com/u/684824?v=4","gravatar_id":"","url":"https://api.github.com/users/axelfontaine","html_url":"https://github.com/axelfontaine","followers_url":"https://api.github.com/users/axelfontaine/followers","following_url":"https://api.github.com/users/axelfontaine/following{/other_user}","gists_url":"https://api.github.com/users/axelfontaine/gists{/gist_id}","starred_url":"https://api.github.com/users/axelfontaine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/axelfontaine/subscriptions","organizations_url":"https://api.github.com/users/axelfontaine/orgs","repos_url":"https://api.github.com/users/axelfontaine/repos","events_url":"https://api.github.com/users/axelfontaine/events{/privacy}","received_events_url":"https://api.github.com/users/axelfontaine/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-11-03T08:59:33Z","updated_at":"2016-11-08T02:32:53Z","closed_at":"2016-11-08T02:32:53Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":3038937,"node_id":"MDEwOlJlcG9zaXRvcnkzMDM4OTM3","name":"jackson-databind","full_name":"FasterXML/jackson-databind","private":false,"owner":{"login":"FasterXML","id":382692,"node_id":"MDEyOk9yZ2FuaXphdGlvbjM4MjY5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/382692?v=4","gravatar_id":"","url":"https://api.github.com/users/FasterXML","html_url":"https://github.com/FasterXML","followers_url":"https://api.github.com/users/FasterXML/followers","following_url":"https://api.github.com/users/FasterXML/following{/other_user}","gists_url":"https://api.github.com/users/FasterXML/gists{/gist_id}","starred_url":"https://api.github.com/users/FasterXML/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FasterXML/subscriptions","organizations_url":"https://api.github.com/users/FasterXML/orgs","repos_url":"https://api.github.com/users/FasterXML/repos","events_url":"https://api.github.com/users/FasterXML/events{/privacy}","received_events_url":"https://api.github.com/users/FasterXML/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/FasterXML/jackson-databind","description":"General data-binding package for Jackson (2.x): works on streaming API (core) implementation(s)","fork":false,"url":"https://api.github.com/repos/FasterXML/jackson-databind","forks_url":"https://api.github.com/repos/FasterXML/jackson-databind/forks","keys_url":"https://api.github.com/repos/FasterXML/jackson-databind/keys{/key_id}","collaborators_url":"https://api.github.com/repos/FasterXML/jackson-databind/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/FasterXML/jackson-databind/teams","hooks_url":"https://api.github.com/repos/FasterXML/jackson-databind/hooks","issue_events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events{/number}","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/events","assignees_url":"https://api.github.com/repos/FasterXML/jackson-databind/assignees{/user}","branches_url":"https://api.github.com/repos/FasterXML/jackson-databind/branches{/branch}","tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/tags","blobs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/refs{/sha}","trees_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/trees{/sha}","statuses_url":"https://api.github.com/repos/FasterXML/jackson-databind/statuses/{sha}","languages_url":"https://api.github.com/repos/FasterXML/jackson-databind/languages","stargazers_url":"https://api.github.com/repos/FasterXML/jackson-databind/stargazers","contributors_url":"https://api.github.com/repos/FasterXML/jackson-databind/contributors","subscribers_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscribers","subscription_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscription","commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits{/sha}","git_commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/commits{/sha}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/comments{/number}","issue_comment_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments{/number}","contents_url":"https://api.github.com/repos/FasterXML/jackson-databind/contents/{+path}","compare_url":"https://api.github.com/repos/FasterXML/jackson-databind/compare/{base}...{head}","merges_url":"https://api.github.com/repos/FasterXML/jackson-databind/merges","archive_url":"https://api.github.com/repos/FasterXML/jackson-databind/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/FasterXML/jackson-databind/downloads","issues_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues{/number}","pulls_url":"https://api.github.com/repos/FasterXML/jackson-databind/pulls{/number}","milestones_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones{/number}","notifications_url":"https://api.github.com/repos/FasterXML/jackson-databind/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/labels{/name}","releases_url":"https://api.github.com/repos/FasterXML/jackson-databind/releases{/id}","deployments_url":"https://api.github.com/repos/FasterXML/jackson-databind/deployments","created_at":"2011-12-23T07:17:41Z","updated_at":"2025-11-08T13:34:42Z","pushed_at":"2025-11-07T22:16:42Z","git_url":"git://github.com/FasterXML/jackson-databind.git","ssh_url":"git@github.com:FasterXML/jackson-databind.git","clone_url":"https://github.com/FasterXML/jackson-databind.git","svn_url":"https://github.com/FasterXML/jackson-databind","homepage":"","size":83232,"stargazers_count":3644,"watchers_count":3644,"language":"Java","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":1446,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":382,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","jackson","jackson-databind","json"],"visibility":"public","forks":1446,"open_issues":382,"watchers":3644,"default_branch":"3.x","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Jackson Version: 2.8.4\r\n\r\n```\r\nMap<String, Object> in = new TreeMap<>();\r\nin.put(\"abc\", \"123\");\r\nin.put(\"def\", null);\r\nin.put(\"ghi\", 456);\r\n\r\nString json = new ObjectMapper().setSerializationInclusion(JsonInclude.Include.NON_NULL).writeValueAsString(in);\r\n\r\nassertThat(json, not(containsString(\"def\")));\r\nassertThat(json, not(containsString(\"null\")));\r\n```\r\n\r\nEven though the json string shouldn't contain \"def\" or \"null\", it still does.","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1442/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"actor":{"login":"mattnworb","id":113840,"node_id":"MDQ6VXNlcjExMzg0MA==","avatar_url":"https://avatars.githubusercontent.com/u/113840?v=4","gravatar_id":"","url":"https://api.github.com/users/mattnworb","html_url":"https://github.com/mattnworb","followers_url":"https://api.github.com/users/mattnworb/followers","following_url":"https://api.github.com/users/mattnworb/following{/other_user}","gists_url":"https://api.github.com/users/mattnworb/gists{/gist_id}","starred_url":"https://api.github.com/users/mattnworb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mattnworb/subscriptions","organizations_url":"https://api.github.com/users/mattnworb/orgs","repos_url":"https://api.github.com/users/mattnworb/repos","events_url":"https://api.github.com/users/mattnworb/events{/privacy}","received_events_url":"https://api.github.com/users/mattnworb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-17T20:53:58Z","updated_at":"2017-08-17T20:53:58Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1736","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1736/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1736/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1736/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/1736","id":251069198,"node_id":"MDU6SXNzdWUyNTEwNjkxOTg=","number":1736,"title":"Change in behavior for ObjectWriter and setSerializationInclusion(JsonInclude.Include.NON_EMPTY) between 2.8.9 and 2.9.0","user":{"login":"mattnworb","id":113840,"node_id":"MDQ6VXNlcjExMzg0MA==","avatar_url":"https://avatars.githubusercontent.com/u/113840?v=4","gravatar_id":"","url":"https://api.github.com/users/mattnworb","html_url":"https://github.com/mattnworb","followers_url":"https://api.github.com/users/mattnworb/followers","following_url":"https://api.github.com/users/mattnworb/following{/other_user}","gists_url":"https://api.github.com/users/mattnworb/gists{/gist_id}","starred_url":"https://api.github.com/users/mattnworb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mattnworb/subscriptions","organizations_url":"https://api.github.com/users/mattnworb/orgs","repos_url":"https://api.github.com/users/mattnworb/repos","events_url":"https://api.github.com/users/mattnworb/events{/privacy}","received_events_url":"https://api.github.com/users/mattnworb/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-08-17T20:53:58Z","updated_at":"2017-08-18T17:46:31Z","closed_at":"2017-08-18T17:46:31Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":3038937,"node_id":"MDEwOlJlcG9zaXRvcnkzMDM4OTM3","name":"jackson-databind","full_name":"FasterXML/jackson-databind","private":false,"owner":{"login":"FasterXML","id":382692,"node_id":"MDEyOk9yZ2FuaXphdGlvbjM4MjY5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/382692?v=4","gravatar_id":"","url":"https://api.github.com/users/FasterXML","html_url":"https://github.com/FasterXML","followers_url":"https://api.github.com/users/FasterXML/followers","following_url":"https://api.github.com/users/FasterXML/following{/other_user}","gists_url":"https://api.github.com/users/FasterXML/gists{/gist_id}","starred_url":"https://api.github.com/users/FasterXML/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FasterXML/subscriptions","organizations_url":"https://api.github.com/users/FasterXML/orgs","repos_url":"https://api.github.com/users/FasterXML/repos","events_url":"https://api.github.com/users/FasterXML/events{/privacy}","received_events_url":"https://api.github.com/users/FasterXML/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/FasterXML/jackson-databind","description":"General data-binding package for Jackson (2.x): works on streaming API (core) implementation(s)","fork":false,"url":"https://api.github.com/repos/FasterXML/jackson-databind","forks_url":"https://api.github.com/repos/FasterXML/jackson-databind/forks","keys_url":"https://api.github.com/repos/FasterXML/jackson-databind/keys{/key_id}","collaborators_url":"https://api.github.com/repos/FasterXML/jackson-databind/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/FasterXML/jackson-databind/teams","hooks_url":"https://api.github.com/repos/FasterXML/jackson-databind/hooks","issue_events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events{/number}","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/events","assignees_url":"https://api.github.com/repos/FasterXML/jackson-databind/assignees{/user}","branches_url":"https://api.github.com/repos/FasterXML/jackson-databind/branches{/branch}","tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/tags","blobs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/refs{/sha}","trees_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/trees{/sha}","statuses_url":"https://api.github.com/repos/FasterXML/jackson-databind/statuses/{sha}","languages_url":"https://api.github.com/repos/FasterXML/jackson-databind/languages","stargazers_url":"https://api.github.com/repos/FasterXML/jackson-databind/stargazers","contributors_url":"https://api.github.com/repos/FasterXML/jackson-databind/contributors","subscribers_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscribers","subscription_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscription","commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits{/sha}","git_commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/commits{/sha}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/comments{/number}","issue_comment_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments{/number}","contents_url":"https://api.github.com/repos/FasterXML/jackson-databind/contents/{+path}","compare_url":"https://api.github.com/repos/FasterXML/jackson-databind/compare/{base}...{head}","merges_url":"https://api.github.com/repos/FasterXML/jackson-databind/merges","archive_url":"https://api.github.com/repos/FasterXML/jackson-databind/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/FasterXML/jackson-databind/downloads","issues_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues{/number}","pulls_url":"https://api.github.com/repos/FasterXML/jackson-databind/pulls{/number}","milestones_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones{/number}","notifications_url":"https://api.github.com/repos/FasterXML/jackson-databind/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/labels{/name}","releases_url":"https://api.github.com/repos/FasterXML/jackson-databind/releases{/id}","deployments_url":"https://api.github.com/repos/FasterXML/jackson-databind/deployments","created_at":"2011-12-23T07:17:41Z","updated_at":"2025-11-08T13:34:42Z","pushed_at":"2025-11-07T22:16:42Z","git_url":"git://github.com/FasterXML/jackson-databind.git","ssh_url":"git@github.com:FasterXML/jackson-databind.git","clone_url":"https://github.com/FasterXML/jackson-databind.git","svn_url":"https://github.com/FasterXML/jackson-databind","homepage":"","size":83232,"stargazers_count":3644,"watchers_count":3644,"language":"Java","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":1446,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":382,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","jackson","jackson-databind","json"],"visibility":"public","forks":1446,"open_issues":382,"watchers":3644,"default_branch":"3.x","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I've found a change in behavior in ObjectWriter when serializationInclusion is set to JsonInclude.Include.NON_EMPTY between version 2.8.9 and 2.9.0 that I wanted to check to see if it was intentional.\r\n\r\nThe application creates an ObjectMapper instance with the default serializationInclusion behavior, and an ObjectWriter based off of the ObjectMapper but with `setSerializationInclusion(JsonInclude.Include.NON_EMPTY)`. \r\n\r\nA particular function is given a complex POJO object and passes it through `objectWriter.writeValueAsString()`, and then deserializes that String back into a `Map<String, Object>` with `objectMapper.readValue(str, map type reference)`. Then the Map is passed through `objectWriter.writeValueAsString()`.\r\n\r\nAfter upgrading from 2.8.9 to 2.9.0, I noticed that one of the fields in the complex POJO, which has a series of nested fields which serializes into an empty object (`{}`), is no longer included in the output of `objectWriter.writeValueAsString()`.\r\n\r\nBelow is a test case that reproduces this behavior: with 2.8.9, both test cases pass, but in 2.9.0 the `testStringToMapToString` test fails. \r\n\r\nI am just curious if this change is intentional? It sounds like it may be related to #1444.\r\n\r\n```java\r\n\r\nimport static com.fasterxml.jackson.databind.MapperFeature.SORT_PROPERTIES_ALPHABETICALLY;\r\nimport static com.fasterxml.jackson.databind.SerializationFeature.ORDER_MAP_ENTRIES_BY_KEYS;\r\nimport static org.junit.Assert.assertEquals;\r\nimport static org.junit.Assert.assertTrue;\r\n\r\nimport com.fasterxml.jackson.annotation.JsonInclude;\r\nimport com.fasterxml.jackson.core.type.TypeReference;\r\nimport com.fasterxml.jackson.databind.JsonNode;\r\nimport com.fasterxml.jackson.databind.ObjectMapper;\r\nimport com.fasterxml.jackson.databind.ObjectWriter;\r\nimport java.util.Map;\r\nimport org.junit.Test;\r\n\r\npublic class JsonTest {\r\n\r\n  private final ObjectMapper objectMapper = new ObjectMapper()\r\n      .configure(SORT_PROPERTIES_ALPHABETICALLY, true)\r\n      .configure(ORDER_MAP_ENTRIES_BY_KEYS, true);\r\n\r\n  private final ObjectWriter objectWriter = objectMapper\r\n      .setSerializationInclusion(JsonInclude.Include.NON_EMPTY)\r\n      .writer();\r\n\r\n  private final TypeReference<Map<String, Object>> mapTypeReference =\r\n      new TypeReference<Map<String, Object>>() {\r\n      };\r\n\r\n  private final String json = \"{\\\"a\\\":\\\"b\\\",\\\"foo\\\":{\\\"bar\\\":{\\\"baz\\\":{\\\"bat\\\":{}}}}}\";\r\n\r\n  @Test\r\n  public void testStringToMapToString() throws Exception {\r\n    final Map<String, Object> map = objectMapper.readValue(json, mapTypeReference);\r\n    assertTrue(map.containsKey(\"foo\"));\r\n    assertEquals(json, objectWriter.writeValueAsString(map));\r\n  }\r\n\r\n  @Test\r\n  public void testStringToJsonNodeToString() throws Exception {\r\n    final JsonNode jsonNode = objectMapper.readTree(json);\r\n    assertTrue(jsonNode.has(\"foo\"));\r\n    assertEquals(json, objectWriter.writeValueAsString(jsonNode));\r\n  }\r\n}\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1736/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"actor":{"login":"mattnworb","id":113840,"node_id":"MDQ6VXNlcjExMzg0MA==","avatar_url":"https://avatars.githubusercontent.com/u/113840?v=4","gravatar_id":"","url":"https://api.github.com/users/mattnworb","html_url":"https://github.com/mattnworb","followers_url":"https://api.github.com/users/mattnworb/followers","following_url":"https://api.github.com/users/mattnworb/following{/other_user}","gists_url":"https://api.github.com/users/mattnworb/gists{/gist_id}","starred_url":"https://api.github.com/users/mattnworb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mattnworb/subscriptions","organizations_url":"https://api.github.com/users/mattnworb/orgs","repos_url":"https://api.github.com/users/mattnworb/repos","events_url":"https://api.github.com/users/mattnworb/events{/privacy}","received_events_url":"https://api.github.com/users/mattnworb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-17T21:58:31Z","updated_at":"2017-08-17T21:58:31Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/spotify/helios/issues/1143","repository_url":"https://api.github.com/repos/spotify/helios","labels_url":"https://api.github.com/repos/spotify/helios/issues/1143/labels{/name}","comments_url":"https://api.github.com/repos/spotify/helios/issues/1143/comments","events_url":"https://api.github.com/repos/spotify/helios/issues/1143/events","html_url":"https://github.com/spotify/helios/issues/1143","id":251084346,"node_id":"MDU6SXNzdWUyNTEwODQzNDY=","number":1143,"title":"\"Id hash mismatch\" if helios-client/helios-testing uses Jackson 2.9.x while helios-master/helios-solo uses Jackson 2.8.x","user":{"login":"mattnworb","id":113840,"node_id":"MDQ6VXNlcjExMzg0MA==","avatar_url":"https://avatars.githubusercontent.com/u/113840?v=4","gravatar_id":"","url":"https://api.github.com/users/mattnworb","html_url":"https://github.com/mattnworb","followers_url":"https://api.github.com/users/mattnworb/followers","following_url":"https://api.github.com/users/mattnworb/following{/other_user}","gists_url":"https://api.github.com/users/mattnworb/gists{/gist_id}","starred_url":"https://api.github.com/users/mattnworb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mattnworb/subscriptions","organizations_url":"https://api.github.com/users/mattnworb/orgs","repos_url":"https://api.github.com/users/mattnworb/repos","events_url":"https://api.github.com/users/mattnworb/events{/privacy}","received_events_url":"https://api.github.com/users/mattnworb/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2017-08-17T21:58:31Z","updated_at":"2017-10-03T13:48:47Z","closed_at":"2017-10-03T13:48:47Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":20171642,"node_id":"MDEwOlJlcG9zaXRvcnkyMDE3MTY0Mg==","name":"helios","full_name":"spotify/helios","private":false,"owner":{"login":"spotify","id":251374,"node_id":"MDEyOk9yZ2FuaXphdGlvbjI1MTM3NA==","avatar_url":"https://avatars.githubusercontent.com/u/251374?v=4","gravatar_id":"","url":"https://api.github.com/users/spotify","html_url":"https://github.com/spotify","followers_url":"https://api.github.com/users/spotify/followers","following_url":"https://api.github.com/users/spotify/following{/other_user}","gists_url":"https://api.github.com/users/spotify/gists{/gist_id}","starred_url":"https://api.github.com/users/spotify/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spotify/subscriptions","organizations_url":"https://api.github.com/users/spotify/orgs","repos_url":"https://api.github.com/users/spotify/repos","events_url":"https://api.github.com/users/spotify/events{/privacy}","received_events_url":"https://api.github.com/users/spotify/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/spotify/helios","description":"Docker container orchestration platform","fork":false,"url":"https://api.github.com/repos/spotify/helios","forks_url":"https://api.github.com/repos/spotify/helios/forks","keys_url":"https://api.github.com/repos/spotify/helios/keys{/key_id}","collaborators_url":"https://api.github.com/repos/spotify/helios/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/spotify/helios/teams","hooks_url":"https://api.github.com/repos/spotify/helios/hooks","issue_events_url":"https://api.github.com/repos/spotify/helios/issues/events{/number}","events_url":"https://api.github.com/repos/spotify/helios/events","assignees_url":"https://api.github.com/repos/spotify/helios/assignees{/user}","branches_url":"https://api.github.com/repos/spotify/helios/branches{/branch}","tags_url":"https://api.github.com/repos/spotify/helios/tags","blobs_url":"https://api.github.com/repos/spotify/helios/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/spotify/helios/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/spotify/helios/git/refs{/sha}","trees_url":"https://api.github.com/repos/spotify/helios/git/trees{/sha}","statuses_url":"https://api.github.com/repos/spotify/helios/statuses/{sha}","languages_url":"https://api.github.com/repos/spotify/helios/languages","stargazers_url":"https://api.github.com/repos/spotify/helios/stargazers","contributors_url":"https://api.github.com/repos/spotify/helios/contributors","subscribers_url":"https://api.github.com/repos/spotify/helios/subscribers","subscription_url":"https://api.github.com/repos/spotify/helios/subscription","commits_url":"https://api.github.com/repos/spotify/helios/commits{/sha}","git_commits_url":"https://api.github.com/repos/spotify/helios/git/commits{/sha}","comments_url":"https://api.github.com/repos/spotify/helios/comments{/number}","issue_comment_url":"https://api.github.com/repos/spotify/helios/issues/comments{/number}","contents_url":"https://api.github.com/repos/spotify/helios/contents/{+path}","compare_url":"https://api.github.com/repos/spotify/helios/compare/{base}...{head}","merges_url":"https://api.github.com/repos/spotify/helios/merges","archive_url":"https://api.github.com/repos/spotify/helios/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/spotify/helios/downloads","issues_url":"https://api.github.com/repos/spotify/helios/issues{/number}","pulls_url":"https://api.github.com/repos/spotify/helios/pulls{/number}","milestones_url":"https://api.github.com/repos/spotify/helios/milestones{/number}","notifications_url":"https://api.github.com/repos/spotify/helios/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/spotify/helios/labels{/name}","releases_url":"https://api.github.com/repos/spotify/helios/releases{/id}","deployments_url":"https://api.github.com/repos/spotify/helios/deployments","created_at":"2014-05-26T02:29:06Z","updated_at":"2025-11-06T20:38:30Z","pushed_at":"2024-09-12T12:43:28Z","git_url":"git://github.com/spotify/helios.git","ssh_url":"git@github.com:spotify/helios.git","clone_url":"https://github.com/spotify/helios.git","svn_url":"https://github.com/spotify/helios","homepage":null,"size":7755,"stargazers_count":2152,"watchers_count":2152,"language":"Java","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":233,"mirror_url":null,"archived":true,"disabled":false,"open_issues_count":17,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["container","docker","helios","java","orchestration"],"visibility":"public","forks":233,"open_issues":17,"watchers":2152,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"The logic in Job.Builder that creates the \"hash\" component of the JobId [does the following](https://github.com/spotify/helios/blob/29106a7e5f290a37152ef0e28b21758ed5d0848f/helios-client/src/main/java/com/spotify/helios/common/Json.java#L344-L352):\r\n\r\n- serialize the non-metadata parameters of the Job into a JSON string\r\n- deserialize this string back into a Map<String, Object>\r\n- serialize this Map into JSON bytes using `objectWriter.writeValueAsBytes()`. The objectWriter instance has been configured with `setSerializationInclusion(JsonInclude.Include.NON_EMPTY)`.\r\n\r\nWhen the Create Job API method is called, the helios-master re-calculates the hash for the submitted Job on the server-side and verifies that it is equal to the hash submitted by the client. If the two values do not match, a CreateJobResponse is sent back with a status of `INVALID_JOB_DEFINITION` and an errors list containing `Id hash mismatch: hash1 != hash2`.\r\n\r\nThe same logic is performed by helios-master when run standalone and also when run inside of helios-solo (as a docker image) in integration tests via helios-testing.\r\n\r\nA Job or TemporaryJob (with helios-testing) with a `registration` section like\r\n\r\n```java\r\ntemporaryJobs.job()\r\n  .port(\"http\", 8080)\r\n  .registration(\"foobar\", \"tcp\", \"http\")\r\n```\r\n\r\nis represented in JSON like `\"registration\": {\"foobar/tcp\":{\"ports\":{\"http\":{}}}}`.\r\n\r\nWith Jackson 2.8.x, which is currently used in helios (-client, -master, -testing, -solo), this portion of the JSON is preserved in each step of the JobId hash calculation mentioned below.\r\n\r\nWith Jackson 2.9.x, the last step of the JobID hash calculation (where the Map is serialized into JSON bytes) omits the entire `\"registration\"` field, likely because it determines that the inner object of `{\"http\":{}}` is empty, which then (theoretically) propagates outward. See https://github.com/FasterXML/jackson-databind/issues/1444 and https://github.com/FasterXML/jackson-databind/issues/1736.\r\n\r\nSince the JobID hash calculation relies on Jackson when calculating the hash, and creating a Job requires the client and the server to calcualte the same JobID hash, there is a need for both the client and the server to both be using a Jackson version <= 2.8.x or both be using >= 2.9.x. The same applies for tests that use helios-testing/TemporaryJobs (the client) and helios-solo (the server).\r\n\r\nIf a helios-testing user upgrades their Maven project to use Jackson 2.9.x, then their tests that attempt to deploy TemporaryJobs will fail with \r\n\r\n> CreateJobResponse{status=INVALID_JOB_DEFINITION, errors=[Id hash mismatch: ... ]\r\n\r\nbecause the helios-master inside the helios-solo docker image is using Jackson 2.8.8.\r\n\r\nIf we upgrade helios to use Jackson 2.9.x, then any users with existing helios-testing tests where the project uses Jackson version <= 2.8.x will download `spotify/helios-solo:latest` the next time they run their tests and begin to get `CreateJobResponse{status=INVALID_JOB_DEFINITION...}` since the `latest` docker image is pulled on each run. Additionally, when a helios-master is deployed using Jackson 2.9.x, any existing helios-cli users of previous versions (which Jackson 2.8.x bundled inside) will be submitting Jobs with an ID hash that the server calculates a different value for.\r\n\r\nArguably the Jackson behavior in 2.8.x with this type of JSON and `setSerializationInclusion(JsonInclude.Include.NON_EMPTY)` (changed in https://github.com/FasterXML/jackson-databind/issues/1444) was incorrect all along, but Helios's insistence that the client and the server calculate the same hash (while using third party libraries which could change serialization behavior with any version upgrade) has created a situation where we need a helios-testing user to be aware and locked into the Jackson version used in the master branch of Helios, and where we need helios-cli/helios-client users to be using a version of Jackson that behaves the same way as the version used inside helios-master.\r\n\r\nI'm not fully sure yet but https://github.com/FasterXML/jackson-databind/issues/1444 makes it sound like it might be possible to use `setDefaultPropertyInclusion()` (introduced in 2.9.x I think?) to get the same serialization behavior with these empty objects as we had in 2.8.x.\r\n\r\nThe larger issue here is that the JobId hash - which is of dubious value - relies on a third-party library for which a different version is frequently used in projects that use helios-testing.\r\n","reactions":{"url":"https://api.github.com/repos/spotify/helios/issues/1143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/spotify/helios/issues/1143/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"actor":{"login":"akhomchenko","id":1894766,"node_id":"MDQ6VXNlcjE4OTQ3NjY=","avatar_url":"https://avatars.githubusercontent.com/u/1894766?v=4","gravatar_id":"","url":"https://api.github.com/users/akhomchenko","html_url":"https://github.com/akhomchenko","followers_url":"https://api.github.com/users/akhomchenko/followers","following_url":"https://api.github.com/users/akhomchenko/following{/other_user}","gists_url":"https://api.github.com/users/akhomchenko/gists{/gist_id}","starred_url":"https://api.github.com/users/akhomchenko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akhomchenko/subscriptions","organizations_url":"https://api.github.com/users/akhomchenko/orgs","repos_url":"https://api.github.com/users/akhomchenko/repos","events_url":"https://api.github.com/users/akhomchenko/events{/privacy}","received_events_url":"https://api.github.com/users/akhomchenko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-13T09:22:54Z","updated_at":"2020-01-13T09:22:54Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2592","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2592/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2592/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2592/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/2592","id":548801373,"node_id":"MDU6SXNzdWU1NDg4MDEzNzM=","number":2592,"title":"`ObjectMapper.setSerializationInclusion()` is ignored for `JsonAnyGetter`","user":{"login":"akhomchenko","id":1894766,"node_id":"MDQ6VXNlcjE4OTQ3NjY=","avatar_url":"https://avatars.githubusercontent.com/u/1894766?v=4","gravatar_id":"","url":"https://api.github.com/users/akhomchenko","html_url":"https://github.com/akhomchenko","followers_url":"https://api.github.com/users/akhomchenko/followers","following_url":"https://api.github.com/users/akhomchenko/following{/other_user}","gists_url":"https://api.github.com/users/akhomchenko/gists{/gist_id}","starred_url":"https://api.github.com/users/akhomchenko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akhomchenko/subscriptions","organizations_url":"https://api.github.com/users/akhomchenko/orgs","repos_url":"https://api.github.com/users/akhomchenko/repos","events_url":"https://api.github.com/users/akhomchenko/events{/privacy}","received_events_url":"https://api.github.com/users/akhomchenko/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/103","html_url":"https://github.com/FasterXML/jackson-databind/milestone/103","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/103/labels","id":4723280,"node_id":"MDk6TWlsZXN0b25lNDcyMzI4MA==","number":103,"title":"2.11.0","description":"Release notes: https://github.com/FasterXML/jackson/wiki/Jackson-Release-2.11","creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":33,"state":"closed","created_at":"2019-10-05T02:59:55Z","updated_at":"2021-03-04T04:19:59Z","due_on":"2020-04-26T07:00:00Z","closed_at":"2021-03-04T04:19:59Z"},"comments":1,"created_at":"2020-01-13T09:22:54Z","updated_at":"2020-04-12T18:38:56Z","closed_at":"2020-02-05T06:41:11Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":3038937,"node_id":"MDEwOlJlcG9zaXRvcnkzMDM4OTM3","name":"jackson-databind","full_name":"FasterXML/jackson-databind","private":false,"owner":{"login":"FasterXML","id":382692,"node_id":"MDEyOk9yZ2FuaXphdGlvbjM4MjY5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/382692?v=4","gravatar_id":"","url":"https://api.github.com/users/FasterXML","html_url":"https://github.com/FasterXML","followers_url":"https://api.github.com/users/FasterXML/followers","following_url":"https://api.github.com/users/FasterXML/following{/other_user}","gists_url":"https://api.github.com/users/FasterXML/gists{/gist_id}","starred_url":"https://api.github.com/users/FasterXML/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FasterXML/subscriptions","organizations_url":"https://api.github.com/users/FasterXML/orgs","repos_url":"https://api.github.com/users/FasterXML/repos","events_url":"https://api.github.com/users/FasterXML/events{/privacy}","received_events_url":"https://api.github.com/users/FasterXML/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/FasterXML/jackson-databind","description":"General data-binding package for Jackson (2.x): works on streaming API (core) implementation(s)","fork":false,"url":"https://api.github.com/repos/FasterXML/jackson-databind","forks_url":"https://api.github.com/repos/FasterXML/jackson-databind/forks","keys_url":"https://api.github.com/repos/FasterXML/jackson-databind/keys{/key_id}","collaborators_url":"https://api.github.com/repos/FasterXML/jackson-databind/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/FasterXML/jackson-databind/teams","hooks_url":"https://api.github.com/repos/FasterXML/jackson-databind/hooks","issue_events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events{/number}","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/events","assignees_url":"https://api.github.com/repos/FasterXML/jackson-databind/assignees{/user}","branches_url":"https://api.github.com/repos/FasterXML/jackson-databind/branches{/branch}","tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/tags","blobs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/refs{/sha}","trees_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/trees{/sha}","statuses_url":"https://api.github.com/repos/FasterXML/jackson-databind/statuses/{sha}","languages_url":"https://api.github.com/repos/FasterXML/jackson-databind/languages","stargazers_url":"https://api.github.com/repos/FasterXML/jackson-databind/stargazers","contributors_url":"https://api.github.com/repos/FasterXML/jackson-databind/contributors","subscribers_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscribers","subscription_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscription","commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits{/sha}","git_commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/commits{/sha}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/comments{/number}","issue_comment_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments{/number}","contents_url":"https://api.github.com/repos/FasterXML/jackson-databind/contents/{+path}","compare_url":"https://api.github.com/repos/FasterXML/jackson-databind/compare/{base}...{head}","merges_url":"https://api.github.com/repos/FasterXML/jackson-databind/merges","archive_url":"https://api.github.com/repos/FasterXML/jackson-databind/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/FasterXML/jackson-databind/downloads","issues_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues{/number}","pulls_url":"https://api.github.com/repos/FasterXML/jackson-databind/pulls{/number}","milestones_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones{/number}","notifications_url":"https://api.github.com/repos/FasterXML/jackson-databind/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/labels{/name}","releases_url":"https://api.github.com/repos/FasterXML/jackson-databind/releases{/id}","deployments_url":"https://api.github.com/repos/FasterXML/jackson-databind/deployments","created_at":"2011-12-23T07:17:41Z","updated_at":"2025-11-08T13:34:42Z","pushed_at":"2025-11-07T22:16:42Z","git_url":"git://github.com/FasterXML/jackson-databind.git","ssh_url":"git@github.com:FasterXML/jackson-databind.git","clone_url":"https://github.com/FasterXML/jackson-databind.git","svn_url":"https://github.com/FasterXML/jackson-databind","homepage":"","size":83232,"stargazers_count":3644,"watchers_count":3644,"language":"Java","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":1446,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":382,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","jackson","jackson-databind","json"],"visibility":"public","forks":1446,"open_issues":382,"watchers":3644,"default_branch":"3.x","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"First of all: thank you a lot for an awesome library and tremendous work.\r\n\r\n### Description\r\n\r\nI faced an issue while working with log4j2 JSON layout which uses Jackson. log4j2 JSON layout uses `JsonAnyGetter` to output context map. While `.setSerializationInclusion(JsonInclude.Include.NON_EMPTY)` is set on the `ObjectMapper` of log4j2 JSON layout, null and empty values of map are still present in output.\r\n\r\nThis issue might be reproduced with plain Jackson:\r\n\r\n```java\r\nimport com.fasterxml.jackson.annotation.JsonAnyGetter;\r\nimport com.fasterxml.jackson.annotation.JsonInclude;\r\nimport com.fasterxml.jackson.annotation.JsonProperty;\r\nimport com.fasterxml.jackson.databind.ObjectMapper;\r\n\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic class Main {\r\n    private static class Sample {\r\n        private static final Map<String, String> attributes = new HashMap<>();\r\n\r\n        static {\r\n            attributes.put(\"name\", \"John\");\r\n            attributes.put(\"empty\", \"\");\r\n            attributes.put(\"null\", null);\r\n        }\r\n\r\n        @JsonProperty(\"map\")\r\n        public Map<String, String> getMap() {\r\n            return attributes;\r\n        }\r\n\r\n        @JsonAnyGetter\r\n        public Map<String, String> getUnwrappedMap() {\r\n            return attributes;\r\n        }\r\n    }\r\n\r\n    public static void main(String[] args) throws Exception {\r\n        ObjectMapper mapper = new ObjectMapper()\r\n                .setSerializationInclusion(JsonInclude.Include.NON_EMPTY);\r\n\r\n        System.out.println(mapper.writeValueAsString(new Sample()));\r\n    }\r\n}\r\n```\r\n\r\nOn versions prior to `2.9.0` (my assumption - because of #1444) output is (I have tested on `2.5.0` and `2.8.11`):\r\n\r\n```json\r\n{\"map\":{\"null\":null,\"name\":\"John\",\"empty\":\"\"},\"null\":null,\"name\":\"John\",\"empty\":\"\"}\r\n```\r\n\r\n`2.9.0+` (I have tested on both `2.9.0` and `2.10.2`):\r\n```\r\n{\"map\":{\"name\":\"John\"},\"null\":null,\"name\":\"John\",\"empty\":\"\"}\r\n```\r\n\r\n### Question\r\n\r\nShould this be considered a bug? If it is a bug which version should fix go? Should fix have backward-compatibility flag? Will you accept PR? I can try to prepare one.\r\n\r\nThanks.\r\n\r\nP.S. might be related to #2289.","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2592/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2592/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]