[{"id":2375918654,"node_id":"MDEyOkxhYmVsZWRFdmVudDIzNzU5MTg2NTQ=","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2375918654","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-05-29T17:39:13Z","label":{"name":"2.10","color":"006b75"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/497037893","html_url":"https://github.com/FasterXML/jackson-databind/issues/2336#issuecomment-497037893","issue_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2336","id":497037893,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzAzNzg5Mw==","user":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T17:41:20Z","updated_at":"2019-05-29T17:41:20Z","body":"Thank you for reporting this. I hope to look into this in near future, but there's bit of backlog of items so apologies in advance for this probably taking a while.\r\n\r\nOne note on abstract type deserializer: that may be ok as such deserializer should be passed a `TypeDeserializer` to extract necessary type id, and locate actual subtype deserializer.\r\nBut handling of that call sequence is sometimes non-obvious wrt which specific deserializer it is to be called on. And it is also true that since merging is relatively new feature there may be some rough edges regarding coordination of things.\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/497037893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/497274253","html_url":"https://github.com/FasterXML/jackson-databind/issues/2336#issuecomment-497274253","issue_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2336","id":497274253,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzI3NDI1Mw==","user":{"login":"rgreig","id":1486435,"node_id":"MDQ6VXNlcjE0ODY0MzU=","avatar_url":"https://avatars.githubusercontent.com/u/1486435?v=4","gravatar_id":"","url":"https://api.github.com/users/rgreig","html_url":"https://github.com/rgreig","followers_url":"https://api.github.com/users/rgreig/followers","following_url":"https://api.github.com/users/rgreig/following{/other_user}","gists_url":"https://api.github.com/users/rgreig/gists{/gist_id}","starred_url":"https://api.github.com/users/rgreig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rgreig/subscriptions","organizations_url":"https://api.github.com/users/rgreig/orgs","repos_url":"https://api.github.com/users/rgreig/repos","events_url":"https://api.github.com/users/rgreig/events{/privacy}","received_events_url":"https://api.github.com/users/rgreig/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T09:53:38Z","updated_at":"2019-05-30T09:53:38Z","body":"Thank you for a quick reply.\r\n\r\nI started looking at this in the case of a polymorphic type not in a map and found this in the code (which I think was your comment):\r\n\r\n```java\r\n // 20-Oct-2016, tatu: Also tricky -- for now, report an error\r\n        if (_valueTypeDeserializer != null) {\r\n            ctxt.reportBadDefinition(getType(),\r\n                    String.format(\"Cannot merge polymorphic property '%s'\",\r\n                            getName()));\r\n//            return _valueDeserializer.deserializeWithType(p, ctxt, _valueTypeDeserializer);\r\n        }\r\n```\r\nSo I am guessing there is something more structurally difficult about doing this in general with the way the deserializers are currently written?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/497274253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rgreig","id":1486435,"node_id":"MDQ6VXNlcjE0ODY0MzU=","avatar_url":"https://avatars.githubusercontent.com/u/1486435?v=4","gravatar_id":"","url":"https://api.github.com/users/rgreig","html_url":"https://github.com/rgreig","followers_url":"https://api.github.com/users/rgreig/followers","following_url":"https://api.github.com/users/rgreig/following{/other_user}","gists_url":"https://api.github.com/users/rgreig/gists{/gist_id}","starred_url":"https://api.github.com/users/rgreig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rgreig/subscriptions","organizations_url":"https://api.github.com/users/rgreig/orgs","repos_url":"https://api.github.com/users/rgreig/repos","events_url":"https://api.github.com/users/rgreig/events{/privacy}","received_events_url":"https://api.github.com/users/rgreig/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/523234181","html_url":"https://github.com/FasterXML/jackson-databind/issues/2336#issuecomment-523234181","issue_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2336","id":523234181,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzIzNDE4MQ==","user":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-20T23:29:08Z","updated_at":"2019-08-20T23:29:08Z","body":"Ok, finally found time to revisit this. So, yes, merging polymorphic values is tricky because extra polymorphic type information must be handled, and it is not clear how you would merge, say, instances of different types (new type might have properties that old instance does not have).\r\nBut even if ignoring that problem (assuming it's fine, come what may), there is the technical problem that `TypeDeserializer` would still need to at least \"unwrap\" information to get to actual properties (remove \"type id\" and wrapper array/object, if any) to pass to old instance.\r\n\r\nNow: for containers it probably would make most sense to either:\r\n\r\n1. Unwrap type id, ignore polymorphic type, pass contents to deserializer of existing value -- alas, beyond problem of unwrapping (which might be doable but difficult wrt safely changing code), we don't really have access to that old value deserializer -- in fact, instance might not even have been deserialized by jackson for all we know. But at this point it is just value, without type info\r\n2. Ignore merge for values and just do \"shallow\" merge in case of `Map`s (or more generally containers)\r\n\r\nOf these, I don't think (1) can made to work. (2) might be possible, and I think I'll try that next.\r\nIf I can solve it for `Map`, separate work would be needed for arrays, Collections; and then there's the question of whether behavior should be configurable in that user could choose to fail in this case (since deep merge is impossible, just shallow), or opt for shallow merge.\r\n\r\n\r\n\r\n\r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/523234181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2571424769,"node_id":"MDEyOkxhYmVsZWRFdmVudDI1NzE0MjQ3Njk=","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2571424769","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-08-21T00:19:42Z","label":{"name":"ACTIVE","color":"f9de7a"},"performed_via_github_app":null},{"id":2571429056,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI1NzE0MjkwNTY=","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2571429056","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"152e3fac145052d7b90d21c98953fcfc18dd34e0","commit_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits/152e3fac145052d7b90d21c98953fcfc18dd34e0","created_at":"2019-08-21T00:23:03Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/523245320","html_url":"https://github.com/FasterXML/jackson-databind/issues/2336#issuecomment-523245320","issue_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2336","id":523245320,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzI0NTMyMA==","user":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-21T00:23:23Z","updated_at":"2019-08-21T00:23:23Z","body":"Ok things look promising: test had one problem (should not have `visible = true`), but I think I can make this work after all.\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/523245320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2571637673,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDI1NzE2Mzc2NzM=","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2571637673","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2019-08-21T03:09:33Z","milestone":{"title":"2.10.0.pr2"},"performed_via_github_app":null},{"id":2571637744,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MjU3MTYzNzc0NA==","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2571637744","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2019-08-21T03:09:36Z","label":{"name":"ACTIVE","color":"f9de7a"},"performed_via_github_app":null},{"id":2571638287,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjU3MTYzODI4Nw==","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2571638287","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2019-08-21T03:10:00Z","rename":{"from":"Defect in MapDeserializer impacting JSON Merging maps containing JsonSubTypes","to":"`MapDeserializer` can not merge `Map`s with polymorphic values"},"performed_via_github_app":null},{"id":2571641450,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI1NzE2NDE0NTA=","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2571641450","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"9051c796e3bf01207896d7668f56cfe8d2c77a4a","commit_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits/9051c796e3bf01207896d7668f56cfe8d2c77a4a","created_at":"2019-08-21T03:12:44Z","performed_via_github_app":null},{"id":2571645147,"node_id":"MDExOkNsb3NlZEV2ZW50MjU3MTY0NTE0Nw==","url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events/2571645147","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"9051c796e3bf01207896d7668f56cfe8d2c77a4a","commit_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits/9051c796e3bf01207896d7668f56cfe8d2c77a4a","created_at":"2019-08-21T03:15:36Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/523278495","html_url":"https://github.com/FasterXML/jackson-databind/issues/2336#issuecomment-523278495","issue_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2336","id":523278495,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzI3ODQ5NQ==","user":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-21T03:18:45Z","updated_at":"2019-08-21T03:18:45Z","body":"So, with 2.10 things will now work (assuming `visible = true` is removed from the test: that is unrelated to polymorphic handling), in a way that merging works for `Map`s, but entries within can not be merged -- new value will be read from input and will replace old value.\r\nThis behavior can be changed by disabling `MapperFeature.IGNORE_MERGE_FOR_UNMERGEABLE` in which case it would result in exception, but with bit more information than previously.\r\n\r\nIf attempts to provide some form of risky merging for polymorphic values are still desired, a new issue should be created (with reference to this issue for back story). But I hope this improvement is still useful for at least some cases.\r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments/523278495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"matthew-altman","id":55401860,"node_id":"MDQ6VXNlcjU1NDAxODYw","avatar_url":"https://avatars.githubusercontent.com/u/55401860?v=4","gravatar_id":"","url":"https://api.github.com/users/matthew-altman","html_url":"https://github.com/matthew-altman","followers_url":"https://api.github.com/users/matthew-altman/followers","following_url":"https://api.github.com/users/matthew-altman/following{/other_user}","gists_url":"https://api.github.com/users/matthew-altman/gists{/gist_id}","starred_url":"https://api.github.com/users/matthew-altman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matthew-altman/subscriptions","organizations_url":"https://api.github.com/users/matthew-altman/orgs","repos_url":"https://api.github.com/users/matthew-altman/repos","events_url":"https://api.github.com/users/matthew-altman/events{/privacy}","received_events_url":"https://api.github.com/users/matthew-altman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T18:08:54Z","updated_at":"2019-11-13T18:08:54Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2541","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2541/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2541/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2541/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/2541","id":522387107,"node_id":"MDU6SXNzdWU1MjIzODcxMDc=","number":2541,"title":"Cannot merge polymorphic objects","user":{"login":"matthew-altman","id":55401860,"node_id":"MDQ6VXNlcjU1NDAxODYw","avatar_url":"https://avatars.githubusercontent.com/u/55401860?v=4","gravatar_id":"","url":"https://api.github.com/users/matthew-altman","html_url":"https://github.com/matthew-altman","followers_url":"https://api.github.com/users/matthew-altman/followers","following_url":"https://api.github.com/users/matthew-altman/following{/other_user}","gists_url":"https://api.github.com/users/matthew-altman/gists{/gist_id}","starred_url":"https://api.github.com/users/matthew-altman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matthew-altman/subscriptions","organizations_url":"https://api.github.com/users/matthew-altman/orgs","repos_url":"https://api.github.com/users/matthew-altman/repos","events_url":"https://api.github.com/users/matthew-altman/events{/privacy}","received_events_url":"https://api.github.com/users/matthew-altman/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":15,"created_at":"2019-11-13T18:08:54Z","updated_at":"2022-06-10T04:14:21Z","closed_at":"2022-06-10T04:14:21Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":3038937,"node_id":"MDEwOlJlcG9zaXRvcnkzMDM4OTM3","name":"jackson-databind","full_name":"FasterXML/jackson-databind","private":false,"owner":{"login":"FasterXML","id":382692,"node_id":"MDEyOk9yZ2FuaXphdGlvbjM4MjY5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/382692?v=4","gravatar_id":"","url":"https://api.github.com/users/FasterXML","html_url":"https://github.com/FasterXML","followers_url":"https://api.github.com/users/FasterXML/followers","following_url":"https://api.github.com/users/FasterXML/following{/other_user}","gists_url":"https://api.github.com/users/FasterXML/gists{/gist_id}","starred_url":"https://api.github.com/users/FasterXML/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FasterXML/subscriptions","organizations_url":"https://api.github.com/users/FasterXML/orgs","repos_url":"https://api.github.com/users/FasterXML/repos","events_url":"https://api.github.com/users/FasterXML/events{/privacy}","received_events_url":"https://api.github.com/users/FasterXML/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/FasterXML/jackson-databind","description":"General data-binding package for Jackson (2.x): works on streaming API (core) implementation(s)","fork":false,"url":"https://api.github.com/repos/FasterXML/jackson-databind","forks_url":"https://api.github.com/repos/FasterXML/jackson-databind/forks","keys_url":"https://api.github.com/repos/FasterXML/jackson-databind/keys{/key_id}","collaborators_url":"https://api.github.com/repos/FasterXML/jackson-databind/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/FasterXML/jackson-databind/teams","hooks_url":"https://api.github.com/repos/FasterXML/jackson-databind/hooks","issue_events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/events{/number}","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/events","assignees_url":"https://api.github.com/repos/FasterXML/jackson-databind/assignees{/user}","branches_url":"https://api.github.com/repos/FasterXML/jackson-databind/branches{/branch}","tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/tags","blobs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/refs{/sha}","trees_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/trees{/sha}","statuses_url":"https://api.github.com/repos/FasterXML/jackson-databind/statuses/{sha}","languages_url":"https://api.github.com/repos/FasterXML/jackson-databind/languages","stargazers_url":"https://api.github.com/repos/FasterXML/jackson-databind/stargazers","contributors_url":"https://api.github.com/repos/FasterXML/jackson-databind/contributors","subscribers_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscribers","subscription_url":"https://api.github.com/repos/FasterXML/jackson-databind/subscription","commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/commits{/sha}","git_commits_url":"https://api.github.com/repos/FasterXML/jackson-databind/git/commits{/sha}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/comments{/number}","issue_comment_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/comments{/number}","contents_url":"https://api.github.com/repos/FasterXML/jackson-databind/contents/{+path}","compare_url":"https://api.github.com/repos/FasterXML/jackson-databind/compare/{base}...{head}","merges_url":"https://api.github.com/repos/FasterXML/jackson-databind/merges","archive_url":"https://api.github.com/repos/FasterXML/jackson-databind/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/FasterXML/jackson-databind/downloads","issues_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues{/number}","pulls_url":"https://api.github.com/repos/FasterXML/jackson-databind/pulls{/number}","milestones_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones{/number}","notifications_url":"https://api.github.com/repos/FasterXML/jackson-databind/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/labels{/name}","releases_url":"https://api.github.com/repos/FasterXML/jackson-databind/releases{/id}","deployments_url":"https://api.github.com/repos/FasterXML/jackson-databind/deployments","created_at":"2011-12-23T07:17:41Z","updated_at":"2025-11-08T13:34:42Z","pushed_at":"2025-11-07T22:16:42Z","git_url":"git://github.com/FasterXML/jackson-databind.git","ssh_url":"git@github.com:FasterXML/jackson-databind.git","clone_url":"https://github.com/FasterXML/jackson-databind.git","svn_url":"https://github.com/FasterXML/jackson-databind","homepage":"","size":83232,"stargazers_count":3644,"watchers_count":3644,"language":"Java","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":1446,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":382,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","jackson","jackson-databind","json"],"visibility":"public","forks":1446,"open_issues":382,"watchers":3644,"default_branch":"3.x","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Referring to https://github.com/FasterXML/jackson-databind/issues/2336 because there was a similar issue with polymorphic maps that was addressed there, and at the end of that issue it mentions:\r\n\r\n> If attempts to provide some form of risky merging for polymorphic values are still desired, a new issue should be created (with reference to this issue for back story).\r\n\r\nWe are on version `2.10.0`\r\nI have some classes defined similarly to:\r\n```\r\npublic class MyRequest {\r\n  @JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = As.PROPERTY, property = \"type\")\r\n  @JsonSubTypes({\r\n      @Type(value = ThingyAA.class, name = \"ThingyAA\"),\r\n      @Type(value = ThingyBB.class, name = \"ThingyBB\")\r\n  })\r\n  public BaseThingy<?> thingy;\r\n\r\n  @JacksonConstructor\r\n  public MyRequest() {\r\n  }\r\n\r\n  public MyRequest(BaseThingy<?> thingy) {\r\n    this.thingy = thingy;\r\n  }\r\n}\r\n\r\n@JsonIgnoreProperties(value = \"type\", allowGetters = true, allowSetters = false)\r\npublic abstract class BaseThingy<D extends BaseThingyConfig> {\r\n  public Map<Integer, D> config = new HashMap<>();\r\n  public String name;\r\n}\r\n\r\npublic abstract class BaseThingyConfig {\r\n  public final Map<String, Object> data = new HashMap<>();\r\n}\r\n\r\npublic class ThingyAAConfig extends BaseThingyConfig {\r\n  @InternalJSONColumn\r\n  public String foo;\r\n}\r\n\r\npublic class ThingyBBConfig extends BaseThingyConfig {\r\n  @InternalJSONColumn\r\n  public String bar;\r\n}\r\n\r\npublic class ThingyAA extends BaseThingy<ThingyAAConfig> {\r\n  @InternalJSONColumn\r\n  public String stuff;\r\n}\r\n\r\npublic class ThingyBB extends BaseThingy<ThingyBBConfig> {\r\n  @InternalJSONColumn\r\n  public String otherStuff;\r\n}\r\n```\r\n\r\nThe problem we're seeing is the incoming request completely overwrites the existing object instead of merging.\r\n\r\nIf we force a merge using `@JsonMerge` then an exception is thrown:\r\n```Cannot merge polymorphic property 'thingy'```\r\n\r\nThere are a few ways we're thinking of  trying to get around this. One is to create a custom deserializer. And another is to manually merge the json via a deep node merge before passing to the reader similar to:\r\n\r\n```\r\nObjectReader jsonNodeReader = objectMapper.readerFor(JsonNode.class);\r\nJsonNode existingNode = jsonNodeReader.readValue(objectMapper.writeValueAsBytes(currentValue));\r\nJsonNode incomingNode = jsonNodeReader.readValue(request.getInputStream());\r\nJsonNode merged = merge(existingNode, incomingNode);\r\nObjectReader patchReader = objectMapper.readerForUpdating(currentValue);\r\npatchReader.readValue(merged);\r\n\r\npublic static JsonNode merge(JsonNode mainNode, JsonNode updateNode) {\r\n    Iterator<String> fieldNames = updateNode.fieldNames();\r\n\r\n    while (fieldNames.hasNext()) {\r\n      String updatedFieldName = fieldNames.next();\r\n      JsonNode valueToBeUpdated = mainNode.get(updatedFieldName);\r\n      JsonNode updatedValue = updateNode.get(updatedFieldName);\r\n\r\n      // If the node is an @ArrayNode\r\n      if (valueToBeUpdated != null && valueToBeUpdated.isArray() &&\r\n          updatedValue.isArray()) {\r\n        // running a loop for all elements of the updated ArrayNode\r\n        for (int i = 0; i < updatedValue.size(); i++) {\r\n          JsonNode updatedChildNode = updatedValue.get(i);\r\n          // Create a new Node in the node that should be updated, if there was no corresponding node in it\r\n          // Use-case - where the updateNode will have a new element in its Array\r\n          if (valueToBeUpdated.size() <= i) {\r\n            ((ArrayNode) valueToBeUpdated).add(updatedChildNode);\r\n          }\r\n          // getting reference for the node to be updated\r\n          JsonNode childNodeToBeUpdated = valueToBeUpdated.get(i);\r\n          merge(childNodeToBeUpdated, updatedChildNode);\r\n        }\r\n        // if the Node is an @ObjectNode\r\n      } else if (valueToBeUpdated != null && valueToBeUpdated.isObject()) {\r\n        merge(valueToBeUpdated, updatedValue);\r\n      } else {\r\n        if (mainNode instanceof ObjectNode) {\r\n          ((ObjectNode) mainNode).replace(updatedFieldName, updatedValue);\r\n        }\r\n      }\r\n    }\r\n    return mainNode;\r\n  }\r\n```\r\n\r\nCan some type of deep node merge occur in Jackson for this polymorphic scenario to alleviate us having to maintain this json functionality ourselves?","reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/2541/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]