{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1439","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1439/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1439/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1439/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/1439","id":186326720,"node_id":"MDU6SXNzdWUxODYzMjY3MjA=","number":1439,"title":"NPE  when using Standard serializer implementation for serializing {link java.util.Map} types","user":{"login":"thomasKlug","id":23172692,"node_id":"MDQ6VXNlcjIzMTcyNjky","avatar_url":"https://avatars.githubusercontent.com/u/23172692?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasKlug","html_url":"https://github.com/thomasKlug","followers_url":"https://api.github.com/users/thomasKlug/followers","following_url":"https://api.github.com/users/thomasKlug/following{/other_user}","gists_url":"https://api.github.com/users/thomasKlug/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasKlug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasKlug/subscriptions","organizations_url":"https://api.github.com/users/thomasKlug/orgs","repos_url":"https://api.github.com/users/thomasKlug/repos","events_url":"https://api.github.com/users/thomasKlug/events{/privacy}","received_events_url":"https://api.github.com/users/thomasKlug/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/65","html_url":"https://github.com/FasterXML/jackson-databind/milestone/65","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/65/labels","id":2048159,"node_id":"MDk6TWlsZXN0b25lMjA0ODE1OQ==","number":65,"title":"2.7.9","description":"Release notes: https://github.com/FasterXML/jackson/wiki/Jackson-Release-2.7.9","creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":11,"state":"closed","created_at":"2016-10-04T23:05:25Z","updated_at":"2021-03-04T04:29:29Z","due_on":"2017-02-04T08:00:00Z","closed_at":"2021-03-04T04:29:29Z"},"comments":2,"created_at":"2016-10-31T16:15:02Z","updated_at":"2016-11-02T04:01:46Z","closed_at":"2016-11-02T03:58:25Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Utilizing jackson-databind-2.7.5. \r\n\r\nThere seems to be an issue surrounding the _filterId when serializing a Map. The Implementation we are setting a default filter by overriding, the JacksonAnnotationIntrospector findFilterId. A default filterId is set if one is not found. That Id may or may not be found, so we set the SimpleFilterProvider().setFailOnUnknownId to false.  However in the Implementation of the MapSerializer there is an issue within the serialize method specifically \r\n\r\n```\r\nif (_filterId != null) {\r\n                serializeFilteredFields(value, gen, provider,\r\n                        findPropertyFilter(provider, _filterId, value), suppressableValue);\r\n            } else if (suppressableValue != null) {\r\n                serializeOptionalFields(value, gen, provider, suppressableValue);\r\n            } else if (_valueSerializer != null) {\r\n                serializeFieldsUsing(value, gen, provider, _valueSerializer);\r\n            } else {\r\n                serializeFields(value, gen, provider);\r\n            }\r\n\r\n```\r\n\r\nSince the above code block assumes that the filter will be found, null gets passed into serializeFilteredFields resulting in an NPE. \r\n\r\nThe above I believe could be written:\r\n\r\n```\r\nif (_filterId != null && findPropertyFilter(provider, _filterId, value) != null) {\r\n                serializeFilteredFields(value, gen, provider,\r\n                        findPropertyFilter(provider, _filterId, value), suppressableValue);\r\n            } else if (suppressableValue != null) {\r\n                serializeOptionalFields(value, gen, provider, suppressableValue);\r\n            } else if (_valueSerializer != null) {\r\n                serializeFieldsUsing(value, gen, provider, _valueSerializer);\r\n            } else {\r\n                serializeFields(value, gen, provider);\r\n            }\r\n```\r\n","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1439/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1439/timeline","performed_via_github_app":null,"state_reason":"completed"}