{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/897","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/897/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/897/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/897/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/897","id":100795610,"node_id":"MDU6SXNzdWUxMDA3OTU2MTA=","number":897,"title":"ObjectMapper.convertValue(Object,Class<T>) to the same class is not functionally equivalent to serializing and then deserializing","user":{"login":"jishi9","id":469031,"node_id":"MDQ6VXNlcjQ2OTAzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/469031?v=4","gravatar_id":"","url":"https://api.github.com/users/jishi9","html_url":"https://github.com/jishi9","followers_url":"https://api.github.com/users/jishi9/followers","following_url":"https://api.github.com/users/jishi9/following{/other_user}","gists_url":"https://api.github.com/users/jishi9/gists{/gist_id}","starred_url":"https://api.github.com/users/jishi9/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jishi9/subscriptions","organizations_url":"https://api.github.com/users/jishi9/orgs","repos_url":"https://api.github.com/users/jishi9/repos","events_url":"https://api.github.com/users/jishi9/events{/privacy}","received_events_url":"https://api.github.com/users/jishi9/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/38","html_url":"https://github.com/FasterXML/jackson-databind/milestone/38","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/38/labels","id":1256019,"node_id":"MDk6TWlsZXN0b25lMTI1NjAxOQ==","number":38,"title":"2.6.2","description":"Release notes: https://github.com/FasterXML/jackson/wiki/Jackson-Release-2.6.2","creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":4,"state":"closed","created_at":"2015-08-14T23:20:47Z","updated_at":"2021-03-04T04:26:08Z","due_on":"2015-09-15T07:00:00Z","closed_at":"2021-03-04T04:26:08Z"},"comments":2,"created_at":"2015-08-13T15:12:08Z","updated_at":"2015-08-14T23:23:48Z","closed_at":"2015-08-14T23:23:48Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"The javadoc for `ObjectMapper.convertValue(Object fromValue, Class<T> toValueType)` states:\n\n> This is functionality equivalent to first serializing given value into JSON, then binding JSON data into value of given type, but may be executed without fully serializing into JSON.\n\nHowever this is not the case when `toValueType` is of the same type as `fromValue`, which should be usable for deep copying an object. The returned object must be distinct from `fromValue`, such that mutating either of `fromValue` or the returned object does not mutate the other.\n\nThis bug occurs due to this snippet from `ObjectMapper._convert`:\n\n```\nprotected Object _convert(Object fromValue, JavaType toValueType)\n        throws IllegalArgumentException\n    {        \n        // also, as per [Issue-11], consider case for simple cast\n        /* But with caveats: one is that while everything is Object.class, we don't\n         * want to \"optimize\" that out; and the other is that we also do not want\n         * to lose conversions of generic types.\n         */\n        Class<?> targetType = toValueType.getRawClass();\n        if (targetType != Object.class\n                && !toValueType.hasGenericTypes()\n                && targetType.isAssignableFrom(fromValue.getClass())) {\n            return fromValue;  // the object should be cloned, not be returned as-is\n        }\n```\n","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/897/timeline","performed_via_github_app":null,"state_reason":"completed"}