{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4896","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4896/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4896/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4896/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/4896","id":2780357908,"node_id":"I_kwDOAC5e2c6luOUU","number":4896,"title":"Coercion shouldn't be necessary for Enums specifying an empty string","user":{"login":"joaocanaverde-blue","id":173159113,"node_id":"U_kgDOClIyyQ","avatar_url":"https://avatars.githubusercontent.com/u/173159113?v=4","gravatar_id":"","url":"https://api.github.com/users/joaocanaverde-blue","html_url":"https://github.com/joaocanaverde-blue","followers_url":"https://api.github.com/users/joaocanaverde-blue/followers","following_url":"https://api.github.com/users/joaocanaverde-blue/following{/other_user}","gists_url":"https://api.github.com/users/joaocanaverde-blue/gists{/gist_id}","starred_url":"https://api.github.com/users/joaocanaverde-blue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joaocanaverde-blue/subscriptions","organizations_url":"https://api.github.com/users/joaocanaverde-blue/orgs","repos_url":"https://api.github.com/users/joaocanaverde-blue/repos","events_url":"https://api.github.com/users/joaocanaverde-blue/events{/privacy}","received_events_url":"https://api.github.com/users/joaocanaverde-blue/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":7098892157,"node_id":"LA_kwDOAC5e2c8AAAABpyB_fQ","url":"https://api.github.com/repos/FasterXML/jackson-databind/labels/2.19","name":"2.19","color":"1D76DB","default":false,"description":"Issues planned at 2.19 or later"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/170","html_url":"https://github.com/FasterXML/jackson-databind/milestone/170","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/170/labels","id":11662847,"node_id":"MI_kwDOAC5e2c4AsfX_","number":170,"title":"2.19.0","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":26,"state":"closed","created_at":"2024-10-02T01:26:15Z","updated_at":"2025-10-30T23:29:09Z","due_on":null,"closed_at":"2025-10-30T23:29:09Z"},"comments":5,"created_at":"2025-01-10T14:46:55Z","updated_at":"2025-01-26T02:15:22Z","closed_at":"2025-01-25T05:49:34Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Search before asking\r\n\r\n- [X] I searched in the [issues](https://github.com/FasterXML/jackson-databind/issues) and found nothing similar.\r\n\r\n### Describe the bug\r\n\r\nTrying to deserialise:\r\n\r\n```json\r\n{ \"example\": \"\" }\r\n```\r\n\r\nResults in:\r\n\r\n```\r\nCannot coerce empty String (\"\") to `YesOrNoOrEmpty` value (but could if coercion was enabled using `CoercionConfig`)\r\n``` \r\n\r\nDespite an empty string (`\"\"`) being listed as a value in the enum.\r\n\r\n```kotlin\r\nenum class YesOrNoOrEmpty(val value: kotlin.String) {\r\n    @JsonProperty(value = \"\")\r\n    EMPTY(\"\"),\r\n\r\n    @JsonProperty(value = \"yes\")\r\n    YES(\"yes\"),\r\n\r\n    @JsonProperty(value = \"no\")\r\n    NO(\"no\");\r\n}\r\n````\r\n\r\nI'm trying to deserialise historical values, so this is a value I have to support. Ideally I'd still like to deserialise to an enum rather than just into a string, and would like to avoid coercion if possible.\r\n\r\nGiven that I'm specifying the empty string explicitly with `@JsonProperty(value = \"\")`, I'm assuming encountering this exception is a bug rather than intended behaviour?\r\n\r\n### Version Information\r\n\r\n2.18.2\r\n\r\n### Reproduction\r\n\r\nRead:\r\n\r\n```json\r\n{ \"example\": \"\" }\r\n```\r\n\r\ninto an `Example` object like:\r\n\r\n```koltin\r\ndata class Example(\r\n    val example: YesOrNo\r\n)\r\n\r\nenum class YesOrNo(val value: kotlin.String) {\r\n    @JsonProperty(value = \"\")\r\n    EMPTY(\"\"),\r\n\r\n    @JsonProperty(value = \"yes\")\r\n    YES(\"yes\"),\r\n\r\n    @JsonProperty(value = \"no\")\r\n    NO(\"no\");\r\n}\r\n```\r\n\r\n### Expected behavior\r\n\r\nDeserialisation works.\r\n\r\n### Additional context\r\n\r\nA workaround does exist (as the exception message suggests):\r\n\r\n\r\n```kotlin\r\nimport com.fasterxml.jackson.databind.cfg.CoercionAction\r\nimport com.fasterxml.jackson.databind.cfg.CoercionInputShape\r\nimport com.fasterxml.jackson.databind.type.LogicalType\r\nimport org.springframework.boot.autoconfigure.jackson.Jackson2ObjectMapperBuilderCustomizer\r\nimport org.springframework.context.annotation.Bean\r\nimport org.springframework.context.annotation.Configuration\r\nimport org.springframework.http.converter.json.Jackson2ObjectMapperBuilder\r\n\r\n@Configuration\r\nclass JacksonConfig {\r\n    @Bean\r\n    fun jsonCustomizer(): Jackson2ObjectMapperBuilderCustomizer {\r\n        return Jackson2ObjectMapperBuilderCustomizer { builder: Jackson2ObjectMapperBuilder ->\r\n            builder.postConfigurer { objectMapper ->\r\n                objectMapper.coercionConfigFor(LogicalType.Enum)\r\n                    .setCoercion(CoercionInputShape.EmptyString, CoercionAction.TryConvert)\r\n            }\r\n\r\n        }\r\n    }\r\n}\r\n```","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4896/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4896/timeline","performed_via_github_app":null,"state_reason":"completed"}