{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/738","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/738/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/738/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/738/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/738","id":64822276,"node_id":"MDU6SXNzdWU2NDgyMjI3Ng==","number":738,"title":"@JsonTypeInfo non-deterministically ignored in 2.5.1","user":{"login":"dylanscott","id":491393,"node_id":"MDQ6VXNlcjQ5MTM5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/491393?v=4","gravatar_id":"","url":"https://api.github.com/users/dylanscott","html_url":"https://github.com/dylanscott","followers_url":"https://api.github.com/users/dylanscott/followers","following_url":"https://api.github.com/users/dylanscott/following{/other_user}","gists_url":"https://api.github.com/users/dylanscott/gists{/gist_id}","starred_url":"https://api.github.com/users/dylanscott/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dylanscott/subscriptions","organizations_url":"https://api.github.com/users/dylanscott/orgs","repos_url":"https://api.github.com/users/dylanscott/repos","events_url":"https://api.github.com/users/dylanscott/events{/privacy}","received_events_url":"https://api.github.com/users/dylanscott/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/28","html_url":"https://github.com/FasterXML/jackson-databind/milestone/28","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/28/labels","id":970086,"node_id":"MDk6TWlsZXN0b25lOTcwMDg2","number":28,"title":"2.5.2","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":7,"state":"closed","created_at":"2015-02-07T20:52:45Z","updated_at":"2021-03-04T04:03:31Z","due_on":null,"closed_at":"2021-03-04T04:03:31Z"},"comments":9,"created_at":"2015-03-27T18:22:11Z","updated_at":"2015-06-04T08:14:42Z","closed_at":"2015-03-28T00:23:44Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"We're observing what appears to be a race condition in Jackson 2.5.1, where a particular use of `@JsonTypeInfo` will non-deterministically get ignored when writing JSON. I have a [small test case](https://github.com/dylanscott/jackson-race) which for me reproduces the issue 30-50% of the time. We're copying the structure of a type in our application, which looks like the following:\n\n```\n          HasSubTypes (interface)\n               |\n       AbstractHasSubTypes (uses @JsonTypeInfo and @JsonSubTypes, serializing as wrapper object)\n       /       |         \\\nTypeOne     TypeTwo     TypeThree\n```\n\nWe mixin `AbstractHasSubTypes`' annotations with `HasSubTypes`, and then serialize a `Wrapper` object which has a single field of type `HasSubTypes`. There appears to be a race condition when serializing these wrapper objects in parallel, where some percentage of the time the `@JsonTypeInfo` information is completely ignored and we don't serialize any type information. The linked test case should hopefully make this clearer, it's pretty small. This issue does not appear to affect 2.4.3.\n","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/738/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/738/timeline","performed_via_github_app":null,"state_reason":"completed"}