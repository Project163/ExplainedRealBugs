{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1655","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1655/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1655/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1655/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/1655","id":235360177,"node_id":"MDU6SXNzdWUyMzUzNjAxNzc=","number":1655,"title":"`@JsonAnyGetter` uses different `bean` parameter in `SimpleBeanPropertyFilter`","user":{"login":"georgeflug","id":13152990,"node_id":"MDQ6VXNlcjEzMTUyOTkw","avatar_url":"https://avatars.githubusercontent.com/u/13152990?v=4","gravatar_id":"","url":"https://api.github.com/users/georgeflug","html_url":"https://github.com/georgeflug","followers_url":"https://api.github.com/users/georgeflug/followers","following_url":"https://api.github.com/users/georgeflug/following{/other_user}","gists_url":"https://api.github.com/users/georgeflug/gists{/gist_id}","starred_url":"https://api.github.com/users/georgeflug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/georgeflug/subscriptions","organizations_url":"https://api.github.com/users/georgeflug/orgs","repos_url":"https://api.github.com/users/georgeflug/repos","events_url":"https://api.github.com/users/georgeflug/events{/privacy}","received_events_url":"https://api.github.com/users/georgeflug/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/75","html_url":"https://github.com/FasterXML/jackson-databind/milestone/75","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/75/labels","id":2487377,"node_id":"MDk6TWlsZXN0b25lMjQ4NzM3Nw==","number":75,"title":"2.9.0.pr4","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":10,"state":"closed","created_at":"2017-04-28T03:32:01Z","updated_at":"2021-03-04T04:04:33Z","due_on":null,"closed_at":"2021-03-04T04:04:33Z"},"comments":3,"created_at":"2017-06-12T20:46:01Z","updated_at":"2017-06-13T05:11:08Z","closed_at":"2017-06-13T05:09:15Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Tried this out on 2.8.5, 2.8.8 and 2.9.0pr3\r\n\r\nWhen extending SimpleBeanPropertyFilter to make a custom filter, the first parameter \"Object pojo\" of serializeAsField() contains the parent Object of the field in question.\r\n\r\nHowever, when the field is a dynamic field using the @JsonAnyGetter annotation, the pojo parameter contains the field value itself instead of its parent object.\r\n\r\nI expected the pojo parameter to contain the same value regardless of whether the field is explicit or dynamic.\r\n\r\nAs a result, I am not able to filter fields based on the parent object. I can only use the field's name which is not enough information.\r\n\r\nHere's an example:\r\n```\r\npublic class Main {\r\n\tpublic static void main(String[] args) throws Exception {\r\n\t\tObjectMapper mapper = new ObjectMapper();\r\n\t\tFilterProvider filters = new SimpleFilterProvider().addFilter(\"CustomFilter\", new CustomFilter());\r\n\t\tString serialized = mapper.writer(filters).writeValueAsString(new OuterObject());\r\n\t\tSystem.out.println(serialized);\r\n\t}\r\n}\r\n\r\n@JsonFilter(\"CustomFilter\")\r\nclass OuterObject {\r\n\tpublic String getExplicitProperty() {\r\n\t\treturn \"I will serialize\";\r\n\t}\r\n\r\n\t@JsonAnyGetter\r\n\tpublic Map<String, Object> getAny() {\r\n\t\tMap<String, Object> extra = new HashMap<>();\r\n\t\textra.put(\"dynamicProperty\", \"I will not serialize\");\r\n\t\treturn extra;\r\n\t}\r\n}\r\n\r\nclass CustomFilter extends SimpleBeanPropertyFilter {\r\n\tprivate static final boolean serializeAllFields = false;\r\n\t@Override\r\n\tpublic void serializeAsField (Object pojo, JsonGenerator jgen, SerializerProvider provider, PropertyWriter writer) throws Exception {\r\n\t\tif (serializeAllFields || pojo instanceof OuterObject) {\r\n\t\t\twriter.serializeAsField(pojo, jgen, provider);\r\n\t\t}\r\n\t}\r\n}\r\n```\r\nIn the example, \"dynamicProperty\" will not serialize unless I set serializeAllFields to True because pojo equals \"I will not serialize\" instead of the OuterObject instance.\r\n","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/1655/timeline","performed_via_github_app":null,"state_reason":"completed"}