{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4620","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4620/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4620/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4620/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/4620","id":2407254719,"node_id":"I_kwDOAC5e2c6Pe8q_","number":4620,"title":"When there are multiple creators with `JsonProperty`, `InvalidDefinitionException` is raised ignoring the result of `findDefaultCreator` processing","user":{"login":"k163377","id":24751011,"node_id":"MDQ6VXNlcjI0NzUxMDEx","avatar_url":"https://avatars.githubusercontent.com/u/24751011?v=4","gravatar_id":"","url":"https://api.github.com/users/k163377","html_url":"https://github.com/k163377","followers_url":"https://api.github.com/users/k163377/followers","following_url":"https://api.github.com/users/k163377/following{/other_user}","gists_url":"https://api.github.com/users/k163377/gists{/gist_id}","starred_url":"https://api.github.com/users/k163377/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k163377/subscriptions","organizations_url":"https://api.github.com/users/k163377/orgs","repos_url":"https://api.github.com/users/k163377/repos","events_url":"https://api.github.com/users/k163377/events{/privacy}","received_events_url":"https://api.github.com/users/k163377/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":6636564281,"node_id":"LA_kwDOAC5e2c8AAAABi5HvOQ","url":"https://api.github.com/repos/FasterXML/jackson-databind/labels/2.18","name":"2.18","color":"1D76DB","default":false,"description":"Issues planned at 2.18 or later"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2024-07-14T03:59:33Z","updated_at":"2024-07-17T03:54:17Z","closed_at":"2024-07-17T03:47:49Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Search before asking\n\n- [X] I searched in the [issues](https://github.com/FasterXML/jackson-databind/issues) and found nothing similar.\n\n### Describe the bug\n\nIt seems that if there are multiple creators with `JsonProperty`, an `InvalidDefinitionException` is raised ignoring the result of the `AnnotationIntrospector` process.\r\n\r\n```\r\ncom.fasterxml.jackson.databind.exc.InvalidDefinitionException: Conflicting property-based creators: already had implicit creator [constructor for `com.fasterxml.jackson.module.kotlin.test.github.Foo` (1 arg), annotations: [null], encountered another: [constructor for `com.fasterxml.jackson.module.kotlin.test.github.Foo` (2 args), annotations: [null]\r\n at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 1]\r\n```\r\n\r\nThis is confirmed by the following test failure.\r\nhttps://github.com/k163377/jackson-module-kotlin/blob/4d84c9b9d6b64f97063364135ba5d75fe541bd18/src/test/kotlin/com/fasterxml/jackson/module/kotlin/test/github/Github155.kt#L8\r\n\r\nThis is caused by the following deserialization of `DTO`.\r\nWhen the `JsonProperty` is removed, this problem is suppressed.\r\n\r\n```kotlin\r\ndata class Foo @JvmOverloads constructor(\r\n    @JsonProperty(\"name\") val name: String,\r\n    @JsonProperty(\"age\") val age: Int = 0,\r\n    @JsonProperty(\"country\") val country: String = \"whatever\",\r\n    @JsonProperty(\"city\") val city: String = \"nada\")\r\n```\r\n\r\nThe result of decompiling this `DTO` is as follows (only the constructor is excerpted)\r\n\r\n```java\r\npublic final class Foo {\r\n   @JvmOverloads\r\n   public Foo(@JsonProperty(\"name\") @NotNull String name, @JsonProperty(\"age\") int age, @JsonProperty(\"country\") @NotNull String country, @JsonProperty(\"city\") @NotNull String city) {\r\n      Intrinsics.checkNotNullParameter(name, \"name\");\r\n      Intrinsics.checkNotNullParameter(country, \"country\");\r\n      Intrinsics.checkNotNullParameter(city, \"city\");\r\n      super();\r\n      this.name = name;\r\n      this.age = age;\r\n      this.country = country;\r\n      this.city = city;\r\n   }\r\n\r\n   // $FF: synthetic method\r\n   public Foo(String var1, int var2, String var3, String var4, int var5, DefaultConstructorMarker var6) {\r\n      if ((var5 & 2) != 0) { var2 = 0; }\r\n      if ((var5 & 4) != 0) { var3 = \"whatever\"; }\r\n      if ((var5 & 8) != 0) { var4 = \"nada\"; }\r\n      this(var1, var2, var3, var4);\r\n   }\r\n\r\n   @JvmOverloads\r\n   public Foo(@JsonProperty(\"name\") @NotNull String name, @JsonProperty(\"age\") int age, @JsonProperty(\"country\") @NotNull String country) {\r\n      Intrinsics.checkNotNullParameter(name, \"name\");\r\n      Intrinsics.checkNotNullParameter(country, \"country\");\r\n      this(name, age, country, (String)null, 8, (DefaultConstructorMarker)null);\r\n   }\r\n\r\n   @JvmOverloads\r\n   public Foo(@JsonProperty(\"name\") @NotNull String name, @JsonProperty(\"age\") int age) {\r\n      Intrinsics.checkNotNullParameter(name, \"name\");\r\n      this(name, age, (String)null, (String)null, 12, (DefaultConstructorMarker)null);\r\n   }\r\n\r\n   @JvmOverloads\r\n   public Foo(@JsonProperty(\"name\") @NotNull String name) {\r\n      Intrinsics.checkNotNullParameter(name, \"name\");\r\n      this(name, 0, (String)null, (String)null, 14, (DefaultConstructorMarker)null);\r\n   }\r\n}\r\n```\n\n### Version Information\n\n2.18\n\n### Reproduction\n\nhttps://github.com/FasterXML/jackson-module-kotlin/actions/runs/9925152503/job/27417235209?pr=818\n\n### Expected behavior\n\nNo error occurs and the result of the `findDefaultCreator` process is used correctly.\n\n### Additional context\n\nThis problem was found during the process of applying `findDefaultCreator` to `kotlin-module`.","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4620/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/4620/timeline","performed_via_github_app":null,"state_reason":"completed"}