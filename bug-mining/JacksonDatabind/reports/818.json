{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/5271","repository_url":"https://api.github.com/repos/FasterXML/jackson-databind","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/5271/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/5271/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/5271/events","html_url":"https://github.com/FasterXML/jackson-databind/issues/5271","id":3345997133,"node_id":"I_kwDOAC5e2c7Hb91N","number":5271,"title":"`EnumDeserializer` fails to deserialize Enums with `@JsonValue` - uses table with name() key instead of `@JsonValue` key","user":{"login":"mikereiche","id":48999328,"node_id":"MDQ6VXNlcjQ4OTk5MzI4","avatar_url":"https://avatars.githubusercontent.com/u/48999328?v=4","gravatar_id":"","url":"https://api.github.com/users/mikereiche","html_url":"https://github.com/mikereiche","followers_url":"https://api.github.com/users/mikereiche/followers","following_url":"https://api.github.com/users/mikereiche/following{/other_user}","gists_url":"https://api.github.com/users/mikereiche/gists{/gist_id}","starred_url":"https://api.github.com/users/mikereiche/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikereiche/subscriptions","organizations_url":"https://api.github.com/users/mikereiche/orgs","repos_url":"https://api.github.com/users/mikereiche/repos","events_url":"https://api.github.com/users/mikereiche/events{/privacy}","received_events_url":"https://api.github.com/users/mikereiche/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2457821256,"node_id":"MDU6TGFiZWwyNDU3ODIxMjU2","url":"https://api.github.com/repos/FasterXML/jackson-databind/labels/has-failing-test","name":"has-failing-test","color":"4e8a16","default":false,"description":"Indicates that there exists a test case (under `failing/`) to reproduce the issue"},{"id":3895061927,"node_id":"LA_kwDOAC5e2c7oKe2n","url":"https://api.github.com/repos/FasterXML/jackson-databind/labels/enum","name":"enum","color":"A596C8","default":false,"description":"Related to handling of Enum values"},{"id":7201103729,"node_id":"LA_kwDOAC5e2c8AAAABrTgfcQ","url":"https://api.github.com/repos/FasterXML/jackson-databind/labels/3.0","name":"3.0","color":"80E086","default":false,"description":"Issue planned for initial 3.0 release"},{"id":8506095424,"node_id":"LA_kwDOAC5e2c8AAAAB-wC3QA","url":"https://api.github.com/repos/FasterXML/jackson-databind/labels/2.20","name":"2.20","color":"1D76DB","default":false,"description":"Issues planned at 2.20 or later"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/181","html_url":"https://github.com/FasterXML/jackson-databind/milestone/181","labels_url":"https://api.github.com/repos/FasterXML/jackson-databind/milestones/181/labels","id":12791387,"node_id":"MI_kwDOAC5e2c4Awy5b","number":181,"title":"2.20.0","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":18,"state":"closed","created_at":"2025-04-26T00:26:36Z","updated_at":"2025-10-30T23:28:38Z","due_on":null,"closed_at":"2025-10-30T23:28:38Z"},"comments":15,"created_at":"2025-08-22T16:22:35Z","updated_at":"2025-08-27T22:37:54Z","closed_at":"2025-08-27T22:27:21Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Search before asking\n\n- [x] I searched in the [issues](https://github.com/FasterXML/jackson-databind/issues) and found nothing similar.\n\n### Describe the bug\n\nEnumDeserializer fails to deserialize Enums with @JsonValue - uses table with name() key instead of @JsonValue key.\n\nThe difference between Jackson2 and Jackson3 is the choice of tables used for lookup (see debugger screen-shot).\n\n\n```\n\t@Test\n\tvoid convertStringToEnum() {\n\t\tassertThat(new ObjectMapper().convertValue(\"10%\", MyEnum.class)).isEqualTo(MyEnum.T10);\n\t}\n\n\tpublic enum MyEnum {\n\t\tT10(\"10%\"), T20(\"20%\"), T30(\"30%\");\n\n\t\tprivate final String code;\n\n\t\tMyEnum(String code) {\n\t\t\tthis.code = code;\n\t\t}\n\n\t\t@JsonValue\n\t\tpublic String getCode() {\n\t\t\treturn code;\n\t\t}\n\t}\n```\n\n\n```\ntools.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `org.springframework.data.couchbase.core.mapping.MappingCouchbaseConverterTests$MyEnum` from String \"10%\": not one of the values accepted for Enum class: [T30, T20, T10]\n at [No location information]\n\n\tat tools.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:37)\n\tat tools.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1977)\n\tat tools.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1320)\n\tat tools.jackson.databind.deser.jdk.EnumDeserializer._deserializeAltString(EnumDeserializer.java:355)\n\tat tools.jackson.databind.deser.jdk.EnumDeserializer._fromString(EnumDeserializer.java:215)\n\tat tools.jackson.databind.deser.jdk.EnumDeserializer.deserialize(EnumDeserializer.java:184)\n\tat tools.jackson.databind.ObjectMapper._convert(ObjectMapper.java:2391)\n\tat tools.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:2323)\n```\n\nIn the debugger \n\nWith Jackson3, the lookup table has the name() as the key. Thus it does not find the corresponding Enum.\n\n<img width=\"1448\" height=\"1182\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/2a7b70c3-5346-4c88-a15a-54a9ffb675ee\" />\n\nWith Jackson2 the lookup table has the @JsonValue values as the key. It does find the corresponding Enum using the serialized value.\n\n<img width=\"1663\" height=\"994\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/78d1fbf0-0a00-422a-9fce-3671800f011a\" />\n\n### Expected behavior\n\nTest passes. \n\n### Additional context\n\nWorks in Jackson 2","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/5271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-databind/issues/5271/timeline","performed_via_github_app":null,"state_reason":"completed"}