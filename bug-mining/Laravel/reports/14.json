{"url":"https://api.github.com/repos/laravel/framework/issues/51583","repository_url":"https://api.github.com/repos/laravel/framework","labels_url":"https://api.github.com/repos/laravel/framework/issues/51583/labels{/name}","comments_url":"https://api.github.com/repos/laravel/framework/issues/51583/comments","events_url":"https://api.github.com/repos/laravel/framework/issues/51583/events","html_url":"https://github.com/laravel/framework/issues/51583","id":2318674333,"node_id":"I_kwDOAHMwOs6KNCmd","number":51583,"title":"BackedEnum on Route already resolved","user":{"login":"CAAHS","id":154250652,"node_id":"U_kgDOCTGtnA","avatar_url":"https://avatars.githubusercontent.com/u/154250652?v=4","gravatar_id":"","url":"https://api.github.com/users/CAAHS","html_url":"https://github.com/CAAHS","followers_url":"https://api.github.com/users/CAAHS/followers","following_url":"https://api.github.com/users/CAAHS/following{/other_user}","gists_url":"https://api.github.com/users/CAAHS/gists{/gist_id}","starred_url":"https://api.github.com/users/CAAHS/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CAAHS/subscriptions","organizations_url":"https://api.github.com/users/CAAHS/orgs","repos_url":"https://api.github.com/users/CAAHS/repos","events_url":"https://api.github.com/users/CAAHS/events{/privacy}","received_events_url":"https://api.github.com/users/CAAHS/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":24480042,"node_id":"MDU6TGFiZWwyNDQ4MDA0Mg==","url":"https://api.github.com/repos/laravel/framework/labels/bug","name":"bug","color":"ee0701","default":true,"description":""},{"id":1993557750,"node_id":"MDU6TGFiZWwxOTkzNTU3NzUw","url":"https://api.github.com/repos/laravel/framework/labels/help%20wanted","name":"help wanted","color":"008672","default":true,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2024-05-27T09:20:05Z","updated_at":"2024-05-27T15:45:36Z","closed_at":"2024-05-27T15:45:36Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Laravel Version\n\n10.48.11\n\n### PHP Version\n\n8.1.28\n\n### Database Driver & Version\n\n_No response_\n\n### Description\n\nGiven the `$parameterValue` on the route is already resolved, do not try to resolve it from stringable any longer.\r\n\r\nOtherwise an error (current behavior):\r\n\r\n     Object of class App\\Models\\StringBackedEnum could not be converted to string\r\n     \r\n\r\nError occured first during an update of livewire/livewire:\r\n\r\n| Production Changes | From   | To     | Compare                                                             |\r\n|--------------------|--------|--------|---------------------------------------------------------------------|\r\n| livewire/livewire  | v3.3.0 | v3.3.1 | [...](https://github.com/livewire/livewire/compare/v3.3.0...v3.3.1) |\r\n\r\n(isolated change, from livewire/livewire:v3.3.1...latest the error retains)\r\n\r\n\r\n~~~console\r\n$ artisan --version\r\nLaravel Framework 10.48.11\r\n~~~\r\n\r\nWe have a trivial patch in \\Illuminate\\Routing\\ImplicitRouteBinding::resolveBackedEnumsForRoute:\r\n\r\n~~~patch\r\ndiff --git a/vendor/laravel/framework/src/Illuminate/Routing/ImplicitRouteBinding.php b/vendor/laravel/framework/src/Illuminate/Routing/ImplicitRouteBindingB.php\r\nindex d3590de..04921e0 100644\r\n--- a/vendor/laravel/framework/src/Illuminate/Routing/ImplicitRouteBinding.php\r\n+++ b/vendor/laravel/framework/src/Illuminate/Routing/ImplicitRouteBindingB.php\r\n@@ -86,7 +86,13 @@ class ImplicitRouteBinding\r\n \r\n             $backedEnumClass = $parameter->getType()?->getName();\r\n \r\n-            $backedEnum = $backedEnumClass::tryFrom((string) $parameterValue);\r\n+            $backedEnum = null;\r\n+\r\n+            if ($parameterValue instanceof $backedEnumClass) {\r\n+                $backedEnum = $parameterValue;\r\n+            }\r\n+\r\n+            $backedEnum = $backedEnum ?? $backedEnumClass::tryFrom((string) $parameterValue);\r\n \r\n             if (is_null($backedEnum)) {\r\n                 throw new BackedEnumCaseNotFoundException($backedEnumClass, $parameterValue);\r\n~~~\r\n\r\nand do see this is induced by Livewire.\r\n\r\nFrom the type of change we believe this is a good fit for supporting (String)BackedEnums on Routes.\r\n\r\nPlease let us know if this is not too far off, then we would create a pull request.\r\n\r\nPlease share your recommendations.\n\n### Steps To Reproduce\n\n* Wire a route with a backed enum parameter\r\n* Inject the enum, directly or indirectly (e.g. use Livewire)\r\n* Error throws at vendor/laravel/framework/src/Illuminate/Routing/ImplicitRouteBinding.php:89\r\n\r\n   ~~~\r\n   $backedEnum = $backedEnumClass::tryFrom((string) $parameterValue);\r\n                                                   ^\r\n                                                   |\r\n              /!\\ Object of class App\\Models\\StringBackedEnum could not be converted to string\r\n   ~~~","closed_by":{"login":"driesvints","id":594614,"node_id":"MDQ6VXNlcjU5NDYxNA==","avatar_url":"https://avatars.githubusercontent.com/u/594614?v=4","gravatar_id":"","url":"https://api.github.com/users/driesvints","html_url":"https://github.com/driesvints","followers_url":"https://api.github.com/users/driesvints/followers","following_url":"https://api.github.com/users/driesvints/following{/other_user}","gists_url":"https://api.github.com/users/driesvints/gists{/gist_id}","starred_url":"https://api.github.com/users/driesvints/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/driesvints/subscriptions","organizations_url":"https://api.github.com/users/driesvints/orgs","repos_url":"https://api.github.com/users/driesvints/repos","events_url":"https://api.github.com/users/driesvints/events{/privacy}","received_events_url":"https://api.github.com/users/driesvints/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/laravel/framework/issues/51583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/laravel/framework/issues/51583/timeline","performed_via_github_app":null,"state_reason":"completed"}