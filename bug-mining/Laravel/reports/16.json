{"url":"https://api.github.com/repos/laravel/framework/issues/51822","repository_url":"https://api.github.com/repos/laravel/framework","labels_url":"https://api.github.com/repos/laravel/framework/issues/51822/labels{/name}","comments_url":"https://api.github.com/repos/laravel/framework/issues/51822/comments","events_url":"https://api.github.com/repos/laravel/framework/issues/51822/events","html_url":"https://github.com/laravel/framework/issues/51822","id":2358690116,"node_id":"I_kwDOAHMwOs6MlsFE","number":51822,"title":"Inside a specific console command, we can not call an another command as a initialized instance of Command class.","user":{"login":"seriquynh","id":16967350,"node_id":"MDQ6VXNlcjE2OTY3MzUw","avatar_url":"https://avatars.githubusercontent.com/u/16967350?v=4","gravatar_id":"","url":"https://api.github.com/users/seriquynh","html_url":"https://github.com/seriquynh","followers_url":"https://api.github.com/users/seriquynh/followers","following_url":"https://api.github.com/users/seriquynh/following{/other_user}","gists_url":"https://api.github.com/users/seriquynh/gists{/gist_id}","starred_url":"https://api.github.com/users/seriquynh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seriquynh/subscriptions","organizations_url":"https://api.github.com/users/seriquynh/orgs","repos_url":"https://api.github.com/users/seriquynh/repos","events_url":"https://api.github.com/users/seriquynh/events{/privacy}","received_events_url":"https://api.github.com/users/seriquynh/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":24480042,"node_id":"MDU6TGFiZWwyNDQ4MDA0Mg==","url":"https://api.github.com/repos/laravel/framework/labels/bug","name":"bug","color":"ee0701","default":true,"description":""}],"state":"closed","locked":false,"assignee":{"login":"crynobone","id":172966,"node_id":"MDQ6VXNlcjE3Mjk2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/172966?v=4","gravatar_id":"","url":"https://api.github.com/users/crynobone","html_url":"https://github.com/crynobone","followers_url":"https://api.github.com/users/crynobone/followers","following_url":"https://api.github.com/users/crynobone/following{/other_user}","gists_url":"https://api.github.com/users/crynobone/gists{/gist_id}","starred_url":"https://api.github.com/users/crynobone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/crynobone/subscriptions","organizations_url":"https://api.github.com/users/crynobone/orgs","repos_url":"https://api.github.com/users/crynobone/repos","events_url":"https://api.github.com/users/crynobone/events{/privacy}","received_events_url":"https://api.github.com/users/crynobone/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"crynobone","id":172966,"node_id":"MDQ6VXNlcjE3Mjk2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/172966?v=4","gravatar_id":"","url":"https://api.github.com/users/crynobone","html_url":"https://github.com/crynobone","followers_url":"https://api.github.com/users/crynobone/followers","following_url":"https://api.github.com/users/crynobone/following{/other_user}","gists_url":"https://api.github.com/users/crynobone/gists{/gist_id}","starred_url":"https://api.github.com/users/crynobone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/crynobone/subscriptions","organizations_url":"https://api.github.com/users/crynobone/orgs","repos_url":"https://api.github.com/users/crynobone/repos","events_url":"https://api.github.com/users/crynobone/events{/privacy}","received_events_url":"https://api.github.com/users/crynobone/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2024-06-18T02:01:31Z","updated_at":"2024-06-19T01:47:01Z","closed_at":"2024-06-19T01:47:01Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Laravel Version\r\n\r\n10.x\r\n\r\n### PHP Version\r\n\r\n8.3\r\n\r\n### Database Driver & Version\r\n\r\n_No response_\r\n\r\n### Description\r\n\r\nBecause of \\Illuminate\\Console\\Command::call() method docblock, it must accept any kinds of Symfony Command instances. But it does not and raise an error.\r\n\r\n```php\r\n    /**\r\n     * Call another console command.\r\n     *\r\n     * @param  \\Symfony\\Component\\Console\\Command\\Command|string  $command\r\n     * @param  array  $arguments\r\n     * @return int\r\n     */\r\n    public function call($command, array $arguments = [])\r\n    {\r\n        return $this->runCommand($command, $arguments, $this->output);\r\n    }\r\n```\r\n\r\n![Screenshot_4](https://github.com/laravel/framework/assets/16967350/720ebbfc-b39e-4837-ac08-5999d9937ad3)\r\n\r\n\r\n### Steps To Reproduce\r\n\r\n1. Inside a 10.x Laravel project, create a \"demo\" command like this:\r\n\r\n```php\r\n<?php\r\n\r\nnamespace App\\Console\\Commands;\r\n\r\nuse Illuminate\\Console\\Command;\r\nuse Illuminate\\Foundation\\Console\\ViewClearCommand;\r\n\r\nclass DemoCommand extends Command\r\n{\r\n    protected $signature = 'demo';\r\n\r\n    protected $description = 'This is \"demo\" command description';\r\n\r\n    public function handle()\r\n    {\r\n        $this->call('view:clear'); // It works properly.\r\n\r\n        $this->call(ViewClearCommand::class); // It works properly.\r\n\r\n        $this->call(\r\n            $this->laravel->make(ViewClearCommand::class) // It does not work and raise an error.\r\n        );\r\n    }\r\n}\r\n\r\n```\r\n \r\n2. Open the termial, go to the project directory and run \"php artisan demo\".\r\n```bash\r\n   INFO  Compiled views cleared successfully.\r\n\r\n   INFO  Compiled views cleared successfully.\r\n\r\n\r\n   TypeError\r\n\r\n  class_exists(): Argument #1 ($class) must be of type string, Illuminate\\Foundation\\Console\\ViewClearCommand given\r\n\r\n  at vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php:245\r\n    241▕      * @return \\Symfony\\Component\\Console\\Command\\Command\r\n    242▕      */\r\n    243▕     protected function resolveCommand($command)\r\n    244▕     {\r\n  ➜ 245▕         if (! class_exists($command)) {\r\n    246▕             return $this->getApplication()->find($command);\r\n    247▕         }\r\n    248▕\r\n    249▕         $command = $this->laravel->make($command);\r\n\r\n  1   vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php:245\r\n\r\n  2   vendor\\laravel\\framework\\src\\Illuminate\\Console\\Concerns\\CallsCommands.php:67\r\n      Illuminate\\Console\\Command::resolveCommand(Object(Illuminate\\Foundation\\Console\\ViewClearCommand))\r\n```\r\n\r\nWhen we pass a Command instance through `call` method, it continues passing through `resolveCommand` method. There, `class_exists` requires a string as the first parameter and an error is raised here.\r\n\r\nWe should either update `call` method to accept string only or update checks inside `resolveCommand`.","closed_by":{"login":"crynobone","id":172966,"node_id":"MDQ6VXNlcjE3Mjk2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/172966?v=4","gravatar_id":"","url":"https://api.github.com/users/crynobone","html_url":"https://github.com/crynobone","followers_url":"https://api.github.com/users/crynobone/followers","following_url":"https://api.github.com/users/crynobone/following{/other_user}","gists_url":"https://api.github.com/users/crynobone/gists{/gist_id}","starred_url":"https://api.github.com/users/crynobone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/crynobone/subscriptions","organizations_url":"https://api.github.com/users/crynobone/orgs","repos_url":"https://api.github.com/users/crynobone/repos","events_url":"https://api.github.com/users/crynobone/events{/privacy}","received_events_url":"https://api.github.com/users/crynobone/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/laravel/framework/issues/51822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/laravel/framework/issues/51822/timeline","performed_via_github_app":null,"state_reason":"completed"}