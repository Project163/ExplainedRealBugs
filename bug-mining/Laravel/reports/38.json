{"url":"https://api.github.com/repos/laravel/framework/issues/56261","repository_url":"https://api.github.com/repos/laravel/framework","labels_url":"https://api.github.com/repos/laravel/framework/issues/56261/labels{/name}","comments_url":"https://api.github.com/repos/laravel/framework/issues/56261/comments","events_url":"https://api.github.com/repos/laravel/framework/issues/56261/events","html_url":"https://github.com/laravel/framework/issues/56261","id":3220101027,"node_id":"I_kwDOAHMwOs6_7tej","number":56261,"title":"Operator Class for PostgreSQL GiST-Index required","user":{"login":"bleedchf","id":116746727,"node_id":"U_kgDOBvVp5w","avatar_url":"https://avatars.githubusercontent.com/u/116746727?v=4","gravatar_id":"","url":"https://api.github.com/users/bleedchf","html_url":"https://github.com/bleedchf","followers_url":"https://api.github.com/users/bleedchf/followers","following_url":"https://api.github.com/users/bleedchf/following{/other_user}","gists_url":"https://api.github.com/users/bleedchf/gists{/gist_id}","starred_url":"https://api.github.com/users/bleedchf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleedchf/subscriptions","organizations_url":"https://api.github.com/users/bleedchf/orgs","repos_url":"https://api.github.com/users/bleedchf/repos","events_url":"https://api.github.com/users/bleedchf/events{/privacy}","received_events_url":"https://api.github.com/users/bleedchf/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-07-10T17:16:07Z","updated_at":"2025-07-18T16:24:26Z","closed_at":"2025-07-18T16:24:26Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Laravel Version\n\n12.20.0\n\n### PHP Version\n\n8.4.8\n\n### Database Driver & Version\n\npgsql/17.5\n\n### Description\n\nThe creation of a GiST-Index requires a class operator as described in https://www.postgresql.org/docs/16/gist-builtin-opclasses.html\n\nIt must be either one of:\n\n-     box_ops\n-     circle_ops\n-     inet_ops\n-     multirange_ops\n-     point_ops\n-     poly_ops\n-     range_ops\n-     tsquery_ops\n-     tsvector_ops\n\nCurrently, laravel ignores the operator class, thus causing it to fail on a migration. A fix of this issue would be highly appreciated since GiST-Indices are not uncommon in PostgreSQL.\n\nThank you very much for your attention and consideration.\n\n### Steps To Reproduce\n\n```sql\nCREATE TABLE public.payers_subscriptions (\nid integer NOT NULL,\nclient_internet inet\n);\n\nCREATE INDEX payers_subscriptions_client_internet_idx ON public.payers_subscriptions USING gist (client_internet inet_ops);\n```\n\n\n\n--------------\n\n\n\n```\ncomposer require kitloong/laravel-migrations-generator\n```\n\n\n\n------\n\n\n\n```\nphp artisan migrate:generate --ignore=users,cache,jobs,cache_locks,failed_jobs,job_batches,password_reset_tokens,sessions\n```\n\nUsing connection: pgsql\n\nGenerating migrations for: payers_subscriptions\n\nDo you want to log these migrations in the migrations table? (yes/no) [yes]:\n\nNext Batch Number is: 2. We recommend using Batch Number 0 so that it becomes the \"first\" migration. [Default: 0] [0]:\n\nSetting up Tables and Index migrations.\nCreated: /.../.../.../database/migrations/2025_07_09_013525_create_payers_subscriptions_table.php\n\nSetting up Views migrations.\n\nSetting up Stored Procedures migrations.\n\nSetting up Foreign Key migrations.\n\nFinished!\n\n\n\n-------------\n\n\n\n```php\n<?php\n\nuse Illuminate\\Database\\Migrations\\Migration;\nuse Illuminate\\Database\\Schema\\Blueprint;\nuse Illuminate\\Support\\Facades\\Schema;\n\nreturn new class extends Migration\n{\n    /**\n     * Run the migrations.\n     */\n    public function up(): void\n    {\n        Schema::create('payers_subscriptions', function (Blueprint $table) {\n            $table->integer('id');\n            $table->ipAddress('client_internet')->nullable();\n\n            $table->spatialIndex(['client_internet'], 'payers_subscriptions_client_internet_idx');\n        });\n    }\n\n    /**\n     * Reverse the migrations.\n     */\n    public function down(): void\n    {\n        Schema::dropIfExists('payers_subscriptions');\n    }\n};\n```\n\n\n\n--------------\n\n\n\n```\nphp artisan migrate:refresh\n```\n\n   INFO  Rolling back migrations.  \n\n  0001_01_01_000002_create_jobs_table ................................................................................................. 63.96ms DONE\n  0001_01_01_000001_create_cache_table ................................................................................................ 16.58ms DONE\n  0001_01_01_000000_create_users_table ................................................................................................ 26.77ms DONE\n  2025_07_09_013525_create_payers_subscriptions_table ................................................................................. 11.78ms DONE\n\n\n   INFO  Running migrations.  \n\n  0001_01_01_000000_create_users_table ................................................................................................. 7.91ms DONE\n  0001_01_01_000001_create_cache_table ................................................................................................. 5.27ms DONE\n  0001_01_01_000002_create_jobs_table .................................................................................................. 6.88ms DONE\n  2025_07_09_013525_create_payers_subscriptions_table .................................................................................. 9.52ms FAIL\n\n>    Illuminate\\Database\\QueryException \n> \n>   SQLSTATE[42704]: Undefined object: 7 ERROR:  data type inet has no default operator class for access method \"gist\"\n> HINT:  You must specify an operator class for the index or define a default operator class for the data type. (Connection: pgsql, SQL: create index \"payers_subscriptions_client_internet_idx\" on \"payers_subscriptions\" using gist (\"client_internet\"))\n> \n>   at vendor/laravel/framework/src/Illuminate/Database/Connection.php:822\n>     818▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e\n>     819▕                 );\n>     820▕             }\n>     821▕ \n>   ➜ 822▕             throw new QueryException(\n>     823▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e\n>     824▕             );\n>     825▕         }\n>     826▕     }\n>       +9 vendor frames \n> \n>   10  database/migrations/2025_07_09_013525_create_payers_subscriptions_table.php:14\n>       Illuminate\\Support\\Facades\\Facade::__callStatic(\"create\")\n>       +38 vendor frames \n> \n>   49  artisan:16\n>       Illuminate\\Foundation\\Application::handleCommand(Object(Symfony\\Component\\Console\\Input\\ArgvInput))\n\n\n\n------\n\n\n\n```\nphp artisan about\n```\n\n>   Environment ......................................................................................................................................  \n>   Application Name .................................................................................................................... [name]  \n>   Laravel Version .......................................................................................................................... 12.20.0  \n>   PHP Version ................................................................................................................................ 8.4.8  \n>   Composer Version .......................................................................................................................... 2.8.10  \n>   Environment ................................................................................................................................ local  \n>   Debug Mode ............................................................................................................................... ENABLED  \n>   URL ............................................................................................................................. [url]  \n>   Maintenance Mode ............................................................................................................................. OFF  \n>   Timezone ..................................................................................................................................... UTC  \n>   Locale ........................................................................................................................................ en  \n> \n>   Cache ............................................................................................................................................  \n>   Config ................................................................................................................................ NOT CACHED  \n>   Events ................................................................................................................................ NOT CACHED  \n>   Routes ................................................................................................................................ NOT CACHED  \n>   Views ..................................................................................................................................... CACHED  \n> \n>   Drivers ..........................................................................................................................................  \n>   Broadcasting ................................................................................................................................. log  \n>   Cache ................................................................................................................................... database  \n>   Database ................................................................................................................................... pgsql  \n>   Logs .............................................................................................................................. stack / single  \n>   Mail ........................................................................................................................................ smtp  \n>   Queue ................................................................................................................................... database  \n>   Session ................................................................................................................................. database  \n> \n>   Storage ..........................................................................................................................................  \n>   public/storage ........................................................................................................................ NOT LINKED  \n\n\n\n```\nphp artisan db:show\n```\n\n>   PostgreSQL .................................................................................................................................. 17.5  \n>   Connection ................................................................................................................................. pgsql  \n>   Database ........................................................................................................................ [dbname]  \n>   Host ................................................................................................................................... 127.0.0.1  \n>   Port ........................................................................................................................................ 5432  \n>   Username ........................................................................................................................ [username]  \n>   URL ..............................................................................................................................................  \n>   Open Connections ............................................................................................................................... 8  \n>   Tables ........................................................................................................................................ 10  \n>   Total Size ............................................................................................................................. 240.00 KB  \n> \n>   Schema / Table .............................................................................................................................. Size  \n>   public / cache .......................................................................................................................... 16.00 KB  \n>   public / cache_locks .................................................................................................................... 16.00 KB  \n>   public / failed_jobs .................................................................................................................... 24.00 KB  \n>   public / job_batches .................................................................................................................... 16.00 KB  \n>   public / jobs ........................................................................................................................... 24.00 KB  \n>   public / migrations ..................................................................................................................... 24.00 KB  \n>   public / password_reset_tokens .......................................................................................................... 16.00 KB  \n>   public / payers_subscriptions ........................................................................................................... 16.00 KB  \n>   public / sessions ....................................................................................................................... 64.00 KB  \n>   public / users .......................................................................................................................... 24.00 KB  \n","closed_by":{"login":"taylorotwell","id":463230,"node_id":"MDQ6VXNlcjQ2MzIzMA==","avatar_url":"https://avatars.githubusercontent.com/u/463230?v=4","gravatar_id":"","url":"https://api.github.com/users/taylorotwell","html_url":"https://github.com/taylorotwell","followers_url":"https://api.github.com/users/taylorotwell/followers","following_url":"https://api.github.com/users/taylorotwell/following{/other_user}","gists_url":"https://api.github.com/users/taylorotwell/gists{/gist_id}","starred_url":"https://api.github.com/users/taylorotwell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/taylorotwell/subscriptions","organizations_url":"https://api.github.com/users/taylorotwell/orgs","repos_url":"https://api.github.com/users/taylorotwell/repos","events_url":"https://api.github.com/users/taylorotwell/events{/privacy}","received_events_url":"https://api.github.com/users/taylorotwell/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/laravel/framework/issues/56261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/laravel/framework/issues/56261/timeline","performed_via_github_app":null,"state_reason":"completed"}