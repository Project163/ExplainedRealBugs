diff --git a/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/notify/NotifyManager.java b/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/notify/NotifyManager.java
index 2ad887f..01c25af 100644
--- a/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/notify/NotifyManager.java
+++ b/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/notify/NotifyManager.java
@@ -223,7 +223,10 @@ public class NotifyManager {
                 AtomicInteger nodeFailCount = nodeFail.get(node);
                 if (nodeFailCount == null) {
                     nodeFailCount = new AtomicInteger();
-                    nodeFail.putIfAbsent(node, nodeFailCount);
+                    AtomicInteger old = nodeFail.putIfAbsent(node, nodeFailCount);
+                    if (old != null) {
+                        nodeFailCount = old;
+                    }
                 }
                 if (nodeFailCount.get() > NODE_FAIL_MAX_NUM) {
                     sendEventRetryMsg(messageEvents, 1, node, 0);
