diff --git a/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/upstream/processor/SubscribeProcessor.java b/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/upstream/processor/SubscribeProcessor.java
index ce06ece..ddcc823 100644
--- a/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/upstream/processor/SubscribeProcessor.java
+++ b/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/upstream/processor/SubscribeProcessor.java
@@ -21,16 +21,21 @@ import io.netty.handler.codec.mqtt.MqttMessage;
 import io.netty.handler.codec.mqtt.MqttSubscribeMessage;
 import io.netty.handler.codec.mqtt.MqttSubscribePayload;
 import io.netty.handler.codec.mqtt.MqttTopicSubscription;
+import org.apache.rocketmq.mqtt.common.facade.SubscriptionPersistManager;
 import org.apache.rocketmq.mqtt.common.hook.HookResult;
 import org.apache.rocketmq.mqtt.common.model.MqttMessageUpContext;
 import org.apache.rocketmq.mqtt.common.model.MqttTopic;
+import org.apache.rocketmq.mqtt.common.model.Subscription;
+import org.apache.rocketmq.mqtt.common.util.SpringUtils;
 import org.apache.rocketmq.mqtt.common.util.TopicUtils;
 import org.apache.rocketmq.mqtt.ds.meta.FirstTopicManager;
 import org.apache.rocketmq.mqtt.ds.upstream.UpstreamProcessor;
 import org.springframework.stereotype.Component;
 
 import javax.annotation.Resource;
+import java.util.HashSet;
 import java.util.List;
+import java.util.Set;
 import java.util.concurrent.CompletableFuture;
 
 @Component
@@ -39,15 +44,28 @@ public class SubscribeProcessor implements UpstreamProcessor {
     @Resource
     private FirstTopicManager firstTopicManager;
 
+    private SubscriptionPersistManager subscriptionPersistManager;
+
     @Override
     public CompletableFuture<HookResult> process(MqttMessageUpContext context, MqttMessage message) {
         MqttSubscribeMessage mqttSubscribeMessage = (MqttSubscribeMessage) message;
         MqttSubscribePayload payload = mqttSubscribeMessage.payload();
         List<MqttTopicSubscription> mqttTopicSubscriptions = payload.topicSubscriptions();
+        Set<Subscription> subscriptions = new HashSet<>();
         for (MqttTopicSubscription mqttTopicSubscription : mqttTopicSubscriptions) {
             String topicFilter = TopicUtils.normalizeTopic(mqttTopicSubscription.topicName());
             MqttTopic mqttTopic = TopicUtils.decode(topicFilter);
             firstTopicManager.checkFirstTopicIfCreated(mqttTopic.getFirstTopic());
+            Subscription subscription = new Subscription();
+            subscription.setTopicFilter(topicFilter);
+            subscription.setQos(mqttTopicSubscription.qualityOfService().value());
+            subscriptions.add(subscription);
+        }
+        if (subscriptionPersistManager == null) {
+            subscriptionPersistManager = SpringUtils.getBean(SubscriptionPersistManager.class);
+        }
+        if (subscriptionPersistManager != null) {
+            subscriptionPersistManager.saveSubscriptions(context.getClientId(), subscriptions);
         }
         return HookResult.newHookResult(HookResult.SUCCESS, null, null);
     }
diff --git a/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/upstream/processor/UnSubscribeProcessor.java b/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/upstream/processor/UnSubscribeProcessor.java
index 1e67703..046a9a8 100644
--- a/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/upstream/processor/UnSubscribeProcessor.java
+++ b/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/upstream/processor/UnSubscribeProcessor.java
@@ -19,15 +19,20 @@ package org.apache.rocketmq.mqtt.ds.upstream.processor;
 
 import io.netty.handler.codec.mqtt.MqttMessage;
 import io.netty.handler.codec.mqtt.MqttUnsubscribePayload;
+import org.apache.rocketmq.mqtt.common.facade.SubscriptionPersistManager;
 import org.apache.rocketmq.mqtt.common.hook.HookResult;
 import org.apache.rocketmq.mqtt.common.model.MqttMessageUpContext;
 import org.apache.rocketmq.mqtt.common.model.MqttTopic;
+import org.apache.rocketmq.mqtt.common.model.Subscription;
+import org.apache.rocketmq.mqtt.common.util.SpringUtils;
 import org.apache.rocketmq.mqtt.common.util.TopicUtils;
 import org.apache.rocketmq.mqtt.ds.meta.FirstTopicManager;
 import org.apache.rocketmq.mqtt.ds.upstream.UpstreamProcessor;
 import org.springframework.stereotype.Component;
 
 import javax.annotation.Resource;
+import java.util.HashSet;
+import java.util.Set;
 import java.util.concurrent.CompletableFuture;
 
 @Component
@@ -36,14 +41,26 @@ public class UnSubscribeProcessor implements UpstreamProcessor {
     @Resource
     private FirstTopicManager firstTopicManager;
 
+    private SubscriptionPersistManager subscriptionPersistManager;
+
     @Override
     public CompletableFuture<HookResult> process(MqttMessageUpContext context, MqttMessage message) {
         MqttUnsubscribePayload payload = (MqttUnsubscribePayload) message.payload();
         if (payload.topics() != null && !payload.topics().isEmpty()) {
+            Set<Subscription> subscriptions = new HashSet<>();
             for (String topic : payload.topics()) {
                 String topicFilter = TopicUtils.normalizeTopic(topic);
                 MqttTopic mqttTopic = TopicUtils.decode(topicFilter);
                 firstTopicManager.checkFirstTopicIfCreated(mqttTopic.getFirstTopic());
+                Subscription subscription = new Subscription();
+                subscription.setTopicFilter(topicFilter);
+                subscriptions.add(subscription);
+            }
+            if (subscriptionPersistManager == null) {
+                subscriptionPersistManager = SpringUtils.getBean(SubscriptionPersistManager.class);
+            }
+            if (subscriptionPersistManager != null) {
+                subscriptionPersistManager.removeSubscriptions(context.getClientId(), subscriptions);
             }
         }
         return HookResult.newHookResult(HookResult.SUCCESS, null, null);
