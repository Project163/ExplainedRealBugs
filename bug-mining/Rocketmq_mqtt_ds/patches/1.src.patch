diff --git a/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/meta/WildcardManager.java b/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/meta/WildcardManager.java
index 545ea1f..7c137c8 100644
--- a/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/meta/WildcardManager.java
+++ b/mqtt-ds/src/main/java/org/apache/rocketmq/mqtt/ds/meta/WildcardManager.java
@@ -88,20 +88,17 @@ public class WildcardManager {
     }
 
     public Set<String> matchQueueSetByMsgTopic(String pubTopic, String namespace) {
+        Set<String> queueNames = new HashSet<>();
         if (StringUtils.isBlank(pubTopic)) {
-            return new HashSet<>();
+            return queueNames;
         }
-        String queueName = pubTopic;
         MqttTopic mqttTopic = TopicUtils.decode(pubTopic);
         String secondTopic = TopicUtils.normalizeSecondTopic(mqttTopic.getSecondTopic());
         if (TopicUtils.isP2P(secondTopic)) {
             String p2Peer = TopicUtils.getP2Peer(mqttTopic, namespace);
-            queueName = TopicUtils.getP2pTopic(p2Peer);
-        }
-        Set<String> queueNames = new HashSet<>();
-        queueNames.add(queueName);
-
-        if (!TopicUtils.isP2P(secondTopic)) {
+            queueNames.add(TopicUtils.getP2pTopic(p2Peer));
+        } else {
+            queueNames.add(pubTopic);
             Set<String> wildcards = matchWildcards(pubTopic);
             if (wildcards != null && !wildcards.isEmpty()) {
                 for (String wildcard : wildcards) {
diff --git a/mqtt-ds/src/test/java/org/apache/rocketmq/mqtt/ds/test/TestWildcardManager.java b/mqtt-ds/src/test/java/org/apache/rocketmq/mqtt/ds/test/TestWildcardManager.java
index a13cb88..7955c4b 100644
--- a/mqtt-ds/src/test/java/org/apache/rocketmq/mqtt/ds/test/TestWildcardManager.java
+++ b/mqtt-ds/src/test/java/org/apache/rocketmq/mqtt/ds/test/TestWildcardManager.java
@@ -53,6 +53,25 @@ public class TestWildcardManager {
 
         Set<String> set =  wildcardManager.matchQueueSetByMsgTopic(TopicUtils.normalizeTopic("test/a"),"");
         Assert.assertTrue(set.contains(TopicUtils.normalizeTopic("test/+")));
+        Assert.assertTrue(set.contains(TopicUtils.normalizeTopic("test/a")));
+        Assert.assertTrue(set.size() == 2);
+    }
+
+    @Test
+    public void testForP2P() throws IllegalAccessException, InterruptedException {
+        WildcardManager wildcardManager = new WildcardManager();
+        MetaPersistManager metaPersistManager = mock(MetaPersistManager.class);
+        FieldUtils.writeDeclaredField(wildcardManager, "metaPersistManager", metaPersistManager, true);
+
+        when(metaPersistManager.getAllFirstTopics()).thenReturn(new HashSet<>(Arrays.asList("test")));
+        when(metaPersistManager.getWildcards(any())).thenReturn(new HashSet<>(Arrays.asList(TopicUtils.normalizeTopic("test/+"))));
+
+        wildcardManager.init();
+        Thread.sleep(1000L);
+
+        Set<String> set =  wildcardManager.matchQueueSetByMsgTopic(TopicUtils.normalizeTopic("test/p2p/GID_sdasa@@@2222"),"");
+        Assert.assertTrue(set.contains(TopicUtils.normalizeTopic("/p2p/GID_sdasa@@@2222/")));
+        Assert.assertTrue(set.size() == 1);
     }
 
 }
