diff --git a/src/main/java/org/apache/hadoop/mrunit/internal/mapreduce/MockMapContextWrapper.java b/src/main/java/org/apache/hadoop/mrunit/internal/mapreduce/MockMapContextWrapper.java
index 8b73f2f..b61f8e6 100644
--- a/src/main/java/org/apache/hadoop/mrunit/internal/mapreduce/MockMapContextWrapper.java
+++ b/src/main/java/org/apache/hadoop/mrunit/internal/mapreduce/MockMapContextWrapper.java
@@ -27,6 +27,8 @@ import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.mapreduce.InputSplit;
 import org.apache.hadoop.mapreduce.Mapper;
+import org.apache.hadoop.mapreduce.TaskAttemptID;
+import org.apache.hadoop.mapreduce.TaskID;
 import org.apache.hadoop.mrunit.internal.output.MockOutputCreator;
 import org.apache.hadoop.mrunit.mapreduce.MapDriver;
 import org.apache.hadoop.mrunit.types.Pair;
@@ -99,6 +101,13 @@ public class MockMapContextWrapper<KEYIN, VALUEIN, KEYOUT, VALUEOUT>
           return currentKeyValue.getSecond();
         }
       });
+      when(context.getTaskAttemptID()).thenAnswer(new Answer<TaskAttemptID>(){
+        @Override
+        public TaskAttemptID answer(InvocationOnMock invocation)
+            throws Throwable {
+          return new TaskAttemptID("", 0, true, 0, 0);
+        }
+      });
     } catch (IOException e) {
       throw new RuntimeException(e);
     } catch (InterruptedException e) {
diff --git a/src/main/java/org/apache/hadoop/mrunit/internal/mapreduce/MockReduceContextWrapper.java b/src/main/java/org/apache/hadoop/mrunit/internal/mapreduce/MockReduceContextWrapper.java
index 6b53415..dbd06e8 100644
--- a/src/main/java/org/apache/hadoop/mrunit/internal/mapreduce/MockReduceContextWrapper.java
+++ b/src/main/java/org/apache/hadoop/mrunit/internal/mapreduce/MockReduceContextWrapper.java
@@ -27,6 +27,8 @@ import java.util.List;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.mapreduce.Reducer;
+import org.apache.hadoop.mapreduce.TaskAttemptID;
+import org.apache.hadoop.mapreduce.TaskID;
 import org.apache.hadoop.mrunit.internal.output.MockOutputCreator;
 import org.apache.hadoop.mrunit.mapreduce.ReduceDriver;
 import org.apache.hadoop.mrunit.types.Pair;
@@ -99,6 +101,13 @@ public class MockReduceContextWrapper<KEYIN, VALUEIN, KEYOUT, VALUEOUT>
           return makeOneUseIterator(currentKeyValue.getSecond().iterator());
         }
       });
+      when(context.getTaskAttemptID()).thenAnswer(new Answer<TaskAttemptID>(){
+        @Override
+        public TaskAttemptID answer(InvocationOnMock invocation)
+            throws Throwable {
+          return new TaskAttemptID("", 0, false, 0, 0);
+        }
+      });
     } catch (IOException e) {
       throw new RuntimeException(e);
     } catch (InterruptedException e) {
diff --git a/src/test/java/org/apache/hadoop/mrunit/mapreduce/TestMapDriver.java b/src/test/java/org/apache/hadoop/mrunit/mapreduce/TestMapDriver.java
index 2313e9f..ac4f1d7 100644
--- a/src/test/java/org/apache/hadoop/mrunit/mapreduce/TestMapDriver.java
+++ b/src/test/java/org/apache/hadoop/mrunit/mapreduce/TestMapDriver.java
@@ -427,4 +427,21 @@ public class TestMapDriver {
     driver.withOutput(new Text("a"), new Text("1"));
     driver.runTest();
   }
+  
+  static class TaskAttemptMapper extends Mapper<Text,NullWritable,Text,NullWritable> {
+    @Override
+    protected void map(Text key, NullWritable value, Context context) 
+        throws IOException,InterruptedException {
+      context.write(new Text(context.getTaskAttemptID().toString()), NullWritable.get());
+    }
+  }
+
+  @Test
+  public void testWithTaskAttemptUse() throws IOException {
+    final MapDriver<Text,NullWritable,Text,NullWritable> driver 
+      = MapDriver.newMapDriver(new TaskAttemptMapper());
+    driver.withInput(new Text("anything"), NullWritable.get()).withOutput(
+        new Text("attempt__0000_m_000000_0"), NullWritable.get()).runTest();
+  }
+  
 }
diff --git a/src/test/java/org/apache/hadoop/mrunit/mapreduce/TestReduceDriver.java b/src/test/java/org/apache/hadoop/mrunit/mapreduce/TestReduceDriver.java
index 6fc1578..936354a 100644
--- a/src/test/java/org/apache/hadoop/mrunit/mapreduce/TestReduceDriver.java
+++ b/src/test/java/org/apache/hadoop/mrunit/mapreduce/TestReduceDriver.java
@@ -486,4 +486,21 @@ public class TestReduceDriver {
         new LongWritable(2));
     driver.runTest();
   }
+
+  static class TaskAttemptReducer extends Reducer<Text,NullWritable,Text,NullWritable> {
+    @Override
+    protected void reduce(Text key, Iterable<NullWritable> values, Context context) 
+        throws IOException,InterruptedException {
+      context.write(new Text(context.getTaskAttemptID().toString()), NullWritable.get());
+    }
+  }
+
+  @Test
+  public void testWithTaskAttemptUse() throws IOException {
+    final ReduceDriver<Text,NullWritable,Text,NullWritable> driver 
+      = ReduceDriver.newReduceDriver(new TaskAttemptReducer());
+    driver.withInput(new Text("anything"), Arrays.asList(NullWritable.get())).withOutput(
+        new Text("attempt__0000_r_000000_0"), NullWritable.get()).runTest();
+  }
+
 }
