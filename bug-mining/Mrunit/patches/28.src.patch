diff --git a/src/main/java/org/apache/hadoop/mrunit/TestDriver.java b/src/main/java/org/apache/hadoop/mrunit/TestDriver.java
index 1072f26..b460e17 100644
--- a/src/main/java/org/apache/hadoop/mrunit/TestDriver.java
+++ b/src/main/java/org/apache/hadoop/mrunit/TestDriver.java
@@ -461,7 +461,7 @@ public abstract class TestDriver<K1, V1, K2, V2, T extends TestDriver<K1, V1, K2
         localFiles.add(filePath);
       }
       if (!localFiles.isEmpty()) {
-        DistributedCache.addLocalFiles(conf, 
+        DistCacheUtils.addLocalFiles(conf, 
             DistCacheUtils.stringifyPathList(localFiles));
       }
     }
@@ -475,7 +475,7 @@ public abstract class TestDriver<K1, V1, K2, V2, T extends TestDriver<K1, V1, K2
             archivePath, tmpDistCacheDir));
       }
       if (!localArchives.isEmpty()) {
-        DistributedCache.addLocalArchives(conf, 
+        DistCacheUtils.addLocalArchives(conf, 
             DistCacheUtils.stringifyPathList(localArchives));
       }
     }
diff --git a/src/main/java/org/apache/hadoop/mrunit/internal/util/DistCacheUtils.java b/src/main/java/org/apache/hadoop/mrunit/internal/util/DistCacheUtils.java
index 0a060b1..f150573 100644
--- a/src/main/java/org/apache/hadoop/mrunit/internal/util/DistCacheUtils.java
+++ b/src/main/java/org/apache/hadoop/mrunit/internal/util/DistCacheUtils.java
@@ -27,12 +27,15 @@ import java.util.UUID;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.fs.FileUtil;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.util.RunJar;
 
 public class DistCacheUtils {
 
+  private static final String CACHE_LOCALARCHIVES = "mapred.cache.localArchives";
+  private static final String CACHE_LOCALFILES = "mapred.cache.localFiles";
   private static final Log LOG = LogFactory.getLog(DistCacheUtils.class);
 
   private DistCacheUtils() {
@@ -129,4 +132,16 @@ public class DistCacheUtils {
            filename.endsWith(".tar"));
   }
 
+  public static void addLocalFiles(Configuration conf, String str) {
+    String files = conf.get(CACHE_LOCALFILES);
+    conf.set(CACHE_LOCALFILES, files == null ? str
+        : files + "," + str);
+  }
+
+  public static void addLocalArchives(Configuration conf, String str) {
+    String files = conf.get(CACHE_LOCALARCHIVES);
+    conf.set(CACHE_LOCALARCHIVES, files == null ? str
+        : files + "," + str);
+  }
+
 }
