<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:41:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MRUNIT-167] context passed to an OuputFormatter is ignored by the framework</title>
                <link>https://issues.apache.org/jira/browse/MRUNIT-167</link>
                <project id="12311292" key="MRUNIT">MRUnit</project>
                    <description>&lt;p&gt;The following method creates a context that it passes to the output formatter under test, however it ignores the results:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;org.apache.hadoop.mrunit.internal.mapreduce.MockMapreduceOutputFormat.collect(K, V)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;specifically if the output formatter increments counters the counters are not available to the test code. (DummyReporter just creates a new Counter() each time) In my case I&apos;m incrementing counters in my output formatter but these counters are not available when I check in my junit test method at the end of the test run.&lt;/p&gt;

&lt;p&gt;I&apos;m using the latest 1.0.0 snapshot with hadoop2 classifier.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12624351">MRUNIT-167</key>
            <summary>context passed to an OuputFormatter is ignored by the framework</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brocknoland">Brock Noland</assignee>
                                    <reporter username="phunt">Patrick D. Hunt</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Dec 2012 21:43:02 +0000</created>
                <updated>Fri, 1 Mar 2013 15:41:15 +0000</updated>
                            <resolved>Fri, 1 Mar 2013 13:21:10 +0000</resolved>
                                    <version>1.0.0</version>
                                    <fixVersion>1.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13538314" author="brocknoland" created="Fri, 21 Dec 2012 19:18:12 +0000"  >&lt;p&gt;I spent some time looking at this. I am not sure we&apos;d be able to support this in a code base on 1.X and 2.X at the same time.&lt;/p&gt;

&lt;p&gt;The TaskAttemptContext.getCounter* methods do not exist in branch-1&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/hadoop-common/blob/branch-1/src/mapred/org/apache/hadoop/mapreduce/TaskAttemptContext.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hadoop-common/blob/branch-1/src/mapred/org/apache/hadoop/mapreduce/TaskAttemptContext.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;but do in branch-2.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/hadoop-common/blob/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/TaskAttemptContext.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hadoop-common/blob/trunk/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/TaskAttemptContext.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13546244" author="brocknoland" created="Mon, 7 Jan 2013 20:42:09 +0000"  >&lt;p&gt;Patrick,&lt;/p&gt;

&lt;p&gt;Could you share a quick snippet or share which method you are incrementing the counters in your output format? I assume it&apos;s in the record writer itself.&lt;/p&gt;</comment>
                            <comment id="13547025" author="brocknoland" created="Tue, 8 Jan 2013 17:20:13 +0000"  >&lt;p&gt;Looking at this a bit more it seems like we just need to pass the context created in the driver down to MockMapreduceOutputFormat. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davebeech&quot; class=&quot;user-hover&quot; rel=&quot;davebeech&quot;&gt;davebeech&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdonofrio&quot; class=&quot;user-hover&quot; rel=&quot;jdonofrio&quot;&gt;jdonofrio&lt;/a&gt; does that sound correct to you?&lt;/p&gt;</comment>
                            <comment id="13548773" author="phunt" created="Wed, 9 Jan 2013 18:23:56 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brocknoland&quot; class=&quot;user-hover&quot; rel=&quot;brocknoland&quot;&gt;brocknoland&lt;/a&gt; it&apos;s pretty straightforward: &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;context.getCounter(groupName, counterName).increment(incr);&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="13548789" author="brocknoland" created="Wed, 9 Jan 2013 18:32:38 +0000"  >&lt;p&gt;Thanks Patrick, my question is really where is that code actually executing? In the RecordWriter?&lt;/p&gt;</comment>
                            <comment id="13548815" author="phunt" created="Wed, 9 Jan 2013 18:49:45 +0000"  >&lt;blockquote&gt;&lt;p&gt;In the RecordWriter?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes.&lt;/p&gt;</comment>
                            <comment id="13575187" author="brocknoland" created="Sat, 9 Feb 2013 15:50:42 +0000"  >&lt;p&gt;Alright, here is the first attempt at this patch. I added a test that tests incrementing a counter in a record writer.&lt;/p&gt;</comment>
                            <comment id="13575190" author="brocknoland" created="Sat, 9 Feb 2013 15:58:46 +0000"  >&lt;p&gt;Patch v2 minor removal of unneeded code.&lt;/p&gt;

&lt;p&gt;The one thing I am not completely sure of is in MockMapreduceOutputFormat are we using inputFormatJob appropriately. I believe it&apos;s uses to read the output of the job back in so I wonder if this line:&lt;/p&gt;

&lt;p&gt;    taskAttemptContext.getConfiguration().set(FileInputFormat.INPUT_DIR, &lt;br/&gt;
        new Path((outputPath + &quot;/&lt;b&gt;/&lt;/b&gt;/&lt;b&gt;/&lt;/b&gt;&quot;)).toString());&lt;/p&gt;

&lt;p&gt;shouldn&apos;t be using that configuration object instead.&lt;/p&gt;</comment>
                            <comment id="13579382" author="brocknoland" created="Fri, 15 Feb 2013 18:20:36 +0000"  >&lt;p&gt;Seeing no comments I&apos;ll give this a final look at commit soon.&lt;/p&gt;</comment>
                            <comment id="13590644" author="hudson" created="Fri, 1 Mar 2013 15:41:15 +0000"  >&lt;p&gt;Integrated in mrunit-trunk #795 (See &lt;a href=&quot;https://builds.apache.org/job/mrunit-trunk/795/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/mrunit-trunk/795/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MRUNIT-167&quot; title=&quot;context passed to an OuputFormatter is ignored by the framework&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MRUNIT-167&quot;&gt;&lt;del&gt;MRUNIT-167&lt;/del&gt;&lt;/a&gt;: context passed to an OuputFormatter is ignored by the framework (Revision 0d261d6298ed2377a85fdeb60d574a62c204b4b7)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
brock : &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=mrunit.git&amp;amp;a=commit&amp;amp;h=0d261d6298ed2377a85fdeb60d574a62c204b4b7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=mrunit.git&amp;amp;a=commit&amp;amp;h=0d261d6298ed2377a85fdeb60d574a62c204b4b7&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;src/main/java/org/apache/hadoop/mrunit/internal/output/MockOutputCreator.java&lt;/li&gt;
	&lt;li&gt;src/main/java/org/apache/hadoop/mrunit/internal/mapreduce/MockMapreduceOutputFormat.java&lt;/li&gt;
	&lt;li&gt;src/main/java/org/apache/hadoop/mrunit/MapDriver.java&lt;/li&gt;
	&lt;li&gt;src/main/java/org/apache/hadoop/mrunit/internal/mapreduce/AbstractMockContextWrapper.java&lt;/li&gt;
	&lt;li&gt;src/test/java/org/apache/hadoop/mrunit/mapreduce/TestMapDriver.java&lt;/li&gt;
	&lt;li&gt;src/main/java/org/apache/hadoop/mrunit/ReduceDriver.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12568705" name="MRUNIT-167-0.patch" size="15712" author="brocknoland" created="Sat, 9 Feb 2013 15:50:42 +0000"/>
                            <attachment id="12568706" name="MRUNIT-167-1.patch" size="15913" author="brocknoland" created="Sat, 9 Feb 2013 15:58:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>299190</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 38 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1605j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>243157</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>