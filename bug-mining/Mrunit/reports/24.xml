<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:41:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MRUNIT-127] Key grouping with GroupingComparators is not consistent with MapReduce behaviour</title>
                <link>https://issues.apache.org/jira/browse/MRUNIT-127</link>
                <project id="12311292" key="MRUNIT">MRUnit</project>
                    <description>&lt;p&gt;In Hadoop MapReduce, for a set of keys to be properly grouped together by a grouping comparator into a reduce call, they need to be in a contiguous range when sorted by the key&apos;s ordering comparator. &lt;/p&gt;

&lt;p&gt;MRUnit does not impose this requirement, so if the user&apos;s grouping and sorting comparator logic is incorrect, their tests may pass and give the expected result even though the outcome would be different when run as a true MapReduce job. &lt;/p&gt;

&lt;p&gt;(see below for further explanation)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12600912">MRUNIT-127</key>
            <summary>Key grouping with GroupingComparators is not consistent with MapReduce behaviour</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dbeech">Dave Beech</assignee>
                                    <reporter username="dbeech">Dave Beech</reporter>
                        <labels>
                    </labels>
                <created>Tue, 31 Jul 2012 21:19:50 +0000</created>
                <updated>Fri, 3 Aug 2012 09:41:51 +0000</updated>
                            <resolved>Fri, 3 Aug 2012 09:41:51 +0000</resolved>
                                    <version>0.9.0</version>
                                    <fixVersion>1.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13426149" author="dbeech" created="Tue, 31 Jul 2012 21:27:52 +0000"  >&lt;p&gt;Consider the following keys sorted in natural order: A1, A2, B1, B2, C1. &lt;/p&gt;

&lt;p&gt;If you have a grouping comparator that only considers the first character, you get 3 reduce groups. This is correct behaviour. &lt;br/&gt;
(A1, A2), (B1, B2) and (C1)&lt;/p&gt;

&lt;p&gt;But - if instead the keys are 1A, 2A, 1B, 2B, 1C but you still want to group according to whether it&apos;s an A,B or C, you may think you can implement a grouping comparator which only considers the second character. This doesn&apos;t work. This is because when the keys are sorted in natural order you get 1A, 1B, 1C, 2A, 2B and the groups are not contiguous. So, MapReduce will give you 5 reduce groups but MRUnit will still group these into 3. &lt;/p&gt;</comment>
                            <comment id="13426558" author="brocknoland" created="Wed, 1 Aug 2012 12:41:51 +0000"  >&lt;p&gt;Is this true even if you add a custom sorting comparator to your driver?&lt;/p&gt;</comment>
                            <comment id="13426560" author="dbeech" created="Wed, 1 Aug 2012 12:46:58 +0000"  >&lt;p&gt;If the custom sorting comparator orders things such that all the keys which should be grouped together fall next to each other, then yeah, you&apos;re fine. Otherwise MapReduce and MRUnit will give you different answers. &lt;/p&gt;</comment>
                            <comment id="13426771" author="brocknoland" created="Wed, 1 Aug 2012 17:47:11 +0000"  >&lt;p&gt;Looks like the problem is in MapReduceDriverBase.shuffle. &lt;/p&gt;</comment>
                            <comment id="13426952" author="dbeech" created="Wed, 1 Aug 2012 22:12:52 +0000"  >&lt;p&gt;Guys, can I get a quick review on this patch please? &lt;/p&gt;

&lt;p&gt;It does introduce two unit test failures (testComparators in TestMapReduceDriver, mapred and mapreduce versions), but actually I think that&apos;s because those tests use the same incorrect assumptions that this JIRA is meant to fix. &lt;/p&gt;

&lt;p&gt;I&apos;ll run that test as a true MapReduce job to see if it confirms my suspicions and report back. &lt;/p&gt;</comment>
                            <comment id="13427571" author="dbeech" created="Thu, 2 Aug 2012 20:14:43 +0000"  >&lt;p&gt;Yep - I&apos;ve confirmed that the expected outputs of the &quot;testComparators&quot; tests do not agree with an actual MapReduce run. So, I&apos;ll fix these tests and commit the patch in this morning unless anyone has objections. &lt;/p&gt;</comment>
                            <comment id="13427586" author="brocknoland" created="Thu, 2 Aug 2012 20:32:11 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13427935" author="dbeech" created="Fri, 3 Aug 2012 09:41:51 +0000"  >&lt;p&gt;Thanks Brock. Committed in 1368848&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12538841" name="MRUNIT-127.patch" size="11162" author="dbeech" created="Wed, 1 Aug 2012 22:12:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>294565</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 16 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0y6nr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>197548</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>