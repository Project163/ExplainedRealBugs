<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:41:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MRUNIT-165] MapReduceDriver calls Mapper#cleanup for each input instead of once</title>
                <link>https://issues.apache.org/jira/browse/MRUNIT-165</link>
                <project id="12311292" key="MRUNIT">MRUnit</project>
                    <description>&lt;p&gt;MapReduceDriver calls the Mapper#run method for each input, causing the Mapper#cleanup method to be called multiple times. &lt;/p&gt;

&lt;p&gt;I believe this is a bug, since the contract in MapReduce is that, for a single Mapper instance, the Mapper#cleanup method is only called once after all inputs to that mapper have been processed. I might be mistaken in my assumption here.&lt;/p&gt;

&lt;p&gt;This would not be an issue, were it not for the fact that MapReduceDriver has only a single instance of Mapper.&lt;/p&gt;

&lt;p&gt;One solution might be to pass the Mapper &lt;em&gt;class&lt;/em&gt; into the MapReduceDriver and create a new instance for each input. Another solution might be to call the MapDriver with multiple inputs (which AFAIK is not possible).&lt;/p&gt;

&lt;p&gt;See attached patch for an example of a stateful mapper and a test which fails due to the bug.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12618345">MRUNIT-165</key>
            <summary>MapReduceDriver calls Mapper#cleanup for each input instead of once</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dbeech">Dave Beech</assignee>
                                    <reporter username="bmesh">Yoni Ben-Meshulam</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Nov 2012 17:31:57 +0000</created>
                <updated>Wed, 5 Dec 2012 23:38:40 +0000</updated>
                            <resolved>Tue, 4 Dec 2012 10:10:46 +0000</resolved>
                                    <version>0.9.0</version>
                                    <fixVersion>1.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13507706" author="dbeech" created="Fri, 30 Nov 2012 22:11:25 +0000"  >&lt;p&gt;Hi Yoni - could you please post your unit test code that exhibits this bug? I think this may not be a problem any longer since we now support multiple inputs, but I&apos;d like to run your test again using the latest code to make sure. Thanks!&lt;/p&gt;</comment>
                            <comment id="13508858" author="bmesh" created="Mon, 3 Dec 2012 17:05:11 +0000"  >&lt;p&gt;Attaching a simple stateful mapper and a test which fails due to the bug in MapReduceDriver.&lt;/p&gt;</comment>
                            <comment id="13509635" author="dbeech" created="Tue, 4 Dec 2012 10:10:46 +0000"  >&lt;p&gt;Thanks for the patch. I&apos;ve confirmed the test does fail against the 0.9.0 code but it passes on trunk. The recent multiple inputs changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/MRUNIT-64&quot; title=&quot;Multiple Input Key, Value Pairs should be supported&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MRUNIT-64&quot;&gt;&lt;del&gt;MRUNIT-64&lt;/del&gt;&lt;/a&gt; seem to have fixed this bug as a side effect.&lt;/p&gt;</comment>
                            <comment id="13509810" author="bmesh" created="Tue, 4 Dec 2012 15:49:22 +0000"  >&lt;p&gt;Awesome. Thanks Dave.&lt;/p&gt;</comment>
                            <comment id="13510918" author="hudson" created="Wed, 5 Dec 2012 23:38:40 +0000"  >&lt;p&gt;Integrated in mrunit-trunk #506 (See &lt;a href=&quot;https://builds.apache.org/job/mrunit-trunk/506/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/mrunit-trunk/506/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MRUNIT-165&quot; title=&quot;MapReduceDriver calls Mapper#cleanup for each input instead of once&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MRUNIT-165&quot;&gt;&lt;del&gt;MRUNIT-165&lt;/del&gt;&lt;/a&gt;: MapReduceDriver calls Mapper#cleanup for each input instead of once (unit test contributed by Yoni Ben-Meshulam) (Revision 92ad229dafea47db18fa978e809d13261721a806)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
dbeech : &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=mrunit.git&amp;amp;a=commit&amp;amp;h=92ad229dafea47db18fa978e809d13261721a806&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=mrunit.git&amp;amp;a=commit&amp;amp;h=92ad229dafea47db18fa978e809d13261721a806&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;src/test/java/org/apache/hadoop/mrunit/mapreduce/StatefulMapper.java&lt;/li&gt;
	&lt;li&gt;src/test/java/org/apache/hadoop/mrunit/mapreduce/TestStatefulMapReduce.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12544155">MRUNIT-64</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12555786" name="reproduce_MRUNIT-165.patch" size="3050" author="bmesh" created="Mon, 3 Dec 2012 17:08:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>293006</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 50 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0srbb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>165902</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>