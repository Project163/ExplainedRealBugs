<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:41:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MRUNIT-114] should support calling configure on sorting and grouping comparators if applicable</title>
                <link>https://issues.apache.org/jira/browse/MRUNIT-114</link>
                <project id="12311292" key="MRUNIT">MRUnit</project>
                    <description>&lt;p&gt;From Jacob Metcalf:&lt;/p&gt;

&lt;p&gt;On another subject (maybe I need a new thread/JIRA for this) is it intentional that the configuration is not applied to the sorting and grouping comparators?&lt;br/&gt;
I am writing my own multiple input MR driver to test a reduce side join and had to do:&lt;br/&gt;
            // Configure grouping and sorting comparators&lt;br/&gt;
   if (keyGroupComparator instanceof Configured ) &lt;/p&gt;
{
       ((Configured)keyGroupComparator).setConf( configuration );
   }
&lt;p&gt;   if (keyValueOrderComparator instanceof Configured) &lt;/p&gt;
{
       ((Configured)keyValueOrderComparator).setConf( configuration );
   }
&lt;p&gt;To get the config applied even though they are Configured objects.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12558526">MRUNIT-114</key>
            <summary>should support calling configure on sorting and grouping comparators if applicable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdonofrio">Jim Donofrio</assignee>
                                    <reporter username="jacobmetcalf">Jacob Metcalf</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 May 2012 02:24:29 +0000</created>
                <updated>Sat, 6 Oct 2012 10:48:11 +0000</updated>
                            <resolved>Sun, 30 Sep 2012 16:29:47 +0000</resolved>
                                                    <fixVersion>1.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13285346" author="jdonofrio" created="Wed, 30 May 2012 02:31:45 +0000"  >&lt;p&gt;We fail to use ReflectionUtils.newInstance on the 2 comparators, it would be better if most of these classes only took classes as input instead of the actual object&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  public void setKeyGroupingComparator(
      final RawComparator&amp;lt;K2&amp;gt; groupingComparator) {
    keyGroupComparator = ReflectionUtils.newInstance(returnNonNull(groupingComparator).getClass(), getConfiguration());
  }

  public void setKeyOrderComparator(final RawComparator&amp;lt;K2&amp;gt; orderComparator) {
    keyValueOrderComparator = ReflectionUtils.newInstance(returnNonNull(orderComparator), getConfiguration());
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13285348" author="jdonofrio" created="Wed, 30 May 2012 02:39:56 +0000"  >&lt;p&gt;I think in the future we should get rid of all of these etKeyGroupingComparator type of methods and solely use the jobconf&lt;/p&gt;

&lt;p&gt;Any thoughts?&lt;/p&gt;</comment>
                            <comment id="13285642" author="jdonofrio" created="Wed, 30 May 2012 13:13:24 +0000"  >&lt;p&gt;Jacob,&lt;/p&gt;

&lt;p&gt;You should not have to call setConf anymore&lt;/p&gt;

&lt;p&gt;checked in 1344239&lt;/p&gt;</comment>
                            <comment id="13294522" author="dbeech" created="Wed, 13 Jun 2012 15:30:43 +0000"  >&lt;p&gt;Hi Jim - I&apos;m working with the KeyFieldBasedComparator at the moment and I&apos;ve found a couple more issues you might need to consider. &lt;/p&gt;

&lt;p&gt;1. Because the shuffle method in MapReduceDriverBase calls the key ordering comparator using compare(Object,Object), it does not call the correct method on classes which only override and do all the work in compare(byte[] b1, int s1, int l1, byte[] b2, int s2, int l2), like KeyFieldBasedComparator. &lt;/p&gt;

&lt;p&gt;It might be better to check whether the two keys are BinaryComparable, casting, and calling this method if possible. Even if a user&apos;s comparator doesn&apos;t override it, the default implementation of this in WritableComparator would still be OK. &lt;/p&gt;

&lt;p&gt;2. KeyFieldBasedComparator doesn&apos;t get configured properly even after the change in 1344239, because ReflectionUtils.newInstance requires the provided config to be a JobConf in order for it to call the configure method on a JobConfigurable object. Of course, the trouble is that simply wrapping getConfiguration as new JobConf(getConfiguration()) isn&apos;t a great thing to do as MapReduceDriverBase is shared by the mapreduce api version... &lt;/p&gt;



</comment>
                            <comment id="13294533" author="dbeech" created="Wed, 13 Jun 2012 15:44:53 +0000"  >&lt;p&gt;This one just caught me out also. Because of the fact that ReflectionUtils.newInstance is called at the time you call the setter, rather than at test run time, it&apos;s important to call set/withConfiguration &lt;b&gt;before&lt;/b&gt; calling set/withKeyGroupingComparator or set/withKeyOrderingComparator, otherwise the custom config parameters won&apos;t get used. &lt;/p&gt;</comment>
                            <comment id="13466513" author="jdonofrio" created="Sun, 30 Sep 2012 16:29:20 +0000"  >&lt;p&gt;Dave,&lt;/p&gt;

&lt;p&gt;1. I will create a new JIRA.&lt;/p&gt;

&lt;p&gt;2.  I did not believe that this is a problem, if you are using the mapreduce api then you should be using the mapreduce org.apache.hadoop.mapreduce.lib.partition.KeyFieldBasedComparator which implements Configurable&lt;/p&gt;</comment>
                            <comment id="13466515" author="jdonofrio" created="Sun, 30 Sep 2012 16:31:36 +0000"  >&lt;p&gt;I do not believe that #1 should be a blocker for 1.0.0&lt;/p&gt;</comment>
                            <comment id="13466516" author="jdonofrio" created="Sun, 30 Sep 2012 16:35:37 +0000"  >&lt;p&gt;created &lt;a href=&quot;https://issues.apache.org/jira/browse/MRUNIT-154&quot; title=&quot;shuffle in MapReduceDriverBase does not support comparators that only override compare(byte[] b1, int s1, int l1, byte[] b2, int s2, int l2)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MRUNIT-154&quot;&gt;MRUNIT-154&lt;/a&gt; for issue #1&lt;/p&gt;</comment>
                            <comment id="13466698" author="dbeech" created="Mon, 1 Oct 2012 08:45:08 +0000"  >&lt;p&gt;Cheers Jim. I wasn&apos;t aware of the new mapreduce api KeyFieldBasedComparator - thanks for pointing that out. I think the problem still applies to the old mapred API though so I&apos;ll create a new JIRA for this too. I agree that none of these issues should block 1.0.0. &lt;/p&gt;</comment>
                            <comment id="13466828" author="jdonofrio" created="Mon, 1 Oct 2012 14:18:11 +0000"  >&lt;p&gt;Just to clarify, are you saying that the mapred KeyFieldBasedComparator will only get configured with a JobConf object and not a Configuration object? I guess we could work around that but hadoop will act the same way but if you are using mapred, hadoop forces you to submit JobConf at some point, maybe we should do the same?&lt;/p&gt;</comment>
                            <comment id="13466844" author="dbeech" created="Mon, 1 Oct 2012 14:38:28 +0000"  >&lt;p&gt;That&apos;s correct, because the mapred api KeyFieldBasedComparator is JobConfigurable instead of Configurable. It will only be configured with a JobConf, not a plain Configuration. &lt;/p&gt;

&lt;p&gt;When I first noticed this I was hesitant to use JobConf anywhere for the new mapreduce API version of our test runners, but from looking through Hadoop source I see that JobConf is actually used pretty much everywhere internally. It&apos;s just no longer used by the client when setting up a job.  &lt;/p&gt;</comment>
                            <comment id="13470973" author="dbeech" created="Sat, 6 Oct 2012 10:48:11 +0000"  >&lt;p&gt;Created &lt;a href=&quot;https://issues.apache.org/jira/browse/MRUNIT-155&quot; title=&quot;KeyFieldBasedComparator (mapred API) does not get configured properly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MRUNIT-155&quot;&gt;MRUNIT-155&lt;/a&gt; for this second issue&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>244195</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 7 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05jmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30276</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>