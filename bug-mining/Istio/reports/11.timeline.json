[{"url":"https://api.github.com/repos/istio/istio/issues/comments/2569581686","html_url":"https://github.com/istio/istio/issues/54544#issuecomment-2569581686","issue_url":"https://api.github.com/repos/istio/istio/issues/54544","id":2569581686,"node_id":"IC_kwDOBGvVPc6ZKLR2","user":{"login":"howardjohn","id":623453,"node_id":"MDQ6VXNlcjYyMzQ1Mw==","avatar_url":"https://avatars.githubusercontent.com/u/623453?v=4","gravatar_id":"","url":"https://api.github.com/users/howardjohn","html_url":"https://github.com/howardjohn","followers_url":"https://api.github.com/users/howardjohn/followers","following_url":"https://api.github.com/users/howardjohn/following{/other_user}","gists_url":"https://api.github.com/users/howardjohn/gists{/gist_id}","starred_url":"https://api.github.com/users/howardjohn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/howardjohn/subscriptions","organizations_url":"https://api.github.com/users/howardjohn/orgs","repos_url":"https://api.github.com/users/howardjohn/repos","events_url":"https://api.github.com/users/howardjohn/events{/privacy}","received_events_url":"https://api.github.com/users/howardjohn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T17:31:34Z","updated_at":"2025-01-03T17:31:34Z","body":"CNI logs:\r\n\r\n<details> \r\n\r\n```\r\n2025-01-03T17:27:40.509788Z\tinfo\tcni-agent\tCNI logging level: info\r\n2025-01-03T17:27:40.509823Z\tinfo\tcni-agent\tCNI install configuration: \r\n2025-01-03T17:27:40.509833Z\tinfo\tcni-agent\tCNI race repair configuration: \r\n2025-01-03T17:27:40.509825Z\tinfo\tControlZ available at 127.0.0.1:9876\r\n2025-01-03T17:27:40.510151Z\tinfo\tcni-agent\tStarting ambient node agent with inpod redirect mode on socket /var/run/istio-cni/pluginevent.sock\r\n2025-01-03T17:27:40.523413Z\tinfo\tcni-agent\tconfiguring host-level iptables rules (healthchecks, etc)\r\n2025-01-03T17:27:40.523506Z\tinfo\tcni-agent\tRunning command (with global lock): iptables-legacy -t nat -D POSTROUTING -j ISTIO_POSTRT --wait=30\tcomponent=host\r\n2025-01-03T17:27:40.524473Z\tinfo\tcni-agent\tRunning command (with global lock): iptables-legacy -t nat -F ISTIO_POSTRT --wait=30\tcomponent=host\r\n2025-01-03T17:27:40.525530Z\tinfo\tcni-agent\tRunning command (with global lock): iptables-legacy -t nat -X ISTIO_POSTRT --wait=30\tcomponent=host\r\n2025-01-03T17:27:40.526183Z\tinfo\tcni-agent\tRunning command (with global lock): ip6tables-legacy -t nat -D POSTROUTING -j ISTIO_POSTRT --wait=30\tcomponent=host\r\n2025-01-03T17:27:40.526924Z\tinfo\tcni-agent\tRunning command (with global lock): ip6tables-legacy -t nat -F ISTIO_POSTRT --wait=30\tcomponent=host\r\n2025-01-03T17:27:40.527518Z\tinfo\tcni-agent\tRunning command (with global lock): ip6tables-legacy -t nat -X ISTIO_POSTRT --wait=30\tcomponent=host\r\n2025-01-03T17:27:40.527924Z\tinfo\tcni-agent\tconfiguring host-level iptables rules (healthchecks, etc)\r\n2025-01-03T17:27:40.527933Z\tinfo\tcni-agent\tAdding host netnamespace iptables rules\r\n2025-01-03T17:27:40.527973Z\tinfo\tcni-agent\tRunning command (without lock): iptables-legacy-save \tcomponent=host\r\n2025-01-03T17:27:40.529318Z\tinfo\tcni-agent\tFound residues of old iptables rules/chains, reconciliation is recommended\tcomponent=host\r\n2025-01-03T17:27:40.529324Z\twarn\tcni-agent\treconcile is needed but no-reconcile flag is set. Unexpected behavior may occur due to preexisting iptables rules\tcomponent=host\r\n2025-01-03T17:27:40.529326Z\tinfo\tcni-agent\tApplying iptables chains and rules\tcomponent=host\r\n2025-01-03T17:27:40.529334Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:27:40.529361Z\tinfo\tcni-agent\tRunning command (with global lock): iptables-legacy-restore --noflush -v --wait=30\tcomponent=host\r\n2025-01-03T17:27:40.530547Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:27:40.530612Z\tinfo\tcni-agent\tRunning command (with global lock): ip6tables-legacy-restore --noflush -v --wait=30\tcomponent=host\r\n2025-01-03T17:27:40.532091Z\tinfo\tcni-agent\tstarting listener for CNI plugin events at /var/run/istio-cni/pluginevent.sock\r\n2025-01-03T17:27:40.532151Z\tinfo\tcni-agent\tCNI ambient server starting\r\n2025-01-03T17:27:40.532185Z\tinfo\tcluster \"\" kube client started\r\n2025-01-03T17:27:40.632343Z\tinfo\tcni-agent\tCNI ambient server kubeclient started\r\n2025-01-03T17:27:40.634564Z\tinfo\tcni-agent\tCNI ambient server marking ready\r\n2025-01-03T17:27:40.634585Z\tinfo\tcni-agent\tAmbient node agent started, starting installer...\r\n2025-01-03T17:27:40.634587Z\tinfo\tcni-agent\tstarting CNI sidecar repair controller\r\n2025-01-03T17:27:40.634696Z\tinfo\tcontrollers\tstarting\tcontroller=ambient\r\n2025-01-03T17:27:40.634754Z\tinfo\tcni-agent\tNamespace default is enabled in ambient mesh\r\n2025-01-03T17:27:40.634793Z\tinfo\tcni-agent\tNamespace istio-system is disabled from ambient mesh\r\n2025-01-03T17:27:40.634806Z\tinfo\tcni-agent\tNamespace kube-node-lease is disabled from ambient mesh\r\n2025-01-03T17:27:40.634811Z\tinfo\tcni-agent\tNamespace kube-public is disabled from ambient mesh\r\n2025-01-03T17:27:40.634815Z\tinfo\tcni-agent\tNamespace kube-system is disabled from ambient mesh\r\n2025-01-03T17:27:40.634824Z\tinfo\tcni-agent\tNamespace local-path-storage is disabled from ambient mesh\r\n2025-01-03T17:27:40.634828Z\tinfo\tcni-agent\tNamespace metallb-system is disabled from ambient mesh\r\n2025-01-03T17:27:40.635169Z\tinfo\tcluster \"\" kube client started\r\n2025-01-03T17:27:40.642314Z\tinfo\tcontrollers\tstarting\tcontroller=repair pods\r\n2025-01-03T17:27:40.735645Z\tinfo\tcni-agent\tinitialization complete, watching node CNI dir\r\n2025-01-03T17:27:40.782199Z\tinfo\tcni-agent\tCopied istio-cni to /host/opt/cni/bin\r\n2025-01-03T17:27:40.782906Z\tinfo\tcni-agent\twrote kubeconfig file /var/run/istio-cni/istio-cni-kubeconfig with: \r\n2025-01-03T17:27:40.783312Z\tinfo\tcni-agent\tconfiguration requires updates, (re)writing CNI config file at \"\": CNI config file \"\" preempted by \"/host/etc/cni/net.d/10-kindnet.conflist\"\r\n2025-01-03T17:27:40.783684Z\tinfo\tcni-agent\tcreated CNI config /host/etc/cni/net.d/10-kindnet.conflist\r\n2025-01-03T17:27:40.783689Z\tinfo\tcni-agent\tinitial installation complete, start watching for re-installation\r\n2025-01-03T17:27:41.615118Z\tinfo\tcni-plugin\texcluded istio-system/ztunnel-nk52h pod because it has proxy type ztunnel\tpod=istio-system/ztunnel-nk52h\r\n2025-01-03T17:27:41.766618Z\tinfo\tcni-agent\treceived hello from ztunnel\tversion=V1\r\n2025-01-03T17:27:41.771421Z\tinfo\tcni-agent\treceived hello from ztunnel\tversion=V1\r\n2025-01-03T17:27:53.951443Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:53.951892Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:53.952885Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:53.953434Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:53.953448Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:53.953490Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:27:53.953515Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:53.956359Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:27:53.956387Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:53.957721Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:53.961642Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:53.961657Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:53.961857Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:53.961900Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:27:53.961913Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:27:54.950042Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:54.950521Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:54.951388Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:54.952126Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:54.952129Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:54.952147Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:27:54.952158Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:54.953295Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:27:54.953324Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:54.954206Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:54.957373Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:54.957385Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:54.957537Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:27:54.957575Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:27:54.957585Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:28:05.966162Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:05.966943Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:05.967934Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:05.968559Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:05.968568Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:05.968603Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:28:05.968622Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:05.970429Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:28:05.970455Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:05.971906Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:05.975746Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:05.975762Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:05.975906Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:05.975947Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:28:05.975962Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:28:17.964667Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:17.965453Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:17.966633Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:17.967960Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:17.968021Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:17.968177Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:28:17.968264Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:17.972813Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:28:17.972907Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:17.976166Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:17.980551Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:17.980571Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:17.980748Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:17.980781Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:28:17.980791Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:28:31.963363Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:31.964112Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:31.965149Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:31.965950Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:31.965956Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:31.965985Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:28:31.966009Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:31.967894Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:28:31.967916Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:31.969444Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:31.973227Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:31.973249Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:31.974133Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:31.974177Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:28:31.974190Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:28:46.962328Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:46.962959Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:46.963975Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:46.964720Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:46.964731Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:46.964828Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:28:46.965909Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:46.971924Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:28:46.972027Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:46.974393Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:46.978273Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:46.978286Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:46.978485Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:46.978522Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:28:46.978533Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:28:58.962712Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:58.963259Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:58.964300Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:58.965001Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:58.965009Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:58.965041Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:28:58.965069Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:58.966703Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:28:58.966738Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:58.968256Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:58.971741Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:58.971757Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:58.971954Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:28:58.971998Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:28:58.972011Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:29:09.954657Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:09.955288Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:09.956223Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:09.957115Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:09.957121Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:09.957144Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:29:09.957161Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:09.958499Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:29:09.958523Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:09.959650Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:09.962733Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:09.962744Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:09.962912Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:09.962947Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:29:09.962962Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:29:24.960706Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:24.961381Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:24.962512Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:24.963209Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:24.963217Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:24.963249Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:29:24.963266Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:24.965037Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:29:24.965066Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:24.966582Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:24.970756Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:24.970774Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:24.970912Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:24.970966Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:29:24.970980Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:29:39.964389Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:39.964914Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:39.965963Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:39.966682Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:39.966688Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:39.966729Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:29:39.966747Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:39.968266Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:29:39.968293Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:39.970104Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:39.973625Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:39.973640Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:39.973812Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:39.973853Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:29:39.973865Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:29:50.967064Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:50.967765Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:50.968978Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:50.969694Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:50.969703Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:50.969738Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:29:50.969760Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:50.971273Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:29:50.971300Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:50.972660Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:50.976276Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:50.976292Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:50.976492Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:29:50.976540Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:29:50.976552Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:30:03.954849Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:03.955499Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:03.956498Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:03.957156Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:03.957164Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:03.957192Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:30:03.957214Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:03.958827Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:30:03.958856Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:03.960552Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:03.963933Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:03.963947Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:03.964103Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:03.964156Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:30:03.964172Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:30:16.963682Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:16.964368Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:16.965322Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:16.967012Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:16.967081Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:16.967297Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:30:16.967399Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:16.971204Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:30:16.971233Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:16.973302Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:16.977525Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:16.977535Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:16.977742Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:16.977792Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:30:16.977804Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:30:27.964674Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:27.966426Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:27.968737Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:27.969741Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:27.969751Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:27.969786Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:30:27.969804Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:27.972618Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:30:27.972676Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:27.975739Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:27.981163Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:27.981195Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:27.981771Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:27.981827Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:30:27.981843Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:30:38.974611Z\tinfo\tcni-agent\tadding pod to the mesh\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:38.975172Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): iptables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:38.976644Z\tinfo\tcni-agent\tRunning command (sandboxed without lock): ip6tables-legacy-save \tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:38.978954Z\tinfo\tcni-agent\tClean-state detected, new iptables are needed\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:38.978968Z\tinfo\tcni-agent\tApplying iptables chains and rules\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:38.979028Z\tinfo\tcni-agent\tRunning iptables-legacy-restore with the following input:\r\n2025-01-03T17:30:38.979055Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): iptables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:38.982613Z\tinfo\tcni-agent\tRunning ip6tables-legacy-restore with the following input:\r\n2025-01-03T17:30:38.982650Z\tinfo\tcni-agent\tRunning command (sandboxed local lock by env and nss): ip6tables-legacy-restore --noflush -v --wait=30\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:38.984880Z\terror\tcni-agent\tfailed to add pod to ztunnel: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:38.989706Z\terror\tcni-agent\tpod was not enrolled and is unhealthy: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:38.989719Z\terror\tcni-agent\tfailed to handle add event: partial add error: no ztunnel connection\tns=default name=shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:38.989919Z\terror\tcni-plugin\tistio-cni cmdAdd failed to signal node Istio CNI agent: unable to push CNI event (status code 500): partial add error: no ztunnel connection\tpod=default/shell-5b7cf9f6c4-l5nh9\r\n2025-01-03T17:30:38.989963Z\terror\tcni-plugin\tistio-cni cmdAdd error: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n2025-01-03T17:30:38.989979Z\terror\tcni-plugin\tistio-cni failed with: unable to push CNI event (status code 500): partial add error: no ztunnel connection\r\n```\r\n</details>","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/istio/istio/issues/comments/2569581686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"howardjohn","id":623453,"node_id":"MDQ6VXNlcjYyMzQ1Mw==","avatar_url":"https://avatars.githubusercontent.com/u/623453?v=4","gravatar_id":"","url":"https://api.github.com/users/howardjohn","html_url":"https://github.com/howardjohn","followers_url":"https://api.github.com/users/howardjohn/followers","following_url":"https://api.github.com/users/howardjohn/following{/other_user}","gists_url":"https://api.github.com/users/howardjohn/gists{/gist_id}","starred_url":"https://api.github.com/users/howardjohn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/howardjohn/subscriptions","organizations_url":"https://api.github.com/users/howardjohn/orgs","repos_url":"https://api.github.com/users/howardjohn/repos","events_url":"https://api.github.com/users/howardjohn/events{/privacy}","received_events_url":"https://api.github.com/users/howardjohn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/istio/istio/issues/comments/2569582045","html_url":"https://github.com/istio/istio/issues/54544#issuecomment-2569582045","issue_url":"https://api.github.com/repos/istio/istio/issues/54544","id":2569582045,"node_id":"IC_kwDOBGvVPc6ZKLXd","user":{"login":"howardjohn","id":623453,"node_id":"MDQ6VXNlcjYyMzQ1Mw==","avatar_url":"https://avatars.githubusercontent.com/u/623453?v=4","gravatar_id":"","url":"https://api.github.com/users/howardjohn","html_url":"https://github.com/howardjohn","followers_url":"https://api.github.com/users/howardjohn/followers","following_url":"https://api.github.com/users/howardjohn/following{/other_user}","gists_url":"https://api.github.com/users/howardjohn/gists{/gist_id}","starred_url":"https://api.github.com/users/howardjohn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/howardjohn/subscriptions","organizations_url":"https://api.github.com/users/howardjohn/orgs","repos_url":"https://api.github.com/users/howardjohn/repos","events_url":"https://api.github.com/users/howardjohn/events{/privacy}","received_events_url":"https://api.github.com/users/howardjohn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T17:31:56Z","updated_at":"2025-01-03T17:31:56Z","body":"Ztunnel logs\r\n\r\n<details>\r\n\r\n```\r\n2025-01-03T17:27:41.762009Z     info    hyper_util      listener established    address=[::]:15021 component=\"readiness\"\r\n2025-01-03T17:27:41.762015Z     info    app     shared proxy mode - in-pod mode enabled\r\n2025-01-03T17:27:41.762047Z     info    hyper_util      listener established    address=127.0.0.1:15000 component=\"admin\"\r\n2025-01-03T17:27:41.762056Z     info    hyper_util      listener established    address=[::]:15020 component=\"stats\"\r\n2025-01-03T17:27:41.762060Z     info    readiness       Task 'dns proxy' complete (775.113µs), still awaiting 3 tasks\r\n2025-01-03T17:27:41.762062Z     info    readiness       Task 'proxy' complete (777.237µs), still awaiting 2 tasks\r\n2025-01-03T17:27:41.766237Z     info    xds::client:xds{id=1}   Stream established\r\n2025-01-03T17:27:41.766265Z     info    xds::client:xds{id=1}   received response       type_url=\"type.googleapis.com/istio.workload.Address\" size=22 removes=0\r\n2025-01-03T17:27:41.766343Z     info    xds::client:xds{id=1}   received response       type_url=\"type.googleapis.com/istio.security.Authorization\" size=0 removes=0\r\n2025-01-03T17:27:41.766354Z     info    readiness       Task 'state manager' complete (5.069218ms), still awaiting 1 tasks\r\n2025-01-03T17:27:41.766400Z     info    inpod::workloadmanager  handling new stream\r\n2025-01-03T17:27:41.767014Z     info    inpod::statemanager     received snapshot sent\r\n2025-01-03T17:27:41.767021Z     info    readiness       Task 'workload proxy manager' complete (5.735916ms), marking server ready\r\n2025-01-03T17:27:41.996832Z     info    xds::client:xds{id=1}   received response       type_url=\"type.googleapis.com/istio.workload.Address\" size=1 removes=0\r\n2025-01-03T17:27:46.846106Z     info    xds::client:xds{id=1}   received response       type_url=\"type.googleapis.com/istio.workload.Address\" size=0 removes=1\r\n```\r\n</details>","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/istio/istio/issues/comments/2569582045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"howardjohn","id":623453,"node_id":"MDQ6VXNlcjYyMzQ1Mw==","avatar_url":"https://avatars.githubusercontent.com/u/623453?v=4","gravatar_id":"","url":"https://api.github.com/users/howardjohn","html_url":"https://github.com/howardjohn","followers_url":"https://api.github.com/users/howardjohn/followers","following_url":"https://api.github.com/users/howardjohn/following{/other_user}","gists_url":"https://api.github.com/users/howardjohn/gists{/gist_id}","starred_url":"https://api.github.com/users/howardjohn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/howardjohn/subscriptions","organizations_url":"https://api.github.com/users/howardjohn/orgs","repos_url":"https://api.github.com/users/howardjohn/repos","events_url":"https://api.github.com/users/howardjohn/events{/privacy}","received_events_url":"https://api.github.com/users/howardjohn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/istio/istio/issues/comments/2569584847","html_url":"https://github.com/istio/istio/issues/54544#issuecomment-2569584847","issue_url":"https://api.github.com/repos/istio/istio/issues/54544","id":2569584847,"node_id":"IC_kwDOBGvVPc6ZKMDP","user":{"login":"howardjohn","id":623453,"node_id":"MDQ6VXNlcjYyMzQ1Mw==","avatar_url":"https://avatars.githubusercontent.com/u/623453?v=4","gravatar_id":"","url":"https://api.github.com/users/howardjohn","html_url":"https://github.com/howardjohn","followers_url":"https://api.github.com/users/howardjohn/followers","following_url":"https://api.github.com/users/howardjohn/following{/other_user}","gists_url":"https://api.github.com/users/howardjohn/gists{/gist_id}","starred_url":"https://api.github.com/users/howardjohn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/howardjohn/subscriptions","organizations_url":"https://api.github.com/users/howardjohn/orgs","repos_url":"https://api.github.com/users/howardjohn/repos","events_url":"https://api.github.com/users/howardjohn/events{/privacy}","received_events_url":"https://api.github.com/users/howardjohn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T17:34:29Z","updated_at":"2025-01-03T17:34:29Z","body":"I am fairly sure what I did was a rolling restart of ztunnel and CNI at the same time. So we get \r\n\r\n```\r\n2025-01-03T17:27:41.766618Z     info    cni-agent       received hello from ztunnel     version=V1\r\n2025-01-03T17:27:41.771421Z     info    cni-agent       received hello from ztunnel     version=V1\r\n```\r\n\r\n one from old ztunnel and one from new?\r\n\r\nWhile its spamming \"no ztunnel connection\", `ztunnel_connected` reports `1`\r\n\r\nI think this LatestConn thing is broken. Basically it doesn't handle the case of:\r\n\r\n\r\n1. ZT-1 connects\r\n2. ZT-2 connects\r\n3. ZT-2 disconnects\r\n\r\nIt should probably fallback to ZT-1 but it doesn't","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/istio/istio/issues/comments/2569584847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"howardjohn","id":623453,"node_id":"MDQ6VXNlcjYyMzQ1Mw==","avatar_url":"https://avatars.githubusercontent.com/u/623453?v=4","gravatar_id":"","url":"https://api.github.com/users/howardjohn","html_url":"https://github.com/howardjohn","followers_url":"https://api.github.com/users/howardjohn/followers","following_url":"https://api.github.com/users/howardjohn/following{/other_user}","gists_url":"https://api.github.com/users/howardjohn/gists{/gist_id}","starred_url":"https://api.github.com/users/howardjohn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/howardjohn/subscriptions","organizations_url":"https://api.github.com/users/howardjohn/orgs","repos_url":"https://api.github.com/users/howardjohn/repos","events_url":"https://api.github.com/users/howardjohn/events{/privacy}","received_events_url":"https://api.github.com/users/howardjohn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15809736252,"node_id":"AE_lADOBGvVPc6k-0e2zwAAAAOuVW48","url":"https://api.github.com/repos/istio/istio/issues/events/15809736252","actor":{"login":"howardjohn","id":623453,"node_id":"MDQ6VXNlcjYyMzQ1Mw==","avatar_url":"https://avatars.githubusercontent.com/u/623453?v=4","gravatar_id":"","url":"https://api.github.com/users/howardjohn","html_url":"https://github.com/howardjohn","followers_url":"https://api.github.com/users/howardjohn/followers","following_url":"https://api.github.com/users/howardjohn/following{/other_user}","gists_url":"https://api.github.com/users/howardjohn/gists{/gist_id}","starred_url":"https://api.github.com/users/howardjohn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/howardjohn/subscriptions","organizations_url":"https://api.github.com/users/howardjohn/orgs","repos_url":"https://api.github.com/users/howardjohn/repos","events_url":"https://api.github.com/users/howardjohn/events{/privacy}","received_events_url":"https://api.github.com/users/howardjohn/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2025-01-03T17:54:46Z","assignee":{"login":"bleggett","id":854255,"node_id":"MDQ6VXNlcjg1NDI1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/854255?v=4","gravatar_id":"","url":"https://api.github.com/users/bleggett","html_url":"https://github.com/bleggett","followers_url":"https://api.github.com/users/bleggett/followers","following_url":"https://api.github.com/users/bleggett/following{/other_user}","gists_url":"https://api.github.com/users/bleggett/gists{/gist_id}","starred_url":"https://api.github.com/users/bleggett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleggett/subscriptions","organizations_url":"https://api.github.com/users/bleggett/orgs","repos_url":"https://api.github.com/users/bleggett/repos","events_url":"https://api.github.com/users/bleggett/events{/privacy}","received_events_url":"https://api.github.com/users/bleggett/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/istio/istio/issues/comments/2569609780","html_url":"https://github.com/istio/istio/issues/54544#issuecomment-2569609780","issue_url":"https://api.github.com/repos/istio/istio/issues/54544","id":2569609780,"node_id":"IC_kwDOBGvVPc6ZKSI0","user":{"login":"keithmattix","id":1531662,"node_id":"MDQ6VXNlcjE1MzE2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/1531662?v=4","gravatar_id":"","url":"https://api.github.com/users/keithmattix","html_url":"https://github.com/keithmattix","followers_url":"https://api.github.com/users/keithmattix/followers","following_url":"https://api.github.com/users/keithmattix/following{/other_user}","gists_url":"https://api.github.com/users/keithmattix/gists{/gist_id}","starred_url":"https://api.github.com/users/keithmattix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keithmattix/subscriptions","organizations_url":"https://api.github.com/users/keithmattix/orgs","repos_url":"https://api.github.com/users/keithmattix/repos","events_url":"https://api.github.com/users/keithmattix/events{/privacy}","received_events_url":"https://api.github.com/users/keithmattix/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T17:56:13Z","updated_at":"2025-01-03T17:56:56Z","body":"> It should probably fallback to ZT-1 but it doesn't\r\n\r\nYup, here's the problem: https://github.com/istio/istio/blob/e81a5ea0f851e4263954a8a2f52d14b555063073/cni/pkg/nodeagent/ztunnelserver.go#L90. We don't handle the case where there's a conn to fallback to","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/istio/istio/issues/comments/2569609780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"keithmattix","id":1531662,"node_id":"MDQ6VXNlcjE1MzE2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/1531662?v=4","gravatar_id":"","url":"https://api.github.com/users/keithmattix","html_url":"https://github.com/keithmattix","followers_url":"https://api.github.com/users/keithmattix/followers","following_url":"https://api.github.com/users/keithmattix/following{/other_user}","gists_url":"https://api.github.com/users/keithmattix/gists{/gist_id}","starred_url":"https://api.github.com/users/keithmattix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keithmattix/subscriptions","organizations_url":"https://api.github.com/users/keithmattix/orgs","repos_url":"https://api.github.com/users/keithmattix/repos","events_url":"https://api.github.com/users/keithmattix/events{/privacy}","received_events_url":"https://api.github.com/users/keithmattix/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15830088731,"node_id":"REFE_lADOBGvVPc6k-0e2zwAAAAOvi_wb","url":"https://api.github.com/repos/istio/istio/issues/events/15830088731","actor":{"login":"bleggett","id":854255,"node_id":"MDQ6VXNlcjg1NDI1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/854255?v=4","gravatar_id":"","url":"https://api.github.com/users/bleggett","html_url":"https://github.com/bleggett","followers_url":"https://api.github.com/users/bleggett/followers","following_url":"https://api.github.com/users/bleggett/following{/other_user}","gists_url":"https://api.github.com/users/bleggett/gists{/gist_id}","starred_url":"https://api.github.com/users/bleggett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleggett/subscriptions","organizations_url":"https://api.github.com/users/bleggett/orgs","repos_url":"https://api.github.com/users/bleggett/repos","events_url":"https://api.github.com/users/bleggett/events{/privacy}","received_events_url":"https://api.github.com/users/bleggett/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"cf990e74d28251055a761b82e9c224893c850ed2","commit_url":"https://api.github.com/repos/bleggett/istio/commits/cf990e74d28251055a761b82e9c224893c850ed2","created_at":"2025-01-06T19:30:13Z","performed_via_github_app":null},{"actor":{"login":"bleggett","id":854255,"node_id":"MDQ6VXNlcjg1NDI1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/854255?v=4","gravatar_id":"","url":"https://api.github.com/users/bleggett","html_url":"https://github.com/bleggett","followers_url":"https://api.github.com/users/bleggett/followers","following_url":"https://api.github.com/users/bleggett/following{/other_user}","gists_url":"https://api.github.com/users/bleggett/gists{/gist_id}","starred_url":"https://api.github.com/users/bleggett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleggett/subscriptions","organizations_url":"https://api.github.com/users/bleggett/orgs","repos_url":"https://api.github.com/users/bleggett/repos","events_url":"https://api.github.com/users/bleggett/events{/privacy}","received_events_url":"https://api.github.com/users/bleggett/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-06T19:34:26Z","updated_at":"2025-01-06T19:34:26Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/istio/istio/issues/54565","repository_url":"https://api.github.com/repos/istio/istio","labels_url":"https://api.github.com/repos/istio/istio/issues/54565/labels{/name}","comments_url":"https://api.github.com/repos/istio/istio/issues/54565/comments","events_url":"https://api.github.com/repos/istio/istio/issues/54565/events","html_url":"https://github.com/istio/istio/pull/54565","id":2771306842,"node_id":"PR_kwDOBGvVPc6G23N4","number":54565,"title":"Handle out-of-order ztunnel connection removals correctly.","user":{"login":"bleggett","id":854255,"node_id":"MDQ6VXNlcjg1NDI1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/854255?v=4","gravatar_id":"","url":"https://api.github.com/users/bleggett","html_url":"https://github.com/bleggett","followers_url":"https://api.github.com/users/bleggett/followers","following_url":"https://api.github.com/users/bleggett/following{/other_user}","gists_url":"https://api.github.com/users/bleggett/gists{/gist_id}","starred_url":"https://api.github.com/users/bleggett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleggett/subscriptions","organizations_url":"https://api.github.com/users/bleggett/orgs","repos_url":"https://api.github.com/users/bleggett/repos","events_url":"https://api.github.com/users/bleggett/events{/privacy}","received_events_url":"https://api.github.com/users/bleggett/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1448953239,"node_id":"MDU6TGFiZWwxNDQ4OTUzMjM5","url":"https://api.github.com/repos/istio/istio/labels/size/L","name":"size/L","color":"77bb00","default":false,"description":"Denotes a PR that changes 100-499 lines, ignoring generated files."},{"id":2492029384,"node_id":"MDU6TGFiZWwyNDkyMDI5Mzg0","url":"https://api.github.com/repos/istio/istio/labels/area/upgrade","name":"area/upgrade","color":"0e8a16","default":false,"description":"Issues related to upgrades"},{"id":4512074651,"node_id":"LA_kwDOBGvVPc8AAAABDPDLmw","url":"https://api.github.com/repos/istio/istio/labels/area/ambient","name":"area/ambient","color":"0e8a16","default":false,"description":"Issues related to ambient mesh"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2025-01-06T19:33:46Z","updated_at":"2025-01-06T22:45:02Z","closed_at":"2025-01-06T22:04:01Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":74175805,"node_id":"MDEwOlJlcG9zaXRvcnk3NDE3NTgwNQ==","name":"istio","full_name":"istio/istio","private":false,"owner":{"login":"istio","id":23534644,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIzNTM0NjQ0","avatar_url":"https://avatars.githubusercontent.com/u/23534644?v=4","gravatar_id":"","url":"https://api.github.com/users/istio","html_url":"https://github.com/istio","followers_url":"https://api.github.com/users/istio/followers","following_url":"https://api.github.com/users/istio/following{/other_user}","gists_url":"https://api.github.com/users/istio/gists{/gist_id}","starred_url":"https://api.github.com/users/istio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/istio/subscriptions","organizations_url":"https://api.github.com/users/istio/orgs","repos_url":"https://api.github.com/users/istio/repos","events_url":"https://api.github.com/users/istio/events{/privacy}","received_events_url":"https://api.github.com/users/istio/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/istio/istio","description":"Connect, secure, control, and observe services.","fork":false,"url":"https://api.github.com/repos/istio/istio","forks_url":"https://api.github.com/repos/istio/istio/forks","keys_url":"https://api.github.com/repos/istio/istio/keys{/key_id}","collaborators_url":"https://api.github.com/repos/istio/istio/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/istio/istio/teams","hooks_url":"https://api.github.com/repos/istio/istio/hooks","issue_events_url":"https://api.github.com/repos/istio/istio/issues/events{/number}","events_url":"https://api.github.com/repos/istio/istio/events","assignees_url":"https://api.github.com/repos/istio/istio/assignees{/user}","branches_url":"https://api.github.com/repos/istio/istio/branches{/branch}","tags_url":"https://api.github.com/repos/istio/istio/tags","blobs_url":"https://api.github.com/repos/istio/istio/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/istio/istio/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/istio/istio/git/refs{/sha}","trees_url":"https://api.github.com/repos/istio/istio/git/trees{/sha}","statuses_url":"https://api.github.com/repos/istio/istio/statuses/{sha}","languages_url":"https://api.github.com/repos/istio/istio/languages","stargazers_url":"https://api.github.com/repos/istio/istio/stargazers","contributors_url":"https://api.github.com/repos/istio/istio/contributors","subscribers_url":"https://api.github.com/repos/istio/istio/subscribers","subscription_url":"https://api.github.com/repos/istio/istio/subscription","commits_url":"https://api.github.com/repos/istio/istio/commits{/sha}","git_commits_url":"https://api.github.com/repos/istio/istio/git/commits{/sha}","comments_url":"https://api.github.com/repos/istio/istio/comments{/number}","issue_comment_url":"https://api.github.com/repos/istio/istio/issues/comments{/number}","contents_url":"https://api.github.com/repos/istio/istio/contents/{+path}","compare_url":"https://api.github.com/repos/istio/istio/compare/{base}...{head}","merges_url":"https://api.github.com/repos/istio/istio/merges","archive_url":"https://api.github.com/repos/istio/istio/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/istio/istio/downloads","issues_url":"https://api.github.com/repos/istio/istio/issues{/number}","pulls_url":"https://api.github.com/repos/istio/istio/pulls{/number}","milestones_url":"https://api.github.com/repos/istio/istio/milestones{/number}","notifications_url":"https://api.github.com/repos/istio/istio/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/istio/istio/labels{/name}","releases_url":"https://api.github.com/repos/istio/istio/releases{/id}","deployments_url":"https://api.github.com/repos/istio/istio/deployments","created_at":"2016-11-18T23:57:21Z","updated_at":"2025-11-09T09:48:40Z","pushed_at":"2025-11-09T03:44:39Z","git_url":"git://github.com/istio/istio.git","ssh_url":"git@github.com:istio/istio.git","clone_url":"https://github.com/istio/istio.git","svn_url":"https://github.com/istio/istio","homepage":"https://istio.io","size":287980,"stargazers_count":37606,"watchers_count":37606,"language":"Go","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":8122,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":492,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["api-management","circuit-breaker","consul","enforce-policies","envoy","fault-injection","kubernetes","lyft-envoy","microservice","microservices","nomad","polyglot-microservices","proxies","request-routing","resiliency","service-mesh"],"visibility":"public","forks":8122,"open_issues":492,"watchers":37606,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/istio/istio/pulls/54565","html_url":"https://github.com/istio/istio/pull/54565","diff_url":"https://github.com/istio/istio/pull/54565.diff","patch_url":"https://github.com/istio/istio/pull/54565.patch","merged_at":"2025-01-06T22:04:01Z"},"body":"**Please provide a description of this PR:**\r\n\r\nI had actually fixed this in passing ages ago in internal builds as part of unrelated work, but forgot to backport when that work was dropped.\r\n\r\nShould fix https://github.com/istio/istio/issues/54544 and (I bet) https://github.com/istio/istio/issues/53843\r\n\r\nMoves ztunnel conns to an ordered slice so we can keep track of what the \"previous\" connection was and revert back to that, if we happen to get out-of-order `deleteConn` calls due to restart timing variances.","reactions":{"url":"https://api.github.com/repos/istio/istio/issues/54565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/istio/istio/issues/54565/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/istio/istio/issues/comments/2573782274","html_url":"https://github.com/istio/istio/issues/54544#issuecomment-2573782274","issue_url":"https://api.github.com/repos/istio/istio/issues/54544","id":2573782274,"node_id":"IC_kwDOBGvVPc6ZaM0C","user":{"login":"bleggett","id":854255,"node_id":"MDQ6VXNlcjg1NDI1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/854255?v=4","gravatar_id":"","url":"https://api.github.com/users/bleggett","html_url":"https://github.com/bleggett","followers_url":"https://api.github.com/users/bleggett/followers","following_url":"https://api.github.com/users/bleggett/following{/other_user}","gists_url":"https://api.github.com/users/bleggett/gists{/gist_id}","starred_url":"https://api.github.com/users/bleggett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleggett/subscriptions","organizations_url":"https://api.github.com/users/bleggett/orgs","repos_url":"https://api.github.com/users/bleggett/repos","events_url":"https://api.github.com/users/bleggett/events{/privacy}","received_events_url":"https://api.github.com/users/bleggett/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-06T19:35:56Z","updated_at":"2025-01-06T19:35:56Z","body":"Ahh, ty. \r\n\r\nI had fixed this at some point, but forgot I didn't fix it here.\r\n\r\nhttps://github.com/istio/istio/pull/54565 should do.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/istio/istio/issues/comments/2573782274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bleggett","id":854255,"node_id":"MDQ6VXNlcjg1NDI1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/854255?v=4","gravatar_id":"","url":"https://api.github.com/users/bleggett","html_url":"https://github.com/bleggett","followers_url":"https://api.github.com/users/bleggett/followers","following_url":"https://api.github.com/users/bleggett/following{/other_user}","gists_url":"https://api.github.com/users/bleggett/gists{/gist_id}","starred_url":"https://api.github.com/users/bleggett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleggett/subscriptions","organizations_url":"https://api.github.com/users/bleggett/orgs","repos_url":"https://api.github.com/users/bleggett/repos","events_url":"https://api.github.com/users/bleggett/events{/privacy}","received_events_url":"https://api.github.com/users/bleggett/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15831386556,"node_id":"CE_lADOBGvVPc6k-0e2zwAAAAOvn8m8","url":"https://api.github.com/repos/istio/istio/issues/events/15831386556","actor":{"login":"istio-testing","id":25311884,"node_id":"MDQ6VXNlcjI1MzExODg0","avatar_url":"https://avatars.githubusercontent.com/u/25311884?v=4","gravatar_id":"","url":"https://api.github.com/users/istio-testing","html_url":"https://github.com/istio-testing","followers_url":"https://api.github.com/users/istio-testing/followers","following_url":"https://api.github.com/users/istio-testing/following{/other_user}","gists_url":"https://api.github.com/users/istio-testing/gists{/gist_id}","starred_url":"https://api.github.com/users/istio-testing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/istio-testing/subscriptions","organizations_url":"https://api.github.com/users/istio-testing/orgs","repos_url":"https://api.github.com/users/istio-testing/repos","events_url":"https://api.github.com/users/istio-testing/events{/privacy}","received_events_url":"https://api.github.com/users/istio-testing/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2025-01-06T22:04:02Z","state_reason":null,"performed_via_github_app":null},{"id":15831386583,"node_id":"CE_lADOBGvVPc6k-0e2zwAAAAOvn8nX","url":"https://api.github.com/repos/istio/istio/issues/events/15831386583","actor":{"login":"istio-testing","id":25311884,"node_id":"MDQ6VXNlcjI1MzExODg0","avatar_url":"https://avatars.githubusercontent.com/u/25311884?v=4","gravatar_id":"","url":"https://api.github.com/users/istio-testing","html_url":"https://github.com/istio-testing","followers_url":"https://api.github.com/users/istio-testing/followers","following_url":"https://api.github.com/users/istio-testing/following{/other_user}","gists_url":"https://api.github.com/users/istio-testing/gists{/gist_id}","starred_url":"https://api.github.com/users/istio-testing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/istio-testing/subscriptions","organizations_url":"https://api.github.com/users/istio-testing/orgs","repos_url":"https://api.github.com/users/istio-testing/repos","events_url":"https://api.github.com/users/istio-testing/events{/privacy}","received_events_url":"https://api.github.com/users/istio-testing/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"b2f5726d06b93532b7be04901e56acfc42451e55","commit_url":"https://api.github.com/repos/istio/istio/commits/b2f5726d06b93532b7be04901e56acfc42451e55","created_at":"2025-01-06T22:04:03Z","state_reason":null,"performed_via_github_app":null},{"id":15831493884,"node_id":"REFE_lADOBGvVPc6k-0e2zwAAAAOvoWz8","url":"https://api.github.com/repos/istio/istio/issues/events/15831493884","actor":{"login":"pull[bot]","id":39814207,"node_id":"MDM6Qm90Mzk4MTQyMDc=","avatar_url":"https://avatars.githubusercontent.com/in/12910?v=4","gravatar_id":"","url":"https://api.github.com/users/pull%5Bbot%5D","html_url":"https://github.com/apps/pull","followers_url":"https://api.github.com/users/pull%5Bbot%5D/followers","following_url":"https://api.github.com/users/pull%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/pull%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/pull%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pull%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/pull%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/pull%5Bbot%5D/repos","events_url":"https://api.github.com/users/pull%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/pull%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"b2f5726d06b93532b7be04901e56acfc42451e55","commit_url":"https://api.github.com/repos/annihilatorrrr/istio/commits/b2f5726d06b93532b7be04901e56acfc42451e55","created_at":"2025-01-06T22:19:11Z","performed_via_github_app":null},{"id":15831664685,"node_id":"REFE_lADOBGvVPc6k-0e2zwAAAAOvpAgt","url":"https://api.github.com/repos/istio/istio/issues/events/15831664685","actor":{"login":"istio-testing","id":25311884,"node_id":"MDQ6VXNlcjI1MzExODg0","avatar_url":"https://avatars.githubusercontent.com/u/25311884?v=4","gravatar_id":"","url":"https://api.github.com/users/istio-testing","html_url":"https://github.com/istio-testing","followers_url":"https://api.github.com/users/istio-testing/followers","following_url":"https://api.github.com/users/istio-testing/following{/other_user}","gists_url":"https://api.github.com/users/istio-testing/gists{/gist_id}","starred_url":"https://api.github.com/users/istio-testing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/istio-testing/subscriptions","organizations_url":"https://api.github.com/users/istio-testing/orgs","repos_url":"https://api.github.com/users/istio-testing/repos","events_url":"https://api.github.com/users/istio-testing/events{/privacy}","received_events_url":"https://api.github.com/users/istio-testing/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"354ca310fa84f46b64f5a14174ea4e35f993de32","commit_url":"https://api.github.com/repos/istio-testing/istio/commits/354ca310fa84f46b64f5a14174ea4e35f993de32","created_at":"2025-01-06T22:45:01Z","performed_via_github_app":null},{"id":15835557073,"node_id":"REFE_lADOBGvVPc6k-0e2zwAAAAOv32zR","url":"https://api.github.com/repos/istio/istio/issues/events/15835557073","actor":{"login":"istio-testing","id":25311884,"node_id":"MDQ6VXNlcjI1MzExODg0","avatar_url":"https://avatars.githubusercontent.com/u/25311884?v=4","gravatar_id":"","url":"https://api.github.com/users/istio-testing","html_url":"https://github.com/istio-testing","followers_url":"https://api.github.com/users/istio-testing/followers","following_url":"https://api.github.com/users/istio-testing/following{/other_user}","gists_url":"https://api.github.com/users/istio-testing/gists{/gist_id}","starred_url":"https://api.github.com/users/istio-testing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/istio-testing/subscriptions","organizations_url":"https://api.github.com/users/istio-testing/orgs","repos_url":"https://api.github.com/users/istio-testing/repos","events_url":"https://api.github.com/users/istio-testing/events{/privacy}","received_events_url":"https://api.github.com/users/istio-testing/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"942705eb4f0b3fc2cc084b2036664953ddab753b","commit_url":"https://api.github.com/repos/istio/istio/commits/942705eb4f0b3fc2cc084b2036664953ddab753b","created_at":"2025-01-07T08:50:02Z","performed_via_github_app":null}]