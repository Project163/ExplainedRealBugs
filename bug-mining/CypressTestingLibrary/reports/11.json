{"url":"https://api.github.com/repos/testing-library/cypress-testing-library/issues/232","repository_url":"https://api.github.com/repos/testing-library/cypress-testing-library","labels_url":"https://api.github.com/repos/testing-library/cypress-testing-library/issues/232/labels{/name}","comments_url":"https://api.github.com/repos/testing-library/cypress-testing-library/issues/232/comments","events_url":"https://api.github.com/repos/testing-library/cypress-testing-library/issues/232/events","html_url":"https://github.com/testing-library/cypress-testing-library/issues/232","id":1409931476,"node_id":"I_kwDOB6dRm85UCdjU","number":232,"title":"cypress cannot find the line number of failed .findBy commands","user":{"login":"rmmanseau","id":8755838,"node_id":"MDQ6VXNlcjg3NTU4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/8755838?v=4","gravatar_id":"","url":"https://api.github.com/users/rmmanseau","html_url":"https://github.com/rmmanseau","followers_url":"https://api.github.com/users/rmmanseau/followers","following_url":"https://api.github.com/users/rmmanseau/following{/other_user}","gists_url":"https://api.github.com/users/rmmanseau/gists{/gist_id}","starred_url":"https://api.github.com/users/rmmanseau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmmanseau/subscriptions","organizations_url":"https://api.github.com/users/rmmanseau/orgs","repos_url":"https://api.github.com/users/rmmanseau/repos","events_url":"https://api.github.com/users/rmmanseau/events{/privacy}","received_events_url":"https://api.github.com/users/rmmanseau/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1118585454,"node_id":"MDU6TGFiZWwxMTE4NTg1NDU0","url":"https://api.github.com/repos/testing-library/cypress-testing-library/labels/released","name":"released","color":"ededed","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-10-14T22:29:58Z","updated_at":"2022-11-15T19:32:25Z","closed_at":"2022-11-15T19:27:36Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\nHI! PLEASE STOP TO READ THIS!! If your issue is regarding one of the query\r\nAPIs (`getByText`, `getByLabelText`, etc), then please file it on the\r\nhttps://github.com/kentcdodds/dom-testing-library repository instead. If you\r\nfile it here it will be closed. Thanks :)\r\n\r\nThanks for your interest in the project. I appreciate bugs filed and PRs submitted!\r\nPlease make sure that you are familiar with and follow the Code of Conduct for\r\nthis project (found in the CODE_OF_CONDUCT.md file).\r\n\r\nPlease fill out this template with all the relevant information so we can\r\nunderstand what's going on and fix the issue.\r\n\r\nI'll probably ask you to submit the fix (after giving some direction). If you've\r\nnever done that before, that's great! Check this free short video tutorial to\r\nlearn how: http://kcd.im/pull-request\r\n-->\r\n\r\nfirst, to address this:\r\n```\r\nHI! PLEASE STOP TO READ THIS!! If your issue is regarding one of the query\r\nAPIs (`getByText`, `getByLabelText`, etc), then please file it on the\r\nhttps://github.com/kentcdodds/dom-testing-library repository instead. If you\r\nfile it here it will be closed. Thanks :)\r\n```\r\n\r\nthe getBy functions do work properly, but when they fail cypress is not able to figure out where the failure is coming from & point to it accurately. This makes for difficult debugging because it's not possible to immediately jump to the failed testing library commands. I believe that this issue does belong here, as the issue is specific to integration with cypress test runner.\r\n\r\n- `cypress-testing-library` version: 8.0.3\r\n- `cypress` version: 10.10.0\r\n- `node` version: 14.20\r\n- `npm` (or `yarn`) version: 1.22.19\r\n\r\nRelevant code or config\r\n\r\n```javascript\r\ndescribe('does not show failing assertion', () => {\r\n  it('cy.findByText', () => {\r\n    cy.mount(<App/>);\r\n    cy.findByText(TEXT); // <---- cypress cannot tell that this line is the point of failure\r\n  })\r\n\r\n  it('cy.findByTestId', () => {\r\n    cy.mount(<App/>);\r\n    cy.findByTestId(\"code\");\r\n    cy.findByTestId(\"yeet\"); // <---- cypress cannot tell that this line is the point of failure \r\n  })\r\n})\r\n```\r\n\r\nWhat you did:\r\n\r\nrun a test that fails on a cy.findBy* command\r\n\r\nWhat happened:\r\n\r\nit creates a `TestingLibraryElementError` and dumps the entire state of the DOM\r\n\r\n<img width=\"714\" alt=\"image\" src=\"https://user-images.githubusercontent.com/8755838/195952638-a4255f0d-b381-42b1-99da-bc4ad209d7f4.png\">\r\n\r\nWhat I expected:\r\n\r\nit generates an `Assertion Error` and points to the line of the failing assertion.\r\n\r\n<img width=\"696\" alt=\"image\" src=\"https://user-images.githubusercontent.com/8755838/195952665-a33dc5db-767d-4e8b-903f-2c0a6c689d1e.png\">\r\n\r\n<!-- Please provide the full error message/screenshots/anything -->\r\n\r\nReproduction repository: https://github.com/rmmanseau/cy-testing-library-repro\r\n\r\n<!--\r\nIf possible, please create a repository that reproduces the issue with the\r\nminimal amount of code possible.\r\n-->\r\n\r\nProblem description:\r\n\r\n@testing-library/cypress doesn't generate the correct assertion type / stack trace / whatever is required by cypress in order for it to point to the location of the failing line.\r\n\r\nSuggested solution:\r\n\r\ndo the thing that cypress expects.\r\n\r\n","closed_by":{"login":"NicholasBoll","id":338257,"node_id":"MDQ6VXNlcjMzODI1Nw==","avatar_url":"https://avatars.githubusercontent.com/u/338257?v=4","gravatar_id":"","url":"https://api.github.com/users/NicholasBoll","html_url":"https://github.com/NicholasBoll","followers_url":"https://api.github.com/users/NicholasBoll/followers","following_url":"https://api.github.com/users/NicholasBoll/following{/other_user}","gists_url":"https://api.github.com/users/NicholasBoll/gists{/gist_id}","starred_url":"https://api.github.com/users/NicholasBoll/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NicholasBoll/subscriptions","organizations_url":"https://api.github.com/users/NicholasBoll/orgs","repos_url":"https://api.github.com/users/NicholasBoll/repos","events_url":"https://api.github.com/users/NicholasBoll/events{/privacy}","received_events_url":"https://api.github.com/users/NicholasBoll/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/testing-library/cypress-testing-library/issues/232/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/testing-library/cypress-testing-library/issues/232/timeline","performed_via_github_app":null,"state_reason":"completed"}