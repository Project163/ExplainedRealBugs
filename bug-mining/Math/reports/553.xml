<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:24:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-1257] NormalDistribution.cumulativeProbability() suffers from cancellation</title>
                <link>https://issues.apache.org/jira/browse/MATH-1257</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;I see the following around line 194:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;        return 0.5 * (1 + Erf.erf(dev / (standardDeviation * SQRT2)));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When erf() returns a very small value, this cancels in the addition with the &quot;1.0&quot; which leads to poor precision in the results.&lt;/p&gt;

&lt;p&gt;I would suggest changing this line to read more like:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;return 0.5 * Erf.erfc( -dev / standardDeviation * SQRT2 );
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;Should you want some test cases for &quot;extreme values&quot; (one might argue that within 10 standard deviations isn&apos;t all that extreme) then you can check the following: &lt;a href=&quot;http://www.jstatsoft.org/v52/i07/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.jstatsoft.org/v52/i07/&lt;/a&gt; then look in the v52i07-xls.zip at replication-01-distribution-standard-normal.xls&lt;/p&gt;

&lt;p&gt;I think you will also find that evaluation of expressions such as &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;NormalDistribution( 0, 1 ).cumulativeProbability( -10.0 );&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;are pretty far off.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12857050">MATH-1257</key>
            <summary>NormalDistribution.cumulativeProbability() suffers from cancellation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="murphyw">Bill Murphy</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Aug 2015 22:31:26 +0000</created>
                <updated>Mon, 25 Jan 2016 20:27:54 +0000</updated>
                            <resolved>Wed, 19 Aug 2015 21:16:23 +0000</resolved>
                                    <version>3.5</version>
                                    <fixVersion>4.0</fixVersion>
                    <fixVersion>3.6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14702901" author="erans" created="Wed, 19 Aug 2015 11:54:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;return 0.5 * Erf.erfc( -dev / standardDeviation * SQRT2 );&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Using either the current code or&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; 0.5 * Erf.erfc(-dev / (standardDeviation * SQRT2));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the unit tests pass.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;[...] test cases for &quot;extreme values&quot; [...]&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;A patch with a test case that shows the problem would be welcome.&lt;/p&gt;
</comment>
                            <comment id="14703203" author="murphyw" created="Wed, 19 Aug 2015 15:35:20 +0000"  >&lt;p&gt;I&apos;m not sure where your test cases are in your src, or how one runs them. A suitable test is to see if &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;NormalDistribution( 0, 1 ).cumulativeProbability( -10.0 );&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;is evaluated to 0.0 (I think incorrect) or like 7.61985E-24 (I think close/approximately correct). &lt;/p&gt;

&lt;p&gt;This should really be reviewed by someone sharper at math than me, so even were I to know where to find the tests and add one as a patch, this needs someone more familiar with the problem domain to assure this is the right move. It looks good to me, however, this is insufficient assurance.&lt;/p&gt;</comment>
                            <comment id="14703261" author="erans" created="Wed, 19 Aug 2015 16:15:26 +0000"  >&lt;p&gt;Well, you found a list of reference values; do you mean that you don&apos;t trust them?&lt;/p&gt;

&lt;p&gt;Otherwise, the unit test would amount to put them in an array of pairs (x, N_cumulative&amp;#40;x&amp;#41;) and compare the reference values with the value computed by the library...&lt;/p&gt;</comment>
                            <comment id="14703276" author="erans" created="Wed, 19 Aug 2015 16:23:34 +0000"  >&lt;p&gt;I&apos;ve added a test case for x=-10 and the above reference value.&lt;/p&gt;

&lt;p&gt;CM&apos;s current code does not pass the test.&lt;/p&gt;

&lt;p&gt;Your suggested change make it pass, so unless there is an objection, I&apos;ll apply the attached patch.&lt;/p&gt;</comment>
                            <comment id="14703429" author="murphyw" created="Wed, 19 Aug 2015 17:37:36 +0000"  >&lt;p&gt;My doubts are based mostly on my not being a statistician. My suggested change was researched on wikipedia and wolfram. &lt;/p&gt;

&lt;p&gt;Glad that you like the mod, I would be in favor of applying this patch. Thanks!&lt;/p&gt;</comment>
                            <comment id="14703489" author="otmar ertl" created="Wed, 19 Aug 2015 18:07:22 +0000"  >&lt;p&gt;+1 for the patch, it eliminates one source of error. For values much smaller than -1 the regularizedGammaQ function evaluates to a very small positive values. The computation was like 0.5*((regularizedGammaQ - 1) + 1). With the patch the computation is now 0.5*regularizedGammaQ, obviously improving accuracy.&lt;/p&gt;</comment>
                            <comment id="14703758" author="erans" created="Wed, 19 Aug 2015 21:16:23 +0000"  >&lt;p&gt;Change applied in the following commits:&lt;br/&gt;
03178c8b15f1b522b98ded0f83cfb0e79f5ec4d3 (4.0)&lt;br/&gt;
49a9e6e8742cb6e05abf0219705338d95f732e12 (3.6)&lt;/p&gt;</comment>
                            <comment id="15115939" author="luc" created="Mon, 25 Jan 2016 20:27:54 +0000"  >&lt;p&gt;Closing all resolved issues that were included in 3.6 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12751298" name="MATH-1257.patch" size="1742" author="erans" created="Wed, 19 Aug 2015 16:23:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2j2rr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>