<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:21:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-297] Eigenvector computation incorrectly returning vectors of NaNs</title>
                <link>https://issues.apache.org/jira/browse/MATH-297</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;As reported by Axel Kramer on commons-dev, the following test case succeeds, but should fail:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testEigenDecomposition() {
    &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;[][] m = { { 0.0, 1.0, -1.0 }, { 1.0, 1.0, 0.0 }, { -1.0,0.0, 1.0 } };
    RealMatrix rm = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Array2DRowRealMatrix(m);
    assertEquals(rm.toString(),
        &lt;span class=&quot;code-quote&quot;&gt;&quot;Array2DRowRealMatrix{{0.0,1.0,-1.0},{1.0,1.0,0.0},{-1.0,0.0,1.0}}&quot;&lt;/span&gt;);
    EigenDecompositionImpl ed = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; EigenDecompositionImpl(rm,
        MathUtils.SAFE_MIN);
    RealVector rv0 = ed.getEigenvector(0);
    assertEquals(rv0.toString(), &lt;span class=&quot;code-quote&quot;&gt;&quot;{(NaN); (NaN); (NaN)}&quot;&lt;/span&gt;);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ed.getRealEigenvalues() returns the correct eigenvalues (2, 1, -1), but all three eigenvectors contain only NaNs.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12436157">MATH-297</key>
            <summary>Eigenvector computation incorrectly returning vectors of NaNs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="psteitz">Phil Steitz</reporter>
                        <labels>
                    </labels>
                <created>Sun, 20 Sep 2009 14:33:07 +0000</created>
                <updated>Wed, 14 Apr 2010 00:16:55 +0000</updated>
                            <resolved>Mon, 25 Jan 2010 17:58:04 +0000</resolved>
                                    <version>2.0</version>
                                    <fixVersion>2.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12767159" author="billbarker" created="Sun, 18 Oct 2009 23:33:05 +0000"  >&lt;p&gt;This is now fixed as of R826550.  Unfortunately, I lack karma to resolve this issue, so will have to hope that somebody else will resolve it for me.&lt;/p&gt;</comment>
                            <comment id="12767433" author="axelclk" created="Mon, 19 Oct 2009 18:14:23 +0000"  >&lt;p&gt;If I&apos;m expanding my testcase to the snippet below, I&apos;m  now getting an eigenvector with all &quot;negative values&quot; at index 1.&lt;br/&gt;
I think this should be avoided. &lt;br/&gt;
See also the solution computed by Ted Dunning on the mailing list: &lt;br/&gt;
&lt;a href=&quot;http://www.mail-archive.com/dev@commons.apache.org/msg12038.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.mail-archive.com/dev@commons.apache.org/msg12038.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    double[][] m = { &lt;/p&gt;
{ 0.0, 1.0, -1.0 }
&lt;p&gt;, &lt;/p&gt;
{ 1.0, 1.0, 0.0 }
&lt;p&gt;, &lt;/p&gt;
{ -1.0, 0.0, 1.0 }
&lt;p&gt; };&lt;br/&gt;
    RealMatrix rm = new Array2DRowRealMatrix(m);&lt;br/&gt;
    assertEquals(rm.toString(),&lt;br/&gt;
        &quot;Array2DRowRealMatrix{{0.0,1.0,-1.0},&lt;/p&gt;
{1.0,1.0,0.0}
&lt;p&gt;,{-1.0,0.0,1.0}}&quot;);&lt;br/&gt;
    EigenDecompositionImpl ed = new EigenDecompositionImpl(rm,&lt;br/&gt;
        MathUtils.SAFE_MIN);&lt;br/&gt;
    RealVector rv0 = ed.getEigenvector(0);&lt;br/&gt;
    RealVector rv1 = ed.getEigenvector(1);&lt;br/&gt;
    RealVector rv2 = ed.getEigenvector(2);&lt;br/&gt;
    assertEquals(rv0.toString(), &quot;&lt;/p&gt;
{0,58; 0,58; -0,58}
&lt;p&gt;&quot;);&lt;br/&gt;
    assertEquals(rv1.toString(), &quot;{-0; -0,71; -0,71}&quot;);&lt;br/&gt;
    assertEquals(rv2.toString(), &quot;&lt;/p&gt;
{0,82; -0,41; 0,41}
&lt;p&gt;&quot;);&lt;/p&gt;</comment>
                            <comment id="12770367" author="bjohnson" created="Tue, 27 Oct 2009 03:14:56 +0000"  >&lt;p&gt;There still seems to be a problem with the decomposition of some matrices.  For example, the decomposition of the identity matrix &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; {{1,0},{0,1}}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; yields the correct eigenvalues, but NaN for all the eigenvector elements.&lt;br/&gt;
Crucially, the &quot;isIncludedColumn&quot; in the EigenDecompositionImplTest.java file always returns true (at least on my system) when the calculated eigenvectors have NaN elements, so is useless as a test for this problem.&lt;/p&gt;

&lt;p&gt;Also, I discovered this problem when getting NaN values doing an SVD of certain matrices (where each row has only one non-zero value).  Since the SVD algorithm uses the EigenDecompositionImpl code, this seems to be a result of this current  bug.  (And ironically, I just told my students that one reason people love the SVD is that it essentially never fails).&lt;/p&gt;




</comment>
                            <comment id="12770424" author="luc" created="Tue, 27 Oct 2009 08:43:22 +0000"  >&lt;p&gt;I will look at this issue one issu &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-308&quot; title=&quot;ArrayIndexOutOfBoundException in EigenDecompositionImpl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-308&quot;&gt;&lt;del&gt;MATH-308&lt;/del&gt;&lt;/a&gt; has been solved.&lt;/p&gt;</comment>
                            <comment id="12770474" author="bjohnson" created="Tue, 27 Oct 2009 11:48:11 +0000"  >&lt;p&gt;Thanks.&lt;/p&gt;

&lt;p&gt;The problem seems to be a divide by zero error with the variable diP1 in the following code, but this is probably as far as I&apos;ll get in debugging it:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   private void stationaryQuotientDifferenceWithShift(final double[] d, final double[] l,
                                                       final double lambda) {
        final int nM1 = d.length - 1;
        double si = -lambda;
        for (int i = 0, sixI = 0; i &amp;lt; nM1; ++i, sixI += 6) {
            final double di   = d[i];
            final double li   = l[i];
            final double diP1 = di + si;
            final double liP1 = li * di / diP1;
            work[sixI]        = si;
            work[sixI + 1]    = diP1;
            work[sixI + 2]    = liP1;
            si = li * liP1 * si - lambda;
        }
        work[6 * nM1 + 1] = d[nM1] + si;
        work[6 * nM1]     = si;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12770601" author="bjohnson" created="Tue, 27 Oct 2009 18:39:01 +0000"  >&lt;p&gt;..., and I note that what I presume to be the original Fortran code (in dlar1v.f of LAPACK) has several sections of code marked:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Runs a slower version of the above loop if a NaN is detected&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Hope this helps in resolving the issue,&lt;/p&gt;

&lt;p&gt;Bruce&lt;/p&gt;</comment>
                            <comment id="12772913" author="jake.mannix" created="Tue, 3 Nov 2009 07:23:23 +0000"  >&lt;p&gt;Doing the most trivial fix possible (dividing by the SAFE_MIN if diPl == 0)  on the line which leads to NaN appears to correctly fix this for the particular case of decomposing diagonal matrices (at least for 2x2 and 3x3 cases I checked with a unit test). &lt;/p&gt;

&lt;p&gt;I&apos;m not sure if this &quot;fixes&quot; the problem, because I&apos;m not sure if I really grok the algorithm&apos;s implementation in this code.&lt;/p&gt;

&lt;p&gt;We could see better if I knew how often this pops up (any matrix whose tri-diagonal form is actually diagonal?)...&lt;/p&gt;</comment>
                            <comment id="12772924" author="jake.mannix" created="Tue, 3 Nov 2009 07:42:24 +0000"  >&lt;p&gt;Ok, well sadly it&apos;s easy to find an example which &lt;b&gt;isn&apos;t&lt;/b&gt; fixed by just removing that one divide-by-zero: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; { {0, 1, 0}, {1, 0, 0}, {0, 0, 1} } &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; leads to perfectly reasonable eigenvalues (1, 1, -1), but NaN again rears its ugly head because findEigenVectors() assumes that, among other things, that the main diagonal does not start with a zero, and then divides by it.&lt;/p&gt;

&lt;p&gt;Not sure what the proper solution is to this, but a non-shifted LDL^t decomposition is a lot easier to understand to me than the other place where the NaN pops up, so maybe I can figure this one out on the plane ride down to ApacheCon tomorrow.&lt;/p&gt;</comment>
                            <comment id="12783480" author="luc" created="Sun, 29 Nov 2009 21:27:31 +0000"  >&lt;p&gt;Another step towards the solution has been checked in as of r885268.&lt;br/&gt;
Just as Bruce noticed one month ago (thanks), there was an improvement in dstqds and dqds algorithms implemented in DLAR1V that are not in Dhillon&apos;s thesis.&lt;br/&gt;
The problem is still not completely solved as for example in dimension 3 the decomposition of identity leads to 3 times the same&lt;br/&gt;
vector (0, 0, 1) instead of giving (1, 0, 0), (0, 1, 0) and (0, 0, 1).&lt;/p&gt;</comment>
                            <comment id="12804619" author="luc" created="Mon, 25 Jan 2010 17:58:04 +0000"  >&lt;p&gt;The original issue as been solved 2009-11-29 as of r885268.&lt;br/&gt;
The remaining problem identified in the last comments has been moved in a separate JIRA issue: &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-333&quot; title=&quot;eigenvectors computation is wrong when several vectors share the same eigenvalue&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-333&quot;&gt;&lt;del&gt;MATH-333&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34221</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 43 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rvbr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160719</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>