<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:24:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-1065] EnumeratedRealDistribution.inverseCumulativeProbability returns values not in the samples set</title>
                <link>https://issues.apache.org/jira/browse/MATH-1065</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;The method EnumeratedRealDistribution.inverseCumulativeProbability() sometimes returns values that are not in the initial samples domain...&lt;br/&gt;
I will attach a test to exploit this bug.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12680726">MATH-1065</key>
            <summary>EnumeratedRealDistribution.inverseCumulativeProbability returns values not in the samples set</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="matteodg@infinito.it">matteodg</reporter>
                        <labels>
                    </labels>
                <created>Fri, 22 Nov 2013 11:21:58 +0000</created>
                <updated>Mon, 19 May 2014 15:13:30 +0000</updated>
                            <resolved>Sun, 9 Feb 2014 11:21:54 +0000</resolved>
                                    <version>3.2</version>
                                    <fixVersion>3.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13829895" author="matteodg@infinito.it" created="Fri, 22 Nov 2013 11:31:56 +0000"  >&lt;p&gt;Failing tests for numerical issues are:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;testFailing1&lt;/li&gt;
	&lt;li&gt;testFailing2&lt;/li&gt;
	&lt;li&gt;testFailing3&lt;/li&gt;
	&lt;li&gt;testFailing4&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Failing tests with very wrong results are:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;testFailing5&lt;/li&gt;
	&lt;li&gt;testFailing6&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13830950" author="tn" created="Sun, 24 Nov 2013 14:29:51 +0000"  >&lt;p&gt;Hi Matteo,&lt;/p&gt;

&lt;p&gt;regarding the numerical issues:&lt;/p&gt;

&lt;p&gt;the distribution works internally with an absolute accuracy of 1e-6. The results should be compared with an epsilon value like this.&lt;/p&gt;

&lt;p&gt;There is currently no easy way to set another accuracy, but you can instantiate an EnumeratedRealDistribution like this, and override the getSolverAbsoluteAccuracy method:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;        DISTRIBUTION = new EnumeratedRealDistribution(new double[]{
            14.0, 18.0, 21.0, 28.0, 31.0, 33.0
        }, new double[]{
            4.0 / 16.0, 5.0 / 16.0, 0.0 / 16.0, 3.0 / 16.0, 1.0 / 16.0, 3.0 / 16.0
        }) {

            @Override
            protected double getSolverAbsoluteAccuracy() {
                return 1e-9;
            }
            
        };
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13830953" author="tn" created="Sun, 24 Nov 2013 15:08:11 +0000"  >&lt;p&gt;For the other failing tests: I am not sure what the enumerated distribution tries to achieve:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;a discrete probability distribution&lt;/li&gt;
	&lt;li&gt;a distribution with continuous and discrete parts&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;in case of a discrete probability distribution the inverseCumulativeProbability method is clearly wrong, and would have to fixed like this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    public double inverseCumulativeProbability(final double p) throws OutOfRangeException {
        double probability = 0;
        double x = getSupportLowerBound();
        for (final Pair&amp;lt;Double, Double&amp;gt; sample : innerDistribution.getPmf()) {
            if (sample.getValue() == 0.0) {
                continue;
            }
            probability += sample.getValue();
            if (probability &amp;lt;= p) {
                x = sample.getKey();
            }

            if (probability &amp;gt;= p) {
                break;
            }
        }

        return x;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But then your other test cases are wrong imho:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  inverseCumulativeProbability(0.5) = 14 instead of 18
  inverseCumulativeProbability(0.5624) = 14 instead of 18
  inverseCumulativeProbability(0.5626) = 18 instead of 28
  inverseCumulativeProbability(0.7600) = 28 instead of 31
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13830983" author="psteitz" created="Sun, 24 Nov 2013 17:12:58 +0000"  >&lt;p&gt;I think the intent of this class is to represent a discrete, but real-valued distribution.  EnumeratedDistributions are discrete distributions with a finite, &quot;enumerated&quot; set of values.  The problem here (as Thomas notes) is that EnumeratedRealDistribution extends AbstractRealDistribution and does not override the default inverse cum method that basically assumes a continuous distribution.  What it should implement is a discrete algorithm like what Thomas has suggested.&lt;/p&gt;</comment>
                            <comment id="13836098" author="tn" created="Sun, 1 Dec 2013 19:20:13 +0000"  >&lt;p&gt;Thanks for the better explanation of the problem.&lt;br/&gt;
I am still searching for a mathematical definition of such a distribution as I mainly looked at the referenced wikipedia page and derived the above algorithm from the cdf graph that is available there, although I am of course unsure if it is correct.&lt;/p&gt;</comment>
                            <comment id="13895658" author="psteitz" created="Sat, 8 Feb 2014 18:10:35 +0000"  >&lt;p&gt;By contract in RealDistribution (same actually in IntegerDistribution), what the inverse cum needs to return is&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 
inf{x in R | P(X&amp;lt;=x) &amp;gt;= p} &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 0 &amp;lt; p &amp;lt;= 1}
inf{x in R | P(X&amp;lt;=x) &amp;gt; 0} &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; p = 0.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looks to me like your algorithm returns &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; sup{x in R | P(X &amp;lt;= x) &amp;lt; p} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; which is not the same.  The key is to be consistent with the way we have defined the inverse cum for both discrete (&quot;Integer&quot;) and continuous (&quot;Real&quot;) distributions.&lt;/p&gt;
</comment>
                            <comment id="13895702" author="tn" created="Sat, 8 Feb 2014 19:31:04 +0000"  >&lt;p&gt;Hi Phil,&lt;/p&gt;

&lt;p&gt;thanks for looking into this. I updated the code to this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    public double inverseCumulativeProbability(final double p) throws OutOfRangeException {

        if (p &amp;lt; 0.0 || p &amp;gt; 1.0) {
            throw new OutOfRangeException(p, 0, 1);
        }

        double probability = 0;
        double x = getSupportLowerBound();
        for (final Pair&amp;lt;Double, Double&amp;gt; sample : innerDistribution.getPmf()) {
            if (sample.getValue() == 0.0) {
                continue;
            }
            probability += sample.getValue();
            x = sample.getKey();

            if (probability &amp;gt;= p) {
                break;
            }
        }

        return x;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which returns the same results as the EnumeratedIntegerDistribution for the same input values and also succeeds in running all the test cases from the attached unit test.&lt;/p&gt;</comment>
                            <comment id="13895733" author="psteitz" created="Sat, 8 Feb 2014 21:31:27 +0000"  >&lt;p&gt;Code and tests look correct to me.&lt;/p&gt;</comment>
                            <comment id="13895879" author="tn" created="Sun, 9 Feb 2014 11:21:54 +0000"  >&lt;p&gt;Applied changes in r1566274.&lt;/p&gt;

&lt;p&gt;Thanks for the report and the testcase!&lt;/p&gt;</comment>
                            <comment id="14001840" author="luc" created="Mon, 19 May 2014 15:13:30 +0000"  >&lt;p&gt;Closing all resolved issue now available in released 3.3 version.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12615317" name="EnumeratedRealDistributionTest.java" size="3563" author="matteodg@infinito.it" created="Fri, 22 Nov 2013 11:31:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>359991</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 26 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1q23b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>360290</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>