<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:23:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-718] inverseCumulativeProbability of BinomialDistribution returns wrong value for large trials.</title>
                <link>https://issues.apache.org/jira/browse/MATH-718</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;The inverseCumulativeProbability method of the BinomialDistributionImpl class returns wrong value for large trials.  Following code will be reproduce the problem.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;System.out.println(new BinomialDistributionImpl(1000000, 0.5).inverseCumulativeProbability(0.5));&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;This returns 499525, though it should be 499999.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure how it should be fixed, but the cause is that the cumulativeProbability method returns Infinity, not NaN.  As the result the checkedCumulativeProbability method doesn&apos;t work as expected.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12533757">MATH-718</key>
            <summary>inverseCumulativeProbability of BinomialDistribution returns wrong value for large trials.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="uchiyama">Yuji Uchiyama</reporter>
                        <labels>
                    </labels>
                <created>Sun, 4 Dec 2011 00:40:44 +0000</created>
                <updated>Mon, 4 Mar 2013 18:53:26 +0000</updated>
                            <resolved>Mon, 21 May 2012 19:56:36 +0000</resolved>
                                    <version>2.2</version>
                    <version>3.0</version>
                                    <fixVersion>3.1</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13162326" author="celestin" created="Sun, 4 Dec 2011 09:22:55 +0000"  >&lt;p&gt;Hi Yuji,&lt;br/&gt;
thanks for reporting this. For version 3.0, we are currently reshaping the package distribution, and this will probably get resolved once we are over with &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-692&quot; title=&quot;Cumulative probability and inverse cumulative probability inconsistencies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-692&quot;&gt;&lt;del&gt;MATH-692&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
Best regards,&lt;br/&gt;
S&#233;bastien&lt;/p&gt;</comment>
                            <comment id="13170599" author="cwinter" created="Thu, 15 Dec 2011 23:55:35 +0000"  >&lt;p&gt;There seem to be stability problems with Beta.regularizedBeta(...) when using extreme parameters. &lt;tt&gt;PascalDistribution.cumulativeProbability(Integer.MAX_VALUE)&lt;/tt&gt; returns &lt;tt&gt;NaN&lt;/tt&gt; instead of 1. We should look for a way to avoid both infinite values and NaNs in the implementation of the regularized beta function.&lt;/p&gt;</comment>
                            <comment id="13200346" author="celestin" created="Sat, 4 Feb 2012 06:33:37 +0000"  >&lt;p&gt;As rightly pointed out by Christian, this issue is strongly related to &lt;a href=&quot;https://issues.apache.org/jira/browse/NUMBERS-52&quot; title=&quot;Incomplete beta function I(x, a, b) is inaccurate for large values of a and/or b&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NUMBERS-52&quot;&gt;MATH-738&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13200347" author="celestin" created="Sat, 4 Feb 2012 06:35:20 +0000"  >&lt;p&gt;Sorry, I only meant to postpone this issue.&lt;/p&gt;</comment>
                            <comment id="13252598" author="jhkauf" created="Thu, 12 Apr 2012 17:09:56 +0000"  >&lt;p&gt;I just wanted to let you know that our open source project (&lt;a href=&quot;http://www.eclipse.org/stem/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.eclipse.org/stem/&lt;/a&gt;) needs this function and we are eagerly awaiting the update. We are experiencing the issue of wrong values for large trials.&lt;/p&gt;</comment>
                            <comment id="13252722" author="celestin" created="Thu, 12 Apr 2012 18:48:34 +0000"  >&lt;p&gt;Hi James,&lt;br/&gt;
thanks for your interest. STEM is a very interesting project!&lt;br/&gt;
I will try and find a fix for this issue as soon as possible. Any ideas are welcome!&lt;br/&gt;
S&#233;bastien&lt;/p&gt;</comment>
                            <comment id="13253360" author="tn" created="Fri, 13 Apr 2012 13:20:10 +0000"  >&lt;p&gt;The problem Christian described wrt the PascalDistribution is a simple integer overflow in the class itself:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    public double cumulativeProbability(int x) {
        double ret;
        if (x &amp;lt; 0) {
            ret = 0.0;
        } else {
            ret = Beta.regularizedBeta(probabilityOfSuccess,
                    numberOfSuccesses, x + 1);
        }
        return ret;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;when x = Integer.MAX_VALUE, adding 1 to it will result in an overflow. As the parameter of regularizedBeta is anyway a double, so it should be changed to something like &quot;1L + x&quot; to enforce a long addition.&lt;/p&gt;

&lt;p&gt;Edit: Similar things happen btw also in other Distribution implementations, so it should be fixed also there, e.g. BinomialDistribution&lt;/p&gt;</comment>
                            <comment id="13253381" author="tn" created="Fri, 13 Apr 2012 13:57:40 +0000"  >&lt;p&gt;The problem is not only related to the Beta function, also the ContinuedFraction.evaluate is numerically unstable.&lt;/p&gt;

&lt;p&gt;The reason the cumulativeProbability returns infinity instead of NaN is because the evaluate return 0.0 when called from Beta.regularizedBeta, which leads to a division by zero. The used default epsilon of 10e-15 seems also quite restrictive, when relaxing the epsilon I got much better results (e.g. with 10e-5 I got a result of 499997).&lt;/p&gt;</comment>
                            <comment id="13279875" author="tn" created="Sun, 20 May 2012 21:42:00 +0000"  >&lt;p&gt;I further looked into this with relation to &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-785&quot; title=&quot;Numerical Underflow in ContinuedFraction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-785&quot;&gt;&lt;del&gt;MATH-785&lt;/del&gt;&lt;/a&gt;. First of all, in the original bug report, the reporter mentions that the expected result should be 499999 which is wrong, imho it should be 500000.&lt;/p&gt;

&lt;p&gt;After implementing the modified Lentz-Thompson algorithm, the results for the BinomialDistribution of large trials show correct results.&lt;/p&gt;</comment>
                            <comment id="13279877" author="tn" created="Sun, 20 May 2012 21:55:54 +0000"  >&lt;p&gt;The attached diff file shows the (preliminary) implementation of the modified Lentz-Thompson algorithm.&lt;/p&gt;

&lt;p&gt;Edit: re-uploaded the diff file as it was broken.&lt;/p&gt;

&lt;p&gt;Edit2: the failing unit tests I mentioned before were due to a wrong loop, the latest diff shows no unit test errors.&lt;/p&gt;</comment>
                            <comment id="13280421" author="tn" created="Mon, 21 May 2012 19:56:36 +0000"  >&lt;p&gt;Fixed in r1341171.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12553447">MATH-785</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12528359" name="MATH-718.diff" size="4460" author="tn" created="Sun, 20 May 2012 21:59:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>219484</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 26 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rtf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160410</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>