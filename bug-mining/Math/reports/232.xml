<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:22:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-601] SingularValueDecompositionImpl psuedoinverse is not consistent with Rank calculation</title>
                <link>https://issues.apache.org/jira/browse/MATH-601</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;In the SingularValueDecompositionImpl&apos;s internal private class Solver, a pseudo inverse matrix is calculated:&lt;/p&gt;

&lt;p&gt;In lines 2600-264 we have:&lt;/p&gt;

&lt;p&gt;                if (singularValues&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt; &amp;gt; 0) &lt;/p&gt;
{
                 a = 1 / singularValues[i];
                }
&lt;p&gt; else &lt;/p&gt;
{
                 a = 0;
                }

&lt;p&gt;This is not consistent with the manner in which rank is determined (lines 225 to 233). That is to say a matrix could potentially be rank deficient, yet the psuedoinverse would still include the redundant columns... &lt;/p&gt;

&lt;p&gt;Also, there is the problem of very small singular values which could result in overflow.  &lt;/p&gt;</description>
                <environment>&lt;p&gt;All&lt;/p&gt;</environment>
        <key id="12511394">MATH-601</key>
            <summary>SingularValueDecompositionImpl psuedoinverse is not consistent with Rank calculation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="psteitz">Phil Steitz</assignee>
                                    <reporter username="gsteri1">greg sterijevski</reporter>
                        <labels>
                            <label>Pseudoinverse</label>
                    </labels>
                <created>Thu, 23 Jun 2011 19:31:50 +0000</created>
                <updated>Sat, 24 Mar 2012 16:16:30 +0000</updated>
                            <resolved>Sun, 18 Sep 2011 21:07:04 +0000</resolved>
                                    <version>2.2</version>
                                    <fixVersion>3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>
                            <timeestimate seconds="86400">24h</timeestimate>
                                        <comments>
                            <comment id="13069501" author="joubert" created="Fri, 22 Jul 2011 11:02:05 +0000"  >&lt;p&gt;getRank() employs a local tolerance value to determine if a singular value should be counted.  &lt;/p&gt;

&lt;p&gt;I have attached a patch that moves this tolerance value to a static variable in the main class to be accessed by the Solver in working out the pseudo-inverse.  This tolerance value will also guard against overflow.&lt;/p&gt;</comment>
                            <comment id="13069628" author="gsteri1" created="Fri, 22 Jul 2011 17:23:07 +0000"  >&lt;p&gt;Patch looks good to me... &lt;/p&gt;</comment>
                            <comment id="13069937" author="axelclk" created="Sat, 23 Jul 2011 10:29:01 +0000"  >&lt;p&gt;For reference values try wolfram alpha:&lt;br/&gt;
N[SingularValueDecomposition&lt;span class=&quot;error&quot;&gt;&amp;#91;{{1,2},{1,2}}&amp;#93;&lt;/span&gt;]&lt;/p&gt;

&lt;p&gt;It&apos;s still different.&lt;br/&gt;
See: &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-320&quot; title=&quot;NaN singular value from SVD&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-320&quot;&gt;&lt;del&gt;MATH-320&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13069982" author="gsteri1" created="Sat, 23 Jul 2011 15:33:09 +0000"  >&lt;p&gt;Axel,&lt;/p&gt;

&lt;p&gt;You are correct, while the getRank()  emthods criterion was changed to:&lt;br/&gt;
double tol = FastMath.max(m, n) * singularValues&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; * EPS;&lt;br/&gt;
there is nothing happening at line 591. The moore-penrose will still be not&lt;br/&gt;
consistent to the ranks calculation.&lt;/p&gt;

&lt;p&gt;Line 591 and onwards:&lt;/p&gt;

&lt;p&gt;                if (singularValues&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt; &amp;gt; 0) &lt;/p&gt;
{
                    a = 1 / singularValues[i];
                }
&lt;p&gt; else &lt;/p&gt;
{
                    a = 0;
                }

&lt;p&gt;So the change of the zero criterion is good, there is one more spot to fix.&lt;/p&gt;

&lt;p&gt;I would also put a lower bound on tol:&lt;/p&gt;

&lt;p&gt;tol = FastMath.max(m, n) * singularValues&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; * EPS;&lt;/p&gt;

&lt;p&gt;if( FastMath.abs(tol) &amp;lt; FastMath.sqrt( MathUtils.SAFE_MIN) ){&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;


&lt;p&gt;-Greg&lt;/p&gt;

</comment>
                            <comment id="13069983" author="gsteri1" created="Sat, 23 Jul 2011 15:35:09 +0000"  >&lt;p&gt;Sorry,&lt;/p&gt;

&lt;p&gt;Sent the previous inadvertently,&lt;/p&gt;

&lt;p&gt;f( FastMath.abs(tol) &amp;lt; FastMath.sqrt( MathUtils.SAFE_MIN) ){&lt;br/&gt;
 tol = FastMath.sqrt( MathUtils.SAFE_MIN);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;That should guard against the case of a small matrix with small eigenvalues.&lt;/p&gt;

&lt;p&gt;-Greg&lt;/p&gt;

&lt;p&gt;On Sat, Jul 23, 2011 at 10:31 AM, Greg Sterijevski&lt;/p&gt;
</comment>
                            <comment id="13084556" author="psteitz" created="Sat, 13 Aug 2011 06:24:03 +0000"  >&lt;p&gt;I just committed (r1157336) a modified version of Chris&apos; patch.  Please review, test and confirm that it fixes the issue.&lt;/p&gt;

&lt;p&gt;Changes to the patch:&lt;br/&gt;
0) Incorporated Greg&apos;s suggestion to put a floor on tol&lt;br/&gt;
1) Made tol final, but not static and explicitly passed it to the Solver constructor.  The value depends on instance data so should not be static.&lt;/p&gt;</comment>
                            <comment id="13084559" author="erans" created="Sat, 13 Aug 2011 07:26:46 +0000"  >&lt;p&gt;Also changed &quot;max(m, n)&quot; to &quot;m&quot; in accordance with Greg&apos;s remark on the &quot;dev&quot; ML for other such occurrences (revision 1157342).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12487425" name="SingularValueDecompositionImpl.patch" size="1614" author="joubert" created="Fri, 22 Jul 2011 11:02:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>60261</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ap7r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>60358</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>