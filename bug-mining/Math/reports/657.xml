<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:25:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-1617] FieldLUDecomposition with BigReal throw divide by zero error</title>
                <link>https://issues.apache.org/jira/browse/MATH-1617</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;From &lt;a href=&quot;https://stackoverflow.com/questions/68427448/how-to-find-the-inverse-of-a-matrix-using-apache-commons-math-library-in-java/68427869?noredirect=1#comment120932354_68427869&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/68427448/how-to-find-the-inverse-of-a-matrix-using-apache-commons-math-library-in-java/68427869?noredirect=1#comment120932354_68427869&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;Reproducibleexample&quot;&gt;&lt;/a&gt;Reproducible example&lt;/h3&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.math3.linear.FieldLUDecomposition;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.math3.linear.FieldMatrix;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.math3.linear.MatrixUtils;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.math3.util.BigReal;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;REPREX {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
        BigReal[][] leftMatrixData = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal[][]{
                {&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(0), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(0), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(0)},
                {&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(0), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(0)},
                {&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(0), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(0)},
                {&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigReal(1)},
        };

        FieldMatrix&amp;lt;BigReal&amp;gt; leftMatrix = MatrixUtils.createFieldMatrix(leftMatrixData);
        FieldMatrix&amp;lt;BigReal&amp;gt; leftMatrixInverse = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FieldLUDecomposition&amp;lt;&amp;gt;(leftMatrix)
                .getSolver()
                .getInverse();
&lt;span class=&quot;code-comment&quot;&gt;//  Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; org.apache.commons.math3.exception.MathArithmeticException: zero not allowed here
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//	  at org.apache.commons.math3.util.BigReal.divide(BigReal.java:255)
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//	  at org.apache.commons.math3.util.BigReal.divide(BigReal.java:39)
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//	  at org.apache.commons.math3.linear.FieldLUDecomposition.&amp;lt;init&amp;gt;(FieldLUDecomposition.java:160)
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//	  at stackoverflow.math.matrix.REPREX.main(REPREX.java:18)
&lt;/span&gt;    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a name=&quot;Possiblereason%3A&quot;&gt;&lt;/a&gt;Possible reason:&lt;/h3&gt;

&lt;p&gt;In &lt;tt&gt;FieldLUDecomposition&lt;/tt&gt; line 130-133&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (lu[nonZero][col].equals(field.getZero())) {
                    &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; to select a better permutation choice
&lt;/span&gt;                    ++nonZero;
                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Which produce incorrect result when &lt;tt&gt;lu&lt;span class=&quot;error&quot;&gt;&amp;#91;nonZeror&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;col&amp;#93;&lt;/span&gt;&lt;/tt&gt; the BigDecimal val has different scale &lt;br/&gt;
 to &lt;tt&gt;field.getZero()&lt;/tt&gt; scale. as the &lt;tt&gt;BigReal#equals&lt;/tt&gt; is comparing using &lt;tt&gt;BigDecimal#equals&lt;/tt&gt;&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;Workaround&quot;&gt;&lt;/a&gt;Workaround&lt;/h3&gt;

&lt;p&gt;I tried to copy class &lt;tt&gt;BigReal&lt;/tt&gt; and &lt;tt&gt;BigRealField&lt;/tt&gt; to &lt;tt&gt;FixBigReal&lt;/tt&gt; and &lt;tt&gt;FixBigRealField&lt;/tt&gt; and replace all &lt;tt&gt;BigReal&lt;/tt&gt; to &lt;tt&gt;FixBigReal&lt;/tt&gt; inside. Then override &lt;tt&gt;FixBIgReal#equals&lt;/tt&gt;&#160;and {{FixBIgReal#hashcode&#160;}}as&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; equals(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; other) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; == other) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (other &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; FixBigReal) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; d.compareTo(((FixBigReal) other).d) == 0;
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
    }
...
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; hashCode() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;.hashCode(d.doubleValue());
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Then the below program will not throw error&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.math3.linear.FieldLUDecomposition;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.math3.linear.FieldMatrix;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.math3.linear.MatrixUtils;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.math3.util.BigReal;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MVE {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
        FixBigReal[][] leftMatrixData = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal[][]{
                {&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(0), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(0), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(0)},
                {&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(0), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(0)},
                {&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(0), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(0)},
                {&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(1), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixBigReal(1)},
        };

        FieldMatrix&amp;lt;FixBigReal&amp;gt; leftMatrix = MatrixUtils.createFieldMatrix(leftMatrixData);
        FieldMatrix&amp;lt;FixBigReal&amp;gt; leftMatrixInverse = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FieldLUDecomposition&amp;lt;&amp;gt;(leftMatrix)
                .getSolver()
                .getInverse();
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13390539">MATH-1617</key>
            <summary>FieldLUDecomposition with BigReal throw divide by zero error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="samabcde">Ng Tsz Sum</reporter>
                        <labels>
                    </labels>
                <created>Sun, 18 Jul 2021 11:49:54 +0000</created>
                <updated>Fri, 30 Jul 2021 02:10:55 +0000</updated>
                            <resolved>Sun, 18 Jul 2021 16:41:30 +0000</resolved>
                                    <version>3.6.1</version>
                                    <fixVersion>4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="17382817" author="erans" created="Sun, 18 Jul 2021 12:09:08 +0000"  >&lt;p&gt;Thanks for the report.&lt;br/&gt;
Could you please provide the fix and test case (as a JUnit test) through a patch (&lt;a href=&quot;https://github.com/apache/commons-math/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;, or diff file) against the &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=commons-math.git&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&quot;master&quot; branch&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="17382849" author="samabcde" created="Sun, 18 Jul 2021 14:58:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erans&quot; class=&quot;user-hover&quot; rel=&quot;erans&quot;&gt;erans&lt;/a&gt;&#160;, I tried to push a new branch for PR but found I have no access:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;ERROR: Permission to apache/commons-math.git denied to samabcde.&lt;br/&gt;
 fatal: Could not read from remote repository.&lt;/p&gt;

&lt;p&gt;Please make sure you have the correct access rights&lt;br/&gt;
 and the repository exists.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;So I attached the patch instead.&lt;/p&gt;</comment>
                            <comment id="17382856" author="erans" created="Sun, 18 Jul 2021 15:38:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;I have no access&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;IIUC, you have to create your own fork on GH.&lt;br/&gt;
For sure the &lt;a href=&quot;https://github.com/apache/commons-math/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;repository&lt;/a&gt; exists. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Patch merged in commit 0b56f2cf54c577ee92d1411b2e5ba42a02bf8a02 (&quot;master&quot; branch).  Thanks!&lt;/p&gt;</comment>
                            <comment id="17383349" author="samabcde" created="Mon, 19 Jul 2021 13:48:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erans&quot; class=&quot;user-hover&quot; rel=&quot;erans&quot;&gt;erans&lt;/a&gt;, just revisited my fix, it seems to have some problem as &lt;tt&gt;BigReal#equals&lt;/tt&gt; method is not consistent with &lt;tt&gt;hashCode&lt;/tt&gt;. I am thinking to change &lt;tt&gt;hashCode&lt;/tt&gt; method of &lt;tt&gt;BigReal&lt;/tt&gt; to make both consistent referring to&#160;&lt;a href=&quot;https://github.com/google/auto/issues/411&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/google/auto/issues/411&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17383370" author="samabcde" created="Mon, 19 Jul 2021 14:17:28 +0000"  >&lt;p&gt;Just created PR&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/commons-math/pull/192&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-math/pull/192&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17383425" author="erans" created="Mon, 19 Jul 2021 16:04:45 +0000"  >&lt;p&gt;PR merged in commit 30a2593c2c9808d7ad118d8e120e8ce807df746a (&quot;master&quot; branch).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13030803" name="MATH-1617.patch" size="3730" author="samabcde" created="Sun, 18 Jul 2021 14:55:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 16 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0t3mg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>