<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:23:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-880] Polygon difference produces erronious results in some cases</title>
                <link>https://issues.apache.org/jira/browse/MATH-880</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;The 2D polygon difference method is returning incorrect&lt;br/&gt;
results.  Below is a test case of subtracting two polygons (Sorry,&lt;br/&gt;
this is the simplest case that I could find that duplicates the&lt;br/&gt;
problem).  &lt;/p&gt;

&lt;p&gt;There are three problems with the result. The first is that the first&lt;br/&gt;
point of the first set of vertices is null (and the first point of the&lt;br/&gt;
second set is also null).  The second is that, even if the first null&lt;br/&gt;
points are ignored,  the returned polygon is not the correct result.&lt;br/&gt;
The first and last points are way off, and the remaining points do not&lt;br/&gt;
match the original polygon boundaries.  Additionally, there are two&lt;br/&gt;
holes that are returned in the results.  This subtraction case should&lt;br/&gt;
not have holes.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;&quot;Complex Polygon Difference Test&quot;&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testComplexDifference() {
        Vector2D[][] vertices1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D[][] {
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D[] {
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.08714908223715,  38.370299337260235),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.08709517675004,  38.3702895991413),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.08401538704919,  38.368849330127944),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.08258210430711,  38.367634558585564),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.08251455106665,  38.36763409247078),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.08106599752608,  38.36761621664249),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.08249585300035,  38.36753627557965),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.09075743352184,  38.35914647644972),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.09099945896571,  38.35896264724079),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.09269383800086,  38.34595756121246),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.09638631543191,  38.3457988093121),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.09666417351019,  38.34523360999418),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.1297082145872,  38.337670454923625),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.12971687748956,  38.337669827794684),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.1240820219179,  38.34328502001131),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13084259656404,  38.34017811765017),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13378567942857,  38.33860579180606),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13519557833206,  38.33621054663689),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13545616732307,  38.33614965452864),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13553111202748,  38.33613962818305),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.1356903436448,  38.33610227127048),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13576283227428,  38.33609255422783),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13595870833188,  38.33604606376991),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.1361556630693,  38.3360024198866),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13622408795709,  38.335987048115726),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13696189099994,  38.33581914328681),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13746655304897,  38.33616706665265),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13845973716064,  38.33650776167099),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13950901827667,  38.3368469456463),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14393814424852,  38.337591835857495),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14483839716831,  38.337076122362475),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14565474433601,  38.33769000964429),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14569421179482,  38.3377117256905),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14577067124333,  38.33770883625908),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14600350631684,  38.337714326520995),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14600355139731,  38.33771435193319),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14600369112401,  38.33771443882085),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14600382486884,  38.33771453466096),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14600395205912,  38.33771463904344),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14600407214999,  38.337714751520764),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14600418462749,  38.337714871611695),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14600422249327,  38.337714915811034),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14867838361471,  38.34113888210675),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14923750157374,  38.341582537502575),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14877083250991,  38.34160685841391),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14816667319519,  38.34244232585684),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14797696744586,  38.34248455284745),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14484318014337,  38.34385573215269),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14477919958296,  38.3453797747614),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14202393306448,  38.34464324839456),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14198920640195,  38.344651155237216),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14155207025175,  38.34486424263724),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.1415196143314,  38.344871730519),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14128611910814,  38.34500196593859),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14047850603913,  38.34600084496253),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14045907000337,  38.34601860032171),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14039496493928,  38.346223030432384),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14037626063737,  38.346240203360026),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14030005823724,  38.34646920000705),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13799164754806,  38.34903093011013),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.11045289492762,  38.36801537312368),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.10871471476526,  38.36878044144294),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.10424901707671,  38.374300101757),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.10263482039932,  38.37310041316073),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.09834601753448,  38.373615053823414),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.0979455456843,  38.373578376172475),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.09086514328669,  38.37527884194668),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.09084931407364,  38.37590801712463),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.09081227075944,  38.37526295920463),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.09081378927135,  38.375193883266434)
            }
        };
        PolygonsSet set1 = buildSet(vertices1);

        Vector2D[][] vertices2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D[][] {
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D[] {
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13067558880044,  38.36977255037573),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.12907570488,  38.36817308242706),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.1342774136516,  38.356886880294724),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13090330629757,  38.34664392676211),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13078571364593,  38.344904617518466),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.1315602208914,  38.3447185040846),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.1316336226821,  38.34470643148342),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.134020944832,  38.340936644972885),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13912536387306,  38.335497255122334),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.1396178806582,  38.334878075552126),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14083049696671,  38.33316530644106),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14145252901329,  38.33152722916191),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.1404779335565,  38.32863516047786),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14282712131586,  38.327504432532066),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14616669875488,  38.3237354115015),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14860976050608,  38.315714862457924),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14999277782437,  38.3164932507504),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.15005207194997,  38.316534677663356),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.15508513859612,  38.31878731691609),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.15919938519221,  38.31852743183782),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.16093758658837,  38.31880662005153),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.16099420184912,  38.318825953291594),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.1665411125756,  38.31859497874757),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.16999653861313,  38.32505772048029),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.17475243391698,  38.32594398441148),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.17940844844992,  38.327427213761325),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.20951909541378,  38.330616833491774),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.2155400467941,  38.331746223670336),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.21559881391778,  38.33175551425302),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.21916646426041,  38.332584299620805),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.23863749852285,  38.34778978875795),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.25459855175802,  38.357790570608984),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.25964298227257,  38.356918010203174),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26024593994703,  38.361692743151366),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26146187570015,  38.36311080550837),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26614159359622,  38.36510808579902),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26621342936448,  38.36507942500333),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26652190211962,  38.36494042196722),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26621240678867,  38.365113172030874),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26614057102057,  38.365141832826794),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26380080055299,  38.3660381760273),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26315345241,  38.36670658276421),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26251574942881,  38.367490323488084),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26247873448426,  38.36755266444749),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26234628016698,  38.36787989125406),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.26214559424784,  38.36945909356126),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.25861728442555,  38.37200753430875),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.23905557537864,  38.375405314295904),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.22517251874075,  38.38984691662256),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.22549955153215,  38.3911564273979),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.22434386063355,  38.391476432092134),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.22147729457276,  38.39134652252034),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.22142070120117,  38.391349167741964),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.20665060751588,  38.39475580900313),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.20042268367109,  38.39842558622888),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.17423771242085,  38.402727751805344),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.16756796257476,  38.40913898597597),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.16728283954308,  38.411255399912875),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.16703538220418,  38.41136059866693),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.16725865657685,  38.41013618805954),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.16746107640665,  38.40902614307544),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.16122795307462,  38.39773101873203)
            }
        };
        PolygonsSet set2 = buildSet(vertices2);
        PolygonsSet set  = (PolygonsSet) &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;
RegionFactory&amp;lt;Euclidean2D&amp;gt;().difference(set1.copySelf(),

              set2.copySelf());

        Vector2D[][] verticies = set.getVertices();
        Assert.assertTrue(verticies[0][0] != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        Assert.assertEquals(1, verticies.length);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12611561">MATH-880</key>
            <summary>Polygon difference produces erronious results in some cases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="curtis">Curtis Jensen</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Oct 2012 17:31:37 +0000</created>
                <updated>Mon, 4 Mar 2013 18:53:24 +0000</updated>
                            <resolved>Mon, 22 Oct 2012 19:28:24 +0000</resolved>
                                    <version>3.0</version>
                                    <fixVersion>3.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13475185" author="curtis" created="Fri, 12 Oct 2012 17:35:50 +0000"  >&lt;p&gt;Plot of the input polygons.&lt;/p&gt;</comment>
                            <comment id="13475187" author="curtis" created="Fri, 12 Oct 2012 17:37:04 +0000"  >&lt;p&gt;Attached images of difference results (by themselves and overlayed on the inputs)&lt;/p&gt;</comment>
                            <comment id="13475188" author="curtis" created="Fri, 12 Oct 2012 17:37:37 +0000"  >&lt;p&gt;FYI:  I have discovered, that if I change the decimal precision of the&lt;br/&gt;
input polygons, I get a much better result (no nulls, and it looks&lt;br/&gt;
almost correct).  I changed the inputs to have only 7 digits after the&lt;br/&gt;
decimal place.  Though, it is still the incorrect results (just much&lt;br/&gt;
closer).&lt;/p&gt;</comment>
                            <comment id="13475189" author="curtis" created="Fri, 12 Oct 2012 17:37:51 +0000"  >&lt;p&gt;I&apos;ve also discovered  that if I translate the points to left by 89&lt;br/&gt;
units (I changed 90 to 1), that the results are even better.&lt;/p&gt;</comment>
                            <comment id="13477922" author="luc" created="Wed, 17 Oct 2012 14:43:46 +0000"  >&lt;p&gt;I confirm the issue.&lt;/p&gt;

&lt;p&gt;The null points probably come from the algorithm thinking some boundaries are not closed, i.e. they extend to infinity. This is the way they are represented when transforming from BSP to boundary representation. So the problem is not the nul points by themselves, but trather why the algorithm fails to see the boundary should remain closed here.&lt;/p&gt;

&lt;p&gt;There is probably a numerical problem here. It will require some investigations.&lt;/p&gt;</comment>
                            <comment id="13477960" author="luc" created="Wed, 17 Oct 2012 15:37:15 +0000"  >&lt;p&gt;I have reduced the problem to the following case with fewer points so it is easier to debug:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testIssue880() {

        Vector2D[][] vertices1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D[][] {
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D[] {
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13595870833188,  38.33604606376991),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.14047850603913,  38.34600084496253),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.11045289492762,  38.36801537312368),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.10871471476526,  38.36878044144294),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.10424901707671,  38.374300101757),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.0979455456843,   38.373578376172475),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.09081227075944,  38.37526295920463),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.09081378927135,  38.375193883266434)
            }
        };

        Vector2D[][] vertices2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D[][] {
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D[] {
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13067558880044,  38.36977255037573),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.1342774136516,   38.356886880294724),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.13090330629757,  38.34664392676211),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.15508513859612,  38.31878731691609),
                    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 90.15919938519221,  38.31852743183782),
            }
        };
        PolygonsSet set  =
                (PolygonsSet) &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RegionFactory&amp;lt;Euclidean2D&amp;gt;().difference(buildSet(vertices1),
                                                                          buildSet(vertices2));

        Vector2D[][] verticies = set.getVertices();
        Assert.assertTrue(verticies[0][0] != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        Assert.assertEquals(1, verticies.length);

    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13478022" author="luc" created="Wed, 17 Oct 2012 16:49:06 +0000"  >&lt;p&gt;The problem does not lie in the polygon difference, but in the creation of the first polygon, the one created using buildset(vertices1).&lt;br/&gt;
Instead of being a simple closed shape, it extends to infinity in two branches. This is easily seen by using simple points checks to see which points are inside as follows:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; x = 90.0; x &amp;lt; 90.15; x += 0.0005) {
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; y = 38.33; y &amp;lt; 38.4; y += 0.0005) {
                Vector2D p = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D(x, y);
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (set1.checkPoint(p) == Location.INSIDE) {
                    &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(x + &lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt; + y);
                }
            }
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So we have to fix the polygon building from boundary representation.&lt;/p&gt;</comment>
                            <comment id="13478999" author="luc" created="Thu, 18 Oct 2012 13:41:18 +0000"  >&lt;p&gt;Here are some news about the investigations done on this issue.&lt;/p&gt;

&lt;p&gt;The problem is indeed due to some numerical issues. During the conversion from boundary representation to BSP tree, we build edges from successive pair of points &lt;/p&gt;
{p0, p1}
&lt;p&gt;, &lt;/p&gt;
{p1, p2}
&lt;p&gt;, &lt;/p&gt;
{p2, p3}
&lt;p&gt; ... These edges belong to hyperplanes (i.e. lines) h01, h12, h23 ... These hyperplanes are then inserted into a BSP tree which is built top down. What happens here is that as h12 is inserted in a tree which already contains h01, we compute the intersection of the two hyperplanes and find a point p1&apos; slightly different from p1 due to numerical considerations. This points extends the edge very slightly, and it is considered afterwards to extend on both sides of h01 instead of one side only. So both sides of hyperplane h01 are split by hyperplane h12. The side that should not have been split now contains an additional artificial cut.&lt;/p&gt;

&lt;p&gt;I am still looking for a solution to this. It seems doubtful to be able to completely avoid numerical problems and avoid this extra splitting. However, BSP trees allow extra cut hyperplanes to appear in the tree without belonging to the boundary (this happens for example with non-convex shapes). These extra cut sub-hyperplane simply define two neighboring cells which are both inside or outside the polygon. I am looking at a way to detect this case more efficiently and avoid creating an artificial &quot;inside&quot; cell.&lt;/p&gt;

&lt;p&gt;This is a difficult problem.&lt;/p&gt;</comment>
                            <comment id="13479064" author="curtis" created="Thu, 18 Oct 2012 15:14:24 +0000"  >&lt;p&gt;Thanks for looking into.  We were also seeing problems with the inside detection and figured that there may be some connection between the contains and the difference problems.  We looked through the code to attempt to find the problem.  We soon realized that we would need to appeal to outside help.  So, again, thanks for looking at the problem.&lt;/p&gt;</comment>
                            <comment id="13479093" author="luc" created="Thu, 18 Oct 2012 15:57:55 +0000"  >&lt;p&gt;Curtis, I was wondering if the API we propose for building the polygons is a good one.&lt;br/&gt;
It was created this way because it is dimension-independent and is in fact implemented at a rather high level (in the AbstractRegion class).&lt;/p&gt;

&lt;p&gt;Perhaps we should provide you an additional way to build polygons, which would be 2D-specific and would not lose topologic information like the general case obviously does now. When you build your polygons, do you have some additional knowledge about it? It seems you already have continuous loops and have organized your points in a logical way. Is this always the case? Could we assume that you know how the various segments are connected together, could we assume you always have closed shapes, could we assume you loops around the shapes with the inside on your left? If so, do you think having a dedicated API for 2D-polygons would be useful to you?&lt;/p&gt;</comment>
                            <comment id="13480942" author="luc" created="Sun, 21 Oct 2012 10:04:44 +0000"  >&lt;p&gt;Here is an update about this issue.&lt;/p&gt;

&lt;p&gt;I have created a new constructor using only a simple boundary loop as a sequence of vertices:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    /** Build a polygon from a simple list of vertices.
     * &amp;lt;p&amp;gt;The boundary is provided as a list of points considering to
     * represent the vertices of a simple loop. The interior part of the
     * region is on the left side of &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; path and the exterior is on its
     * right side.&amp;lt;/p&amp;gt;
     * &amp;lt;p&amp;gt;This constructor does not handle polygons with a boundary
     * forming several disconnected paths (such as polygons with holes).&amp;lt;/p&amp;gt;
     * &amp;lt;p&amp;gt;For cases where &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; simple constructor applies, it is expected to
     * be numerically more robust than the {@link #PolygonsSet(Collection) general
     * constructor} using {@link SubHyperplane subhyperplanes}.&amp;lt;/p&amp;gt;
     * &amp;lt;p&amp;gt;If the list is empty, the region will represent the whole
     * space.&amp;lt;/p&amp;gt;
     * @param hyperplaneThickness tolerance below which points are consider to
     * belong to the hyperplane (which is therefore more a slab)
     * @param vertices vertices of the simple loop boundary
     */
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; PolygonsSet(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; hyperplaneThickness, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Vector2D ... vertices) {
      ...
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This constructor avoid the two way conversion: vertices -&amp;gt; hyperplanes -&amp;gt; rebuilt vertices. This two way conversion induces the problem as the vertices rebuilt from hyperplanes intersections are numerically slightly different from the original vertices. It does so by preserving the initial vertices all the way through, so it uses only the the first part of the conversion: vertices -&amp;gt; hyperplanes and never comes backs from hyperplanes to vertices.&lt;/p&gt;

&lt;p&gt;As explained in the javadoc, this constructor does not handle boundaries in several paths. So if for example a polygon with a hole is to be built, then one polygon without the hole and hole itself can be built separately from this constructor, and the final polygon with a hole would be created by subtracting the hole from the polygon. I don&apos;t think the limitation is too cumbersome for users, so I think I will let the API as is.&lt;/p&gt;

&lt;p&gt;This works well on the reduced case I presented in earlier comments above, but currently fails miserably on the initial bug report.&lt;br/&gt;
I am working on it.&lt;/p&gt;</comment>
                            <comment id="13481051" author="luc" created="Sun, 21 Oct 2012 20:11:26 +0000"  >&lt;p&gt;A partial fix for the problem has been committed in subversion as of r1400717.&lt;/p&gt;

&lt;p&gt;There are still some problems with the test case, as shown by two TODO markers in the unit tests.&lt;/p&gt;

&lt;p&gt;Could you check if this fix at least partially works for you?&lt;/p&gt;</comment>
                            <comment id="13481399" author="luc" created="Mon, 22 Oct 2012 14:38:42 +0000"  >&lt;p&gt;Well, the remaining problem is worse than expected. The current version even fails on the simplistic following case:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Vector2D[] vertices = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D[] {
    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D(-6, -4), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D(-8, -8), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D(  8, -8),
    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D( 6, -4), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D(10,  4), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector2D(-10,  4)
};
PolygonsSet set = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PolygonsSet(1.0e-10, vertices);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Still working on it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13481694" author="luc" created="Mon, 22 Oct 2012 19:28:24 +0000"  >&lt;p&gt;Fixed in subversion repository as of r1401022.&lt;/p&gt;

&lt;p&gt;Note that the unit test corresponding to the issue uses a value equal to 1.0e-8 for the hyperplaneThickness parameter. Smaller values do not work due to numerical issues. This new parameter is therefore an important one for such problems and too small values should be avoided.&lt;/p&gt;

&lt;p&gt;There are no definitive value that can be suggested and would work in every case. The appropriate value depends on the polygon (does it have thin pikes or dents, does it have vertices with almost flat angles, does it have independent edges that happen to be almost aligned despite they are not directly connected ..).&lt;/p&gt;

&lt;p&gt;Thanks for reporting the problem.&lt;/p&gt;</comment>
                            <comment id="13487165" author="curtis" created="Tue, 30 Oct 2012 19:54:41 +0000"  >&lt;p&gt;The new PolygonsSet constructor fixes the problems we have been seeing.  So far 1.0e-8 works for all of our cases.  If it ever doesn&apos;t work, we&apos;ll come up with a heuristic for setting the thickness.&lt;/p&gt;

&lt;p&gt;To answer the earlier questions about how we organize our data, we have created a layer on top of Apache Math.  We have developed our own internal API for different general euclidean representations and operations that we use on different projects.   We work both in 3D and 2D coordinate spaces.  Our polygon classes contain a clockwise ordered array of points.  In all cases, our polygons are sequentially connected, fully continuous, and closed (nothing fancy).  We keep track of holes as polygons defined in the same way.  We have methods to convert and order points in many different fashions.  Our 3D space is almost exclusively topographical in nature, so we generally reduce to 2D for most geometric calculations.  In addition to a topographical third dimension we do sometimes keep track of other information on those points (such as a altitude or measurement error value).  The PolygonsSet constructor you have created should work nicely for us.  If there was a way to build 2D polygons but keep the topological information (or other information), that would be nice; though, we are able to work with whatever you provide.&lt;/p&gt;

&lt;p&gt;Because we have an abstraction layer on top of Apache Math, we should be able to adapt to any API that is provided.  Before Apache Math 3, we had a combination of our home grown code and Sun&apos;s Vecmath (Thanks for Apache Math 3; it fixes some limitations we had previously).  In that regard, the API for building polygons is &quot;a good one.&quot;  It does what we need.  As long as there are examples, test cases, and documentation we&apos;ll figure it out.  The Apache Math API has many capabilities we don&apos;t need and so the building of Polygons is probably not as simple as it could be for what we are doing.  Now that you know roughly how we are using it, I&apos;ll leave it up to as to how &quot;good&quot; the API is for building polygons. One limitation I would point out is the absence of non-polygonal shapes like circles/spheres, ellipses/ellipsoids, cylinders, etc.  All in all, we are happy with it and very appreciative.&lt;/p&gt;

&lt;p&gt;Thanks again, and Happy Halloween&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12548927" name="PolygonDiffAll.png" size="56375" author="curtis" created="Fri, 12 Oct 2012 17:37:04 +0000"/>
                            <attachment id="12548928" name="PolygonDiffResults.png" size="38562" author="curtis" created="Fri, 12 Oct 2012 17:37:04 +0000"/>
                            <attachment id="12548926" name="PolygonInputs.png" size="48499" author="curtis" created="Fri, 12 Oct 2012 17:35:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248021</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 3 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09ahz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>52134</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>