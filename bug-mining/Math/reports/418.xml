<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:23:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-1019] &quot;shuffle&quot; method broken (in class &quot;o.a.c.m.random.RandomDataGenerator&quot;)</title>
                <link>https://issues.apache.org/jira/browse/MATH-1019</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;The method does not abide by its contract: elements before the &quot;end&quot; index are included in the shuffle.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;/**
 * Uses a 2-cycle permutation shuffle to randomly re-order the last elements 
 * of list.
 *
 * @param list list to be shuffled
 * @param end element past which shuffling begins
 */
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void shuffle(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[] list, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; end) {
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; target = 0;
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = list.length - 1; i &amp;gt;= end; i--) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (i == 0) { &lt;span class=&quot;code-comment&quot;&gt;// XXX &lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt; should be &lt;span class=&quot;code-quote&quot;&gt;&quot;end&quot;&lt;/span&gt;
&lt;/span&gt;            target = 0; &lt;span class=&quot;code-comment&quot;&gt;// XXX &lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt; should be &lt;span class=&quot;code-quote&quot;&gt;&quot;end&quot;&lt;/span&gt;
&lt;/span&gt;        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-comment&quot;&gt;// NumberIsTooLargeException cannot occur
&lt;/span&gt;            target = nextInt(0, i); &lt;span class=&quot;code-comment&quot;&gt;// XXX &lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt; should be &lt;span class=&quot;code-quote&quot;&gt;&quot;end&quot;&lt;/span&gt;
&lt;/span&gt;        }
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; temp = list[target];
        list[target] = list[i];
        list[i] = temp;
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m going to introduce the above corrections in the new implementation to be located in &quot;MathArrays&quot; (cf. issue &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-1010&quot; title=&quot;Shuffling an array&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-1010&quot;&gt;&lt;del&gt;MATH-1010&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12662726">MATH-1019</key>
            <summary>&quot;shuffle&quot; method broken (in class &quot;o.a.c.m.random.RandomDataGenerator&quot;)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="erans">Gilles Sadowski</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Aug 2013 22:43:33 +0000</created>
                <updated>Mon, 19 May 2014 15:13:32 +0000</updated>
                            <resolved>Sat, 10 Aug 2013 00:26:53 +0000</resolved>
                                                    <fixVersion>3.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13734182" author="erans" created="Thu, 8 Aug 2013 23:35:26 +0000"  >&lt;p&gt;In &quot;RandomDataGenerator&quot;, I tried to replace the use of &quot;shuffle&quot; that appears in &quot;nextPermutation(int n, int k)&quot; (at line 642) by a call to the new &quot;MathArrays.shuffle&quot; (cf. &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-1010&quot; title=&quot;Shuffling an array&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-1010&quot;&gt;&lt;del&gt;MATH-1010&lt;/del&gt;&lt;/a&gt;) but this makes the &quot;testNextSample&quot; unit test fail!&lt;/p&gt;</comment>
                            <comment id="13734748" author="erans" created="Fri, 9 Aug 2013 13:09:32 +0000"  >&lt;p&gt;With the replacement, the unit test &quot;testNextPermutation()&quot; passes but it uses a fully shuffled array where there is no difference in behaviour between the old (in &quot;RandomDataGenerator&quot;) and the fixed (in &quot;MathArrays&quot;) code.&lt;/p&gt;</comment>
                            <comment id="13734885" author="psteitz" created="Fri, 9 Aug 2013 15:18:20 +0000"  >&lt;p&gt;It might be better not to log this and &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-1020&quot; title=&quot;&amp;quot;nextPermutation&amp;quot; method broken (in class &amp;quot;o.a.c.m.random.RandomDataGenerator&amp;quot;)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-1020&quot;&gt;&lt;del&gt;MATH-1020&lt;/del&gt;&lt;/a&gt; as separate issues - i.e., this is just work related to making the formerly private internal method public.  As you note, the bugged API spec / impl does not impact its use in RandomDataGenerator.  Tracking this and &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-1020&quot; title=&quot;&amp;quot;nextPermutation&amp;quot; method broken (in class &amp;quot;o.a.c.m.random.RandomDataGenerator&amp;quot;)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-1020&quot;&gt;&lt;del&gt;MATH-1020&lt;/del&gt;&lt;/a&gt; as issues against 3.2 and reporting their resolution in 3.3 may be misleading to users reading the release notes.  The 3.2 implementation of nextPermutation in RandomDataGenerator performs according to spec and seeing the bug report and resolution in the 3.3 release notes may give users the impression that there is an actual usage-impacting bug in the 3.2 impl, which is not true.  May be best to just note the problem in the other issue (&lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-1010&quot; title=&quot;Shuffling an array&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-1010&quot;&gt;&lt;del&gt;MATH-1010&lt;/del&gt;&lt;/a&gt;) and drop this and &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-1020&quot; title=&quot;&amp;quot;nextPermutation&amp;quot; method broken (in class &amp;quot;o.a.c.m.random.RandomDataGenerator&amp;quot;)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-1020&quot;&gt;&lt;del&gt;MATH-1020&lt;/del&gt;&lt;/a&gt; as separate issues.&lt;/p&gt;</comment>
                            <comment id="13735327" author="erans" created="Fri, 9 Aug 2013 21:23:28 +0000"  >&lt;p&gt;IMHO, the svn log and the bug tracking system are not solely directed to library users.&lt;br/&gt;
Developers too might like to be able to follow why and how code changes.&lt;/p&gt;

&lt;p&gt;I understand your concern, but &quot;historically&quot; &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-1010&quot; title=&quot;Shuffling an array&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-1010&quot;&gt;&lt;del&gt;MATH-1010&lt;/del&gt;&lt;/a&gt; was not meant to fix something, just to move code from one place to another; I fortuitously uncovered the bug because the method was intended to do more than is actually needed in &quot;RandomDataGenerator&quot; (&quot;user&quot; behaviour was indeed fine but &quot;developer&quot; code was misleading).&lt;/p&gt;

&lt;p&gt;In order to not frighten users, I can add a comment in the &quot;changes.xml&quot; file to that effect; i.e. for &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-1020&quot; title=&quot;&amp;quot;nextPermutation&amp;quot; method broken (in class &amp;quot;o.a.c.m.random.RandomDataGenerator&amp;quot;)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-1020&quot;&gt;&lt;del&gt;MATH-1020&lt;/del&gt;&lt;/a&gt;, something like: This bug does not affect applications using a previous version of Commons Math. For this issue, it should be obvious since the method &quot;shuffle&quot; was private.&lt;/p&gt;</comment>
                            <comment id="13735364" author="psteitz" created="Fri, 9 Aug 2013 21:52:43 +0000"  >&lt;p&gt;I like to keep what is in JIRA understandable to users, but I get your point and am OK with keeping these as separate issues as long as you make it clear in changes.xml.  Also, what would you think about changing the affects version to 3.3?  Unfortunately, &quot;nightly builds&quot; does not seem to be an option.&lt;/p&gt;</comment>
                            <comment id="13735377" author="erans" created="Fri, 9 Aug 2013 21:58:26 +0000"  >&lt;p&gt;&quot;Affects Version&quot; entry set to &lt;em&gt;empty&lt;/em&gt; to indicate that the bug does not affect applications.&lt;/p&gt;</comment>
                            <comment id="13736058" author="erans" created="Sat, 10 Aug 2013 21:38:55 +0000"  >&lt;p&gt;The Javadoc for &quot;shuffle&quot; must be updated: a request to the&lt;br/&gt;
reference link&lt;br/&gt;
  &lt;a href=&quot;http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node83.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node83.html&lt;/a&gt;&lt;br/&gt;
replies &quot;Forbidden&quot;.&lt;/p&gt;</comment>
                            <comment id="13736471" author="psteitz" created="Sun, 11 Aug 2013 23:51:16 +0000"  >&lt;p&gt;This looks like a published version of the course notes in the now dead reference:&lt;br/&gt;
&lt;a href=&quot;http://citeseerx.ist.psu.edu/viewdoc/download;?doi=10.1.1.173.1898&amp;amp;rep=rep1&amp;amp;type=pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://citeseerx.ist.psu.edu/viewdoc/download;?doi=10.1.1.173.1898&amp;amp;rep=rep1&amp;amp;type=pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The algorithm is on page 68.  Not sure how long this will be available online, so it may be best just to reference the dead trees version.&lt;/p&gt;</comment>
                            <comment id="13736862" author="erans" created="Mon, 12 Aug 2013 13:35:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt; so it may be best just to reference the dead trees version.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m not sure I understand: Do you suggest to leave an unreachable link in the Javadoc?&lt;/p&gt;

&lt;p&gt;Wouldn&apos;t &lt;a href=&quot;http://en.wikipedia.org/wiki/Fisher&#8211;Yates_shuffle&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this link&lt;/a&gt; be an adequate reference?&lt;/p&gt;</comment>
                            <comment id="13736868" author="psteitz" created="Mon, 12 Aug 2013 13:46:26 +0000"  >&lt;p&gt;Sorry, but the &quot;dead trees version&quot; I meant the published book.  The link above is to a pdf of the book.  I think it is better to stick with this, which is the original reference that describes what we have implemented exactly.  The wikipedia article covers several different algorithms, one of which is similar to what we have.&lt;/p&gt;</comment>
                            <comment id="13736883" author="erans" created="Mon, 12 Aug 2013 14:07:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt; &quot;dead trees version&quot; &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Oh, I got the expression now. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;But I still don&apos;t see the reference; the one in the Javadoc is not a link to a book, and since the link is dead, it couldn&apos;t be more useless.&lt;br/&gt;
Then the one which you mention is a PDF, and IIUC, you said that it might not be reliable to reference that link.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The wikipedia article covers several different algorithms, one of which is similar to what we have.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thus we can put a link to the appropriate &lt;a href=&quot;http://en.wikipedia.org/wiki/Fisher&#8211;Yates_shuffle#The_modern_algorithm&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;section&lt;/a&gt;.&lt;br/&gt;
Also it&apos;s more user-friendly IMO to be redirected to that section than to have to download the whole textbook and refer to a page number.&lt;/p&gt;</comment>
                            <comment id="13736898" author="psteitz" created="Mon, 12 Aug 2013 14:28:08 +0000"  >&lt;p&gt;OK, assuming the section link works and what is described there matches what we have, I agree it is easier.  It would be nice to reference the e-book in any case, as that was the original source. The lecture notes linked in the javadoc were eventually published as the ebook and removed from the university web site.  At least the relevant section matches my recollection of the nice description and justification for the shuffle algorithm in the original link.  I see now that there does not actually appear to be a &quot;dead trees version&quot; after all.  apologies for that &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  I assumed the pdf was an image of a physical book published by the University of Aberdeen.  Looks like it is only distributed as an ebook, generally behind a paywall.  It can be referenced as  &lt;em&gt;Algorithms&lt;/em&gt;, by Ian Craw, John Pulham, University of Aberdeen 1999.&lt;/p&gt;</comment>
                            <comment id="13738273" author="erans" created="Tue, 13 Aug 2013 14:21:41 +0000"  >&lt;p&gt;I hope that changes brought in revision 1513501 are fine.&lt;/p&gt;</comment>
                            <comment id="14001853" author="luc" created="Mon, 19 May 2014 15:13:32 +0000"  >&lt;p&gt;Closing all resolved issue now available in released 3.3 version.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12662855">MATH-1020</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12659780">MATH-1010</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>342728</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 26 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n3tj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343032</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>