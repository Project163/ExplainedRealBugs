<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:23:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-578] Decrease DescriptiveStatistics performance from 2.0 to 2.2</title>
                <link>https://issues.apache.org/jira/browse/MATH-578</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;Switching between commons-math 2.0 to 2.2 we note how the&lt;br/&gt;
DescriptiveStatistics.addValue(double) has decrease the performance.&lt;/p&gt;

&lt;p&gt;I tested with 2 million values.&lt;/p&gt;

&lt;p&gt;DescriptiveStatistics ds = new DescriptiveStatistics();&lt;br/&gt;
for(int i = 0; i&amp;lt;1000*1000*2; i++) { //2 million values&lt;br/&gt;
    ds.addValue(v);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;ds.getPercentile(50);&lt;/p&gt;


&lt;p&gt;Seems that depending by the values inserted in the DescriptiveStatistics it takes different time:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;with a single value (0)
	&lt;ul&gt;
		&lt;li&gt;2.0 -&amp;gt; take ~500 ms&lt;/li&gt;
		&lt;li&gt;2.2 -&amp;gt; take more than 10 minutes&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;with 50% fixed value (0) and 50% Math.random()
	&lt;ul&gt;
		&lt;li&gt;2.0 -&amp;gt; take ~500 ms&lt;/li&gt;
		&lt;li&gt;2.2 -&amp;gt; take ~250000 ms -&amp;gt; ~250 second&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;with 100% Math.random()
	&lt;ul&gt;
		&lt;li&gt;2.0 -&amp;gt; take ~500 ms&lt;/li&gt;
		&lt;li&gt;2.2 -&amp;gt; take ~70 ms&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

</description>
                <environment>&lt;p&gt;Linux&lt;/p&gt;</environment>
        <key id="12507371">MATH-578</key>
            <summary>Decrease DescriptiveStatistics performance from 2.0 to 2.2</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikl">Mikkel Meyer Andersen</assignee>
                                    <reporter username="paolo.repele">Paolo Repele</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 May 2011 14:34:47 +0000</created>
                <updated>Mon, 4 Mar 2013 18:53:25 +0000</updated>
                            <resolved>Sun, 22 Jul 2012 15:01:30 +0000</resolved>
                                    <version>2.2</version>
                                    <fixVersion>3.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13034056" author="mikl" created="Mon, 16 May 2011 15:18:48 +0000"  >&lt;p&gt;Have you tried more detailed profiling? E.g. in Eclipse to see which methods are using the majority of time?&lt;/p&gt;</comment>
                            <comment id="13034061" author="psteitz" created="Mon, 16 May 2011 15:33:54 +0000"  >&lt;p&gt;Thanks for reporting this.  I assume the timings include the percentile calculation, right? &lt;/p&gt;

&lt;p&gt;This could be related to the changes in the Percentile implementation in 2.2. If isolating the timing to just the percentile calculation shows that is where the latency difference is, we should reopen &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-417&quot; title=&quot;improve performance of Percentile&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-417&quot;&gt;&lt;del&gt;MATH-417&lt;/del&gt;&lt;/a&gt;.  The changes there were to improve Percentile performance, which in most cases they do.  The first two results above are disturbing, however.  If your data is largely constant and this creates a problem in your application, as a workaround, you can provide an alternative Percentile implementation to DescriptiveStatistics using setPercentileImpl.&lt;/p&gt;</comment>
                            <comment id="13034067" author="paolo.repele" created="Mon, 16 May 2011 15:45:51 +0000"  >&lt;p&gt;Image file to show the profile snapshot&lt;/p&gt;</comment>
                            <comment id="13034068" author="mikl" created="Mon, 16 May 2011 15:47:55 +0000"  >&lt;p&gt;Sorry for my (too) short first answer. Thanks for your proper introduction, Phil.&lt;/p&gt;

&lt;p&gt;I&apos;ll try a more detailed profiling to see what&apos;s causing the performance problems.&lt;/p&gt;
</comment>
                            <comment id="13034070" author="paolo.repele" created="Mon, 16 May 2011 15:56:37 +0000"  >&lt;p&gt;No Problem &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;yep, the time was only for the getPercentile() method.&lt;/li&gt;
	&lt;li&gt;I added an image where you can see the profile snapshot&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Usually we use this library to analyze some grids. These grids can be very huge and can be generated using the same values for all the cells or a continue function around the grid or any combination of both.&lt;br/&gt;
Then we have really no idea how these grids can be generated.&lt;/p&gt;</comment>
                            <comment id="13034094" author="mikl" created="Mon, 16 May 2011 16:44:35 +0000"  >&lt;p&gt;Also, it seems like FastMath is new to 2.2. I&apos;ll try to investigate what causes this.&lt;/p&gt;</comment>
                            <comment id="13034152" author="mikl" created="Mon, 16 May 2011 17:56:43 +0000"  >&lt;p&gt;As far as I can see, Percentile contributes a lot to the longer execution time, so reopening &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-417&quot; title=&quot;improve performance of Percentile&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-417&quot;&gt;&lt;del&gt;MATH-417&lt;/del&gt;&lt;/a&gt; for datasets of this type might be the right thing to do.&lt;/p&gt;</comment>
                            <comment id="13082179" author="psteitz" created="Wed, 10 Aug 2011 06:35:36 +0000"  >&lt;p&gt;Not sure this is in fact a bug, but rather a feature resulting from overall performance improvements in Percentile (poorer performance for a relatively small number of problem instances).  I do not see it as showstopper for 3.0, so moving to 3.1.&lt;/p&gt;</comment>
                            <comment id="13420032" author="erans" created="Sun, 22 Jul 2012 01:13:17 +0000"  >&lt;p&gt;Please rerun your test when &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-805&quot; title=&quot;Percentile calculation is very slow when input data are constants&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-805&quot;&gt;&lt;del&gt;MATH-805&lt;/del&gt;&lt;/a&gt; has been solved, as it seems that this issue might be caused by the same bug.&lt;/p&gt;</comment>
                            <comment id="13420185" author="tn" created="Sun, 22 Jul 2012 15:01:30 +0000"  >&lt;p&gt;Fixed in r1364318.&lt;br/&gt;
See also &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-805&quot; title=&quot;Percentile calculation is very slow when input data are constants&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-805&quot;&gt;&lt;del&gt;MATH-805&lt;/del&gt;&lt;/a&gt; with a description of the problem.&lt;/p&gt;</comment>
                            <comment id="13420188" author="tn" created="Sun, 22 Jul 2012 15:17:52 +0000"  >&lt;p&gt;I did the provided test myself and indeed it is the same problem and is fixed by the suggested changes.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12560360">MATH-805</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12479338" name="percentile.png" size="28463" author="paolo.repele" created="Mon, 16 May 2011 15:45:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2218</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 17 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rtnj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160448</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>