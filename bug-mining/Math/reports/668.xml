<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:25:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-1674] SimplexSolver incorrectly throws NoFeasibleSolutionException after valid translation of feasible problem</title>
                <link>https://issues.apache.org/jira/browse/MATH-1674</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;During metamorphic testing of the &lt;tt&gt;SimplexSolver&lt;/tt&gt;, we observed that translating a feasible linear programming problem by a random vector occasionally causes the solver to throw a &lt;tt&gt;NoFeasibleSolutionException&lt;/tt&gt;, even though the transformed problem remains theoretically feasible.&lt;/p&gt;

&lt;p&gt;In particular, the test is as follows:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;A feasible LP problem is randomly generated, ensuring that a known feasible point &lt;tt&gt;x&#8320;&lt;/tt&gt; satisfies all constraints.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;The problem is shifted via a variable transformation &lt;tt&gt;x&apos; = x + d&lt;/tt&gt;, where &lt;tt&gt;d&lt;/tt&gt; is a random vector.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Constraints are adjusted accordingly: each constraint &lt;tt&gt;A x &amp;lt;= b&lt;/tt&gt; is transformed to &lt;tt&gt;A x&apos; &amp;lt;= b + A d&lt;/tt&gt;.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;The original and transformed problems are solved independently.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;b&gt;Expected behavior:&lt;/b&gt;&lt;br/&gt;
Since &lt;tt&gt;x&#8320;&lt;/tt&gt; is feasible for the original problem, {{x&#8320; + d}} should be feasible for the shifted problem. Therefore, the shifted problem should always have a feasible solution.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Actual behavior:&lt;/b&gt;&lt;br/&gt;
After ~2700 random tests, in some cases, solving the shifted problem results in a &lt;tt&gt;NoFeasibleSolutionException&lt;/tt&gt;. This suggests that &lt;tt&gt;SimplexSolver&lt;/tt&gt; may have issues handling feasible translated problems, potentially due to numerical instability or bugs during the Phase 1 process.&lt;/p&gt;</description>
                <environment>&lt;ul&gt;
	&lt;li&gt;Java version: Java 8&lt;/li&gt;
	&lt;li&gt;Platform: Windows&lt;/li&gt;
&lt;/ul&gt;
</environment>
        <key id="13616497">MATH-1674</key>
            <summary>SimplexSolver incorrectly throws NoFeasibleSolutionException after valid translation of feasible problem</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="zrfc">Li Qu</reporter>
                        <labels>
                    </labels>
                <created>Sun, 27 Apr 2025 11:11:48 +0000</created>
                <updated>Wed, 14 May 2025 07:29:07 +0000</updated>
                                            <version>4.0-beta1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17948630" author="erans" created="Thu, 1 May 2025 07:30:46 +0000"  >&lt;p&gt;Thanks for the report.&lt;/p&gt;

&lt;p&gt;Could you please provide a patch wrt the &lt;a href=&quot;https://github.com/apache/commons-math/blob/master/commons-math-legacy/src/test/java/org/apache/commons/math4/legacy/optim/linear/SimplexSolverTest.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;corresponding file&lt;/a&gt; in the Junit test suite (defining the new test method with a name&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; such as  &lt;tt&gt;testMath1674&lt;/tt&gt;)?&lt;/p&gt;

&lt;p&gt;The failing case should be &quot;isolated&quot;; i.e. rather than loop over thousands of tests (that pass), the unit test should contain the one test that fails.  The coefficients, for example, should be hard-coded in the source file&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; rather than depend on being arrived at through a generated sequence of numbers.&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Minor nit-pick (but helpful for reviewers): Please declare variables &quot;final&quot; (wherever possible).&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; Alternatively, you could keep &lt;tt&gt;testMetamorphicTranslationInvariant&lt;/tt&gt;, if a (code) comment contains this report&apos;s identifier (&quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-1674&quot; title=&quot;SimplexSolver incorrectly throws NoFeasibleSolutionException after valid translation of feasible problem&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-1674&quot;&gt;MATH-1674&lt;/a&gt;&quot;).&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; Or read from a simple text &quot;resource&quot; file (see examples of this in the non-linear optimization &lt;a href=&quot;https://github.com/apache/commons-math/tree/master/commons-math-legacy/src/test/resources/org/apache/commons/math4/legacy/optim/nonlinear/scalar/noderiv&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;resource directory&lt;/a&gt;).&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; A sequence that is obviously tied to a specific pseudo-random number generator.&lt;/p&gt;</comment>
                            <comment id="17950828" author="JIRAUSER309523" created="Mon, 12 May 2025 04:27:27 +0000"  >&lt;p&gt;Thanks for the response.&lt;/p&gt;

&lt;p&gt;As requested, I&apos;ve attached a new patch that adds a regression test for the issue.&lt;/p&gt;</comment>
                            <comment id="17951001" author="erans" created="Mon, 12 May 2025 15:44:33 +0000"  >&lt;p&gt;The patch file tries to add a new file at a wrong location.&lt;br/&gt;
As this is just a new testcase to an existing functionality, the unit tests file already exists (cf. link in my previous comment); the new &quot;testMath1674&quot; should have been added there (done now).&lt;/p&gt;

&lt;p&gt;The failure is related to using the default constructor; as it happens, the generated problem requires a larger tolerance than the default: Your test fails with 1e-6 but passes with 1e-5 (see commit 7be143d11ca393afdb33a6522c8149f4d6f1ff42 on &quot;master&quot; branch).&lt;/p&gt;

&lt;p&gt;Maybe you were expecting that the tolerance should adapt to the problem definition. If possible &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, that would be a new feature.&lt;/p&gt;</comment>
                            <comment id="17951097" author="JIRAUSER309523" created="Tue, 13 May 2025 03:53:02 +0000"  >&lt;p&gt;Sorry about placing the patch incorrectly&#8212;thanks for correcting that and integrating the test case.&lt;/p&gt;

&lt;p&gt;I fully understand your explanation that the root cause here relates to numerical precision and tolerance settings. From a mathematical perspective, however, it feels somewhat counterintuitive that two equivalent sets of constraints and objectives would require manual adjustment of tolerance settings to produce identical feasibility results.&lt;/p&gt;

&lt;p&gt;As you&apos;ve mentioned, an adaptive tolerance mechanism&#8212;if feasible to implement&#8212;would indeed be a better solution.&lt;/p&gt;

&lt;p&gt;Thanks again for your help and clarification!&lt;/p&gt;</comment>
                            <comment id="17951353" author="erans" created="Wed, 14 May 2025 07:29:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;it feels somewhat counterintuitive that two equivalent sets of constraints and objectives would require manual adjustment of tolerance settings to produce identical feasibility results.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;AFAICT, your unit test does not expect them to be &lt;em&gt;identical&lt;/em&gt;  since it sets a relatively lax tolerance (1e-4).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;adaptive tolerance mechanism &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt; would indeed be a better solution.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;You could contribute an analysis about how a sequence of transformations (expressed in parametric form) impacts the accuracy (&quot;equality&quot;) of the result (and the tolerance required to avoid the observed failure).&lt;br/&gt;
Then maybe, it&apos;ll give you hints on how to devise an automated scaling procedure...&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13076465" name="MATH-1674.patch" size="196000" author="zrfc" created="Mon, 12 May 2025 04:25:40 +0000"/>
                            <attachment id="13076299" name="reproduction.patch" size="8982" author="zrfc" created="Mon, 28 Apr 2025 14:39:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            25 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1vkow:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314621" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>difficulty-level</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="14062"><![CDATA[Easy]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>