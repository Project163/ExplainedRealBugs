diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 0baae6da2..260e32506 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -52,6 +52,10 @@ If the output is not quite correct, check for invisible trailing spaces!
   <body>
     <release version="3.1" date="TBD" description="
 ">
+      <action dev="tn" type="fix" issue="MATH-578">
+        Improve performance of quantile evaluation in Percentile class for cases
+        with lots of equal values.
+      </action>
       <action dev="erans" type="add" issue="MATH-797">
         New framework for Gauss integration schemes (in package
         "o.a.c.m.analysis.integration.gauss").
diff --git a/src/main/java/org/apache/commons/math3/stat/descriptive/rank/Percentile.java b/src/main/java/org/apache/commons/math3/stat/descriptive/rank/Percentile.java
index 7220cb4d3..2095c3bde 100644
--- a/src/main/java/org/apache/commons/math3/stat/descriptive/rank/Percentile.java
+++ b/src/main/java/org/apache/commons/math3/stat/descriptive/rank/Percentile.java
@@ -333,11 +333,11 @@ public class Percentile extends AbstractUnivariateStatistic implements Serializa
             } else if (k < pivot) {
                 // the element is in the left partition
                 end  = pivot;
-                node = Math.min(2 * node + 1, pivotsHeap.length); // the min is here to avoid integer overflow
+                node = FastMath.min(2 * node + 1, pivotsHeap.length); // the min is here to avoid integer overflow
             } else {
                 // the element is in the right partition
                 begin = pivot + 1;
-                node  = Math.min(2 * node + 2, pivotsHeap.length); // the min is here to avoid integer overflow
+                node  = FastMath.min(2 * node + 2, pivotsHeap.length); // the min is here to avoid integer overflow
             }
 
         }
@@ -401,10 +401,10 @@ public class Percentile extends AbstractUnivariateStatistic implements Serializa
         int i = begin + 1;
         int j = end - 1;
         while (i < j) {
-            while ((i < j) && (work[j] >= value)) {
+            while ((i < j) && (work[j] > value)) {
                 --j;
             }
-            while ((i < j) && (work[i] <= value)) {
+            while ((i < j) && (work[i] < value)) {
                 ++i;
             }
 
