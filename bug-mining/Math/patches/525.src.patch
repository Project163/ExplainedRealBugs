diff --git a/src/test/java/org/apache/commons/math4/ml/neuralnet/sofm/KohonenUpdateActionTest.java b/src/test/java/org/apache/commons/math4/ml/neuralnet/sofm/KohonenUpdateActionTest.java
index 9051dd65e..7a064cfc0 100644
--- a/src/test/java/org/apache/commons/math4/ml/neuralnet/sofm/KohonenUpdateActionTest.java
+++ b/src/test/java/org/apache/commons/math4/ml/neuralnet/sofm/KohonenUpdateActionTest.java
@@ -87,7 +87,7 @@ public class KohonenUpdateActionTest {
 
         Assert.assertEquals(bestBefore, bestAfter);
         // Distance is now zero.
-        Assert.assertEquals(0, dist.compute(bestAfter.getFeatures(), features), 0d);
+        Assert.assertEquals(0, dist.compute(bestAfter.getFeatures(), features), 1e-16);
 
         for (int i = 0; i < netSize; i++) {
             // All distances have decreased.
