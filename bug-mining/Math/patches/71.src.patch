diff --git a/src/test/java/org/apache/commons/math/TestUtils.java b/src/test/java/org/apache/commons/math/TestUtils.java
index 59f30b723..b2a7c8c3e 100644
--- a/src/test/java/org/apache/commons/math/TestUtils.java
+++ b/src/test/java/org/apache/commons/math/TestUtils.java
@@ -169,8 +169,8 @@ public class TestUtils {
         } else if (expected == 0.0) {
             Assert.assertEquals(msg, actual, expected, relativeError);
         } else {
-            double x = Math.abs((expected - actual) / expected);
-            Assert.assertEquals(msg, 0.0, x, relativeError);
+            double absError = Math.abs(expected) * relativeError;
+            Assert.assertEquals(msg, expected, actual, absError);
         }
     }
 
