diff --git a/build.gradle b/build.gradle
index 55339ce6a..431594574 100644
--- a/build.gradle
+++ b/build.gradle
@@ -31,6 +31,7 @@ buildscript {
       ],
       android_support: 'com.android.support:support-v4:28.0.0',
       clikt: 'com.github.ajalt:clikt:2.3.0',
+      curtains: 'com.squareup.curtains:curtains:1.0.1',
       jline: 'jline:jline:2.14.6',
       detekt: 'io.gitlab.arturbosch.detekt:detekt-gradle-plugin:1.6.0',
       junit: 'junit:junit:4.12',
diff --git a/leakcanary-object-watcher-android/build.gradle b/leakcanary-object-watcher-android/build.gradle
index 1bfd62ef4..19664ec68 100644
--- a/leakcanary-object-watcher-android/build.gradle
+++ b/leakcanary-object-watcher-android/build.gradle
@@ -5,6 +5,7 @@ dependencies {
   api project(':leakcanary-object-watcher')
   api project(':leakcanary-android-utils')
 
+  implementation deps.curtains
   implementation deps.kotlin.stdlib
 
   testImplementation deps.assertj_core
diff --git a/leakcanary-object-watcher-android/src/main/java/leakcanary/RootViewWatcher.kt b/leakcanary-object-watcher-android/src/main/java/leakcanary/RootViewWatcher.kt
index 5ee8cffd5..4fbf1d535 100644
--- a/leakcanary-object-watcher-android/src/main/java/leakcanary/RootViewWatcher.kt
+++ b/leakcanary-object-watcher-android/src/main/java/leakcanary/RootViewWatcher.kt
@@ -15,12 +15,22 @@
  */
 package leakcanary
 
-import android.annotation.SuppressLint
-import android.os.Build
+import android.app.Activity
+import android.app.Dialog
 import android.view.View
 import android.view.View.OnAttachStateChangeListener
+import com.squareup.leakcanary.objectwatcher.R
+import curtains.Curtains
+import curtains.OnRootViewAddedListener
+import curtains.WindowType.PHONE_WINDOW
+import curtains.WindowType.POPUP_WINDOW
+import curtains.WindowType.TOAST
+import curtains.WindowType.TOOLTIP
+import curtains.WindowType.UNKNOWN
+import curtains.phoneWindow
+import curtains.windowType
+import curtains.wrappedCallback
 import leakcanary.internal.friendly.mainHandler
-import shark.SharkLog
 
 /**
  * Expects root views to become weakly reachable soon after they are removed from the window
@@ -30,65 +40,46 @@ class RootViewWatcher(
   private val reachabilityWatcher: ReachabilityWatcher
 ) : InstallableWatcher {
 
-  override fun install() {
-    if (Build.VERSION.SDK_INT < 19) {
-      return
-    }
-    swapViewManagerGlobalMViews { mViews ->
-      object : ArrayList<View>(mViews) {
-        override fun add(element: View): Boolean {
-          onRootViewAdded(element)
-          return super.add(element)
+  private val listener = OnRootViewAddedListener { rootView ->
+    val trackDetached = when(rootView.windowType) {
+      PHONE_WINDOW -> {
+        when (rootView.phoneWindow?.callback?.wrappedCallback) {
+          // Activities are already tracked by ActivityWatcher
+          is Activity -> false
+          is Dialog -> rootView.resources.getBoolean(R.bool.leak_canary_watcher_watch_dismissed_dialogs)
+          // Probably a DreamService
+          else -> true
         }
       }
+      // Android widgets keep detached popup window instances around.
+      POPUP_WINDOW -> false
+      TOOLTIP, TOAST, UNKNOWN -> true
     }
-  }
-
-  override fun uninstall() {
-    if (Build.VERSION.SDK_INT < 19) {
-      return
-    }
-    swapViewManagerGlobalMViews { mViews ->
-      ArrayList(mViews)
-    }
-  }
+    if (trackDetached) {
+      rootView.addOnAttachStateChangeListener(object : OnAttachStateChangeListener {
 
-  @SuppressLint("PrivateApi")
-  @Suppress("FunctionName")
-  private fun swapViewManagerGlobalMViews(swap: (ArrayList<View>) -> ArrayList<View>) {
-    try {
-      val windowManagerGlobalClass = Class.forName("android.view.WindowManagerGlobal")
-      val windowManagerGlobalInstance =
-        windowManagerGlobalClass.getDeclaredMethod("getInstance").invoke(null)
-
-      val mViewsField =
-        windowManagerGlobalClass.getDeclaredField("mViews").apply { isAccessible = true }
+        val watchDetachedView = Runnable {
+          reachabilityWatcher.expectWeaklyReachable(
+            rootView, "${rootView::class.java.name} received View#onDetachedFromWindow() callback"
+          )
+        }
 
-      @Suppress("UNCHECKED_CAST")
-      val mViews = mViewsField[windowManagerGlobalInstance] as ArrayList<View>
+        override fun onViewAttachedToWindow(v: View) {
+          mainHandler.removeCallbacks(watchDetachedView)
+        }
 
-      mViewsField[windowManagerGlobalInstance] = swap(mViews)
-    } catch (ignored: Throwable) {
-      SharkLog.d(ignored) { "Could not watch detached root views" }
+        override fun onViewDetachedFromWindow(v: View) {
+          mainHandler.post(watchDetachedView)
+        }
+      })
     }
   }
 
-  private fun onRootViewAdded(rootView: View) {
-    rootView.addOnAttachStateChangeListener(object : OnAttachStateChangeListener {
-
-      val watchDetachedView = Runnable {
-        reachabilityWatcher.expectWeaklyReachable(
-          rootView, "${rootView::class.java.name} received View#onDetachedFromWindow() callback"
-        )
-      }
-
-      override fun onViewAttachedToWindow(v: View) {
-        mainHandler.removeCallbacks(watchDetachedView)
-      }
+  override fun install() {
+    Curtains.onRootViewsChangedListeners += listener
+  }
 
-      override fun onViewDetachedFromWindow(v: View) {
-        mainHandler.post(watchDetachedView)
-      }
-    })
+  override fun uninstall() {
+    Curtains.onRootViewsChangedListeners -= listener
   }
 }
diff --git a/leakcanary-object-watcher-android/src/main/res/values/leak_canary_public.xml b/leakcanary-object-watcher-android/src/main/res/values/leak_canary_public.xml
index 18f26d324..762a5bc47 100644
--- a/leakcanary-object-watcher-android/src/main/res/values/leak_canary_public.xml
+++ b/leakcanary-object-watcher-android/src/main/res/values/leak_canary_public.xml
@@ -1,4 +1,5 @@
 <?xml version="1.0" encoding="utf-8"?>
 <resources>
   <public name="leak_canary_watcher_auto_install" type="bool"/>
+  <public name="leak_canary_watcher_watch_dismissed_dialogs" type="bool"/>
 </resources>
diff --git a/leakcanary-object-watcher-android/src/main/res/values/watcher_bools.xml b/leakcanary-object-watcher-android/src/main/res/values/watcher_bools.xml
index e550b45bf..20d639eaf 100644
--- a/leakcanary-object-watcher-android/src/main/res/values/watcher_bools.xml
+++ b/leakcanary-object-watcher-android/src/main/res/values/watcher_bools.xml
@@ -4,4 +4,5 @@
    If false, you need to call AppWatcher.manualInstall().
    -->
   <bool name="leak_canary_watcher_auto_install">true</bool>
+  <bool name="leak_canary_watcher_watch_dismissed_dialogs">false</bool>
 </resources>
