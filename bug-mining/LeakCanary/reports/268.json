{"url":"https://api.github.com/repos/square/leakcanary/issues/2478","repository_url":"https://api.github.com/repos/square/leakcanary","labels_url":"https://api.github.com/repos/square/leakcanary/issues/2478/labels{/name}","comments_url":"https://api.github.com/repos/square/leakcanary/issues/2478/comments","events_url":"https://api.github.com/repos/square/leakcanary/issues/2478/events","html_url":"https://github.com/square/leakcanary/issues/2478","id":1588524720,"node_id":"I_kwDOAhNhM85ervaw","number":2478,"title":"Leak in InputMethodManager","user":{"login":"sanura-njaka","id":40278046,"node_id":"MDQ6VXNlcjQwMjc4MDQ2","avatar_url":"https://avatars.githubusercontent.com/u/40278046?v=4","gravatar_id":"","url":"https://api.github.com/users/sanura-njaka","html_url":"https://github.com/sanura-njaka","followers_url":"https://api.github.com/users/sanura-njaka/followers","following_url":"https://api.github.com/users/sanura-njaka/following{/other_user}","gists_url":"https://api.github.com/users/sanura-njaka/gists{/gist_id}","starred_url":"https://api.github.com/users/sanura-njaka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sanura-njaka/subscriptions","organizations_url":"https://api.github.com/users/sanura-njaka/orgs","repos_url":"https://api.github.com/users/sanura-njaka/repos","events_url":"https://api.github.com/users/sanura-njaka/events{/privacy}","received_events_url":"https://api.github.com/users/sanura-njaka/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":236245157,"node_id":"MDU6TGFiZWwyMzYyNDUxNTc=","url":"https://api.github.com/repos/square/leakcanary/labels/type:%20leak","name":"type: leak","color":"f9ee02","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/square/leakcanary/milestones/26","html_url":"https://github.com/square/leakcanary/milestone/26","labels_url":"https://api.github.com/repos/square/leakcanary/milestones/26/labels","id":8646148,"node_id":"MI_kwDOAhNhM84Ag-4E","number":26,"title":"2.11","description":"","creator":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":7,"state":"closed","created_at":"2022-11-11T14:36:09Z","updated_at":"2023-05-18T00:20:51Z","due_on":null,"closed_at":"2023-05-18T00:20:51Z"},"comments":1,"created_at":"2023-02-16T23:39:34Z","updated_at":"2023-05-17T23:57:33Z","closed_at":"2023-05-17T23:57:33Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Please see the following _internal_ bugs filed with Android Jetpack Fragment both with very similar leak traces to the one shown below:\r\n\r\nhttps://b.corp.google.com/issues/266749605 (Leak trace below pasted from this bug)\r\nhttps://b.corp.google.com/issues/267242355\r\n\r\n### LeakTrace information\r\n\r\n```\r\nleakcanary.NoLeakAssertionFailedError: Application memory leaks were detected:\r\n====================================\r\nHEAP ANALYSIS RESULT\r\n====================================\r\n1 APPLICATION LEAKS\r\n\r\nReferences underlined with \"~~~\" are likely causes.\r\nLearn more at https://squ.re/leaks.\r\n\r\n284221 bytes retained by leaking objects\r\nSignature: 4f5d3e652eeacb84138b7a40e62b473fe98037ce\r\n┬───\r\n│ GC Root: System class\r\n│\r\n├─ android.view.inputmethod.InputMethodManager class\r\n│    Leaking: NO (InputMethodManager↓ is not leaking and a class is never leaking)\r\n│    ↓ static InputMethodManager.sInstance\r\n├─ android.view.inputmethod.InputMethodManager instance\r\n│    Leaking: NO (InputMethodManager is a singleton)\r\n│    ↓ InputMethodManager.mNextServedView\r\n│                         ~~~~~~~~~~~~~~~\r\n├─ com.android.internal.policy.DecorView instance\r\n│    Leaking: YES (View.mContext references a destroyed activity)\r\n│    Retaining 284.2 kB in 1470 objects\r\n│    View not part of a window view hierarchy\r\n│    View.mAttachInfo is null (view detached)\r\n│    View.mWindowAttachCount = 1\r\n│    mContext instance of com.android.internal.policy.DecorContext, wrapping activity androidx.fragment.app.test.EmptyFragmentTestActivity with mDestroyed = true\r\n│    ↓ DecorView.mWindow\r\n├─ com.android.internal.policy.PhoneWindow instance\r\n│    Leaking: YES (DecorView↑ is leaking and Window#mDestroyed is true)\r\n│    Retaining 14.5 kB in 308 objects\r\n│    mCallback instance of androidx.fragment.app.test.EmptyFragmentTestActivity with mDestroyed = true\r\n│    mContext instance of androidx.fragment.app.test.EmptyFragmentTestActivity with mDestroyed = true\r\n│    mOnWindowDismissedCallback instance of androidx.fragment.app.test.EmptyFragmentTestActivity with mDestroyed = true\r\n│    ↓ Window.mCallback\r\n╰→ androidx.fragment.app.test.EmptyFragmentTestActivity instance\r\n​     Leaking: YES (ObjectWatcher was watching this because androidx.fragment.app.test.EmptyFragmentTestActivity received Activity#onDestroy() callback and Activity#mDestroyed is true)\r\n​     Retaining 7.4 kB in 225 objects\r\n​     key = 17c2cf1b-4cbe-4f2b-b7bf-e77a92bd3351\r\n​     watchDurationMillis = 5028\r\n​     retainedDurationMillis = 27\r\n​     mApplication instance of androidx.fragment.app.LeakCanaryApp\r\n​     mBase instance of android.app.ContextImpl\r\n====================================\r\n0 LIBRARY LEAKS\r\n\r\nA Library Leak is a leak caused by a known bug in 3rd party code that you do not have control over.\r\nSee https://square.github.io/leakcanary/fundamentals-how-leakcanary-works/#4-categorizing-leaks\r\n====================================\r\n0 UNREACHABLE OBJECTS\r\n\r\nAn unreachable object is still in memory but LeakCanary could not find a strong reference path\r\nfrom GC roots.\r\n====================================\r\nMETADATA\r\n\r\nPlease include this in bug reports and Stack Overflow questions.\r\n\r\nBuild.VERSION.SDK_INT: 33\r\nBuild.MANUFACTURER: Google\r\nLeakCanary version: 2.8.1\r\nApp process name: androidx.fragment.test\r\nCount of retained yet cleared: 1 KeyedWeakReference instances\r\nStats: LruCache[maxSize=3000,hits=110598,misses=183001,hitRate=37%] RandomAccess[bytes=9101979,reads=183001,travel=54521103066,range=34160399,size=42299208]\r\nAnalysis duration: 18998 ms\r\nHeap dump file path: /data/user/0/androidx.fragment.test/files/instrumentation_tests_2023-01-20_01-08-48_325.hprof\r\nHeap dump timestamp: 1674176954549\r\nHeap dump duration: 2128 ms\r\n====================================\r\n\tat leakcanary.NoLeakAssertionFailedError$Companion$throwOnApplicationLeaks$1.reportHeapAnalysis(NoLeakAssertionFailedError.kt:25)\r\n\tat leakcanary.AndroidDetectLeaksAssert.assertNoLeaks(AndroidDetectLeaksAssert.kt:69)\r\n\tat leakcanary.LeakAssertions.assertNoLeaks(LeakAssertions.kt:21)\r\n\tat leakcanary.DetectLeaksAfterTestSuccess$apply$1.evaluate(DetectLeaksAfterTestSuccess.kt:22)\r\n\tat org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n\tat org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n\tat org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n\tat org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n\tat org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n\tat org.junit.runners.Suite.runChild(Suite.java:128)\r\n\tat org.junit.runners.Suite.runChild(Suite.java:27)\r\n\tat org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n\tat org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n\tat org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n\tat org.junit.runners.Suite.runChild(Suite.java:128)\r\n\tat org.junit.runners.Suite.runChild(Suite.java:27)\r\n\tat org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n\tat org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n\tat org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n\tat org.junit.runner.JUnitCore.run(JUnitCore.java:137)\r\n\tat org.junit.runner.JUnitCore.run(JUnitCore.java:115)\r\n\tat androidx.test.internal.runner.TestExecutor.execute(TestExecutor.java:67)\r\n\tat androidx.test.internal.runner.TestExecutor.execute(TestExecutor.java:58)\r\n\tat androidx.test.runner.AndroidJUnitRunner.onStart(AndroidJUnitRunner.java:446)\r\n\tat android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:2361)\r\n\r\n```\r\n","closed_by":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/2478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/square/leakcanary/issues/2478/timeline","performed_via_github_app":null,"state_reason":"completed"}