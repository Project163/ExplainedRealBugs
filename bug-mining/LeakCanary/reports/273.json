{"url":"https://api.github.com/repos/square/leakcanary/issues/2592","repository_url":"https://api.github.com/repos/square/leakcanary","labels_url":"https://api.github.com/repos/square/leakcanary/issues/2592/labels{/name}","comments_url":"https://api.github.com/repos/square/leakcanary/issues/2592/comments","events_url":"https://api.github.com/repos/square/leakcanary/issues/2592/events","html_url":"https://github.com/square/leakcanary/issues/2592","id":2049408308,"node_id":"I_kwDOAhNhM856J300","number":2592,"title":"InputMethodManager.mImeInsetsConsumer leaking in API 30","user":{"login":"jbw0033","id":17055233,"node_id":"MDQ6VXNlcjE3MDU1MjMz","avatar_url":"https://avatars.githubusercontent.com/u/17055233?v=4","gravatar_id":"","url":"https://api.github.com/users/jbw0033","html_url":"https://github.com/jbw0033","followers_url":"https://api.github.com/users/jbw0033/followers","following_url":"https://api.github.com/users/jbw0033/following{/other_user}","gists_url":"https://api.github.com/users/jbw0033/gists{/gist_id}","starred_url":"https://api.github.com/users/jbw0033/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbw0033/subscriptions","organizations_url":"https://api.github.com/users/jbw0033/orgs","repos_url":"https://api.github.com/users/jbw0033/repos","events_url":"https://api.github.com/users/jbw0033/events{/privacy}","received_events_url":"https://api.github.com/users/jbw0033/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":236245157,"node_id":"MDU6TGFiZWwyMzYyNDUxNTc=","url":"https://api.github.com/repos/square/leakcanary/labels/type:%20leak","name":"type: leak","color":"f9ee02","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/square/leakcanary/milestones/29","html_url":"https://github.com/square/leakcanary/milestone/29","labels_url":"https://api.github.com/repos/square/leakcanary/milestones/29/labels","id":9599597,"node_id":"MI_kwDOAhNhM84Aknpt","number":29,"title":"2.13","description":"","creator":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":8,"state":"closed","created_at":"2023-06-29T16:42:45Z","updated_at":"2024-01-03T00:09:37Z","due_on":null,"closed_at":"2024-01-03T00:09:37Z"},"comments":0,"created_at":"2023-12-19T20:46:29Z","updated_at":"2024-01-02T18:27:54Z","closed_at":"2024-01-02T16:22:12Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Same issue that was seen in #2542 on API 31+. Maybe it should be tagged for 30 as well.\r\n\r\n### LeakTrace information\r\n\r\n```\r\nleakcanary.NoLeakAssertionFailedError: Application memory leaks were detected:\r\n====================================\r\nHEAP ANALYSIS RESULT\r\n====================================\r\n1 APPLICATION LEAKS\r\n\r\nReferences underlined with \"~~~\" are likely causes.\r\nLearn more at https://squ.re/leaks.\r\n\r\n1031302 bytes retained by leaking objects\r\nDisplaying only 1 leak trace out of 2 with the same signature\r\nSignature: 50cecf817eeb5767395b498c721604d069d469eb\r\n┬───\r\n│ GC Root: System class\r\n│\r\n├─ android.view.inputmethod.InputMethodManager class\r\n│    Leaking: NO (InputMethodManager↓ is not leaking and a class is never leaking)\r\n│    ↓ static InputMethodManager.sInstance\r\n├─ android.view.inputmethod.InputMethodManager instance\r\n│    Leaking: NO (InputMethodManager is a singleton)\r\n│    ↓ InputMethodManager.mImeInsetsConsumer\r\n│                         ~~~~~~~~~~~~~~~~~~\r\n├─ android.view.ImeInsetsSourceConsumer instance\r\n│    Leaking: UNKNOWN\r\n│    Retaining 518.3 kB in 2585 objects\r\n│    ↓ InsetsSourceConsumer.mController\r\n│                           ~~~~~~~~~~~\r\n├─ android.view.InsetsController instance\r\n│    Leaking: UNKNOWN\r\n│    Retaining 517.5 kB in 2554 objects\r\n│    ↓ InsetsController.mHandler\r\n│                       ~~~~~~~~\r\n├─ android.view.ViewRootImpl$ViewRootHandler instance\r\n│    Leaking: UNKNOWN\r\n│    Retaining 32 B in 1 objects\r\n│    ↓ ViewRootImpl$ViewRootHandler.this$0\r\n│                                   ~~~~~~\r\n├─ android.view.ViewRootImpl instance\r\n│    Leaking: YES (ViewRootImpl#mView is null)\r\n│    Retaining 515.7 kB in 2490 objects\r\n│    mContext instance of android.view.ContextThemeWrapper, wrapping activity androidx.fragment.app.test.EmptyFragmentTestActivity with mDestroyed = true\r\n│    mWindowAttributes.mTitle = \"androidx.fragment.test/androidx.fragment.app.test.EmptyFragmentTestActivity\"\r\n│    mWindowAttributes.type = 2\r\n│    ↓ ViewRootImpl.mContext\r\n├─ android.view.ContextThemeWrapper instance\r\n│    Leaking: YES (ViewRootImpl↑ is leaking and ContextThemeWrapper wraps an Activity with Activity.mDestroyed true)\r\n│    Retaining 32 B in 1 objects\r\n│    mBase instance of androidx.fragment.app.test.EmptyFragmentTestActivity with mDestroyed = true\r\n│    ↓ ContextWrapper.mBase\r\n╰→ androidx.fragment.app.test.EmptyFragmentTestActivity instance\r\n​     Leaking: YES (ObjectWatcher was watching this because androidx.fragment.app.test.EmptyFragmentTestActivity received Activity#onDestroy() callback and Activity#mDestroyed is true)\r\n​     Retaining 416.9 kB in 1158 objects\r\n​     key = 10449255-2757-4592-b7f4-c811ff3eb3b5\r\n​     watchDurationMillis = 5091\r\n​     retainedDurationMillis = 86\r\n​     mApplication instance of androidx.fragment.app.LeakCanaryApp\r\n​     mBase instance of android.app.ContextImpl\r\n====================================\r\n0 LIBRARY LEAKS\r\n\r\nA Library Leak is a leak caused by a known bug in 3rd party code that you do not have control over.\r\nSee https://square.github.io/leakcanary/fundamentals-how-leakcanary-works/#4-categorizing-leaks\r\n====================================\r\n0 UNREACHABLE OBJECTS\r\n\r\nAn unreachable object is still in memory but LeakCanary could not find a strong reference path\r\nfrom GC roots.\r\n====================================\r\nMETADATA\r\n\r\nPlease include this in bug reports and Stack Overflow questions.\r\n\r\nBuild.VERSION.SDK_INT: 30\r\nBuild.MANUFACTURER: Google\r\nLeakCanary version: 2.12\r\nApp process name: androidx.fragment.test\r\nClass count: 21597\r\nInstance count: 130577\r\nPrimitive array count: 105751\r\nObject array count: 19954\r\nThread count: 19\r\nHeap total bytes: 20984130\r\nBitmap count: 4\r\nBitmap total bytes: 385520\r\nLarge bitmap count: 0\r\nLarge bitmap total bytes: 0\r\nStats: LruCache[maxSize=3000,hits=38997,misses=90280,hitRate=30%] RandomAccess[bytes=4285965,reads=90280,travel=29998003312,range=24502897,size=30664733]\r\nassertionTag: DetectLeaksAfterTestSuccess\r\nwaitForRetainedDurationMillis: 5133\r\ntotalDurationMillis: 9718\r\nAnalysis duration: 1460 ms\r\nHeap dump file path: /data/user/0/androidx.fragment.test/files/instrumentation_tests_2023-12-12_16-21-50_095.hprof\r\nHeap dump timestamp: 1702426914678\r\nHeap dump duration: 587 ms\r\n====================================\r\n\tat leakcanary.NoLeakAssertionFailedError$Companion$throwOnApplicationLeaks$1.reportHeapAnalysis(NoLeakAssertionFailedError.kt:25)\r\n\tat leakcanary.AndroidDetectLeaksAssert.runLeakChecks(AndroidDetectLeaksAssert.kt:95)\r\n\tat leakcanary.AndroidDetectLeaksAssert.assertNoLeaks(AndroidDetectLeaksAssert.kt:34)\r\n\tat leakcanary.LeakAssertions.assertNoLeaks(LeakAssertions.kt:21)\r\n\tat leakcanary.DetectLeaksAfterTestSuccess$apply$1.evaluate(DetectLeaksAfterTestSuccess.kt:26)\r\n\tat leakcanary.TestDescriptionHolder$wrap$1.evaluate(TestDescriptionHolder.kt:43)\r\n\tat org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n\tat org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n\tat org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n\tat org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n\tat org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n\tat org.junit.runners.Suite.runChild(Suite.java:128)\r\n\tat org.junit.runners.Suite.runChild(Suite.java:27)\r\n\tat org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n\tat org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n\tat org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n\tat org.junit.runners.Suite.runChild(Suite.java:128)\r\n\tat org.junit.runners.Suite.runChild(Suite.java:27)\r\n\tat org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n\tat org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n\tat org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n\tat org.junit.runner.JUnitCore.run(JUnitCore.java:137)\r\n\tat org.junit.runner.JUnitCore.run(JUnitCore.java:115)\r\n\tat androidx.test.internal.runner.TestExecutor.execute(TestExecutor.java:68)\r\n\tat androidx.test.internal.runner.TestExecutor.execute(TestExecutor.java:59)\r\n\tat androidx.test.runner.AndroidJUnitRunner.onStart(AndroidJUnitRunner.java:466)\r\n\tat android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:2205)\r\n```\r\n","closed_by":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/2592/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/square/leakcanary/issues/2592/timeline","performed_via_github_app":null,"state_reason":"completed"}