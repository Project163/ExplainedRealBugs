[{"id":3465866906,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MzQ2NTg2NjkwNg==","url":"https://api.github.com/repos/square/leakcanary/issues/events/3465866906","actor":{"login":"Armaxis","id":2152942,"node_id":"MDQ6VXNlcjIxNTI5NDI=","avatar_url":"https://avatars.githubusercontent.com/u/2152942?v=4","gravatar_id":"","url":"https://api.github.com/users/Armaxis","html_url":"https://github.com/Armaxis","followers_url":"https://api.github.com/users/Armaxis/followers","following_url":"https://api.github.com/users/Armaxis/following{/other_user}","gists_url":"https://api.github.com/users/Armaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/Armaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Armaxis/subscriptions","organizations_url":"https://api.github.com/users/Armaxis/orgs","repos_url":"https://api.github.com/users/Armaxis/repos","events_url":"https://api.github.com/users/Armaxis/events{/privacy}","received_events_url":"https://api.github.com/users/Armaxis/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2020-06-21T21:23:14Z","rename":{"from":"FileChannel performance discussion","to":"Hprof file reading performance discussion"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/647250437","html_url":"https://github.com/square/leakcanary/issues/1876#issuecomment-647250437","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1876","id":647250437,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NzI1MDQzNw==","user":{"login":"swankjesse","id":133019,"node_id":"MDQ6VXNlcjEzMzAxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/133019?v=4","gravatar_id":"","url":"https://api.github.com/users/swankjesse","html_url":"https://github.com/swankjesse","followers_url":"https://api.github.com/users/swankjesse/followers","following_url":"https://api.github.com/users/swankjesse/following{/other_user}","gists_url":"https://api.github.com/users/swankjesse/gists{/gist_id}","starred_url":"https://api.github.com/users/swankjesse/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swankjesse/subscriptions","organizations_url":"https://api.github.com/users/swankjesse/orgs","repos_url":"https://api.github.com/users/swankjesse/repos","events_url":"https://api.github.com/users/swankjesse/events{/privacy}","received_events_url":"https://api.github.com/users/swankjesse/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-22T03:28:05Z","updated_at":"2020-06-22T03:28:05Z","body":"This is a thing that might help:\r\nhttps://github.com/square/okhttp/blob/master/okhttp/src/main/kotlin/okhttp3/internal/cache2/FileOperator.kt","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/647250437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"swankjesse","id":133019,"node_id":"MDQ6VXNlcjEzMzAxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/133019?v=4","gravatar_id":"","url":"https://api.github.com/users/swankjesse","html_url":"https://github.com/swankjesse","followers_url":"https://api.github.com/users/swankjesse/followers","following_url":"https://api.github.com/users/swankjesse/following{/other_user}","gists_url":"https://api.github.com/users/swankjesse/gists{/gist_id}","starred_url":"https://api.github.com/users/swankjesse/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swankjesse/subscriptions","organizations_url":"https://api.github.com/users/swankjesse/orgs","repos_url":"https://api.github.com/users/swankjesse/repos","events_url":"https://api.github.com/users/swankjesse/events{/privacy}","received_events_url":"https://api.github.com/users/swankjesse/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/647634707","html_url":"https://github.com/square/leakcanary/issues/1876#issuecomment-647634707","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1876","id":647634707,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NzYzNDcwNw==","user":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-22T16:36:04Z","updated_at":"2020-06-22T16:38:38Z","body":"ðŸ™ Thanks @Armaxis  & @swankjesse!\r\n\r\nIf we go with this approach, we have to reimplement something that keeps updating the sink and pulling more bytes into it, because we don't know the size of what we're trying to read, so we're essentially rebuilding BufferedSource but with the ability to reset at a different position.\r\n\r\nHowever, here's something **really cool**: we already read the file once when we build the index. That means we could start keeping track of objects sizes, instead of just their position. That means making the index larger, BUT, it also means that for every read after indexing we can read exactly the number of bytes we need, nothing more nothing less. There's also little benefit to the current buffering since we're exploring the graph and constantly jumping around the file.\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/647634707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3469257389,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzQ2OTI1NzM4OQ==","url":"https://api.github.com/repos/square/leakcanary/issues/events/3469257389","actor":{"login":"swankjesse","id":133019,"node_id":"MDQ6VXNlcjEzMzAxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/133019?v=4","gravatar_id":"","url":"https://api.github.com/users/swankjesse","html_url":"https://github.com/swankjesse","followers_url":"https://api.github.com/users/swankjesse/followers","following_url":"https://api.github.com/users/swankjesse/following{/other_user}","gists_url":"https://api.github.com/users/swankjesse/gists{/gist_id}","starred_url":"https://api.github.com/users/swankjesse/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swankjesse/subscriptions","organizations_url":"https://api.github.com/users/swankjesse/orgs","repos_url":"https://api.github.com/users/swankjesse/repos","events_url":"https://api.github.com/users/swankjesse/events{/privacy}","received_events_url":"https://api.github.com/users/swankjesse/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-06-22T16:36:04Z","performed_via_github_app":null},{"id":3469257395,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM0NjkyNTczOTU=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3469257395","actor":{"login":"swankjesse","id":133019,"node_id":"MDQ6VXNlcjEzMzAxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/133019?v=4","gravatar_id":"","url":"https://api.github.com/users/swankjesse","html_url":"https://github.com/swankjesse","followers_url":"https://api.github.com/users/swankjesse/followers","following_url":"https://api.github.com/users/swankjesse/following{/other_user}","gists_url":"https://api.github.com/users/swankjesse/gists{/gist_id}","starred_url":"https://api.github.com/users/swankjesse/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swankjesse/subscriptions","organizations_url":"https://api.github.com/users/swankjesse/orgs","repos_url":"https://api.github.com/users/swankjesse/repos","events_url":"https://api.github.com/users/swankjesse/events{/privacy}","received_events_url":"https://api.github.com/users/swankjesse/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-06-22T16:36:04Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/647635749","html_url":"https://github.com/square/leakcanary/issues/1876#issuecomment-647635749","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1876","id":647635749,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NzYzNTc0OQ==","user":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-22T16:38:08Z","updated_at":"2020-06-22T16:38:08Z","body":"`MappedByteBuffer` is probably not a good option for us, as we're jumping around the file, so you'd only get benefits when jumping locally, and there's a huge memory cost to mapping the file (whole point of the current approach is to limit memory impact)","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/647635749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3469267344,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzQ2OTI2NzM0NA==","url":"https://api.github.com/repos/square/leakcanary/issues/events/3469267344","actor":{"login":"Armaxis","id":2152942,"node_id":"MDQ6VXNlcjIxNTI5NDI=","avatar_url":"https://avatars.githubusercontent.com/u/2152942?v=4","gravatar_id":"","url":"https://api.github.com/users/Armaxis","html_url":"https://github.com/Armaxis","followers_url":"https://api.github.com/users/Armaxis/followers","following_url":"https://api.github.com/users/Armaxis/following{/other_user}","gists_url":"https://api.github.com/users/Armaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/Armaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Armaxis/subscriptions","organizations_url":"https://api.github.com/users/Armaxis/orgs","repos_url":"https://api.github.com/users/Armaxis/repos","events_url":"https://api.github.com/users/Armaxis/events{/privacy}","received_events_url":"https://api.github.com/users/Armaxis/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-06-22T16:38:38Z","performed_via_github_app":null},{"id":3469267346,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM0NjkyNjczNDY=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3469267346","actor":{"login":"Armaxis","id":2152942,"node_id":"MDQ6VXNlcjIxNTI5NDI=","avatar_url":"https://avatars.githubusercontent.com/u/2152942?v=4","gravatar_id":"","url":"https://api.github.com/users/Armaxis","html_url":"https://github.com/Armaxis","followers_url":"https://api.github.com/users/Armaxis/followers","following_url":"https://api.github.com/users/Armaxis/following{/other_user}","gists_url":"https://api.github.com/users/Armaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/Armaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Armaxis/subscriptions","organizations_url":"https://api.github.com/users/Armaxis/orgs","repos_url":"https://api.github.com/users/Armaxis/repos","events_url":"https://api.github.com/users/Armaxis/events{/privacy}","received_events_url":"https://api.github.com/users/Armaxis/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-06-22T16:38:38Z","performed_via_github_app":null},{"id":3469873666,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDM0Njk4NzM2NjY=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3469873666","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"7ad6688cc4fa38cf3d13f57a3492732b55d806b5","commit_url":"https://api.github.com/repos/square/leakcanary/commits/7ad6688cc4fa38cf3d13f57a3492732b55d806b5","created_at":"2020-06-22T19:35:52Z","performed_via_github_app":null},{"actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-22T19:35:58Z","updated_at":"2020-06-22T19:35:58Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/square/leakcanary/issues/1878","repository_url":"https://api.github.com/repos/square/leakcanary","labels_url":"https://api.github.com/repos/square/leakcanary/issues/1878/labels{/name}","comments_url":"https://api.github.com/repos/square/leakcanary/issues/1878/comments","events_url":"https://api.github.com/repos/square/leakcanary/issues/1878/events","html_url":"https://github.com/square/leakcanary/pull/1878","id":643313058,"node_id":"MDExOlB1bGxSZXF1ZXN0NDM4MTM3NzUw","number":1878,"title":"Use random access while analyzing","user":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-06-22T19:35:58Z","updated_at":"2020-09-15T21:25:06Z","closed_at":"2020-09-15T21:25:02Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":34824499,"node_id":"MDEwOlJlcG9zaXRvcnkzNDgyNDQ5OQ==","name":"leakcanary","full_name":"square/leakcanary","private":false,"owner":{"login":"square","id":82592,"node_id":"MDEyOk9yZ2FuaXphdGlvbjgyNTky","avatar_url":"https://avatars.githubusercontent.com/u/82592?v=4","gravatar_id":"","url":"https://api.github.com/users/square","html_url":"https://github.com/square","followers_url":"https://api.github.com/users/square/followers","following_url":"https://api.github.com/users/square/following{/other_user}","gists_url":"https://api.github.com/users/square/gists{/gist_id}","starred_url":"https://api.github.com/users/square/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/square/subscriptions","organizations_url":"https://api.github.com/users/square/orgs","repos_url":"https://api.github.com/users/square/repos","events_url":"https://api.github.com/users/square/events{/privacy}","received_events_url":"https://api.github.com/users/square/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/square/leakcanary","description":"A memory leak detection library for Android.","fork":false,"url":"https://api.github.com/repos/square/leakcanary","forks_url":"https://api.github.com/repos/square/leakcanary/forks","keys_url":"https://api.github.com/repos/square/leakcanary/keys{/key_id}","collaborators_url":"https://api.github.com/repos/square/leakcanary/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/square/leakcanary/teams","hooks_url":"https://api.github.com/repos/square/leakcanary/hooks","issue_events_url":"https://api.github.com/repos/square/leakcanary/issues/events{/number}","events_url":"https://api.github.com/repos/square/leakcanary/events","assignees_url":"https://api.github.com/repos/square/leakcanary/assignees{/user}","branches_url":"https://api.github.com/repos/square/leakcanary/branches{/branch}","tags_url":"https://api.github.com/repos/square/leakcanary/tags","blobs_url":"https://api.github.com/repos/square/leakcanary/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/square/leakcanary/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/square/leakcanary/git/refs{/sha}","trees_url":"https://api.github.com/repos/square/leakcanary/git/trees{/sha}","statuses_url":"https://api.github.com/repos/square/leakcanary/statuses/{sha}","languages_url":"https://api.github.com/repos/square/leakcanary/languages","stargazers_url":"https://api.github.com/repos/square/leakcanary/stargazers","contributors_url":"https://api.github.com/repos/square/leakcanary/contributors","subscribers_url":"https://api.github.com/repos/square/leakcanary/subscribers","subscription_url":"https://api.github.com/repos/square/leakcanary/subscription","commits_url":"https://api.github.com/repos/square/leakcanary/commits{/sha}","git_commits_url":"https://api.github.com/repos/square/leakcanary/git/commits{/sha}","comments_url":"https://api.github.com/repos/square/leakcanary/comments{/number}","issue_comment_url":"https://api.github.com/repos/square/leakcanary/issues/comments{/number}","contents_url":"https://api.github.com/repos/square/leakcanary/contents/{+path}","compare_url":"https://api.github.com/repos/square/leakcanary/compare/{base}...{head}","merges_url":"https://api.github.com/repos/square/leakcanary/merges","archive_url":"https://api.github.com/repos/square/leakcanary/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/square/leakcanary/downloads","issues_url":"https://api.github.com/repos/square/leakcanary/issues{/number}","pulls_url":"https://api.github.com/repos/square/leakcanary/pulls{/number}","milestones_url":"https://api.github.com/repos/square/leakcanary/milestones{/number}","notifications_url":"https://api.github.com/repos/square/leakcanary/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/square/leakcanary/labels{/name}","releases_url":"https://api.github.com/repos/square/leakcanary/releases{/id}","deployments_url":"https://api.github.com/repos/square/leakcanary/deployments","created_at":"2015-04-29T23:54:16Z","updated_at":"2025-11-10T12:46:59Z","pushed_at":"2025-08-05T05:43:50Z","git_url":"git://github.com/square/leakcanary.git","ssh_url":"git@github.com:square/leakcanary.git","clone_url":"https://github.com/square/leakcanary.git","svn_url":"https://github.com/square/leakcanary","homepage":"https://square.github.io/leakcanary","size":147448,"stargazers_count":29826,"watchers_count":29826,"language":"Kotlin","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":3974,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":144,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["android","java","kotlin","kotlin-android","leak-canary","leak-trace","leakcanary","memory-leak","outofmemory","outofmemoryerror"],"visibility":"public","forks":3974,"open_issues":144,"watchers":29826,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/square/leakcanary/pulls/1878","html_url":"https://github.com/square/leakcanary/pull/1878","diff_url":"https://github.com/square/leakcanary/pull/1878.diff","patch_url":"https://github.com/square/leakcanary/pull/1878.patch","merged_at":"2020-09-15T21:25:01Z"},"body":"This change improves the performance of analyzing heap dumps dramatically by changing the way we do random access reads: use FileChannel.transferTo instead of resetting the position of the FileChannel backing the Okio buffered source. This change requires updating the indexed data to know not only the position, but also the size of every record. That way we transfer exactly only what we need.\r\n\r\nBenchmarking on a Pixel 3, airplane mode, with 10 iterations on a large heap dump (from ProfiledTest):\r\n\r\nBefore: Durations (ms): median 11884.5, min 11802, max 12021\r\nAfter: Durations (ms): median 8281.5, min 8181, max 8417\r\n\r\nThat's a 30% improvement!\r\n\r\nDoing this required rewriting the core low level APIs, which in turns enabled several great changes!\r\n\r\n* Sharks internals are now independant from `File`, it's all based on Okio's `Source`.\r\n* This means unit tests don't need to do any actual IO, they can work from in memory arrays.\r\n* This enables writing a new test, HprofIOPerfTest, for measuring IO reads and avoiding regressions.\r\n* As a result, Hprof and HprofReader are deprecated, replaced with HprofHeader, HprofRecordReader, StreamingHprofReader and RandomAccessHprofReader.\r\n* Updated APIs for opening a hprof with Shark:\r\n\r\nPreviously, now deprecated though still works:\r\n\r\n```kotlin\r\nHprof.open(hprofFile)\r\n    .use { hprof ->\r\n      val graph = HprofHeapGraph.indexHprof(hprof)\r\n      // TODO Use graph\r\n    }\r\n```\r\n\r\nNow:\r\n\r\n```\r\nhprofFile.openHeapGraph().use { graph ->\r\n  // TODO Use graph\r\n}\r\n```\r\n\r\n* Updated the minimum required Okio release to 1.14 (which is the first release where Buffer implements WritableByteChannel)\r\n* New tests: HprofIOPerfTest for ensuring we don't increase IO reads, HprofRetainedHeapPerfTest for ensuring we don't increase retained memory.\r\n* Fixed bug when reading char arrays from the heap dump: the byte array was converted to a string in UTF_16BE then into a char array. This could lead to transforming the chars due to conversion loss.\r\n* Improved reading the size of object arrays and primitive arrays, now only requires reading 4 bytes.\r\n* Fixed bug in LruCache, it was caching only maxSize - 1 elements instead of maxSize.\r\n* Fixed bug when handling classes from JVM heap dumps. Class names in JVM heap dumps are \"foo/BarClass\" instead of \"foo.BarClass\". We were previously replacing names when storing them in a string cache while parsing the heap dump but that could lead to overwriting entries from strings already named that way. This is fixed by only replacing names at the outer layers of the graph API.\r\n* Fixed bug when computing retained size with duplicated paths, the deduplication would lead to not reporting retained size on the wrong leaks and missing some of it. We now add the retained size from a longer path back to the shorter path's retained size.\r\n* Fixed bug: retained size could not be computed for leaking primitive arrays and leaking object arrays.\r\n* Fixed bug: library leaks & thread local leaks would not necessarily return the shortest path but a longer one instead. Fixed by using only the depriotized queue once we've emptied the prioritized queue.\r\n\r\nFixes #1876\r\n","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/1878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/square/leakcanary/issues/1878/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":3469879947,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDM0Njk4Nzk5NDc=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3469879947","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"847445457dcf210cbbdab28c19caade11405c5ce","commit_url":"https://api.github.com/repos/square/leakcanary/commits/847445457dcf210cbbdab28c19caade11405c5ce","created_at":"2020-06-22T19:38:04Z","performed_via_github_app":null},{"id":3469894806,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDM0Njk4OTQ4MDY=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3469894806","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"07ad703cbd55259328ef7cc8d3c6a79411488f14","commit_url":"https://api.github.com/repos/square/leakcanary/commits/07ad703cbd55259328ef7cc8d3c6a79411488f14","created_at":"2020-06-22T19:43:05Z","performed_via_github_app":null},{"id":3470155921,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDM0NzAxNTU5MjE=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3470155921","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"6223890a7e9115c011d6b362effc3303aef6b8f4","commit_url":"https://api.github.com/repos/square/leakcanary/commits/6223890a7e9115c011d6b362effc3303aef6b8f4","created_at":"2020-06-22T21:02:53Z","performed_via_github_app":null},{"id":3732754310,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDM3MzI3NTQzMTA=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3732754310","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"d47e8b95370ad58f63b4b799315233c7a016fcea","commit_url":"https://api.github.com/repos/square/leakcanary/commits/d47e8b95370ad58f63b4b799315233c7a016fcea","created_at":"2020-09-05T09:06:56Z","performed_via_github_app":null},{"id":3770387551,"node_id":"MDExOkNsb3NlZEV2ZW50Mzc3MDM4NzU1MQ==","url":"https://api.github.com/repos/square/leakcanary/issues/events/3770387551","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-09-15T21:25:02Z","state_reason":null,"performed_via_github_app":null},{"id":3770395810,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDM3NzAzOTU4MTA=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3770395810","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2020-09-15T21:27:45Z","milestone":{"title":"2.5"},"performed_via_github_app":null}]