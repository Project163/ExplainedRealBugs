{"url":"https://api.github.com/repos/square/leakcanary/issues/2301","repository_url":"https://api.github.com/repos/square/leakcanary","labels_url":"https://api.github.com/repos/square/leakcanary/issues/2301/labels{/name}","comments_url":"https://api.github.com/repos/square/leakcanary/issues/2301/comments","events_url":"https://api.github.com/repos/square/leakcanary/issues/2301/events","html_url":"https://github.com/square/leakcanary/issues/2301","id":1118254171,"node_id":"I_kwDOAhNhM85CpzRb","number":2301,"title":"ToastEventListener leak","user":{"login":"andronaline","id":98653549,"node_id":"U_kgDOBeFVbQ","avatar_url":"https://avatars.githubusercontent.com/u/98653549?v=4","gravatar_id":"","url":"https://api.github.com/users/andronaline","html_url":"https://github.com/andronaline","followers_url":"https://api.github.com/users/andronaline/followers","following_url":"https://api.github.com/users/andronaline/following{/other_user}","gists_url":"https://api.github.com/users/andronaline/gists{/gist_id}","starred_url":"https://api.github.com/users/andronaline/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andronaline/subscriptions","organizations_url":"https://api.github.com/users/andronaline/orgs","repos_url":"https://api.github.com/users/andronaline/repos","events_url":"https://api.github.com/users/andronaline/events{/privacy}","received_events_url":"https://api.github.com/users/andronaline/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":205873874,"node_id":"MDU6TGFiZWwyMDU4NzM4NzQ=","url":"https://api.github.com/repos/square/leakcanary/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/square/leakcanary/milestones/23","html_url":"https://github.com/square/leakcanary/milestone/23","labels_url":"https://api.github.com/repos/square/leakcanary/milestones/23/labels","id":7539052,"node_id":"MI_kwDOAhNhM84Acwls","number":23,"title":"2.9","description":"","creator":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":20,"state":"closed","created_at":"2022-01-04T09:47:49Z","updated_at":"2022-04-20T13:29:07Z","due_on":null,"closed_at":"2022-04-20T00:49:55Z"},"comments":5,"created_at":"2022-01-29T15:54:56Z","updated_at":"2023-07-13T04:47:03Z","closed_at":"2022-04-03T16:04:08Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\r\nHi all,\r\n\r\nI receive two notifications from Leakcanary when debugging an app on a Samsung Galaxy S10 running on Android 12.\r\n\r\nIndeed, Leakcanary notifies a leaked activity when the concerned activity is recreated (toggling from light to night mode or vice versa, and rotating screen, in my case).\r\n\r\nBelow are shown the Leakcanary reports:\r\n\r\nFIRST REPORT\r\n```┬───\r\n│ GC Root: System class\r\n│\r\n├─ android.view.inputmethod.InputMethodManager class\r\n│    Leaking: NO (InputMethodManager↓ is not leaking and a class is never\r\n│    leaking)\r\n│    ↓ static InputMethodManager.sInstance\r\n├─ android.view.inputmethod.InputMethodManager instance\r\n│    Leaking: NO (DecorView↓ is not leaking and InputMethodManager is a\r\n│    singleton)\r\n│    ↓ InputMethodManager.mCurRootView\r\n├─ android.view.ViewRootImpl instance\r\n│    Leaking: NO (DecorView↓ is not leaking)\r\n│    mContext instance of com.android.internal.policy.DecorContext, wrapping\r\n│    activity my_package.MainActivity with mDestroyed = false\r\n│    ViewRootImpl#mView is not null\r\n│    mWindowAttributes.mTitle = \"my_package/my_package.\r\n│    MainActivity\"\r\n│    mWindowAttributes.type = 1\r\n│    ↓ ViewRootImpl.mParentDecorView\r\n├─ com.android.internal.policy.DecorView instance\r\n│    Leaking: NO (View attached)\r\n│    View is part of a window view hierarchy\r\n│    View.mAttachInfo is not null (view attached)\r\n│    View.mWindowAttachCount = 1\r\n│    mContext instance of com.android.internal.policy.DecorContext, wrapping\r\n│    activity my_package.MainActivity with mDestroyed = false\r\n│    ↓ DecorView.mMSActions\r\n│                ~~~~~~~~~~\r\n├─ com.samsung.android.multiwindow.MultiSplitActions instance\r\n│    Leaking: UNKNOWN\r\n│    Retaining 43 B in 1 objects\r\n│    ↓ MultiSplitActions.mWindow\r\n│                        ~~~~~~~\r\n├─ com.android.internal.policy.PhoneWindow instance\r\n│    Leaking: YES (Window#mDestroyed is true)\r\n│    Retaining 15,0 kB in 285 objects\r\n│    mContext instance of my_package.MainActivity with mDestroyed =\r\n│    true\r\n│    mOnWindowDismissedCallback instance of my_package.MainActivity\r\n│    with mDestroyed = true\r\n│    ↓ Window.mContext\r\n╰→ my_package.MainActivity instance\r\n​     Leaking: YES (ObjectWatcher was watching this because my_package.MainActivity received Activity#onDestroy() callback and\r\n​     Activity#mDestroyed is true)\r\n​     Retaining 6,4 kB in 226 objects\r\n​     key = 7a5ee5de-103e-4f43-a3d1-2564ede0b638\r\n​     watchDurationMillis = 11124\r\n​     retainedDurationMillis = 6118\r\n​     mApplication instance of android.app.Application\r\n​     mBase instance of androidx.appcompat.view.ContextThemeWrapper\r\n\r\nMETADATA\r\n\r\nBuild.VERSION.SDK_INT: 31\r\nBuild.MANUFACTURER: samsung\r\nLeakCanary version: 2.8.1\r\nApp process name: my_package\r\nStats: LruCache[maxSize=3000,hits=107193,misses=188802,hitRate=36%]\r\nRandomAccess[bytes=9370928,reads=188802,travel=55908452413,range=31914653,size=3\r\n9719368]\r\nAnalysis duration: 12542 ms\r\n```\r\n\r\nSECOND REPORT\r\n```┬───\r\n│ GC Root: Thread object\r\n│\r\n├─ android.os.HandlerThread instance\r\n│    Leaking: NO (PathClassLoader↓ is not leaking)\r\n│    Thread name: 'LeakCanary-Heap-Dump'\r\n│    ↓ Thread.contextClassLoader\r\n├─ dalvik.system.PathClassLoader instance\r\n│    Leaking: NO (ToastEventListener↓ is not leaking and A ClassLoader is never\r\n│    leaking)\r\n│    ↓ ClassLoader.runtimeInternalObjects\r\n├─ java.lang.Object[] array\r\n│    Leaking: NO (ToastEventListener↓ is not leaking)\r\n│    ↓ Object[1219]\r\n├─ leakcanary.ToastEventListener class\r\n│    Leaking: NO (a class is never leaking)\r\n│    ↓ static ToastEventListener.toastCurrentlyShown\r\n│                                ~~~~~~~~~~~~~~~~~~~\r\n├─ android.widget.Toast instance\r\n│    Leaking: UNKNOWN\r\n│    Retaining 9,6 kB in 150 objects\r\n│    mContext instance of my_package.MainActivity with mDestroyed =\r\n│    false\r\n│    ↓ Toast.mNextView\r\n│            ~~~~~~~~~\r\n╰→ android.widget.FrameLayout instance\r\n​     Leaking: YES (ObjectWatcher was watching this because android.widget.\r\n​     FrameLayout received View#onDetachedFromWindow() callback)\r\n​     Retaining 9,5 kB in 148 objects\r\n​     key = 21d82ba6-98f3-42a3-8496-d000912361c5\r\n​     watchDurationMillis = 7325\r\n​     retainedDurationMillis = 2322\r\n​     View not part of a window view hierarchy\r\n​     View.mAttachInfo is null (view detached)\r\n​     View.mWindowAttachCount = 1\r\n​     mContext instance of my_package.MainActivity with mDestroyed =\r\n​     false\r\n\r\nMETADATA\r\n\r\nBuild.VERSION.SDK_INT: 31\r\nBuild.MANUFACTURER: samsung\r\nLeakCanary version: 2.8.1\r\nApp process name: my_package\r\nStats: LruCache[maxSize=3000,hits=107890,misses=222607,hitRate=32%]\r\nRandomAccess[bytes=12173060,reads=222607,travel=168156278612,range=60979699,size\r\n=89197607]\r\nAnalysis duration: 11614 ms\r\n```\r\n\r\n### Version Information\r\n\r\n* LeakCanary version: 2.8.1\r\n* Android OS version: 12\r\n* Gradle version: 7.3.3\r\n\r\n### Additional Information\r\n\r\nIn my opinion, the first report is a bug related to Samsung and the second one is a Leakcanary bug.\r\n","closed_by":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/2301/reactions","total_count":11,"+1":9,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":2},"timeline_url":"https://api.github.com/repos/square/leakcanary/issues/2301/timeline","performed_via_github_app":null,"state_reason":"completed"}