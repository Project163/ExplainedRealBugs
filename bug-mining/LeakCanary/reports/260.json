{"url":"https://api.github.com/repos/square/leakcanary/issues/2409","repository_url":"https://api.github.com/repos/square/leakcanary","labels_url":"https://api.github.com/repos/square/leakcanary/issues/2409/labels{/name}","comments_url":"https://api.github.com/repos/square/leakcanary/issues/2409/comments","events_url":"https://api.github.com/repos/square/leakcanary/issues/2409/events","html_url":"https://github.com/square/leakcanary/issues/2409","id":1331140571,"node_id":"I_kwDOAhNhM85PV5fb","number":2409,"title":"AndroidJUnitRunner cannot find extra class com.squareup.leakcanary.FailTestOnLeakRunListener","user":{"login":"sourabhdas1991","id":110791567,"node_id":"U_kgDOBpqLjw","avatar_url":"https://avatars.githubusercontent.com/u/110791567?v=4","gravatar_id":"","url":"https://api.github.com/users/sourabhdas1991","html_url":"https://github.com/sourabhdas1991","followers_url":"https://api.github.com/users/sourabhdas1991/followers","following_url":"https://api.github.com/users/sourabhdas1991/following{/other_user}","gists_url":"https://api.github.com/users/sourabhdas1991/gists{/gist_id}","starred_url":"https://api.github.com/users/sourabhdas1991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sourabhdas1991/subscriptions","organizations_url":"https://api.github.com/users/sourabhdas1991/orgs","repos_url":"https://api.github.com/users/sourabhdas1991/repos","events_url":"https://api.github.com/users/sourabhdas1991/events{/privacy}","received_events_url":"https://api.github.com/users/sourabhdas1991/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":238439652,"node_id":"MDU6TGFiZWwyMzg0Mzk2NTI=","url":"https://api.github.com/repos/square/leakcanary/labels/type:%20documentation","name":"type: documentation","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/square/leakcanary/milestones/25","html_url":"https://github.com/square/leakcanary/milestone/25","labels_url":"https://api.github.com/repos/square/leakcanary/milestones/25/labels","id":7893332,"node_id":"MI_kwDOAhNhM84AeHFU","number":25,"title":"2.10","description":"","creator":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":1,"closed_issues":25,"state":"closed","created_at":"2022-04-20T00:50:09Z","updated_at":"2025-07-22T13:59:42Z","due_on":null,"closed_at":"2022-11-11T14:36:09Z"},"comments":1,"created_at":"2022-08-07T22:35:13Z","updated_at":"2022-11-10T19:31:44Z","closed_at":"2022-11-10T19:31:44Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\r\nI am trying to run leak canary along with my Android Instrumentation tests. I followed the LeakCanary documentation https://square.github.io/leakcanary/upgrading-to-leakcanary-2.0/#running-leakcanary-in-instrumentation-tests\r\n\r\nHowever, the instrumentation test app fails to start with the following error:\r\n\r\n```\r\njava.lang.RuntimeException: Exception thrown in onCreate() of ComponentInfo{<app component>/androidx.test.runner.AndroidJUnitRunner}: java.lang.IllegalArgumentException: Could not find extra class com.squareup.leakcanary.FailTestOnLeakRunListener\r\nat android.app.ActivityThread.handleBindApplication(ActivityThread.java:6709)\r\n        at android.app.ActivityThread.access$1300(ActivityThread.java:237)\r\n        at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1913)\r\n        at android.os.Handler.dispatchMessage(Handler.java:106)\r\n        at android.os.Looper.loop(Looper.java:223)\r\n        at android.app.ActivityThread.main(ActivityThread.java:7656)\r\n        at java.lang.reflect.Method.invoke(Native Method)\r\n        at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:592)\r\n        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:947)\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\nProject build.gradle contains the following:\r\n\r\n```\r\ndependencies {\r\n    compileOnly 'org.projectlombok:lombok:1.18.12'\r\n    implementation fileTree(include: ['*.jar'], dir: 'libs')\r\n    implementation 'androidx.annotation:annotation:1.0.0'\r\n    implementation 'androidx.core:core:1.0.0'\r\n    implementation 'androidx.appcompat:appcompat:1.2.0'\r\n    implementation 'com.github.bumptech.glide:glide:4.6.1'\r\n    testImplementation 'junit:junit:4.12'\r\n    testImplementation 'org.robolectric:robolectric:4.2'\r\n    testImplementation 'org.robolectric:shadows-httpclient:4.2'\r\n    testImplementation 'androidx.test:core:1.1.0'\r\n    testImplementation 'org.mockito:mockito-core:2.25.0'\r\n    androidTestImplementation 'org.mockito:mockito-core:2.25.0'\r\n    androidTestImplementation 'androidx.test.ext:junit:1.1.0'\r\n    androidTestImplementation 'androidx.annotation:annotation:1.0.0'\r\n    androidTestImplementation 'androidx.test.espresso:espresso-core:3.1.1'\r\n    androidTestImplementation 'androidx.test:runner:1.1.1'\r\n    androidTestImplementation 'androidx.test:rules:1.1.1'\r\n    androidTestImplementation 'androidx.test.uiautomator:uiautomator:2.2.0'\r\n    androidTestImplementation 'com.linkedin.dexmaker:dexmaker:2.25.0'\r\n    androidTestImplementation 'com.linkedin.dexmaker:dexmaker-mockito:2.25.0'\r\n    testImplementation 'com.squareup.leakcanary:leakcanary-android:2.9.1'\r\n    androidTestImplementation 'com.squareup.leakcanary:leakcanary-android-instrumentation:2.9.1'\r\n    androidTestUtil 'androidx.test:orchestrator:1.1.1'\r\n    api \"com.google.auto.value:auto-value-annotations:1.7\"\r\n    api 'com.google.guava:guava:27.0.1-jre'\r\n    annotationProcessor \"com.google.auto.value:auto-value:1.7\"\r\n    annotationProcessor 'org.projectlombok:lombok:1.18.12'\r\n}\r\n\r\nandroid {\r\n    compileSdkVersion 31\r\n    ndkVersion \"23.0.7599858\"\r\n    buildToolsVersion \"30.0.2\"\r\n    defaultConfig {\r\n        minSdkVersion 22\r\n        targetSdkVersion 31\r\n        versionCode 1\r\n        versionName \"1.0\"\r\n        testInstrumentationRunner \"androidx.test.runner.AndroidJUnitRunner\"\r\n        testInstrumentationRunnerArguments clearPackageData: 'true'\r\n        testInstrumentationRunnerArgument \"listener\", \"com.squareup.leakcanary.FailTestOnLeakRunListener\"\r\n        renderscriptTargetApi 22\r\n    }\r\n}\r\n```\r\n**Expected behavior:** The instrumentation tests should start and execute.\r\n\r\n### Version Information\r\n\r\n* LeakCanary version: 2.9.1\r\n* Android OS version: 31\r\n* Gradle version: 6.8.1\r\n","closed_by":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/2409/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/square/leakcanary/issues/2409/timeline","performed_via_github_app":null,"state_reason":"completed"}