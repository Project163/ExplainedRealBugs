{"url":"https://api.github.com/repos/square/leakcanary/issues/1297","repository_url":"https://api.github.com/repos/square/leakcanary","labels_url":"https://api.github.com/repos/square/leakcanary/issues/1297/labels{/name}","comments_url":"https://api.github.com/repos/square/leakcanary/issues/1297/comments","events_url":"https://api.github.com/repos/square/leakcanary/issues/1297/events","html_url":"https://github.com/square/leakcanary/issues/1297","id":436775692,"node_id":"MDU6SXNzdWU0MzY3NzU2OTI=","number":1297,"title":"Add resource id names to the heap dump","user":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/square/leakcanary/milestones/15","html_url":"https://github.com/square/leakcanary/milestone/15","labels_url":"https://api.github.com/repos/square/leakcanary/milestones/15/labels","id":4885696,"node_id":"MDk6TWlsZXN0b25lNDg4NTY5Ng==","number":15,"title":"2.1","description":"","creator":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":30,"state":"closed","created_at":"2019-11-27T20:02:09Z","updated_at":"2019-12-31T17:45:19Z","due_on":"2020-01-03T08:00:00Z","closed_at":"2019-12-31T17:45:19Z"},"comments":4,"created_at":"2019-04-24T15:51:07Z","updated_at":"2019-12-10T05:44:16Z","closed_at":"2019-12-10T05:44:02Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Currently we resolve resource id names at analysis time by calling `resources.getResourceEntryName()`. This works only if the heap dump is analyzed in the same build as where the heap was dumped.\r\n\r\nInstead, we can capture the list of ids and names before the heap dump, store that in a static field in memory, then read it from the analyzer (and clear it in memory)\r\n\r\n```\r\n      for (resId in 0 until (1 shl 16)) {\r\n        try {\r\n\r\n          // https://android.googlesource.com/platform/frameworks/base/+/master/core/res/res/values/public.xml\r\n          // 0x07070000 for app, 0x01020000 for Android but we don't need that.\r\n          CanaryLog.d(resources.getResourceEntryName(0x07070000 or resId) + \" \" + resId)\r\n        } catch (ignored: NotFoundException) {\r\n          // Assumption that might break some day: numbers are sequential, starting at 0\r\n          break\r\n        }\r\n      }\r\n```\r\n\r\nWe might want to capture this data as a pre dump step.\r\n\r\ncc @romainguy @tyvsmith","closed_by":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/1297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/square/leakcanary/issues/1297/timeline","performed_via_github_app":null,"state_reason":"completed"}