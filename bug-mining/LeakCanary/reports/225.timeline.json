[{"id":3947349037,"node_id":"MDEyOkxhYmVsZWRFdmVudDM5NDczNDkwMzc=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3947349037","actor":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-11-02T10:22:13Z","label":{"name":"type: bug","color":"fc2929"},"performed_via_github_app":null},{"actor":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T10:31:32Z","updated_at":"2020-11-02T10:31:32Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/android/android-test/issues/743","repository_url":"https://api.github.com/repos/android/android-test","labels_url":"https://api.github.com/repos/android/android-test/issues/743/labels{/name}","comments_url":"https://api.github.com/repos/android/android-test/issues/743/comments","events_url":"https://api.github.com/repos/android/android-test/issues/743/events","html_url":"https://github.com/android/android-test/issues/743","id":702202003,"node_id":"MDU6SXNzdWU3MDIyMDIwMDM=","number":743,"title":"Instrumented test execution with ANDROIDX_TEST_ORCHESTRATOR does not work with Android 11","user":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"brettchabot","id":4038919,"node_id":"MDQ6VXNlcjQwMzg5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/4038919?v=4","gravatar_id":"","url":"https://api.github.com/users/brettchabot","html_url":"https://github.com/brettchabot","followers_url":"https://api.github.com/users/brettchabot/followers","following_url":"https://api.github.com/users/brettchabot/following{/other_user}","gists_url":"https://api.github.com/users/brettchabot/gists{/gist_id}","starred_url":"https://api.github.com/users/brettchabot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brettchabot/subscriptions","organizations_url":"https://api.github.com/users/brettchabot/orgs","repos_url":"https://api.github.com/users/brettchabot/repos","events_url":"https://api.github.com/users/brettchabot/events{/privacy}","received_events_url":"https://api.github.com/users/brettchabot/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"brettchabot","id":4038919,"node_id":"MDQ6VXNlcjQwMzg5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/4038919?v=4","gravatar_id":"","url":"https://api.github.com/users/brettchabot","html_url":"https://github.com/brettchabot","followers_url":"https://api.github.com/users/brettchabot/followers","following_url":"https://api.github.com/users/brettchabot/following{/other_user}","gists_url":"https://api.github.com/users/brettchabot/gists{/gist_id}","starred_url":"https://api.github.com/users/brettchabot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brettchabot/subscriptions","organizations_url":"https://api.github.com/users/brettchabot/orgs","repos_url":"https://api.github.com/users/brettchabot/repos","events_url":"https://api.github.com/users/brettchabot/events{/privacy}","received_events_url":"https://api.github.com/users/brettchabot/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":70,"created_at":"2020-09-15T19:35:00Z","updated_at":"2022-12-15T20:57:55Z","closed_at":"2021-03-15T20:57:04Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":41148494,"node_id":"MDEwOlJlcG9zaXRvcnk0MTE0ODQ5NA==","name":"android-test","full_name":"android/android-test","private":false,"owner":{"login":"android","id":32689599,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMyNjg5NTk5","avatar_url":"https://avatars.githubusercontent.com/u/32689599?v=4","gravatar_id":"","url":"https://api.github.com/users/android","html_url":"https://github.com/android","followers_url":"https://api.github.com/users/android/followers","following_url":"https://api.github.com/users/android/following{/other_user}","gists_url":"https://api.github.com/users/android/gists{/gist_id}","starred_url":"https://api.github.com/users/android/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/android/subscriptions","organizations_url":"https://api.github.com/users/android/orgs","repos_url":"https://api.github.com/users/android/repos","events_url":"https://api.github.com/users/android/events{/privacy}","received_events_url":"https://api.github.com/users/android/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/android/android-test","description":"An extensive framework for testing Android apps","fork":false,"url":"https://api.github.com/repos/android/android-test","forks_url":"https://api.github.com/repos/android/android-test/forks","keys_url":"https://api.github.com/repos/android/android-test/keys{/key_id}","collaborators_url":"https://api.github.com/repos/android/android-test/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/android/android-test/teams","hooks_url":"https://api.github.com/repos/android/android-test/hooks","issue_events_url":"https://api.github.com/repos/android/android-test/issues/events{/number}","events_url":"https://api.github.com/repos/android/android-test/events","assignees_url":"https://api.github.com/repos/android/android-test/assignees{/user}","branches_url":"https://api.github.com/repos/android/android-test/branches{/branch}","tags_url":"https://api.github.com/repos/android/android-test/tags","blobs_url":"https://api.github.com/repos/android/android-test/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/android/android-test/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/android/android-test/git/refs{/sha}","trees_url":"https://api.github.com/repos/android/android-test/git/trees{/sha}","statuses_url":"https://api.github.com/repos/android/android-test/statuses/{sha}","languages_url":"https://api.github.com/repos/android/android-test/languages","stargazers_url":"https://api.github.com/repos/android/android-test/stargazers","contributors_url":"https://api.github.com/repos/android/android-test/contributors","subscribers_url":"https://api.github.com/repos/android/android-test/subscribers","subscription_url":"https://api.github.com/repos/android/android-test/subscription","commits_url":"https://api.github.com/repos/android/android-test/commits{/sha}","git_commits_url":"https://api.github.com/repos/android/android-test/git/commits{/sha}","comments_url":"https://api.github.com/repos/android/android-test/comments{/number}","issue_comment_url":"https://api.github.com/repos/android/android-test/issues/comments{/number}","contents_url":"https://api.github.com/repos/android/android-test/contents/{+path}","compare_url":"https://api.github.com/repos/android/android-test/compare/{base}...{head}","merges_url":"https://api.github.com/repos/android/android-test/merges","archive_url":"https://api.github.com/repos/android/android-test/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/android/android-test/downloads","issues_url":"https://api.github.com/repos/android/android-test/issues{/number}","pulls_url":"https://api.github.com/repos/android/android-test/pulls{/number}","milestones_url":"https://api.github.com/repos/android/android-test/milestones{/number}","notifications_url":"https://api.github.com/repos/android/android-test/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/android/android-test/labels{/name}","releases_url":"https://api.github.com/repos/android/android-test/releases{/id}","deployments_url":"https://api.github.com/repos/android/android-test/deployments","created_at":"2015-08-21T09:47:39Z","updated_at":"2025-11-03T18:37:56Z","pushed_at":"2025-11-03T18:37:54Z","git_url":"git://github.com/android/android-test.git","ssh_url":"git@github.com:android/android-test.git","clone_url":"https://github.com/android/android-test.git","svn_url":"https://github.com/android/android-test","homepage":"https://android.github.io/android-test","size":77431,"stargazers_count":1205,"watchers_count":1205,"language":"Java","has_issues":true,"has_projects":false,"has_downloads":false,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":334,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":332,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":334,"open_issues":332,"watchers":1205,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### Description\r\nSimilar to #355, but the execution hangs\r\n\r\n### Steps to Reproduce\r\n1. Create new project using AS wizard\r\n2. Enable Android orchestrator following the https://developer.android.com/training/testing/junit-runner\r\n3. Run tests on Android Emulator with API 30\r\n\r\n### Expected Results\r\nThe test passes\r\n\r\n### Actual Results\r\n- The test hangs\r\n- logcat shows:\r\n```\r\n2020-09-15 21:28:39.486 12791-12791/com.example.myapplication E/AndroidRuntime: FATAL EXCEPTION: main\r\n    Process: com.example.myapplication, PID: 12791\r\n    java.lang.RuntimeException: Exception thrown in onCreate() of ComponentInfo{com.example.myapplication.test/androidx.test.runner.AndroidJUnitRunner}: java.lang.RuntimeException: Cannot connect to androidx.test.orchestrator.OrchestratorService\r\n        at android.app.ActivityThread.handleBindApplication(ActivityThread.java:6709)\r\n        at android.app.ActivityThread.access$1300(ActivityThread.java:237)\r\n        at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1913)\r\n        at android.os.Handler.dispatchMessage(Handler.java:106)\r\n        at android.os.Looper.loop(Looper.java:223)\r\n        at android.app.ActivityThread.main(ActivityThread.java:7656)\r\n        at java.lang.reflect.Method.invoke(Native Method)\r\n        at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:592)\r\n        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:947)\r\n     Caused by: java.lang.RuntimeException: Cannot connect to androidx.test.orchestrator.OrchestratorService\r\n        at androidx.test.orchestrator.instrumentationlistener.OrchestratedInstrumentationListener.connect(OrchestratedInstrumentationListener.java:93)\r\n        at androidx.test.runner.AndroidJUnitRunner.onCreate(AndroidJUnitRunner.java:309)\r\n        at android.app.ActivityThread.handleBindApplication(ActivityThread.java:6704)\r\n        at android.app.ActivityThread.access$1300(ActivityThread.java:237)Â \r\n        at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1913)Â \r\n        at android.os.Handler.dispatchMessage(Handler.java:106)Â \r\n        at android.os.Looper.loop(Looper.java:223)Â \r\n        at android.app.ActivityThread.main(ActivityThread.java:7656)Â \r\n        at java.lang.reflect.Method.invoke(Native Method)Â \r\n        at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:592)Â \r\n        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:947)Â \r\n2020-09-15 21:28:39.486 12791-12791/com.example.myapplication E/AndroidJUnitRunner: An unhandled exception was thrown by the app.\r\n2020-09-15 21:28:39.493 12791-12791/com.example.myapplication E/InstrumentationResultPrinter: Failed to mark test No Tests as finished after process crash\r\n```\r\n- (might be unrelated, but doesn' happen on api 29) my private app shows in addition: `mkdir: â€˜/storage/emulated/0/Android/data/my.app.packageâ€™: Permission denied` which points at `DeviceProviderInstrumentTestTask` and `getAdditionalTestOutputEnabled` which tries to save some log file. disabling the `android.enableAdditionalTestOutput` property removes the `mkdir` error but the test still hangs\r\n\r\n### AndroidX Test and Android OS Versions\r\n```\r\n    androidTestImplementation 'androidx.test.ext:junit:1.1.2'\r\n    androidTestImplementation 'androidx.test.espresso:espresso-core:3.2.0'\r\n    androidTestImplementation 'androidx.test:runner:1.3.0'\r\n    androidTestUtil 'androidx.test:orchestrator:1.3.0'\r\n```\r\nAndroid OS Versions: the issue exists only on API 30. The test passes on lower apis. \r\n\r\n### Link to a public git repo demonstrating the problem:\r\nhttps://github.com/mateuszkwiecinski/orchestrator_doesnt_work\r\ntask: `./gradlew connectedDebugAndroidTest` hangs and never ends\r\n![image](https://user-images.githubusercontent.com/36954793/93256276-684ba180-f79b-11ea-8e1d-19dafc1e79d8.png)\r\n\r\nGithub action run confirming the issue: https://github.com/mateuszkwiecinski/orchestrator_doesnt_work/pull/1/checks?check_run_id=1119649523","reactions":{"url":"https://api.github.com/repos/android/android-test/issues/743/reactions","total_count":18,"+1":13,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":5},"timeline_url":"https://api.github.com/repos/android/android-test/issues/743/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":3950696625,"node_id":"MDEyOkxhYmVsZWRFdmVudDM5NTA2OTY2MjU=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3950696625","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-11-03T00:59:12Z","label":{"name":"good first issue","color":"3c3ce0"},"performed_via_github_app":null},{"id":3950696626,"node_id":"MDEyOkxhYmVsZWRFdmVudDM5NTA2OTY2MjY=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3950696626","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-11-03T00:59:13Z","label":{"name":"status: help wanted","color":"159818"},"performed_via_github_app":null},{"actor":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T09:37:42Z","updated_at":"2020-11-04T09:37:42Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/issues/7","repository_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work","labels_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/issues/7/labels{/name}","comments_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/issues/7/comments","events_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/issues/7/events","html_url":"https://github.com/mateuszkwiecinski/orchestrator_doesnt_work/pull/7","id":734359855,"node_id":"MDExOlB1bGxSZXF1ZXN0NTEzOTM3Mjgy","number":7,"title":"Test if it fails","user":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-11-02T09:53:59Z","updated_at":"2022-03-19T23:26:01Z","closed_at":"2022-03-19T23:26:01Z","author_association":"OWNER","active_lock_reason":null,"draft":false,"repository":{"id":295828668,"node_id":"MDEwOlJlcG9zaXRvcnkyOTU4Mjg2Njg=","name":"orchestrator_doesnt_work","full_name":"mateuszkwiecinski/orchestrator_doesnt_work","private":false,"owner":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/mateuszkwiecinski/orchestrator_doesnt_work","description":"Sample repo for ANDORID ORCHESTRATOR on API 30 bug","fork":false,"url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work","forks_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/forks","keys_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/keys{/key_id}","collaborators_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/teams","hooks_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/hooks","issue_events_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/issues/events{/number}","events_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/events","assignees_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/assignees{/user}","branches_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/branches{/branch}","tags_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/tags","blobs_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/git/refs{/sha}","trees_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/git/trees{/sha}","statuses_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/statuses/{sha}","languages_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/languages","stargazers_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/stargazers","contributors_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/contributors","subscribers_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/subscribers","subscription_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/subscription","commits_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/commits{/sha}","git_commits_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/git/commits{/sha}","comments_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/comments{/number}","issue_comment_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/issues/comments{/number}","contents_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/contents/{+path}","compare_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/compare/{base}...{head}","merges_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/merges","archive_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/downloads","issues_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/issues{/number}","pulls_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/pulls{/number}","milestones_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/milestones{/number}","notifications_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/labels{/name}","releases_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/releases{/id}","deployments_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/deployments","created_at":"2020-09-15T19:25:43Z","updated_at":"2020-10-20T19:40:15Z","pushed_at":"2021-08-04T06:58:36Z","git_url":"git://github.com/mateuszkwiecinski/orchestrator_doesnt_work.git","ssh_url":"git@github.com:mateuszkwiecinski/orchestrator_doesnt_work.git","clone_url":"https://github.com/mateuszkwiecinski/orchestrator_doesnt_work.git","svn_url":"https://github.com/mateuszkwiecinski/orchestrator_doesnt_work","homepage":"https://github.com/android/android-test/issues/743","size":182,"stargazers_count":0,"watchers_count":0,"language":"Kotlin","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":null,"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/pulls/7","html_url":"https://github.com/mateuszkwiecinski/orchestrator_doesnt_work/pull/7","diff_url":"https://github.com/mateuszkwiecinski/orchestrator_doesnt_work/pull/7.diff","patch_url":"https://github.com/mateuszkwiecinski/orchestrator_doesnt_work/pull/7.patch","merged_at":null},"body":"https://github.com/square/leakcanary/issues/1986\r\nhttps://github.com/android/android-test/issues/743","reactions":{"url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/issues/7/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mateuszkwiecinski/orchestrator_doesnt_work/issues/7/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/723493127","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-723493127","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":723493127,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMzQ5MzEyNw==","user":{"login":"opatry","id":362710,"node_id":"MDQ6VXNlcjM2MjcxMA==","avatar_url":"https://avatars.githubusercontent.com/u/362710?v=4","gravatar_id":"","url":"https://api.github.com/users/opatry","html_url":"https://github.com/opatry","followers_url":"https://api.github.com/users/opatry/followers","following_url":"https://api.github.com/users/opatry/following{/other_user}","gists_url":"https://api.github.com/users/opatry/gists{/gist_id}","starred_url":"https://api.github.com/users/opatry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opatry/subscriptions","organizations_url":"https://api.github.com/users/opatry/orgs","repos_url":"https://api.github.com/users/opatry/repos","events_url":"https://api.github.com/users/opatry/events{/privacy}","received_events_url":"https://api.github.com/users/opatry/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-07T20:41:47Z","updated_at":"2020-11-07T20:41:47Z","body":"`lateinit var` are so Java's NPEâ€¦ I tend to avoid it and simply rely on nullable far more explicit!\r\n\r\nI suggest to make `testResultPublisher` nullable then.\r\nOtherwise, check on `this::testResultPublisher.isInitialized` could be done but meehhâ€¦","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/723493127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"opatry","id":362710,"node_id":"MDQ6VXNlcjM2MjcxMA==","avatar_url":"https://avatars.githubusercontent.com/u/362710?v=4","gravatar_id":"","url":"https://api.github.com/users/opatry","html_url":"https://github.com/opatry","followers_url":"https://api.github.com/users/opatry/followers","following_url":"https://api.github.com/users/opatry/following{/other_user}","gists_url":"https://api.github.com/users/opatry/gists{/gist_id}","starred_url":"https://api.github.com/users/opatry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opatry/subscriptions","organizations_url":"https://api.github.com/users/opatry/orgs","repos_url":"https://api.github.com/users/opatry/repos","events_url":"https://api.github.com/users/opatry/events{/privacy}","received_events_url":"https://api.github.com/users/opatry/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/723493744","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-723493744","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":723493744,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMzQ5Mzc0NA==","user":{"login":"opatry","id":362710,"node_id":"MDQ6VXNlcjM2MjcxMA==","avatar_url":"https://avatars.githubusercontent.com/u/362710?v=4","gravatar_id":"","url":"https://api.github.com/users/opatry","html_url":"https://github.com/opatry","followers_url":"https://api.github.com/users/opatry/followers","following_url":"https://api.github.com/users/opatry/following{/other_user}","gists_url":"https://api.github.com/users/opatry/gists{/gist_id}","starred_url":"https://api.github.com/users/opatry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opatry/subscriptions","organizations_url":"https://api.github.com/users/opatry/orgs","repos_url":"https://api.github.com/users/opatry/repos","events_url":"https://api.github.com/users/opatry/events{/privacy}","received_events_url":"https://api.github.com/users/opatry/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-07T20:47:36Z","updated_at":"2020-11-07T20:47:36Z","body":"@pyricau unless this proposal is considered too defensive and this state isn't expected when executing `RunListener` implementation?\r\n\r\nIs it something possible to have `testRunStarted` not called while `failTest` (called by `detectLeaks` from `testFinished`) is?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/723493744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"opatry","id":362710,"node_id":"MDQ6VXNlcjM2MjcxMA==","avatar_url":"https://avatars.githubusercontent.com/u/362710?v=4","gravatar_id":"","url":"https://api.github.com/users/opatry","html_url":"https://github.com/opatry","followers_url":"https://api.github.com/users/opatry/followers","following_url":"https://api.github.com/users/opatry/following{/other_user}","gists_url":"https://api.github.com/users/opatry/gists{/gist_id}","starred_url":"https://api.github.com/users/opatry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opatry/subscriptions","organizations_url":"https://api.github.com/users/opatry/orgs","repos_url":"https://api.github.com/users/opatry/repos","events_url":"https://api.github.com/users/opatry/events{/privacy}","received_events_url":"https://api.github.com/users/opatry/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3970203573,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzk3MDIwMzU3Mw==","url":"https://api.github.com/repos/square/leakcanary/issues/events/3970203573","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-11-07T20:47:36Z","performed_via_github_app":null},{"id":3970203574,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM5NzAyMDM1NzQ=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3970203574","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-11-07T20:47:36Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/723495925","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-723495925","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":723495925,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMzQ5NTkyNQ==","user":{"login":"opatry","id":362710,"node_id":"MDQ6VXNlcjM2MjcxMA==","avatar_url":"https://avatars.githubusercontent.com/u/362710?v=4","gravatar_id":"","url":"https://api.github.com/users/opatry","html_url":"https://github.com/opatry","followers_url":"https://api.github.com/users/opatry/followers","following_url":"https://api.github.com/users/opatry/following{/other_user}","gists_url":"https://api.github.com/users/opatry/gists{/gist_id}","starred_url":"https://api.github.com/users/opatry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opatry/subscriptions","organizations_url":"https://api.github.com/users/opatry/orgs","repos_url":"https://api.github.com/users/opatry/repos","events_url":"https://api.github.com/users/opatry/events{/privacy}","received_events_url":"https://api.github.com/users/opatry/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-07T21:11:46Z","updated_at":"2020-11-07T21:11:46Z","body":"@pyricau do you have a recipe somewhere to use `leakcanary` from sources in an external project, like the one provided in this issue? Currently, I tweaked a lot (both on `leakcanary` and example repositories) to make it work.\r\nSo, I guess I'm missing something obvious ðŸ˜… ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/723495925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"opatry","id":362710,"node_id":"MDQ6VXNlcjM2MjcxMA==","avatar_url":"https://avatars.githubusercontent.com/u/362710?v=4","gravatar_id":"","url":"https://api.github.com/users/opatry","html_url":"https://github.com/opatry","followers_url":"https://api.github.com/users/opatry/followers","following_url":"https://api.github.com/users/opatry/following{/other_user}","gists_url":"https://api.github.com/users/opatry/gists{/gist_id}","starred_url":"https://api.github.com/users/opatry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opatry/subscriptions","organizations_url":"https://api.github.com/users/opatry/orgs","repos_url":"https://api.github.com/users/opatry/repos","events_url":"https://api.github.com/users/opatry/events{/privacy}","received_events_url":"https://api.github.com/users/opatry/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3970218534,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzk3MDIxODUzNA==","url":"https://api.github.com/repos/square/leakcanary/issues/events/3970218534","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-11-07T21:11:46Z","performed_via_github_app":null},{"id":3970218536,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM5NzAyMTg1MzY=","url":"https://api.github.com/repos/square/leakcanary/issues/events/3970218536","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-11-07T21:11:46Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/723496586","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-723496586","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":723496586,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMzQ5NjU4Ng==","user":{"login":"opatry","id":362710,"node_id":"MDQ6VXNlcjM2MjcxMA==","avatar_url":"https://avatars.githubusercontent.com/u/362710?v=4","gravatar_id":"","url":"https://api.github.com/users/opatry","html_url":"https://github.com/opatry","followers_url":"https://api.github.com/users/opatry/followers","following_url":"https://api.github.com/users/opatry/following{/other_user}","gists_url":"https://api.github.com/users/opatry/gists{/gist_id}","starred_url":"https://api.github.com/users/opatry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opatry/subscriptions","organizations_url":"https://api.github.com/users/opatry/orgs","repos_url":"https://api.github.com/users/opatry/repos","events_url":"https://api.github.com/users/opatry/events{/privacy}","received_events_url":"https://api.github.com/users/opatry/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-07T21:18:16Z","updated_at":"2020-11-07T21:19:59Z","body":"The real issue causing trouble is the following exception, not `kotlin.UninitializedPropertyAccessException: lateinit property testResultPublisher has not been initialized` when I try with my setup:\r\n\r\n```\r\n2020-11-07 22:10:32.129 14094-14119/com.example.myapplication E/TestRunner: failed: Test mechanism\r\n2020-11-07 22:10:32.129 14094-14119/com.example.myapplication E/TestRunner: ----- begin exception -----\r\n2020-11-07 22:10:32.130 14094-14119/com.example.myapplication E/TestRunner: java.lang.NoSuchFieldException: No field orchestratorListener in class Landroidx/test/runner/AndroidJUnitRunner; (declaration of 'androidx.test.runner.AndroidJUnitRunner' appears in /data/app/~~CPf-cpXbvJK3gl7Eclskvg==/com.example.myapplication.test-IBmvTiaApQAoie0dWx3Nyg==/base.apk)\r\n        at java.lang.Class.getDeclaredField(Native Method)\r\n        at leakcanary.internal.TestResultPublisher$Companion.install(TestResultPublisher.kt:22)\r\n        at leakcanary.FailTestOnLeakRunListener.testRunStarted(FailTestOnLeakRunListener.kt:63)\r\n        at org.junit.runner.notification.SynchronizedRunListener.testRunStarted(SynchronizedRunListener.java:35)\r\n        at org.junit.runner.notification.RunNotifier$1.notifyListener(RunNotifier.java:91)\r\n        at org.junit.runner.notification.RunNotifier$SafeNotifier.run(RunNotifier.java:72)\r\n        at org.junit.runner.notification.RunNotifier.fireTestRunStarted(RunNotifier.java:88)\r\n        at org.junit.runner.JUnitCore.run(JUnitCore.java:136)\r\n        at org.junit.runner.JUnitCore.run(JUnitCore.java:115)\r\n        at androidx.test.internal.runner.TestExecutor.execute(TestExecutor.java:56)\r\n        at androidx.test.runner.AndroidJUnitRunner.onStart(AndroidJUnitRunner.java:434)\r\n        at android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:2205)\r\n2020-11-07 22:10:32.130 14094-14119/com.example.myapplication E/TestRunner: ----- end exception -----\r\n2020-11-07 22:10:32.131 14094-14119/com.example.myapplication E/OrchestrationListener: Unable to determine test case from description [No Tests]\r\n    androidx.test.services.events.TestEventException: Unexpected description instance: No Tests\r\n        at androidx.test.services.events.ParcelableConverter.getTestCaseFromDescription(ParcelableConverter.java:49)\r\n        at androidx.test.internal.events.client.OrchestratedInstrumentationListener.getTestFailureEventFromCachedDescription(OrchestratedInstrumentationListener.java:156)\r\n        at androidx.test.internal.events.client.OrchestratedInstrumentationListener.testFailure(OrchestratedInstrumentationListener.java:137)\r\n        at org.junit.runner.notification.SynchronizedRunListener.testFailure(SynchronizedRunListener.java:63)\r\n        at org.junit.runner.notification.RunNotifier$4.notifyListener(RunNotifier.java:142)\r\n        at org.junit.runner.notification.RunNotifier$SafeNotifier.run(RunNotifier.java:72)\r\n        at org.junit.runner.notification.RunNotifier.fireTestFailures(RunNotifier.java:138)\r\n        at org.junit.runner.notification.RunNotifier.access$100(RunNotifier.java:21)\r\n        at org.junit.runner.notification.RunNotifier$SafeNotifier.run(RunNotifier.java:78)\r\n        at org.junit.runner.notification.RunNotifier.fireTestRunStarted(RunNotifier.java:88)\r\n        at org.junit.runner.JUnitCore.run(JUnitCore.java:136)\r\n        at org.junit.runner.JUnitCore.run(JUnitCore.java:115)\r\n        at androidx.test.internal.runner.TestExecutor.execute(TestExecutor.java:56)\r\n        at androidx.test.runner.AndroidJUnitRunner.onStart(AndroidJUnitRunner.java:434)\r\n        at android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:2205)\r\n```\r\n\r\nI protected such error and the test is now correctly marked as failed as expected.\r\nThat being said, I don't know exactly what it means and if something more needs to be done. I guess this access by reflection wasn't made for the pleasure of doing it. Which concrete instance of `AndroidJUnitRunner` are you expecting that should have a `orchestratorListener` field?\r\n\r\nI'll push a PR with my changes even if I don't think it will be the end of the story.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/723496586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"opatry","id":362710,"node_id":"MDQ6VXNlcjM2MjcxMA==","avatar_url":"https://avatars.githubusercontent.com/u/362710?v=4","gravatar_id":"","url":"https://api.github.com/users/opatry","html_url":"https://github.com/opatry","followers_url":"https://api.github.com/users/opatry/followers","following_url":"https://api.github.com/users/opatry/following{/other_user}","gists_url":"https://api.github.com/users/opatry/gists{/gist_id}","starred_url":"https://api.github.com/users/opatry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opatry/subscriptions","organizations_url":"https://api.github.com/users/opatry/orgs","repos_url":"https://api.github.com/users/opatry/repos","events_url":"https://api.github.com/users/opatry/events{/privacy}","received_events_url":"https://api.github.com/users/opatry/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"opatry","id":362710,"node_id":"MDQ6VXNlcjM2MjcxMA==","avatar_url":"https://avatars.githubusercontent.com/u/362710?v=4","gravatar_id":"","url":"https://api.github.com/users/opatry","html_url":"https://github.com/opatry","followers_url":"https://api.github.com/users/opatry/followers","following_url":"https://api.github.com/users/opatry/following{/other_user}","gists_url":"https://api.github.com/users/opatry/gists{/gist_id}","starred_url":"https://api.github.com/users/opatry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opatry/subscriptions","organizations_url":"https://api.github.com/users/opatry/orgs","repos_url":"https://api.github.com/users/opatry/repos","events_url":"https://api.github.com/users/opatry/events{/privacy}","received_events_url":"https://api.github.com/users/opatry/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-07T21:28:35Z","updated_at":"2020-11-07T21:28:35Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/square/leakcanary/issues/1987","repository_url":"https://api.github.com/repos/square/leakcanary","labels_url":"https://api.github.com/repos/square/leakcanary/issues/1987/labels{/name}","comments_url":"https://api.github.com/repos/square/leakcanary/issues/1987/comments","events_url":"https://api.github.com/repos/square/leakcanary/issues/1987/events","html_url":"https://github.com/square/leakcanary/pull/1987","id":738320888,"node_id":"MDExOlB1bGxSZXF1ZXN0NTE3MTk0MzY1","number":1987,"title":"Fix false positive when running instrumentation tests (fixes #1986)","user":{"login":"opatry","id":362710,"node_id":"MDQ6VXNlcjM2MjcxMA==","avatar_url":"https://avatars.githubusercontent.com/u/362710?v=4","gravatar_id":"","url":"https://api.github.com/users/opatry","html_url":"https://github.com/opatry","followers_url":"https://api.github.com/users/opatry/followers","following_url":"https://api.github.com/users/opatry/following{/other_user}","gists_url":"https://api.github.com/users/opatry/gists{/gist_id}","starred_url":"https://api.github.com/users/opatry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opatry/subscriptions","organizations_url":"https://api.github.com/users/opatry/orgs","repos_url":"https://api.github.com/users/opatry/repos","events_url":"https://api.github.com/users/opatry/events{/privacy}","received_events_url":"https://api.github.com/users/opatry/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2552276021,"node_id":"MDU6TGFiZWwyNTUyMjc2MDIx","url":"https://api.github.com/repos/square/leakcanary/labels/pr:%20wip","name":"pr: wip","color":"fab538","default":false,"description":"work in progress"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-11-07T21:28:35Z","updated_at":"2021-12-29T15:27:19Z","closed_at":"2021-12-29T15:27:19Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":34824499,"node_id":"MDEwOlJlcG9zaXRvcnkzNDgyNDQ5OQ==","name":"leakcanary","full_name":"square/leakcanary","private":false,"owner":{"login":"square","id":82592,"node_id":"MDEyOk9yZ2FuaXphdGlvbjgyNTky","avatar_url":"https://avatars.githubusercontent.com/u/82592?v=4","gravatar_id":"","url":"https://api.github.com/users/square","html_url":"https://github.com/square","followers_url":"https://api.github.com/users/square/followers","following_url":"https://api.github.com/users/square/following{/other_user}","gists_url":"https://api.github.com/users/square/gists{/gist_id}","starred_url":"https://api.github.com/users/square/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/square/subscriptions","organizations_url":"https://api.github.com/users/square/orgs","repos_url":"https://api.github.com/users/square/repos","events_url":"https://api.github.com/users/square/events{/privacy}","received_events_url":"https://api.github.com/users/square/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/square/leakcanary","description":"A memory leak detection library for Android.","fork":false,"url":"https://api.github.com/repos/square/leakcanary","forks_url":"https://api.github.com/repos/square/leakcanary/forks","keys_url":"https://api.github.com/repos/square/leakcanary/keys{/key_id}","collaborators_url":"https://api.github.com/repos/square/leakcanary/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/square/leakcanary/teams","hooks_url":"https://api.github.com/repos/square/leakcanary/hooks","issue_events_url":"https://api.github.com/repos/square/leakcanary/issues/events{/number}","events_url":"https://api.github.com/repos/square/leakcanary/events","assignees_url":"https://api.github.com/repos/square/leakcanary/assignees{/user}","branches_url":"https://api.github.com/repos/square/leakcanary/branches{/branch}","tags_url":"https://api.github.com/repos/square/leakcanary/tags","blobs_url":"https://api.github.com/repos/square/leakcanary/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/square/leakcanary/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/square/leakcanary/git/refs{/sha}","trees_url":"https://api.github.com/repos/square/leakcanary/git/trees{/sha}","statuses_url":"https://api.github.com/repos/square/leakcanary/statuses/{sha}","languages_url":"https://api.github.com/repos/square/leakcanary/languages","stargazers_url":"https://api.github.com/repos/square/leakcanary/stargazers","contributors_url":"https://api.github.com/repos/square/leakcanary/contributors","subscribers_url":"https://api.github.com/repos/square/leakcanary/subscribers","subscription_url":"https://api.github.com/repos/square/leakcanary/subscription","commits_url":"https://api.github.com/repos/square/leakcanary/commits{/sha}","git_commits_url":"https://api.github.com/repos/square/leakcanary/git/commits{/sha}","comments_url":"https://api.github.com/repos/square/leakcanary/comments{/number}","issue_comment_url":"https://api.github.com/repos/square/leakcanary/issues/comments{/number}","contents_url":"https://api.github.com/repos/square/leakcanary/contents/{+path}","compare_url":"https://api.github.com/repos/square/leakcanary/compare/{base}...{head}","merges_url":"https://api.github.com/repos/square/leakcanary/merges","archive_url":"https://api.github.com/repos/square/leakcanary/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/square/leakcanary/downloads","issues_url":"https://api.github.com/repos/square/leakcanary/issues{/number}","pulls_url":"https://api.github.com/repos/square/leakcanary/pulls{/number}","milestones_url":"https://api.github.com/repos/square/leakcanary/milestones{/number}","notifications_url":"https://api.github.com/repos/square/leakcanary/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/square/leakcanary/labels{/name}","releases_url":"https://api.github.com/repos/square/leakcanary/releases{/id}","deployments_url":"https://api.github.com/repos/square/leakcanary/deployments","created_at":"2015-04-29T23:54:16Z","updated_at":"2025-11-10T12:46:59Z","pushed_at":"2025-08-05T05:43:50Z","git_url":"git://github.com/square/leakcanary.git","ssh_url":"git@github.com:square/leakcanary.git","clone_url":"https://github.com/square/leakcanary.git","svn_url":"https://github.com/square/leakcanary","homepage":"https://square.github.io/leakcanary","size":147448,"stargazers_count":29826,"watchers_count":29826,"language":"Kotlin","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":3974,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":144,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["android","java","kotlin","kotlin-android","leak-canary","leak-trace","leakcanary","memory-leak","outofmemory","outofmemoryerror"],"visibility":"public","forks":3974,"open_issues":144,"watchers":29826,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/square/leakcanary/pulls/1987","html_url":"https://github.com/square/leakcanary/pull/1987","diff_url":"https://github.com/square/leakcanary/pull/1987.diff","patch_url":"https://github.com/square/leakcanary/pull/1987.patch","merged_at":null},"body":"I share a change for discussion but I'm not sure it's the way to go.\r\nAt least the issue spotted in #1986 is fixed this way.\r\nI'm not 100% sure of the consequence of the defensive code I introduce.\r\nThat being said, I think accessing private member of third party code by reflection deserves defensive code ðŸ˜ƒ ","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/1987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/square/leakcanary/issues/1987/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/723502047","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-723502047","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":723502047,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMzUwMjA0Nw==","user":{"login":"opatry","id":362710,"node_id":"MDQ6VXNlcjM2MjcxMA==","avatar_url":"https://avatars.githubusercontent.com/u/362710?v=4","gravatar_id":"","url":"https://api.github.com/users/opatry","html_url":"https://github.com/opatry","followers_url":"https://api.github.com/users/opatry/followers","following_url":"https://api.github.com/users/opatry/following{/other_user}","gists_url":"https://api.github.com/users/opatry/gists{/gist_id}","starred_url":"https://api.github.com/users/opatry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opatry/subscriptions","organizations_url":"https://api.github.com/users/opatry/orgs","repos_url":"https://api.github.com/users/opatry/repos","events_url":"https://api.github.com/users/opatry/events{/privacy}","received_events_url":"https://api.github.com/users/opatry/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-07T22:16:38Z","updated_at":"2020-11-07T22:16:38Z","body":"It seems this commit [android/android-test/e998fe63c1870e79548d2b6386db81ca07010c5c](https://github.com/android/android-test/commit/e998fe63c1870e79548d2b6386db81ca07010c5c) introduced the issue.\r\n\r\n`OrchestratedInstrumentationListener orchestratorListener` is replaced by `TestEventClient testEventClient`.\r\n\r\n`TestEventClient` is only available with `androidx.test:runner:1.3.1-alpha02`, if `leakcanary` needs to depend on it, is it a problem?\r\nMoreover, `OrchestratedInstrumentationListener` package changed from `androidx.test.orchestrator.instrumentationlistener` to `androidx.test.internal.events.client`, so I guess having a strategy for old runtime and recent one might be difficult with current impl.\r\nMight need deeper changes I'm afraid.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/723502047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"opatry","id":362710,"node_id":"MDQ6VXNlcjM2MjcxMA==","avatar_url":"https://avatars.githubusercontent.com/u/362710?v=4","gravatar_id":"","url":"https://api.github.com/users/opatry","html_url":"https://github.com/opatry","followers_url":"https://api.github.com/users/opatry/followers","following_url":"https://api.github.com/users/opatry/following{/other_user}","gists_url":"https://api.github.com/users/opatry/gists{/gist_id}","starred_url":"https://api.github.com/users/opatry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opatry/subscriptions","organizations_url":"https://api.github.com/users/opatry/orgs","repos_url":"https://api.github.com/users/opatry/repos","events_url":"https://api.github.com/users/opatry/events{/privacy}","received_events_url":"https://api.github.com/users/opatry/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/737567060","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-737567060","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":737567060,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzU2NzA2MA==","user":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T23:55:21Z","updated_at":"2020-12-02T23:55:21Z","body":"Catching up, sorry it took me so long to take a look.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/737567060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/737568920","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-737568920","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":737568920,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzU2ODkyMA==","user":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-03T00:00:47Z","updated_at":"2020-12-03T00:00:47Z","body":"> do you have a recipe somewhere to use leakcanary from sources in an external project, like the one provided in this issue?\r\n\r\nThe LeakCanary example app has UI tests that fail (and don't run on CI). You could add a test there (and update the espresso version temporarily).\r\n\r\nBased on what you're telling me, it sounds like we need a two different impls. We could check for whether the `OrchestratedInstrumentationListener` vs `TestEventClient` impls are available, and use one strategy / test impl vs another. We'd have to move those impls into two different modules that each have a different version of the dependency.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/737568920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-23T07:25:00Z","updated_at":"2021-05-23T07:25:00Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/square/leakcanary/issues/2132","repository_url":"https://api.github.com/repos/square/leakcanary","labels_url":"https://api.github.com/repos/square/leakcanary/issues/2132/labels{/name}","comments_url":"https://api.github.com/repos/square/leakcanary/issues/2132/comments","events_url":"https://api.github.com/repos/square/leakcanary/issues/2132/events","html_url":"https://github.com/square/leakcanary/pull/2132","id":898956648,"node_id":"MDExOlB1bGxSZXF1ZXN0NjUwNzQxNDI0","number":2132,"title":"Use the new way of plugins application. Migrate to lazy Gradle api to avoid eager tasks configuration","user":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-05-23T07:25:00Z","updated_at":"2021-09-17T13:14:53Z","closed_at":"2021-09-16T23:23:59Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":34824499,"node_id":"MDEwOlJlcG9zaXRvcnkzNDgyNDQ5OQ==","name":"leakcanary","full_name":"square/leakcanary","private":false,"owner":{"login":"square","id":82592,"node_id":"MDEyOk9yZ2FuaXphdGlvbjgyNTky","avatar_url":"https://avatars.githubusercontent.com/u/82592?v=4","gravatar_id":"","url":"https://api.github.com/users/square","html_url":"https://github.com/square","followers_url":"https://api.github.com/users/square/followers","following_url":"https://api.github.com/users/square/following{/other_user}","gists_url":"https://api.github.com/users/square/gists{/gist_id}","starred_url":"https://api.github.com/users/square/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/square/subscriptions","organizations_url":"https://api.github.com/users/square/orgs","repos_url":"https://api.github.com/users/square/repos","events_url":"https://api.github.com/users/square/events{/privacy}","received_events_url":"https://api.github.com/users/square/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/square/leakcanary","description":"A memory leak detection library for Android.","fork":false,"url":"https://api.github.com/repos/square/leakcanary","forks_url":"https://api.github.com/repos/square/leakcanary/forks","keys_url":"https://api.github.com/repos/square/leakcanary/keys{/key_id}","collaborators_url":"https://api.github.com/repos/square/leakcanary/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/square/leakcanary/teams","hooks_url":"https://api.github.com/repos/square/leakcanary/hooks","issue_events_url":"https://api.github.com/repos/square/leakcanary/issues/events{/number}","events_url":"https://api.github.com/repos/square/leakcanary/events","assignees_url":"https://api.github.com/repos/square/leakcanary/assignees{/user}","branches_url":"https://api.github.com/repos/square/leakcanary/branches{/branch}","tags_url":"https://api.github.com/repos/square/leakcanary/tags","blobs_url":"https://api.github.com/repos/square/leakcanary/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/square/leakcanary/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/square/leakcanary/git/refs{/sha}","trees_url":"https://api.github.com/repos/square/leakcanary/git/trees{/sha}","statuses_url":"https://api.github.com/repos/square/leakcanary/statuses/{sha}","languages_url":"https://api.github.com/repos/square/leakcanary/languages","stargazers_url":"https://api.github.com/repos/square/leakcanary/stargazers","contributors_url":"https://api.github.com/repos/square/leakcanary/contributors","subscribers_url":"https://api.github.com/repos/square/leakcanary/subscribers","subscription_url":"https://api.github.com/repos/square/leakcanary/subscription","commits_url":"https://api.github.com/repos/square/leakcanary/commits{/sha}","git_commits_url":"https://api.github.com/repos/square/leakcanary/git/commits{/sha}","comments_url":"https://api.github.com/repos/square/leakcanary/comments{/number}","issue_comment_url":"https://api.github.com/repos/square/leakcanary/issues/comments{/number}","contents_url":"https://api.github.com/repos/square/leakcanary/contents/{+path}","compare_url":"https://api.github.com/repos/square/leakcanary/compare/{base}...{head}","merges_url":"https://api.github.com/repos/square/leakcanary/merges","archive_url":"https://api.github.com/repos/square/leakcanary/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/square/leakcanary/downloads","issues_url":"https://api.github.com/repos/square/leakcanary/issues{/number}","pulls_url":"https://api.github.com/repos/square/leakcanary/pulls{/number}","milestones_url":"https://api.github.com/repos/square/leakcanary/milestones{/number}","notifications_url":"https://api.github.com/repos/square/leakcanary/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/square/leakcanary/labels{/name}","releases_url":"https://api.github.com/repos/square/leakcanary/releases{/id}","deployments_url":"https://api.github.com/repos/square/leakcanary/deployments","created_at":"2015-04-29T23:54:16Z","updated_at":"2025-11-10T12:46:59Z","pushed_at":"2025-08-05T05:43:50Z","git_url":"git://github.com/square/leakcanary.git","ssh_url":"git@github.com:square/leakcanary.git","clone_url":"https://github.com/square/leakcanary.git","svn_url":"https://github.com/square/leakcanary","homepage":"https://square.github.io/leakcanary","size":147448,"stargazers_count":29826,"watchers_count":29826,"language":"Kotlin","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":3974,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":144,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["android","java","kotlin","kotlin-android","leak-canary","leak-trace","leakcanary","memory-leak","outofmemory","outofmemoryerror"],"visibility":"public","forks":3974,"open_issues":144,"watchers":29826,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/square/leakcanary/pulls/2132","html_url":"https://github.com/square/leakcanary/pull/2132","diff_url":"https://github.com/square/leakcanary/pull/2132.diff","patch_url":"https://github.com/square/leakcanary/pull/2132.patch","merged_at":"2021-09-16T23:23:58Z"},"body":"### Motivation\r\nI wanted to see if I can help with #1986, but after opening the project I saw tons of deprecations, outdated api usage and it didn't work for me locally (the project requires compiling with Java 8). I thought I should start by updating project configuration, so my first goal is to make the plugin use Gradle 7 and be able to build it with higher java version, using recent dependency versions\r\n\r\n### What this PR does\r\nAs a warmup I created this PR which:\r\n1. Migrates away from [legacy plugins application](https://docs.gradle.org/current/userguide/plugins.html#sec:old_plugin_application)\r\n2. Makes sure project configuration leverages Gradle's lazy configuration apis and tasks aren't configured eagerly\r\n3. Removes a few lines of configuration code I found useless","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/2132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/square/leakcanary/issues/2132/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/892419279","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-892419279","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":892419279,"node_id":"IC_kwDOAhNhM841MTzP","user":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-04T07:06:50Z","updated_at":"2021-08-04T07:06:50Z","body":"FYI: The issue persiststs in LeakCanary 2.7 and androidx.test 1.4.0 as well.\r\nUpdated sample project: https://github.com/mateuszkwiecinski/orchestrator_doesnt_work/pull/8\r\n\r\nSurprisingly, the behavior I observe in my _default_ project is a bit different. It doesn't make the whole test suite to pass, but it shows Leakcanary Failure as a separate `Test mechanism` step:\r\n```\r\nTest mechanism > null[Pixel_XL_API_28(AVD) - 9] FAILED\r\n        java.lang.NoSuchFieldException: No field orchestratorListener in class Landroidx/test/runner/AndroidJUnitRunner; (declaration of 'androidx.test.runner.AndroidJUnitRunner' appears in /data/app/***.debug.test-FLMMcvtXSvyPQf3e3MDyYQ==/base.apk)\r\n        at java.lang.Class.getDeclaredField(Native Method)\r\n```\r\nbut yeah, basically Leakcanary Espresso intergration is _broken_ utterly. ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/892419279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5109157563,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50NTEwOTE1NzU2Mw==","url":"https://api.github.com/repos/square/leakcanary/issues/events/5109157563","actor":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2021-08-04T07:17:37Z","rename":{"from":"Leakcanary makes test always pass when using android-test 1.3.1-alpha02","to":"Leakcanary makes test always pass when using androidx.test >=1.3.1-alpha02"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/892426143","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-892426143","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":892426143,"node_id":"IC_kwDOAhNhM841MVef","user":{"login":"dawidhyzy","id":2484936,"node_id":"MDQ6VXNlcjI0ODQ5MzY=","avatar_url":"https://avatars.githubusercontent.com/u/2484936?v=4","gravatar_id":"","url":"https://api.github.com/users/dawidhyzy","html_url":"https://github.com/dawidhyzy","followers_url":"https://api.github.com/users/dawidhyzy/followers","following_url":"https://api.github.com/users/dawidhyzy/following{/other_user}","gists_url":"https://api.github.com/users/dawidhyzy/gists{/gist_id}","starred_url":"https://api.github.com/users/dawidhyzy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dawidhyzy/subscriptions","organizations_url":"https://api.github.com/users/dawidhyzy/orgs","repos_url":"https://api.github.com/users/dawidhyzy/repos","events_url":"https://api.github.com/users/dawidhyzy/events{/privacy}","received_events_url":"https://api.github.com/users/dawidhyzy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-04T07:18:23Z","updated_at":"2021-08-04T07:25:44Z","body":"I face the same issue when updating to `androidx.test` 1.4.0. Is there a way to disable this integration for tests?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/892426143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dawidhyzy","id":2484936,"node_id":"MDQ6VXNlcjI0ODQ5MzY=","avatar_url":"https://avatars.githubusercontent.com/u/2484936?v=4","gravatar_id":"","url":"https://api.github.com/users/dawidhyzy","html_url":"https://github.com/dawidhyzy","followers_url":"https://api.github.com/users/dawidhyzy/followers","following_url":"https://api.github.com/users/dawidhyzy/following{/other_user}","gists_url":"https://api.github.com/users/dawidhyzy/gists{/gist_id}","starred_url":"https://api.github.com/users/dawidhyzy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dawidhyzy/subscriptions","organizations_url":"https://api.github.com/users/dawidhyzy/orgs","repos_url":"https://api.github.com/users/dawidhyzy/repos","events_url":"https://api.github.com/users/dawidhyzy/events{/privacy}","received_events_url":"https://api.github.com/users/dawidhyzy/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/892434469","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-892434469","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":892434469,"node_id":"IC_kwDOAhNhM841MXgl","user":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-04T07:33:07Z","updated_at":"2021-08-04T07:33:07Z","body":">Is there a way to disable this integration for tests?\r\n\r\n@dawidhyzy You had to explicitly enable it, soo the way to disable the integration is to comment out lines responsible for enabling it ðŸ˜› \r\n>Note that LeakCanary is automatically disabled in tests (see [Running LeakCanary in instrumentation tests](https://square.github.io/leakcanary/recipes/#running-leakcanary-in-instrumentation-tests))\r\n\r\nSource: https://square.github.io/leakcanary/faq/#how-do-i-know-if-leakcanary-is-running\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/892434469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5109226681,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NTEwOTIyNjY4MQ==","url":"https://api.github.com/repos/square/leakcanary/issues/events/5109226681","actor":{"login":"dawidhyzy","id":2484936,"node_id":"MDQ6VXNlcjI0ODQ5MzY=","avatar_url":"https://avatars.githubusercontent.com/u/2484936?v=4","gravatar_id":"","url":"https://api.github.com/users/dawidhyzy","html_url":"https://github.com/dawidhyzy","followers_url":"https://api.github.com/users/dawidhyzy/followers","following_url":"https://api.github.com/users/dawidhyzy/following{/other_user}","gists_url":"https://api.github.com/users/dawidhyzy/gists{/gist_id}","starred_url":"https://api.github.com/users/dawidhyzy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dawidhyzy/subscriptions","organizations_url":"https://api.github.com/users/dawidhyzy/orgs","repos_url":"https://api.github.com/users/dawidhyzy/repos","events_url":"https://api.github.com/users/dawidhyzy/events{/privacy}","received_events_url":"https://api.github.com/users/dawidhyzy/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-08-04T07:33:08Z","performed_via_github_app":null},{"id":5109226683,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDUxMDkyMjY2ODM=","url":"https://api.github.com/repos/square/leakcanary/issues/events/5109226683","actor":{"login":"dawidhyzy","id":2484936,"node_id":"MDQ6VXNlcjI0ODQ5MzY=","avatar_url":"https://avatars.githubusercontent.com/u/2484936?v=4","gravatar_id":"","url":"https://api.github.com/users/dawidhyzy","html_url":"https://github.com/dawidhyzy","followers_url":"https://api.github.com/users/dawidhyzy/followers","following_url":"https://api.github.com/users/dawidhyzy/following{/other_user}","gists_url":"https://api.github.com/users/dawidhyzy/gists{/gist_id}","starred_url":"https://api.github.com/users/dawidhyzy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dawidhyzy/subscriptions","organizations_url":"https://api.github.com/users/dawidhyzy/orgs","repos_url":"https://api.github.com/users/dawidhyzy/repos","events_url":"https://api.github.com/users/dawidhyzy/events{/privacy}","received_events_url":"https://api.github.com/users/dawidhyzy/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-08-04T07:33:08Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/915552347","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-915552347","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":915552347,"node_id":"IC_kwDOAhNhM842kjhb","user":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-08T20:36:46Z","updated_at":"2021-09-17T14:34:52Z","body":"It isn't linked but it seems like this issue will be fixed by https://github.com/square/leakcanary/pull/2147.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/915552347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mateuszkwiecinski","id":36954793,"node_id":"MDQ6VXNlcjM2OTU0Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/36954793?v=4","gravatar_id":"","url":"https://api.github.com/users/mateuszkwiecinski","html_url":"https://github.com/mateuszkwiecinski","followers_url":"https://api.github.com/users/mateuszkwiecinski/followers","following_url":"https://api.github.com/users/mateuszkwiecinski/following{/other_user}","gists_url":"https://api.github.com/users/mateuszkwiecinski/gists{/gist_id}","starred_url":"https://api.github.com/users/mateuszkwiecinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateuszkwiecinski/subscriptions","organizations_url":"https://api.github.com/users/mateuszkwiecinski/orgs","repos_url":"https://api.github.com/users/mateuszkwiecinski/repos","events_url":"https://api.github.com/users/mateuszkwiecinski/events{/privacy}","received_events_url":"https://api.github.com/users/mateuszkwiecinski/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"nborodikhin","id":1527671,"node_id":"MDQ6VXNlcjE1Mjc2NzE=","avatar_url":"https://avatars.githubusercontent.com/u/1527671?v=4","gravatar_id":"","url":"https://api.github.com/users/nborodikhin","html_url":"https://github.com/nborodikhin","followers_url":"https://api.github.com/users/nborodikhin/followers","following_url":"https://api.github.com/users/nborodikhin/following{/other_user}","gists_url":"https://api.github.com/users/nborodikhin/gists{/gist_id}","starred_url":"https://api.github.com/users/nborodikhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nborodikhin/subscriptions","organizations_url":"https://api.github.com/users/nborodikhin/orgs","repos_url":"https://api.github.com/users/nborodikhin/repos","events_url":"https://api.github.com/users/nborodikhin/events{/privacy}","received_events_url":"https://api.github.com/users/nborodikhin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T16:50:22Z","updated_at":"2021-10-20T16:50:22Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/robolectric/robolectric/issues/6781","repository_url":"https://api.github.com/repos/robolectric/robolectric","labels_url":"https://api.github.com/repos/robolectric/robolectric/issues/6781/labels{/name}","comments_url":"https://api.github.com/repos/robolectric/robolectric/issues/6781/comments","events_url":"https://api.github.com/repos/robolectric/robolectric/issues/6781/events","html_url":"https://github.com/robolectric/robolectric/issues/6781","id":1031549200,"node_id":"I_kwDOAA087M49fDEQ","number":6781,"title":"Robolectric 4.6.1 does not work with ActivityScenario from androidx.test.monitor 1.3.0","user":{"login":"nborodikhin","id":1527671,"node_id":"MDQ6VXNlcjE1Mjc2NzE=","avatar_url":"https://avatars.githubusercontent.com/u/1527671?v=4","gravatar_id":"","url":"https://api.github.com/users/nborodikhin","html_url":"https://github.com/nborodikhin","followers_url":"https://api.github.com/users/nborodikhin/followers","following_url":"https://api.github.com/users/nborodikhin/following{/other_user}","gists_url":"https://api.github.com/users/nborodikhin/gists{/gist_id}","starred_url":"https://api.github.com/users/nborodikhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nborodikhin/subscriptions","organizations_url":"https://api.github.com/users/nborodikhin/orgs","repos_url":"https://api.github.com/users/nborodikhin/repos","events_url":"https://api.github.com/users/nborodikhin/events{/privacy}","received_events_url":"https://api.github.com/users/nborodikhin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2021-10-20T15:29:31Z","updated_at":"2021-11-08T02:35:12Z","closed_at":"2021-11-07T19:03:08Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":867564,"node_id":"MDEwOlJlcG9zaXRvcnk4Njc1NjQ=","name":"robolectric","full_name":"robolectric/robolectric","private":false,"owner":{"login":"robolectric","id":3988212,"node_id":"MDEyOk9yZ2FuaXphdGlvbjM5ODgyMTI=","avatar_url":"https://avatars.githubusercontent.com/u/3988212?v=4","gravatar_id":"","url":"https://api.github.com/users/robolectric","html_url":"https://github.com/robolectric","followers_url":"https://api.github.com/users/robolectric/followers","following_url":"https://api.github.com/users/robolectric/following{/other_user}","gists_url":"https://api.github.com/users/robolectric/gists{/gist_id}","starred_url":"https://api.github.com/users/robolectric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robolectric/subscriptions","organizations_url":"https://api.github.com/users/robolectric/orgs","repos_url":"https://api.github.com/users/robolectric/repos","events_url":"https://api.github.com/users/robolectric/events{/privacy}","received_events_url":"https://api.github.com/users/robolectric/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/robolectric/robolectric","description":"Android Unit Testing Framework","fork":false,"url":"https://api.github.com/repos/robolectric/robolectric","forks_url":"https://api.github.com/repos/robolectric/robolectric/forks","keys_url":"https://api.github.com/repos/robolectric/robolectric/keys{/key_id}","collaborators_url":"https://api.github.com/repos/robolectric/robolectric/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/robolectric/robolectric/teams","hooks_url":"https://api.github.com/repos/robolectric/robolectric/hooks","issue_events_url":"https://api.github.com/repos/robolectric/robolectric/issues/events{/number}","events_url":"https://api.github.com/repos/robolectric/robolectric/events","assignees_url":"https://api.github.com/repos/robolectric/robolectric/assignees{/user}","branches_url":"https://api.github.com/repos/robolectric/robolectric/branches{/branch}","tags_url":"https://api.github.com/repos/robolectric/robolectric/tags","blobs_url":"https://api.github.com/repos/robolectric/robolectric/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/robolectric/robolectric/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/robolectric/robolectric/git/refs{/sha}","trees_url":"https://api.github.com/repos/robolectric/robolectric/git/trees{/sha}","statuses_url":"https://api.github.com/repos/robolectric/robolectric/statuses/{sha}","languages_url":"https://api.github.com/repos/robolectric/robolectric/languages","stargazers_url":"https://api.github.com/repos/robolectric/robolectric/stargazers","contributors_url":"https://api.github.com/repos/robolectric/robolectric/contributors","subscribers_url":"https://api.github.com/repos/robolectric/robolectric/subscribers","subscription_url":"https://api.github.com/repos/robolectric/robolectric/subscription","commits_url":"https://api.github.com/repos/robolectric/robolectric/commits{/sha}","git_commits_url":"https://api.github.com/repos/robolectric/robolectric/git/commits{/sha}","comments_url":"https://api.github.com/repos/robolectric/robolectric/comments{/number}","issue_comment_url":"https://api.github.com/repos/robolectric/robolectric/issues/comments{/number}","contents_url":"https://api.github.com/repos/robolectric/robolectric/contents/{+path}","compare_url":"https://api.github.com/repos/robolectric/robolectric/compare/{base}...{head}","merges_url":"https://api.github.com/repos/robolectric/robolectric/merges","archive_url":"https://api.github.com/repos/robolectric/robolectric/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/robolectric/robolectric/downloads","issues_url":"https://api.github.com/repos/robolectric/robolectric/issues{/number}","pulls_url":"https://api.github.com/repos/robolectric/robolectric/pulls{/number}","milestones_url":"https://api.github.com/repos/robolectric/robolectric/milestones{/number}","notifications_url":"https://api.github.com/repos/robolectric/robolectric/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/robolectric/robolectric/labels{/name}","releases_url":"https://api.github.com/repos/robolectric/robolectric/releases{/id}","deployments_url":"https://api.github.com/repos/robolectric/robolectric/deployments","created_at":"2010-08-28T00:28:25Z","updated_at":"2025-11-10T07:57:06Z","pushed_at":"2025-11-10T07:57:05Z","git_url":"git://github.com/robolectric/robolectric.git","ssh_url":"git@github.com:robolectric/robolectric.git","clone_url":"https://github.com/robolectric/robolectric.git","svn_url":"https://github.com/robolectric/robolectric","homepage":"https://robolectric.org","size":64964,"stargazers_count":5975,"watchers_count":5975,"language":"Java","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":1379,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":465,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["android","java","robolectric","unit-testing"],"visibility":"public","forks":1379,"open_issues":465,"watchers":5975,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### Description\r\n\r\nHello,\r\n\r\nI am using `ActivityScenario` as outlined in the [AndroidX test guide](http://robolectric.org/androidx_test/).  After upgrading Robolectric to 4.6.1 I got two issues - one reported as #6593 and the other one:\r\n\r\n```\r\n    java.lang.IllegalStateException: No instrumentation registered! Must run under a registering instrumentation.\r\n        at androidx.test.InstrumentationRegistry.getInstrumentation(InstrumentationRegistry.java:50)\r\n        at androidx.test.InstrumentationRegistry.getTargetContext(InstrumentationRegistry.java:101)\r\n        at org.robolectric.android.internal.LocalActivityInvoker.getIntentForActivity(LocalActivityInvoker.java:142)\r\n        at androidx.test.core.app.ActivityScenario.<init>(ActivityScenario.java:175)\r\n        at androidx.test.core.app.ActivityScenario.launch(ActivityScenario.java:194)\r\n        at ...MyTest.<init>(...MyTest.kt:73)\r\n```\r\n\r\nThe root cause of this issue is that `LocalActivityInvoker` is getting target context from now-deprecated `InstrumentationRegistry` [here](https://github.com/robolectric/robolectric/blob/master/robolectric/src/main/java/org/robolectric/android/internal/LocalActivityInvoker.java#L3-L4) but in this particular combination of frameworks it is never set.\r\n\r\nThe change that broke compatibility it the reimplementation `RoboMonitoringInstrumentation`: daa9d1aa9e2df8e187498020b459fd5f9e58f750\r\n\r\n#### Why combination Robolectric 4.5 + `androidx.test` 1.3 works\r\n\r\n* `androidx.test` has two independent `InstrumentationRegistry` classes: `androidx.test.InstrumentationRegistry` and `androidx.test.platform.app.InstrumentationRegistry`\r\n* `RoboMonitoringInstrumentation` descends from `androidx.test.runner.MonitoringInstrumentation`\r\n* `androidx.test.runner.MonitoringInstrumentation` configures both instrumentation registries: [link](https://github.com/android/android-test/blob/master/runner/monitor/java/androidx/test/runner/MonitoringInstrumentation.java#L170-L171)\r\n* `LocalActivityInvoker` accesses deprecated instrumentation registry which is explicitly set up\r\n\r\n#### Why combination Robolectric 4.6 + `androidx.test` 1.4 works\r\n\r\n* `androidx.test` has has one main `InstrumentationRegistry` implementation: `androidx.test.platform.app.InstrumentationRegistry`\r\n* Deprecated `androidx.test.InstrumentationRegistry` forwards all calls to the main one: [link](https://github.com/android/android-test/blob/master/runner/monitor/java/androidx/test/InstrumentationRegistry.java#L45)\r\n* Robolectric uses its own implementation of `RoboMonitoringInstrumentation` which installs itself into only one instrumentation registry: [link](https://github.com/robolectric/robolectric/blob/master/robolectric/src/main/java/org/robolectric/android/internal/RoboMonitoringInstrumentation.java#L60)\r\n* `LocalActivityInvoker` accesses configured instrumentation registry via the forwarding provided by the deprecated one\r\n\r\n#### Why combination Robolectric 4.5 + `androidx.test` 1.3 does not work\r\n\r\n* `androidx.test` has two independent `InstrumentationRegistry` classes: `androidx.test.InstrumentationRegistry` and `androidx.test.platform.app.InstrumentationRegistry`\r\n* Robolectric uses its own implementation of `RoboMonitoringInstrumentation` which installs itself into one registry: [link](https://github.com/robolectric/robolectric/blob/master/robolectric/src/main/java/org/robolectric/android/internal/RoboMonitoringInstrumentation.java#L60)\r\n* `LocalActivityInvoker` is trying to get target context from now-deprecated `InstrumentationRegistry` which is not configured\r\n\r\n### Steps to Reproduce\r\n\r\n```kotlin\r\npackage foo.bar\r\n\r\nimport android.app.Activity\r\nimport androidx.test.core.app.ActivityScenario\r\nimport androidx.test.ext.junit.runners.AndroidJUnit4\r\nimport org.junit.Test\r\nimport org.junit.runner.RunWith\r\n\r\n@RunWith(AndroidJUnit4::class)\r\nclass MyTest {\r\n    @Test\r\n    fun foo() {\r\n        val scenario = ActivityScenario.launch(Activity::class.java)\r\n    }\r\n```\r\n\r\n### Robolectric & Android Version\r\n\r\nRobolectric: 4.6.1\r\n`androidx.test`: 1.3.0\r\n\r\n### Link to a public git repo demonstrating the problem:\r\n\r\n### Proposed solution\r\n\r\nRobolectric does not use deprecated `InstrumentationRegistry` with the exception of `LocalActivityInvoker`.  I think the appropriate solution would be to migrate deprecated registry access in `LocalActivityInvoker` to use main registry `androidx.test.platform.app.InstrumentationRegistry`.\r\n","reactions":{"url":"https://api.github.com/repos/robolectric/robolectric/issues/6781/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/robolectric/robolectric/issues/6781/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/947855716","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-947855716","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":947855716,"node_id":"IC_kwDOAhNhM844fyFk","user":{"login":"brettchabot","id":4038919,"node_id":"MDQ6VXNlcjQwMzg5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/4038919?v=4","gravatar_id":"","url":"https://api.github.com/users/brettchabot","html_url":"https://github.com/brettchabot","followers_url":"https://api.github.com/users/brettchabot/followers","following_url":"https://api.github.com/users/brettchabot/following{/other_user}","gists_url":"https://api.github.com/users/brettchabot/gists{/gist_id}","starred_url":"https://api.github.com/users/brettchabot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brettchabot/subscriptions","organizations_url":"https://api.github.com/users/brettchabot/orgs","repos_url":"https://api.github.com/users/brettchabot/repos","events_url":"https://api.github.com/users/brettchabot/events{/privacy}","received_events_url":"https://api.github.com/users/brettchabot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T16:57:36Z","updated_at":"2021-10-20T16:57:36Z","body":"androidx.test maintainer here. Please let us know how we could help migrate LeakCanary from depending on androidx.test implementation details. #2147 will only 'fix' this issue until the next time the implementation is changed again. \r\n\r\nAnything in androidx.test.internal is not a stable API surface and no external libraries should depend on it. ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/947855716/reactions","total_count":3,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":3,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"brettchabot","id":4038919,"node_id":"MDQ6VXNlcjQwMzg5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/4038919?v=4","gravatar_id":"","url":"https://api.github.com/users/brettchabot","html_url":"https://github.com/brettchabot","followers_url":"https://api.github.com/users/brettchabot/followers","following_url":"https://api.github.com/users/brettchabot/following{/other_user}","gists_url":"https://api.github.com/users/brettchabot/gists{/gist_id}","starred_url":"https://api.github.com/users/brettchabot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brettchabot/subscriptions","organizations_url":"https://api.github.com/users/brettchabot/orgs","repos_url":"https://api.github.com/users/brettchabot/repos","events_url":"https://api.github.com/users/brettchabot/events{/privacy}","received_events_url":"https://api.github.com/users/brettchabot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/995260986","html_url":"https://github.com/square/leakcanary/issues/1986#issuecomment-995260986","issue_url":"https://api.github.com/repos/square/leakcanary/issues/1986","id":995260986,"node_id":"IC_kwDOAhNhM847Uno6","user":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-15T22:23:33Z","updated_at":"2021-12-15T22:24:02Z","body":"Thanks everybody, sorry this is taking a while.\r\n\r\n> Anything in androidx.test.internal is not a stable API surface and no external libraries should depend on it.\r\n\r\n@brettchabot I hear you, but also: https://en.wikipedia.org/wiki/Desire_path\r\n\r\nIn other words, when an API is missing, users will find a way around it. The missing API was \"I need a way to fail an otherwise successful test once it's done running\". A bit like a rule but that applies to all tests\r\n\r\nThere is one API that's available: Junit rules. The problem with those is two fold: 1) they're not applied to all tests, so you have to manually add to each test. 2) Espresso itself had leaks within its outer rules code (it keeps activities after they're destroyed) and that's meant leak detection would trigger due to Espresso. I believe that's fixed now, and we could likely use a rule, but it's definitely way less convenient.\r\n\r\nI might take a spike at migrating this and the documentation to rely on rules instead, but that's a pretty significant change. ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/square/leakcanary/issues/comments/995260986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pyricau","id":557033,"node_id":"MDQ6VXNlcjU1NzAzMw==","avatar_url":"https://avatars.githubusercontent.com/u/557033?v=4","gravatar_id":"","url":"https://api.github.com/users/pyricau","html_url":"https://github.com/pyricau","followers_url":"https://api.github.com/users/pyricau/followers","following_url":"https://api.github.com/users/pyricau/following{/other_user}","gists_url":"https://api.github.com/users/pyricau/gists{/gist_id}","starred_url":"https://api.github.com/users/pyricau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyricau/subscriptions","organizations_url":"https://api.github.com/users/pyricau/orgs","repos_url":"https://api.github.com/users/pyricau/repos","events_url":"https://api.github.com/users/pyricau/events{/privacy}","received_events_url":"https://api.github.com/users/pyricau/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5774670980,"node_id":"MEE_lADOAhNhM84rxcHnzwAAAAFYMnyE","url":"https://api.github.com/repos/square/leakcanary/issues/events/5774670980","actor":{"login":"brettchabot","id":4038919,"node_id":"MDQ6VXNlcjQwMzg5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/4038919?v=4","gravatar_id":"","url":"https://api.github.com/users/brettchabot","html_url":"https://github.com/brettchabot","followers_url":"https://api.github.com/users/brettchabot/followers","following_url":"https://api.github.com/users/brettchabot/following{/other_user}","gists_url":"https://api.github.com/users/brettchabot/gists{/gist_id}","starred_url":"https://api.github.com/users/brettchabot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brettchabot/subscriptions","organizations_url":"https://api.github.com/users/brettchabot/orgs","repos_url":"https://api.github.com/users/brettchabot/repos","events_url":"https://api.github.com/users/brettchabot/events{/privacy}","received_events_url":"https://api.github.com/users/brettchabot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-12-15T22:23:33Z","performed_via_github_app":null},{"id":5774670984,"node_id":"SE_lADOAhNhM84rxcHnzwAAAAFYMnyI","url":"https://api.github.com/repos/square/leakcanary/issues/events/5774670984","actor":{"login":"brettchabot","id":4038919,"node_id":"MDQ6VXNlcjQwMzg5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/4038919?v=4","gravatar_id":"","url":"https://api.github.com/users/brettchabot","html_url":"https://github.com/brettchabot","followers_url":"https://api.github.com/users/brettchabot/followers","following_url":"https://api.github.com/users/brettchabot/following{/other_user}","gists_url":"https://api.github.com/users/brettchabot/gists{/gist_id}","starred_url":"https://api.github.com/users/brettchabot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brettchabot/subscriptions","organizations_url":"https://api.github.com/users/brettchabot/orgs","repos_url":"https://api.github.com/users/brettchabot/repos","events_url":"https://api.github.com/users/brettchabot/events{/privacy}","received_events_url":"https://api.github.com/users/brettchabot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-12-15T22:23:33Z","performed_via_github_app":null}]