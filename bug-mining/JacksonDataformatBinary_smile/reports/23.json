{"url":"https://api.github.com/repos/FasterXML/jackson-dataformats-binary/issues/300","repository_url":"https://api.github.com/repos/FasterXML/jackson-dataformats-binary","labels_url":"https://api.github.com/repos/FasterXML/jackson-dataformats-binary/issues/300/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-dataformats-binary/issues/300/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-dataformats-binary/issues/300/events","html_url":"https://github.com/FasterXML/jackson-dataformats-binary/issues/300","id":1021777364,"node_id":"I_kwDOA3Qg68485xXU","number":300,"title":"Floats are encoded with sign extension while doubles without","user":{"login":"sfackler","id":1455697,"node_id":"MDQ6VXNlcjE0NTU2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1455697?v=4","gravatar_id":"","url":"https://api.github.com/users/sfackler","html_url":"https://github.com/sfackler","followers_url":"https://api.github.com/users/sfackler/followers","following_url":"https://api.github.com/users/sfackler/following{/other_user}","gists_url":"https://api.github.com/users/sfackler/gists{/gist_id}","starred_url":"https://api.github.com/users/sfackler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfackler/subscriptions","organizations_url":"https://api.github.com/users/sfackler/orgs","repos_url":"https://api.github.com/users/sfackler/repos","events_url":"https://api.github.com/users/sfackler/events{/privacy}","received_events_url":"https://api.github.com/users/sfackler/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":433796791,"node_id":"MDU6TGFiZWw0MzM3OTY3OTE=","url":"https://api.github.com/repos/FasterXML/jackson-dataformats-binary/labels/smile","name":"smile","color":"0e8a16","default":false,"description":null},{"id":7604560508,"node_id":"LA_kwDOA3Qg688AAAABxURifA","url":"https://api.github.com/repos/FasterXML/jackson-dataformats-binary/labels/2.19","name":"2.19","color":"c2e0c6","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-dataformats-binary/milestones/61","html_url":"https://github.com/FasterXML/jackson-dataformats-binary/milestone/61","labels_url":"https://api.github.com/repos/FasterXML/jackson-dataformats-binary/milestones/61/labels","id":12086674,"node_id":"MI_kwDOA3Qg684AuG2S","number":61,"title":"2.19.0","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":6,"state":"open","created_at":"2024-12-24T01:34:08Z","updated_at":"2025-05-22T22:55:01Z","due_on":null,"closed_at":null},"comments":5,"created_at":"2021-10-09T18:42:05Z","updated_at":"2025-02-06T05:09:24Z","closed_at":"2025-02-06T05:09:24Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'm working on a Smile implementation in Rust, and am trying to exactly match Jackson's behavior to be able to test against it. While testing floats and doubles, I've noticed an inconsistency in how Jackson's serializer behaves. Specifically, the float and double serialization logic differ in what ends up in the unused high bits of the MSB of the encoded representation.\r\n\r\nThe float implementation uses arithmetic shifts, so a negative floating point value will end up with the unused high bits set to 1 and a positive floating point value will end up with the unused high bits set to 0. In contrast, the double implementation uses a logical shift in one place, so the unused high bits are always 0.\r\n\r\nAs an example, here's an encoding of `(float) -0` into Smile using 2.13.0:\r\n\r\n```\r\n00000000: 3a29 0a00 2878 0000 0000                 :)..(x....\r\n```\r\n\r\nThe first byte of the encoded float is 0x78, aka `0b01111000`.\r\n\r\nAnd here's the encoding of `(double) -0`:\r\n\r\n```\r\n00000000: 3a29 0a00 2901 0000 0000 0000 0000 00    :)..)..........\r\n```\r\n\r\nThe first byte of the encoded double is 0x01, aka `0b00000001`.\r\n\r\nThe contents of the unused bits shouldn't matter in practice, but it'd probably be good to unify and explicitly specify the desired behavior here.","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-dataformats-binary/issues/300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-dataformats-binary/issues/300/timeline","performed_via_github_app":null,"state_reason":"completed"}