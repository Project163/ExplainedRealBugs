diff --git a/CHANGES b/CHANGES
index 658c479..2d08e55 100644
--- a/CHANGES
+++ b/CHANGES
@@ -12,6 +12,7 @@ Version 6.7
 - Fix bug in bash completion with nested subcommands. See #639.
 - Fix test runner not saving caller env correctly. See #644.
 - Fix handling of SIGPIPE. See #626
+- Deal with broken Windows environments such as Google App Engine's. See #711.
 
 Version 6.6
 -----------
diff --git a/click/_compat.py b/click/_compat.py
index 6bbebd3..2b43412 100644
--- a/click/_compat.py
+++ b/click/_compat.py
@@ -160,8 +160,16 @@ if PY2:
     #
     # This code also lives in _winconsole for the fallback to the console
     # emulation stream.
-    if WIN:
+    #
+    # There are also Windows environments where the `msvcrt` module is not
+    # available (which is why we use try-catch instead of the WIN variable
+    # here), such as the Google App Engine development server on Windows. In
+    # those cases there is just nothing we can do.
+    try:
         import msvcrt
+    except ImportError:
+        set_binary_mode = lambda x: x
+    else:
         def set_binary_mode(f):
             try:
                 fileno = f.fileno()
@@ -170,8 +178,6 @@ if PY2:
             else:
                 msvcrt.setmode(fileno, os.O_BINARY)
             return f
-    else:
-        set_binary_mode = lambda x: x
 
     def isidentifier(x):
         return _identifier_re.search(x) is not None
