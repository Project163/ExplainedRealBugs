diff --git a/CHANGES b/CHANGES
index 66b53ca..62a5d85 100644
--- a/CHANGES
+++ b/CHANGES
@@ -13,6 +13,7 @@ Version 4.1
 - Support streams with encoding set to `None` on Python 3 by barfing with
   a better error.
 - Handle ^C in less-pager properly.
+- Handle return value of `None` from `sys.getfilesystemencoding`
 
 Version 4.0
 -----------
diff --git a/click/_compat.py b/click/_compat.py
index 60c8162..6e90408 100644
--- a/click/_compat.py
+++ b/click/_compat.py
@@ -14,6 +14,10 @@ DEFAULT_COLUMNS = 80
 _ansi_re = re.compile('\033\[((?:\d|;)*)([a-zA-Z])')
 
 
+def get_filesystem_encoding():
+    return sys.getfilesystemencoding() or sys.getdefaultencoding()
+
+
 def _make_text_stream(stream, encoding, errors):
     if encoding is None:
         encoding = get_best_encoding(stream)
@@ -189,7 +193,7 @@ if PY2:
 
     def filename_to_ui(value):
         if isinstance(value, bytes):
-            value = value.decode(sys.getfilesystemencoding(), 'replace')
+            value = value.decode(get_filesystem_encoding(), 'replace')
         return value
 else:
     import io
@@ -364,7 +368,7 @@ else:
 
     def filename_to_ui(value):
         if isinstance(value, bytes):
-            value = value.decode(sys.getfilesystemencoding(), 'replace')
+            value = value.decode(get_filesystem_encoding(), 'replace')
         else:
             value = value.encode('utf-8', 'surrogateescape') \
                 .decode('utf-8', 'replace')
diff --git a/click/types.py b/click/types.py
index 0736be5..ebf772b 100644
--- a/click/types.py
+++ b/click/types.py
@@ -2,7 +2,8 @@ import os
 import sys
 import stat
 
-from ._compat import open_stream, text_type, filename_to_ui, get_streerror
+from ._compat import open_stream, text_type, filename_to_ui, \
+    get_filesystem_encoding, get_streerror
 from .exceptions import BadParameter
 from .utils import safecall, LazyFile
 
@@ -114,7 +115,7 @@ class StringParamType(ParamType):
                     value = value.decode(enc)
             except UnicodeError:
                 try:
-                    value = value.decode(sys.getfilesystemencoding())
+                    value = value.decode(get_filesystem_encoding())
                 except UnicodeError:
                     value = value.decode('utf-8', 'replace')
             return value
diff --git a/click/utils.py b/click/utils.py
index 8aa7bdc..8c98b0b 100644
--- a/click/utils.py
+++ b/click/utils.py
@@ -2,10 +2,10 @@ import os
 import sys
 from collections import deque
 
-from ._compat import text_type, open_stream, get_streerror, string_types, \
-     PY2, binary_streams, text_streams, filename_to_ui, \
-     auto_wrap_for_ansi, strip_ansi, should_strip_ansi, \
-     _default_text_stdout, _default_text_stderr, is_bytes, WIN
+from ._compat import text_type, open_stream, get_filesystem_encoding, \
+    get_streerror, string_types, PY2, binary_streams, text_streams, \
+    filename_to_ui, auto_wrap_for_ansi, strip_ansi, should_strip_ansi, \
+    _default_text_stdout, _default_text_stderr, is_bytes, WIN
 
 if not PY2:
     from ._compat import _find_binary_writer
@@ -90,7 +90,7 @@ def make_str(value):
     """Converts a value into a valid string."""
     if isinstance(value, bytes):
         try:
-            return value.decode(sys.getfilesystemencoding())
+            return value.decode(get_filesystem_encoding())
         except UnicodeError:
             return value.decode('utf-8', 'replace')
     return text_type(value)
