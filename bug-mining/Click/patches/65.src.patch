diff --git a/click/_compat.py b/click/_compat.py
index e8b06a4..eb236a6 100644
--- a/click/_compat.py
+++ b/click/_compat.py
@@ -669,6 +669,7 @@ def _make_cached_stream_func(src_func, wrapper_func):
             return rv
         rv = wrapper_func()
         try:
+            stream = src_func()  # In case wrapper_func() modified the stream
             cache[stream] = rv
         except Exception:
             pass
diff --git a/click/_winconsole.py b/click/_winconsole.py
index 4530051..8bcb66c 100644
--- a/click/_winconsole.py
+++ b/click/_winconsole.py
@@ -201,6 +201,30 @@ class ConsoleStream(object):
         )
 
 
+class StreamWrapper(object):
+    """
+    Wraps a stream (such as stdout), acting as a transparent proxy for all
+    attribute access apart from method 'write()' which we wrap to write in
+    limited chunks due to a Windows limitation on binary console streams.
+    """
+    def __init__(self, wrapped):
+        # double-underscore everything to prevent clashes with names of
+        # attributes on the wrapped stream object.
+        self.__wrapped = wrapped
+
+    def __getattr__(self, name):
+        return getattr(self.__wrapped, name)
+
+    def write(self, text):
+        total_to_write = len(text)
+        written = 0
+
+        while written < total_to_write:
+            to_write = min(total_to_write - written, MAX_BYTES_WRITTEN)
+            self.__wrapped.write(text[written:written+to_write])
+            written += to_write
+
+
 def _get_text_stdin(buffer_stream):
     text_stream = _NonClosingTextIOWrapper(
         io.BufferedReader(_WindowsConsoleReader(STDIN_HANDLE)),
@@ -209,6 +233,10 @@ def _get_text_stdin(buffer_stream):
 
 
 def _get_text_stdout(buffer_stream):
+    if PY2:
+        buffer_stream = StreamWrapper(buffer_stream)
+        sys.stdout = StreamWrapper(sys.stdout)
+
     text_stream = _NonClosingTextIOWrapper(
         io.BufferedWriter(_WindowsConsoleWriter(STDOUT_HANDLE)),
         'utf-16-le', 'strict', line_buffering=True)
@@ -216,6 +244,10 @@ def _get_text_stdout(buffer_stream):
 
 
 def _get_text_stderr(buffer_stream):
+    if PY2:
+        buffer_stream = StreamWrapper(buffer_stream)
+        sys.stderr = StreamWrapper(sys.stderr)
+
     text_stream = _NonClosingTextIOWrapper(
         io.BufferedWriter(_WindowsConsoleWriter(STDERR_HANDLE)),
         'utf-16-le', 'strict', line_buffering=True)
