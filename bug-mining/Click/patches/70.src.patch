diff --git a/CHANGES.rst b/CHANGES.rst
index 6e639ba..ac1c51b 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -6,8 +6,6 @@ Version 7.1
 Unreleased
 
 -   Fix PyPI package name, "click" is lowercase again.
--   Add ``no_args_is_help`` option to ``click.Command``, defaults to
-    False :pr:`1167`
 -   Fix link in ``unicode_literals`` error message. :pr:`1151`
 -   Add support for colored output on UNIX Jupyter notebooks.
     :issue:`1185`
@@ -15,15 +13,18 @@ Unreleased
 -   Expand testing around termui, especially getchar on Windows.
     :issue:`1116`
 -   Fix output on Windows Python 2.7 built with MSVC 14. :pr:`1342`
--   Always return one of the passed choices for ``click.Choice``
-    :issue:`1277`, :pr:`1318`
 -   Fix ``OSError`` when running in MSYS2. :issue:`1338`
+-   Fix ``OSError`` when redirecting to ``NUL`` stream on Windows.
+    :issue:`1065`
 -   Fix error in new AppEngine environments. :issue:`1462`
+-   Always return one of the passed choices for ``click.Choice``
+    :issue:`1277`, :pr:`1318`
+-   Add ``no_args_is_help`` option to ``click.Command``, defaults to
+    False :pr:`1167`
 -   Add ``show_defaults`` parameter to ``Context`` to enable showing
     defaults globally. :issue:`1018`
 
 
-
 Version 7.0
 -----------
 
diff --git a/click/_winconsole.py b/click/_winconsole.py
index 2bc0cfb..dc203cc 100644
--- a/click/_winconsole.py
+++ b/click/_winconsole.py
@@ -24,7 +24,7 @@ try:
     PyBuffer_Release = pythonapi.PyBuffer_Release
 except ImportError:
     pythonapi = None
-from ctypes.wintypes import LPWSTR, LPCWSTR, HANDLE
+from ctypes.wintypes import DWORD, LPWSTR, LPCWSTR, HANDLE
 
 
 c_ssize_p = POINTER(c_ssize_t)
@@ -33,6 +33,7 @@ kernel32 = windll.kernel32
 GetStdHandle = kernel32.GetStdHandle
 ReadConsoleW = kernel32.ReadConsoleW
 WriteConsoleW = kernel32.WriteConsoleW
+GetConsoleMode = kernel32.GetConsoleMode
 GetLastError = kernel32.GetLastError
 GetCommandLineW = WINFUNCTYPE(LPWSTR)(
     ('GetCommandLineW', windll.kernel32))
@@ -287,11 +288,24 @@ _stream_factories = {
 }
 
 
+def _is_console(f):
+    if not hasattr(f, 'fileno'):
+        return False
+
+    try:
+        fileno = f.fileno()
+    except OSError:
+        return False
+
+    handle = msvcrt.get_osfhandle(fileno)
+    return bool(GetConsoleMode(handle, byref(DWORD())))
+
+
 def _get_windows_console_stream(f, encoding, errors):
     if get_buffer is not None and \
        encoding in ('utf-16-le', None) \
        and errors in ('strict', None) and \
-       hasattr(f, 'isatty') and f.isatty():
+       _is_console(f):
         func = _stream_factories.get(f.fileno())
         if func is not None:
             if not PY2:
