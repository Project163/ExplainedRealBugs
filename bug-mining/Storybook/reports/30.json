{"url":"https://api.github.com/repos/storybookjs/storybook/issues/32603","repository_url":"https://api.github.com/repos/storybookjs/storybook","labels_url":"https://api.github.com/repos/storybookjs/storybook/issues/32603/labels{/name}","comments_url":"https://api.github.com/repos/storybookjs/storybook/issues/32603/comments","events_url":"https://api.github.com/repos/storybookjs/storybook/issues/32603/events","html_url":"https://github.com/storybookjs/storybook/issues/32603","id":3473800774,"node_id":"I_kwDOAzqfmc7PDf5G","number":32603,"title":"[Bug]: \"Maximum call stack size exceeded\" error when using Cally date picker","user":{"login":"rdebeasi","id":1299370,"node_id":"MDQ6VXNlcjEyOTkzNzA=","avatar_url":"https://avatars.githubusercontent.com/u/1299370?v=4","gravatar_id":"","url":"https://api.github.com/users/rdebeasi","html_url":"https://github.com/rdebeasi","followers_url":"https://api.github.com/users/rdebeasi/followers","following_url":"https://api.github.com/users/rdebeasi/following{/other_user}","gists_url":"https://api.github.com/users/rdebeasi/gists{/gist_id}","starred_url":"https://api.github.com/users/rdebeasi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdebeasi/subscriptions","organizations_url":"https://api.github.com/users/rdebeasi/orgs","repos_url":"https://api.github.com/users/rdebeasi/repos","events_url":"https://api.github.com/users/rdebeasi/events{/privacy}","received_events_url":"https://api.github.com/users/rdebeasi/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":343576454,"node_id":"MDU6TGFiZWwzNDM1NzY0NTQ=","url":"https://api.github.com/repos/storybookjs/storybook/labels/bug","name":"bug","color":"EB484F","default":true,"description":null},{"id":626669469,"node_id":"MDU6TGFiZWw2MjY2Njk0Njk=","url":"https://api.github.com/repos/storybookjs/storybook/labels/react","name":"react","color":"f9d0c4","default":false,"description":""},{"id":6356276807,"node_id":"LA_kwDOAzqfmc8AAAABet0WRw","url":"https://api.github.com/repos/storybookjs/storybook/labels/test%20utilities","name":"test utilities","color":"FBCA04","default":false,"description":""},{"id":8576329827,"node_id":"LA_kwDOAzqfmc8AAAAB_zBoYw","url":"https://api.github.com/repos/storybookjs/storybook/labels/addon:%20pseudo-states","name":"addon: pseudo-states","color":"fbca04","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2025-10-01T14:17:36Z","updated_at":"2025-11-04T16:43:39Z","closed_at":"2025-11-04T16:43:39Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nWhen the [Cally](https://github.com/WickyNilliams/cally) date picker is used in Storybook, a \"maximum call stack size\" error occurs. This error does not occur outside of Storybook.\n\n> VM1030 cally.js:19 Uncaught RangeError: Maximum call stack size exceeded\n\n### Reproduction link\n\nhttps://github.com/rdebeasi/cally-repro\n\n### Reproduction steps\n\n1. Check out the repro and run `npm i`. \n2. Run `npm run storybok`. This command runs React + Vite + Storybook.\n3. In a browser, open http://localhost:6006/iframe.html?globals=&id=example-datepicker--basic&viewMode=story\n4. Open browser dev tools and open the console tab.\n5. Click a date.\n6. Note that the follwoing error appears in console: \"VM1030 cally.js:19 Uncaught RangeError: Maximum call stack size exceeded\".\n7. Press an arrow key.\n8. Note that the highlighted date does not move.\n\nThis repro uses Storybook React, but I've also seen the issue when using Storybook Angular.\n\n### Viewing expected behavior\n\n1. Run `npm run dev`. This command runs a React + Vite app.\n2. Open the local dev site in a browser.\n3. Open browser dev tools and open the console tab.\n4. Click a date.\n5. Note that no errors appear in console.\n6. Press an arrow key.\n7. Note that the highlighted date moves in the direction of the arrow key that was pressed.\n\n\n### System\n\n```bash\nStorybook Environment Info:\n\n  System:\n    OS: macOS 15.6.1\n    CPU: (8) arm64 Apple M1 Pro\n    Shell: 5.9 - /bin/zsh\n  Binaries:\n    Node: 22.18.0 - ~/.local/state/fnm_multishells/48691_1759251509769/bin/node\n    npm: 10.9.3 - ~/.local/state/fnm_multishells/48691_1759251509769/bin/npm <----- active\n  Browsers:\n    Chrome: 140.0.7339.214\n    Edge: 140.0.3485.94\n    Safari: 18.6\n  npmPackages:\n    @storybook/react-vite: ^9.1.8 => 9.1.8 \n    eslint-plugin-storybook: ^9.1.8 => 9.1.8 \n    storybook: ^9.1.8 => 9.1.8\n```\n\n### Additional context\n\nThe \"maximum call stack size\" error appears when Cally [attempts to focus](https://github.com/WickyNilliams/cally/blob/38e6a7bc7c53e29c427f5de028b8544e2bff9a9d/src/calendar-month/calendar-month.tsx#L23) to focus the button for currently selected date. This logic runs when the month is focused.\n\nIf focus events bubbled, then I could see why this error would occur. The button's focus event would bubble up to the month, which would trigger another button focus, which would trigger another month focus, which would trigger another button focus, etc.\n\nMy understanding is that [focus events don't bubble](https://developer.mozilla.org/en-US/docs/Web/API/Element/focus_event), so I'm confused as to why this loop would occur. Is it possible that something in Storybook is causing focus events to bubble?\n\nThank you!!","closed_by":{"login":"yannbf","id":1671563,"node_id":"MDQ6VXNlcjE2NzE1NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1671563?v=4","gravatar_id":"","url":"https://api.github.com/users/yannbf","html_url":"https://github.com/yannbf","followers_url":"https://api.github.com/users/yannbf/followers","following_url":"https://api.github.com/users/yannbf/following{/other_user}","gists_url":"https://api.github.com/users/yannbf/gists{/gist_id}","starred_url":"https://api.github.com/users/yannbf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yannbf/subscriptions","organizations_url":"https://api.github.com/users/yannbf/orgs","repos_url":"https://api.github.com/users/yannbf/repos","events_url":"https://api.github.com/users/yannbf/events{/privacy}","received_events_url":"https://api.github.com/users/yannbf/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/storybookjs/storybook/issues/32603/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/storybookjs/storybook/issues/32603/timeline","performed_via_github_app":null,"state_reason":"completed"}