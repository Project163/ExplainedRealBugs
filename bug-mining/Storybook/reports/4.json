{"url":"https://api.github.com/repos/storybookjs/storybook/issues/21343","repository_url":"https://api.github.com/repos/storybookjs/storybook","labels_url":"https://api.github.com/repos/storybookjs/storybook/issues/21343/labels{/name}","comments_url":"https://api.github.com/repos/storybookjs/storybook/issues/21343/comments","events_url":"https://api.github.com/repos/storybookjs/storybook/issues/21343/events","html_url":"https://github.com/storybookjs/storybook/issues/21343","id":1605950739,"node_id":"I_kwDOAzqfmc5fuN0T","number":21343,"title":"[Bug]: Storybook does not respect BROWSER env var if default browser is not chromium based.","user":{"login":"vito-giarrusso","id":9210782,"node_id":"MDQ6VXNlcjkyMTA3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9210782?v=4","gravatar_id":"","url":"https://api.github.com/users/vito-giarrusso","html_url":"https://github.com/vito-giarrusso","followers_url":"https://api.github.com/users/vito-giarrusso/followers","following_url":"https://api.github.com/users/vito-giarrusso/following{/other_user}","gists_url":"https://api.github.com/users/vito-giarrusso/gists{/gist_id}","starred_url":"https://api.github.com/users/vito-giarrusso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vito-giarrusso/subscriptions","organizations_url":"https://api.github.com/users/vito-giarrusso/orgs","repos_url":"https://api.github.com/users/vito-giarrusso/repos","events_url":"https://api.github.com/users/vito-giarrusso/events{/privacy}","received_events_url":"https://api.github.com/users/vito-giarrusso/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":343576454,"node_id":"MDU6TGFiZWwzNDM1NzY0NTQ=","url":"https://api.github.com/repos/storybookjs/storybook/labels/bug","name":"bug","color":"EB484F","default":true,"description":null},{"id":603520516,"node_id":"MDU6TGFiZWw2MDM1MjA1MTY=","url":"https://api.github.com/repos/storybookjs/storybook/labels/cli","name":"cli","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"vito-giarrusso","id":9210782,"node_id":"MDQ6VXNlcjkyMTA3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9210782?v=4","gravatar_id":"","url":"https://api.github.com/users/vito-giarrusso","html_url":"https://github.com/vito-giarrusso","followers_url":"https://api.github.com/users/vito-giarrusso/followers","following_url":"https://api.github.com/users/vito-giarrusso/following{/other_user}","gists_url":"https://api.github.com/users/vito-giarrusso/gists{/gist_id}","starred_url":"https://api.github.com/users/vito-giarrusso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vito-giarrusso/subscriptions","organizations_url":"https://api.github.com/users/vito-giarrusso/orgs","repos_url":"https://api.github.com/users/vito-giarrusso/repos","events_url":"https://api.github.com/users/vito-giarrusso/events{/privacy}","received_events_url":"https://api.github.com/users/vito-giarrusso/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"vito-giarrusso","id":9210782,"node_id":"MDQ6VXNlcjkyMTA3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9210782?v=4","gravatar_id":"","url":"https://api.github.com/users/vito-giarrusso","html_url":"https://github.com/vito-giarrusso","followers_url":"https://api.github.com/users/vito-giarrusso/followers","following_url":"https://api.github.com/users/vito-giarrusso/following{/other_user}","gists_url":"https://api.github.com/users/vito-giarrusso/gists{/gist_id}","starred_url":"https://api.github.com/users/vito-giarrusso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vito-giarrusso/subscriptions","organizations_url":"https://api.github.com/users/vito-giarrusso/orgs","repos_url":"https://api.github.com/users/vito-giarrusso/repos","events_url":"https://api.github.com/users/vito-giarrusso/events{/privacy}","received_events_url":"https://api.github.com/users/vito-giarrusso/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":5,"created_at":"2023-03-02T01:16:18Z","updated_at":"2023-05-23T16:21:55Z","closed_at":"2023-05-22T11:33:50Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\r\n\r\nWhen using the environment variable BROWSER to configure the browser that storybook opens in, storybook will not respect this configuration if the users default browser is not set to a browser which the `@aw-web-design/x-default-browser` package does not resolve to either `chrome`, `chromium` or `com.brave.browser`.\r\n\r\n### To Reproduce\r\n\r\n### To reproduce\r\n\r\n#### Set the system default browser to something not based on chromium\r\n\r\neg: `safari`\r\n\r\n#### Clone the reproduction repo\r\n\r\n```bash\r\nmkdir repo-test\r\ncd repo-test\r\ngit clone https://github.com/thtliife/storybook-specify-browser-repro\r\n```\r\n\r\n#### Install dependencies\r\n\r\n```bash\r\nyarn\r\n```\r\n\r\n#### Run storybook with the BROWSER environment variable set to something other than the default system browser:\r\n\r\n```bash\r\nBROWSER=firefox yarn storybook\r\n```\r\n\r\nor create a .env file in the root of the project with the following contents:\r\n\r\n```bash\r\nBROWSER=firefox\r\n```\r\n\r\nthen run storybook\r\n```bash\r\nyarn storybook\r\n```\r\n\r\n### System\r\n\r\n```shell\r\nEnvironment Info:\r\n\r\n  System:\r\n    OS: macOS 13.1\r\n    CPU: (8) arm64 Apple M1\r\n  Binaries:\r\n    Node: 16.13.0 - ~/.tools/n/bin/node\r\n    Yarn: 1.22.19 - ~/.tools/n/bin/yarn\r\n    npm: 8.1.0 - ~/.tools/n/bin/npm\r\n  Browsers:\r\n    Chrome: 110.0.5481.177\r\n    Firefox: 110.0.1\r\n    Safari: 16.2\r\n```\r\n\r\n\r\n### Additional context\r\n\r\nThe problem is caused by the `open-in-browser` utility not passing args to `open` when the default browser is not chromium.\r\n\r\nIf the default browser is a chromium browser, `better-opn` is used which does its own evaluation of environment variables, allowing the BROWSER variable to be evaluated.\r\n\r\n","closed_by":{"login":"ndelangen","id":3070389,"node_id":"MDQ6VXNlcjMwNzAzODk=","avatar_url":"https://avatars.githubusercontent.com/u/3070389?v=4","gravatar_id":"","url":"https://api.github.com/users/ndelangen","html_url":"https://github.com/ndelangen","followers_url":"https://api.github.com/users/ndelangen/followers","following_url":"https://api.github.com/users/ndelangen/following{/other_user}","gists_url":"https://api.github.com/users/ndelangen/gists{/gist_id}","starred_url":"https://api.github.com/users/ndelangen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndelangen/subscriptions","organizations_url":"https://api.github.com/users/ndelangen/orgs","repos_url":"https://api.github.com/users/ndelangen/repos","events_url":"https://api.github.com/users/ndelangen/events{/privacy}","received_events_url":"https://api.github.com/users/ndelangen/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/storybookjs/storybook/issues/21343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/storybookjs/storybook/issues/21343/timeline","performed_via_github_app":null,"state_reason":"completed"}