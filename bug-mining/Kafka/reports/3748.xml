<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:38:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-16310] ListOffsets doesn&apos;t report the offset with maxTimestamp anymore</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-16310</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Updated: This is confirmed a regression issue in v3.7.0. &lt;/p&gt;

&lt;p&gt;The impact of this issue is that when there is a batch containing records with timestamp not in order, the offset of the timestamp will be wrong.(ex: the timestamp for t0 should be mapping to offset 10, but will get offset 12.. etc). It&apos;ll cause the time index is putting the wrong offset, so the result will be unexpected. &lt;/p&gt;

&lt;p&gt;===&lt;br/&gt;
The last offset is reported instead.&lt;br/&gt;
A test in librdkafka (0081/do_test_ListOffsets) is failing an it&apos;s checking that the offset with the max timestamp is the middle one and not the last one. The tests is passing with 3.6.0 and previous versions&lt;/p&gt;

&lt;p&gt;This is the test:&lt;br/&gt;
&lt;a href=&quot;https://github.com/confluentinc/librdkafka/blob/a6d85bdbc1023b1a5477b8befe516242c3e182f6/tests/0081-admin.c#L4989&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/confluentinc/librdkafka/blob/a6d85bdbc1023b1a5477b8befe516242c3e182f6/tests/0081-admin.c#L4989&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;there are three messages, with timestamps:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;t0 + 100
t0 + 400
t0 + 250&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and indices 0,1,2.&#160;&lt;/p&gt;

&lt;p&gt;then a ListOffsets with RD_KAFKA_OFFSET_SPEC_MAX_TIMESTAMP is done.&lt;br/&gt;
it should return offset 1 but in 3.7.0 and trunk is returning offset 2&lt;/p&gt;

&lt;p&gt;Even after 5 seconds from producing it&apos;s still returning 2 as the offset with max timestamp.&lt;br/&gt;
ProduceRequest and ListOffsets were sent to the same broker (2), the leader didn&apos;t change.&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
%7|1709134230.019|SEND|0081_admin#producer-3| [thrd:localhost:39951/bootstrap]: localhost:39951/2: Sent ProduceRequest (v7, 206 bytes @ 0, CorrId 2) %7|1709134230.020|RECV|0081_admin#producer-3| [thrd:localhost:39951/bootstrap]: localhost:39951/2: Received ProduceResponse (v7, 95 bytes, CorrId 2, rtt 1.18ms) %7|1709134230.020|MSGSET|0081_admin#producer-3| [thrd:localhost:39951/bootstrap]: localhost:39951/2: rdkafkatest_rnd22e8d8ec45b53f98_do_test_ListOffsets [0]: MessageSet with 3 message(s) (MsgId 0, BaseSeq -1) delivered &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
%7|1709134235.021|SEND|0081_admin#producer-2| [thrd:localhost:39951/bootstrap]: localhost:39951/2: Sent ListOffsetsRequest (v7, 103 bytes @ 0, CorrId 7) %7|1709134235.022|RECV|0081_admin#producer-2| [thrd:localhost:39951/bootstrap]: localhost:39951/2: Received ListOffsetsResponse (v7, 88 bytes, CorrId 7, rtt 0.54ms)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13570145">KAFKA-16310</key>
            <summary>ListOffsets doesn&apos;t report the offset with maxTimestamp anymore</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chia7712">Chia-Ping Tsai</assignee>
                                    <reporter username="emasab">Emanuele Sabellico</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Feb 2024 10:55:30 +0000</created>
                <updated>Thu, 9 May 2024 01:05:05 +0000</updated>
                            <resolved>Wed, 10 Apr 2024 03:38:19 +0000</resolved>
                                    <version>3.7.0</version>
                                    <fixVersion>3.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                                                                                                            <comments>
                            <comment id="17822981" author="chia7712" created="Sun, 3 Mar 2024 20:10:56 +0000"  >&lt;p&gt;the bug is related to &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-14477&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-14477&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;the code of updating `offsetOfMaxTimestamp` was:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-scala&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (timestampType == TimestampType.LOG_APPEND_TIME) {
      maxTimestamp = now
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (magic &amp;gt;= RecordBatch.MAGIC_VALUE_V2)
        offsetOfMaxTimestamp = offsetCounter.value - 1
      &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
        offsetOfMaxTimestamp = initialOffset
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and now we always update `offsetOfMaxTimestamp` to `offsetCounter.value - 1` even though it is  TimestampType.LOG_APPEND_TIME (see &lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/storage/src/main/java/org/apache/kafka/storage/internals/log/LogValidator.java#L300&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/storage/src/main/java/org/apache/kafka/storage/internals/log/LogValidator.java#L300&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (timestampType == TimestampType.LOG_APPEND_TIME) {
            maxTimestamp = now;
            offsetOfMaxTimestamp = initialOffset;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (toMagic &amp;gt;= RecordBatch.MAGIC_VALUE_V2) {
            offsetOfMaxTimestamp = offsetCounter.value - 1;
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Furthermore, the path of compressed data has similar issue. see &lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/storage/src/main/java/org/apache/kafka/storage/internals/log/LogValidator.java#L417&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/storage/src/main/java/org/apache/kafka/storage/internals/log/LogValidator.java#L417&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kevinztw&quot; class=&quot;user-hover&quot; rel=&quot;kevinztw&quot;&gt;kevinztw&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ijuma&quot; class=&quot;user-hover&quot; rel=&quot;ijuma&quot;&gt;ijuma&lt;/a&gt; Please double check the root cause, thanks!&lt;/p&gt;</comment>
                            <comment id="17822991" author="ijuma" created="Sun, 3 Mar 2024 21:29:36 +0000"  >&lt;p&gt;Yes, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jolshan&quot; class=&quot;user-hover&quot; rel=&quot;jolshan&quot;&gt;jolshan&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hachikuji&quot; class=&quot;user-hover&quot; rel=&quot;hachikuji&quot;&gt;hachikuji&lt;/a&gt; looked into this and arrived to a similar conclusion. I think one of them was going to submit a fix soon.&lt;/p&gt;</comment>
                            <comment id="17823151" author="showuon" created="Mon, 4 Mar 2024 12:22:52 +0000"  >&lt;p&gt;Thanks! Please let us know when the PR is open.&lt;/p&gt;</comment>
                            <comment id="17823174" author="chia7712" created="Mon, 4 Mar 2024 13:01:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ijuma&quot; class=&quot;user-hover&quot; rel=&quot;ijuma&quot;&gt;ijuma&lt;/a&gt; thanks for feedback. good to know we are on the same page &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;I think one of them was going to submit a fix soon.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Please feel free to assign this JIRA to us if you guys have no free cycle. It seems the fix is straightforward as we can follow the behavior of Scala code.&lt;/p&gt;</comment>
                            <comment id="17823205" author="ijuma" created="Mon, 4 Mar 2024 14:13:14 +0000"  >&lt;p&gt;By the way, the bug attribution doesn&apos;t seem completely right (or not right at all). There were more recent changes to LogValidator after the conversion to Java that touched the related area.&lt;/p&gt;</comment>
                            <comment id="17823208" author="ijuma" created="Mon, 4 Mar 2024 14:25:34 +0000"  >&lt;p&gt;More recent changes to LogValidator: &lt;a href=&quot;https://github.com/apache/kafka/commit/e905ef1edfb92d8771e8c2a9a668f32210ad7e07&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/e905ef1edfb92d8771e8c2a9a668f32210ad7e07&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;My understanding is that the following change caused the change to the non compressed case. It looks like the compressed case had the issue already, but we didn&apos;t go further back to see if that has always been the case or not.&lt;/p&gt;</comment>
                            <comment id="17823238" author="chia7712" created="Mon, 4 Mar 2024 15:58:20 +0000"  >&lt;blockquote&gt;
&lt;p&gt;It looks like the compressed case had the issue already, but we didn&apos;t go further back to see if that has always been the case or not.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think the bug is already there before. I write the tests for both cases (compression and non-compression), and both cases fails at trunk. By contrast, only compression get failure at 3.4&lt;br/&gt;
see: &lt;a href=&quot;https://github.com/chia7712/kafka/blob/KAFKA-16310-3.4/core/src/test/scala/integration/kafka/api/OffsetOfMaxTimestampTest.scala#L52&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/chia7712/kafka/blob/KAFKA-16310-3.4/core/src/test/scala/integration/kafka/api/OffsetOfMaxTimestampTest.scala#L52&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17823266" author="ijuma" created="Mon, 4 Mar 2024 17:31:20 +0000"  >&lt;p&gt;Thanks for confirming that. &lt;a href=&quot;https://github.com/apache/kafka/commit/e905ef1edfb92d8771e8c2a9a668f32210ad7e07&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/e905ef1edfb92d8771e8c2a9a668f32210ad7e07&lt;/a&gt; is indeed the only relevant regression then. We should take the chance to fix the regression and the previously existing issue.&lt;/p&gt;</comment>
                            <comment id="17823280" author="hachikuji" created="Mon, 4 Mar 2024 18:16:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chia7712&quot; class=&quot;user-hover&quot; rel=&quot;chia7712&quot;&gt;chia7712&lt;/a&gt; Thanks for the analysis. Ironically, my original approach was to fix the compressed path to match the uncompressed path so that we passed along the actual offset of max timestamp. I ended up doing the opposite though. If either you or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=showuon&quot; class=&quot;user-hover&quot; rel=&quot;showuon&quot;&gt;showuon&lt;/a&gt; have time to submit a fix, I am happy to review.&#160;&lt;/p&gt;</comment>
                            <comment id="17823286" author="chia7712" created="Mon, 4 Mar 2024 18:33:30 +0000"  >&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/apache/kafka/commit/e905ef1edfb92d8771e8c2a9a668f32210ad7e07&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/e905ef1edfb92d8771e8c2a9a668f32210ad7e07&lt;/a&gt; is indeed the only relevant regression then. We should take the chance to fix the regression and the previously existing issue.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ijuma&quot; class=&quot;user-hover&quot; rel=&quot;ijuma&quot;&gt;ijuma&lt;/a&gt; oh, I pointed to incorrect ticket. Thanks for correcting, and sorry :-&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Thanks for the analysis. Ironically, my original approach was to fix the compressed path to match the uncompressed path so that we passed along the actual offset of max timestamp. I ended up doing the opposite though. If either you or Luke Chen have time to submit a fix, I am happy to review. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hachikuji&quot; class=&quot;user-hover&quot; rel=&quot;hachikuji&quot;&gt;hachikuji&lt;/a&gt; I have offline  discussion with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=showuon&quot; class=&quot;user-hover&quot; rel=&quot;showuon&quot;&gt;showuon&lt;/a&gt;, so we have time to submit/backport the fix.&lt;/p&gt;</comment>
                            <comment id="17823460" author="showuon" created="Tue, 5 Mar 2024 07:16:25 +0000"  >&lt;p&gt;Created 2 sub-tasks for compressed and un-compressed records.&lt;/p&gt;</comment>
                            <comment id="17830026" author="chia7712" created="Sat, 23 Mar 2024 03:20:57 +0000"  >&lt;p&gt;will resolve this jira after &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=johnnyhsu&quot; class=&quot;user-hover&quot; rel=&quot;johnnyhsu&quot;&gt;johnnyhsu&lt;/a&gt; update KIP-734 (&lt;a href=&quot;https://cwiki.apache.org/confluence/display/KAFKA/KIP-734:+Improve+AdminClient.listOffsets+to+return+timestamp+and+offset+for+the+record+with+the+largest+timestamp&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/KAFKA/KIP-734:+Improve+AdminClient.listOffsets+to+return+timestamp+and+offset+for+the+record+with+the+largest+timestamp&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="17831460" author="JIRAUSER304478" created="Wed, 27 Mar 2024 16:44:44 +0000"  >&lt;p&gt;The update is in below section:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;When the TimestampType is LOG_APPEND_TIME&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;When the TimestampType is LOG_APPEND_TIME, the timestamp of the records are the same. In this case, we should choose the offset of the first record. &lt;a href=&quot;https://github.com/apache/kafka/blob/6f38fe5e0a6e2fe85fec7cb9adc379061d35ce45/storage/src/main/java/org/apache/kafka/storage/internals/log/LogValidator.java#L294&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;This path&lt;/a&gt; in LogValidator was added to handle this case for non-compressed type, while &lt;a href=&quot;https://github.com/apache/kafka/blob/6f38fe5e0a6e2fe85fec7cb9adc379061d35ce45/storage/src/main/java/org/apache/kafka/storage/internals/log/LogValidator.java#L421&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this path&lt;/a&gt;&#160;in LogValidator was added to handle this case for compressed type.&#160;&#160;&lt;/p&gt;

&lt;p&gt;I don&apos;t have the Confluence account yet, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chia7712&quot; class=&quot;user-hover&quot; rel=&quot;chia7712&quot;&gt;chia7712&lt;/a&gt; would you please help update the KIP in the wiki? I will send this update to the dev thread for visibility. Thanks!&#160;&lt;/p&gt;</comment>
                            <comment id="17831463" author="chia7712" created="Wed, 27 Mar 2024 16:57:16 +0000"  >&lt;p&gt;@johnnyhsu thanks for offers the description. I add following statement to KIP-734 according to your comments.&lt;/p&gt;

&lt;blockquote&gt;

&lt;p&gt;This returns the offset and timestamp corresponding to the record with the highest timestamp on the partition. Noted that we should choose the offset of the earliest record if the timestamp of the records are the same.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;WDYT?&lt;/p&gt;</comment>
                            <comment id="17831464" author="JIRAUSER304478" created="Wed, 27 Mar 2024 17:01:33 +0000"  >&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chia7712&quot; class=&quot;user-hover&quot; rel=&quot;chia7712&quot;&gt;chia7712&lt;/a&gt; thanks for the help!&lt;/p&gt;

&lt;p&gt;This returns the offset and timestamp corresponding to the record with the highest timestamp on the partition. Noted that we should choose the offset of the earliest record if the timestamp of the records are the same.&lt;/p&gt;

&lt;p&gt;This sounds good to me, thanks!&#160;&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17831553" author="junrao" created="Wed, 27 Mar 2024 21:31:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=johnnyhsu&quot; class=&quot;user-hover&quot; rel=&quot;johnnyhsu&quot;&gt;johnnyhsu&lt;/a&gt; , &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=showuon&quot; class=&quot;user-hover&quot; rel=&quot;showuon&quot;&gt;showuon&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chia7712&quot; class=&quot;user-hover&quot; rel=&quot;chia7712&quot;&gt;chia7712&lt;/a&gt; : Sorry, but I just realized one issue with the fix. The problem is that we only fixed offsetForMaxTimestamp during leader append. The follower append still uses the lastOffset in the batch.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
UnifiedLog.analyzeAndValidateRecords()

lastOffset = batch.lastOffset

...

&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (batch.maxTimestamp &amp;gt; maxTimestamp) {
  maxTimestamp = batch.maxTimestamp
  offsetOfMaxTimestamp = lastOffset
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We optimize the follower code to avoid decompressing a batch. So, it&apos;s kind of hard to get the exact record offset for maxTimestamp in the batch.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I think the easiest way to fix the listMaxTimestamp issue is probably to still maintain offsetOfMaxTimestamp at the record batch level so that it can be derived consistently at both the leader and the follower. When serving the listMaxTimestamp request, we iterate the batch containing the maxTimestamp to find the exact record offset with maxTimestamp. Since this is a rare operation, paying the decompression overhead is fine. What do you think?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If we want to do the above, we probably need to revert the changes in 3.6.2, which is being voted now. cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=omkreddy&quot; class=&quot;user-hover&quot; rel=&quot;omkreddy&quot;&gt;omkreddy&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17831624" author="omkreddy" created="Thu, 28 Mar 2024 05:14:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chia7712&quot; class=&quot;user-hover&quot; rel=&quot;chia7712&quot;&gt;chia7712&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=showuon&quot; class=&quot;user-hover&quot; rel=&quot;showuon&quot;&gt;showuon&lt;/a&gt; Can we revert the relavent changes from 3.6 branch as this not regression in 3.6.x releases and looks like complete fix requires few more changes. This is to unblock 3.6.2 release.&#160;&lt;/p&gt;</comment>
                            <comment id="17831629" author="chia7712" created="Thu, 28 Mar 2024 05:32:38 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Can we revert the relavent changes from 3.6 branch as this not regression in 3.6.x releases and looks like complete fix requires few more changes. This is to unblock 3.6.2 release.&#160;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;sure, please feel free to revert &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-16341&quot; title=&quot;Fix un-compressed records&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-16341&quot;&gt;&lt;del&gt;KAFKA-16341&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-16342&quot; title=&quot;Fix compressed records&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-16342&quot;&gt;&lt;del&gt;KAFKA-16342&lt;/del&gt;&lt;/a&gt;. Sorry for that incomplete fix and it blocks the 3.6.2 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I will update KIP-734 to remind users that  behavior of  maxTimestamp offset could be changed in the future release.&lt;/p&gt;
</comment>
                            <comment id="17831631" author="omkreddy" created="Thu, 28 Mar 2024 05:41:38 +0000"  >&lt;p&gt;Thanks, I have reverted &#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-16341&quot; title=&quot;Fix un-compressed records&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-16341&quot;&gt;&lt;del&gt;KAFKA-16341&lt;/del&gt;&lt;/a&gt;&#160;and&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-16342&quot; title=&quot;Fix compressed records&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-16342&quot;&gt;&lt;del&gt;KAFKA-16342&lt;/del&gt;&lt;/a&gt;. commits from 3.6 branch&lt;/p&gt;</comment>
                            <comment id="17831658" author="chia7712" created="Thu, 28 Mar 2024 07:47:42 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I think the easiest way to fix the listMaxTimestamp issue is probably to still maintain offsetOfMaxTimestamp at the record batch level so that it can be derived consistently at both the leader and the follower. When serving the listMaxTimestamp request, we iterate the batch containing the maxTimestamp to find the exact record offset with maxTimestamp. Since this is a rare operation, paying the decompression overhead is fine. What do you think?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m still digging in &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;BTW, it seems the recovering the segments has similar issue. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
                &lt;span class=&quot;code-comment&quot;&gt;// The max timestamp is exposed at the batch level, so no need to iterate the records
&lt;/span&gt;                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (batch.maxTimestamp() &amp;gt; maxTimestampSoFar()) {
                    maxTimestampAndOffsetSoFar = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TimestampOffset(batch.maxTimestamp(), batch.lastOffset());
                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17831683" author="chia7712" created="Thu, 28 Mar 2024 09:13:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think the easiest way to fix the listMaxTimestamp issue is probably to still maintain offsetOfMaxTimestamp at the record batch level so that it can be derived consistently at both the leader and the follower.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Did you mean that we should change the schema to have a new field to keep `offsetOfMaxTimestamp`? or just add a new method to Batch to iterate all records to find out offsetOfMaxTimestamp?&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;When serving the listMaxTimestamp request, we iterate the batch containing the maxTimestamp to find the exact record offset with maxTimestamp. Since this is a rare operation, paying the decompression overhead is fine.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I gree to this solution. Furthermore, there are other works we can do for this solution.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;catch maxTimestamp instead of maxTimestampAndOffsetSoFar (&lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/storage/src/main/java/org/apache/kafka/storage/internals/log/LogSegment.java#L93&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/storage/src/main/java/org/apache/kafka/storage/internals/log/LogSegment.java#L93&lt;/a&gt;) since we do iterate all records to find out the offsetOfMaxTimestamp&lt;/li&gt;
	&lt;li&gt;update time index by (max timestamp, last offset) even though the mapping is not accurate. It should be fine since:
	&lt;ul&gt;
		&lt;li&gt;it does not violate spec of time index (&lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/storage/src/main/java/org/apache/kafka/storage/internals/log/TimeIndex.java#L36&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/storage/src/main/java/org/apache/kafka/storage/internals/log/TimeIndex.java#L36&lt;/a&gt;) `Any message whose timestamp is greater than TIMESTAMP must come after OFFSET`&lt;/li&gt;
		&lt;li&gt;the index returned from time index is used to look up the position of batch, so it makes sense we append lastOffset to both time index and offset index&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;In short, we do NOT trace offsetOfMaxTimestamp for all paths. The side effect is that request to offsetOfMaxTimestamp can get slower ...&lt;/p&gt;</comment>
                            <comment id="17831741" author="showuon" created="Thu, 28 Mar 2024 11:44:14 +0000"  >&lt;blockquote&gt;&lt;p&gt;Did you mean that we should change the schema to have a new field to keep `offsetOfMaxTimestamp`? or just add a new method to Batch to iterate all records to find out offsetOfMaxTimestamp?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think it&apos;s the former, otherwise, we&apos;re still iterating all records, and the overhead for follower is unnecessary.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;When serving the listMaxTimestamp request, we iterate the batch containing the maxTimestamp to find the exact record offset with maxTimestamp. Since this is a rare operation, paying the decompression overhead is fine.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, I agree with this method. But the question is, should we revert the fix in this JIRA? I think no because the fix doesn&apos;t change anything (no additional overhead at all) if we will iterate the batch when returning listOffset for MaxTimestamp in the end.WDYT?&lt;/p&gt;</comment>
                            <comment id="17831747" author="chia7712" created="Thu, 28 Mar 2024 12:01:37 +0000"  >&lt;p&gt;&amp;gt; Yes, I agree with this method. But the question is, should we revert the fix in this JIRA? I think no because the fix doesn&apos;t change anything (no additional overhead at all) if we will iterate the batch when returning listOffset for MaxTimestamp in the end.WDYT?&lt;/p&gt;

&lt;p&gt;We can do a little optimization if current fixes are kept. We do iterate batches to find the q only if we don&#8217;t cache it. i.e the path of leader can return the cached offsetOfMaxTimestanp. The other paths do not cache the offsetOfMaxTimestanpq&lt;/p&gt;</comment>
                            <comment id="17831834" author="junrao" created="Thu, 28 Mar 2024 14:25:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chia7712&quot; class=&quot;user-hover&quot; rel=&quot;chia7712&quot;&gt;chia7712&lt;/a&gt; :&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Did you mean that we should change the schema to have a new field to keep `offsetOfMaxTimestamp`? or just add a new method to Batch to iterate all records to find out offsetOfMaxTimestamp?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Adding a new field in the batch requires record format change, which is a much bigger effort. For now, the easiest thing is to add a method in Batch to find out offsetOfMaxTimestanp by iterating all records.&lt;/p&gt;

&lt;p&gt;Regarding the optimization on the leader side by caching offsetOfMaxTimestanp, we could do it. However, my understanding is that listMaxTimestamp is rare and I am not sure if it&apos;s worth the additional complexity.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=showuon&quot; class=&quot;user-hover&quot; rel=&quot;showuon&quot;&gt;showuon&lt;/a&gt; : Regarding the fix, we could fix forward if we could provide the fix soon. Otherwise, we probably want to revert the fixes to avoid new code depending on the new semantic since we changed shallowOffsetOfMaxTimestanp to offsetOfMaxTimestanp.&lt;/p&gt;</comment>
                            <comment id="17831837" author="ijuma" created="Thu, 28 Mar 2024 14:28:20 +0000"  >&lt;p&gt;Team, there are serious issues that are fixed by 3.6.2. We should not delay it due to a long standing issue. As I said elsewhere, if it&apos;s not a regression or a security issue, it should be avoided. Precisely to avoid the issue that happened here. Let&apos;s revert and move on please.&lt;/p&gt;</comment>
                            <comment id="17831845" author="chia7712" created="Thu, 28 Mar 2024 14:38:19 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Team, there are serious issues that are fixed by 3.6.2. We should not delay it due to a long standing issue. As I said elsewhere, if it&apos;s not a regression or a security issue, it should be avoided. Precisely to avoid the issue that happened here. Let&apos;s revert and move on please.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ijuma&quot; class=&quot;user-hover&quot; rel=&quot;ijuma&quot;&gt;ijuma&lt;/a&gt; Are you worry about the 3.6.2? If so, the fixes are reverted already. see &lt;a href=&quot;https://github.com/apache/kafka/commit/da1ee97f11c1c828a93db37023122b647a5a271e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/da1ee97f11c1c828a93db37023122b647a5a271e&lt;/a&gt; and &lt;a href=&quot;https://github.com/apache/kafka/commit/64f7a0a300c70b00c0cc357d0a936ea8b42b69fb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/64f7a0a300c70b00c0cc357d0a936ea8b42b69fb&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17831848" author="ijuma" created="Thu, 28 Mar 2024 14:45:12 +0000"  >&lt;p&gt;Perfect, thanks!&lt;/p&gt;</comment>
                            <comment id="17831959" author="junrao" created="Thu, 28 Mar 2024 20:22:15 +0000"  >&lt;p&gt;Since the follower only maintains offsetForMaxTimestamp at the batch level, the listMaxTimestamp API was never implemented correctly. So, technically, there was no regression for listMaxTimestamp. We could just fix this issue in trunk without backporting to the old branch.&lt;/p&gt;</comment>
                            <comment id="17831965" author="chia7712" created="Thu, 28 Mar 2024 20:33:21 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Since the follower only maintains offsetForMaxTimestamp at the batch level, the listMaxTimestamp API was never implemented correctly. So, technically, there was no regression for listMaxTimestamp. We could just fix this issue in trunk without backporting to the old branch.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I will revert &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-16341&quot; title=&quot;Fix un-compressed records&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-16341&quot;&gt;&lt;del&gt;KAFKA-16341&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-16342&quot; title=&quot;Fix compressed records&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-16342&quot;&gt;&lt;del&gt;KAFKA-16342&lt;/del&gt;&lt;/a&gt; from 3.7&lt;/p&gt;</comment>
                            <comment id="17831966" author="chia7712" created="Thu, 28 Mar 2024 20:44:04 +0000"  >&lt;p&gt;see the following link to check the revert from 3.7&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/commit/bd5989dd195d42c1608582316367a03b2c78cb11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/bd5989dd195d42c1608582316367a03b2c78cb11&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/commit/fc646f920701b792eb683bacd513a1f20909f6bc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/fc646f920701b792eb683bacd513a1f20909f6bc&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17832226" author="JIRAUSER304478" created="Fri, 29 Mar 2024 14:58:39 +0000"  >&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=junrao&quot; class=&quot;user-hover&quot; rel=&quot;junrao&quot;&gt;junrao&lt;/a&gt; for pointing this out and sharing the solution, and thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chia7712&quot; class=&quot;user-hover&quot; rel=&quot;chia7712&quot;&gt;chia7712&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=showuon&quot; class=&quot;user-hover&quot; rel=&quot;showuon&quot;&gt;showuon&lt;/a&gt; for those discussions and revert it for 3.6.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Since this is a rare operation, paying the decompression overhead is fine.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Adding a new field in the batch requires record format change, which is a much bigger effort. For now, the easiest thing is to add a method in Batch to find out offsetOfMaxTimestanp by iterating all records.&lt;/p&gt;

&lt;p&gt;Regarding the optimization on the leader side by caching offsetOfMaxTimestanp, we could do it. However, my understanding is that listMaxTimestamp is rare and I am not sure if it&apos;s worth the additional complexity.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;have go through the comments and had a offline discussion with Chia-Ping, I got more context and also feel that we can transfer the workload to listMaxTimestamp when clients fetch this since it&apos;s rare. What do you think?&#160;&#160;&lt;/p&gt;</comment>
                            <comment id="17832228" author="chia7712" created="Fri, 29 Mar 2024 15:10:59 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I got more context and also feel that we can transfer the workload to listMaxTimestamp when clients fetch this since it&apos;s rare. What do you think?  &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;yep, we are on the same page. I have filed a PR according to the solution. Please take a look at &lt;a href=&quot;https://github.com/apache/kafka/pull/15621&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/15621&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17834129" author="JIRAUSER303642" created="Fri, 5 Apr 2024 02:52:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chia7712&quot; class=&quot;user-hover&quot; rel=&quot;chia7712&quot;&gt;chia7712&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=omkreddy&quot; class=&quot;user-hover&quot; rel=&quot;omkreddy&quot;&gt;omkreddy&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;&amp;gt;&#160; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ijuma&quot; class=&quot;user-hover&quot; rel=&quot;ijuma&quot;&gt;ijuma&lt;/a&gt;&#160;Are you worry about the 3.6.2? If so, the fixes are reverted already. see&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://home.apache.org/~manikumar/kafka-3.6.2-rc2/RELEASE_NOTES.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://home.apache.org/~manikumar/kafka-3.6.2-rc2/RELEASE_NOTES.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This is my first time commenting on kafka&apos;s jira. I apologize if this is an unnecessary question.&lt;/p&gt;

&lt;p&gt;The fix for this bug is not mentioned in the release notes of 3.6.2-rc2.&lt;/p&gt;

&lt;p&gt;Will this bug not be fixed in 3.6.2 ?&lt;/p&gt;</comment>
                            <comment id="17834131" author="chia7712" created="Fri, 5 Apr 2024 03:54:51 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Will this bug not be fixed in 3.6.2 ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;yep. As we discussed above, all paths do NOT use same way to find the offset of max timestamp, so it is not a regression of both 3.6 and 3.7. Instead, it is a issue which is existent for a while &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                            <comment id="17835583" author="chia7712" created="Wed, 10 Apr 2024 03:39:41 +0000"  >&lt;p&gt;I will update KIP-734 later since the web site has no response ....&lt;/p&gt;</comment>
                            <comment id="17835595" author="chia7712" created="Wed, 10 Apr 2024 05:32:36 +0000"  >&lt;p&gt;have updated KIP-734&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="13570782">KAFKA-16341</subtask>
                            <subtask id="13570783">KAFKA-16342</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 30 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1no6o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>