<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:15:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-7513] Flaky test SaslAuthenticatorFailureDelayTest.testInvalidPasswordSaslPlain</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-7513</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Have seen this test fail quite a few times in PR builds (e.g. &lt;a href=&quot;https://builds.apache.org/job/kafka-pr-jdk11-scala2.12/123):&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/kafka-pr-jdk11-scala2.12/123):&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.AssertionError: expected:&amp;lt;AUTHENTICATION_FAILED&amp;gt; but was:&amp;lt;EXPIRED&amp;gt;
	at org.junit.Assert.fail(Assert.java:88)
	at org.junit.Assert.failNotEquals(Assert.java:834)
	at org.junit.Assert.assertEquals(Assert.java:118)
	at org.junit.Assert.assertEquals(Assert.java:144)
	at org.apache.kafka.common.network.NetworkTestUtils.waitForChannelClose(NetworkTestUtils.java:114)
	at org.apache.kafka.common.security.authenticator.SaslAuthenticatorFailureDelayTest.createAndCheckClientConnectionFailure(SaslAuthenticatorFailureDelayTest.java:223)
	at org.apache.kafka.common.security.authenticator.SaslAuthenticatorFailureDelayTest.createAndCheckClientAuthenticationFailure(SaslAuthenticatorFailureDelayTest.java:212)
	at org.apache.kafka.common.security.authenticator.SaslAuthenticatorFailureDelayTest.testInvalidPasswordSaslPlain(SaslAuthenticatorFailureDelayTest.java:115)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13191871">KAFKA-7513</key>
            <summary>Flaky test SaslAuthenticatorFailureDelayTest.testInvalidPasswordSaslPlain</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rsivaram">Rajini Sivaram</assignee>
                                    <reporter username="rsivaram">Rajini Sivaram</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Oct 2018 10:43:56 +0000</created>
                <updated>Tue, 16 Oct 2018 16:19:20 +0000</updated>
                            <resolved>Tue, 16 Oct 2018 16:19:20 +0000</resolved>
                                    <version>2.1.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>security</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16651489" author="githubbot" created="Tue, 16 Oct 2018 10:59:07 +0000"  >&lt;p&gt;rajinisivaram opened a new pull request #5805: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7513&quot; title=&quot;Flaky test SaslAuthenticatorFailureDelayTest.testInvalidPasswordSaslPlain&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7513&quot;&gt;&lt;del&gt;KAFKA-7513&lt;/del&gt;&lt;/a&gt;: Fix timing issue in SaslAuthenticatorFailureDelayTest&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5805&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Reduce tick interval of the mock timer and avoid large timer increments to avoid hitting idle expiry on the client-side before delayed close is processed by the server. Also reduce poll interval in the server to make the test complete faster (since delayed close is only processed when poll returns).&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16652026" author="githubbot" created="Tue, 16 Oct 2018 16:15:25 +0000"  >&lt;p&gt;rajinisivaram closed pull request #5805: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7513&quot; title=&quot;Flaky test SaslAuthenticatorFailureDelayTest.testInvalidPasswordSaslPlain&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7513&quot;&gt;&lt;del&gt;KAFKA-7513&lt;/del&gt;&lt;/a&gt;: Fix timing issue in SaslAuthenticatorFailureDelayTest&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5805&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/clients/src/test/java/org/apache/kafka/common/network/NetworkTestUtils.java b/clients/src/test/java/org/apache/kafka/common/network/NetworkTestUtils.java&lt;br/&gt;
index b08c8c19a87..e6c0eda6f41 100644&lt;br/&gt;
&amp;#8212; a/clients/src/test/java/org/apache/kafka/common/network/NetworkTestUtils.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/common/network/NetworkTestUtils.java&lt;br/&gt;
@@ -28,7 +28,6 @@&lt;br/&gt;
 import org.apache.kafka.common.security.auth.SecurityProtocol;&lt;br/&gt;
 import org.apache.kafka.common.utils.LogContext;&lt;br/&gt;
 import org.apache.kafka.common.security.authenticator.CredentialCache;&lt;br/&gt;
-import org.apache.kafka.common.utils.MockTime;&lt;br/&gt;
 import org.apache.kafka.common.utils.Time;&lt;br/&gt;
 import org.apache.kafka.common.utils.Utils;&lt;br/&gt;
 import org.apache.kafka.test.TestUtils;&lt;br/&gt;
@@ -87,7 +86,7 @@ public static void waitForChannelReady(Selector selector, String node) throws IO&lt;br/&gt;
         assertTrue(selector.isChannelReady(node));&lt;br/&gt;
     }&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static ChannelState waitForChannelClose(Selector selector, String node, ChannelState.State channelState, MockTime mockTime)&lt;br/&gt;
+    public static ChannelState waitForChannelClose(Selector selector, String node, ChannelState.State channelState)&lt;br/&gt;
             throws IOException {&lt;br/&gt;
         boolean closed = false;&lt;br/&gt;
         for (int i = 0; i &amp;lt; 300; i++) 
{
@@ -96,8 +95,6 @@ public static ChannelState waitForChannelClose(Selector selector, String node, C
                 closed = true;
                 break;
             }&lt;/li&gt;
	&lt;li&gt;if (mockTime != null)&lt;/li&gt;
	&lt;li&gt;mockTime.setCurrentTimeMs(mockTime.milliseconds() + 150);&lt;br/&gt;
         }&lt;br/&gt;
         assertTrue(&quot;Channel was not closed by timeout&quot;, closed);&lt;br/&gt;
         ChannelState finalState = selector.disconnected().get(node);&lt;br/&gt;
@@ -105,10 +102,6 @@ public static ChannelState waitForChannelClose(Selector selector, String node, C&lt;br/&gt;
         return finalState;&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static ChannelState waitForChannelClose(Selector selector, String node, ChannelState.State channelState) throws IOException 
{
-        return waitForChannelClose(selector, node, channelState, null);
-    }
&lt;p&gt;-&lt;br/&gt;
     public static void completeDelayedChannelClose(Selector selector, long currentTimeNanos) &lt;/p&gt;
{
         selector.completeDelayedChannelClose(currentTimeNanos);
     }
&lt;p&gt;diff --git a/clients/src/test/java/org/apache/kafka/common/network/NioEchoServer.java b/clients/src/test/java/org/apache/kafka/common/network/NioEchoServer.java&lt;br/&gt;
index 76d37c26c67..68b3f9dc112 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/test/java/org/apache/kafka/common/network/NioEchoServer.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/common/network/NioEchoServer.java&lt;br/&gt;
@@ -153,7 +153,7 @@ public void run() {&lt;br/&gt;
         try {&lt;br/&gt;
             acceptorThread.start();&lt;br/&gt;
             while (serverSocketChannel.isOpen()) {&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;selector.poll(1000);&lt;br/&gt;
+                selector.poll(100);&lt;br/&gt;
                 synchronized (newChannels) {&lt;br/&gt;
                     for (SocketChannel socketChannel : newChannels) {&lt;br/&gt;
                         String id = id(socketChannel);&lt;br/&gt;
diff --git a/clients/src/test/java/org/apache/kafka/common/security/authenticator/SaslAuthenticatorFailureDelayTest.java b/clients/src/test/java/org/apache/kafka/common/security/authenticator/SaslAuthenticatorFailureDelayTest.java&lt;br/&gt;
index b0dfc7a123b..c8e6edb4a44 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/test/java/org/apache/kafka/common/security/authenticator/SaslAuthenticatorFailureDelayTest.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/common/security/authenticator/SaslAuthenticatorFailureDelayTest.java&lt;br/&gt;
@@ -53,8 +53,8 @@&lt;br/&gt;
 @RunWith(value = Parameterized.class)&lt;br/&gt;
 public class SaslAuthenticatorFailureDelayTest {&lt;br/&gt;
     private static final int BUFFER_SIZE = 4 * 1024;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;private static MockTime time = new MockTime(50);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+    private final MockTime time = new MockTime(10);&lt;br/&gt;
     private NioEchoServer server;&lt;br/&gt;
     private Selector selector;&lt;br/&gt;
     private ChannelBuilder channelBuilder;&lt;br/&gt;
@@ -221,7 +221,7 @@ private ChannelState createAndCheckClientConnectionFailure(SecurityProtocol secu&lt;br/&gt;
             throws Exception {&lt;br/&gt;
         createClientConnection(securityProtocol, node);&lt;br/&gt;
         ChannelState finalState = NetworkTestUtils.waitForChannelClose(selector, node,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ChannelState.State.AUTHENTICATION_FAILED, time);&lt;br/&gt;
+                ChannelState.State.AUTHENTICATION_FAILED);&lt;br/&gt;
         selector.close();&lt;br/&gt;
         selector = null;&lt;br/&gt;
         return finalState;&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 5 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3z8vj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ijuma</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>