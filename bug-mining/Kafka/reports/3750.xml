<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:38:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-16389] consumer_test.py&#8217;s test_valid_assignment fails with new consumer</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-16389</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;The following error is reported when running the &lt;tt&gt;test_valid_assignment&lt;/tt&gt; test from &lt;tt&gt;consumer_test.py&lt;/tt&gt;:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/lib/python3.9/dist-packages/ducktape/tests/runner_client.py&quot;&lt;/span&gt;, line 186, in _do_run
    data = self.run_test()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/lib/python3.9/dist-packages/ducktape/tests/runner_client.py&quot;&lt;/span&gt;, line 246, in run_test
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.test_context.function(self.test)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/lib/python3.9/dist-packages/ducktape/mark/_mark.py&quot;&lt;/span&gt;, line 433, in wrapper
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; functools.partial(f, *args, **kwargs)(*w_args, **w_kwargs)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/opt/kafka-dev/tests/kafkatest/tests/client/consumer_test.py&quot;&lt;/span&gt;, line 584, in test_valid_assignment
    wait_until(lambda: self.valid_assignment(self.TOPIC, self.NUM_PARTITIONS, consumer.current_assignment()),
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/lib/python3.9/dist-packages/ducktape/utils/util.py&quot;&lt;/span&gt;, line 58, in wait_until
    raise TimeoutError(err_msg() &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; callable(err_msg) &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; err_msg) from last_exception
ducktape.errors.TimeoutError: expected valid assignments of 6 partitions when num_started 2: [(&lt;span class=&quot;code-quote&quot;&gt;&apos;ducker@ducker05&apos;&lt;/span&gt;, []), (&lt;span class=&quot;code-quote&quot;&gt;&apos;ducker@ducker06&apos;&lt;/span&gt;, [])]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To reproduce, create a system test suite file named &lt;tt&gt;test_valid_assignment.yml&lt;/tt&gt; with these contents:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-yaml&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;failures: &lt;/span&gt;
  - &lt;span class=&quot;code-quote&quot;&gt;&apos;kafkatest/tests/client/consumer_test.py::AssignmentValidationTest.test_valid_assignment@{&lt;span class=&quot;code-quote&quot;&gt;&quot;metadata_quorum&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;ISOLATED_KRAFT&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;use_new_coordinator&quot;&lt;/span&gt;:true,&lt;span class=&quot;code-quote&quot;&gt;&quot;group_protocol&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;consumer&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;group_remote_assignor&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;range&quot;&lt;/span&gt;}&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then set the the &lt;tt&gt;TC_PATHS&lt;/tt&gt; environment variable to include that test suite file.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13572474">KAFKA-16389</key>
            <summary>consumer_test.py&#8217;s test_valid_assignment fails with new consumer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pnee">Philip Nee</assignee>
                                    <reporter username="kirktrue">Kirk True</reporter>
                        <labels>
                            <label>kip-848-client-support</label>
                            <label>system-tests</label>
                    </labels>
                <created>Tue, 19 Mar 2024 23:05:22 +0000</created>
                <updated>Thu, 18 Apr 2024 17:43:36 +0000</updated>
                            <resolved>Thu, 18 Apr 2024 17:43:36 +0000</resolved>
                                    <version>3.7.0</version>
                                    <fixVersion>3.8.0</fixVersion>
                                    <component>clients</component>
                    <component>consumer</component>
                    <component>system tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17828538" author="kirktrue" created="Tue, 19 Mar 2024 23:20:55 +0000"  >&lt;p&gt;I&apos;ve attached &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13067541/13067541_KAFKA-16389.patch&quot; title=&quot;KAFKA-16389.patch attached to KAFKA-16389&quot;&gt;KAFKA-16389.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; which &lt;em&gt;appears&lt;/em&gt; to address the issue in the system test so that it passes.&lt;/p&gt;

&lt;p&gt;The patch includes two changes:&lt;/p&gt;

&lt;p&gt;1. &lt;tt&gt;verifiable_consumer.py&lt;/tt&gt; now updates the test&#8217;s list of assignments instead of overwriting them&lt;br/&gt;
2. &lt;tt&gt;consumer_test.py&lt;/tt&gt; now waits for the assignments to be made instead of expecting them to be immediately correct&lt;/p&gt;

&lt;p&gt;I am &lt;em&gt;not&lt;/em&gt; necessarily suggesting that we change the test to make the new consumer work. This is patch is provided to show how the new consumer behaves differently than the old.&lt;/p&gt;</comment>
                            <comment id="17829712" author="chia7712" created="Fri, 22 Mar 2024 00:59:18 +0000"  >&lt;p&gt;Just curious, why not fixing the failed e2e?&lt;/p&gt;</comment>
                            <comment id="17831016" author="JIRAUSER283568" created="Tue, 26 Mar 2024 17:26:29 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chia7712&quot; class=&quot;user-hover&quot; rel=&quot;chia7712&quot;&gt;chia7712&lt;/a&gt; - We are currently setting up the system tests using the AsyncKafkaConsumer so that we can get system test reports to address the shortcoming of the async consumer.&#160; Our goal is to bring the async consumer as close to the current one as possible.&#160; Understand the concern about the broken tests, but this consumer is also not being released yet...&lt;/p&gt;</comment>
                            <comment id="17831122" author="chia7712" created="Wed, 27 Mar 2024 01:41:33 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Our goal is to bring the async consumer as close to the current one as possible.  Understand the concern about the broken tests, but this consumer is also not being released yet...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks for sharing!&lt;/p&gt;</comment>
                            <comment id="17833298" author="kirktrue" created="Tue, 2 Apr 2024 19:27:27 +0000"  >&lt;p&gt;Can you mark this as &quot;In progress&quot;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnee&quot; class=&quot;user-hover&quot; rel=&quot;pnee&quot;&gt;pnee&lt;/a&gt;? Thanks!&lt;/p&gt;</comment>
                            <comment id="17833704" author="JIRAUSER283568" created="Wed, 3 Apr 2024 18:24:25 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kirktrue&quot; class=&quot;user-hover&quot; rel=&quot;kirktrue&quot;&gt;kirktrue&lt;/a&gt; Thanks for the initial investigation.&#160; I think your approach makes sense but I do think we need to rewrite the verifiable_consumer.py&apos;s event handler.&#160; As the states transition doesn&apos;t necessary match the behavior of the current consumer.&#160; And I think that&apos;s why there&apos;s still some flakiness in the patch you submitted.&#160; See my notes below:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I&apos;m still occasionally getting errors like: &quot;ducktape.errors.TimeoutError: expected valid assignments of 6 partitions when num_started 1: [(&apos;ducker@ducker11&apos;, [])]&quot;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This seems to be caused by some weird reconciliation state.&#160; For example: Here We can see consumer1 got assigned 6 partitions and then immediately gave up all of them.&#160; It is unclear why onPartitionsRevoke is triggered.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 &#160;1 node &#160;&amp;lt;ducktape.cluster.cluster.ClusterNode object at 0xffff9fe617c0&amp;gt;
wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; member
idx &#160;1 partiton assigned [{&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;test_topic&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;partition&apos;&lt;/span&gt;: 0}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;test_topic&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;partition&apos;&lt;/span&gt;: 1}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;test_topic&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;partition&apos;&lt;/span&gt;: 2}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;test_topic&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;partition&apos;&lt;/span&gt;: 3}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;test_topic&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;partition&apos;&lt;/span&gt;: 4}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;test_topic&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;partition&apos;&lt;/span&gt;: 5}]
idx &#160;1 partiton revoked [{&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;test_topic&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;partition&apos;&lt;/span&gt;: 0}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;test_topic&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;partition&apos;&lt;/span&gt;: 1}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;test_topic&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;partition&apos;&lt;/span&gt;: 2}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;test_topic&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;partition&apos;&lt;/span&gt;: 3}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;test_topic&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;partition&apos;&lt;/span&gt;: 4}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;test_topic&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;partition&apos;&lt;/span&gt;: 5}]
node: ducker11
Current assignment: {&amp;lt;ducktape.cluster.cluster.ClusterNode object at 0xffff9fe617c0&amp;gt;: []}
idx &#160;1 partiton assigned []
[WARNING - 2024-04-03 11:05:34,587 - service_registry - stop_all - lineno:53]: Error stopping service &amp;lt;VerifiableConsumer-0-281473364398912: num_nodes: 3, nodes: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ducker11&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ducker12&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ducker13&apos;&lt;/span&gt;]&amp;gt;: &amp;lt;ducktape.cluster.cluster.ClusterNode object at 0xffff9fe61640&amp;gt;
[WARNING - 2024-04-03 11:06:09,128 - service_registry - clean_all - lineno:67]: Error cleaning service &amp;lt;VerifiableConsumer-0-281473364398912: num_nodes: 3, nodes: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ducker11&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ducker12&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ducker13&apos;&lt;/span&gt;]&amp;gt;: &amp;lt;ducktape.cluster.cluster.ClusterNode object at 0xffff9fe61640&amp;gt;
[INFO:2024-04-03 11:06:09,134]: RunnerClient: kafkatest.tests.client.consumer_test.AssignmentValidationTest.test_valid_assignment.metadata_quorum=ISOLATED_KRAFT.use_new_coordinator=True.group_protocol=consumer.group_remote_assignor=range: FAIL: TimeoutError(&lt;span class=&quot;code-quote&quot;&gt;&quot;expected valid assignments of 6 partitions when num_started 1: [(&lt;span class=&quot;code-quote&quot;&gt;&apos;ducker@ducker11&apos;&lt;/span&gt;, [])]&quot;&lt;/span&gt;)
Traceback (most recent call last):
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/lib/python3.9/dist-packages/ducktape/tests/runner_client.py&quot;&lt;/span&gt;, line 186, in _do_run
&#160; &#160; data = self.run_test()
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/lib/python3.9/dist-packages/ducktape/tests/runner_client.py&quot;&lt;/span&gt;, line 246, in run_test
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.test_context.function(self.test)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/lib/python3.9/dist-packages/ducktape/mark/_mark.py&quot;&lt;/span&gt;, line 433, in wrapper
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; functools.partial(f, *args, **kwargs)(*w_args, **w_kwargs)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/opt/kafka-dev/tests/kafkatest/tests/client/consumer_test.py&quot;&lt;/span&gt;, line 583, in test_valid_assignment
&#160; &#160; wait_until(lambda: self.valid_assignment(self.TOPIC, self.NUM_PARTITIONS, consumer.current_assignment()),
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/lib/python3.9/dist-packages/ducktape/utils/util.py&quot;&lt;/span&gt;, line 58, in wait_until
&#160; &#160; raise TimeoutError(err_msg() &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; callable(err_msg) &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; err_msg) from last_exception
ducktape.errors.TimeoutError: expected valid assignments of 6 partitions when num_started 1: [(&lt;span class=&quot;code-quote&quot;&gt;&apos;ducker@ducker11&apos;&lt;/span&gt;, [])] &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17833744" author="JIRAUSER283568" created="Wed, 3 Apr 2024 21:01:41 +0000"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13067834/13067834_consumer.log&quot; title=&quot;consumer.log attached to KAFKA-16389&quot;&gt;consumer.log&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;It seems like the consumer receives empty topicPartitions after the assignment.&#160; One suspicious thing that I see is that there&apos;s no send in between the successive Receives.&#160; I wonder if this is a race condition:&lt;/p&gt;

&lt;p&gt;First: Assignments received&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
7997 [2024-04-03 19:48:49,445] DEBUG [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Received CONSUMER_GROUP_HEARTBEAT response from node 2147483646 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; request with header RequestHeader(apiKey=CONSUMER_GROUP_HEARTBEAT, apiVersion=0, clientId=consumer-test_group_id-1, correlationId=35, headerVersion=2): ConsumerGroupHeartbeatResponseData(t &#160; &#160; hrottleTimeMs=0, errorCode=0, errorMessage=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, memberId=&lt;span class=&quot;code-quote&quot;&gt;&apos;pBC-jWhKQ7yr0y9MXysT2g&apos;&lt;/span&gt;, memberEpoch=1, heartbeatIntervalMs=5000, assignment=Assignment(topicPartitions=[TopicPartitions(topicId=TcUeldqLQae7xsWQo2WjPA, partitions=[0, 1, 2, 3, 4, 5])])) (org.apache.kafka.clients.NetworkClient)

7999 [2024-04-03 19:48:49,450] TRACE [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Member pBC-jWhKQ7yr0y9MXysT2g with epoch 1 transitioned from JOINING to RECONCILING. (org.apache.kafka.clients.consumer.internals.MembershipManagerImpl)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Assignments completed:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
8005 [2024-04-03 19:48:49,454] INFO [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Updating assignment with local epoch 0
8006 &#160; &#160; &#160; &#160; Assigned partitions: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [test_topic-0, test_topic-1, test_topic-2, test_topic-3, test_topic-4, test_topic-5]
8007 &#160; &#160; &#160; &#160; Current owned partitions: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;[]
8008 &#160; &#160; &#160; &#160; Added partitions (assigned - owned): &#160; &#160; &#160; [test_topic-0, test_topic-1, test_topic-2, test_topic-3, test_topic-4, test_topic-5]
8009 &#160; &#160; &#160; &#160; Revoked partitions (owned - assigned): &#160; &#160; []
8010 &#160;(org.apache.kafka.clients.consumer.internals.MembershipManagerImpl) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Then receive another heartbeat:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
8021 [2024-04-03 19:48:49,486] DEBUG [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Received CONSUMER_GROUP_HEARTBEAT response from node 2147483646 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; request with header RequestHeader(apiKey=CONSUMER_GROUP_HEARTBEAT, apiVersion=0, clientId=consumer-test_group_id-1, correlationId=36, headerVersion=2): ConsumerGroupHeartbeatResponseData(t &#160; &#160; hrottleTimeMs=0, errorCode=0, errorMessage=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, memberId=&lt;span class=&quot;code-quote&quot;&gt;&apos;HhILLGoPQ3i7Rt6IINJbRA&apos;&lt;/span&gt;, memberEpoch=2, heartbeatIntervalMs=5000, assignment=Assignment(topicPartitions=[])) (org.apache.kafka.clients.NetworkClient)

Which causes revocation

Updating assignment with local epoch 1
8223 &#160; &#160; &#160; &#160; Assigned partitions: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; []
8224 &#160; &#160; &#160; &#160; Current owned partitions: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;[test_topic-0, test_topic-1, test_topic-2, test_topic-3, test_topic-4, test_topic-5]
8225 &#160; &#160; &#160; &#160; Added partitions (assigned - owned): &#160; &#160; &#160; []
8226 &#160; &#160; &#160; &#160; Revoked partitions (owned - assigned): &#160; &#160; [test_topic-0, test_topic-1, test_topic-2, test_topic-3, test_topic-4, test_topic-5]
8227 &#160;(org.apache.kafka.clients.consumer.internals.MembershipManagerImpl) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13067541" name="KAFKA-16389.patch" size="2679" author="kirktrue" created="Tue, 19 Mar 2024 23:14:57 +0000"/>
                            <attachment id="13067834" name="consumer.log" size="2557599" author="pnee" created="Wed, 3 Apr 2024 20:48:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 31 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1o2ko:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>