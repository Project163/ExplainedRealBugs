<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:06:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-6288] Broken symlink interrupts scanning the plugin path</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-6288</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6087&quot; title=&quot;Scanning plugin.path needs to support relative symlinks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6087&quot;&gt;&lt;del&gt;KAFKA-6087&lt;/del&gt;&lt;/a&gt; introduced support for scanning relative symlinks in the plugin path. However, if a relative symlink points to a target that doesn&apos;t exist, then scanning the plugin path is interrupted. The consequence is that the unscanned connectors in the plugin path may effectively not be usable.&lt;/p&gt;

&lt;p&gt;Desired behavior is that the symlink with the non-existent target is skipped and scanning the plugin path continues.&lt;/p&gt;

&lt;p&gt;Example of error message:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[2017-11-30 20:19:26,226] ERROR Could not get listing for plugin path: /usr/share/java. Ignoring. (org.apache.kafka.connect.runtime.isolation.DelegatingClassLoader:170)
java.nio.file.NoSuchFileException: /usr/share/java/name.jar
	at sun.nio.fs.UnixException.translateToIOException(UnixException.java:86)
	at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)
	at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)
	at sun.nio.fs.UnixPath.toRealPath(UnixPath.java:837)
	at org.apache.kafka.connect.runtime.isolation.PluginUtils.pluginUrls(PluginUtils.java:241)
	at org.apache.kafka.connect.runtime.isolation.DelegatingClassLoader.registerPlugin(DelegatingClassLoader.java:181)
	at org.apache.kafka.connect.runtime.isolation.DelegatingClassLoader.initLoaders(DelegatingClassLoader.java:153)
	at org.apache.kafka.connect.runtime.isolation.Plugins.&amp;lt;init&amp;gt;(Plugins.java:47)
	at org.apache.kafka.connect.cli.ConnectDistributed.main(ConnectDistributed.java:70)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13122073">KAFKA-6288</key>
            <summary>Broken symlink interrupts scanning the plugin path</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kkonstantine">Konstantine Karantasis</assignee>
                                    <reporter username="yevabyzek">Yeva Byzek</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Dec 2017 02:06:41 +0000</created>
                <updated>Wed, 25 Apr 2018 09:42:55 +0000</updated>
                            <resolved>Sun, 4 Feb 2018 23:12:28 +0000</resolved>
                                    <version>0.11.0.2</version>
                    <version>1.0.0</version>
                                    <fixVersion>0.11.0.3</fixVersion>
                    <fixVersion>1.0.1</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16273872" author="yuzhihong@gmail.com" created="Fri, 1 Dec 2017 03:28:19 +0000"  >&lt;p&gt;How does the patch look (just for reference) ?&lt;/p&gt;

&lt;p&gt;Edit:&lt;br/&gt;
Just saw this is taken by Konstantin.&lt;/p&gt;</comment>
                            <comment id="16341880" author="githubbot" created="Sat, 27 Jan 2018 01:21:02 +0000"  >&lt;p&gt;kkonstantine opened a new pull request #4481: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6288&quot; title=&quot;Broken symlink interrupts scanning the plugin path&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6288&quot;&gt;&lt;del&gt;KAFKA-6288&lt;/del&gt;&lt;/a&gt;: Broken symlink interrupts scanning of the plugin path&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/4481&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4481&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Submitting a fail safe fix for rare IOExceptions on symbolic links. &lt;/p&gt;

&lt;p&gt;   The fix is submitted without a test case since it does seem easy to reproduce such type of failures (just having a broken symbolic link does not reproduce the issue) and it&apos;s considered pretty low risk.  &lt;/p&gt;

&lt;p&gt;   If accepted, needs to be ported at least to 1.0, if not 0.11&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16343864" author="githubbot" created="Mon, 29 Jan 2018 19:27:28 +0000"  >&lt;p&gt;ewencp closed pull request #4481: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6288&quot; title=&quot;Broken symlink interrupts scanning the plugin path&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6288&quot;&gt;&lt;del&gt;KAFKA-6288&lt;/del&gt;&lt;/a&gt;: Broken symlink interrupts scanning of the plugin path&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/4481&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4481&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/DelegatingClassLoader.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/DelegatingClassLoader.java&lt;br/&gt;
index 0c133b9a891..8e746c95e45 100644&lt;br/&gt;
&amp;#8212; a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/DelegatingClassLoader.java&lt;br/&gt;
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/DelegatingClassLoader.java&lt;br/&gt;
@@ -52,6 +52,7 @@&lt;/p&gt;

&lt;p&gt; public class DelegatingClassLoader extends URLClassLoader {&lt;br/&gt;
     private static final Logger log = LoggerFactory.getLogger(DelegatingClassLoader.class);&lt;br/&gt;
+    private static final String classpathName = &quot;classpath&quot;;&lt;/p&gt;

&lt;p&gt;     private final Map&amp;lt;String, SortedMap&amp;lt;PluginDesc&amp;lt;?&amp;gt;, ClassLoader&amp;gt;&amp;gt; pluginLoaders;&lt;br/&gt;
     private final Map&amp;lt;String, String&amp;gt; aliases;&lt;br/&gt;
@@ -139,10 +140,23 @@ public Object run() {&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;     protected void initLoaders() {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String path = null;&lt;br/&gt;
+        for (String configPath : pluginPaths) 
{
+            initPluginLoader(configPath);
+        }
&lt;p&gt;+        // Finally add parent/system loader.&lt;br/&gt;
+        initPluginLoader(classpathName);&lt;br/&gt;
+        addAllAliases();&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
+    private void initPluginLoader(String path) {&lt;br/&gt;
         try {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;for (String configPath : pluginPaths) {&lt;/li&gt;
	&lt;li&gt;path = configPath;&lt;br/&gt;
+            if (classpathName.equals(path)) 
{
+                scanUrlsAndAddPlugins(
+                        getParent(),
+                        ClasspathHelper.forJavaClassPath().toArray(new URL[0]),
+                        null
+                );
+            }
&lt;p&gt; else &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {                 Path pluginPath = Paths.get(path).toAbsolutePath();                 // Update for exception handling                 path = pluginPath.toString();@@ -156,14 +170,6 @@ protected void initLoaders() {
                     registerPlugin(pluginPath);
                 }             }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;-&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;path = &quot;classpath&quot;;&lt;/li&gt;
	&lt;li&gt;// Finally add parent/system loader.&lt;/li&gt;
	&lt;li&gt;scanUrlsAndAddPlugins(&lt;/li&gt;
	&lt;li&gt;getParent(),&lt;/li&gt;
	&lt;li&gt;ClasspathHelper.forJavaClassPath().toArray(new URL&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;),&lt;/li&gt;
	&lt;li&gt;null&lt;/li&gt;
	&lt;li&gt;);&lt;br/&gt;
         } catch (InvalidPathException | MalformedURLException e) {&lt;br/&gt;
             log.error(&quot;Invalid path in plugin path: {}. Ignoring.&quot;, path, e);&lt;br/&gt;
         } catch (IOException e) {&lt;br/&gt;
@@ -171,7 +177,6 @@ protected void initLoaders() {&lt;br/&gt;
         } catch (InstantiationException | IllegalAccessException e) {&lt;br/&gt;
             log.error(&quot;Could not instantiate plugins in: {}. Ignoring: {}&quot;, path, e);&lt;br/&gt;
         }&lt;/li&gt;
	&lt;li&gt;addAllAliases();&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     private void registerPlugin(Path pluginLocation)&lt;br/&gt;
diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/PluginUtils.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/PluginUtils.java&lt;br/&gt;
index c1774e971aa..ca75227ff40 100644&lt;br/&gt;
&amp;#8212; a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/PluginUtils.java&lt;br/&gt;
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/PluginUtils.java&lt;br/&gt;
@@ -233,16 +233,29 @@ public static boolean isClassFile(Path path) {&lt;/p&gt;

&lt;p&gt;                 Path adjacent = neighbors.next();&lt;br/&gt;
                 if (Files.isSymbolicLink(adjacent)) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Path symlink = Files.readSymbolicLink(adjacent);&lt;/li&gt;
	&lt;li&gt;// if symlink is absolute resolve() returns the absolute symlink itself&lt;/li&gt;
	&lt;li&gt;Path parent = adjacent.getParent();&lt;/li&gt;
	&lt;li&gt;if (parent == null) 
{
-                        continue;
-                    }&lt;/li&gt;
	&lt;li&gt;Path absolute = parent.resolve(symlink).toRealPath();&lt;/li&gt;
	&lt;li&gt;if (Files.exists(absolute)) 
{
-                        adjacent = absolute;
-                    }
&lt;p&gt; else {&lt;br/&gt;
+                    try &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+                        Path symlink = Files.readSymbolicLink(adjacent);+                        // if symlink is absolute resolve() returns the absolute symlink itself+                        Path parent = adjacent.getParent();+                        if (parent == null) {
+                            continue;
+                        }&lt;br/&gt;
+                        Path absolute = parent.resolve(symlink).toRealPath();&lt;br/&gt;
+                        if (Files.exists(absolute)) {
+                            adjacent = absolute;
+                        } else {+                            continue;+                        }+                    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; catch (IOException e) {&lt;br/&gt;
+                        // See &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6288&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-6288&lt;/a&gt; for a reported&lt;br/&gt;
+                        // failure. Such a failure at this stage is not easily reproducible and&lt;br/&gt;
+                        // therefore an exception is caught and ignored after issuing a&lt;br/&gt;
+                        // warning. This allows class scanning to continue for non-broken plugins.&lt;br/&gt;
+                        log.warn(&lt;br/&gt;
+                                &quot;Resolving symbolic link &apos;{}&apos; failed. Ignoring this path.&quot;,&lt;br/&gt;
+                                adjacent,&lt;br/&gt;
+                                e&lt;br/&gt;
+                        );&lt;br/&gt;
                         continue;&lt;br/&gt;
                     }&lt;br/&gt;
                 }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16343865" author="githubbot" created="Mon, 29 Jan 2018 19:27:29 +0000"  >&lt;p&gt;kkonstantine opened a new pull request #4481: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6288&quot; title=&quot;Broken symlink interrupts scanning the plugin path&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6288&quot;&gt;&lt;del&gt;KAFKA-6288&lt;/del&gt;&lt;/a&gt;: Broken symlink interrupts scanning of the plugin path&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/4481&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4481&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Submitting a fail safe fix for rare IOExceptions on symbolic links. &lt;/p&gt;

&lt;p&gt;   The fix is submitted without a test case since it does seem easy to reproduce such type of failures (just having a broken symbolic link does not reproduce the issue) and it&apos;s considered pretty low risk.  &lt;/p&gt;

&lt;p&gt;   If accepted, needs to be ported at least to 1.0, if not 0.11&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16351915" author="githubbot" created="Sun, 4 Feb 2018 22:59:02 +0000"  >&lt;p&gt;ewencp closed pull request #4481: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6288&quot; title=&quot;Broken symlink interrupts scanning the plugin path&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6288&quot;&gt;&lt;del&gt;KAFKA-6288&lt;/del&gt;&lt;/a&gt;: Broken symlink interrupts scanning of the plugin path&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/4481&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4481&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/checkstyle/suppressions.xml b/checkstyle/suppressions.xml&lt;br/&gt;
index f06155f930a..de1bdfd4b04 100644&lt;br/&gt;
&amp;#8212; a/checkstyle/suppressions.xml&lt;br/&gt;
+++ b/checkstyle/suppressions.xml&lt;br/&gt;
@@ -57,7 +57,7 @@&lt;br/&gt;
               files=&quot;AbstractRequest.java|KerberosLogin.java|WorkerSinkTaskTest.java&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;     &amp;lt;suppress checks=&quot;NPathComplexity&quot;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;files=&quot;(BufferPool|MetricName|Node|ConfigDef|SslTransportLayer|MetadataResponse|KerberosLogin|Selector|Sender|Serdes|Agent|Values).java&quot;/&amp;gt;&lt;br/&gt;
+              files=&quot;(BufferPool|MetricName|Node|ConfigDef|SslTransportLayer|MetadataResponse|KerberosLogin|Selector|Sender|Serdes|Agent|Values|PluginUtils).java&quot;/&amp;gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     &amp;lt;!-- clients tests --&amp;gt;&lt;br/&gt;
     &amp;lt;suppress checks=&quot;ClassDataAbstractionCoupling&quot;&lt;br/&gt;
diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/DelegatingClassLoader.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/DelegatingClassLoader.java&lt;br/&gt;
index 0c133b9a891..8a44d4d1207 100644&lt;br/&gt;
&amp;#8212; a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/DelegatingClassLoader.java&lt;br/&gt;
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/DelegatingClassLoader.java&lt;br/&gt;
@@ -52,6 +52,7 @@&lt;/p&gt;

&lt;p&gt; public class DelegatingClassLoader extends URLClassLoader {&lt;br/&gt;
     private static final Logger log = LoggerFactory.getLogger(DelegatingClassLoader.class);&lt;br/&gt;
+    private static final String CLASSPATH_NAME = &quot;classpath&quot;;&lt;/p&gt;

&lt;p&gt;     private final Map&amp;lt;String, SortedMap&amp;lt;PluginDesc&amp;lt;?&amp;gt;, ClassLoader&amp;gt;&amp;gt; pluginLoaders;&lt;br/&gt;
     private final Map&amp;lt;String, String&amp;gt; aliases;&lt;br/&gt;
@@ -139,10 +140,23 @@ public Object run() {&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;     protected void initLoaders() {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String path = null;&lt;br/&gt;
+        for (String configPath : pluginPaths) 
{
+            initPluginLoader(configPath);
+        }
&lt;p&gt;+        // Finally add parent/system loader.&lt;br/&gt;
+        initPluginLoader(CLASSPATH_NAME);&lt;br/&gt;
+        addAllAliases();&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
+    private void initPluginLoader(String path) {&lt;br/&gt;
         try {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;for (String configPath : pluginPaths) {&lt;/li&gt;
	&lt;li&gt;path = configPath;&lt;br/&gt;
+            if (CLASSPATH_NAME.equals(path)) 
{
+                scanUrlsAndAddPlugins(
+                        getParent(),
+                        ClasspathHelper.forJavaClassPath().toArray(new URL[0]),
+                        null
+                );
+            }
&lt;p&gt; else &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {                 Path pluginPath = Paths.get(path).toAbsolutePath();                 // Update for exception handling                 path = pluginPath.toString();@@ -156,14 +170,6 @@ protected void initLoaders() {
                     registerPlugin(pluginPath);
                 }             }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;-&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;path = &quot;classpath&quot;;&lt;/li&gt;
	&lt;li&gt;// Finally add parent/system loader.&lt;/li&gt;
	&lt;li&gt;scanUrlsAndAddPlugins(&lt;/li&gt;
	&lt;li&gt;getParent(),&lt;/li&gt;
	&lt;li&gt;ClasspathHelper.forJavaClassPath().toArray(new URL&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;),&lt;/li&gt;
	&lt;li&gt;null&lt;/li&gt;
	&lt;li&gt;);&lt;br/&gt;
         } catch (InvalidPathException | MalformedURLException e) {&lt;br/&gt;
             log.error(&quot;Invalid path in plugin path: {}. Ignoring.&quot;, path, e);&lt;br/&gt;
         } catch (IOException e) {&lt;br/&gt;
@@ -171,7 +177,6 @@ protected void initLoaders() {&lt;br/&gt;
         } catch (InstantiationException | IllegalAccessException e) {&lt;br/&gt;
             log.error(&quot;Could not instantiate plugins in: {}. Ignoring: {}&quot;, path, e);&lt;br/&gt;
         }&lt;/li&gt;
	&lt;li&gt;addAllAliases();&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     private void registerPlugin(Path pluginLocation)&lt;br/&gt;
diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/PluginUtils.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/PluginUtils.java&lt;br/&gt;
index d85986ea628..d490bde4ed2 100644&lt;br/&gt;
&amp;#8212; a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/PluginUtils.java&lt;br/&gt;
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/PluginUtils.java&lt;br/&gt;
@@ -133,7 +133,7 @@&lt;br/&gt;
     private static final DirectoryStream.Filter&amp;lt;Path&amp;gt; PLUGIN_PATH_FILTER = new DirectoryStream&lt;br/&gt;
             .Filter&amp;lt;Path&amp;gt;() {&lt;br/&gt;
         @Override&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public boolean accept(Path path) throws IOException 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+        public boolean accept(Path path) {
             return Files.isDirectory(path) || isArchive(path) || isClassFile(path);
         }     }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;;&lt;br/&gt;
@@ -232,16 +232,29 @@ public static boolean isClassFile(Path path) {&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;                 Path adjacent = neighbors.next();&lt;br/&gt;
                 if (Files.isSymbolicLink(adjacent)) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Path symlink = Files.readSymbolicLink(adjacent);&lt;/li&gt;
	&lt;li&gt;// if symlink is absolute resolve() returns the absolute symlink itself&lt;/li&gt;
	&lt;li&gt;Path parent = adjacent.getParent();&lt;/li&gt;
	&lt;li&gt;if (parent == null) 
{
-                        continue;
-                    }&lt;/li&gt;
	&lt;li&gt;Path absolute = parent.resolve(symlink).toRealPath();&lt;/li&gt;
	&lt;li&gt;if (Files.exists(absolute)) 
{
-                        adjacent = absolute;
-                    }
&lt;p&gt; else {&lt;br/&gt;
+                    try &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+                        Path symlink = Files.readSymbolicLink(adjacent);+                        // if symlink is absolute resolve() returns the absolute symlink itself+                        Path parent = adjacent.getParent();+                        if (parent == null) {
+                            continue;
+                        }&lt;br/&gt;
+                        Path absolute = parent.resolve(symlink).toRealPath();&lt;br/&gt;
+                        if (Files.exists(absolute)) {
+                            adjacent = absolute;
+                        } else {+                            continue;+                        }+                    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; catch (IOException e) {&lt;br/&gt;
+                        // See &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6288&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-6288&lt;/a&gt; for a reported&lt;br/&gt;
+                        // failure. Such a failure at this stage is not easily reproducible and&lt;br/&gt;
+                        // therefore an exception is caught and ignored after issuing a&lt;br/&gt;
+                        // warning. This allows class scanning to continue for non-broken plugins.&lt;br/&gt;
+                        log.warn(&lt;br/&gt;
+                                &quot;Resolving symbolic link &apos;{}&apos; failed. Ignoring this path.&quot;,&lt;br/&gt;
+                                adjacent,&lt;br/&gt;
+                                e&lt;br/&gt;
+                        );&lt;br/&gt;
                         continue;&lt;br/&gt;
                     }&lt;br/&gt;
                 }&lt;br/&gt;
@@ -341,8 +354,8 @@ private static String prunePluginName(PluginDesc&amp;lt;?&amp;gt; plugin, String suffix) {&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     private static class DirectoryEntry {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DirectoryStream&amp;lt;Path&amp;gt; stream;&lt;/li&gt;
	&lt;li&gt;Iterator&amp;lt;Path&amp;gt; iterator;&lt;br/&gt;
+        final DirectoryStream&amp;lt;Path&amp;gt; stream;&lt;br/&gt;
+        final Iterator&amp;lt;Path&amp;gt; iterator;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         DirectoryEntry(DirectoryStream&amp;lt;Path&amp;gt; stream) {&lt;br/&gt;
             this.stream = stream;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16351919" author="ewencp" created="Sun, 4 Feb 2018 23:12:28 +0000"  >&lt;p&gt;Issue resolved by pull request 4481&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/4481&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4481&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13110536">KAFKA-6087</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12900141" name="6288.v1.txt" size="1491" author="yuzhihong@gmail.com" created="Fri, 1 Dec 2017 03:27:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 41 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3nexj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>