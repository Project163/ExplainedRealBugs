<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:20:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-8104] Consumer cannot rejoin to the group after rebalancing</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-8104</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;TL;DR; &lt;tt&gt;KafkaConsumer&lt;/tt&gt; cannot rejoin to the group due to inconsistent &lt;tt&gt;AbstractCoordinator.generation&lt;/tt&gt; (which is &lt;tt&gt;NO_GENERATION&lt;/tt&gt; and &lt;tt&gt;AbstractCoordinator.joinFuture&lt;/tt&gt; (which is succeeded &lt;tt&gt;RequestFuture&lt;/tt&gt;). See explanation below.&lt;/p&gt;

&lt;p&gt;There are 16 consumers in single process (threads from pool-4-thread-1 to pool-4-thread-16). All of them belong to single consumer group &lt;tt&gt;hercules.sink.elastic.legacy_logs_elk_c2&lt;/tt&gt;. Rebalancing has been acquired and consumers have got &lt;tt&gt;CommitFailedException&lt;/tt&gt; as expected:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2019-03-10T03:16:37.023Z [pool-4-thread-10] WARN  r.k.vostok.hercules.sink.SimpleSink - Commit failed due to rebalancing
org.apache.kafka.clients.consumer.CommitFailedException: Commit cannot be completed since the group has already rebalanced and assigned the partitions to another member. This means that the time between subsequent calls to poll() was longer than the configured max.poll.interval.ms, which typically implies that the poll loop is spending too much time message processing. You can address this either by increasing the session timeout or by reducing the maximum size of batches returned in poll() with max.poll.records.
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.sendOffsetCommitRequest(ConsumerCoordinator.java:798)
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.commitOffsetsSync(ConsumerCoordinator.java:681)
	at org.apache.kafka.clients.consumer.KafkaConsumer.commitSync(KafkaConsumer.java:1334)
	at org.apache.kafka.clients.consumer.KafkaConsumer.commitSync(KafkaConsumer.java:1298)
	at ru.kontur.vostok.hercules.sink.Sink.commit(Sink.java:156)
	at ru.kontur.vostok.hercules.sink.SimpleSink.run(SimpleSink.java:104)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After that, most of them successfully rejoined to the group with generation 10699:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2019-03-10T03:16:39.208Z [pool-4-thread-13] INFO  o.a.k.c.c.i.AbstractCoordinator - [Consumer clientId=consumer-13, groupId=hercules.sink.elastic.legacy_logs_elk_c2] Successfully joined group with generation 10699
2019-03-10T03:16:39.209Z [pool-4-thread-13] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-13, groupId=hercules.sink.elastic.legacy_logs_elk_c2] Setting newly assigned partitions [legacy_logs_elk_c2-18]
...
2019-03-10T03:16:39.216Z [pool-4-thread-11] INFO  o.a.k.c.c.i.AbstractCoordinator - [Consumer clientId=consumer-11, groupId=hercules.sink.elastic.legacy_logs_elk_c2] Successfully joined group with generation 10699
2019-03-10T03:16:39.217Z [pool-4-thread-11] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-11, groupId=hercules.sink.elastic.legacy_logs_elk_c2] Setting newly assigned partitions [legacy_logs_elk_c2-10, legacy_logs_elk_c2-11]
...
2019-03-10T03:16:39.218Z [pool-4-thread-15] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-15, groupId=hercules.sink.elastic.legacy_logs_elk_c2] Setting newly assigned partitions [legacy_logs_elk_c2-24]
2019-03-10T03:16:42.320Z [kafka-coordinator-heartbeat-thread | hercules.sink.elastic.legacy_logs_elk_c2] INFO  o.a.k.c.c.i.AbstractCoordinator - [Consumer clientId=consumer-6, groupId=hercules.sink.elastic.legacy_logs_elk_c2] Attempt to heartbeat failed since group is rebalancing
2019-03-10T03:16:42.320Z [kafka-coordinator-heartbeat-thread | hercules.sink.elastic.legacy_logs_elk_c2] INFO  o.a.k.c.c.i.AbstractCoordinator - [Consumer clientId=consumer-5, groupId=hercules.sink.elastic.legacy_logs_elk_c2] Attempt to heartbeat failed since group is rebalancing
2019-03-10T03:16:42.323Z [kafka-coordinator-heartbeat-thread | hercules.sink.elastic.legacy_logs_elk_c2] INFO  o.a.k.c.c.i.AbstractCoordinator - [Consumer clientId=consumer-7, groupId=hercules.sink.elastic.legacy_logs_elk_c2] Attempt to heartbeat failed since group is rebalancing
2019-03-10T03:17:13.235Z [pool-4-thread-4] INFO  o.a.k.c.c.i.AbstractCoordinator - [Consumer clientId=consumer-4, groupId=hercules.sink.elastic.legacy_logs_elk_c2] Successfully joined group with generation -1

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;But one consumer (pool-4-thread-4) got strange generation -1 (see last log record from above).&lt;br/&gt;
Further log records in attached log file.&lt;/p&gt;

&lt;p&gt;Finally, 15 consumers successfully rejoined. But consumer with thread &lt;tt&gt;pool-4-thread-4&lt;/tt&gt; didn&apos;t rejoin:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2019-03-10T03:17:13.355Z [pool-4-thread-4] ERROR r.k.vostok.hercules.sink.SimpleSink - Unspecified exception has been acquired
java.lang.IllegalStateException: Coordinator selected invalid assignment protocol: null
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.onJoinComplete(ConsumerCoordinator.java:241)
	at org.apache.kafka.clients.consumer.internals.AbstractCoordinator.joinGroupIfNeeded(AbstractCoordinator.java:422)
	at org.apache.kafka.clients.consumer.internals.AbstractCoordinator.ensureActiveGroup(AbstractCoordinator.java:352)
	at org.apache.kafka.clients.consumer.internals.AbstractCoordinator.ensureActiveGroup(AbstractCoordinator.java:337)
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.poll(ConsumerCoordinator.java:333)
	at org.apache.kafka.clients.consumer.KafkaConsumer.updateAssignmentMetadataIfNeeded(KafkaConsumer.java:1218)
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1175)
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1154)
	at ru.kontur.vostok.hercules.sink.Sink.poll(Sink.java:152)
	at ru.kontur.vostok.hercules.sink.SimpleSink.run(SimpleSink.java:70)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2019-03-10T03:17:13.360Z [pool-4-thread-4] ERROR r.k.vostok.hercules.sink.SimpleSink - Unspecified exception has been acquired
java.lang.IllegalStateException: Coordinator selected invalid assignment protocol: null
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.onJoinComplete(ConsumerCoordinator.java:241)
	at org.apache.kafka.clients.consumer.internals.AbstractCoordinator.joinGroupIfNeeded(AbstractCoordinator.java:422)
	at org.apache.kafka.clients.consumer.internals.AbstractCoordinator.ensureActiveGroup(AbstractCoordinator.java:352)
	at org.apache.kafka.clients.consumer.internals.AbstractCoordinator.ensureActiveGroup(AbstractCoordinator.java:337)
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.poll(ConsumerCoordinator.java:333)
	at org.apache.kafka.clients.consumer.KafkaConsumer.updateAssignmentMetadataIfNeeded(KafkaConsumer.java:1218)
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1175)
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1154)
	at ru.kontur.vostok.hercules.sink.Sink.poll(Sink.java:152)
	at ru.kontur.vostok.hercules.sink.SimpleSink.run(SimpleSink.java:70)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It is important to note, that &lt;tt&gt;KafkaConsumer.coordinator.joinFuture&lt;/tt&gt; is not null and succeeded, but &lt;tt&gt;ConsumerCoordinator&lt;/tt&gt; cannot perform &lt;tt&gt;resetJoinGroupFuture()&lt;/tt&gt; due to exception was thrown from &lt;tt&gt;onJoinComplete()&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt;.succeeded()) {
                &lt;span class=&quot;code-comment&quot;&gt;// Duplicate the buffer in &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; `onJoinComplete` does not complete and needs to be retried.
&lt;/span&gt;                ByteBuffer memberAssignment = &lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt;.value().duplicate();
                onJoinComplete(generation.generationId, generation.memberId, generation.protocol, memberAssignment);

                &lt;span class=&quot;code-comment&quot;&gt;// We reset the join group &lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt; only after the completion callback returns. This ensures
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// that &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the callback is woken up, we will retry it on the next joinGroupIfNeeded.
&lt;/span&gt;                resetJoinGroupFuture();
                needsJoinPrepare = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If I understood correctly, the generation was changed to &lt;tt&gt;NO_GENERATION&lt;/tt&gt; in another thread by one of CoordinatorResponseHandlers.&lt;/p&gt;

&lt;p&gt; &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12962390/12962390_consumer-rejoin-fail.log&quot; title=&quot;consumer-rejoin-fail.log attached to KAFKA-8104&quot;&gt;consumer-rejoin-fail.log&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;/p&gt;</description>
                <environment></environment>
        <key id="13221504">KAFKA-8104</key>
            <summary>Consumer cannot rejoin to the group after rebalancing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nizhikov">Nikolay Izhikov</assignee>
                                    <reporter username="kgn">Gregory Koshelev</reporter>
                        <labels>
                            <label>new-consumer-threading-should-fix</label>
                    </labels>
                <created>Wed, 13 Mar 2019 19:15:23 +0000</created>
                <updated>Mon, 24 Feb 2025 20:39:31 +0000</updated>
                            <resolved>Thu, 17 Oct 2019 05:54:38 +0000</resolved>
                                    <version>2.0.0</version>
                    <version>2.1.0</version>
                    <version>2.2.0</version>
                    <version>2.3.0</version>
                                    <fixVersion>2.4.0</fixVersion>
                                    <component>consumer</component>
                        <due></due>
                            <votes>11</votes>
                                    <watches>19</watches>
                                                                                                                <comments>
                            <comment id="16891092" author="mbarbon" created="Tue, 23 Jul 2019 14:46:02 +0000"  >&lt;p&gt;It also happens with version 2.3 of the client&lt;/p&gt;</comment>
                            <comment id="16895482" author="guozhang" created="Mon, 29 Jul 2019 17:46:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbarbon&quot; class=&quot;user-hover&quot; rel=&quot;mbarbon&quot;&gt;mbarbon&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kgn&quot; class=&quot;user-hover&quot; rel=&quot;kgn&quot;&gt;kgn&lt;/a&gt; do you have any broker-side logs around the time this happens that can be shared on this ticket as well?&lt;/p&gt;</comment>
                            <comment id="16911182" author="kgn" created="Tue, 20 Aug 2019 10:13:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guozhang&quot; class=&quot;user-hover&quot; rel=&quot;guozhang&quot;&gt;guozhang&lt;/a&gt;, I found server.log (there are 3 brokers, but only one of them has relevant log entries in log):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[2019-03-10 02:46:43,627] INFO [GroupCoordinator 2]: Stabilized group hercules.sink.elastic.legacy_logs_elk_c2 generation 10693 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:43,630] INFO [GroupCoordinator 2]: Assignment received from leader &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; group hercules.sink.elastic.legacy_logs_elk_c2 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; generation 10693 (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:45,397] INFO [GroupCoordinator 2]: Preparing to rebalance group hercules.sink.elastic.legacy_logs_elk_c2 with old generation 10693 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,628] INFO [GroupCoordinator 2]: Member consumer-7-cc600ccb-72b6-4582-b288-3ea966f33c7c in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,628] INFO [GroupCoordinator 2]: Member consumer-1-f284c5c8-22fc-40d5-aa30-46c2875463bd in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,628] INFO [GroupCoordinator 2]: Member consumer-5-e608adfc-e9ad-427e-99b5-99ff1538611d in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,628] INFO [GroupCoordinator 2]: Member consumer-6-daa568cc-a5ee-49a9-aa7c-bd34fbb1da52 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,628] INFO [GroupCoordinator 2]: Member consumer-2-da70d65b-53e6-4467-b06d-63f02ff89eec in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,628] INFO [GroupCoordinator 2]: Member consumer-12-a0cb16ff-46eb-4945-a87a-244a20261af9 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,628] INFO [GroupCoordinator 2]: Member consumer-10-c10cb15d-edc3-4c6a-b21a-68e2b8298284 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,628] INFO [GroupCoordinator 2]: Member consumer-16-d80c8a16-be83-48f3-ac9d-08431b87c198 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,628] INFO [GroupCoordinator 2]: Member consumer-5-75899722-91a9-439a-a0c5-f23eb7c6c93f in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,628] INFO [GroupCoordinator 2]: Member consumer-11-14fe64e9-1553-49e1-abf9-5ea623847c84 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,628] INFO [GroupCoordinator 2]: Member consumer-3-9b62bde0-ff71-46f7-b6a4-7be14e6055b5 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-14-42336dad-be7c-49da-a76b-72d13a856943 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-6-1d57e91e-a6cd-4917-9560-19fa6579d02e in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-13-a310873e-5c66-402c-a031-0b2fce8eb4cc in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-1-7c591ed8-01d8-4f2c-b756-a5c3d3f63eea in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-7-70c381bc-5d32-4e2c-923b-2c15c0f15aa2 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-15-5de2a785-0cd8-43f8-b3e2-6b1da2983910 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-10-92f6d7a8-cc6c-4091-9eb4-1a8be9a08541 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-5-bd971902-bea5-49ef-83f6-3788e7363924 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-11-18b7fff3-f477-44c8-bece-4bde079bb578 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-2-bb9ff074-6738-4092-a2c0-f3d49e5e7e2a in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-9-ef6b36b3-376f-4a04-a0cb-709c8a28712b in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-13-57c73f24-4e8d-407e-874b-ab95409f7b1c in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-10-265e41ea-c8c3-47f2-96d2-33309f975f29 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-15-f3ea2d41-09df-454a-a13b-c2007e0bff32 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-11-dcbc5baf-b7e4-433f-9580-b5e846418748 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-14-3cfd686d-e590-4055-9c8c-70f673a0a624 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-8-43d4c7af-a8f5-4616-8346-33bed246a253 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-11-bf244902-001f-460c-8cf5-e9ac5e7cb4a6 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-10-74f336ca-6a0f-4603-b93a-fcee81953f9f in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-1-65fe1595-6bff-4506-8a9b-6f35f3663f48 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-16-470b7eb9-942d-48fa-b8c1-d128ae21900d in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,629] INFO [GroupCoordinator 2]: Member consumer-2-d587e29f-4d7e-4234-a774-21813af82415 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-7-a1fbd1a5-a4a8-42a8-bf7e-d6742edb8003 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-16-47eaa6a5-1fe9-4216-8afa-aaa5a7684755 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-10-1cba9737-26c2-4879-82c7-d3ef6399a2b3 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-13-b4031cae-43c3-45a4-b258-b9cfe2645eb6 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-3-e23f1744-7781-4e09-b394-6e3a09a5ed6d in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-4-59459730-4118-4379-a208-83bfba9a751e in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-9-4291927f-119f-4610-bd00-f9503847ff05 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-6-b8d722e7-58d3-4e2f-af03-92ab01e23f8d in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-14-b2504ede-535c-4884-aea5-03734661bb4d in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-6-afb90678-4548-4a23-bbbb-3ce2ffb6b59c in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-15-ecd3673c-c585-4fab-98ae-b14f5583e59d in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-7-d534cf40-ecf6-4cac-a823-c5bb7d515ffe in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-15-6c51bd3b-88c0-407a-a606-f21f8a16b22e in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-16-47e4622c-aea3-4a7f-b3c4-c4e88c553c63 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-13-6aef6aef-2fa7-4499-a138-8132f10662fd in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-1-d5563ddf-63dc-4308-b456-881b0f3bd64f in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-3-323295d3-d5b5-49f4-a364-18c681fcc534 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-3-494d66e9-5225-4673-8400-ebf1f96d5e5e in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-1-5035e670-86ff-4365-9be1-daf28bb85894 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-7-2bccc8ef-31f0-4974-8042-4721d60d0be4 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-13-e5e10c2d-28a2-4def-a5ec-2e33e3162c6c in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-4-b18fc59c-d2e0-474b-9eb7-76150001406a in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-1-c99e56c9-bd3b-4230-a3fa-c01ae0208333 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-13-c7331006-f001-4cee-b7f7-feb4be3db7e5 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-5-fcf52494-4825-43da-8b8f-622b69f19707 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-4-7f88af3b-bcc8-475c-84e0-e254871998b3 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-16-b5952574-6146-4f4f-9fb9-e5a1a0165296 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-3-0b751ea6-b228-489b-9679-381173ac7bb8 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-6-5f5ed961-0ac6-4463-8e2d-87a0d40de556 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-9-180c4643-92f2-4989-b807-b6a4f8ab4ac9 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-15-24048d2d-7442-4392-af17-b4a959e58bf7 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-5-6fc6f5b5-cd67-4cb6-a8fb-b4b4dd8fc2ea in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-8-9fca323f-e32d-4e4a-99eb-356557892607 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-3-3b403a81-75d5-44df-b9d5-c0accc173e67 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-15-dbd7b016-fb76-4ce0-be8e-753995fa701e in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-12-39204442-c071-46d5-8f5d-45a89dbe9426 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-11-dd4283b7-9226-496c-834e-4abfba06396c in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-2-f5f81416-0d70-4d44-86b4-cf834add0c5c in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,630] INFO [GroupCoordinator 2]: Member consumer-12-a889fd7d-edc8-4323-9aea-4e7c98f24e64 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,631] INFO [GroupCoordinator 2]: Member consumer-6-cbe5c48d-24ac-4aab-87a8-227c1292bffa in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,631] INFO [GroupCoordinator 2]: Member consumer-2-5e1893ac-76ee-495c-9624-ee06b8004565 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,631] INFO [GroupCoordinator 2]: Member consumer-5-3f0832ba-0b9e-4ff1-8e10-1ba9c61a7b67 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,631] INFO [GroupCoordinator 2]: Member consumer-8-ab32a5e0-4781-487c-8e8f-2a163d1437dd in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:46:53,631] INFO [GroupCoordinator 2]: Member consumer-7-4457a612-a996-43ed-95ee-9a0e1c9e5371 in group hercules.sink.elastic.legacy_logs_elk_c2 has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:47:00,306] INFO [GroupMetadataManager brokerId=2] Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.group.GroupMetadataManager)
[2019-03-10 02:47:09,911] WARN Attempting to send response via channel &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; which there is no open connection, connection id 10.0.3.151:9092-10.0.3.60:41792-1811027 (kafka.network.Processor)
[2019-03-10 02:47:15,431] INFO [GroupCoordinator 2]: Stabilized group hercules.sink.elastic.legacy_logs_elk_c2 generation 10694 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:47:15,433] INFO [GroupCoordinator 2]: Preparing to rebalance group hercules.sink.elastic.legacy_logs_elk_c2 with old generation 10694 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:47:15,436] INFO [GroupCoordinator 2]: Stabilized group hercules.sink.elastic.legacy_logs_elk_c2 generation 10695 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:47:15,437] INFO [GroupCoordinator 2]: Assignment received from leader &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; group hercules.sink.elastic.legacy_logs_elk_c2 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; generation 10695 (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:47:22,774] INFO [GroupCoordinator 2]: Preparing to rebalance group hercules.sink.elastic.legacy_logs_elk_c2 with old generation 10695 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:47:42,111] INFO [GroupCoordinator 2]: Stabilized group hercules.sink.elastic.legacy_logs_elk_c2 generation 10696 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:47:42,113] INFO [GroupCoordinator 2]: Assignment received from leader &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; group hercules.sink.elastic.legacy_logs_elk_c2 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; generation 10696 (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:48:04,754] WARN Attempting to send response via channel &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; which there is no open connection, connection id 10.0.3.151:9092-10.0.3.60:43668-1811310 (kafka.network.Processor)
[2019-03-10 02:48:10,975] WARN Attempting to send response via channel &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; which there is no open connection, connection id 10.0.3.151:9092-10.0.3.153:56162-1811343 (kafka.network.Processor)
[2019-03-10 02:48:32,082] WARN Attempting to send response via channel &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; which there is no open connection, connection id 10.0.3.151:9092-10.0.3.60:44598-1811455 (kafka.network.Processor)
[2019-03-10 02:50:09,387] WARN Attempting to send response via channel &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; which there is no open connection, connection id 10.0.3.151:9092-10.0.3.60:48904-1811956 (kafka.network.Processor)
[2019-03-10 02:50:16,787] INFO [GroupCoordinator 2]: Preparing to rebalance group hercules.sink.elastic.legacy_logs_elk_c2 with old generation 10696 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:50:22,630] INFO [GroupCoordinator 2]: Stabilized group hercules.sink.elastic.legacy_logs_elk_c2 generation 10697 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:50:22,633] INFO [GroupCoordinator 2]: Assignment received from leader &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; group hercules.sink.elastic.legacy_logs_elk_c2 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; generation 10697 (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:51:13,251] INFO [GroupCoordinator 2]: Preparing to rebalance group hercules.sink.elastic.legacy_logs_elk_c2 with old generation 10697 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:51:13,967] INFO [GroupCoordinator 2]: Stabilized group hercules.sink.elastic.legacy_logs_elk_c2 generation 10698 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:51:13,969] INFO [GroupCoordinator 2]: Assignment received from leader &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; group hercules.sink.elastic.legacy_logs_elk_c2 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; generation 10698 (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 02:57:00,306] INFO [GroupMetadataManager brokerId=2] Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.group.GroupMetadataManager)
[2019-03-10 03:13:44,854] WARN Attempting to send response via channel &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; which there is no open connection, connection id 10.0.3.151:9092-10.0.3.153:42480-1819319 (kafka.network.Processor)
[2019-03-10 03:16:11,256] INFO [GroupCoordinator 2]: Preparing to rebalance group hercules.sink.elastic.legacy_logs_elk_c2 with old generation 10698 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 03:16:39,196] INFO [GroupCoordinator 2]: Stabilized group hercules.sink.elastic.legacy_logs_elk_c2 generation 10699 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 03:16:39,204] INFO [GroupCoordinator 2]: Assignment received from leader &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; group hercules.sink.elastic.legacy_logs_elk_c2 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; generation 10699 (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 03:16:39,221] INFO [GroupCoordinator 2]: Preparing to rebalance group hercules.sink.elastic.legacy_logs_elk_c2 with old generation 10699 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 03:17:00,306] INFO [GroupMetadataManager brokerId=2] Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.group.GroupMetadataManager)
[2019-03-10 03:17:31,693] INFO [GroupCoordinator 2]: Stabilized group hercules.sink.elastic.legacy_logs_elk_c2 generation 10700 (__consumer_offsets-25) (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 03:17:31,695] INFO [GroupCoordinator 2]: Assignment received from leader &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; group hercules.sink.elastic.legacy_logs_elk_c2 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; generation 10700 (kafka.coordinator.group.GroupCoordinator)
[2019-03-10 03:20:05,312] WARN Attempting to send response via channel &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; which there is no open connection, connection id 10.0.3.151:9092-10.0.3.60:60490-1821319 (kafka.network.Processor)
[2019-03-10 03:22:56,928] WARN Attempting to send response via channel &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; which there is no open connection, connection id 10.0.3.151:9092-10.0.3.60:38542-1822186 (kafka.network.Processor)
[2019-03-10 03:24:43,989] WARN Attempting to send response via channel &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; which there is no open connection, connection id 10.0.3.151:9092-10.0.3.60:42936-1822733 (kafka.network.Processor)
[2019-03-10 03:27:00,306] INFO [GroupMetadataManager brokerId=2] Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.group.GroupMetadataManager)
[2019-03-10 03:37:00,306] INFO [GroupMetadataManager brokerId=2] Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.group.GroupMetadataManager)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ve skipped logs about segment deletion and so on.&lt;/p&gt;</comment>
                            <comment id="16912116" author="adam.kotwasinski" created="Wed, 21 Aug 2019 09:18:29 +0000"  >&lt;p&gt;FWIW, I&apos;m seeing the same&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.IllegalStateException: Coordinator selected invalid assignment protocol: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;while using kafka-clients:1.1.1&lt;/p&gt;</comment>
                            <comment id="16931990" author="charles.qian" created="Wed, 18 Sep 2019 02:45:33 +0000"  >&lt;p&gt;same issue.&#160; &#160;kafka-client 2.2.0&lt;/p&gt;

&lt;p&gt;it happens in large topology. like each topic has &amp;gt; 16 partitions. so that for each topic, client needs &amp;gt; 16 consumer threads.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16939971" author="vvteplygin" created="Sat, 28 Sep 2019 11:37:09 +0000"  >&lt;p&gt;same issue.&#160; &#160;kafka-client 1.1.1-cp1&lt;/p&gt;

&lt;p&gt;100 partitions. 5 consumers with the same consumer group with 20 threads each&lt;/p&gt;</comment>
                            <comment id="16942526" author="apologiz" created="Wed, 2 Oct 2019 06:25:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kgn&quot; class=&quot;user-hover&quot; rel=&quot;kgn&quot;&gt;kgn&lt;/a&gt;&#160;,&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nizhikov&quot; class=&quot;user-hover&quot; rel=&quot;nizhikov&quot;&gt;nizhikov&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Version 1.1.0 is also affect&lt;/b&gt;, thanks.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2019-10-01 17:40:33,995&amp;#93;&lt;/span&gt; INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;GroupCoordinator 1001&amp;#93;&lt;/span&gt;: Member &amp;lt;client&amp;gt;-2af431fd-60e4-4dd7-a4fd-8dd85d4a5620 in group main has failed, removing it from the group (kafka.coordinator.group.GroupCoordinator)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2019-10-01 17:40:33,995&amp;#93;&lt;/span&gt; INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;GroupCoordinator 1001&amp;#93;&lt;/span&gt;: Preparing to rebalance group main with old generation 15 (__consumer_offsets-1) (kafka.coordinator.group.GroupCoordinator)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2019-10-01 17:40:33,995&amp;#93;&lt;/span&gt; INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;GroupCoordinator 1001&amp;#93;&lt;/span&gt;: Group main with generation 16 is now empty (__consumer_offsets-1) (kafka.coordinator.group.GroupCoordinator)&lt;/p&gt;</comment>
                            <comment id="16944730" author="nizhikov" created="Fri, 4 Oct 2019 18:08:43 +0000"  >&lt;p&gt;Hello.&lt;/p&gt;

&lt;p&gt;I wrote a reproducer &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; for this issue.&lt;br/&gt;
It generates the output &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; exact to the issue description.&lt;br/&gt;
It requires to emulate specific consumer threads execution path.&lt;br/&gt;
It emulated via CyclicBarrier.&lt;/p&gt;

&lt;p&gt;Seems, we have a synchronization issue.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guozhang&quot; class=&quot;user-hover&quot; rel=&quot;guozhang&quot;&gt;guozhang&lt;/a&gt; can you take a look?&lt;br/&gt;
Is reproducer correct?&lt;br/&gt;
Can you, please, assist me on how it should be fixed?&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/nizhikov/kafka/pull/1/files#diff-d5e6de9941a0199b89a70d312962d546&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/nizhikov/kafka/pull/1/files#diff-d5e6de9941a0199b89a70d312962d546&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://gist.github.com/nizhikov/8c4d5e0c78fd634a97557fdc0ece0097#file-kafka-8104-reproducer-output-L1578&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/nizhikov/8c4d5e0c78fd634a97557fdc0ece0097#file-kafka-8104-reproducer-output-L1578&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16946061" author="nizhikov" created="Mon, 7 Oct 2019 17:28:28 +0000"  >&lt;p&gt;Reproducer simplified and updated.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/nizhikov/kafka/pull/1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/nizhikov/kafka/pull/1&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16946114" author="githubbot" created="Mon, 7 Oct 2019 18:30:35 +0000"  >&lt;p&gt;nizhikov commented on pull request #7460: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-8104&quot; title=&quot;Consumer cannot rejoin to the group after rebalancing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-8104&quot;&gt;&lt;del&gt;KAFKA-8104&lt;/del&gt;&lt;/a&gt;: Consumer cannot rejoin to the group after rebalancing&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7460&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7460&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   This PR contains the fix of race condition bug between &quot;consumer thread&quot; and &quot;consumer coordinator heartbeat thread&quot;. It reproduces in many production environments.&lt;/p&gt;

&lt;p&gt;   Condition for reproducing:&lt;/p&gt;

&lt;p&gt;   1. Consumer thread initiates rejoin to the group because of commit timeout. Call of `AbstractCoordinator#joinGroupIfNeeded` which leads to `sendJoinGroupRequest`.&lt;br/&gt;
   2. `JoinGroupResponseHandler` writes to the `AbstractCoordinator.this.generation` new generation data and leaves the` synchronized` section.&lt;br/&gt;
   3. Heartbeat thread executes `mabeLeaveGroup` and clears generation data via `resetGenerationOnLeaveGroup`.&lt;br/&gt;
   4. Consumer thread executes `onJoinComplete(generation.generationId, generation.memberId, generation.protocol, memberAssignment);` with the cleared generation data. This leads to the corresponding exception.&lt;/p&gt;

&lt;p&gt;   The race fixed with the condition in `maybeLeaveGroup`: if we have ongoing rejoin process in consumer thread there is no reason to reset generation data and send `LeaveGroupRequest` in heartbeat thread.&lt;/p&gt;

&lt;p&gt;   This PR contains unfair &quot;reproducer&quot;.&lt;br/&gt;
   It implemented with the `CountDownLatch` that imitates described race in `AbstractCoordinator` code.&lt;/p&gt;

&lt;p&gt;   I need assistance on how should be fair reproducer implemented.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16946208" author="guozhang" created="Mon, 7 Oct 2019 20:42:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nizhikov&quot; class=&quot;user-hover&quot; rel=&quot;nizhikov&quot;&gt;nizhikov&lt;/a&gt; Thanks for picking this up, I think this issue is the same as reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-8891&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-8891&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7263&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-7263&lt;/a&gt; as well, which is a long-lurking bug. So I&apos;m linking them together now.&lt;/p&gt;

&lt;p&gt;I will take a look into your PR as well.&lt;/p&gt;</comment>
                            <comment id="16953423" author="githubbot" created="Thu, 17 Oct 2019 05:53:19 +0000"  >&lt;p&gt;guozhangwang commented on pull request #7460: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-8104&quot; title=&quot;Consumer cannot rejoin to the group after rebalancing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-8104&quot;&gt;&lt;del&gt;KAFKA-8104&lt;/del&gt;&lt;/a&gt;: Consumer cannot rejoin to the group after rebalancing&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7460&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7460&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="13177841">KAFKA-7263</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13255826">KAFKA-8891</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13266239">KAFKA-9140</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12962390" name="consumer-rejoin-fail.log" size="211791" author="kgn" created="Wed, 13 Mar 2019 19:18:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 4 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z00ofk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>