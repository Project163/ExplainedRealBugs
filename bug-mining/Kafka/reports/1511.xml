<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:01:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-5266] Follow-up improvements for consumer offset reset tool (KIP-122)</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-5266</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;1. We should try to ensure that offsets are in range for the topic partition. We currently only verify this for the shift option.&lt;br/&gt;
2. If you provide a CSV file, you shouldn&apos;t need to specify one of the --all-topics or --topic options.&lt;br/&gt;
3. We currently support a &quot;reset to current offsets&quot; option if none of the supported reset options are provided. This seems kind of useless. Perhaps we should just enforce that one of the reset options is provided.&lt;br/&gt;
4. The command fails with an NPE if we cannot find one of the offsets we are trying to reset. It would be better to raise an exception with a friendlier message.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13072934">KAFKA-5266</key>
            <summary>Follow-up improvements for consumer offset reset tool (KIP-122)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jeqo">Jorge Esteban Quilcate Otoya</assignee>
                                    <reporter username="hachikuji">Jason Gustafson</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 May 2017 21:12:36 +0000</created>
                <updated>Wed, 31 May 2017 07:53:03 +0000</updated>
                            <resolved>Wed, 31 May 2017 07:53:03 +0000</resolved>
                                                    <fixVersion>0.11.0.0</fixVersion>
                                    <component>tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16017475" author="jeqo" created="Fri, 19 May 2017 14:40:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hachikuji&quot; class=&quot;user-hover&quot; rel=&quot;hachikuji&quot;&gt;hachikuji&lt;/a&gt; some comments about the improvements:&lt;/p&gt;

&lt;p&gt;1. Agree, it will be fixed for the following cases: `resetToOffset`, `resetFromFile` and `resetShiftBy`; as in the other cases, offsets are gathered from the log, not by input.&lt;br/&gt;
2. Agree.&lt;br/&gt;
3. This option was kept to support the following case: export current offsets, and use it later to go back to an specific point in time. I think this scenario is usable enough to maintain it.&lt;br/&gt;
4. This looks OK, but I&apos;m not sure if I get where this could happen. Could you point where this is possible? &lt;/p&gt;</comment>
                            <comment id="16017489" author="githubbot" created="Fri, 19 May 2017 14:51:00 +0000"  >&lt;p&gt;GitHub user jeqo opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3102&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3102&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Implement Improvements&lt;/p&gt;

&lt;p&gt;    Implement improvements defined here: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5266&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-5266&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/jeqo/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jeqo/kafka&lt;/a&gt; feature/&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5266&quot; title=&quot;Follow-up improvements for consumer offset reset tool (KIP-122)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5266&quot;&gt;&lt;del&gt;KAFKA-5266&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3102.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3102.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3102&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit f0219737139760a455baf54bce6b1fa06789b255&lt;br/&gt;
Author: Jorge Quilcate Otoya &amp;lt;quilcate.jorge@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-05-19T14:40:15Z&lt;/p&gt;

&lt;p&gt;    implement improvements (1,2,3)&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16017870" author="hachikuji" created="Fri, 19 May 2017 19:12:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeqo&quot; class=&quot;user-hover&quot; rel=&quot;jeqo&quot;&gt;jeqo&lt;/a&gt; Thanks for explaining the case for 3. I guess that makes sense. Would it make sense to give this behavior an explicit option (e.g. --current-offsets)? For 4., an easy way to reproduce it is set the offset for a non-existing topic partition. You&apos;ll get something like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Error: Executing consumer group command failed due to &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16018004" author="jeqo" created="Fri, 19 May 2017 21:03:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hachikuji&quot; class=&quot;user-hover&quot; rel=&quot;hachikuji&quot;&gt;hachikuji&lt;/a&gt; Thanks!&lt;/p&gt;

&lt;p&gt;For case 3, maybe `now` could be less verbose but I like `current` also. I&apos;d avoid adding `*-offsets` to the option name because it is kind of implicit from the main `reset-offsets`. But definitely it is better having an explicit option.  Any preference between `now` and `current`? &lt;/p&gt;

&lt;p&gt;For 4, this will be possible only when you set the topic partition manually, right? What if we filter the topicPartitions from allTopics, so if you put some unassigned topic partition you will get an empty list of topicPartitions from #getPartitionsToReset. Check it here: &lt;a href=&quot;https://github.com/jeqo/kafka/blob/f1a4c5236984de348d4928450c5c0ad5112b6012/core/src/main/scala/kafka/admin/ConsumerGroupCommand.scala#L548&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jeqo/kafka/blob/f1a4c5236984de348d4928450c5c0ad5112b6012/core/src/main/scala/kafka/admin/ConsumerGroupCommand.scala#L548&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="16018106" author="hachikuji" created="Fri, 19 May 2017 22:14:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeqo&quot; class=&quot;user-hover&quot; rel=&quot;jeqo&quot;&gt;jeqo&lt;/a&gt; Maybe it could be &lt;tt&gt;-&lt;del&gt;to-current&lt;/tt&gt;, which sort of fits with the &lt;tt&gt;&lt;/del&gt;-to-offset&lt;/tt&gt; option? On 4., filtering makes sense, but there will always be some case where some error pops up when we actually try to collect the offsets we want to commit. My point is just that we should raise a friendly error to the user when that happens. So all of those paths where we currently pass through null in &lt;tt&gt;prepareOffsetsToReset&lt;/tt&gt; should raise some exception instead with a nice message.&lt;/p&gt;</comment>
                            <comment id="16018581" author="jeqo" created="Sat, 20 May 2017 18:29:16 +0000"  >&lt;p&gt;I like &apos;to-current&apos;, I&apos;ll implement it.&lt;/p&gt;

&lt;p&gt;On 4, you&apos;re right, NPE is possible in those cases. Wouldn&apos;t be better to filter those &apos;null&apos;s and print some warning logs before #toMap? And then catch any other exception on the all #resetOffsets implementation?&lt;/p&gt;</comment>
                            <comment id="16030798" author="hachikuji" created="Wed, 31 May 2017 07:53:03 +0000"  >&lt;p&gt;Issue resolved by pull request 3102&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/3102&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3102&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3f4yf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>