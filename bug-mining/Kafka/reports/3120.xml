<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:29:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-12226] High-throughput source tasks fail to commit offsets</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-12226</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;The current source task thread has the following workflow:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Poll messages from the source task&lt;/li&gt;
	&lt;li&gt;Queue these messages to the producer and send them to Kafka asynchronously.&lt;/li&gt;
	&lt;li&gt;Add the message to outstandingMessages, or if a flush is currently active, outstandingMessagesBacklog&lt;/li&gt;
	&lt;li&gt;When the producer completes the send of a record, remove it from outstandingMessages&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;The commit offsets thread has the following workflow:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Wait a flat timeout for outstandingMessages to flush completely&lt;/li&gt;
	&lt;li&gt;If this times out, add all of the outstandingMessagesBacklog to the outstandingMessages and reset&lt;/li&gt;
	&lt;li&gt;If it succeeds, commit the source task offsets to the backing store.&lt;/li&gt;
	&lt;li&gt;Retry the above on a fixed schedule&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;If the source task is producing records quickly (faster than the producer can send), then the producer will throttle the task thread by blocking in its &lt;tt&gt;send&lt;/tt&gt; method, waiting at most &lt;tt&gt;max.block.ms&lt;/tt&gt;&#160;for space in the &lt;tt&gt;buffer.memory&lt;/tt&gt;&#160;to be available. This means that the number of records in &lt;tt&gt;outstandingMessages&lt;/tt&gt;&#160;+ &lt;tt&gt;outstandingMessagesBacklog&lt;/tt&gt;&#160;is proportional to the size of the producer memory buffer.&lt;/p&gt;

&lt;p&gt;This amount of data might take more than &lt;tt&gt;offset.flush.timeout.ms&lt;/tt&gt;&#160;to flush, and thus the flush will never succeed while the source task is rate-limited by the producer memory. This means that we may write multiple hours of data to Kafka and not ever commit source offsets for the connector. When the task is lost due to a worker failure, hours of data will be re-processed that otherwise were successfully written to Kafka.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13353363">KAFKA-12226</key>
            <summary>High-throughput source tasks fail to commit offsets</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ChrisEgerton">Chris Egerton</assignee>
                                    <reporter username="ChrisEgerton">Chris Egerton</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Jan 2021 20:39:15 +0000</created>
                <updated>Mon, 22 Nov 2021 16:03:14 +0000</updated>
                            <resolved>Mon, 15 Nov 2021 23:40:13 +0000</resolved>
                                                    <fixVersion>3.0.1</fixVersion>
                    <fixVersion>3.1.0</fixVersion>
                    <fixVersion>3.2.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17440067" author="rhauch" created="Sun, 7 Nov 2021 17:41:17 +0000"  >&lt;p&gt;Merged the PR to the `trunk` branch, which will be included in the upcoming 3.1.0 branch. &lt;/p&gt;</comment>
                            <comment id="17443699" author="dajac" created="Mon, 15 Nov 2021 10:07:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhauch&quot; class=&quot;user-hover&quot; rel=&quot;rhauch&quot;&gt;rhauch&lt;/a&gt; I don&apos;t see this commit in the 3.1.0 branch. Note that the 3.1.0 branch was cut on November 2nd.&lt;/p&gt;</comment>
                            <comment id="17443975" author="rhauch" created="Mon, 15 Nov 2021 17:21:02 +0000"  >&lt;p&gt;Thanks for catching this, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dajac&quot; class=&quot;user-hover&quot; rel=&quot;dajac&quot;&gt;dajac&lt;/a&gt;. I did miss merging this to the `3.1` branch &amp;#8211; I recall at the time looking for the branch and not seeing it. I&apos;m in the process or building the branch after merging locally, so you should see this a bit later today.&lt;/p&gt;</comment>
                            <comment id="17444177" author="rhauch" created="Mon, 15 Nov 2021 23:40:13 +0000"  >&lt;p&gt;Merged to branches:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;`3.0` for upcoming 3.0.1 release&lt;/li&gt;
	&lt;li&gt;`3.1` for upcoming 3.1.0 release&lt;/li&gt;
	&lt;li&gt;`trunk` for upcoming 3.2 (or 4.0) release.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13413206">KAFKA-13469</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0mryw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>rhauch</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>