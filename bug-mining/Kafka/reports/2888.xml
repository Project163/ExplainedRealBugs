<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:26:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-10366] TimeWindowedDeserializer doesn&apos;t allow users to set a custom window size</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-10366</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Related to &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;KAFKA-4468&lt;/a&gt;, in timeWindowedDeserializer Long.MAX_VALUE is used as &lt;em&gt;windowSize&lt;/em&gt;&#160;for any deserializer that uses the default constructor. While streams apps can pass in a window size in serdes or while creating a timeWindowedDeserializer, the deserializer that is actually used in processing the messages is created by the Kafka consumer, without passing in the set windowSize. The deserializer the consumer creates uses the configs, but as there is no config for windowSize, the window size is always default.&lt;/p&gt;

&lt;p&gt;See&#160;&lt;em&gt;KStreamAggregationIntegrationTest #ShouldReduceWindowed()&lt;/em&gt;&#160;as an example of this issue. Despite passing in the windowSize to both the serdes and the timeWindowedDeserializer, the window size is set to Long.MAX_VALUE.&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13321196">KAFKA-10366</key>
            <summary>TimeWindowedDeserializer doesn&apos;t allow users to set a custom window size</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lthomas">Leah Thomas</assignee>
                                    <reporter username="lthomas">Leah Thomas</reporter>
                        <labels>
                            <label>streams</label>
                    </labels>
                <created>Thu, 6 Aug 2020 00:05:28 +0000</created>
                <updated>Wed, 3 Feb 2021 01:11:13 +0000</updated>
                            <resolved>Tue, 2 Feb 2021 13:59:28 +0000</resolved>
                                                    <fixVersion>2.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17172139" author="soerenhenning" created="Thu, 6 Aug 2020 08:44:09 +0000"  >&lt;p&gt;I guess, this is also related to &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9649&quot; title=&quot;Remove/Warn on use of TimeWindowedSerde with no specified window size&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9649&quot;&gt;&lt;del&gt;KAFKA-9649&lt;/del&gt;&lt;/a&gt;, right?&lt;/p&gt;</comment>
                            <comment id="17172633" author="ableegoldman" created="Thu, 6 Aug 2020 19:31:27 +0000"  >&lt;p&gt;Yeah, there are two related problems. The first one is&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9649&quot; title=&quot;Remove/Warn on use of TimeWindowedSerde with no specified window size&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9649&quot;&gt;&lt;del&gt;KAFKA-9649&lt;/del&gt;&lt;/a&gt;, where you can get in trouble by using a TimeWindowedSerde constructor that appears legit but sets the windowSize to a random default. I agree with your conclusion in that ticket, we should deprecate the TimeWindowedSerde(innerClass) constructor. If you&apos;re forced to pass in the windowSize, then things work, because Streams uses the actual Serde object that you pass into your topology. So for example a TimeWindowedSerde passed in to a Materialized or Consumed would properly set the window end time upon deserialization.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Unfortunately, you can only set the deserializer&#160;&lt;em&gt;class&lt;/em&gt; for the Consumer, which then instantiates its own Deserializer through reflection. You&apos;re supposed to do all configuration for it in the Deserializer#configure class. Unfortunately, TimeWindowedDeserializer#deserialize only sets the innerClass.&lt;/p&gt;

&lt;p&gt;The second problem, which this ticket targets, isn&apos;t really an issue for Streams users. Streams uses a plain Consumer&amp;lt;byte[], byte[]&amp;gt; and does all the deserialization itself, with the passed-in serde objects. It&apos;s just a problem for anyone who wants to consume TimeWindowed records directly. Even then, you can always use the workaround of consuming plain bytes and deserializing them yourself, so it&apos;s really more of an annoyance. It would be nice to have this fixed for tests in particular.&lt;/p&gt;

&lt;p&gt;In general though any Serdes that we support out-of-the-box should probably work throughout Kafka, so we should consider introducing a config to set the windowSize similar to what we do for the inner class&lt;/p&gt;</comment>
                            <comment id="17186265" author="mjsax" created="Fri, 28 Aug 2020 05:33:20 +0000"  >&lt;p&gt;Following &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ableegoldman&quot; class=&quot;user-hover&quot; rel=&quot;ableegoldman&quot;&gt;ableegoldman&lt;/a&gt;&#160;last comment on the discuss thread of the KIP, I was double checking `KStreamAggregationIntegrationTest#shouldReduceWindowed()` and it seem the issue is in the test setup, or in particular the use helper methods. The method `IntegrationTestUitls#createConsumer` does only take a `Properties` parameter and we should extend it to also take key/value deserializer objects (ie, add an overload for the method &#8211; we also need more overloads for other methods for this case). In `KStreamAggregationIntegrationTest#receiveMessages` we actually have a `Deserializer` object on hand, but we just convert it to a config for the consumer instead of forwarding the reference... This should resolve the issue.&lt;/p&gt;</comment>
                            <comment id="17188115" author="ableegoldman" created="Tue, 1 Sep 2020 03:33:59 +0000"  >&lt;p&gt;Yeah thanks for tracking that down &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mjsax&quot; class=&quot;user-hover&quot; rel=&quot;mjsax&quot;&gt;mjsax&lt;/a&gt;. I think we can repurpose/reinterpret this ticket to track fixing the Streams tests/test utils. If we have to add a lot of overloads throughout the call hierarchy between the test and the actual Consumer creation, maybe we can save some work by just adding a ConsumerParameters class (better names welcome) and replacing the ConsumerConfig/Properties parameter in all the methods instead. Then we can just call the appropriate Consumer constructor based on whether the deserializers have been set in the passed in. ConsumerParameters&#160;&lt;/p&gt;</comment>
                            <comment id="17189725" author="mjsax" created="Wed, 2 Sep 2020 21:58:36 +0000"  >&lt;p&gt;SGTM. And no worries about naming. It&apos;s internal classes only so we can always rename.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 10 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0hii0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>