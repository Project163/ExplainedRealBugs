<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:13:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-6966] Extend `TopologyDescription.Sink` to return `TopicNameExtractor`</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-6966</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;With KIP-303, a dynamic routing feature was added and `TopologyDescription.Sink#topic()` returns `null` if this feature is used.&lt;/p&gt;

&lt;p&gt;It would be useful to get the actually used `TopicNameExtractor` class from the `TopologyDescription`.&lt;/p&gt;

&lt;p&gt;We suggest to add `Class&amp;lt;? extends TopicNameExtractor&amp;gt; TopologyDescription.Sink#topicNameExtractor()` and let it return `null` if dynamic routing feature is not used.&lt;/p&gt;

&lt;p&gt;KIP-321:&#160;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/KAFKA/KIP-321%3A+Update+TopologyDescription+to+better+represent+Source+and+Sink+Nodes&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/KAFKA/KIP-321%3A+Update+TopologyDescription+to+better+represent+Source+and+Sink+Nodes&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13162683">KAFKA-6966</key>
            <summary>Extend `TopologyDescription.Sink` to return `TopicNameExtractor`</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nprad">Nishanth Pradeep</assignee>
                                    <reporter username="mjsax">Matthias J. Sax</reporter>
                        <labels>
                            <label>beginner</label>
                            <label>kip</label>
                            <label>newbie</label>
                    </labels>
                <created>Tue, 29 May 2018 18:30:50 +0000</created>
                <updated>Mon, 10 Sep 2018 00:16:44 +0000</updated>
                            <resolved>Fri, 10 Aug 2018 23:14:04 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>streams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16509062" author="nprad" created="Tue, 12 Jun 2018 01:50:22 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mjsax&quot; class=&quot;user-hover&quot; rel=&quot;mjsax&quot;&gt;mjsax&lt;/a&gt;. I would like to pick this up ticket as my first contribution to Kafka.&lt;/p&gt;</comment>
                            <comment id="16509072" author="mjsax" created="Tue, 12 Jun 2018 02:01:11 +0000"  >&lt;p&gt;Thanks for your interest in contributing to Kafka! I added you to the list of contributors and assigned the ticket to you. You can also self-assign tickets now. Please prepare a KIP for this &#8211; you can also work on a PR in parallel &#8211; whatever works best for you. The KIP must be accepted before we can accept the PR. If you don&apos;t have a wiki account yet, please create one and provide your wiki ID so we can grant you write access to the wiki (otherwise you cannot create a KIP page).&lt;/p&gt;</comment>
                            <comment id="16576949" author="githubbot" created="Fri, 10 Aug 2018 23:12:06 +0000"  >&lt;p&gt;mjsax closed pull request #5284: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6966&quot; title=&quot;Extend `TopologyDescription.Sink` to return `TopicNameExtractor`&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6966&quot;&gt;&lt;del&gt;KAFKA-6966&lt;/del&gt;&lt;/a&gt;: Extend TopologyDescription.Sink to return TopicNameExtractor&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5284&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5284&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/docs/streams/upgrade-guide.html b/docs/streams/upgrade-guide.html&lt;br/&gt;
index 34f66ce53fe..35e1f77fd4c 100644&lt;br/&gt;
&amp;#8212; a/docs/streams/upgrade-guide.html&lt;br/&gt;
+++ b/docs/streams/upgrade-guide.html&lt;br/&gt;
@@ -90,6 +90,14 @@ &amp;lt;h1&amp;gt;Upgrade Guide and API Changes&amp;lt;/h1&amp;gt;&lt;br/&gt;
         We have also removed some public APIs that are deprecated prior to 1.0.x in 2.0.0.&lt;br/&gt;
         See below for a detailed list of removed APIs.&lt;br/&gt;
     &amp;lt;/p&amp;gt;&lt;br/&gt;
+    &amp;lt;h3&amp;gt;&amp;lt;a id=&quot;streams_api_changes_210&quot; href=&quot;#streams_api_changes_210&quot;&amp;gt;Streams API changes in 2.1.0&amp;lt;/a&amp;gt;&amp;lt;/h3&amp;gt;&lt;br/&gt;
+    &amp;lt;p&amp;gt;&lt;br/&gt;
+        We updated &amp;lt;code&amp;gt;TopologyDescription&amp;lt;/code&amp;gt; API to allow for better runtime checking.&lt;br/&gt;
+        Users are encouraged to use &amp;lt;code&amp;gt;#topicSet()&amp;lt;/code&amp;gt; and &amp;lt;code&amp;gt;#topicPattern()&amp;lt;/code&amp;gt; accordingly on &amp;lt;code&amp;gt;TopologyDescription.Source&amp;lt;/code&amp;gt; nodes,&lt;br/&gt;
+        instead of using &amp;lt;code&amp;gt;#topics()&amp;lt;/code&amp;gt;, which has since been deprecated. Similarly, use &amp;lt;code&amp;gt;#topic()&amp;lt;/code&amp;gt; and &amp;lt;code&amp;gt;#topicNameExtractor()&amp;lt;/code&amp;gt;&lt;br/&gt;
+        to get descriptions of &amp;lt;code&amp;gt;TopologyDescription.Sink&amp;lt;/code&amp;gt; nodes. For more details, see&lt;br/&gt;
+        &amp;lt;a href=&quot;https://cwiki.apache.org/confluence/display/KAFKA/KIP-321%3A+Update+TopologyDescription+to+better+represent+Source+and+Sink+Nodes&quot;&amp;gt;KIP-321&amp;lt;/a&amp;gt;.&lt;br/&gt;
+    &amp;lt;/p&amp;gt;&lt;/p&gt;

&lt;p&gt;     &amp;lt;h3&amp;gt;&amp;lt;a id=&quot;streams_api_changes_200&quot; href=&quot;#streams_api_changes_200&quot;&amp;gt;Streams API changes in 2.0.0&amp;lt;/a&amp;gt;&amp;lt;/h3&amp;gt;&lt;br/&gt;
     &amp;lt;p&amp;gt;&lt;br/&gt;
diff --git a/streams/src/main/java/org/apache/kafka/streams/TopologyDescription.java b/streams/src/main/java/org/apache/kafka/streams/TopologyDescription.java&lt;br/&gt;
index 04a292f9a97..870052d7399 100644&lt;br/&gt;
&amp;#8212; a/streams/src/main/java/org/apache/kafka/streams/TopologyDescription.java&lt;br/&gt;
+++ b/streams/src/main/java/org/apache/kafka/streams/TopologyDescription.java&lt;br/&gt;
@@ -16,9 +16,11 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.kafka.streams;&lt;/p&gt;

&lt;p&gt;+import org.apache.kafka.streams.processor.TopicNameExtractor;&lt;br/&gt;
 import org.apache.kafka.streams.processor.internals.StreamTask;&lt;/p&gt;

&lt;p&gt; import java.util.Set;&lt;br/&gt;
+import java.util.regex.Pattern;&lt;/p&gt;

&lt;p&gt; /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;A meta representation of a 
{@link Topology topology}
&lt;p&gt;.&lt;br/&gt;
@@ -113,8 +115,22 @@&lt;br/&gt;
         /**&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;The topic names this source node is reading from.&lt;/li&gt;
	&lt;li&gt;@return comma separated list of topic names or pattern (as String)&lt;br/&gt;
+         * @deprecated use 
{@link #topicSet()}
&lt;p&gt; or &lt;/p&gt;
{@link #topicPattern()}
&lt;p&gt; instead&lt;br/&gt;
          */&lt;br/&gt;
+        @Deprecated&lt;br/&gt;
         String topics();&lt;br/&gt;
+&lt;br/&gt;
+        /**&lt;br/&gt;
+         * The topic names this source node is reading from.&lt;br/&gt;
+         * @return a set of topic names&lt;br/&gt;
+         */&lt;br/&gt;
+        Set&amp;lt;String&amp;gt; topicSet();&lt;br/&gt;
+&lt;br/&gt;
+        /**&lt;br/&gt;
+         * The pattern used to match topic names that is reading from.&lt;br/&gt;
+         * @return the pattern used to match topic names&lt;br/&gt;
+         */&lt;br/&gt;
+        Pattern topicPattern();&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     /**&lt;br/&gt;
@@ -134,10 +150,17 @@&lt;br/&gt;
     interface Sink extends Node {&lt;br/&gt;
         /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The topic name this sink node is writing to.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* Could be null if the topic name can only be dynamically determined based on 
{@code TopicNameExtractor}
&lt;p&gt;+         * Could be &lt;/p&gt;
{@code null} if the topic name can only be dynamically determined based on {@link TopicNameExtractor}&lt;br/&gt;
          * @return a topic name&lt;br/&gt;
          */&lt;br/&gt;
         String topic();&lt;br/&gt;
+&lt;br/&gt;
+        /**&lt;br/&gt;
+         * The {@link TopicNameExtractor} class that this sink node uses to dynamically extract the topic name to write to.&lt;br/&gt;
+         * Could be {@code null}
&lt;p&gt; if the topic name is not dynamically determined.&lt;br/&gt;
+         * @return the &lt;/p&gt;
{@link TopicNameExtractor}
&lt;p&gt; class used get the topic name&lt;br/&gt;
+         */&lt;br/&gt;
+        TopicNameExtractor topicNameExtractor();&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     /**&lt;br/&gt;
diff --git a/streams/src/main/java/org/apache/kafka/streams/processor/internals/InternalTopologyBuilder.java b/streams/src/main/java/org/apache/kafka/streams/processor/internals/InternalTopologyBuilder.java&lt;br/&gt;
index 250105ad2a3..2944f6ba29b 100644&lt;br/&gt;
&amp;#8212; a/streams/src/main/java/org/apache/kafka/streams/processor/internals/InternalTopologyBuilder.java&lt;br/&gt;
+++ b/streams/src/main/java/org/apache/kafka/streams/processor/internals/InternalTopologyBuilder.java&lt;br/&gt;
@@ -282,15 +282,7 @@ private boolean isMatch(final String topic) {&lt;/p&gt;

&lt;p&gt;         @Override&lt;br/&gt;
         Source describe() {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String sourceTopics;&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;if (pattern == null) 
{
-                sourceTopics = topics.toString();
-            }
&lt;p&gt; else &lt;/p&gt;
{
-                sourceTopics = pattern.toString();
-            }
&lt;p&gt;-&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;return new Source(name, sourceTopics);&lt;br/&gt;
+            return new Source(name, new HashSet&amp;lt;&amp;gt;(topics), pattern);&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -1337,7 +1329,7 @@ public GlobalStore(final String sourceName,&lt;br/&gt;
                            final String storeName,&lt;br/&gt;
                            final String topicName,&lt;br/&gt;
                            final int id) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;source = new Source(sourceName, topicName);&lt;br/&gt;
+            source = new Source(sourceName, Collections.singleton(topicName), null);&lt;br/&gt;
             processor = new Processor(processorName, Collections.singleton(storeName));&lt;br/&gt;
             source.successors.add(processor);&lt;br/&gt;
             processor.predecessors.add(source);&lt;br/&gt;
@@ -1424,19 +1416,33 @@ public void addSuccessor(final TopologyDescription.Node successor) {&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     public final static class Source extends AbstractNode implements TopologyDescription.Source {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private final String topics;&lt;br/&gt;
+        private final Set&amp;lt;String&amp;gt; topics;&lt;br/&gt;
+        private final Pattern topicPattern;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         public Source(final String name,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String topics) {&lt;br/&gt;
+                      final Set&amp;lt;String&amp;gt; topics,&lt;br/&gt;
+                      final Pattern pattern) 
{
             super(name);
             this.topics = topics;
+            this.topicPattern = pattern;
         }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+        @Deprecated&lt;br/&gt;
         @Override&lt;br/&gt;
         public String topics() &lt;/p&gt;
{
+            return topics.toString();
+        }
&lt;p&gt;+&lt;br/&gt;
+        @Override&lt;br/&gt;
+        public Set&amp;lt;String&amp;gt; topicSet() &lt;/p&gt;
{
             return topics;
         }

&lt;p&gt;+        @Override&lt;br/&gt;
+        public Pattern topicPattern() &lt;/p&gt;
{
+            return topicPattern;
+        }
&lt;p&gt;+&lt;br/&gt;
         @Override&lt;br/&gt;
         public void addPredecessor(final TopologyDescription.Node predecessor) {&lt;br/&gt;
             throw new UnsupportedOperationException(&quot;Sources don&apos;t have predecessors.&quot;);&lt;br/&gt;
@@ -1444,7 +1450,9 @@ public void addPredecessor(final TopologyDescription.Node predecessor) {&lt;/p&gt;

&lt;p&gt;         @Override&lt;br/&gt;
         public String toString() &lt;/p&gt;
{
-            return &quot;Source: &quot; + name + &quot; (topics: &quot; + topics + &quot;)\n      --&amp;gt; &quot; + nodeNames(successors);
+            final String topicsString = topics == null ? topicPattern.toString() : topics.toString();
+            
+            return &quot;Source: &quot; + name + &quot; (topics: &quot; + topicsString + &quot;)\n      --&amp;gt; &quot; + nodeNames(successors);
         }

&lt;p&gt;         @Override&lt;br/&gt;
@@ -1459,13 +1467,14 @@ public boolean equals(final Object o) &lt;/p&gt;
{
             final Source source = (Source) o;
             // omit successor to avoid infinite loops
             return name.equals(source.name)
-                &amp;amp;&amp;amp; topics.equals(source.topics);
+                &amp;amp;&amp;amp; topics.equals(source.topics)
+                &amp;amp;&amp;amp; topicPattern.equals(source.topicPattern);
         }

&lt;p&gt;         @Override&lt;br/&gt;
         public int hashCode() &lt;/p&gt;
{
             // omit successor as it might change and alter the hash code
-            return Objects.hash(name, topics);
+            return Objects.hash(name, topics, topicPattern);
         }
&lt;p&gt;     }&lt;/p&gt;

&lt;p&gt;@@ -1528,10 +1537,20 @@ public Sink(final String name,&lt;/p&gt;

&lt;p&gt;         @Override&lt;br/&gt;
         public String topic() {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (topicNameExtractor instanceof StaticTopicNameExtractor)&lt;br/&gt;
+            if (topicNameExtractor instanceof StaticTopicNameExtractor) 
{
                 return ((StaticTopicNameExtractor) topicNameExtractor).topicName;
-            else
+            }
&lt;p&gt; else &lt;/p&gt;
{
                 return null;
+            }
&lt;p&gt;+        }&lt;br/&gt;
+&lt;br/&gt;
+        @Override&lt;br/&gt;
+        public TopicNameExtractor topicNameExtractor() &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+            if (topicNameExtractor instanceof StaticTopicNameExtractor) {
+                return null;
+            } else {
+                return topicNameExtractor;
+            }         }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         @Override&lt;br/&gt;
@@ -1541,7 +1560,10 @@ public void addSuccessor(final TopologyDescription.Node successor) {&lt;/p&gt;

&lt;p&gt;         @Override&lt;br/&gt;
         public String toString() {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return &quot;Sink: &quot; + name + &quot; (topic: &quot; + topic() + &quot;)\n      &amp;lt;-- &quot; + nodeNames(predecessors);&lt;br/&gt;
+            if (topicNameExtractor instanceof StaticTopicNameExtractor) 
{
+                return &quot;Sink: &quot; + name + &quot; (topic: &quot; + topic() + &quot;)\n      &amp;lt;-- &quot; + nodeNames(predecessors);
+            }
&lt;p&gt;+            return &quot;Sink: &quot; + name + &quot; (extractor class: &quot; + topicNameExtractor + &quot;)\n      &amp;lt;-- &quot; + nodeNames(predecessors);&lt;br/&gt;
         }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         @Override&lt;br/&gt;
diff --git a/streams/src/test/java/org/apache/kafka/streams/TopologyTest.java b/streams/src/test/java/org/apache/kafka/streams/TopologyTest.java&lt;br/&gt;
index ece157cd02e..eeb08ac1f95 100644&lt;br/&gt;
&amp;#8212; a/streams/src/test/java/org/apache/kafka/streams/TopologyTest.java&lt;br/&gt;
+++ b/streams/src/test/java/org/apache/kafka/streams/TopologyTest.java&lt;br/&gt;
@@ -27,6 +27,7 @@&lt;br/&gt;
 import org.apache.kafka.streams.processor.Processor;&lt;br/&gt;
 import org.apache.kafka.streams.processor.ProcessorContext;&lt;br/&gt;
 import org.apache.kafka.streams.processor.ProcessorSupplier;&lt;br/&gt;
+import org.apache.kafka.streams.processor.RecordContext;&lt;br/&gt;
 import org.apache.kafka.streams.processor.TopicNameExtractor;&lt;br/&gt;
 import org.apache.kafka.streams.processor.internals.InternalTopologyBuilder;&lt;br/&gt;
 import org.apache.kafka.streams.state.KeyValueStore;&lt;br/&gt;
@@ -370,6 +371,23 @@ public void shouldDescribeEmptyTopology() &lt;/p&gt;
{
         assertThat(topology.describe(), equalTo(expectedDescription));
     }&lt;br/&gt;
 &lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void sinkShouldReturnNullTopicWithDynamicRouting() {
+        final TopologyDescription.Sink expectedSinkNode
+                = new InternalTopologyBuilder.Sink(&quot;sink&quot;, (key, value, record) -&amp;gt; record.topic() + &quot;-&quot; + key);
+
+        assertThat(expectedSinkNode.topic(), equalTo(null));
+    }&lt;br/&gt;
+&lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void sinkShouldReturnTopicNameExtractorWithDynamicRouting() {
+        final TopicNameExtractor topicNameExtractor = (key, value, record) -&amp;gt; record.topic() + &quot;-&quot; + key;
+        final TopologyDescription.Sink expectedSinkNode
+                = new InternalTopologyBuilder.Sink(&quot;sink&quot;, topicNameExtractor);
+
+        assertThat(expectedSinkNode.topicNameExtractor(), equalTo(topicNameExtractor));
+    }&lt;br/&gt;
+&lt;br/&gt;
     @Test&lt;br/&gt;
     public void singleSourceShouldHaveSingleSubtopology() {&lt;br/&gt;
         final TopologyDescription.Source expectedSourceNode = addSource(&quot;source&quot;, &quot;topic&quot;);&lt;br/&gt;
@@ -629,6 +647,34 @@ public void shouldDescribeMultipleGlobalStoreTopology() {         assertThat(topology.describe(), equalTo(expectedDescription));     }

&lt;p&gt;+    @Test&lt;br/&gt;
+    public void topologyWithDynamicRoutingShouldDescribeExtractorClass() {&lt;br/&gt;
+        final StreamsBuilder builder  = new StreamsBuilder();&lt;br/&gt;
+&lt;br/&gt;
+        final TopicNameExtractor topicNameExtractor = new TopicNameExtractor() {&lt;br/&gt;
+            @Override&lt;br/&gt;
+            public String extract(final Object key, final Object value, final RecordContext recordContext) &lt;/p&gt;
{
+                return recordContext.topic() + &quot;-&quot; + key;
+            }
&lt;p&gt;+&lt;br/&gt;
+            @Override&lt;br/&gt;
+            public String toString() &lt;/p&gt;
{
+                return &quot;anonymous topic name extractor. topic is [recordContext.topic()]-[key]&quot;;
+            }
&lt;p&gt;+        };&lt;br/&gt;
+        builder.stream(&quot;input-topic&quot;).to(topicNameExtractor);&lt;br/&gt;
+        final TopologyDescription describe = builder.build().describe();&lt;br/&gt;
+&lt;br/&gt;
+        assertEquals(&lt;br/&gt;
+                &quot;Topologies:\n&quot; +&lt;br/&gt;
+                &quot;   Sub-topology: 0\n&quot; +&lt;br/&gt;
+                &quot;    Source: KSTREAM-SOURCE-0000000000 (topics: &lt;span class=&quot;error&quot;&gt;&amp;#91;input-topic&amp;#93;&lt;/span&gt;)\n&quot; +&lt;br/&gt;
+                &quot;      --&amp;gt; KSTREAM-SINK-0000000001\n&quot; +&lt;br/&gt;
+                &quot;    Sink: KSTREAM-SINK-0000000001 (extractor class: anonymous topic name extractor. topic is &lt;span class=&quot;error&quot;&gt;&amp;#91;recordContext.topic()&amp;#93;&lt;/span&gt;-&lt;span class=&quot;error&quot;&gt;&amp;#91;key&amp;#93;&lt;/span&gt;)\n&quot; +&lt;br/&gt;
+                &quot;      &amp;lt;-- KSTREAM-SOURCE-0000000000\n\n&quot;,&lt;br/&gt;
+                describe.toString());&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
     @Test&lt;br/&gt;
     public void kGroupedStreamZeroArgCountShouldPreserveTopologyStructure() {&lt;br/&gt;
         final StreamsBuilder builder = new StreamsBuilder();&lt;br/&gt;
@@ -1048,13 +1094,13 @@ public void kTableNamedMaterializedFilterShouldPreserveTopologyStructure() {&lt;br/&gt;
         for (int i = 1; i &amp;lt; sourceTopic.length; ++i) &lt;/p&gt;
{
             allSourceTopics.append(&quot;, &quot;).append(sourceTopic[i]);
         }
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return new InternalTopologyBuilder.Source(sourceName, allSourceTopics.toString());&lt;br/&gt;
+        return new InternalTopologyBuilder.Source(sourceName, new HashSet&amp;lt;&amp;gt;(Arrays.asList(sourceTopic)), null);&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     private TopologyDescription.Source addSource(final String sourceName,&lt;br/&gt;
                                                  final Pattern sourcePattern) &lt;/p&gt;
{
         topology.addSource(null, sourceName, null, null, null, sourcePattern);
-        return new InternalTopologyBuilder.Source(sourceName, sourcePattern.toString());
+        return new InternalTopologyBuilder.Source(sourceName, null, sourcePattern);
     }

&lt;p&gt;     private TopologyDescription.Processor addProcessor(final String processorName,&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13058361">KAFKA-4936</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 14 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3u9yn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>