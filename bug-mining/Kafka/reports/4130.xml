<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:42:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-17808] InstanceAlreadyExistsException: kafka.admin.client:type=app-info,id=connector-dlq-adminclient- when add connector with tasks</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-17808</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Why do we always create an admin client with the same &quot;connector-dlq-adminclient-&quot; value id?&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/Worker.java#L1008&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/Worker.java#L1008&lt;/a&gt;&lt;br/&gt;
For all other cases, a postfix is &#8203;&#8203;added.&lt;br/&gt;
&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13072235/13072235_image-2024-10-16-13-00-36-667.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;br/&gt;
&#160;I get &quot;Error registering AppInfo mbean&lt;br/&gt;
javax.management.InstanceAlreadyExistsException: kafka.admin.client:type=app-info,id=connector-dlq-adminclient-.&quot; error for all tasks.&lt;br/&gt;
It looks like the ConnectorTaskId should be added.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13595665">KAFKA-17808</key>
            <summary>InstanceAlreadyExistsException: kafka.admin.client:type=app-info,id=connector-dlq-adminclient- when add connector with tasks</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yung">Jhen-Yung Hsu</assignee>
                                    <reporter username="ignat233">ignat233</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Oct 2024 10:28:27 +0000</created>
                <updated>Tue, 11 Mar 2025 20:38:05 +0000</updated>
                            <resolved>Tue, 11 Mar 2025 20:38:04 +0000</resolved>
                                                    <fixVersion>4.1.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17890261" author="gharris1727" created="Wed, 16 Oct 2024 22:29:53 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ignat233&quot; class=&quot;user-hover&quot; rel=&quot;ignat233&quot;&gt;ignat233&lt;/a&gt; thanks for finding this, it looks like a typo.&lt;/p&gt;

&lt;p&gt;This adminclient is short-lived, just used for checking if the DLQ topic exists and creating it if not. That could be why this hasn&apos;t been found yet.&lt;/p&gt;

&lt;p&gt;Are you able to open a PR to fix this by appending the connector name?&lt;/p&gt;</comment>
                            <comment id="17890846" author="muralibasani" created="Fri, 18 Oct 2024 08:00:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ignat233&quot; class=&quot;user-hover&quot; rel=&quot;ignat233&quot;&gt;ignat233&lt;/a&gt; If it&apos;s ok with you, I can pick up this change.&lt;/p&gt;</comment>
                            <comment id="17890895" author="JIRAUSER307421" created="Fri, 18 Oct 2024 09:58:33 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=muralibasani&quot; class=&quot;user-hover&quot; rel=&quot;muralibasani&quot;&gt;muralibasani&lt;/a&gt; ,&lt;br/&gt;
I will do this task myself.&lt;/p&gt;</comment>
                            <comment id="17890896" author="muralibasani" created="Fri, 18 Oct 2024 10:03:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ignat233&quot; class=&quot;user-hover&quot; rel=&quot;ignat233&quot;&gt;ignat233&lt;/a&gt; sure. I closed the pr.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="17891008" author="gharris1727" created="Fri, 18 Oct 2024 16:10:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ignat233&quot; class=&quot;user-hover&quot; rel=&quot;ignat233&quot;&gt;ignat233&lt;/a&gt; I&apos;ve added you as a contributor so that you are able to assign issues to yourself. I also assigned you to this ticket.&lt;/p&gt;

&lt;p&gt;Thanks for contributing! Please also consider subscribing to the mailing lists if you aren&apos;t already: &lt;a href=&quot;https://kafka.apache.org/contact&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://kafka.apache.org/contact&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17904146" author="JIRAUSER307421" created="Mon, 9 Dec 2024 12:55:51 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gharris1727&quot; class=&quot;user-hover&quot; rel=&quot;gharris1727&quot;&gt;gharris1727&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Unfortunately, I can&apos;t create a PR. Please appoint someone so that the process is not delayed. &lt;br/&gt;
And yes, I think in this case it would be more correct to add the task id. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;connector-dlq-adminclient-&quot;&lt;/span&gt; + id
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When adding connector name, the same error may occur.&lt;/p&gt;</comment>
                            <comment id="17931791" author="JIRAUSER307316" created="Sun, 2 Mar 2025 08:13:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=muralibasani&quot; class=&quot;user-hover&quot; rel=&quot;muralibasani&quot;&gt;muralibasani&lt;/a&gt; Thanks for the contribution. Do you have time to revisit this? Otherwise, I&apos;d like to continue this PR and add some tests.&lt;br/&gt;
&#160;&lt;/p&gt;</comment>
                            <comment id="17931929" author="muralibasani" created="Mon, 3 Mar 2025 10:39:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yung&quot; class=&quot;user-hover&quot; rel=&quot;yung&quot;&gt;yung&lt;/a&gt; thanks for asking.&lt;/p&gt;

&lt;p&gt;It would be great if you can take over. Currently stuck with other things.&lt;/p&gt;</comment>
                            <comment id="17932554" author="JIRAUSER307316" created="Wed, 5 Mar 2025 08:56:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ignat233&quot; class=&quot;user-hover&quot; rel=&quot;ignat233&quot;&gt;ignat233&lt;/a&gt; Could you provide the steps to reproduce the error `Error registering AppInfo mbean&lt;br/&gt;
javax.management.InstanceAlreadyExistsException: kafka.admin.client:type=app-info,id=connector-dlq-adminclient-`?&lt;/p&gt;

&lt;p&gt;This will help me verify that the fix and test case work and cover our target.&lt;/p&gt;


&lt;p&gt;I was only able to see this message in the log with the following modification&lt;br/&gt;
log:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
cat logs/connect.log| grep -ri connector-dlq-adminclient-   
logs/connect.log:       client.id = connector-dlq-adminclient-
logs/connect.log:       client.id = connector-dlq-adminclient-
logs/connect.log:[2025-03-05 03:51:55,766] INFO [local-file-sink|task-1] The mbean of App info: [kafka.admin.client], id: [connector-dlq-adminclient-] already exists, so skipping a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; mbean creation. (org.apache.kafka.common.utils.AppInfoParser:66)
logs/connect.log:[2025-03-05 03:51:55,768] INFO App info kafka.admin.client &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; connector-dlq-adminclient- unregistered (org.apache.kafka.common.utils.AppInfoParser:89)
logs/connect.log:[2025-03-05 03:51:55,770] INFO App info kafka.admin.client &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; connector-dlq-adminclient- unregistered (org.apache.kafka.common.utils.AppInfoParser:89) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
config/connect-file-sink.properties (enabling dlq):&lt;br/&gt;
&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
name=local-file-sink
connector.class=FileStreamSink
-tasks.max=1
+tasks.max=2
file=test.sink.txt
topics=connect-test

+errors.deadletterqueue.topic.name=dlq-topic
+errors.deadletterqueue.context.headers.enable=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
+errors.deadletterqueue.topic.replication.factor=1
+errors.tolerance=all &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;


&lt;p&gt;Then, running:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
bin/connect-standalone.sh config/connect-standalone.properties config/connect-file-sink.properties&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;



&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17933701" author="JIRAUSER307316" created="Mon, 10 Mar 2025 02:35:37 +0000"  >&lt;p&gt;Since the admin is not exposed, it is hard to write a unit test to check the ID.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/errors/DeadLetterQueueReporter.java#L84-L89&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/errors/DeadLetterQueueReporter.java#L84-L89&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So, I clipped the log to verify the fix in the PR. PTAL.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13073457">KAFKA-5295</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13072235" name="image-2024-10-16-13-00-36-667.png" size="18557" author="ignat233" created="Wed, 16 Oct 2024 10:00:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            35 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1s10o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>