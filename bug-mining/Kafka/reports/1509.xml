<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:01:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-5211] KafkaConsumer should not skip a corrupted record after throwing an exception.</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-5211</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;In 0.10.2, when there is a corrupted record, KafkaConsumer.poll() will throw an exception and block on that corrupted record. In the latest trunk this behavior has changed to skip the corrupted record (which is the old consumer behavior). With KIP-98, skipping corrupted messages would be a little dangerous as the message could be a control message for a transaction. We should fix the issue to let the KafkaConsumer block on the corrupted messages.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13070920">KAFKA-5211</key>
            <summary>KafkaConsumer should not skip a corrupted record after throwing an exception.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="becket_qin">Jiangjie Qin</assignee>
                                    <reporter username="becket_qin">Jiangjie Qin</reporter>
                        <labels>
                            <label>clients</label>
                            <label>consumer</label>
                    </labels>
                <created>Wed, 10 May 2017 19:04:44 +0000</created>
                <updated>Wed, 31 May 2017 06:00:18 +0000</updated>
                            <resolved>Wed, 31 May 2017 05:59:28 +0000</resolved>
                                                    <fixVersion>0.11.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16019183" author="githubbot" created="Mon, 22 May 2017 06:27:54 +0000"  >&lt;p&gt;GitHub user becketqin opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3114&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5211&quot; title=&quot;KafkaConsumer should not skip a corrupted record after throwing an exception.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5211&quot;&gt;&lt;del&gt;KAFKA-5211&lt;/del&gt;&lt;/a&gt;: Do not skip a corrupted record in consumer&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/becketqin/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/becketqin/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5211&quot; title=&quot;KafkaConsumer should not skip a corrupted record after throwing an exception.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5211&quot;&gt;&lt;del&gt;KAFKA-5211&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3114.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3114.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3114&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit e15530c262b4fc4727e61656f22881642d5e5049&lt;br/&gt;
Author: Jiangjie Qin &amp;lt;becket.qin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-05-22T06:24:22Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5211&quot; title=&quot;KafkaConsumer should not skip a corrupted record after throwing an exception.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5211&quot;&gt;&lt;del&gt;KAFKA-5211&lt;/del&gt;&lt;/a&gt;: Do not skip a corrupted record in consumer&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16022824" author="enothereska" created="Wed, 24 May 2017 12:40:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=becket_qin&quot; class=&quot;user-hover&quot; rel=&quot;becket_qin&quot;&gt;becket_qin&lt;/a&gt; I think this change needs a KIP. There have been several JIRAs like &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5078&quot; title=&quot;PartitionRecords.fetchRecords(...) should defer exception to the next call if iterator has already moved across any valid record&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5078&quot;&gt;&lt;del&gt;KAFKA-5078&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4740&quot; title=&quot;Using new consumer API with a Deserializer that throws SerializationException can lead to infinite loop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4740&quot;&gt;KAFKA-4740&lt;/a&gt; etc that have a lot of discussion on the PR. I personally haven&apos;t understood the ramifications of these changes. They affect users since they need to know what to do in case bad data is in the pipeline. Could you prepare a KIP on this? Thanks.&lt;/p&gt;</comment>
                            <comment id="16023641" author="becket_qin" created="Wed, 24 May 2017 20:33:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enothereska&quot; class=&quot;user-hover&quot; rel=&quot;enothereska&quot;&gt;enothereska&lt;/a&gt; I think a KIP is only required if there is a public API change or user sensible behavior change. &lt;/p&gt;

&lt;p&gt;Some clarification regarding this ticket, in 0.10.2.1 the consumer does not skip over a corrupted message. A refactor at some point after that changed the behavior to skip over the corrupted messages without a KIP. We are changing the behavior back to be the same as 0.10.2.1 to avoid user sensible behavior change. So I don&apos;t think a KIP is required for this ticket.&lt;/p&gt;</comment>
                            <comment id="16023656" author="ijuma" created="Wed, 24 May 2017 20:46:00 +0000"  >&lt;p&gt;This particular JIRA doesn&apos;t need a KIP because it&apos;s indeed just restoring the behaviour in trunk to match the behaviour from previous releases. We do need a KIP if we want to change how we handle errors during deserialization and such.&lt;/p&gt;</comment>
                            <comment id="16024066" author="hachikuji" created="Thu, 25 May 2017 02:21:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enothereska&quot; class=&quot;user-hover&quot; rel=&quot;enothereska&quot;&gt;enothereska&lt;/a&gt; Looking toward the future, it would be good to get your take on what the ideal behavior would be for Kafka streams. Thanks to some of the improvements in this release cycle, the current &quot;intended&quot; semantics may now actually be usable (which wasn&apos;t the case before-as is apparent from the discussion in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4740&quot; title=&quot;Using new consumer API with a Deserializer that throws SerializationException can lead to infinite loop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4740&quot;&gt;KAFKA-4740&lt;/a&gt;). When we raise an exception from parsing or record corruption, the consumer&apos;s position should now be pointing to the offset of the record that failed parsing, which means the user can seek past it if they wish. Because of the reasons mentioned by Becket in the description, I don&apos;t think it will be safe to proactively skip past a corrupt record-at least not without refetching the data--but it may be possible for parsing errors. It has also been proposed to move parsing out of the consumer entirely (see &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-1895&quot; title=&quot;Investigate moving deserialization and decompression out of KafkaConsumer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-1895&quot;&gt;KAFKA-1895&lt;/a&gt;), which would neatly solve part of the problem, but would likely require a KIP. Given the short horizon for this release, however, Becket&apos;s patch is probably the way to go for now.&lt;/p&gt;</comment>
                            <comment id="16024372" author="enothereska" created="Thu, 25 May 2017 08:04:08 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=becket_qin&quot; class=&quot;user-hover&quot; rel=&quot;becket_qin&quot;&gt;becket_qin&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ijuma&quot; class=&quot;user-hover&quot; rel=&quot;ijuma&quot;&gt;ijuma&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hachikuji&quot; class=&quot;user-hover&quot; rel=&quot;hachikuji&quot;&gt;hachikuji&lt;/a&gt;. Makes sense that this JIRA doesn&apos;t need a KIP and that for the future we&apos;ll consider a KIP if we change things. I&apos;ll do a KIP for streams-specific changes (that don&apos;t touch the Kafka protocol) and we can have some discussion as part of that KIP. Thanks.&lt;/p&gt;</comment>
                            <comment id="16026977" author="guozhang" created="Fri, 26 May 2017 22:43:01 +0000"  >&lt;p&gt;For this specific issue, Streams should be independent of whichever behavior in Consumer since Streams always use the &lt;tt&gt;Consumer&amp;lt;byte[], byte[]&amp;gt;&lt;/tt&gt; and perform deserialization after polling the records. This is because embedded consumer within Streams would probably fetch from topics with different serde mechanisms, so it need to deserialize based on the topics.&lt;/p&gt;</comment>
                            <comment id="16030682" author="hachikuji" created="Wed, 31 May 2017 05:59:28 +0000"  >&lt;p&gt;Issue resolved by pull request 3114&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/3114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3114&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16030683" author="githubbot" created="Wed, 31 May 2017 06:00:18 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3114&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3eskf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>