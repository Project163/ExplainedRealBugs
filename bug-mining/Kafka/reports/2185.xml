<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:17:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-7288] Transient failure in SslSelectorTest.testCloseConnectionInClosingState</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-7288</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Noticed this failure in SslSelectorTest.testCloseConnectionInClosingState a few times in unit tests in Jenkins:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;java.lang.AssertionError: Channel not expired expected null, but was:&amp;lt;org.apache.kafka.common.network.KafkaChannel@4f&amp;gt; at org.junit.Assert.fail(Assert.java:88) at org.junit.Assert.failNotNull(Assert.java:755) at org.junit.Assert.assertNull(Assert.java:737) at org.apache.kafka.common.network.SelectorTest.testCloseConnectionInClosingState(SelectorTest.java:341)&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="13178834">KAFKA-7288</key>
            <summary>Transient failure in SslSelectorTest.testCloseConnectionInClosingState</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rsivaram">Rajini Sivaram</assignee>
                                    <reporter username="rsivaram">Rajini Sivaram</reporter>
                        <labels>
                            <label>flaky-test</label>
                    </labels>
                <created>Tue, 14 Aug 2018 12:09:31 +0000</created>
                <updated>Sat, 9 Mar 2019 08:16:27 +0000</updated>
                            <resolved>Sat, 9 Mar 2019 08:16:27 +0000</resolved>
                                    <version>2.3.0</version>
                                    <fixVersion>2.2.0</fixVersion>
                                    <component>unit tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16579714" author="githubbot" created="Tue, 14 Aug 2018 12:14:29 +0000"  >&lt;p&gt;rajinisivaram opened a new pull request #5504: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7288&quot; title=&quot;Transient failure in SslSelectorTest.testCloseConnectionInClosingState&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7288&quot;&gt;&lt;del&gt;KAFKA-7288&lt;/del&gt;&lt;/a&gt;: Fix for SslSelectorTest.testCloseConnectionInClosingState&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5504&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5504&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Ensure that sends are completed before waiting for channel to be closed based on idle expiry, since channel will not be expired if added to ready keys in the next poll as a result of pending sends.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16580819" author="githubbot" created="Wed, 15 Aug 2018 08:05:33 +0000"  >&lt;p&gt;rajinisivaram closed pull request #5504: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7288&quot; title=&quot;Transient failure in SslSelectorTest.testCloseConnectionInClosingState&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7288&quot;&gt;&lt;del&gt;KAFKA-7288&lt;/del&gt;&lt;/a&gt;: Fix for SslSelectorTest.testCloseConnectionInClosingState&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5504&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5504&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/clients/src/test/java/org/apache/kafka/common/network/SelectorTest.java b/clients/src/test/java/org/apache/kafka/common/network/SelectorTest.java&lt;br/&gt;
index 3bb6244715e..cfd7fb3af8d 100644&lt;br/&gt;
&amp;#8212; a/clients/src/test/java/org/apache/kafka/common/network/SelectorTest.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/common/network/SelectorTest.java&lt;br/&gt;
@@ -418,7 +418,9 @@ private KafkaChannel createConnectionWithStagedReceives(int maxStagedReceives) t&lt;br/&gt;
             selector.mute(id);&lt;br/&gt;
             for (int i = 0; i &amp;lt;= maxStagedReceives; i++) {&lt;br/&gt;
                 selector.send(createSend(id, String.valueOf&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;));&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;selector.poll(1000);&lt;br/&gt;
+                do 
{
+                    selector.poll(1000);
+                }
&lt;p&gt; while (selector.completedSends().isEmpty());&lt;br/&gt;
             }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;             selector.unmute(id);&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16778667" author="mjsax" created="Tue, 26 Feb 2019 22:59:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rsivaram&quot; class=&quot;user-hover&quot; rel=&quot;rsivaram&quot;&gt;rsivaram&lt;/a&gt; This happened again in `2.0` branch: &lt;a href=&quot;https://builds.apache.org/blue/organizations/jenkins/kafka-2.0-jdk8/detail/kafka-2.0-jdk8/230/tests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/blue/organizations/jenkins/kafka-2.0-jdk8/detail/kafka-2.0-jdk8/230/tests&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Can you back port the fix to `2.0` ?&lt;/p&gt;</comment>
                            <comment id="16781378" author="mjsax" created="Fri, 1 Mar 2019 07:22:25 +0000"  >&lt;p&gt;Seems not to be fixed: &lt;a href=&quot;https://builds.apache.org/blue/organizations/jenkins/kafka-trunk-jdk8/detail/kafka-trunk-jdk8/3425/tests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/blue/organizations/jenkins/kafka-trunk-jdk8/detail/kafka-trunk-jdk8/3425/tests&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;java.lang.AssertionError: Channel not expired expected null, but was:&amp;lt;org.apache.kafka.common.network.KafkaChannel@4f id=0&amp;gt;&lt;br/&gt;
at org.junit.Assert.fail(Assert.java:89)&lt;br/&gt;
at org.junit.Assert.failNotNull(Assert.java:756)&lt;br/&gt;
at org.junit.Assert.assertNull(Assert.java:738)&lt;br/&gt;
at org.apache.kafka.common.network.SelectorTest.testCloseConnectionInClosingState(SelectorTest.java:343)&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="16782244" author="mjsax" created="Sat, 2 Mar 2019 01:39:11 +0000"  >&lt;p&gt;Failed again:&#160;&lt;a href=&quot;https://builds.apache.org/blue/organizations/jenkins/kafka-trunk-jdk8/detail/kafka-trunk-jdk8/3429/tests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/blue/organizations/jenkins/kafka-trunk-jdk8/detail/kafka-trunk-jdk8/3429/tests&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16786612" author="githubbot" created="Thu, 7 Mar 2019 10:44:36 +0000"  >&lt;p&gt;rajinisivaram commented on pull request #6390: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7288&quot; title=&quot;Transient failure in SslSelectorTest.testCloseConnectionInClosingState&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7288&quot;&gt;&lt;del&gt;KAFKA-7288&lt;/del&gt;&lt;/a&gt; - Make sure no bytes buffered when relying on idle timeout in channel close test&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/6390&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/6390&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   SelectorTest.testCloseConnectionInClosingState sends and receives messages to get the channel into a state with staged receives and then waits for idle timeout to close the channel. When run with SSL, the channel may have buffered bytes that prevent the channel from being closed. Updated the test to wait until there are no buffered bytes as well. I have left the number of retries to achieve this state at 100, since my local runs always succeed the first time.&lt;/p&gt;

&lt;p&gt;   I wasn&apos;t able to recreate the failure with or without the fix.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16787050" author="githubbot" created="Thu, 7 Mar 2019 18:09:53 +0000"  >&lt;p&gt;rajinisivaram commented on pull request #6390: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7288&quot; title=&quot;Transient failure in SslSelectorTest.testCloseConnectionInClosingState&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7288&quot;&gt;&lt;del&gt;KAFKA-7288&lt;/del&gt;&lt;/a&gt; - Make sure no bytes buffered when relying on idle timeout in channel close test&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/6390&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/6390&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16788140" author="mjsax" created="Fri, 8 Mar 2019 18:12:47 +0000"  >&lt;p&gt;Updating fixed version from 2.2.1 to 2.2.0 because we cut a new RC.&lt;/p&gt;</comment>
                            <comment id="16788299" author="githubbot" created="Fri, 8 Mar 2019 21:03:12 +0000"  >&lt;p&gt;rajinisivaram commented on pull request #6415: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7288&quot; title=&quot;Transient failure in SslSelectorTest.testCloseConnectionInClosingState&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7288&quot;&gt;&lt;del&gt;KAFKA-7288&lt;/del&gt;&lt;/a&gt;; Fix check in SelectorTest to wait for no buffered bytes&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/6415&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/6415&lt;/a&gt;&lt;/p&gt;



&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16788303" author="rsivaram" created="Fri, 8 Mar 2019 21:06:50 +0000"  >&lt;p&gt;The check added to fix this issue was wrong, submitted new PR to fix properly.&lt;/p&gt;</comment>
                            <comment id="16788572" author="githubbot" created="Sat, 9 Mar 2019 08:09:59 +0000"  >&lt;p&gt;rajinisivaram commented on pull request #6415: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7288&quot; title=&quot;Transient failure in SslSelectorTest.testCloseConnectionInClosingState&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7288&quot;&gt;&lt;del&gt;KAFKA-7288&lt;/del&gt;&lt;/a&gt;; Fix check in SelectorTest to wait for no buffered bytes&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/6415&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/6415&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 36 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3x0zz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>junrao</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>