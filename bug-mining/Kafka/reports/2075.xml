<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:15:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-6764] ConsoleConsumer behavior inconsistent when specifying --partition with --from-beginning </title>
                <link>https://issues.apache.org/jira/browse/KAFKA-6764</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Per its usage statement, &lt;tt&gt;kafka-console-consumer.sh&lt;/tt&gt; ignores&#160;&lt;tt&gt;&amp;#45;&amp;#45;from-beginning&lt;/tt&gt; when the specified consumer group has committed offsets, and sets &lt;tt&gt;auto.offset.reset&lt;/tt&gt; to &lt;tt&gt;latest&lt;/tt&gt;. However, if &lt;tt&gt;&amp;#45;&amp;#45;partition&lt;/tt&gt; is also specified, &lt;tt&gt;&amp;#45;&amp;#45;from-beginning&lt;/tt&gt; is observed in all cases, whether there are committed offsets or not.&lt;/p&gt;

&lt;p&gt;This happens because when &lt;tt&gt;&amp;#45;&amp;#45;from-beginning&lt;/tt&gt; is specified, &lt;tt&gt;offsetArg&lt;/tt&gt; is set to &lt;tt&gt;OffsetRequest.EarliestTime&lt;/tt&gt;. However, &lt;tt&gt;offsetArg&lt;/tt&gt; is &lt;a href=&quot;https://github.com/apache/kafka/blob/fedac0cea74feeeece529ee1c0cefd6af53ecbdd/core/src/main/scala/kafka/tools/ConsoleConsumer.scala#L76-L79&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;only passed to the constructor&lt;/a&gt; for &lt;tt&gt;NewShinyConsumer&lt;/tt&gt; when &lt;tt&gt;&amp;#45;&amp;#45;partition&lt;/tt&gt; is also specified. Hence, it is honored in this case and not the other.&lt;/p&gt;

&lt;p&gt;This case should either be handled consistently, or the usage statement should be modified to indicate the actual behavior/usage. &lt;/p&gt;</description>
                <environment></environment>
        <key id="13150823">KAFKA-6764</key>
            <summary>ConsoleConsumer behavior inconsistent when specifying --partition with --from-beginning </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="mcqueary">Larry McQueary</assignee>
                                    <reporter username="mcqueary">Larry McQueary</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Sun, 8 Apr 2018 04:07:01 +0000</created>
                <updated>Fri, 24 Jul 2020 10:50:23 +0000</updated>
                                                                            <component>consumer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16609249" author="sumannewton" created="Mon, 10 Sep 2018 14:00:33 +0000"  >&lt;p&gt;consumer.subscribe() should be called whenever group id is specified no matter whether partition/offset is specified or not. If partition/offset is specified, then it should be seek(TopicPartition) accordingly. &lt;br/&gt;
Console-consumer without group id can be assigned partition/offset based on config specifed. Unless specified, subscribe() is honoured in current scenario.&#160;That provides consistent behaviour as follows:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;With group-id, always subscribe and auto-assign. Seek based on partition/offset config(Not sure if seek should be supported console-consumer when a group-id is specified). Because assign() and subscribe() can&apos;t be used together for the same topic-consumer-group combination&lt;/li&gt;
	&lt;li&gt;Without group-id (Auto Commit Offset is always disabled):
	&lt;ul&gt;
		&lt;li&gt;Partition/Offset specified, then assign.&lt;/li&gt;
		&lt;li&gt;Partition/Offset not specified, then subscribe.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Correct me if I am wrong.&lt;/p&gt;</comment>
                            <comment id="16610188" author="githubbot" created="Tue, 11 Sep 2018 07:14:51 +0000"  >&lt;p&gt;sumannewton opened a new pull request #5637: Fixed &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6764&quot; title=&quot;ConsoleConsumer behavior inconsistent when specifying --partition with --from-beginning &quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6764&quot;&gt;KAFKA-6764&lt;/a&gt;; Update usage for console-consumer whitelist option&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5637&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5637&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   *Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6764&quot; title=&quot;ConsoleConsumer behavior inconsistent when specifying --partition with --from-beginning &quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6764&quot;&gt;KAFKA-6764&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6764).*&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-6764).*&lt;/a&gt;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;With group-id, always subscribe() and auto-assign. Seek based on partition/offset config(Not sure if seek should be supported console-consumer when a group-id is specified. Because assign() and subscribe() can&apos;t be used together for the same topic-consumer-group combination)&lt;/li&gt;
	&lt;li&gt;Without group-id (Auto Commit Offset is always disabled):&lt;/li&gt;
	&lt;li&gt;Partition/Offset specified, then assign.&lt;/li&gt;
	&lt;li&gt;Partition/Offset not specified, then subscribe.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   Correct if I am wrong.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16628748" author="sumannewton" created="Wed, 26 Sep 2018 13:14:12 +0000"  >&lt;p&gt;Fixed. Pull request is &lt;a href=&quot;https://github.com/apache/kafka/pull/5637&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5637&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16651075" author="githubbot" created="Tue, 16 Oct 2018 03:14:20 +0000"  >&lt;p&gt;cmccabe closed pull request #5637: MINOR : Fixed &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6764&quot; title=&quot;ConsoleConsumer behavior inconsistent when specifying --partition with --from-beginning &quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6764&quot;&gt;KAFKA-6764&lt;/a&gt;; Update usage for console-consumer whitelist option&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5637&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5637&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/core/src/main/scala/kafka/tools/ConsoleConsumer.scala b/core/src/main/scala/kafka/tools/ConsoleConsumer.scala&lt;br/&gt;
index 365652a75b5..06705d59219 100755&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/tools/ConsoleConsumer.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/tools/ConsoleConsumer.scala&lt;br/&gt;
@@ -65,6 +65,7 @@ object ConsoleConsumer extends Logging {&lt;br/&gt;
   def run(conf: ConsumerConfig) {&lt;br/&gt;
     val timeoutMs = if (conf.timeoutMs &amp;gt;= 0) conf.timeoutMs else Long.MaxValue&lt;br/&gt;
     val consumer = new KafkaConsumer(consumerProps(conf), new ByteArrayDeserializer, new ByteArrayDeserializer)&lt;br/&gt;
+&lt;br/&gt;
     val consumerWrapper =&lt;br/&gt;
       if (conf.partitionArg.isDefined)&lt;br/&gt;
         new ConsumerWrapper(Option(conf.topicArg), conf.partitionArg, Option(conf.offsetArg), None, consumer, timeoutMs)&lt;br/&gt;
@@ -194,7 +195,7 @@ object ConsoleConsumer extends Logging {&lt;br/&gt;
       .withRequiredArg&lt;br/&gt;
       .describedAs(&quot;topic&quot;)&lt;br/&gt;
       .ofType(classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val whitelistOpt = parser.accepts(&quot;whitelist&quot;, &quot;Whitelist of topics to include for consumption.&quot;)&lt;br/&gt;
+    val whitelistOpt = parser.accepts(&quot;whitelist&quot;, &quot;Regular expression specifying whitelist of topics to include for consumption.&quot;)&lt;br/&gt;
       .withRequiredArg&lt;br/&gt;
       .describedAs(&quot;whitelist&quot;)&lt;br/&gt;
       .ofType(classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;)&lt;br/&gt;
@@ -355,7 +356,7 @@ object ConsoleConsumer extends Logging {&lt;br/&gt;
     val groupIdsProvided = Set(&lt;br/&gt;
       Option(options.valueOf(groupIdOpt)), // via --group&lt;br/&gt;
       Option(consumerProps.get(ConsumerConfig.GROUP_ID_CONFIG)), // via --consumer-property&lt;/li&gt;
	&lt;li&gt;Option(extraConsumerProps.get(ConsumerConfig.GROUP_ID_CONFIG)) // via --cosumer.config&lt;br/&gt;
+      Option(extraConsumerProps.get(ConsumerConfig.GROUP_ID_CONFIG)) // via --consumer.config&lt;br/&gt;
     ).flatten&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     if (groupIdsProvided.size &amp;gt; 1) {&lt;br/&gt;
@@ -376,6 +377,9 @@ object ConsoleConsumer extends Logging &lt;/p&gt;
{
         groupIdPassed = false
     }

&lt;p&gt;+    if (groupIdPassed &amp;amp;&amp;amp; partitionArg.isDefined)&lt;br/&gt;
+      CommandLineUtils.printUsageAndDie(parser, &quot;Options group and partition cannot be specified together.&quot;)&lt;br/&gt;
+&lt;br/&gt;
     def tryParse(parser: OptionParser, args: Array&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;): OptionSet = {&lt;br/&gt;
       try&lt;br/&gt;
         parser.parse(args: _*)&lt;br/&gt;
diff --git a/core/src/test/scala/unit/kafka/tools/ConsoleConsumerTest.scala b/core/src/test/scala/unit/kafka/tools/ConsoleConsumerTest.scala&lt;br/&gt;
index 47b7fae3d9b..cdc146f3666 100644&lt;br/&gt;
&amp;#8212; a/core/src/test/scala/unit/kafka/tools/ConsoleConsumerTest.scala&lt;br/&gt;
+++ b/core/src/test/scala/unit/kafka/tools/ConsoleConsumerTest.scala&lt;br/&gt;
@@ -432,4 +432,67 @@ class ConsoleConsumerTest &lt;/p&gt;
{
     assertTrue(formatter.keyDeserializer.get.asInstanceOf[MockDeserializer].isKey)
   }

&lt;p&gt;+  @Test&lt;br/&gt;
+  def shouldParseGroupIdFromBeginningGivenTogether() &lt;/p&gt;
{
+    // Start from earliest
+    var args: Array[String] = Array(
+      &quot;--bootstrap-server&quot;, &quot;localhost:9092&quot;,
+      &quot;--topic&quot;, &quot;test&quot;,
+      &quot;--group&quot;, &quot;test-group&quot;,
+      &quot;--from-beginning&quot;)
+
+    var config = new ConsoleConsumer.ConsumerConfig(args)
+    assertEquals(&quot;localhost:9092&quot;, config.bootstrapServer)
+    assertEquals(&quot;test&quot;, config.topicArg)
+    assertEquals(-2, config.offsetArg)
+    assertEquals(true, config.fromBeginning)
+
+    // Start from latest
+    args = Array(
+      &quot;--bootstrap-server&quot;, &quot;localhost:9092&quot;,
+      &quot;--topic&quot;, &quot;test&quot;,
+      &quot;--group&quot;, &quot;test-group&quot;
+    )
+
+    config = new ConsoleConsumer.ConsumerConfig(args)
+    assertEquals(&quot;localhost:9092&quot;, config.bootstrapServer)
+    assertEquals(&quot;test&quot;, config.topicArg)
+    assertEquals(-1, config.offsetArg)
+    assertEquals(false, config.fromBeginning)
+  }
&lt;p&gt;+&lt;br/&gt;
+  @Test(expected = classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;IllegalArgumentException&amp;#93;&lt;/span&gt;)&lt;br/&gt;
+  def shouldExitOnGroupIdAndPartitionGivenTogether() {&lt;br/&gt;
+    Exit.setExitProcedure((_, message) =&amp;gt; throw new IllegalArgumentException(message.orNull))&lt;br/&gt;
+    //Given&lt;br/&gt;
+    val args: Array&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; = Array(&lt;br/&gt;
+      &quot;--bootstrap-server&quot;, &quot;localhost:9092&quot;,&lt;br/&gt;
+      &quot;--topic&quot;, &quot;test&quot;,&lt;br/&gt;
+      &quot;--group&quot;, &quot;test-group&quot;,&lt;br/&gt;
+      &quot;--partition&quot;, &quot;0&quot;)&lt;br/&gt;
+&lt;br/&gt;
+    //When&lt;br/&gt;
+    try &lt;/p&gt;
{
+      new ConsoleConsumer.ConsumerConfig(args)
+    } finally {
+      Exit.resetExitProcedure()
+    }&lt;br/&gt;
+  }&lt;br/&gt;
+&lt;br/&gt;
+  @Test(expected = classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;IllegalArgumentException&amp;#93;&lt;/span&gt;)&lt;br/&gt;
+  def shouldExitOnOffsetWithoutPartition() {&lt;br/&gt;
+    Exit.setExitProcedure((_, message) =&amp;gt; throw new IllegalArgumentException(message.orNull))&lt;br/&gt;
+    //Given&lt;br/&gt;
+    val args: Array&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; = Array(&lt;br/&gt;
+      &quot;--bootstrap-server&quot;, &quot;localhost:9092&quot;,&lt;br/&gt;
+      &quot;--topic&quot;, &quot;test&quot;,&lt;br/&gt;
+      &quot;--offset&quot;, &quot;10&quot;)&lt;br/&gt;
+&lt;br/&gt;
+    //When&lt;br/&gt;
+    try {+      new ConsoleConsumer.ConsumerConfig(args)+    }
&lt;p&gt; finally &lt;/p&gt;
{
+      Exit.resetExitProcedure()
+    }
&lt;p&gt;+  }&lt;br/&gt;
 }&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="17164370" author="pardhu" created="Fri, 24 Jul 2020 10:50:23 +0000"  >&lt;p&gt;I am observing this behavior with kafka broker with SSL enabled even with a new consumer group also. I produced a few messages. Then I created a new consumer with a new group. Then&#160;&lt;b&gt;kafka-console-consumer -&lt;del&gt;from-beginning&lt;/b&gt;&#160;is not displaying any messages. But when I tried with&#160;&lt;b&gt;&lt;/del&gt;-partition 0&lt;/b&gt;&#160;I could see it reading the messages.&lt;/p&gt;

&lt;p&gt;Then I killed my broker with ssl and created a new broker without ssl. This time, even if I did not specify&#160;&lt;b&gt;--partition 0&lt;/b&gt;, I can see all the messages as expected.&lt;/p&gt;

&lt;p&gt;In both the cases only a single broker is running. Topic partitions and replication factor are both 1.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3s9x3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>