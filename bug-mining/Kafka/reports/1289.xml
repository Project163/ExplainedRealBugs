<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:58:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-4405] Avoid calling pollNoWakeup unnecessarily</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-4405</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;In KafkaConsumer:poll, the code always calls &quot;pollNoWakeup&quot;, which turns out to be expensive. When max.poll.records=1, for example, that call adds about 50% performance overhead. The code should avoid avoid that function unnecessarily when there are no outstanding prefetches.&lt;/p&gt;


&lt;p&gt;Old JIRA description (discarded because turned out not to be the case):&lt;br/&gt;
---------------------------------------------------------------------------------------------------&lt;br/&gt;
Now kafka consumer has added max.poll.records to limit the count of messages return by poll().&lt;/p&gt;

&lt;p&gt;According to KIP-41, to implement  max.poll.records, the prefetch request should only be sent when the total number of retained records is less than max.poll.records.&lt;/p&gt;

&lt;p&gt;But in the code of 0.10.0.1 , the consumer will send a prefetch request if it retained any records and never check if total number of retained records is less than max.poll.records..&lt;/p&gt;

&lt;p&gt;If max.poll.records is set to a count much less than the count of message fetched , the poll() loop will send a lot of requests than expected and will have more and more records fetched and stored in memory before they can be consumed.&lt;/p&gt;

&lt;p&gt;So before sending a  prefetch request , the consumer must check if total number of retained records is less than max.poll.records.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13020449">KAFKA-4405</key>
            <summary>Avoid calling pollNoWakeup unnecessarily</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="enothereska">Eno Thereska</assignee>
                                    <reporter username="ysysberserk">ysysberserk</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 Nov 2016 08:38:20 +0000</created>
                <updated>Tue, 13 Dec 2016 11:29:04 +0000</updated>
                            <resolved>Mon, 12 Dec 2016 17:53:49 +0000</resolved>
                                    <version>0.10.0.1</version>
                                    <fixVersion>0.10.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15700704" author="hachikuji" created="Mon, 28 Nov 2016 02:18:27 +0000"  >&lt;p&gt;I think a better approach is &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4007&quot; title=&quot;Improve fetch pipelining for low values of max.poll.records&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4007&quot;&gt;KAFKA-4007&lt;/a&gt;. The idea is to always send the next prefetch (regardless whether we still have data queued), but avoid reading it from the socket until we need to. This is also related to KIP-81: &lt;a href=&quot;https://cwiki.apache.org/confluence/display/KAFKA/KIP-81%3A+Bound+Fetch+memory+usage+in+the+consumer&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/KAFKA/KIP-81%3A+Bound+Fetch+memory+usage+in+the+consumer&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15701064" author="guozhang" created="Mon, 28 Nov 2016 06:19:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enothereska&quot; class=&quot;user-hover&quot; rel=&quot;enothereska&quot;&gt;enothereska&lt;/a&gt; Maybe this can result in performance differences in consumer.&lt;/p&gt;</comment>
                            <comment id="15701118" author="ysysberserk" created="Mon, 28 Nov 2016 06:42:09 +0000"  >&lt;p&gt;It sounds better, I will check it.&lt;/p&gt;

&lt;p&gt;But comparing the total number of retained records with  max.poll.records will be much simpler and can be done with only a few lines.&lt;/p&gt;</comment>
                            <comment id="15701241" author="ysysberserk" created="Mon, 28 Nov 2016 07:54:34 +0000"  >&lt;p&gt;It seems to me that it is not only a performance problem but will cause big problem .&lt;/p&gt;

&lt;p&gt;For example , assume we set max.poll.records to 1 and each prefetch request can fetch 1000 records and there are plenty unprocessed records to be read.&lt;/p&gt;

&lt;p&gt;Then to consume all 1000 records in the first prefetch request, we need call poll() 1000 times and 1000 prefetch request will be sent and 1000 * 1000 records are returned and stored in memory.&lt;/p&gt;

&lt;p&gt;And when it goes on , more and more records will be fetched and need to wait for a long time to be consumed.&lt;/p&gt;

&lt;p&gt;When there are too many records, it may run out of memory.&lt;/p&gt;

&lt;p&gt;So the count of prefetch must be strictly limited and be sent only when necessary.&lt;/p&gt;</comment>
                            <comment id="15705475" author="enothereska" created="Tue, 29 Nov 2016 14:44:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guozhang&quot; class=&quot;user-hover&quot; rel=&quot;guozhang&quot;&gt;guozhang&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hachikuji&quot; class=&quot;user-hover&quot; rel=&quot;hachikuji&quot;&gt;hachikuji&lt;/a&gt;&lt;br/&gt;
Indeed I can verify that I saw a 50% increase in performance with max.poll.records set to 1 with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ysysberserk&quot; class=&quot;user-hover&quot; rel=&quot;ysysberserk&quot;&gt;ysysberserk&lt;/a&gt;&apos;s suggestion in KafkaConsumer::poll()&lt;br/&gt;
                   // 1 line change. For testing, I made fetcher.maxPollRecords public.&lt;br/&gt;
                    if (records.size() &amp;lt; fetcher.maxPollRecords)&lt;/p&gt;
{
                        fetcher.sendFetches();
                        client.pollNoWakeup();
                    }

&lt;p&gt;Details: I ran SimpleBenchmark.java (for streams) and measured the performance of benchmark.processStreamWithStateStore only (commented out everything except for the benchmark.produce and the above ---- produce is needed to send data to a topic). In createKafkaStreamsWithStateStore I added a line to configure max.poll.records:  props.put((ConsumerConfig.MAX_POLL_RECORDS_CONFIG, 1);&lt;/p&gt;

&lt;p&gt;I got 10MB/s and 15MB/s as results. Did 2 runs to check.&lt;/p&gt;</comment>
                            <comment id="15705594" author="ijuma" created="Tue, 29 Nov 2016 15:25:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enothereska&quot; class=&quot;user-hover&quot; rel=&quot;enothereska&quot;&gt;enothereska&lt;/a&gt;, do you mean the following?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!records.isEmpty()) {
                    &lt;span class=&quot;code-comment&quot;&gt;// before returning the fetched records, we can send off the next round of fetches
&lt;/span&gt;                    &lt;span class=&quot;code-comment&quot;&gt;// and avoid block waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; their responses to enable pipelining &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; the user
&lt;/span&gt;                    &lt;span class=&quot;code-comment&quot;&gt;// is handling the fetched records.
&lt;/span&gt;                    &lt;span class=&quot;code-comment&quot;&gt;//
&lt;/span&gt;                    &lt;span class=&quot;code-comment&quot;&gt;// NOTE: since the consumed position has already been updated, we must not allow
&lt;/span&gt;                    &lt;span class=&quot;code-comment&quot;&gt;// wakeups or any other errors to be triggered prior to returning the fetched records.
&lt;/span&gt;                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (records.size() &amp;lt; fetcher.maxPollRecords) {
                        fetcher.sendFetches();
                        client.pollNoWakeup();
                    }

                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.interceptors == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
                        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConsumerRecords&amp;lt;&amp;gt;(records);
                    &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
                        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.interceptors.onConsume(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConsumerRecords&amp;lt;&amp;gt;(records));
                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15705655" author="enothereska" created="Tue, 29 Nov 2016 15:45:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ijuma&quot; class=&quot;user-hover&quot; rel=&quot;ijuma&quot;&gt;ijuma&lt;/a&gt; yes.&lt;/p&gt;</comment>
                            <comment id="15705691" author="ijuma" created="Tue, 29 Nov 2016 16:03:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ysysberserk&quot; class=&quot;user-hover&quot; rel=&quot;ysysberserk&quot;&gt;ysysberserk&lt;/a&gt;, are you really seeing the behaviour you have described here? Fetcher should only try to prefetch a given partition if we don&apos;t have records for it, see the code below (`fetchablePartitions` in particular):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; List&amp;lt;TopicPartition&amp;gt; fetchablePartitions() {
        List&amp;lt;TopicPartition&amp;gt; fetchable = subscriptions.fetchablePartitions();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (nextInLineRecords != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !nextInLineRecords.isEmpty())
            fetchable.remove(nextInLineRecords.partition);
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (CompletedFetch completedFetch : completedFetches)
            fetchable.remove(completedFetch.partition);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; fetchable;
    }

    /**
     * Create fetch requests &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all nodes &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; which we have assigned partitions
     * that have no existing requests in flight.
     */
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Map&amp;lt;Node, FetchRequest&amp;gt; createFetchRequests() {
        &lt;span class=&quot;code-comment&quot;&gt;// create the fetch info
&lt;/span&gt;        Cluster cluster = metadata.fetch();
        Map&amp;lt;Node, LinkedHashMap&amp;lt;TopicPartition, FetchRequest.PartitionData&amp;gt;&amp;gt; fetchable = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LinkedHashMap&amp;lt;&amp;gt;();
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (TopicPartition partition : fetchablePartitions()) {
            Node node = cluster.leaderFor(partition);
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (node == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                metadata.requestUpdate();
            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.client.pendingRequestCount(node) == 0) {
                &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; there is a leader and no in-flight requests, issue a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; fetch
&lt;/span&gt;                LinkedHashMap&amp;lt;TopicPartition, FetchRequest.PartitionData&amp;gt; fetch = fetchable.get(node);
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fetch == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                    fetch = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LinkedHashMap&amp;lt;&amp;gt;();
                    fetchable.put(node, fetch);
                }

                &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; position = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.subscriptions.position(partition);
                fetch.put(partition, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FetchRequest.PartitionData(position, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.fetchSize));
                log.trace(&lt;span class=&quot;code-quote&quot;&gt;&quot;Added fetch request &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partition {} at offset {}&quot;&lt;/span&gt;, partition, position);
            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                log.trace(&lt;span class=&quot;code-quote&quot;&gt;&quot;Skipping fetch &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partition {} because there is an in-flight request to {}&quot;&lt;/span&gt;, partition, node);
            }
        }

        &lt;span class=&quot;code-comment&quot;&gt;// create the fetches
&lt;/span&gt;        Map&amp;lt;Node, FetchRequest&amp;gt; requests = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&amp;gt;();
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;Node, LinkedHashMap&amp;lt;TopicPartition, FetchRequest.PartitionData&amp;gt;&amp;gt; entry : fetchable.entrySet()) {
            Node node = entry.getKey();
            FetchRequest fetch = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FetchRequest(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.maxWaitMs, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.minBytes, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.maxBytes, entry.getValue());
            requests.put(node, fetch);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; requests;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15706166" author="guozhang" created="Tue, 29 Nov 2016 18:47:20 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enothereska&quot; class=&quot;user-hover&quot; rel=&quot;enothereska&quot;&gt;enothereska&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15707215" author="ysysberserk" created="Wed, 30 Nov 2016 01:51:00 +0000"  >&lt;p&gt;Oh, I am sorry that I only read the code and did not notice that in fetchablePartitions() the partition which has records is removed before sent a prefetch.&lt;/p&gt;

&lt;p&gt;So there is no such a big problem and current work flow is ok.&lt;/p&gt;

&lt;p&gt;But we can still add check if total number of retained records is less than max.poll.records  before we call &lt;/p&gt;

&lt;p&gt;fetcher.sendFetches().It will prevent useless call and save a lot of time and make code eaiser to understand.&lt;/p&gt;</comment>
                            <comment id="15708050" author="githubbot" created="Wed, 30 Nov 2016 09:30:53 +0000"  >&lt;p&gt;GitHub user enothereska opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2193&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2193&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4405&quot; title=&quot;Avoid calling pollNoWakeup unnecessarily&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4405&quot;&gt;&lt;del&gt;KAFKA-4405&lt;/del&gt;&lt;/a&gt;: Check max.poll.records before prefetching&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/enothereska/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/enothereska/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4405&quot; title=&quot;Avoid calling pollNoWakeup unnecessarily&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4405&quot;&gt;&lt;del&gt;KAFKA-4405&lt;/del&gt;&lt;/a&gt;-prefetch&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2193.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2193.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2193&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 592482e0c41b14f66bd78f2f4f6247a686743280&lt;br/&gt;
Author: Eno Thereska &amp;lt;eno.thereska@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-11-30T09:29:55Z&lt;/p&gt;

&lt;p&gt;    Check max.poll.records before prefetching&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15708052" author="enothereska" created="Wed, 30 Nov 2016 09:31:55 +0000"  >&lt;p&gt;I opened a PR since the performance difference is still significant.&lt;/p&gt;</comment>
                            <comment id="15711450" author="githubbot" created="Thu, 1 Dec 2016 09:25:56 +0000"  >&lt;p&gt;Github user enothereska closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2193&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2193&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15711461" author="enothereska" created="Thu, 1 Dec 2016 09:31:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guozhang&quot; class=&quot;user-hover&quot; rel=&quot;guozhang&quot;&gt;guozhang&lt;/a&gt;I tested with the new trunk containing &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4469&quot; title=&quot;Consumer throughput regression caused by inefficient list removal and copy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4469&quot;&gt;&lt;del&gt;KAFKA-4469&lt;/del&gt;&lt;/a&gt; and I don&apos;t see the performance discrepancy anymore. So I&apos;ll close this PR. Thanks.&lt;/p&gt;</comment>
                            <comment id="15711475" author="githubbot" created="Thu, 1 Dec 2016 09:38:05 +0000"  >&lt;p&gt;GitHub user enothereska reopened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2193&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2193&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4405&quot; title=&quot;Avoid calling pollNoWakeup unnecessarily&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4405&quot;&gt;&lt;del&gt;KAFKA-4405&lt;/del&gt;&lt;/a&gt;: Check max.poll.records before prefetching&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/enothereska/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/enothereska/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4405&quot; title=&quot;Avoid calling pollNoWakeup unnecessarily&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4405&quot;&gt;&lt;del&gt;KAFKA-4405&lt;/del&gt;&lt;/a&gt;-prefetch&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2193.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2193.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2193&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 592482e0c41b14f66bd78f2f4f6247a686743280&lt;br/&gt;
Author: Eno Thereska &amp;lt;eno.thereska@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-11-30T09:29:55Z&lt;/p&gt;

&lt;p&gt;    Check max.poll.records before prefetching&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15711481" author="enothereska" created="Thu, 1 Dec 2016 09:41:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guozhang&quot; class=&quot;user-hover&quot; rel=&quot;guozhang&quot;&gt;guozhang&lt;/a&gt; Ignore previous comment, I was testing by mistake with max.poll.records=1000 today. The PR is still showing benefits for max.poll.records=1&lt;/p&gt;</comment>
                            <comment id="15742588" author="hachikuji" created="Mon, 12 Dec 2016 17:53:49 +0000"  >&lt;p&gt;Issue resolved by pull request 2193&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/2193&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2193&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15742591" author="githubbot" created="Mon, 12 Dec 2016 17:54:36 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2193&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2193&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15743437" author="ijuma" created="Mon, 12 Dec 2016 22:56:45 +0000"  >&lt;p&gt;Thanks for the PR &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enothereska&quot; class=&quot;user-hover&quot; rel=&quot;enothereska&quot;&gt;enothereska&lt;/a&gt;. Can you please update the JIRA title and description to match what we actually merged?&lt;/p&gt;</comment>
                            <comment id="15744924" author="enothereska" created="Tue, 13 Dec 2016 11:29:04 +0000"  >&lt;p&gt;Done, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ijuma&quot; class=&quot;user-hover&quot; rel=&quot;ijuma&quot;&gt;ijuma&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36a4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>