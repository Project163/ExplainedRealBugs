<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:21:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-9265] kafka.log.Log instances are leaking on log delete</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-9265</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-8448&quot; title=&quot;Too many kafka.log.Log instances (Memory Leak)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-8448&quot;&gt;&lt;del&gt;KAFKA-8448&lt;/del&gt;&lt;/a&gt; fixes problem with similar leak. The &lt;tt&gt;Log&lt;/tt&gt; objects are being held in &lt;tt&gt;ScheduledExecutor&lt;/tt&gt; &lt;tt&gt;PeriodicProducerExpirationCheck&lt;/tt&gt; callback. The fix in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-8448&quot; title=&quot;Too many kafka.log.Log instances (Memory Leak)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-8448&quot;&gt;&lt;del&gt;KAFKA-8448&lt;/del&gt;&lt;/a&gt; was to change the policy of &lt;tt&gt;ScheduledExecutor&lt;/tt&gt; to remove the scheduled task when it gets canceled (by calling &lt;tt&gt;setRemoveOnCancelPolicy(true)&lt;/tt&gt;).&lt;/p&gt;

&lt;p&gt;This works when a log is closed using &lt;tt&gt;close()&lt;/tt&gt; method. But when a log is deleted either when the topic gets deleted or when the rebalancing operation moves the replica away from broker, the &lt;tt&gt;delete()&lt;/tt&gt; operation is invoked. &lt;tt&gt;Log.delete()&lt;/tt&gt; doesn&apos;t close the pending scheduled task and that leaks Log instance.&lt;/p&gt;

&lt;p&gt;Fix is to close the scheduled task in the &lt;tt&gt;Log.delete()&lt;/tt&gt; method too.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13272060">KAFKA-9265</key>
            <summary>kafka.log.Log instances are leaking on log delete</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vikasconfluent">Vikas Singh</assignee>
                                    <reporter username="vikasconfluent">Vikas Singh</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 Dec 2019 21:40:16 +0000</created>
                <updated>Wed, 4 Dec 2019 14:08:59 +0000</updated>
                            <resolved>Wed, 4 Dec 2019 14:08:59 +0000</resolved>
                                                    <fixVersion>2.3.2</fixVersion>
                    <fixVersion>2.4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16987300" author="githubbot" created="Tue, 3 Dec 2019 22:04:18 +0000"  >&lt;p&gt;soondenana commented on pull request #7773: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9265&quot; title=&quot;kafka.log.Log instances are leaking on log delete&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9265&quot;&gt;&lt;del&gt;KAFKA-9265&lt;/del&gt;&lt;/a&gt;: Fix kafka.log.Log instance leak on log deletion&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7773&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7773&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-8448&quot; title=&quot;Too many kafka.log.Log instances (Memory Leak)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-8448&quot;&gt;&lt;del&gt;KAFKA-8448&lt;/del&gt;&lt;/a&gt; fixes problem with similar leak. The Log objects are being&lt;br/&gt;
   held in ScheduledExecutor PeriodicProducerExpirationCheck callback. The&lt;br/&gt;
   fix in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-8448&quot; title=&quot;Too many kafka.log.Log instances (Memory Leak)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-8448&quot;&gt;&lt;del&gt;KAFKA-8448&lt;/del&gt;&lt;/a&gt; was to change the policy of ScheduledExecutor to&lt;br/&gt;
   remove the scheduled task when it gets canceled (by calling&lt;br/&gt;
   setRemoveOnCancelPolicy(true)).&lt;/p&gt;

&lt;p&gt;   This works when a log is closed using close() method. But when a log is&lt;br/&gt;
   deleted either when the topic gets deleted or when the rebalancing&lt;br/&gt;
   operation moves the replica away from broker, the delete() operation is&lt;br/&gt;
   invoked. Log.delete() doesn&apos;t close the pending scheduled task and that&lt;br/&gt;
   leaks Log instance.&lt;/p&gt;

&lt;p&gt;   Fix is to close the scheduled task in the Log.delete() method too.&lt;/p&gt;

&lt;p&gt;   Tested with and without this fix and Log instances are no longer leaked&lt;br/&gt;
   and scheduled tasks are gone once log is deleted.&lt;/p&gt;

&lt;p&gt;   *More detailed description of your change,&lt;br/&gt;
   if necessary. The PR title and PR message become&lt;br/&gt;
   the squashed commit message, so use a separate&lt;br/&gt;
   comment to ping reviewers.*&lt;/p&gt;

&lt;p&gt;   *Summary of testing strategy (including rationale)&lt;br/&gt;
   for the feature or bug fix. Unit and/or integration&lt;br/&gt;
   tests are expected for any behaviour change and&lt;br/&gt;
   system tests should be considered for larger changes.*&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16987884" author="githubbot" created="Wed, 4 Dec 2019 13:52:34 +0000"  >&lt;p&gt;ijuma commented on pull request #7773: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9265&quot; title=&quot;kafka.log.Log instances are leaking on log delete&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9265&quot;&gt;&lt;del&gt;KAFKA-9265&lt;/del&gt;&lt;/a&gt;: Fix kafka.log.Log instance leak on log deletion&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7773&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7773&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 49 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z09960:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>