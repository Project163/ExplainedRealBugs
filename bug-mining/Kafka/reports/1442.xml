<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:00:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-4814] ZookeeperLeaderElector not respecting zookeeper.set.acl</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-4814</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;By &lt;a href=&quot;https://kafka.apache.org/documentation/#zk_authz_migration&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;migration guide&lt;/a&gt; for enabling ZooKeeper security on an existing Apache Kafka cluster, and &lt;a href=&quot;https://kafka.apache.org/documentation/#brokerconfigs&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;broker configuration documentation&lt;/a&gt; for &lt;tt&gt;zookeeper.set.acl&lt;/tt&gt; configuration property, when this property is set to false Kafka brokers should not be setting any ACLs on ZooKeeper nodes, even when JAAS config file is provisioned to broker. &lt;/p&gt;

&lt;p&gt;Problem is that there is broker side logic, like one in &lt;tt&gt;ZookeeperLeaderElector&lt;/tt&gt; making use of &lt;tt&gt;JaasUtils#isZkSecurityEnabled&lt;/tt&gt;, which does not respect this configuration property, resulting in ACLs being set even when there&apos;s just JAAS config file provisioned to Kafka broker while &lt;tt&gt;zookeeper.set.acl&lt;/tt&gt; is set to &lt;tt&gt;false&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Notice that &lt;tt&gt;JaasUtils&lt;/tt&gt; is in &lt;tt&gt;org.apache.kafka.common.security&lt;/tt&gt; package of &lt;tt&gt;kafka-clients&lt;/tt&gt; module, while &lt;tt&gt;zookeeper.set.acl&lt;/tt&gt; is broker side only configuration property.&lt;/p&gt;

&lt;p&gt;To make it possible without downtime to enable ZooKeeper authentication on existing cluster, it should be possible to have all Kafka brokers in cluster first authenticate to ZooKeeper cluster, without ACLs being set. Only once all ZooKeeper clients (Kafka brokers and others) are authenticating to ZooKeeper cluster then ACLs can be started being set.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13047024">KAFKA-4814</key>
            <summary>ZookeeperLeaderElector not respecting zookeeper.set.acl</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rsivaram">Rajini Sivaram</assignee>
                                    <reporter username="sslavic">Stevo Slavi&#263;</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Tue, 28 Feb 2017 16:59:38 +0000</created>
                <updated>Thu, 20 Apr 2017 10:10:01 +0000</updated>
                            <resolved>Thu, 20 Apr 2017 09:26:37 +0000</resolved>
                                    <version>0.10.1.1</version>
                                    <fixVersion>0.11.0.0</fixVersion>
                                    <component>security</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="15946169" author="ijuma" created="Tue, 28 Mar 2017 23:19:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=baluchicken&quot; class=&quot;user-hover&quot; rel=&quot;baluchicken&quot;&gt;baluchicken&lt;/a&gt;, are you working on this JIRA? It would be good to include it in the next bug fix release that will be out soon.&lt;/p&gt;</comment>
                            <comment id="15946736" author="baluchicken" created="Wed, 29 Mar 2017 08:42:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ijuma&quot; class=&quot;user-hover&quot; rel=&quot;ijuma&quot;&gt;ijuma&lt;/a&gt; Not yet, but I am going to start to work on this today and I hope I can finish until the weekend. If this is too late for the release fell free to reassign&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15953384" author="baluchicken" created="Mon, 3 Apr 2017 12:22:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ijuma&quot; class=&quot;user-hover&quot; rel=&quot;ijuma&quot;&gt;ijuma&lt;/a&gt; Something odd happening here, or I don&apos;t understand something. There is a ZkUtils constructor where we have a parameter isZkSecurityEnabled &lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/core/src/main/scala/kafka/utils/ZkUtils.scala#L80&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/core/src/main/scala/kafka/utils/ZkUtils.scala#L80&lt;/a&gt; . We are giving value to this parameter from two different? thing. First we are using the zookeeper.set.acl value for example in class &lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/core/src/main/scala/kafka/server/KafkaServer.scala#L325&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/core/src/main/scala/kafka/server/KafkaServer.scala#L325&lt;/a&gt;&lt;br/&gt;
and we are also using the JaasUtils.isZkSecurityEnabled method for example in &lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/core/src/main/scala/kafka/admin/ConfigCommand.scala#L61&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/core/src/main/scala/kafka/admin/ConfigCommand.scala#L61&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think these are separate things which we need to handle differently. Or am I missing something here?  &lt;/p&gt;</comment>
                            <comment id="15953428" author="ijuma" created="Mon, 3 Apr 2017 12:58:11 +0000"  >&lt;p&gt;For commands, it&apos;s enough to check `JaasUtils.isZkSecurityEnabled`. For the broker, we should check the config as well (same as KafkaServer).&lt;/p&gt;</comment>
                            <comment id="15956846" author="ijuma" created="Wed, 5 Apr 2017 13:25:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=baluchicken&quot; class=&quot;user-hover&quot; rel=&quot;baluchicken&quot;&gt;baluchicken&lt;/a&gt;, have you made progress on this one? If not, maybe &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rsivaram&quot; class=&quot;user-hover&quot; rel=&quot;rsivaram&quot;&gt;rsivaram&lt;/a&gt; could pick it up.&lt;/p&gt;</comment>
                            <comment id="15958663" author="rsivaram" created="Thu, 6 Apr 2017 09:44:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=baluchicken&quot; class=&quot;user-hover&quot; rel=&quot;baluchicken&quot;&gt;baluchicken&lt;/a&gt; Let me know you would like me to take this. I am happy to help.&lt;/p&gt;</comment>
                            <comment id="15958759" author="baluchicken" created="Thu, 6 Apr 2017 11:17:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rsivaram&quot; class=&quot;user-hover&quot; rel=&quot;rsivaram&quot;&gt;rsivaram&lt;/a&gt; Please help me with this. Sadly, I don&apos;t have time to deal with this. I started to work on this but I do not have a solution yet.&lt;/p&gt;</comment>
                            <comment id="15961176" author="gwenshap" created="Fri, 7 Apr 2017 17:39:52 +0000"  >&lt;p&gt;Hey guys, &lt;br/&gt;
I think this is going to be late for 0.10.2.1, so I&apos;m moving the fixVersion.&lt;br/&gt;
Sorry about that, but there are so many important bug fixes that I don&apos;t want to delay the release.&lt;/p&gt;

&lt;p&gt;I&apos;ll revisit if we do another RC, so keep on the good work &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15965664" author="baluchicken" created="Wed, 12 Apr 2017 11:00:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rsivaram&quot; class=&quot;user-hover&quot; rel=&quot;rsivaram&quot;&gt;rsivaram&lt;/a&gt; I think if we change JaasUtils.isZkSecurityEnabled function to controllerContext.zkUtils.isSecure does the trick &lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/core/src/main/scala/kafka/server/ZookeeperLeaderElector.scala#L81&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/core/src/main/scala/kafka/server/ZookeeperLeaderElector.scala#L81&lt;/a&gt;. But I am not 100% sure about that. On the other hand maybe it is a good to wait until &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5028&quot; title=&quot;convert kafka controller to a single-threaded event queue model&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5028&quot;&gt;&lt;del&gt;KAFKA-5028&lt;/del&gt;&lt;/a&gt; is merged.&lt;/p&gt;</comment>
                            <comment id="15965722" author="rsivaram" created="Wed, 12 Apr 2017 12:19:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=baluchicken&quot; class=&quot;user-hover&quot; rel=&quot;baluchicken&quot;&gt;baluchicken&lt;/a&gt; Sorry, I had forgotten about this one. Yes, you are right. We should use &lt;tt&gt;zookeeper.set.acl&lt;/tt&gt; which is available in &lt;tt&gt;controllerContext.zkUtils&lt;/tt&gt;. Will also check if &lt;tt&gt;JaasUtils.isZkSecurityEnabled&lt;/tt&gt; is used incorrectly anywhere else.&lt;/p&gt;</comment>
                            <comment id="15965775" author="githubbot" created="Wed, 12 Apr 2017 12:47:47 +0000"  >&lt;p&gt;GitHub user rajinisivaram opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2845&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2845&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4814&quot; title=&quot;ZookeeperLeaderElector not respecting zookeeper.set.acl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4814&quot;&gt;&lt;del&gt;KAFKA-4814&lt;/del&gt;&lt;/a&gt;: Enable ZK ACLs only when zookeeper.set.acl is set&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/rajinisivaram/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rajinisivaram/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4814&quot; title=&quot;ZookeeperLeaderElector not respecting zookeeper.set.acl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4814&quot;&gt;&lt;del&gt;KAFKA-4814&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2845.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2845.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2845&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b4c8614fa6faaba40ec878919bf2314a17736493&lt;br/&gt;
Author: Rajini Sivaram &amp;lt;rajinisivaram@googlemail.com&amp;gt;&lt;br/&gt;
Date:   2017-04-12T12:28:06Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4814&quot; title=&quot;ZookeeperLeaderElector not respecting zookeeper.set.acl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4814&quot;&gt;&lt;del&gt;KAFKA-4814&lt;/del&gt;&lt;/a&gt;: Enable ZK ACLs only when zookeeper.set.acl is set&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15976360" author="githubbot" created="Thu, 20 Apr 2017 09:25:06 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2845&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2845&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15976432" author="baluchicken" created="Thu, 20 Apr 2017 10:10:01 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rsivaram&quot; class=&quot;user-hover&quot; rel=&quot;rsivaram&quot;&gt;rsivaram&lt;/a&gt;, helping me out with this one&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 30 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3aqov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>