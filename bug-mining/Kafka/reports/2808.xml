<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:25:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-10600] Connect adds error to property in validation result if connector does not define the property</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-10600</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Kafka Connect&apos;s &lt;tt&gt;AbstractHerder.generateResult(...)&lt;/tt&gt; method is responsible for taking the result of a &lt;tt&gt;Connector.validate(...)&lt;/tt&gt; call and constructing the &lt;tt&gt;ConfigInfos&lt;/tt&gt; object that is then mapped to the JSON representation.&lt;/p&gt;

&lt;p&gt;As this method (see &lt;a href=&quot;https://github.com/apache/kafka/blob/1f8ac6e6fee3aa404fc1a4c01ac2e0c48429a306/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/AbstractHerder.java#L504-L507&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;code&lt;/a&gt;) iterates over the &lt;tt&gt;ConfigKey&lt;/tt&gt; objects in the connector&apos;s &lt;tt&gt;ConfigDef&lt;/tt&gt; and the &lt;tt&gt;ConfigValue&lt;/tt&gt; objects returned by the &lt;tt&gt;Connector.validate(...)&lt;/tt&gt; method, this method adds an error message to any &lt;tt&gt;ConfigValue&lt;/tt&gt; whose &lt;tt&gt;configValue.name()&lt;/tt&gt; does not correspond to a &lt;tt&gt;ConfigKey&lt;/tt&gt; in the connector&apos;s &lt;tt&gt;ConfigDef&lt;/tt&gt;. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!configKeys.containsKey(configName)) {
                configValue.addErrorMessage(&lt;span class=&quot;code-quote&quot;&gt;&quot;Configuration is not defined: &quot;&lt;/span&gt; + configName);
                configInfoList.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConfigInfo(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, convertConfigValue(configValue, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)));
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Interestingly, these errors are not included in the total error count of the response. Is that intentional??&lt;/p&gt;

&lt;p&gt;This behavior does not allow connectors to report validation errors against extra properties not defined in the connector&apos;s &lt;tt&gt;ConfigDef&lt;/tt&gt;. &lt;/p&gt;

&lt;p&gt;Consider a connector that allows arbitrary properties with some prefix (e.g., &lt;tt&gt;connection.*&lt;/tt&gt;) to be included and used in the connector properties. One example is to supply additional properties to a JDBC connection, where the connector may not be able to know these &quot;additional properties&quot; in advance because the connector either works with multiple JDBC drivers or the connection properties allowed by a JDBC driver are many and/or vary over different JDBC driver versions or server versions.&lt;/p&gt;

&lt;p&gt;Such &quot;additional properties&quot; are not prohibited by Connect API, yet if a connector implementation chooses to include any such additional properties in the &lt;tt&gt;Connector.validate(...)&lt;/tt&gt; result (whether or not the corresponding &lt;tt&gt;ConfigValue&lt;/tt&gt; has an error) then Connect will always add the following error to that property. &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Configuration is not defined: &amp;lt;additionalPropertyName&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This code was in the 0.10.0.0 release of Kafka via the &lt;a href=&quot;https://github.com/apache/kafka/pull/964&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt; for &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3315&quot; title=&quot;Add Connect API to expose connector configuration info&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3315&quot;&gt;&lt;del&gt;KAFKA-3315&lt;/del&gt;&lt;/a&gt;, which is one of the tasks that implemented &lt;a href=&quot;https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=58851767&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;KIP-26&lt;/a&gt; for Kafka Connect (approved and partially added in 0.9.0.0). There is no mention of &quot;validation&quot; in KIP-26 nor any followup KIP (that I can find).&lt;/p&gt;

&lt;p&gt;I can kind of imagine the original thought process: any user-supplied property that is not defined by a &lt;tt&gt;ConfigDef&lt;/tt&gt; is inherently an error. However, this assumption is not matched by any mention in the Connect API, documentation, or one of Connect&apos;s KIP.&lt;br/&gt;
IMO, this is a bug in the &lt;tt&gt;AbstractHerder&lt;/tt&gt; that over-constrains the connector properties to be only those defined in the connector&apos;s &lt;tt&gt;ConfigDef&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Quite a few connectors already support additional properties, and it&apos;s perhaps only by chance that this happens to work: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;If a connector does not override &lt;tt&gt;Connector.validate(...)&lt;/tt&gt;, extra properties are not validated and therefore are not included in the resulting &lt;tt&gt;Config&lt;/tt&gt; response with one &lt;tt&gt;ConfigValue&lt;/tt&gt; per property defined in the connector&apos;s &lt;tt&gt;ConfigDef&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;If a connector does override &lt;tt&gt;Connector.validate(...)&lt;/tt&gt; and includes in the &lt;tt&gt;Config&lt;/tt&gt; response a &lt;tt&gt;ConfigValue&lt;/tt&gt; for the any additional properties, the &lt;tt&gt;AbstractHerder.generateResults(...)&lt;/tt&gt; method does add the error but does not include this error in the error count, which is actually used to determine if there are any validation problems before starting/updating the connector.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I propose that the &lt;tt&gt;AbstractHerder.generateResult(...)&lt;/tt&gt; method be changed to not add any additional error message to the validation result, and to properly handle all &lt;tt&gt;ConfigValue&lt;/tt&gt; objects regardless of whether there is a corresponding &lt;tt&gt;ConfigKey&lt;/tt&gt; in the connector&apos;s &lt;tt&gt;ConfigDef&lt;/tt&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13335051">KAFKA-10600</key>
            <summary>Connect adds error to property in validation result if connector does not define the property</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhauch">Randall Hauch</assignee>
                                    <reporter username="rhauch">Randall Hauch</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Oct 2020 16:29:59 +0000</created>
                <updated>Wed, 7 Jul 2021 15:50:24 +0000</updated>
                            <resolved>Fri, 16 Oct 2020 14:17:13 +0000</resolved>
                                    <version>0.10.0.0</version>
                    <version>0.11.0.0</version>
                    <version>1.0.0</version>
                    <version>1.1.0</version>
                    <version>2.0.0</version>
                    <version>2.1.0</version>
                    <version>2.2.0</version>
                    <version>2.3.0</version>
                    <version>2.4.0</version>
                    <version>2.5.0</version>
                    <version>2.6.0</version>
                                    <fixVersion>2.5.2</fixVersion>
                    <fixVersion>2.6.1</fixVersion>
                    <fixVersion>2.7.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17213276" author="rhauch" created="Tue, 13 Oct 2020 17:54:00 +0000"  >&lt;p&gt;See PR &lt;a href=&quot;https://github.com/apache/kafka/pull/9425&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/9425&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17215413" author="rhauch" created="Fri, 16 Oct 2020 14:17:13 +0000"  >&lt;p&gt;Connect should not always add an error to configuration values in validation results that don&apos;t have a `ConfigKey` defined in the connector&apos;s `ConfigDef`, and any errors on such configuration values included by the connector should be counted in the total number of errors. Added more unit tests for `AbstractHerder.generateResult(...)`.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310660">
                    <name>Completes</name>
                                            <outwardlinks description="fixes">
                                        <issuelink>
            <issuekey id="13184865">KAFKA-7407</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 4 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0jmww:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>kkarantasis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>