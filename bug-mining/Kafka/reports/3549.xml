<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:33:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-13197] KStream-GlobalKTable join semantics don&apos;t match documentation</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-13197</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;As part of &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-10277&quot; title=&quot;Relax non-null key requirement for KStream-GlobalKTable joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-10277&quot;&gt;&lt;del&gt;KAFKA-10277&lt;/del&gt;&lt;/a&gt;, the behavior of KStream-GlobalKTable joins was changed. It appears the change was intended to merely relax a requirement but it actually broke backwards compatibility. Although it does allow &lt;tt&gt;null&lt;/tt&gt; keys and values in the KStream to be joined, it now excludes &lt;tt&gt;null&lt;/tt&gt; results of the &lt;tt&gt;KeyValueMapper&lt;/tt&gt;. We have an application which can return &lt;tt&gt;null&lt;/tt&gt; from the &lt;tt&gt;KeyValueMapper&lt;/tt&gt; for non-null keys in the KStream, and relies on these nulls being passed to the &lt;tt&gt;ValueJoiner&lt;/tt&gt;. Indeed the javadoc still explicitly says this is done:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;If a KStream input record key or value is null the record will not be included in the join operation and thus no output record will be added to the resulting KStream.&lt;br/&gt;
 If keyValueMapper returns null implying no match exists, a null value will be provided to ValueJoiner.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Both these statements are incorrect.&lt;/p&gt;

&lt;p&gt;I think the new behavior is worse than the previous/documented behavior. It feels more reasonable to have a non-null stream record map to a null join key (our use-case is event-enhancement where the incoming record doesn&apos;t have the join field), than the reverse.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13394935">KAFKA-13197</key>
            <summary>KStream-GlobalKTable join semantics don&apos;t match documentation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aki">Florin Akermann</assignee>
                                    <reporter username="twbecker">Tommy Becker</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Aug 2021 15:26:51 +0000</created>
                <updated>Fri, 11 Aug 2023 21:36:30 +0000</updated>
                            <resolved>Fri, 11 Aug 2023 18:47:02 +0000</resolved>
                                    <version>2.7.0</version>
                                    <fixVersion>3.5.2</fixVersion>
                    <fixVersion>3.6.0</fixVersion>
                                    <component>documentation</component>
                    <component>streams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17400653" author="guozhang" created="Tue, 17 Aug 2021 22:59:20 +0000"  >&lt;p&gt;Thanks for filing this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twbecker&quot; class=&quot;user-hover&quot; rel=&quot;twbecker&quot;&gt;twbecker&lt;/a&gt;. The current doc says &quot;If &lt;/p&gt;
{@code keyValueMapper}
&lt;p&gt; returns &lt;/p&gt;
{@code null}
&lt;p&gt; implying no match exists, no output record will be added to the resulting &lt;/p&gt;
{@code KStream}
&lt;p&gt;.&quot; But I read the tickets and I think you are right: this property is not very reasonable since users may want to know if a single stream record does not find any matching results as well.&lt;/p&gt;

&lt;p&gt;I think the reasonable behavior (and the java doc should be updated accordingly) in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-10277&quot; title=&quot;Relax non-null key requirement for KStream-GlobalKTable joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-10277&quot;&gt;&lt;del&gt;KAFKA-10277&lt;/del&gt;&lt;/a&gt; should be&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
If the keyValueMapper returns &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; implying no matching key found, the ValueJoiner would still be triggered with (&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, v, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;).
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Does that sound right to you?&lt;/p&gt;</comment>
                            <comment id="17402211" author="twbecker" created="Fri, 20 Aug 2021 13:29:30 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guozhang&quot; class=&quot;user-hover&quot; rel=&quot;guozhang&quot;&gt;guozhang&lt;/a&gt;&#160;thanks for the response. To be clear, I&apos;m looking at &lt;tt&gt;KStream.leftJoin(GlobalKTable, KeyValueMapper, ValueJoiner)&lt;/tt&gt; as shown&#160;&lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java#L2964&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; and similar signatures, which still have the (incorrect) verbiage I quoted.&lt;/p&gt;

&lt;p&gt;It seems from the churn in this area that there is a need to allow both null stream key/value records as well as non-null stream side records that map to null join keys,, though my use-case and this issue are specifically about the latter, which used to work prior to 2.7.&lt;/p&gt;</comment>
                            <comment id="17753349" author="aki" created="Fri, 11 Aug 2023 21:36:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twbecker&quot; class=&quot;user-hover&quot; rel=&quot;twbecker&quot;&gt;twbecker&lt;/a&gt;, thanks for raising this. The documentation has been fixed.&lt;br/&gt;
KIP-962 will allow for the old behavior again: &apos;no longer drop records when KeyValueMapper returns &apos;null&apos; and call ValueJoiner with &apos;null&apos; for right value&apos;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13357820">KAFKA-12317</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13470320">KAFKA-14049</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 13 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0tuqw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>