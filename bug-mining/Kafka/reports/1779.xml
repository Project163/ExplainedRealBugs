<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:05:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-6422] When enable trace level log in mirror maker, it will throw null pointer exception and the mirror maker will shutdown</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-6422</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/kafka/blob/0.10.0/core/src/main/scala/kafka/tools/MirrorMaker.scala#L414&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/0.10.0/core/src/main/scala/kafka/tools/MirrorMaker.scala#L414&lt;/a&gt;&lt;br/&gt;
when enable trace level log in mirror maker, if the message value is null, it will throw null pointer exception, and mirror maker will shutdown because of that.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13128545">KAFKA-6422</key>
            <summary>When enable trace level log in mirror maker, it will throw null pointer exception and the mirror maker will shutdown</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Xin Li">Xin Li</assignee>
                                    <reporter username="Xin Li">Xin Li</reporter>
                        <labels>
                            <label>easyfix</label>
                    </labels>
                <created>Thu, 4 Jan 2018 17:31:47 +0000</created>
                <updated>Mon, 8 Jan 2018 23:06:21 +0000</updated>
                            <resolved>Mon, 8 Jan 2018 23:06:21 +0000</resolved>
                                    <version>0.10.0.0</version>
                    <version>0.10.1.0</version>
                    <version>0.10.2.0</version>
                    <version>0.11.0.0</version>
                    <version>0.11.0.1</version>
                    <version>0.11.0.2</version>
                                    <fixVersion>1.0.1</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                                    <component>tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16312474" author="prasanna1433" created="Fri, 5 Jan 2018 04:55:43 +0000"  >&lt;p&gt;So we should do a null check before printing the trace ? If so I can pick this story up&lt;/p&gt;</comment>
                            <comment id="16312577" author="xin li" created="Fri, 5 Jan 2018 06:46:15 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=prasanna1433&quot; class=&quot;user-hover&quot; rel=&quot;prasanna1433&quot;&gt;prasanna1433&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;I already have the pr open, just wait them to merge it.&lt;/p&gt;

&lt;p&gt;here is the pr &lt;a href=&quot;https://github.com/apache/kafka/pull/4387&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4387&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16315064" author="prasanna1433" created="Sun, 7 Jan 2018 05:42:38 +0000"  >&lt;p&gt;Thanks for letting me know. Since it was unassigned I commented on this.&lt;/p&gt;</comment>
                            <comment id="16315086" author="wushujames" created="Sun, 7 Jan 2018 07:37:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Xin+Li&quot; class=&quot;user-hover&quot; rel=&quot;Xin Li&quot;&gt;Xin Li&lt;/a&gt;, you should assign this JIRA to yourself (Edit -&amp;gt; Assignee). I tried assigning it to you, but I couldn&apos;t find you in the dropdown.&lt;/p&gt;

&lt;p&gt;If you aren&apos;t able to assign JIRAs to yourself, then you can send email to the dev@kafka.apache.org mailing list to ask for permissions to do so.&lt;/p&gt;</comment>
                            <comment id="16315146" author="xin li" created="Sun, 7 Jan 2018 10:14:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jchenga&quot; class=&quot;user-hover&quot; rel=&quot;jchenga&quot;&gt;jchenga&lt;/a&gt; looks that I do not have the rights to assign a task to myself. I will try to request the rights now.&lt;br/&gt;
Thank you for your information.&lt;br/&gt;
Cheers,&lt;br/&gt;
Xin&lt;/p&gt;</comment>
                            <comment id="16315739" author="xin li" created="Mon, 8 Jan 2018 06:47:23 +0000"  >&lt;p&gt;Hey&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hachikuji&quot; class=&quot;user-hover&quot; rel=&quot;hachikuji&quot;&gt;hachikuji&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wushujames&quot; class=&quot;user-hover&quot; rel=&quot;wushujames&quot;&gt;wushujames&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;could you take a look for the issue, and help me merge the pr if everything looks fine?&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/4386&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4386&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thank you,&lt;br/&gt;
Xin&lt;/p&gt;</comment>
                            <comment id="16316749" author="wushujames" created="Mon, 8 Jan 2018 18:33:27 +0000"  >&lt;p&gt;I have no ability to merge PRs, but the change looks good to me.&lt;/p&gt;</comment>
                            <comment id="16317292" author="githubbot" created="Mon, 8 Jan 2018 22:59:19 +0000"  >&lt;p&gt;hachikuji closed pull request #4387: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6422&quot; title=&quot;When enable trace level log in mirror maker, it will throw null pointer exception and the mirror maker will shutdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6422&quot;&gt;&lt;del&gt;KAFKA-6422&lt;/del&gt;&lt;/a&gt; Mirror maker will throw null pointer exception when the message value is null&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/4387&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4387&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/core/src/main/scala/kafka/tools/MirrorMaker.scala b/core/src/main/scala/kafka/tools/MirrorMaker.scala&lt;br/&gt;
index 618fd2a95b9..907fe20f414 100755&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/tools/MirrorMaker.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/tools/MirrorMaker.scala&lt;br/&gt;
@@ -67,7 +67,7 @@ object MirrorMaker extends Logging with KafkaMetricsGroup {&lt;/p&gt;

&lt;p&gt;   private&lt;span class=&quot;error&quot;&gt;&amp;#91;tools&amp;#93;&lt;/span&gt; var producer: MirrorMakerProducer = null&lt;br/&gt;
   private var mirrorMakerThreads: Seq&lt;span class=&quot;error&quot;&gt;&amp;#91;MirrorMakerThread&amp;#93;&lt;/span&gt; = null&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private val isShuttingdown: AtomicBoolean = new AtomicBoolean(false)&lt;br/&gt;
+  private val isShuttingDown: AtomicBoolean = new AtomicBoolean(false)&lt;br/&gt;
   // Track the messages not successfully sent by mirror maker.&lt;br/&gt;
   private val numDroppedMessages: AtomicInteger = new AtomicInteger(0)&lt;br/&gt;
   private var messageHandler: MirrorMakerMessageHandler = null&lt;br/&gt;
@@ -384,7 +384,7 @@ object MirrorMaker extends Logging with KafkaMetricsGroup {&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   def cleanShutdown() {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (isShuttingdown.compareAndSet(false, true)) {&lt;br/&gt;
+    if (isShuttingDown.compareAndSet(false, true)) {&lt;br/&gt;
       info(&quot;Start clean shutdown.&quot;)&lt;br/&gt;
       // Shutdown consumer threads.&lt;br/&gt;
       info(&quot;Shutting down consumer threads.&quot;)&lt;br/&gt;
@@ -426,7 +426,11 @@ object MirrorMaker extends Logging with KafkaMetricsGroup {&lt;br/&gt;
           try {&lt;br/&gt;
             while (!exitingOnSendFailure &amp;amp;&amp;amp; !shuttingDown &amp;amp;&amp;amp; mirrorMakerConsumer.hasData) {&lt;br/&gt;
               val data = mirrorMakerConsumer.receive()&lt;/li&gt;
	&lt;li&gt;trace(&quot;Sending message with value size %d and offset %d&quot;.format(data.value.length, data.offset))&lt;br/&gt;
+              if (data.value != null) 
{
+                trace(&quot;Sending message with value size %d and offset %d.&quot;.format(data.value.length, data.offset))
+              }
&lt;p&gt; else &lt;/p&gt;
{
+                trace(&quot;Sending message with null value and offset %d.&quot;.format(data.offset))
+              }
&lt;p&gt;               val records = messageHandler.handle(data)&lt;br/&gt;
               records.asScala.foreach(producer.send)&lt;br/&gt;
               maybeFlushAndCommitOffsets()&lt;br/&gt;
@@ -459,7 +463,7 @@ object MirrorMaker extends Logging with KafkaMetricsGroup {&lt;br/&gt;
         shutdownLatch.countDown()&lt;br/&gt;
         info(&quot;Mirror maker thread stopped&quot;)&lt;br/&gt;
         // if it exits accidentally, stop the entire mirror maker&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;if (!isShuttingdown.get()) {&lt;br/&gt;
+        if (!isShuttingDown.get()) 
{
           fatal(&quot;Mirror maker thread exited abnormally, stopping the whole mirror maker.&quot;)
           sys.exit(-1)
         }&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 45 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3oinj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>hachikuji</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>