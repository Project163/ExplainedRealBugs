<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:57:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-4081] Consumer API consumer new interface commitSyn does not verify the validity of offset</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-4081</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Consumer API consumer new interface commitSyn synchronization update offset, for the illegal offset successful return, illegal offset&amp;lt;0 or offset&amp;gt;hw&lt;/p&gt;</description>
                <environment></environment>
        <key id="12999193">KAFKA-4081</key>
            <summary>Consumer API consumer new interface commitSyn does not verify the validity of offset</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mimaison">Mickael Maison</assignee>
                                    <reporter username="menglf">lifeng</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Aug 2016 11:51:54 +0000</created>
                <updated>Fri, 11 Nov 2016 18:38:00 +0000</updated>
                            <resolved>Fri, 11 Nov 2016 18:37:34 +0000</resolved>
                                    <version>0.9.0.1</version>
                                    <fixVersion>0.10.2.0</fixVersion>
                                    <component>clients</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15439258" author="mimaison" created="Fri, 26 Aug 2016 15:24:41 +0000"  >&lt;p&gt;The same happens with 0.10.0.1. Looking at the offset commit logic, the value of the offset is not checked at all.&lt;/p&gt;

&lt;p&gt;It seems some code (ConsumerCoordinator:730) attributes a special meaning to negative offsets. &lt;br/&gt;
One inconsistency I can find is that in the client that commits a negative offset, calls to committed() will return the negative value whereas in clients that just fetch the committed offset it returns nothing. This is because when we commit, it updates the SubscriptionState. This can be seen by using ConsumerGroupCommand, it shows &quot;unknown&quot; for topics that have a negative offset committed.&lt;/p&gt;

&lt;p&gt;Are there use cases we&apos;d break by forcing offsets to be valid when committed ? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ijuma&quot; class=&quot;user-hover&quot; rel=&quot;ijuma&quot;&gt;ijuma&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="15440830" author="menglf" created="Sat, 27 Aug 2016 06:27:48 +0000"  >&lt;p&gt;thanks&lt;/p&gt;

&lt;p&gt;Our new consumer api Each interface has been tested, quality department raised the issue, they think that if kafka as production systems, should have robust.&lt;/p&gt;</comment>
                            <comment id="15447017" author="hachikuji" created="Mon, 29 Aug 2016 20:50:53 +0000"  >&lt;p&gt;I think it definitely makes sense to reject negative values (we currently use -1 to indicate an invalid offset which leads to inconsistent behavior as noted by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mimaison&quot; class=&quot;user-hover&quot; rel=&quot;mimaison&quot;&gt;mimaison&lt;/a&gt;), but rejecting offsets greater than hw seems more challenging since neither the client (nor the server accepting the offset commit) will necessarily have an up-to-date value. We could use the last hw returned from a previous fetch, but it might be stale by the time the user attempts to commit offsets. Perhaps it would make more sense to reject &lt;em&gt;any&lt;/em&gt; offset which is greater than the current position? It would still be possible to commit an invalid offset, but not without an explicit seek to that offset. However, there is a compatibility concern for use cases which use the consumer only for access to the offset API, which could be seen in offset tooling.&lt;/p&gt;</comment>
                            <comment id="15467915" author="githubbot" created="Tue, 6 Sep 2016 16:57:37 +0000"  >&lt;p&gt;GitHub user mimaison opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1827&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1827&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4081&quot; title=&quot;Consumer API consumer new interface commitSyn does not verify the validity of offset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4081&quot;&gt;&lt;del&gt;KAFKA-4081&lt;/del&gt;&lt;/a&gt;: Consumer API consumer new interface commitSync does not v&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;erify the validity of offset&lt;/p&gt;

&lt;p&gt;    Commit throws InvalidOffsetException if the offset is negative&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mimaison/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mimaison/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4081&quot; title=&quot;Consumer API consumer new interface commitSyn does not verify the validity of offset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4081&quot;&gt;&lt;del&gt;KAFKA-4081&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1827.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1827.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1827&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 334f82f60416c511665519362ce23d4ab22cc5fd&lt;br/&gt;
Author: Mickael Maison &amp;lt;mickael.maison@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-09-01T16:41:16Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4081&quot; title=&quot;Consumer API consumer new interface commitSyn does not verify the validity of offset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4081&quot;&gt;&lt;del&gt;KAFKA-4081&lt;/del&gt;&lt;/a&gt;: Consumer API consumer new interface commitSync does not verify the validity of offset&lt;/p&gt;

&lt;p&gt;    Commit throws InvalidOffsetException if the offset is negative&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15504492" author="githubbot" created="Mon, 19 Sep 2016 19:55:21 +0000"  >&lt;p&gt;Github user mimaison closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1827&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1827&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15510415" author="githubbot" created="Wed, 21 Sep 2016 16:16:05 +0000"  >&lt;p&gt;GitHub user mimaison reopened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1827&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1827&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4081&quot; title=&quot;Consumer API consumer new interface commitSyn does not verify the validity of offset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4081&quot;&gt;&lt;del&gt;KAFKA-4081&lt;/del&gt;&lt;/a&gt;: Consumer API consumer new interface commitSync does not v&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;erify the validity of offset&lt;/p&gt;

&lt;p&gt;    Commit throws InvalidOffsetException if the offset is negative&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mimaison/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mimaison/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4081&quot; title=&quot;Consumer API consumer new interface commitSyn does not verify the validity of offset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4081&quot;&gt;&lt;del&gt;KAFKA-4081&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1827.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1827.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1827&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 7ec08416868180422dd6df8e921c9f6027218bfa&lt;br/&gt;
Author: Mickael Maison &amp;lt;mickael.maison@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-09-19T17:22:34Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4081&quot; title=&quot;Consumer API consumer new interface commitSyn does not verify the validity of offset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4081&quot;&gt;&lt;del&gt;KAFKA-4081&lt;/del&gt;&lt;/a&gt;: Consumer API consumer new interface commitSync does not verify the validity of offset&lt;/p&gt;

&lt;p&gt;    Commit will now fail with an IllegalArgumentException when trying to commit an offset that is either negative or larger than the consumer&apos;s current position&lt;/p&gt;

&lt;p&gt;commit e1c1674b8f661e4063e4d5bc04a86ad069a3f317&lt;br/&gt;
Author: Edoardo Comar &amp;lt;ecomar@uk.ibm.com&amp;gt;&lt;br/&gt;
Date:   2016-09-21T16:14:36Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4081&quot; title=&quot;Consumer API consumer new interface commitSyn does not verify the validity of offset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4081&quot;&gt;&lt;del&gt;KAFKA-4081&lt;/del&gt;&lt;/a&gt;: Consumer API consumer new interface commitSync does not&lt;br/&gt;
    verify the validity of offset&lt;/p&gt;

&lt;p&gt;    Commit will now fail with an IllegalArgumentException when trying to&lt;br/&gt;
    commit an offset that is either negative or larger than the consumer&apos;s&lt;br/&gt;
    current position&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15657764" author="hachikuji" created="Fri, 11 Nov 2016 18:37:35 +0000"  >&lt;p&gt;Issue resolved by pull request 1827&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/1827&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1827&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15657766" author="githubbot" created="Fri, 11 Nov 2016 18:38:00 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1827&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1827&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 1 week, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32n7z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>