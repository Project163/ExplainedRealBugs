<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:39:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-1241] Cryptic serde error messages in new producer</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-1241</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;One of the motivations for the new serde format is better error reporting. I was running a test on the new mirror maker when I saw this exception -&lt;/p&gt;

&lt;p&gt;java.nio.BufferUnderflowException&lt;br/&gt;
	at java.nio.Buffer.nextGetIndex(Buffer.java:480)&lt;br/&gt;
	at java.nio.HeapByteBuffer.getInt(HeapByteBuffer.java:336)&lt;br/&gt;
	at kafka.common.protocol.types.Type$3.read(Type.java:88)&lt;br/&gt;
	at kafka.common.protocol.types.Schema.read(Schema.java:50)&lt;br/&gt;
	at kafka.common.protocol.types.ArrayOf.read(ArrayOf.java:30)&lt;br/&gt;
	at kafka.common.protocol.types.Schema.read(Schema.java:50)&lt;br/&gt;
	at kafka.common.protocol.types.ArrayOf.read(ArrayOf.java:30)&lt;br/&gt;
	at kafka.common.protocol.types.Schema.read(Schema.java:50)&lt;br/&gt;
	at kafka.clients.producer.internals.Sender.handleResponses(Sender.java:273)&lt;br/&gt;
	at kafka.clients.producer.internals.Sender.run(Sender.java:144)&lt;br/&gt;
	at kafka.clients.producer.internals.Sender.run(Sender.java:84)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;


&lt;p&gt;I was expecting to see a precise error message about the Request type that serde failed for. Instead it says Type$3 and no information on which field.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12693189">KAFKA-1241</key>
            <summary>Cryptic serde error messages in new producer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jkreps">Jay Kreps</assignee>
                                    <reporter username="nehanarkhede">Neha Narkhede</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Feb 2014 19:11:56 +0000</created>
                <updated>Thu, 20 Mar 2014 21:56:30 +0000</updated>
                            <resolved>Thu, 20 Mar 2014 21:56:30 +0000</resolved>
                                    <version>0.10.1.0</version>
                                                    <component>producer </component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13894185" author="jkreps" created="Fri, 7 Feb 2014 04:23:42 +0000"  >&lt;p&gt;Created reviewboard &lt;a href=&quot;https://reviews.apache.org/r/17836/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/17836/&lt;/a&gt;&lt;br/&gt;
 against branch trunk&lt;/p&gt;</comment>
                            <comment id="13894188" author="jkreps" created="Fri, 7 Feb 2014 04:29:26 +0000"  >&lt;p&gt;I improved the error for that case. I think the rationale was that we CAN have good error messages because all parsing logic is in a single place not that we DO have good errors. Once we fix all the issues like this then we will have good errors &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;We can&apos;t give the request name as the serialization doesn&apos;t know about requests but we can give the field being read and how much it was off by which I think is an improvement.&lt;/p&gt;

&lt;p&gt;All that said this sounds like there is a bug, no? I mean the fact that we get an error is itself an issue irrespective of how good the error message is, right?&lt;/p&gt;</comment>
                            <comment id="13894207" author="nehanarkhede" created="Fri, 7 Feb 2014 05:29:19 +0000"  >&lt;p&gt;Yes, it is a bug I hit during a test with large set of topics on the mirror maker. However, due to absence of logging and the incomplete error message, it is difficult to say what happened. Here is the rest of the stack trace -&lt;/p&gt;

&lt;p&gt;java.lang.IllegalStateException: Attempt to begin a send operation with prior send operation still in progress.&lt;br/&gt;
	at kafka.common.network.Selector.poll(Selector.java:171)&lt;br/&gt;
	at kafka.clients.producer.internals.Sender.run(Sender.java:137)&lt;br/&gt;
	at kafka.clients.producer.internals.Sender.run(Sender.java:84)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;br/&gt;
java.lang.IllegalStateException: Correlation id for response (7401215) does not match request (7401214)&lt;br/&gt;
	at kafka.clients.producer.internals.Sender.correlate(Sender.java:313)&lt;br/&gt;
	at kafka.clients.producer.internals.Sender.handleResponses(Sender.java:274)&lt;br/&gt;
	at kafka.clients.producer.internals.Sender.run(Sender.java:144)&lt;br/&gt;
	at kafka.clients.producer.internals.Sender.run(Sender.java:84)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;br/&gt;
java.nio.BufferUnderflowException&lt;br/&gt;
	at java.nio.Buffer.nextGetIndex(Buffer.java:480)&lt;br/&gt;
	at java.nio.HeapByteBuffer.getInt(HeapByteBuffer.java:336)&lt;br/&gt;
	at kafka.common.protocol.types.Type$3.read(Type.java:88)&lt;br/&gt;
	at kafka.common.protocol.types.Schema.read(Schema.java:50)&lt;br/&gt;
	at kafka.common.protocol.types.ArrayOf.read(ArrayOf.java:30)&lt;br/&gt;
	at kafka.common.protocol.types.Schema.read(Schema.java:50)&lt;br/&gt;
	at kafka.common.protocol.types.ArrayOf.read(ArrayOf.java:30)&lt;br/&gt;
	at kafka.common.protocol.types.Schema.read(Schema.java:50)&lt;br/&gt;
	at kafka.clients.producer.internals.Sender.handleResponses(Sender.java:273)&lt;br/&gt;
	at kafka.clients.producer.internals.Sender.run(Sender.java:144)&lt;br/&gt;
	at kafka.clients.producer.internals.Sender.run(Sender.java:84)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;

</comment>
                            <comment id="13896114" author="jkreps" created="Sun, 9 Feb 2014 23:57:17 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nehanarkhede&quot; class=&quot;user-hover&quot; rel=&quot;nehanarkhede&quot;&gt;nehanarkhede&lt;/a&gt; I think that is a real bug that someone pointed out in the code review, namely that when the metadata refresh happens if it goes to a broker that also gets a produce request in the same iteration it is possible to have two unsent requests at the same time (which we don&apos;t allow). The fix is fairly straight-forward but let me break it into a seperate issue from the error message bug.&lt;/p&gt;

&lt;p&gt;In any case I think the patch I posted fixes the logging in the serialization. I&apos;ll fix up the sender logging when we do the slf4j. So can I get a +1 on this?&lt;/p&gt;</comment>
                            <comment id="13896238" author="nehanarkhede" created="Mon, 10 Feb 2014 05:48:02 +0000"  >&lt;p&gt;Got it. Do you want to fix the issue of better error messages for request types in the Sender in another JIRA then? If so, I&apos;m a +1 on this patch. &lt;/p&gt;</comment>
                            <comment id="13942368" author="jkreps" created="Thu, 20 Mar 2014 21:56:30 +0000"  >&lt;p&gt;I believe this is fixed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12627551" name="KAFKA-1241.patch" size="1607" author="jkreps" created="Fri, 7 Feb 2014 04:23:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>371775</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1s2lb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>372074</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>