<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:42:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-1865] Add a flush() call to the new producer API</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-1865</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;The postconditions of this would be that any record enqueued prior to flush() would have completed being sent (either successfully or not).&lt;/p&gt;

&lt;p&gt;An open question is whether you can continue sending new records while this call is executing (on other threads).&lt;/p&gt;

&lt;p&gt;We should only do this if it doesn&apos;t add inefficiencies for people who don&apos;t use it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12767631">KAFKA-1865</key>
            <summary>Add a flush() call to the new producer API</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jkreps">Jay Kreps</assignee>
                                    <reporter username="jkreps">Jay Kreps</reporter>
                        <labels>
                    </labels>
                <created>Thu, 15 Jan 2015 02:17:15 +0000</created>
                <updated>Thu, 12 Mar 2015 04:06:09 +0000</updated>
                            <resolved>Sat, 28 Feb 2015 23:52:25 +0000</resolved>
                                                    <fixVersion>0.9.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14310590" author="jkreps" created="Sat, 7 Feb 2015 07:04:13 +0000"  >&lt;p&gt;A key aspect of this that isn&apos;t obvious is that flush() has to disable linger.&lt;/p&gt;

&lt;p&gt;That is say I have linger.ms=3000&lt;br/&gt;
If I do &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; 1000; i++)
   producer.send(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ProducerRecord(&lt;span class=&quot;code-quote&quot;&gt;&quot;topic&quot;&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.toString(i));
producer.flush();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The flush call isn&apos;t as simple as just blocking on the record accumulator draining since that would mean waiting an extra 3 seconds during which of course no other records will be written. So flush should trigger immediate send just as close and memory exhaustion do in the record accumulator.&lt;/p&gt;</comment>
                            <comment id="14310927" author="jkreps" created="Sat, 7 Feb 2015 20:59:53 +0000"  >&lt;p&gt;Created reviewboard &lt;a href=&quot;https://reviews.apache.org/r/30763/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/30763/diff/&lt;/a&gt;&lt;br/&gt;
 against branch trunk&lt;/p&gt;</comment>
                            <comment id="14331364" author="jkreps" created="Sat, 21 Feb 2015 23:37:07 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/30763/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/30763/diff/&lt;/a&gt;&lt;br/&gt;
 against branch trunk&lt;/p&gt;</comment>
                            <comment id="14332020" author="jkreps" created="Sun, 22 Feb 2015 04:46:15 +0000"  >&lt;p&gt;Actually this approach is fundamentally flawed. This patch waits on the completion of all requests in the record accumulator but not any requests that have already been sent. To be correct we need to wait on both.&lt;/p&gt;

&lt;p&gt;I think the right approach is to keep a set of all the ProduceRequestResults that are currently incomplete. We would add to this set as soon as a new batch is created and remote it once it is completed. Then flush would just wait on all these.&lt;/p&gt;

&lt;p&gt;I&apos;ll redo this but not tonight.&lt;/p&gt;</comment>
                            <comment id="14332080" author="becket_qin" created="Sun, 22 Feb 2015 08:58:37 +0000"  >&lt;p&gt;Yes you are right, Jay. This approach sounds good. Thanks.&lt;/p&gt;</comment>
                            <comment id="14332450" author="jkreps" created="Mon, 23 Feb 2015 00:26:56 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/30763/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/30763/diff/&lt;/a&gt;&lt;br/&gt;
 against branch trunk&lt;/p&gt;</comment>
                            <comment id="14332452" author="jkreps" created="Mon, 23 Feb 2015 00:28:38 +0000"  >&lt;p&gt;Uploaded a new patch that tracks all incomplete RecordBatch&apos;s in the RecordAccumulator and uses these to block on for flush.&lt;/p&gt;

&lt;p&gt;I was having trouble with test hangs, but I&apos;m not sure if they are related to this patch or not so I haven&apos;t yet validated the tests.&lt;/p&gt;

&lt;p&gt;I also improved the producer javadoc while in there since I was adding docs for flush.&lt;/p&gt;</comment>
                            <comment id="14332459" author="guozhang" created="Mon, 23 Feb 2015 00:43:35 +0000"  >&lt;p&gt;Does it hang on ConsumerTest? Maybe we can disable it for now while I work on fixing the test.&lt;/p&gt;</comment>
                            <comment id="14333471" author="nehanarkhede" created="Mon, 23 Feb 2015 16:34:59 +0000"  >&lt;p&gt;+1 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14334281" author="jkreps" created="Tue, 24 Feb 2015 02:29:29 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/30763/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/30763/diff/&lt;/a&gt;&lt;br/&gt;
 against branch trunk&lt;/p&gt;</comment>
                            <comment id="14337636" author="jkreps" created="Thu, 26 Feb 2015 01:15:37 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/30763/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/30763/diff/&lt;/a&gt;&lt;br/&gt;
 against branch trunk&lt;/p&gt;</comment>
                            <comment id="14338880" author="jkreps" created="Thu, 26 Feb 2015 18:37:27 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/30763/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/30763/diff/&lt;/a&gt;&lt;br/&gt;
 against branch trunk&lt;/p&gt;</comment>
                            <comment id="14338944" author="junrao" created="Thu, 26 Feb 2015 19:18:04 +0000"  >&lt;p&gt;The KIP (&lt;a href=&quot;https://cwiki.apache.org/confluence/display/KAFKA/KIP-8+-+Add+a+flush+method+to+the+producer+API&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/KAFKA/KIP-8+-+Add+a+flush+method+to+the+producer+API&lt;/a&gt;) still says one flush at a time. We will need to change that.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12769805">SAMZA-524</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12767525">KAFKA-1863</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12706818">SAMZA-227</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12697291" name="KAFKA-1865.patch" size="13650" author="jkreps" created="Sat, 7 Feb 2015 20:59:53 +0000"/>
                            <attachment id="12700064" name="KAFKA-1865_2015-02-21_15:36:54.patch" size="24939" author="jkreps" created="Sat, 21 Feb 2015 23:37:06 +0000"/>
                            <attachment id="12700125" name="KAFKA-1865_2015-02-22_16:26:46.patch" size="45585" author="jkreps" created="Mon, 23 Feb 2015 00:26:56 +0000"/>
                            <attachment id="12700315" name="KAFKA-1865_2015-02-23_18:29:16.patch" size="120424" author="jkreps" created="Tue, 24 Feb 2015 02:29:28 +0000"/>
                            <attachment id="12700927" name="KAFKA-1865_2015-02-25_17:15:26.patch" size="121266" author="jkreps" created="Thu, 26 Feb 2015 01:15:37 +0000"/>
                            <attachment id="12701140" name="KAFKA-1865_2015-02-26_10:37:16.patch" size="121267" author="jkreps" created="Thu, 26 Feb 2015 18:37:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 38 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24e6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>