<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:27:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-12701] NPE in MetadataRequest when using topic IDs</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-12701</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Authorized result checking relies on topic name to not be null, which, when using topic IDs, it is.&lt;/p&gt;

&lt;p&gt;Unlike the logic in handleDeleteTopicsRequest, handleMetadataRequest does not check zk for the names corresponding to topic IDs if topic IDs are present.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[2021-04-21 05:53:01,463] ERROR [KafkaApi-1] Error when handling request: clientId=kgo, correlationId=1, api=METADATA, version=11, body=MetadataRequestData(topics=[MetadataRequestTopic(topicId=LmqOoFOASnqQp_4-oJgeKA, name=null)], allowAutoTopicCreation=false, includeClusterAuthorizedOperations=false, includeTopicAuthorizedOperations=false) (kafka.server.RequestHandlerHelper)
java.lang.NullPointerException: name
	at java.base/java.util.Objects.requireNonNull(Unknown Source)
	at org.apache.kafka.common.resource.ResourcePattern.&amp;lt;init&amp;gt;(ResourcePattern.java:50)
	at kafka.server.AuthHelper.$anonfun$filterByAuthorized$3(AuthHelper.scala:121)
	at scala.collection.Iterator$$anon$9.next(Iterator.scala:575)
	at scala.collection.mutable.Growable.addAll(Growable.scala:62)
	at scala.collection.mutable.Growable.addAll$(Growable.scala:57)
	at scala.collection.mutable.ArrayBuffer.addAll(ArrayBuffer.scala:142)
	at scala.collection.mutable.ArrayBuffer.addAll(ArrayBuffer.scala:42)
	at scala.collection.mutable.ArrayBuffer$.from(ArrayBuffer.scala:258)
	at scala.collection.mutable.ArrayBuffer$.from(ArrayBuffer.scala:247)
	at scala.collection.SeqFactory$Delegate.from(Factory.scala:306)
	at scala.collection.IterableOnceOps.toBuffer(IterableOnce.scala:1270)
	at scala.collection.IterableOnceOps.toBuffer$(IterableOnce.scala:1270)
	at scala.collection.AbstractIterator.toBuffer(Iterator.scala:1288)
	at kafka.server.AuthHelper.filterByAuthorized(AuthHelper.scala:120)
	at kafka.server.KafkaApis.handleTopicMetadataRequest(KafkaApis.scala:1146)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:170)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:74)
	at java.base/java.lang.Thread.run(Unknown Source)
[2021-04-21 05:53:01,464] ERROR [Kafka Request Handler 1 on Broker 1], Exception when handling request (kafka.server.KafkaRequestHandler)
java.lang.NullPointerException
	at org.apache.kafka.common.message.MetadataResponseData$MetadataResponseTopic.addSize(MetadataResponseData.java:1247)
	at org.apache.kafka.common.message.MetadataResponseData.addSize(MetadataResponseData.java:417)
	at org.apache.kafka.common.protocol.SendBuilder.buildSend(SendBuilder.java:218)
	at org.apache.kafka.common.protocol.SendBuilder.buildResponseSend(SendBuilder.java:200)
	at org.apache.kafka.common.requests.AbstractResponse.toSend(AbstractResponse.java:43)
	at org.apache.kafka.common.requests.RequestContext.buildResponseSend(RequestContext.java:111)
	at kafka.network.RequestChannel$Request.buildResponseSend(RequestChannel.scala:132)
	at kafka.server.RequestHandlerHelper.sendResponse(RequestHandlerHelper.scala:185)
	at kafka.server.RequestHandlerHelper.sendErrorOrCloseConnection(RequestHandlerHelper.scala:155)
	at kafka.server.RequestHandlerHelper.sendErrorResponseMaybeThrottle(RequestHandlerHelper.scala:109)
	at kafka.server.RequestHandlerHelper.handleError(RequestHandlerHelper.scala:79)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:229)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:74)
	at java.base/java.lang.Thread.run(Unknown Source)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13374025">KAFKA-12701</key>
            <summary>NPE in MetadataRequest when using topic IDs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jolshan">Justine Olshan</assignee>
                                    <reporter username="twmb">Travis Bischel</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Apr 2021 06:21:50 +0000</created>
                <updated>Sun, 22 Aug 2021 03:47:04 +0000</updated>
                            <resolved>Sun, 22 Aug 2021 03:47:04 +0000</resolved>
                                    <version>2.8.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17326297" author="dengziming" created="Wed, 21 Apr 2021 06:52:07 +0000"  >&lt;p&gt;Describe a topic using topicId is not supported in 2.8.0, can you provide your request or command?&lt;/p&gt;</comment>
                            <comment id="17326316" author="twmb" created="Wed, 21 Apr 2021 07:23:00 +0000"  >&lt;p&gt;Metadata v11 is supported in 2.8.0. I&apos;ve added support for specifying topic IDs in my &lt;tt&gt;kcl&lt;/tt&gt; command line client &lt;a href=&quot;https://github.com/twmb/kcl/commit/a09f6f8cca4f87b878d943a2bed4ef8ed2e10a7e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; (you&apos;d need to build off of master if you want to test this yourself).&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[01:20:51]
twmb@h4x3r:~
$ kcl admin topic create foo
NAME  ID                                MESSAGE
foo   6a62c01129a341c8a0231f7b3c21bc9b  OK

[01:20:57]
twmb@h4x3r:~
$ kcl metadata -t --ids 6a62c01129a341c8a0231f7b3c21bc9b
^C

[01:21:11]
twmb@h4x3r:~
$ kcl metadata -t foo
NAME  ID                                PARTITIONS  REPLICAS
foo   6a62c01129a341c8a0231f7b3c21bc9b  20          1

[01:21:16]
twmb@h4x3r:~
$ kcl admin topic delete --ids 6a62c01129a341c8a0231f7b3c21bc9b
foo   OK
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What this is doing is issuing a metadata request that has a single topic where the topic name is null and the topic ID is the hex-decoded ID that is passed in.&lt;/p&gt;</comment>
                            <comment id="17326392" author="dengziming" created="Wed, 21 Apr 2021 09:18:11 +0000"  >&lt;p&gt;In fact, we first planned to support topicId in MetadataRequest and MetadataResponse, and we added 2 tickets &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-10547&quot; title=&quot;Add topic IDs to MetadataResponse&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-10547&quot;&gt;&lt;del&gt;KAFKA-10547&lt;/del&gt;&lt;/a&gt; and &#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-10774&quot; title=&quot;Support Describe topic using topic IDs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-10774&quot;&gt;&lt;del&gt;KAFKA-10774&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;though &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-10547&quot; title=&quot;Add topic IDs to MetadataResponse&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-10547&quot;&gt;&lt;del&gt;KAFKA-10547&lt;/del&gt;&lt;/a&gt; add topicId in MetadataResponse and MetadataRequest, describe topic using topicId is supported by &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-10774&quot; title=&quot;Support Describe topic using topic IDs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-10774&quot;&gt;&lt;del&gt;KAFKA-10774&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;sadly &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-10547&quot; title=&quot;Add topic IDs to MetadataResponse&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-10547&quot;&gt;&lt;del&gt;KAFKA-10547&lt;/del&gt;&lt;/a&gt; PR was merged but &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-10774&quot; title=&quot;Support Describe topic using topic IDs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-10774&quot;&gt;&lt;del&gt;KAFKA-10774&lt;/del&gt;&lt;/a&gt; PR was held off, for more details: &lt;a href=&quot;https://github.com/apache/kafka/pull/9769#issuecomment-772830472&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/9769#issuecomment-772830472&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think this is a bug so we should fix this for 2.8.0, I will submit a PR target at 2.8.0 to remove TopicID from MetadataRequest since it isn&apos;t supported.&lt;/p&gt;</comment>
                            <comment id="17326628" author="jolshan" created="Wed, 21 Apr 2021 15:24:31 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twmb&quot; class=&quot;user-hover&quot; rel=&quot;twmb&quot;&gt;twmb&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dengziming&quot; class=&quot;user-hover&quot; rel=&quot;dengziming&quot;&gt;dengziming&lt;/a&gt; for taking a look at this. I am not sure this is something for 2.8.0 since that release has already passed the vote. I&apos;m thinking that this is ok. We should still fix for 3.0 and possibly 2.8.x though. Does that make sense?&lt;/p&gt;</comment>
                            <comment id="17326633" author="ijuma" created="Wed, 21 Apr 2021 15:29:00 +0000"  >&lt;p&gt;I suggest fixing it in 3.0.0 and 2.8.1.&lt;/p&gt;</comment>
                            <comment id="17326652" author="jolshan" created="Wed, 21 Apr 2021 15:41:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dengziming&quot; class=&quot;user-hover&quot; rel=&quot;dengziming&quot;&gt;dengziming&lt;/a&gt; Just to clarify, we did not yet implement functionality to handle using topic IDs in MetadataRequest. So even if we get past the NPE, we wouldn&apos;t handle the topic ID yet. That will be added in &lt;a href=&quot;https://github.com/apache/kafka/pull/9769&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/9769&lt;/a&gt;, correct? Maybe for 2.8.1 we can return an error that the operation is not yet supported for v11 requests. We&apos;ll have to add this to trunk too. Then in &lt;a href=&quot;https://github.com/apache/kafka/pull/9769&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/9769&lt;/a&gt;, we bump the protocol to v12 so that the clients know that topic IDs are supported.&lt;/p&gt;</comment>
                            <comment id="17326909" author="jolshan" created="Wed, 21 Apr 2021 20:50:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dengziming&quot; class=&quot;user-hover&quot; rel=&quot;dengziming&quot;&gt;dengziming&lt;/a&gt; I can work on the part where we return an error for earlier versions if you haven&apos;t started on that already.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 29 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0q9xs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>