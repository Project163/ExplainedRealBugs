<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:56:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-4153] Incorrect KStream-KStream join behavior with asymmetric time window</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-4153</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Using Kafka 0.10.0.1, if joining records in two streams separated by some time, but only when records from one stream are newer than records from the other, i.e. doing:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;stream1.join(stream2, valueJoiner, JoinWindows.of(&quot;X&quot;).after(10000))&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;One would expect that the following would be equivalent:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;stream2.join(stream1, valueJoiner, JoinWindows.of(&quot;X&quot;).before(10000))&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Alas, that this is not the case.  Instead, this generates the same output as the first example:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;stream2.join(stream1, valueJoiner, JoinWindows.of(&quot;X&quot;).after(10000))&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;The problem is that the &lt;a href=&quot;https://github.com/apache/kafka/blob/caa9bd0fcd2fab4758791408e2b145532153910e/streams/src/main/java/org/apache/kafka/streams/kstream/internals/KStreamImpl.java#L692-L697&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;DefaultJoin&lt;/tt&gt;&lt;/a&gt; implementation in &lt;tt&gt;KStreamImpl&lt;/tt&gt; fails to reverse the &lt;tt&gt;before&lt;/tt&gt; and &lt;tt&gt;after&lt;/tt&gt; values when creates the &lt;tt&gt;KStreamKStreamJoin&lt;/tt&gt; for the other stream, even though is calls &lt;tt&gt;reverseJoiner&lt;/tt&gt; to reverse the joiner.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13004444">KAFKA-4153</key>
            <summary>Incorrect KStream-KStream join behavior with asymmetric time window</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="elevy">Elias Levy</assignee>
                                    <reporter username="elevy">Elias Levy</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Sep 2016 22:39:36 +0000</created>
                <updated>Tue, 20 Sep 2016 00:16:05 +0000</updated>
                            <resolved>Tue, 20 Sep 2016 00:14:11 +0000</resolved>
                                    <version>0.10.0.1</version>
                                    <fixVersion>0.10.1.0</fixVersion>
                                    <component>streams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15485524" author="githubbot" created="Mon, 12 Sep 2016 22:45:25 +0000"  >&lt;p&gt;GitHub user eliaslevy opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1846&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1846&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4153&quot; title=&quot;Incorrect KStream-KStream join behavior with asymmetric time window&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4153&quot;&gt;&lt;del&gt;KAFKA-4153&lt;/del&gt;&lt;/a&gt;: Fix incorrect KStream-KStream join behavior with asymmetric time window&lt;/p&gt;

&lt;p&gt;    The contribution is my original work and I license the work to the project under the project&apos;s open source license.&lt;/p&gt;

&lt;p&gt;    @guozhangwang&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/eliaslevy/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/eliaslevy/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4153&quot; title=&quot;Incorrect KStream-KStream join behavior with asymmetric time window&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4153&quot;&gt;&lt;del&gt;KAFKA-4153&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1846.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1846.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1846&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit a82897f5e4933698c95de1a77ae6ae6f4c721743&lt;br/&gt;
Author: Elias Levy &amp;lt;fearsome.lucidity@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-09-12T22:27:34Z&lt;/p&gt;

&lt;p&gt;    Swap before &amp;amp; after values for other KStreamKstreamJoin&lt;/p&gt;

&lt;p&gt;commit 05721ca926321e298fbd3481c96db176dfec9716&lt;br/&gt;
Author: Elias Levy &amp;lt;fearsome.lucidity@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-09-12T22:28:37Z&lt;/p&gt;

&lt;p&gt;    Add tests for asymetric window stream-stream joins&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15485561" author="elevy" created="Mon, 12 Sep 2016 22:59:29 +0000"  >&lt;p&gt;As a side note, the API for &lt;tt&gt;JoinWindows&lt;/tt&gt; has become mangled since 0.10.0.1.  Now if you want to instantiate an asymetric &lt;tt&gt;JoinWindows&lt;/tt&gt; you must first call &lt;tt&gt;JoinWindows.of(0)&lt;/tt&gt; before you can call &lt;tt&gt;before&lt;/tt&gt; or &lt;tt&gt;after&lt;/tt&gt; to set to actual window boundaries.  The class should provide alternative static method for both &lt;tt&gt;before&lt;/tt&gt; and &lt;tt&gt;after&lt;/tt&gt; to instantiate the class without having to first call &lt;tt&gt;of&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15485638" author="mjsax" created="Mon, 12 Sep 2016 23:37:08 +0000"  >&lt;p&gt;Well, you can just call &lt;tt&gt;JoinWindows.of(before).after(after)&lt;/tt&gt; (or reverse). However, it might be good to add &lt;tt&gt;JoinWindows#of(long before, long after)&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15485700" author="elevy" created="Tue, 13 Sep 2016 00:00:27 +0000"  >&lt;p&gt;You could do that, but it would be non-obvious to someone reading the code what the semantics of that window should be.&lt;/p&gt;

&lt;p&gt;I would prefer seeing &lt;tt&gt;before&lt;/tt&gt; and &lt;tt&gt;after&lt;/tt&gt; have static alternatives, so you could write &lt;tt&gt;JoinWindows.before(100).after(50)&lt;/tt&gt; or similar.&lt;/p&gt;</comment>
                            <comment id="15485759" author="mjsax" created="Tue, 13 Sep 2016 00:25:57 +0000"  >&lt;p&gt;IMHO &lt;tt&gt;JoinWindows.before(100).after(50)&lt;/tt&gt; would not be a good choice &amp;#8211; the user could just call only &lt;tt&gt;JoinWindows.before(100)&lt;/tt&gt; creating a window with undefined value for after. For me, the API should ensure, that defining and invalid window is not possible (instead of check for this condition and throw an exception later on).&lt;/p&gt;</comment>
                            <comment id="15485826" author="elevy" created="Tue, 13 Sep 2016 00:58:24 +0000"  >&lt;p&gt;Why would the other value be undefined? Default it to zero.&lt;/p&gt;</comment>
                            <comment id="15491329" author="guozhang" created="Wed, 14 Sep 2016 20:05:24 +0000"  >&lt;p&gt;According to the stated Java doc string, &lt;tt&gt;JoinWindows&lt;/tt&gt; definition should be reversed as it states that, for example in &lt;tt&gt;before&lt;/tt&gt; function, &lt;tt&gt;if the timestamp of a record from the secondary stream is earlier than or equal to the timestamp of a record from the first stream&lt;/tt&gt;. It is indeed a bug that should be fixed, we can review the PR and merge it.&lt;/p&gt;

&lt;p&gt;As for defining asymmetric &lt;tt&gt;JoinWindows&lt;/tt&gt;, I think it is better to add to the current &lt;tt&gt;before&lt;/tt&gt; &lt;tt&gt;after&lt;/tt&gt; functions with static constructors, as it is for defining the &quot;length&quot; of the window as final values that should not be overridden later. &lt;/p&gt;</comment>
                            <comment id="15491553" author="elevy" created="Wed, 14 Sep 2016 21:56:43 +0000"  >&lt;p&gt;I&apos;ve updated the PR to reverse the before &amp;amp; after semantics as you&apos;ve pointed out.&lt;/p&gt;</comment>
                            <comment id="15505112" author="guozhang" created="Tue, 20 Sep 2016 00:14:11 +0000"  >&lt;p&gt;Issue resolved by pull request 1846&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/1846&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1846&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15505113" author="githubbot" created="Tue, 20 Sep 2016 00:14:35 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1846&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1846&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15505117" author="guozhang" created="Tue, 20 Sep 2016 00:16:05 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=elevy&quot; class=&quot;user-hover&quot; rel=&quot;elevy&quot;&gt;elevy&lt;/a&gt;, I have added you to the contributor list so you can assign tickets to yourself moving forward.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33jkv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>