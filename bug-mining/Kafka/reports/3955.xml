<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:40:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-17766] TopicBasedRemoteLogMetadataManager stuck in close</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-17766</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;During a CI run, there was a timed out build due to this class stuck in its close method.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;Test worker&quot;&lt;/span&gt; #1 prio=5 os_prio=0 cpu=9155.23ms elapsed=9615.57s tid=0x00007fcc80029800 nid=0x1f12 in &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait() &#160;[0x00007fcc853f9000]
&#160; &#160;java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (on object monitor)
&#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(java.base@11.0.24/Native Method)
&#160; &#160; - waiting on &amp;lt;no object reference available&amp;gt;
&#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.join(java.base@11.0.24/&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:1300)
&#160; &#160; - waiting to re-lock in wait() &amp;lt;0x000000008189e9f8&amp;gt; (a org.apache.kafka.common.utils.KafkaThread)
&#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.join(java.base@11.0.24/&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:1375)
&#160; &#160; at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.close(TopicBasedRemoteLogMetadataManager.java:575) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;RLMMInitializationThread&quot;&lt;/span&gt; #9511 prio=5 os_prio=0 cpu=1.40ms elapsed=9222.98s tid=0x00007fcc8196f800 nid=0x12ef2 waiting on condition &#160;[0x00007fcbe05fe000]
&#160; &#160;java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (parking)
&#160; &#160; at jdk.internal.misc.Unsafe.park(java.base@11.0.24/Native Method)
&#160; &#160; - parking to wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &#160;&amp;lt;0x0000000081e364c0&amp;gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync)
&#160; &#160; at java.util.concurrent.locks.LockSupport.park(java.base@11.0.24/LockSupport.java:194)
&#160; &#160; at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(java.base@11.0.24/AbstractQueuedSynchronizer.java:885)
&#160; &#160; at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(java.base@11.0.24/AbstractQueuedSynchronizer.java:917)
&#160; &#160; at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(java.base@11.0.24/AbstractQueuedSynchronizer.java:1240)
&#160; &#160; at java.util.concurrent.locks.ReentrantReadWriteLock$WriteLock.lock(java.base@11.0.24/ReentrantReadWriteLock.java:959)
&#160; &#160; at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.initializeResources(TopicBasedRemoteLogMetadataManager.java:432)
&#160; &#160; at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager$$Lambda$2007/0x0000000100934c40.run(Unknown Source)
&#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(java.base@11.0.24/&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:829) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;It seems we are joining the initialization thread assuming that it has (or will) complete. This appears to be a lock race between the close method and the initialization thread which results in a dead lock.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13594928">KAFKA-17766</key>
            <summary>TopicBasedRemoteLogMetadataManager stuck in close</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="anshul35">Anshul Goyal</assignee>
                                    <reporter username="davidarthur">David Arthur</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Oct 2024 14:16:53 +0000</created>
                <updated>Fri, 18 Oct 2024 12:28:35 +0000</updated>
                            <resolved>Fri, 18 Oct 2024 12:15:51 +0000</resolved>
                                                    <fixVersion>4.0.0</fixVersion>
                                    <component>build</component>
                    <component>Tiered-Storage</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17888306" author="davidarthur" created="Thu, 10 Oct 2024 14:20:59 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=satish.duggana&quot; class=&quot;user-hover&quot; rel=&quot;satish.duggana&quot;&gt;satish.duggana&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ckamal&quot; class=&quot;user-hover&quot; rel=&quot;ckamal&quot;&gt;ckamal&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17888407" author="JIRAUSER307298" created="Thu, 10 Oct 2024 19:20:46 +0000"  >&lt;p&gt;New To contributing to Kafka. But have experience with Java concurrent APIs.&lt;/p&gt;

&lt;p&gt;Can I try this one ?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davidarthur&quot; class=&quot;user-hover&quot; rel=&quot;davidarthur&quot;&gt;davidarthur&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=satishd&quot; class=&quot;user-hover&quot; rel=&quot;satishd&quot;&gt;satishd&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17888596" author="satish.duggana" created="Fri, 11 Oct 2024 10:32:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anshul35&quot; class=&quot;user-hover&quot; rel=&quot;anshul35&quot;&gt;anshul35&lt;/a&gt; You can try looking into it. You can ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ckamal&quot; class=&quot;user-hover&quot; rel=&quot;ckamal&quot;&gt;ckamal&lt;/a&gt; or me once you have an initial analysis.&lt;/p&gt;</comment>
                            <comment id="17889036" author="JIRAUSER307298" created="Sun, 13 Oct 2024 19:19:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ckamal&quot; class=&quot;user-hover&quot; rel=&quot;ckamal&quot;&gt;ckamal&lt;/a&gt; Could you have a look at my approach here : &lt;a href=&quot;https://github.com/apache/kafka/pull/17492&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/17492&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks In Advance.&#160;&lt;/p&gt;</comment>
                            <comment id="17889298" author="JIRAUSER307298" created="Mon, 14 Oct 2024 18:16:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=satish.duggana&quot; class=&quot;user-hover&quot; rel=&quot;satish.duggana&quot;&gt;satish.duggana&lt;/a&gt;&#160; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ckamal&quot; class=&quot;user-hover&quot; rel=&quot;ckamal&quot;&gt;ckamal&lt;/a&gt;&#160;Could you have a look at my approach here :&#160;&lt;a href=&quot;https://github.com/apache/kafka/pull/17492&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/17492&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks In Advance.&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13072115" name="GradleWorkerMain-7952.txt" size="258321" author="davidarthur" created="Thu, 10 Oct 2024 13:52:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1rwh4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>