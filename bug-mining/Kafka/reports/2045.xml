<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:14:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-5690] kafka-acls command should be able to list per principal</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-5690</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Currently the `kafka-acls` command has a `--list` option that can list per resource which is --topic &amp;lt;topic&amp;gt; or --group &amp;lt;group&amp;gt; or --cluster. In order to look at the ACLs for a particular principal the user needs to iterate through the entire list to figure out what privileges a particular principal has been granted. An option to list the ACL per principal would simplify this process.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13091680">KAFKA-5690</key>
            <summary>kafka-acls command should be able to list per principal</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="omkreddy">Manikumar</assignee>
                                    <reporter username="Koelli">Koelli Mungee</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Aug 2017 20:55:52 +0000</created>
                <updated>Tue, 25 Sep 2018 06:57:17 +0000</updated>
                            <resolved>Mon, 17 Sep 2018 16:40:19 +0000</resolved>
                                    <version>0.10.2.0</version>
                    <version>0.11.0.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16109937" author="sddasgu" created="Tue, 1 Aug 2017 22:48:41 +0000"  >&lt;p&gt;Yes, this will be really useful. If I created a &#8220;super-user type&#8221; principal (not to be confused with the real super users described in server.properties) and granted it all the privileges (READ, WRITE, DESCRIBE, CLUSTERACTION etc) on all TOPICS, GROUPS and the CLUSTER, there should be some way to list the privileges granted to that principal.&lt;/p&gt;

&lt;p&gt;Rational is: Say we create the above ACL for the principal, this principal come and produce/consume for all topics and groups, there should some way to list which principal has these privileges, that support does not exist today in Kafka. This is important for audit purposes&lt;/p&gt;</comment>
                            <comment id="16110080" author="huxi_2b" created="Wed, 2 Aug 2017 01:02:38 +0000"  >&lt;p&gt;I am seeing this jira as an improvement instead of a bug since other people possibly prefer showing acls by resource, so a new KIP might be required. Maybe a new parameter could be introduced to control whether it&apos;s showing by resource or by principal.&lt;/p&gt;</comment>
                            <comment id="16110287" author="sddasgu" created="Wed, 2 Aug 2017 04:32:00 +0000"  >&lt;p&gt;Here is the crux of the requirement, once I set up the acl to grant the principal all the operations to all the resources, there is no way for me to view the privileges granted to that principal&lt;/p&gt;

&lt;p&gt;On 8/1/17, 8:39 PM, &quot;huxihx (JIRA)&quot; &amp;lt;jira@apache.org&amp;gt; wrote:&lt;/p&gt;


&lt;p&gt;        [ &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5690?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=16110080#comment-16110080&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-5690?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=16110080#comment-16110080&lt;/a&gt; ] &lt;/p&gt;

&lt;p&gt;    huxihx edited comment on &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5690&quot; title=&quot;kafka-acls command should be able to list per principal&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5690&quot;&gt;&lt;del&gt;KAFKA-5690&lt;/del&gt;&lt;/a&gt; at 8/2/17 3:38 AM:&lt;br/&gt;
    -------------------------------------------------------&lt;/p&gt;

&lt;p&gt;    I am seeing this jira as an improvement instead of a bug since other people possibly prefer showing acls by resource, so a new KIP might be required. Maybe a new parameter could be introduced to control whether it&apos;s showing by resource or by principal.&lt;/p&gt;


&lt;p&gt;    was (Author: huxi_2b):&lt;br/&gt;
    I am seeing this jira as an improvement instead of a bug since other people prefer showing acls by resource, so a new KIP might be required. Maybe a new parameter could be introduced to control whether it&apos;s showing by resource or by principal.&lt;/p&gt;

&lt;p&gt;    &amp;gt; kafka-acls command should be able to list per principal&lt;br/&gt;
    &amp;gt; -------------------------------------------------------&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt;                 Key: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5690&quot; title=&quot;kafka-acls command should be able to list per principal&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5690&quot;&gt;&lt;del&gt;KAFKA-5690&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
    &amp;gt;                 URL: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5690&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-5690&lt;/a&gt;&lt;br/&gt;
    &amp;gt;             Project: Kafka&lt;br/&gt;
    &amp;gt;          Issue Type: Bug&lt;br/&gt;
    &amp;gt;          Components: core&lt;br/&gt;
    &amp;gt;    Affects Versions: 0.10.2.0, 0.11.0.0&lt;br/&gt;
    &amp;gt;            Reporter: Koelli Mungee&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; Currently the `kafka-acls` command has a `--list` option that can list per resource which is --topic &amp;lt;topic&amp;gt; or --group &amp;lt;group&amp;gt; or --cluster. In order to look at the ACLs for a particular principal the user needs to iterate through the entire list to figure out what privileges a particular principal has been granted. An option to list the ACL per principal would simplify this process.&lt;/p&gt;



&lt;p&gt;    &amp;#8211;&lt;br/&gt;
    This message was sent by Atlassian JIRA&lt;br/&gt;
    (v6.4.14#64029)&lt;/p&gt;




&lt;p&gt;American Express made the following annotations&lt;br/&gt;
******************************************************************************&lt;br/&gt;
&quot;This message and any attachments are solely for the intended recipient and may contain confidential or privileged information. If you are not the intended recipient, any disclosure, copying, use, or distribution of the information included in this message and any attachments is prohibited. If you have received this communication in error, please notify us by reply e-mail and immediately and permanently delete this message and any attachments. Thank you.&quot;&lt;/p&gt;

&lt;p&gt;American Express a ajout&#233; le commentaire suivant le Ce courrier et toute pi&#232;ce jointe qu&apos;il contient sont r&#233;serv&#233;s au seul destinataire indiqu&#233; et peuvent renfermer des &lt;br/&gt;
renseignements confidentiels et privil&#233;gi&#233;s. Si vous n&apos;&#234;tes pas le destinataire pr&#233;vu, toute divulgation, duplication, utilisation ou distribution du courrier ou de toute pi&#232;ce jointe est interdite. Si vous avez re&#231;u cette communication par erreur, veuillez nous en aviser par courrier et d&#233;truire imm&#233;diatement le courrier et les pi&#232;ces jointes. Merci.&lt;/p&gt;

&lt;p&gt;******************************************************************************&lt;/p&gt;</comment>
                            <comment id="16609380" author="githubbot" created="Mon, 10 Sep 2018 15:21:58 +0000"  >&lt;p&gt;omkreddy opened a new pull request #5633: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5690&quot; title=&quot;kafka-acls command should be able to list per principal&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5690&quot;&gt;&lt;del&gt;KAFKA-5690&lt;/del&gt;&lt;/a&gt;: Add support to list ACLs for a given principal (KIP-357)&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5633&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5633&lt;/a&gt;&lt;/p&gt;




&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16616616" author="githubbot" created="Sun, 16 Sep 2018 07:13:47 +0000"  >&lt;p&gt;lindong28 closed pull request #5633: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5690&quot; title=&quot;kafka-acls command should be able to list per principal&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5690&quot;&gt;&lt;del&gt;KAFKA-5690&lt;/del&gt;&lt;/a&gt;: Add support to list ACLs for a given principal (KIP-357)&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5633&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5633&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/core/src/main/scala/kafka/admin/AclCommand.scala b/core/src/main/scala/kafka/admin/AclCommand.scala&lt;br/&gt;
index c2dda33d5ab..ad375d20572 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/admin/AclCommand.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/admin/AclCommand.scala&lt;br/&gt;
@@ -138,10 +138,22 @@ object AclCommand extends Logging {&lt;br/&gt;
     def listAcls(): Unit = {&lt;br/&gt;
       withAdminClient(opts) { adminClient =&amp;gt;&lt;br/&gt;
         val filters = getResourceFilter(opts, dieIfNoResourceFound = false)&lt;br/&gt;
+        val listPrincipals = getPrincipals(opts, opts.listPrincipalsOpt)&lt;br/&gt;
         val resourceToAcls = getAcls(adminClient, filters)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;for ((resource, acls) &amp;lt;- resourceToAcls)&lt;/li&gt;
	&lt;li&gt;println(s&quot;Current ACLs for resource `$resource`: $Newline ${acls.map(&quot;\t&quot; + _).mkString(Newline)} $Newline&quot;)&lt;br/&gt;
+        if (listPrincipals.isEmpty) {&lt;br/&gt;
+          for ((resource, acls) &amp;lt;- resourceToAcls)&lt;br/&gt;
+            println(s&quot;Current ACLs for resource `$resource`: $Newline ${acls.map(&quot;\t&quot; + _).mkString(Newline)} $Newline&quot;)&lt;br/&gt;
+        } else {&lt;br/&gt;
+          listPrincipals.foreach(principal =&amp;gt; {&lt;br/&gt;
+            println(s&quot;ACLs for principal `$principal`&quot;)&lt;br/&gt;
+            val filteredResourceToAcls =  resourceToAcls.mapValues(acls =&amp;gt;&lt;br/&gt;
+              acls.filter(acl =&amp;gt; principal.toString.equals(acl.principal))).filter(entry =&amp;gt; entry._2.nonEmpty)&lt;br/&gt;
+&lt;br/&gt;
+            for ((resource, acls) &amp;lt;- filteredResourceToAcls)&lt;br/&gt;
+              println(s&quot;Current ACLs for resource `$resource`: $Newline ${acls.map(&quot;\t&quot; + _).mkString(Newline)} $Newline&quot;)&lt;br/&gt;
+          })&lt;br/&gt;
+        }&lt;br/&gt;
       }&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -237,13 +249,20 @@ object AclCommand extends Logging {&lt;br/&gt;
     def listAcls(): Unit = {&lt;br/&gt;
       withAuthorizer() { authorizer =&amp;gt;&lt;br/&gt;
         val filters = getResourceFilter(opts, dieIfNoResourceFound = false)&lt;br/&gt;
+        val listPrincipals = getPrincipals(opts, opts.listPrincipalsOpt)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val resourceToAcls: Iterable[(Resource, Set&lt;span class=&quot;error&quot;&gt;&amp;#91;Acl&amp;#93;&lt;/span&gt;)] =&lt;/li&gt;
	&lt;li&gt;if (filters.isEmpty) authorizer.getAcls()&lt;/li&gt;
	&lt;li&gt;else filters.flatMap(filter =&amp;gt; getAcls(authorizer, filter))&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;for ((resource, acls) &amp;lt;- resourceToAcls)&lt;/li&gt;
	&lt;li&gt;println(s&quot;Current ACLs for resource `$resource`: $Newline ${acls.map(&quot;\t&quot; + _).mkString(Newline)} $Newline&quot;)&lt;br/&gt;
+        if (listPrincipals.isEmpty) {&lt;br/&gt;
+          val resourceToAcls =  getFilteredResourceToAcls(authorizer, filters)&lt;br/&gt;
+          for ((resource, acls) &amp;lt;- resourceToAcls)&lt;br/&gt;
+            println(s&quot;Current ACLs for resource `$resource`: $Newline ${acls.map(&quot;\t&quot; + _).mkString(Newline)} $Newline&quot;)&lt;br/&gt;
+        } else {&lt;br/&gt;
+          listPrincipals.foreach(principal =&amp;gt; {&lt;br/&gt;
+            println(s&quot;ACLs for principal `$principal`&quot;)&lt;br/&gt;
+            val resourceToAcls =  getFilteredResourceToAcls(authorizer, filters, Some(principal))&lt;br/&gt;
+            for ((resource, acls) &amp;lt;- resourceToAcls)&lt;br/&gt;
+              println(s&quot;Current ACLs for resource `$resource`: $Newline ${acls.map(&quot;\t&quot; + _).mkString(Newline)} $Newline&quot;)&lt;br/&gt;
+          })&lt;br/&gt;
+        }&lt;br/&gt;
       }&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -256,9 +275,23 @@ object AclCommand extends Logging &lt;/p&gt;
{
         )
     }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private def getAcls(authorizer: Authorizer, filter: ResourcePatternFilter): Map[Resource, Set&lt;span class=&quot;error&quot;&gt;&amp;#91;Acl&amp;#93;&lt;/span&gt;] =&lt;/li&gt;
	&lt;li&gt;authorizer.getAcls()&lt;/li&gt;
	&lt;li&gt;.filter 
{ case (resource, acl) =&amp;gt; filter.matches(resource.toPattern) }&lt;br/&gt;
+    private def getFilteredResourceToAcls(authorizer: Authorizer, filters: Set&lt;span class=&quot;error&quot;&gt;&amp;#91;ResourcePatternFilter&amp;#93;&lt;/span&gt;,&lt;br/&gt;
+                                          listPrincipal: Option&lt;span class=&quot;error&quot;&gt;&amp;#91;KafkaPrincipal&amp;#93;&lt;/span&gt; = None): Iterable[(Resource, Set&lt;span class=&quot;error&quot;&gt;&amp;#91;Acl&amp;#93;&lt;/span&gt;)] = {
+      if (filters.isEmpty)
+        if (listPrincipal.isEmpty)
+          authorizer.getAcls()
+        else
+          authorizer.getAcls(listPrincipal.get)
+      else filters.flatMap(filter =&amp;gt; getAcls(authorizer, filter, listPrincipal))
+    }&lt;br/&gt;
+&lt;br/&gt;
+    private def getAcls(authorizer: Authorizer, filter: ResourcePatternFilter,&lt;br/&gt;
+                        listPrincipal: Option&lt;span class=&quot;error&quot;&gt;&amp;#91;KafkaPrincipal&amp;#93;&lt;/span&gt; = None): Map[Resource, Set&lt;span class=&quot;error&quot;&gt;&amp;#91;Acl&amp;#93;&lt;/span&gt;] =&lt;br/&gt;
+      if (listPrincipal.isEmpty)&lt;br/&gt;
+        authorizer.getAcls().filter { case (resource, acl) =&amp;gt; filter.matches(resource.toPattern) }
&lt;p&gt;+      else&lt;br/&gt;
+        authorizer.getAcls(listPrincipal.get).filter &lt;/p&gt;
{ case (resource, acl) =&amp;gt; filter.matches(resource.toPattern) }
&lt;p&gt;+&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private def getResourceToAcls(opts: AclCommandOptions): Map[Resource, Set&lt;span class=&quot;error&quot;&gt;&amp;#91;Acl&amp;#93;&lt;/span&gt;] = {&lt;br/&gt;
@@ -521,6 +554,12 @@ object AclCommand extends Logging {&lt;br/&gt;
       .describedAs(&quot;deny-principal&quot;)&lt;br/&gt;
       .ofType(classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;)&lt;/p&gt;

&lt;p&gt;+    val listPrincipalsOpt = parser.accepts(&quot;principal&quot;, &quot;List ACLs for the specified principal. principal is in principalType:name format.&quot; +&lt;br/&gt;
+      &quot; Note that principalType must be supported by the Authorizer being used. Multiple --principal option can be passed.&quot;)&lt;br/&gt;
+      .withOptionalArg()&lt;br/&gt;
+      .describedAs(&quot;principal&quot;)&lt;br/&gt;
+      .ofType(classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;)&lt;br/&gt;
+&lt;br/&gt;
     val allowHostsOpt = parser.accepts(&quot;allow-host&quot;, &quot;Host from which principals listed in --allow-principal will have access. &quot; +&lt;br/&gt;
       &quot;If you have specified --allow-principal then the default for this option will be set to * which allows access from all hosts.&quot;)&lt;br/&gt;
       .withRequiredArg&lt;br/&gt;
@@ -568,6 +607,9 @@ object AclCommand extends Logging {&lt;br/&gt;
       CommandLineUtils.checkInvalidArgs(parser, options, producerOpt, Set(operationsOpt, denyPrincipalsOpt, denyHostsOpt))&lt;br/&gt;
       CommandLineUtils.checkInvalidArgs(parser, options, consumerOpt, Set(operationsOpt, denyPrincipalsOpt, denyHostsOpt))&lt;/p&gt;

&lt;p&gt;+      if (options.has(listPrincipalsOpt) &amp;amp;&amp;amp; !options.has(listOpt))&lt;br/&gt;
+        CommandLineUtils.printUsageAndDie(parser, &quot;The --principal option is only available if --list is set&quot;)&lt;br/&gt;
+&lt;br/&gt;
       if (options.has(producerOpt) &amp;amp;&amp;amp; !options.has(topicOpt))&lt;br/&gt;
         CommandLineUtils.printUsageAndDie(parser, &quot;With --producer you must specify a --topic&quot;)&lt;/p&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16616617" author="githubbot" created="Sun, 16 Sep 2018 07:14:48 +0000"  >&lt;p&gt;omkreddy opened a new pull request #5633: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5690&quot; title=&quot;kafka-acls command should be able to list per principal&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5690&quot;&gt;&lt;del&gt;KAFKA-5690&lt;/del&gt;&lt;/a&gt;: Add support to list ACLs for a given principal (KIP-357)&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5633&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5633&lt;/a&gt;&lt;/p&gt;




&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16617784" author="githubbot" created="Mon, 17 Sep 2018 16:36:55 +0000"  >&lt;p&gt;lindong28 closed pull request #5633: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5690&quot; title=&quot;kafka-acls command should be able to list per principal&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5690&quot;&gt;&lt;del&gt;KAFKA-5690&lt;/del&gt;&lt;/a&gt;: Add support to list ACLs for a given principal (KIP-357)&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5633&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5633&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/core/src/main/scala/kafka/admin/AclCommand.scala b/core/src/main/scala/kafka/admin/AclCommand.scala&lt;br/&gt;
index c2dda33d5ab..ad375d20572 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/admin/AclCommand.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/admin/AclCommand.scala&lt;br/&gt;
@@ -138,10 +138,22 @@ object AclCommand extends Logging {&lt;br/&gt;
     def listAcls(): Unit = {&lt;br/&gt;
       withAdminClient(opts) { adminClient =&amp;gt;&lt;br/&gt;
         val filters = getResourceFilter(opts, dieIfNoResourceFound = false)&lt;br/&gt;
+        val listPrincipals = getPrincipals(opts, opts.listPrincipalsOpt)&lt;br/&gt;
         val resourceToAcls = getAcls(adminClient, filters)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;for ((resource, acls) &amp;lt;- resourceToAcls)&lt;/li&gt;
	&lt;li&gt;println(s&quot;Current ACLs for resource `$resource`: $Newline ${acls.map(&quot;\t&quot; + _).mkString(Newline)} $Newline&quot;)&lt;br/&gt;
+        if (listPrincipals.isEmpty) {&lt;br/&gt;
+          for ((resource, acls) &amp;lt;- resourceToAcls)&lt;br/&gt;
+            println(s&quot;Current ACLs for resource `$resource`: $Newline ${acls.map(&quot;\t&quot; + _).mkString(Newline)} $Newline&quot;)&lt;br/&gt;
+        } else {&lt;br/&gt;
+          listPrincipals.foreach(principal =&amp;gt; {&lt;br/&gt;
+            println(s&quot;ACLs for principal `$principal`&quot;)&lt;br/&gt;
+            val filteredResourceToAcls =  resourceToAcls.mapValues(acls =&amp;gt;&lt;br/&gt;
+              acls.filter(acl =&amp;gt; principal.toString.equals(acl.principal))).filter(entry =&amp;gt; entry._2.nonEmpty)&lt;br/&gt;
+&lt;br/&gt;
+            for ((resource, acls) &amp;lt;- filteredResourceToAcls)&lt;br/&gt;
+              println(s&quot;Current ACLs for resource `$resource`: $Newline ${acls.map(&quot;\t&quot; + _).mkString(Newline)} $Newline&quot;)&lt;br/&gt;
+          })&lt;br/&gt;
+        }&lt;br/&gt;
       }&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -237,13 +249,20 @@ object AclCommand extends Logging {&lt;br/&gt;
     def listAcls(): Unit = {&lt;br/&gt;
       withAuthorizer() { authorizer =&amp;gt;&lt;br/&gt;
         val filters = getResourceFilter(opts, dieIfNoResourceFound = false)&lt;br/&gt;
+        val listPrincipals = getPrincipals(opts, opts.listPrincipalsOpt)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val resourceToAcls: Iterable[(Resource, Set&lt;span class=&quot;error&quot;&gt;&amp;#91;Acl&amp;#93;&lt;/span&gt;)] =&lt;/li&gt;
	&lt;li&gt;if (filters.isEmpty) authorizer.getAcls()&lt;/li&gt;
	&lt;li&gt;else filters.flatMap(filter =&amp;gt; getAcls(authorizer, filter))&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;for ((resource, acls) &amp;lt;- resourceToAcls)&lt;/li&gt;
	&lt;li&gt;println(s&quot;Current ACLs for resource `$resource`: $Newline ${acls.map(&quot;\t&quot; + _).mkString(Newline)} $Newline&quot;)&lt;br/&gt;
+        if (listPrincipals.isEmpty) {&lt;br/&gt;
+          val resourceToAcls =  getFilteredResourceToAcls(authorizer, filters)&lt;br/&gt;
+          for ((resource, acls) &amp;lt;- resourceToAcls)&lt;br/&gt;
+            println(s&quot;Current ACLs for resource `$resource`: $Newline ${acls.map(&quot;\t&quot; + _).mkString(Newline)} $Newline&quot;)&lt;br/&gt;
+        } else {&lt;br/&gt;
+          listPrincipals.foreach(principal =&amp;gt; {&lt;br/&gt;
+            println(s&quot;ACLs for principal `$principal`&quot;)&lt;br/&gt;
+            val resourceToAcls =  getFilteredResourceToAcls(authorizer, filters, Some(principal))&lt;br/&gt;
+            for ((resource, acls) &amp;lt;- resourceToAcls)&lt;br/&gt;
+              println(s&quot;Current ACLs for resource `$resource`: $Newline ${acls.map(&quot;\t&quot; + _).mkString(Newline)} $Newline&quot;)&lt;br/&gt;
+          })&lt;br/&gt;
+        }&lt;br/&gt;
       }&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -256,9 +275,23 @@ object AclCommand extends Logging &lt;/p&gt;
{
         )
     }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private def getAcls(authorizer: Authorizer, filter: ResourcePatternFilter): Map[Resource, Set&lt;span class=&quot;error&quot;&gt;&amp;#91;Acl&amp;#93;&lt;/span&gt;] =&lt;/li&gt;
	&lt;li&gt;authorizer.getAcls()&lt;/li&gt;
	&lt;li&gt;.filter 
{ case (resource, acl) =&amp;gt; filter.matches(resource.toPattern) }&lt;br/&gt;
+    private def getFilteredResourceToAcls(authorizer: Authorizer, filters: Set&lt;span class=&quot;error&quot;&gt;&amp;#91;ResourcePatternFilter&amp;#93;&lt;/span&gt;,&lt;br/&gt;
+                                          listPrincipal: Option&lt;span class=&quot;error&quot;&gt;&amp;#91;KafkaPrincipal&amp;#93;&lt;/span&gt; = None): Iterable[(Resource, Set&lt;span class=&quot;error&quot;&gt;&amp;#91;Acl&amp;#93;&lt;/span&gt;)] = {
+      if (filters.isEmpty)
+        if (listPrincipal.isEmpty)
+          authorizer.getAcls()
+        else
+          authorizer.getAcls(listPrincipal.get)
+      else filters.flatMap(filter =&amp;gt; getAcls(authorizer, filter, listPrincipal))
+    }&lt;br/&gt;
+&lt;br/&gt;
+    private def getAcls(authorizer: Authorizer, filter: ResourcePatternFilter,&lt;br/&gt;
+                        listPrincipal: Option&lt;span class=&quot;error&quot;&gt;&amp;#91;KafkaPrincipal&amp;#93;&lt;/span&gt; = None): Map[Resource, Set&lt;span class=&quot;error&quot;&gt;&amp;#91;Acl&amp;#93;&lt;/span&gt;] =&lt;br/&gt;
+      if (listPrincipal.isEmpty)&lt;br/&gt;
+        authorizer.getAcls().filter { case (resource, acl) =&amp;gt; filter.matches(resource.toPattern) }
&lt;p&gt;+      else&lt;br/&gt;
+        authorizer.getAcls(listPrincipal.get).filter &lt;/p&gt;
{ case (resource, acl) =&amp;gt; filter.matches(resource.toPattern) }
&lt;p&gt;+&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private def getResourceToAcls(opts: AclCommandOptions): Map[Resource, Set&lt;span class=&quot;error&quot;&gt;&amp;#91;Acl&amp;#93;&lt;/span&gt;] = {&lt;br/&gt;
@@ -521,6 +554,12 @@ object AclCommand extends Logging {&lt;br/&gt;
       .describedAs(&quot;deny-principal&quot;)&lt;br/&gt;
       .ofType(classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;)&lt;/p&gt;

&lt;p&gt;+    val listPrincipalsOpt = parser.accepts(&quot;principal&quot;, &quot;List ACLs for the specified principal. principal is in principalType:name format.&quot; +&lt;br/&gt;
+      &quot; Note that principalType must be supported by the Authorizer being used. Multiple --principal option can be passed.&quot;)&lt;br/&gt;
+      .withOptionalArg()&lt;br/&gt;
+      .describedAs(&quot;principal&quot;)&lt;br/&gt;
+      .ofType(classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;)&lt;br/&gt;
+&lt;br/&gt;
     val allowHostsOpt = parser.accepts(&quot;allow-host&quot;, &quot;Host from which principals listed in --allow-principal will have access. &quot; +&lt;br/&gt;
       &quot;If you have specified --allow-principal then the default for this option will be set to * which allows access from all hosts.&quot;)&lt;br/&gt;
       .withRequiredArg&lt;br/&gt;
@@ -568,6 +607,9 @@ object AclCommand extends Logging {&lt;br/&gt;
       CommandLineUtils.checkInvalidArgs(parser, options, producerOpt, Set(operationsOpt, denyPrincipalsOpt, denyHostsOpt))&lt;br/&gt;
       CommandLineUtils.checkInvalidArgs(parser, options, consumerOpt, Set(operationsOpt, denyPrincipalsOpt, denyHostsOpt))&lt;/p&gt;

&lt;p&gt;+      if (options.has(listPrincipalsOpt) &amp;amp;&amp;amp; !options.has(listOpt))&lt;br/&gt;
+        CommandLineUtils.printUsageAndDie(parser, &quot;The --principal option is only available if --list is set&quot;)&lt;br/&gt;
+&lt;br/&gt;
       if (options.has(producerOpt) &amp;amp;&amp;amp; !options.has(topicOpt))&lt;br/&gt;
         CommandLineUtils.printUsageAndDie(parser, &quot;With --producer you must specify a --topic&quot;)&lt;/p&gt;

&lt;p&gt;diff --git a/docs/security.html b/docs/security.html&lt;br/&gt;
index e856a7e1686..924c1bf6c40 100644&lt;br/&gt;
&amp;#8212; a/docs/security.html&lt;br/&gt;
+++ b/docs/security.html&lt;br/&gt;
@@ -1129,6 +1129,12 @@ &amp;lt;h4&amp;gt;&amp;lt;a id=&quot;security_authz_cli&quot; href=&quot;#security_authz_cli&quot;&amp;gt;Command Line Interface&lt;br/&gt;
             &amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&lt;br/&gt;
             &amp;lt;td&amp;gt;Principal&amp;lt;/td&amp;gt;&lt;br/&gt;
         &amp;lt;/tr&amp;gt;&lt;br/&gt;
+        &amp;lt;tr&amp;gt;&lt;br/&gt;
+            &amp;lt;td&amp;gt;--principal&amp;lt;/td&amp;gt;&lt;br/&gt;
+            &amp;lt;td&amp;gt;Principal is in PrincipalType:name format that will be used along with --list option. This will list the ACLs for the specified principal. &amp;lt;br&amp;gt;You can specify multiple --principal in a single command.&amp;lt;/td&amp;gt;&lt;br/&gt;
+            &amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&lt;br/&gt;
+            &amp;lt;td&amp;gt;Principal&amp;lt;/td&amp;gt;&lt;br/&gt;
+        &amp;lt;/tr&amp;gt;&lt;br/&gt;
         &amp;lt;tr&amp;gt;&lt;br/&gt;
             &amp;lt;td&amp;gt;--allow-host&amp;lt;/td&amp;gt;&lt;br/&gt;
             &amp;lt;td&amp;gt;IP address from which principals listed in --allow-principal will have access.&amp;lt;/td&amp;gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 9 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3iadr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>