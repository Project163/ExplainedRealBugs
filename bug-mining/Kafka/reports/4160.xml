<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:42:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-19128] Kafka Streams should not get offsets when close dirty</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-19128</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Kafka Streams calls `prepareCommit()` in `Taskmanager#closeTaskDirty()`. The initial purpose of this call has only been to flush the case if necessary before suspending and closing the topology. But, calling `prepareCommit()` results into calling other methods as well, which compute the next offsets for the partition. However, the dirty task must not get committed and therefore, getting offsets should not be needed as well.&lt;/p&gt;

&lt;p&gt;Once, we encountered the following exception with AK 3.9:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Streams Soak encountered IllegalStateException: You can only check the position &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partitions assigned to &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; consumer.&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;However, due to changes and improvements in AK 4.0, this exception can not happen any more with AK 4.0+. BTW, the issue must get fixed. Proposed fixes are as follows:&lt;br/&gt;
1. Introduction of a flag &lt;tt&gt;prepareCommit(boolean clean)&lt;/tt&gt; to determine clean or unclean shutdown, avoiding unnecessary offset checking during dirty shutdowns.&lt;br/&gt;
2. Separating `flush` and `prepareCommit`. When closing dirty or in other required cases, only call `flush()`.&lt;/p&gt;

&lt;p&gt;{{}}&lt;/p&gt;</description>
                <environment></environment>
        <key id="13614993">KAFKA-19128</key>
            <summary>Kafka Streams should not get offsets when close dirty</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="alisa23">Alieh Saeedi</assignee>
                                    <reporter username="alisa23">Alieh Saeedi</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Apr 2025 13:08:37 +0000</created>
                <updated>Fri, 25 Apr 2025 04:29:53 +0000</updated>
                            <resolved>Fri, 25 Apr 2025 04:29:20 +0000</resolved>
                                                    <fixVersion>4.0.1</fixVersion>
                    <fixVersion>4.1.0</fixVersion>
                                    <component>streams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17944365" author="JIRAUSER298811" created="Mon, 14 Apr 2025 13:35:19 +0000"  >&lt;p&gt;Following &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mjsax&quot; class=&quot;user-hover&quot; rel=&quot;mjsax&quot;&gt;mjsax&lt;/a&gt; &apos;s idea (PR comment: &lt;a href=&quot;https://github.com/apache/kafka/pull/19450#issuecomment-2798404630),&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/19450#issuecomment-2798404630),&lt;/a&gt; the first solution is implemented.&lt;br/&gt;
PR: &lt;a href=&quot;https://github.com/apache/kafka/pull/19450&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/19450&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            30 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1vbf4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>