<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:28:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-13132] Upgrading to topic IDs in LISR requests has gaps introduced in 3.0</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-13132</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;With the change in 3.0 to how topic IDs are assigned to logs, a bug was inadvertently introduced. Now, topic IDs will only be assigned on the load of the log to a partition in LISR requests. This means we will only assign topic IDs for newly created topics/partitions, on broker startup, or potentially when a partition is reassigned.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In the case of upgrading from an IBP before 2.8, we may have a scenario where we upgrade the controller to IBP 3.0 (or even 2.8) last. (Ie, the controller is IBP &amp;lt; 2.8 and all other brokers are on the newest IBP) Upon the last broker upgrading, we will elect a new controller but its LISR request will not result in topic IDs being assigned to logs of existing topics. They will only be assigned in the cases mentioned above.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Keep in mind, in this scenario, topic IDs will be still be assigned in the controller/ZK to all new and pre-existing topics and will show up in metadata.&lt;/b&gt;&#160; This means we are not ensured the same guarantees we had in 2.8.&#160;&lt;b&gt;It is just the LISR/partition.metadata part of the code that is affected.&lt;/b&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The problem is two-fold&lt;br/&gt;
 1. We ignore LISR requests when the partition leader epoch has not increased (previously we assigned the ID before this check)&lt;br/&gt;
 2. We only assign the topic ID when we are associating the log with the partition in replicamanager for the first time. Though in the scenario described above, we have logs associated with partitions that need to be upgraded.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;We should check the if the LISR request is resulting in a topic ID addition and add logic to logs already associated to partitions in replica manager.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13391697">KAFKA-13132</key>
            <summary>Upgrading to topic IDs in LISR requests has gaps introduced in 3.0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jolshan">Justine Olshan</assignee>
                                    <reporter username="jolshan">Justine Olshan</reporter>
                        <labels>
                    </labels>
                <created>Sun, 25 Jul 2021 03:59:50 +0000</created>
                <updated>Fri, 6 Aug 2021 01:14:28 +0000</updated>
                            <resolved>Fri, 6 Aug 2021 01:14:28 +0000</resolved>
                                                    <fixVersion>3.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17387456" author="kkonstantine" created="Mon, 26 Jul 2021 16:16:44 +0000"  >&lt;p&gt;Marked as Blocker for now targeting 3.0, as it seems to be a regression.&#160;&lt;/p&gt;</comment>
                            <comment id="17392554" author="jolshan" created="Tue, 3 Aug 2021 21:28:49 +0000"  >&lt;p&gt;Found an issue where we don&apos;t sufficiently cover case 2. I have a plan to properly cover.&lt;/p&gt;

&lt;p&gt; cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkonstantine&quot; class=&quot;user-hover&quot; rel=&quot;kkonstantine&quot;&gt;kkonstantine&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 14 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0tars:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>