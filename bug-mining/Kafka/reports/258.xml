<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:37:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-851] Broken handling of leader and isr request leads to incorrect high watermark checkpoint file</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-851</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;The broker depends on receiving a list of &lt;b&gt;all&lt;/b&gt; partitions from the controller on startup. It uses this information to create a list of partitions that will get check pointed to the high watermark checkpoint file. However, during a make follower operation, it adds a partition to the high watermark checkpoint list only if its leader is alive. Due to this, even if the controller sends a full list of partitions to the broker, replica manager filters it to keep only those partitions whose leader is alive. This leads to the high watermark value for the rest of those partitions to reset to 0. Which, in turn, leads to the follower to fetch from the beginning of leader&apos;s log instead of min(log end offset, high watermark). The effect of this is very long lag on the replica fetchers leading to high under replicated partition count&lt;/p&gt;</description>
                <environment></environment>
        <key id="12640888">KAFKA-851</key>
            <summary>Broken handling of leader and isr request leads to incorrect high watermark checkpoint file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nehanarkhede">Neha Narkhede</assignee>
                                    <reporter username="nehanarkhede">Neha Narkhede</reporter>
                        <labels>
                            <label>kafka-0.8</label>
                            <label>p1</label>
                    </labels>
                <created>Thu, 4 Apr 2013 22:35:32 +0000</created>
                <updated>Fri, 5 Apr 2013 04:28:28 +0000</updated>
                            <resolved>Fri, 5 Apr 2013 04:28:26 +0000</resolved>
                                    <version>0.8.0</version>
                                                    <component>replication</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13623085" author="nehanarkhede" created="Thu, 4 Apr 2013 23:51:15 +0000"  >&lt;p&gt;Fixed Partition.makeFollower() to do the following irrespective of whether the leader is alive or not -&lt;/p&gt;

&lt;p&gt;getOrCreateReplica: This creates a local replica, if one does not exist. This ensures that, on the very first leader and isr request, the broker will create a replica object for every partition in the leader and isr request. As part of this, it reads the previous high watermark value for that partition and creates a replica object with that high watermark value. This ensures that the right high watermark value gets checkpointed by the checkpoint thread. This will also ensure that all partitions will get checkpointed to the file&lt;/p&gt;</comment>
                            <comment id="13623241" author="junrao" created="Fri, 5 Apr 2013 01:27:06 +0000"  >&lt;p&gt;Good catch. +1.&lt;/p&gt;</comment>
                            <comment id="13623253" author="swapnilghike" created="Fri, 5 Apr 2013 02:01:02 +0000"  >&lt;p&gt;+1 Great catch!&lt;/p&gt;</comment>
                            <comment id="13623351" author="nehanarkhede" created="Fri, 5 Apr 2013 04:28:26 +0000"  >&lt;p&gt;Thanks for the quick review, guys! Checked in patch to 0.8&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12577112" name="kafka-851-v1.patch" size="1206" author="nehanarkhede" created="Thu, 4 Apr 2013 23:51:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>321347</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 33 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1jg1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>321692</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>