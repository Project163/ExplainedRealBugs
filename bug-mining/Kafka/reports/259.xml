<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:37:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-849] Bug in controller&apos;s startup/failover logic fails to update in memory leader and isr cache causing other state changes to work incorrectly</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-849</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;partitionLeadershipInfo is the in memory cache of the controller that keeps track of every partition&apos;s &quot;last elected&quot; leader and isr. On controller startup/failover, this cache is bootstrapped only with those partitions whose leader is alive. This causes the leader and isr cache to be initialized incorrectly causing other state transitions related to new broker startup, existing broker failure to not work correctly. For instance, it does not allow the controller to send the list of &lt;b&gt;all&lt;/b&gt; replicas that exist on a broker to it during startup.&lt;/p&gt;

&lt;p&gt;Another bug during controller startup is that it invokes OnlinePartition state change before OnlineReplica state change. This also breaks the guarantee that the controller sends a full list of replicas to a broker on startup&lt;/p&gt;</description>
                <environment></environment>
        <key id="12640707">KAFKA-849</key>
            <summary>Bug in controller&apos;s startup/failover logic fails to update in memory leader and isr cache causing other state changes to work incorrectly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nehanarkhede">Neha Narkhede</assignee>
                                    <reporter username="nehanarkhede">Neha Narkhede</reporter>
                        <labels>
                            <label>kafka-0.8</label>
                            <label>p1</label>
                    </labels>
                <created>Thu, 4 Apr 2013 06:12:07 +0000</created>
                <updated>Fri, 5 Apr 2013 04:27:57 +0000</updated>
                            <resolved>Fri, 5 Apr 2013 04:27:49 +0000</resolved>
                                    <version>0.8.0</version>
                                                    <component>controller</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13622953" author="nehanarkhede" created="Thu, 4 Apr 2013 23:13:12 +0000"  >&lt;p&gt;Fixed the bug so that leader and isr cache is updated whether or not the leader is alive. This is the right thing to do since the purpose of the cache is to record the last decision made. On controller failover, this is the value read from zookeeper.&lt;/p&gt;

&lt;p&gt;Other than that, fixed couple other issues -&lt;/p&gt;

&lt;p&gt;1. Changed list topics tool to also print whether or not the partition is under replicated. This makes it very easy to script the output of list topics to show only partitions that are under replicated&lt;br/&gt;
2. Reduced the noise in the logs due to failed metadata requests. There is not much value in logging this since when some brokers are down, the stack trace just complains that those brokers are down. We still return the correct error code to the client, so turned this error message to debug&lt;/p&gt;</comment>
                            <comment id="13623231" author="junrao" created="Fri, 5 Apr 2013 01:16:21 +0000"  >&lt;p&gt;Thanks for the patch. +1. The changes related to list topic are not sufficient though. The problem is that if a broker is down, AdminUtils.fetchTopicMetadataFromZk returns an empty replica list. There is a patch in kafka-850 that fixes this issue more completely.&lt;/p&gt;</comment>
                            <comment id="13623240" author="swapnilghike" created="Fri, 5 Apr 2013 01:26:18 +0000"  >&lt;p&gt;+1 Both were great catches!&lt;/p&gt;</comment>
                            <comment id="13623332" author="nehanarkhede" created="Fri, 5 Apr 2013 03:55:42 +0000"  >&lt;p&gt;Thanks Jun and Swapnil for the quick review! Jun, I agree that these changes are not complete. I saw that you have it covered in 850 so left it from here.&lt;/p&gt;</comment>
                            <comment id="13623350" author="nehanarkhede" created="Fri, 5 Apr 2013 04:27:49 +0000"  >&lt;p&gt;Committed to 0.8&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12577105" name="kafka-849-v1.patch" size="16932" author="nehanarkhede" created="Thu, 4 Apr 2013 23:15:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>321166</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 33 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1jexb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>321511</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>