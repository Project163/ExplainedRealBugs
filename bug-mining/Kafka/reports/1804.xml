<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:06:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-6018] Make KafkaFuture.Function java 8 lambda compatible</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-6018</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;KafkaFuture.Function is currently an empty public abstract class.&lt;/p&gt;

&lt;p&gt;This means you cannot implement them as a java lambda.  And you end up with constructs as:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; KafkaFuture.Function&amp;lt;Set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt;() {
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; apply(Set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; strings) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; foo;
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I propose to define them as interfaces.&lt;br/&gt;
So this code can become in java 8:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;strings -&amp;gt; foo
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I know this change is backwards incompatible (extends becomes implements).&lt;br/&gt;
But as &lt;tt&gt;KafkaFuture&lt;/tt&gt; is marked as &lt;tt&gt;@InterfaceStability.Evolving&lt;/tt&gt;.&lt;br/&gt;
And KafkaFuture states in its javadoc:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;This will eventually become a thin shim on top of Java 8&apos;s CompletableFuture.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think this change might be worth considering.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="13107459">KAFKA-6018</key>
            <summary>Make KafkaFuture.Function java 8 lambda compatible</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="steven.aerts">Steven Aerts</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Oct 2017 09:48:18 +0000</created>
                <updated>Tue, 30 Jan 2018 23:57:19 +0000</updated>
                            <resolved>Tue, 30 Jan 2018 23:56:07 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                    <component>clients</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16194376" author="ijuma" created="Fri, 6 Oct 2017 09:54:42 +0000"  >&lt;p&gt;Lambdas can be used with abstract classes if they have a single abstract method (which is the case for KafkaFuture.Function). Are you saying that this doesn&apos;t work?&lt;/p&gt;</comment>
                            <comment id="16194404" author="steven.aerts" created="Fri, 6 Oct 2017 10:20:01 +0000"  >&lt;p&gt;This does not work, as you cannot use java 8 lambdas with abstract classes:&lt;br/&gt;
&lt;a href=&quot;https://stackoverflow.com/a/24617900/612704&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/a/24617900/612704&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I will make a pull request.&lt;/p&gt;

</comment>
                            <comment id="16194411" author="ijuma" created="Fri, 6 Oct 2017 10:26:01 +0000"  >&lt;p&gt;Hmm, this is unfortunate. The change would require a KIP: &lt;a href=&quot;https://cwiki.apache.org/confluence/display/KAFKA/Kafka+Improvement+Proposals&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/KAFKA/Kafka+Improvement+Proposals&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16194413" author="ijuma" created="Fri, 6 Oct 2017 10:27:36 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cmccabe&quot; class=&quot;user-hover&quot; rel=&quot;cmccabe&quot;&gt;cmccabe&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16194414" author="githubbot" created="Fri, 6 Oct 2017 10:27:37 +0000"  >&lt;p&gt;GitHub user steven-aerts opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/4033&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4033&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6018&quot; title=&quot;Make KafkaFuture.Function java 8 lambda compatible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6018&quot;&gt;&lt;del&gt;KAFKA-6018&lt;/del&gt;&lt;/a&gt;: Make KafkaFuture.Future an interface&lt;/p&gt;

&lt;p&gt;    Changing KafkaFuture.Future and KafkaFuture.BiConsumer into an interface makes&lt;br/&gt;
    them a functional interface.  This makes them Java 8 lambda compatible.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/steven-aerts/kafka-1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/steven-aerts/kafka-1&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6018&quot; title=&quot;Make KafkaFuture.Function java 8 lambda compatible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6018&quot;&gt;&lt;del&gt;KAFKA-6018&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/4033.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4033.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4033&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 6c630aff48954558b8ad6e2611cf0c269b879287&lt;br/&gt;
Author: Steven Aerts &amp;lt;steven.aerts@technicolor.com&amp;gt;&lt;br/&gt;
Date:   2017-10-06T10:16:41Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6018&quot; title=&quot;Make KafkaFuture.Function java 8 lambda compatible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6018&quot;&gt;&lt;del&gt;KAFKA-6018&lt;/del&gt;&lt;/a&gt; Make KafkaFuture.Future an interface&lt;/p&gt;

&lt;p&gt;    Changing KafkaFuture.Future and KafkaFuture.BiConsumer into an interface makes&lt;br/&gt;
    them a functional interface.  This makes them Java 8 lambda compatible.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16194427" author="steven.aerts" created="Fri, 6 Oct 2017 10:38:30 +0000"  >&lt;p&gt;I do not mind to create a KIP for this or start a &lt;span class=&quot;error&quot;&gt;&amp;#91;DISCUSS&amp;#93;&lt;/span&gt; thread on the mailing list.&lt;/p&gt;

&lt;p&gt;I will do it early next weak, so &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cmccabe&quot; class=&quot;user-hover&quot; rel=&quot;cmccabe&quot;&gt;cmccabe&lt;/a&gt; has some time to give feedback on how to move forward.&lt;/p&gt;
</comment>
                            <comment id="16275494" author="steven.aerts" created="Sat, 2 Dec 2017 09:50:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/KAFKA/KIP-218%3A+Make+KafkaFuture.Function+java+8+lambda+compatible&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;KIP218&lt;/a&gt; was created to track this improvement.&lt;/p&gt;</comment>
                            <comment id="16289883" author="githubbot" created="Wed, 13 Dec 2017 20:51:01 +0000"  >&lt;p&gt;Github user xvrl closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/4308&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4308&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16324658" author="githubbot" created="Fri, 12 Jan 2018 22:27:17 +0000"  >&lt;p&gt;ewencp closed pull request #4033: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6018&quot; title=&quot;Make KafkaFuture.Function java 8 lambda compatible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6018&quot;&gt;&lt;del&gt;KAFKA-6018&lt;/del&gt;&lt;/a&gt;: Make KafkaFuture.Future an interface&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/4033&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4033&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/clients/src/main/java/org/apache/kafka/clients/admin/DeleteAclsResult.java b/clients/src/main/java/org/apache/kafka/clients/admin/DeleteAclsResult.java&lt;br/&gt;
index 90bc2970e13..eaa5a0185cd 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/clients/admin/DeleteAclsResult.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/admin/DeleteAclsResult.java&lt;br/&gt;
@@ -102,7 +102,7 @@ public ApiException exception() {&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Collection&amp;lt;AclBinding&amp;gt;&amp;gt; all() {&lt;br/&gt;
         return KafkaFuture.allOf(futures.values().toArray(new KafkaFuture&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;)).thenApply(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new KafkaFuture.Function&amp;lt;Void, Collection&amp;lt;AclBinding&amp;gt;&amp;gt;() {&lt;br/&gt;
+            new KafkaFuture.FunctionInterface&amp;lt;Void, Collection&amp;lt;AclBinding&amp;gt;&amp;gt;() {&lt;br/&gt;
                 @Override&lt;br/&gt;
                 public Collection&amp;lt;AclBinding&amp;gt; apply(Void v) {&lt;br/&gt;
                     List&amp;lt;AclBinding&amp;gt; acls = new ArrayList&amp;lt;&amp;gt;();&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeConfigsResult.java b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeConfigsResult.java&lt;br/&gt;
index 478bf055cfd..343a06af9d5 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeConfigsResult.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeConfigsResult.java&lt;br/&gt;
@@ -53,7 +53,7 @@&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Map&amp;lt;ConfigResource, Config&amp;gt;&amp;gt; all() {&lt;br/&gt;
         return KafkaFuture.allOf(futures.values().toArray(new KafkaFuture&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;)).&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;thenApply(new KafkaFuture.Function&amp;lt;Void, Map&amp;lt;ConfigResource, Config&amp;gt;&amp;gt;() {&lt;br/&gt;
+                thenApply(new KafkaFuture.FunctionInterface&amp;lt;Void, Map&amp;lt;ConfigResource, Config&amp;gt;&amp;gt;() {&lt;br/&gt;
                     @Override&lt;br/&gt;
                     public Map&amp;lt;ConfigResource, Config&amp;gt; apply(Void v) {&lt;br/&gt;
                         Map&amp;lt;ConfigResource, Config&amp;gt; configs = new HashMap&amp;lt;&amp;gt;(futures.size());&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeLogDirsResult.java b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeLogDirsResult.java&lt;br/&gt;
index de186fd751d..9bd2d520b6b 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeLogDirsResult.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeLogDirsResult.java&lt;br/&gt;
@@ -51,7 +51,7 @@&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Map&amp;lt;Integer, Map&amp;lt;String, LogDirInfo&amp;gt;&amp;gt;&amp;gt; all() {&lt;br/&gt;
         return KafkaFuture.allOf(futures.values().toArray(new KafkaFuture&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;)).&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;thenApply(new KafkaFuture.Function&amp;lt;Void, Map&amp;lt;Integer, Map&amp;lt;String, LogDirInfo&amp;gt;&amp;gt;&amp;gt;() {&lt;br/&gt;
+            thenApply(new KafkaFuture.FunctionInterface&amp;lt;Void, Map&amp;lt;Integer, Map&amp;lt;String, LogDirInfo&amp;gt;&amp;gt;&amp;gt;() {&lt;br/&gt;
                 @Override&lt;br/&gt;
                 public Map&amp;lt;Integer, Map&amp;lt;String, LogDirInfo&amp;gt;&amp;gt; apply(Void v) {&lt;br/&gt;
                     Map&amp;lt;Integer, Map&amp;lt;String, LogDirInfo&amp;gt;&amp;gt; descriptions = new HashMap&amp;lt;&amp;gt;(futures.size());&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeReplicaLogDirsResult.java b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeReplicaLogDirsResult.java&lt;br/&gt;
index 401b4aa7b9d..8a73df38b46 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeReplicaLogDirsResult.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeReplicaLogDirsResult.java&lt;br/&gt;
@@ -52,7 +52,7 @@&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Map&amp;lt;TopicPartitionReplica, ReplicaLogDirInfo&amp;gt;&amp;gt; all() {&lt;br/&gt;
         return KafkaFuture.allOf(futures.values().toArray(new KafkaFuture&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;)).&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;thenApply(new KafkaFuture.Function&amp;lt;Void, Map&amp;lt;TopicPartitionReplica, ReplicaLogDirInfo&amp;gt;&amp;gt;() {&lt;br/&gt;
+            thenApply(new KafkaFuture.FunctionInterface&amp;lt;Void, Map&amp;lt;TopicPartitionReplica, ReplicaLogDirInfo&amp;gt;&amp;gt;() {&lt;br/&gt;
                 @Override&lt;br/&gt;
                 public Map&amp;lt;TopicPartitionReplica, ReplicaLogDirInfo&amp;gt; apply(Void v) {&lt;br/&gt;
                     Map&amp;lt;TopicPartitionReplica, ReplicaLogDirInfo&amp;gt; replicaLogDirInfos = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeTopicsResult.java b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeTopicsResult.java&lt;br/&gt;
index 18f5f9d20cd..add317659f6 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeTopicsResult.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeTopicsResult.java&lt;br/&gt;
@@ -51,7 +51,7 @@&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Map&amp;lt;String, TopicDescription&amp;gt;&amp;gt; all() {&lt;br/&gt;
         return KafkaFuture.allOf(futures.values().toArray(new KafkaFuture&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;)).&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;thenApply(new KafkaFuture.Function&amp;lt;Void, Map&amp;lt;String, TopicDescription&amp;gt;&amp;gt;() {&lt;br/&gt;
+            thenApply(new KafkaFuture.FunctionInterface&amp;lt;Void, Map&amp;lt;String, TopicDescription&amp;gt;&amp;gt;() {&lt;br/&gt;
                 @Override&lt;br/&gt;
                 public Map&amp;lt;String, TopicDescription&amp;gt; apply(Void v) {&lt;br/&gt;
                     Map&amp;lt;String, TopicDescription&amp;gt; descriptions = new HashMap&amp;lt;&amp;gt;(futures.size());&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/admin/ListTopicsResult.java b/clients/src/main/java/org/apache/kafka/clients/admin/ListTopicsResult.java&lt;br/&gt;
index e54b3defe36..2b0955732c2 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/clients/admin/ListTopicsResult.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/admin/ListTopicsResult.java&lt;br/&gt;
@@ -48,7 +48,7 @@&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;Return a future which yields a collection of TopicListing objects.&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Collection&amp;lt;TopicListing&amp;gt;&amp;gt; listings() {&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return future.thenApply(new KafkaFuture.Function&amp;lt;Map&amp;lt;String, TopicListing&amp;gt;, Collection&amp;lt;TopicListing&amp;gt;&amp;gt;() {&lt;br/&gt;
+        return future.thenApply(new KafkaFuture.FunctionInterface&amp;lt;Map&amp;lt;String, TopicListing&amp;gt;, Collection&amp;lt;TopicListing&amp;gt;&amp;gt;() {&lt;br/&gt;
             @Override&lt;br/&gt;
             public Collection&amp;lt;TopicListing&amp;gt; apply(Map&amp;lt;String, TopicListing&amp;gt; namesToDescriptions) {&lt;br/&gt;
                 return namesToDescriptions.values();&lt;br/&gt;
@@ -60,7 +60,7 @@&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;Return a future which yields a collection of topic names.&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Set&amp;lt;String&amp;gt;&amp;gt; names() {&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return future.thenApply(new KafkaFuture.Function&amp;lt;Map&amp;lt;String, TopicListing&amp;gt;, Set&amp;lt;String&amp;gt;&amp;gt;() {&lt;br/&gt;
+        return future.thenApply(new KafkaFuture.FunctionInterface&amp;lt;Map&amp;lt;String, TopicListing&amp;gt;, Set&amp;lt;String&amp;gt;&amp;gt;() {&lt;br/&gt;
             @Override&lt;br/&gt;
             public Set&amp;lt;String&amp;gt; apply(Map&amp;lt;String, TopicListing&amp;gt; namesToListings) {&lt;br/&gt;
                 return namesToListings.keySet();&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/common/KafkaFuture.java b/clients/src/main/java/org/apache/kafka/common/KafkaFuture.java&lt;br/&gt;
index 23e218137a9..2b3e5efce83 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/common/KafkaFuture.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/common/KafkaFuture.java&lt;br/&gt;
@@ -35,18 +35,26 @@&lt;br/&gt;
     /**&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;A function which takes objects of type A and returns objects of type B.&lt;br/&gt;
      */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static abstract class Function&amp;lt;A, B&amp;gt; {&lt;/li&gt;
	&lt;li&gt;public abstract B apply(A a);&lt;br/&gt;
+    public interface FunctionInterface&amp;lt;A, B&amp;gt; 
{
+        B apply(A a);
     }
&lt;p&gt;+    &lt;br/&gt;
+    /**&lt;br/&gt;
+     * A function which takes objects of type A and returns objects of type B.&lt;br/&gt;
+     *&lt;br/&gt;
+     * @deprecated use &lt;/p&gt;
{@link FunctionInterface}
&lt;p&gt; instead&lt;br/&gt;
+     */&lt;br/&gt;
+    @Deprecated&lt;br/&gt;
+    public static abstract class Function&amp;lt;A, B&amp;gt; implements FunctionInterface&amp;lt;A, B&amp;gt; { }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;A consumer of two different types of object.&lt;br/&gt;
      */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static abstract class BiConsumer&amp;lt;A, B&amp;gt; {&lt;/li&gt;
	&lt;li&gt;public abstract void accept(A a, B b);&lt;br/&gt;
+    public interface BiConsumer&amp;lt;A, B&amp;gt; 
{
+        void accept(A a, B b);
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static class AllOfAdapter&amp;lt;R&amp;gt; extends BiConsumer&amp;lt;R, Throwable&amp;gt; {&lt;br/&gt;
+    private static class AllOfAdapter&amp;lt;R&amp;gt; implements BiConsumer&amp;lt;R, Throwable&amp;gt; {&lt;br/&gt;
         private int remainingResponses;&lt;br/&gt;
         private KafkaFuture&amp;lt;?&amp;gt; future;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -101,11 +109,43 @@ private void maybeComplete() {&lt;br/&gt;
     /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Returns a new KafkaFuture that, when this future completes normally, is executed with this&lt;/li&gt;
	&lt;li&gt;futures&apos;s result as the argument to the supplied function.&lt;br/&gt;
+     *&lt;br/&gt;
+     * The function may be invoked by the thread that calls 
{@code thenApply}
&lt;p&gt; or it may be invoked by the thread that&lt;br/&gt;
+     * completes the future.&lt;br/&gt;
+     */&lt;br/&gt;
+    public abstract &amp;lt;R&amp;gt; KafkaFuture&amp;lt;R&amp;gt; thenApply(FunctionInterface&amp;lt;T, R&amp;gt; function);&lt;br/&gt;
+&lt;br/&gt;
+    /**&lt;br/&gt;
+     * @see KafkaFuture#thenApply(FunctionInterface)&lt;br/&gt;
+     *&lt;br/&gt;
+     * @deprecated use &lt;/p&gt;
{@link KafkaFuture#thenApply(FunctionInterface)}
&lt;p&gt;      */&lt;br/&gt;
+    @Deprecated&lt;br/&gt;
     public abstract &amp;lt;R&amp;gt; KafkaFuture&amp;lt;R&amp;gt; thenApply(Function&amp;lt;T, R&amp;gt; function);&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;protected abstract void addWaiter(BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; action);&lt;br/&gt;
+    /**&lt;br/&gt;
+     * Returns a new KafkaFuture with the same result or exception as this future, that executes the given action&lt;br/&gt;
+     * when this future completes.&lt;br/&gt;
+     *&lt;br/&gt;
+     * When this future is done, the given action is invoked with the result (or null if none) and the exception&lt;br/&gt;
+     * (or null if none) of this future as arguments.&lt;br/&gt;
+     *&lt;br/&gt;
+     * The returned future is completed when the action returns.&lt;br/&gt;
+     * The supplied action should not throw an exception. However, if it does, the following rules apply:&lt;br/&gt;
+     * if this future completed normally but the supplied action throws an exception, then the returned future completes&lt;br/&gt;
+     * exceptionally with the supplied action&apos;s exception.&lt;br/&gt;
+     * Or, if this future completed exceptionally and the supplied action throws an exception, then the returned future&lt;br/&gt;
+     * completes exceptionally with this future&apos;s exception.&lt;br/&gt;
+     *&lt;br/&gt;
+     * The action may be invoked by the thread that calls 
{@code whenComplete}
&lt;p&gt; or it may be invoked by the thread that&lt;br/&gt;
+     * completes the future.&lt;br/&gt;
+     *&lt;br/&gt;
+     * @param action the action to preform&lt;br/&gt;
+     * @return the new future&lt;br/&gt;
+     */&lt;br/&gt;
+    public abstract KafkaFuture&amp;lt;T&amp;gt; whenComplete(BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; action);&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+    protected abstract void addWaiter(BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; action);&lt;br/&gt;
     /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;If not already completed, sets the value returned by get() and related methods to the given&lt;/li&gt;
	&lt;li&gt;value.&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/common/internals/KafkaFutureImpl.java b/clients/src/main/java/org/apache/kafka/common/internals/KafkaFutureImpl.java&lt;br/&gt;
index e2dbdf9be92..20cdfca86f2 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/common/internals/KafkaFutureImpl.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/common/internals/KafkaFutureImpl.java&lt;br/&gt;
@@ -46,11 +46,11 @@ private static void wrapAndThrow(Throwable t) throws InterruptedException, Execu&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static class Applicant&amp;lt;A, B&amp;gt; extends BiConsumer&amp;lt;A, Throwable&amp;gt; {&lt;/li&gt;
	&lt;li&gt;private final Function&amp;lt;A, B&amp;gt; function;&lt;br/&gt;
+    private static class Applicant&amp;lt;A, B&amp;gt; implements BiConsumer&amp;lt;A, Throwable&amp;gt; {&lt;br/&gt;
+        private final FunctionInterface&amp;lt;A, B&amp;gt; function;&lt;br/&gt;
         private final KafkaFutureImpl&amp;lt;B&amp;gt; future;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Applicant(Function&amp;lt;A, B&amp;gt; function, KafkaFutureImpl&amp;lt;B&amp;gt; future) {&lt;br/&gt;
+        Applicant(FunctionInterface&amp;lt;A, B&amp;gt; function, KafkaFutureImpl&amp;lt;B&amp;gt; future) 
{
             this.function = function;
             this.future = future;
         }
&lt;p&gt;@@ -70,7 +70,7 @@ public void accept(A a, Throwable exception) {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static class SingleWaiter&amp;lt;R&amp;gt; extends BiConsumer&amp;lt;R, Throwable&amp;gt; {&lt;br/&gt;
+    private static class SingleWaiter&amp;lt;R&amp;gt; implements BiConsumer&amp;lt;R, Throwable&amp;gt; {&lt;br/&gt;
         private R value = null;&lt;br/&gt;
         private Throwable exception = null;&lt;br/&gt;
         private boolean done = false;&lt;br/&gt;
@@ -140,14 +140,60 @@ R await(long timeout, TimeUnit unit)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;futures&apos;s result as the argument to the supplied function.&lt;br/&gt;
      */&lt;br/&gt;
     @Override&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public &amp;lt;R&amp;gt; KafkaFuture&amp;lt;R&amp;gt; thenApply(Function&amp;lt;T, R&amp;gt; function) {&lt;br/&gt;
+    public &amp;lt;R&amp;gt; KafkaFuture&amp;lt;R&amp;gt; thenApply(FunctionInterface&amp;lt;T, R&amp;gt; function) 
{
         KafkaFutureImpl&amp;lt;R&amp;gt; future = new KafkaFutureImpl&amp;lt;R&amp;gt;();
         addWaiter(new Applicant&amp;lt;&amp;gt;(function, future));
         return future;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+&lt;br/&gt;
+    /**&lt;br/&gt;
+     * @See KafkaFutureImpl#thenApply(FunctionInterface)&lt;br/&gt;
+     */&lt;br/&gt;
+    @Deprecated&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public &amp;lt;R&amp;gt; KafkaFuture&amp;lt;R&amp;gt; thenApply(Function&amp;lt;T, R&amp;gt; function) &lt;/p&gt;
{
+        return thenApply((FunctionInterface&amp;lt;T, R&amp;gt;) function);
+    }
&lt;p&gt;+&lt;br/&gt;
+    private static class WhenCompleteBiConsumer&amp;lt;T&amp;gt; implements BiConsumer&amp;lt;T, Throwable&amp;gt; {&lt;br/&gt;
+        private final KafkaFutureImpl&amp;lt;T&amp;gt; future;&lt;br/&gt;
+        private final BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; biConsumer;&lt;br/&gt;
+&lt;br/&gt;
+        WhenCompleteBiConsumer(KafkaFutureImpl&amp;lt;T&amp;gt; future, BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; biConsumer) &lt;/p&gt;
{
+            this.future = future;
+            this.biConsumer = biConsumer;
+        }
&lt;p&gt;+&lt;br/&gt;
+        @Override&lt;br/&gt;
+        public void accept(T val, Throwable exception) {&lt;br/&gt;
+            try {&lt;br/&gt;
+                if (exception != null) &lt;/p&gt;
{
+                    biConsumer.accept(null, exception);
+                }
&lt;p&gt; else &lt;/p&gt;
{
+                    biConsumer.accept(val, null);
+                }
&lt;p&gt;+            } catch (Throwable e) {&lt;br/&gt;
+                if (exception == null) &lt;/p&gt;
{
+                    exception = e;
+                }
&lt;p&gt;+            }&lt;br/&gt;
+            if (exception != null) &lt;/p&gt;
{
+                future.completeExceptionally(exception);
+            }
&lt;p&gt; else &lt;/p&gt;
{
+                future.complete(val);
+            }
&lt;p&gt;+        }&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
     @Override&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;protected synchronized void addWaiter(BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; action) {&lt;br/&gt;
+    public KafkaFuture&amp;lt;T&amp;gt; whenComplete(final BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; biConsumer) 
{
+        final KafkaFutureImpl&amp;lt;T&amp;gt; future = new KafkaFutureImpl&amp;lt;&amp;gt;();
+        addWaiter(new WhenCompleteBiConsumer&amp;lt;&amp;gt;(future, biConsumer));
+        return future;
+    }
&lt;p&gt;+&lt;br/&gt;
+    public synchronized void addWaiter(BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; action) {&lt;br/&gt;
         if (exception != null) &lt;/p&gt;
{
             action.accept(null, exception);
         }
&lt;p&gt; else if (done) {&lt;br/&gt;
diff --git a/clients/src/test/java/org/apache/kafka/common/KafkaFutureTest.java b/clients/src/test/java/org/apache/kafka/common/KafkaFutureTest.java&lt;br/&gt;
index 71f3c3c984d..eac5f9b2e4e 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/test/java/org/apache/kafka/common/KafkaFutureTest.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/common/KafkaFutureTest.java&lt;br/&gt;
@@ -83,6 +83,47 @@ public void testCompletingFutures() throws Exception 
{
         assertEquals(null, myThread.testException);
     }&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+    @Test&lt;br/&gt;
+    public void testThenApply() throws Exception {&lt;br/&gt;
+        KafkaFutureImpl&amp;lt;Integer&amp;gt; future = new KafkaFutureImpl&amp;lt;&amp;gt;();&lt;br/&gt;
+        KafkaFuture&amp;lt;Integer&amp;gt; doubledFuture = future.thenApply(new KafkaFuture.FunctionInterface&amp;lt;Integer, Integer&amp;gt;() {&lt;br/&gt;
+            @Override&lt;br/&gt;
+            public Integer apply(Integer integer) &lt;/p&gt;
{
+                return 2 * integer;
+            }&lt;br/&gt;
+        });&lt;br/&gt;
+        assertFalse(doubledFuture.isDone());&lt;br/&gt;
+        KafkaFuture&amp;lt;Integer&amp;gt; tripledFuture = future.thenApply(new KafkaFuture.Function&amp;lt;Integer, Integer&amp;gt;() {&lt;br/&gt;
+            @Override&lt;br/&gt;
+            public Integer apply(Integer integer) {
+                return 3 * integer;
+            }&lt;br/&gt;
+        });&lt;br/&gt;
+        assertFalse(tripledFuture.isDone());&lt;br/&gt;
+        future.complete(21);&lt;br/&gt;
+        assertEquals(Integer.valueOf(21), future.getNow(-1));&lt;br/&gt;
+        assertEquals(Integer.valueOf(42), doubledFuture.getNow(-1));&lt;br/&gt;
+        assertEquals(Integer.valueOf(63), tripledFuture.getNow(-1));&lt;br/&gt;
+        KafkaFuture&amp;lt;Integer&amp;gt; quadrupledFuture = future.thenApply(new KafkaFuture.FunctionInterface&amp;lt;Integer, Integer&amp;gt;() {&lt;br/&gt;
+            @Override&lt;br/&gt;
+            public Integer apply(Integer integer) {
+                return 4 * integer;
+            }&lt;br/&gt;
+        });&lt;br/&gt;
+        assertEquals(Integer.valueOf(84), quadrupledFuture.getNow(-1));&lt;br/&gt;
+&lt;br/&gt;
+        KafkaFutureImpl&amp;lt;Integer&amp;gt; futureFail = new KafkaFutureImpl&amp;lt;&amp;gt;();&lt;br/&gt;
+        KafkaFuture&amp;lt;Integer&amp;gt; futureAppliedFail = futureFail.thenApply(new KafkaFuture.FunctionInterface&amp;lt;Integer, Integer&amp;gt;() {&lt;br/&gt;
+            @Override&lt;br/&gt;
+            public Integer apply(Integer integer) {+                return 2 * integer;+            }
&lt;p&gt;+        });&lt;br/&gt;
+        futureFail.completeExceptionally(new RuntimeException());&lt;br/&gt;
+        assertTrue(futureFail.isCompletedExceptionally());&lt;br/&gt;
+        assertTrue(futureAppliedFail.isCompletedExceptionally());&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
     private static class CompleterThread&amp;lt;T&amp;gt; extends Thread {&lt;/p&gt;

&lt;p&gt;         private final KafkaFutureImpl&amp;lt;T&amp;gt; future;&lt;br/&gt;
diff --git a/clients/src/test/java/org/apache/kafka/common/utils/MockScheduler.java b/clients/src/test/java/org/apache/kafka/common/utils/MockScheduler.java&lt;br/&gt;
index ba5e1ed0c59..5a2dac3c337 100644&lt;br/&gt;
&amp;#8212; a/clients/src/test/java/org/apache/kafka/common/utils/MockScheduler.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/common/utils/MockScheduler.java&lt;br/&gt;
@@ -87,7 +87,7 @@ public synchronized void addWaiter(long delayMs, KafkaFutureImpl&amp;lt;Long&amp;gt; waiter) {&lt;br/&gt;
                                   final Callable&amp;lt;T&amp;gt; callable, long delayMs) {&lt;br/&gt;
         final KafkaFutureImpl&amp;lt;T&amp;gt; future = new KafkaFutureImpl&amp;lt;&amp;gt;();&lt;br/&gt;
         KafkaFutureImpl&amp;lt;Long&amp;gt; waiter = new KafkaFutureImpl&amp;lt;&amp;gt;();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiter.thenApply(new KafkaFuture.Function&amp;lt;Long, Void&amp;gt;() {&lt;br/&gt;
+        waiter.thenApply(new KafkaFuture.FunctionInterface&amp;lt;Long, Void&amp;gt;() {&lt;br/&gt;
             @Override&lt;br/&gt;
             public Void apply(final Long now) {&lt;br/&gt;
                 executor.submit(new Callable&amp;lt;Void&amp;gt;() {&lt;br/&gt;
diff --git a/tools/src/main/java/org/apache/kafka/trogdor/agent/WorkerManager.java b/tools/src/main/java/org/apache/kafka/trogdor/agent/WorkerManager.java&lt;br/&gt;
index 3c03e1e62ca..d1031bac0c1 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/tools/src/main/java/org/apache/kafka/trogdor/agent/WorkerManager.java&lt;br/&gt;
+++ b/tools/src/main/java/org/apache/kafka/trogdor/agent/WorkerManager.java&lt;br/&gt;
@@ -290,7 +290,7 @@ public void createWorker(final String id, TaskSpec spec) throws Exception 
{
                 return;
             }
&lt;p&gt;             KafkaFutureImpl&amp;lt;String&amp;gt; haltFuture = new KafkaFutureImpl&amp;lt;&amp;gt;();&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;haltFuture.thenApply(new KafkaFuture.Function&amp;lt;String, Void&amp;gt;() {&lt;br/&gt;
+            haltFuture.thenApply(new KafkaFuture.FunctionInterface&amp;lt;String, Void&amp;gt;() {&lt;br/&gt;
                 @Override&lt;br/&gt;
                 public Void apply(String errorString) {&lt;br/&gt;
                     if (errorString.isEmpty()) {&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16324659" author="githubbot" created="Fri, 12 Jan 2018 22:27:18 +0000"  >&lt;p&gt;steven-aerts opened a new pull request #4033: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6018&quot; title=&quot;Make KafkaFuture.Function java 8 lambda compatible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6018&quot;&gt;&lt;del&gt;KAFKA-6018&lt;/del&gt;&lt;/a&gt;: Make KafkaFuture.Future an interface&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/4033&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4033&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Changing KafkaFuture.Future and KafkaFuture.BiConsumer into an interface makes&lt;br/&gt;
   them a functional interface.  This makes them Java 8 lambda compatible.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16346008" author="ewencp" created="Tue, 30 Jan 2018 23:56:07 +0000"  >&lt;p&gt;Issue resolved by pull request 4033&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/4033&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4033&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16346010" author="githubbot" created="Tue, 30 Jan 2018 23:57:19 +0000"  >&lt;p&gt;ewencp closed pull request #4033: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6018&quot; title=&quot;Make KafkaFuture.Function java 8 lambda compatible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6018&quot;&gt;&lt;del&gt;KAFKA-6018&lt;/del&gt;&lt;/a&gt;: Make KafkaFuture.Future an interface&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/4033&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4033&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/clients/src/main/java/org/apache/kafka/clients/admin/DeleteAclsResult.java b/clients/src/main/java/org/apache/kafka/clients/admin/DeleteAclsResult.java&lt;br/&gt;
index 90bc2970e13..19df2289f5b 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/clients/admin/DeleteAclsResult.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/admin/DeleteAclsResult.java&lt;br/&gt;
@@ -102,7 +102,7 @@ public ApiException exception() {&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Collection&amp;lt;AclBinding&amp;gt;&amp;gt; all() {&lt;br/&gt;
         return KafkaFuture.allOf(futures.values().toArray(new KafkaFuture&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;)).thenApply(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new KafkaFuture.Function&amp;lt;Void, Collection&amp;lt;AclBinding&amp;gt;&amp;gt;() {&lt;br/&gt;
+            new KafkaFuture.BaseFunction&amp;lt;Void, Collection&amp;lt;AclBinding&amp;gt;&amp;gt;() {&lt;br/&gt;
                 @Override&lt;br/&gt;
                 public Collection&amp;lt;AclBinding&amp;gt; apply(Void v) {&lt;br/&gt;
                     List&amp;lt;AclBinding&amp;gt; acls = new ArrayList&amp;lt;&amp;gt;();&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeConfigsResult.java b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeConfigsResult.java&lt;br/&gt;
index 478bf055cfd..e5d79e80743 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeConfigsResult.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeConfigsResult.java&lt;br/&gt;
@@ -53,7 +53,7 @@&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Map&amp;lt;ConfigResource, Config&amp;gt;&amp;gt; all() {&lt;br/&gt;
         return KafkaFuture.allOf(futures.values().toArray(new KafkaFuture&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;)).&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;thenApply(new KafkaFuture.Function&amp;lt;Void, Map&amp;lt;ConfigResource, Config&amp;gt;&amp;gt;() {&lt;br/&gt;
+                thenApply(new KafkaFuture.BaseFunction&amp;lt;Void, Map&amp;lt;ConfigResource, Config&amp;gt;&amp;gt;() {&lt;br/&gt;
                     @Override&lt;br/&gt;
                     public Map&amp;lt;ConfigResource, Config&amp;gt; apply(Void v) {&lt;br/&gt;
                         Map&amp;lt;ConfigResource, Config&amp;gt; configs = new HashMap&amp;lt;&amp;gt;(futures.size());&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeLogDirsResult.java b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeLogDirsResult.java&lt;br/&gt;
index de186fd751d..7c7bde755e2 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeLogDirsResult.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeLogDirsResult.java&lt;br/&gt;
@@ -51,7 +51,7 @@&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Map&amp;lt;Integer, Map&amp;lt;String, LogDirInfo&amp;gt;&amp;gt;&amp;gt; all() {&lt;br/&gt;
         return KafkaFuture.allOf(futures.values().toArray(new KafkaFuture&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;)).&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;thenApply(new KafkaFuture.Function&amp;lt;Void, Map&amp;lt;Integer, Map&amp;lt;String, LogDirInfo&amp;gt;&amp;gt;&amp;gt;() {&lt;br/&gt;
+            thenApply(new KafkaFuture.BaseFunction&amp;lt;Void, Map&amp;lt;Integer, Map&amp;lt;String, LogDirInfo&amp;gt;&amp;gt;&amp;gt;() {&lt;br/&gt;
                 @Override&lt;br/&gt;
                 public Map&amp;lt;Integer, Map&amp;lt;String, LogDirInfo&amp;gt;&amp;gt; apply(Void v) {&lt;br/&gt;
                     Map&amp;lt;Integer, Map&amp;lt;String, LogDirInfo&amp;gt;&amp;gt; descriptions = new HashMap&amp;lt;&amp;gt;(futures.size());&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeReplicaLogDirsResult.java b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeReplicaLogDirsResult.java&lt;br/&gt;
index 401b4aa7b9d..d4c84794636 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeReplicaLogDirsResult.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeReplicaLogDirsResult.java&lt;br/&gt;
@@ -52,7 +52,7 @@&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Map&amp;lt;TopicPartitionReplica, ReplicaLogDirInfo&amp;gt;&amp;gt; all() {&lt;br/&gt;
         return KafkaFuture.allOf(futures.values().toArray(new KafkaFuture&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;)).&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;thenApply(new KafkaFuture.Function&amp;lt;Void, Map&amp;lt;TopicPartitionReplica, ReplicaLogDirInfo&amp;gt;&amp;gt;() {&lt;br/&gt;
+            thenApply(new KafkaFuture.BaseFunction&amp;lt;Void, Map&amp;lt;TopicPartitionReplica, ReplicaLogDirInfo&amp;gt;&amp;gt;() {&lt;br/&gt;
                 @Override&lt;br/&gt;
                 public Map&amp;lt;TopicPartitionReplica, ReplicaLogDirInfo&amp;gt; apply(Void v) {&lt;br/&gt;
                     Map&amp;lt;TopicPartitionReplica, ReplicaLogDirInfo&amp;gt; replicaLogDirInfos = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeTopicsResult.java b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeTopicsResult.java&lt;br/&gt;
index 18f5f9d20cd..6bb24d91026 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/clients/admin/DescribeTopicsResult.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/admin/DescribeTopicsResult.java&lt;br/&gt;
@@ -51,7 +51,7 @@&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Map&amp;lt;String, TopicDescription&amp;gt;&amp;gt; all() {&lt;br/&gt;
         return KafkaFuture.allOf(futures.values().toArray(new KafkaFuture&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;)).&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;thenApply(new KafkaFuture.Function&amp;lt;Void, Map&amp;lt;String, TopicDescription&amp;gt;&amp;gt;() {&lt;br/&gt;
+            thenApply(new KafkaFuture.BaseFunction&amp;lt;Void, Map&amp;lt;String, TopicDescription&amp;gt;&amp;gt;() {&lt;br/&gt;
                 @Override&lt;br/&gt;
                 public Map&amp;lt;String, TopicDescription&amp;gt; apply(Void v) {&lt;br/&gt;
                     Map&amp;lt;String, TopicDescription&amp;gt; descriptions = new HashMap&amp;lt;&amp;gt;(futures.size());&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/admin/ListTopicsResult.java b/clients/src/main/java/org/apache/kafka/clients/admin/ListTopicsResult.java&lt;br/&gt;
index e54b3defe36..a2e17fdbd9c 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/clients/admin/ListTopicsResult.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/admin/ListTopicsResult.java&lt;br/&gt;
@@ -48,7 +48,7 @@&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;Return a future which yields a collection of TopicListing objects.&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Collection&amp;lt;TopicListing&amp;gt;&amp;gt; listings() {&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return future.thenApply(new KafkaFuture.Function&amp;lt;Map&amp;lt;String, TopicListing&amp;gt;, Collection&amp;lt;TopicListing&amp;gt;&amp;gt;() {&lt;br/&gt;
+        return future.thenApply(new KafkaFuture.BaseFunction&amp;lt;Map&amp;lt;String, TopicListing&amp;gt;, Collection&amp;lt;TopicListing&amp;gt;&amp;gt;() {&lt;br/&gt;
             @Override&lt;br/&gt;
             public Collection&amp;lt;TopicListing&amp;gt; apply(Map&amp;lt;String, TopicListing&amp;gt; namesToDescriptions) {&lt;br/&gt;
                 return namesToDescriptions.values();&lt;br/&gt;
@@ -60,7 +60,7 @@&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;Return a future which yields a collection of topic names.&lt;br/&gt;
      */&lt;br/&gt;
     public KafkaFuture&amp;lt;Set&amp;lt;String&amp;gt;&amp;gt; names() {&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return future.thenApply(new KafkaFuture.Function&amp;lt;Map&amp;lt;String, TopicListing&amp;gt;, Set&amp;lt;String&amp;gt;&amp;gt;() {&lt;br/&gt;
+        return future.thenApply(new KafkaFuture.BaseFunction&amp;lt;Map&amp;lt;String, TopicListing&amp;gt;, Set&amp;lt;String&amp;gt;&amp;gt;() {&lt;br/&gt;
             @Override&lt;br/&gt;
             public Set&amp;lt;String&amp;gt; apply(Map&amp;lt;String, TopicListing&amp;gt; namesToListings) {&lt;br/&gt;
                 return namesToListings.keySet();&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/common/KafkaFuture.java b/clients/src/main/java/org/apache/kafka/common/KafkaFuture.java&lt;br/&gt;
index 23e218137a9..9cd2e01dc42 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/common/KafkaFuture.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/common/KafkaFuture.java&lt;br/&gt;
@@ -35,18 +35,26 @@&lt;br/&gt;
     /**&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;A function which takes objects of type A and returns objects of type B.&lt;br/&gt;
      */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static abstract class Function&amp;lt;A, B&amp;gt; {&lt;/li&gt;
	&lt;li&gt;public abstract B apply(A a);&lt;br/&gt;
+    public interface BaseFunction&amp;lt;A, B&amp;gt; 
{
+        B apply(A a);
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+    /**&lt;br/&gt;
+     * A function which takes objects of type A and returns objects of type B.&lt;br/&gt;
+     *&lt;br/&gt;
+     * Prefer the functional interface &lt;/p&gt;
{@link BaseFunction}
&lt;p&gt; over the class &lt;/p&gt;
{@link Function}
&lt;p&gt;.  This class is here for&lt;br/&gt;
+     * backwards compatibility reasons and might be deprecated/removed in a future release.&lt;br/&gt;
+     */&lt;br/&gt;
+    public static abstract class Function&amp;lt;A, B&amp;gt; implements BaseFunction&amp;lt;A, B&amp;gt; { }&lt;br/&gt;
+&lt;br/&gt;
     /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;A consumer of two different types of object.&lt;br/&gt;
      */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static abstract class BiConsumer&amp;lt;A, B&amp;gt; {&lt;/li&gt;
	&lt;li&gt;public abstract void accept(A a, B b);&lt;br/&gt;
+    public interface BiConsumer&amp;lt;A, B&amp;gt; 
{
+        void accept(A a, B b);
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static class AllOfAdapter&amp;lt;R&amp;gt; extends BiConsumer&amp;lt;R, Throwable&amp;gt; {&lt;br/&gt;
+    private static class AllOfAdapter&amp;lt;R&amp;gt; implements BiConsumer&amp;lt;R, Throwable&amp;gt; {&lt;br/&gt;
         private int remainingResponses;&lt;br/&gt;
         private KafkaFuture&amp;lt;?&amp;gt; future;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -101,11 +109,43 @@ private void maybeComplete() {&lt;br/&gt;
     /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Returns a new KafkaFuture that, when this future completes normally, is executed with this&lt;/li&gt;
	&lt;li&gt;futures&apos;s result as the argument to the supplied function.&lt;br/&gt;
+     *&lt;br/&gt;
+     * The function may be invoked by the thread that calls 
{@code thenApply}
&lt;p&gt; or it may be invoked by the thread that&lt;br/&gt;
+     * completes the future.&lt;br/&gt;
+     */&lt;br/&gt;
+    public abstract &amp;lt;R&amp;gt; KafkaFuture&amp;lt;R&amp;gt; thenApply(BaseFunction&amp;lt;T, R&amp;gt; function);&lt;br/&gt;
+&lt;br/&gt;
+    /**&lt;br/&gt;
+     * @see KafkaFuture#thenApply(BaseFunction)&lt;br/&gt;
+     *&lt;br/&gt;
+     * Prefer &lt;/p&gt;
{@link KafkaFuture#thenApply(BaseFunction)}
&lt;p&gt; as this function is here for backwards compatibility reasons&lt;br/&gt;
+     * and might be deprecated/removed in a future release.&lt;br/&gt;
      */&lt;br/&gt;
     public abstract &amp;lt;R&amp;gt; KafkaFuture&amp;lt;R&amp;gt; thenApply(Function&amp;lt;T, R&amp;gt; function);&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;protected abstract void addWaiter(BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; action);&lt;br/&gt;
+    /**&lt;br/&gt;
+     * Returns a new KafkaFuture with the same result or exception as this future, that executes the given action&lt;br/&gt;
+     * when this future completes.&lt;br/&gt;
+     *&lt;br/&gt;
+     * When this future is done, the given action is invoked with the result (or null if none) and the exception&lt;br/&gt;
+     * (or null if none) of this future as arguments.&lt;br/&gt;
+     *&lt;br/&gt;
+     * The returned future is completed when the action returns.&lt;br/&gt;
+     * The supplied action should not throw an exception. However, if it does, the following rules apply:&lt;br/&gt;
+     * if this future completed normally but the supplied action throws an exception, then the returned future completes&lt;br/&gt;
+     * exceptionally with the supplied action&apos;s exception.&lt;br/&gt;
+     * Or, if this future completed exceptionally and the supplied action throws an exception, then the returned future&lt;br/&gt;
+     * completes exceptionally with this future&apos;s exception.&lt;br/&gt;
+     *&lt;br/&gt;
+     * The action may be invoked by the thread that calls 
{@code whenComplete}
&lt;p&gt; or it may be invoked by the thread that&lt;br/&gt;
+     * completes the future.&lt;br/&gt;
+     *&lt;br/&gt;
+     * @param action the action to preform&lt;br/&gt;
+     * @return the new future&lt;br/&gt;
+     */&lt;br/&gt;
+    public abstract KafkaFuture&amp;lt;T&amp;gt; whenComplete(BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; action);&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+    protected abstract void addWaiter(BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; action);&lt;br/&gt;
     /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;If not already completed, sets the value returned by get() and related methods to the given&lt;/li&gt;
	&lt;li&gt;value.&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/common/internals/KafkaFutureImpl.java b/clients/src/main/java/org/apache/kafka/common/internals/KafkaFutureImpl.java&lt;br/&gt;
index e2dbdf9be92..049ed491ab4 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/common/internals/KafkaFutureImpl.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/common/internals/KafkaFutureImpl.java&lt;br/&gt;
@@ -46,11 +46,11 @@ private static void wrapAndThrow(Throwable t) throws InterruptedException, Execu&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static class Applicant&amp;lt;A, B&amp;gt; extends BiConsumer&amp;lt;A, Throwable&amp;gt; {&lt;/li&gt;
	&lt;li&gt;private final Function&amp;lt;A, B&amp;gt; function;&lt;br/&gt;
+    private static class Applicant&amp;lt;A, B&amp;gt; implements BiConsumer&amp;lt;A, Throwable&amp;gt; {&lt;br/&gt;
+        private final BaseFunction&amp;lt;A, B&amp;gt; function;&lt;br/&gt;
         private final KafkaFutureImpl&amp;lt;B&amp;gt; future;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Applicant(Function&amp;lt;A, B&amp;gt; function, KafkaFutureImpl&amp;lt;B&amp;gt; future) {&lt;br/&gt;
+        Applicant(BaseFunction&amp;lt;A, B&amp;gt; function, KafkaFutureImpl&amp;lt;B&amp;gt; future) 
{
             this.function = function;
             this.future = future;
         }
&lt;p&gt;@@ -70,7 +70,7 @@ public void accept(A a, Throwable exception) {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static class SingleWaiter&amp;lt;R&amp;gt; extends BiConsumer&amp;lt;R, Throwable&amp;gt; {&lt;br/&gt;
+    private static class SingleWaiter&amp;lt;R&amp;gt; implements BiConsumer&amp;lt;R, Throwable&amp;gt; {&lt;br/&gt;
         private R value = null;&lt;br/&gt;
         private Throwable exception = null;&lt;br/&gt;
         private boolean done = false;&lt;br/&gt;
@@ -140,14 +140,59 @@ R await(long timeout, TimeUnit unit)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;futures&apos;s result as the argument to the supplied function.&lt;br/&gt;
      */&lt;br/&gt;
     @Override&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public &amp;lt;R&amp;gt; KafkaFuture&amp;lt;R&amp;gt; thenApply(Function&amp;lt;T, R&amp;gt; function) {&lt;br/&gt;
+    public &amp;lt;R&amp;gt; KafkaFuture&amp;lt;R&amp;gt; thenApply(BaseFunction&amp;lt;T, R&amp;gt; function) 
{
         KafkaFutureImpl&amp;lt;R&amp;gt; future = new KafkaFutureImpl&amp;lt;R&amp;gt;();
         addWaiter(new Applicant&amp;lt;&amp;gt;(function, future));
         return future;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+&lt;br/&gt;
+    /**&lt;br/&gt;
+     * @See KafkaFutureImpl#thenApply(BaseFunction)&lt;br/&gt;
+     */&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public &amp;lt;R&amp;gt; KafkaFuture&amp;lt;R&amp;gt; thenApply(Function&amp;lt;T, R&amp;gt; function) &lt;/p&gt;
{
+        return thenApply((BaseFunction&amp;lt;T, R&amp;gt;) function);
+    }
&lt;p&gt;+&lt;br/&gt;
+    private static class WhenCompleteBiConsumer&amp;lt;T&amp;gt; implements BiConsumer&amp;lt;T, Throwable&amp;gt; {&lt;br/&gt;
+        private final KafkaFutureImpl&amp;lt;T&amp;gt; future;&lt;br/&gt;
+        private final BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; biConsumer;&lt;br/&gt;
+&lt;br/&gt;
+        WhenCompleteBiConsumer(KafkaFutureImpl&amp;lt;T&amp;gt; future, BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; biConsumer) &lt;/p&gt;
{
+            this.future = future;
+            this.biConsumer = biConsumer;
+        }
&lt;p&gt;+&lt;br/&gt;
+        @Override&lt;br/&gt;
+        public void accept(T val, Throwable exception) {&lt;br/&gt;
+            try {&lt;br/&gt;
+                if (exception != null) &lt;/p&gt;
{
+                    biConsumer.accept(null, exception);
+                }
&lt;p&gt; else &lt;/p&gt;
{
+                    biConsumer.accept(val, null);
+                }
&lt;p&gt;+            } catch (Throwable e) {&lt;br/&gt;
+                if (exception == null) &lt;/p&gt;
{
+                    exception = e;
+                }
&lt;p&gt;+            }&lt;br/&gt;
+            if (exception != null) &lt;/p&gt;
{
+                future.completeExceptionally(exception);
+            }
&lt;p&gt; else &lt;/p&gt;
{
+                future.complete(val);
+            }
&lt;p&gt;+        }&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
     @Override&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;protected synchronized void addWaiter(BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; action) {&lt;br/&gt;
+    public KafkaFuture&amp;lt;T&amp;gt; whenComplete(final BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; biConsumer) 
{
+        final KafkaFutureImpl&amp;lt;T&amp;gt; future = new KafkaFutureImpl&amp;lt;&amp;gt;();
+        addWaiter(new WhenCompleteBiConsumer&amp;lt;&amp;gt;(future, biConsumer));
+        return future;
+    }
&lt;p&gt;+&lt;br/&gt;
+    public synchronized void addWaiter(BiConsumer&amp;lt;? super T, ? super Throwable&amp;gt; action) {&lt;br/&gt;
         if (exception != null) &lt;/p&gt;
{
             action.accept(null, exception);
         }
&lt;p&gt; else if (done) {&lt;br/&gt;
diff --git a/clients/src/test/java/org/apache/kafka/common/KafkaFutureTest.java b/clients/src/test/java/org/apache/kafka/common/KafkaFutureTest.java&lt;br/&gt;
index 71f3c3c984d..6f9efca7c66 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/test/java/org/apache/kafka/common/KafkaFutureTest.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/common/KafkaFutureTest.java&lt;br/&gt;
@@ -83,6 +83,47 @@ public void testCompletingFutures() throws Exception 
{
         assertEquals(null, myThread.testException);
     }&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+    @Test&lt;br/&gt;
+    public void testThenApply() throws Exception {&lt;br/&gt;
+        KafkaFutureImpl&amp;lt;Integer&amp;gt; future = new KafkaFutureImpl&amp;lt;&amp;gt;();&lt;br/&gt;
+        KafkaFuture&amp;lt;Integer&amp;gt; doubledFuture = future.thenApply(new KafkaFuture.BaseFunction&amp;lt;Integer, Integer&amp;gt;() {&lt;br/&gt;
+            @Override&lt;br/&gt;
+            public Integer apply(Integer integer) &lt;/p&gt;
{
+                return 2 * integer;
+            }&lt;br/&gt;
+        });&lt;br/&gt;
+        assertFalse(doubledFuture.isDone());&lt;br/&gt;
+        KafkaFuture&amp;lt;Integer&amp;gt; tripledFuture = future.thenApply(new KafkaFuture.Function&amp;lt;Integer, Integer&amp;gt;() {&lt;br/&gt;
+            @Override&lt;br/&gt;
+            public Integer apply(Integer integer) {
+                return 3 * integer;
+            }&lt;br/&gt;
+        });&lt;br/&gt;
+        assertFalse(tripledFuture.isDone());&lt;br/&gt;
+        future.complete(21);&lt;br/&gt;
+        assertEquals(Integer.valueOf(21), future.getNow(-1));&lt;br/&gt;
+        assertEquals(Integer.valueOf(42), doubledFuture.getNow(-1));&lt;br/&gt;
+        assertEquals(Integer.valueOf(63), tripledFuture.getNow(-1));&lt;br/&gt;
+        KafkaFuture&amp;lt;Integer&amp;gt; quadrupledFuture = future.thenApply(new KafkaFuture.BaseFunction&amp;lt;Integer, Integer&amp;gt;() {&lt;br/&gt;
+            @Override&lt;br/&gt;
+            public Integer apply(Integer integer) {
+                return 4 * integer;
+            }&lt;br/&gt;
+        });&lt;br/&gt;
+        assertEquals(Integer.valueOf(84), quadrupledFuture.getNow(-1));&lt;br/&gt;
+&lt;br/&gt;
+        KafkaFutureImpl&amp;lt;Integer&amp;gt; futureFail = new KafkaFutureImpl&amp;lt;&amp;gt;();&lt;br/&gt;
+        KafkaFuture&amp;lt;Integer&amp;gt; futureAppliedFail = futureFail.thenApply(new KafkaFuture.BaseFunction&amp;lt;Integer, Integer&amp;gt;() {&lt;br/&gt;
+            @Override&lt;br/&gt;
+            public Integer apply(Integer integer) {+                return 2 * integer;+            }
&lt;p&gt;+        });&lt;br/&gt;
+        futureFail.completeExceptionally(new RuntimeException());&lt;br/&gt;
+        assertTrue(futureFail.isCompletedExceptionally());&lt;br/&gt;
+        assertTrue(futureAppliedFail.isCompletedExceptionally());&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
     private static class CompleterThread&amp;lt;T&amp;gt; extends Thread {&lt;/p&gt;

&lt;p&gt;         private final KafkaFutureImpl&amp;lt;T&amp;gt; future;&lt;br/&gt;
diff --git a/clients/src/test/java/org/apache/kafka/common/utils/MockScheduler.java b/clients/src/test/java/org/apache/kafka/common/utils/MockScheduler.java&lt;br/&gt;
index ba5e1ed0c59..7134f0aaa42 100644&lt;br/&gt;
&amp;#8212; a/clients/src/test/java/org/apache/kafka/common/utils/MockScheduler.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/common/utils/MockScheduler.java&lt;br/&gt;
@@ -87,7 +87,7 @@ public synchronized void addWaiter(long delayMs, KafkaFutureImpl&amp;lt;Long&amp;gt; waiter) {&lt;br/&gt;
                                   final Callable&amp;lt;T&amp;gt; callable, long delayMs) {&lt;br/&gt;
         final KafkaFutureImpl&amp;lt;T&amp;gt; future = new KafkaFutureImpl&amp;lt;&amp;gt;();&lt;br/&gt;
         KafkaFutureImpl&amp;lt;Long&amp;gt; waiter = new KafkaFutureImpl&amp;lt;&amp;gt;();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiter.thenApply(new KafkaFuture.Function&amp;lt;Long, Void&amp;gt;() {&lt;br/&gt;
+        waiter.thenApply(new KafkaFuture.BaseFunction&amp;lt;Long, Void&amp;gt;() {&lt;br/&gt;
             @Override&lt;br/&gt;
             public Void apply(final Long now) {&lt;br/&gt;
                 executor.submit(new Callable&amp;lt;Void&amp;gt;() {&lt;br/&gt;
diff --git a/tools/src/main/java/org/apache/kafka/trogdor/agent/WorkerManager.java b/tools/src/main/java/org/apache/kafka/trogdor/agent/WorkerManager.java&lt;br/&gt;
index 3c03e1e62ca..cda77738d8c 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/tools/src/main/java/org/apache/kafka/trogdor/agent/WorkerManager.java&lt;br/&gt;
+++ b/tools/src/main/java/org/apache/kafka/trogdor/agent/WorkerManager.java&lt;br/&gt;
@@ -290,7 +290,7 @@ public void createWorker(final String id, TaskSpec spec) throws Exception 
{
                 return;
             }
&lt;p&gt;             KafkaFutureImpl&amp;lt;String&amp;gt; haltFuture = new KafkaFutureImpl&amp;lt;&amp;gt;();&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;haltFuture.thenApply(new KafkaFuture.Function&amp;lt;String, Void&amp;gt;() {&lt;br/&gt;
+            haltFuture.thenApply(new KafkaFuture.BaseFunction&amp;lt;String, Void&amp;gt;() {&lt;br/&gt;
                 @Override&lt;br/&gt;
                 public Void apply(String errorString) {&lt;br/&gt;
                     if (errorString.isEmpty()) {&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 41 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3kydr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>