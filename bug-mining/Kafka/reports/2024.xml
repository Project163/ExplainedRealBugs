<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:14:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-5975] No response when deleting topics and delete.topic.enable=false</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-5975</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;When trying to delete topics using the KafkaAdminClient and the flag in server config is set as &apos;delete.topic.enable=false&apos;, the client cannot get a response and fails returning a timeout error. This is due to the object DelayedCreatePartitions cannot complete the operation.&lt;/p&gt;

&lt;p&gt;This bug fix modifies the KafkaApi key DELETE_TOPICS taking into account that the flag can be disabled and swallow the error to the client, this is, the topic is never removed and no error is returned to the client.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13104966">KAFKA-5975</key>
            <summary>No response when deleting topics and delete.topic.enable=false</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mmolimar">Mario Molina</assignee>
                                    <reporter username="mmolimar">Mario Molina</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Sep 2017 02:06:53 +0000</created>
                <updated>Wed, 24 Oct 2018 16:48:13 +0000</updated>
                            <resolved>Fri, 24 Aug 2018 15:32:30 +0000</resolved>
                                    <version>0.11.0.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16180095" author="githubbot" created="Tue, 26 Sep 2017 02:12:53 +0000"  >&lt;p&gt;GitHub user mmolimar opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3960&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3960&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5975&quot; title=&quot;No response when deleting topics and delete.topic.enable=false&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5975&quot;&gt;&lt;del&gt;KAFKA-5975&lt;/del&gt;&lt;/a&gt;: No response when deleting topics and delete.topic.enable=false&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mmolimar/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mmolimar/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5975&quot; title=&quot;No response when deleting topics and delete.topic.enable=false&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5975&quot;&gt;&lt;del&gt;KAFKA-5975&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3960.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3960.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3960&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit f22a5547f3d9573e3f8bfbe3c624dc6eab595c8f&lt;br/&gt;
Author: Mario Molina &amp;lt;mmolimar@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-09-26T02:10:58Z&lt;/p&gt;

&lt;p&gt;    Fix response when deleting topics and delete.topic.enable=false&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16180336" author="ijuma" created="Tue, 26 Sep 2017 06:48:14 +0000"  >&lt;p&gt;We should probably return an error in this case, right?&lt;/p&gt;</comment>
                            <comment id="16180783" author="mmolimar" created="Tue, 26 Sep 2017 13:44:20 +0000"  >&lt;p&gt;Yes, I just included a new API Error: INCOMPATIBLE_WITH_CONFIG with its corresponding exception.&lt;/p&gt;</comment>
                            <comment id="16242113" author="mmolimar" created="Tue, 7 Nov 2017 14:39:47 +0000"  >&lt;p&gt;The error returned finally was INVALID_REQUEST in order to avoid modifying the API Errors.&lt;/p&gt;</comment>
                            <comment id="16245502" author="rsivaram" created="Thu, 9 Nov 2017 11:03:56 +0000"  >&lt;p&gt;Moving this out to the next release since it is marked as Priority Minor and the PR still needs review.&lt;/p&gt;</comment>
                            <comment id="16343886" author="ewencp" created="Mon, 29 Jan 2018 19:40:53 +0000"  >&lt;p&gt;Moving from 1.0.1 to 1.0.2 as this isn&apos;t ready for 1.0.1.&lt;/p&gt;</comment>
                            <comment id="16439572" author="mmolimar" created="Mon, 16 Apr 2018 15:18:38 +0000"  >&lt;p&gt;What about this fix? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ewencp&quot; class=&quot;user-hover&quot; rel=&quot;ewencp&quot;&gt;ewencp&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rsivaram&quot; class=&quot;user-hover&quot; rel=&quot;rsivaram&quot;&gt;rsivaram&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16517623" author="lindong" created="Tue, 19 Jun 2018 23:23:09 +0000"  >&lt;p&gt;Moving from 1.1.1 to 1.1.2 since it is marked as Priority Minor and the PR still needs review.&lt;/p&gt;</comment>
                            <comment id="16591815" author="githubbot" created="Fri, 24 Aug 2018 15:32:09 +0000"  >&lt;p&gt;hachikuji closed pull request #3960: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5975&quot; title=&quot;No response when deleting topics and delete.topic.enable=false&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5975&quot;&gt;&lt;del&gt;KAFKA-5975&lt;/del&gt;&lt;/a&gt;: No response when deleting topics and delete.topic.enable=false&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/3960&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3960&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/clients/src/main/java/org/apache/kafka/common/errors/TopicDeletionDisabledException.java b/clients/src/main/java/org/apache/kafka/common/errors/TopicDeletionDisabledException.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..41577d2a288&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/common/errors/TopicDeletionDisabledException.java&lt;br/&gt;
@@ -0,0 +1,29 @@&lt;br/&gt;
+/*&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+ * contributor license agreements. See the NOTICE file distributed with&lt;br/&gt;
+ * this work for additional information regarding copyright ownership.&lt;br/&gt;
+ * The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+ * (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+ * the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ *    &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+ * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+ * See the License for the specific language governing permissions and&lt;br/&gt;
+ * limitations under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+&lt;br/&gt;
+package org.apache.kafka.common.errors;&lt;br/&gt;
+&lt;br/&gt;
+public class TopicDeletionDisabledException extends  ApiException {&lt;br/&gt;
+    private static final long serialVersionUID = 1L;&lt;br/&gt;
+&lt;br/&gt;
+    public TopicDeletionDisabledException() &lt;/p&gt;
{
+    }
&lt;p&gt;+&lt;br/&gt;
+    public TopicDeletionDisabledException(String message) &lt;/p&gt;
{
+        super(message);
+    }
&lt;p&gt;+}&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/common/protocol/Errors.java b/clients/src/main/java/org/apache/kafka/common/protocol/Errors.java&lt;br/&gt;
index 090dca32651..d4610602d1e 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/common/protocol/Errors.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/common/protocol/Errors.java&lt;br/&gt;
@@ -80,6 +80,7 @@&lt;br/&gt;
 import org.apache.kafka.common.errors.SecurityDisabledException;&lt;br/&gt;
 import org.apache.kafka.common.errors.TimeoutException;&lt;br/&gt;
 import org.apache.kafka.common.errors.TopicAuthorizationException;&lt;br/&gt;
+import org.apache.kafka.common.errors.TopicDeletionDisabledException;&lt;br/&gt;
 import org.apache.kafka.common.errors.TopicExistsException;&lt;br/&gt;
 import org.apache.kafka.common.errors.TransactionalIdAuthorizationException;&lt;br/&gt;
 import org.apache.kafka.common.errors.TransactionCoordinatorFencedException;&lt;br/&gt;
@@ -110,7 +111,7 @@&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Do not add exceptions that occur only on the client or only on the server here.&lt;br/&gt;
  */&lt;br/&gt;
 public enum Errors {&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;UNKNOWN_SERVER_ERROR(-1, &quot;The server experienced an unexpected error when processing the request&quot;,&lt;br/&gt;
+    UNKNOWN_SERVER_ERROR(-1, &quot;The server experienced an unexpected error when processing the request,&quot;,&lt;br/&gt;
             UnknownServerException::new),&lt;br/&gt;
     NONE(0, null, message -&amp;gt; null),&lt;br/&gt;
     OFFSET_OUT_OF_RANGE(1, &quot;The requested offset is not within the range of offsets maintained by the server.&quot;,&lt;br/&gt;
@@ -129,7 +130,7 @@&lt;br/&gt;
             TimeoutException::new),&lt;br/&gt;
     BROKER_NOT_AVAILABLE(8, &quot;The broker is not available.&quot;,&lt;br/&gt;
             BrokerNotAvailableException::new),&lt;/li&gt;
	&lt;li&gt;REPLICA_NOT_AVAILABLE(9, &quot;The replica is not available for the requested topic-partition&quot;,&lt;br/&gt;
+    REPLICA_NOT_AVAILABLE(9, &quot;The replica is not available for the requested topic-partition.&quot;,&lt;br/&gt;
             ReplicaNotAvailableException::new),&lt;br/&gt;
     MESSAGE_TOO_LARGE(10, &quot;The request included a message larger than the max message size the server will accept.&quot;,&lt;br/&gt;
             RecordTooLargeException::new),&lt;br/&gt;
@@ -161,7 +162,7 @@&lt;br/&gt;
             &quot;The group member&apos;s supported protocols are incompatible with those of existing members&quot; +&lt;br/&gt;
                 &quot; or first group member tried to join with empty protocol type or empty protocol list.&quot;,&lt;br/&gt;
             InconsistentGroupProtocolException::new),&lt;/li&gt;
	&lt;li&gt;INVALID_GROUP_ID(24, &quot;The configured groupId is invalid&quot;,&lt;br/&gt;
+    INVALID_GROUP_ID(24, &quot;The configured groupId is invalid.&quot;,&lt;br/&gt;
             InvalidGroupIdException::new),&lt;br/&gt;
     UNKNOWN_MEMBER_ID(25, &quot;The coordinator is not aware of this member.&quot;,&lt;br/&gt;
             UnknownMemberIdException::new),&lt;br/&gt;
@@ -171,7 +172,7 @@&lt;br/&gt;
             InvalidSessionTimeoutException::new),&lt;br/&gt;
     REBALANCE_IN_PROGRESS(27, &quot;The group is rebalancing, so a rejoin is needed.&quot;,&lt;br/&gt;
             RebalanceInProgressException::new),&lt;/li&gt;
	&lt;li&gt;INVALID_COMMIT_OFFSET_SIZE(28, &quot;The committing offset data size is not valid&quot;,&lt;br/&gt;
+    INVALID_COMMIT_OFFSET_SIZE(28, &quot;The committing offset data size is not valid.&quot;,&lt;br/&gt;
             InvalidCommitOffsetSizeException::new),&lt;br/&gt;
     TOPIC_AUTHORIZATION_FAILED(29, &quot;Topic authorization failed.&quot;,&lt;br/&gt;
             TopicAuthorizationException::new),&lt;br/&gt;
@@ -207,28 +208,28 @@&lt;br/&gt;
             UnsupportedForMessageFormatException::new),&lt;br/&gt;
     POLICY_VIOLATION(44, &quot;Request parameters do not satisfy the configured policy.&quot;,&lt;br/&gt;
             PolicyViolationException::new),&lt;/li&gt;
	&lt;li&gt;OUT_OF_ORDER_SEQUENCE_NUMBER(45, &quot;The broker received an out of order sequence number&quot;,&lt;br/&gt;
+    OUT_OF_ORDER_SEQUENCE_NUMBER(45, &quot;The broker received an out of order sequence number.&quot;,&lt;br/&gt;
             OutOfOrderSequenceException::new),&lt;/li&gt;
	&lt;li&gt;DUPLICATE_SEQUENCE_NUMBER(46, &quot;The broker received a duplicate sequence number&quot;,&lt;br/&gt;
+    DUPLICATE_SEQUENCE_NUMBER(46, &quot;The broker received a duplicate sequence number.&quot;,&lt;br/&gt;
             DuplicateSequenceException::new),&lt;br/&gt;
     INVALID_PRODUCER_EPOCH(47, &quot;Producer attempted an operation with an old epoch. Either there is a newer producer &quot; +&lt;br/&gt;
             &quot;with the same transactionalId, or the producer&apos;s transaction has been expired by the broker.&quot;,&lt;br/&gt;
             ProducerFencedException::new),&lt;/li&gt;
	&lt;li&gt;INVALID_TXN_STATE(48, &quot;The producer attempted a transactional operation in an invalid state&quot;,&lt;br/&gt;
+    INVALID_TXN_STATE(48, &quot;The producer attempted a transactional operation in an invalid state.&quot;,&lt;br/&gt;
             InvalidTxnStateException::new),&lt;br/&gt;
     INVALID_PRODUCER_ID_MAPPING(49, &quot;The producer attempted to use a producer id which is not currently assigned to &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;its transactional id&quot;,&lt;br/&gt;
+            &quot;its transactional id.&quot;,&lt;br/&gt;
             InvalidPidMappingException::new),&lt;br/&gt;
     INVALID_TRANSACTION_TIMEOUT(50, &quot;The transaction timeout is larger than the maximum value allowed by &quot; +&lt;br/&gt;
                 &quot;the broker (as configured by transaction.max.timeout.ms).&quot;,&lt;br/&gt;
             InvalidTxnTimeoutException::new),&lt;br/&gt;
     CONCURRENT_TRANSACTIONS(51, &quot;The producer attempted to update a transaction &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;while another concurrent operation on the same transaction was ongoing&quot;,&lt;br/&gt;
+                &quot;while another concurrent operation on the same transaction was ongoing.&quot;,&lt;br/&gt;
             ConcurrentTransactionsException::new),&lt;br/&gt;
     TRANSACTION_COORDINATOR_FENCED(52, &quot;Indicates that the transaction coordinator sending a WriteTxnMarker &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;is no longer the current coordinator for a given producer&quot;,&lt;br/&gt;
+            &quot;is no longer the current coordinator for a given producer.&quot;,&lt;br/&gt;
             TransactionCoordinatorFencedException::new),&lt;/li&gt;
	&lt;li&gt;TRANSACTIONAL_ID_AUTHORIZATION_FAILED(53, &quot;Transactional Id authorization failed&quot;,&lt;br/&gt;
+    TRANSACTIONAL_ID_AUTHORIZATION_FAILED(53, &quot;Transactional Id authorization failed.&quot;,&lt;br/&gt;
             TransactionalIdAuthorizationException::new),&lt;br/&gt;
     SECURITY_DISABLED(54, &quot;Security features are disabled.&quot;,&lt;br/&gt;
             SecurityDisabledException::new),&lt;br/&gt;
@@ -248,7 +249,7 @@&lt;br/&gt;
             &quot;removed, the producer&apos;s metadata is removed from the broker, and future appends by the producer will &quot; +&lt;br/&gt;
             &quot;return this exception.&quot;,&lt;br/&gt;
             UnknownProducerIdException::new),&lt;/li&gt;
	&lt;li&gt;REASSIGNMENT_IN_PROGRESS(60, &quot;A partition reassignment is in progress&quot;,&lt;br/&gt;
+    REASSIGNMENT_IN_PROGRESS(60, &quot;A partition reassignment is in progress.&quot;,&lt;br/&gt;
             ReassignmentInProgressException::new),&lt;br/&gt;
     DELEGATION_TOKEN_AUTH_DISABLED(61, &quot;Delegation Token feature is not enabled.&quot;,&lt;br/&gt;
             DelegationTokenDisabledException::new),&lt;br/&gt;
@@ -263,19 +264,21 @@&lt;br/&gt;
             DelegationTokenAuthorizationException::new),&lt;br/&gt;
     DELEGATION_TOKEN_EXPIRED(66, &quot;Delegation Token is expired.&quot;,&lt;br/&gt;
             DelegationTokenExpiredException::new),&lt;/li&gt;
	&lt;li&gt;INVALID_PRINCIPAL_TYPE(67, &quot;Supplied principalType is not supported&quot;,&lt;br/&gt;
+    INVALID_PRINCIPAL_TYPE(67, &quot;Supplied principalType is not supported.&quot;,&lt;br/&gt;
             InvalidPrincipalTypeException::new),&lt;/li&gt;
	&lt;li&gt;NON_EMPTY_GROUP(68, &quot;The group is not empty&quot;,&lt;br/&gt;
+    NON_EMPTY_GROUP(68, &quot;The group is not empty.&quot;,&lt;br/&gt;
             GroupNotEmptyException::new),&lt;/li&gt;
	&lt;li&gt;GROUP_ID_NOT_FOUND(69, &quot;The group id does not exist&quot;,&lt;br/&gt;
+    GROUP_ID_NOT_FOUND(69, &quot;The group id does not exist.&quot;,&lt;br/&gt;
             GroupIdNotFoundException::new),&lt;/li&gt;
	&lt;li&gt;FETCH_SESSION_ID_NOT_FOUND(70, &quot;The fetch session ID was not found&quot;,&lt;br/&gt;
+    FETCH_SESSION_ID_NOT_FOUND(70, &quot;The fetch session ID was not found.&quot;,&lt;br/&gt;
             FetchSessionIdNotFoundException::new),&lt;/li&gt;
	&lt;li&gt;INVALID_FETCH_SESSION_EPOCH(71, &quot;The fetch session epoch is invalid&quot;,&lt;br/&gt;
+    INVALID_FETCH_SESSION_EPOCH(71, &quot;The fetch session epoch is invalid.&quot;,&lt;br/&gt;
             InvalidFetchSessionEpochException::new),&lt;br/&gt;
     LISTENER_NOT_FOUND(72, &quot;There is no listener on the leader broker that matches the listener on which &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;metadata request was processed&quot;,&lt;/li&gt;
	&lt;li&gt;ListenerNotFoundException::new),;&lt;br/&gt;
+            &quot;metadata request was processed.&quot;,&lt;br/&gt;
+            ListenerNotFoundException::new),&lt;br/&gt;
+    TOPIC_DELETION_DISABLED(73, &quot;Topic deletion is disabled.&quot;,&lt;br/&gt;
+            TopicDeletionDisabledException::new);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     private static final Logger log = LoggerFactory.getLogger(Errors.class);&lt;/p&gt;

&lt;p&gt;diff --git a/clients/src/main/java/org/apache/kafka/common/requests/DeleteTopicsRequest.java b/clients/src/main/java/org/apache/kafka/common/requests/DeleteTopicsRequest.java&lt;br/&gt;
index dbcc25d37c6..87f14b4aa63 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/common/requests/DeleteTopicsRequest.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/common/requests/DeleteTopicsRequest.java&lt;br/&gt;
@@ -51,9 +51,15 @@&lt;br/&gt;
      */&lt;br/&gt;
     private static final Schema DELETE_TOPICS_REQUEST_V2 = DELETE_TOPICS_REQUEST_V1;&lt;/p&gt;

&lt;p&gt;+    /**&lt;br/&gt;
+     * v3 request is the same that as v2. The response is different based on the request version.&lt;br/&gt;
+     * In v3 version a TopicDeletionDisabledException is returned&lt;br/&gt;
+     */&lt;br/&gt;
+    private static final Schema DELETE_TOPICS_REQUEST_V3 = DELETE_TOPICS_REQUEST_V2;&lt;br/&gt;
+&lt;br/&gt;
     public static Schema[] schemaVersions() {&lt;br/&gt;
         return new Schema[]&lt;/p&gt;
{DELETE_TOPICS_REQUEST_V0, DELETE_TOPICS_REQUEST_V1,
-            DELETE_TOPICS_REQUEST_V2}
&lt;p&gt;;&lt;br/&gt;
+            DELETE_TOPICS_REQUEST_V2, DELETE_TOPICS_REQUEST_V3};&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;     private final Set&amp;lt;String&amp;gt; topics;&lt;br/&gt;
@@ -121,6 +127,7 @@ public AbstractResponse getErrorResponse(int throttleTimeMs, Throwable e) {&lt;br/&gt;
                 return new DeleteTopicsResponse(topicErrors);&lt;br/&gt;
             case 1:&lt;br/&gt;
             case 2:&lt;br/&gt;
+            case 3:&lt;br/&gt;
                 return new DeleteTopicsResponse(throttleTimeMs, topicErrors);&lt;br/&gt;
             default:&lt;br/&gt;
                 throw new IllegalArgumentException(String.format(&quot;Version %d is not valid. Valid versions for %s are 0 to %d&quot;,&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/common/requests/DeleteTopicsResponse.java b/clients/src/main/java/org/apache/kafka/common/requests/DeleteTopicsResponse.java&lt;br/&gt;
index db1c4343f9e..650caa829ab 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/common/requests/DeleteTopicsResponse.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/common/requests/DeleteTopicsResponse.java&lt;br/&gt;
@@ -53,8 +53,15 @@&lt;br/&gt;
      */&lt;br/&gt;
     private static final Schema DELETE_TOPICS_RESPONSE_V2 = DELETE_TOPICS_RESPONSE_V1;&lt;/p&gt;

&lt;p&gt;+    /**&lt;br/&gt;
+     * v3 request is the same that as v2. The response is different based on the request version.&lt;br/&gt;
+     * In v3 version a TopicDeletionDisabledException is returned&lt;br/&gt;
+     */&lt;br/&gt;
+    private static final Schema DELETE_TOPICS_RESPONSE_V3 = DELETE_TOPICS_RESPONSE_V2;&lt;br/&gt;
+&lt;br/&gt;
     public static Schema[] schemaVersions() {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return new Schema[]
{DELETE_TOPICS_RESPONSE_V0, DELETE_TOPICS_RESPONSE_V1, DELETE_TOPICS_RESPONSE_V2}
&lt;p&gt;;&lt;br/&gt;
+        return new Schema[]&lt;/p&gt;
{DELETE_TOPICS_RESPONSE_V0, DELETE_TOPICS_RESPONSE_V1,
+            DELETE_TOPICS_RESPONSE_V2, DELETE_TOPICS_RESPONSE_V3}
&lt;p&gt;;&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;@@ -65,6 +72,8 @@&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;INVALID_TOPIC_EXCEPTION(17)&lt;/li&gt;
	&lt;li&gt;TOPIC_AUTHORIZATION_FAILED(29)&lt;/li&gt;
	&lt;li&gt;NOT_CONTROLLER(41)&lt;br/&gt;
+     * INVALID_REQUEST(42)&lt;br/&gt;
+     * TOPIC_DELETION_DISABLED(73)&lt;br/&gt;
      */&lt;br/&gt;
     private final Map&amp;lt;String, Errors&amp;gt; errors;&lt;br/&gt;
     private final int throttleTimeMs;&lt;br/&gt;
diff --git a/clients/src/test/java/org/apache/kafka/clients/admin/KafkaAdminClientTest.java b/clients/src/test/java/org/apache/kafka/clients/admin/KafkaAdminClientTest.java&lt;br/&gt;
index 70794714026..0245cbd3695 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/test/java/org/apache/kafka/clients/admin/KafkaAdminClientTest.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/clients/admin/KafkaAdminClientTest.java&lt;br/&gt;
@@ -45,6 +45,7 @@&lt;br/&gt;
 import org.apache.kafka.common.errors.SaslAuthenticationException;&lt;br/&gt;
 import org.apache.kafka.common.errors.SecurityDisabledException;&lt;br/&gt;
 import org.apache.kafka.common.errors.TimeoutException;&lt;br/&gt;
+import org.apache.kafka.common.errors.TopicDeletionDisabledException;&lt;br/&gt;
 import org.apache.kafka.common.errors.UnknownTopicOrPartitionException;&lt;br/&gt;
 import org.apache.kafka.common.protocol.Errors;&lt;br/&gt;
 import org.apache.kafka.common.requests.ApiError;&lt;br/&gt;
@@ -58,6 +59,8 @@&lt;br/&gt;
 import org.apache.kafka.common.requests.DeleteAclsResponse.AclFilterResponse;&lt;br/&gt;
 import org.apache.kafka.common.requests.DeleteGroupsResponse;&lt;br/&gt;
 import org.apache.kafka.common.requests.DeleteRecordsResponse;&lt;br/&gt;
+import org.apache.kafka.common.requests.DeleteTopicsRequest;&lt;br/&gt;
+import org.apache.kafka.common.requests.DeleteTopicsResponse;&lt;br/&gt;
 import org.apache.kafka.common.requests.DescribeAclsResponse;&lt;br/&gt;
 import org.apache.kafka.common.requests.DescribeConfigsResponse;&lt;br/&gt;
 import org.apache.kafka.common.requests.DescribeGroupsResponse;&lt;br/&gt;
@@ -378,6 +381,32 @@ public void testCreateTopicsHandleNotControllerException() throws Exception {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+    @Test&lt;br/&gt;
+    public void testDeleteTopics() throws Exception {&lt;br/&gt;
+        try (AdminClientUnitTestEnv env = mockClientEnv()) &lt;/p&gt;
{
+            env.kafkaClient().setNodeApiVersions(NodeApiVersions.create());
+            env.kafkaClient().setNode(env.cluster().controller());
+
+            env.kafkaClient().prepareResponse(body -&amp;gt; body instanceof DeleteTopicsRequest,
+                    new DeleteTopicsResponse(Collections.singletonMap(&quot;myTopic&quot;, Errors.NONE)));
+            KafkaFuture&amp;lt;Void&amp;gt; future = env.adminClient().deleteTopics(Collections.singletonList(&quot;myTopic&quot;),
+                    new DeleteTopicsOptions()).all();
+            future.get();
+
+            env.kafkaClient().prepareResponse(body -&amp;gt; body instanceof DeleteTopicsRequest,
+                    new DeleteTopicsResponse(Collections.singletonMap(&quot;myTopic&quot;, Errors.TOPIC_DELETION_DISABLED)));
+            future = env.adminClient().deleteTopics(Collections.singletonList(&quot;myTopic&quot;),
+                    new DeleteTopicsOptions()).all();
+            TestUtils.assertFutureError(future, TopicDeletionDisabledException.class);
+
+            env.kafkaClient().prepareResponse(body -&amp;gt; body instanceof DeleteTopicsRequest,
+                    new DeleteTopicsResponse(Collections.singletonMap(&quot;myTopic&quot;, Errors.UNKNOWN_TOPIC_OR_PARTITION)));
+            future = env.adminClient().deleteTopics(Collections.singletonList(&quot;myTopic&quot;),
+                    new DeleteTopicsOptions()).all();
+            TestUtils.assertFutureError(future, UnknownTopicOrPartitionException.class);
+        }
&lt;p&gt;+    }&lt;br/&gt;
+&lt;br/&gt;
     @Test&lt;br/&gt;
     public void testInvalidTopicNames() throws Exception {&lt;br/&gt;
         try (AdminClientUnitTestEnv env = mockClientEnv()) &lt;/p&gt;
{
diff --git a/core/src/main/scala/kafka/server/KafkaApis.scala b/core/src/main/scala/kafka/server/KafkaApis.scala
index 0273e3da557..096ff388bdd 100644
--- a/core/src/main/scala/kafka/server/KafkaApis.scala
+++ b/core/src/main/scala/kafka/server/KafkaApis.scala
@@ -1539,6 +1539,12 @@ class KafkaApis(val requestChannel: RequestChannel,
         (topic, Errors.NOT_CONTROLLER)
       }
&lt;p&gt;.toMap&lt;br/&gt;
       sendResponseCallback(results)&lt;br/&gt;
+    } else if (!config.deleteTopicEnable) {&lt;br/&gt;
+      val error = if (request.context.apiVersion &amp;lt; 3) Errors.INVALID_REQUEST else Errors.TOPIC_DELETION_DISABLED&lt;br/&gt;
+      val results = deleteTopicRequest.topics.asScala.map &lt;/p&gt;
{ topic =&amp;gt;
+        (topic, error)
+      }
&lt;p&gt;.toMap&lt;br/&gt;
+      sendResponseCallback(results)&lt;br/&gt;
     } else {&lt;br/&gt;
       // If no authorized topics return immediately&lt;br/&gt;
       if (authorizedForDeleteTopics.isEmpty)&lt;br/&gt;
diff --git a/core/src/test/scala/unit/kafka/server/DeleteTopicsRequestWithDeletionDisabledTest.scala b/core/src/test/scala/unit/kafka/server/DeleteTopicsRequestWithDeletionDisabledTest.scala&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..20e30c08a9f&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/core/src/test/scala/unit/kafka/server/DeleteTopicsRequestWithDeletionDisabledTest.scala&lt;br/&gt;
@@ -0,0 +1,59 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+ * contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+ * this work for additional information regarding copyright ownership.&lt;br/&gt;
+ * The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+ * (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+ * the License.  You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+ * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+ * See the License for the specific language governing permissions and&lt;br/&gt;
+ * limitations under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+&lt;br/&gt;
+package kafka.server&lt;br/&gt;
+&lt;br/&gt;
+import kafka.network.SocketServer&lt;br/&gt;
+import kafka.utils._&lt;br/&gt;
+import org.apache.kafka.common.protocol.&lt;/p&gt;
{ApiKeys, Errors}
&lt;p&gt;+import org.apache.kafka.common.requests.&lt;/p&gt;
{DeleteTopicsRequest, DeleteTopicsResponse}
&lt;p&gt;+import org.junit.Assert._&lt;br/&gt;
+import org.junit.Test&lt;br/&gt;
+&lt;br/&gt;
+import scala.collection.JavaConverters._&lt;br/&gt;
+&lt;br/&gt;
+class DeleteTopicsRequestWithDeletionDisabledTest extends BaseRequestTest {&lt;br/&gt;
+&lt;br/&gt;
+  override def numBrokers: Int = 1&lt;br/&gt;
+&lt;br/&gt;
+  override def generateConfigs = &lt;/p&gt;
{
+    val props = TestUtils.createBrokerConfigs(numBrokers, zkConnect,
+      enableControlledShutdown = false, enableDeleteTopic = false,
+      interBrokerSecurityProtocol = Some(securityProtocol),
+      trustStoreFile = trustStoreFile, saslProperties = serverSaslProperties, logDirCount = logDirCount)
+    props.foreach(propertyOverrides)
+    props.map(KafkaConfig.fromProps)
+  }
&lt;p&gt;+&lt;br/&gt;
+  @Test&lt;br/&gt;
+  def testDeleteRecordsRequest() &lt;/p&gt;
{
+    val topic = &quot;topic-1&quot;
+    val request = new DeleteTopicsRequest.Builder(Set(topic).asJava, 1000).build()
+    val response = sendDeleteTopicsRequest(request)
+    assertEquals(Errors.TOPIC_DELETION_DISABLED, response.errors.get(topic))
+
+    val v2request = new DeleteTopicsRequest.Builder(Set(topic).asJava, 1000).build(2)
+    val v2response = sendDeleteTopicsRequest(v2request)
+    assertEquals(Errors.INVALID_REQUEST, v2response.errors.get(topic))
+  }
&lt;p&gt;+&lt;br/&gt;
+  private def sendDeleteTopicsRequest(request: DeleteTopicsRequest, socketServer: SocketServer = controllerSocketServer): DeleteTopicsResponse = &lt;/p&gt;
{
+    val response = connectAndSend(request, ApiKeys.DELETE_TOPICS, socketServer)
+    DeleteTopicsResponse.parse(response, request.version)
+  }
&lt;p&gt;+&lt;br/&gt;
+}&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13037196">KAFKA-4690</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3kj4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>