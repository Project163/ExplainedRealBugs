<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:15:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-7379] send.buffer.bytes should be allowed to set -1 in KafkaStreams</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-7379</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;send.buffer.bytes and receive.buffer.bytes are declared with atLeast(0) constraint in StreamsConfig, whereas -1 should be also allowed to set. This is like &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6891&quot; title=&quot;send.buffer.bytes should be allowed to set -1 in KafkaConnect&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6891&quot;&gt;&lt;del&gt;KAFKA-6891&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="13183259">KAFKA-7379</key>
            <summary>send.buffer.bytes should be allowed to set -1 in KafkaStreams</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Aleksei_Izmalkin">Aleksei Izmalkin</assignee>
                                    <reporter username="badai">Badai Aqrandista</reporter>
                        <labels>
                            <label>easyfix</label>
                            <label>newbie</label>
                    </labels>
                <created>Wed, 5 Sep 2018 22:53:28 +0000</created>
                <updated>Thu, 20 Sep 2018 20:25:15 +0000</updated>
                            <resolved>Thu, 20 Sep 2018 20:25:15 +0000</resolved>
                                    <version>0.10.2.2</version>
                    <version>0.11.0.3</version>
                    <version>1.0.2</version>
                    <version>1.1.1</version>
                    <version>2.0.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>streams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16610471" author="aleksei_izmalkin" created="Tue, 11 Sep 2018 11:40:55 +0000"  >&lt;p&gt;Hello! I will work on this issue.&lt;/p&gt;</comment>
                            <comment id="16611031" author="mjsax" created="Tue, 11 Sep 2018 18:04:50 +0000"  >&lt;p&gt;Thanks for picking this up &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Aleksei_Izmalkin&quot; class=&quot;user-hover&quot; rel=&quot;Aleksei_Izmalkin&quot;&gt;Aleksei_Izmalkin&lt;/a&gt;. I added you to the list of contributors and assigned the ticket to you. You can now also self-assign tickets.&lt;/p&gt;</comment>
                            <comment id="16612167" author="githubbot" created="Wed, 12 Sep 2018 13:58:22 +0000"  >&lt;p&gt;aai95 opened a new pull request #5643: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7379&quot; title=&quot;send.buffer.bytes should be allowed to set -1 in KafkaStreams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7379&quot;&gt;&lt;del&gt;KAFKA-7379&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;streams&amp;#93;&lt;/span&gt; send.buffer.bytes should be allowed to set -1 in KafkaStreams&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5643&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5643&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &lt;b&gt;atLeast(0) were replaced by atLeast(-1) in org.apache.kafka.streams.StreamsConfig&lt;/b&gt;&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16622564" author="githubbot" created="Thu, 20 Sep 2018 19:20:08 +0000"  >&lt;p&gt;guozhangwang closed pull request #5643: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7379&quot; title=&quot;send.buffer.bytes should be allowed to set -1 in KafkaStreams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7379&quot;&gt;&lt;del&gt;KAFKA-7379&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;streams&amp;#93;&lt;/span&gt; send.buffer.bytes should be allowed to set -1 in KafkaStreams&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5643&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5643&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/clients/src/main/java/org/apache/kafka/clients/CommonClientConfigs.java b/clients/src/main/java/org/apache/kafka/clients/CommonClientConfigs.java&lt;br/&gt;
index 7da7a60b4cb..a08e5b10b3b 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/clients/CommonClientConfigs.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/CommonClientConfigs.java&lt;br/&gt;
@@ -46,9 +46,11 @@&lt;/p&gt;

&lt;p&gt;     public static final String SEND_BUFFER_CONFIG = &quot;send.buffer.bytes&quot;;&lt;br/&gt;
     public static final String SEND_BUFFER_DOC = &quot;The size of the TCP send buffer (SO_SNDBUF) to use when sending data. If the value is -1, the OS default will be used.&quot;;&lt;br/&gt;
+    public static final int SEND_BUFFER_LOWER_BOUND = -1;&lt;/p&gt;

&lt;p&gt;     public static final String RECEIVE_BUFFER_CONFIG = &quot;receive.buffer.bytes&quot;;&lt;br/&gt;
     public static final String RECEIVE_BUFFER_DOC = &quot;The size of the TCP receive buffer (SO_RCVBUF) to use when reading data. If the value is -1, the OS default will be used.&quot;;&lt;br/&gt;
+    public static final int RECEIVE_BUFFER_LOWER_BOUND = -1;&lt;/p&gt;

&lt;p&gt;     public static final String CLIENT_ID_CONFIG = &quot;client.id&quot;;&lt;br/&gt;
     public static final String CLIENT_ID_DOC = &quot;An id string to pass to the server when making requests. The purpose of this is to be able to track the source of requests beyond just ip/port by allowing a logical application name to be included in server-side request logging.&quot;;&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/consumer/ConsumerConfig.java b/clients/src/main/java/org/apache/kafka/clients/consumer/ConsumerConfig.java&lt;br/&gt;
index 1fcabca134c..ddd6e06c713 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/clients/consumer/ConsumerConfig.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/consumer/ConsumerConfig.java&lt;br/&gt;
@@ -313,13 +313,13 @@&lt;br/&gt;
                                 .define(SEND_BUFFER_CONFIG,&lt;br/&gt;
                                         Type.INT,&lt;br/&gt;
                                         128 * 1024,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;atLeast(-1),&lt;br/&gt;
+                                        atLeast(CommonClientConfigs.SEND_BUFFER_LOWER_BOUND),&lt;br/&gt;
                                         Importance.MEDIUM,&lt;br/&gt;
                                         CommonClientConfigs.SEND_BUFFER_DOC)&lt;br/&gt;
                                 .define(RECEIVE_BUFFER_CONFIG,&lt;br/&gt;
                                         Type.INT,&lt;br/&gt;
                                         64 * 1024,&lt;/li&gt;
	&lt;li&gt;atLeast(-1),&lt;br/&gt;
+                                        atLeast(CommonClientConfigs.RECEIVE_BUFFER_LOWER_BOUND),&lt;br/&gt;
                                         Importance.MEDIUM,&lt;br/&gt;
                                         CommonClientConfigs.RECEIVE_BUFFER_DOC)&lt;br/&gt;
                                 .define(FETCH_MIN_BYTES_CONFIG,&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/producer/ProducerConfig.java b/clients/src/main/java/org/apache/kafka/clients/producer/ProducerConfig.java&lt;br/&gt;
index 0a55303c2d7..1a1bab5127b 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/main/java/org/apache/kafka/clients/producer/ProducerConfig.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/producer/ProducerConfig.java&lt;br/&gt;
@@ -251,8 +251,8 @@&lt;br/&gt;
                                 .define(LINGER_MS_CONFIG, Type.INT, 0, atLeast(0), Importance.MEDIUM, LINGER_MS_DOC)&lt;br/&gt;
                                 .define(DELIVERY_TIMEOUT_MS_CONFIG, Type.INT, 120 * 1000, atLeast(0), Importance.MEDIUM, DELIVERY_TIMEOUT_MS_DOC)&lt;br/&gt;
                                 .define(CLIENT_ID_CONFIG, Type.STRING, &quot;&quot;, Importance.MEDIUM, CommonClientConfigs.CLIENT_ID_DOC)&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;.define(SEND_BUFFER_CONFIG, Type.INT, 128 * 1024, atLeast(-1), Importance.MEDIUM, CommonClientConfigs.SEND_BUFFER_DOC)&lt;/li&gt;
	&lt;li&gt;.define(RECEIVE_BUFFER_CONFIG, Type.INT, 32 * 1024, atLeast(-1), Importance.MEDIUM, CommonClientConfigs.RECEIVE_BUFFER_DOC)&lt;br/&gt;
+                                .define(SEND_BUFFER_CONFIG, Type.INT, 128 * 1024, atLeast(CommonClientConfigs.SEND_BUFFER_LOWER_BOUND), Importance.MEDIUM, CommonClientConfigs.SEND_BUFFER_DOC)&lt;br/&gt;
+                                .define(RECEIVE_BUFFER_CONFIG, Type.INT, 32 * 1024, atLeast(CommonClientConfigs.RECEIVE_BUFFER_LOWER_BOUND), Importance.MEDIUM, CommonClientConfigs.RECEIVE_BUFFER_DOC)&lt;br/&gt;
                                 .define(MAX_REQUEST_SIZE_CONFIG,&lt;br/&gt;
                                         Type.INT,&lt;br/&gt;
                                         1 * 1024 * 1024,&lt;br/&gt;
diff --git a/streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java b/streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java&lt;br/&gt;
index 736e9cbd34f..20f2f6923ba 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java&lt;br/&gt;
+++ b/streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java&lt;br/&gt;
@@ -630,7 +630,7 @@&lt;br/&gt;
             .define(RECEIVE_BUFFER_CONFIG,&lt;br/&gt;
                     Type.INT,&lt;br/&gt;
                     32 * 1024,&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;atLeast(0),&lt;br/&gt;
+                    atLeast(CommonClientConfigs.RECEIVE_BUFFER_LOWER_BOUND),&lt;br/&gt;
                     Importance.LOW,&lt;br/&gt;
                     CommonClientConfigs.RECEIVE_BUFFER_DOC)&lt;br/&gt;
             .define(RECONNECT_BACKOFF_MS_CONFIG,&lt;br/&gt;
@@ -671,7 +671,7 @@&lt;br/&gt;
             .define(SEND_BUFFER_CONFIG,&lt;br/&gt;
                     Type.INT,&lt;br/&gt;
                     128 * 1024,&lt;/li&gt;
	&lt;li&gt;atLeast(0),&lt;br/&gt;
+                    atLeast(CommonClientConfigs.SEND_BUFFER_LOWER_BOUND),&lt;br/&gt;
                     Importance.LOW,&lt;br/&gt;
                     CommonClientConfigs.SEND_BUFFER_DOC)&lt;br/&gt;
             .define(STATE_CLEANUP_DELAY_MS_CONFIG,&lt;br/&gt;
diff --git a/streams/src/test/java/org/apache/kafka/streams/KafkaStreamsTest.java b/streams/src/test/java/org/apache/kafka/streams/KafkaStreamsTest.java&lt;br/&gt;
index dd5cff7da17..5e07703ddd5 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/streams/src/test/java/org/apache/kafka/streams/KafkaStreamsTest.java&lt;br/&gt;
+++ b/streams/src/test/java/org/apache/kafka/streams/KafkaStreamsTest.java&lt;br/&gt;
@@ -16,12 +16,15 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.kafka.streams;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+import org.apache.kafka.clients.CommonClientConfigs;&lt;br/&gt;
 import org.apache.kafka.clients.consumer.ConsumerConfig;&lt;br/&gt;
 import org.apache.kafka.clients.producer.MockProducer;&lt;br/&gt;
 import org.apache.kafka.common.Cluster;&lt;br/&gt;
+import org.apache.kafka.common.KafkaException;&lt;br/&gt;
 import org.apache.kafka.common.Node;&lt;br/&gt;
 import org.apache.kafka.common.config.ConfigException;&lt;br/&gt;
 import org.apache.kafka.common.metrics.Sensor;&lt;br/&gt;
+import org.apache.kafka.common.network.Selectable;&lt;br/&gt;
 import org.apache.kafka.common.serialization.Serdes;&lt;br/&gt;
 import org.apache.kafka.common.serialization.StringSerializer;&lt;br/&gt;
 import org.apache.kafka.common.utils.Utils;&lt;br/&gt;
@@ -95,6 +98,28 @@ public void cleanup() {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    @Test&lt;br/&gt;
+    public void testOsDefaultSocketBufferSizes() &lt;/p&gt;
{
+        props.put(CommonClientConfigs.SEND_BUFFER_CONFIG, Selectable.USE_DEFAULT_BUFFER_SIZE);
+        props.put(CommonClientConfigs.RECEIVE_BUFFER_CONFIG, Selectable.USE_DEFAULT_BUFFER_SIZE);
+        final KafkaStreams streams = new KafkaStreams(builder.build(), props);
+        streams.close();
+    }
&lt;p&gt;+&lt;br/&gt;
+    @Test(expected = KafkaException.class)&lt;br/&gt;
+    public void testInvalidSocketSendBufferSize() &lt;/p&gt;
{
+        props.put(CommonClientConfigs.SEND_BUFFER_CONFIG, -2);
+        final KafkaStreams streams = new KafkaStreams(builder.build(), props);
+        streams.close();
+    }
&lt;p&gt;+&lt;br/&gt;
+    @Test(expected = KafkaException.class)&lt;br/&gt;
+    public void testInvalidSocketReceiveBufferSize() &lt;/p&gt;
{
+        props.put(CommonClientConfigs.RECEIVE_BUFFER_CONFIG, -2);
+        final KafkaStreams streams = new KafkaStreams(builder.build(), props);
+        streams.close();
+    }
&lt;p&gt;+&lt;br/&gt;
     @Test&lt;br/&gt;
     public void testStateChanges() throws InterruptedException {&lt;br/&gt;
         final StateListenerStub stateListener = new StateListenerStub();&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 8 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3xs2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>