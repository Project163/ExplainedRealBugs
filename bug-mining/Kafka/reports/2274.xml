<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:18:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-8407] Connector client overrides broken on client configs with type &apos;Class&apos; or &apos;List&apos;</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-8407</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;When a connector request is submitted that overrides a&#160;client configuration that is meant to contain the name of a class (such as &lt;tt&gt;sasl.login.callback.handler.class&lt;/tt&gt;), a 500 response is generated and the following stack trace can be found in the logs for Connect:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2019-05-22 14:51:36,123&amp;#93;&lt;/span&gt; ERROR Uncaught exception in REST call to /connectors (org.apache.kafka.connect.runtime.rest.errors.ConnectExceptionMapper:61)&lt;/p&gt;

&lt;p&gt;java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Class&lt;/p&gt;

&lt;p&gt;at org.apache.kafka.common.config.ConfigDef.convertToString(ConfigDef.java:774)&lt;/p&gt;

&lt;p&gt;at org.apache.kafka.connect.runtime.AbstractHerder.convertConfigValue(AbstractHerder.java:491)&lt;/p&gt;

&lt;p&gt;at org.apache.kafka.connect.runtime.AbstractHerder.validateClientOverrides(AbstractHerder.java:426)&lt;/p&gt;

&lt;p&gt;at org.apache.kafka.connect.runtime.AbstractHerder.validateConnectorConfig(AbstractHerder.java:342)&lt;/p&gt;

&lt;p&gt;at org.apache.kafka.connect.runtime.distributed.DistributedHerder$6.call(DistributedHerder.java:565)&lt;/p&gt;

&lt;p&gt;at org.apache.kafka.connect.runtime.distributed.DistributedHerder$6.call(DistributedHerder.java:562)&lt;/p&gt;

&lt;p&gt;at org.apache.kafka.connect.runtime.distributed.DistributedHerder.tick(DistributedHerder.java:292)&lt;/p&gt;

&lt;p&gt;at org.apache.kafka.connect.runtime.distributed.DistributedHerder.run(DistributedHerder.java:241)&lt;/p&gt;

&lt;p&gt;at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)&lt;/p&gt;

&lt;p&gt;at java.util.concurrent.FutureTask.run(FutureTask.java:266)&lt;/p&gt;

&lt;p&gt;at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)&lt;/p&gt;

&lt;p&gt;at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)&lt;/p&gt;

&lt;p&gt;at java.lang.Thread.run(Thread.java:748)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This appears to be limited only to client configs that are meant to be classes or lists due to the fact that &lt;tt&gt;ConfigDef.convertToString(...)&lt;/tt&gt; assumes its first argument is an instance of &lt;tt&gt;Class&amp;lt;?&amp;gt;&lt;/tt&gt; when its second argument is &lt;tt&gt;ConfigDef.Type.CLASS&lt;/tt&gt; and then casts accordingly, and acts similarly for lists.&#160;If&#160;the second argument is anything else,&#160;&lt;tt&gt;toString()&lt;/tt&gt; is invoked on it without any casting, avoiding any problems.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The cause of this is due to the fact that the newly-introduced &lt;tt&gt;ConnectorClientConfigOverridePolicy&lt;/tt&gt; interface returns a list of &lt;tt&gt;ConfigValue&lt;/tt&gt; instances for its validation. The &lt;tt&gt;value()&lt;/tt&gt; for each of these can be any type, although with the default implementations available (&lt;tt&gt;All&lt;/tt&gt;, &lt;tt&gt;None&lt;/tt&gt;, &lt;tt&gt;Principal&lt;/tt&gt;) if one is returned at all it&apos;s just the same type of what was passed in for that particular config. In the case of the &lt;tt&gt;AbstractHerder.validateClientOverrides(...)&lt;/tt&gt; method, the raw strings for the client configs are used. However, the &lt;tt&gt;AbstractHerder.convertConfigValue(...)&lt;/tt&gt; is then called for those raw strings but with the &lt;tt&gt;ConfigDef.Type&lt;/tt&gt; of the config based on the relevant client &lt;tt&gt;ConfigDef&lt;/tt&gt; (i.e., &lt;tt&gt;ProducerConfig.configDef()&lt;/tt&gt;, &lt;tt&gt;ConsumerConfig.configDef()&lt;/tt&gt;, or &lt;tt&gt;AdminClientConfig.configDef()&lt;/tt&gt;). This in turn can and will result in &lt;tt&gt;ConfigDef.convertToString(someClassNameAsAString, ConfigDef.Type.CLASS)&lt;/tt&gt; being invoked.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Although this isn&apos;t technically a comprehensive fix, a quick option would be to invoke &lt;tt&gt;ConfigDef.parse(...)&lt;/tt&gt; using the relevant client &lt;tt&gt;ConfigDef&lt;/tt&gt; before passing overrides to the policy. Technically, this would still lead to problems if the policy decided to return just the name of a class for a config that of type class instead, so we may want to investigate other options as well.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13234939">KAFKA-8407</key>
            <summary>Connector client overrides broken on client configs with type &apos;Class&apos; or &apos;List&apos;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ChrisEgerton">Chris Egerton</assignee>
                                    <reporter username="ChrisEgerton">Chris Egerton</reporter>
                        <labels>
                            <label>connect</label>
                    </labels>
                <created>Wed, 22 May 2019 16:18:00 +0000</created>
                <updated>Thu, 23 May 2019 19:24:31 +0000</updated>
                            <resolved>Thu, 23 May 2019 19:24:31 +0000</resolved>
                                    <version>2.3.0</version>
                                    <fixVersion>2.3.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16846152" author="githubbot" created="Wed, 22 May 2019 18:56:05 +0000"  >&lt;p&gt;C0urante commented on pull request #6789: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-8407&quot; title=&quot;Connector client overrides broken on client configs with type &amp;#39;Class&amp;#39; or &amp;#39;List&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-8407&quot;&gt;&lt;del&gt;KAFKA-8407&lt;/del&gt;&lt;/a&gt;: Fix validation of class and list configs in connector client overrides&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/6789&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/6789&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &lt;span class=&quot;error&quot;&gt;&amp;#91;Jira&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-8407&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-8407&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;   Because of how config values are converted into strings in the `AbstractHerder.validateClientOverrides()` method after being validated by the client override policy, an exception is thrown if the value returned by the policy isn&apos;t already parsed as the type expected by the client `ConfigDef`. A more thorough writeup of how this happens is available in the linked Jira ticket.&lt;/p&gt;

&lt;p&gt;   The fix here involves parsing client override properties before passing them to the override policy.&lt;/p&gt;

&lt;p&gt;   A unit test is added to ensure that several different types of configs are validated properly by the herder.&lt;/p&gt;

&lt;p&gt;   This bug fix should be included in the recently-cut 2.3 branch.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16846991" author="githubbot" created="Thu, 23 May 2019 19:21:22 +0000"  >&lt;p&gt;rhauch commented on pull request #6789: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-8407&quot; title=&quot;Connector client overrides broken on client configs with type &amp;#39;Class&amp;#39; or &amp;#39;List&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-8407&quot;&gt;&lt;del&gt;KAFKA-8407&lt;/del&gt;&lt;/a&gt;: Fix validation of class and list configs in connector client overrides&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/6789&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/6789&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16846992" author="rhauch" created="Thu, 23 May 2019 19:24:31 +0000"  >&lt;p&gt;Merged onto the `trunk` and `2.3` branches.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02yrs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>rhauch</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>