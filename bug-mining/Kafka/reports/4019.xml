<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:41:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-18040] PlaintextProducerSendTest.testSendToPartitionWithFollowerShutdownShouldNotTimeout fails with CONSUMER group protocol</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-18040</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;I am getting an error&#160;(&lt;tt&gt;Consumed 0 records before timeout instead of the expected 100&lt;/tt&gt;) when running this test with the &lt;tt&gt;CONSUMER&lt;/tt&gt;&#160;group protocol.&lt;/p&gt;

&lt;p&gt;When I run the test using the&#160;&lt;tt&gt;CLASSIC&lt;/tt&gt;&#160;group protocol, I can run it 25 times in a row without an error. So it doesn&apos;t appear to be flaky (&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-16176&quot; title=&quot;Flaky test: testSendToPartitionWithFollowerShutdownShouldNotTimeout &#8211; kafka.api.PlaintextProducerSendTest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-16176&quot;&gt;&lt;del&gt;KAFKA-16176&lt;/del&gt;&lt;/a&gt;). When I run it with the&#160;&lt;tt&gt;CONSUMER&lt;/tt&gt;&#160;group protocol, it fails 16 out of the 25 runs&#160;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13599292">KAFKA-18040</key>
            <summary>PlaintextProducerSendTest.testSendToPartitionWithFollowerShutdownShouldNotTimeout fails with CONSUMER group protocol</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kirktrue">Kirk True</assignee>
                                    <reporter username="kirktrue">Kirk True</reporter>
                        <labels>
                            <label>integration-test</label>
                            <label>kip-848-client-support</label>
                    </labels>
                <created>Tue, 19 Nov 2024 18:54:34 +0000</created>
                <updated>Tue, 10 Dec 2024 07:02:23 +0000</updated>
                            <resolved>Tue, 10 Dec 2024 07:02:23 +0000</resolved>
                                    <version>3.9.0</version>
                                    <fixVersion>4.0.0</fixVersion>
                                    <component>clients</component>
                    <component>consumer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17903787" author="kirktrue" created="Sat, 7 Dec 2024 02:33:21 +0000"  >&lt;p&gt;In this test there are two brokers: a leader and a follower. The purpose of this test is to verify that when the follower fails, things continue to work. To that end, the test &lt;em&gt;intentionally&lt;/em&gt; shuts down the follower.&lt;/p&gt;

&lt;p&gt;For a little bit of background, when the consumer sends the &lt;tt&gt;FIND_COORDINATOR&lt;/tt&gt; request to the cluster, the response will include the ID of the broker selected as the group coordinator. Given that this test only has two brokers, the group coordinator is either the leader or the follower. The broker that is selected for each test appears to be &quot;random&quot; in that it&apos;s sometimes the leader and sometimes the follower.&lt;/p&gt;

&lt;p&gt;What I&apos;ve found so far in my investigation: when the test runs and the broker selected as the group coordinator is the &lt;em&gt;leader&lt;/em&gt;, the test passes. When the test runs and the broker selected is the &lt;em&gt;follower&lt;/em&gt;, the test fails.&lt;/p&gt;

&lt;p&gt;The consumer can detect when it is disconnected from the group coordinator, and it will then send another &lt;tt&gt;FIND_COORDINATOR&lt;/tt&gt; request to one of the remaining nodes in the cluster to ask for the new coordinator. In my investigation, the client is able to successfully connect to another broker (the leader), but the broker repeatedly responds with the &lt;tt&gt;COORDINATOR_NOT_AVAILABLE&lt;/tt&gt; error. I increased the timeout for the test from 15 seconds to 60 seconds, but this did not give the broker enough time to &quot;fail over&quot; to a new coordinator.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            48 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1sna8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>