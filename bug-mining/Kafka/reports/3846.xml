<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:39:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-17083] KRaft Upgrade Failures in SystemTests</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-17083</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;2 System tests for &quot;TestKRaftUpgrade are consistently failing on 3.8 in the system tests.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Module: kafkatest.tests.core.kraft_upgrade_test
Class:&#160; TestKRaftUpgrade
Method: test_isolated_mode_upgrade
Arguments:
{
&#160;&#160;&quot;from_kafka_version&quot;: &quot;dev&quot;,
&#160;&#160;&quot;metadata_quorum&quot;: &quot;ISOLATED_KRAFT&quot;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;and &lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Module: kafkatest.tests.core.kraft_upgrade_test
&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;:&#160; TestKRaftUpgrade
Method: test_combined_mode_upgrade
Arguments:
{
&#160;&#160;&lt;span class=&quot;code-quote&quot;&gt;&quot;from_kafka_version&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;dev&quot;&lt;/span&gt;,
&#160;&#160;&lt;span class=&quot;code-quote&quot;&gt;&quot;metadata_quorum&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;COMBINED_KRAFT&quot;&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Failure for Isolated is:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;RemoteCommandError({&apos;ssh_config&apos;: {&apos;host&apos;: &apos;worker15&apos;, &apos;hostname&apos;: &apos;10.140.39.207&apos;, &apos;user&apos;: &apos;ubuntu&apos;, &apos;port&apos;: 22, &apos;password&apos;: None, &apos;identityfile&apos;: &apos;/home/semaphore/kafka-overlay/semaphore-muckrake.pem&apos;}, &apos;hostname&apos;: &apos;worker15&apos;, &apos;ssh_hostname&apos;: &apos;10.140.39.207&apos;, &apos;user&apos;: &apos;ubuntu&apos;, &apos;externally_routable_ip&apos;: &apos;10.140.39.207&apos;, &apos;_logger&apos;: &amp;lt;Logger kafkatest.tests.core.kraft_upgrade_test.TestKRaftUpgrade.test_isolated_mode_upgrade.from_kafka_version=dev.metadata_quorum=ISOLATED_KRAFT-674 (DEBUG)&amp;gt;, &apos;os&apos;: &apos;linux&apos;, &apos;_ssh_client&apos;: &amp;lt;paramiko.client.SSHClient object at 0x7f07e2e800a0&amp;gt;, &apos;_sftp_client&apos;: &amp;lt;paramiko.sftp_client.SFTPClient object at 0x7f07e2f3d070&amp;gt;, &apos;_custom_ssh_exception_checks&apos;: None}, &apos;/opt/kafka-dev/bin/kafka-features.sh --bootstrap-server worker15:9092,worker16:9092,worker17:9092 upgrade --metadata 3.7&apos;, 1, b&apos;SLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/vagrant/tools/build/dependant-libs-2.13.14/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/vagrant/trogdor/build/dependant-libs-2.13.14/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]\n1 out of 1 operation(s) failed.\n&apos;)
Traceback (most recent call last):
  File &quot;/home/semaphore/kafka-overlay/kafka/venv/lib/python3.8/site-packages/ducktape/tests/runner_client.py&quot;, line 184, in _do_run
    data = self.run_test()
  File &quot;/home/semaphore/kafka-overlay/kafka/venv/lib/python3.8/site-packages/ducktape/tests/runner_client.py&quot;, line 262, in run_test
    return self.test_context.function(self.test)
  File &quot;/home/semaphore/kafka-overlay/kafka/venv/lib/python3.8/site-packages/ducktape/mark/_mark.py&quot;, line 433, in wrapper
    return functools.partial(f, *args, **kwargs)(*w_args, **w_kwargs)
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/tests/core/kraft_upgrade_test.py&quot;, line 121, in test_isolated_mode_upgrade
    self.run_upgrade(from_kafka_version)
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/tests/core/kraft_upgrade_test.py&quot;, line 105, in run_upgrade
    self.run_produce_consume_validate(core_test_action=lambda: self.perform_version_change(from_kafka_version))
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/tests/produce_consume_validate.py&quot;, line 105, in run_produce_consume_validate
    core_test_action(*args)
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/tests/core/kraft_upgrade_test.py&quot;, line 105, in &amp;lt;lambda&amp;gt;
    self.run_produce_consume_validate(core_test_action=lambda: self.perform_version_change(from_kafka_version))
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/tests/core/kraft_upgrade_test.py&quot;, line 75, in perform_version_change
    self.kafka.upgrade_metadata_version(LATEST_STABLE_METADATA_VERSION)
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/services/kafka/kafka.py&quot;, line 920, in upgrade_metadata_version
    self.run_features_command(&quot;upgrade&quot;, new_version)
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/services/kafka/kafka.py&quot;, line 930, in run_features_command
    self.nodes[0].account.ssh(cmd)
  File &quot;/home/semaphore/kafka-overlay/kafka/venv/lib/python3.8/site-packages/ducktape/cluster/remoteaccount.py&quot;, line 35, in wrapper
    return method(self, *args, **kwargs)
  File &quot;/home/semaphore/kafka-overlay/kafka/venv/lib/python3.8/site-packages/ducktape/cluster/remoteaccount.py&quot;, line 293, in ssh
    raise RemoteCommandError(self, cmd, exit_status, stderr.read())
ducktape.cluster.remoteaccount.RemoteCommandError: ubuntu@worker15: Command &apos;/opt/kafka-dev/bin/kafka-features.sh --bootstrap-server worker15:9092,worker16:9092,worker17:9092 upgrade --metadata 3.7&apos; returned non-zero exit status 1. Remote error message: b&apos;SLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/vagrant/tools/build/dependant-libs-2.13.14/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/vagrant/trogdor/build/dependant-libs-2.13.14/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]\n1 out of 1 operation(s) failed.\n&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Failure for combined is:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;RemoteCommandError({&apos;ssh_config&apos;: {&apos;host&apos;: &apos;worker29&apos;, &apos;hostname&apos;: &apos;10.140.50.210&apos;, &apos;user&apos;: &apos;ubuntu&apos;, &apos;port&apos;: 22, &apos;password&apos;: None, &apos;identityfile&apos;: &apos;/home/semaphore/kafka-overlay/semaphore-muckrake.pem&apos;}, &apos;hostname&apos;: &apos;worker29&apos;, &apos;ssh_hostname&apos;: &apos;10.140.50.210&apos;, &apos;user&apos;: &apos;ubuntu&apos;, &apos;externally_routable_ip&apos;: &apos;10.140.50.210&apos;, &apos;_logger&apos;: &amp;lt;Logger kafkatest.tests.core.kraft_upgrade_test.TestKRaftUpgrade.test_combined_mode_upgrade.from_kafka_version=dev.metadata_quorum=COMBINED_KRAFT-1789 (DEBUG)&amp;gt;, &apos;os&apos;: &apos;linux&apos;, &apos;_ssh_client&apos;: &amp;lt;paramiko.client.SSHClient object at 0x7f07e2a616a0&amp;gt;, &apos;_sftp_client&apos;: &amp;lt;paramiko.sftp_client.SFTPClient object at 0x7f07e25ac7c0&amp;gt;, &apos;_custom_ssh_exception_checks&apos;: None}, &apos;/opt/kafka-dev/bin/kafka-features.sh --bootstrap-server worker29:9092,worker4:9092,worker1:9092 upgrade --metadata 3.7&apos;, 1, b&apos;SLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/vagrant/tools/build/dependant-libs-2.13.14/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/vagrant/trogdor/build/dependant-libs-2.13.14/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]\n1 out of 1 operation(s) failed.\n&apos;)
Traceback (most recent call last):
  File &quot;/home/semaphore/kafka-overlay/kafka/venv/lib/python3.8/site-packages/ducktape/tests/runner_client.py&quot;, line 184, in _do_run
    data = self.run_test()
  File &quot;/home/semaphore/kafka-overlay/kafka/venv/lib/python3.8/site-packages/ducktape/tests/runner_client.py&quot;, line 262, in run_test
    return self.test_context.function(self.test)
  File &quot;/home/semaphore/kafka-overlay/kafka/venv/lib/python3.8/site-packages/ducktape/mark/_mark.py&quot;, line 433, in wrapper
    return functools.partial(f, *args, **kwargs)(*w_args, **w_kwargs)
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/tests/core/kraft_upgrade_test.py&quot;, line 115, in test_combined_mode_upgrade
    self.run_upgrade(from_kafka_version)
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/tests/core/kraft_upgrade_test.py&quot;, line 105, in run_upgrade
    self.run_produce_consume_validate(core_test_action=lambda: self.perform_version_change(from_kafka_version))
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/tests/produce_consume_validate.py&quot;, line 105, in run_produce_consume_validate
    core_test_action(*args)
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/tests/core/kraft_upgrade_test.py&quot;, line 105, in &amp;lt;lambda&amp;gt;
    self.run_produce_consume_validate(core_test_action=lambda: self.perform_version_change(from_kafka_version))
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/tests/core/kraft_upgrade_test.py&quot;, line 75, in perform_version_change
    self.kafka.upgrade_metadata_version(LATEST_STABLE_METADATA_VERSION)
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/services/kafka/kafka.py&quot;, line 920, in upgrade_metadata_version
    self.run_features_command(&quot;upgrade&quot;, new_version)
  File &quot;/home/semaphore/kafka-overlay/kafka/tests/kafkatest/services/kafka/kafka.py&quot;, line 930, in run_features_command
    self.nodes[0].account.ssh(cmd)
  File &quot;/home/semaphore/kafka-overlay/kafka/venv/lib/python3.8/site-packages/ducktape/cluster/remoteaccount.py&quot;, line 35, in wrapper
    return method(self, *args, **kwargs)
  File &quot;/home/semaphore/kafka-overlay/kafka/venv/lib/python3.8/site-packages/ducktape/cluster/remoteaccount.py&quot;, line 293, in ssh
    raise RemoteCommandError(self, cmd, exit_status, stderr.read())
ducktape.cluster.remoteaccount.RemoteCommandError: ubuntu@worker29: Command &apos;/opt/kafka-dev/bin/kafka-features.sh --bootstrap-server worker29:9092,worker4:9092,worker1:9092 upgrade --metadata 3.7&apos; returned non-zero exit status 1. Remote error message: b&apos;SLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/vagrant/tools/build/dependant-libs-2.13.14/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/vagrant/trogdor/build/dependant-libs-2.13.14/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]\n1 out of 1 operation(s) failed.\n&apos;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here is an instance of this failure&lt;/p&gt;</description>
                <environment></environment>
        <key id="13584805">KAFKA-17083</key>
            <summary>KRaft Upgrade Failures in SystemTests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="soarez">Igor Soarez</assignee>
                                    <reporter username="jlprat">Josep Prat</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Jul 2024 09:44:18 +0000</created>
                <updated>Mon, 8 Jul 2024 08:03:41 +0000</updated>
                            <resolved>Fri, 5 Jul 2024 21:49:50 +0000</resolved>
                                    <version>3.8.0</version>
                                    <fixVersion>3.8.0</fixVersion>
                                    <component>system tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17863353" author="soarez" created="Fri, 5 Jul 2024 14:50:24 +0000"  >&lt;p&gt;In both cases, this is the command that fails:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/opt/kafka-dev/bin/kafka-features.sh --bootstrap-server worker15:9092,worker16:9092,worker17:9092 upgrade --metadata 3.7 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ducktape shows this as the output from the command:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SLF4J: &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/vagrant/tools/build/dependant-libs-2.13.14/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/vagrant/trogdor/build/dependant-libs-2.13.14/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http:&lt;span class=&quot;code-comment&quot;&gt;//www.slf4j.org/codes.html#multiple_bindings &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; an explanation.
&lt;/span&gt;SLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]
1 out of 1 operation(s) failed. &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ignoring the SLF4J class conflict, there&apos;s just one line, and it seems to come from &lt;a href=&quot;https://github.com/apache/kafka/blob/3.8/tools/src/main/java/org/apache/kafka/tools/FeatureCommand.java#L318&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; &#8211; the `update` method in FeatureCommand. It is odd that we don&apos;t &lt;a href=&quot;https://github.com/apache/kafka/blob/3.8/tools/src/main/java/org/apache/kafka/tools/FeatureCommand.java#L308&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see the specific error&lt;/a&gt; in the output.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17863359" author="soarez" created="Fri, 5 Jul 2024 15:23:49 +0000"  >&lt;p&gt;Found the exception:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.kafka.common.errors.InvalidUpdateVersionException: Invalid update version 19 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; feature metadata.version. Can&apos;t downgrade the version of &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; feature without setting the upgrade type to either safe or unsafe downgrade. &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/apache/kafka/blob/3.8/metadata/src/main/java/org/apache/kafka/controller/FeatureControlManager.java#L228-L232&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Thrown in FeatureControlManager.updateFeature&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1q634:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>