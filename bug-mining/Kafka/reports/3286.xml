<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:30:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-12699] Streams no longer overrides the java default uncaught exception handler  </title>
                <link>https://issues.apache.org/jira/browse/KAFKA-12699</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;If a user used `Thread.setUncaughtExceptionHanlder()` to set the handler for all threads in the runtime streams would override that with its own handler. However since streams does not use the `Thread` handler anymore it will no longer do so. This can cause problems if the user does something like `System.exit(1)` in the handler.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If using the old handler in streams it will still work as it used to&lt;/p&gt;</description>
                <environment></environment>
        <key id="13373976">KAFKA-12699</key>
            <summary>Streams no longer overrides the java default uncaught exception handler  </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="wcarlson5">Walker Carlson</assignee>
                                    <reporter username="wcarlson5">Walker Carlson</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Apr 2021 01:31:01 +0000</created>
                <updated>Mon, 15 Aug 2022 21:08:19 +0000</updated>
                            <resolved>Tue, 19 Jul 2022 20:38:10 +0000</resolved>
                                    <version>2.8.0</version>
                                    <fixVersion>3.4.0</fixVersion>
                                    <component>streams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17326215" author="ableegoldman" created="Wed, 21 Apr 2021 02:57:07 +0000"  >&lt;p&gt;To be fair, I think claiming that this is a bug that Streams &quot;no longer overrides the java default handler&quot; is a bit harsh since (a) as you point out, this isn&apos;t a regression but just a different behavior in a new feature, and (b) it was never specified or implied that the new feature would do exactly the same thing as the old feature. I would actually argue that continuing to override the java default handler when the user has not actually supplied a Thread.UncaughtExceptionHandler to override it would be more unexpected.&lt;/p&gt;

&lt;p&gt;However, I do think it&apos;s a bit odd that we would end up invoking the default thread uncaught exception handler at all, since Streams will have already caught and invoked the user-defined handler at that point. The &quot;bug&quot; from my perspective is that we rethrow the exception up through run(), vs swallowing it once we reach the outer try in StreamThread#run.&lt;/p&gt;

&lt;p&gt;If we think that the user-defined default handler should not be invoked when using the new StreamsUncaughtExceptionHandler (and I think that assumption is not a given, although I don&apos;t feel strongly for or against), and should be overriden with a no-op handler, then why continue to throw the exception. And if we don&apos;t throw the exception, then why do we need to override with a no-op &amp;#8211; just my line of thinking, again I&apos;m not sure what a realistic user expected behavior is here. But setting a global exception handler and then just blindly calling System.exit in a multi-threaded app where you&apos;ve consciously implemented a handler that makes it clear threads can die and be replaced...seems like user error to me&lt;/p&gt;</comment>
                            <comment id="17326223" author="wcarlson5" created="Wed, 21 Apr 2021 03:09:36 +0000"  >&lt;p&gt;I would not say its a bug per-say but I just wanted anyone surprised by the behavior to know that it was known. Also I am not sure what else to categorize it as&lt;/p&gt;

&lt;p&gt;We might be able to handle the EOS corner cases by changing around where the catch block is. I am not sure a no-op would be better, but I do think that since the thread died exceptionally we should have the exception raised again to make sure it it handled properly. Also we should do our best to make sure the exception and thread are paired.&#160; I could see a case where the stream user and the owner of the runtime are not entirely equal so might have different requirements. I do agree calling System.exit might be a bit extreme but they could be tracking threads deaths and exceptions for some reason.&lt;/p&gt;</comment>
                            <comment id="17327006" author="ableegoldman" created="Wed, 21 Apr 2021 23:23:53 +0000"  >&lt;p&gt;&amp;gt; we should have the exception raised again to make sure it it handled properly.&lt;br/&gt;
I agree with the sentiment here, but if we disable the uncaught exception handler then there&apos;s no other handling that is/can be done. I&apos;m also not sure what EOS has to do with this, in both ALOS and EOS we want to (and have to) do a &quot;dirty close&quot;, otherwise we&apos;re committing bad data&lt;/p&gt;

&lt;p&gt;&amp;gt; stream user and the owner of the runtime are not entirely equal so might have different requirements&lt;br/&gt;
Good point&lt;/p&gt;</comment>
                            <comment id="17327007" author="ableegoldman" created="Wed, 21 Apr 2021 23:24:30 +0000"  >&lt;p&gt;Marking it down for 3.0 so we don&apos;t forget&lt;/p&gt;</comment>
                            <comment id="17377748" author="kkonstantine" created="Fri, 9 Jul 2021 03:20:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ableegoldman&quot; class=&quot;user-hover&quot; rel=&quot;ableegoldman&quot;&gt;ableegoldman&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wcarlson5&quot; class=&quot;user-hover&quot; rel=&quot;wcarlson5&quot;&gt;wcarlson5&lt;/a&gt;&#160;is this issue a blocker for 3.0. Can we still make it on time before code freeze? Please advise if we should postpone to the next version or wait for a PR&lt;/p&gt;</comment>
                            <comment id="17383586" author="kkonstantine" created="Mon, 19 Jul 2021 21:08:39 +0000"  >&lt;p&gt;Postponing to the subsequent release given that this issue is not a blocker and did not make it on time for the 3.0 code freeze.&#160;&lt;/p&gt;</comment>
                            <comment id="17443708" author="dajac" created="Mon, 15 Nov 2021 10:10:57 +0000"  >&lt;p&gt;Moving to the next release as we are past the 3.1 release code freeze.&lt;/p&gt;</comment>
                            <comment id="17517525" author="cadonna" created="Tue, 5 Apr 2022 15:50:07 +0000"  >&lt;p&gt;Removing from the 3.2.0 release since code freeze has passed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 32 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0q9mw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>