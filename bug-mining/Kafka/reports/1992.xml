<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:13:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-7193] ZooKeeper client times out with localhost due to random choice of ipv4/ipv6</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-7193</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;ZooKeeper client from version 3.4.13 doesn&apos;t handle connections to `localhost` very well. If ZooKeeper is started on 127.0.0.1 on a machine that has both ipv4 and ipv6 and a client is created using `localhost` rather than the IP address in the connection string, ZooKeeper client attempts to connect to ipv4 or ipv6 randomly with a fixed one second backoff if connection fails. With the default 6 second connection timeout in Kafka, this can result in client connection failures if ipv6 is chosen in consecutive address selections.&lt;/p&gt;

&lt;p&gt;Streams tests are failing intermittently as a result of this.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13173793">KAFKA-7193</key>
            <summary>ZooKeeper client times out with localhost due to random choice of ipv4/ipv6</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rsivaram">Rajini Sivaram</assignee>
                                    <reporter username="rsivaram">Rajini Sivaram</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Jul 2018 12:36:37 +0000</created>
                <updated>Mon, 23 Jul 2018 18:14:49 +0000</updated>
                            <resolved>Mon, 23 Jul 2018 18:14:48 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>zkclient</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16552795" author="githubbot" created="Mon, 23 Jul 2018 12:53:04 +0000"  >&lt;p&gt;rajinisivaram opened a new pull request #5414: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7193&quot; title=&quot;ZooKeeper client times out with localhost due to random choice of ipv4/ipv6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7193&quot;&gt;&lt;del&gt;KAFKA-7193&lt;/del&gt;&lt;/a&gt;: Use ZooKeeper IP address in streams tests to avoid timeouts&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5414&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5414&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   ZooKeeper client from version 3.4.13 doesn&apos;t handle connections to `localhost` very well. If ZooKeeper is started on 127.0.0.1 on a machine that has both ipv4 and ipv6 and a client is created using `localhost` rather than the IP address in the connection string, ZooKeeper client attempts to connect to ipv4 or ipv6 randomly with a fixed one second backoff if connection fails. Use `127.0.0.1` instead of `localhost` in streams tests to avoid intermittent test failures due to ZK client connection timeouts if ipv6 is chosen in consecutive address selections.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16552922" author="rsivaram" created="Mon, 23 Jul 2018 14:14:24 +0000"  >&lt;p&gt;Created &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-3100&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/ZOOKEEPER-3100&lt;/a&gt; to improve ZooKeeper client behaviour.&lt;/p&gt;</comment>
                            <comment id="16553191" author="githubbot" created="Mon, 23 Jul 2018 18:10:36 +0000"  >&lt;p&gt;rajinisivaram closed pull request #5414: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7193&quot; title=&quot;ZooKeeper client times out with localhost due to random choice of ipv4/ipv6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7193&quot;&gt;&lt;del&gt;KAFKA-7193&lt;/del&gt;&lt;/a&gt;: Use ZooKeeper IP address in streams tests to avoid timeouts&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5414&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5414&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/docs/upgrade.html b/docs/upgrade.html&lt;br/&gt;
index c9c0c90e003..ccfab95897f 100644&lt;br/&gt;
&amp;#8212; a/docs/upgrade.html&lt;br/&gt;
+++ b/docs/upgrade.html&lt;br/&gt;
@@ -147,6 +147,9 @@ &amp;lt;h5&amp;gt;&amp;lt;a id=&quot;upgrade_200_notable&quot; href=&quot;#upgrade_200_notable&quot;&amp;gt;Notable changes in 2&lt;br/&gt;
        error to the client.&amp;lt;/p&amp;gt;&amp;lt;/li&amp;gt;&lt;br/&gt;
     &amp;lt;li&amp;gt;Dynamic broker configuration options can be stored in ZooKeeper using kafka-configs.sh before brokers are started.&lt;br/&gt;
         This option can be used to avoid storing clear passwords in server.properties as all password configs may be stored encrypted in ZooKeeper.&amp;lt;/li&amp;gt;&lt;br/&gt;
+    &amp;lt;li&amp;gt;ZooKeeper hosts are now re-resolved if connection attempt fails. But if your ZooKeeper host names resolve&lt;br/&gt;
+    to multiple addresses and some of them are not reachable, then you may need to increase the connection timeout&lt;br/&gt;
+    &amp;lt;code&amp;gt;zookeeper.connection.timeout.ms&amp;lt;/code&amp;gt;.&amp;lt;/li&amp;gt;&lt;br/&gt;
 &amp;lt;/ul&amp;gt;&lt;/p&gt;

&lt;p&gt; &amp;lt;h5&amp;gt;&amp;lt;a id=&quot;upgrade_200_new_protocols&quot; href=&quot;#upgrade_200_new_protocols&quot;&amp;gt;New Protocol Versions&amp;lt;/a&amp;gt;&amp;lt;/h5&amp;gt;&lt;br/&gt;
diff --git a/streams/src/test/java/org/apache/kafka/streams/integration/utils/EmbeddedKafkaCluster.java b/streams/src/test/java/org/apache/kafka/streams/integration/utils/EmbeddedKafkaCluster.java&lt;br/&gt;
index daa1103789b..6239a681961 100644&lt;br/&gt;
&amp;#8212; a/streams/src/test/java/org/apache/kafka/streams/integration/utils/EmbeddedKafkaCluster.java&lt;br/&gt;
+++ b/streams/src/test/java/org/apache/kafka/streams/integration/utils/EmbeddedKafkaCluster.java&lt;br/&gt;
@@ -128,7 +128,7 @@ private void stop() {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;You can use this to e.g. tell Kafka brokers how to connect to this instance.&lt;br/&gt;
      */&lt;br/&gt;
     public String zKConnectString() 
{
-        return &quot;localhost:&quot; + zookeeper.port();
+        return &quot;127.0.0.1:&quot; + zookeeper.port();
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     /**&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3w673:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ijuma</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>