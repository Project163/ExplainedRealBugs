<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:54:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-3525] max.reserved.broker.id off-by-one error</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-3525</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;There&apos;s an off-by-one error in the config check / id generation for max.reserved.broker.id setting.  The auto-generation will generate max.reserved.broker.id as the initial broker id as it&apos;s currently written.&lt;/p&gt;

&lt;p&gt;Not sure what the consequences of this are if there&apos;s already a broker with that id as I didn&apos;t test that behavior.&lt;/p&gt;

&lt;p&gt;This can return 0 + max.reserved.broker.id:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/blob/8dbd688b1617968329087317fa6bde8b8df0392e/core/src/main/scala/kafka/utils/ZkUtils.scala#L213-L215&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/8dbd688b1617968329087317fa6bde8b8df0392e/core/src/main/scala/kafka/utils/ZkUtils.scala#L213-L215&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;However, this does a &amp;lt;= check, which is inclusive of max.reserved.broker.id:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/blob/8dbd688b1617968329087317fa6bde8b8df0392e/core/src/main/scala/kafka/server/KafkaConfig.scala#L984-L986&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/8dbd688b1617968329087317fa6bde8b8df0392e/core/src/main/scala/kafka/server/KafkaConfig.scala#L984-L986&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12956949">KAFKA-3525</key>
            <summary>max.reserved.broker.id off-by-one error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="omkreddy">Manikumar</assignee>
                                    <reporter username="abraithwaite">Alan Braithwaite</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Apr 2016 18:13:24 +0000</created>
                <updated>Wed, 11 May 2016 00:54:06 +0000</updated>
                            <resolved>Wed, 11 May 2016 00:54:06 +0000</resolved>
                                                    <fixVersion>0.10.1.0</fixVersion>
                                    <component>config</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15232671" author="omkreddy" created="Fri, 8 Apr 2016 18:30:28 +0000"  >&lt;p&gt;Actually getBrokerSequenceId will never return  (0 + max.reserved.broker.id).  &lt;/p&gt;

&lt;p&gt;During kafka startup we are creating all the required zk paths. So we should never get ZkNoNodeException in getSequenceId method. getSequenceId method should return &amp;gt;= 1.   getBrokerSequenceId should  return  &amp;gt;=  (1 + max.reserved.broker.id). So the reported scenario may not occur. &lt;/p&gt;


</comment>
                            <comment id="15232703" author="abraithwaite" created="Fri, 8 Apr 2016 18:48:21 +0000"  >&lt;p&gt;Please correct me if I&apos;m wrong, but this looks like a create or update function, meaning that it is possible to create and then return 0 (instead of the zk node version, but that would be 0 as well).&lt;/p&gt;</comment>
                            <comment id="15233241" author="omkreddy" created="Sat, 9 Apr 2016 00:54:18 +0000"  >&lt;p&gt;Yes, by looking this function alone it is possible.  But, the create part of the code will never get execute (we create all the required zk paths during kafka startup process).  May be we can just cleanup code.&lt;/p&gt;</comment>
                            <comment id="15242882" author="githubbot" created="Fri, 15 Apr 2016 12:23:48 +0000"  >&lt;p&gt;GitHub user omkreddy opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1224&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1224&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3525&quot; title=&quot;max.reserved.broker.id off-by-one error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3525&quot;&gt;&lt;del&gt;KAFKA-3525&lt;/del&gt;&lt;/a&gt;; getSequenceId should return 1  for first path creation&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/omkreddy/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/omkreddy/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3525&quot; title=&quot;max.reserved.broker.id off-by-one error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3525&quot;&gt;&lt;del&gt;KAFKA-3525&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1224.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1224.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1224&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 83143d07bc2bafdd4699b8144f55b9f44d528e0f&lt;br/&gt;
Author: Manikumar reddy O &amp;lt;manikumar.reddy@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-04-15T12:19:53Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3525&quot; title=&quot;max.reserved.broker.id off-by-one error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3525&quot;&gt;&lt;del&gt;KAFKA-3525&lt;/del&gt;&lt;/a&gt;; getSequenceId should return 1  for first path creation&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15271527" author="gwenshap" created="Wed, 4 May 2016 22:13:04 +0000"  >&lt;p&gt;This will wait for the next release. The max reserved is very high and user-configurable.&lt;/p&gt;</comment>
                            <comment id="15272234" author="fpj" created="Thu, 5 May 2016 12:00:41 +0000"  >&lt;p&gt;I&apos;m a bit confused by what this issue is trying to accomplish. The documentation for &lt;tt&gt;reserved.broker.max.id&lt;/tt&gt; says &quot;Max number that can be used for a broker.id&quot;, which in my interpretation says that the maximum id is the value of &lt;tt&gt;reserved.broker.max.id&lt;/tt&gt;, and not that there are &lt;tt&gt;reserved.broker.max.id&lt;/tt&gt; possible values reserved. Unless I&apos;m missing something, the code is correct without the change proposed in the PR, but please clarify if I&apos;m missing the point. &lt;/p&gt;</comment>
                            <comment id="15272275" author="omkreddy" created="Thu, 5 May 2016 13:03:43 +0000"  >&lt;p&gt;1. Assume reserved.broker.max.id =1000&lt;br/&gt;
2. Configure broker.id=1000 on  Broker1&lt;br/&gt;
3. Enable auto broker id generation on Broker2&lt;/p&gt;

&lt;p&gt;Now, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abraithwaite&quot; class=&quot;user-hover&quot; rel=&quot;abraithwaite&quot;&gt;abraithwaite&lt;/a&gt; concern is Broker2 may generate 1000 as broker.id. &lt;/p&gt;</comment>
                            <comment id="15272696" author="sriharsha" created="Thu, 5 May 2016 17:42:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;fpj&lt;/a&gt; reservered.broker.max.id is for backward compatibility. If a user is already setting broker.id than they can do so till reserved.broker.max.id and auto generation of broker.id (in absence of broker.id in server.properties) will start from reserved.broker.max.id &lt;/p&gt;</comment>
                            <comment id="15273215" author="fpj" created="Thu, 5 May 2016 22:14:36 +0000"  >&lt;p&gt;Got it, thank you both for the clarification. &lt;tt&gt;getSequenceId&lt;/tt&gt; needs to start from 1, otherwise we can get a collision.&lt;/p&gt;</comment>
                            <comment id="15279324" author="githubbot" created="Wed, 11 May 2016 00:53:19 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1224&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1224&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 27 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2vsrj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ijuma</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>