<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:29:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-13309] InMemorySessionStore#fetch/backwardFetch doesn&apos;t return in correct order</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-13309</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;We supported backward iterator for SessionStore in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9929&quot; title=&quot;Support reverse iterator on WindowStore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9929&quot;&gt;&lt;del&gt;KAFKA-9929&lt;/del&gt;&lt;/a&gt;. But we cannot return the correct order when fetch/backwardFetch the key range when there are multiple records in the same session window.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;

&lt;p&gt;We have a session window inactivity gap with 10 ms, and the records:&lt;/p&gt;

&lt;p&gt;key: &quot;A&quot;, value: &quot;AA&quot;, timestamp: 0 --&amp;gt; with SessionWindow(0, 0)&lt;/p&gt;

&lt;p&gt;key: &quot;B&quot;, value: &quot;BB&quot;, timestamp: 0 --&amp;gt; with SessionWindow(0, 0)&lt;/p&gt;

&lt;p&gt;key: &quot;C&quot;, value: &quot;CC&quot;, timestamp: 0 --&amp;gt; with SessionWindow(0, 0)&lt;/p&gt;

&lt;p&gt;key: &quot;D&quot; value: &quot;DD&quot;, timestamp: 100 --&amp;gt; with SessionWindow(100, 100)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;So, when fetch(&quot;A&quot; /&amp;#42;key from&amp;#42;/, &quot;D&quot; /&amp;#42;key to&amp;#42;/), we expected to have &lt;span class=&quot;error&quot;&gt;&amp;#91;A, B, C, D&amp;#93;&lt;/span&gt;, but we&apos;ll have&#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;C, B A, D &amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;And the reason is here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/streams/src/main/java/org/apache/kafka/streams/state/internals/InMemorySessionStore.java#L276-L295&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/streams/src/main/java/org/apache/kafka/streams/state/internals/InMemorySessionStore.java#L276-L295&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; KeyValueIterator&amp;lt;Windowed&amp;lt;Bytes&amp;gt;, &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[]&amp;gt; fetch(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Bytes keyFrom, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Bytes keyTo) {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; registerNewIterator(keyFrom, keyTo, &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.MAX_VALUE, endTimeMap.entrySet().iterator(), &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;// &amp;lt;-- the &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; param is &lt;span class=&quot;code-quote&quot;&gt;&quot;isFarwarded&quot;&lt;/span&gt;, which should be &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;fetch&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;, and &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;backwardFetch&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;
&lt;/span&gt;            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We pass &quot;false&quot; in the &quot;is forward&quot; parameter for `fetch` method, and &quot;true&quot; for &quot;backwardFetch&quot; method, which obviously is wrong.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13401860">KAFKA-13309</key>
            <summary>InMemorySessionStore#fetch/backwardFetch doesn&apos;t return in correct order</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="showuon">Luke Chen</assignee>
                                    <reporter username="showuon">Luke Chen</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Sep 2021 12:33:41 +0000</created>
                <updated>Thu, 30 Sep 2021 00:44:16 +0000</updated>
                            <resolved>Wed, 29 Sep 2021 00:35:12 +0000</resolved>
                                    <version>3.0.0</version>
                                    <fixVersion>3.0.1</fixVersion>
                    <fixVersion>3.1.0</fixVersion>
                                    <component>streams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 8 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0v1gw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>