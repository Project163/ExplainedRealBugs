<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:39:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-16984] New consumer should not complete leave operation until it gets a response</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-16984</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;When the new consumer attempts to leave a group, it sends a leave group request in a fire-and-forget mode, so, as soon as the request is generated, it will:&lt;/p&gt;

&lt;p&gt;1. transitions to UNSUBSCRIBED&lt;br/&gt;
2. complete the leaveGroup operation future&#160;&lt;/p&gt;

&lt;p&gt;This task focus on point 2, which has the undesired side-effect that whatever might have been waiting for the leave to do something else, will carry on, ex. consumer close, leading to responses to disconnected clients we&apos;ve seen when running stress tests)&lt;/p&gt;

&lt;p&gt;When leaving a group while closing a consumer, the member sends the leave request and moves on to next operation, which is closing the network thread, so we end up with disconnected client receiving responses from the server. We should send leave group heartbeat, and transition to UNSUBSCRIBE, but only complete the leave operation when we get a response for it, which is a much more accurate confirmation that the consumer left the group and can move on with other operations.&lt;/p&gt;

&lt;p&gt;Note that the legacy consumer does wait for a leave response before closing down the coordinator (see &lt;a href=&quot;https://github.com/apache/kafka/blob/25230b538841a5e7256b1b51725361dd59435901/clients/src/main/java/org/apache/kafka/clients/consumer/internals/AbstractCoordinator.java#L1135-L1140&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;AbstractCoordinator&lt;/a&gt;), we we are looking to have the same behaviour on the new consumer.&#160;&lt;/p&gt;

&lt;p&gt;Note that with this task we&apos;ll only focus on changing the behaviour for the leave operation completion (point 2 above) to tidy up the close flow. We are not changing the transition to UNSUBSCRIBED, as it would require further consideration if ever needed.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This is also a building block for future improvements around error handling for the leave request, which we don&apos;t have at the moment (related Jira linked)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13582914">KAFKA-16984</key>
            <summary>New consumer should not complete leave operation until it gets a response</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lianetm">Lianet Magrans</assignee>
                                    <reporter username="lianetm">Lianet Magrans</reporter>
                        <labels>
                            <label>kip-848</label>
                            <label>kip-848-client-support</label>
                    </labels>
                <created>Mon, 17 Jun 2024 15:36:02 +0000</created>
                <updated>Mon, 7 Oct 2024 04:13:08 +0000</updated>
                            <resolved>Fri, 19 Jul 2024 13:26:24 +0000</resolved>
                                    <version>3.8.0</version>
                                    <fixVersion>3.9.0</fixVersion>
                                    <component>clients</component>
                    <component>consumer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                    <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13560233">KAFKA-15954</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 21 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1pug8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>lucasbru</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>