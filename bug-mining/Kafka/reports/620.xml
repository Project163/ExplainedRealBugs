<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:42:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-1664] Kafka does not properly parse multiple ZK nodes with non-root chroot</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-1664</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;When using a non-root ZK directory for Kafka, if you specify multiple ZK servers, Kafka does not seem to properly parse the connection string. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;Error&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[root@hodor-001 bin]# ./kafka-console-consumer.sh --zookeeper baelish-001.edh.cloudera.com:2181/kafka,baelish-002.edh.cloudera.com:2181/kafka,baelish-003.edh.cloudera.com:2181/kafka --topic test-topic
[2014-10-01 15:31:04,629] ERROR Error processing message, stopping consumer:  (kafka.consumer.ConsoleConsumer$)
java.lang.IllegalArgumentException: Path length must be &amp;gt; 0
	at org.apache.zookeeper.common.PathUtils.validatePath(PathUtils.java:48)
	at org.apache.zookeeper.common.PathUtils.validatePath(PathUtils.java:35)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:766)
	at org.I0Itec.zkclient.ZkConnection.create(ZkConnection.java:87)
	at org.I0Itec.zkclient.ZkClient$1.call(ZkClient.java:308)
	at org.I0Itec.zkclient.ZkClient$1.call(ZkClient.java:304)
	at org.I0Itec.zkclient.ZkClient.retryUntilConnected(ZkClient.java:675)
	at org.I0Itec.zkclient.ZkClient.create(ZkClient.java:304)
	at org.I0Itec.zkclient.ZkClient.createPersistent(ZkClient.java:213)
	at org.I0Itec.zkclient.ZkClient.createPersistent(ZkClient.java:223)
	at org.I0Itec.zkclient.ZkClient.createPersistent(ZkClient.java:223)
	at org.I0Itec.zkclient.ZkClient.createPersistent(ZkClient.java:223)
	at kafka.utils.ZkUtils$.createParentPath(ZkUtils.scala:245)
	at kafka.utils.ZkUtils$.createEphemeralPath(ZkUtils.scala:256)
	at kafka.utils.ZkUtils$.createEphemeralPathExpectConflict(ZkUtils.scala:268)
	at kafka.utils.ZkUtils$.createEphemeralPathExpectConflictHandleZKBug(ZkUtils.scala:306)
	at kafka.consumer.ZookeeperConsumerConnector.kafka$consumer$ZookeeperConsumerConnector$$registerConsumerInZK(ZookeeperConsumerConnector.scala:226)
	at kafka.consumer.ZookeeperConsumerConnector$WildcardStreamsHandler.&amp;lt;init&amp;gt;(ZookeeperConsumerConnector.scala:755)
	at kafka.consumer.ZookeeperConsumerConnector.createMessageStreamsByFilter(ZookeeperConsumerConnector.scala:145)
	at kafka.consumer.ConsoleConsumer$.main(ConsoleConsumer.scala:196)
	at kafka.consumer.ConsoleConsumer.main(ConsoleConsumer.scala)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;&lt;b&gt;Working&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[root@hodor-001 bin]# ./kafka-console-consumer.sh --zookeeper baelish-001.edh.cloudera.com:2181/kafka --topic test-topic
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12745375">KAFKA-1664</key>
            <summary>Kafka does not properly parse multiple ZK nodes with non-root chroot</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="singhashish">Ashish Singh</assignee>
                                    <reporter username="rickysaltzer">Ricky Saltzer</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Wed, 1 Oct 2014 22:37:43 +0000</created>
                <updated>Mon, 2 Mar 2015 05:16:07 +0000</updated>
                            <resolved>Fri, 27 Feb 2015 23:10:28 +0000</resolved>
                                                                    <component>clients</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14155704" author="gwenshap" created="Wed, 1 Oct 2014 22:42:58 +0000"  >&lt;p&gt;This happens with other high-level consumer clients. So its not just the ConsoleConsumer. &lt;/p&gt;

&lt;p&gt;Topic admin tools don&apos;t throw an exception, but don&apos;t show topics either.&lt;/p&gt;

&lt;p&gt;I&apos;m working on a patch.&lt;/p&gt;</comment>
                            <comment id="14155908" author="junrao" created="Thu, 2 Oct 2014 00:51:47 +0000"  >&lt;p&gt;Actually, namespace should only be included once in a ZK url, not after every host:port. So the correct ZK URL should be&lt;/p&gt;

&lt;p&gt; baelish-001.edh.cloudera.com:2181,baelish-002.edh.cloudera.com:2181,baelish-003.edh.cloudera.com:2181/kafka&lt;/p&gt;</comment>
                            <comment id="14155951" author="rickysaltzer" created="Thu, 2 Oct 2014 01:19:40 +0000"  >&lt;p&gt;Yes I&apos;ve tried that as well, same problem.&lt;/p&gt;
</comment>
                            <comment id="14156022" author="junrao" created="Thu, 2 Oct 2014 02:53:26 +0000"  >&lt;p&gt;So, it seems that namespace doesn&apos;t exist. For tools, auto-creating those namespaces may not be ideal. Perhaps we just need to provide a more meaningful error.&lt;/p&gt;</comment>
                            <comment id="14156057" author="nehanarkhede" created="Thu, 2 Oct 2014 04:06:03 +0000"  >&lt;p&gt;+1 on providing a more meaningful error.&lt;/p&gt;</comment>
                            <comment id="14156889" author="rickysaltzer" created="Thu, 2 Oct 2014 18:01:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=junrao&quot; class=&quot;user-hover&quot; rel=&quot;junrao&quot;&gt;junrao&lt;/a&gt; my apologies, thanks for the recommendation, that &lt;b&gt;did&lt;/b&gt; actually work. +1 for a more meaningful error. &lt;/p&gt;</comment>
                            <comment id="14157228" author="gwenshap" created="Thu, 2 Oct 2014 21:37:18 +0000"  >&lt;p&gt;For a more meaningful error, I&apos;m thinking: Catch the exception thrown by zkClient at createParentPath, log an error like &quot;Invalid ZooKeeper path, please check syntax and that path exists&quot; and throw our own ConfigException&lt;/p&gt;

&lt;p&gt;Since the original error is thrown by zkClient, we&apos;ll need to handle that in multiple places where we call it. Does it make sense to patch zkClient instead?&lt;/p&gt;
</comment>
                            <comment id="14159755" author="junrao" created="Sun, 5 Oct 2014 23:57:38 +0000"  >&lt;p&gt;Perhaps we can add a wrapper in ZkUtils for creating a path in ZK. The wrapper will first check the existence of namespace. If it doesn&apos;t, throw a meaningful exception.&lt;/p&gt;</comment>
                            <comment id="14213707" author="singhashish" created="Sat, 15 Nov 2014 18:13:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gwenshap&quot; class=&quot;user-hover&quot; rel=&quot;gwenshap&quot;&gt;gwenshap&lt;/a&gt; I am thinking of taking a look at this. If it is OK with you, kindly assign the JIRA to me.&lt;/p&gt;</comment>
                            <comment id="14213899" author="gwenshap" created="Sun, 16 Nov 2014 10:05:12 +0000"  >&lt;p&gt;Here you go, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=singhashish&quot; class=&quot;user-hover&quot; rel=&quot;singhashish&quot;&gt;singhashish&lt;/a&gt;. Have fun.&lt;/p&gt;</comment>
                            <comment id="14214037" author="singhashish" created="Sun, 16 Nov 2014 19:52:46 +0000"  >&lt;p&gt;RB: &lt;a href=&quot;https://reviews.apache.org/r/28108/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/28108/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14243024" author="singhashish" created="Thu, 11 Dec 2014 19:48:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nehanarkhede&quot; class=&quot;user-hover&quot; rel=&quot;nehanarkhede&quot;&gt;nehanarkhede&lt;/a&gt; Addressed your review comment. Kindly take a look.&lt;/p&gt;</comment>
                            <comment id="14260500" author="singhashish" created="Mon, 29 Dec 2014 22:38:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nehanarkhede&quot; class=&quot;user-hover&quot; rel=&quot;nehanarkhede&quot;&gt;nehanarkhede&lt;/a&gt; still waiting for your review.&lt;/p&gt;</comment>
                            <comment id="14280988" author="singhashish" created="Fri, 16 Jan 2015 23:24:52 +0000"  >&lt;p&gt;Testing file &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12686456/KAFKA-1664.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;KAFKA-1664.2.patch&lt;/a&gt; against branch trunk took 0:09:06.543433.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall:&lt;/font&gt; -1 due to 2 errors&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; Some unit tests failed (report)&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; Failed unit test: {{kafka.consumer.ZookeeperConsumerConnectorTest &amp;gt; testConsumerRebalanceListener FAILED&lt;br/&gt;
}}&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; Gradle bootstrap was successful&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; Clean was successful&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; Patch applied correctly&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; Patch add/modify test case&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; Gradle bootstrap was successful&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; Patch compiled&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14297291" author="singhashish" created="Thu, 29 Jan 2015 18:27:04 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/28108/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/28108/&lt;/a&gt;&lt;br/&gt;
 against branch trunk&lt;/p&gt;</comment>
                            <comment id="14334266" author="singhashish" created="Tue, 24 Feb 2015 02:16:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nehanarkhede&quot; class=&quot;user-hover&quot; rel=&quot;nehanarkhede&quot;&gt;nehanarkhede&lt;/a&gt; could you review this when you get a chance.&lt;/p&gt;</comment>
                            <comment id="14335053" author="nehanarkhede" created="Tue, 24 Feb 2015 16:35:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashishujjain&quot; class=&quot;user-hover&quot; rel=&quot;ashishujjain&quot;&gt;ashishujjain&lt;/a&gt; Thanks for the reminder. The patch looks good, the only comment I have is that it introduces a bunch of build warnings-&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;/Users/nnarkhed/Projects/kafka/core/src/test/scala/unit/kafka/zk/ZKPathTest.scala:45: This catches all Throwables. If &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; is really intended, use `&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; exception : Throwable` to clear &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; warning.
      &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; exception =&amp;gt; fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;Should have thrown ConfigException&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14335248" author="singhashish" created="Tue, 24 Feb 2015 19:02:32 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/28108/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/28108/&lt;/a&gt;&lt;br/&gt;
 against branch trunk&lt;/p&gt;</comment>
                            <comment id="14335255" author="singhashish" created="Tue, 24 Feb 2015 19:04:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nehanarkhede&quot; class=&quot;user-hover&quot; rel=&quot;nehanarkhede&quot;&gt;nehanarkhede&lt;/a&gt; addressed the warnings issue. Thanks for the review.&lt;/p&gt;</comment>
                            <comment id="14337379" author="jcreasy" created="Wed, 25 Feb 2015 22:46:38 +0000"  >&lt;p&gt;I think this is because it expects the string to be:&lt;/p&gt;

&lt;p&gt;baelish-001.edh.cloudera.com:2181,baelish-002.edh.cloudera.com:2181,baelis&lt;br/&gt;
h-003.edh.cloudera.com:2181/kafka&lt;/p&gt;


&lt;p&gt;I don&#185;t think you would ever want to have a different root per host.&lt;/p&gt;</comment>
                            <comment id="14337382" author="jcreasy" created="Wed, 25 Feb 2015 22:47:13 +0000"  >&lt;p&gt;nevermind, missed Jun&apos;s response farther up. Carry on! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14340995" author="nehanarkhede" created="Fri, 27 Feb 2015 23:10:28 +0000"  >&lt;p&gt;Thanks for the patch. Pushed to trunk.&lt;/p&gt;</comment>
                            <comment id="14341660" author="junrao" created="Sat, 28 Feb 2015 17:12:05 +0000"  >&lt;p&gt;Thanks for the patch. The patch makes every create operation in ZK a bit more expensive since it has to do an extra exists check. This may slow down operations like creating a new topic, especially when there are lots of partitions.&lt;/p&gt;

&lt;p&gt;The checking of the chroot really just needs to be done once at the beginning. I am thinking that one way to improve this is to make ZkPath a singleton. It will do the chroot check on first create and remembers the result. Subsequent create calls will just reuse the result.&lt;/p&gt;</comment>
                            <comment id="14342763" author="singhashish" created="Mon, 2 Mar 2015 05:16:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=junrao&quot; class=&quot;user-hover&quot; rel=&quot;junrao&quot;&gt;junrao&lt;/a&gt; thanks for bringing up this point. Created &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-1994&quot; title=&quot;Evaluate performance effect of chroot check on Topic creation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-1994&quot;&gt;&lt;del&gt;KAFKA-1994&lt;/del&gt;&lt;/a&gt; to track this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12683216" name="KAFKA-1664.1.patch" size="4242" author="singhashish" created="Sun, 23 Nov 2014 05:45:01 +0000"/>
                            <attachment id="12686456" name="KAFKA-1664.2.patch" size="10645" author="singhashish" created="Thu, 11 Dec 2014 06:18:00 +0000"/>
                            <attachment id="12681803" name="KAFKA-1664.patch" size="1408" author="singhashish" created="Sun, 16 Nov 2014 19:52:46 +0000"/>
                            <attachment id="12695323" name="KAFKA-1664_2015-01-29_10:26:20.patch" size="10914" author="singhashish" created="Thu, 29 Jan 2015 18:27:04 +0000"/>
                            <attachment id="12700546" name="KAFKA-1664_2015-02-24_11:02:23.patch" size="11002" author="singhashish" created="Tue, 24 Feb 2015 19:02:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 38 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20phb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>nehanarkhede</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>