<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:22:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-9712] Reflections library 0.9.12 introduced in 2.5 causes regression scanning for plugins on plugin_path</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-9712</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Reflections v0.9.12 was introduced in 2.5 branch to remove Guava dependency - &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3061&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-3061&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This version, however, contains a &lt;a href=&quot;https://github.com/ronmamo/reflections/issues/273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;bug&lt;/a&gt; that will cause regression when scanning for plugins if the `plugins_path` specified does not contain valid plugins. The case where we were able to repro this, the `plugins_path` was misconfigured to point to `~/.ssh` which contained unrelated files but no plugins. Further testing is needed to figure out if it will repro for other cases such as empty directory, combination of valid and invalid plugins in directory, just some types of plugins and not others in directory, etc.&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[2020-03-12 18:07:01,045] INFO Loading plugin from: /home/ducker/.ssh (org.apache.kafka.connect.runtime.isolation.DelegatingClassLoader)
[2020-03-12 18:07:01,047] DEBUG Loading plugin urls: [] (org.apache.kafka.connect.runtime.isolation.DelegatingClassLoader)
[2020-03-12 18:07:01,062] ERROR Stopping due to error (org.apache.kafka.connect.cli.ConnectDistributed)
org.reflections.ReflectionsException: Scanner SubTypesScanner was not configured
        at org.reflections.Store.get(Store.java:39)
        at org.reflections.Store.get(Store.java:61)
        at org.reflections.Store.get(Store.java:46)
        at org.reflections.Store.getAll(Store.java:93)
        at org.reflections.Reflections.getSubTypesOf(Reflections.java:404)
        at org.apache.kafka.connect.runtime.isolation.DelegatingClassLoader.getPluginDesc(DelegatingClassLoader.java:342)
        at org.apache.kafka.connect.runtime.isolation.DelegatingClassLoader.scanPluginPath(DelegatingClassLoader.java:327)
        at org.apache.kafka.connect.runtime.isolation.DelegatingClassLoader.scanUrlsAndAddPlugins(DelegatingClassLoader.java:260)
        at org.apache.kafka.connect.runtime.isolation.DelegatingClassLoader.registerPlugin(DelegatingClassLoader.java:252)
        at org.apache.kafka.connect.runtime.isolation.DelegatingClassLoader.initPluginLoader(DelegatingClassLoader.java:221)
        at org.apache.kafka.connect.runtime.isolation.DelegatingClassLoader.initLoaders(DelegatingClassLoader.java:198)
        at org.apache.kafka.connect.runtime.isolation.Plugins.&amp;lt;init&amp;gt;(Plugins.java:60)
        at org.apache.kafka.connect.cli.ConnectDistributed.startConnect(ConnectDistributed.java:91)
        at org.apache.kafka.connect.cli.ConnectDistributed.main(ConnectDistributed.java:78)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13291395">KAFKA-9712</key>
            <summary>Reflections library 0.9.12 introduced in 2.5 causes regression scanning for plugins on plugin_path</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nigel.liang">Nigel Liang</assignee>
                                    <reporter username="nigel.liang">Nigel Liang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Mar 2020 17:57:31 +0000</created>
                <updated>Sat, 6 Jun 2020 01:08:06 +0000</updated>
                            <resolved>Mon, 16 Mar 2020 22:09:29 +0000</resolved>
                                                    <fixVersion>2.5.0</fixVersion>
                    <fixVersion>2.6.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17058191" author="nigel.liang" created="Thu, 12 Mar 2020 19:15:59 +0000"  >&lt;p&gt;I have concluded more testing. My conclusion is that any file on the plugin path that is either:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;not a jar, or&lt;/li&gt;
	&lt;li&gt;a jar containing no classes&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;will trigger the bug. Consequence is that connect worker will not be able to start up.&lt;br/&gt;
 &#160;&lt;br/&gt;
 Possible workarounds include but are not limited to:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Revert back to&#160;v0.9.11&lt;/li&gt;
	&lt;li&gt;Switch to reflections8 fork similar to what is done here -&#160;&lt;a href=&quot;https://github.com/JanusGraph/janusgraph/pull/2029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/JanusGraph/janusgraph/pull/2029&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Try to catch and handle the exception by skipping the problematic file and continuing the scan&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17058235" author="nigel.liang" created="Thu, 12 Mar 2020 20:36:36 +0000"  >&lt;p&gt;If we were to revert back to v0.9.11, we would bring back dependency on guava. As noted in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3061&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-3061&lt;/a&gt;, this is undesirable since having it in framework leads to potential version conflicts downstream for users of framework that want to use their own Guava. OTOH, this would be the path of lowest risk since no new code would be introduced.&lt;/p&gt;

&lt;p&gt;reflections8 claims that they are obsoleted by v0.9.12 of reflections -&#160;&lt;a href=&quot;https://github.com/aschoerk/reflections8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/aschoerk/reflections8&lt;/a&gt;&#160;. This library will likely not be maintained in the future, while reflections library will likely be fixed in a future 0.9.13 release. There is already a PR out for the fix -&#160;&lt;a href=&quot;https://github.com/ronmamo/reflections/pull/278&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ronmamo/reflections/pull/278&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The try...catch workaround seems like it will be most promising. The proposal is to catch the exception &lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/isolation/DelegatingClassLoader.java#L342&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; and return empty result on exception. The `Reflections` object we build and use here scans over either a single URL at a time expecting to find an Uber jar or an array of URLs representing contents of the plugin directory. This bug is triggered only when the `Reflections` object could find no classes in the URLs provided. In which case, returning empty results is indeed the correct response. Empty result is also essentially the response that you would get from previous versions of reflections that do not contain the bug. So, making the change should be pretty safe in the sense that existing users upgrading to `2.5` would see the same behavior as before (non-jars or jars containing no classes silently skipped). Exception handling comes with a little bit of a performance penalty, but this is in the worker startup path only and it will be only for exceptional situations. The happy path will be unchanged.&lt;/p&gt;</comment>
                            <comment id="17058261" author="githubbot" created="Thu, 12 Mar 2020 21:49:03 +0000"  >&lt;p&gt;ncliang commented on pull request #8289: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9712&quot; title=&quot;Reflections library 0.9.12 introduced in 2.5 causes regression scanning for plugins on plugin_path&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9712&quot;&gt;&lt;del&gt;KAFKA-9712&lt;/del&gt;&lt;/a&gt;: Catch and handle exception thrown by reflections scanner&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/8289&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/8289&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   This commit works around a bug in v0.9.12 in upstream `reflections` library by catching and handling the exception thrown.&lt;/p&gt;

&lt;p&gt;   New unittests were introduced to test the behavior.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="17058296" author="kkonstantine" created="Thu, 12 Mar 2020 23:41:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nigel.liang&quot; class=&quot;user-hover&quot; rel=&quot;nigel.liang&quot;&gt;nigel.liang&lt;/a&gt;&#160;I agree with the direction of the proposed fix, because this seems to correspond to the behavior that was exhibited until recently, according to which any exception due to a class mismatch or a match that was not found during class scanning would result in a &lt;tt&gt;WARN&lt;/tt&gt; log message from the &lt;tt&gt;reflections&lt;/tt&gt; library, that was ignored by Kafka Connect. For example, in this logging template:&#160;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/config/connect-log4j.properties&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/config/connect-log4j.properties&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17060484" author="githubbot" created="Mon, 16 Mar 2020 21:43:16 +0000"  >&lt;p&gt;kkonstantine commented on pull request #8289: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9712&quot; title=&quot;Reflections library 0.9.12 introduced in 2.5 causes regression scanning for plugins on plugin_path&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9712&quot;&gt;&lt;del&gt;KAFKA-9712&lt;/del&gt;&lt;/a&gt;: Catch and handle exception thrown by reflections scanner&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/8289&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/8289&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="17060497" author="kkonstantine" created="Mon, 16 Mar 2020 22:09:29 +0000"  >&lt;p&gt;This fix has now been merged to &lt;tt&gt;trunk&lt;/tt&gt; and backported to &lt;tt&gt;2.5&lt;/tt&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13281590">KAFKA-9476</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 35 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ch54:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>