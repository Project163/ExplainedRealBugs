<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:25:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-10133] Cannot compress messages in destination cluster with MM2</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-10133</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;When configuring mirrormaker2 using kafka connect, it is not possible to configure things such that messages are compressed in the destination cluster. Dump Log shows that batching is occuring, but no compression. If this is possible, then this is a documentation bug, because I can find no documentation on how to do this.&lt;/p&gt;

&lt;p&gt;baseOffset: 4208 lastOffset: 4492 count: 285 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 2 isTransactional: false isControl: false position: 239371 CreateTime: 1591745894859 size: 16362 magic: 2 compresscodec: NONE crc: 1811507259 isvalid: true&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>kafka 2.5.0 deployed via the strimzi operator 0.18</environment>
        <key id="13310503">KAFKA-10133</key>
            <summary>Cannot compress messages in destination cluster with MM2</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yangguo1220">Ning Zhang</assignee>
                                    <reporter username="steveatbat">Steve Jacobs</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Jun 2020 23:56:44 +0000</created>
                <updated>Wed, 3 Jan 2024 23:01:21 +0000</updated>
                            <resolved>Fri, 4 Sep 2020 17:26:34 +0000</resolved>
                                    <version>2.4.0</version>
                    <version>2.4.1</version>
                    <version>2.5.0</version>
                                    <fixVersion>2.7.0</fixVersion>
                                    <component>mirrormaker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17132712" author="steveatbat" created="Wed, 10 Jun 2020 20:57:44 +0000"  >&lt;p&gt;Got this working finally. compression.type has to be set on the cluster config (kafka connect worker config). Not on the kafkaconnect cluster as a producer override (which seems like it should work from the documentation but doesn&apos;t). Overall this was extremely confusing and improved documentation would save a ton of hassle.&lt;/p&gt;</comment>
                            <comment id="17182976" author="yangguo1220" created="Mon, 24 Aug 2020 06:17:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steveatbat&quot; class=&quot;user-hover&quot; rel=&quot;steveatbat&quot;&gt;steveatbat&lt;/a&gt; My experiment seems to show different conclusion.&lt;/p&gt;

&lt;p&gt;In order to preserve the compression type from upstream producer, in MM2 config file, I override the producer config, such as,&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;target_cluster_alias&amp;gt;.producer.compression.type = gzip
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then run this command on the target cluster to verify:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/opt/kafka/bin/kafka-run-&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;sh kafka.tools.DumpLogSegments --deep-iteration --files /kafka/kafka-logs-kafka2-0/primary.test-0/00000000000000000000.log
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Starting offset: 0
offset: 0 position: 0 CreateTime: 1598249096409 isvalid: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; keysize: 4 valuesize: 6 magic: 2 compresscodec: GZIP producerId: -1 producerEpoch: -1 sequence: -1 isTransactional: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; headerKeys: []
offset: 1 position: 0 CreateTime: 1598249106432 isvalid: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; keysize: 4 valuesize: 6 magic: 2 compresscodec: GZIP producerId: -1 producerEpoch: -1 sequence: -1 isTransactional: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; headerKeys: []
offset: 2 position: 0 CreateTime: 1598249158144 isvalid: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; keysize: 4 valuesize: 6 magic: 2 compresscodec: GZIP producerId: -1 producerEpoch: -1 sequence: -1 isTransactional: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; headerKeys: []
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The output shows that the messages replicated to the target cluster are compressed with GZIP.&lt;/p&gt;

&lt;p&gt;So I am wondering what exact config you use at kafka connect worker level to make compression work&lt;/p&gt;
</comment>
                            <comment id="17183300" author="steveatbat" created="Mon, 24 Aug 2020 13:52:17 +0000"  >&lt;p&gt;That is how I was confirming compression as well. The example you gave is the same as what I said above. It sets the property on the kafka connect worker.&#160; Not in the sourceconnector/checkpointconnector etc.&#160;&lt;/p&gt;</comment>
                            <comment id="17183401" author="yangguo1220" created="Mon, 24 Aug 2020 16:03:13 +0000"  >&lt;p&gt;Great. Then I will probably make a pr to clarify some use cases like this. Thanks&lt;/p&gt;</comment>
                            <comment id="17183445" author="steveatbat" created="Mon, 24 Aug 2020 16:51:02 +0000"  >&lt;p&gt;That would be incredibly helpful. Just an example of where this setting goes would save a lot of trouble!&lt;/p&gt;</comment>
                            <comment id="17183453" author="yangguo1220" created="Mon, 24 Aug 2020 16:58:11 +0000"  >&lt;p&gt;There is no bug in the code, but need some efforts on doc to clarify on where some frequently used configs should be set.&lt;/p&gt;</comment>
                            <comment id="17183607" author="yangguo1220" created="Mon, 24 Aug 2020 21:35:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/kafka/pull/9215&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/9215&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0fov4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>