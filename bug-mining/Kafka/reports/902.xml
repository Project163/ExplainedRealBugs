<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:51:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-3055] JsonConverter mangles schema during serialization (fromConnectData)</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-3055</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Test case is here: &lt;a href=&quot;https://github.com/ksenji/kafka-connect-test/tree/master/src/test/java/org/apache/kafka/connect/json&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ksenji/kafka-connect-test/tree/master/src/test/java/org/apache/kafka/connect/json&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If Caching is disabled, it behaves correctly and JsonConverterWithNoCacheTest runs successfully. Otherwise the test JsonConverterTest fails.&lt;/p&gt;

&lt;p&gt;The reason is that the JsonConverter has a bug where it mangles the schema as it assigns all String fields with the same name (and similar for all Int32 fields)&lt;/p&gt;

&lt;p&gt;This is how the schema &amp;amp; payload gets serialized for the Person Struct (with caching disabled):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;schema&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;struct&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;fields&quot;&lt;/span&gt;:[{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;optional&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;firstName&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;optional&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;lastName&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;optional&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;email&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;int32&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;optional&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;age&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;int32&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;optional&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;weightInKgs&quot;&lt;/span&gt;}],&lt;span class=&quot;code-quote&quot;&gt;&quot;optional&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;Person&quot;&lt;/span&gt;},&lt;span class=&quot;code-quote&quot;&gt;&quot;payload&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;firstName&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;Eric&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;lastName&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;Cartman&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;email&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;eric.cartman@southpark.com&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;age&quot;&lt;/span&gt;:10,&lt;span class=&quot;code-quote&quot;&gt;&quot;weightInKgs&quot;&lt;/span&gt;:40}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;where as when caching is enabled the same Struct gets serialized as (with caching enabled) :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;schema&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;struct&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;fields&quot;&lt;/span&gt;:[{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;optional&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;email&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;optional&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;email&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;optional&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;email&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;int32&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;optional&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;weightInKgs&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;int32&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;optional&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;weightInKgs&quot;&lt;/span&gt;}],&lt;span class=&quot;code-quote&quot;&gt;&quot;optional&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;Person&quot;&lt;/span&gt;},&lt;span class=&quot;code-quote&quot;&gt;&quot;payload&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;firstName&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;Eric&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;lastName&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;Cartman&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;email&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;eric.cartman@southpark.com&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;age&quot;&lt;/span&gt;:10,&lt;span class=&quot;code-quote&quot;&gt;&quot;weightInKgs&quot;&lt;/span&gt;:40}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As we can see all String fields became &quot;email&quot; and all int32 fields became &quot;weightInKgs&quot;. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12925164">KAFKA-3055</key>
            <summary>JsonConverter mangles schema during serialization (fromConnectData)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ewencp">Ewen Cheslack-Postava</assignee>
                                    <reporter username="ksenji">Kishore Senji</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Jan 2016 01:40:01 +0000</created>
                <updated>Wed, 18 May 2016 01:37:44 +0000</updated>
                            <resolved>Mon, 4 Jan 2016 16:48:35 +0000</resolved>
                                    <version>0.9.0.0</version>
                                    <fixVersion>0.9.0.1</fixVersion>
                    <fixVersion>0.10.0.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15076221" author="githubbot" created="Fri, 1 Jan 2016 02:05:05 +0000"  >&lt;p&gt;GitHub user ksenji opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/722&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/722&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3055&quot; title=&quot;JsonConverter mangles schema during serialization (fromConnectData)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3055&quot;&gt;&lt;del&gt;KAFKA-3055&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/ksenji/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ksenji/kafka&lt;/a&gt; trunk&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/722.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/722.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #722&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 60a5b5cecd39ccdd4ff2f977a6bfdef123cadb44&lt;br/&gt;
Author: ksenji &amp;lt;ksenji@ebay.com&amp;gt;&lt;br/&gt;
Date:   2016-01-01T02:01:44Z&lt;/p&gt;

&lt;p&gt;    Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3055&quot; title=&quot;JsonConverter mangles schema during serialization (fromConnectData)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3055&quot;&gt;&lt;del&gt;KAFKA-3055&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15076222" author="ksenji" created="Fri, 1 Jan 2016 02:05:32 +0000"  >&lt;p&gt;PR: &lt;a href=&quot;https://github.com/apache/kafka/pull/722&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/722&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15081345" author="githubbot" created="Mon, 4 Jan 2016 16:48:09 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/722&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/722&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15081346" author="ewencp" created="Mon, 4 Jan 2016 16:48:35 +0000"  >&lt;p&gt;Issue resolved by pull request 722&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/722&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/722&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15128891" author="vtsarva78@gmail.com" created="Tue, 2 Feb 2016 19:49:40 +0000"  >&lt;p&gt;Hi Kishore&lt;/p&gt;

&lt;p&gt;I am facing this same problem and trying to see if we can handle without&lt;br/&gt;
updating the patch fix done already. Can you please let me know how to&lt;br/&gt;
disable cache as you mentioned this works fine when cache is disabled.&lt;/p&gt;

&lt;p&gt;regards&lt;br/&gt;
Saravanan&lt;/p&gt;</comment>
                            <comment id="15138155" author="ewencp" created="Tue, 9 Feb 2016 01:00:41 +0000"  >&lt;p&gt;There&apos;s a config schemas.cache.size. Since it&apos;s an LRU cache, setting the size to 1 would presumably work.&lt;/p&gt;</comment>
                            <comment id="15139051" author="ksenji" created="Tue, 9 Feb 2016 15:16:10 +0000"  >&lt;p&gt;Please look here: &lt;a href=&quot;https://github.com/ksenji/kafka-connect-test/blob/master/src/test/java/org/apache/kafka/connect/json/JsonConverterWithNoCacheTest.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ksenji/kafka-connect-test/blob/master/src/test/java/org/apache/kafka/connect/json/JsonConverterWithNoCacheTest.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15288056" author="ceposta" created="Wed, 18 May 2016 01:37:44 +0000"  >&lt;p&gt;the correct config for the worker to change the cache size is &lt;/p&gt;

&lt;p&gt;value.converter.schemas.cache.size&lt;/p&gt;

&lt;p&gt;Need to have this fixed before you can use it though: &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3723&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-3723&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12915839">KAFKA-2884</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2qfzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ewencp</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>