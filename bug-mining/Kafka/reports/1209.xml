<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:56:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-4234] Consumer should not commit offsets in unsubscribe()</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-4234</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;In KIP-70, we changed the behavior of &lt;tt&gt;unsubscribe&lt;/tt&gt; to commit offsets if autocommit is enabled. Unfortunately, because of the issue documented in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3491&quot; title=&quot;Issue with consumer close() in finally block with &amp;#39;enable.auto.commit=true&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3491&quot;&gt;KAFKA-3491&lt;/a&gt;, this makes it impossible to abort processing if an exception is thrown while processing some records. Until we have a fix for this problem, we should probably revert this behavior.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13008762">KAFKA-4234</key>
            <summary>Consumer should not commit offsets in unsubscribe()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vahid">Vahid Hashemian</assignee>
                                    <reporter username="hachikuji">Jason Gustafson</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Sep 2016 00:07:19 +0000</created>
                <updated>Fri, 30 Sep 2016 20:29:22 +0000</updated>
                            <resolved>Fri, 30 Sep 2016 20:29:12 +0000</resolved>
                                                    <fixVersion>0.10.1.0</fixVersion>
                                    <component>consumer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15534483" author="hachikuji" created="Fri, 30 Sep 2016 00:07:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vahid&quot; class=&quot;user-hover&quot; rel=&quot;vahid&quot;&gt;vahid&lt;/a&gt; Does this make sense to you?&lt;/p&gt;</comment>
                            <comment id="15534708" author="vahid" created="Fri, 30 Sep 2016 01:39:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hachikuji&quot; class=&quot;user-hover&quot; rel=&quot;hachikuji&quot;&gt;hachikuji&lt;/a&gt; I read the comments on &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3491&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;KAFKA-3491&lt;/a&gt; and it seems there is no consensus on which way to go. Has it been decided that calling &lt;tt&gt;unsubscribe&lt;/tt&gt; before &lt;tt&gt;close&lt;/tt&gt; should be the workaround? If so, are we ok with the issues that not committing offsets in &lt;tt&gt;unsubscribe&lt;/tt&gt; will bring back (e.g. reading duplicates)?&lt;/p&gt;</comment>
                            <comment id="15534782" author="hachikuji" created="Fri, 30 Sep 2016 02:19:57 +0000"  >&lt;p&gt;Yeah, since there&apos;s no consensus how to address the problem at the moment, I think it would make sense to let the current workaround of calling unsubscribe() continue to work as it has in previous releases. Otherwise users have no way to abort if an exception occurs, which kind of limits the usefulness of autocommit. In the next release cycle, we can come up with a better solution for this problem and then decide whether &lt;tt&gt;unsubscribe()&lt;/tt&gt; should send an offset commit or not. What do you think?&lt;/p&gt;</comment>
                            <comment id="15536297" author="vahid" created="Fri, 30 Sep 2016 15:39:55 +0000"  >&lt;p&gt;Sounds fair. One approach would be to somehow preserve the offset(s) before the last &lt;tt&gt;poll&lt;/tt&gt; so that if issues occurred after the &lt;tt&gt;poll&lt;/tt&gt; we are able to reset (or &lt;tt&gt;rewind&lt;/tt&gt; as suggested in the other thread) without having to perform an &lt;tt&gt;unsubscribe&lt;/tt&gt;. But as you suggested, we can think more about this during the next release cycle. I&apos;ll start working on this today.&lt;/p&gt;</comment>
                            <comment id="15536715" author="githubbot" created="Fri, 30 Sep 2016 18:44:55 +0000"  >&lt;p&gt;GitHub user vahidhashemian opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1944&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1944&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4234&quot; title=&quot;Consumer should not commit offsets in unsubscribe()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4234&quot;&gt;&lt;del&gt;KAFKA-4234&lt;/del&gt;&lt;/a&gt;: Temporarily disable committing offsets in consumer&apos;s `unsubscribe()`&lt;/p&gt;

&lt;p&gt;    Temporarily disable the offset commit (when auto commit is enabled) in the new consumer&apos;s `unsubscribe()` method towards a workaround for the issue reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3491&quot; title=&quot;Issue with consumer close() in finally block with &amp;#39;enable.auto.commit=true&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3491&quot;&gt;KAFKA-3491&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3491&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-3491&lt;/a&gt;).&lt;br/&gt;
    For now, a call to `unsubscribe()` can be made to reset the offsets in case processing the batch received from the most recent `poll()` is interrupted (due to some exception).&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/vahidhashemian/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/vahidhashemian/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4234&quot; title=&quot;Consumer should not commit offsets in unsubscribe()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4234&quot;&gt;&lt;del&gt;KAFKA-4234&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1944.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1944.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1944&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 6e850b65904031cb4f8c21834d10cd746cc62f42&lt;br/&gt;
Author: Vahid Hashemian &amp;lt;vahidhashemian@us.ibm.com&amp;gt;&lt;br/&gt;
Date:   2016-09-30T18:36:22Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4234&quot; title=&quot;Consumer should not commit offsets in unsubscribe()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4234&quot;&gt;&lt;del&gt;KAFKA-4234&lt;/del&gt;&lt;/a&gt;: Temporarily disable committing offsets in consumer&apos;s unsubscribe()&lt;/p&gt;

&lt;p&gt;    Temporarily disable the offset commit (when auto commit is enabled) in the new consumer&apos;s `unsubscribe()` method towards a workaround for the issue reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3491&quot; title=&quot;Issue with consumer close() in finally block with &amp;#39;enable.auto.commit=true&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3491&quot;&gt;KAFKA-3491&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3491&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-3491&lt;/a&gt;).&lt;br/&gt;
    For now, a call to `unsubscribe()` can be made to reset the offsets in case processing the batch received from the most recent `poll()` is interrupted (due to some exception).&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15536984" author="hachikuji" created="Fri, 30 Sep 2016 20:29:12 +0000"  >&lt;p&gt;Issue resolved by pull request 1944&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/1944&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1944&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15536986" author="githubbot" created="Fri, 30 Sep 2016 20:29:22 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1944&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1944&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13008955">KAFKA-4242</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12955366">KAFKA-3491</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 7 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34a6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>