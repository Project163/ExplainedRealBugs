<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:44:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-2338] Warn users if they change max.message.bytes that they also need to update broker and consumer settings</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-2338</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;We already have &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-1756&quot; title=&quot;never allow the replica fetch size to be less than the max message size&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-1756&quot;&gt;&lt;del&gt;KAFKA-1756&lt;/del&gt;&lt;/a&gt; filed to more completely address this issue, but it is waiting for some other major changes to configs to completely protect users from this problem.&lt;/p&gt;

&lt;p&gt;This JIRA should address the low hanging fruit to at least warn users of the potential problems. Currently the only warning is in our documentation.&lt;/p&gt;

&lt;p&gt;1. Generate a warning in the kafka-topics.sh tool when they change this setting on a topic to be larger than the default. This needs to be very obvious in the output.&lt;br/&gt;
2. Currently, the broker&apos;s replica fetcher isn&apos;t logging any useful error messages when replication can&apos;t succeed because a message size is too large. Logging an error here would allow users that get into a bad state to find out why it is happening more easily. (Consumers should already be logging a useful error message.)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12845364">KAFKA-2338</key>
            <summary>Warn users if they change max.message.bytes that they also need to update broker and consumer settings</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="benstopford">Ben Stopford</assignee>
                                    <reporter username="ewencp">Ewen Cheslack-Postava</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Jul 2015 19:16:00 +0000</created>
                <updated>Thu, 22 Oct 2015 15:34:01 +0000</updated>
                            <resolved>Wed, 21 Oct 2015 00:22:02 +0000</resolved>
                                    <version>0.8.2.1</version>
                                    <fixVersion>0.9.0.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14631784" author="eribeiro" created="Fri, 17 Jul 2015 19:32:20 +0000"  >&lt;p&gt;Created reviewboard &lt;a href=&quot;https://reviews.apache.org/r/36578/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/36578/diff/&lt;/a&gt;&lt;br/&gt;
 against branch origin/trunk&lt;/p&gt;</comment>
                            <comment id="14631785" author="eribeiro" created="Fri, 17 Jul 2015 19:34:46 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ewencp&quot; class=&quot;user-hover&quot; rel=&quot;ewencp&quot;&gt;ewencp&lt;/a&gt;, as this my first official Kafka patch (yay!) it should have some misunderstandings or plain errors (I was particularly in doubt about the logging of a useful message by the broker&apos;s replica fetcher). Please, whenever you have time, see if it&apos;s okay. Thanks!&lt;/p&gt;</comment>
                            <comment id="14632244" author="eribeiro" created="Sat, 18 Jul 2015 03:37:56 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/36578/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/36578/diff/&lt;/a&gt;&lt;br/&gt;
 against branch origin/trunk&lt;/p&gt;</comment>
                            <comment id="14634465" author="eribeiro" created="Tue, 21 Jul 2015 03:16:55 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gwenshap&quot; class=&quot;user-hover&quot; rel=&quot;gwenshap&quot;&gt;gwenshap&lt;/a&gt;, whenever you have a free cycles, could you please review this puppy? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Still getting acquainted with the code base, so I hope not far off what&apos;s required. &lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="14635216" author="eribeiro" created="Tue, 21 Jul 2015 14:55:23 +0000"  >&lt;p&gt;Oh, ignore the previous message, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gwenshap&quot; class=&quot;user-hover&quot; rel=&quot;gwenshap&quot;&gt;gwenshap&lt;/a&gt;, I will be reworking the patch to fix it.&lt;/p&gt;</comment>
                            <comment id="14635330" author="eribeiro" created="Tue, 21 Jul 2015 16:21:45 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/36578/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/36578/diff/&lt;/a&gt;&lt;br/&gt;
 against branch origin/trunk&lt;/p&gt;</comment>
                            <comment id="14663249" author="gwenshap" created="Sun, 9 Aug 2015 04:09:46 +0000"  >&lt;p&gt;Moving to patch-available so we won&apos;t forget to review.&lt;/p&gt;</comment>
                            <comment id="14708277" author="gwenshap" created="Sun, 23 Aug 2015 02:39:06 +0000"  >&lt;p&gt;OK, this patch doesn&apos;t even come close to fixing everything that is broken with max message sizes, but it is short, sweet and will probably be useful to some users. &lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14708278" author="gwenshap" created="Sun, 23 Aug 2015 02:40:36 +0000"  >&lt;p&gt;Sorry, patch doesn&apos;t apply again &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Can you rebase?&lt;/p&gt;</comment>
                            <comment id="14709685" author="eribeiro" created="Mon, 24 Aug 2015 17:36:26 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/36578/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/36578/diff/&lt;/a&gt;&lt;br/&gt;
 against branch origin/trunk&lt;/p&gt;</comment>
                            <comment id="14709707" author="eribeiro" created="Mon, 24 Aug 2015 17:46:13 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gwenshap&quot; class=&quot;user-hover&quot; rel=&quot;gwenshap&quot;&gt;gwenshap&lt;/a&gt;, thanks for the kind words. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I am sorry for not being able to give the necessary love to this patch &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; (much because of my inexperience with the code base, I guess). I hope I can dig more about max message size problems soon tough. I have just rebased the patch and it compiles successfully now with latest trunk.&lt;/p&gt;

&lt;p&gt;Oh, one thing that has caught my attention is that some chunk of code (below) was removed from TopicCommand, specifically in the alterTopic() method, in the context of &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-2198&quot; title=&quot;kafka-topics.sh exits with 0 status on failures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-2198&quot;&gt;&lt;del&gt;KAFKA-2198&lt;/del&gt;&lt;/a&gt; (a7e0ac):. Seems to indicate that now topic configuration cannot be altered, right?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      val configs = AdminUtils.fetchTopicConfig(zkClient, topic)
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(opts.options.has(opts.configOpt) || opts.options.has(opts.deleteConfigOpt)) {
        val configsToBeAdded = parseTopicConfigsToBeAdded(opts)
        val configsToBeDeleted = parseTopicConfigsToBeDeleted(opts)
        &lt;span class=&quot;code-comment&quot;&gt;// compile the &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; set of configs
&lt;/span&gt;        configs.putAll(configsToBeAdded)
        configsToBeDeleted.foreach(config =&amp;gt; configs.remove(config))
        AdminUtils.changeTopicConfig(zkClient, topic, configs)
        println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Updated config &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; topic \&quot;&lt;/span&gt;%s\&lt;span class=&quot;code-quote&quot;&gt;&quot;.&quot;&lt;/span&gt;.format(topic))
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sorry if my doubt is naive/stupid. And feel free to merge this patch, but take a look to see if I am doing it right. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;

&lt;p&gt;Thanks!&lt;br/&gt;
Edward&lt;/p&gt;</comment>
                            <comment id="14728149" author="eribeiro" created="Wed, 2 Sep 2015 22:31:04 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/36578/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/36578/diff/&lt;/a&gt;&lt;br/&gt;
 against branch origin/trunk&lt;/p&gt;</comment>
                            <comment id="14959887" author="githubbot" created="Thu, 15 Oct 2015 23:59:30 +0000"  >&lt;p&gt;GitHub user benstopford opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/322&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/322&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-2338&quot; title=&quot;Warn users if they change max.message.bytes that they also need to update broker and consumer settings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-2338&quot;&gt;&lt;del&gt;KAFKA-2338&lt;/del&gt;&lt;/a&gt;: Warn on max.message.bytes change&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Both TopicCommand and ConfigCommand warn if message.max.bytes increases&lt;/li&gt;
	&lt;li&gt;Log failures on the broker if replication gets stuck due to an oversized message&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/benstopford/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/benstopford/kafka&lt;/a&gt; CPKAFKA-61&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/322.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/322.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #322&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit d59110d28fe1dcd62520e2b031005a369ceb4bc7&lt;br/&gt;
Author: benstopford &amp;lt;benstopford@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-10-15T17:13:09Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-2338&quot; title=&quot;Warn users if they change max.message.bytes that they also need to update broker and consumer settings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-2338&quot;&gt;&lt;del&gt;KAFKA-2338&lt;/del&gt;&lt;/a&gt;: Warn user if they override max.message.bytes. Warn on failing replica fetches.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14966020" author="junrao" created="Wed, 21 Oct 2015 00:22:02 +0000"  >&lt;p&gt;Issue resolved by pull request 322&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/322&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/322&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14966022" author="githubbot" created="Wed, 21 Oct 2015 00:22:06 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/322&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/322&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14969092" author="githubbot" created="Thu, 22 Oct 2015 12:28:36 +0000"  >&lt;p&gt;GitHub user benstopford opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/351&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/351&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-2338&quot; title=&quot;Warn users if they change max.message.bytes that they also need to update broker and consumer settings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-2338&quot;&gt;&lt;del&gt;KAFKA-2338&lt;/del&gt;&lt;/a&gt;: add force option to topic / config command so they can be called programatically&lt;/p&gt;

&lt;p&gt;    Tiny change to add a force option to the topic and config commands so they can be called programatically without requiring user input. &lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/benstopford/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/benstopford/kafka&lt;/a&gt; CPKAFKA-61B&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/351.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/351.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #351&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b29316e7174f21a91043d7a3aa451b6345324dd2&lt;br/&gt;
Author: Ben Stopford &amp;lt;benstopford@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-10-22T12:27:13Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-2338&quot; title=&quot;Warn users if they change max.message.bytes that they also need to update broker and consumer settings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-2338&quot;&gt;&lt;del&gt;KAFKA-2338&lt;/del&gt;&lt;/a&gt;: add &apos;force&apos; option to avoid console prompts&lt;/p&gt;

&lt;hr /&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12907118">KAFKA-2684</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12745873" name="KAFKA-2338.patch" size="6006" author="eribeiro" created="Fri, 17 Jul 2015 19:32:19 +0000"/>
                            <attachment id="12745929" name="KAFKA-2338_2015-07-18_00:37:31.patch" size="4064" author="eribeiro" created="Sat, 18 Jul 2015 03:37:55 +0000"/>
                            <attachment id="12746379" name="KAFKA-2338_2015-07-21_13:21:19.patch" size="3120" author="eribeiro" created="Tue, 21 Jul 2015 16:21:43 +0000"/>
                            <attachment id="12752040" name="KAFKA-2338_2015-08-24_14:32:38.patch" size="5698" author="eribeiro" created="Mon, 24 Aug 2015 17:36:24 +0000"/>
                            <attachment id="12753868" name="KAFKA-2338_2015-09-02_19:27:17.patch" size="5668" author="eribeiro" created="Wed, 2 Sep 2015 22:31:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 4 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2hat3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>gwenshap</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>