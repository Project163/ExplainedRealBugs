<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:50:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-2421] Upgrade LZ4 to version 1.3 to avoid crashing with IBM Java 7</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-2421</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Upgrade LZ4 to version 1.3 to avoid crashing with IBM Java 7.&lt;/p&gt;

&lt;p&gt;LZ4 version 1.2 crashes with 64-bit IBM Java 7. This has been fixed in LZ4 version 1.3 (&lt;a href=&quot;https://github.com/jpountz/lz4-java/blob/master/CHANGES.md&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jpountz/lz4-java/blob/master/CHANGES.md&lt;/a&gt;, &lt;a href=&quot;https://github.com/jpountz/lz4-java/pull/46&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jpountz/lz4-java/pull/46&lt;/a&gt;).&lt;/p&gt;


&lt;p&gt;The unit test org.apache.kafka.common.record.MemoryRecordsTest crashes when run with 64-bit IBM Java7 with the error:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;00000000023EB900: Native Method 000000000263CE10 (net/jpountz/lz4/LZ4JNI.LZ4_compress_limitedOutput([BII[BII)I)&lt;br/&gt;
00000000023EB900: Invalid JNI call of function void ReleasePrimitiveArrayCritical(JNIEnv *env, jarray array, void *carray, jint mode): For array 00000000FFF7EAB8 parameter carray passed 00000000FFF85998, expected to be 00000000FFF7EAC0&lt;br/&gt;
14:08:42.763 0x23eb900    j9mm.632    *   ** ASSERTION FAILED ** at StandardAccessBarrier.cpp:335: ((false))&lt;br/&gt;
JVMDUMP039I Processing dump event &quot;traceassert&quot;, detail &quot;&quot; at 2015/08/11 15:08:42 - please wait.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Stack trace from javacore:&lt;/p&gt;

&lt;p&gt;3XMTHREADINFO3           Java callstack:&lt;br/&gt;
4XESTACKTRACE                at net/jpountz/lz4/LZ4JNI.LZ4_compress_limitedOutput(Native Method)&lt;br/&gt;
4XESTACKTRACE                at net/jpountz/lz4/LZ4JNICompressor.compress(LZ4JNICompressor.java:31)&lt;br/&gt;
4XESTACKTRACE                at net/jpountz/lz4/LZ4Factory.&amp;lt;init&amp;gt;(LZ4Factory.java:163)&lt;br/&gt;
4XESTACKTRACE                at net/jpountz/lz4/LZ4Factory.instance(LZ4Factory.java:46)&lt;br/&gt;
4XESTACKTRACE                at net/jpountz/lz4/LZ4Factory.nativeInstance(LZ4Factory.java:76)&lt;br/&gt;
5XESTACKTRACE                   (entered lock: net/jpountz/lz4/LZ4Factory@0x00000000E02F0BE8, entry count: 1)&lt;br/&gt;
4XESTACKTRACE                at net/jpountz/lz4/LZ4Factory.fastestInstance(LZ4Factory.java:129)&lt;br/&gt;
4XESTACKTRACE                at org/apache/kafka/common/record/KafkaLZ4BlockOutputStream.&amp;lt;init&amp;gt;(KafkaLZ4BlockOutputStream.java:72)&lt;br/&gt;
4XESTACKTRACE                at org/apache/kafka/common/record/KafkaLZ4BlockOutputStream.&amp;lt;init&amp;gt;(KafkaLZ4BlockOutputStream.java:93)&lt;br/&gt;
4XESTACKTRACE                at org/apache/kafka/common/record/KafkaLZ4BlockOutputStream.&amp;lt;init&amp;gt;(KafkaLZ4BlockOutputStream.java:103)&lt;br/&gt;
4XESTACKTRACE                at sun/reflect/NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
4XESTACKTRACE                at sun/reflect/NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:86)&lt;br/&gt;
4XESTACKTRACE                at sun/reflect/DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:58)&lt;br/&gt;
4XESTACKTRACE                at java/lang/reflect/Constructor.newInstance(Constructor.java:542)&lt;br/&gt;
4XESTACKTRACE                at org/apache/kafka/common/record/Compressor.wrapForOutput(Compressor.java:222)&lt;br/&gt;
4XESTACKTRACE                at org/apache/kafka/common/record/Compressor.&amp;lt;init&amp;gt;(Compressor.java:72)&lt;br/&gt;
4XESTACKTRACE                at org/apache/kafka/common/record/Compressor.&amp;lt;init&amp;gt;(Compressor.java:76)&lt;br/&gt;
4XESTACKTRACE                at org/apache/kafka/common/record/MemoryRecords.&amp;lt;init&amp;gt;(MemoryRecords.java:43)&lt;br/&gt;
4XESTACKTRACE                at org/apache/kafka/common/record/MemoryRecords.emptyRecords(MemoryRecords.java:51)&lt;br/&gt;
4XESTACKTRACE                at org/apache/kafka/common/record/MemoryRecords.emptyRecords(MemoryRecords.java:55)&lt;br/&gt;
4XESTACKTRACE                at org/apache/kafka/common/record/MemoryRecordsTest.testIterator(MemoryRecordsTest.java:42)&lt;/p&gt;

&lt;p&gt;java -version&lt;br/&gt;
java version &quot;1.7.0&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build pxa6470_27sr3fp1-20150605_01(SR3 FP1))&lt;br/&gt;
IBM J9 VM (build 2.7, JRE 1.7.0 Linux amd64-64 Compressed References 20150407_243189 (JIT enabled, AOT enabled)&lt;br/&gt;
J9VM - R27_Java727_SR3_20150407_1831_B243189&lt;br/&gt;
JIT  - tr.r13.java_20150406_89182&lt;br/&gt;
GC   - R27_Java727_SR3_20150407_1831_B243189_CMPRSS&lt;br/&gt;
J9CL - 20150407_243189)&lt;br/&gt;
JCL - 20150601_01 based on Oracle 7u79-b14&lt;/p&gt;</description>
                <environment>IBM Java 7</environment>
        <key id="12854175">KAFKA-2421</key>
            <summary>Upgrade LZ4 to version 1.3 to avoid crashing with IBM Java 7</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="granthenke">Grant Henke</assignee>
                                    <reporter username="rsivaram">Rajini Sivaram</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Aug 2015 14:51:43 +0000</created>
                <updated>Tue, 1 Dec 2015 19:59:15 +0000</updated>
                            <resolved>Tue, 1 Dec 2015 19:59:15 +0000</resolved>
                                    <version>0.8.2.1</version>
                                    <fixVersion>0.10.0.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14681931" author="rsivaram" created="Tue, 11 Aug 2015 15:18:00 +0000"  >&lt;p&gt;Created reviewboard &lt;a href=&quot;https://reviews.apache.org/r/37357/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/37357/diff/&lt;/a&gt;&lt;br/&gt;
 against branch origin/trunk&lt;/p&gt;</comment>
                            <comment id="14681947" author="rsivaram" created="Tue, 11 Aug 2015 15:27:29 +0000"  >&lt;p&gt;Attached patch upgrades LZ4 to version 1.3 and fixes the reference to a method that was moved to a different class. Have tested that all unit tests work with IBM Java 7 with the changes.&lt;/p&gt;</comment>
                            <comment id="14682303" author="rsivaram" created="Tue, 11 Aug 2015 18:56:37 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/37357/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/37357/diff/&lt;/a&gt;&lt;br/&gt;
 against branch origin/trunk&lt;/p&gt;</comment>
                            <comment id="14726385" author="junrao" created="Tue, 1 Sep 2015 23:04:03 +0000"  >&lt;p&gt;The patch no longer applies. Could you rebase?&lt;/p&gt;</comment>
                            <comment id="14734672" author="rsivaram" created="Tue, 8 Sep 2015 11:38:52 +0000"  >&lt;p&gt;Updated reviewboard &lt;a href=&quot;https://reviews.apache.org/r/37357/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/37357/diff/&lt;/a&gt;&lt;br/&gt;
 against branch origin/trunk&lt;/p&gt;</comment>
                            <comment id="14734674" author="rsivaram" created="Tue, 8 Sep 2015 11:44:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=junrao&quot; class=&quot;user-hover&quot; rel=&quot;junrao&quot;&gt;junrao&lt;/a&gt; Sorry I was away for the last couple of weeks. The patch has been updated.&lt;/p&gt;</comment>
                            <comment id="15011263" author="granthenke" created="Wed, 18 Nov 2015 16:01:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rsivaram&quot; class=&quot;user-hover&quot; rel=&quot;rsivaram&quot;&gt;rsivaram&lt;/a&gt; Do you mind if I finish this up? I would like to add a few unit tests related to compression size and get this merged. Its related to &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-2800&quot; title=&quot;Update outdated dependencies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-2800&quot;&gt;&lt;del&gt;KAFKA-2800&lt;/del&gt;&lt;/a&gt; which I have been working on.&lt;/p&gt;</comment>
                            <comment id="15011532" author="granthenke" created="Wed, 18 Nov 2015 17:54:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rsivaram&quot; class=&quot;user-hover&quot; rel=&quot;rsivaram&quot;&gt;rsivaram&lt;/a&gt; I am going to send a PR for this today. I hope thats okay.&lt;/p&gt;</comment>
                            <comment id="15011547" author="githubbot" created="Wed, 18 Nov 2015 17:59:26 +0000"  >&lt;p&gt;GitHub user granthenke opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/552&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/552&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-2421&quot; title=&quot;Upgrade LZ4 to version 1.3 to avoid crashing with IBM Java 7&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-2421&quot;&gt;&lt;del&gt;KAFKA-2421&lt;/del&gt;&lt;/a&gt;: Upgrade LZ4 to version 1.3&lt;/p&gt;

&lt;p&gt;    A few notes on the added test:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;I verified this test fails when changing between snappy 1.1.1.2 and 1.1.1.7 (per &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-2189&quot; title=&quot;Snappy compression of message batches less efficient in 0.8.2.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-2189&quot;&gt;&lt;del&gt;KAFKA-2189&lt;/del&gt;&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;The hard coded numbers are passing before and after lzo change&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/granthenke/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/granthenke/kafka&lt;/a&gt; lz4&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/552.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/552.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #552&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 0d6eb9948c18cdabdadcb7baa67c59fe0c8c51e2&lt;br/&gt;
Author: Grant Henke &amp;lt;granthenke@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-11-18T17:58:09Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-2421&quot; title=&quot;Upgrade LZ4 to version 1.3 to avoid crashing with IBM Java 7&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-2421&quot;&gt;&lt;del&gt;KAFKA-2421&lt;/del&gt;&lt;/a&gt;: Upgrade LZ4 to version 1.3&lt;/p&gt;

&lt;p&gt;    A few notes on the added test:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;I verified this test fails when changing between snappy 1.1.1.2 and 1.1.1.7 (per &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-2189&quot; title=&quot;Snappy compression of message batches less efficient in 0.8.2.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-2189&quot;&gt;&lt;del&gt;KAFKA-2189&lt;/del&gt;&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;The hard coded numbers are passing before and after lzo change&lt;/li&gt;
&lt;/ul&gt;


&lt;hr /&gt;</comment>
                            <comment id="15011781" author="rsivaram" created="Wed, 18 Nov 2015 19:38:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=granthenke&quot; class=&quot;user-hover&quot; rel=&quot;granthenke&quot;&gt;granthenke&lt;/a&gt; Thank you for picking this up.&lt;/p&gt;</comment>
                            <comment id="15034476" author="githubbot" created="Tue, 1 Dec 2015 19:57:54 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/552&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/552&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12749873" name="KAFKA-2421.patch" size="2557" author="rsivaram" created="Tue, 11 Aug 2015 15:17:59 +0000"/>
                            <attachment id="12749909" name="KAFKA-2421_2015-08-11_18:54:26.patch" size="2551" author="rsivaram" created="Tue, 11 Aug 2015 18:56:31 +0000"/>
                            <attachment id="12754622" name="kafka-2421_2015-09-08_11:38:03.patch" size="2494" author="rsivaram" created="Tue, 8 Sep 2015 11:38:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2il9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>