<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:37:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-830] partition replica assignment map in the controller should be a Set</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-830</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;partitionReplicaAssignment currently stores the list of assigned replicas as a sequence. When a broker comes online, the replica state machine adds the broker to the list of assigned replicas. It should do that only if the replica is already not in the list of assigned replicas. This causes the replication factor to be incorrectly calculated&lt;/p&gt;</description>
                <environment></environment>
        <key id="12639232">KAFKA-830</key>
            <summary>partition replica assignment map in the controller should be a Set</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nehanarkhede">Neha Narkhede</assignee>
                                    <reporter username="nehanarkhede">Neha Narkhede</reporter>
                        <labels>
                            <label>kafka-0.8</label>
                            <label>p1</label>
                    </labels>
                <created>Wed, 27 Mar 2013 00:07:55 +0000</created>
                <updated>Wed, 27 Mar 2013 21:02:12 +0000</updated>
                            <resolved>Wed, 27 Mar 2013 20:34:41 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>controller</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13615387" author="nehanarkhede" created="Wed, 27 Mar 2013 15:29:28 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Changed any replica list to a set. This makes sense since replica ids can never legitimately repeat.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13615448" author="junrao" created="Wed, 27 Mar 2013 16:24:32 +0000"  >&lt;p&gt;Thanks for the patch. One problem with changing assigned replicas from a list to a set is that it breaks the preferred replica logic. We assume that the first replica is the preferred one. So the ordering of the replicas is important. Perhaps we should keep replicas as a list and make sure that we don&apos;t add duplicates when changing it.&lt;/p&gt;</comment>
                            <comment id="13615512" author="nehanarkhede" created="Wed, 27 Mar 2013 17:21:04 +0000"  >&lt;p&gt;Good catch! However, it doesn&apos;t make sense to keep it sequence since by definition those ids are unique. As for preferred replica logic, currently it is just the smallest replica id . So there are 2 options -&lt;/p&gt;

&lt;p&gt;1. Store replica ids in a sorted set&lt;br/&gt;
2. For preferred replica, pick the smallest id from a traditional hash set&lt;/p&gt;

&lt;p&gt;But in patch v2, I stuck to your suggestion since it is a much smaller change for 0.8. Will fix this in 0.8.1&lt;/p&gt;</comment>
                            <comment id="13615586" author="nehanarkhede" created="Wed, 27 Mar 2013 18:17:58 +0000"  >&lt;p&gt;Actually, thinking about it more, even picking the smallest replica id does not make sense. This is because if we pick the first replica to be the largest broker id, the rest of the replica ids are smaller than the preferred replica in this case. We will have to keep this a sequence and be careful while adding a replica id to the assigned replica list&lt;/p&gt;</comment>
                            <comment id="13615645" author="swapnilghike" created="Wed, 27 Mar 2013 19:19:52 +0000"  >&lt;p&gt;collection.mutable.LinkedHashSet will iterate the elements in the same sequence they were inserted. But using it will require changes at more places than the one line change in patch v2.&lt;/p&gt;</comment>
                            <comment id="13615697" author="junrao" created="Wed, 27 Mar 2013 20:18:50 +0000"  >&lt;p&gt;+1 on patch v2.&lt;/p&gt;</comment>
                            <comment id="13615728" author="nehanarkhede" created="Wed, 27 Mar 2013 20:34:52 +0000"  >&lt;p&gt;Thanks for the review&lt;/p&gt;</comment>
                            <comment id="13615750" author="nehanarkhede" created="Wed, 27 Mar 2013 21:02:12 +0000"  >&lt;p&gt;Swapnil, thanks for pointing that out, we can remember to do this in 0.8.1&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12575719" name="kafka-830-v1.patch" size="26871" author="nehanarkhede" created="Wed, 27 Mar 2013 15:29:28 +0000"/>
                            <attachment id="12575733" name="kafka-830-v2.patch" size="1195" author="nehanarkhede" created="Wed, 27 Mar 2013 17:21:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319702</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 34 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1j5v3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320043</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>