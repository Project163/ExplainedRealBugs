<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:39:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-17098] Error Opening RocksDBStore</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-17098</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;I&apos;m getting this exception on many of my state stores:&lt;/p&gt;


&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 03:35:33 �[1;31mERROR�[m [LH] KafkaStreamsServerImpl - Uncaught exception &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Error opening store core-repartition-store at location /lh-data/streams/lh-core/2_8/rocksdb/core-repartition-store 03:35:33 �[1;31mERROR�[m [KAFKA] KafkaStreams - stream-client [lh-0-core] Encountered the following exception during processing and the registered exception handler opted to SHUTDOWN_CLIENT. The streams client is going to shut down now. org.apache.kafka.streams.errors.ProcessorStateException: Error opening store core-repartition-store at location /lh-data/streams/lh-core/2_8/rocksdb/core-repartition-store at org.apache.kafka.streams.state.internals.RocksDBStore.openRocksDB(RocksDBStore.java:329) ~[server.jar:?] at org.apache.kafka.streams.state.internals.RocksDBStore.openRocksDB(RocksDBStore.java:291) ~[server.jar:?] at org.apache.kafka.streams.state.internals.RocksDBStore.openDB(RocksDBStore.java:254) ~[server.jar:?] at org.apache.kafka.streams.state.internals.RocksDBStore.init(RocksDBStore.java:175) ~[server.jar:?] at org.apache.kafka.streams.state.internals.WrappedStateStore.init(WrappedStateStore.java:71) ~[server.jar:?] at org.apache.kafka.streams.state.internals.ChangeLoggingKeyValueBytesStore.init(ChangeLoggingKeyValueBytesStore.java:56) ~[server.jar:?] at org.apache.kafka.streams.state.internals.WrappedStateStore.init(WrappedStateStore.java:71) ~[server.jar:?] at org.apache.kafka.streams.state.internals.MeteredKeyValueStore.lambda$init$3(MeteredKeyValueStore.java:158) ~[server.jar:?] at org.apache.kafka.streams.processor.internals.metrics.StreamsMetricsImpl.maybeMeasureLatency(StreamsMetricsImpl.java:872) ~[server.jar:?] at org.apache.kafka.streams.state.internals.MeteredKeyValueStore.init(MeteredKeyValueStore.java:158) ~[server.jar:?] at org.apache.kafka.streams.processor.internals.ProcessorStateManager.registerStateStores(ProcessorStateManager.java:232) ~[server.jar:?] at org.apache.kafka.streams.processor.internals.StateManagerUtil.registerStateStores(StateManagerUtil.java:102) ~[server.jar:?] at org.apache.kafka.streams.processor.internals.StreamTask.initializeIfNeeded(StreamTask.java:258) ~[server.jar:?] at org.apache.kafka.streams.processor.internals.TaskManager.addTaskToStateUpdater(TaskManager.java:1008) ~[server.jar:?] at org.apache.kafka.streams.processor.internals.TaskManager.addTasksToStateUpdater(TaskManager.java:995) ~[server.jar:?] at org.apache.kafka.streams.processor.internals.TaskManager.checkStateUpdater(TaskManager.java:911) ~[server.jar:?] at org.apache.kafka.streams.processor.internals.StreamThread.checkStateUpdater(StreamThread.java:1188) ~[server.jar:?] at org.apache.kafka.streams.processor.internals.StreamThread.runOnceWithoutProcessingThreads(StreamThread.java:996) ~[server.jar:?] at org.apache.kafka.streams.processor.internals.StreamThread.runLoop(StreamThread.java:711) ~[server.jar:?] at org.apache.kafka.streams.processor.internals.StreamThread.run(StreamThread.java:670) [server.jar:?] Caused by: org.rocksdb.RocksDBException: lock hold by current process, acquire time 1720323060 acquiring thread 139820785784576: /lh-data/streams/lh-core/2_8/rocksdb/core-repartition-store/LOCK: No locks available at org.rocksdb.RocksDB.open(Native Method) ~[server.jar:?] at org.rocksdb.RocksDB.open(RocksDB.java:307) ~[server.jar:?] at org.apache.kafka.streams.state.internals.RocksDBStore.openRocksDB(RocksDBStore.java:323) ~[server.jar:?] ... 19 more  &#160;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;br/&gt;
Some other details:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;State updater is enabled&lt;/li&gt;
	&lt;li&gt;I&apos;m using 5 stream threads&lt;/li&gt;
	&lt;li&gt;This usually happends during either normal processing or&#160; during state store restoration&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13585064">KAFKA-17098</key>
            <summary>Error Opening RocksDBStore</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cadonna">Bruno Cadonna</assignee>
                                    <reporter username="eduwerc">Eduwer Camacaro</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Jul 2024 19:59:02 +0000</created>
                <updated>Thu, 11 Jul 2024 20:06:22 +0000</updated>
                            <resolved>Thu, 11 Jul 2024 15:37:13 +0000</resolved>
                                    <version>3.8.0</version>
                                    <fixVersion>3.8.0</fixVersion>
                                    <component>streams</component>
                        <due>Mon, 8 Jul 2024 00:00:00 +0000</due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17863975" author="mjsax" created="Tue, 9 Jul 2024 01:13:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cadonna&quot; class=&quot;user-hover&quot; rel=&quot;cadonna&quot;&gt;cadonna&lt;/a&gt; &#8211; do you think you recent fix for state updated (ie from today) addresses this issues: &lt;a href=&quot;https://github.com/apache/kafka/commit/25230b538841a5e7256b1b51725361dd59435901&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/25230b538841a5e7256b1b51725361dd59435901&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We did discuss internally about potential lock issues, which you did rule out for the error we say in our own soak, but maybe this one is different? But I would assume you might need logs (\cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eduwerc&quot; class=&quot;user-hover&quot; rel=&quot;eduwerc&quot;&gt;eduwerc&lt;/a&gt; do you happen to have logs?) to judge?&lt;/p&gt;</comment>
                            <comment id="17863989" author="JIRAUSER306126" created="Tue, 9 Jul 2024 02:24:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mjsax&quot; class=&quot;user-hover&quot; rel=&quot;mjsax&quot;&gt;mjsax&lt;/a&gt; Yes, I just attached a log file that include some lines from our logs. If you think the entire log is useful, I can attach it.&lt;/p&gt;</comment>
                            <comment id="17864077" author="cadonna" created="Tue, 9 Jul 2024 08:55:25 +0000"  >&lt;p&gt;Apparently, my fix does not fix this issue. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eduwerc&quot; class=&quot;user-hover&quot; rel=&quot;eduwerc&quot;&gt;eduwerc&lt;/a&gt; tested it yesterday. I am wondering, why we do not see this issue.&lt;/p&gt;</comment>
                            <comment id="17864822" author="JIRAUSER306126" created="Wed, 10 Jul 2024 21:56:39 +0000"  >&lt;p&gt;I&apos;ve recently uploaded a fresh log (&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13070059/13070059_server.log.txt&quot; title=&quot;server.log.txt attached to KAFKA-17098&quot;&gt;server.log.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;)&#160;file with all of the log entries from the instance&apos;s start until the exception.&lt;/p&gt;</comment>
                            <comment id="17864987" author="cadonna" created="Thu, 11 Jul 2024 10:02:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eduwerc&quot; class=&quot;user-hover&quot; rel=&quot;eduwerc&quot;&gt;eduwerc&lt;/a&gt; I think, I found the issue. See the attached PR.&lt;br/&gt;
Could you please verify the fix?&lt;/p&gt;</comment>
                            <comment id="17865210" author="JIRAUSER306126" created="Thu, 11 Jul 2024 20:06:22 +0000"  >&lt;p&gt;Yes it works! thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13070059" name="server.log.txt" size="18477134" author="eduwerc" created="Wed, 10 Jul 2024 22:01:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1q7og:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>