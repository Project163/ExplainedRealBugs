<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:23:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-9925] Non-key KTable Joining may result in duplicate schema name in confluence schema registry</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-9925</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;The second half of issue Andy Bryant reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9390&quot; title=&quot;Non-key joining of KTable not compatible with confluent avro serdes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9390&quot;&gt;&lt;del&gt;KAFKA-9390&lt;/del&gt;&lt;/a&gt; looks like still exist.&lt;/p&gt;

&lt;p&gt;When testing non-key join method without passing in &quot;Named&quot;, I noticed that there are schema subjects registered in confluent schema registry without consumer group Id still, &lt;br/&gt;
e.g. &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&quot;KTABLE-FK-JOIN-SUBSCRIPTION-REGISTRATION-0000000005-topic-pk-key&quot;,
&quot;KTABLE-FK-JOIN-SUBSCRIPTION-REGISTRATION-0000000005-topic-fk-key&quot;,
&quot;KTABLE-FK-JOIN-SUBSCRIPTION-REGISTRATION-0000000005-topic-vh-value&quot;,
&quot;KTABLE-FK-JOIN-SUBSCRIPTION-REGISTRATION-0000000025-topic-pk-key&quot;,
&quot;KTABLE-FK-JOIN-SUBSCRIPTION-REGISTRATION-0000000025-topic-fk-key&quot;,
&quot;KTABLE-FK-JOIN-SUBSCRIPTION-REGISTRATION-0000000025-topic-vh-value&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Code in KTableImpl which constructed above naming :&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/blob/2.4.1/streams/src/main/java/org/apache/kafka/streams/kstream/internals/KTableImpl.java#L959&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/2.4.1/streams/src/main/java/org/apache/kafka/streams/kstream/internals/KTableImpl.java#L959&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;When we have multiple topologies using foreignKey join and registered to same schema registry, we can have a name clash, and fail to register schema. &lt;/p&gt;

&lt;p&gt;In order to clean up these schema subjects, we will need to know the internal naming of a consumer group&apos;s topology, which is not straightforward and error prone.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="13301551">KAFKA-9925</key>
            <summary>Non-key KTable Joining may result in duplicate schema name in confluence schema registry</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vvcephei">John Roesler</assignee>
                                    <reporter username="nikuis">Kin Siu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Apr 2020 12:15:00 +0000</created>
                <updated>Wed, 29 Apr 2020 22:35:46 +0000</updated>
                            <resolved>Wed, 29 Apr 2020 22:35:45 +0000</resolved>
                                    <version>2.4.1</version>
                                    <fixVersion>2.4.2</fixVersion>
                    <fixVersion>2.5.1</fixVersion>
                    <fixVersion>2.6.0</fixVersion>
                                    <component>streams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17094604" author="vvcephei" created="Tue, 28 Apr 2020 15:23:35 +0000"  >&lt;p&gt;Ah, right you are. So sorry I overlooked that part of the bug report when I submitted my fix for it.&lt;/p&gt;

&lt;p&gt;The issue is that these &quot;pseudo topics&quot; are being created the same way that real repartition topics get created in the DSL layer, but for real repartition topics, we add them to the InternalTopologyBuilder, which later on invokes org.apache.kafka.streams.processor.internals.InternalTopologyBuilder#decorateTopic to add the applicationId prefix. Of course, this will never happen for the pseudo-topics, since we don&apos;t add them to the InternalTopologyBuilder.&lt;/p&gt;

&lt;p&gt;The complication is that we don&apos;t know the applicationId until the application is started. Currently, both the DSL builder and the runtime are isolated from this because the DSL builder only has to register the topic with the InternalTopologyBuilder, and then the runtime code only has to deal with pre-configured Serdes, which get the pre-decorated topics injected at startup.&lt;/p&gt;

&lt;p&gt;I&apos;ll submit a PR shortly to fix it.&lt;/p&gt;</comment>
                            <comment id="17094729" author="vvcephei" created="Tue, 28 Apr 2020 17:57:36 +0000"  >&lt;p&gt;Ok, I&apos;ve opened &lt;a href=&quot;https://github.com/apache/kafka/pull/8574&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/8574&lt;/a&gt; . If you have the time, a review would help speed things along. Thanks for the report!&lt;/p&gt;</comment>
                            <comment id="17094772" author="guozhang" created="Tue, 28 Apr 2020 18:42:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vvcephei&quot; class=&quot;user-hover&quot; rel=&quot;vvcephei&quot;&gt;vvcephei&lt;/a&gt; Thanks for getting a look into this issue.&lt;/p&gt;

&lt;p&gt;I&apos;m wondering if now is a good time to deprecate the `StreamsBuilder#build()` function to let users use `build(final Properties props)` instead as a tiny KIP. There&apos;s risk of course that the props passed in `build` is not the same as the one passed into the `KafkaStreams` constructor. I think we can remember the reference of the Props when building the topology, and then at construction if we found they are not the same (by reference), we can log a warning such that &quot;found the topology is built with some StreamsConfig already, which is not the same as the config passed in the constructor&quot;.&lt;/p&gt;</comment>
                            <comment id="17094799" author="mjsax" created="Tue, 28 Apr 2020 19:01:27 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m wondering if now is a good time to deprecate the `StreamsBuilder#build()` function to let users use `build(final Properties props)` instead as a tiny KIP.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Just FYI: this is already proposed in KIP-591.&lt;/p&gt;

&lt;p&gt;However, IMHO, we should fix it for older versions, too?&lt;/p&gt;</comment>
                            <comment id="17094805" author="guozhang" created="Tue, 28 Apr 2020 19:10:19 +0000"  >&lt;p&gt;Ah yes!! Hope we can get KIP-591 by 2.6 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17095934" author="vvcephei" created="Wed, 29 Apr 2020 22:35:00 +0000"  >&lt;p&gt;Just saw this conversation. Thanks for the idea, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guozhang&quot; class=&quot;user-hover&quot; rel=&quot;guozhang&quot;&gt;guozhang&lt;/a&gt; . I guess it&apos;s moot now, since I&apos;ve just merged the PR &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I agree we should consider that separately, since we need to backport the fix. Plus, to replace the run time vs build time problem, we&apos;d have to &lt;em&gt;remove&lt;/em&gt; `build()`, not just &lt;em&gt;deprecate&lt;/em&gt; it, so I think even after KIP-591, we&apos;ll have to support this code path for a while.&lt;/p&gt;

&lt;p&gt;Anyway, I&apos;m resolving this ticket, since the fix is merged to trunk, 2.5, and 2.4. Thanks for the report and review, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nikuis&quot; class=&quot;user-hover&quot; rel=&quot;nikuis&quot;&gt;nikuis&lt;/a&gt; ! And sorry again for the trouble.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 28 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0e60w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>