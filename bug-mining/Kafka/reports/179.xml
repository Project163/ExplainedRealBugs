<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:36:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-697] ConsoleConsumer throws InvalidConfigException for &quot;.&quot; in client id</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-697</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;kafka.common.InvalidConfigException: client.id console-consumer-16946-ConsumerFetcherThread-console-consumer-16946_XXXX-host18.corp-1358006528116-991e3f2d-0-1 is illegal, contains a character other than ASCII alphanumerics, _ and -&lt;br/&gt;
        at kafka.common.Config$class.validateChars(Config.scala:32)&lt;br/&gt;
        at kafka.consumer.ConsumerConfig$.validateChars(ConsumerConfig.scala:25)&lt;br/&gt;
        at kafka.consumer.ConsumerConfig$.validateClientId(ConsumerConfig.scala:55)&lt;br/&gt;
        at kafka.consumer.SimpleConsumer.&amp;lt;init&amp;gt;(SimpleConsumer.scala:88)&lt;br/&gt;
        at kafka.server.AbstractFetcherThread.&amp;lt;init&amp;gt;(AbstractFetcherThread.scala:44)&lt;br/&gt;
        at kafka.consumer.ConsumerFetcherThread.&amp;lt;init&amp;gt;(ConsumerFetcherThread.scala:27)&lt;br/&gt;
        at kafka.consumer.ConsumerFetcherManager.createFetcherThread(ConsumerFetcherManager.scala:93)&lt;br/&gt;
        at kafka.server.AbstractFetcherManager.addFetcher(AbstractFetcherManager.scala:44)&lt;br/&gt;
        at kafka.consumer.ConsumerFetcherManager$$anon$1$$anonfun$doWork$3.apply(ConsumerFetcherManager.scala:75)&lt;br/&gt;
        at kafka.consumer.ConsumerFetcherManager$$anon$1$$anonfun$doWork$3.apply(ConsumerFetcherManager.scala:72)&lt;br/&gt;
        at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:80)&lt;br/&gt;
        at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:80)&lt;br/&gt;
        at scala.collection.Iterator$class.foreach(Iterator.scala:631)&lt;br/&gt;
        at scala.collection.mutable.HashTable$$anon$1.foreach(HashTable.scala:161)&lt;br/&gt;
        at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:194)&lt;br/&gt;
        at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)&lt;br/&gt;
        at scala.collection.mutable.HashMap.foreach(HashMap.scala:80)&lt;br/&gt;
        at kafka.consumer.ConsumerFetcherManager$$anon$1.doWork(ConsumerFetcherManager.scala:72)&lt;br/&gt;
        at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:50)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12627316">KAFKA-697</key>
            <summary>ConsoleConsumer throws InvalidConfigException for &quot;.&quot; in client id</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="swapnilghike">Swapnil Ghike</assignee>
                                    <reporter username="jfung">John Fung</reporter>
                        <labels>
                    </labels>
                <created>Sat, 12 Jan 2013 16:21:40 +0000</created>
                <updated>Tue, 15 Jan 2013 17:47:36 +0000</updated>
                            <resolved>Tue, 15 Jan 2013 17:46:45 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13552080" author="swapnilghike" created="Sat, 12 Jan 2013 22:09:04 +0000"  >&lt;p&gt;Currently we allow only alphanumerics, - and _ in the clientId, topic name and groupId. The topic name validation criteria were decided in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-495&quot; title=&quot;Handle topic names with &amp;quot;/&amp;quot; on Kafka server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-495&quot;&gt;&lt;del&gt;KAFKA-495&lt;/del&gt;&lt;/a&gt; and later while deciding to validate clientId and groupId in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-646&quot; title=&quot;Provide aggregate stats at the high level Producer and ZookeeperConsumerConnector level&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-646&quot;&gt;&lt;del&gt;KAFKA-646&lt;/del&gt;&lt;/a&gt;, we tried to maintain consistency with the topic name validation. &lt;/p&gt;

&lt;p&gt;As discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-495&quot; title=&quot;Handle topic names with &amp;quot;/&amp;quot; on Kafka server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-495&quot;&gt;&lt;del&gt;KAFKA-495&lt;/del&gt;&lt;/a&gt;, we don&apos;t have any strong reason to disallow dot in the validation, but we did not see any strong reason to make special case exceptions at the time as well and decided to make the validation criteria strict.&lt;/p&gt;

&lt;p&gt;For now, can we change the system test to not use dot? We can add it to the set of legal characters later though if more use cases arise.&lt;/p&gt;</comment>
                            <comment id="13552326" author="junrao" created="Sun, 13 Jan 2013 21:51:08 +0000"  >&lt;p&gt;In kafka-683 we changed client.id for a consumer to be config.clientId + &quot;-&quot; + consumerIdString + fetcherId + sourceBroker.id. ConsumerIdString has the format of consumerHostName + currentTimeMillis + randomUUID. The problem is that consumerHostName may have &quot;.&quot;, which breaks the naming convention. However, such a client.id is too verbose.  For debugging, we need to know the client IP address. We can fix that for every type of request in a separate jira. With client IP address and correlation id, we should have enough information for debugging. So, for now, just attach a patch to revert client.id to just config.ClientId.&lt;/p&gt;</comment>
                            <comment id="13552866" author="jfung" created="Mon, 14 Jan 2013 16:44:07 +0000"  >&lt;p&gt;Tested kafka-697.patch and it fixes the exception. Ran a full System Test and looks good.&lt;/p&gt;</comment>
                            <comment id="13553345" author="nehanarkhede" created="Tue, 15 Jan 2013 00:39:36 +0000"  >&lt;p&gt;Unfortunately, this rule of not allowing a &apos;.&apos; in the clientid seems very restrictive. Here, it is useful for the client id to have the hostname of the fetcher thread. This allows us to look at the kafka request log, take that client id, go the box, take a thread dump and correlate the behavior of the thread from the thread dump and the log4j using the client id string. This saves time required for troubleshooting. Since we have this restriction, we will have to take the client IP from the request log, convert it to a hostname, construct the thread name from this information and then try to understand the thread behavior from the thread dump and log4j. Also, one needs to know Kafka code to figure out how to construct the thread name from all this information, which is even worse.&lt;/p&gt;

&lt;p&gt;I think this is making things more difficult for us, which is a down side to disallowing &apos;.&apos; in the client id.&lt;/p&gt;</comment>
                            <comment id="13553351" author="sriramsub" created="Tue, 15 Jan 2013 00:45:26 +0000"  >&lt;p&gt;+1 on Neha&apos;s comment. It is simpler to allow &apos;.&apos; rather than getting the ip and adding code to pass that as part of the request object.&lt;/p&gt;</comment>
                            <comment id="13553389" author="swapnilghike" created="Tue, 15 Jan 2013 01:38:35 +0000"  >&lt;p&gt;Thanks for your comments. I agree that allowing dot will make our lives easier.&lt;/p&gt;

&lt;p&gt;In the attached patch, I have added dot to the regexes in Topic and Config classes. The regexes have also been modified to escape the last hyphen so that in the future if someone accidentally added a character at the end of the regex group, then the hyphen will not be treated as a range identifier.&lt;/p&gt;

&lt;p&gt;Topic has been modified to disallow &quot;.&quot; and &quot;..&quot; as topic names.&lt;/p&gt;

&lt;p&gt;TopicTest and ConfigTest have been modified accordingly.&lt;/p&gt;

&lt;p&gt;After including this patch, we can keep Jun&apos;s patch or discard it depending on what is convenient to keep in clientId.&lt;/p&gt;

&lt;p&gt;John, can you please check if this patch solves the problem (after reverting Jun&apos;s patch so that the root cause is reintroduced)? &lt;/p&gt;</comment>
                            <comment id="13553968" author="junrao" created="Tue, 15 Jan 2013 16:35:59 +0000"  >&lt;p&gt;The new patch looks good to me. We can just apply this patch once John verifies the system tests are ok.&lt;/p&gt;</comment>
                            <comment id="13554000" author="jfung" created="Tue, 15 Jan 2013 17:05:38 +0000"  >&lt;p&gt;Thanks Swapnil for the latest patch.&lt;/p&gt;

&lt;p&gt;The patch is sanity tested in a single box in which the hostname doesn&apos;t have a &quot;.&quot; and in a distributed env where the host names have a &quot;.&quot; (besides the parent domain name). In both cases, the patch works fine.&lt;/p&gt;</comment>
                            <comment id="13554035" author="nehanarkhede" created="Tue, 15 Jan 2013 17:35:54 +0000"  >&lt;p&gt;+1 on the new patch, thanks Swapnil!&lt;/p&gt;</comment>
                            <comment id="13554046" author="nehanarkhede" created="Tue, 15 Jan 2013 17:46:45 +0000"  >&lt;p&gt;Committed patch to 0.8 branch&lt;/p&gt;</comment>
                            <comment id="13554048" author="junrao" created="Tue, 15 Jan 2013 17:47:36 +0000"  >&lt;p&gt;Thanks for the latest patch. Committed to 0.8 and merged to trunk.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12627643">KAFKA-704</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12564837" name="kafka-697-allow-dot.patch" size="5835" author="swapnilghike" created="Tue, 15 Jan 2013 01:38:35 +0000"/>
                            <attachment id="12564635" name="kafka-697.patch" size="975" author="junrao" created="Sun, 13 Jan 2013 21:51:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>304089</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 44 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i17jaf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>252094</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>