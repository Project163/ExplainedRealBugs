<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:34:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-111] A bug in the iterator of the ByteBufferMessageSet returns incorrect offsets when it encounters a compressed empty message set</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-111</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;The deep iterator logic in the ByteBufferMessageSet returns incorrect offsets when it encounters empty compressed data. Ideally, it should be able to decompress the data, figure out that it is somehow empty, skip it and proceed to decoding rest of the data. To make this possible, the manner in which we update the offset to be returned by the iterator, needs to be tweaked.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12519279">KAFKA-111</key>
            <summary>A bug in the iterator of the ByteBufferMessageSet returns incorrect offsets when it encounters a compressed empty message set</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nehanarkhede">Neha Narkhede</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Aug 2011 10:56:56 +0000</created>
                <updated>Tue, 13 Sep 2011 01:28:52 +0000</updated>
                            <resolved>Tue, 13 Sep 2011 01:28:52 +0000</resolved>
                                    <version>0.7</version>
                                    <fixVersion>0.7</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13086948" author="nehanarkhede" created="Thu, 18 Aug 2011 11:04:54 +0000"  >&lt;p&gt;This patch corrects the offset management in the deep iterator of the ByteBufferMessageSet, to handle the case of compressed empty message sets.&lt;/p&gt;</comment>
                            <comment id="13087078" author="junrao" created="Thu, 18 Aug 2011 16:01:37 +0000"  >&lt;p&gt;1. Please remove unreferenced imports before checking in.&lt;br/&gt;
2. The following unit test now hangs.&lt;br/&gt;
Test Starting: testCompression(kafka.consumer.ZookeeperConsumerConnectorTest)&lt;/p&gt;</comment>
                            <comment id="13087103" author="junrao" created="Thu, 18 Aug 2011 16:29:39 +0000"  >&lt;p&gt;The patch in kafka-108 also identifies this problem. The problem is that we need to set the new offset in 2 cases: (1) if the compressed unit is empty; (2) otherwise, the last message of the compressed unit is being iterated. This patches covers (1), but not (2). One solution is probably to use the code that we had before, but treat case (1) specially, i.e., we won&apos;t even create an inner iterator and just advance the offset.&lt;/p&gt;</comment>
                            <comment id="13087163" author="junrao" created="Thu, 18 Aug 2011 18:11:19 +0000"  >&lt;p&gt;How about patch v2? It currently breaks PrimitiveApiTest. However, the test probably should be fixed since it includes an empty message set.&lt;/p&gt;</comment>
                            <comment id="13087209" author="nehanarkhede" created="Thu, 18 Aug 2011 19:24:09 +0000"  >&lt;p&gt;Yes, looks like patch v2 is a better way of handling the above 2 cases. We should check what breaks with PrimitiveApiTest though, maybe just a test bug.&lt;/p&gt;</comment>
                            <comment id="13087223" author="junrao" created="Thu, 18 Aug 2011 19:51:46 +0000"  >&lt;p&gt;Patch v3. Fix test in kafka.javaapi.message.ByteBufferMessageSetTest.&lt;/p&gt;

&lt;p&gt;PrimitiveApiTest for javaapi still fails. However, it should pass after kafka-109 is fixed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12490784" name="KAFKA-111.patch" size="3155" author="nehanarkhede" created="Thu, 18 Aug 2011 11:04:54 +0000"/>
                            <attachment id="12490832" name="kafka-111.patch.v2" size="2568" author="junrao" created="Thu, 18 Aug 2011 18:11:19 +0000"/>
                            <attachment id="12490843" name="kafka-111.patch.v3" size="3238" author="junrao" created="Thu, 18 Aug 2011 19:51:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>60816</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i15yz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>242966</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>