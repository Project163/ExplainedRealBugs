<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:39:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-1041] Number of file handles increases indefinitely in producer if broker host is unresolvable</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-1041</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;We found a issue that if broker host is un resolvable, the number of file handle keep increasing for every message we produce and eventually it uses up all available files handles in operating system. If broker itself is not running and broker host name is resolvable, open file handles count stays flat.&lt;/p&gt;

&lt;p&gt;lsof output shows number of these open file handles continue to grow for every message we produce.&lt;/p&gt;

&lt;p&gt; java      19631    relango   81u     sock                0,6      0t0  196966526 can&apos;t identify protocol&lt;/p&gt;

&lt;p&gt;I can easily reproduce this with console producer,  If I run console producer with right hostname and if broker is not running, the console producer will exit after three tries. But If I run console producer with unresolvable broker, it throws below exception and continues to wait for user input, every time I enter new message, it opens socket and file handle count keeps increasing.. &lt;/p&gt;

&lt;p&gt;Here is Exception in producer&lt;/p&gt;

&lt;p&gt;ERROR fetching topic metadata for topics &lt;span class=&quot;error&quot;&gt;&amp;#91;Set(test-1378245487417)&amp;#93;&lt;/span&gt; from broker &lt;span class=&quot;error&quot;&gt;&amp;#91;ArrayBuffer(id:0,host:localhost1,port:6667)&amp;#93;&lt;/span&gt; failed (kafka.utils.Utils$)&lt;br/&gt;
kafka.common.KafkaException: fetching topic metadata for topics &lt;span class=&quot;error&quot;&gt;&amp;#91;Set(test-1378245487417)&amp;#93;&lt;/span&gt; from broker &lt;span class=&quot;error&quot;&gt;&amp;#91;ArrayBuffer(id:0,host:localhost1,port:6667)&amp;#93;&lt;/span&gt; failed&lt;br/&gt;
        at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:51)&lt;br/&gt;
        at kafka.producer.BrokerPartitionInfo.updateInfo(BrokerPartitionInfo.scala:82)&lt;br/&gt;
        at kafka.producer.async.DefaultEventHandler$$anonfun$handle$2.apply$mcV$sp(DefaultEventHandler.scala:79)&lt;br/&gt;
        at kafka.utils.Utils$.swallow(Utils.scala:186)&lt;br/&gt;
        at kafka.utils.Logging$class.swallowError(Logging.scala:105)&lt;br/&gt;
        at kafka.utils.Utils$.swallowError(Utils.scala:45)&lt;br/&gt;
        at kafka.producer.async.DefaultEventHandler.handle(DefaultEventHandler.scala:79)&lt;br/&gt;
        at kafka.producer.async.ProducerSendThread.tryToHandle(ProducerSendThread.scala:104)&lt;br/&gt;
        at kafka.producer.async.ProducerSendThread$$anonfun$processEvents$3.apply(ProducerSendThread.scala:87)&lt;br/&gt;
        at kafka.producer.async.ProducerSendThread$$anonfun$processEvents$3.apply(ProducerSendThread.scala:67)&lt;br/&gt;
        at scala.collection.immutable.Stream.foreach(Stream.scala:526)&lt;br/&gt;
        at kafka.producer.async.ProducerSendThread.processEvents(ProducerSendThread.scala:66)&lt;br/&gt;
        at kafka.producer.async.ProducerSendThread.run(ProducerSendThread.scala:44)&lt;br/&gt;
Caused by: java.nio.channels.UnresolvedAddressException&lt;br/&gt;
        at sun.nio.ch.Net.checkAddress(Net.java:30)&lt;br/&gt;
        at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:487)&lt;br/&gt;
        at kafka.network.BlockingChannel.connect(BlockingChannel.scala:59)&lt;br/&gt;
        at kafka.producer.SyncProducer.connect(SyncProducer.scala:151)&lt;br/&gt;
        at kafka.producer.SyncProducer.getOrMakeConnection(SyncProducer.scala:166)&lt;br/&gt;
        at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:73)&lt;br/&gt;
        at kafka.producer.SyncProducer.send(SyncProducer.scala:117)&lt;br/&gt;
        at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:37)&lt;br/&gt;
        ... 12 more&lt;/p&gt;
</description>
                <environment>*unix*</environment>
        <key id="12666893">KAFKA-1041</key>
            <summary>Number of file handles increases indefinitely in producer if broker host is unresolvable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="erajasekar">Rajasekar Elango</assignee>
                                    <reporter username="erajasekar">Rajasekar Elango</reporter>
                        <labels>
                            <label>features</label>
                            <label>newbie</label>
                    </labels>
                <created>Wed, 4 Sep 2013 14:43:27 +0000</created>
                <updated>Wed, 4 Feb 2015 16:22:50 +0000</updated>
                            <resolved>Fri, 28 Feb 2014 16:03:50 +0000</resolved>
                                    <version>0.8.0</version>
                                    <fixVersion>0.8.2.0</fixVersion>
                                    <component>producer </component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="13766541" author="junrao" created="Fri, 13 Sep 2013 15:18:23 +0000"  >&lt;p&gt;Moving to 0.8.1 since it&apos;s not very critical&lt;/p&gt;</comment>
                            <comment id="13914651" author="akhanzode" created="Thu, 27 Feb 2014 15:28:53 +0000"  >&lt;p&gt;Is this good enough for this?&lt;/p&gt;</comment>
                            <comment id="13914733" author="junrao" created="Thu, 27 Feb 2014 17:03:20 +0000"  >&lt;p&gt;Thanks for the patch. Some comments.&lt;/p&gt;

&lt;p&gt;1. We probably should catch all throwables.&lt;br/&gt;
2. We can probably just call disconnect() when we hit an exception.&lt;/p&gt;</comment>
                            <comment id="13915861" author="akhanzode" created="Fri, 28 Feb 2014 15:21:24 +0000"  >&lt;p&gt;Here is the updated patch for 0.8&lt;br/&gt;
Thanks for looking into it.&lt;/p&gt;</comment>
                            <comment id="13915921" author="junrao" created="Fri, 28 Feb 2014 16:03:50 +0000"  >&lt;p&gt;Thanks for patch v2. +1 and committed to trunk.&lt;/p&gt;</comment>
                            <comment id="13916100" author="akhanzode" created="Fri, 28 Feb 2014 17:58:35 +0000"  >&lt;p&gt;Is 0.8.1 released? Can I get this applied on a released stable branch?&lt;/p&gt;</comment>
                            <comment id="13916116" author="junrao" created="Fri, 28 Feb 2014 18:09:05 +0000"  >&lt;p&gt;0.8.1 is being voted now.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12683218">SAMZA-101</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12631759" name="KAFKA-1041-patch.diff" size="2788" author="akhanzode" created="Fri, 28 Feb 2014 15:21:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>346830</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 38 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1nt27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>347130</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>