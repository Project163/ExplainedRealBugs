<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:55:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-3916] Connection from controller to broker disconnects</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-3916</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;We recently upgraded from 0.8.2.1 to 0.9.0.1. Since then, several times per day, the controllers in our clusters have their connection to all brokers disconnected, and then successfully reconnected a few hundred ms later. Each time this occurs we see a brief spike in our 99th percentile produce and consume times, reaching several hundred ms.&lt;/p&gt;

&lt;p&gt;Here is an example of what we&apos;re seeing in the controller.log:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[2016-06-28 14:15:35,416] WARN [Controller-151-to-broker-160-send-thread], Controller 151 epoch 106 fails to send request {&#8230;} to broker Node(160, broker.160.hostname, 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 160 was disconnected before the response was read
        at kafka.utils.NetworkClientBlockingOps$$anonfun$blockingSendAndReceive$extension$1$$anonfun$apply$1.apply(NetworkClientBlockingOps.scala:87)
        at kafka.utils.NetworkClientBlockingOps$$anonfun$blockingSendAndReceive$extension$1$$anonfun$apply$1.apply(NetworkClientBlockingOps.scala:84)
        at scala.Option.foreach(Option.scala:236)
        at kafka.utils.NetworkClientBlockingOps$$anonfun$blockingSendAndReceive$extension$1.apply(NetworkClientBlockingOps.scala:84)
        at kafka.utils.NetworkClientBlockingOps$$anonfun$blockingSendAndReceive$extension$1.apply(NetworkClientBlockingOps.scala:80)
        at kafka.utils.NetworkClientBlockingOps$.recurse$1(NetworkClientBlockingOps.scala:129)
        at kafka.utils.NetworkClientBlockingOps$.kafka$utils$NetworkClientBlockingOps$$pollUntilFound$extension(NetworkClientBlockingOps.scala:139)
        at kafka.utils.NetworkClientBlockingOps$.blockingSendAndReceive$extension(NetworkClientBlockingOps.scala:80)
        at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:180)
        at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:171)
        at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:63)

... one each &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all brokers (including the controller) ...

 [2016-06-28 14:15:35,721] INFO [Controller-151-to-broker-160-send-thread], Controller 151 connected to Node(160, broker.160.hostname, 9092) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; sending state change requests (kafka.controller.RequestSendThread)

&#8230; one each &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all brokers (including the controller) ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12984498">KAFKA-3916</key>
            <summary>Connection from controller to broker disconnects</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hachikuji">Jason Gustafson</assignee>
                                    <reporter username="poweld">Dave Powell</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Jun 2016 21:17:50 +0000</created>
                <updated>Sat, 26 Aug 2017 20:36:37 +0000</updated>
                            <resolved>Tue, 23 Aug 2016 02:22:03 +0000</resolved>
                                    <version>0.9.0.1</version>
                                    <fixVersion>0.10.1.0</fixVersion>
                                    <component>controller</component>
                        <due></due>
                            <votes>11</votes>
                                    <watches>23</watches>
                                                                                                                <comments>
                            <comment id="15389188" author="akonyaev" created="Fri, 22 Jul 2016 09:08:43 +0000"  >&lt;p&gt;I have this problem with 0.10 vers.&lt;/p&gt;
</comment>
                            <comment id="15406027" author="turek@avast.com" created="Wed, 3 Aug 2016 14:57:24 +0000"  >&lt;p&gt;We saw this issue yesterday, I don&apos;t know if this helps, but it may be useful while debugging.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Kafka 0.9.0.1 and 0.9.0.1 clients.&lt;/li&gt;
	&lt;li&gt;There is ISR shrink and immediate ISR expand visible in graphs based on JMX of Kafka brokers.&lt;/li&gt;
	&lt;li&gt;Consumers were unable to commit offsets at that time.&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2016-08-02 14:25:29.589 INFO  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-7]: Offset commit for group ... failed due to REQUEST_TIMED_OUT, will find new coordinator and retry
2016-08-02 14:25:52.560 INFO  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-2]: Offset commit for group ... failed due to REQUEST_TIMED_OUT, will find new coordinator and retry
2016-08-02 14:25:52.562 INFO  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-0]: Offset commit for group ... failed due to REQUEST_TIMED_OUT, will find new coordinator and retry
2016-08-02 14:25:52.563 INFO  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-5]: Offset commit for group ... failed due to REQUEST_TIMED_OUT, will find new coordinator and retry
2016-08-02 14:25:52.570 INFO  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-6]: Offset commit for group ... failed due to REQUEST_TIMED_OUT, will find new coordinator and retry
2016-08-02 14:25:52.570 INFO  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-3]: Offset commit for group ... failed due to REQUEST_TIMED_OUT, will find new coordinator and retry
2016-08-02 14:25:52.570 INFO  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-4]: Offset commit for group ... failed due to REQUEST_TIMED_OUT, will find new coordinator and retry
2016-08-02 14:25:52.572 INFO  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-1]: Offset commit for group ... failed due to REQUEST_TIMED_OUT, will find new coordinator and retry
2016-08-02 14:25:52.572 INFO  o.a.k.c.c.internals.AbstractCoordinator       [Consumer-7]: Marking the coordinator 2147483646 dead.
2016-08-02 14:25:52.573 INFO  o.a.k.c.c.internals.AbstractCoordinator       [Consumer-2]: Marking the coordinator 2147483646 dead.
2016-08-02 14:25:52.573 INFO  o.a.k.c.c.internals.AbstractCoordinator       [Consumer-0]: Marking the coordinator 2147483646 dead.
2016-08-02 14:25:52.574 INFO  o.a.k.c.c.internals.AbstractCoordinator       [Consumer-5]: Marking the coordinator 2147483646 dead.
2016-08-02 14:25:52.575 INFO  o.a.k.c.c.internals.AbstractCoordinator       [Consumer-6]: Marking the coordinator 2147483646 dead.
2016-08-02 14:25:52.575 INFO  o.a.k.c.c.internals.AbstractCoordinator       [Consumer-3]: Marking the coordinator 2147483646 dead.
2016-08-02 14:25:52.575 INFO  o.a.k.c.c.internals.AbstractCoordinator       [Consumer-4]: Marking the coordinator 2147483646 dead.
2016-08-02 14:25:52.576 INFO  o.a.k.c.c.internals.AbstractCoordinator       [Consumer-1]: Marking the coordinator 2147483646 dead.
2016-08-02 14:25:52.576 WARN  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-7]: Auto offset commit failed: The request timed out.
2016-08-02 14:25:52.577 WARN  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-2]: Auto offset commit failed: The request timed out.
2016-08-02 14:25:52.577 WARN  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-0]: Auto offset commit failed: The request timed out.
2016-08-02 14:25:52.577 WARN  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-5]: Auto offset commit failed: The request timed out.
2016-08-02 14:25:52.578 WARN  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-6]: Auto offset commit failed: The request timed out.
2016-08-02 14:25:52.578 WARN  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-3]: Auto offset commit failed: The request timed out.
2016-08-02 14:25:52.578 WARN  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-4]: Auto offset commit failed: The request timed out.
2016-08-02 14:25:52.579 WARN  o.a.k.c.c.internals.ConsumerCoordinator       [Consumer-1]: Auto offset commit failed: The request timed out.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15416682" author="turek@avast.com" created="Thu, 11 Aug 2016 07:13:37 +0000"  >&lt;p&gt;Production of messages was failing for few seconds this time. I found no issue in logs of consumers. Exceptions in controller.log are the same as in description. Multiple ISR shrinks and expands happened during 6:30 pm to 9:30 pm based on our monitoring and graphs, then the issue disappeared.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2016-08-10 20:01:40.611 WARN  (application class)  [kafka-producer-network-thread | (consumer group)]: Write to Kafka failed: (topic), org.apache.kafka.common.errors.TimeoutException: Batch Expired
2016-08-10 20:01:40.683 WARN  (application class)  [kafka-producer-network-thread | (consumer group)]: Write to Kafka failed: (topic), org.apache.kafka.common.errors.TimeoutException: Batch Expired
...
2016-08-10 20:01:43.714 WARN  (application class)  [kafka-producer-network-thread | (consumer group)]: Write to Kafka failed: (topic), org.apache.kafka.common.errors.TimeoutException: Batch Expired
2016-08-10 20:01:43.714 WARN  (application class)  [kafka-producer-network-thread | (consumer group)]: Write to Kafka failed: (topic), org.apache.kafka.common.errors.TimeoutException: Batch Expired
2016-08-10 20:01:43.838 WARN  o.a.kafka.clients.producer.internals.Sender   [kafka-producer-network-thread | (consumer group)]: Got error produce response with correlation id 113676841 on topic-partition (topic)-3, retrying (0 attempts left). Error: NETWORK_EXCEPTION
2016-08-10 20:01:43.840 WARN  o.a.kafka.clients.producer.internals.Sender   [kafka-producer-network-thread | (consumer group)]: Got error produce response with correlation id 113676841 on topic-partition (topic)-0, retrying (0 attempts left). Error: NETWORK_EXCEPTION
2016-08-10 20:01:43.840 WARN  o.a.kafka.clients.producer.internals.Sender   [kafka-producer-network-thread | (consumer group)]: Got error produce response with correlation id 113676841 on topic-partition (topic)-0, retrying (0 attempts left). Error: NETWORK_EXCEPTION
2016-08-10 20:01:43.840 WARN  o.a.kafka.clients.producer.internals.Sender   [kafka-producer-network-thread | (consumer group)]: Got error produce response with correlation id 113676841 on topic-partition (topic)-8, retrying (0 attempts left). Error: NETWORK_EXCEPTION
2016-08-10 20:01:43.841 WARN  o.a.kafka.clients.producer.internals.Sender   [kafka-producer-network-thread | (consumer group)]: Got error produce response with correlation id 113676841 on topic-partition (topic)-4, retrying (0 attempts left). Error: NETWORK_EXCEPTION
2016-08-10 20:01:43.841 WARN  o.a.kafka.clients.producer.internals.Sender   [kafka-producer-network-thread | (consumer group)]: Got error produce response with correlation id 113676841 on topic-partition (topic)-0, retrying (0 attempts left). Error: NETWORK_EXCEPTION
2016-08-10 20:01:43.841 WARN  o.a.kafka.clients.producer.internals.Sender   [kafka-producer-network-thread | (consumer group)]: Got error produce response with correlation id 113676841 on topic-partition (topic)-10, retrying (0 attempts left). Error: NETWORK_EXCEPTION
2016-08-10 20:01:43.842 WARN  o.a.kafka.clients.producer.internals.Sender   [kafka-producer-network-thread | (consumer group)]: Got error produce response with correlation id 113676841 on topic-partition (topic)-0, retrying (0 attempts left). Error: NETWORK_EXCEPTION
2016-08-10 20:01:43.842 WARN  o.a.kafka.clients.producer.internals.Sender   [kafka-producer-network-thread | (consumer group)]: Got error produce response with correlation id 113676841 on topic-partition (topic)-6, retrying (0 attempts left). Error: NETWORK_EXCEPTION
2016-08-10 20:01:43.842 WARN  o.a.kafka.clients.producer.internals.Sender   [kafka-producer-network-thread | (consumer group)]: Got error produce response with correlation id 113676841 on topic-partition (topic)-6, retrying (0 attempts left). Error: NETWORK_EXCEPTION
2016-08-10 20:01:43.919 WARN  (application class)  [kafka-producer-network-thread | (consumer group)]: Write to Kafka failed: (topic), org.apache.kafka.common.errors.TimeoutException: Batch Expired
2016-08-10 20:01:43.920 WARN  (application class)  [kafka-producer-network-thread | (consumer group)]: Write to Kafka failed: (topic), org.apache.kafka.common.errors.TimeoutException: Batch Expired
...
2016-08-10 20:01:43.971 WARN  (application class)  [kafka-producer-network-thread | (consumer group)]: Write to Kafka failed: (topic), org.apache.kafka.common.errors.TimeoutException: Batch Expired
2016-08-10 20:01:43.972 WARN  (application class)  [kafka-producer-network-thread | (consumer group)]: Write to Kafka failed: (topic), org.apache.kafka.common.errors.TimeoutException: Batch Expired
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15417813" author="hachikuji" created="Thu, 11 Aug 2016 19:40:26 +0000"  >&lt;p&gt;Could we be hitting the idle connection timeout? The default setting for &lt;tt&gt;connections.max.idle.ms&lt;/tt&gt; is 10 minutes. When the cluster is stable, I&apos;m not sure there&apos;s much traffic from the controller, so we may proactively disconnect the connection. Perhaps someone can try increasing it?&lt;/p&gt;</comment>
                            <comment id="15418477" author="turek@avast.com" created="Fri, 12 Aug 2016 07:42:34 +0000"  >&lt;p&gt;Hi Jason and others,&lt;/p&gt;

&lt;p&gt;I have finally found the root cause for our case. I was grep-ing the controller logs for a while to hide disturbing stack traces and noticed that all warnings from last month always mention the same topic, which is quite strange because we have about 50 of them total. This one is the largest one, with the highest throughput, but not strongly larger than others. Time stamps of the warnings are also from the afternoon or early evening when Kafka receives the highest traffic, so I believe the issue is somehow related to performance. There is also always leader=2, ISR changes between &lt;span class=&quot;error&quot;&gt;&amp;#91;1,2&amp;#93;&lt;/span&gt; and &lt;span class=&quot;error&quot;&gt;&amp;#91;1,2,3&amp;#93;&lt;/span&gt;, related partitions are always 2, 7, 11.&lt;/p&gt;

&lt;p&gt;While working on a completely different task yesterday, I also by coincidence found that consumption speed of events buffered in Kafka for this topic reached its limits, other topics were ok. Producers were only little slower than consumers. So we are trying to add few more partitions to increase parallelism both in consumers and internally in Kafka (replication). I guess it will help.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;# egrep &apos;WARN|IOException&apos; controller.log | less -S

[2016-08-10 19:00:14,502] WARN [Controller-1-to-broker-1-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=2,controller_epoch=18,leader=2,leader_epoch=26,isr=[1,2,3],zk_version=145,replicas=[2,3,1]},{topic=(always same topic),partition=11,controller_epoch=18,leader=2,leader_epoch=23,isr=[1,2,3],zk_version=120,replicas=[2,1,3]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(1, (host1), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
[2016-08-10 19:00:14,506] WARN [Controller-1-to-broker-4-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=2,controller_epoch=18,leader=2,leader_epoch=26,isr=[1,2,3],zk_version=145,replicas=[2,3,1]},{topic=(always same topic),partition=11,controller_epoch=18,leader=2,leader_epoch=23,isr=[1,2,3],zk_version=120,replicas=[2,1,3]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(4, (host4), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 4 was disconnected before the response was read
[2016-08-10 19:00:14,506] WARN [Controller-1-to-broker-2-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=2,controller_epoch=18,leader=2,leader_epoch=26,isr=[1,2,3],zk_version=145,replicas=[2,3,1]},{topic=(always same topic),partition=11,controller_epoch=18,leader=2,leader_epoch=23,isr=[1,2,3],zk_version=120,replicas=[2,1,3]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(2, (host2), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
[2016-08-10 19:00:14,502] WARN [Controller-1-to-broker-3-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=2,controller_epoch=18,leader=2,leader_epoch=26,isr=[1,2,3],zk_version=145,replicas=[2,3,1]},{topic=(always same topic),partition=11,controller_epoch=18,leader=2,leader_epoch=23,isr=[1,2,3],zk_version=120,replicas=[2,1,3]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(3, (host3), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 3 was disconnected before the response was read
[2016-08-10 19:50:41,999] WARN [Controller-1-to-broker-1-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=11,controller_epoch=18,leader=2,leader_epoch=23,isr=[1,2],zk_version=129,replicas=[2,1,3]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(1, (host1), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
[2016-08-10 19:50:42,002] WARN [Controller-1-to-broker-3-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=11,controller_epoch=18,leader=2,leader_epoch=23,isr=[1,2],zk_version=129,replicas=[2,1,3]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(3, (host3), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 3 was disconnected before the response was read
[2016-08-10 19:50:42,002] WARN [Controller-1-to-broker-4-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=11,controller_epoch=18,leader=2,leader_epoch=23,isr=[1,2],zk_version=129,replicas=[2,1,3]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(4, (host4), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 4 was disconnected before the response was read
[2016-08-10 19:50:42,002] WARN [Controller-1-to-broker-2-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=11,controller_epoch=18,leader=2,leader_epoch=23,isr=[1,2],zk_version=129,replicas=[2,1,3]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(2, (host2), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
[2016-08-10 20:10:12,044] WARN [Controller-1-to-broker-2-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=7,controller_epoch=18,leader=2,leader_epoch=26,isr=[1,2],zk_version=136,replicas=[2,3,1]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(2, (host2), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
[2016-08-10 20:10:12,044] WARN [Controller-1-to-broker-1-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=7,controller_epoch=18,leader=2,leader_epoch=26,isr=[1,2],zk_version=136,replicas=[2,3,1]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(1, (host1), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
[2016-08-10 20:10:12,044] WARN [Controller-1-to-broker-3-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=7,controller_epoch=18,leader=2,leader_epoch=26,isr=[1,2],zk_version=136,replicas=[2,3,1]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(3, (host3), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 3 was disconnected before the response was read
[2016-08-10 20:10:12,044] WARN [Controller-1-to-broker-4-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=7,controller_epoch=18,leader=2,leader_epoch=26,isr=[1,2],zk_version=136,replicas=[2,3,1]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(4, (host4), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 4 was disconnected before the response was read
[2016-08-10 21:04:11,998] WARN [Controller-1-to-broker-1-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=2,controller_epoch=18,leader=2,leader_epoch=26,isr=[1,2],zk_version=168,replicas=[2,3,1]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(1, (host1), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
[2016-08-10 21:04:12,001] WARN [Controller-1-to-broker-4-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=2,controller_epoch=18,leader=2,leader_epoch=26,isr=[1,2],zk_version=168,replicas=[2,3,1]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(4, (host4), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 4 was disconnected before the response was read
[2016-08-10 21:04:11,998] WARN [Controller-1-to-broker-2-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=2,controller_epoch=18,leader=2,leader_epoch=26,isr=[1,2],zk_version=168,replicas=[2,3,1]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(2, (host2), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
[2016-08-10 21:04:11,998] WARN [Controller-1-to-broker-3-send-thread], Controller 1 epoch 20 fails to send request {controller_id=1,controller_epoch=20,partition_states=[{topic=(always same topic),partition=2,controller_epoch=18,leader=2,leader_epoch=26,isr=[1,2],zk_version=168,replicas=[2,3,1]}],live_brokers=[{id=1,end_points=[{port=9092,host=(host1),security_protocol_type=0}]},{id=2,end_points=[{port=9092,host=(host2),security_protocol_type=0}]},{id=3,end_points=[{port=9092,host=(host3),security_protocol_type=0}]},{id=4,end_points=[{port=9092,host=(host4),security_protocol_type=0}]}]} to broker Node(3, (host3), 9092). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 3 was disconnected before the response was read
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15420154" author="githubbot" created="Sun, 14 Aug 2016 01:22:50 +0000"  >&lt;p&gt;GitHub user hachikuji opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1734&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1734&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3916&quot; title=&quot;Connection from controller to broker disconnects&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3916&quot;&gt;&lt;del&gt;KAFKA-3916&lt;/del&gt;&lt;/a&gt;: Check for disconnects properly before sending from the controller&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/hachikuji/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/hachikuji/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3916&quot; title=&quot;Connection from controller to broker disconnects&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3916&quot;&gt;&lt;del&gt;KAFKA-3916&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1734.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1734.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1734&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 1cc38623c047128d9c83309c66f37491726c8082&lt;br/&gt;
Author: Jason Gustafson &amp;lt;jason@confluent.io&amp;gt;&lt;br/&gt;
Date:   2016-08-12T00:40:32Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3916&quot; title=&quot;Connection from controller to broker disconnects&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3916&quot;&gt;&lt;del&gt;KAFKA-3916&lt;/del&gt;&lt;/a&gt;: Check for disconnects properly before sending from the controller&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15432003" author="ijuma" created="Tue, 23 Aug 2016 02:22:04 +0000"  >&lt;p&gt;Issue resolved by pull request 1734&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/1734&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1734&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15432004" author="githubbot" created="Tue, 23 Aug 2016 02:22:15 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1734&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1734&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16142922" author="void.aman93" created="Sat, 26 Aug 2017 20:30:01 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
 I am using Kafka version 0.10.0.2 in the production environment. I am facing issues in my kafka broker and consumer machines which is very similar to issue described here.&lt;br/&gt;
Controller logs are very similar to the one described above:&lt;/p&gt;



&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;|WARN [2017-08-26 19:19:27,204] [Controller-6-to-broker-5-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-5-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-1,partition=0,controller_epoch=34,leader=3,leader_epoch=0,isr=[3,4,5],zk_version=0,replicas=[3,4,5]}],live_leaders=[{id=3,host=host-1,port=9092}]} to broker host-2:9092 (id: 5 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 19:19:27,204] [Controller-6-to-broker-4-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-4-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-1,partition=0,controller_epoch=34,leader=3,leader_epoch=0,isr=[3,4,5],zk_version=0,replicas=[3,4,5]}],live_leaders=[{id=3,host=host-1,port=9092}]} to broker host-3:9092 (id: 4 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 19:19:27,204] [Controller-6-to-broker-2-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-2-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-1,partition=0,controller_epoch=34,leader=3,leader_epoch=0,isr=[3,4,5],zk_version=0,replicas=[3,4,5]},{topic=topic-4,partition=0,controller_epoch=34,leader=-2,leader_epoch=0,isr=[],zk_version=0,replicas=[0]}],live_brokers=[{id=5,end_points=[{port=9092,host=host-2,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=1,end_points=[{port=9092,host=host-4,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=4,end_points=[{port=9092,host=host-3,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=6,end_points=[{port=9092,host=host-6,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=2,end_points=[{port=9092,host=host-5,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=3,end_points=[{port=9092,host=host-1,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]} to broker host-5:9092 (id: 2 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 19:19:27,205] [Controller-6-to-broker-3-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-3-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-1,partition=0,controller_epoch=34,leader=3,leader_epoch=0,isr=[3,4,5],zk_version=0,replicas=[3,4,5]}],live_leaders=[{id=3,host=host-1,port=9092}]} to broker host-1:9092 (id: 3 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 19:19:27,205] [Controller-6-to-broker-1-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-1-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-1,partition=0,controller_epoch=34,leader=3,leader_epoch=0,isr=[3,4,5],zk_version=0,replicas=[3,4,5]},{topic=topic-4,partition=0,controller_epoch=34,leader=-2,leader_epoch=0,isr=[],zk_version=0,replicas=[0]}],live_brokers=[{id=2,end_points=[{port=9092,host=host-5,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=6,end_points=[{port=9092,host=host-6,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=5,end_points=[{port=9092,host=host-2,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=3,end_points=[{port=9092,host=host-1,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=1,end_points=[{port=9092,host=host-4,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=4,end_points=[{port=9092,host=host-3,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]} to broker host-4:9092 (id: 1 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 19:19:27,205] [Controller-6-to-broker-6-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-6-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-1,partition=0,controller_epoch=34,leader=3,leader_epoch=0,isr=[3,4,5],zk_version=0,replicas=[3,4,5]},{topic=topic-4,partition=0,controller_epoch=34,leader=-2,leader_epoch=0,isr=[],zk_version=0,replicas=[0]}],live_brokers=[{id=5,end_points=[{port=9092,host=host-2,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=6,end_points=[{port=9092,host=host-6,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=2,end_points=[{port=9092,host=host-5,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=3,end_points=[{port=9092,host=host-1,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=4,end_points=[{port=9092,host=host-3,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=1,end_points=[{port=9092,host=host-4,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]} to broker host-6:9092 (id: 6 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 20:46:41,009] [Controller-6-to-broker-2-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-2-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-2.2604144,partition=0,controller_epoch=34,leader=1,leader_epoch=0,isr=[1,2,3],zk_version=0,replicas=[1,2,3]}],live_leaders=[{id=1,host=host-4,port=9092}]} to broker host-5:9092 (id: 2 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 20:46:41,009] [Controller-6-to-broker-3-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-3-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-2.2604144,partition=0,controller_epoch=34,leader=1,leader_epoch=0,isr=[1,2,3],zk_version=0,replicas=[1,2,3]}],live_leaders=[{id=1,host=host-4,port=9092}]} to broker host-1:9092 (id: 3 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 20:46:41,009] [Controller-6-to-broker-4-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-4-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-2.2604144,partition=0,controller_epoch=34,leader=1,leader_epoch=0,isr=[1,2,3],zk_version=0,replicas=[1,2,3]},{topic=topic-4,partition=0,controller_epoch=34,leader=-2,leader_epoch=0,isr=[],zk_version=0,replicas=[0]}],live_brokers=[{id=4,end_points=[{port=9092,host=host-3,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=3,end_points=[{port=9092,host=host-1,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=5,end_points=[{port=9092,host=host-2,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=6,end_points=[{port=9092,host=host-6,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=1,end_points=[{port=9092,host=host-4,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=2,end_points=[{port=9092,host=host-5,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]} to broker host-3:9092 (id: 4 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 20:46:41,009] [Controller-6-to-broker-5-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-5-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-2.2604144,partition=0,controller_epoch=34,leader=1,leader_epoch=0,isr=[1,2,3],zk_version=0,replicas=[1,2,3]},{topic=topic-4,partition=0,controller_epoch=34,leader=-2,leader_epoch=0,isr=[],zk_version=0,replicas=[0]}],live_brokers=[{id=4,end_points=[{port=9092,host=host-3,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=6,end_points=[{port=9092,host=host-6,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=3,end_points=[{port=9092,host=host-1,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=1,end_points=[{port=9092,host=host-4,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=2,end_points=[{port=9092,host=host-5,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=5,end_points=[{port=9092,host=host-2,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]} to broker host-2:9092 (id: 5 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 20:46:41,010] [Controller-6-to-broker-6-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-6-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-2.2604144,partition=0,controller_epoch=34,leader=1,leader_epoch=0,isr=[1,2,3],zk_version=0,replicas=[1,2,3]},{topic=topic-4,partition=0,controller_epoch=34,leader=-2,leader_epoch=0,isr=[],zk_version=0,replicas=[0]}],live_brokers=[{id=3,end_points=[{port=9092,host=host-1,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=4,end_points=[{port=9092,host=host-3,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=2,end_points=[{port=9092,host=host-5,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=6,end_points=[{port=9092,host=host-6,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=5,end_points=[{port=9092,host=host-2,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=1,end_points=[{port=9092,host=host-4,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]} to broker host-6:9092 (id: 6 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 20:46:41,009] [Controller-6-to-broker-1-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-1-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-2.2604144,partition=0,controller_epoch=34,leader=1,leader_epoch=0,isr=[1,2,3],zk_version=0,replicas=[1,2,3]}],live_leaders=[{id=1,host=host-4,port=9092}]} to broker host-4:9092 (id: 1 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 23:44:28,288] [Controller-6-to-broker-2-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-2-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-3,partition=0,controller_epoch=34,leader=3,leader_epoch=0,isr=[3,1,2],zk_version=0,replicas=[3,1,2]}],live_leaders=[{id=3,host=host-1,port=9092}]} to broker host-5:9092 (id: 2 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 23:44:28,288] [Controller-6-to-broker-1-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-1-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-3,partition=0,controller_epoch=34,leader=3,leader_epoch=0,isr=[3,1,2],zk_version=0,replicas=[3,1,2]}],live_leaders=[{id=3,host=host-1,port=9092}]} to broker host-4:9092 (id: 1 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 23:44:28,288] [Controller-6-to-broker-3-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-3-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-3,partition=0,controller_epoch=34,leader=3,leader_epoch=0,isr=[3,1,2],zk_version=0,replicas=[3,1,2]}],live_leaders=[{id=3,host=host-1,port=9092}]} to broker host-1:9092 (id: 3 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 23:44:28,288] [Controller-6-to-broker-5-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-5-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-3,partition=0,controller_epoch=34,leader=3,leader_epoch=0,isr=[3,1,2],zk_version=0,replicas=[3,1,2]},{topic=topic-4,partition=0,controller_epoch=34,leader=-2,leader_epoch=0,isr=[],zk_version=0,replicas=[0]}],live_brokers=[{id=3,end_points=[{port=9092,host=host-1,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=5,end_points=[{port=9092,host=host-2,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=4,end_points=[{port=9092,host=host-3,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=1,end_points=[{port=9092,host=host-4,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=6,end_points=[{port=9092,host=host-6,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=2,end_points=[{port=9092,host=host-5,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]} to broker host-2:9092 (id: 5 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 23:44:28,289] [Controller-6-to-broker-4-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-4-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-3,partition=0,controller_epoch=34,leader=3,leader_epoch=0,isr=[3,1,2],zk_version=0,replicas=[3,1,2]},{topic=topic-4,partition=0,controller_epoch=34,leader=-2,leader_epoch=0,isr=[],zk_version=0,replicas=[0]}],live_brokers=[{id=1,end_points=[{port=9092,host=host-4,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=6,end_points=[{port=9092,host=host-6,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=2,end_points=[{port=9092,host=host-5,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=3,end_points=[{port=9092,host=host-1,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=5,end_points=[{port=9092,host=host-2,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=4,end_points=[{port=9092,host=host-3,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]} to broker host-3:9092 (id: 4 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-26 23:44:28,289] [Controller-6-to-broker-6-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-6-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-3,partition=0,controller_epoch=34,leader=3,leader_epoch=0,isr=[3,1,2],zk_version=0,replicas=[3,1,2]},{topic=topic-4,partition=0,controller_epoch=34,leader=-2,leader_epoch=0,isr=[],zk_version=0,replicas=[0]}],live_brokers=[{id=2,end_points=[{port=9092,host=host-5,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=1,end_points=[{port=9092,host=host-4,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=6,end_points=[{port=9092,host=host-6,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=4,end_points=[{port=9092,host=host-3,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=5,end_points=[{port=9092,host=host-2,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=3,end_points=[{port=9092,host=host-1,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]} to broker host-6:9092 (id: 6 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-27 00:10:59,050] [Controller-6-to-broker-6-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-6-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-2.2606546,partition=0,controller_epoch=34,leader=2,leader_epoch=0,isr=[2,5,6],zk_version=0,replicas=[2,5,6]}],live_leaders=[{id=2,host=host-5,port=9092}]} to broker host-6:9092 (id: 6 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-27 00:10:59,050] [Controller-6-to-broker-2-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-2-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-2.2606546,partition=0,controller_epoch=34,leader=2,leader_epoch=0,isr=[2,5,6],zk_version=0,replicas=[2,5,6]}],live_leaders=[{id=2,host=host-5,port=9092}]} to broker host-5:9092 (id: 2 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-27 00:10:59,059] [Controller-6-to-broker-4-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-4-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-2.2606546,partition=0,controller_epoch=34,leader=2,leader_epoch=0,isr=[2,5,6],zk_version=0,replicas=[2,5,6]},{topic=topic-4,partition=0,controller_epoch=34,leader=-2,leader_epoch=0,isr=[],zk_version=0,replicas=[0]}],live_brokers=[{id=6,end_points=[{port=9092,host=host-6,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=3,end_points=[{port=9092,host=host-1,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=4,end_points=[{port=9092,host=host-3,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=2,end_points=[{port=9092,host=host-5,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=1,end_points=[{port=9092,host=host-4,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=5,end_points=[{port=9092,host=host-2,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]} to broker host-3:9092 (id: 4 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-27 00:10:59,059] [Controller-6-to-broker-3-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-3-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-2.2606546,partition=0,controller_epoch=34,leader=2,leader_epoch=0,isr=[2,5,6],zk_version=0,replicas=[2,5,6]},{topic=topic-4,partition=0,controller_epoch=34,leader=-2,leader_epoch=0,isr=[],zk_version=0,replicas=[0]}],live_brokers=[{id=2,end_points=[{port=9092,host=host-5,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=3,end_points=[{port=9092,host=host-1,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=4,end_points=[{port=9092,host=host-3,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=5,end_points=[{port=9092,host=host-2,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=6,end_points=[{port=9092,host=host-6,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=1,end_points=[{port=9092,host=host-4,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]} to broker host-1:9092 (id: 3 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-27 00:10:59,060] [Controller-6-to-broker-5-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-5-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-2.2606546,partition=0,controller_epoch=34,leader=2,leader_epoch=0,isr=[2,5,6],zk_version=0,replicas=[2,5,6]}],live_leaders=[{id=2,host=host-5,port=9092}]} to broker host-2:9092 (id: 5 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
 WARN [2017-08-27 00:10:59,059] [Controller-6-to-broker-1-send-thread][] kafka.controller.RequestSendThread - [Controller-6-to-broker-1-send-thread], Controller 6 epoch 34 fails to send request {controller_id=6,controller_epoch=34,partition_states=[{topic=topic-2.2606546,partition=0,controller_epoch=34,leader=2,leader_epoch=0,isr=[2,5,6],zk_version=0,replicas=[2,5,6]},{topic=topic-4,partition=0,controller_epoch=34,leader=-2,leader_epoch=0,isr=[],zk_version=0,replicas=[0]}],live_brokers=[{id=5,end_points=[{port=9092,host=host-2,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=6,end_points=[{port=9092,host=host-6,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=2,end_points=[{port=9092,host=host-5,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=1,end_points=[{port=9092,host=host-4,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=3,end_points=[{port=9092,host=host-1,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{id=4,end_points=[{port=9092,host=host-3,security_protocol_type=0}],rack=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]} to broker host-4:9092 (id: 1 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;). Reconnecting to broker.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;



&lt;p&gt;Consumer error log:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
|2017-08-26 23:47:54,738 WARN [kafka-producer-network-thread | producer-8] o.a.k.c.p.i.Sender [kafka-producer-network-thread | (consumer group)] Got error produce response with correlation id 10322 on topic-partition topic-0, retrying (9 attempts left). Error: NETWORK_EXCEPTION
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;



&lt;p&gt;I am having 5000 topics right now with a retention period of 1 hour. The maximum size of data during peak load is 3-4 GB in a machine and I am having 6 kafka broker machines of 6 core and 16 GB RAM.&lt;br/&gt;
Can someone please point out if there&apos;s something wrong in my approach? Do I need to update to latest version?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 12 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30a1z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>