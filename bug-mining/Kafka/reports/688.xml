<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:43:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-2101] Metric metadata-age is reset on a failed update</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-2101</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;In org.apache.kafka.clients.Metadata there is a lastUpdate() method that returns the time the metadata was lasted updated. This is only called by metadata-age metric. &lt;/p&gt;

&lt;p&gt;However the lastRefreshMs is updated on a failed update (when MetadataResponse has not valid nodes). This is confusing since the metric&apos;s name suggests that it is a true reflection of the age of the current metadata. But the age might be reset by a failed update. &lt;/p&gt;

&lt;p&gt;Additionally, lastRefreshMs is not reset on a failed update due to no node being available. This seems slightly inconsistent, since one failure condition resets the metrics, but another one does not. Especially since both failure conditions do trigger the backoff (for the next attempt).&lt;/p&gt;

&lt;p&gt;I have not implemented a patch yet, because I am unsure what expected behavior is.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12819071">KAFKA-2101</key>
            <summary>Metric metadata-age is reset on a failed update</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="timbrooks">Tim Brooks</assignee>
                                    <reporter username="timbrooks">Tim Brooks</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Apr 2015 21:04:39 +0000</created>
                <updated>Tue, 16 Jun 2015 00:44:28 +0000</updated>
                            <resolved>Tue, 16 Jun 2015 00:44:28 +0000</resolved>
                                                    <fixVersion>0.9.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14513318" author="nehanarkhede" created="Sun, 26 Apr 2015 22:48:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=timbrooks&quot; class=&quot;user-hover&quot; rel=&quot;timbrooks&quot;&gt;timbrooks&lt;/a&gt; To clarify your question - we shouldn&apos;t update the metric on failed attempts. &lt;/p&gt;</comment>
                            <comment id="14516263" author="timbrooks" created="Tue, 28 Apr 2015 03:18:44 +0000"  >&lt;p&gt;Okay. Well I made a number of changes related to Metadata in Kafka-2102. One of which would resolve this issue. Essentially split last successful update from last update attempt.&lt;/p&gt;

&lt;p&gt;I guess I will wait to see if that patch is accepted before submitting one for this card.&lt;/p&gt;</comment>
                            <comment id="14566767" author="timbrooks" created="Sun, 31 May 2015 21:51:49 +0000"  >&lt;p&gt;Created reviewboard &lt;a href=&quot;https://reviews.apache.org/r/34865/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/34865/diff/&lt;/a&gt;&lt;br/&gt;
 against branch origin/trunk&lt;/p&gt;</comment>
                            <comment id="14566770" author="timbrooks" created="Sun, 31 May 2015 21:54:57 +0000"  >&lt;p&gt;As I mentioned earlier, this overlaps some with the changes in Kafka-2102. However, if that patch is not accepted, the patch I submitted here will resolve this ticket.&lt;/p&gt;

&lt;p&gt;A second long is created for last successful update. This is used in the metrics. And it is used when considering when next to update based on metadataExpireMs. Whereas right now, if there is a failed update - the backoff will be for the entire metadataExpireMs opposed to just the refreshBackoffMs time period. &lt;/p&gt;</comment>
                            <comment id="14587239" author="junrao" created="Tue, 16 Jun 2015 00:44:28 +0000"  >&lt;p&gt;Thanks for the patch. +1 and committed to trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12736460" name="KAFKA-2101.patch" size="4455" author="timbrooks" created="Sun, 31 May 2015 21:51:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cxlj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>