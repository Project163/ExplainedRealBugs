<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:12:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-7068] ConfigTransformer doesn&apos;t handle null values</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-7068</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;ConfigTransformer fails with NPE when the input configs have keys with null values. This is a blocker for 2.0.0 since connectors configs can have null values.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13166586">KAFKA-7068</key>
            <summary>ConfigTransformer doesn&apos;t handle null values</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mageshn">Magesh kumar Nandakumar</reporter>
                        <labels>
                    </labels>
                <created>Sun, 17 Jun 2018 07:12:21 +0000</created>
                <updated>Sun, 17 Jun 2018 19:15:05 +0000</updated>
                            <resolved>Sun, 17 Jun 2018 19:13:04 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16515017" author="rayokota" created="Sun, 17 Jun 2018 07:19:39 +0000"  >&lt;p&gt;Here is a PR to fix this: &lt;a href=&quot;https://github.com/apache/kafka/pull/5241&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5241&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16515190" author="ewencp" created="Sun, 17 Jun 2018 19:13:04 +0000"  >&lt;p&gt;Issue resolved by pull request 5241&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/5241&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5241&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16515191" author="githubbot" created="Sun, 17 Jun 2018 19:15:05 +0000"  >&lt;p&gt;ewencp closed pull request #5241: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7068&quot; title=&quot;ConfigTransformer doesn&amp;#39;t handle null values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7068&quot;&gt;&lt;del&gt;KAFKA-7068&lt;/del&gt;&lt;/a&gt; : KIP-297 : Handle null config values during transform&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5241&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5241&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/clients/src/main/java/org/apache/kafka/common/config/ConfigTransformer.java b/clients/src/main/java/org/apache/kafka/common/config/ConfigTransformer.java&lt;br/&gt;
index 7c3c516b073..c727230e137 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/common/config/ConfigTransformer.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/common/config/ConfigTransformer.java&lt;br/&gt;
@@ -77,11 +77,13 @@ public ConfigTransformerResult transform(Map&amp;lt;String, String&amp;gt; configs) {&lt;/p&gt;

&lt;p&gt;         // Collect the variables from the given configs that need transformation&lt;br/&gt;
         for (Map.Entry&amp;lt;String, String&amp;gt; config : configs.entrySet()) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;List&amp;lt;ConfigVariable&amp;gt; vars = getVars(config.getKey(), config.getValue(), DEFAULT_PATTERN);&lt;/li&gt;
	&lt;li&gt;for (ConfigVariable var : vars) {&lt;/li&gt;
	&lt;li&gt;Map&amp;lt;String, Set&amp;lt;String&amp;gt;&amp;gt; keysByPath = keysByProvider.computeIfAbsent(var.providerName, k -&amp;gt; new HashMap&amp;lt;&amp;gt;());&lt;/li&gt;
	&lt;li&gt;Set&amp;lt;String&amp;gt; keys = keysByPath.computeIfAbsent(var.path, k -&amp;gt; new HashSet&amp;lt;&amp;gt;());&lt;/li&gt;
	&lt;li&gt;keys.add(var.variable);&lt;br/&gt;
+            if (config.getValue() != null) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+                List&amp;lt;ConfigVariable&amp;gt; vars = getVars(config.getKey(), config.getValue(), DEFAULT_PATTERN);+                for (ConfigVariable var }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;         }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -128,6 +130,9 @@ public ConfigTransformerResult transform(Map&amp;lt;String, String&amp;gt; configs) {&lt;br/&gt;
     private static String replace(Map&amp;lt;String, Map&amp;lt;String, Map&amp;lt;String, String&amp;gt;&amp;gt;&amp;gt; lookupsByProvider,&lt;br/&gt;
                                   String value,&lt;br/&gt;
                                   Pattern pattern) {&lt;br/&gt;
+        if (value == null) &lt;/p&gt;
{
+            return null;
+        }
&lt;p&gt;         Matcher matcher = pattern.matcher(value);&lt;br/&gt;
         StringBuilder builder = new StringBuilder();&lt;br/&gt;
         int i = 0;&lt;br/&gt;
diff --git a/clients/src/test/java/org/apache/kafka/common/config/ConfigTransformerTest.java b/clients/src/test/java/org/apache/kafka/common/config/ConfigTransformerTest.java&lt;br/&gt;
index 7bc74f36e9b..ebc401180f2 100644&lt;br/&gt;
&amp;#8212; a/clients/src/test/java/org/apache/kafka/common/config/ConfigTransformerTest.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/common/config/ConfigTransformerTest.java&lt;br/&gt;
@@ -25,6 +25,7 @@&lt;br/&gt;
 import java.util.Set;&lt;/p&gt;

&lt;p&gt; import static org.junit.Assert.assertEquals;&lt;br/&gt;
+import static org.junit.Assert.assertNull;&lt;br/&gt;
 import static org.junit.Assert.assertTrue;&lt;/p&gt;

&lt;p&gt; public class ConfigTransformerTest {&lt;br/&gt;
@@ -36,6 +37,7 @@&lt;br/&gt;
     public static final String TEST_PATH = &quot;testPath&quot;;&lt;br/&gt;
     public static final String TEST_RESULT = &quot;testResult&quot;;&lt;br/&gt;
     public static final String TEST_RESULT_WITH_TTL = &quot;testResultWithTTL&quot;;&lt;br/&gt;
+    public static final String TEST_RESULT_NO_PATH = &quot;testResultNoPath&quot;;&lt;/p&gt;

&lt;p&gt;     private ConfigTransformer configTransformer;&lt;/p&gt;

&lt;p&gt;@@ -83,6 +85,24 @@ public void testSingleLevelOfIndirection() throws Exception {&lt;br/&gt;
         assertEquals(&quot;${test:testPath:testResult}&quot;, data.get(MY_KEY));&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    @Test&lt;br/&gt;
+    public void testReplaceVariableNoPath() throws Exception {&lt;br/&gt;
+        ConfigTransformerResult result = configTransformer.transform(Collections.singletonMap(MY_KEY, &quot;${test:testKey}&quot;));&lt;br/&gt;
+        Map&amp;lt;String, String&amp;gt; data = result.data();&lt;br/&gt;
+        Map&amp;lt;String, Long&amp;gt; ttls = result.ttls();&lt;br/&gt;
+        assertEquals(TEST_RESULT_NO_PATH, data.get(MY_KEY));&lt;br/&gt;
+        assertTrue(ttls.isEmpty());&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void testNullConfigValue() throws Exception &lt;/p&gt;
{
+        ConfigTransformerResult result = configTransformer.transform(Collections.singletonMap(MY_KEY, null));
+        Map&amp;lt;String, String&amp;gt; data = result.data();
+        Map&amp;lt;String, Long&amp;gt; ttls = result.ttls();
+        assertNull(data.get(MY_KEY));
+        assertTrue(ttls.isEmpty());
+    }
&lt;p&gt;+&lt;br/&gt;
     public static class TestConfigProvider implements ConfigProvider {&lt;/p&gt;

&lt;p&gt;         public void configure(Map&amp;lt;String, ?&amp;gt; configs) {&lt;br/&gt;
@@ -95,7 +115,7 @@ public ConfigData get(String path) {&lt;br/&gt;
         public ConfigData get(String path, Set&amp;lt;String&amp;gt; keys) {&lt;br/&gt;
             Map&amp;lt;String, String&amp;gt; data = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
             Long ttl = null;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (path.equals(TEST_PATH)) {&lt;br/&gt;
+            if (TEST_PATH.equals(path)) {&lt;br/&gt;
                 if (keys.contains(TEST_KEY)) 
{
                     data.put(TEST_KEY, TEST_RESULT);
                 }
&lt;p&gt;@@ -106,6 +126,10 @@ public ConfigData get(String path, Set&amp;lt;String&amp;gt; keys) {&lt;br/&gt;
                 if (keys.contains(TEST_INDIRECTION)) {&lt;br/&gt;
                     data.put(TEST_INDIRECTION, &quot;${test:testPath:testResult}&quot;);&lt;br/&gt;
                 }&lt;br/&gt;
+            } else &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+                if (keys.contains(TEST_KEY)) {
+                    data.put(TEST_KEY, TEST_RESULT_NO_PATH);
+                }             }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;             return new ConfigData(data, ttl);&lt;br/&gt;
         }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 22 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3uyan:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>