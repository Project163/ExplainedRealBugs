<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:06:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-6362] auto commit not work since coordinatorUnknown() is always true.</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-6362</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[2017-12-14 20:09:23.501] [Kafka 0.10 Fetcher &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Source: source_bj-docker-large (14/40)] INFO  org.apache.kafka.clients.consumer.ConsumerConfig - ConsumerConfig values: 
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [11.192.77.42:3002, 11.192.73.43:3002, 11.192.73.66:3002]
	check.crcs = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
	client.id = 
	connections.max.idle.ms = 540000
	enable.auto.commit = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
	exclude.internal.topics = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = tcprtdetail_flink
	heartbeat.interval.ms = 3000
	interceptor.classes = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	key.deserializer = &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.kafka.common.serialization.ByteArrayDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.kafka.clients.consumer.RangeAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.ms = 50
	request.timeout.ms = 305000
	retry.backoff.ms = 100
	sasl.jaas.config = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	send.buffer.bytes = 131072
	session.timeout.ms = 10000
	ssl.cipher.suites = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	ssl.enabled.protocols = [TLSv1.2, TLSv1.1, TLSv1]
	ssl.endpoint.identification.algorithm = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	ssl.key.password = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.location = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	ssl.keystore.password = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	ssl.keystore.type = JKS
	ssl.protocol = TLS
	ssl.provider = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	ssl.secure.random.implementation = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.location = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	ssl.truststore.password = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	ssl.truststore.type = JKS
	value.deserializer = &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.kafka.common.serialization.ByteArrayDeserializer

[2017-12-14 20:09:23.502] [Kafka 0.10 Fetcher &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Source: source_bj-docker-large (14/40)] INFO  org.apache.kafka.common.utils.AppInfoParser - Kafka version : 0.10.2.1
[2017-12-14 20:09:23.502] [Kafka 0.10 Fetcher &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Source: source_bj-docker-large (14/40)] INFO  org.apache.kafka.common.utils.AppInfoParser - Kafka commitId : e89bffd6b2eff799
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;My kafka java client cannot auto commit.After add some debug log,I found that the coordinatorUnknown() function in &lt;a href=&quot;https://github.com/apache/kafka/blob/0.10.2.1/clients/src/main/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinator.java#L604&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ConsumerCoordinator.java#L604&lt;/a&gt; always returns true,and nextAutoCommitDeadline just increases infinitly.Should there be a lookupCoordinator() after line 604 like in &lt;a href=&quot;https://github.com/apache/kafka/blob/0.10.2.1/clients/src/main/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinator.java#L508&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ConsumerCoordinator.java#L508&lt;/a&gt;?After I add lookupCoordinator() next to line 604.The consumer can auto commit offset properly.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13124946">KAFKA-6362</key>
            <summary>auto commit not work since coordinatorUnknown() is always true.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="huxi_2b">huxihx</assignee>
                                    <reporter username="RenkaiGe">Renkai Ge</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Dec 2017 12:25:07 +0000</created>
                <updated>Thu, 8 Feb 2018 17:50:35 +0000</updated>
                            <resolved>Thu, 8 Feb 2018 17:50:26 +0000</resolved>
                                    <version>0.10.2.1</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>clients</component>
                    <component>consumer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16291952" author="githubbot" created="Fri, 15 Dec 2017 02:43:21 +0000"  >&lt;p&gt;GitHub user huxihx opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/4326&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4326&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6362&quot; title=&quot;auto commit not work since coordinatorUnknown() is always true.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6362&quot;&gt;&lt;del&gt;KAFKA-6362&lt;/del&gt;&lt;/a&gt;: maybeAutoCommitOffsetsAsync should try to discover coordinator&lt;/p&gt;

&lt;p&gt;    Currently, `maybeAutoCommitOffsetsAsync` may not retry to find out coordinator even after the coordinator goes back to service. As a result, all asynchronous offset commits will fail.&lt;/p&gt;

&lt;p&gt;    This patch refines `maybeAutoCommitOffsetsAsync` to have it periodically retry the coordinator discovering.&lt;/p&gt;

&lt;p&gt;    *More detailed description of your change,&lt;br/&gt;
    if necessary. The PR title and PR message become&lt;br/&gt;
    the squashed commit message, so use a separate&lt;br/&gt;
    comment to ping reviewers.*&lt;/p&gt;

&lt;p&gt;    *Summary of testing strategy (including rationale)&lt;br/&gt;
    for the feature or bug fix. Unit and/or integration&lt;br/&gt;
    tests are expected for any behaviour change and&lt;br/&gt;
    system tests should be considered for larger changes.*&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/huxihx/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/huxihx/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6362&quot; title=&quot;auto commit not work since coordinatorUnknown() is always true.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6362&quot;&gt;&lt;del&gt;KAFKA-6362&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/4326.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4326.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4326&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit a2e2da2b2215da2053ffc9e6dace4a36e8777e12&lt;br/&gt;
Author: huxihx &amp;lt;huxi_2b@hotmail.com&amp;gt;&lt;br/&gt;
Date:   2017-12-15T02:39:31Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6362&quot; title=&quot;auto commit not work since coordinatorUnknown() is always true.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6362&quot;&gt;&lt;del&gt;KAFKA-6362&lt;/del&gt;&lt;/a&gt;: ConsumerCoordinator.maybeAutoCommitOffsetsAsync should try to discover coordinator.&lt;/p&gt;

&lt;p&gt;    Currently, `maybeAutoCommitOffsetsAsync` may not retry to find out coordinator even after the coordinator goes back to service. As a result, all asynchronous offset commits will fail.&lt;/p&gt;

&lt;p&gt;    This patch refines `maybeAutoCommitOffsetsAsync` to have it periodically retry the coordinator discovering.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16349578" author="hachikuji" created="Fri, 2 Feb 2018 00:26:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=RenkaiGe&quot; class=&quot;user-hover&quot; rel=&quot;RenkaiGe&quot;&gt;RenkaiGe&lt;/a&gt; Thanks for filing the issue and sorry for getting to it so late. As far as I can tell, this should only be affecting &quot;simple&quot; consumer usage with assign(). Can you confirm whether that&apos;s the case?&lt;/p&gt;</comment>
                            <comment id="16349609" author="huxi_2b" created="Fri, 2 Feb 2018 01:00:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hachikuji&quot; class=&quot;user-hover&quot; rel=&quot;hachikuji&quot;&gt;hachikuji&lt;/a&gt; I reproduced the issue on my local test environment&#160;where&#160;standalone consumer was used. Seems there is no code for standalone consumers to rediscover the coordinator even after it came back to work.&lt;/p&gt;</comment>
                            <comment id="16349611" author="hachikuji" created="Fri, 2 Feb 2018 01:01:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=huxi_2b&quot; class=&quot;user-hover&quot; rel=&quot;huxi_2b&quot;&gt;huxi_2b&lt;/a&gt; By &quot;standalone,&quot; you mean a simple consumer which is not using group management (i.e. one using the &lt;tt&gt;assign()&lt;/tt&gt; API), right? I am just confirming that the problem is only for this usage.&lt;/p&gt;</comment>
                            <comment id="16349616" author="huxi_2b" created="Fri, 2 Feb 2018 01:08:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hachikuji&quot; class=&quot;user-hover&quot; rel=&quot;hachikuji&quot;&gt;hachikuji&lt;/a&gt; Yes, I do mean the consumer using assign() API. And for consumer groups, they will ensure the coordinator&apos;s readiness in every round of ConsumerCoordinator#poll() if they found it&apos;s not available.&#160; Does it make sense?&lt;/p&gt;</comment>
                            <comment id="16357298" author="githubbot" created="Thu, 8 Feb 2018 17:49:15 +0000"  >&lt;p&gt;hachikuji closed pull request #4326: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6362&quot; title=&quot;auto commit not work since coordinatorUnknown() is always true.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6362&quot;&gt;&lt;del&gt;KAFKA-6362&lt;/del&gt;&lt;/a&gt;: maybeAutoCommitOffsetsAsync should try to discover coordinator&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/4326&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4326&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/clients/src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java b/clients/src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java&lt;br/&gt;
index 1d84f847cd8..2f7fd58a66f 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java&lt;br/&gt;
@@ -1058,7 +1058,7 @@ public void assign(Collection&amp;lt;TopicPartition&amp;gt; partitions) {&lt;/p&gt;

&lt;p&gt;                 // make sure the offsets of topic partitions the consumer is unsubscribing from&lt;br/&gt;
                 // are committed since there will be no following rebalance&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.coordinator.maybeAutoCommitOffsetsNow();&lt;br/&gt;
+                this.coordinator.maybeAutoCommitOffsetsAsync(time.milliseconds());&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;                 log.debug(&quot;Subscribed to partition(s): {}&quot;, Utils.join(partitions, &quot;, &quot;));&lt;br/&gt;
                 this.subscriptions.assignFromUser(new HashSet&amp;lt;&amp;gt;(partitions));&lt;br/&gt;
diff --git a/clients/src/main/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinator.java b/clients/src/main/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinator.java&lt;br/&gt;
index 5c1e60eee82..d7c1ce9966e 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinator.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinator.java&lt;br/&gt;
@@ -528,6 +528,7 @@ public void commitOffsetsAsync(final Map&amp;lt;TopicPartition, OffsetAndMetadata&amp;gt; offs&lt;br/&gt;
                 public void onSuccess(Void value) &lt;/p&gt;
{
                     pendingAsyncCommits.decrementAndGet();
                     doCommitOffsetsAsync(offsets, callback);
+                    client.pollNoWakeup();
                 }

&lt;p&gt;                 @Override&lt;br/&gt;
@@ -623,20 +624,10 @@ public boolean commitOffsetsSync(Map&amp;lt;TopicPartition, OffsetAndMetadata&amp;gt; offsets,&lt;br/&gt;
         return false;&lt;br/&gt;
     }&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private void maybeAutoCommitOffsetsAsync(long now) {&lt;/li&gt;
	&lt;li&gt;if (autoCommitEnabled) {&lt;/li&gt;
	&lt;li&gt;if (coordinatorUnknown()) 
{
-                this.nextAutoCommitDeadline = now + retryBackoffMs;
-            }
&lt;p&gt; else if (now &amp;gt;= nextAutoCommitDeadline) &lt;/p&gt;
{
-                this.nextAutoCommitDeadline = now + autoCommitIntervalMs;
-                doAutoCommitOffsetsAsync();
-            }&lt;/li&gt;
	&lt;li&gt;}&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;public void maybeAutoCommitOffsetsNow() {&lt;/li&gt;
	&lt;li&gt;if (autoCommitEnabled &amp;amp;&amp;amp; !coordinatorUnknown())&lt;br/&gt;
+    public void maybeAutoCommitOffsetsAsync(long now) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+        if (autoCommitEnabled &amp;amp;&amp;amp; now &amp;gt;= nextAutoCommitDeadline) {
             doAutoCommitOffsetsAsync();
+        }     }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     private void doAutoCommitOffsetsAsync() {&lt;br/&gt;
@@ -650,8 +641,11 @@ public void onComplete(Map&amp;lt;TopicPartition, OffsetAndMetadata&amp;gt; offsets, Exception&lt;br/&gt;
                     log.warn(&quot;Asynchronous auto-commit of offsets {} failed: {}&quot;, offsets, exception.getMessage());&lt;br/&gt;
                     if (exception instanceof RetriableException)&lt;br/&gt;
                         nextAutoCommitDeadline = Math.min(time.milliseconds() + retryBackoffMs, nextAutoCommitDeadline);&lt;br/&gt;
+                    else&lt;br/&gt;
+                        nextAutoCommitDeadline = time.milliseconds() + autoCommitIntervalMs;&lt;br/&gt;
                 } else {&lt;br/&gt;
                     log.debug(&quot;Completed asynchronous auto-commit of offsets {}&quot;, offsets);&lt;br/&gt;
+                    nextAutoCommitDeadline = time.milliseconds() + autoCommitIntervalMs;&lt;br/&gt;
                 }&lt;br/&gt;
             }&lt;br/&gt;
         });&lt;br/&gt;
diff --git a/clients/src/test/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinatorTest.java b/clients/src/test/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinatorTest.java&lt;br/&gt;
index 76301a71bea..c49339b6525 100644&lt;br/&gt;
&amp;#8212; a/clients/src/test/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinatorTest.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinatorTest.java&lt;br/&gt;
@@ -1625,6 +1625,25 @@ public void testHeartbeatThreadClose() throws Exception &lt;/p&gt;
{
             assertFalse(&quot;Heartbeat thread active after close&quot;, threads[i].getName().contains(groupId));
     }

&lt;p&gt;+    @Test&lt;br/&gt;
+    public void testAutoCommitAfterCoordinatorBackToService() &lt;/p&gt;
{
+        ConsumerCoordinator coordinator = buildCoordinator(new Metrics(), assignors,
+                ConsumerConfig.DEFAULT_EXCLUDE_INTERNAL_TOPICS, true, true);
+        subscriptions.assignFromUser(Collections.singleton(t1p));
+        subscriptions.seek(t1p, 100L);
+
+        coordinator.coordinatorDead();
+        assertTrue(coordinator.coordinatorUnknown());
+        client.prepareResponse(groupCoordinatorResponse(node, Errors.NONE));
+        client.prepareResponse(offsetCommitResponse(Collections.singletonMap(t1p, Errors.NONE)));
+
+        // async commit offset should find coordinator
+        time.sleep(autoCommitIntervalMs); // sleep for a while to ensure auto commit does happen
+        coordinator.maybeAutoCommitOffsetsAsync(time.milliseconds());
+        assertFalse(coordinator.coordinatorUnknown());
+        assertEquals(subscriptions.committed(t1p).offset(), 100L);
+    }
&lt;p&gt;+&lt;br/&gt;
     private ConsumerCoordinator prepareCoordinatorForCloseTest(final boolean useGroupManagement,&lt;br/&gt;
                                                                final boolean autoCommit,&lt;br/&gt;
                                                                final boolean leaveGroup) {&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 40 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3nwjb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>