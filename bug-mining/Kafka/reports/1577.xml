<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:02:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-5402] JmxReporter Fetch metrics for kafka.server should not be created when client quotas are not enabled</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-5402</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;JMXReporter kafka.server Fetch metrics should not be created when client quotas are not enforced for client fetch requests. Currently, these metrics are created and this can cause OutOfMemoryException in the KafkaServer in cases where a large number of consumers are being created rapidly.&lt;/p&gt;

&lt;p&gt;Attaching screenshots from a heapdump showing the kafka.server:type=Fetch,client-id=consumer-358567 with different client.ids from a kafkaserver where client quotas were not enabled.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13078118">KAFKA-5402</key>
            <summary>JmxReporter Fetch metrics for kafka.server should not be created when client quotas are not enabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rsivaram">Rajini Sivaram</assignee>
                                    <reporter username="Koelli">Koelli Mungee</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Jun 2017 21:08:38 +0000</created>
                <updated>Thu, 29 Jun 2017 12:03:11 +0000</updated>
                            <resolved>Thu, 29 Jun 2017 12:02:04 +0000</resolved>
                                    <version>0.10.1.1</version>
                                    <fixVersion>1.0.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16042069" author="huxi_2b" created="Thu, 8 Jun 2017 01:58:24 +0000"  >&lt;p&gt;Is it a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3980&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;KAFKA-3980&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="16043480" author="junrao" created="Thu, 8 Jun 2017 21:33:43 +0000"  >&lt;p&gt;Not sure if this is the same as &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3980&quot; title=&quot;JmxReporter uses excessive memory causing OutOfMemoryException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3980&quot;&gt;KAFKA-3980&lt;/a&gt;. Currently, if a metric is not being actively updated (after the client is gone), the metric is supposed to be automatically removed after 1 hour.&lt;/p&gt;

&lt;p&gt;Also, it seem that currently even if quota is not enabled, we still create the quota metric with the client-id. Not sure how useful those metrics are w/o enabling quota. Perhaps we should only create the metric if quota is enabled. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rsivaram&quot; class=&quot;user-hover&quot; rel=&quot;rsivaram&quot;&gt;rsivaram&lt;/a&gt;, what do you think?&lt;/p&gt;</comment>
                            <comment id="16044100" author="rsivaram" created="Fri, 9 Jun 2017 07:47:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=junrao&quot; class=&quot;user-hover&quot; rel=&quot;junrao&quot;&gt;junrao&lt;/a&gt; Yes, agree that these metrics are only useful for quotas. We can disable them when no quotas are configured. If anyone is interested in these metrics without any throttling, it should be easy to set a very large (e.g. Long.MAX_VALUE-1) default client-id quota (or default user quota to monitor at user level).&lt;/p&gt;</comment>
                            <comment id="16046540" author="githubbot" created="Mon, 12 Jun 2017 13:15:27 +0000"  >&lt;p&gt;GitHub user rajinisivaram opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3303&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3303&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5402&quot; title=&quot;JmxReporter Fetch metrics for kafka.server should not be created when client quotas are not enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5402&quot;&gt;&lt;del&gt;KAFKA-5402&lt;/del&gt;&lt;/a&gt;: Avoid creating quota related metrics if quotas not enabled&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/rajinisivaram/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rajinisivaram/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5402&quot; title=&quot;JmxReporter Fetch metrics for kafka.server should not be created when client quotas are not enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5402&quot;&gt;&lt;del&gt;KAFKA-5402&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3303.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3303.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3303&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit f69011760d67a4b85d5049014e5929fbdc661858&lt;br/&gt;
Author: Rajini Sivaram &amp;lt;rajinisivaram@googlemail.com&amp;gt;&lt;br/&gt;
Date:   2017-06-12T12:12:14Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5402&quot; title=&quot;JmxReporter Fetch metrics for kafka.server should not be created when client quotas are not enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5402&quot;&gt;&lt;del&gt;KAFKA-5402&lt;/del&gt;&lt;/a&gt;: Avoid creating quota related metrics if quotas not enabled&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16067529" author="githubbot" created="Thu, 29 Jun 2017 00:49:38 +0000"  >&lt;p&gt;Github user rajinisivaram closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3303&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3303&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16067569" author="githubbot" created="Thu, 29 Jun 2017 01:43:18 +0000"  >&lt;p&gt;GitHub user rajinisivaram reopened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3303&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3303&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5402&quot; title=&quot;JmxReporter Fetch metrics for kafka.server should not be created when client quotas are not enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5402&quot;&gt;&lt;del&gt;KAFKA-5402&lt;/del&gt;&lt;/a&gt;: Avoid creating quota related metrics if quotas not enabled&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/rajinisivaram/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rajinisivaram/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5402&quot; title=&quot;JmxReporter Fetch metrics for kafka.server should not be created when client quotas are not enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5402&quot;&gt;&lt;del&gt;KAFKA-5402&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3303.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3303.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3303&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 5040ef11e46eabc390422783ef44972145ac85b2&lt;br/&gt;
Author: Rajini Sivaram &amp;lt;rajinisivaram@googlemail.com&amp;gt;&lt;br/&gt;
Date:   2017-06-12T12:12:14Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5402&quot; title=&quot;JmxReporter Fetch metrics for kafka.server should not be created when client quotas are not enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5402&quot;&gt;&lt;del&gt;KAFKA-5402&lt;/del&gt;&lt;/a&gt;: Avoid creating quota related metrics if quotas not enabled&lt;/p&gt;

&lt;p&gt;commit 2e25eac8a25adbe8c5a01c8b857cb5e1e879e5e5&lt;br/&gt;
Author: Rajini Sivaram &amp;lt;rajinisivaram@googlemail.com&amp;gt;&lt;br/&gt;
Date:   2017-06-12T15:29:01Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5402&quot; title=&quot;JmxReporter Fetch metrics for kafka.server should not be created when client quotas are not enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5402&quot;&gt;&lt;del&gt;KAFKA-5402&lt;/del&gt;&lt;/a&gt;: Address review comment&lt;/p&gt;

&lt;p&gt;commit f70e82622a06ede38e8f3d704ade6f3f4f27b2bd&lt;br/&gt;
Author: Rajini Sivaram &amp;lt;rajinisivaram@googlemail.com&amp;gt;&lt;br/&gt;
Date:   2017-06-12T20:11:09Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5402&quot; title=&quot;JmxReporter Fetch metrics for kafka.server should not be created when client quotas are not enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5402&quot;&gt;&lt;del&gt;KAFKA-5402&lt;/del&gt;&lt;/a&gt;: Fix test failures, update method names&lt;/p&gt;

&lt;p&gt;commit e25d5b1d3b19af198f5dac070abc9495edc49364&lt;br/&gt;
Author: Rajini Sivaram &amp;lt;rajinisivaram@googlemail.com&amp;gt;&lt;br/&gt;
Date:   2017-06-13T12:42:23Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5402&quot; title=&quot;JmxReporter Fetch metrics for kafka.server should not be created when client quotas are not enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5402&quot;&gt;&lt;del&gt;KAFKA-5402&lt;/del&gt;&lt;/a&gt;: Address review comments&lt;/p&gt;

&lt;p&gt;commit 499ded48f04f6da193d8a3f04d9072983174069b&lt;br/&gt;
Author: Rajini Sivaram &amp;lt;rajinisivaram@googlemail.com&amp;gt;&lt;br/&gt;
Date:   2017-06-29T00:16:51Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5402&quot; title=&quot;JmxReporter Fetch metrics for kafka.server should not be created when client quotas are not enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5402&quot;&gt;&lt;del&gt;KAFKA-5402&lt;/del&gt;&lt;/a&gt;: Address review comments&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16068239" author="rsivaram" created="Thu, 29 Jun 2017 12:02:04 +0000"  >&lt;p&gt;Issue resolved by pull request 3303&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/3303&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3303&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16068241" author="githubbot" created="Thu, 29 Jun 2017 12:03:11 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3303&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3303&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12871924" name="Fetch.jpg" size="395706" author="Koelli" created="Wed, 7 Jun 2017 21:08:38 +0000"/>
                            <attachment id="12871923" name="Metrics.jpg" size="378064" author="Koelli" created="Wed, 7 Jun 2017 21:08:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 20 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3g05z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>