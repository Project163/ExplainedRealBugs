<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:42:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-19054] StreamThread exception handling with SHUTDOWN_APPLICATION may trigger a tight loop with MANY logs</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-19054</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;When configured with SHUTDOWN_APPLICATION for uncaught exception handler:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
kafkaStreams.setUncaughtExceptionHandler(e -&amp;gt; StreamsUncaughtExceptionHandler.StreamThreadExceptionResponse.SHUTDOWN_APPLICATION);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The kafka streams application may fall in a tight loop where inside StreamThread#runLoop()&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (isRunning() || taskManager.rebalanceInProgress()) { &lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt; to loop because rebalanceInProgress even though the thread is already PENDING_SHUTDOWN
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                checkForTopologyUpdates();
                &lt;span class=&quot;code-comment&quot;&gt;// If we received the shutdown signal &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; a topology to be added, we can
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// stop polling regardless of the rebalance status since we know there are no tasks left
&lt;/span&gt;                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isRunning() &amp;amp;&amp;amp; topologyMetadata.isEmpty()) {
                    log.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Shutting down thread with empty topology.&quot;&lt;/span&gt;);
                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
                }

                maybeSendShutdown();
                &lt;span class=&quot;code-comment&quot;&gt;// omitted code, returns very quickly because consumer#poll will &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; immediately due to it receiving shutdown request
&lt;/span&gt;        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Inside maybeSendShutdown(), logs are printed to flood the log. We received more than 13k logs in a short period of 50ms. &lt;/p&gt;

&lt;p&gt;Please add logic to avoid the tight loop. Thank you.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13613594">KAFKA-19054</key>
            <summary>StreamThread exception handling with SHUTDOWN_APPLICATION may trigger a tight loop with MANY logs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="apalan60">HongYi Chen</assignee>
                                    <reporter username="boquan">Boquan Tang</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Mon, 31 Mar 2025 01:24:56 +0000</created>
                <updated>Thu, 17 Apr 2025 17:38:51 +0000</updated>
                            <resolved>Thu, 17 Apr 2025 03:54:56 +0000</resolved>
                                    <version>2.8.0</version>
                                    <fixVersion>4.0.1</fixVersion>
                    <fixVersion>4.1.0</fixVersion>
                                    <component>streams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17939858" author="JIRAUSER308785" created="Tue, 1 Apr 2025 02:04:54 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=boquan&quot; class=&quot;user-hover&quot; rel=&quot;boquan&quot;&gt;boquan&lt;/a&gt;, If you&apos;re not currently working on it, may I take it? Thanks.&lt;/p&gt;</comment>
                            <comment id="17939862" author="boquan" created="Tue, 1 Apr 2025 02:23:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apalan60&quot; class=&quot;user-hover&quot; rel=&quot;apalan60&quot;&gt;apalan60&lt;/a&gt; Hey, please feel free to work on it, thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13367087">KAFKA-12537</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            32 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1v2so:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>