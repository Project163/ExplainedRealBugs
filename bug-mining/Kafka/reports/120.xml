<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:36:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-432] allow consumer to read from followers</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-432</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;For debugging purpose, it would be convenient if we allow a consumer to consume from a follower replica.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12601089">KAFKA-432</key>
            <summary>allow consumer to read from followers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yeyangever">Yang Ye</assignee>
                                    <reporter username="junrao">Jun Rao</reporter>
                        <labels>
                            <label>optimization</label>
                    </labels>
                <created>Wed, 1 Aug 2012 16:19:45 +0000</created>
                <updated>Fri, 12 Oct 2012 02:57:20 +0000</updated>
                            <resolved>Fri, 12 Oct 2012 02:57:15 +0000</resolved>
                                    <version>0.8.0</version>
                                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="172800">48h</timeoriginalestimate>
                            <timeestimate seconds="172800">48h</timeestimate>
                                        <comments>
                            <comment id="13467296" author="yeyangever" created="Mon, 1 Oct 2012 23:19:22 +0000"  >
&lt;p&gt;1. removing the &quot;ConsumerShell.scala&quot; file&lt;/p&gt;

&lt;p&gt;2. Use &quot;replicaId&quot; field in &quot;FetchRequest&quot; and &quot;OffsetRequest&quot; to indicate where the fetch is from, -1 means &quot;OrdinaryConsumerId&quot;, -2 means &quot;LowLevelConsumerId&quot;, instead of using &quot;clientId&quot; to distinguish different request &lt;/p&gt;

&lt;p&gt;3. create a function &quot;getLocalReplica()&quot; in ReplicaManager, which returns the local replica even if it&apos;s not the leader. This function is used in KafkaApis, to work with requests from &quot;LowLevelConsumerId&quot;&lt;/p&gt;

&lt;p&gt;4. In kafkaApis, when handling &quot;offsetRequest&quot; and &quot;fetchRequest&quot;, treat differently depending on the value of the &quot;replicaId&quot; field. If it&apos;s from &quot;lowLevelConsumer&quot;, use &quot;getLocalReplica&quot; instead of &quot;getLocalReplicaIfLeader&quot;&lt;/p&gt;

&lt;p&gt;5. Move the &quot;earliestOrLatestOffset()&quot; function from &quot;zookeeperConsumerConnector&quot; to &quot;SimpleConsumer&quot; because it&apos;s now used by both the high level and low level consumer. (And create two overloaded functions because the client can get it from either zkConnect or from brokerList)&lt;/p&gt;

&lt;p&gt;6. Move the &quot;MessageFormmater&quot; inner class out of &quot;ConsoleConsumer&quot;, because it&apos;s now used by both the console consumer and the simple consumer shell&lt;/p&gt;

&lt;p&gt;7. Update the logic of simpleConsumerShell so that it supports fetching from any specified replica now. &lt;/p&gt;

&lt;p&gt;8. Removing some unused import and fixed missing arguments in some log statement&lt;/p&gt;</comment>
                            <comment id="13467868" author="junrao" created="Tue, 2 Oct 2012 17:07:18 +0000"  >&lt;p&gt;Thanks for patch v1. Some comments:&lt;/p&gt;

&lt;p&gt;1. ReplicaManager.getLocalReplica(): We shouldn&apos;t be creating a new replica in this method. Also, this function is almost the same as getReplica() except that it wants to throw an exception if the replica is not found. How about creating a new method getReplicaOrException that calls getReplica and throws an exception if replica is none?&lt;/p&gt;

&lt;p&gt;2. object MessageFormatter: remove the extra empty lines above.&lt;/p&gt;

&lt;p&gt;3. RequestOrResponse: Could we change LowLevelConsumerId to DebuggingConsumerId so that people is aware that it&apos;s only for debugging purpose?&lt;/p&gt;

&lt;p&gt;4. remove unused imports&lt;/p&gt;

&lt;p&gt;5. SimpleConsumerShell: &lt;br/&gt;
5.1 The comment for the --offset is inaccurate. -2 is from beginning.&lt;br/&gt;
5.2 The --server option should be changed to --broker-list and the format should be changed accordingly (to take in  a list).&lt;br/&gt;
5.3 Can we add a command line option to print out the offset for each message too?&lt;br/&gt;
5.4 Could we add a command line option to specify the maxWaitMs for each fetch request and defaults it to 1000ms? Also, in FetchRequestBuilder, could we set the default maxWait and minBytes to that in ConsumerConfig object, instead of FetchRequest?&lt;/p&gt;

&lt;p&gt;Could you also rebase?&lt;/p&gt;</comment>
                            <comment id="13468106" author="yeyangever" created="Tue, 2 Oct 2012 21:48:00 +0000"  >&lt;p&gt;&lt;br/&gt;
All comments for patch v1 addressed&lt;/p&gt;</comment>
                            <comment id="13469034" author="junrao" created="Thu, 4 Oct 2012 00:36:10 +0000"  >&lt;p&gt;Thanks for patch v2. A few other minor comments:&lt;/p&gt;

&lt;p&gt;10. FetchRequestBuilder: could we set the default maxWait and minBytes to that in ConsumerConfig object, instead of FetchRequest?&lt;/p&gt;

&lt;p&gt;11. ReplicaManager.getLocalReplica(): Could we use getReplica?&lt;/p&gt;

&lt;p&gt;12. Let&apos;s remove the consumer shell script in bin/&lt;/p&gt;</comment>
                            <comment id="13469040" author="yeyangever" created="Thu, 4 Oct 2012 00:48:59 +0000"  >&lt;p&gt;&lt;br/&gt;
addressed all comments for v2 patch&lt;/p&gt;</comment>
                            <comment id="13472126" author="junrao" created="Tue, 9 Oct 2012 04:38:54 +0000"  >&lt;p&gt;Patch no longer applies. Could you rebase?&lt;/p&gt;</comment>
                            <comment id="13474665" author="yeyangever" created="Fri, 12 Oct 2012 00:27:24 +0000"  >&lt;p&gt;&lt;br/&gt;
rebase from kafka 510&lt;/p&gt;</comment>
                            <comment id="13474720" author="nehanarkhede" created="Fri, 12 Oct 2012 01:46:08 +0000"  >&lt;p&gt;Thanks for the patch! Overall, looks pretty good. A few more comments -&lt;/p&gt;

&lt;p&gt;1. FetchRequest&lt;br/&gt;
1.1 isFromOrdinaryConsumer and isFromLowLevelConsumer methods are unused. How about adding them when we have a use for them ?&lt;br/&gt;
1.2 If you still want to keep them, rename isFromLowLevelConsumer to isFromDebuggingConsumer to be consistent&lt;/p&gt;

&lt;p&gt;2. FetchResponse&lt;/p&gt;

&lt;p&gt;Revert this file since you changed the spacing between the ( and { at the end of a function name and that does not conform with our coding convention&lt;/p&gt;

&lt;p&gt;3. KafkaApis&lt;/p&gt;

&lt;p&gt;The following statements are not easy to understand and should not be at info level&lt;/p&gt;

&lt;p&gt;    info(&quot;bytes readable: &quot; + bytesReadable)&lt;br/&gt;
    info(&quot;data read: &quot; + dataRead)&lt;/p&gt;

&lt;p&gt;For example, if you read them in a busy Kafka log, would you be able to make sense of it ?&lt;/p&gt;

&lt;p&gt;3. OffsetRequest&lt;/p&gt;

&lt;p&gt;Rename isFromLowLevelClient to isFromDebuggingClient&lt;/p&gt;

&lt;p&gt;4. SimpleConsumer&lt;/p&gt;

&lt;p&gt;In earliestOrLatestOffset API, the response variable is never used&lt;/p&gt;

&lt;p&gt;5. SimpleConsumerShell&lt;/p&gt;

&lt;p&gt;1. You don&apos;t have a space between ) and { at the start of few blocks. We have been following the convention of including a space between those, please can you conform to convention in all your patches ?&lt;/p&gt;

&lt;p&gt;2. There is one very-long-statement in the file. Please can you break it ?&lt;/p&gt;</comment>
                            <comment id="13474733" author="yeyangever" created="Fri, 12 Oct 2012 02:13:57 +0000"  >&lt;p&gt;&lt;br/&gt;
Thanks for the review! And they&apos;re addressed in v5 patch.&lt;/p&gt;</comment>
                            <comment id="13474741" author="nehanarkhede" created="Fri, 12 Oct 2012 02:36:29 +0000"  >&lt;p&gt;+1. v5 looks good. &lt;/p&gt;</comment>
                            <comment id="13474749" author="nehanarkhede" created="Fri, 12 Oct 2012 02:57:15 +0000"  >&lt;p&gt;Committed v5.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12547304" name="kafka_432_v1.diff" size="47736" author="yeyangever" created="Mon, 1 Oct 2012 23:19:22 +0000"/>
                            <attachment id="12547451" name="kafka_432_v2.diff" size="49512" author="yeyangever" created="Tue, 2 Oct 2012 21:48:00 +0000"/>
                            <attachment id="12547646" name="kafka_432_v3.diff" size="50751" author="yeyangever" created="Thu, 4 Oct 2012 00:48:59 +0000"/>
                            <attachment id="12548830" name="kafka_432_v4.diff" size="52931" author="yeyangever" created="Fri, 12 Oct 2012 00:27:24 +0000"/>
                            <attachment id="12548848" name="kafka_432_v5.diff" size="53682" author="yeyangever" created="Fri, 12 Oct 2012 02:13:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>240632</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 6 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0142v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4430</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>