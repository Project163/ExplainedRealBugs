<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:38:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-991] Reduce the queue size in hadoop producer</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-991</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Currently the queue.size in hadoop producer is 10MB. This means that the KafkaRecordWriter will hit the send button on kafka producer after the size of uncompressed queued messages becomes greater than 10MB. (The other condition on which the messages are sent is if their number exceeds SHORT.MAX_VALUE).&lt;/p&gt;

&lt;p&gt;Considering that the server accepts a (compressed) batch of messages of sizeupto 1 million bytes minus the log overhead, we should probably reduce the queue size in hadoop producer. We should do two things:&lt;/p&gt;

&lt;p&gt;1. change max message size on the broker to 1 million + log overhead, because that will make the client message size easy to remember. Right now the maximum number of bytes that can be accepted from a client in a batch of messages is an awkward 999988. (I don&apos;t have a stronger reason). We have set fetch size on the consumer to 1MB, this gives us a lot of room even if the log overhead increased with further versions.&lt;/p&gt;

&lt;p&gt;2. Set the default number of bytes on hadoop producer to 1 million bytes. Anyone who wants higher throughput can override this config using kafka.output.queue.size&lt;/p&gt;</description>
                <environment></environment>
        <key id="12660812">KAFKA-991</key>
            <summary>Reduce the queue size in hadoop producer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="swapnilghike">Swapnil Ghike</assignee>
                                    <reporter username="swapnilghike">Swapnil Ghike</reporter>
                        <labels>
                            <label>bugs</label>
                    </labels>
                <created>Tue, 30 Jul 2013 23:11:32 +0000</created>
                <updated>Fri, 2 Aug 2013 00:12:44 +0000</updated>
                            <resolved>Fri, 2 Aug 2013 00:12:34 +0000</resolved>
                                    <version>0.8.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13726891" author="jkreps" created="Thu, 1 Aug 2013 21:03:02 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13726955" author="swapnilghike" created="Thu, 1 Aug 2013 21:59:36 +0000"  >&lt;p&gt;Also reviewed by Jun, Neha. The reason why we use sync producer in hadoop producer is because the caller may want to get the exceptions from kafka producer and kill their job.&lt;/p&gt;</comment>
                            <comment id="13726958" author="jjkoshy" created="Thu, 1 Aug 2013 21:59:52 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Committed to 0.8&lt;/p&gt;

&lt;p&gt;Minor comment:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;queue size is unintuitive. sounds like number of messages, but it is bytes&lt;/li&gt;
	&lt;li&gt;The totalSize &amp;gt; queueSize check should ideally be done before adding it to msgList.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13726995" author="swapnilghike" created="Thu, 1 Aug 2013 22:32:54 +0000"  >&lt;p&gt;Thanks Joel. Would you mind committing the follow up patch as well, so that we can complete the hadoop producer queue size/queue bytes related change.&lt;/p&gt;</comment>
                            <comment id="13727026" author="swapnilghike" created="Thu, 1 Aug 2013 22:54:50 +0000"  >&lt;p&gt;Fixed README.&lt;/p&gt;</comment>
                            <comment id="13727092" author="jjkoshy" created="Thu, 1 Aug 2013 23:42:48 +0000"  >&lt;p&gt;Thanks for the follow-up patch. totalBytes is set to zero in sendMsgList so the next batch totalBytes will less (incorrect) by valBytes.&lt;/p&gt;</comment>
                            <comment id="13727101" author="swapnilghike" created="Thu, 1 Aug 2013 23:49:24 +0000"  >&lt;p&gt;Thanks, attached a new patch to address that.&lt;/p&gt;</comment>
                            <comment id="13727138" author="jjkoshy" created="Fri, 2 Aug 2013 00:12:44 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Committed to 0.8&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12595517" name="kafka-991-followup-3.patch" size="4740" author="swapnilghike" created="Thu, 1 Aug 2013 23:49:24 +0000"/>
                            <attachment id="12595506" name="kafka-991-followup-v2.patch" size="4573" author="swapnilghike" created="Thu, 1 Aug 2013 22:54:50 +0000"/>
                            <attachment id="12595504" name="kafka-991-followup.patch" size="3985" author="swapnilghike" created="Thu, 1 Aug 2013 22:33:03 +0000"/>
                            <attachment id="12595126" name="kafka-991-v1.patch" size="2376" author="swapnilghike" created="Wed, 31 Jul 2013 04:53:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>341001</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1mt9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>341319</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>