<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:40:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-17154] New consumer subscribe may join group without a call to consumer.poll</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-17154</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;With the new consumer, a call to consumer.subscribe will update the client subscription state via a SubscriptionChangedEvent. This will be picked up by the background thread, and will send a Heartbeat RPC on the next poll of the background thread (without requiring a consumer.poll). This is a change in behaviour with the legacy consumer, that breaks the consumer#subscribe contract for &quot;rebalances will only occur during an active call to {@link #poll(Duration)}&quot;, so it should be fixed.&#160;&#160;&lt;/p&gt;

&lt;p&gt;In the legacy its a similar principle but different behaviour: subscribe changes the subscription state, and the coordinator picks it up to send the JoinRequest on the next poll of the coordinator (but this happens only as part of a consumer.poll)&lt;/p&gt;

&lt;p&gt;We should make the new consumer join (send HB to join) only on consumer.poll after a call to subscribed. We could consider having the SubscriptionChangedEvent only signal to the background that the subscription changed without doing the transition to JOINING that triggers the HB (membershipMgr#onSubscriptionUpdated could simply flip a flag, no transition), and then do the actual transition to JOINING when processing a PollEvent if the flag is on (flipping it back). (Just first simple approach that comes to mind, we should think about it a bit more and consider other interactions that could happen in between, like unsubscribe, close, etc).&lt;/p&gt;

&lt;p&gt;We should add test coverage to ensure the common behaviour with the legacy.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13586147">KAFKA-17154</key>
            <summary>New consumer subscribe may join group without a call to consumer.poll</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yangpoan">PoAn Yang</assignee>
                                    <reporter username="lianetm">Lianet Magrans</reporter>
                        <labels>
                            <label>kip-848-client-support</label>
                    </labels>
                <created>Wed, 17 Jul 2024 14:33:16 +0000</created>
                <updated>Thu, 26 Sep 2024 20:23:37 +0000</updated>
                            <resolved>Thu, 26 Sep 2024 18:55:53 +0000</resolved>
                                    <version>3.8.0</version>
                                    <fixVersion>4.0.0</fixVersion>
                                    <component>clients</component>
                    <component>consumer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17867031" author="JIRAUSER300229" created="Thu, 18 Jul 2024 14:54:41 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lianetm&quot; class=&quot;user-hover&quot; rel=&quot;lianetm&quot;&gt;lianetm&lt;/a&gt;, I&apos;m interested in this jira. If you&apos;re not working on it, may I assign to myself? Thank you.&lt;/p&gt;</comment>
                            <comment id="17867036" author="JIRAUSER300183" created="Thu, 18 Jul 2024 15:15:41 +0000"  >&lt;p&gt;Sure, assigned to you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yangpoan&quot; class=&quot;user-hover&quot; rel=&quot;yangpoan&quot;&gt;yangpoan&lt;/a&gt;, thanks a lot! The description has the first approach that comes to mind but we should review the details in case I&apos;m missing some interaction. Let me know if you have any questions.&#160;&lt;/p&gt;</comment>
                            <comment id="17880427" author="JIRAUSER300183" created="Mon, 9 Sep 2024 20:39:23 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yangpoan&quot; class=&quot;user-hover&quot; rel=&quot;yangpoan&quot;&gt;yangpoan&lt;/a&gt; , just bumping this one up to make sure we have it in our radar. Are you still planning to work on it before 4.0? Let me know if you need any help. Thanks a lot!&#160;&lt;/p&gt;</comment>
                            <comment id="17880824" author="JIRAUSER300229" created="Wed, 11 Sep 2024 01:27:18 +0000"  >&lt;p&gt;Yes, I&apos;ll work on it this week. Thank you.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 8 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1qecw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>