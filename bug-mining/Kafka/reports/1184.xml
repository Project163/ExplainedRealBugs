<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:56:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-4131] Multiple Regex KStream-Consumers cause Null pointer exception in addRawRecords in RecordQueue class</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-4131</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;When you start two consumer processes with a regex topic (with 2 or more&lt;br/&gt;
partitions for the matching topics), the second (i.e. nonleader) consumer&lt;br/&gt;
will fail with a null pointer exception.&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;StreamThread-4&quot; java.lang.NullPointerException&lt;br/&gt;
                 at org.apache.kafka.streams.processor.internals.&lt;br/&gt;
RecordQueue.addRawRecords(RecordQueue.java:78)&lt;br/&gt;
                 at org.apache.kafka.streams.processor.internals.&lt;br/&gt;
PartitionGroup.addRawRecords(PartitionGroup.java:117)&lt;br/&gt;
                 at org.apache.kafka.streams.processor.internals.&lt;br/&gt;
StreamTask.addRecords(StreamTask.java:139)&lt;br/&gt;
                 at org.apache.kafka.streams.processor.internals.&lt;br/&gt;
StreamThread.runLoop(StreamThread.java:299)&lt;br/&gt;
                 at org.apache.kafka.streams.processor.internals.&lt;br/&gt;
StreamThread.run(StreamThread.java:208)&lt;/p&gt;

&lt;p&gt;The issue may be in the TopologyBuilder line 832:&lt;br/&gt;
String[] topics = (sourceNodeFactory.pattern != null) ?&lt;br/&gt;
sourceNodeFactory.getTopics(subscriptionUpdates.getUpdates()) :&lt;br/&gt;
sourceNodeFactory.getTopics();&lt;/p&gt;

&lt;p&gt;Because the 2nd consumer joins as a follower, &#8220;getUpdates&#8221; returns an&lt;br/&gt;
empty collection and the regular expression doesn&#8217;t get applied to any&lt;br/&gt;
topics.&lt;/p&gt;

&lt;p&gt;Steps to Reproduce:&lt;br/&gt;
1.) Create at least two topics with at least 2 partitions each.  And start sending messages to them.&lt;br/&gt;
2.) Start a single threaded Regex KStream-Consumer (i.e. becomes the leader)&lt;br/&gt;
3)  Start a new instance of this consumer (i.e. it should receive some of the partitions)&lt;/p&gt;

&lt;p&gt;The second consumer will die with the above exception.&lt;/p&gt;
</description>
                <environment>Servers: Confluent Distribution 3.0.0 (i.e. kafka 0.10.0 release)&lt;br/&gt;
Client: Kafka-streams and Kafka-client... commit: 6fb33afff976e467bfa8e0b29eb827&lt;br/&gt;
70a2a3aaec</environment>
        <key id="13002947">KAFKA-4131</key>
            <summary>Multiple Regex KStream-Consumers cause Null pointer exception in addRawRecords in RecordQueue class</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bbejeck">Bill Bejeck</assignee>
                                    <reporter username="djchooy">David J. Garcia</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Sep 2016 15:09:38 +0000</created>
                <updated>Fri, 16 Sep 2016 00:08:38 +0000</updated>
                            <resolved>Fri, 16 Sep 2016 00:08:15 +0000</resolved>
                                    <version>0.10.1.0</version>
                                    <fixVersion>0.10.1.0</fixVersion>
                                    <component>streams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15467695" author="bbejeck" created="Tue, 6 Sep 2016 15:29:53 +0000"  >&lt;p&gt;If it&apos;s ok, I&apos;ll pick this one up&lt;/p&gt;</comment>
                            <comment id="15469669" author="guozhang" created="Wed, 7 Sep 2016 06:01:29 +0000"  >&lt;p&gt;Thanks Bill!&lt;/p&gt;</comment>
                            <comment id="15478891" author="githubbot" created="Sat, 10 Sep 2016 01:42:05 +0000"  >&lt;p&gt;GitHub user bbejeck opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1843&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1843&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4131&quot; title=&quot;Multiple Regex KStream-Consumers cause Null pointer exception in addRawRecords in RecordQueue class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4131&quot;&gt;&lt;del&gt;KAFKA-4131&lt;/del&gt;&lt;/a&gt;: moved updates for topics matching regex subscription meth&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;od, allows for followers to get subscribed topics&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/bbejeck/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/bbejeck/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4131&quot; title=&quot;Multiple Regex KStream-Consumers cause Null pointer exception in addRawRecords in RecordQueue class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4131&quot;&gt;&lt;del&gt;KAFKA-4131&lt;/del&gt;&lt;/a&gt;_mulitple_regex_consumers_cause_npe&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1843.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1843.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1843&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 0816ecc454cb9d7504fbc2c48549e3f4eb2b5f22&lt;br/&gt;
Author: bbejeck &amp;lt;bbejeck@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-09-10T01:40:12Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4131&quot; title=&quot;Multiple Regex KStream-Consumers cause Null pointer exception in addRawRecords in RecordQueue class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4131&quot;&gt;&lt;del&gt;KAFKA-4131&lt;/del&gt;&lt;/a&gt;: moved updates for topics matching regex subscription method, allows for followers to get subscribed topics&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15478902" author="bbejeck" created="Sat, 10 Sep 2016 01:50:23 +0000"  >&lt;p&gt;Working on getting an integration test for this bug fix.&lt;/p&gt;</comment>
                            <comment id="15494911" author="guozhang" created="Fri, 16 Sep 2016 00:08:17 +0000"  >&lt;p&gt;Issue resolved by pull request 1843&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/1843&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1843&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15494913" author="githubbot" created="Fri, 16 Sep 2016 00:08:38 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1843&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1843&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 9 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33acn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>