<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:42:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-1742] ControllerContext removeTopic does not correctly update state</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-1742</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;removeTopic does not correctly update the state of ControllerContext.&lt;/p&gt;

&lt;p&gt;This is because it removes the topic from some underlying maps through dropWhile.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12752061">KAFKA-1742</key>
            <summary>ControllerContext removeTopic does not correctly update state</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="onurkaraman">Onur Karaman</assignee>
                                    <reporter username="onurkaraman">Onur Karaman</reporter>
                        <labels>
                    </labels>
                <created>Fri, 31 Oct 2014 20:13:53 +0000</created>
                <updated>Wed, 12 Nov 2014 02:44:57 +0000</updated>
                            <resolved>Wed, 12 Nov 2014 02:44:57 +0000</resolved>
                                                    <fixVersion>0.8.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14192733" author="onurkaraman" created="Fri, 31 Oct 2014 23:26:48 +0000"  >&lt;p&gt;partitionLeadershipInfo and partitionReplicaAssignment are mutable.Maps. Given that a mutable.Map may be arbitrarily ordered, dropping the longest prefix of elements that satisfy a predicate can cause incorrect results.&lt;/p&gt;

&lt;p&gt;It&apos;s also noted in the scaladocs &lt;a href=&quot;http://www.scala-lang.org/api/current/index.html#scala.collection.mutable.Map@dropWhile(p:A=&amp;gt;Boolean):Repr&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.scala-lang.org/api/current/index.html#scala.collection.mutable.Map@dropWhile(p:A=&amp;gt;Boolean):Repr&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; collection._

object Main {
  def main(args: Array[&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;]) {
    &lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt; m = mutable.Map(5 -&amp;gt; 2, 3 -&amp;gt; 6)
    println(&lt;span class=&quot;code-quote&quot;&gt;&quot;original: &quot;&lt;/span&gt; + m)
    println(&lt;span class=&quot;code-quote&quot;&gt;&quot;using filter: &quot;&lt;/span&gt; + m.filter(p =&amp;gt; p._1 != 3))
    println(&lt;span class=&quot;code-quote&quot;&gt;&quot;using dropWhile: &quot;&lt;/span&gt; + m.dropWhile(p =&amp;gt; p._1 == 3))
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Outputs:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;original: Map(5 -&amp;gt; 2, 3 -&amp;gt; 6)
using filter: Map(5 -&amp;gt; 2)
using dropWhile: Map(5 -&amp;gt; 2, 3 -&amp;gt; 6)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14202418" author="guozhang" created="Fri, 7 Nov 2014 18:37:46 +0000"  >&lt;p&gt;Thanks for the patch, looks good to me.&lt;/p&gt;</comment>
                            <comment id="14202955" author="jjkoshy" created="Fri, 7 Nov 2014 23:48:39 +0000"  >&lt;p&gt;+1, although one minor change:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// instead of
&lt;/span&gt;filter(p =&amp;gt; !p._1.topic.equals(topic)
&lt;span class=&quot;code-comment&quot;&gt;//
&lt;/span&gt;filter{ &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;(topicPartition, _) =&amp;gt; topicPartition.topic != topicToRemove }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m a bit divided on the usefulness of the unit test.&lt;/p&gt;</comment>
                            <comment id="14204256" author="nehanarkhede" created="Mon, 10 Nov 2014 02:28:57 +0000"  >&lt;p&gt;+1 on the change but I think we don&apos;t want to add a separate test suite just for controller context. We may be able to do without the test. &lt;/p&gt;</comment>
                            <comment id="14205193" author="guozhang" created="Mon, 10 Nov 2014 19:31:27 +0000"  >&lt;p&gt;Actually, just realized that we do not have a &quot;controller&quot; test suite under scala.unit.kafka before, and the tests in the &quot;server&quot;, and this would be a first step adding such a test suite to controller modules. The current test scope &quot;ControllerContextTest&quot; also looks fine to me, but in the future as we add more test cases into it we can always generalize the test class name.&lt;/p&gt;</comment>
                            <comment id="14205214" author="onurkaraman" created="Mon, 10 Nov 2014 19:44:00 +0000"  >&lt;p&gt;Updated patch with Joel&apos;s suggestion to&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;filter{ &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; (topicAndPartition, _) =&amp;gt; ... }&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14207591" author="jjkoshy" created="Wed, 12 Nov 2014 02:44:45 +0000"  >&lt;p&gt;+1 and committed to trunk and 0.8.2&lt;/p&gt;

&lt;p&gt;Based on the review comments I did not include the unit test. I think it makes sense to work out a full-fledged unit test suite for controller in general.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12680637" name="KAFKA-1742.patch" size="4503" author="onurkaraman" created="Mon, 10 Nov 2014 19:44:00 +0000"/>
                            <attachment id="12680100" name="KAFKA-1742.patch" size="4433" author="onurkaraman" created="Fri, 7 Nov 2014 06:11:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21tzr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>