<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:21:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-9212] Keep receiving FENCED_LEADER_EPOCH while sending ListOffsetRequest</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-9212</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;When running Kafka connect s3 sink connector ( confluent 5.3.0), after one broker got restarted (leaderEpoch updated at this point), the connect worker crashed with the following error :&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2019-11-19 16:20:30,097&amp;#93;&lt;/span&gt; ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;Worker clientId=connect-1, groupId=connect-ls&amp;#93;&lt;/span&gt; Uncaught exception in herder work thread, exiting: (org.apache.kafka.connect.runtime.distributed.DistributedHerder:253)&lt;br/&gt;
 org.apache.kafka.common.errors.TimeoutException: Failed to get offsets by times in 30003ms&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;After investigation, it seems it&apos;s because it got fenced when sending ListOffsetRequest in loop and then got timed out , as follows :&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2019-11-19 16:20:30,020&amp;#93;&lt;/span&gt; DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Consumer clientId=consumer-3, groupId=connect-ls&amp;#93;&lt;/span&gt; Sending ListOffsetRequest (type=ListOffsetRequest, replicaId=-1, partitionTimestamps={connect_ls_config-0={timestamp: -1, maxNumOffsets: 1, currentLeaderEpoch: Optional&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;}}, isolationLevel=READ_UNCOMMITTED) to broker kafka6.fra2.internal:9092 (id: 4 rack: null) (org.apache.kafka.clients.consumer.internals.Fetcher:905)&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2019-11-19 16:20:30,044&amp;#93;&lt;/span&gt; DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Consumer clientId=consumer-3, groupId=connect-ls&amp;#93;&lt;/span&gt; Attempt to fetch offsets for partition connect_ls_config-0 failed due to FENCED_LEADER_EPOCH, retrying. (org.apache.kafka.clients.consumer.internals.Fetcher:985)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The above happens multiple times until timeout.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;According to the debugs, the consumer always get a leaderEpoch of 1 for this topic when starting up :&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
 &lt;span class=&quot;error&quot;&gt;&amp;#91;2019-11-19 13:27:30,802&amp;#93;&lt;/span&gt; DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Consumer clientId=consumer-3, groupId=connect-ls&amp;#93;&lt;/span&gt; Updating last seen epoch from null to 1 for partition connect_ls_config-0 (org.apache.kafka.clients.Metadata:178)&lt;br/&gt;
 &#160;&lt;br/&gt;
 &#160;&lt;br/&gt;
 But according to our brokers log, the leaderEpoch should be 2, as follows :&lt;br/&gt;
 &#160;&lt;br/&gt;
 &lt;span class=&quot;error&quot;&gt;&amp;#91;2019-11-18 14:19:28,988&amp;#93;&lt;/span&gt; INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;Partition connect_ls_config-0 broker=4&amp;#93;&lt;/span&gt; connect_ls_config-0 starts at Leader Epoch 2 from offset 22. Previous Leader Epoch was: 1 (kafka.cluster.Partition)&lt;br/&gt;
 &#160;&lt;br/&gt;
 &#160;&lt;br/&gt;
 This make impossible to restart the worker as it will always get fenced and then finally timeout.&lt;br/&gt;
 &#160;&lt;br/&gt;
 It is also impossible to consume with a 2.3 kafka-console-consumer as follows :&lt;br/&gt;
 &#160;&lt;br/&gt;
 kafka-console-consumer --bootstrap-server BOOTSTRAPSERVER:9092 --topic connect_ls_config --from-beginning&#160;&lt;br/&gt;
 &#160;&lt;br/&gt;
 the above will just hang forever ( which is not expected cause there is data) and we can see those debug messages :&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2019-11-19 22:17:59,124&amp;#93;&lt;/span&gt; DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Consumer clientId=consumer-1, groupId=console-consumer-3844&amp;#93;&lt;/span&gt; Attempt to fetch offsets for partition connect_ls_config-0 failed due to FENCED_LEADER_EPOCH, retrying. (org.apache.kafka.clients.consumer.internals.Fetcher)&lt;br/&gt;
 &#160;&lt;br/&gt;
 &#160;&lt;br/&gt;
 Interesting fact, if we do subscribe the same way with kafkacat (1.5.0) we can consume without problem ( must be the way kafkacat is consuming ignoring FENCED_LEADER_EPOCH):&lt;br/&gt;
 &#160;&lt;br/&gt;
 kafkacat -b BOOTSTRAPSERVER:9092 -t connect_ls_config -o beginning&lt;br/&gt;
 &#160;&lt;br/&gt;
 &#160;&lt;/p&gt;</description>
                <environment>Linux</environment>
        <key id="13269430">KAFKA-9212</key>
            <summary>Keep receiving FENCED_LEADER_EPOCH while sending ListOffsetRequest</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hachikuji">Jason Gustafson</assignee>
                                    <reporter username="Lambruschi">Yannick</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Nov 2019 22:08:02 +0000</created>
                <updated>Tue, 10 Dec 2019 03:52:25 +0000</updated>
                            <resolved>Tue, 10 Dec 2019 03:52:25 +0000</resolved>
                                    <version>2.3.0</version>
                    <version>2.3.1</version>
                                    <fixVersion>2.3.2</fixVersion>
                    <fixVersion>2.4.0</fixVersion>
                                    <component>consumer</component>
                    <component>offset manager</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16978305" author="lambruschi" created="Wed, 20 Nov 2019 10:45:36 +0000"  >&lt;p&gt;As expected, when we use a 2.2.1 API client ( kafka-console-consumer) this works fine, sureley because it&apos;s ingnoring FENCED_LEADER_EPOCH answers&lt;/p&gt;</comment>
                            <comment id="16979153" author="lambruschi" created="Thu, 21 Nov 2019 10:17:43 +0000"  >&lt;p&gt;Here are leader-epoch-checkpoint on each broker ( 3 in total which are 1, 3 and 4l)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Broker ID 4 ( the current partition leader during issue):&lt;/p&gt;

&lt;p&gt;cat /var/lib/kafka/logs/connect_ls_config-0/leader-epoch-checkpoint&lt;br/&gt;
0&lt;br/&gt;
2&lt;br/&gt;
0 0&lt;br/&gt;
2 22&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Broker ID 1 :&lt;/p&gt;

&lt;p&gt;cat /var/lib/kafka/logs/connect_ls_config-0/leader-epoch-checkpoint&lt;br/&gt;
0&lt;br/&gt;
1&lt;br/&gt;
0 0&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Broker ID 3:&lt;/p&gt;

&lt;p&gt;cat /var/lib/kafka/logs/connect_ls_config-0/leader-epoch-checkpoint&lt;br/&gt;
0&lt;br/&gt;
1&lt;br/&gt;
0 0&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;And config topic comes from kafka connect worker default creation ( compacted topic) :&lt;/p&gt;

&lt;p&gt;Topic:connect_ls_config PartitionCount:1 ReplicationFactor:3 Configs:min.insync.replicas=2,cleanup.policy=compact,segment.bytes=1073741824,max.message.bytes=30000000&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16982018" author="hachikuji" created="Tue, 26 Nov 2019 00:59:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Lambruschi&quot; class=&quot;user-hover&quot; rel=&quot;Lambruschi&quot;&gt;Lambruschi&lt;/a&gt;&#160;The output from the leader epoch checkpoints is curious. The contents should match for all replicas. Is replication working for this partition? I&apos;d suggest using `bin/kafka-dump-log.sh` to dump the log contents for each `.log` file for that partition and see if they match. It would also be useful to see the broker config.&lt;/p&gt;</comment>
                            <comment id="16982412" author="lambruschi" created="Tue, 26 Nov 2019 12:03:37 +0000"  >&lt;p&gt;Yeah the topic is correctly replicated according metadata output from tools like kafkacat :&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;As of today, we downgrade our clients to 2.2.1 to avoid being stuck in this fencing loop ( 2.3 client handle the&#160;FENCED_LEADER_EPOCH ).&lt;/p&gt;

&lt;p&gt;We restarted the 3 brokers ( rolling restart) and still have discrepancies between those checkpoint files as follows :&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Broker ID 4 :&lt;/p&gt;

&lt;p&gt;cat /var/lib/kafka/logs/connect_ls_config-0/leader-epoch-checkpoint&lt;br/&gt;
0&lt;br/&gt;
2&lt;br/&gt;
0 0&lt;br/&gt;
6 22&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Broker ID 1 :&lt;/p&gt;

&lt;p&gt;cat /var/lib/kafka/logs/connect_ls_config-0/leader-epoch-checkpoint&lt;br/&gt;
0&lt;br/&gt;
2&lt;br/&gt;
0 0&lt;br/&gt;
5 22&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Broker ID 3:&lt;/p&gt;

&lt;p&gt;cat /var/lib/kafka/logs/connect_ls_config-0/leader-epoch-checkpoint&lt;br/&gt;
0&lt;br/&gt;
1&lt;br/&gt;
0 0&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Regarding the dump of this topic, here they are ( there is just one .log file . for all brokers) ( cannot show the content using print-data-log as it might contain sensitive info) :&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Broker ID 1 :&lt;/p&gt;

&lt;p&gt;/opt/kafka/bin/kafka-run-class.sh kafka.tools.DumpLogSegments --files /var/lib/kafka/logs/connect_ls_config-0/00000000000000000000.log&lt;br/&gt;
Dumping /var/lib/kafka/logs/connect_ls_config-0/00000000000000000000.log&lt;br/&gt;
Starting offset: 0&lt;br/&gt;
baseOffset: 0 lastOffset: 0 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 0 CreateTime: 1573660711038 size: 962 magic: 2 compresscodec: NONE crc: 1786879997 isvalid: true&lt;br/&gt;
baseOffset: 1 lastOffset: 1 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 962 CreateTime: 1573660712089 size: 1009 magic: 2 compresscodec: NONE crc: 1230182444 isvalid: true&lt;br/&gt;
baseOffset: 2 lastOffset: 3 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 1971 CreateTime: 1573660712091 size: 1957 magic: 2 compresscodec: NONE crc: 2419651795 isvalid: true&lt;br/&gt;
baseOffset: 4 lastOffset: 4 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 3928 CreateTime: 1573660712611 size: 89 magic: 2 compresscodec: NONE crc: 3321423372 isvalid: true&lt;br/&gt;
baseOffset: 5 lastOffset: 5 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 4017 CreateTime: 1573751698440 size: 962 magic: 2 compresscodec: NONE crc: 704355531 isvalid: true&lt;br/&gt;
baseOffset: 6 lastOffset: 6 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 4979 CreateTime: 1573751699462 size: 1009 magic: 2 compresscodec: NONE crc: 1489459952 isvalid: true&lt;br/&gt;
baseOffset: 7 lastOffset: 8 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 5988 CreateTime: 1573751699463 size: 1957 magic: 2 compresscodec: NONE crc: 657348671 isvalid: true&lt;br/&gt;
baseOffset: 9 lastOffset: 9 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 7945 CreateTime: 1573751699985 size: 89 magic: 2 compresscodec: NONE crc: 1825092385 isvalid: true&lt;br/&gt;
baseOffset: 10 lastOffset: 11 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 8034 CreateTime: 1573828311242 size: 104 magic: 2 compresscodec: NONE crc: 3533917687 isvalid: true&lt;br/&gt;
baseOffset: 12 lastOffset: 12 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 8138 CreateTime: 1573828467292 size: 953 magic: 2 compresscodec: NONE crc: 232359935 isvalid: true&lt;br/&gt;
baseOffset: 13 lastOffset: 13 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 9091 CreateTime: 1573828467807 size: 1000 magic: 2 compresscodec: NONE crc: 1484213287 isvalid: true&lt;br/&gt;
baseOffset: 14 lastOffset: 15 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 10091 CreateTime: 1573828467808 size: 1939 magic: 2 compresscodec: NONE crc: 49865436 isvalid: true&lt;br/&gt;
baseOffset: 16 lastOffset: 16 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 12030 CreateTime: 1573828468331 size: 94 magic: 2 compresscodec: NONE crc: 1480833250 isvalid: true&lt;br/&gt;
baseOffset: 17 lastOffset: 17 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 12124 CreateTime: 1573828530715 size: 986 magic: 2 compresscodec: NONE crc: 678439265 isvalid: true&lt;br/&gt;
baseOffset: 18 lastOffset: 19 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 13110 CreateTime: 1573828531239 size: 2005 magic: 2 compresscodec: NONE crc: 1542429159 isvalid: true&lt;br/&gt;
baseOffset: 20 lastOffset: 20 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 15115 CreateTime: 1573828531239 size: 1033 magic: 2 compresscodec: NONE crc: 865245135 isvalid: true&lt;br/&gt;
baseOffset: 21 lastOffset: 21 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 16148 CreateTime: 1573828531761 size: 101 magic: 2 compresscodec: NONE crc: 4023495638 isvalid: true&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Broker ID 3 :&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;~$ /opt/kafka/bin/kafka-run-class.sh kafka.tools.DumpLogSegments --files /var/lib/kafka/logs/connect_ls_config-0/00000000000000000000.log&lt;br/&gt;
Dumping /var/lib/kafka/logs/connect_ls_config-0/00000000000000000000.log&lt;br/&gt;
Starting offset: 0&lt;br/&gt;
baseOffset: 0 lastOffset: 0 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 0 CreateTime: 1573660711038 size: 962 magic: 2 compresscodec: NONE crc: 1786879997 isvalid: true&lt;br/&gt;
baseOffset: 1 lastOffset: 1 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 962 CreateTime: 1573660712089 size: 1009 magic: 2 compresscodec: NONE crc: 1230182444 isvalid: true&lt;br/&gt;
baseOffset: 2 lastOffset: 3 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 1971 CreateTime: 1573660712091 size: 1957 magic: 2 compresscodec: NONE crc: 2419651795 isvalid: true&lt;br/&gt;
baseOffset: 4 lastOffset: 4 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 3928 CreateTime: 1573660712611 size: 89 magic: 2 compresscodec: NONE crc: 3321423372 isvalid: true&lt;br/&gt;
baseOffset: 5 lastOffset: 5 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 4017 CreateTime: 1573751698440 size: 962 magic: 2 compresscodec: NONE crc: 704355531 isvalid: true&lt;br/&gt;
baseOffset: 6 lastOffset: 6 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 4979 CreateTime: 1573751699462 size: 1009 magic: 2 compresscodec: NONE crc: 1489459952 isvalid: true&lt;br/&gt;
baseOffset: 7 lastOffset: 8 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 5988 CreateTime: 1573751699463 size: 1957 magic: 2 compresscodec: NONE crc: 657348671 isvalid: true&lt;br/&gt;
baseOffset: 9 lastOffset: 9 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 7945 CreateTime: 1573751699985 size: 89 magic: 2 compresscodec: NONE crc: 1825092385 isvalid: true&lt;br/&gt;
baseOffset: 10 lastOffset: 11 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 8034 CreateTime: 1573828311242 size: 104 magic: 2 compresscodec: NONE crc: 3533917687 isvalid: true&lt;br/&gt;
baseOffset: 12 lastOffset: 12 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 8138 CreateTime: 1573828467292 size: 953 magic: 2 compresscodec: NONE crc: 232359935 isvalid: true&lt;br/&gt;
baseOffset: 13 lastOffset: 13 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 9091 CreateTime: 1573828467807 size: 1000 magic: 2 compresscodec: NONE crc: 1484213287 isvalid: true&lt;br/&gt;
baseOffset: 14 lastOffset: 15 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 10091 CreateTime: 1573828467808 size: 1939 magic: 2 compresscodec: NONE crc: 49865436 isvalid: true&lt;br/&gt;
baseOffset: 16 lastOffset: 16 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 12030 CreateTime: 1573828468331 size: 94 magic: 2 compresscodec: NONE crc: 1480833250 isvalid: true&lt;br/&gt;
baseOffset: 17 lastOffset: 17 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 12124 CreateTime: 1573828530715 size: 986 magic: 2 compresscodec: NONE crc: 678439265 isvalid: true&lt;br/&gt;
baseOffset: 18 lastOffset: 19 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 13110 CreateTime: 1573828531239 size: 2005 magic: 2 compresscodec: NONE crc: 1542429159 isvalid: true&lt;br/&gt;
baseOffset: 20 lastOffset: 20 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 15115 CreateTime: 1573828531239 size: 1033 magic: 2 compresscodec: NONE crc: 865245135 isvalid: true&lt;br/&gt;
baseOffset: 21 lastOffset: 21 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 16148 CreateTime: 1573828531761 size: 101 magic: 2 compresscodec: NONE crc: 4023495638 isvalid: true&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Broker ID 4 :&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Dumping /var/lib/kafka/logs/connect_ls_config-0/00000000000000000000.log&lt;br/&gt;
Starting offset: 0&lt;br/&gt;
baseOffset: 0 lastOffset: 0 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 0 CreateTime: 1573660711038 size: 962 magic: 2 compresscodec: NONE crc: 1786879997 isvalid: true&lt;br/&gt;
baseOffset: 1 lastOffset: 1 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 962 CreateTime: 1573660712089 size: 1009 magic: 2 compresscodec: NONE crc: 1230182444 isvalid: true&lt;br/&gt;
baseOffset: 2 lastOffset: 3 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 1971 CreateTime: 1573660712091 size: 1957 magic: 2 compresscodec: NONE crc: 2419651795 isvalid: true&lt;br/&gt;
baseOffset: 4 lastOffset: 4 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 3928 CreateTime: 1573660712611 size: 89 magic: 2 compresscodec: NONE crc: 3321423372 isvalid: true&lt;br/&gt;
baseOffset: 5 lastOffset: 5 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 4017 CreateTime: 1573751698440 size: 962 magic: 2 compresscodec: NONE crc: 704355531 isvalid: true&lt;br/&gt;
baseOffset: 6 lastOffset: 6 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 4979 CreateTime: 1573751699462 size: 1009 magic: 2 compresscodec: NONE crc: 1489459952 isvalid: true&lt;br/&gt;
baseOffset: 7 lastOffset: 8 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 5988 CreateTime: 1573751699463 size: 1957 magic: 2 compresscodec: NONE crc: 657348671 isvalid: true&lt;br/&gt;
baseOffset: 9 lastOffset: 9 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 7945 CreateTime: 1573751699985 size: 89 magic: 2 compresscodec: NONE crc: 1825092385 isvalid: true&lt;br/&gt;
baseOffset: 10 lastOffset: 11 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 8034 CreateTime: 1573828311242 size: 104 magic: 2 compresscodec: NONE crc: 3533917687 isvalid: true&lt;br/&gt;
baseOffset: 12 lastOffset: 12 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 8138 CreateTime: 1573828467292 size: 953 magic: 2 compresscodec: NONE crc: 232359935 isvalid: true&lt;br/&gt;
baseOffset: 13 lastOffset: 13 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 9091 CreateTime: 1573828467807 size: 1000 magic: 2 compresscodec: NONE crc: 1484213287 isvalid: true&lt;br/&gt;
baseOffset: 14 lastOffset: 15 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 10091 CreateTime: 1573828467808 size: 1939 magic: 2 compresscodec: NONE crc: 49865436 isvalid: true&lt;br/&gt;
baseOffset: 16 lastOffset: 16 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 12030 CreateTime: 1573828468331 size: 94 magic: 2 compresscodec: NONE crc: 1480833250 isvalid: true&lt;br/&gt;
baseOffset: 17 lastOffset: 17 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 12124 CreateTime: 1573828530715 size: 986 magic: 2 compresscodec: NONE crc: 678439265 isvalid: true&lt;br/&gt;
baseOffset: 18 lastOffset: 19 count: 2 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 13110 CreateTime: 1573828531239 size: 2005 magic: 2 compresscodec: NONE crc: 1542429159 isvalid: true&lt;br/&gt;
baseOffset: 20 lastOffset: 20 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 15115 CreateTime: 1573828531239 size: 1033 magic: 2 compresscodec: NONE crc: 865245135 isvalid: true&lt;br/&gt;
baseOffset: 21 lastOffset: 21 count: 1 baseSequence: -1 lastSequence: -1 producerId: -1 producerEpoch: -1 partitionLeaderEpoch: 0 isTransactional: false isControl: false position: 16148 CreateTime: 1573828531761 size: 101 magic: 2 compresscodec: NONE crc: 4023495638 isvalid: true&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Here is the conf used by all brokers :&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;broker.id=XX&lt;/p&gt;

&lt;p&gt;delete.topic.enable=true&lt;/p&gt;


&lt;p&gt;listeners=INSIDE://0.0.0.0:9092,OUTSIDE://0.0.0.0:9492&lt;br/&gt;
advertised.listeners=REDACTED&lt;br/&gt;
listener.security.protocol.map=INSIDE:PLAINTEXT,OUTSIDE:SSL&lt;br/&gt;
inter.broker.listener.name=INSIDE&lt;br/&gt;
#SSL conf REDACTED&lt;/p&gt;

&lt;p&gt;ssl.client.auth=required&lt;br/&gt;
num.network.threads=3&lt;/p&gt;

&lt;p&gt;num.io.threads=8&lt;/p&gt;

&lt;p&gt;socket.send.buffer.bytes=102400&lt;/p&gt;

&lt;p&gt;socket.receive.buffer.bytes=102400&lt;/p&gt;

&lt;p&gt;socket.request.max.bytes=104857600&lt;/p&gt;

&lt;p&gt;inter.broker.protocol.version=2.3&lt;/p&gt;

&lt;p&gt;&#160;auto.create.topics.enable=true&lt;/p&gt;

&lt;p&gt;log.dirs=/var/lib/kafka/logs&lt;/p&gt;

&lt;p&gt;num.partitions=3&lt;/p&gt;

&lt;p&gt;num.recovery.threads.per.data.dir=1&lt;/p&gt;

&lt;p&gt;default.replication.factor=3&lt;/p&gt;

&lt;p&gt;offsets.topic.replication.factor=3&lt;br/&gt;
transaction.state.log.replication.factor=3&lt;br/&gt;
transaction.state.log.min.isr=2&lt;/p&gt;

&lt;p&gt;replica.socket.timeout.ms=30000&lt;/p&gt;

&lt;p&gt;replica.fetch.wait.max.ms=5000&lt;/p&gt;

&lt;p&gt;replica.lag.time.max.ms=15000&lt;/p&gt;

&lt;p&gt;min.insync.replicas=2&lt;/p&gt;

&lt;p&gt;acks=all&lt;/p&gt;

&lt;p&gt;log.retention.hours=24&lt;/p&gt;


&lt;p&gt;log.segment.bytes=1073741824&lt;/p&gt;

&lt;p&gt;log.retention.check.interval.ms=300000&lt;/p&gt;

&lt;p&gt;log.roll.hours=168&lt;/p&gt;


&lt;p&gt;zookeeper.connect=REDACTED&lt;/p&gt;

&lt;p&gt;zookeeper.connection.timeout.ms=6000&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;group.initial.rebalance.delay.ms=3000&lt;/p&gt;

&lt;p&gt;transactional.id.expiration.ms=1814400000&lt;/p&gt;

&lt;p&gt;offsets.retention.minutes=11580&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16989287" author="mjaschob@twilio.com" created="Fri, 6 Dec 2019 00:59:46 +0000"  >&lt;p&gt;Chiming in here, I believe we&apos;ve experienced the same error. I&apos;ve been able to reproduce the behavior quite simply, as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;3-broker cluster (running Apache Kafka 2.3.1)&lt;/li&gt;
	&lt;li&gt;one partition with replica assignment (0, 1, 2)&lt;/li&gt;
	&lt;li&gt;booted fourth broker (id 3)&lt;/li&gt;
	&lt;li&gt;initiated partition reassignment from (0, 1, 2) to (0, 1, 2, 3) with a very low throttle (for testing)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;As soon as the assignment begins, a 2.3.0 console consumer simply hangs when started. A 1.1.1 consumer does not have any issues. I see this in leader broker&apos;s request logs:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[2019-12-05 16:38:36,790] DEBUG Completed request:RequestHeader(apiKey=LIST_OFFSETS, apiVersion=5, clientId=consumer-1, correlationId=1529) -- {replica_id=-1,isolation_level=0,topics=[{topic=DataPlatform.CGSynthTests,partitions=[{partition=0,current_leader_epoch=0,timestamp=-1}]}]},response:{throttle_time_ms=0,responses=[{topic=DataPlatform.CGSynthTests,partition_responses=[{partition=0,error_code=74,timestamp=-1,offset=-1,leader_epoch=-1}]}]} from connection 172.22.15.67:9092-172.22.23.98:46974-9;totalTime:0.27,requestQueueTime:0.044,localTime:0.185,remoteTime:0.0,throttleTime:0.036,responseQueueTime:0.022,sendTime:0.025,securityProtocol:PLAINTEXT,principal:User:data-pipeline-monitor,listener:PLAINTEXT (kafka.request.logger)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note the producer fenced error code for list offsets, as in the original report.&lt;/p&gt;

&lt;p&gt;Once the reassignment completes, the 2.3.1 console consumer starts working. I&apos;ve also tried a different reassignment (0, 1, 2) -&amp;gt; (3, 1, 2) with the same results.&lt;/p&gt;

&lt;p&gt;Where we stand right now is we can&apos;t initiate partition reassignments in our production cluster without paralyzing a Spark application (using 2.3.0 client libs under the hood). Downgrading the Kafka client libs there isn&apos;t possible since they are part of the Spark assembly.&lt;/p&gt;

&lt;p&gt;Any pointers on what the issue might be here? Struggling to understand the bug because it seems like any partition reassignment breaks LIST_OFFSETS requests from 2.3 clients, but that just seems to be too severe a problem to have gone unnoticed for so long. Even ideas for a workaround would help here, since we don&apos;t see a path to do partition reassignments without causing a production incident right now.&lt;/p&gt;</comment>
                            <comment id="16989491" author="hachikuji" created="Fri, 6 Dec 2019 07:59:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mjaschob%40twilio.com&quot; class=&quot;user-hover&quot; rel=&quot;mjaschob@twilio.com&quot;&gt;mjaschob@twilio.com&lt;/a&gt; Really appreciate the extra detail. I was able to reproduce this on trunk following your instructions. What I see is the controller sending a stale epoch in the UPDATE_METADATA request which follows the initiation of the reassignment. I will work on a patch to fix the controller and I will try to make the case for the 2.4.0 release. Note that fixing this does require a broker upgrade. Until a patch is available, probably the best option is to use the 2.2 or lower clients.&lt;/p&gt;</comment>
                            <comment id="16990283" author="githubbot" created="Sat, 7 Dec 2019 02:28:53 +0000"  >&lt;p&gt;hachikuji commented on pull request #7795: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9212&quot; title=&quot;Keep receiving FENCED_LEADER_EPOCH while sending ListOffsetRequest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9212&quot;&gt;&lt;del&gt;KAFKA-9212&lt;/del&gt;&lt;/a&gt;; Update LeaderAndIsr state in controller context after reassignment&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7795&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7795&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   KIP-320 improved fetch semantics by adding leader epoch validation. This relies on reliable propagation of leader epoch information from the controller. Unfortunately, we have encountered a bug during partition reassignment in which the leader epoch in the controller context does not get properly updated. This causes UpdateMetadata requests to be sent with stale epoch information which results in the metadata caches on the brokers falling out of sync. &lt;/p&gt;

&lt;p&gt;   This bug has existed for a long time, but it is only a problem due to the new epoch validation done by the client. Because the client includes the stale leader epoch in its requests, the leader rejects them, but the stale metadata cache on the brokers prevents the consumer from getting the latest epoch. Hence the consumer cannot make progress while a reassignment is ongoing. &lt;/p&gt;

&lt;p&gt;   Although it is straightforward to fix this problem in the controller for the new releases (which is what this patch does), it is not so easy to fix older brokers which means new clients could still encounter brokers with this bug. To address this problem, this patch also modifies the client to treat the leader epoch returned from the Metadata response as &quot;unreliable&quot; if it comes from an older version of the protocol. The client in this case we discard the returned epoch and it won&apos;t be included in any requests.&lt;/p&gt;

&lt;p&gt;   Also, note that the correct epoch is still forwarded to replicas correctly in the LeaderAndIsr request, so this bug does not affect replication.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16990971" author="githubbot" created="Sun, 8 Dec 2019 19:38:55 +0000"  >&lt;p&gt;ijuma commented on pull request #7795: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9212&quot; title=&quot;Keep receiving FENCED_LEADER_EPOCH while sending ListOffsetRequest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9212&quot;&gt;&lt;del&gt;KAFKA-9212&lt;/del&gt;&lt;/a&gt;; Ensure LeaderAndIsr state updated in controller context during reassignment&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7795&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7795&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16991075" author="githubbot" created="Mon, 9 Dec 2019 02:21:16 +0000"  >&lt;p&gt;ijuma commented on pull request #7800: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9212&quot; title=&quot;Keep receiving FENCED_LEADER_EPOCH while sending ListOffsetRequest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9212&quot;&gt;&lt;del&gt;KAFKA-9212&lt;/del&gt;&lt;/a&gt;; Ensure LeaderAndIsr state updated in controller context during reassignment (#7795)&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7800&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7800&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   KIP-320 improved fetch semantics by adding leader epoch validation. This relies on&lt;br/&gt;
   reliable propagation of leader epoch information from the controller. Unfortunately, we&lt;br/&gt;
   have encountered a bug during partition reassignment in which the leader epoch in the&lt;br/&gt;
   controller context does not get properly updated. This causes UpdateMetadata requests&lt;br/&gt;
   to be sent with stale epoch information which results in the metadata caches on the&lt;br/&gt;
   brokers falling out of sync.&lt;/p&gt;

&lt;p&gt;   This bug has existed for a long time, but it is only a problem due to the new epoch&lt;br/&gt;
   validation done by the client. Because the client includes the stale leader epoch in its&lt;br/&gt;
   requests, the leader rejects them, yet the stale metadata cache on the brokers prevents&lt;br/&gt;
   the consumer from getting the latest epoch. Hence the consumer cannot make progress&lt;br/&gt;
   while a reassignment is ongoing.&lt;/p&gt;

&lt;p&gt;   Although it is straightforward to fix this problem in the controller for the new releases&lt;br/&gt;
   (which this patch does), it is not so easy to fix older brokers which means new clients&lt;br/&gt;
   could still encounter brokers with this bug. To address this problem, this patch also&lt;br/&gt;
   modifies the client to treat the leader epoch returned from the Metadata response as&lt;br/&gt;
   &quot;unreliable&quot; if it comes from an older version of the protocol. The client in this case will&lt;br/&gt;
   discard the returned epoch and it won&apos;t be included in any requests.&lt;/p&gt;

&lt;p&gt;   Also, note that the correct epoch is still forwarded to replicas correctly in the&lt;br/&gt;
   LeaderAndIsr request, so this bug does not affect replication.&lt;/p&gt;

&lt;p&gt;   Reviewers: Jun Rao &amp;lt;junrao@gmail.com&amp;gt;, Stanislav Kozlovski &amp;lt;stanislav_kozlovski@outlook.com&amp;gt;, Ismael Juma &amp;lt;ismael@juma.me.uk&amp;gt;&lt;/p&gt;

&lt;p&gt;   *More detailed description of your change,&lt;br/&gt;
   if necessary. The PR title and PR message become&lt;br/&gt;
   the squashed commit message, so use a separate&lt;br/&gt;
   comment to ping reviewers.*&lt;/p&gt;

&lt;p&gt;   *Summary of testing strategy (including rationale)&lt;br/&gt;
   for the feature or bug fix. Unit and/or integration&lt;br/&gt;
   tests are expected for any behaviour change and&lt;br/&gt;
   system tests should be considered for larger changes.*&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16991737" author="githubbot" created="Mon, 9 Dec 2019 16:12:35 +0000"  >&lt;p&gt;hachikuji commented on pull request #7800: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9212&quot; title=&quot;Keep receiving FENCED_LEADER_EPOCH while sending ListOffsetRequest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9212&quot;&gt;&lt;del&gt;KAFKA-9212&lt;/del&gt;&lt;/a&gt;; Ensure LeaderAndIsr state updated in controller context during reassignment (#7795)&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7800&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7800&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16991826" author="githubbot" created="Mon, 9 Dec 2019 18:15:27 +0000"  >&lt;p&gt;hachikuji commented on pull request #7805: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9212&quot; title=&quot;Keep receiving FENCED_LEADER_EPOCH while sending ListOffsetRequest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9212&quot;&gt;&lt;del&gt;KAFKA-9212&lt;/del&gt;&lt;/a&gt;; Ensure LeaderAndIsr state updated in controller context during reassignment&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7805&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   This is a cherry-pick of &lt;a href=&quot;https://github.com/apache/kafka/commit/5d0cb1419cd1f1cdfb7bc04ed4760d5a0eae0aa1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/5d0cb1419cd1f1cdfb7bc04ed4760d5a0eae0aa1&lt;/a&gt;. The main differences are 1) leader epoch validation is unconditionally disable, and 2) the test case has been refactored due to the absence of the reassignment admin APIs.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16992119" author="githubbot" created="Tue, 10 Dec 2019 02:15:38 +0000"  >&lt;p&gt;hachikuji commented on pull request #7805: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9212&quot; title=&quot;Keep receiving FENCED_LEADER_EPOCH while sending ListOffsetRequest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9212&quot;&gt;&lt;del&gt;KAFKA-9212&lt;/del&gt;&lt;/a&gt;; Ensure LeaderAndIsr state updated in controller context during reassignment&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7805&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z08sxs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>