<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:59:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-4757] Improve NetworkClient trace logging of request details</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-4757</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Two issues here:&lt;br/&gt;
1. Here&apos;s what NetworkClient now shows when processing a disconnection:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[2017-02-10 10:48:57,052] TRACE Cancelled request org.apache.kafka.clients.NetworkClient$InFlightRequest@52f759d7 due to node 0 being disconnected (org.apache.kafka.clients.NetworkClient)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The log at one point was useful and actually showed the contents of the request. For instance, with FetchRequest, you used to be able to see which partitions were requested as well as the offsets and max bytes requested per partition.&lt;/p&gt;

&lt;p&gt;It looks like InFlightRequest itself doesn&apos;t actually hold the request but instead currently just holds the RequestHeader. We probably want to make InFlightRequest hold the entire request to make the original request show up in the logs.&lt;/p&gt;

&lt;p&gt;2. Sometimes I see the following log:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[2017-02-10 10:53:59,015] TRACE Sending {} to node 0. (org.apache.kafka.clients.NetworkClient)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Again not very insightful.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13042150">KAFKA-4757</key>
            <summary>Improve NetworkClient trace logging of request details</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cmccabe">Colin McCabe</assignee>
                                    <reporter username="onurkaraman">Onur Karaman</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 Feb 2017 18:57:29 +0000</created>
                <updated>Wed, 22 Feb 2017 04:48:50 +0000</updated>
                            <resolved>Wed, 22 Feb 2017 04:48:50 +0000</resolved>
                                    <version>0.10.2.0</version>
                                    <fixVersion>0.11.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15872176" author="cmccabe" created="Fri, 17 Feb 2017 17:38:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;1. The &lt;span class=&quot;error&quot;&gt;&amp;#91;request cancelled&amp;#93;&lt;/span&gt; log at one point was useful and actually showed the contents of the request. For instance, with FetchRequest, you used to be able to see which partitions were requested as well as the offsets and max bytes requested per partition.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, this is annoying.  We should have a better log message here.  I will create a patch.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2. Sometimes I see the following log:
[2017-02-10 10:53:59,015] TRACE Sending {} to node 0. (org.apache.kafka.clients.NetworkClient)
Again not very insightful.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This was fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4635&quot; title=&quot;Client Compatibility follow-up&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4635&quot;&gt;&lt;del&gt;KAFKA-4635&lt;/del&gt;&lt;/a&gt;.  The line is now: &lt;tt&gt;log.trace(&quot;Sending {} to node {}.&quot;, request, nodeId);&lt;/tt&gt;&lt;/p&gt;
</comment>
                            <comment id="15872194" author="onurkaraman" created="Fri, 17 Feb 2017 17:43:52 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cmccabe&quot; class=&quot;user-hover&quot; rel=&quot;cmccabe&quot;&gt;cmccabe&lt;/a&gt;. Regarding the second issue, I&apos;ll need to double check if I already pulled in the patch.&lt;/p&gt;</comment>
                            <comment id="15872284" author="onurkaraman" created="Fri, 17 Feb 2017 18:44:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cmccabe&quot; class=&quot;user-hover&quot; rel=&quot;cmccabe&quot;&gt;cmccabe&lt;/a&gt; I double checked and the 2nd logging issue still appears after &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4635&quot; title=&quot;Client Compatibility follow-up&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4635&quot;&gt;&lt;del&gt;KAFKA-4635&lt;/del&gt;&lt;/a&gt;. My trunk is currently at git hash 2c91b324d4798138dd479f54269bdc4f39339817.&lt;/p&gt;

&lt;p&gt;My initial guess is that it&apos;s related to ApiVersionsRequest, as the line following the bad log line usually contains a completed receive of api_key=18:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[2017-02-17 10:38:40,312] TRACE Sending {} to node 1. (org.apache.kafka.clients.NetworkClient)
[2017-02-17 10:38:40,312] TRACE Completed receive from node 1, &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; key 18, received {error_code=0,api_versions=[{api_key=0,min_version=0,max_version=2},{api_key=1,min_version=0,max_version=3},{api_key=2,min_version=0,max_version=1},{api_key=3,min_version=0,max_version=2},{api_key=4,min_version=0,max_version=0},{api_key=5,min_version=0,max_version=0},{api_key=6,min_version=0,max_version=3},{api_key=7,min_version=1,max_version=1},{api_key=8,min_version=0,max_version=2},{api_key=9,min_version=0,max_version=2},{api_key=10,min_version=0,max_version=0},{api_key=11,min_version=0,max_version=1},{api_key=12,min_version=0,max_version=0},{api_key=13,min_version=0,max_version=0},{api_key=14,min_version=0,max_version=0},{api_key=15,min_version=0,max_version=0},{api_key=16,min_version=0,max_version=0},{api_key=17,min_version=0,max_version=0},{api_key=18,min_version=0,max_version=0},{api_key=19,min_version=0,max_version=1},{api_key=20,min_version=0,max_version=0}]} (org.apache.kafka.clients.NetworkClient)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15872390" author="onurkaraman" created="Fri, 17 Feb 2017 19:38:01 +0000"  >&lt;p&gt;Ah. Might&apos;ve found it: Here&apos;s what ApiVersionsRequest schema looks like in org.apache.kafka.common.protocol.Protocol:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Schema API_VERSIONS_REQUEST_V0 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15872406" author="cmccabe" created="Fri, 17 Feb 2017 19:48:38 +0000"  >&lt;p&gt;Thanks.  That&apos;s a good find.&lt;/p&gt;

&lt;p&gt;I just posted a patch that improves that log message to look like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[2017-02-17 11:47:42,663] TRACE Sending API_VERSIONS {} to node 0. (org.apache.kafka.clients.NetworkClient)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15872616" author="onurkaraman" created="Fri, 17 Feb 2017 22:06:02 +0000"  >&lt;p&gt;Left some comments on the PR.&lt;/p&gt;

&lt;p&gt;Speaking of which, usually the PR itself should appear on the jira ticket.&lt;/p&gt;

&lt;p&gt;I wonder if it&apos;s because the PR title isn&apos;t in the KAFKA-WXYZ:title format as defined here:&lt;br/&gt;
&lt;a href=&quot;https://cwiki.apache.org/confluence/display/KAFKA/Contributing+Code+Changes&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/KAFKA/Contributing+Code+Changes&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15872643" author="cmccabe" created="Fri, 17 Feb 2017 22:22:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/kafka/pull/2563&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2563&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15872650" author="cmccabe" created="Fri, 17 Feb 2017 22:29:40 +0000"  >&lt;p&gt;Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=onurkaraman&quot; class=&quot;user-hover&quot; rel=&quot;onurkaraman&quot;&gt;onurkaraman&lt;/a&gt;.  I usually do name them as KAFKA-XYZ, but I missed the dash somehow this time.  You found it anyway... good job &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  Thanks for the review.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 39 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i39x9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>