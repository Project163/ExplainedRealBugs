<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:40:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-17731] Kafka consumer client sometimes elapses wait time for terminating telemetry push</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-17731</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;ClientTelemetryReporter awaits on the timeout to send terminating telemetry push but sometimes the wait is elapsed. The condition occurs intermitently which can affect closing time of the consumer.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;The issue can only be reproduced when consumer is closed just after creating i.e. instantiated Kafka Consumer and closed it&lt;/b&gt;. When consumer is instantly closed then, then worker thread goes for &lt;tt&gt;timed_waiting&lt;/tt&gt; state and expects last telemetry push request, which gets completed by background thread poll. But as the consumer is instantly closed, the heartbeat thread can&apos;t send the telemetry request, which makes the consumer close to wait for timeout.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Debug logs:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[2024-10-08 18:58:48,223] DEBUG (org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter)
&#160;:224 - &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; - 17 - Initiate close of ClientTelemetryReporter
[2024-10-08 18:58:48,223] DEBUG (org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter)
&#160;:610 - &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; - 17 - initiate close &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; client telemetry, check &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; terminal push required. Timeout 30000 ms.
[2024-10-08 18:58:48,223] DEBUG (org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter)
&#160;:834 - &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; - 17 - Setting telemetry state from PUSH_NEEDED to TERMINATING_PUSH_NEEDED
[2024-10-08 18:58:48,223] INFO (org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter)
&#160;:632 - &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; - 17 - About to wait 30000 ms. &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; terminal telemetry push to be submitted
[2024-10-08 18:59:18,729] INFO (org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter)
&#160;:634 - &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; - 17 - Wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; terminal telemetry push to be submitted has elapsed; may not have actually sent request 


&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13594690">KAFKA-17731</key>
            <summary>Kafka consumer client sometimes elapses wait time for terminating telemetry push</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="apoorvmittal10">Apoorv Mittal</assignee>
                                    <reporter username="apoorvmittal10">Apoorv Mittal</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Oct 2024 18:05:42 +0000</created>
                <updated>Fri, 10 Jan 2025 19:22:40 +0000</updated>
                            <resolved>Thu, 10 Oct 2024 11:37:13 +0000</resolved>
                                    <version>3.7.0</version>
                    <version>3.7.1</version>
                    <version>3.8.0</version>
                                    <fixVersion>3.7.2</fixVersion>
                    <fixVersion>3.8.1</fixVersion>
                    <fixVersion>3.9.0</fixVersion>
                                    <component>clients</component>
                    <component>consumer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17888295" author="JIRAUSER300183" created="Thu, 10 Oct 2024 13:56:22 +0000"  >&lt;p&gt;Back-ported to:&lt;/p&gt;

&lt;p&gt;3.7 &lt;a href=&quot;https://github.com/apache/kafka/commit/f4b46a7cec533eac4d4433953a722454d947a98a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/f4b46a7cec533eac4d4433953a722454d947a98a&lt;/a&gt;&#160;&lt;br/&gt;
3.8 &lt;a href=&quot;https://github.com/apache/kafka/commit/07c4f4c83647cfa61b184e9f4e81632f561c45d6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/07c4f4c83647cfa61b184e9f4e81632f561c45d6&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1rv0g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>