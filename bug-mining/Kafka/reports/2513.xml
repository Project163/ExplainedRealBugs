<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:22:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-9577] Client encountering SASL_HANDSHAKE protocol version errors on 2.5 / trunk</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-9577</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;I am trying 2.5.0 with sasl turned on and my consumer and producer clients receive:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.kafka.common.errors.UnsupportedVersionException: The SASL_HANDSHAKE protocol does not support version 2
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I believe this is due to &lt;a href=&quot;https://github.com/apache/kafka/commit/0a2569e2b9907a1217dd50ccbc320f8ad0b42fd0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/0a2569e2b9907a1217dd50ccbc320f8ad0b42fd0&lt;/a&gt;&#160;which added flexible version support and bumped the protocol version.&lt;/p&gt;

&lt;p&gt;It appears that the SaslClientAuthenticator uses the max version for SASL_HANDSHAKE received in the broker&apos;s AP_VERSIONS response, and then uses that version even though it may not support it. See&#160;&lt;a href=&quot;https://github.com/apache/kafka/blob/eb09efa9ac79efa484307bdcf03ac8eb8a3a94e2/clients/src/main/java/org/apache/kafka/common/security/authenticator/SaslClientAuthenticator.java#L290&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/eb09efa9ac79efa484307bdcf03ac8eb8a3a94e2/clients/src/main/java/org/apache/kafka/common/security/authenticator/SaslClientAuthenticator.java#L290&lt;/a&gt;.&#160;&lt;/p&gt;

&lt;p&gt;This may make it hard to ever evolve this schema. In the short term I suggest we roll back the version bump and flexible schema until we figure out a path forward.&lt;/p&gt;

&lt;p&gt;It appears that this may not have been a problem in the past because the schema versions were the same and maybe we didn&apos;t validate the version number&#160;&lt;a href=&quot;https://github.com/apache/kafka/commit/0cf7708007b01faac5012d939f3c50db274f858d#diff-7f65552a2e23aa7028500f8db06cbb30R47&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/0cf7708007b01faac5012d939f3c50db274f858d#diff-7f65552a2e23aa7028500f8db06cbb30R47&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13286362">KAFKA-9577</key>
            <summary>Client encountering SASL_HANDSHAKE protocol version errors on 2.5 / trunk</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lucasbradstreet">Lucas Bradstreet</assignee>
                                    <reporter username="lucasbradstreet">Lucas Bradstreet</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Feb 2020 01:19:10 +0000</created>
                <updated>Sat, 22 Feb 2020 05:58:23 +0000</updated>
                            <resolved>Sat, 22 Feb 2020 05:58:23 +0000</resolved>
                                    <version>2.5.0</version>
                                    <fixVersion>2.5.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17040550" author="ijuma" created="Thu, 20 Feb 2020 01:20:57 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mumrah&quot; class=&quot;user-hover&quot; rel=&quot;mumrah&quot;&gt;mumrah&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17040552" author="lucasbradstreet" created="Thu, 20 Feb 2020 01:24:59 +0000"  >&lt;p&gt;We should also fix the client so that it doesn&apos;t build requests in this way, but this will not be a sufficient fix until all existing clients are unsupported.&lt;/p&gt;</comment>
                            <comment id="17041046" author="enether" created="Thu, 20 Feb 2020 14:47:16 +0000"  >&lt;p&gt;Do we have a system test that would catch this?&lt;/p&gt;</comment>
                            <comment id="17041087" author="lucasbradstreet" created="Thu, 20 Feb 2020 15:36:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enether&quot; class=&quot;user-hover&quot; rel=&quot;enether&quot;&gt;enether&lt;/a&gt;&#160;I will have to check the system test results, but I don&apos;t think it&apos;s likely unless we have a SASL related test that uses an older client version.&lt;/p&gt;</comment>
                            <comment id="17041249" author="githubbot" created="Thu, 20 Feb 2020 19:13:27 +0000"  >&lt;p&gt;lbradstreet commented on pull request #8142: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9577&quot; title=&quot;Client encountering SASL_HANDSHAKE protocol version errors on 2.5 / trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9577&quot;&gt;&lt;del&gt;KAFKA-9577&lt;/del&gt;&lt;/a&gt;: SaslClientAuthenticator incorrectly negotiates supported SaslHandshakeRequest version&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/8142&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/8142&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   The SaslClientAuthenticator incorrectly negotiates supported SaslHandshakeRequest version and  uses the maximum version supported by the broker whether or not the client supports it. This PR rolls back the recent SaslHandshake&lt;span class=&quot;error&quot;&gt;&amp;#91;Request,Response&amp;#93;&lt;/span&gt; bump, fixes the version negotiation, and adds a test to prevent anyone from accidentally bumping the version without a workaround (e.g. a new ApiKey).&lt;/p&gt;

&lt;p&gt;   Tests:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Prevent SASL_HANDSHAKE schema version bump&lt;/li&gt;
	&lt;li&gt;Add test to return ApiVersions unsupported by client&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="17042380" author="githubbot" created="Sat, 22 Feb 2020 05:49:17 +0000"  >&lt;p&gt;hachikuji commented on pull request #8142: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9577&quot; title=&quot;Client encountering SASL_HANDSHAKE protocol version errors on 2.5 / trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9577&quot;&gt;&lt;del&gt;KAFKA-9577&lt;/del&gt;&lt;/a&gt;: SaslClientAuthenticator incorrectly negotiates SASL_HANDSHAKE version&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/8142&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/8142&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 38 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0boew:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>