<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:19:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-7157] Connect TimestampConverter SMT doesn&apos;t handle null values</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-7157</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;TimestampConverter SMT is not able to handle null values (in any versions), so it&apos;s always trying to apply the transformation to the value. Instead, it needs to check for null and use the default value for the new schema&apos;s field.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[2018-07-03 02:31:52,490] ERROR Task MySourceConnector-2 threw an uncaught and unrecoverable exception (org.apache.kafka.connect.runtime.WorkerTask) 
java.lang.NullPointerException 
at org.apache.kafka.connect.transforms.TimestampConverter$2.toRaw(TimestampConverter.java:137) 
at org.apache.kafka.connect.transforms.TimestampConverter.convertTimestamp(TimestampConverter.java:440) 
at org.apache.kafka.connect.transforms.TimestampConverter.applyValueWithSchema(TimestampConverter.java:368) 
at org.apache.kafka.connect.transforms.TimestampConverter.applyWithSchema(TimestampConverter.java:358) 
at org.apache.kafka.connect.transforms.TimestampConverter.apply(TimestampConverter.java:275) 
at org.apache.kafka.connect.runtime.TransformationChain.apply(TransformationChain.java:38) 
at org.apache.kafka.connect.runtime.WorkerSinkTask.convertMessages(WorkerSinkTask.java:435) 
at org.apache.kafka.connect.runtime.WorkerSinkTask.poll(WorkerSinkTask.java:264) 
at org.apache.kafka.connect.runtime.WorkerSinkTask.iteration(WorkerSinkTask.java:182) 
at org.apache.kafka.connect.runtime.WorkerSinkTask.execute(WorkerSinkTask.java:150) 
at org.apache.kafka.connect.runtime.WorkerTask.doRun(WorkerTask.java:146) 
at org.apache.kafka.connect.runtime.WorkerTask.run(WorkerTask.java:190) 
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) 
at java.util.concurrent.FutureTask.run(FutureTask.java:266) 
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 
at java.lang.Thread.run(Thread.java:748) 
[2018-07-03 02:31:52,491] ERROR Task is being killed and will not recover until manually restarted (org.apache.kafka.connect.runtime.WorkerTask) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13171743">KAFKA-7157</key>
            <summary>Connect TimestampConverter SMT doesn&apos;t handle null values</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nimfadora">Valeria Vasylieva</assignee>
                                    <reporter username="rhauch">Randall Hauch</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Jul 2018 14:29:11 +0000</created>
                <updated>Wed, 20 May 2020 09:07:54 +0000</updated>
                            <resolved>Fri, 12 Jul 2019 17:49:49 +0000</resolved>
                                    <version>0.10.2.0</version>
                                    <fixVersion>1.0.3</fixVersion>
                    <fixVersion>1.1.2</fixVersion>
                    <fixVersion>2.0.2</fixVersion>
                    <fixVersion>2.1.2</fixVersion>
                    <fixVersion>2.2.2</fixVersion>
                    <fixVersion>2.3.1</fixVersion>
                    <fixVersion>2.4.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>4</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="16589428" author="ian.a" created="Wed, 22 Aug 2018 22:49:33 +0000"  >&lt;p&gt;FWIW, I have encountered this as well and it is blocking production work.&#160;The fix for this is simple, but I wonder if there is an opportunity here to create the idea of conditional transformations. I can think of myriad cases where you would want to execute a transformer only when a record / record field has a certain value (or matches regex, ...). One could fix the NPE issue by wrapping TimestampConverter in the conditional transformer executor class and have the condition be that the&#160;field value is not null.&lt;/p&gt;</comment>
                            <comment id="16636931" author="cboratto" created="Wed, 3 Oct 2018 13:17:10 +0000"  >&lt;p&gt;Is there any workaround that we can use while the bug has not been fixed?&#160;&lt;/p&gt;</comment>
                            <comment id="16781704" author="nimfadora" created="Fri, 1 Mar 2019 14:10:21 +0000"  >&lt;p&gt;Issue can be still reproduced, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhauch&quot; class=&quot;user-hover&quot; rel=&quot;rhauch&quot;&gt;rhauch&lt;/a&gt; I&apos;ll fix it, if you don&apos;t mind.&lt;/p&gt;</comment>
                            <comment id="16788112" author="jeffbeagley" created="Fri, 8 Mar 2019 17:48:27 +0000"  >&lt;p&gt;Also looking for a temporary solution until this is developed. The only thought I can come up with right now is sinking the date as epoch within downstream databases, and then converting as needed. However we&apos;re using Kafka as a means of replication for reporting and analytic purposes, so we&apos;d take a huge performance hit here&lt;/p&gt;</comment>
                            <comment id="16788436" author="jeffbeagley" created="Sat, 9 Mar 2019 01:47:06 +0000"  >&lt;p&gt;Never programmed java before, but I gave it my best shot; I basically just checked for null, and if so returned null from the transformation. I kept landing with the same error. This is using Avro with the schema below&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: org.apache.kafka.connect.errors.DataException: Invalid value: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; used &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; required field: &lt;span class=&quot;code-quote&quot;&gt;&quot;nullable_date&quot;&lt;/span&gt;, schema type: INT64
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
                  {
                     &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;nullable_date&quot;&lt;/span&gt;,
                     &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: [
                        &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;,
                        {
                           &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;&quot;&lt;/span&gt;,
                           &lt;span class=&quot;code-quote&quot;&gt;&quot;connect.version&quot;&lt;/span&gt;: 1,
                           &lt;span class=&quot;code-quote&quot;&gt;&quot;connect.name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;io.debezium.time.Timestamp&quot;&lt;/span&gt;
                        }
                     ],
                     &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;&quot;&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
                  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16790069" author="jeffbeagley" created="Tue, 12 Mar 2019 00:09:32 +0000"  >&lt;p&gt;I believe, through writing my own SMT, I have found a workaround. My transform accepts all date fields and immediately sets the schema of each field to OPTIONAL_STRING_SCHEMA, and then I format appropriately if the value is other than null.&#160;&lt;/p&gt;

&lt;p&gt;Code for my SMT (Specific to unix timestamp to smalldatetime within SQL) can be found here, &lt;a href=&quot;https://github.com/jeffbeagley/kafka-connect-transform&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jeffbeagley/kafka-connect-transform&lt;/a&gt;&#160;hope this helps!&lt;/p&gt;</comment>
                            <comment id="16792864" author="githubbot" created="Thu, 14 Mar 2019 17:08:05 +0000"  >&lt;p&gt;Nimfadora commented on pull request #6446: &lt;span class=&quot;error&quot;&gt;&amp;#91;WIP&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7157&quot; title=&quot;Connect TimestampConverter SMT doesn&amp;#39;t handle null values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7157&quot;&gt;&lt;del&gt;KAFKA-7157&lt;/del&gt;&lt;/a&gt;: Connect TimestampConverter SMT doesn&apos;t handle null values&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/6446&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/6446&lt;/a&gt;&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Goal&lt;br/&gt;
   Introduce null-value handling to TimestampConverter SMT. &lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Details&lt;br/&gt;
   The existing org.apache.kafka.connect.transforms.TimestampConverter does not handle null values. When null value is passed to SMT the NPE is thrown. This PR introduces null vallue handling for this SMT.&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   `schemaless null value` will result in `null record value`&lt;br/&gt;
   `schemaless null complex object` will result in `null record value`&lt;br/&gt;
   `null struct(has schema)` will result in `null record value with optional struct schema`&lt;br/&gt;
   `null struct(has schema) field` will result in `record value with null field value and optional struct schema for that field`&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Important&lt;br/&gt;
   We consider that original schema with null value will have optional modifier. Maybe we should be smarter and decide on the value of optional modifier based on the field actual nullability.&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Testing&lt;br/&gt;
   Unit tests are provided&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16792870" author="nimfadora" created="Thu, 14 Mar 2019 17:10:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhauch&quot; class=&quot;user-hover&quot; rel=&quot;rhauch&quot;&gt;rhauch&lt;/a&gt; I have submitted PR fix for this issue, I will be very glad if you look at it. Thank you!&lt;/p&gt;</comment>
                            <comment id="16818827" author="nimfadora" created="Tue, 16 Apr 2019 09:29:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhauch&quot; class=&quot;user-hover&quot; rel=&quot;rhauch&quot;&gt;rhauch&lt;/a&gt; kindly ask you to look at the PR, thank you!&lt;/p&gt;</comment>
                            <comment id="16882464" author="githubbot" created="Wed, 10 Jul 2019 21:39:26 +0000"  >&lt;p&gt;rayokota commented on pull request #7070: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7157&quot; title=&quot;Connect TimestampConverter SMT doesn&amp;#39;t handle null values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7157&quot;&gt;&lt;del&gt;KAFKA-7157&lt;/del&gt;&lt;/a&gt;: Fix handling of nulls in TimestampConverter&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7070&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7070&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   This is based on the PR from @Nimfadora&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16883997" author="githubbot" created="Fri, 12 Jul 2019 17:12:28 +0000"  >&lt;p&gt;rhauch commented on pull request #7070: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7157&quot; title=&quot;Connect TimestampConverter SMT doesn&amp;#39;t handle null values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7157&quot;&gt;&lt;del&gt;KAFKA-7157&lt;/del&gt;&lt;/a&gt;: Fix handling of nulls in TimestampConverter&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7070&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7070&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="17064109" author="githubbot" created="Sat, 21 Mar 2020 23:50:57 +0000"  >&lt;p&gt;kkonstantine commented on pull request #6446: &lt;span class=&quot;error&quot;&gt;&amp;#91;WIP&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7157&quot; title=&quot;Connect TimestampConverter SMT doesn&amp;#39;t handle null values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7157&quot;&gt;&lt;del&gt;KAFKA-7157&lt;/del&gt;&lt;/a&gt;: Connect TimestampConverter SMT doesn&apos;t handle null values&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/6446&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/6446&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 34 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3vtrr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>