<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:43:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-1884] Print metadata response errors</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-1884</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Print metadata response errors.&lt;/p&gt;

&lt;p&gt;producer logs:&lt;/p&gt;

&lt;p&gt;DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;2015-01-20 12:46:13,406&amp;#93;&lt;/span&gt; NetworkClient: maybeUpdateMetadata(): Trying to send metadata request to node -1&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;2015-01-20 12:46:13,406&amp;#93;&lt;/span&gt; NetworkClient: maybeUpdateMetadata(): Sending metadata request ClientRequest(expectResponse=true, payload=null, request=RequestSend(header=&lt;/p&gt;
{api_key=3,api_version=0,correlation_id=50845,client_id=my-producer}
&lt;p&gt;, body=&lt;/p&gt;
{topics=[TOPIC=]})) to node -1&lt;br/&gt;
TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;2015-01-20 12:46:13,416&amp;#93;&lt;/span&gt; NetworkClient: handleMetadataResponse(): Ignoring empty metadata response with correlation id 50845.&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;2015-01-20 12:46:13,417&amp;#93;&lt;/span&gt; NetworkClient: maybeUpdateMetadata(): Trying to send metadata request to node -1&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;2015-01-20 12:46:13,417&amp;#93;&lt;/span&gt; NetworkClient: maybeUpdateMetadata(): Sending metadata request ClientRequest(expectResponse=true, payload=null, request=RequestSend(header={api_key=3,api_version=0,correlation_id=50846,client_id=my-producer}, body={topics=[TOPIC=]}
&lt;p&gt;)) to node -1&lt;br/&gt;
TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;2015-01-20 12:46:13,417&amp;#93;&lt;/span&gt; NetworkClient: handleMetadataResponse(): Ignoring empty metadata response with correlation id 50846.&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;2015-01-20 12:46:13,417&amp;#93;&lt;/span&gt; NetworkClient: maybeUpdateMetadata(): Trying to send metadata request to node -1&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;2015-01-20 12:46:13,418&amp;#93;&lt;/span&gt; NetworkClient: maybeUpdateMetadata(): Sending metadata request ClientRequest(expectResponse=true, payload=null, request=RequestSend(header=&lt;/p&gt;
{api_key=3,api_version=0,correlation_id=50847,client_id=my-producer}
&lt;p&gt;, body=&lt;/p&gt;
{topics=[TOPIC=]}
&lt;p&gt;)) to node -1&lt;br/&gt;
TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;2015-01-20 12:46:13,418&amp;#93;&lt;/span&gt; NetworkClient: handleMetadataResponse(): Ignoring empty metadata response with correlation id 50847.&lt;/p&gt;

&lt;p&gt;Broker logs:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2015-01-20 12:46:14,074&amp;#93;&lt;/span&gt; ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;KafkaApi-0&amp;#93;&lt;/span&gt; error when handling request Name: TopicMetadataRequest; Version: 0; CorrelationId: 51020; ClientId: my-producer; Topics: TOPIC= (kafka.server.KafkaApis)&lt;br/&gt;
kafka.common.InvalidTopicException: topic name TOPIC= is illegal, contains a character other than ASCII alphanumerics, &apos;.&apos;, &apos;_&apos; and &apos;-&apos;&lt;br/&gt;
	at kafka.common.Topic$.validate(Topic.scala:42)&lt;br/&gt;
	at kafka.admin.AdminUtils$.createOrUpdateTopicPartitionAssignmentPathInZK(AdminUtils.scala:186)&lt;br/&gt;
	at kafka.admin.AdminUtils$.createTopic(AdminUtils.scala:177)&lt;br/&gt;
	at kafka.server.KafkaApis$$anonfun$5.apply(KafkaApis.scala:367)&lt;br/&gt;
	at kafka.server.KafkaApis$$anonfun$5.apply(KafkaApis.scala:350)&lt;br/&gt;
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)&lt;br/&gt;
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)&lt;br/&gt;
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)&lt;br/&gt;
	at scala.collection.TraversableLike$class.map(TraversableLike.scala:244)&lt;br/&gt;
	at scala.collection.AbstractSet.scala$collection$SetLike$$super$map(Set.scala:47)&lt;br/&gt;
	at scala.collection.SetLike$class.map(SetLike.scala:93)&lt;br/&gt;
	at scala.collection.AbstractSet.map(Set.scala:47)&lt;br/&gt;
	at kafka.server.KafkaApis.getTopicMetadata(KafkaApis.scala:350)&lt;br/&gt;
	at kafka.server.KafkaApis.handleTopicMetadataRequest(KafkaApis.scala:389)&lt;br/&gt;
	at kafka.server.KafkaApis.handle(KafkaApis.scala:57)&lt;br/&gt;
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:722)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12768617">KAFKA-1884</key>
            <summary>Print metadata response errors</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="omkreddy">Manikumar</assignee>
                                    <reporter username="omkreddy">Manikumar</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 Jan 2015 07:21:13 +0000</created>
                <updated>Thu, 7 May 2015 22:49:40 +0000</updated>
                            <resolved>Thu, 7 May 2015 22:49:40 +0000</resolved>
                                    <version>0.8.2.0</version>
                                    <fixVersion>0.9.0.0</fixVersion>
                                    <component>producer </component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14308539" author="pradeepg26" created="Fri, 6 Feb 2015 03:22:54 +0000"  >&lt;p&gt;I&apos;d like to work on this. Please assign to me.&lt;/p&gt;

&lt;p&gt;I&apos;ve been able to reproduce the issue. I also noticed another oddity about this though.&lt;/p&gt;

&lt;p&gt;1. The server side error above is being repeated 100&apos;s of times a second (each repeat increments the CorrelationId). This seems to indicate some type of retry logic.&lt;br/&gt;
2. If I kill the server, kill the client and start the server. The error continues to repeat. This seems to indicate that this request may be persisted somewhere.&lt;/p&gt;

&lt;p&gt;I have a good grasp of where to start looking for the problem, though I have no idea why the above two are occurring.&lt;/p&gt;</comment>
                            <comment id="14308670" author="pradeepg26" created="Fri, 6 Feb 2015 06:00:02 +0000"  >&lt;p&gt;What makes the behavior in #2 earlier even more odd is, I stopped the server, deleted the znodes, deleted the kafka log dir and restarted the server and the same behavior is seen.&lt;/p&gt;

&lt;p&gt;O.o&lt;/p&gt;</comment>
                            <comment id="14309671" author="guozhang" created="Fri, 6 Feb 2015 19:09:33 +0000"  >&lt;p&gt;I think the behavior that producer&apos;s sender thread will keep retrying refreshing metadata for invalid topic names is expected, and it does not actually &quot;block&quot; the producer as it is a background thread; but the other issue is valid: it should back off between refreshing instead of bombarding the server. This issue is being addressed in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-1919&quot; title=&quot;Metadata request issued with no backoff in new producer if there are no topics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-1919&quot;&gt;&lt;del&gt;KAFKA-1919&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14310241" author="pradeepg26" created="Sat, 7 Feb 2015 00:03:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guozhang&quot; class=&quot;user-hover&quot; rel=&quot;guozhang&quot;&gt;guozhang&lt;/a&gt; That&apos;s what I figured at first. But the odd behavior is that the exception storm is happening on server even after the producer has been shut down (and the broker restarted). Not sure why that would be the case.&lt;/p&gt;</comment>
                            <comment id="14310283" author="guozhang" created="Sat, 7 Feb 2015 00:22:13 +0000"  >&lt;p&gt;That is a bit weird, the metadata requests should not persist... did you make a thread dump and check if the underlying sender thread is already gone after producer shut down? I guess it is because the background thread is not shut down when you hard kill the producer.&lt;/p&gt;</comment>
                            <comment id="14310548" author="pradeepg26" created="Sat, 7 Feb 2015 04:47:25 +0000"  >&lt;p&gt;I guess that makes sense... I&apos;ll confirm.&lt;/p&gt;</comment>
                            <comment id="14311252" author="omkreddy" created="Sun, 8 Feb 2015 09:55:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guozhang&quot; class=&quot;user-hover&quot; rel=&quot;guozhang&quot;&gt;guozhang&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jkreps&quot; class=&quot;user-hover&quot; rel=&quot;jkreps&quot;&gt;jkreps&lt;/a&gt; &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-1919&quot; title=&quot;Metadata request issued with no backoff in new producer if there are no topics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-1919&quot;&gt;&lt;del&gt;KAFKA-1919&lt;/del&gt;&lt;/a&gt; solves the retry problem.  Currently we will get continuous empty metadata response for invalid topics.  I was thinking,  Can clients get the InvalidTopicException/Error code?  or Can we add topic validation at client side itself? How non-java clients will handle it?&lt;/p&gt;</comment>
                            <comment id="14311632" author="guozhang" created="Mon, 9 Feb 2015 00:14:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=omkreddy&quot; class=&quot;user-hover&quot; rel=&quot;omkreddy&quot;&gt;omkreddy&lt;/a&gt; I think this is a valid point, we should handle this exception better at the server side to return corresponding error code.&lt;/p&gt;</comment>
                            <comment id="14314518" author="omkreddy" created="Tue, 10 Feb 2015 17:45:08 +0000"  >&lt;p&gt;looks like we are already returning error code from server. It just that we are not logging any error info in new client logs. Will add some logs.&lt;/p&gt;</comment>
                            <comment id="14343294" author="omkreddy" created="Mon, 2 Mar 2015 15:57:51 +0000"  >&lt;p&gt;Created reviewboard &lt;a href=&quot;https://reviews.apache.org/r/31627/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/31627/diff/&lt;/a&gt;&lt;br/&gt;
 against branch origin/trunk&lt;/p&gt;</comment>
                            <comment id="14352262" author="nehanarkhede" created="Sun, 8 Mar 2015 21:11:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guozhang&quot; class=&quot;user-hover&quot; rel=&quot;guozhang&quot;&gt;guozhang&lt;/a&gt; It seems you were helping out earlier. &lt;/p&gt;</comment>
                            <comment id="14501112" author="omkreddy" created="Sat, 18 Apr 2015 05:22:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guozhang&quot; class=&quot;user-hover&quot; rel=&quot;guozhang&quot;&gt;guozhang&lt;/a&gt; can you review this trivial patch?&lt;/p&gt;</comment>
                            <comment id="14533539" author="guozhang" created="Thu, 7 May 2015 22:49:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=omkreddy&quot; class=&quot;user-hover&quot; rel=&quot;omkreddy&quot;&gt;omkreddy&lt;/a&gt; Sorry for the late reply, committed to trunk with some minor changes.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12701885" name="KAFKA-1884.patch" size="1230" author="omkreddy" created="Mon, 2 Mar 2015 15:57:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24jwf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>guozhang</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>