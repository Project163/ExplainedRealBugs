<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:06:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-6253] Improve sink connector topic regex validation</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-6253</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3073&quot; title=&quot;KafkaConnect should support regular expression for topics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3073&quot;&gt;&lt;del&gt;KAFKA-3073&lt;/del&gt;&lt;/a&gt; adds topic regex support for sink connectors. The addition requires that you only specify one of topics or topics.regex settings. This is being validated in one place, but not during submission of connectors. We should improve this since this means it&apos;s possible to get a bad connector config into the config topic.&lt;/p&gt;

&lt;p&gt;For more detailed discussion, see &lt;a href=&quot;https://github.com/apache/kafka/pull/4151#pullrequestreview-77300221&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4151#pullrequestreview-77300221&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13120089">KAFKA-6253</key>
            <summary>Improve sink connector topic regex validation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jeff.klukas@gmail.com">Jeff Klukas</assignee>
                                    <reporter username="ewencp">Ewen Cheslack-Postava</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Nov 2017 23:23:37 +0000</created>
                <updated>Wed, 25 Apr 2018 09:42:29 +0000</updated>
                            <resolved>Mon, 5 Feb 2018 17:47:57 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16263058" author="githubbot" created="Wed, 22 Nov 2017 18:19:22 +0000"  >&lt;p&gt;GitHub user jklukas opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/4251&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4251&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6253&quot; title=&quot;Improve sink connector topic regex validation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6253&quot;&gt;&lt;del&gt;KAFKA-6253&lt;/del&gt;&lt;/a&gt;: Improve sink connector topic regex validation&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3073&quot; title=&quot;KafkaConnect should support regular expression for topics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3073&quot;&gt;&lt;del&gt;KAFKA-3073&lt;/del&gt;&lt;/a&gt; added topic regex support for sink connectors. The addition requires that you only specify one of topics or topics.regex settings. This is being validated in one place, but not during submission of connectors. This PR adds validation at `AbstractHerder.validateConnectorConfig` and `WorkerConnector.initialize`.&lt;/p&gt;

&lt;p&gt;    This adds a test of the new behavior to `AbstractHerderTest`.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/jklukas/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jklukas/kafka&lt;/a&gt; connect-topics-validation&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/4251.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4251.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4251&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 830f1b627f6ba2d76f72626fac0741380d03a010&lt;br/&gt;
Author: Jeff Klukas &amp;lt;jeff@klukas.net&amp;gt;&lt;br/&gt;
Date:   2017-11-22T17:42:56Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6253&quot; title=&quot;Improve sink connector topic regex validation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6253&quot;&gt;&lt;del&gt;KAFKA-6253&lt;/del&gt;&lt;/a&gt;: Improve sink connector topic regex validation&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16327938" author="githubbot" created="Tue, 16 Jan 2018 22:43:08 +0000"  >&lt;p&gt;jklukas opened a new pull request #4251: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6253&quot; title=&quot;Improve sink connector topic regex validation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6253&quot;&gt;&lt;del&gt;KAFKA-6253&lt;/del&gt;&lt;/a&gt;: Improve sink connector topic regex validation&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/4251&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4251&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3073&quot; title=&quot;KafkaConnect should support regular expression for topics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3073&quot;&gt;&lt;del&gt;KAFKA-3073&lt;/del&gt;&lt;/a&gt; added topic regex support for sink connectors. The addition requires that you only specify one of topics or topics.regex settings. This is being validated in one place, but not during submission of connectors. This PR adds validation at `AbstractHerder.validateConnectorConfig` and `WorkerConnector.initialize`.&lt;/p&gt;

&lt;p&gt;   This adds a test of the new behavior to `AbstractHerderTest`.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16327939" author="githubbot" created="Tue, 16 Jan 2018 22:43:08 +0000"  >&lt;p&gt;ewencp closed pull request #4251: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6253&quot; title=&quot;Improve sink connector topic regex validation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6253&quot;&gt;&lt;del&gt;KAFKA-6253&lt;/del&gt;&lt;/a&gt;: Improve sink connector topic regex validation&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/4251&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4251&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/AbstractHerder.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/AbstractHerder.java&lt;br/&gt;
index fbe0ae2afb2..6208e2f2cdb 100644&lt;br/&gt;
&amp;#8212; a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/AbstractHerder.java&lt;br/&gt;
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/AbstractHerder.java&lt;br/&gt;
@@ -248,9 +248,13 @@ public ConfigInfos validateConnectorConfig(Map&amp;lt;String, String&amp;gt; connectorProps) {&lt;br/&gt;
         Connector connector = getConnector(connType);&lt;br/&gt;
         ClassLoader savedLoader = plugins().compareAndSwapLoaders(connector);&lt;br/&gt;
         try {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ConfigDef baseConfigDef = (connector instanceof SourceConnector)&lt;/li&gt;
	&lt;li&gt;? SourceConnectorConfig.configDef()&lt;/li&gt;
	&lt;li&gt;: SinkConnectorConfig.configDef();&lt;br/&gt;
+            ConfigDef baseConfigDef;&lt;br/&gt;
+            if (connector instanceof SourceConnector) 
{
+                baseConfigDef = SourceConnectorConfig.configDef();
+            }
&lt;p&gt; else &lt;/p&gt;
{
+                baseConfigDef = SinkConnectorConfig.configDef();
+                SinkConnectorConfig.validate(connectorProps);
+            }
&lt;p&gt;             ConfigDef enrichedConfigDef = ConnectorConfig.enrich(plugins(), baseConfigDef, connectorProps, false);&lt;br/&gt;
             Map&amp;lt;String, ConfigValue&amp;gt; validatedConnectorConfig = validateBasicConnectorConfig(&lt;br/&gt;
                     connector,&lt;br/&gt;
diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/SinkConnectorConfig.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/SinkConnectorConfig.java&lt;br/&gt;
index cf5564c25c2..887a4da2dea 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/SinkConnectorConfig.java&lt;br/&gt;
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/SinkConnectorConfig.java&lt;br/&gt;
@@ -17,6 +17,7 @@&lt;br/&gt;
 package org.apache.kafka.connect.runtime;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; import org.apache.kafka.common.config.ConfigDef;&lt;br/&gt;
+import org.apache.kafka.common.config.ConfigException;&lt;br/&gt;
 import org.apache.kafka.connect.runtime.isolation.Plugins;&lt;br/&gt;
 import org.apache.kafka.connect.sink.SinkTask;&lt;br/&gt;
 import org.apache.kafka.connect.transforms.util.RegexValidator;&lt;br/&gt;
@@ -34,7 +35,7 @@&lt;br/&gt;
     public static final String TOPICS_DEFAULT = &quot;&quot;;&lt;br/&gt;
     private static final String TOPICS_DISPLAY = &quot;Topics&quot;;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final String TOPICS_REGEX_CONFIG = SinkTask.TOPICS_REGEX_CONFIG;&lt;br/&gt;
+    public static final String TOPICS_REGEX_CONFIG = SinkTask.TOPICS_REGEX_CONFIG;&lt;br/&gt;
     private static final String TOPICS_REGEX_DOC = &quot;Regular expression giving topics to consume. &quot; +&lt;br/&gt;
         &quot;Under the hood, the regex is compiled to a &amp;lt;code&amp;gt;java.util.regex.Pattern&amp;lt;/code&amp;gt;. &quot; +&lt;br/&gt;
         &quot;Only one of &quot; + TOPICS_CONFIG + &quot; or &quot; + TOPICS_REGEX_CONFIG + &quot; should be specified.&quot;;&lt;br/&gt;
@@ -52,4 +53,34 @@ public static ConfigDef configDef() {&lt;br/&gt;
     public SinkConnectorConfig(Plugins plugins, Map&amp;lt;String, String&amp;gt; props) 
{
         super(plugins, config, props);
     }
&lt;p&gt;+&lt;br/&gt;
+    /**&lt;br/&gt;
+     * Throw an exception if the passed-in properties do not constitute a valid sink.&lt;br/&gt;
+     * @param props sink configuration properties&lt;br/&gt;
+     */&lt;br/&gt;
+    public static void validate(Map&amp;lt;String, String&amp;gt; props) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+        final boolean hasTopicsConfig = hasTopicsConfig(props);+        final boolean hasTopicsRegexConfig = hasTopicsRegexConfig(props);++        if (hasTopicsConfig &amp;amp;&amp;amp; hasTopicsRegexConfig) {
+            throw new ConfigException(SinkTask.TOPICS_CONFIG + &quot; and &quot; + SinkTask.TOPICS_REGEX_CONFIG +
+                &quot; are mutually exclusive options, but both are set.&quot;);
+        }++        if (!hasTopicsConfig &amp;amp;&amp;amp; !hasTopicsRegexConfig) {
+            throw new ConfigException(&quot;Must configure one of &quot; +
+                SinkTask.TOPICS_CONFIG + &quot; or &quot; + SinkTask.TOPICS_REGEX_CONFIG);
+        }+    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;+&lt;br/&gt;
+    public static boolean hasTopicsConfig(Map&amp;lt;String, String&amp;gt; props) &lt;/p&gt;
{
+        String topicsStr = props.get(TOPICS_CONFIG);
+        return topicsStr != null &amp;amp;&amp;amp; !topicsStr.trim().isEmpty();
+    }
&lt;p&gt;+&lt;br/&gt;
+    public static boolean hasTopicsRegexConfig(Map&amp;lt;String, String&amp;gt; props) &lt;/p&gt;
{
+        String topicsRegexStr = props.get(TOPICS_REGEX_CONFIG);
+        return topicsRegexStr != null &amp;amp;&amp;amp; !topicsRegexStr.trim().isEmpty();
+    }
&lt;p&gt;+&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerConnector.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerConnector.java&lt;br/&gt;
index 9e65cd2d80f..29f487386ac 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerConnector.java&lt;br/&gt;
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerConnector.java&lt;br/&gt;
@@ -77,6 +77,9 @@ public void initialize(ConnectorConfig connectorConfig) {&lt;br/&gt;
         try {&lt;br/&gt;
             this.config = connectorConfig.originalsStrings();&lt;br/&gt;
             log.debug(&quot;{} Initializing connector {} with config {}&quot;, this, connName, config);&lt;br/&gt;
+            if (isSinkConnector()) 
{
+                SinkConnectorConfig.validate(config);
+            }&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;             connector.initialize(new ConnectorContext() {&lt;br/&gt;
                 @Override&lt;br/&gt;
diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java&lt;br/&gt;
index 05ace587249..9c064325bef 100644&lt;br/&gt;
&amp;#8212; a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java&lt;br/&gt;
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java&lt;br/&gt;
@@ -25,7 +25,6 @@&lt;br/&gt;
 import org.apache.kafka.clients.consumer.OffsetCommitCallback;&lt;br/&gt;
 import org.apache.kafka.common.KafkaException;&lt;br/&gt;
 import org.apache.kafka.common.TopicPartition;&lt;br/&gt;
-import org.apache.kafka.common.config.ConfigException;&lt;br/&gt;
 import org.apache.kafka.common.errors.WakeupException;&lt;br/&gt;
 import org.apache.kafka.common.metrics.Sensor;&lt;br/&gt;
 import org.apache.kafka.common.metrics.stats.Avg;&lt;br/&gt;
@@ -259,27 +258,14 @@ public int commitFailures() {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Initializes and starts the SinkTask.&lt;br/&gt;
      */&lt;br/&gt;
     protected void initializeAndStart() {&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String topicsStr = taskConfig.get(SinkTask.TOPICS_CONFIG);&lt;/li&gt;
	&lt;li&gt;boolean topicsStrPresent = topicsStr != null &amp;amp;&amp;amp; !topicsStr.trim().isEmpty();&lt;br/&gt;
+        SinkConnectorConfig.validate(taskConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String topicsRegexStr = taskConfig.get(SinkTask.TOPICS_REGEX_CONFIG);&lt;/li&gt;
	&lt;li&gt;boolean topicsRegexStrPresent = topicsRegexStr != null &amp;amp;&amp;amp; !topicsRegexStr.trim().isEmpty();&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;if (topicsStrPresent &amp;amp;&amp;amp; topicsRegexStrPresent) 
{
-            throw new ConfigException(SinkTask.TOPICS_CONFIG + &quot; and &quot; + SinkTask.TOPICS_REGEX_CONFIG +
-                &quot; are mutually exclusive options, but both are set.&quot;);
-        }
&lt;p&gt;-&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;if (!topicsStrPresent &amp;amp;&amp;amp; !topicsRegexStrPresent) 
{
-            throw new ConfigException(&quot;Must configure one of &quot; +
-                SinkTask.TOPICS_CONFIG + &quot; or &quot; + SinkTask.TOPICS_REGEX_CONFIG);
-        }
&lt;p&gt;-&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;if (topicsStrPresent) {&lt;/li&gt;
	&lt;li&gt;String[] topics = topicsStr.split(&quot;,&quot;);&lt;br/&gt;
+        if (SinkConnectorConfig.hasTopicsConfig(taskConfig)) {&lt;br/&gt;
+            String[] topics = taskConfig.get(SinkTask.TOPICS_CONFIG).split(&quot;,&quot;);&lt;br/&gt;
             consumer.subscribe(Arrays.asList(topics), new HandleRebalance());&lt;br/&gt;
             log.debug(&quot;{} Initializing and starting task for topics {}&quot;, this, topics);&lt;br/&gt;
         } else {&lt;br/&gt;
+            String topicsRegexStr = taskConfig.get(SinkTask.TOPICS_REGEX_CONFIG);&lt;br/&gt;
             Pattern pattern = Pattern.compile(topicsRegexStr);&lt;br/&gt;
             consumer.subscribe(pattern, new HandleRebalance());&lt;br/&gt;
             log.debug(&quot;{} Initializing and starting task for topics regex {}&quot;, this, topicsRegexStr);&lt;br/&gt;
diff --git a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/AbstractHerderTest.java b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/AbstractHerderTest.java&lt;br/&gt;
index ac9c312823c..2400abf327a 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/AbstractHerderTest.java&lt;br/&gt;
+++ b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/AbstractHerderTest.java&lt;br/&gt;
@@ -17,6 +17,7 @@&lt;br/&gt;
 package org.apache.kafka.connect.runtime;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; import org.apache.kafka.common.config.ConfigDef;&lt;br/&gt;
+import org.apache.kafka.common.config.ConfigException;&lt;br/&gt;
 import org.apache.kafka.connect.connector.ConnectRecord;&lt;br/&gt;
 import org.apache.kafka.connect.connector.Connector;&lt;br/&gt;
 import org.apache.kafka.connect.runtime.isolation.PluginDesc;&lt;br/&gt;
@@ -174,6 +175,21 @@ public void testConfigValidationMissingName() &lt;/p&gt;
{
         verifyAll();
     }

&lt;p&gt;+    @Test(expected = ConfigException.class)&lt;br/&gt;
+    public void testConfigValidationInvalidTopics() &lt;/p&gt;
{
+        AbstractHerder herder = createConfigValidationHerder(TestSinkConnector.class);
+        replayAll();
+
+        Map&amp;lt;String, String&amp;gt; config = new HashMap();
+        config.put(ConnectorConfig.CONNECTOR_CLASS_CONFIG, TestSinkConnector.class.getName());
+        config.put(SinkConnectorConfig.TOPICS_CONFIG, &quot;topic1,topic2&quot;);
+        config.put(SinkConnectorConfig.TOPICS_REGEX_CONFIG, &quot;topic.*&quot;);
+
+        herder.validateConnectorConfig(config);
+
+        verifyAll();
+    }
&lt;p&gt;+&lt;br/&gt;
     @Test()&lt;br/&gt;
     public void testConfigValidationTransformsExtendResults() {&lt;br/&gt;
         AbstractHerder herder = createConfigValidationHerder(TestSourceConnector.class);&lt;br/&gt;
diff --git a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/distributed/DistributedHerderTest.java b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/distributed/DistributedHerderTest.java&lt;br/&gt;
index d41ccbebae0..d1e02edf0b5 100644&lt;br/&gt;
&amp;#8212; a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/distributed/DistributedHerderTest.java&lt;br/&gt;
+++ b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/distributed/DistributedHerderTest.java&lt;br/&gt;
@@ -352,7 +352,7 @@ public void testCreateConnector() throws Exception {&lt;br/&gt;
         PowerMock.expectLastCall();&lt;/p&gt;

&lt;p&gt;         // config validation&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(3);&lt;br/&gt;
         EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);&lt;br/&gt;
         EasyMock.expect(plugins.newConnector(EasyMock.anyString())).andReturn(connectorMock);&lt;br/&gt;
@@ -395,7 +395,7 @@ public void testCreateConnectorFailedBasicValidation() throws Exception {&lt;br/&gt;
         PowerMock.expectLastCall();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // config validation&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(3);&lt;br/&gt;
         EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);&lt;br/&gt;
         EasyMock.expect(plugins.newConnector(EasyMock.anyString())).andReturn(connectorMock);&lt;br/&gt;
@@ -440,7 +440,7 @@ public void testCreateConnectorFailedCustomValidation() throws Exception {&lt;br/&gt;
         PowerMock.expectLastCall();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // config validation&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(3);&lt;br/&gt;
         EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);&lt;br/&gt;
         EasyMock.expect(plugins.newConnector(EasyMock.anyString())).andReturn(connectorMock);&lt;br/&gt;
@@ -1335,7 +1335,7 @@ public void testPutConnectorConfig() throws Exception {&lt;br/&gt;
         PowerMock.expectLastCall();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // config validation&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         EasyMock.expect(worker.getPlugins()).andReturn(plugins).anyTimes();&lt;br/&gt;
         EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);&lt;br/&gt;
         EasyMock.expect(plugins.newConnector(EasyMock.anyString())).andReturn(connectorMock);&lt;br/&gt;
diff --git a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/standalone/StandaloneHerderTest.java b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/standalone/StandaloneHerderTest.java&lt;br/&gt;
index 18d2739f13e..c29005a0a04 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/standalone/StandaloneHerderTest.java&lt;br/&gt;
+++ b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/standalone/StandaloneHerderTest.java&lt;br/&gt;
@@ -124,7 +124,8 @@ public void testCreateSourceConnector() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(config);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, config);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         PowerMock.replayAll();&lt;/p&gt;

&lt;p&gt;@@ -141,7 +142,7 @@ public void testCreateConnectorFailedBasicValidation() throws Exception {&lt;br/&gt;
         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SOURCE);&lt;br/&gt;
         config.remove(ConnectorConfig.NAME_CONFIG);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(3);&lt;br/&gt;
         EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);&lt;br/&gt;
         EasyMock.expect(plugins.newConnector(EasyMock.anyString())).andReturn(connectorMock);&lt;br/&gt;
@@ -166,7 +167,7 @@ public void testCreateConnectorFailedBasicValidation() throws Exception {&lt;br/&gt;
     public void testCreateConnectorFailedCustomValidation() throws Exception {&lt;br/&gt;
         connector = PowerMock.createMock(BogusSourceConnector.class);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(3);&lt;br/&gt;
         EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);&lt;br/&gt;
         EasyMock.expect(plugins.newConnector(EasyMock.anyString())).andReturn(connectorMock);&lt;br/&gt;
@@ -198,7 +199,7 @@ public void testCreateConnectorAlreadyExists() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         expectConfigValidation(connectorMock, true, config, config);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(2);&lt;br/&gt;
@@ -223,7 +224,8 @@ public void testCreateSinkConnector() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SINK);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SINK);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(config);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SinkConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, config);&lt;br/&gt;
         PowerMock.replayAll();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         herder.putConnectorConfig(CONNECTOR_NAME, config, false, createCallback);&lt;br/&gt;
@@ -237,7 +239,8 @@ public void testDestroyConnector() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(config);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, config);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         EasyMock.expect(statusBackingStore.getAll(CONNECTOR_NAME)).andReturn(Collections.&amp;lt;TaskStatus&amp;gt;emptyList());&lt;br/&gt;
         statusBackingStore.put(new ConnectorStatus(CONNECTOR_NAME, AbstractStatus.State.DESTROYED, WORKER_ID, 0));&lt;br/&gt;
@@ -269,7 +272,8 @@ public void testRestartConnector() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(config);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, config);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         worker.stopConnector(CONNECTOR_NAME);&lt;br/&gt;
         EasyMock.expectLastCall().andReturn(true);&lt;br/&gt;
@@ -294,7 +298,8 @@ public void testRestartConnectorFailureOnStart() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(config);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, config);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         worker.stopConnector(CONNECTOR_NAME);&lt;br/&gt;
         EasyMock.expectLastCall().andReturn(true);&lt;br/&gt;
@@ -325,7 +330,8 @@ public void testRestartTask() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; connectorConfig = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(connectorConfig);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, connectorConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         worker.stopAndAwaitTask(taskId);&lt;br/&gt;
         EasyMock.expectLastCall();&lt;br/&gt;
@@ -350,7 +356,8 @@ public void testRestartTaskFailureOnStart() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; connectorConfig = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(connectorConfig);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, connectorConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         worker.stopAndAwaitTask(taskId);&lt;br/&gt;
         EasyMock.expectLastCall();&lt;br/&gt;
@@ -380,7 +387,8 @@ public void testCreateAndStop() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; connectorConfig = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(connectorConfig);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, connectorConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // herder.stop() should stop any running connectors and tasks even if destroyConnector was not invoked&lt;br/&gt;
         expectStop();&lt;br/&gt;
@@ -401,6 +409,7 @@ public void testCreateAndStop() throws Exception {&lt;br/&gt;
     @Test&lt;br/&gt;
     public void testAccessors() throws Exception {&lt;br/&gt;
         Map&amp;lt;String, String&amp;gt; connConfig = connectorConfig(SourceSink.SOURCE);&lt;br/&gt;
+        System.out.println(connConfig);&lt;/p&gt;

&lt;p&gt;         Callback&amp;lt;Collection&amp;lt;String&amp;gt;&amp;gt; listConnectorsCb = PowerMock.createMock(Callback.class);&lt;br/&gt;
         Callback&amp;lt;ConnectorInfo&amp;gt; connectorInfoCb = PowerMock.createMock(Callback.class);&lt;br/&gt;
@@ -420,7 +429,8 @@ public void testAccessors() throws Exception {&lt;br/&gt;
         // Create connector&lt;br/&gt;
         connector = PowerMock.createMock(BogusSourceConnector.class);&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(connConfig);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connector, true, connConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // Validate accessors with 1 connector&lt;br/&gt;
         listConnectorsCb.onCompletion(null, singleton(CONNECTOR_NAME));&lt;br/&gt;
@@ -466,7 +476,7 @@ public void testPutConnectorConfig() throws Exception {&lt;br/&gt;
         // Create&lt;br/&gt;
         connector = PowerMock.createMock(BogusSourceConnector.class);&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         expectConfigValidation(connectorMock, true, connConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // Should get first config&lt;br/&gt;
@@ -525,7 +535,8 @@ public void testCorruptConfig() {&lt;br/&gt;
         Map&amp;lt;String, String&amp;gt; config = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
         config.put(ConnectorConfig.NAME_CONFIG, CONNECTOR_NAME);&lt;br/&gt;
         config.put(ConnectorConfig.CONNECTOR_CLASS_CONFIG, BogusSinkConnector.class.getName());&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        config.put(SinkConnectorConfig.TOPICS_CONFIG, TOPICS_LIST_STR);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SinkConnector.class);&lt;br/&gt;
         String error = &quot;This is an error in your config!&quot;;&lt;br/&gt;
         List&amp;lt;String&amp;gt; errors = new ArrayList&amp;lt;&amp;gt;(singletonList(error));&lt;br/&gt;
         String key = &quot;foo.invalid.key&quot;;&lt;br/&gt;
@@ -591,7 +602,7 @@ private void expectAdd(SourceSink sourceSink) throws Exception 
{
         EasyMock.expect(herder.connectorTypeForClass(BogusSourceConnector.class.getName()))
             .andReturn(ConnectorType.SOURCE).anyTimes();
         EasyMock.expect(herder.connectorTypeForClass(BogusSinkConnector.class.getName()))
-        .andReturn(ConnectorType.SINK).anyTimes();
+            .andReturn(ConnectorType.SINK).anyTimes();
         worker.isSinkConnector(CONNECTOR_NAME);
         PowerMock.expectLastCall().andReturn(sourceSink == SourceSink.SINK);
     }
&lt;p&gt;@@ -630,12 +641,6 @@ private void expectDestroy() &lt;/p&gt;
{
         return generatedTaskProps;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private void expectConfigValidation(Map&amp;lt;String, String&amp;gt; ... configs) 
{
-        Connector connectorMock = PowerMock.createMock(Connector.class);
-        expectConfigValidation(connectorMock, true, configs);
-    }
&lt;p&gt;-&lt;br/&gt;
     private void expectConfigValidation(&lt;br/&gt;
             Connector connectorMock,&lt;br/&gt;
             boolean shouldCreateConnector,&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16352691" author="githubbot" created="Mon, 5 Feb 2018 17:47:46 +0000"  >&lt;p&gt;ewencp closed pull request #4251: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-6253&quot; title=&quot;Improve sink connector topic regex validation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-6253&quot;&gt;&lt;del&gt;KAFKA-6253&lt;/del&gt;&lt;/a&gt;: Improve sink connector topic regex validation&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/4251&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/4251&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/AbstractHerder.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/AbstractHerder.java&lt;br/&gt;
index 02465c922f1..b913f9ed65e 100644&lt;br/&gt;
&amp;#8212; a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/AbstractHerder.java&lt;br/&gt;
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/AbstractHerder.java&lt;br/&gt;
@@ -256,9 +256,13 @@ public ConfigInfos validateConnectorConfig(Map&amp;lt;String, String&amp;gt; connectorProps) {&lt;br/&gt;
         Connector connector = getConnector(connType);&lt;br/&gt;
         ClassLoader savedLoader = plugins().compareAndSwapLoaders(connector);&lt;br/&gt;
         try {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ConfigDef baseConfigDef = (connector instanceof SourceConnector)&lt;/li&gt;
	&lt;li&gt;? SourceConnectorConfig.configDef()&lt;/li&gt;
	&lt;li&gt;: SinkConnectorConfig.configDef();&lt;br/&gt;
+            ConfigDef baseConfigDef;&lt;br/&gt;
+            if (connector instanceof SourceConnector) 
{
+                baseConfigDef = SourceConnectorConfig.configDef();
+            }
&lt;p&gt; else &lt;/p&gt;
{
+                baseConfigDef = SinkConnectorConfig.configDef();
+                SinkConnectorConfig.validate(connectorProps);
+            }
&lt;p&gt;             ConfigDef enrichedConfigDef = ConnectorConfig.enrich(plugins(), baseConfigDef, connectorProps, false);&lt;br/&gt;
             Map&amp;lt;String, ConfigValue&amp;gt; validatedConnectorConfig = validateBasicConnectorConfig(&lt;br/&gt;
                     connector,&lt;br/&gt;
diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/SinkConnectorConfig.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/SinkConnectorConfig.java&lt;br/&gt;
index cf5564c25c2..887a4da2dea 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/SinkConnectorConfig.java&lt;br/&gt;
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/SinkConnectorConfig.java&lt;br/&gt;
@@ -17,6 +17,7 @@&lt;br/&gt;
 package org.apache.kafka.connect.runtime;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; import org.apache.kafka.common.config.ConfigDef;&lt;br/&gt;
+import org.apache.kafka.common.config.ConfigException;&lt;br/&gt;
 import org.apache.kafka.connect.runtime.isolation.Plugins;&lt;br/&gt;
 import org.apache.kafka.connect.sink.SinkTask;&lt;br/&gt;
 import org.apache.kafka.connect.transforms.util.RegexValidator;&lt;br/&gt;
@@ -34,7 +35,7 @@&lt;br/&gt;
     public static final String TOPICS_DEFAULT = &quot;&quot;;&lt;br/&gt;
     private static final String TOPICS_DISPLAY = &quot;Topics&quot;;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final String TOPICS_REGEX_CONFIG = SinkTask.TOPICS_REGEX_CONFIG;&lt;br/&gt;
+    public static final String TOPICS_REGEX_CONFIG = SinkTask.TOPICS_REGEX_CONFIG;&lt;br/&gt;
     private static final String TOPICS_REGEX_DOC = &quot;Regular expression giving topics to consume. &quot; +&lt;br/&gt;
         &quot;Under the hood, the regex is compiled to a &amp;lt;code&amp;gt;java.util.regex.Pattern&amp;lt;/code&amp;gt;. &quot; +&lt;br/&gt;
         &quot;Only one of &quot; + TOPICS_CONFIG + &quot; or &quot; + TOPICS_REGEX_CONFIG + &quot; should be specified.&quot;;&lt;br/&gt;
@@ -52,4 +53,34 @@ public static ConfigDef configDef() {&lt;br/&gt;
     public SinkConnectorConfig(Plugins plugins, Map&amp;lt;String, String&amp;gt; props) 
{
         super(plugins, config, props);
     }
&lt;p&gt;+&lt;br/&gt;
+    /**&lt;br/&gt;
+     * Throw an exception if the passed-in properties do not constitute a valid sink.&lt;br/&gt;
+     * @param props sink configuration properties&lt;br/&gt;
+     */&lt;br/&gt;
+    public static void validate(Map&amp;lt;String, String&amp;gt; props) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+        final boolean hasTopicsConfig = hasTopicsConfig(props);+        final boolean hasTopicsRegexConfig = hasTopicsRegexConfig(props);++        if (hasTopicsConfig &amp;amp;&amp;amp; hasTopicsRegexConfig) {
+            throw new ConfigException(SinkTask.TOPICS_CONFIG + &quot; and &quot; + SinkTask.TOPICS_REGEX_CONFIG +
+                &quot; are mutually exclusive options, but both are set.&quot;);
+        }++        if (!hasTopicsConfig &amp;amp;&amp;amp; !hasTopicsRegexConfig) {
+            throw new ConfigException(&quot;Must configure one of &quot; +
+                SinkTask.TOPICS_CONFIG + &quot; or &quot; + SinkTask.TOPICS_REGEX_CONFIG);
+        }+    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;+&lt;br/&gt;
+    public static boolean hasTopicsConfig(Map&amp;lt;String, String&amp;gt; props) &lt;/p&gt;
{
+        String topicsStr = props.get(TOPICS_CONFIG);
+        return topicsStr != null &amp;amp;&amp;amp; !topicsStr.trim().isEmpty();
+    }
&lt;p&gt;+&lt;br/&gt;
+    public static boolean hasTopicsRegexConfig(Map&amp;lt;String, String&amp;gt; props) &lt;/p&gt;
{
+        String topicsRegexStr = props.get(TOPICS_REGEX_CONFIG);
+        return topicsRegexStr != null &amp;amp;&amp;amp; !topicsRegexStr.trim().isEmpty();
+    }
&lt;p&gt;+&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerConnector.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerConnector.java&lt;br/&gt;
index 9b934f3428a..611e196d9de 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerConnector.java&lt;br/&gt;
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerConnector.java&lt;br/&gt;
@@ -77,6 +77,9 @@ public void initialize(ConnectorConfig connectorConfig) {&lt;br/&gt;
         try {&lt;br/&gt;
             this.config = connectorConfig.originalsStrings();&lt;br/&gt;
             log.debug(&quot;{} Initializing connector {} with config {}&quot;, this, connName, config);&lt;br/&gt;
+            if (isSinkConnector()) 
{
+                SinkConnectorConfig.validate(config);
+            }&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;             connector.initialize(new ConnectorContext() {&lt;br/&gt;
                 @Override&lt;br/&gt;
diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java&lt;br/&gt;
index 69614948147..39e17e32a5f 100644&lt;br/&gt;
&amp;#8212; a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java&lt;br/&gt;
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java&lt;br/&gt;
@@ -25,7 +25,6 @@&lt;br/&gt;
 import org.apache.kafka.clients.consumer.OffsetCommitCallback;&lt;br/&gt;
 import org.apache.kafka.common.KafkaException;&lt;br/&gt;
 import org.apache.kafka.common.TopicPartition;&lt;br/&gt;
-import org.apache.kafka.common.config.ConfigException;&lt;br/&gt;
 import org.apache.kafka.common.errors.WakeupException;&lt;br/&gt;
 import org.apache.kafka.common.metrics.Sensor;&lt;br/&gt;
 import org.apache.kafka.common.metrics.stats.Avg;&lt;br/&gt;
@@ -259,27 +258,14 @@ public int commitFailures() {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Initializes and starts the SinkTask.&lt;br/&gt;
      */&lt;br/&gt;
     protected void initializeAndStart() {&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String topicsStr = taskConfig.get(SinkTask.TOPICS_CONFIG);&lt;/li&gt;
	&lt;li&gt;boolean topicsStrPresent = topicsStr != null &amp;amp;&amp;amp; !topicsStr.trim().isEmpty();&lt;br/&gt;
+        SinkConnectorConfig.validate(taskConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String topicsRegexStr = taskConfig.get(SinkTask.TOPICS_REGEX_CONFIG);&lt;/li&gt;
	&lt;li&gt;boolean topicsRegexStrPresent = topicsRegexStr != null &amp;amp;&amp;amp; !topicsRegexStr.trim().isEmpty();&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;if (topicsStrPresent &amp;amp;&amp;amp; topicsRegexStrPresent) 
{
-            throw new ConfigException(SinkTask.TOPICS_CONFIG + &quot; and &quot; + SinkTask.TOPICS_REGEX_CONFIG +
-                &quot; are mutually exclusive options, but both are set.&quot;);
-        }
&lt;p&gt;-&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;if (!topicsStrPresent &amp;amp;&amp;amp; !topicsRegexStrPresent) 
{
-            throw new ConfigException(&quot;Must configure one of &quot; +
-                SinkTask.TOPICS_CONFIG + &quot; or &quot; + SinkTask.TOPICS_REGEX_CONFIG);
-        }
&lt;p&gt;-&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;if (topicsStrPresent) {&lt;/li&gt;
	&lt;li&gt;String[] topics = topicsStr.split(&quot;,&quot;);&lt;br/&gt;
+        if (SinkConnectorConfig.hasTopicsConfig(taskConfig)) {&lt;br/&gt;
+            String[] topics = taskConfig.get(SinkTask.TOPICS_CONFIG).split(&quot;,&quot;);&lt;br/&gt;
             consumer.subscribe(Arrays.asList(topics), new HandleRebalance());&lt;br/&gt;
             log.debug(&quot;{} Initializing and starting task for topics {}&quot;, this, topics);&lt;br/&gt;
         } else {&lt;br/&gt;
+            String topicsRegexStr = taskConfig.get(SinkTask.TOPICS_REGEX_CONFIG);&lt;br/&gt;
             Pattern pattern = Pattern.compile(topicsRegexStr);&lt;br/&gt;
             consumer.subscribe(pattern, new HandleRebalance());&lt;br/&gt;
             log.debug(&quot;{} Initializing and starting task for topics regex {}&quot;, this, topicsRegexStr);&lt;br/&gt;
diff --git a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/AbstractHerderTest.java b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/AbstractHerderTest.java&lt;br/&gt;
index 500d31f42e0..97cc7d94448 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/AbstractHerderTest.java&lt;br/&gt;
+++ b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/AbstractHerderTest.java&lt;br/&gt;
@@ -17,6 +17,7 @@&lt;br/&gt;
 package org.apache.kafka.connect.runtime;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; import org.apache.kafka.common.config.ConfigDef;&lt;br/&gt;
+import org.apache.kafka.common.config.ConfigException;&lt;br/&gt;
 import org.apache.kafka.connect.connector.ConnectRecord;&lt;br/&gt;
 import org.apache.kafka.connect.connector.Connector;&lt;br/&gt;
 import org.apache.kafka.connect.runtime.isolation.PluginDesc;&lt;br/&gt;
@@ -175,6 +176,21 @@ public void testConfigValidationMissingName() &lt;/p&gt;
{
         verifyAll();
     }

&lt;p&gt;+    @Test(expected = ConfigException.class)&lt;br/&gt;
+    public void testConfigValidationInvalidTopics() &lt;/p&gt;
{
+        AbstractHerder herder = createConfigValidationHerder(TestSinkConnector.class);
+        replayAll();
+
+        Map&amp;lt;String, String&amp;gt; config = new HashMap();
+        config.put(ConnectorConfig.CONNECTOR_CLASS_CONFIG, TestSinkConnector.class.getName());
+        config.put(SinkConnectorConfig.TOPICS_CONFIG, &quot;topic1,topic2&quot;);
+        config.put(SinkConnectorConfig.TOPICS_REGEX_CONFIG, &quot;topic.*&quot;);
+
+        herder.validateConnectorConfig(config);
+
+        verifyAll();
+    }
&lt;p&gt;+&lt;br/&gt;
     @Test()&lt;br/&gt;
     public void testConfigValidationTransformsExtendResults() {&lt;br/&gt;
         AbstractHerder herder = createConfigValidationHerder(TestSourceConnector.class);&lt;br/&gt;
diff --git a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/distributed/DistributedHerderTest.java b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/distributed/DistributedHerderTest.java&lt;br/&gt;
index d7307cfdbc4..d7a7d87cb4f 100644&lt;br/&gt;
&amp;#8212; a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/distributed/DistributedHerderTest.java&lt;br/&gt;
+++ b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/distributed/DistributedHerderTest.java&lt;br/&gt;
@@ -355,7 +355,7 @@ public void testCreateConnector() throws Exception {&lt;br/&gt;
         PowerMock.expectLastCall();&lt;/p&gt;

&lt;p&gt;         // config validation&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(3);&lt;br/&gt;
         EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);&lt;br/&gt;
         EasyMock.expect(plugins.newConnector(EasyMock.anyString())).andReturn(connectorMock);&lt;br/&gt;
@@ -398,7 +398,7 @@ public void testCreateConnectorFailedBasicValidation() throws Exception {&lt;br/&gt;
         PowerMock.expectLastCall();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // config validation&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(3);&lt;br/&gt;
         EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);&lt;br/&gt;
         EasyMock.expect(plugins.newConnector(EasyMock.anyString())).andReturn(connectorMock);&lt;br/&gt;
@@ -443,7 +443,7 @@ public void testCreateConnectorFailedCustomValidation() throws Exception {&lt;br/&gt;
         PowerMock.expectLastCall();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // config validation&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(3);&lt;br/&gt;
         EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);&lt;br/&gt;
         EasyMock.expect(plugins.newConnector(EasyMock.anyString())).andReturn(connectorMock);&lt;br/&gt;
@@ -1338,7 +1338,7 @@ public void testPutConnectorConfig() throws Exception {&lt;br/&gt;
         PowerMock.expectLastCall();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // config validation&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         EasyMock.expect(worker.getPlugins()).andReturn(plugins).anyTimes();&lt;br/&gt;
         EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);&lt;br/&gt;
         EasyMock.expect(plugins.newConnector(EasyMock.anyString())).andReturn(connectorMock);&lt;br/&gt;
diff --git a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/standalone/StandaloneHerderTest.java b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/standalone/StandaloneHerderTest.java&lt;br/&gt;
index 79be45b3290..fd330f28009 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/standalone/StandaloneHerderTest.java&lt;br/&gt;
+++ b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/standalone/StandaloneHerderTest.java&lt;br/&gt;
@@ -125,7 +125,8 @@ public void testCreateSourceConnector() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(config);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, config);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         PowerMock.replayAll();&lt;/p&gt;

&lt;p&gt;@@ -142,7 +143,7 @@ public void testCreateConnectorFailedBasicValidation() throws Exception {&lt;br/&gt;
         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SOURCE);&lt;br/&gt;
         config.remove(ConnectorConfig.NAME_CONFIG);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(3);&lt;br/&gt;
         EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);&lt;br/&gt;
         EasyMock.expect(plugins.newConnector(EasyMock.anyString())).andReturn(connectorMock);&lt;br/&gt;
@@ -167,7 +168,7 @@ public void testCreateConnectorFailedBasicValidation() throws Exception {&lt;br/&gt;
     public void testCreateConnectorFailedCustomValidation() throws Exception {&lt;br/&gt;
         connector = PowerMock.createMock(BogusSourceConnector.class);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(3);&lt;br/&gt;
         EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);&lt;br/&gt;
         EasyMock.expect(plugins.newConnector(EasyMock.anyString())).andReturn(connectorMock);&lt;br/&gt;
@@ -199,7 +200,7 @@ public void testCreateConnectorAlreadyExists() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         expectConfigValidation(connectorMock, true, config, config);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(2);&lt;br/&gt;
@@ -224,7 +225,8 @@ public void testCreateSinkConnector() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SINK);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SINK);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(config);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SinkConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, config);&lt;br/&gt;
         PowerMock.replayAll();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         herder.putConnectorConfig(CONNECTOR_NAME, config, false, createCallback);&lt;br/&gt;
@@ -238,7 +240,8 @@ public void testDestroyConnector() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(config);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, config);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         EasyMock.expect(statusBackingStore.getAll(CONNECTOR_NAME)).andReturn(Collections.&amp;lt;TaskStatus&amp;gt;emptyList());&lt;br/&gt;
         statusBackingStore.put(new ConnectorStatus(CONNECTOR_NAME, AbstractStatus.State.DESTROYED, WORKER_ID, 0));&lt;br/&gt;
@@ -270,7 +273,8 @@ public void testRestartConnector() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(config);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, config);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         worker.stopConnector(CONNECTOR_NAME);&lt;br/&gt;
         EasyMock.expectLastCall().andReturn(true);&lt;br/&gt;
@@ -295,7 +299,8 @@ public void testRestartConnectorFailureOnStart() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; config = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(config);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, config);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         worker.stopConnector(CONNECTOR_NAME);&lt;br/&gt;
         EasyMock.expectLastCall().andReturn(true);&lt;br/&gt;
@@ -326,7 +331,8 @@ public void testRestartTask() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; connectorConfig = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(connectorConfig);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, connectorConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         worker.stopAndAwaitTask(taskId);&lt;br/&gt;
         EasyMock.expectLastCall();&lt;br/&gt;
@@ -351,7 +357,8 @@ public void testRestartTaskFailureOnStart() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; connectorConfig = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(connectorConfig);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, connectorConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         worker.stopAndAwaitTask(taskId);&lt;br/&gt;
         EasyMock.expectLastCall();&lt;br/&gt;
@@ -381,7 +388,8 @@ public void testCreateAndStop() throws Exception {&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;

&lt;p&gt;         Map&amp;lt;String, String&amp;gt; connectorConfig = connectorConfig(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(connectorConfig);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connectorMock, true, connectorConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // herder.stop() should stop any running connectors and tasks even if destroyConnector was not invoked&lt;br/&gt;
         expectStop();&lt;br/&gt;
@@ -402,6 +410,7 @@ public void testCreateAndStop() throws Exception {&lt;br/&gt;
     @Test&lt;br/&gt;
     public void testAccessors() throws Exception {&lt;br/&gt;
         Map&amp;lt;String, String&amp;gt; connConfig = connectorConfig(SourceSink.SOURCE);&lt;br/&gt;
+        System.out.println(connConfig);&lt;/p&gt;

&lt;p&gt;         Callback&amp;lt;Collection&amp;lt;String&amp;gt;&amp;gt; listConnectorsCb = PowerMock.createMock(Callback.class);&lt;br/&gt;
         Callback&amp;lt;ConnectorInfo&amp;gt; connectorInfoCb = PowerMock.createMock(Callback.class);&lt;br/&gt;
@@ -421,7 +430,8 @@ public void testAccessors() throws Exception {&lt;br/&gt;
         // Create connector&lt;br/&gt;
         connector = PowerMock.createMock(BogusSourceConnector.class);&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expectConfigValidation(connConfig);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
+        expectConfigValidation(connector, true, connConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // Validate accessors with 1 connector&lt;br/&gt;
         listConnectorsCb.onCompletion(null, singleton(CONNECTOR_NAME));&lt;br/&gt;
@@ -467,7 +477,7 @@ public void testPutConnectorConfig() throws Exception {&lt;br/&gt;
         // Create&lt;br/&gt;
         connector = PowerMock.createMock(BogusSourceConnector.class);&lt;br/&gt;
         expectAdd(SourceSink.SOURCE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SourceConnector.class);&lt;br/&gt;
         expectConfigValidation(connectorMock, true, connConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // Should get first config&lt;br/&gt;
@@ -526,7 +536,8 @@ public void testCorruptConfig() {&lt;br/&gt;
         Map&amp;lt;String, String&amp;gt; config = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
         config.put(ConnectorConfig.NAME_CONFIG, CONNECTOR_NAME);&lt;br/&gt;
         config.put(ConnectorConfig.CONNECTOR_CLASS_CONFIG, BogusSinkConnector.class.getName());&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connector connectorMock = PowerMock.createMock(Connector.class);&lt;br/&gt;
+        config.put(SinkConnectorConfig.TOPICS_CONFIG, TOPICS_LIST_STR);&lt;br/&gt;
+        Connector connectorMock = PowerMock.createMock(SinkConnector.class);&lt;br/&gt;
         String error = &quot;This is an error in your config!&quot;;&lt;br/&gt;
         List&amp;lt;String&amp;gt; errors = new ArrayList&amp;lt;&amp;gt;(singletonList(error));&lt;br/&gt;
         String key = &quot;foo.invalid.key&quot;;&lt;br/&gt;
@@ -592,7 +603,7 @@ private void expectAdd(SourceSink sourceSink) throws Exception 
{
         EasyMock.expect(herder.connectorTypeForClass(BogusSourceConnector.class.getName()))
             .andReturn(ConnectorType.SOURCE).anyTimes();
         EasyMock.expect(herder.connectorTypeForClass(BogusSinkConnector.class.getName()))
-        .andReturn(ConnectorType.SINK).anyTimes();
+            .andReturn(ConnectorType.SINK).anyTimes();
         worker.isSinkConnector(CONNECTOR_NAME);
         PowerMock.expectLastCall().andReturn(sourceSink == SourceSink.SINK);
     }
&lt;p&gt;@@ -631,12 +642,6 @@ private void expectDestroy() &lt;/p&gt;
{
         return generatedTaskProps;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private void expectConfigValidation(Map&amp;lt;String, String&amp;gt; ... configs) 
{
-        Connector connectorMock = PowerMock.createMock(Connector.class);
-        expectConfigValidation(connectorMock, true, configs);
-    }
&lt;p&gt;-&lt;br/&gt;
     private void expectConfigValidation(&lt;br/&gt;
             Connector connectorMock,&lt;br/&gt;
             boolean shouldCreateConnector,&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13153705">KAFKA-6806</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 41 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3n2pj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ewencp</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>