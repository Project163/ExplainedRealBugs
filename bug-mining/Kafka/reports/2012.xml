<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:13:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-7284] Producer getting fenced may cause Streams to shut down</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-7284</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;As part of the investigation, I will determine what other versions are affected.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In StreamTask, we catch a `ProducerFencedException` and throw a `TaskMigratedException`. However, in this case, the `RecordCollectorImpl` is throwing a `StreamsException`, caused by `KafkaException` caused by `ProducerFencedException`.&lt;/p&gt;

&lt;p&gt;In response to a TaskMigratedException, we would rebalance, but when we get a StreamsException, streams shuts itself down.&lt;/p&gt;

&lt;p&gt;In other words, we intended to do a rebalance in response to a producer fence, but actually, we shut down (when the fence happens inside the record collector).&lt;/p&gt;


&lt;p&gt;Coincidentally, Guozhang noticed and fixed this in a recent PR: &lt;a href=&quot;https://github.com/apache/kafka/pull/5428/files#diff-4e5612eeba09dabf30d0b8430f269ff6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5428/files#diff-4e5612eeba09dabf30d0b8430f269ff6&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The scope of this ticket is to extract that fix and associated tests, and send a separate PR to trunk and 2.0, and also to determine what other versions, if any, are affected.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13178689">KAFKA-7284</key>
            <summary>Producer getting fenced may cause Streams to shut down</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vvcephei">John Roesler</assignee>
                                    <reporter username="vvcephei">John Roesler</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 Aug 2018 19:59:09 +0000</created>
                <updated>Tue, 21 Aug 2018 17:08:36 +0000</updated>
                            <resolved>Tue, 14 Aug 2018 00:31:41 +0000</resolved>
                                    <version>0.11.0.3</version>
                    <version>1.0.2</version>
                    <version>1.1.1</version>
                    <version>2.0.0</version>
                                    <fixVersion>0.11.0.4</fixVersion>
                    <fixVersion>1.0.3</fixVersion>
                    <fixVersion>1.1.2</fixVersion>
                    <fixVersion>2.0.1</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                    <component>streams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16578869" author="githubbot" created="Mon, 13 Aug 2018 20:30:21 +0000"  >&lt;p&gt;vvcephei opened a new pull request #5499: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7284&quot; title=&quot;Producer getting fenced may cause Streams to shut down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7284&quot;&gt;&lt;del&gt;KAFKA-7284&lt;/del&gt;&lt;/a&gt;: streams should unwrap fenced exception&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5499&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5499&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Unwrap the `ProducerFencedException` in `RecordCollectorImpl`&lt;br/&gt;
   so it can be caught and converted to a `TaskMigratedException` &lt;br/&gt;
   instead of triggering a shutdown.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16579057" author="githubbot" created="Tue, 14 Aug 2018 00:13:16 +0000"  >&lt;p&gt;mjsax closed pull request #5499: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7284&quot; title=&quot;Producer getting fenced may cause Streams to shut down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7284&quot;&gt;&lt;del&gt;KAFKA-7284&lt;/del&gt;&lt;/a&gt;: streams should unwrap fenced exception&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5499&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5499&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/clients/src/main/java/org/apache/kafka/clients/producer/MockProducer.java b/clients/src/main/java/org/apache/kafka/clients/producer/MockProducer.java&lt;br/&gt;
index dc00b473027..60fd1865a23 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/clients/producer/MockProducer.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/producer/MockProducer.java&lt;br/&gt;
@@ -21,6 +21,7 @@&lt;br/&gt;
 import org.apache.kafka.clients.producer.internals.FutureRecordMetadata;&lt;br/&gt;
 import org.apache.kafka.clients.producer.internals.ProduceRequestResult;&lt;br/&gt;
 import org.apache.kafka.common.Cluster;&lt;br/&gt;
+import org.apache.kafka.common.KafkaException;&lt;br/&gt;
 import org.apache.kafka.common.Metric;&lt;br/&gt;
 import org.apache.kafka.common.MetricName;&lt;br/&gt;
 import org.apache.kafka.common.PartitionInfo;&lt;br/&gt;
@@ -206,7 +207,7 @@ public void abortTransaction() throws ProducerFencedException &lt;/p&gt;
{
         this.transactionInFlight = false;
     }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private void verifyProducerState() {&lt;br/&gt;
+    private synchronized void verifyProducerState() {&lt;br/&gt;
         if (this.closed) 
{
             throw new IllegalStateException(&quot;MockProducer is already closed.&quot;);
         }
&lt;p&gt;@@ -244,7 +245,12 @@ private void verifyNoTransactionInFlight() {&lt;br/&gt;
      */&lt;br/&gt;
     @Override&lt;br/&gt;
     public synchronized Future&amp;lt;RecordMetadata&amp;gt; send(ProducerRecord&amp;lt;K, V&amp;gt; record, Callback callback) {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;verifyProducerState();&lt;br/&gt;
+        if (this.closed) 
{
+            throw new IllegalStateException(&quot;MockProducer is already closed.&quot;);
+        }
&lt;p&gt;+        if (this.producerFenced) &lt;/p&gt;
{
+            throw new KafkaException(&quot;MockProducer is fenced.&quot;, new ProducerFencedException(&quot;Fenced&quot;));
+        }
&lt;p&gt;         int partition = 0;&lt;br/&gt;
         if (!this.cluster.partitionsForTopic(record.topic()).isEmpty())&lt;br/&gt;
             partition = partition(record, this.cluster);&lt;br/&gt;
@@ -318,7 +324,7 @@ public boolean closed() &lt;/p&gt;
{
         return this.closed;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void fenceProducer() {&lt;br/&gt;
+    public synchronized void fenceProducer() {&lt;br/&gt;
         verifyProducerState();&lt;br/&gt;
         verifyTransactionsInitialized();&lt;br/&gt;
         this.producerFenced = true;&lt;br/&gt;
diff --git a/clients/src/test/java/org/apache/kafka/clients/producer/MockProducerTest.java b/clients/src/test/java/org/apache/kafka/clients/producer/MockProducerTest.java&lt;br/&gt;
index 7a8c710b76b..eef9d6d2c66 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/test/java/org/apache/kafka/clients/producer/MockProducerTest.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/clients/producer/MockProducerTest.java&lt;br/&gt;
@@ -19,6 +19,7 @@&lt;br/&gt;
 import org.apache.kafka.clients.consumer.OffsetAndMetadata;&lt;br/&gt;
 import org.apache.kafka.clients.producer.internals.DefaultPartitioner;&lt;br/&gt;
 import org.apache.kafka.common.Cluster;&lt;br/&gt;
+import org.apache.kafka.common.KafkaException;&lt;br/&gt;
 import org.apache.kafka.common.Node;&lt;br/&gt;
 import org.apache.kafka.common.PartitionInfo;&lt;br/&gt;
 import org.apache.kafka.common.TopicPartition;&lt;br/&gt;
@@ -267,18 +268,9 @@ public void shouldThrowOnSendIfProducerGotFenced() {&lt;br/&gt;
         try 
{
             producer.send(null);
             fail(&quot;Should have thrown as producer is fenced off&quot;);
-        }
&lt;p&gt; catch (ProducerFencedException e) { }&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;@Test&lt;/li&gt;
	&lt;li&gt;public void shouldThrowOnFlushIfProducerGotFenced() {&lt;/li&gt;
	&lt;li&gt;buildMockProducer(true);&lt;/li&gt;
	&lt;li&gt;producer.initTransactions();&lt;/li&gt;
	&lt;li&gt;producer.fenceProducer();&lt;/li&gt;
	&lt;li&gt;try 
{
-            producer.flush();
-            fail(&quot;Should have thrown as producer is fenced off&quot;);
-        }
&lt;p&gt; catch (ProducerFencedException e) { }&lt;br/&gt;
+        } catch (KafkaException e) &lt;/p&gt;
{
+            assertTrue(&quot;The root cause of the exception should be ProducerFenced&quot;, e.getCause() instanceof ProducerFencedException);
+        }
&lt;p&gt;     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     @Test&lt;br/&gt;
diff --git a/streams/src/main/java/org/apache/kafka/streams/processor/internals/RecordCollectorImpl.java b/streams/src/main/java/org/apache/kafka/streams/processor/internals/RecordCollectorImpl.java&lt;br/&gt;
index d753648eede..90302266fd5 100644&lt;br/&gt;
&amp;#8212; a/streams/src/main/java/org/apache/kafka/streams/processor/internals/RecordCollectorImpl.java&lt;br/&gt;
+++ b/streams/src/main/java/org/apache/kafka/streams/processor/internals/RecordCollectorImpl.java&lt;br/&gt;
@@ -207,18 +207,26 @@ public void onCompletion(final RecordMetadata metadata,&lt;br/&gt;
                 &quot;You can increase producer parameter `max.block.ms` to increase this timeout.&quot;, topic);&lt;br/&gt;
             throw new StreamsException(String.format(&quot;%sFailed to send record to topic %s due to timeout.&quot;, logPrefix, topic));&lt;br/&gt;
         } catch (final Exception uncaughtException) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;throw new StreamsException(&lt;/li&gt;
	&lt;li&gt;String.format(&lt;/li&gt;
	&lt;li&gt;EXCEPTION_MESSAGE,&lt;/li&gt;
	&lt;li&gt;logPrefix,&lt;/li&gt;
	&lt;li&gt;&quot;an error caught&quot;,&lt;/li&gt;
	&lt;li&gt;key,&lt;/li&gt;
	&lt;li&gt;value,&lt;/li&gt;
	&lt;li&gt;timestamp,&lt;/li&gt;
	&lt;li&gt;topic,&lt;/li&gt;
	&lt;li&gt;uncaughtException.toString()&lt;/li&gt;
	&lt;li&gt;),&lt;/li&gt;
	&lt;li&gt;uncaughtException);&lt;br/&gt;
+            if (uncaughtException instanceof KafkaException &amp;amp;&amp;amp;&lt;br/&gt;
+                uncaughtException.getCause() instanceof ProducerFencedException) 
{
+                final KafkaException kafkaException = (KafkaException) uncaughtException;
+                // producer.send() call may throw a KafkaException which wraps a FencedException,
+                // in this case we should throw its wrapped inner cause so that it can be captured and re-wrapped as TaskMigrationException
+                throw (ProducerFencedException) kafkaException.getCause();
+            }
&lt;p&gt; else &lt;/p&gt;
{
+                throw new StreamsException(
+                    String.format(
+                        EXCEPTION_MESSAGE,
+                        logPrefix,
+                        &quot;an error caught&quot;,
+                        key,
+                        value,
+                        timestamp,
+                        topic,
+                        uncaughtException.toString()
+                    ),
+                    uncaughtException);
+            }
&lt;p&gt;         }&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;






&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16581572" author="githubbot" created="Wed, 15 Aug 2018 20:29:27 +0000"  >&lt;p&gt;vvcephei opened a new pull request #5513: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7284&quot; title=&quot;Producer getting fenced may cause Streams to shut down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7284&quot;&gt;&lt;del&gt;KAFKA-7284&lt;/del&gt;&lt;/a&gt;: streams should unwrap fenced exception&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5513&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5513&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Unwrap the ProducerFencedException in RecordCollectorImpl&lt;br/&gt;
   so it can be caught and converted to a TaskMigratedException&lt;br/&gt;
   instead of triggering a shutdown.&lt;/p&gt;

&lt;p&gt;   See also #5499&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16581707" author="githubbot" created="Wed, 15 Aug 2018 22:49:01 +0000"  >&lt;p&gt;guozhangwang closed pull request #5513: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7284&quot; title=&quot;Producer getting fenced may cause Streams to shut down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7284&quot;&gt;&lt;del&gt;KAFKA-7284&lt;/del&gt;&lt;/a&gt;: streams should unwrap fenced exception&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5513&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5513&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/clients/src/main/java/org/apache/kafka/clients/producer/MockProducer.java b/clients/src/main/java/org/apache/kafka/clients/producer/MockProducer.java&lt;br/&gt;
index d2a84c66abe..a72714bb3df 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/clients/producer/MockProducer.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/producer/MockProducer.java&lt;br/&gt;
@@ -21,6 +21,7 @@&lt;br/&gt;
 import org.apache.kafka.clients.producer.internals.FutureRecordMetadata;&lt;br/&gt;
 import org.apache.kafka.clients.producer.internals.ProduceRequestResult;&lt;br/&gt;
 import org.apache.kafka.common.Cluster;&lt;br/&gt;
+import org.apache.kafka.common.KafkaException;&lt;br/&gt;
 import org.apache.kafka.common.Metric;&lt;br/&gt;
 import org.apache.kafka.common.MetricName;&lt;br/&gt;
 import org.apache.kafka.common.PartitionInfo;&lt;br/&gt;
@@ -205,7 +206,7 @@ public void abortTransaction() throws ProducerFencedException &lt;/p&gt;
{
         this.transactionInFlight = false;
     }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private void verifyProducerState() {&lt;br/&gt;
+    private synchronized void verifyProducerState() {&lt;br/&gt;
         if (this.closed) 
{
             throw new IllegalStateException(&quot;MockProducer is already closed.&quot;);
         }
&lt;p&gt;@@ -243,7 +244,12 @@ private void verifyNoTransactionInFlight() {&lt;br/&gt;
      */&lt;br/&gt;
     @Override&lt;br/&gt;
     public synchronized Future&amp;lt;RecordMetadata&amp;gt; send(ProducerRecord&amp;lt;K, V&amp;gt; record, Callback callback) {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;verifyProducerState();&lt;br/&gt;
+        if (this.closed) 
{
+            throw new IllegalStateException(&quot;MockProducer is already closed.&quot;);
+        }
&lt;p&gt;+        if (this.producerFenced) &lt;/p&gt;
{
+            throw new KafkaException(&quot;MockProducer is fenced.&quot;, new ProducerFencedException(&quot;Fenced&quot;));
+        }
&lt;p&gt;         int partition = 0;&lt;br/&gt;
         if (!this.cluster.partitionsForTopic(record.topic()).isEmpty())&lt;br/&gt;
             partition = partition(record, this.cluster);&lt;br/&gt;
@@ -313,7 +319,7 @@ public boolean closed() &lt;/p&gt;
{
         return this.closed;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void fenceProducer() {&lt;br/&gt;
+    public synchronized void fenceProducer() {&lt;br/&gt;
         verifyProducerState();&lt;br/&gt;
         verifyTransactionsInitialized();&lt;br/&gt;
         this.producerFenced = true;&lt;br/&gt;
diff --git a/clients/src/test/java/org/apache/kafka/clients/producer/MockProducerTest.java b/clients/src/test/java/org/apache/kafka/clients/producer/MockProducerTest.java&lt;br/&gt;
index 27fac280afc..ee4803f635b 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/test/java/org/apache/kafka/clients/producer/MockProducerTest.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/clients/producer/MockProducerTest.java&lt;br/&gt;
@@ -19,6 +19,7 @@&lt;br/&gt;
 import org.apache.kafka.clients.consumer.OffsetAndMetadata;&lt;br/&gt;
 import org.apache.kafka.clients.producer.internals.DefaultPartitioner;&lt;br/&gt;
 import org.apache.kafka.common.Cluster;&lt;br/&gt;
+import org.apache.kafka.common.KafkaException;&lt;br/&gt;
 import org.apache.kafka.common.Node;&lt;br/&gt;
 import org.apache.kafka.common.PartitionInfo;&lt;br/&gt;
 import org.apache.kafka.common.TopicPartition;&lt;br/&gt;
@@ -267,18 +268,9 @@ public void shouldThrowOnSendIfProducerGotFenced() {&lt;br/&gt;
         try 
{
             producer.send(null);
             fail(&quot;Should have thrown as producer is fenced off&quot;);
-        }
&lt;p&gt; catch (ProducerFencedException e) { }&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;@Test&lt;/li&gt;
	&lt;li&gt;public void shouldThrowOnFlushIfProducerGotFenced() {&lt;/li&gt;
	&lt;li&gt;buildMockProducer(true);&lt;/li&gt;
	&lt;li&gt;producer.initTransactions();&lt;/li&gt;
	&lt;li&gt;producer.fenceProducer();&lt;/li&gt;
	&lt;li&gt;try 
{
-            producer.flush();
-            fail(&quot;Should have thrown as producer is fenced off&quot;);
-        }
&lt;p&gt; catch (ProducerFencedException e) { }&lt;br/&gt;
+        } catch (KafkaException e) &lt;/p&gt;
{
+            assertTrue(&quot;The root cause of the exception should be ProducerFenced&quot;, e.getCause() instanceof ProducerFencedException);
+        }
&lt;p&gt;     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     @Test&lt;br/&gt;
diff --git a/streams/src/main/java/org/apache/kafka/streams/processor/internals/RecordCollectorImpl.java b/streams/src/main/java/org/apache/kafka/streams/processor/internals/RecordCollectorImpl.java&lt;br/&gt;
index afdadf2dec3..44b2089f6ab 100644&lt;br/&gt;
&amp;#8212; a/streams/src/main/java/org/apache/kafka/streams/processor/internals/RecordCollectorImpl.java&lt;br/&gt;
+++ b/streams/src/main/java/org/apache/kafka/streams/processor/internals/RecordCollectorImpl.java&lt;br/&gt;
@@ -23,14 +23,14 @@&lt;br/&gt;
 import org.apache.kafka.common.KafkaException;&lt;br/&gt;
 import org.apache.kafka.common.PartitionInfo;&lt;br/&gt;
 import org.apache.kafka.common.TopicPartition;&lt;br/&gt;
-import org.apache.kafka.common.errors.AuthorizationException;&lt;br/&gt;
 import org.apache.kafka.common.errors.AuthenticationException;&lt;br/&gt;
+import org.apache.kafka.common.errors.AuthorizationException;&lt;br/&gt;
 import org.apache.kafka.common.errors.InvalidTopicException;&lt;br/&gt;
 import org.apache.kafka.common.errors.OffsetMetadataTooLarge;&lt;br/&gt;
 import org.apache.kafka.common.errors.ProducerFencedException;&lt;br/&gt;
 import org.apache.kafka.common.errors.RetriableException;&lt;br/&gt;
-import org.apache.kafka.common.errors.SerializationException;&lt;br/&gt;
 import org.apache.kafka.common.errors.SecurityDisabledException;&lt;br/&gt;
+import org.apache.kafka.common.errors.SerializationException;&lt;br/&gt;
 import org.apache.kafka.common.errors.TimeoutException;&lt;br/&gt;
 import org.apache.kafka.common.errors.UnknownServerException;&lt;br/&gt;
 import org.apache.kafka.common.serialization.Serializer;&lt;br/&gt;
@@ -193,16 +193,26 @@ public void onCompletion(final RecordMetadata metadata,&lt;br/&gt;
                 &quot;You can increase producer parameter `max.block.ms` to increase this timeout.&quot;, topic);&lt;br/&gt;
             throw new StreamsException(String.format(&quot;%sFailed to send record to topic %s due to timeout.&quot;, logPrefix, topic));&lt;br/&gt;
         } catch (final Exception uncaughtException) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;throw new StreamsException(&lt;/li&gt;
	&lt;li&gt;String.format(EXCEPTION_MESSAGE,&lt;/li&gt;
	&lt;li&gt;logPrefix,&lt;/li&gt;
	&lt;li&gt;&quot;an error caught&quot;,&lt;/li&gt;
	&lt;li&gt;key,&lt;/li&gt;
	&lt;li&gt;value,&lt;/li&gt;
	&lt;li&gt;timestamp,&lt;/li&gt;
	&lt;li&gt;topic,&lt;/li&gt;
	&lt;li&gt;uncaughtException.getMessage()),&lt;/li&gt;
	&lt;li&gt;uncaughtException);&lt;br/&gt;
+            if (uncaughtException instanceof KafkaException &amp;amp;&amp;amp;&lt;br/&gt;
+                uncaughtException.getCause() instanceof ProducerFencedException) 
{
+                final KafkaException kafkaException = (KafkaException) uncaughtException;
+                // producer.send() call may throw a KafkaException which wraps a FencedException,
+                // in this case we should throw its wrapped inner cause so that it can be captured and re-wrapped as TaskMigrationException
+                throw (ProducerFencedException) kafkaException.getCause();
+            }
&lt;p&gt; else &lt;/p&gt;
{
+                throw new StreamsException(
+                    String.format(
+                        EXCEPTION_MESSAGE,
+                        logPrefix,
+                        &quot;an error caught&quot;,
+                        key,
+                        value,
+                        timestamp,
+                        topic,
+                        uncaughtException.getMessage()
+                    ),
+                    uncaughtException);
+            }
&lt;p&gt;         }&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java b/streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java&lt;br/&gt;
index 39fe7ab20c3..68c779b50db 100644&lt;br/&gt;
&amp;#8212; a/streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java&lt;br/&gt;
+++ b/streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java&lt;br/&gt;
@@ -26,6 +26,7 @@&lt;br/&gt;
 import org.apache.kafka.common.Node;&lt;br/&gt;
 import org.apache.kafka.common.PartitionInfo;&lt;br/&gt;
 import org.apache.kafka.common.TopicPartition;&lt;br/&gt;
+import org.apache.kafka.common.errors.ProducerFencedException;&lt;br/&gt;
 import org.apache.kafka.common.serialization.ByteArraySerializer;&lt;br/&gt;
 import org.apache.kafka.common.serialization.StringSerializer;&lt;br/&gt;
 import org.apache.kafka.common.utils.LogContext;&lt;br/&gt;
@@ -299,4 +300,27 @@ public void shouldThrowIfTopicIsUnknownWithContinueExceptionHandler() &lt;/p&gt;
{
             new AlwaysContinueProductionExceptionHandler());
         collector.send(&quot;topic1&quot;, &quot;3&quot;, &quot;0&quot;, null, stringSerializer, stringSerializer, streamPartitioner);
     }
&lt;p&gt;+&lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void shouldUnwrapAndThrowProducerFencedExceptionFromCallToSend() {&lt;br/&gt;
+        final MockProducer&amp;lt;byte[], byte[]&amp;gt; producer =&lt;br/&gt;
+            new MockProducer&amp;lt;&amp;gt;(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer);&lt;br/&gt;
+&lt;br/&gt;
+        final RecordCollector collector = new RecordCollectorImpl(&lt;br/&gt;
+            producer,&lt;br/&gt;
+            &quot;test&quot;,&lt;br/&gt;
+            logContext,&lt;br/&gt;
+            new DefaultProductionExceptionHandler()&lt;br/&gt;
+        );&lt;br/&gt;
+&lt;br/&gt;
+        producer.initTransactions();&lt;br/&gt;
+        producer.fenceProducer();&lt;br/&gt;
+&lt;br/&gt;
+        try &lt;/p&gt;
{
+            collector.send(&quot;topic1&quot;, &quot;3&quot;, &quot;0&quot;, null, stringSerializer, stringSerializer, streamPartitioner);
+            fail(&quot;expected a ProducerFencedException&quot;);
+        }
&lt;p&gt; catch (ProducerFencedException pfe) &lt;/p&gt;
{
+            // expected
+        }
&lt;p&gt;+    }&lt;br/&gt;
 }&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16583083" author="githubbot" created="Thu, 16 Aug 2018 21:35:02 +0000"  >&lt;p&gt;vvcephei opened a new pull request #5520: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7284&quot; title=&quot;Producer getting fenced may cause Streams to shut down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7284&quot;&gt;&lt;del&gt;KAFKA-7284&lt;/del&gt;&lt;/a&gt;: streams should unwrap fenced exception&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5520&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5520&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Unwrap the ProducerFencedException in RecordCollectorImpl&lt;br/&gt;
   so it can be caught and converted to a TaskMigratedException&lt;br/&gt;
   instead of triggering a shutdown.&lt;/p&gt;

&lt;p&gt;   See also #5499 and #5513 &lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16587752" author="githubbot" created="Tue, 21 Aug 2018 17:06:20 +0000"  >&lt;p&gt;mjsax closed pull request #5520: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7284&quot; title=&quot;Producer getting fenced may cause Streams to shut down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7284&quot;&gt;&lt;del&gt;KAFKA-7284&lt;/del&gt;&lt;/a&gt;: streams should unwrap fenced exception&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5520&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5520&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/clients/src/main/java/org/apache/kafka/clients/producer/MockProducer.java b/clients/src/main/java/org/apache/kafka/clients/producer/MockProducer.java&lt;br/&gt;
index d2a84c66abe..a72714bb3df 100644&lt;br/&gt;
&amp;#8212; a/clients/src/main/java/org/apache/kafka/clients/producer/MockProducer.java&lt;br/&gt;
+++ b/clients/src/main/java/org/apache/kafka/clients/producer/MockProducer.java&lt;br/&gt;
@@ -21,6 +21,7 @@&lt;br/&gt;
 import org.apache.kafka.clients.producer.internals.FutureRecordMetadata;&lt;br/&gt;
 import org.apache.kafka.clients.producer.internals.ProduceRequestResult;&lt;br/&gt;
 import org.apache.kafka.common.Cluster;&lt;br/&gt;
+import org.apache.kafka.common.KafkaException;&lt;br/&gt;
 import org.apache.kafka.common.Metric;&lt;br/&gt;
 import org.apache.kafka.common.MetricName;&lt;br/&gt;
 import org.apache.kafka.common.PartitionInfo;&lt;br/&gt;
@@ -205,7 +206,7 @@ public void abortTransaction() throws ProducerFencedException &lt;/p&gt;
{
         this.transactionInFlight = false;
     }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private void verifyProducerState() {&lt;br/&gt;
+    private synchronized void verifyProducerState() {&lt;br/&gt;
         if (this.closed) 
{
             throw new IllegalStateException(&quot;MockProducer is already closed.&quot;);
         }
&lt;p&gt;@@ -243,7 +244,12 @@ private void verifyNoTransactionInFlight() {&lt;br/&gt;
      */&lt;br/&gt;
     @Override&lt;br/&gt;
     public synchronized Future&amp;lt;RecordMetadata&amp;gt; send(ProducerRecord&amp;lt;K, V&amp;gt; record, Callback callback) {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;verifyProducerState();&lt;br/&gt;
+        if (this.closed) 
{
+            throw new IllegalStateException(&quot;MockProducer is already closed.&quot;);
+        }
&lt;p&gt;+        if (this.producerFenced) &lt;/p&gt;
{
+            throw new KafkaException(&quot;MockProducer is fenced.&quot;, new ProducerFencedException(&quot;Fenced&quot;));
+        }
&lt;p&gt;         int partition = 0;&lt;br/&gt;
         if (!this.cluster.partitionsForTopic(record.topic()).isEmpty())&lt;br/&gt;
             partition = partition(record, this.cluster);&lt;br/&gt;
@@ -313,7 +319,7 @@ public boolean closed() &lt;/p&gt;
{
         return this.closed;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void fenceProducer() {&lt;br/&gt;
+    public synchronized void fenceProducer() {&lt;br/&gt;
         verifyProducerState();&lt;br/&gt;
         verifyTransactionsInitialized();&lt;br/&gt;
         this.producerFenced = true;&lt;br/&gt;
diff --git a/clients/src/test/java/org/apache/kafka/clients/producer/MockProducerTest.java b/clients/src/test/java/org/apache/kafka/clients/producer/MockProducerTest.java&lt;br/&gt;
index 27fac280afc..9acde112a5f 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/clients/src/test/java/org/apache/kafka/clients/producer/MockProducerTest.java&lt;br/&gt;
+++ b/clients/src/test/java/org/apache/kafka/clients/producer/MockProducerTest.java&lt;br/&gt;
@@ -19,6 +19,7 @@&lt;br/&gt;
 import org.apache.kafka.clients.consumer.OffsetAndMetadata;&lt;br/&gt;
 import org.apache.kafka.clients.producer.internals.DefaultPartitioner;&lt;br/&gt;
 import org.apache.kafka.common.Cluster;&lt;br/&gt;
+import org.apache.kafka.common.KafkaException;&lt;br/&gt;
 import org.apache.kafka.common.Node;&lt;br/&gt;
 import org.apache.kafka.common.PartitionInfo;&lt;br/&gt;
 import org.apache.kafka.common.TopicPartition;&lt;br/&gt;
@@ -267,7 +268,9 @@ public void shouldThrowOnSendIfProducerGotFenced() {&lt;br/&gt;
         try 
{
             producer.send(null);
             fail(&quot;Should have thrown as producer is fenced off&quot;);
-        }
&lt;p&gt; catch (ProducerFencedException e) { }&lt;br/&gt;
+        } catch (KafkaException e) &lt;/p&gt;
{
+            assertTrue(&quot;The root cause of the exception should be ProducerFenced&quot;, e.getCause() instanceof ProducerFencedException);
+        }
&lt;p&gt;     }&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     @Test&lt;br/&gt;
diff --git a/streams/src/main/java/org/apache/kafka/streams/processor/internals/RecordCollectorImpl.java b/streams/src/main/java/org/apache/kafka/streams/processor/internals/RecordCollectorImpl.java&lt;br/&gt;
index a3aea1c9ef0..a775044ac0a 100644&lt;br/&gt;
&amp;#8212; a/streams/src/main/java/org/apache/kafka/streams/processor/internals/RecordCollectorImpl.java&lt;br/&gt;
+++ b/streams/src/main/java/org/apache/kafka/streams/processor/internals/RecordCollectorImpl.java&lt;br/&gt;
@@ -129,6 +129,16 @@ public void onCompletion(final RecordMetadata metadata, final Exception exceptio&lt;br/&gt;
                 }&lt;br/&gt;
                 log.warn(&quot;Timeout exception caught when sending record to topic {}; retrying with {} attempt&quot;, topic, attempt);&lt;br/&gt;
                 Utils.sleep(SEND_RETRY_BACKOFF);&lt;br/&gt;
+            } catch (final Exception uncaughtException) {&lt;br/&gt;
+                if (uncaughtException instanceof KafkaException &amp;amp;&amp;amp;&lt;br/&gt;
+                    uncaughtException.getCause() instanceof ProducerFencedException) &lt;/p&gt;
{
+                    final KafkaException kafkaException = (KafkaException) uncaughtException;
+                    // producer.send() call may throw a KafkaException which wraps a FencedException,
+                    // in this case we should throw its wrapped inner cause so that it can be captured and re-wrapped as TaskMigrationException
+                    throw (ProducerFencedException) kafkaException.getCause();
+                }
&lt;p&gt; else &lt;/p&gt;
{
+                    throw uncaughtException;
+                }
&lt;p&gt;             }&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;br/&gt;
diff --git a/streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java b/streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java&lt;br/&gt;
index 7b2a41e323e..2ec0db14035 100644&lt;br/&gt;
&amp;#8212; a/streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java&lt;br/&gt;
+++ b/streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java&lt;br/&gt;
@@ -25,6 +25,7 @@&lt;br/&gt;
 import org.apache.kafka.common.Node;&lt;br/&gt;
 import org.apache.kafka.common.PartitionInfo;&lt;br/&gt;
 import org.apache.kafka.common.TopicPartition;&lt;br/&gt;
+import org.apache.kafka.common.errors.ProducerFencedException;&lt;br/&gt;
 import org.apache.kafka.common.errors.TimeoutException;&lt;br/&gt;
 import org.apache.kafka.common.serialization.ByteArraySerializer;&lt;br/&gt;
 import org.apache.kafka.common.serialization.StringSerializer;&lt;br/&gt;
@@ -41,6 +42,7 @@&lt;br/&gt;
 import java.util.concurrent.atomic.AtomicInteger;&lt;/p&gt;

&lt;p&gt; import static org.junit.Assert.assertEquals;&lt;br/&gt;
+import static org.junit.Assert.fail;&lt;/p&gt;

&lt;p&gt; public class RecordCollectorTest {&lt;/p&gt;

&lt;p&gt;@@ -146,6 +148,23 @@ public void shouldRetryWhenTimeoutExceptionOccursOnSend() &lt;/p&gt;
{
         assertEquals(Long.valueOf(0L), offset);
     }

&lt;p&gt;+    @Test&lt;br/&gt;
+    public void shouldUnwrapAndThrowProducerFencedExceptionFromCallToSend() {&lt;br/&gt;
+        final MockProducer&amp;lt;byte[], byte[]&amp;gt; producer =&lt;br/&gt;
+            new MockProducer&amp;lt;&amp;gt;(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer);&lt;br/&gt;
+        final RecordCollector collector = new RecordCollectorImpl(producer, &quot;test&quot;, logContext);&lt;br/&gt;
+&lt;br/&gt;
+        producer.initTransactions();&lt;br/&gt;
+        producer.fenceProducer();&lt;br/&gt;
+&lt;br/&gt;
+        try &lt;/p&gt;
{
+            collector.send(&quot;topic1&quot;, &quot;3&quot;, &quot;0&quot;, null, stringSerializer, stringSerializer, streamPartitioner);
+            fail(&quot;expected a ProducerFencedException&quot;);
+        }
&lt;p&gt; catch (ProducerFencedException pfe) &lt;/p&gt;
{
+            // expected
+        }
&lt;p&gt;+    }&lt;br/&gt;
+&lt;br/&gt;
     @SuppressWarnings(&quot;unchecked&quot;)&lt;br/&gt;
     @Test(expected = StreamsException.class)&lt;br/&gt;
     public void shouldThrowStreamsExceptionAfterMaxAttempts() {&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 13 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3x03r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>