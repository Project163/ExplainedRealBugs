<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:31:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-13891] sync group failed with rebalanceInProgress error cause rebalance many rounds in coopeartive</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-13891</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;This issue was first found in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-13419&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;KAFKA-13419&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But the previous PR forgot to reset generation when sync group failed with rebalanceInProgress error. So the previous bug still exists and it may cause consumer to rebalance many rounds before final stable.&lt;/p&gt;

&lt;p&gt;Here&apos;s the example (&lt;b&gt;bold is added&lt;/b&gt;):&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;consumer A joined and synced group successfully with generation 1 &lt;b&gt;( with ownedPartition P1/P2 )&lt;/b&gt;&lt;/li&gt;
	&lt;li&gt;New rebalance started with generation 2, consumer A joined successfully, but somehow, consumer A doesn&apos;t send out sync group immediately&lt;/li&gt;
	&lt;li&gt;other consumer completed sync group successfully in generation 2, except consumer A.&lt;/li&gt;
	&lt;li&gt;After consumer A send out sync group, the new rebalance start, with generation 3. So consumer A got REBALANCE_IN_PROGRESS error with sync group response&lt;/li&gt;
	&lt;li&gt;When receiving REBALANCE_IN_PROGRESS, we re-join the group, with generation 3, with the assignment (ownedPartition) in generation 1.&lt;/li&gt;
	&lt;li&gt;So, now, we have out-of-date ownedPartition sent, with unexpected results happened&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;After the generation-3 rebalance, consumer A got P3/P4 partition. the ownedPartition is ignored because of old generation.&lt;/b&gt;&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;consumer A revoke P1/P2 and re-join to start a new round of rebalance&lt;/b&gt;&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;if some other consumer C failed to syncGroup before consumer A&apos;s joinGroup. the same issue will happens again and result in many rounds of rebalance before stable&lt;/b&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13444164">KAFKA-13891</key>
            <summary>sync group failed with rebalanceInProgress error cause rebalance many rounds in coopeartive</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pnee">Philip Nee</assignee>
                                    <reporter username="aiquestion">Shawn Wang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 May 2022 12:13:06 +0000</created>
                <updated>Fri, 5 May 2023 00:12:02 +0000</updated>
                            <resolved>Wed, 3 May 2023 16:58:05 +0000</resolved>
                                    <version>3.0.0</version>
                                    <fixVersion>3.4.1</fixVersion>
                    <fixVersion>3.5.0</fixVersion>
                                    <component>clients</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="17629931" author="JIRAUSER298133" created="Mon, 7 Nov 2022 17:31:49 +0000"  >&lt;p&gt;This ticket was reverted, see PR here: &lt;a href=&quot;https://github.com/apache/kafka/pull/12794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/12794&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can find the discussion about this revert here: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-14016&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-14016&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17630331" author="cadonna" created="Tue, 8 Nov 2022 10:30:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdrean&quot; class=&quot;user-hover&quot; rel=&quot;jdrean&quot;&gt;jdrean&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ableegoldman&quot; class=&quot;user-hover&quot; rel=&quot;ableegoldman&quot;&gt;ableegoldman&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dajac&quot; class=&quot;user-hover&quot; rel=&quot;dajac&quot;&gt;dajac&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=showuon&quot; class=&quot;user-hover&quot; rel=&quot;showuon&quot;&gt;showuon&lt;/a&gt; Should we reopen this ticket then?&lt;/p&gt;</comment>
                            <comment id="17630675" author="ableegoldman" created="Wed, 9 Nov 2022 00:47:44 +0000"  >&lt;p&gt;Reopening &#8211; original fix was reverted, we should instead fix this assignor-side by making it smarter about partition ownership across generations. Basically, it should take as the previous owner whichever consumer has the highest generation and claims it among their owned partitions&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=showuon&quot; class=&quot;user-hover&quot; rel=&quot;showuon&quot;&gt;showuon&lt;/a&gt; I probably won&apos;t be able to get to this within the next few days so if you&apos;re interested in picking up this fix go ahead and I&apos;ll find time to review &#8211; otherwise I will try to get to it in time for the 3.4 release&lt;/p&gt;</comment>
                            <comment id="17631387" author="showuon" created="Thu, 10 Nov 2022 02:09:23 +0000"  >&lt;p&gt;I&apos;m also very busy these days. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aiquestion&quot; class=&quot;user-hover&quot; rel=&quot;aiquestion&quot;&gt;aiquestion&lt;/a&gt; , if you have time, welcome to take over to improve it.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17647809" author="ableegoldman" created="Thu, 15 Dec 2022 02:40:27 +0000"  >&lt;p&gt;Bumping this to 3.5.0 since we&apos;re past 3.4.0 code freeze, but I&apos;ll try to find either time to work on it myself, or someone else who can pick it up so that it doesn&apos;t get lost&lt;/p&gt;</comment>
                            <comment id="17698586" author="kirktrue" created="Thu, 9 Mar 2023 19:55:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnee&quot; class=&quot;user-hover&quot; rel=&quot;pnee&quot;&gt;pnee&lt;/a&gt; please let me know if you need help on this. Happy to help where I can.&lt;/p&gt;</comment>
                            <comment id="17717745" author="JIRAUSER283568" created="Fri, 28 Apr 2023 16:35:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dajac&quot; class=&quot;user-hover&quot; rel=&quot;dajac&quot;&gt;dajac&lt;/a&gt; - I think we resolve this and the subsequent issues (&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-14016&quot; title=&quot;Revoke more partitions than expected in Cooperative rebalance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-14016&quot;&gt;&lt;del&gt;KAFKA-14016&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="17718826" author="mimaison" created="Wed, 3 May 2023 08:02:38 +0000"  >&lt;p&gt;We are past code freeze for 3.5 so moving this to the next release.&lt;/p&gt;</comment>
                            <comment id="17718993" author="JIRAUSER283568" created="Wed, 3 May 2023 16:55:28 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mimaison&quot; class=&quot;user-hover&quot; rel=&quot;mimaison&quot;&gt;mimaison&lt;/a&gt;&#160; - this is actually the same issue as &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-14639&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-14639&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I think the story is a bit complicated, but all these issues should be fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-14639&quot; title=&quot;Kafka CooperativeStickyAssignor revokes/assigns partition in one rebalance cycle&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-14639&quot;&gt;&lt;del&gt;KAFKA-14639&lt;/del&gt;&lt;/a&gt;. So I think we can resolve them...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-13891&quot; title=&quot;sync group failed with rebalanceInProgress error cause rebalance many rounds in coopeartive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-13891&quot;&gt;&lt;del&gt;KAFKA-13891&lt;/del&gt;&lt;/a&gt; (this)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-14016&quot; title=&quot;Revoke more partitions than expected in Cooperative rebalance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-14016&quot;&gt;&lt;del&gt;KAFKA-14016&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-14639&quot; title=&quot;Kafka CooperativeStickyAssignor revokes/assigns partition in one rebalance cycle&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-14639&quot;&gt;&lt;del&gt;KAFKA-14639&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17719572" author="ableegoldman" created="Fri, 5 May 2023 00:12:02 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnee&quot; class=&quot;user-hover&quot; rel=&quot;pnee&quot;&gt;pnee&lt;/a&gt; &#8211; just to round out the above, the actual fix was in &lt;a href=&quot;https://github.com/apache/kafka/pull/13550&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;pull/13550&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 27 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z12888:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>