<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:35:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-501] getOfffset Api needs to return different latest offset to regular and follower consumers</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-501</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;For follower consumers, getOffset should return logEndOffset as the latest offset. For regular consumers, getOffset should return highWatermark as the latest offset. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12606803">KAFKA-501</key>
            <summary>getOfffset Api needs to return different latest offset to regular and follower consumers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jjkoshy">Joel Jacob Koshy</assignee>
                                    <reporter username="junrao">Jun Rao</reporter>
                        <labels>
                            <label>bugs</label>
                    </labels>
                <created>Mon, 10 Sep 2012 00:09:17 +0000</created>
                <updated>Mon, 1 Oct 2012 04:08:56 +0000</updated>
                            <resolved>Thu, 27 Sep 2012 19:21:08 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="172800">48h</timeoriginalestimate>
                            <timeestimate seconds="172800">48h</timeestimate>
                                        <comments>
                            <comment id="13463463" author="jjkoshy" created="Wed, 26 Sep 2012 01:57:48 +0000"  >&lt;p&gt;Overview of changes:&lt;br/&gt;
1 - For non-followers, collapse any offsets &amp;gt; hw into a single entry == hw.&lt;br/&gt;
2 - I think the returned offsets are reverse sorted, but I did that again&lt;br/&gt;
  anyway, for the above collapsing to work correctly. I could just as well&lt;br/&gt;
  use Seq.span.&lt;br/&gt;
3 - Made the offsetrequest batched, using a map. So this is very similar to&lt;br/&gt;
  what was done for &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-391&quot; title=&quot;Producer request and response classes should use maps&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-391&quot;&gt;&lt;del&gt;KAFKA-391&lt;/del&gt;&lt;/a&gt;. So I also needed to provide javaapi versions&lt;br/&gt;
  of the OffsetRequest and OffsetResponse.&lt;br/&gt;
4 - One side-effect of batching was I was forced to clean up the layering&lt;br/&gt;
  issue. i.e., I prevent log from taking offsetrequest.&lt;br/&gt;
5 - Switched from Array to Seq in the scala version (and got rid of the&lt;br/&gt;
  equals).&lt;br/&gt;
6 - For consistency, made simple-consumer&apos;s getOffsetsBefore take a request&lt;br/&gt;
  and return a response.&lt;/p&gt;

&lt;p&gt;Other points:&lt;br/&gt;
7 - I&apos;m not very sure we should be providing the OffsetRequest directly to&lt;br/&gt;
  clients - i.e., maybe we should only have a request builder (like we have&lt;br/&gt;
  for FetchRequest). This would make it easier to use from the Java side and&lt;br/&gt;
  also we can hide the replicaId option - maybe it shouldn&apos;t be exposed to&lt;br/&gt;
  clients (especially on the Java-side)&lt;br/&gt;
8 - Code in getOffsetsBefore can be cleaned up quite a bit I think, but I left&lt;br/&gt;
  it as is for now.&lt;br/&gt;
9 - I was thinking of nesting PartitionOffsetRequestInfo inside the&lt;br/&gt;
  OffsetRequest object - that would make the code clearer, but only if users&lt;br/&gt;
  always fully qualify the reference.&lt;br/&gt;
10 - Previously getOffsetsBefore could through an exception on Error. Now, the&lt;br/&gt;
  client will need to explicitly check the errorCode. We may need to go&lt;br/&gt;
  through all usages and assess whether we want to throw an exception or&lt;br/&gt;
  not.&lt;/p&gt;</comment>
                            <comment id="13464453" author="junrao" created="Thu, 27 Sep 2012 05:19:05 +0000"  >&lt;p&gt;Thanks for patch v1. Looks good overall. Some minor comments:&lt;/p&gt;

&lt;p&gt;1. javaapi.OffsetRequest: No need to expose replicaId in the constructor since all java clients are non-follower.&lt;/p&gt;

&lt;p&gt;2. Log.getOffsetBefore, KafkaApis: So far, offsets are returned in ascending order.&lt;/p&gt;

&lt;p&gt;3. removed unused imports: LogManager, LogOffsetTest&lt;/p&gt;

&lt;p&gt;4. UpdateOffsetsInZK: Not directly related to this jira, but this class should probably be moved to tools package.&lt;/p&gt;

&lt;p&gt;5. ZookeeperConsumerConnector: Do we need to import scala.Some?&lt;/p&gt;

&lt;p&gt;Also, could you rebase?&lt;/p&gt;</comment>
                            <comment id="13464790" author="junrao" created="Thu, 27 Sep 2012 14:48:01 +0000"  >&lt;p&gt;Actually, for #2, you are right, offsets are returned in descending order. So this is fine.&lt;/p&gt;

&lt;p&gt;If the rest of the comments are addressed, the patch can be checked in without another round of review.&lt;/p&gt;</comment>
                            <comment id="13465004" author="jjkoshy" created="Thu, 27 Sep 2012 19:21:00 +0000"  >&lt;p&gt;Thanks for the review. Addressed the above comments and committed to 0.8.&lt;/p&gt;</comment>
                            <comment id="13466630" author="junrao" created="Mon, 1 Oct 2012 04:08:56 +0000"  >&lt;p&gt;Just realized that we need to patch KafkaETLContext to use getMetaData api to figure out the leader so that it can make the getOffsetBefore call.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12546633" name="KAFKA-501-v1.patch" size="56816" author="jjkoshy" created="Wed, 26 Sep 2012 01:57:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>291941</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 8 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rhqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>158518</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>