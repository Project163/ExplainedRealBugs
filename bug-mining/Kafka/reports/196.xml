<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:37:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-696] Fix toString() API for all requests to make logging easier to read</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-696</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;It will be useful to have consistent logging styles for all requests. Right now, we depend on the default toString implementation and the problem is that it is very hard to read and prints out unnecessary information like the ByteBuffer.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12627266">KAFKA-696</key>
            <summary>Fix toString() API for all requests to make logging easier to read</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sriramsub">Sriram</assignee>
                                    <reporter username="nehanarkhede">Neha Narkhede</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Jan 2013 22:08:39 +0000</created>
                <updated>Thu, 24 Jan 2013 19:52:28 +0000</updated>
                            <resolved>Thu, 24 Jan 2013 19:52:25 +0000</resolved>
                                    <version>0.8.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13554554" author="sriramsub" created="Wed, 16 Jan 2013 00:09:58 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Added ToString overrides to all the request object to make logging more readable and ignore things that we dont care&lt;/li&gt;
	&lt;li&gt;Errors are handled by each request and removed the case statements in kafkaapi.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13558439" author="junrao" created="Sun, 20 Jan 2013 23:46:09 +0000"  >&lt;p&gt;Thanks for the patch. Some comments:&lt;/p&gt;

&lt;p&gt;1. RequestOrResponse.handleError: We probably shouldn&apos;t couple the error response generation and the sending of the response through RequestChannel. It&apos;s probably better if we change handleError() to sth like generateErrorResponse() that only takes an error code and generates a response. The sending of the response will be done in KafkaApis. Similarly, I think the error logging should be done in KafkaApis.handle() too.&lt;/p&gt;

&lt;p&gt;2. ProducerRequest: When printing out data, in addition to the key, it would be useful to print out messageSet.sizeInBytes().&lt;/p&gt;

&lt;p&gt;3. KafkaApis: &lt;br/&gt;
3.1 Doesn&apos;t compile.&lt;br/&gt;
3.2 There are statements like the following in the handling of each type of request. Could we move them to handle() and remove the special printing for versionId, correlationId, and clientId?&lt;br/&gt;
    if(requestLogger.isTraceEnabled)&lt;br/&gt;
      requestLogger.trace(&quot;Handling LeaderAndIsrRequest v%d with correlation id %d from client %s: %s&quot;&lt;br/&gt;
            .format(leaderAndIsrRequest.versionId, leaderAndIsrRequest.correlationId, leaderAndIsrRequest.clientId, leaderAndIsrRequest.toString))&lt;/p&gt;

&lt;p&gt;4. RequestChannel.Request: Could you remove versionId, correlationId, clientId in the trace statement in updateRequestMetrics() and remove the corresponding deserialization logic?&lt;/p&gt;</comment>
                            <comment id="13559234" author="sriramsub" created="Tue, 22 Jan 2013 00:33:54 +0000"  >&lt;p&gt;1. The reason why I did not do that was because ReplicaRequest does not extend from RequestReponse. I kept what was there as is but moved the logging of the request outside to kafkaapi.&lt;br/&gt;
2. ProducerRequest logs the size for each message set.&lt;br/&gt;
3.1 It was an old patch and looks like there were conflicts.&lt;br/&gt;
3.2 Each request also prints the request name now. Hence moved these lines to the parent method.&lt;br/&gt;
4. Removed the deserializations and just log the request object.&lt;/p&gt;</comment>
                            <comment id="13561412" author="nehanarkhede" created="Thu, 24 Jan 2013 04:16:29 +0000"  >&lt;p&gt;Sorry for a late review. Following are a few review suggestions on patch v2 -&lt;br/&gt;
1. FetchRequest&lt;br/&gt;
1.1 Remove unused imports &quot;Response&quot; and &quot;BoundedByteBufferSend&quot;&lt;br/&gt;
1.2 In the toString() API, for MaxWait, lets append &quot;ms&quot; after the value. Also for MinBytes, lets append &quot;bytes&quot; after the value&lt;/p&gt;

&lt;p&gt;2. KafkaApis&lt;br/&gt;
2.1 In handle() APIs, let&apos;s move the .format(request.requestObj)) to the previous line&lt;/p&gt;

&lt;p&gt;3. LeaderAndIsrRequest&lt;br/&gt;
Let&apos;s include &quot;ms&quot; after the value for AckTimeoutMs&lt;/p&gt;

&lt;p&gt;4. ProducerRequest&lt;br/&gt;
Let&apos;s include &quot;ms&quot; after the value for AckTimeoutMs&lt;/p&gt;

&lt;p&gt;5. StopReplicaRequest&lt;br/&gt;
5.1 Let&apos;s include &quot;ms&quot; after the value for AckTimeoutMs&lt;br/&gt;
5.2 Looks like we haven&apos;t standardized StopReplicaRequest to use TopicAndPartition instead of a custom Tuple for representing partitions. This messes up the log4j logging style and the toString() API will not print partitions the way rest of the code does. You can either include it in your patch or leave it for &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-649&quot; title=&quot;Cleanup log4j logging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-649&quot;&gt;&lt;del&gt;KAFKA-649&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13561898" author="sriramsub" created="Thu, 24 Jan 2013 19:38:58 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Added units to the logging&lt;/li&gt;
	&lt;li&gt;Did not change StopReplicaRequest to using TopicAndPartition. Leaving it to 649.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13561912" author="nehanarkhede" created="Thu, 24 Jan 2013 19:52:25 +0000"  >&lt;p&gt;Committed v3&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12565044" name="cleanup-v1.patch" size="15730" author="sriramsub" created="Wed, 16 Jan 2013 00:09:58 +0000"/>
                            <attachment id="12565881" name="cleanup-v2.patch" size="25598" author="sriramsub" created="Tue, 22 Jan 2013 00:33:54 +0000"/>
                            <attachment id="12566355" name="cleanup-v3.patch" size="31174" author="sriramsub" created="Thu, 24 Jan 2013 19:38:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>304036</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 43 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i17hrj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>251847</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>