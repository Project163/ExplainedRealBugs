<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:01:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-4942] Kafka Connect: Offset committing times out before expected</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-4942</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;On Kafka 0.10.2.0&lt;br/&gt;
I run a connector that deals with a lot of data, in a kafka connect cluster&lt;/p&gt;

&lt;p&gt;When the offsets are getting committed, I get the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[2017-03-23 03:56:25,134] INFO WorkerSinkTask{id=MyConnector-1} Committing offsets (org.apache.kafka.connect.runtime.WorkerSinkTask)
[2017-03-23 03:56:25,135] WARN Commit of WorkerSinkTask{id=MyConnector-1} offsets timed out (org.apache.kafka.connect.runtime.WorkerSinkTask)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you look at the timestamps, they&apos;re 1 ms apart. My settings are the following: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	offset.flush.interval.ms = 120000
	offset.flush.timeout.ms = 60000
	offset.storage.topic = _connect_offsets
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It seems the offset flush timeout setting is completely ignored for the look of the logs. I would expect the timeout message to happen 60 seconds after the commit offset INFO message, not 1 millisecond later.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13058459">KAFKA-4942</key>
            <summary>Kafka Connect: Offset committing times out before expected</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stephane.maarek@gmail.com">Stephane Maarek</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Mar 2017 04:01:41 +0000</created>
                <updated>Tue, 25 Jul 2017 11:11:36 +0000</updated>
                            <resolved>Tue, 6 Jun 2017 21:23:14 +0000</resolved>
                                    <version>0.10.2.0</version>
                                    <fixVersion>0.11.0.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15938892" author="ewencp" created="Thu, 23 Mar 2017 17:48:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stephane.maarek%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;stephane.maarek@gmail.com&quot;&gt;stephane.maarek@gmail.com&lt;/a&gt; Any more context from earlier in the logs? Definitely looks fishy, and I don&apos;t see a way that could happen where the log message would just be misleading (it happens here &lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java#L171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java#L171&lt;/a&gt; after a condition, so it&apos;s not anything like an unrelated exception).&lt;/p&gt;</comment>
                            <comment id="15939453" author="stephane.maarek@gmail.com" created="Thu, 23 Mar 2017 23:48:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ewencp&quot; class=&quot;user-hover&quot; rel=&quot;ewencp&quot;&gt;ewencp&lt;/a&gt; nothing weird from the log, except that EVERY offset commit gives me that behaviour. You know what&apos;s even weirder? Offsets still are committed. It&apos;s because the line you linked me doesn&apos;t interrupt the offset commit, it just throws a warning.&lt;br/&gt;
Now the reason I would see that line being triggered right away is when &lt;br/&gt;
now &amp;gt;= commitTimeoutMs&lt;br/&gt;
now &amp;gt;= commitStarted + workerConfig.getLong(WorkerConfig.OFFSET_COMMIT_TIMEOUT_MS_CONFIG)&lt;/p&gt;

&lt;p&gt;I believe the setting workerConfig.getLong should return something 60000 ms, so it hints towards commitStarted being corrupted. &lt;/p&gt;

&lt;p&gt;And I think I just found your issue.....&lt;br/&gt;
commitTimeoutMs happens before the try block.&lt;br/&gt;
so no matter what happens in the commitOffsets(now, false); , it won&apos;t impact the comparison:&lt;br/&gt;
 if (committing &amp;amp;&amp;amp; now &amp;gt;= commitTimeoutMs) &lt;/p&gt;

&lt;p&gt;And that&apos;s the bug &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; One offset that times out on your thread and all the subsequent tries will show that warning &lt;/p&gt;</comment>
                            <comment id="15939464" author="githubbot" created="Fri, 24 Mar 2017 00:04:00 +0000"  >&lt;p&gt;GitHub user simplesteph opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2730&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2730&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4942&quot; title=&quot;Kafka Connect: Offset committing times out before expected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4942&quot;&gt;&lt;del&gt;KAFKA-4942&lt;/del&gt;&lt;/a&gt; fixed the commitTimeoutMs being set before the commit actually started&lt;/p&gt;

&lt;p&gt;    this fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4942&quot; title=&quot;Kafka Connect: Offset committing times out before expected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4942&quot;&gt;&lt;del&gt;KAFKA-4942&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/simplesteph/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/simplesteph/kafka&lt;/a&gt; fix-connect-offset-commit&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2730.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2730.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2730&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 4d1db91ec8276da3dcca6d85b66c70497cf0815d&lt;br/&gt;
Author: simplesteph &amp;lt;stephane.maarek@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-03-24T00:03:07Z&lt;/p&gt;

&lt;p&gt;    fixed the commitTimeoutMs being set before the commit actually started&lt;br/&gt;
    this fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4942&quot; title=&quot;Kafka Connect: Offset committing times out before expected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4942&quot;&gt;&lt;del&gt;KAFKA-4942&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15983038" author="githubbot" created="Tue, 25 Apr 2017 15:11:49 +0000"  >&lt;p&gt;GitHub user 56quarters opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2912&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2912&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4942&quot; title=&quot;Kafka Connect: Offset committing times out before expected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4942&quot;&gt;&lt;del&gt;KAFKA-4942&lt;/del&gt;&lt;/a&gt; Fix commitTimeoutMs being set before the commit actually started&lt;/p&gt;

&lt;p&gt;    This fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4942&quot; title=&quot;Kafka Connect: Offset committing times out before expected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4942&quot;&gt;&lt;del&gt;KAFKA-4942&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This supersededs #2730 &lt;/p&gt;

&lt;p&gt;    /cc @simplesteph @gwenshap @ewencp&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/smarter-travel-media/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/smarter-travel-media/kafka&lt;/a&gt; fix-connect-offset-commit&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2912.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2912.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2912&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit f93bd001a723c5e1402bf92474f43fb0b991a44c&lt;br/&gt;
Author: simplesteph &amp;lt;stephane.maarek@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-03-24T00:03:07Z&lt;/p&gt;

&lt;p&gt;    Fixed commitTimeoutMs being set before the commit actually started&lt;/p&gt;

&lt;p&gt;    Fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4942&quot; title=&quot;Kafka Connect: Offset committing times out before expected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4942&quot;&gt;&lt;del&gt;KAFKA-4942&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;commit e7b704d97b8de35384f6d24ba48f050a0b20be01&lt;br/&gt;
Author: Nick Pillitteri &amp;lt;nickp@smartertravelmedia.com&amp;gt;&lt;br/&gt;
Date:   2017-04-21T19:49:37Z&lt;/p&gt;

&lt;p&gt;    Test for commitTimeoutMs being set before commit started&lt;/p&gt;

&lt;p&gt;    See &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4942&quot; title=&quot;Kafka Connect: Offset committing times out before expected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4942&quot;&gt;&lt;del&gt;KAFKA-4942&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16039669" author="ewencp" created="Tue, 6 Jun 2017 21:23:14 +0000"  >&lt;p&gt;Issue resolved by pull request 2912&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/2912&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2912&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16039671" author="githubbot" created="Tue, 6 Jun 2017 21:24:05 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2912&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2912&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16039681" author="githubbot" created="Tue, 6 Jun 2017 21:29:26 +0000"  >&lt;p&gt;Github user simplesteph closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2730&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2730&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 23 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3cobz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>