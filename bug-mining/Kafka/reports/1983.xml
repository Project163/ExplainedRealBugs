<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:13:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-4994] Fix findbugs warning about OffsetStorageWriter#currentFlushId</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-4994</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;We should fix the findbugs warning about &lt;tt&gt;OffsetStorageWriter#currentFlushId&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Multithreaded correctness Warnings
IS2_INCONSISTENT_SYNC:   Inconsistent synchronization of org.apache.kafka.connect.storage.OffsetStorageWriter.currentFlushId; locked 83% of time
IS2_INCONSISTENT_SYNC:   Inconsistent synchronization of org.apache.kafka.connect.storage.OffsetStorageWriter.toFlush; locked 75% of time
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13060784">KAFKA-4994</key>
            <summary>Fix findbugs warning about OffsetStorageWriter#currentFlushId</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cmccabe">Colin McCabe</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Fri, 31 Mar 2017 20:11:18 +0000</created>
                <updated>Fri, 7 Jun 2024 09:20:10 +0000</updated>
                            <resolved>Thu, 19 Jul 2018 06:07:13 +0000</resolved>
                                                    <fixVersion>2.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15983540" author="githubbot" created="Tue, 25 Apr 2017 20:14:05 +0000"  >&lt;p&gt;Github user johnma14 closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2913&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2913&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15983594" author="githubbot" created="Tue, 25 Apr 2017 20:54:58 +0000"  >&lt;p&gt;GitHub user johnma14 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2914&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2914&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4994&quot; title=&quot;Fix findbugs warning about OffsetStorageWriter#currentFlushId&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4994&quot;&gt;&lt;del&gt;KAFKA-4994&lt;/del&gt;&lt;/a&gt;: Fix findbug warnings about OffsetStorageWriter&lt;/p&gt;

&lt;p&gt;    OffsetStorageWriter is not a thread-safe class and should be accessed&lt;br/&gt;
    only from a Task&apos;s processing thread. The WorkerSourceTask class calls&lt;br/&gt;
    the different methods (offset, beginFlush, cancelFlush, handleFinishWrite)&lt;br/&gt;
    within a synchronized block. Hence the method definitions in&lt;br/&gt;
    OffsetStorageWriter.java does not need to contain the keyword synchronized&lt;br/&gt;
    again.&lt;/p&gt;

&lt;p&gt;    In the OffsetStorageWriter.java class, the doFlush() method is not explicitely&lt;br/&gt;
    synchronized like the other methods in this class. Hence this can lead to&lt;br/&gt;
    inconsistent synchronization of variables like currentFlushId and toFlush which&lt;br/&gt;
    are set in the synchronized methods within this class.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/storage/OffsetStorageWriter.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/storage/OffsetStorageWriter.java&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java#L295&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java#L295&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/johnma14/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/johnma14/kafka&lt;/a&gt; bug/kafka-4994&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2914.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2914.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2914&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit d481c10818b59e67eaac0aa598e845773b07e51d&lt;br/&gt;
Author: Mariam John &amp;lt;mariamj@us.ibm.com&amp;gt;&lt;br/&gt;
Date:   2017-04-25T20:47:04Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4994&quot; title=&quot;Fix findbugs warning about OffsetStorageWriter#currentFlushId&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4994&quot;&gt;&lt;del&gt;KAFKA-4994&lt;/del&gt;&lt;/a&gt;: Fix findbug warnings about OffsetStorageWriter&lt;/p&gt;

&lt;p&gt;    OffsetStorageWriter is not a thread-safe class and should be accessed&lt;br/&gt;
    only from a Task&apos;s processing thread. The WorkerSourceTask class calls&lt;br/&gt;
    the different methods (offset, beginFlush, cancelFlush, handleFinishWrite)&lt;br/&gt;
    within a synchronized block. Hence the method definitions in&lt;br/&gt;
    OffsetStorageWriter.java does not need to contain the keyword synchronized&lt;br/&gt;
    again.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15983633" author="johnma" created="Tue, 25 Apr 2017 21:15:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cmccabe&quot; class=&quot;user-hover&quot; rel=&quot;cmccabe&quot;&gt;cmccabe&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ewencp&quot; class=&quot;user-hover&quot; rel=&quot;ewencp&quot;&gt;ewencp&lt;/a&gt; A fix for this issue is ready for review whenever you have some time. Thank you. &lt;/p&gt;</comment>
                            <comment id="15985434" author="githubbot" created="Wed, 26 Apr 2017 19:33:34 +0000"  >&lt;p&gt;Github user johnma14 closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2914&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2914&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15985435" author="githubbot" created="Wed, 26 Apr 2017 19:33:43 +0000"  >&lt;p&gt;GitHub user johnma14 reopened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2914&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2914&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4994&quot; title=&quot;Fix findbugs warning about OffsetStorageWriter#currentFlushId&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4994&quot;&gt;&lt;del&gt;KAFKA-4994&lt;/del&gt;&lt;/a&gt;: Fix findbug warnings about OffsetStorageWriter&lt;/p&gt;

&lt;p&gt;    OffsetStorageWriter is not a thread-safe class and should be accessed&lt;br/&gt;
    only from a Task&apos;s processing thread. The WorkerSourceTask class calls&lt;br/&gt;
    the different methods (offset, beginFlush, cancelFlush, handleFinishWrite)&lt;br/&gt;
    within a synchronized block. Hence the method definitions in&lt;br/&gt;
    OffsetStorageWriter.java does not need to contain the keyword synchronized&lt;br/&gt;
    again.&lt;/p&gt;

&lt;p&gt;    In the OffsetStorageWriter.java class, the doFlush() method is not explicitely&lt;br/&gt;
    synchronized like the other methods in this class. Hence this can lead to&lt;br/&gt;
    inconsistent synchronization of variables like currentFlushId and toFlush which&lt;br/&gt;
    are set in the synchronized methods within this class.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/storage/OffsetStorageWriter.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/storage/OffsetStorageWriter.java&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java#L295&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/blob/trunk/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java#L295&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/johnma14/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/johnma14/kafka&lt;/a&gt; bug/kafka-4994&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2914.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2914.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2914&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit d481c10818b59e67eaac0aa598e845773b07e51d&lt;br/&gt;
Author: Mariam John &amp;lt;mariamj@us.ibm.com&amp;gt;&lt;br/&gt;
Date:   2017-04-25T20:47:04Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4994&quot; title=&quot;Fix findbugs warning about OffsetStorageWriter#currentFlushId&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4994&quot;&gt;&lt;del&gt;KAFKA-4994&lt;/del&gt;&lt;/a&gt;: Fix findbug warnings about OffsetStorageWriter&lt;/p&gt;

&lt;p&gt;    OffsetStorageWriter is not a thread-safe class and should be accessed&lt;br/&gt;
    only from a Task&apos;s processing thread. The WorkerSourceTask class calls&lt;br/&gt;
    the different methods (offset, beginFlush, cancelFlush, handleFinishWrite)&lt;br/&gt;
    within a synchronized block. Hence the method definitions in&lt;br/&gt;
    OffsetStorageWriter.java does not need to contain the keyword synchronized&lt;br/&gt;
    again.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16548051" author="githubbot" created="Wed, 18 Jul 2018 16:38:41 +0000"  >&lt;p&gt;cmccabe opened a new pull request #5385: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4994&quot; title=&quot;Fix findbugs warning about OffsetStorageWriter#currentFlushId&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4994&quot;&gt;&lt;del&gt;KAFKA-4994&lt;/del&gt;&lt;/a&gt;: Remove findbugs suppression for OffsetStorageWriter&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5385&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5385&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Remove findbugs suppression for OffsetStorageWriter because it is no longer needed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16548827" author="githubbot" created="Thu, 19 Jul 2018 06:05:55 +0000"  >&lt;p&gt;hachikuji closed pull request #5385: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4994&quot; title=&quot;Fix findbugs warning about OffsetStorageWriter#currentFlushId&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4994&quot;&gt;&lt;del&gt;KAFKA-4994&lt;/del&gt;&lt;/a&gt;: Remove findbugs suppression for OffsetStorageWriter&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/5385&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/5385&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/gradle/findbugs-exclude.xml b/gradle/findbugs-exclude.xml&lt;br/&gt;
index 21c889116d7..09981852f95 100644&lt;br/&gt;
&amp;#8212; a/gradle/findbugs-exclude.xml&lt;br/&gt;
+++ b/gradle/findbugs-exclude.xml&lt;br/&gt;
@@ -170,13 +170,6 @@ For a detailed description of findbugs bug categories, see &lt;a href=&quot;http://findbugs.sourc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://findbugs.sourc&lt;/a&gt;&lt;br/&gt;
         &amp;lt;Bug pattern=&quot;SF_SWITCH_FALLTHROUGH&quot;/&amp;gt;&lt;br/&gt;
     &amp;lt;/Match&amp;gt;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;Match&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;!-- Suppress some inconsistent synchronization warnings.  TODO: fix these.  See&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4994&quot; title=&quot;Fix findbugs warning about OffsetStorageWriter#currentFlushId&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4994&quot;&gt;&lt;del&gt;KAFKA-4994&lt;/del&gt;&lt;/a&gt;. --&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;Class name=&quot;org.apache.kafka.connect.storage.OffsetStorageWriter&quot;/&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;Bug pattern=&quot;IS2_INCONSISTENT_SYNC&quot;/&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;/Match&amp;gt;&lt;br/&gt;
-&lt;br/&gt;
     &amp;lt;Match&amp;gt;&lt;br/&gt;
         &amp;lt;!-- Suppress a warning about intentional switch statement fallthrough. --&amp;gt;&lt;br/&gt;
         &amp;lt;Class name=&quot;org.apache.kafka.common.security.authenticator.SaslClientAuthenticator&quot;/&amp;gt;&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13043734">KAFKA-4773</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 17 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3d2o7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>cmccabe</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>