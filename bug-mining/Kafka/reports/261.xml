<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:37:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-826] Make Kafka 0.8 depend on metrics 2.2.0 instead of 3.x</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-826</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;In order to mavenize Kafka 0.8, we have to depend on metrics 2.2.0 since metrics 3.x is a huge change as well as not an officially supported release.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12638970">KAFKA-826</key>
            <summary>Make Kafka 0.8 depend on metrics 2.2.0 instead of 3.x</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dragosm">Dragos Manolescu</assignee>
                                    <reporter username="nehanarkhede">Neha Narkhede</reporter>
                        <labels>
                            <label>build</label>
                            <label>kafka-0.8</label>
                            <label>metrics</label>
                    </labels>
                <created>Mon, 25 Mar 2013 21:19:47 +0000</created>
                <updated>Tue, 2 Feb 2016 23:09:20 +0000</updated>
                            <resolved>Thu, 18 Apr 2013 04:20:42 +0000</resolved>
                                    <version>0.8.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                                                                <comments>
                            <comment id="13613192" author="scott_carey" created="Mon, 25 Mar 2013 21:47:27 +0000"  >&lt;p&gt;Thank you!  We will be able to test and validate this quickly once there is a patch.&lt;/p&gt;

&lt;p&gt;Metrics 3.0.x has hit its first snapshot recently:&lt;br/&gt;
&lt;a href=&quot;https://groups.google.com/forum/#!topic/metrics-user/c4sPUhLjHEQ&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://groups.google.com/forum/#!topic/metrics-user/c4sPUhLjHEQ&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;However, it looks like it won&apos;t be done in time for Kafka 0.8.  It now at least does not conflict  with a copy of 2.2.x as badly as it did a couple months ago.&lt;/p&gt;</comment>
                            <comment id="13613243" author="dragosm" created="Mon, 25 Mar 2013 22:36:32 +0000"  >&lt;p&gt;Good to see this pop on your radar screen... I looked at what it would take to move from 3.0.0-c0c8be71 to SNAPSHOT and there were quite a few changes. I&apos;ve just forked the project, if I make progress I&apos;ll send a pull request.&lt;/p&gt;</comment>
                            <comment id="13616499" author="nehanarkhede" created="Thu, 28 Mar 2013 18:14:12 +0000"  >&lt;p&gt;We need to remove the dependency on the custom metrics jar in order to mavenize kafka&lt;/p&gt;</comment>
                            <comment id="13616683" author="dragosm" created="Thu, 28 Mar 2013 21:39:20 +0000"  >&lt;p&gt;diff --git a/core/lib/metrics-annotation-3.0.0-c0c8be71.jar b/core/lib/metrics-annotation-3.0.0-c0c8be71.jar&lt;br/&gt;
deleted file mode 100644&lt;br/&gt;
index dba9d2b..0000000&lt;br/&gt;
Binary files a/core/lib/metrics-annotation-3.0.0-c0c8be71.jar and /dev/null differ&lt;br/&gt;
diff --git a/core/lib/metrics-core-3.0.0-c0c8be71.jar b/core/lib/metrics-core-3.0.0-c0c8be71.jar&lt;br/&gt;
deleted file mode 100644&lt;br/&gt;
index 529a69b..0000000&lt;br/&gt;
Binary files a/core/lib/metrics-core-3.0.0-c0c8be71.jar and /dev/null differ&lt;br/&gt;
diff --git a/core/src/main/scala/kafka/cluster/Partition.scala b/core/src/main/scala/kafka/cluster/Partition.scala&lt;br/&gt;
index 367ccd5..7788b30 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/cluster/Partition.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/cluster/Partition.scala&lt;br/&gt;
@@ -60,7 +60,7 @@ class Partition(val topic: String,&lt;br/&gt;
   newGauge(&lt;br/&gt;
     topic + &quot;-&quot; + partitionId + &quot;-UnderReplicated&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;def getValue = 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      def value = {
         if (isUnderReplicated) 1 else 0
       }     }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;diff --git a/core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala b/core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala&lt;br/&gt;
index 972d33d..51b9c35 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala&lt;br/&gt;
@@ -653,7 +653,7 @@ private&lt;span class=&quot;error&quot;&gt;&amp;#91;kafka&amp;#93;&lt;/span&gt; class ZookeeperConsumerConnector(val config: ConsumerConfig,&lt;br/&gt;
       newGauge(&lt;br/&gt;
         config.clientId + &quot;&lt;del&gt;&quot; + config.groupId + &quot;&lt;/del&gt;&quot; + topicThreadId._1 + &quot;-&quot; + topicThreadId._2 + &quot;-FetchQueueSize&quot;,&lt;br/&gt;
         new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; 
{
-          def getValue = q.size
+          def value = q.size
         }
&lt;p&gt;       )&lt;br/&gt;
     })&lt;br/&gt;
diff --git a/core/src/main/scala/kafka/controller/KafkaController.scala b/core/src/main/scala/kafka/controller/KafkaController.scala&lt;br/&gt;
index 48eae7e..9c4c8d1 100644&lt;/p&gt;&lt;/li&gt;
			&lt;li&gt;a/core/src/main/scala/kafka/controller/KafkaController.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/controller/KafkaController.scala&lt;br/&gt;
@@ -95,7 +95,7 @@ class KafkaController(val config : KafkaConfig, zkClient: ZkClient) extends Logg&lt;br/&gt;
   newGauge(&lt;br/&gt;
     &quot;ActiveControllerCount&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; 
{
-      def getValue() = if (isActive) 1 else 0
+      def value() = if (isActive) 1 else 0
     }
&lt;p&gt;   )&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/core/src/main/scala/kafka/log/Log.scala b/core/src/main/scala/kafka/log/Log.scala&lt;br/&gt;
index 631953f..b7b266e 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/log/Log.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/log/Log.scala&lt;br/&gt;
@@ -77,10 +77,10 @@ class Log(val dir: File,&lt;br/&gt;
   debug(&quot;Completed load of log %s with log end offset %d&quot;.format(name, logEndOffset))&lt;/p&gt;

&lt;p&gt;   newGauge(name + &quot;-&quot; + &quot;NumLogSegments&quot;,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; 
{ def getValue = numberOfSegments }
&lt;p&gt;)&lt;br/&gt;
+           new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; &lt;/p&gt;
{ def value = numberOfSegments }
&lt;p&gt;)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   newGauge(name + &quot;-&quot; + &quot;LogEndOffset&quot;,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Long&amp;#93;&lt;/span&gt; 
{ def getValue = logEndOffset }
&lt;p&gt;)&lt;br/&gt;
+           new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Long&amp;#93;&lt;/span&gt; &lt;/p&gt;
{ def value = logEndOffset }
&lt;p&gt;)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   /** The name of this log */&lt;br/&gt;
   def name  = dir.getName()&lt;br/&gt;
diff --git a/core/src/main/scala/kafka/network/RequestChannel.scala b/core/src/main/scala/kafka/network/RequestChannel.scala&lt;br/&gt;
index 209fdfa..c0e0dfc 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/network/RequestChannel.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/network/RequestChannel.scala&lt;br/&gt;
@@ -99,7 +99,7 @@ class RequestChannel(val numProcessors: Int, val queueSize: Int) extends KafkaMe&lt;br/&gt;
   newGauge(&lt;br/&gt;
     &quot;RequestQueueSize&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; &lt;/p&gt;
{
-      def getValue = requestQueue.size
+      def value = requestQueue.size
     }
&lt;p&gt;   )&lt;/p&gt;

&lt;p&gt;diff --git a/core/src/main/scala/kafka/producer/async/ProducerSendThread.scala b/core/src/main/scala/kafka/producer/async/ProducerSendThread.scala&lt;br/&gt;
index 6691147..090400d 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/producer/async/ProducerSendThread.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/producer/async/ProducerSendThread.scala&lt;br/&gt;
@@ -36,7 +36,7 @@ class ProducerSendThread&lt;span class=&quot;error&quot;&gt;&amp;#91;K,V&amp;#93;&lt;/span&gt;(val threadName: String,&lt;/p&gt;

&lt;p&gt;   newGauge(clientId + &quot;-ProducerQueueSize&quot;,&lt;br/&gt;
           new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; &lt;/p&gt;
{
-            def getValue = queue.size
+            def value = queue.size
           }
&lt;p&gt;)&lt;/p&gt;

&lt;p&gt;   override def run {&lt;br/&gt;
diff --git a/core/src/main/scala/kafka/server/AbstractFetcherThread.scala b/core/src/main/scala/kafka/server/AbstractFetcherThread.scala&lt;br/&gt;
index a7d39b1..006d573 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/server/AbstractFetcherThread.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/server/AbstractFetcherThread.scala&lt;br/&gt;
@@ -203,7 +203,7 @@ class FetcherLagMetrics(metricId: ClientIdBrokerTopicPartition) extends KafkaMet&lt;br/&gt;
   newGauge(&lt;br/&gt;
     metricId + &quot;-ConsumerLag&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Long&amp;#93;&lt;/span&gt; &lt;/p&gt;
{
-      def getValue = lagVal.get
+      def value = lagVal.get
     }
&lt;p&gt;   )&lt;/p&gt;

&lt;p&gt;diff --git a/core/src/main/scala/kafka/server/ReplicaManager.scala b/core/src/main/scala/kafka/server/ReplicaManager.scala&lt;br/&gt;
index 765d3cb..e1d5bd8 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/server/ReplicaManager.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/server/ReplicaManager.scala&lt;br/&gt;
@@ -56,19 +56,19 @@ class ReplicaManager(val config: KafkaConfig,&lt;br/&gt;
   newGauge(&lt;br/&gt;
     &quot;LeaderCount&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; &lt;/p&gt;
{
-      def getValue = leaderPartitions.size
+      def value = leaderPartitions.size
     }
&lt;p&gt;   )&lt;br/&gt;
   newGauge(&lt;br/&gt;
     &quot;PartitionCount&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; &lt;/p&gt;
{
-      def getValue = allPartitions.size
+      def value = allPartitions.size
     }
&lt;p&gt;   )&lt;br/&gt;
   newGauge(&lt;br/&gt;
     &quot;UnderReplicatedPartitions&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;def getValue = {&lt;br/&gt;
+      def value = {&lt;br/&gt;
         leaderPartitionsLock synchronized 
{
           leaderPartitions.count(_.isUnderReplicated)
         }
&lt;p&gt;diff --git a/core/src/main/scala/kafka/server/RequestPurgatory.scala b/core/src/main/scala/kafka/server/RequestPurgatory.scala&lt;br/&gt;
index afe9e22..c064c5c 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/core/src/main/scala/kafka/server/RequestPurgatory.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/server/RequestPurgatory.scala&lt;br/&gt;
@@ -72,14 +72,14 @@ abstract class RequestPurgatory&lt;span class=&quot;error&quot;&gt;&amp;#91;T &amp;lt;: DelayedRequest, R&amp;#93;&lt;/span&gt;(brokerId: Int = 0, purge&lt;br/&gt;
   newGauge(&lt;br/&gt;
     &quot;PurgatorySize&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; 
{
-      def getValue = watchersForKey.values.map(_.numRequests).sum + expiredRequestReaper.numRequests
+      def value = watchersForKey.values.map(_.numRequests).sum + expiredRequestReaper.numRequests
     }
&lt;p&gt;   )&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   newGauge(&lt;br/&gt;
     &quot;NumDelayedRequests&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; &lt;/p&gt;
{
-      def getValue = expiredRequestReaper.unsatisfied.get()
+      def value = expiredRequestReaper.unsatisfied.get()
     }
&lt;p&gt;   )&lt;/p&gt;

&lt;p&gt;diff --git a/core/src/test/scala/unit/kafka/metrics/KafkaTimerTest.scala b/core/src/test/scala/unit/kafka/metrics/KafkaTimerTest.scala&lt;br/&gt;
index a3f85cf..fe5bc09 100644&lt;br/&gt;
&amp;#8212; a/core/src/test/scala/unit/kafka/metrics/KafkaTimerTest.scala&lt;br/&gt;
+++ b/core/src/test/scala/unit/kafka/metrics/KafkaTimerTest.scala&lt;br/&gt;
@@ -35,20 +35,20 @@ class KafkaTimerTest extends JUnit3Suite {&lt;br/&gt;
     timer.time &lt;/p&gt;
{
       clock.addMillis(1000)
     }
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;assertEquals(1, metric.getCount())&lt;/li&gt;
	&lt;li&gt;assertTrue((metric.getMax() - 1000).abs &amp;lt;= Double.Epsilon)&lt;/li&gt;
	&lt;li&gt;assertTrue((metric.getMin() - 1000).abs &amp;lt;= Double.Epsilon)&lt;br/&gt;
+    assertEquals(1, metric.count())&lt;br/&gt;
+    assertTrue((metric.max() - 1000).abs &amp;lt;= Double.Epsilon)&lt;br/&gt;
+    assertTrue((metric.min() - 1000).abs &amp;lt;= Double.Epsilon)&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private class ManualClock extends Clock {&lt;/p&gt;

&lt;p&gt;     private var ticksInNanos = 0L&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;override def getTick() = {&lt;br/&gt;
+    override def tick() = 
{
       ticksInNanos
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;override def getTime() = {&lt;br/&gt;
+    override def time() = 
{
       TimeUnit.NANOSECONDS.toMillis(ticksInNanos)
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/project/Build.scala b/project/Build.scala&lt;br/&gt;
index facca79..bc3bc0c 100644&lt;br/&gt;
&amp;#8212; a/project/Build.scala&lt;br/&gt;
+++ b/project/Build.scala&lt;br/&gt;
@@ -17,7 +17,6 @@&lt;/p&gt;

&lt;p&gt; import sbt._&lt;br/&gt;
 import Keys._&lt;br/&gt;
-import java.io.File&lt;/p&gt;

&lt;p&gt; import scala.xml.&lt;/p&gt;
{Node, Elem}
&lt;p&gt; import scala.xml.transform.&lt;/p&gt;
{RewriteRule, RuleTransformer}
&lt;p&gt;@@ -35,7 +34,9 @@ object KafkaBuild extends Build {&lt;br/&gt;
       &quot;log4j&quot;                 % &quot;log4j&quot;        % &quot;1.2.15&quot;,&lt;br/&gt;
       &quot;net.sf.jopt-simple&quot;    % &quot;jopt-simple&quot;  % &quot;3.2&quot;,&lt;br/&gt;
       &quot;org.slf4j&quot;             % &quot;slf4j-simple&quot; % &quot;1.6.4&quot;,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&quot;com.101tec&quot;            % &quot;zkclient&quot;     % &quot;0.2&quot;&lt;br/&gt;
+      &quot;com.101tec&quot;            % &quot;zkclient&quot;     % &quot;0.2&quot;,&lt;br/&gt;
+      &quot;com.yammer.metrics&quot; % &quot;metrics-core&quot; % &quot;2.2.0&quot;,&lt;br/&gt;
+      &quot;com.yammer.metrics&quot; % &quot;metrics-annotation&quot; % &quot;2.2.0&quot;&lt;br/&gt;
     ),&lt;br/&gt;
     // The issue is going from log4j 1.2.14 to 1.2.15, the developers added some features which required&lt;br/&gt;
     // some dependencies on various sun and javax packages.&lt;br/&gt;
diff --git a/project/build/KafkaProject.scala b/project/build/KafkaProject.scala&lt;br/&gt;
index 1660fb8..853a45c 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/project/build/KafkaProject.scala&lt;br/&gt;
+++ b/project/build/KafkaProject.scala&lt;br/&gt;
@@ -74,7 +74,7 @@ class KafkaProject(info: ProjectInfo) extends ParentProject(info) with IdeaProje&lt;br/&gt;
       &amp;lt;dependency&amp;gt;&lt;br/&gt;
         &amp;lt;groupId&amp;gt;com.yammer.metrics&amp;lt;/groupId&amp;gt;&lt;br/&gt;
         &amp;lt;artifactId&amp;gt;metrics-core&amp;lt;/artifactId&amp;gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;&amp;lt;version&amp;gt;3.0.0-c0c8be71&amp;lt;/version&amp;gt;&lt;br/&gt;
+        &amp;lt;version&amp;gt;2.2.0&amp;lt;/version&amp;gt;&lt;br/&gt;
         &amp;lt;scope&amp;gt;compile&amp;lt;/scope&amp;gt;&lt;br/&gt;
       &amp;lt;/dependency&amp;gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -82,7 +82,7 @@ class KafkaProject(info: ProjectInfo) extends ParentProject(info) with IdeaProje&lt;br/&gt;
       &amp;lt;dependency&amp;gt;&lt;br/&gt;
         &amp;lt;groupId&amp;gt;com.yammer.metrics&amp;lt;/groupId&amp;gt;&lt;br/&gt;
         &amp;lt;artifactId&amp;gt;metrics-annotation&amp;lt;/artifactId&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;version&amp;gt;3.0.0-c0c8be71&amp;lt;/version&amp;gt;&lt;br/&gt;
+        &amp;lt;version&amp;gt;2.2.0&amp;lt;/version&amp;gt;&lt;br/&gt;
         &amp;lt;scope&amp;gt;compile&amp;lt;/scope&amp;gt;&lt;br/&gt;
       &amp;lt;/dependency&amp;gt;&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="13616783" author="jjkoshy" created="Thu, 28 Mar 2013 23:12:14 +0000"  >&lt;p&gt;Thank you for looking into this. Metrics 2.x had a few minor issues with the CsvReporter (which we use in the system tests) and this is why we&lt;br/&gt;
used 3.x.&lt;/p&gt;

&lt;p&gt;The fixes that I&apos;m aware of are:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/codahale/metrics/pull/225&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/codahale/metrics/pull/225&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/codahale/metrics/pull/290&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/codahale/metrics/pull/290&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;If a CSV file already exists, metrics throws an IOException and does not resume CSV reporting. This would be the case on a broker bounce for example. Someone put out a patch for this (&lt;a href=&quot;https://github.com/adagios/metrics/compare/2.x-maintenance...2.x-epoch-in-csv&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/adagios/metrics/compare/2.x-maintenance...2.x-epoch-in-csv&lt;/a&gt;) but I&apos;d have to check if that was pulled into metrics-3.x&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Unfortunately, although the above are small fixes, if we want to use the official 2.x metrics release we would need to copy over&lt;br/&gt;
the code of the metrics CsvReporter (i.e., into a new implementation of metrics&apos; AbstractReporter), patch in those fixes and plug&lt;br/&gt;
that into KafkaMetricsCsvReporter. I don&apos;t think it is difficult, but a bit clunky (which is why at the time we preferred using 3.x).&lt;/p&gt;</comment>
                            <comment id="13617539" author="scott_carey" created="Fri, 29 Mar 2013 17:26:04 +0000"  >&lt;p&gt;The only real trouble with 3.0.x is if:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;it conflicts with 2.2.x if in the same classloader&lt;/li&gt;
	&lt;li&gt;there is no released artifact in a public maven repo to provide repeatable builds.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We might be able to find out when a 3.0-alpha may be available and pushed to a public maven repo.  It does  not appear that a final version is due out in time.&lt;/p&gt;</comment>
                            <comment id="13617646" author="swapnilghike" created="Fri, 29 Mar 2013 19:42:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragosm&quot; class=&quot;user-hover&quot; rel=&quot;dragosm&quot;&gt;dragosm&lt;/a&gt;: Could you upload a patch using the attach files options above? I tried applying your patch using &quot;patch -p1&quot;, but it could not be applied. Thanks.&lt;/p&gt;</comment>
                            <comment id="13617696" author="dragosm" created="Fri, 29 Mar 2013 20:36:10 +0000"  >&lt;p&gt;Alternatively this code is checked into my fork of the project, &lt;a href=&quot;https://github.com/polymorphic/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/polymorphic/kafka&lt;/a&gt;, the metrics2 branch&lt;/p&gt;</comment>
                            <comment id="13617818" author="swapnilghike" created="Fri, 29 Mar 2013 22:27:37 +0000"  >&lt;p&gt;Hi Dragos, I am still not able to cleanly apply the patch. Is it created off 0.8 HEAD? Could you rebase in case it helps? Thanks.&lt;/p&gt;

&lt;p&gt;sghike@machine:~/kafka-local/kafka$ patch -p1 --dry-run &amp;lt; ../kafka-fix-for-826.patch &lt;br/&gt;
patching file core/src/main/scala/kafka/cluster/Partition.scala&lt;br/&gt;
patching file core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala&lt;br/&gt;
Hunk #1 succeeded at 650 (offset -3 lines).&lt;br/&gt;
patching file core/src/main/scala/kafka/controller/KafkaController.scala&lt;br/&gt;
Hunk #1 succeeded at 97 (offset 2 lines).&lt;br/&gt;
patching file core/src/main/scala/kafka/log/Log.scala&lt;br/&gt;
Hunk #1 succeeded at 130 with fuzz 2 (offset 53 lines).&lt;br/&gt;
patching file core/src/main/scala/kafka/network/RequestChannel.scala&lt;br/&gt;
patching file core/src/main/scala/kafka/producer/async/ProducerSendThread.scala&lt;br/&gt;
patching file core/src/main/scala/kafka/server/AbstractFetcherThread.scala&lt;br/&gt;
Hunk #1 succeeded at 195 (offset -8 lines).&lt;br/&gt;
patching file core/src/main/scala/kafka/server/ReplicaManager.scala&lt;br/&gt;
Hunk #1 FAILED at 56.&lt;br/&gt;
1 out of 1 hunk FAILED &amp;#8211; saving rejects to file core/src/main/scala/kafka/server/ReplicaManager.scala.rej&lt;br/&gt;
patching file core/src/main/scala/kafka/server/RequestPurgatory.scala&lt;br/&gt;
patching file core/src/test/scala/unit/kafka/metrics/KafkaTimerTest.scala&lt;br/&gt;
patching file project/Build.scala&lt;br/&gt;
Hunk #2 FAILED at 34.&lt;br/&gt;
1 out of 2 hunks FAILED &amp;#8211; saving rejects to file project/Build.scala.rej&lt;br/&gt;
patching file project/build/KafkaProject.scala&lt;br/&gt;
Hunk #1 FAILED at 74.&lt;br/&gt;
Hunk #2 FAILED at 82.&lt;br/&gt;
2 out of 2 hunks FAILED &amp;#8211; saving rejects to file project/build/KafkaProject.scala.rej&lt;/p&gt;</comment>
                            <comment id="13619129" author="dragosm" created="Mon, 1 Apr 2013 20:32:41 +0000"  >&lt;p&gt;Let&apos;s try this again, I have another patch ready.&lt;/p&gt;</comment>
                            <comment id="13619134" author="dragosm" created="Mon, 1 Apr 2013 20:37:05 +0000"  >&lt;p&gt;diff --git a/core/src/main/scala/kafka/cluster/Partition.scala b/core/src/main/scala/kafka/cluster/Partition.scala&lt;br/&gt;
index 2ca7ee6..e49bdae 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/cluster/Partition.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/cluster/Partition.scala&lt;br/&gt;
@@ -60,7 +60,7 @@ class Partition(val topic: String,&lt;br/&gt;
   newGauge(&lt;br/&gt;
     topic + &quot;-&quot; + partitionId + &quot;-UnderReplicated&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;def getValue = 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      def value = {
         if (isUnderReplicated) 1 else 0
       }     }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;diff --git a/core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala b/core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala&lt;br/&gt;
index 9a5fbfe..398618f 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala&lt;br/&gt;
@@ -650,7 +650,7 @@ private&lt;span class=&quot;error&quot;&gt;&amp;#91;kafka&amp;#93;&lt;/span&gt; class ZookeeperConsumerConnector(val config: ConsumerConfig,&lt;br/&gt;
       newGauge(&lt;br/&gt;
         config.clientId + &quot;&lt;del&gt;&quot; + config.groupId + &quot;&lt;/del&gt;&quot; + topicThreadId._1 + &quot;-&quot; + topicThreadId._2 + &quot;-FetchQueueSize&quot;,&lt;br/&gt;
         new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; 
{
-          def getValue = q.size
+          def value = q.size
         }
&lt;p&gt;       )&lt;br/&gt;
     })&lt;br/&gt;
diff --git a/core/src/main/scala/kafka/controller/KafkaController.scala b/core/src/main/scala/kafka/controller/KafkaController.scala&lt;br/&gt;
index 74614d8..5f6eb3c 100644&lt;/p&gt;&lt;/li&gt;
			&lt;li&gt;a/core/src/main/scala/kafka/controller/KafkaController.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/controller/KafkaController.scala&lt;br/&gt;
@@ -97,14 +97,14 @@ class KafkaController(val config : KafkaConfig, zkClient: ZkClient) extends Logg&lt;br/&gt;
   newGauge(&lt;br/&gt;
     &quot;ActiveControllerCount&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; 
{
-      def getValue() = if (isActive) 1 else 0
+      def value() = if (isActive) 1 else 0
     }
&lt;p&gt;   )&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   newGauge(&lt;br/&gt;
     &quot;OfflinePartitionsCount&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;def getValue: Int = {&lt;br/&gt;
+      def value(): Int = {&lt;br/&gt;
         controllerContext.controllerLock synchronized 
{
           controllerContext.partitionLeadershipInfo.count(p =&amp;gt; !controllerContext.liveBrokerIds.contains(p._2.leaderAndIsr.leader))
         }
&lt;p&gt;diff --git a/core/src/main/scala/kafka/log/Log.scala b/core/src/main/scala/kafka/log/Log.scala&lt;br/&gt;
index 7d71451..451775b 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/core/src/main/scala/kafka/log/Log.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/log/Log.scala&lt;br/&gt;
@@ -130,10 +130,10 @@ private&lt;span class=&quot;error&quot;&gt;&amp;#91;kafka&amp;#93;&lt;/span&gt; class Log(val dir: File,&lt;br/&gt;
   debug(&quot;Completed load of log %s with log end offset %d&quot;.format(name, logEndOffset))&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   newGauge(name + &quot;-&quot; + &quot;NumLogSegments&quot;,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; 
{ def getValue = numberOfSegments }
&lt;p&gt;)&lt;br/&gt;
+           new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; &lt;/p&gt;
{ def value = numberOfSegments }
&lt;p&gt;)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   newGauge(name + &quot;-&quot; + &quot;LogEndOffset&quot;,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Long&amp;#93;&lt;/span&gt; 
{ def getValue = logEndOffset }
&lt;p&gt;)&lt;br/&gt;
+           new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Long&amp;#93;&lt;/span&gt; &lt;/p&gt;
{ def value = logEndOffset }
&lt;p&gt;)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   /* The name of this log */&lt;br/&gt;
   def name  = dir.getName()&lt;br/&gt;
diff --git a/core/src/main/scala/kafka/network/RequestChannel.scala b/core/src/main/scala/kafka/network/RequestChannel.scala&lt;br/&gt;
index 209fdfa..c0e0dfc 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/network/RequestChannel.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/network/RequestChannel.scala&lt;br/&gt;
@@ -99,7 +99,7 @@ class RequestChannel(val numProcessors: Int, val queueSize: Int) extends KafkaMe&lt;br/&gt;
   newGauge(&lt;br/&gt;
     &quot;RequestQueueSize&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; &lt;/p&gt;
{
-      def getValue = requestQueue.size
+      def value = requestQueue.size
     }
&lt;p&gt;   )&lt;/p&gt;

&lt;p&gt;diff --git a/core/src/main/scala/kafka/producer/async/ProducerSendThread.scala b/core/src/main/scala/kafka/producer/async/ProducerSendThread.scala&lt;br/&gt;
index 6691147..090400d 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/producer/async/ProducerSendThread.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/producer/async/ProducerSendThread.scala&lt;br/&gt;
@@ -36,7 +36,7 @@ class ProducerSendThread&lt;span class=&quot;error&quot;&gt;&amp;#91;K,V&amp;#93;&lt;/span&gt;(val threadName: String,&lt;/p&gt;

&lt;p&gt;   newGauge(clientId + &quot;-ProducerQueueSize&quot;,&lt;br/&gt;
           new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; &lt;/p&gt;
{
-            def getValue = queue.size
+            def value = queue.size
           }
&lt;p&gt;)&lt;/p&gt;

&lt;p&gt;   override def run {&lt;br/&gt;
diff --git a/core/src/main/scala/kafka/server/AbstractFetcherThread.scala b/core/src/main/scala/kafka/server/AbstractFetcherThread.scala&lt;br/&gt;
index 087979f..2e026e6 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/server/AbstractFetcherThread.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/server/AbstractFetcherThread.scala&lt;br/&gt;
@@ -195,7 +195,7 @@ class FetcherLagMetrics(metricId: ClientIdBrokerTopicPartition) extends KafkaMet&lt;br/&gt;
   newGauge(&lt;br/&gt;
     metricId + &quot;-ConsumerLag&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Long&amp;#93;&lt;/span&gt; &lt;/p&gt;
{
-      def getValue = lagVal.get
+      def value = lagVal.get
     }
&lt;p&gt;   )&lt;/p&gt;

&lt;p&gt;diff --git a/core/src/main/scala/kafka/server/ReplicaManager.scala b/core/src/main/scala/kafka/server/ReplicaManager.scala&lt;br/&gt;
index 68e712c..44ad562 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/scala/kafka/server/ReplicaManager.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/server/ReplicaManager.scala&lt;br/&gt;
@@ -57,7 +57,7 @@ class ReplicaManager(val config: KafkaConfig,&lt;br/&gt;
   newGauge(&lt;br/&gt;
     &quot;LeaderCount&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;def getValue = {&lt;br/&gt;
+      def value = {&lt;br/&gt;
         leaderPartitionsLock synchronized 
{
           leaderPartitions.size
         }
&lt;p&gt;@@ -67,13 +67,13 @@ class ReplicaManager(val config: KafkaConfig,&lt;br/&gt;
   newGauge(&lt;br/&gt;
     &quot;PartitionCount&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; &lt;/p&gt;
{
-      def getValue = allPartitions.size
+      def value = allPartitions.size
     }
&lt;p&gt;   )&lt;br/&gt;
   newGauge(&lt;br/&gt;
     &quot;UnderReplicatedPartitions&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;def getValue = {&lt;br/&gt;
+      def value = {&lt;br/&gt;
         leaderPartitionsLock synchronized 
{
           leaderPartitions.count(_.isUnderReplicated)
         }
&lt;p&gt;diff --git a/core/src/main/scala/kafka/server/RequestPurgatory.scala b/core/src/main/scala/kafka/server/RequestPurgatory.scala&lt;br/&gt;
index afe9e22..c064c5c 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/core/src/main/scala/kafka/server/RequestPurgatory.scala&lt;br/&gt;
+++ b/core/src/main/scala/kafka/server/RequestPurgatory.scala&lt;br/&gt;
@@ -72,14 +72,14 @@ abstract class RequestPurgatory&lt;span class=&quot;error&quot;&gt;&amp;#91;T &amp;lt;: DelayedRequest, R&amp;#93;&lt;/span&gt;(brokerId: Int = 0, purge&lt;br/&gt;
   newGauge(&lt;br/&gt;
     &quot;PurgatorySize&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; 
{
-      def getValue = watchersForKey.values.map(_.numRequests).sum + expiredRequestReaper.numRequests
+      def value = watchersForKey.values.map(_.numRequests).sum + expiredRequestReaper.numRequests
     }
&lt;p&gt;   )&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   newGauge(&lt;br/&gt;
     &quot;NumDelayedRequests&quot;,&lt;br/&gt;
     new Gauge&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt; &lt;/p&gt;
{
-      def getValue = expiredRequestReaper.unsatisfied.get()
+      def value = expiredRequestReaper.unsatisfied.get()
     }
&lt;p&gt;   )&lt;/p&gt;

&lt;p&gt;diff --git a/core/src/test/scala/unit/kafka/metrics/KafkaTimerTest.scala b/core/src/test/scala/unit/kafka/metrics/KafkaTimerTest.scala&lt;br/&gt;
index a3f85cf..fe5bc09 100644&lt;br/&gt;
&amp;#8212; a/core/src/test/scala/unit/kafka/metrics/KafkaTimerTest.scala&lt;br/&gt;
+++ b/core/src/test/scala/unit/kafka/metrics/KafkaTimerTest.scala&lt;br/&gt;
@@ -35,20 +35,20 @@ class KafkaTimerTest extends JUnit3Suite {&lt;br/&gt;
     timer.time &lt;/p&gt;
{
       clock.addMillis(1000)
     }
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;assertEquals(1, metric.getCount())&lt;/li&gt;
	&lt;li&gt;assertTrue((metric.getMax() - 1000).abs &amp;lt;= Double.Epsilon)&lt;/li&gt;
	&lt;li&gt;assertTrue((metric.getMin() - 1000).abs &amp;lt;= Double.Epsilon)&lt;br/&gt;
+    assertEquals(1, metric.count())&lt;br/&gt;
+    assertTrue((metric.max() - 1000).abs &amp;lt;= Double.Epsilon)&lt;br/&gt;
+    assertTrue((metric.min() - 1000).abs &amp;lt;= Double.Epsilon)&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private class ManualClock extends Clock {&lt;/p&gt;

&lt;p&gt;     private var ticksInNanos = 0L&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;override def getTick() = {&lt;br/&gt;
+    override def tick() = 
{
       ticksInNanos
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;override def getTime() = {&lt;br/&gt;
+    override def time() = 
{
       TimeUnit.NANOSECONDS.toMillis(ticksInNanos)
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/project/Build.scala b/project/Build.scala&lt;br/&gt;
index 4bbdfee..b8b476b 100644&lt;br/&gt;
&amp;#8212; a/project/Build.scala&lt;br/&gt;
+++ b/project/Build.scala&lt;br/&gt;
@@ -17,7 +17,6 @@&lt;/p&gt;

&lt;p&gt; import sbt._&lt;br/&gt;
 import Keys._&lt;br/&gt;
-import java.io.File&lt;/p&gt;

&lt;p&gt; import scala.xml.&lt;/p&gt;
{Node, Elem}
&lt;p&gt; import scala.xml.transform.&lt;/p&gt;
{RewriteRule, RuleTransformer}
&lt;p&gt;@@ -34,7 +33,10 @@ object KafkaBuild extends Build {&lt;br/&gt;
     libraryDependencies ++= Seq(&lt;br/&gt;
       &quot;log4j&quot;                 % &quot;log4j&quot;        % &quot;1.2.15&quot;,&lt;br/&gt;
       &quot;net.sf.jopt-simple&quot;    % &quot;jopt-simple&quot;  % &quot;3.2&quot;,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&quot;org.slf4j&quot;             % &quot;slf4j-simple&quot; % &quot;1.6.4&quot;&lt;br/&gt;
+      &quot;org.slf4j&quot;             % &quot;slf4j-simple&quot; % &quot;1.6.4&quot;,&lt;br/&gt;
+      &quot;com.101tec&quot;            % &quot;zkclient&quot;     % &quot;0.2&quot;,&lt;br/&gt;
+      &quot;com.yammer.metrics&quot;    % &quot;metrics-core&quot; % &quot;2.2.0&quot;,&lt;br/&gt;
+      &quot;com.yammer.metrics&quot;    % &quot;metrics-annotation&quot; % &quot;2.2.0&quot;&lt;br/&gt;
     ),&lt;br/&gt;
     // The issue is going from log4j 1.2.14 to 1.2.15, the developers added some features which required&lt;br/&gt;
     // some dependencies on various sun and javax packages.&lt;br/&gt;
diff --git a/project/build/KafkaProject.scala b/project/build/KafkaProject.scala&lt;br/&gt;
index fac723a..853a45c 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/project/build/KafkaProject.scala&lt;br/&gt;
+++ b/project/build/KafkaProject.scala&lt;br/&gt;
@@ -74,7 +74,7 @@ class KafkaProject(info: ProjectInfo) extends ParentProject(info) with IdeaProje&lt;br/&gt;
       &amp;lt;dependency&amp;gt;&lt;br/&gt;
         &amp;lt;groupId&amp;gt;com.yammer.metrics&amp;lt;/groupId&amp;gt;&lt;br/&gt;
         &amp;lt;artifactId&amp;gt;metrics-core&amp;lt;/artifactId&amp;gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;&amp;lt;version&amp;gt;3.0.0-SNAPSHOT&amp;lt;/version&amp;gt;&lt;br/&gt;
+        &amp;lt;version&amp;gt;2.2.0&amp;lt;/version&amp;gt;&lt;br/&gt;
         &amp;lt;scope&amp;gt;compile&amp;lt;/scope&amp;gt;&lt;br/&gt;
       &amp;lt;/dependency&amp;gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -82,7 +82,7 @@ class KafkaProject(info: ProjectInfo) extends ParentProject(info) with IdeaProje&lt;br/&gt;
       &amp;lt;dependency&amp;gt;&lt;br/&gt;
         &amp;lt;groupId&amp;gt;com.yammer.metrics&amp;lt;/groupId&amp;gt;&lt;br/&gt;
         &amp;lt;artifactId&amp;gt;metrics-annotation&amp;lt;/artifactId&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;version&amp;gt;3.0.0-SNAPSHOT&amp;lt;/version&amp;gt;&lt;br/&gt;
+        &amp;lt;version&amp;gt;2.2.0&amp;lt;/version&amp;gt;&lt;br/&gt;
         &amp;lt;scope&amp;gt;compile&amp;lt;/scope&amp;gt;&lt;br/&gt;
       &amp;lt;/dependency&amp;gt;&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="13619138" author="dragosm" created="Mon, 1 Apr 2013 20:39:39 +0000"  >&lt;p&gt;I&apos;m sorry you&apos;ve had problems with this patch. You should be good to go:&lt;/p&gt;

&lt;p&gt;seac02jh0rjdkq4 ~/Repos/kafka% git status                                                                                                                                  &lt;span class=&quot;error&quot;&gt;&amp;#91;92&amp;#93;&lt;/span&gt;&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;On branch 0.8&lt;/li&gt;
	&lt;li&gt;Untracked files:&lt;/li&gt;
	&lt;li&gt;(use &quot;git add &amp;lt;file&amp;gt;...&quot; to include in what will be committed)&lt;br/&gt;
#&lt;/li&gt;
	&lt;li&gt;.idea_modules/&lt;br/&gt;
nothing added to commit but untracked files present (use &quot;git add&quot; to track)&lt;br/&gt;
mseac02jh0rjdkq4 ~/Repos/kafka% patch -p1 --dry-run &amp;lt; ../kafka-fix-for-826-take2.patch                                                                                      &lt;span class=&quot;error&quot;&gt;&amp;#91;93&amp;#93;&lt;/span&gt;&lt;br/&gt;
patching file core/src/main/scala/kafka/cluster/Partition.scala&lt;br/&gt;
patching file core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala&lt;br/&gt;
patching file core/src/main/scala/kafka/controller/KafkaController.scala&lt;br/&gt;
patching file core/src/main/scala/kafka/log/Log.scala&lt;br/&gt;
patching file core/src/main/scala/kafka/network/RequestChannel.scala&lt;br/&gt;
patching file core/src/main/scala/kafka/producer/async/ProducerSendThread.scala&lt;br/&gt;
patching file core/src/main/scala/kafka/server/AbstractFetcherThread.scala&lt;br/&gt;
patching file core/src/main/scala/kafka/server/ReplicaManager.scala&lt;br/&gt;
patching file core/src/main/scala/kafka/server/RequestPurgatory.scala&lt;br/&gt;
patching file core/src/test/scala/unit/kafka/metrics/KafkaTimerTest.scala&lt;br/&gt;
patching file project/Build.scala&lt;br/&gt;
patching file project/build/KafkaProject.scala&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13619153" author="swapnilghike" created="Mon, 1 Apr 2013 20:57:20 +0000"  >&lt;p&gt;Hi Dragos, sorry for bugging you again. I think if I copy paste your new patch, I am not able to apply it again. Do you mind attaching it as a file? Thanks for the help Dragos!&lt;/p&gt;</comment>
                            <comment id="13619163" author="dragosm" created="Mon, 1 Apr 2013 21:07:52 +0000"  >&lt;p&gt;Here it is, attached. Please LMK if you still have problems.&lt;/p&gt;</comment>
                            <comment id="13619172" author="swapnilghike" created="Mon, 1 Apr 2013 21:15:20 +0000"  >&lt;p&gt;The take2 patch applies quite smoothly! Thanks a ton, will check today how it works out.&lt;/p&gt;</comment>
                            <comment id="13619475" author="otis" created="Tue, 2 Apr 2013 03:21:53 +0000"  >&lt;p&gt;Ah, what timing!  Metrics 3.0.0 BETA1 has just been pushed to Maven Central with goodies:&lt;br/&gt;
Coda Hale &amp;lt;coda.hale@gmail.com&amp;gt; Apr 01 02:02PM -0700  &lt;/p&gt;

&lt;p&gt;Metrics 3.0.0-BETA1 is on its way to Maven Central! It includes the following changes:&lt;/p&gt;

&lt;p&gt;&#8226; Total overhaul of most of the core Metrics classes:&lt;br/&gt;
&#8226; Metric names are now just dotted paths like com.example.Thing, allowing for very flexible scopes, etc.&lt;br/&gt;
&#8226; Meters and timers no longer have rate or duration units; those are properties of reporters.&lt;br/&gt;
&#8226; Reporter architecture has been radically simplified, fixing many bugs.&lt;br/&gt;
&#8226; Histograms and timers can take arbitrary reservoir implementations.&lt;br/&gt;
&#8226; Added sliding window reservoir implementations.&lt;br/&gt;
&#8226; Added MetricSet for sets of metrics.&lt;br/&gt;
&#8226; Changed package names to be OSGi-compatible and added OSGi bundling.&lt;br/&gt;
&#8226; Extracted JVM instrumentation to metrics-jvm.&lt;br/&gt;
&#8226; Extracted Jackson integration to metrics-json.&lt;br/&gt;
&#8226; Removed metrics-guice, metrics-scala, and metrics-spring.&lt;br/&gt;
&#8226; Renamed metrics-servlet to metrics-servlets.&lt;br/&gt;
&#8226; Renamed metrics-web to metrics-servlet.&lt;br/&gt;
&#8226; Renamed metrics-jetty to metrics-jetty8.&lt;br/&gt;
&#8226; Many more small changes!&lt;/p&gt;

&lt;p&gt;Wouldn&apos;t it make sense to invest the effort into moving to 3.0.0 instead now?  Otherwise, if the gap between 0.8 and post-0.8 release is as big as the gap between 0.7.2 and 0.8 it will be a while before moving to this new metrics package.&lt;/p&gt;</comment>
                            <comment id="13620363" author="junrao" created="Tue, 2 Apr 2013 22:35:29 +0000"  >&lt;p&gt;Otis,&lt;/p&gt;

&lt;p&gt;The reason that we want to downgrade metrics to 2.x is because quite a few people feel this is the most stable version that they can depend on. Do you know how stable is this beta release? Will there be any API or bean name change btw the final 3.x release and this beta release?&lt;/p&gt;

&lt;p&gt;In general, do people feel comfortable about using the metrics 3.0 beta release?&lt;/p&gt;</comment>
                            <comment id="13620428" author="swapnilghike" created="Wed, 3 Apr 2013 00:06:52 +0000"  >&lt;p&gt;Dragos, thanks for the input. We can definitely use your patch if we decide to downgrade metrics to 2.2.0. Could you please address the following comments and re-submit the patch?&lt;/p&gt;

&lt;p&gt;1. Could you move the metrics-core, metrics-annotations and zkclient library dependences to core/build.sbt? You will need to replace the old organization and version number of zkclient there with the one you added to KafkaBuild.&lt;br/&gt;
2. Could you append the corresponding paths to class path in bin/kafka-run-class.sh? Also please remove core/lib/*.jar from class path since we are moving the three jars there to ivy.&lt;br/&gt;
3. git rm core/lib for the same reason mentioned in 2.&lt;/p&gt;

&lt;p&gt;Apart from your patch, we will need to fix the csv reporter separately.&lt;/p&gt;</comment>
                            <comment id="13620566" author="otis" created="Wed, 3 Apr 2013 03:34:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=junrao&quot; class=&quot;user-hover&quot; rel=&quot;junrao&quot;&gt;junrao&lt;/a&gt; - I&apos;m on the ML for that metrics lib and a few weeks (1-2 months?) ago Coda wrote an email saying he was not happy with a number of things in 2.x that he completely reworked in 3.x.  I don&apos;t recall the details, but I recall feeling like 3.x is the version I&apos;d use if I had to pick between 2.x and 3.x.  Unless Kafka 0.8 is going to be released within the next week or two, I&apos;d personally go with 3.x, unless you are open moving from 2.x to 3.x in the near future in 0.8.1.&lt;/p&gt;
</comment>
                            <comment id="13621416" author="scott_carey" created="Wed, 3 Apr 2013 22:19:09 +0000"  >&lt;p&gt;My main complaint prior to this was two-fold:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Early versions of metrics 3.x had classpath collisions with 2.2.x , so we would be unable to have both in the same application and we already use 2.2.&lt;/li&gt;
	&lt;li&gt;There was no official version of metrics 3.x published anywhere to consume, no roadmap, and the developer was MIA for months.  Kafka would have had to publish their own artifact version which gets messy fast and would have likely api compatibility issues with any future final metrics 3.0.x release and therefore be very difficult to use kafka 0.8 and the final metrics 3.0 in the same application.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If 3.x is stable enough API wise, I&apos;d be fine with keeping kafka on it.   I believe 3.x no longer collides with 2.2.x in a classpath, but have not tested that recently, meaning we could migrate to 3.x at our own pace and not have to time it to be in sync with use of Kafka 0.8.&lt;/p&gt;</comment>
                            <comment id="13621426" author="scott_carey" created="Wed, 3 Apr 2013 22:29:26 +0000"  >&lt;p&gt;Given the volume of work that has been done on metrics 3 between the snapshot on March 12 and the recent BETA1, I am comfortable with it &amp;#8211; a full release is likely to be complete before Kafka 0.8 is through its beta.&lt;/p&gt;</comment>
                            <comment id="13622062" author="brugidou" created="Thu, 4 Apr 2013 11:47:31 +0000"  >&lt;p&gt;Yes there has been some work and it breaks when I try to use 3.0.0-BETA1 from 0.8 branch. We need to have a MetricsRegistry (static or injected) and use the new register() method to add gauges/metrics. Also the core namespace has been removed&lt;/p&gt;

&lt;p&gt;Anyone working on a patch to get the BETA1 ? (and remove the core/lib/metrics*.jar files? )&lt;/p&gt;

&lt;p&gt;By the way I don&apos;t think we use metrics-annotation, just metrics-core right?&lt;/p&gt;</comment>
                            <comment id="13622458" author="junrao" created="Thu, 4 Apr 2013 16:07:37 +0000"  >&lt;p&gt;I pinged Coda and the following are the answers that I got.&lt;/p&gt;

&lt;p&gt;1. How stable is 3.0.0-Beta1?&lt;br/&gt;
The code is actually less complicated than Metrics 2 and far better tested: no thread pools, no lifecycles, no static references, just simple objects.&lt;/p&gt;

&lt;p&gt;2. Is it true that 3.0.0-Beta1 has no classpath conflict with 2.x? In other words, can an application use both jars in the same JVM?&lt;br/&gt;
Many of the classes have changed names and/or packages, but I didn&apos;t intend for there to be no classpath conflicts. You might be able to get away with it, but someone somewhere will step on something sharp, I&apos;m sure.&lt;/p&gt;

&lt;p&gt;3. Will there be any api change btw 3.0.0-Beta1 and the final 3.0 release?&lt;br/&gt;
Probably, yes.&lt;/p&gt;

&lt;p&gt;4. Were there any api changes btw 3.0.0-Beta1 and 3.0.0-SNAPSHOT (the one that we are currently using in Kafka 0.8)?&lt;br/&gt;
I don&apos;t know which snapshot build you&apos;re using, but I would imagine there are a lot of changes.&lt;/p&gt;

&lt;p&gt;Based on the above, my feeling is that Kafka 0.8 release should use metrics 2.x since (1) it has been stable; (2) people who depend on 2.x have no risk in using Kafka 0.8; (3) the api of 3.x is likely going to change again. In a post 0.8 release, we can upgrade to metrics 3.x when the final version is released and is deemed stable. Any concern with this approach?&lt;/p&gt;</comment>
                            <comment id="13622469" author="dragosm" created="Thu, 4 Apr 2013 16:16:34 +0000"  >&lt;p&gt;Thank you Jun for the analysis! From my perspective the approach you suggested is sound. FWIW a couple of weeks ago I &quot;ported&quot; the Kafka code to the latest (at the time) metrics 3.0.0 APIs. The code compiled and tests passed, but I don&apos;t know the extent that demonstrates that the instrumentation and reporting worked as it should. I&apos;m bringing it up because I feel that once 3.0.0 is released the port is mechanical.&lt;/p&gt;</comment>
                            <comment id="13622515" author="nehanarkhede" created="Thu, 4 Apr 2013 16:59:37 +0000"  >&lt;p&gt;I agree with Jun that we should release Kafka 0.8 with metrics 2.x. Let&apos;s wait until metrics 3.x APIs are stable.&lt;/p&gt;</comment>
                            <comment id="13622650" author="scott_carey" created="Thu, 4 Apr 2013 18:47:43 +0000"  >&lt;p&gt;Sounds good to me. &lt;/p&gt;</comment>
                            <comment id="13622733" author="nikore" created="Thu, 4 Apr 2013 20:22:11 +0000"  >&lt;p&gt;I also like this, allows this to be integrated in with our other metrics we are already collecting under 2.2 and report it all to ganglia. &lt;/p&gt;</comment>
                            <comment id="13622833" author="swapnilghike" created="Thu, 4 Apr 2013 21:39:47 +0000"  >&lt;p&gt;Dragos, it seems like we are headed towards agreeing on using 2.2.0. Do you mind including the review suggestions in your patch? If you are busy, I can finish it up too. Thanks.&lt;/p&gt;</comment>
                            <comment id="13624150" author="dragosm" created="Fri, 5 Apr 2013 22:51:16 +0000"  >&lt;p&gt;I&apos;m just starting to work on it, will try to finish it over the weekend.&lt;/p&gt;</comment>
                            <comment id="13624535" author="dragosm" created="Sat, 6 Apr 2013 23:28:44 +0000"  >&lt;p&gt;Here&apos;s the patch for metrics 2.2.0 with &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; code updates for the metrics API, (ii) build updates to reference zkclient 0.2 and metrics 2.2.0, and (iii) script updates with the appropriate classpaths. I have verified it and all tests pass:&lt;/p&gt;


&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Passed: : Total 175, Failed 0, Errors 0, Passed 175, Skipped 0&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;success&amp;#93;&lt;/span&gt; Total time: 166 s, completed Apr 6, 2013 4:19:27 PM&lt;/p&gt;

&lt;p&gt;Please LMK if you run into problems.&lt;/p&gt;</comment>
                            <comment id="13625222" author="swapnilghike" created="Mon, 8 Apr 2013 07:58:44 +0000"  >&lt;p&gt;Thanks, the unit tests were ok. But while trying to boot up a kafka server, I got the following error.&lt;/p&gt;

&lt;p&gt;This is what I did, &lt;br/&gt;
rm -rf ~/.ivy2&lt;br/&gt;
patch -p1 &amp;lt; kafka-fix-for-826-complete.patch&lt;br/&gt;
git rm -r core/lib&lt;br/&gt;
./sbt clean&lt;br/&gt;
./sbt update&lt;br/&gt;
./sbt package&lt;br/&gt;
bin/zookeeper-server-start.sh config/zookeeper.properties&lt;br/&gt;
bin/kafka-server-start.sh config/server.properties&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2013-04-08 00:48:29,743&amp;#93;&lt;/span&gt; FATAL  (kafka.Kafka$)&lt;br/&gt;
java.lang.NoClassDefFoundError: com/yammer/metrics/reporting/CsvReporter&lt;br/&gt;
	at kafka.metrics.KafkaCSVMetricsReporter.init(KafkaCSVMetricsReporter.scala:53)&lt;br/&gt;
	at kafka.metrics.KafkaMetricsReporter$$anonfun$startReporters$1.apply(KafkaMetricsReporter.scala:60)&lt;br/&gt;
	at kafka.metrics.KafkaMetricsReporter$$anonfun$startReporters$1.apply(KafkaMetricsReporter.scala:58)&lt;br/&gt;
	at scala.collection.IndexedSeqOptimized$class.foreach(IndexedSeqOptimized.scala:34)&lt;br/&gt;
	at scala.collection.mutable.WrappedArray.foreach(WrappedArray.scala:32)&lt;br/&gt;
	at kafka.metrics.KafkaMetricsReporter$.startReporters(KafkaMetricsReporter.scala:58)&lt;br/&gt;
	at kafka.Kafka$.main(Kafka.scala:36)&lt;br/&gt;
	at kafka.Kafka.main(Kafka.scala)&lt;br/&gt;
Caused by: java.lang.ClassNotFoundException: com.yammer.metrics.reporting.CsvReporter&lt;br/&gt;
	at java.net.URLClassLoader$1.run(URLClassLoader.java:202)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at java.net.URLClassLoader.findClass(URLClassLoader.java:190)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:306)&lt;br/&gt;
	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:247)&lt;br/&gt;
	... 8 more&lt;/p&gt;

&lt;p&gt;I am not currently sure what&apos;s causing this issue.&lt;/p&gt;</comment>
                            <comment id="13625609" author="dragosm" created="Mon, 8 Apr 2013 18:05:26 +0000"  >&lt;p&gt;Hmm, it looks like for some reason the metrics JARs didn&apos;t end up on your CLASSPATH.&lt;/p&gt;

&lt;p&gt;Here&apos;s the same patch with one additional update that packages the required libraries into a single jar, kafka-assembly-0.8-SNAPSHOT-deps.jar. This change removes ALL references to ~/.ivy2/cache from the script and requires one additional step: execute the &quot;assembly-package-dependency&quot; sbt task (provided by the sbt-assembly plugin that was already included).&lt;/p&gt;

&lt;p&gt;Here are the steps:&lt;/p&gt;

&lt;p&gt;   rm -rf ~/.ivy2/cache/&lt;br/&gt;
   find . -name target | xargs rm -rf&lt;br/&gt;
   bash sbt update&lt;br/&gt;
   bash sbt package&lt;br/&gt;
   bash sbt assembly-package-dependency # NEW STEP&lt;br/&gt;
   bin/zookeeper-server-start.sh config/zookeeper.properties &lt;br/&gt;
   bin/kafka-server-start.sh config/server.properties&lt;/p&gt;

&lt;p&gt;I verified and the server starts up fine. Please LMK if you run into problems.&lt;/p&gt;

&lt;p&gt;Here&apos;s the output from assembly-package-dependency: &lt;/p&gt;

&lt;p&gt;% bash sbt assembly-package-dependency                                                                                                       &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Loading global plugins from /Users/dragos.manolescu/.sbt/plugins&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Loading project definition from /Users/dragos.manolescu/Repos/kafka/project&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Set current project to Kafka (in build &lt;a href=&quot;file:/Users/dragos.manolescu/Repos/kafka/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/Users/dragos.manolescu/Repos/kafka/&lt;/a&gt;)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including metrics-core-2.2.0.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including scala-compiler.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including zkclient-0.2.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including metrics-annotation-2.2.0.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including snappy-java-1.0.4.1.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including log4j-1.2.15.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including slf4j-api-1.7.2.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including zookeeper-3.3.4.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including jopt-simple-3.2.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including slf4j-simple-1.6.4.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including scala-library.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;warn&amp;#93;&lt;/span&gt; Merging &apos;META-INF/NOTICE&apos; with strategy &apos;rename&apos;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;warn&amp;#93;&lt;/span&gt; Merging &apos;org/xerial/snappy/native/README&apos; with strategy &apos;rename&apos;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;warn&amp;#93;&lt;/span&gt; Merging &apos;META-INF/maven/org.xerial.snappy/snappy-java/LICENSE&apos; with strategy &apos;rename&apos;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;warn&amp;#93;&lt;/span&gt; Merging &apos;LICENSE.txt&apos; with strategy &apos;rename&apos;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;warn&amp;#93;&lt;/span&gt; Merging &apos;META-INF/LICENSE&apos; with strategy &apos;rename&apos;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;warn&amp;#93;&lt;/span&gt; Merging &apos;META-INF/MANIFEST.MF&apos; with strategy &apos;discard&apos;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;warn&amp;#93;&lt;/span&gt; Strategy &apos;discard&apos; was applied to a file&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;warn&amp;#93;&lt;/span&gt; Strategy &apos;rename&apos; was applied to 5 files&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Packaging /Users/dragos.manolescu/Repos/kafka/core/target/scala-2.8.0/kafka-assembly-0.8-SNAPSHOT-deps.jar ...&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Done packaging.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;success&amp;#93;&lt;/span&gt; Total time: 44 s, completed Apr 8, 2013 10:58:33 AM&lt;/p&gt;</comment>
                            <comment id="13626135" author="scott_carey" created="Tue, 9 Apr 2013 02:25:25 +0000"  >&lt;p&gt;Can a committer look at this?  This would be great to get in the 0.8 branch soon and looks good to me. &lt;br/&gt;
I have a cleanup of sbt to significantly simplify it further that I&apos;d like to do as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-854&quot; title=&quot;Upgrade dependencies for 0.8&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-854&quot;&gt;&lt;del&gt;KAFKA-854&lt;/del&gt;&lt;/a&gt; but it will fail to merge with this change.&lt;/p&gt;</comment>
                            <comment id="13626304" author="nikore" created="Tue, 9 Apr 2013 06:42:57 +0000"  >&lt;p&gt;I made my own branch and applyed this patch, in all my testing it seems like its doing great. I would also love to see it committed. &lt;/p&gt;</comment>
                            <comment id="13626374" author="swapnilghike" created="Tue, 9 Apr 2013 08:16:49 +0000"  >&lt;p&gt;Thanks Matt for verifying! This patch works well. Perhaps a committer who is familiar with sbt should take a look. &lt;/p&gt;</comment>
                            <comment id="13627227" author="nehanarkhede" created="Tue, 9 Apr 2013 22:55:55 +0000"  >&lt;p&gt;Thanks a lot for the patches! +1 on the complete patch. In addition to that, I will check in a change that deletes core/lib&lt;/p&gt;</comment>
                            <comment id="13627269" author="dragosm" created="Tue, 9 Apr 2013 23:37:58 +0000"  >&lt;p&gt;You&apos;re welcome; thank you all for verifying independently.&lt;/p&gt;</comment>
                            <comment id="13627302" author="junrao" created="Wed, 10 Apr 2013 00:13:29 +0000"  >&lt;p&gt;Dragos,&lt;/p&gt;

&lt;p&gt;Thanks for the patch. It seems that you merged all dependant jars into a fat jar kafka-assembly-0.8-SNAPSHOT-deps.jar. Is it possible to keep individual jars in target/scala-2.8.0? This way, if people want to release the binary, it&apos;s clear for them what are the dependant jars and their version.&lt;/p&gt;</comment>
                            <comment id="13628350" author="dragosm" created="Wed, 10 Apr 2013 22:13:20 +0000"  >&lt;p&gt;Jun, I understand what you&apos;re after. The sbt-assembly task lists the JARs it packages together when executed:&lt;/p&gt;

&lt;p&gt;&amp;gt; assembly-package-dependency&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including metrics-core-2.2.0.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including metrics-annotation-2.2.0.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including snappy-java-1.0.4.1.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including slf4j-api-1.7.2.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including log4j-1.2.15.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including zkclient-0.2.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including scala-compiler.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including zookeeper-3.3.4.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including slf4j-simple-1.6.4.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including scala-library.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;info&amp;#93;&lt;/span&gt; Including jopt-simple-3.2.jar&lt;/p&gt;

&lt;p&gt;Following the execution of the update task these JARs will be available from the ivy cache (rather than the target folder, which if my understanding is correct holds only artifacts generated while compiling and building).&lt;/p&gt;

&lt;p&gt;I am not aware of a mechanism to have sbt-assembly place the dependencies in the target folder. As plugins like sbt-assembly, sbt-proguard, sbt-onejar and others indicate fat JARs are the typical packaging mechanism for releasing JVM bytecode.&lt;/p&gt;</comment>
                            <comment id="13698935" author="clehene" created="Wed, 3 Jul 2013 13:13:16 +0000"  >&lt;p&gt;Now that metrics 3.0 has been released (&lt;a href=&quot;http://metrics.codahale.com/about/release-notes/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://metrics.codahale.com/about/release-notes/&lt;/a&gt;) perhaps we should consider upgrading it back?&lt;/p&gt;</comment>
                            <comment id="13699172" author="junrao" created="Wed, 3 Jul 2013 16:55:06 +0000"  >&lt;p&gt;Could you file a new jira to track this?&lt;/p&gt;</comment>
                            <comment id="13699191" author="clehene" created="Wed, 3 Jul 2013 17:13:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-960&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-960&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15129290" author="githubbot" created="Tue, 2 Feb 2016 23:09:20 +0000"  >&lt;p&gt;Github user stumped2 closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12523213">KAFKA-133</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12639638">KAFKA-833</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12656072">KAFKA-960</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12577577" name="kafka-fix-for-826-complete.patch" size="15307" author="dragosm" created="Mon, 8 Apr 2013 18:05:26 +0000"/>
                            <attachment id="12576434" name="kafka-fix-for-826-take2.patch" size="9198" author="dragosm" created="Mon, 1 Apr 2013 21:07:52 +0000"/>
                            <attachment id="12576156" name="kafka-fix-for-826.patch" size="9174" author="dragosm" created="Fri, 29 Mar 2013 20:36:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319440</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 41 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1j48n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319781</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>