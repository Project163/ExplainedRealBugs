<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:43:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-19213] Kafka java client ignores default properties</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-19213</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Using Kafka Java client, when creating a kafka consumer/producer using a properties object with defaults the defaults are ignored.&lt;/p&gt;

&lt;p&gt;Not sure if this is an intentional design choice or not but it was a surprise to me.&lt;/p&gt;

&lt;p&gt;My expectation was if a KafkaConsumer or KafkaProducer accepts a Properties object it should not ignore the defaults in the Properties object.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The culprit seems to be in the propsToMap in the Utils class.&lt;/p&gt;

&lt;p&gt;It doesn&apos;t use the propertyNames method to get all the keys known to the Properties object.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; propsToMap(Properties properties) {
    Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; map = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&amp;gt;(properties.size());
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; entry : properties.entrySet()) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (entry.getKey() &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) {
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; k = (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) entry.getKey();
            map.put(k, properties.get(k));
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConfigException(entry.getKey().toString(), entry.getValue(), &lt;span class=&quot;code-quote&quot;&gt;&quot;Key must be a string.&quot;&lt;/span&gt;);
        }
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; map;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I was using version 7.6.0-ccs of the kafka client, on the trunk branch the implementation seems different but is subject to the same issue:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &#160;/**
&#160; &#160; &#160;* Convert a properties to map. All keys in properties must be string type. Otherwise, a ConfigException is thrown.
&#160; &#160; &#160;* @param properties to be converted
&#160; &#160; &#160;* @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; a map including all elements in properties
&#160; &#160; &#160;*/
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; propsToMap(Properties properties) {
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; castToStringObjectMap(properties);
&#160; &#160; }&#160; &#160;

 /**
&#160; &#160; &#160;* Cast a map with arbitrary type keys to be keyed on &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.
&#160; &#160; &#160;* @param inputMap A map with unknown type keys
&#160; &#160; &#160;* @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; A map with the same contents as the input map, but with &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; keys
&#160; &#160; &#160;* @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; ConfigException &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; any key is not a &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;
&#160; &#160; &#160;*/
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; castToStringObjectMap(Map&amp;lt;?, ?&amp;gt; inputMap) {
&#160; &#160; &#160; &#160; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; map = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&amp;gt;(inputMap.size());
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;?, ?&amp;gt; entry : inputMap.entrySet()) {
&#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (entry.getKey() &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; k = (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) entry.getKey();
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; map.put(k, entry.getValue());
&#160; &#160; &#160; &#160; &#160; &#160; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConfigException(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.valueOf(entry.getKey()), entry.getValue(), &lt;span class=&quot;code-quote&quot;&gt;&quot;Key must be a string.&quot;&lt;/span&gt;);
&#160; &#160; &#160; &#160; &#160; &#160; }
&#160; &#160; &#160; &#160; }
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; map;
&#160; &#160; }&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;A possible suggestion for how to fix the behavior:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; propsToMap(Properties properties) {
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Enumeration&amp;lt;?&amp;gt; enumeration = properties.propertyNames();

    Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; props = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&amp;gt;();
    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (enumeration.hasMoreElements()) {
        &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; key = enumeration.nextElement();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (key &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; keyString = (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) key;
            props.put(keyString,properties.getProperty(keyString));
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConfigException(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.valueOf(key),properties.get(key), &lt;span class=&quot;code-quote&quot;&gt;&quot;Key must be a string.&quot;&lt;/span&gt;);
        }
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; props;
}
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Provided a basic test case to demonstrate the issue. See file attachment.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13616707">KAFKA-19213</key>
            <summary>Kafka java client ignores default properties</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ezhou">Evan Zhou</assignee>
                                    <reporter username="pasfilip">Pas Filip</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Apr 2025 15:03:08 +0000</created>
                <updated>Tue, 22 Jul 2025 18:17:04 +0000</updated>
                            <resolved>Tue, 22 Jul 2025 18:17:04 +0000</resolved>
                                    <version>2.0.0</version>
                    <version>3.0.0</version>
                    <version>4.0.0</version>
                                    <fixVersion>4.2.0</fixVersion>
                                    <component>clients</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                        <attachments>
                            <attachment id="13076322" name="TestMapCreationFromPropertiesUsingDefaults.java" size="2884" author="pasfilip" created="Tue, 29 Apr 2025 15:01:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>java</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            28 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1vlzk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>