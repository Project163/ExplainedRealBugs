<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:35:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-15465] MM2 not working when its internal topics are pre-created on a cluster that disallows topic creation</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-15465</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;h1&gt;&lt;a name=&quot;Replicationsteps&quot;&gt;&lt;/a&gt;Replication steps&lt;/h1&gt;
&lt;ul&gt;
	&lt;li&gt;Setup a source kafka cluster (alias SOURCE) which doesn&apos;t allow topic creation to MM2 (therefore it doesn&apos;t allow the creation of internal topics)&lt;/li&gt;
	&lt;li&gt;Create MM2 internal topics in the source kafka cluster&lt;/li&gt;
	&lt;li&gt;Setup a target kafka cluster (alias TARGET)&lt;/li&gt;
	&lt;li&gt;Enable one way replication SOURCE-&amp;gt;TARGET&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;MM2 will attempt to create or find its internal topics on the source cluster but it will fail with the following stack trace&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{&lt;span class=&quot;code-quote&quot;&gt;&quot;log_timestamp&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;2023-09-13T09:39:25.612+0000&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;log_level&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;ERROR&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;process_id&quot;&lt;/span&gt;: 1, &lt;span class=&quot;code-quote&quot;&gt;&quot;process_name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;mirror-maker&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;thread_id&quot;&lt;/span&gt;: 1, &lt;span class=&quot;code-quote&quot;&gt;&quot;thread_name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;Scheduler &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; MirrorSourceConnector-creating upstream offset-syncs topic&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;action_name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.kafka.connect.mirror.Scheduler&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;log_message&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;Scheduler &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; MirrorSourceConnector caught exception in scheduled task: creating upstream offset-syncs topic&quot;&lt;/span&gt;}
org.apache.kafka.connect.errors.ConnectException: Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; attempting to create/find topic &lt;span class=&quot;code-quote&quot;&gt;&apos;mm2-offset-syncs.TARGET.internal&apos;&lt;/span&gt;
	at org.apache.kafka.connect.mirror.MirrorUtils.createCompactedTopic(MirrorUtils.java:155)
	at org.apache.kafka.connect.mirror.MirrorUtils.createSinglePartitionCompactedTopic(MirrorUtils.java:161)
	at org.apache.kafka.connect.mirror.MirrorSourceConnector.createOffsetSyncsTopic(MirrorSourceConnector.java:328)
	at org.apache.kafka.connect.mirror.Scheduler.run(Scheduler.java:93)
	at org.apache.kafka.connect.mirror.Scheduler.executeThread(Scheduler.java:112)
	at org.apache.kafka.connect.mirror.Scheduler.lambda$execute$2(Scheduler.java:63)
[...]
Caused by: java.util.concurrent.ExecutionException: org.apache.kafka.common.errors.TopicAuthorizationException: Authorization failed.
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:395)
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1999)
	at org.apache.kafka.common.internals.KafkaFutureImpl.get(KafkaFutureImpl.java:165)
	at org.apache.kafka.connect.mirror.MirrorUtils.createCompactedTopic(MirrorUtils.java:124)
	... 11 more
Caused by: org.apache.kafka.common.errors.TopicAuthorizationException: Authorization failed. &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;
&lt;h1&gt;&lt;a name=&quot;Rootcauseanalysis&quot;&gt;&lt;/a&gt;Root cause analysis&lt;/h1&gt;

&lt;p&gt;The changes introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-13401&quot; title=&quot;Introduce a new Interface to manage Kafka resources in MM2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-13401&quot;&gt;&lt;del&gt;KAFKA-13401&lt;/del&gt;&lt;/a&gt; in &lt;a href=&quot;https://github.com/apache/kafka/pull/12577/files#diff-fa8f595307a4ade20cc22253a7721828e3b55c96f778e9c4842c978801e0a1a4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;MirrorUtils&lt;/tt&gt;&lt;/a&gt; are supposed to follow the same logic as &lt;a href=&quot;https://github.com/apache/kafka/blob/a7e865c0a756504cc7ae6f4eb0772cadd3333c53/connect/runtime/src/main/java/org/apache/kafka/connect/util/TopicAdmin.java#L423&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;TopicAdmin&lt;/tt&gt;&lt;/a&gt; according to the contributor&apos;s &lt;a href=&quot;https://github.com/apache/kafka/pull/12577#discussion_r991566108&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;comment&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;TopicAdmin.createOrFindTopics(...)&lt;/tt&gt; and &lt;tt&gt;MirrorUtils.createCompactedTopic(...)&lt;/tt&gt; aren&apos;t aligned in terms of allowed exceptions&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Exception&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;TopicAdmin&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;MirrorUtils&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;TopicExistsException&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;OK&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;OK&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;UnsupportedVersionException&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;OK&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;em&gt;KO&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;ClusterAuthorizationException&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;OK&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;em&gt;KO&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;TopicAuthorizationException&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;OK&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;em&gt;KO&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13550585">KAFKA-15465</key>
            <summary>MM2 not working when its internal topics are pre-created on a cluster that disallows topic creation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="omnia_h_ibrahim">Omnia Ibrahim</assignee>
                                    <reporter username="ahibot">Ahmed HIBOT</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Sep 2023 20:12:11 +0000</created>
                <updated>Fri, 13 Oct 2023 10:53:52 +0000</updated>
                            <resolved>Fri, 13 Oct 2023 10:53:52 +0000</resolved>
                                    <version>3.4.1</version>
                                    <fixVersion>3.7.0</fixVersion>
                                    <component>mirrormaker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17764867" author="JIRAUSER302211" created="Wed, 13 Sep 2023 20:26:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=omnia_h_ibrahim&quot; class=&quot;user-hover&quot; rel=&quot;omnia_h_ibrahim&quot;&gt;omnia_h_ibrahim&lt;/a&gt;, Can you please take a look and confirm my findings. Also, I will be happy to provide the fix but I can&apos;t assign myself to the bug.&lt;/p&gt;</comment>
                            <comment id="17765099" author="omnia_h_ibrahim" created="Thu, 14 Sep 2023 10:50:10 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ahibot&quot; class=&quot;user-hover&quot; rel=&quot;ahibot&quot;&gt;ahibot&lt;/a&gt; ,&lt;/p&gt;

&lt;p&gt;I re-checked the code of TopicAdmin.createOrFindTopics and we missed a few returns. I&apos;m raising a pr for this shortly. Thanks for reporting this.&lt;/p&gt;</comment>
                            <comment id="17765240" author="satish.duggana" created="Thu, 14 Sep 2023 15:48:45 +0000"  >&lt;p&gt;Moving it to 3.7.0 as 3.6.0 code freeze is over.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13408276">KAFKA-13401</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>Java</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 8 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1kcd4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>