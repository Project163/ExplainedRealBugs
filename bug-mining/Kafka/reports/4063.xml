<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:41:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-17623] Flaky testSeekPositionAndPauseNewlyAssignedPartitionOnPartitionsAssignedCallback</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-17623</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Flaky for the new consumer, failing with :&lt;/p&gt;

&lt;p&gt;org.apache.kafka.common.KafkaException: User rebalance callback throws an error at app//org.apache.kafka.clients.consumer.internals.ConsumerUtils.maybeWrapAsKafkaException(ConsumerUtils.java:259) at app//org.apache.kafka.clients.consumer.internals.AsyncKafkaConsumer.invokeRebalanceCallbacks(AsyncKafkaConsumer.java:1867) at app//org.apache.kafka.clients.consumer.internals.AsyncKafkaConsumer$BackgroundEventProcessor.process(AsyncKafkaConsumer.java:195) at app//org.apache.kafka.clients.consumer.internals.AsyncKafkaConsumer$BackgroundEventProcessor.process(AsyncKafkaConsumer.java:181) at app//org.apache.kafka.clients.consumer.internals.AsyncKafkaConsumer.processBackgroundEvents(AsyncKafkaConsumer.java:1758) at app//org.apache.kafka.clients.consumer.internals.AsyncKafkaConsumer.updateAssignmentMetadataIfNeeded(AsyncKafkaConsumer.java:1618)&lt;/p&gt;

&lt;p&gt;...&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.IllegalStateException: No current assignment for partition topic-0 at org.apache.kafka.clients.consumer.internals.SubscriptionState.assignedState(SubscriptionState.java:378) at org.apache.kafka.clients.consumer.internals.SubscriptionState.seekUnvalidated(SubscriptionState.java:395) at org.apache.kafka.clients.consumer.internals.events.ApplicationEventProcessor.process(ApplicationEventProcessor.java:425) at org.apache.kafka.clients.consumer.internals.events.ApplicationEventProcessor.process(ApplicationEventProcessor.java:147) at org.apache.kafka.clients.consumer.internals.ConsumerNetworkThread.processApplicationEvents(ConsumerNetworkThread.java:171)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Flaky behaviour:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://ge.apache.org/scans/tests?search.buildOutcome=failure&amp;amp;search.names=Git%20branch&amp;amp;search.rootProjectNames=kafka&amp;amp;search.startTimeMax=1727409599999&amp;amp;search.startTimeMin=1722484800000&amp;amp;search.timeZoneId=America%2FToronto&amp;amp;search.values=trunk&amp;amp;tests.container=integration.kafka.api.PlaintextConsumerCallbackTest&amp;amp;tests.test=testSeekPositionAndPauseNewlyAssignedPartitionOnPartitionsAssignedCallback(String%2C%20String)%5B3%5D&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ge.apache.org/scans/tests?search.buildOutcome=failure&amp;amp;search.names=Git%20branch&amp;amp;search.rootProjectNames=kafka&amp;amp;search.startTimeMax=1727409599999&amp;amp;search.startTimeMin=1722484800000&amp;amp;search.timeZoneId=America%2FToronto&amp;amp;search.values=trunk&amp;amp;tests.container=integration.kafka.api.PlaintextConsumerCallbackTest&amp;amp;tests.test=testSeekPositionAndPauseNewlyAssignedPartitionOnPartitionsAssignedCallback(String%2C%20String)%5B3%5D&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13593392">KAFKA-17623</key>
            <summary>Flaky testSeekPositionAndPauseNewlyAssignedPartitionOnPartitionsAssignedCallback</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kirktrue">Kirk True</assignee>
                                    <reporter username="lianetm">Lianet Magrans</reporter>
                        <labels>
                            <label>consumer-threading-refactor</label>
                            <label>flaky-test</label>
                            <label>integration-test</label>
                    </labels>
                <created>Thu, 26 Sep 2024 14:27:52 +0000</created>
                <updated>Thu, 16 Jan 2025 21:27:25 +0000</updated>
                            <resolved>Thu, 16 Jan 2025 21:03:26 +0000</resolved>
                                                    <fixVersion>4.0.0</fixVersion>
                                    <component>clients</component>
                    <component>consumer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17885047" author="JIRAUSER300229" created="Thu, 26 Sep 2024 14:38:05 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lianetm&quot; class=&quot;user-hover&quot; rel=&quot;lianetm&quot;&gt;lianetm&lt;/a&gt;, may I take this? Thank you.&lt;/p&gt;</comment>
                            <comment id="17885049" author="JIRAUSER300183" created="Thu, 26 Sep 2024 14:41:26 +0000"  >&lt;p&gt;Sure, thanks!&lt;/p&gt;</comment>
                            <comment id="17907941" author="kirktrue" created="Mon, 23 Dec 2024 19:24:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yangpoan&quot; class=&quot;user-hover&quot; rel=&quot;yangpoan&quot;&gt;yangpoan&lt;/a&gt;&#8212;checking in on this ticket. Is this something you&apos;re actively working on?&lt;/p&gt;</comment>
                            <comment id="17912068" author="kirktrue" created="Fri, 10 Jan 2025 18:06:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yangpoan&quot; class=&quot;user-hover&quot; rel=&quot;yangpoan&quot;&gt;yangpoan&lt;/a&gt;&#8212;do you mind if I take this ticket? Thanks!&lt;/p&gt;</comment>
                            <comment id="17912158" author="JIRAUSER300229" created="Sat, 11 Jan 2025 01:03:51 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kirktrue&quot; class=&quot;user-hover&quot; rel=&quot;kirktrue&quot;&gt;kirktrue&lt;/a&gt;, sorry for late and block the progress. Yes, feel free to take it. Thanks.&lt;/p&gt;</comment>
                            <comment id="17912660" author="kirktrue" created="Mon, 13 Jan 2025 20:29:32 +0000"  >&lt;p&gt;No worries &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yangpoan&quot; class=&quot;user-hover&quot; rel=&quot;yangpoan&quot;&gt;yangpoan&lt;/a&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Thanks!&lt;/p&gt;</comment>
                            <comment id="17912680" author="kirktrue" created="Tue, 14 Jan 2025 00:20:44 +0000"  >&lt;p&gt;The test creates a &lt;tt&gt;Consumer&lt;/tt&gt; that subscribes to a topic named &lt;tt&gt;topic&lt;/tt&gt; with two partitions. In the common case, &lt;tt&gt;onPartitionsAssigned()&lt;/tt&gt; is invoked once by the consumer with a list that contains both partitions:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;topic-0, topic-1&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;However, in rare cases, &lt;tt&gt;onPartitionsAssigned()&lt;/tt&gt; is invoked with a list that contains a single topic succession:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;topic-1&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;or&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;topic-0&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In these cases, the &lt;tt&gt;onPartitionsAssigned()&lt;/tt&gt; will be invoked twice, but the ordering of the partitions in those invocations is (or at least should be) considered non-deterministic. The test assumes that the consumer is assigned &lt;em&gt;both&lt;/em&gt; test partitions at the same time, but in the rare case the rebalance callback receives a call with just&#160;&lt;tt&gt;topic-1&lt;/tt&gt;. What that happens, because the test invokes various &lt;tt&gt;Consumer&lt;/tt&gt; APIs with the &lt;tt&gt;topic-0&lt;/tt&gt; partition, an error is thrown because that partition is not (yet) assigned.&lt;/p&gt;</comment>
                            <comment id="17913860" author="JIRAUSER300183" created="Thu, 16 Jan 2025 21:27:25 +0000"  >&lt;p&gt;Merged to trunk, and cherry-picked to 4.0 to close the blocker &lt;a href=&quot;https://github.com/apache/kafka/commit/807bc48a6c52d52b6597c7b50d652549c28cea56&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/commit/807bc48a6c52d52b6597c7b50d652549c28cea56&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1rn0g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>lianetm</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>