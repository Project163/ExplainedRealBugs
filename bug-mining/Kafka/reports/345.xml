<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:39:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-1078] Update System Test to handle controller data returned by ZK</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-1078</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;There is a change in the result returned by ZK when querying for controller:&lt;/p&gt;

&lt;p&gt;2013-10-07 09:39:15,599 - DEBUG - executing command &lt;span class=&quot;error&quot;&gt;&amp;#91;ssh localhost &amp;quot;JAVA_HOME=/export/apps/jdk/JDK-1_6_0_27 /home/user/kafka/bin/kafka-run-class.sh org.apache.zookeeper.ZooKeeperMain -server localhost:2188 get /controller 2&amp;gt; /dev/null | tail -1&amp;quot;&amp;#93;&lt;/span&gt; (kafka_system_test_utils)&lt;/p&gt;

&lt;p&gt;1. Previously it returned : 1&lt;br/&gt;
2. It is currently returning : &lt;/p&gt;
{ &quot;brokerid&quot;:1, &quot;timestamp&quot;:&quot;1381163914835&quot;, &quot;version&quot;:1 }

&lt;p&gt;The impact is that System Test doesn&apos;t have the correct entity ID for bouncing controller. There are a few test cases that are impacted by this change when they are bouncing the controller.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12672839">KAFKA-1078</key>
            <summary>Update System Test to handle controller data returned by ZK</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jfung">John Fung</assignee>
                                    <reporter username="jfung">John Fung</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Oct 2013 16:11:11 +0000</created>
                <updated>Tue, 8 Oct 2013 16:27:43 +0000</updated>
                            <resolved>Tue, 8 Oct 2013 16:23:06 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13789344" author="jfung" created="Tue, 8 Oct 2013 16:18:32 +0000"  >&lt;p&gt;Updated kafka_system_test_utils.get_controller_attributes to read the json data of controller.&lt;/p&gt;</comment>
                            <comment id="13789346" author="junrao" created="Tue, 8 Oct 2013 16:23:06 +0000"  >&lt;p&gt;Thanks for the patch. Committed to 0.8.&lt;/p&gt;</comment>
                            <comment id="13789350" author="jfung" created="Tue, 8 Oct 2013 16:27:04 +0000"  >&lt;p&gt;1. Before the patch (no controller entity id found and system test throws exception)&lt;/p&gt;

&lt;p&gt;2013-10-04 01:04:38,070 - INFO - ======================================================&lt;br/&gt;
2013-10-04 01:04:38,070 - INFO - Found controller with entity id: &lt;br/&gt;
2013-10-04 01:04:38,070 - INFO - ======================================================&lt;/p&gt;

&lt;p&gt;2013-10-04 01:04:38,070 - INFO - ======================================================&lt;br/&gt;
2013-10-04 01:04:38,070 - INFO - stopping controller : &lt;/p&gt;
{ &quot;brokerid&quot;:1, &quot;timestamp&quot;:&quot;1380873836165&quot;, &quot;version&quot;:1 }
&lt;p&gt;2013-10-04 01:04:38,070 - INFO - ======================================================&lt;/p&gt;

&lt;p&gt;2013-10-04 01:04:38,071 - INFO - ======================================================&lt;br/&gt;
2013-10-04 01:04:38,071 - INFO - Exception while running test &apos;&apos;&lt;br/&gt;
2013-10-04 01:04:38,071 - INFO - ======================================================&lt;br/&gt;
Traceback (most recent call last):&lt;br/&gt;
  File &quot;/home/user/kafka/system_test/replication_testsuite/replica_basic_test.py&quot;, line 301, in runTest&lt;br/&gt;
    kafka_system_test_utils.stop_remote_entity(self.systemTestEnv, controllerDict&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;entity_id&amp;quot;&amp;#93;&lt;/span&gt;, self.testcaseEnv.entityBrokerParentPidDict[controllerDict&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;entity_id&amp;quot;&amp;#93;&lt;/span&gt;])&lt;br/&gt;
KeyError: &apos;&apos;&lt;/p&gt;


&lt;p&gt;2. After the patch (controller entity id found)&lt;/p&gt;

&lt;p&gt;2013-10-07 16:30:48,122 - INFO - ======================================================&lt;br/&gt;
2013-10-07 16:30:48,122 - INFO - Found controller with entity id: 1&lt;br/&gt;
2013-10-07 16:30:48,122 - INFO - ======================================================&lt;/p&gt;

&lt;p&gt;2013-10-07 16:30:48,123 - INFO - ======================================================&lt;br/&gt;
2013-10-07 16:30:48,123 - INFO - stopping controller : 1&lt;br/&gt;
2013-10-07 16:30:48,123 - INFO - ======================================================&lt;br/&gt;
2013-10-07 16:30:48,123 - DEBUG - executing command [ssh localhost &apos;pid=26805; prev_pid=&quot;&quot;; echo $pid; while [[ &quot;x$pid&quot; != &quot;x&quot; ]]; do prev_pid=$pid;   for child in $(ps -o pid,ppid a&lt;br/&gt;
x | awk &quot;{ if ( \$2 == $pid ) { print \$1 }}&quot;);     do echo $child; pid=$child;   done;   if [ $prev_pid == $pid ]; then     break;   fi; done&apos; 2&amp;gt; /dev/null (system_test_utils)&lt;br/&gt;
2013-10-07 16:30:48,477 - DEBUG - terminating (SIGTERM) process id: 26805 in host: localhost (kafka_system_test_utils)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12607376" name="kafka-1078.patch" size="1317" author="jfung" created="Tue, 8 Oct 2013 16:18:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>352462</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 7 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1oro7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>352749</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>