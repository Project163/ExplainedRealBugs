<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:40:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-17515] Fix flaky RestoreIntegrationTest.shouldInvokeUserDefinedGlobalStateRestoreListener</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-17515</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Stacktrace
java.nio.file.DirectoryNotEmptyException: /tmp/shouldInvokeUserDefinedGlobalStateRestoreListenerH0u0n9foRY_peZu4FqeGHQ10111145955704739924-ks1/shouldInvokeUserDefinedGlobalStateRestoreListenerH0u0n9foRY_peZu4FqeGHQ/0_0
	at java.base/sun.nio.fs.UnixFileSystemProvider.implDelete(UnixFileSystemProvider.java:289)
	at java.base/sun.nio.fs.AbstractFileSystemProvider.deleteIfExists(AbstractFileSystemProvider.java:109)
	at java.base/java.nio.file.Files.deleteIfExists(Files.java:1191)
	at org.apache.kafka.common.utils.Utils$1.postVisitDirectory(Utils.java:898)
	at org.apache.kafka.common.utils.Utils$1.postVisitDirectory(Utils.java:870)
	at java.base/java.nio.file.Files.walkFileTree(Files.java:2803)
	at java.base/java.nio.file.Files.walkFileTree(Files.java:2857)
	at org.apache.kafka.common.utils.Utils.delete(Utils.java:870)
	at org.apache.kafka.streams.integration.utils.IntegrationTestUtils.purgeLocalStreamsState(IntegrationTestUtils.java:266)
	at org.apache.kafka.streams.integration.utils.IntegrationTestUtils.purgeLocalStreamsState(IntegrationTestUtils.java:278)
	at org.apache.kafka.streams.integration.RestoreIntegrationTest.shouldInvokeUserDefinedGlobalStateRestoreListener(RestoreIntegrationTest.java:583)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13591666">KAFKA-17515</key>
            <summary>Fix flaky RestoreIntegrationTest.shouldInvokeUserDefinedGlobalStateRestoreListener</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Yu-Lin Chen">Yu-Lin Chen</assignee>
                                    <reporter username="chia7712">Chia-Ping Tsai</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Sep 2024 15:33:57 +0000</created>
                <updated>Sun, 29 Sep 2024 04:22:18 +0000</updated>
                            <resolved>Thu, 26 Sep 2024 04:23:47 +0000</resolved>
                                                    <fixVersion>4.0.0</fixVersion>
                                    <component>streams</component>
                    <component>unit tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17881175" author="yu-lin chen" created="Thu, 12 Sep 2024 05:40:22 +0000"  >&lt;p&gt;I found two issues in the flaky tests:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;The local state is purged imediately after kafkaStreams.close() timeout (Current timeout = 5 sec). But the asynchronize close thread still trigger RocksDBStore.flush() to write to local state dir. This is the root cause of the &lt;a href=&quot;https://ge.apache.org/s/havqcr7zu2tbk/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?expanded-stacktrace=WyIwIl0&amp;amp;page=eyJvdXRwdXQiOnsiMCI6MSwiMSI6Mn19&amp;amp;top-execution=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;flaky test&lt;/a&gt; that occured on Sep 10 2024 16:55:51 CST. (&lt;a href=&quot;https://github.com/apache/kafka/blob/a1f28570afb9499fb0cdb9b2928afb50a8a489ff/streams/src/test/java/org/apache/kafka/streams/integration/RestoreIntegrationTest.java#L582-L583&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Code Link&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;Some partition tasks assigned to first kafkaStream(ks-1), are reassigned to second KafkaStream(ks-2) after rebalancing. However, the reassigned tasks are not started in ks-1 yet, so it&#8217;s won&#8217;t enter the suspend state. This is the root cause of the &lt;a href=&quot;https://ge.apache.org/s/hdpapdbvngcts/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?top-execution=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;flak test&lt;/a&gt; that occured on Sep 10 2024 11:44:34 CST. (&lt;a href=&quot;https://github.com/apache/kafka/blob/a1f28570afb9499fb0cdb9b2928afb50a8a489ff/streams/src/test/java/org/apache/kafka/streams/integration/RestoreIntegrationTest.java#L604&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Code Link&lt;/a&gt;)&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&#160;&lt;br/&gt;
Analysis result of flaky logs: (TL;DR; )&lt;/p&gt;

&lt;p&gt;For flaky #1, log shows:&lt;br/&gt;
2024-09-10 04:35:&lt;b&gt;14,227&lt;/b&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;ks1-StreamThread-1&amp;#93;&lt;/span&gt; Informed to shut down&lt;br/&gt;
2024-09-10 04:35:&lt;b&gt;19,349&lt;/b&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;ks1-StreamThread-1&amp;#93;&lt;/span&gt; Shutdown completed&lt;br/&gt;
-&amp;gt; It took 5.022 secs&lt;br/&gt;
-&amp;gt; the retry test took 2.429 secs&lt;br/&gt;
-&amp;gt; My local env took 0.2 secs&lt;/p&gt;

&lt;p&gt;For the failed flaky test #2,&lt;br/&gt;
Below is the time flow of the second flaky test:&lt;br/&gt;
time 1: ks-1 (Assigned 0_0, 0_1, 0_2, 0_3, 0_4)&lt;br/&gt;
time 2: ks-1 (0_4 restore started)&lt;br/&gt;
time 3: ks-1 (0_2 restore started)&lt;br/&gt;
time 4: ks-1 (0_0 restore started)&lt;br/&gt;
time 5: ks-2 (After rebalancing, assigned 0_1, 0_3), those test haven&apos;t started on ks-1&lt;br/&gt;
time 6: ks-2 (0_1 restore started)&lt;br/&gt;
time 7: ks-2 (0_3 restore started)&lt;/p&gt;

&lt;p&gt;In this case: `kafkaStreams1StateRestoreListener.awaitUntilRestorationSuspends()` will never be true since no &quot;Suspended from RUNNING&quot; for task 0_1 and 0_3 in ks-1.&lt;/p&gt;

&lt;p&gt;Compare to the log of sucessful run in flaky #2&lt;/p&gt;

&lt;p&gt;time 1: ks-1 (Assigned 0_0, 0_1, 0_2, 0_3, 0_4)&lt;br/&gt;
time 2: ks-1 (0_1 restore started)&lt;br/&gt;
time 3: ks-1 (0_3 restore started)&lt;br/&gt;
time 4: ks-1 (0_4 restore started)&lt;br/&gt;
time 5: ks-1 (0_2 restore started)&lt;br/&gt;
time 6: ks-1 (0_0 restore started)&lt;br/&gt;
time 7: ks-2 (After rebalancing, assigned 0_0, 0_2, 0_4)&lt;br/&gt;
time 8: ks-1 (task 0_4 suspended from RESTORING)&#160;&lt;br/&gt;
time 9: ks-1 (task 0_2 suspended from RESTORING)&lt;br/&gt;
time 10: ks-1 (task 0_0 suspended from RESTORING)&lt;br/&gt;
time 11: ks-2 (0_4 restore started)&lt;br/&gt;
time 12: ks-2 (0_2 restore started)&lt;br/&gt;
time 13: ks-2 (0_0 restore started)&lt;/p&gt;

&lt;p&gt;kafkaStreams1StateRestoreListener.awaitUntilRestorationSuspends() passed at time 8.&#160;&lt;br/&gt;
kafkaStreams2StateRestoreListener.awaitUntilRestorationStarts() passed at time 11.&lt;br/&gt;
&#160;&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chia7712&quot; class=&quot;user-hover&quot; rel=&quot;chia7712&quot;&gt;chia7712&lt;/a&gt; If you&apos;re not workign on this, I could submit a PR to fix the known issue.&lt;/p&gt;</comment>
                            <comment id="17881177" author="yu-lin chen" created="Thu, 12 Sep 2024 06:01:45 +0000"  >&lt;p&gt;Another trivial finding regarding the flaky tests, both tests are timeout, but the CI shows different failure reasons. This is because:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;If local state dir was purged before RocksDBStore.flush(), the test will failed directly.&#160; (&lt;a href=&quot;https://ge.apache.org/s/havqcr7zu2tbk/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?expanded-stacktrace=WyIwIl0&amp;amp;focused-execution=1&amp;amp;page=eyJvdXRwdXQiOnsiMCI6MSwiMSI6Mn19&amp;amp;top-execution=2#L177&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;The first flaky link&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;If local state dir was purged before writing OffsetCheckpoint, the test only throw warning in logs, the CI will keep running. (&lt;a href=&quot;https://ge.apache.org/s/hdpapdbvngcts/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?focused-execution=1&amp;amp;top-execution=2#L196&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;The second flaky link&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;m not sure whether the timeout indirectly caused the slowly start of ks-1 tasks in flaky test #2.&#160; But we can fix the known issue first.&lt;/p&gt;</comment>
                            <comment id="17881477" author="yu-lin chen" created="Fri, 13 Sep 2024 06:46:10 +0000"  >&lt;p&gt;Assigned it to myself, will submit a PR ASAP.&lt;/p&gt;</comment>
                            <comment id="17881675" author="yu-lin chen" created="Fri, 13 Sep 2024 19:35:30 +0000"  >&lt;p&gt;The same &quot;java.nio.file.DirectoryNotEmptyException&quot; error can be reproduced in my local environment if I adjust the timeout from 5000 ms to 100ms. (&lt;a href=&quot;https://github.com/apache/kafka/blob/d95e384146e67e475b2e0638f70d6f4a708a01dc/streams/src/test/java/org/apache/kafka/streams/integration/RestoreIntegrationTest.java#L582-L583&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Code Link&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;By shortening the timeout, I can force the flush() of kafkaStreams.close() and purgeLocalStreamsState() to be triggered in the same time. Attached the screenshot.&lt;/p&gt;

&lt;p&gt;Extend the timeout from 5 sec to 60 sec in the PR since the CI env is quite unstable and slow.&lt;/p&gt;</comment>
                            <comment id="17881679" author="chia7712" created="Fri, 13 Sep 2024 19:52:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Yu-Lin+Chen&quot; class=&quot;user-hover&quot; rel=&quot;Yu-Lin Chen&quot;&gt;Yu-Lin Chen&lt;/a&gt; thanks for all sharing. Could you please update the description of PR? &lt;/p&gt;</comment>
                            <comment id="17881684" author="yu-lin chen" created="Fri, 13 Sep 2024 20:09:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chia7712&quot; class=&quot;user-hover&quot; rel=&quot;chia7712&quot;&gt;chia7712&lt;/a&gt; Just updated the description of PR. Please let me know if I miss something.&lt;/p&gt;

&lt;p&gt;And I just found that there was another flaky run of this test yesterday. (&lt;a href=&quot;https://ge.apache.org/s/kzmyf3c3jo7fo/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?top-execution=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;flaky link&lt;/a&gt;)&lt;br/&gt;
I might need more time to dig into this.&lt;/p&gt;</comment>
                            <comment id="17882672" author="yu-lin chen" created="Wed, 18 Sep 2024 11:03:19 +0000"  >&lt;p&gt;The another flaky was caused by long initialization of stream tasks. It took longer than 60 secs so no record was processed.&#160; (&lt;a href=&quot;https://ge.apache.org/s/kzmyf3c3jo7fo/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?top-execution=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;flaky link&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.opentest4j.AssertionFailedError: Condition not met within timeout 60000. Did not receive all [KeyValue(0, 0), KeyValue(1, 1), KeyValue(2, 2), KeyValue(3, 3), KeyValue(4, 4), KeyValue(5, 5), KeyValue(6, 6), KeyValue(7, 7), KeyValue(8, 8), KeyValue(9, 9), KeyValue(10, 10), KeyValue(11, 11), KeyValue(12, 12), KeyValue(13, 13), KeyValue(14, 14), KeyValue(15, 15), KeyValue(16, 16), KeyValue(17, 17), KeyValue(18, 18), KeyValue(19, 19), KeyValue(20, 20), KeyValue(21, 21), KeyValue(22, 22), KeyValue(23, 23), KeyValue(24, 24), KeyValue(25, 25), KeyValue(26, 26), KeyValue(27, 27), KeyValue(28, 28), KeyValue(29, 29), KeyValue(30, 30), KeyValue(31, 31), KeyValue(32, 32), KeyValue(33, 33), KeyValue(34, 34), KeyValue(35, 35), KeyValue(36, 36), KeyValue(37, 37), KeyValue(38, 38), KeyValue(39, 39), KeyValue(40, 40), KeyValue(41, 41), KeyValue(42, 42), KeyValue(43, 43), KeyValue(44, 44), KeyValue(45, 45), KeyValue(46, 46), KeyValue(47, 47), KeyValue(48, 48), KeyValue(49, 49), KeyValue(50, 50), KeyValue(51, 51), KeyValue(52, 52), KeyValue(53, 53), KeyValue(54, 54), KeyValue(55, 55), KeyValue(56, 56), KeyValue(57, 57), KeyValue(58, 58), KeyValue(59, 59), KeyValue(60, 60), KeyValue(61, 61), KeyValue(62, 62), KeyValue(63, 63), KeyValue(64, 64), KeyValue(65, 65), KeyValue(66, 66), KeyValue(67, 67), KeyValue(68, 68), KeyValue(69, 69), KeyValue(70, 70), KeyValue(71, 71), KeyValue(72, 72), KeyValue(73, 73), KeyValue(74, 74), KeyValue(75, 75), KeyValue(76, 76), KeyValue(77, 77), KeyValue(78, 78), KeyValue(79, 79), KeyValue(80, 80), KeyValue(81, 81), KeyValue(82, 82), KeyValue(83, 83), KeyValue(84, 84), KeyValue(85, 85), KeyValue(86, 86), KeyValue(87, 87), KeyValue(88, 88), KeyValue(89, 89), KeyValue(90, 90), KeyValue(91, 91), KeyValue(92, 92), KeyValue(93, 93), KeyValue(94, 94), KeyValue(95, 95), KeyValue(96, 96), KeyValue(97, 97), KeyValue(98, 98), KeyValue(99, 99)] records from topic outputTopic (got []) ==&amp;gt; expected: &amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;gt; but was: &amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Logs:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[2024-09-12 18:50:29,644] INFO ... ks1-StreamThread-1] State transition from CREATED to STARTING
[2024-09-12 18:50:38,263] INFO ... ks1-StreamThread-1] State transition from STARTING to PARTITIONS_ASSIGNED
[2024-09-12 18:50:48,813] INFO ... ks1-StreamThread-1] task [0_3] Initialized (org.apache.kafka.streams.processor.internals.StreamTask:277)
[2024-09-12 18:51:02,038] INFO ... ks1-StreamThread-1] task [0_0] Initialized (org.apache.kafka.streams.processor.internals.StreamTask:277)
[2024-09-12 18:51:14,316] INFO ... ks1-StreamThread-1] task [0_4] Initialized (org.apache.kafka.streams.processor.internals.StreamTask:277)
[2024-09-12 18:51:25,080] INFO ... ks1-StreamThread-1] task [0_1] Initialized (org.apache.kafka.streams.processor.internals.StreamTask:277)
[2024-09-12 18:51:37,862] INFO ... ks1-StreamThread-1] task [0_2] Initialized (org.apache.kafka.streams.processor.internals.StreamTask:277) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In the flaky test run, each step of stream task initialization took the following amount of time:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;8.619 sec for rebalancing&lt;/li&gt;
	&lt;li&gt;10.550 sec for initializing task &lt;span class=&quot;error&quot;&gt;&amp;#91;0_3&amp;#93;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;13.225 sec for initializing task &lt;span class=&quot;error&quot;&gt;&amp;#91;0_0&amp;#93;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;12.278 sec for initializing task &lt;span class=&quot;error&quot;&gt;&amp;#91;0_4&amp;#93;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;10.764 sec for initializing task &lt;span class=&quot;error&quot;&gt;&amp;#91;0_1&amp;#93;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;12.782 sec for initializing task &lt;span class=&quot;error&quot;&gt;&amp;#91;0_2&amp;#93;&lt;/span&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;It took longer than 60 seconds. But in most of the time, it can be done less than 10 secs.&lt;/p&gt;

&lt;p&gt;The followings are the total tasks initialization time in other flaky test:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Failed Execution (&lt;a href=&quot;https://ge.apache.org/s/kzmyf3c3jo7fo/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?top-execution=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Link&lt;/a&gt;):&#160; 68.218 sec (Started Sep 13 2024 at 02:50:08 CST)&lt;/li&gt;
	&lt;li&gt;Successed Execution (&lt;a href=&quot;https://ge.apache.org/s/kzmyf3c3jo7fo/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?top-execution=2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Link&lt;/a&gt;) 6.718 sec (Started Sep 13 2024 at 05:40:21 CST)&lt;/li&gt;
	&lt;li&gt;Failed Execution (&lt;a href=&quot;https://ge.apache.org/s/g72utse4pdln2/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?top-execution=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Link&lt;/a&gt;):&#160; 59.632 sec (Started Sep 14 2024 at 04:05:41 CST)&lt;/li&gt;
	&lt;li&gt;Passed Execution (&lt;a href=&quot;https://ge.apache.org/s/g72utse4pdln2/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?top-execution=2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Link&lt;/a&gt;):&#160; 7.891(Started Sep 14 2024 at 07:36:26 CST)&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;This issue doesn&apos;t occurs in the last three days, so I think we could fix the known issue in the PR first.&lt;br/&gt;
Keep moniotoring the flaky rate in the next following days to see whether we should loose the timeout again.&lt;/p&gt;</comment>
                            <comment id="17884601" author="yu-lin chen" created="Wed, 25 Sep 2024 12:53:17 +0000"  >&lt;p&gt;Reopen this issue because the slow stream task initialization has still been occured over the last 5 days. (&lt;a href=&quot;https://ge.apache.org/scans/tests?search.startTimeMax=1727263640181&amp;amp;search.startTimeMin=1726761600000&amp;amp;search.tags=trunk&amp;amp;search.timeZoneId=Asia%2FTaipei&amp;amp;tests.container=org.apache.kafka.streams.integration.RestoreIntegrationTest&amp;amp;tests.test=shouldInvokeUserDefinedGlobalStateRestoreListener()&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Report Link&lt;/a&gt;, 5 of 115&#160; run took longer than 60s in trunk)&lt;/p&gt;

&lt;p&gt;Flaky tests:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Sep 25 2024 at 09:04:01 CST (&lt;a href=&quot;https://ge.apache.org/s/g5hopxjvfwdey/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?top-execution=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Link&lt;/a&gt;): 62 sec for ks1 stream tasks initialization (44 sec for rebalancing)&lt;/li&gt;
	&lt;li&gt;Sep 24 2024 at 21:46:08 CST (&lt;a href=&quot;https://ge.apache.org/s/jphpbv3mlmvca/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?top-execution=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Link&lt;/a&gt;): 59 sec for ks1 stream tasks initialization (43 sec for rebalancing)&lt;/li&gt;
	&lt;li&gt;Sep 23 2024 at 21:53:23 CST (&lt;a href=&quot;https://ge.apache.org/s/bngb54dybplky/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?top-execution=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Link&lt;/a&gt;): 70 sec for ks1 stream tasks initialization (45 sec for rebalancing)&lt;/li&gt;
	&lt;li&gt;Sep 23 2024 at 21:37:09 CST (&lt;a href=&quot;https://ge.apache.org/s/crnlwfthyofpw/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?top-execution=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Link&lt;/a&gt;): 61 sec for ks1 stream tasks initialization (45 sec for rebalancing)&lt;/li&gt;
	&lt;li&gt;Sep 23 2024 at 12:24:00 CST (&lt;a href=&quot;https://ge.apache.org/s/2fe6eo4xauoac/tests/task/:streams:test/details/org.apache.kafka.streams.integration.RestoreIntegrationTest/shouldInvokeUserDefinedGlobalStateRestoreListener()?top-execution=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Link&lt;/a&gt;): 63 sec for ks1 stream tasks initialization (49 sec for rebalancing)&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Will create another PR to increase the timeout. (Current 60 sec)&lt;/p&gt;</comment>
                            <comment id="17884844" author="yu-lin chen" created="Thu, 26 Sep 2024 04:23:47 +0000"  >&lt;p&gt;Since the Jenkins build on the trunk has been disabled today, close the second PR(&lt;a href=&quot;https://github.com/apache/kafka/pull/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;pull/17272&lt;/a&gt;), which increased the timeout. I will keep monitoring the build results.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13071558" name="Reproduced screenshoot in my env (Loop 7).png" size="395614" author="Yu-Lin Chen" created="Fri, 13 Sep 2024 19:34:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 6 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1rcds:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>