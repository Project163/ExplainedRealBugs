<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:32:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-8713] [Connect] JsonConverter NULL Values are replaced by default values even in NULLABLE fields</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-8713</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Class JsonConverter line: 582&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; JsonNode convertToJson(Schema schema, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; logicalValue) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (logicalValue == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (schema == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-comment&quot;&gt;// Any schema is valid and we don&apos;t have a &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;, so treat &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; as an optional schema
&lt;/span&gt;                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (schema.defaultValue() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; convertToJson(schema, schema.defaultValue());
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (schema.isOptional())
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; JsonNodeFactory.instance.nullNode();
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DataException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Conversion error: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; value &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; field that is required and has no &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; value&quot;&lt;/span&gt;);
        }
        ....
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;h1&gt;&lt;a name=&quot;Expect%3A&quot;&gt;&lt;/a&gt;Expect:&lt;/h1&gt;

&lt;p&gt;Value `null` is valid for an optional filed, even though the filed has a default value.&lt;br/&gt;
 Only when field is required, the converter return default value fallback when value is `null`.&lt;/p&gt;

&lt;h1&gt;&lt;a name=&quot;Actual%3A&quot;&gt;&lt;/a&gt;Actual:&lt;/h1&gt;

&lt;p&gt;Always return default value if `null` was given.&lt;/p&gt;


&lt;h1&gt;&lt;a name=&quot;Example%3A&quot;&gt;&lt;/a&gt;Example:&lt;/h1&gt;

&lt;p&gt;I&apos;m not sure if the current behavior is the exactly expected, but at least on MySQL, a table  define as &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt; t1 {
   &lt;span class=&quot;code-keyword&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;varchar&lt;/span&gt;(40) &lt;span class=&quot;code-keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,
   create_time &lt;span class=&quot;code-keyword&quot;&gt;datetime&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;1999-01-01 11:11:11&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,
   update_time &lt;span class=&quot;code-keyword&quot;&gt;datetime&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;1999-01-01 11:11:11&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Just insert a record:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INTO&lt;/span&gt; `t1` (`&lt;span class=&quot;code-keyword&quot;&gt;name&lt;/span&gt;`,  `update_time`) &lt;span class=&quot;code-keyword&quot;&gt;VALUES&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&apos;kafka&apos;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The result is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-json&quot;&gt;
{
    &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;kafka&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;create_time&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;1999-01-01 11:11:11&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;update_time&quot;&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But when I use debezium pull binlog and send the record to Kafka with JsonConverter, the result changed to:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-json&quot;&gt;
{
    &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;kafka&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;create_time&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;1999-01-01 11:11:11&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;update_time&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;1999-01-01 11:11:11&quot;&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For more details, see: &lt;a href=&quot;https://issues.jboss.org/browse/DBZ-1064&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://issues.jboss.org/browse/DBZ-1064&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13246975">KAFKA-8713</key>
            <summary>[Connect] JsonConverter NULL Values are replaced by default values even in NULLABLE fields</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mimaison">Mickael Maison</assignee>
                                    <reporter username="chengpan">Cheng Pan</reporter>
                        <labels>
                            <label>needs-kip</label>
                    </labels>
                <created>Thu, 25 Jul 2019 06:58:31 +0000</created>
                <updated>Thu, 8 Feb 2024 10:41:24 +0000</updated>
                            <resolved>Wed, 31 May 2023 13:55:13 +0000</resolved>
                                    <version>2.0.0</version>
                    <version>2.0.1</version>
                    <version>2.1.0</version>
                    <version>2.2.0</version>
                    <version>2.2.1</version>
                    <version>2.3.0</version>
                                    <fixVersion>3.5.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16892485" author="githubbot" created="Thu, 25 Jul 2019 07:09:40 +0000"  >&lt;p&gt;pan3793 commented on pull request #7112: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-8713&quot; title=&quot;[Connect] JsonConverter NULL Values are replaced by default values even in NULLABLE fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-8713&quot;&gt;&lt;del&gt;KAFKA-8713&lt;/del&gt;&lt;/a&gt;: Fix Connect JsonConverter swallow null value on optional filed which has default value&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/7112&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/7112&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-8713&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-8713&lt;/a&gt;&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="17044972" author="rhauch" created="Tue, 25 Feb 2020 22:42:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pan3793&quot; class=&quot;user-hover&quot; rel=&quot;pan3793&quot;&gt;pan3793&lt;/a&gt;, I agree that the current behavior is incorrect. But correcting this would change behavior, and we&apos;ll have to worry about how this affects existing users that upgrade to a version where this might get fixed. And AK&apos;s policy is that such changes require a KIP to identify all potential compatibility concerns. For example, we should consider whether we need to introduce a configuration property on the JSON converter that enables/disables this behavior so that existing users don&apos;t see any changes unless they want to enable it.&lt;/p&gt;</comment>
                            <comment id="17045149" author="chengpan" created="Wed, 26 Feb 2020 05:24:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhauch&quot; class=&quot;user-hover&quot; rel=&quot;rhauch&quot;&gt;rhauch&lt;/a&gt;, thanks for your reply. I totally agree with you this is an incompatibility change, and I also think that introducing a configuration property is a good choice. I&apos;d like to follow the process to come out a KIP draft to push on this ISSUE.&lt;/p&gt;</comment>
                            <comment id="17553550" author="JIRAUSER290714" created="Mon, 13 Jun 2022 12:21:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pan3793&quot; class=&quot;user-hover&quot; rel=&quot;pan3793&quot;&gt;pan3793&lt;/a&gt; This exact same bug exists in Confluent&apos;s AvroConverter as well. That&apos;s a major bug IMO..&lt;/p&gt;

&lt;p&gt;I&apos;ve opened a separate issue regarding AvroConverter: &lt;a href=&quot;https://github.com/confluentinc/schema-registry/issues/2314&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/confluentinc/schema-registry/issues/2314&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;d really appreciate it if you can comment or upvote this issue so it might get more attention.&lt;/p&gt;

&lt;p&gt;Thank you&lt;/p&gt;</comment>
                            <comment id="17553724" author="chengpan" created="Mon, 13 Jun 2022 17:16:03 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rotem-ad&quot; class=&quot;user-hover&quot; rel=&quot;rotem-ad&quot;&gt;rotem-ad&lt;/a&gt;, I&apos;m sorry I haven&apos;t worked in this area recently, feel free to take over this KIP if you want.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310361">
                    <name>Blocked</name>
                                                                <inwardlinks description="Blocked">
                                        <issuelink>
            <issuekey id="13558163">KAFKA-15838</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 22 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z050ag:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>