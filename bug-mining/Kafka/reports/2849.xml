<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:26:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-10811] System exit from MirrorConnectorsIntegrationTest#testReplication</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-10811</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;The MirrorConnectorsIntegrationTest::testReplication has been very frequently causing the build to fail with:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;FAILURE: Build failed with an exception.
13:50:17  
13:50:17  * What went wrong:
13:50:17  Execution failed for task &apos;:connect:mirror:integrationTest&apos;.
13:50:17  &amp;gt; Process &apos;Gradle Test Executor 52&apos; finished with non-zero exit value 1
13:50:17    This problem might be caused by incorrect test process configuration.
13:50:17    Please refer to the test execution section in the User Manual at https://docs.gradle.org/6.7.1/userguide/java_testing.html#sec:test_execution
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Even running this locally resulted in mostly failures, and specifically the `MirrorConnectorsIntegrationTest::testReplication` test method reliably fails due to the process being exited.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ChrisEgerton&quot; class=&quot;user-hover&quot; rel=&quot;ChrisEgerton&quot;&gt;ChrisEgerton&lt;/a&gt; traced this to the fact that these integration tests are creating multiple EmbeddedConnectCluster instances, each of which by default:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;mask the Exit procedures upon startup&lt;/li&gt;
	&lt;li&gt;reset the Exit procedures upon stop&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;But since &lt;b&gt;each&lt;/b&gt; cluster does this, then &lt;tt&gt;Exit.resetExitProcedure()&lt;/tt&gt; is called when the first Connect cluster is stopped, and if any problems occur while the second Connect cluster is being stopped (e.g., the KafkaBasedLog produce thread is interrupted) then the Exit called by the Connect worker results in the termination of the JVM.&lt;/p&gt;

&lt;p&gt;The solution is to change the MirrorConnectorsIntegrationTest to own the overriding of the exit procedures, and to tell the EmbeddedConnectCluster instances to not mask the exit procedures.&lt;/p&gt;

&lt;p&gt;With these changes, running these tests locally made the tests always pass locally for me.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13344308">KAFKA-10811</key>
            <summary>System exit from MirrorConnectorsIntegrationTest#testReplication</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhauch">Randall Hauch</assignee>
                                    <reporter username="rhauch">Randall Hauch</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Dec 2020 23:46:06 +0000</created>
                <updated>Tue, 20 Sep 2022 14:25:28 +0000</updated>
                            <resolved>Mon, 7 Dec 2020 19:51:28 +0000</resolved>
                                    <version>2.7.0</version>
                    <version>2.8.0</version>
                                    <fixVersion>2.5.2</fixVersion>
                    <fixVersion>2.6.1</fixVersion>
                    <fixVersion>2.7.0</fixVersion>
                    <fixVersion>2.8.0</fixVersion>
                                    <component>connect</component>
                    <component>mirrormaker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17245488" author="rhauch" created="Mon, 7 Dec 2020 19:51:28 +0000"  >&lt;p&gt;Merged to `trunk`, backported to `2.7` (with agreement from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bbejeck&quot; class=&quot;user-hover&quot; rel=&quot;bbejeck&quot;&gt;bbejeck&lt;/a&gt;) to avoid build failures. &lt;/p&gt;

&lt;p&gt;Also backported to `2.6` and `2.5`, though this included a few more lines from the `MirrorConnectorsIntegrationTest` class to make it more consistent with newer branches.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13482405">KAFKA-14244</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13261505">KAFKA-9013</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13344312">KAFKA-10812</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0l7yg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>