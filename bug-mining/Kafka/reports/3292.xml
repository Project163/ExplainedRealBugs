<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:31:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-14093] Flaky ExactlyOnceSourceIntegrationTest.testFencedLeaderRecovery</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-14093</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;org.apache.kafka.connect.integration.ExactlyOnceSourceIntegrationTest &amp;gt; testFencedLeaderRecovery FAILED&lt;br/&gt;
    java.lang.AssertionError: expected org.apache.kafka.connect.runtime.rest.errors.ConnectRestException to be thrown, but nothing was thrown&lt;/p&gt;
</description>
                <environment></environment>
        <key id="13472625">KAFKA-14093</key>
            <summary>Flaky ExactlyOnceSourceIntegrationTest.testFencedLeaderRecovery</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ChrisEgerton">Chris Egerton</assignee>
                                    <reporter username="mimaison">Mickael Maison</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Jul 2022 08:46:05 +0000</created>
                <updated>Mon, 25 Jul 2022 19:45:56 +0000</updated>
                            <resolved>Mon, 25 Jul 2022 13:38:09 +0000</resolved>
                                    <version>3.3.0</version>
                                    <fixVersion>3.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17569313" author="mimaison" created="Thu, 21 Jul 2022 08:46:29 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ChrisEgerton&quot; class=&quot;user-hover&quot; rel=&quot;ChrisEgerton&quot;&gt;ChrisEgerton&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17569318" author="mimaison" created="Thu, 21 Jul 2022 09:01:23 +0000"  >&lt;p&gt;I&apos;ve only been able to reproduce it once locally but I found a couple of other instances from our CI: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/kafka/runs/7208515607&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/runs/7208515607&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/kafka/runs/7428998555&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/runs/7428998555&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17570169" author="chrisegerton" created="Fri, 22 Jul 2022 20:23:58 +0000"  >&lt;p&gt;Ah, I think the root cause of this is rather simple; the Javadoc for the test calls out that it uses a one-node cluster, and the &lt;a href=&quot;https://github.com/apache/kafka/blob/679e9e0cee67e7d3d2ece204a421ea7da31d73e9/connect/runtime/src/test/java/org/apache/kafka/connect/integration/ExactlyOnceSourceIntegrationTest.java#L493-L494&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;check we do&lt;/a&gt; to make sure that the leader is up and running (and has had a chance to instantiate its transactional producer for the config topic) relies on that fact. However, I forgot to actually reduce the cluster size to one in the test, so right now it&apos;s running with three workers.&lt;/p&gt;

&lt;p&gt;As a result, it&apos;s possible that the readiness check we&apos;re doing hits a follower worker and passes before the leader has had a chance to finish startup.&lt;/p&gt;

&lt;p&gt;I&apos;ve published a quick fix that reduces the cluster to a single worker, and also adds client IDs for producers created for testing so that they can be distinguished from any producers created by the Connect cluster.&lt;/p&gt;

&lt;p&gt;I&apos;ve also filed &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-14098&quot; title=&quot;Internal Kafka clients used by Kafka Connect should have distinguishable client IDs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-14098&quot;&gt;&lt;del&gt;KAFKA-14098&lt;/del&gt;&lt;/a&gt; as a potential follow-up item to add meaningful client IDs to the internal clients set up by Connect workers.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13047070" name="org.apache.kafka.connect.integration.ExactlyOnceSourceIntegrationTest.testFencedLeaderRecovery.test.stdout" size="1082277" author="mimaison" created="Thu, 21 Jul 2022 08:45:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 16 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z171i0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>