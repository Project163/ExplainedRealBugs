<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:35:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-550] Wildcarded consumption is single-threaded</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-550</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;It&apos;s surprising that we haven&apos;t noticed this before, but I was looking at a CPU usage profile on yourkit and It turns out that only one mirror maker thread is actually doing anything. Basically I suspect some bug in fetcher -&amp;gt; queue mapping. Only one queue seems to have any data. I&apos;ll look into this probably next week.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12610676">KAFKA-550</key>
            <summary>Wildcarded consumption is single-threaded</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jjkoshy">Joel Jacob Koshy</assignee>
                                    <reporter username="jjkoshy">Joel Jacob Koshy</reporter>
                        <labels>
                    </labels>
                <created>Sat, 6 Oct 2012 01:38:46 +0000</created>
                <updated>Wed, 10 Oct 2012 16:30:11 +0000</updated>
                            <resolved>Wed, 10 Oct 2012 00:07:11 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13471950" author="jjkoshy" created="Mon, 8 Oct 2012 23:10:20 +0000"  >&lt;p&gt;This was a silly coding bug - the topicThreadIdAndQueues map was getting&lt;br/&gt;
updated incorrectly.  This affects both 0.7 and 0.8. The same patch applies to&lt;br/&gt;
both trunk and 0.8.&lt;/p&gt;

&lt;p&gt;The patch fixes the issue. Also got rid of the implicit def in&lt;br/&gt;
reinitializeConsumer.&lt;/p&gt;</comment>
                            <comment id="13472158" author="junrao" created="Tue, 9 Oct 2012 05:51:49 +0000"  >&lt;p&gt;Thanks for the patch. What was the bug? Is it the implicit function? &lt;/p&gt;

&lt;p&gt;1.reinitializeConsumer(): It seems that the computation for threadQueueStreamPairs is slightly different for WildcardTopicCount and StaticTopicCount. However, it seems that we can just use the same computation. &lt;/p&gt;</comment>
                            <comment id="13472576" author="jjkoshy" created="Tue, 9 Oct 2012 17:35:20 +0000"  >&lt;p&gt;The bug was not in the implicit function. I removed the implicit because it&lt;br/&gt;
could be easily avoided in this case.&lt;br/&gt;
The issue was here: (tt &amp;lt;- topicThreadIds; qs &amp;lt;- queuesAndStreams) yield (tt&lt;br/&gt;
-&amp;gt; qs)&lt;/p&gt;

&lt;p&gt;If there were topic-threadIds t1, t2, and queues q1, q2, you would get (t1&lt;br/&gt;
-&amp;gt; q1) (t1, q2) (t2 -&amp;gt; q1) (t2 -&amp;gt; q2) and they were sequentially added to&lt;br/&gt;
the topicThreadIdAndQueues pool. So all the threads would feed into the same&lt;br/&gt;
queue.&lt;/p&gt;

&lt;p&gt;Re: the computation is different because topicThreadIds in wildcard&lt;br/&gt;
consumption may share the same queue so you can&apos;t zip them directly. e.g., &lt;br/&gt;
whether there are two or 100 allowed topics, they will all share the same &lt;br/&gt;
num-streams queues, and num-streams != the number of threads, so you can&apos;t &lt;br/&gt;
zip them. In the static topic count case, there is one-to-one correspondence&lt;br/&gt;
so you can zip them.&lt;/p&gt;

&lt;p&gt;That said, I think the code can be made clearer here. I will upload another &lt;br/&gt;
patch in a minute.&lt;/p&gt;</comment>
                            <comment id="13472688" author="jjkoshy" created="Tue, 9 Oct 2012 19:57:02 +0000"  >&lt;p&gt;Another point to consider for future enhancement is that right now all wildcard topics will be assigned&lt;br/&gt;
num-threads (i.e., the wildcard stream count) threads regardless of how many partitions&lt;br/&gt;
they have.&lt;/p&gt;

&lt;p&gt;Ideally, the user should be able to say something like &quot;numThreads=100&quot; and messages from all&lt;br/&gt;
topic-partitions (that are allowed by the wildcard) should be fed into those queues/streams uniformly.&lt;/p&gt;</comment>
                            <comment id="13472797" author="nehanarkhede" created="Tue, 9 Oct 2012 22:20:35 +0000"  >&lt;p&gt;Good catch, +1&lt;/p&gt;</comment>
                            <comment id="13472878" author="jjkoshy" created="Wed, 10 Oct 2012 00:07:20 +0000"  >&lt;p&gt;Committed to 0.8 and trunk.&lt;/p&gt;</comment>
                            <comment id="13473346" author="junrao" created="Wed, 10 Oct 2012 16:30:11 +0000"  >&lt;p&gt;Could you open a separate jira for improving partition assignment for wildcard topic? This is probably beyond 0.8 though.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12548327" name="KAFKA-550-v1.patch" size="2208" author="jjkoshy" created="Mon, 8 Oct 2012 23:10:20 +0000"/>
                            <attachment id="12548446" name="KAFKA-550-v2.patch" size="2588" author="jjkoshy" created="Tue, 9 Oct 2012 19:53:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>244151</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 6 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05iqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30133</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>