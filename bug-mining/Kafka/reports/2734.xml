<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:24:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-10220] NPE when describing resources</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-10220</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;In current trunk code &lt;br/&gt;
 Describing a topic from the CLI can fail with an NPE in the broker&lt;/p&gt;

&lt;p&gt;on the line&#160;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&#160; &#160; &#160; &#160; &#160; resource.configurationKeys.asScala.forall(_.contains(configName))&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;(configurationKeys is null)&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2020-06-30 11:10:39,464&amp;#93;&lt;/span&gt; ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;Admin Manager on Broker 0&amp;#93;&lt;/span&gt;: Error processing describe configs request for resource DescribeConfigsResource(resourceType=2, resourceName=&apos;topic1&apos;, configurationKeys=null) (kafka.server.AdminManager)&lt;/tt&gt;&lt;tt&gt;java.lang.NullPointerException&lt;/tt&gt;&lt;tt&gt;at kafka.server.AdminManager.$anonfun$describeConfigs$3(AdminManager.scala:395)&lt;/tt&gt;&lt;tt&gt;at kafka.server.AdminManager.$anonfun$describeConfigs$3$adapted(AdminManager.scala:393)&lt;/tt&gt;&lt;tt&gt;at scala.collection.TraversableLike.$anonfun$filterImpl$1(TraversableLike.scala:248)&lt;/tt&gt;&lt;tt&gt;at scala.collection.Iterator.foreach(Iterator.scala:929)&lt;/tt&gt;&lt;tt&gt;at scala.collection.Iterator.foreach$(Iterator.scala:929)&lt;/tt&gt;&lt;tt&gt;at scala.collection.AbstractIterator.foreach(Iterator.scala:1417)&lt;/tt&gt;&lt;tt&gt;at scala.collection.IterableLike.foreach(IterableLike.scala:71)&lt;/tt&gt;&lt;tt&gt;at scala.collection.IterableLike.foreach$(IterableLike.scala:70)&lt;/tt&gt;&lt;tt&gt;at scala.collection.AbstractIterable.foreach(Iterable.scala:54)&lt;/tt&gt;&lt;tt&gt;at scala.collection.TraversableLike.filterImpl(TraversableLike.scala:247)&lt;/tt&gt;&lt;tt&gt;at scala.collection.TraversableLike.filterImpl$(TraversableLike.scala:245)&lt;/tt&gt;&lt;tt&gt;at scala.collection.AbstractTraversable.filterImpl(Traversable.scala:104)&lt;/tt&gt;&lt;tt&gt;at scala.collection.TraversableLike.filter(TraversableLike.scala:259)&lt;/tt&gt;&lt;tt&gt;at scala.collection.TraversableLike.filter$(TraversableLike.scala:259)&lt;/tt&gt;&lt;tt&gt;at scala.collection.AbstractTraversable.filter(Traversable.scala:104)&lt;/tt&gt;&lt;tt&gt;at kafka.server.AdminManager.createResponseConfig$1(AdminManager.scala:393)&lt;/tt&gt;&lt;tt&gt;at kafka.server.AdminManager.$anonfun$describeConfigs$1(AdminManager.scala:412)&lt;/tt&gt;&lt;tt&gt;at scala.collection.immutable.List.map(List.scala:283)&lt;/tt&gt;&lt;tt&gt;at kafka.server.AdminManager.describeConfigs(AdminManager.scala:386)&lt;/tt&gt;&lt;tt&gt;at kafka.server.KafkaApis.handleDescribeConfigsRequest(KafkaApis.scala:2595)&lt;/tt&gt;&lt;tt&gt;at kafka.server.KafkaApis.handle(KafkaApis.scala:165)&lt;/tt&gt;&lt;tt&gt;at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:70)&lt;/tt&gt;&lt;tt&gt;at java.lang.Thread.run(Thread.java:748)&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13314272">KAFKA-10220</key>
            <summary>NPE when describing resources</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="showuon">Luke Chen</assignee>
                                    <reporter username="ecomar">Edoardo Comar</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Jun 2020 10:26:07 +0000</created>
                <updated>Thu, 9 Jul 2020 09:28:27 +0000</updated>
                            <resolved>Thu, 9 Jul 2020 08:59:33 +0000</resolved>
                                                    <fixVersion>2.7.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17148550" author="huxi_2b" created="Tue, 30 Jun 2020 11:19:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ecomar&quot; class=&quot;user-hover&quot; rel=&quot;ecomar&quot;&gt;ecomar&lt;/a&gt;&#160; Thanks for reporting. I could not reproduce this issue with trunk. Are you using the latest code for clients?&lt;/p&gt;</comment>
                            <comment id="17148564" author="ecomar" created="Tue, 30 Jun 2020 11:32:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=huxi_2b&quot; class=&quot;user-hover&quot; rel=&quot;huxi_2b&quot;&gt;huxi_2b&lt;/a&gt;&#160;I initially hit this when using the 2.5.0 cli (from the binary distribution) against trunk (running in eclipse)&lt;/p&gt;

&lt;p&gt;I was later able to reproduce using the cli built from trunk (./gradlew assemble&#160;-PscalaVersion=2.12)&lt;/p&gt;</comment>
                            <comment id="17148575" author="ecomar" created="Tue, 30 Jun 2020 11:49:10 +0000"  >&lt;p&gt;ok, a bit more steps to reproduce.... looks like the issue was linked to having created and described a topic with 2.5&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;#on current trunk&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;$ git lg&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;55b5b248c - (HEAD -&amp;gt; trunk, origin/trunk, origin/HEAD)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;#build&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;$ ./gradlew clean&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;$ ./gradlew assemble -PscalaVersion=2.12&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;#run zookepeer and one broker&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;$ export SCALA_VERSION=2.12&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;$&#160; bin/zookeeper-server-start.sh config/zookeeper.properties&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;$ bin/kafka-server-start.sh config/server.properties&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;#create topic with CLI&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;$ bin/kafka-topics.sh --bootstrap-server localhost:9092 --create --topic topic1 --partitions 1 --replication-factor 1&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;# works fine&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;# describe topic with CLI&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;$ bin/kafka-topics.sh --bootstrap-server localhost:9092 --describe&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Topic: topic1 PartitionCount: 1 ReplicationFactor: 1 Configs: segment.bytes=1073741824Topic: topic1 PartitionCount: 1 ReplicationFactor: 1 Configs: segment.bytes=1073741824 Topic: topic1 Partition: 0 Leader: 0 Replicas: 0 Isr: 0&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;#works fine&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;in another terminal, use the kafka_2.13-2.5.0 binary distribution:&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;$ bin/kafka-topics.sh --bootstrap-server localhost:9092 --create --topic topic25 --partitions 1 --replication-factor 1&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Created topic topic25.&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;#now describe it (still with 2.5) ... boom&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;$ bin/kafka-topics.sh --bootstrap-server localhost:9092 --describe&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Error while executing topic command : org.apache.kafka.common.errors.UnknownServerException: The server experienced an unexpected error when processing the request.Error while executing topic command : org.apache.kafka.common.errors.UnknownServerException: The server experienced an unexpected error when processing the request.&lt;span class=&quot;error&quot;&gt;&amp;#91;2020-06-30 12:39:48,581&amp;#93;&lt;/span&gt; ERROR java.util.concurrent.ExecutionException: org.apache.kafka.common.errors.UnknownServerException: The server experienced an unexpected error when processing the request. at org.apache.kafka.common.internals.KafkaFutureImpl.wrapAndThrow(KafkaFutureImpl.java:45)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;#in the broker terminal, the exception is&#160;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2020-06-30 12:40:27,543&amp;#93;&lt;/span&gt; ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;Admin Manager on Broker 0&amp;#93;&lt;/span&gt;: Error processing describe configs request for resource DescribeConfigsResource(resourceType=2, resourceName=&apos;topic1&apos;, configurationKeys=null) (kafka.server.AdminManager)&lt;span class=&quot;error&quot;&gt;&amp;#91;2020-06-30 12:40:27,543&amp;#93;&lt;/span&gt; ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;Admin Manager on Broker 0&amp;#93;&lt;/span&gt;: Error processing describe configs request for resource DescribeConfigsResource(resourceType=2, resourceName=&apos;topic1&apos;, configurationKeys=null) (kafka.server.AdminManager)java.lang.NullPointerException at kafka.server.AdminManager.$anonfun$describeConfigs$3(AdminManager.scala:359) at kafka.server.AdminManager.$anonfun$describeConfigs$3$adapted(AdminManager.scala:357) at scala.collection.TraversableLike.$anonfun$filterImpl$1(TraversableLike.scala:291) at scala.collection.Iterator.foreach(Iterator.scala:943) at scala.collection.Iterator.foreach$(Iterator.scala:943) at scala.collection.AbstractIterator.foreach(Iterator.scala:1431) at scala.collection.IterableLike.foreach(IterableLike.scala:74) at scala.collection.IterableLike.foreach$(IterableLike.scala:73) at scala.collection.AbstractIterable.foreach(Iterable.scala:56) at scala.collection.TraversableLike.filterImpl(TraversableLike.scala:290) at scala.collection.TraversableLike.filterImpl$(TraversableLike.scala:284) at scala.collection.AbstractTraversable.filterImpl(Traversable.scala:108) at scala.collection.TraversableLike.filter(TraversableLike.scala:382) at scala.collection.TraversableLike.filter$(TraversableLike.scala:382) at scala.collection.AbstractTraversable.filter(Traversable.scala:108) at kafka.server.AdminManager.$anonfun$describeConfigs$1(AdminManager.scala:357) at kafka.server.AdminManager.describeConfigs(AdminManager.scala:350) at kafka.server.KafkaApis.handleDescribeConfigsRequest(KafkaApis.scala:2594) at kafka.server.KafkaApis.handle(KafkaApis.scala:165) at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:70) at java.base/java.lang.Thread.run(Thread.java:834)&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17148576" author="ecomar" created="Tue, 30 Jun 2020 11:50:43 +0000"  >&lt;p&gt;&lt;tt&gt;also note that if the describe comes from the current trunk, it succeeds:&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;(trunk)$ bin/kafka-topics.sh --bootstrap-server localhost:9092 --describe&lt;/tt&gt;&lt;br/&gt;
 {{Topic: topic1 PartitionCount: 1 ReplicationFactor: 1 Configs: segment.bytes=1073741824 }}&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;Topic: topic1 Partition: 0 Leader: 0 Replicas: 0 Isr: 0&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;{{Topic: topic25 PartitionCount: 1 ReplicationFactor: 1 Configs: segment.bytes=1073741824 }}&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;Topic: topic25 Partition: 0 Leader: 0 Replicas: 0 Isr: 0&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17148680" author="ijuma" created="Tue, 30 Jun 2020 13:36:34 +0000"  >&lt;p&gt;Does this affect 2.6 as well or just trunk?&lt;/p&gt;</comment>
                            <comment id="17148738" author="huxi_2b" created="Tue, 30 Jun 2020 14:44:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ijuma&quot; class=&quot;user-hover&quot; rel=&quot;ijuma&quot;&gt;ijuma&lt;/a&gt;&#160;This should affect 2.6 as well since `configurationKeys` starts to be initialized in 2.7, due to the refinement introduced by&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9432&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;KAFKA-9432&lt;/a&gt;. Anyway, since `configurationKeys` is a nullable, an empty check should be added when processing the resources in AdminManager.&lt;/p&gt;</comment>
                            <comment id="17148756" author="ijuma" created="Tue, 30 Jun 2020 15:08:01 +0000"  >&lt;p&gt;From the link you referenced, it seems like this only affects trunk, not 2.6.&lt;/p&gt;</comment>
                            <comment id="17148774" author="huxi_2b" created="Tue, 30 Jun 2020 15:30:05 +0000"  >&lt;p&gt;Well, from the broker perspective, you are right. Only trunk is affected. What I mean is we&apos;ll also hit NPE when using 2.6 clients talking to trunk broker.&lt;/p&gt;</comment>
                            <comment id="17149170" author="omkreddy" created="Wed, 1 Jul 2020 07:12:46 +0000"  >&lt;p&gt;looks like this got introduced in &lt;a href=&quot;https://github.com/apache/kafka/pull/8312&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/8312&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tombentley&quot; class=&quot;user-hover&quot; rel=&quot;tombentley&quot;&gt;tombentley&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17149192" author="tombentley" created="Wed, 1 Jul 2020 07:44:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=omkreddy&quot; class=&quot;user-hover&quot; rel=&quot;omkreddy&quot;&gt;omkreddy&lt;/a&gt; I&apos;m happy to fix it, but Luke is already assigned. In any case, sorry folks &#9785;. I took another look at my PR and since &lt;tt&gt;configurationKeys&lt;/tt&gt; is the only nullable field I don&apos;t think it&apos;s a systematic mistake.&lt;/p&gt;


&lt;p&gt;One other thought: We could easily have the message generator add &lt;tt&gt;@Nullable&lt;/tt&gt; annotations to nullable fields to enable static checking for this kind of error.&lt;/p&gt;</comment>
                            <comment id="17149206" author="showuon" created="Wed, 1 Jul 2020 08:22:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tombentley&quot; class=&quot;user-hover&quot; rel=&quot;tombentley&quot;&gt;tombentley&lt;/a&gt;, I&apos;ll submit a PR for your review later. Thanks.&lt;/p&gt;</comment>
                            <comment id="17154362" author="omkreddy" created="Thu, 9 Jul 2020 08:59:33 +0000"  >&lt;p&gt;Issue resolved by pull request 8966&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/8966&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/8966&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0gc1s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>