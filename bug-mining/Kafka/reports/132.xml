<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:36:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-577] extend DumpLogSegments to verify consistency btw data and index</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-577</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;It would be good to extend DumpLogSegments to do the following verification:&lt;br/&gt;
1. The offsets stored in the index match those in the log data.&lt;br/&gt;
2. The offsets in the data log is consecutive.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12612446">KAFKA-577</key>
            <summary>extend DumpLogSegments to verify consistency btw data and index</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="junrao">Jun Rao</reporter>
                        <labels>
                            <label>newbie</label>
                            <label>tools</label>
                    </labels>
                <created>Thu, 18 Oct 2012 16:18:40 +0000</created>
                <updated>Mon, 5 Nov 2012 23:39:17 +0000</updated>
                            <resolved>Mon, 5 Nov 2012 23:39:12 +0000</resolved>
                                    <version>0.8.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>
                            <timeestimate seconds="86400">24h</timeestimate>
                                        <comments>
                            <comment id="13485306" author="junrao" created="Sat, 27 Oct 2012 00:31:42 +0000"  >&lt;p&gt;Thanks for the patch. Some comments:&lt;/p&gt;

&lt;p&gt;1. Could you add a --verifyOnly option so that we only do the verification but not print out the content?&lt;br/&gt;
2. The text in the following statement is too verbose. It doesn&apos;t need to print the index file since it&apos;s provided in the command line. It can just say &quot;Index position %d doesn&apos;t match log position at offset %d&quot;.&lt;br/&gt;
        System.err.println((&quot;The offset in index file &lt;span class=&quot;error&quot;&gt;&amp;#91;%s&amp;#93;&lt;/span&gt; does not match the offset stored in &quot; +&lt;br/&gt;
                &quot;log file &lt;span class=&quot;error&quot;&gt;&amp;#91;%s&amp;#93;&lt;/span&gt;, they&apos;re %d and %d separately&quot;).format(entry.offset + index.baseOffset, messageAndOffset.offset))&lt;br/&gt;
3. Shouldn&apos;t we use %d instead of %l in the following line?&lt;br/&gt;
        System.err.println(&quot;The offset in the data log file &lt;span class=&quot;error&quot;&gt;&amp;#91;%s&amp;#93;&lt;/span&gt; is not consecutive, &lt;span class=&quot;error&quot;&gt;&amp;#91;%l&amp;#93;&lt;/span&gt; follows &lt;span class=&quot;error&quot;&gt;&amp;#91;%l&amp;#93;&lt;/span&gt;&quot;.format(file.getName, messageAndOffset.offset, lastOffset))&lt;br/&gt;
4. Could you add a shell script for DumpLogSegments in bin/ ?&lt;/p&gt;</comment>
                            <comment id="13486372" author="yeyangever" created="Mon, 29 Oct 2012 21:15:20 +0000"  >&lt;p&gt;&lt;br/&gt;
changed according to the comments&lt;/p&gt;</comment>
                            <comment id="13486548" author="junrao" created="Tue, 30 Oct 2012 00:25:46 +0000"  >&lt;p&gt;Thanks for patch v2. Instead of exiting on first verification failure, it would be better if we dump the whole log and report all failed verification at the very end.&lt;/p&gt;</comment>
                            <comment id="13488582" author="yeyangever" created="Thu, 1 Nov 2012 09:54:18 +0000"  >&lt;p&gt;&lt;br/&gt;
cache all verification failure and print out at the end, not verified by real data yet because cannot find proper data for that...., just check the logic of the code..&lt;/p&gt;</comment>
                            <comment id="13489213" author="yeyangever" created="Fri, 2 Nov 2012 02:39:41 +0000"  >
&lt;p&gt;1. also &quot;do it in batch&quot; for dumpLog() function&lt;/p&gt;

&lt;p&gt;2. use scala HashMap instead of Pool&lt;/p&gt;

&lt;p&gt;3. Use LinkedList in the right way&lt;/p&gt;</comment>
                            <comment id="13489255" author="junrao" created="Fri, 2 Nov 2012 04:33:46 +0000"  >&lt;p&gt;A couple of more comments for patch v4.&lt;/p&gt;

&lt;p&gt;40. LinkedList is supposed to be used for manipulating links directly. We should just use List (immutable) instead. Also, instead of the following,&lt;/p&gt;

&lt;p&gt;        misMatchesSeq = misMatchesSeq.:+((entry.offset + index.baseOffset, messageAndOffset.offset).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;(Int, Int)&amp;#93;&lt;/span&gt;)&lt;/p&gt;

&lt;p&gt;we should write&lt;/p&gt;

&lt;p&gt;        misMatchesSeq :+= ((entry.offset + index.baseOffset, messageAndOffset.offset).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;(Int, Int)&amp;#93;&lt;/span&gt;)&lt;/p&gt;</comment>
                            <comment id="13489858" author="yeyangever" created="Sat, 3 Nov 2012 00:06:10 +0000"  >&lt;p&gt;&lt;br/&gt;
Thanks for the comments, and the LinkedList is replaced with List now &lt;/p&gt;</comment>
                            <comment id="13490305" author="nehanarkhede" created="Sun, 4 Nov 2012 21:55:35 +0000"  >&lt;p&gt;Sorry for coming to this a little late. Patch v5 looks good, just one suggestion - Looks like DumpLogSegments is the only tool that doesn&apos;t quite follow the convention for argument parsing. It will be good to standardize on jopt parser since it also helps with a description for each option, a help command and convenient required argument checks. Just my 2c.&lt;/p&gt;</comment>
                            <comment id="13490834" author="yeyangever" created="Mon, 5 Nov 2012 19:07:39 +0000"  >&lt;p&gt;@Neha sure, we can do that&lt;/p&gt;</comment>
                            <comment id="13490944" author="yeyangever" created="Mon, 5 Nov 2012 21:31:22 +0000"  >&lt;p&gt;&lt;br/&gt;
Using jOptSimple for option parsing&lt;/p&gt;</comment>
                            <comment id="13491047" author="junrao" created="Mon, 5 Nov 2012 23:39:12 +0000"  >&lt;p&gt;Thanks for patch v6. &lt;ins&gt;1. Committed to 0.8 with a minor change: using ::= on a list instead of .:&lt;/ins&gt;=&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12550926" name="kafka_577_v1.diff" size="2298" author="yeyangever" created="Fri, 26 Oct 2012 04:55:03 +0000"/>
                            <attachment id="12551249" name="kafka_577_v2.diff" size="4299" author="yeyangever" created="Mon, 29 Oct 2012 21:15:20 +0000"/>
                            <attachment id="12551692" name="kafka_577_v3.diff" size="4017" author="yeyangever" created="Thu, 1 Nov 2012 09:54:18 +0000"/>
                            <attachment id="12551811" name="kafka_577_v4.diff" size="6102" author="yeyangever" created="Fri, 2 Nov 2012 02:39:41 +0000"/>
                            <attachment id="12551949" name="kafka_577_v5.diff" size="6854" author="yeyangever" created="Sat, 3 Nov 2012 00:06:10 +0000"/>
                            <attachment id="12552165" name="kafka_577_v6.diff" size="7298" author="yeyangever" created="Mon, 5 Nov 2012 21:31:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>249592</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 3 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0afrj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>58827</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>